import{P as K,j as i,B as le,N as zr,a as Ry,C as He,b as ce,A as tt,S as ur,I as Fy,F as Y,M as de,R as Ee,c as oe,T as Yt,O as CP,d as PP,D as vr,e as $e,L as Ly,f as DP,g as dn,h as lS,i as IP}from"./bootstrap-BmnIkvjv.js";import{r as _,R as se,u as ki,b as Et,L as Ef,O as RP,c as FP,d as pd,N as LP,e as MP,f as BP,g as Fn,h as $P,i as zP}from"./router-uuPVKGOP.js";import{a as cS,g as ss,r as vd,c as kc}from"./vendor-Dazix4UH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Oc={},My;function UP(){if(My)return Oc;My=1;var e=cS();return Oc.createRoot=e.createRoot,Oc.hydrateRoot=e.hydrateRoot,Oc}var qP=UP(),WP=["color","size","title","className"];function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sp.apply(null,arguments)}function HP(e,t){if(e==null)return{};var r,n,a=VP(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HP(e,WP);return se.createElement("svg",sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-airplane",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});uS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var GP=["color","size","title","className"];function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ip.apply(null,arguments)}function KP(e,t){if(e==null)return{};var r,n,a=YP(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=KP(e,GP);return se.createElement("svg",ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-arrow-clockwise",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),se.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});dS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var XP=["color","size","title","className"];function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},op.apply(null,arguments)}function ZP(e,t){if(e==null)return{};var r,n,a=JP(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dr=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ZP(e,XP);return se.createElement("svg",op({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-arrow-left",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});dr.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var QP=["color","size","title","className"];function lp(){return lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lp.apply(null,arguments)}function e3(e,t){if(e==null)return{};var r,n,a=t3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function t3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vl=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=e3(e,QP);return se.createElement("svg",lp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-arrow-right",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});vl.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var r3=["color","size","title","className"];function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cp.apply(null,arguments)}function n3(e,t){if(e==null)return{};var r,n,a=a3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function a3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gl=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=n3(e,r3);return se.createElement("svg",cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-award",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),se.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});gl.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var s3=["color","size","title","className"];function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},up.apply(null,arguments)}function i3(e,t){if(e==null)return{};var r,n,a=o3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function o3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gr=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=i3(e,s3);return se.createElement("svg",up({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-book",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});gr.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var l3=["color","size","title","className"];function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dp.apply(null,arguments)}function c3(e,t){if(e==null)return{};var r,n,a=u3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function u3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fp=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=c3(e,l3);return se.createElement("svg",dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-box-arrow-right",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),se.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});fp.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var d3=["color","size","title","className"];function hp(){return hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hp.apply(null,arguments)}function f3(e,t){if(e==null)return{};var r,n,a=h3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function h3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ts=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=f3(e,d3);return se.createElement("svg",hp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-building",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),se.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Ts.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var m3=["color","size","title","className"];function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mp.apply(null,arguments)}function p3(e,t){if(e==null)return{};var r,n,a=v3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Yr=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=p3(e,m3);return se.createElement("svg",mp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-calendar",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});Yr.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var g3=["color","size","title","className"];function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pp.apply(null,arguments)}function x3(e,t){if(e==null)return{};var r,n,a=y3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function y3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var It=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=x3(e,g3);return se.createElement("svg",pp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-check-circle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),se.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});It.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var b3=["color","size","title","className"];function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vp.apply(null,arguments)}function w3(e,t){if(e==null)return{};var r,n,a=j3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function j3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=w3(e,b3);return se.createElement("svg",vp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-check-square",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),se.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});fS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var N3=["color","size","title","className"];function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gp.apply(null,arguments)}function E3(e,t){if(e==null)return{};var r,n,a=_3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hi=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=E3(e,N3);return se.createElement("svg",gp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-chevron-down",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});hi.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var S3=["color","size","title","className"];function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xp.apply(null,arguments)}function T3(e,t){if(e==null)return{};var r,n,a=A3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function A3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Og=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=T3(e,S3);return se.createElement("svg",xp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-chevron-right",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Og.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var k3=["color","size","title","className"];function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yp.apply(null,arguments)}function O3(e,t){if(e==null)return{};var r,n,a=C3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=O3(e,k3);return se.createElement("svg",yp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-chevron-up",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});hS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var P3=["color","size","title","className"];function bp(){return bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bp.apply(null,arguments)}function D3(e,t){if(e==null)return{};var r,n,a=I3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function I3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Vt=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=D3(e,P3);return se.createElement("svg",bp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-clipboard-check",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),se.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),se.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});Vt.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var R3=["color","size","title","className"];function wp(){return wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wp.apply(null,arguments)}function F3(e,t){if(e==null)return{};var r,n,a=L3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function L3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Oa=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=F3(e,R3);return se.createElement("svg",wp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-clock",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),se.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});Oa.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var M3=["color","size","title","className"];function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jp.apply(null,arguments)}function B3(e,t){if(e==null)return{};var r,n,a=$3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ja=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=B3(e,M3);return se.createElement("svg",jp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-download",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),se.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});Ja.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var z3=["color","size","title","className"];function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Np.apply(null,arguments)}function U3(e,t){if(e==null)return{};var r,n,a=q3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function q3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gd=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=U3(e,z3);return se.createElement("svg",Np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-envelope",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});gd.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var W3=["color","size","title","className"];function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ep.apply(null,arguments)}function H3(e,t){if(e==null)return{};var r,n,a=V3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function V3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Gt=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=H3(e,W3);return se.createElement("svg",Ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-exclamation-triangle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),se.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Gt.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var G3=["color","size","title","className"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_p.apply(null,arguments)}function K3(e,t){if(e==null)return{};var r,n,a=Y3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Y3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xl=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=K3(e,G3);return se.createElement("svg",_p({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-eye-slash",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),se.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),se.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});xl.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var X3=["color","size","title","className"];function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sp.apply(null,arguments)}function Z3(e,t){if(e==null)return{};var r,n,a=J3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xt=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Z3(e,X3);return se.createElement("svg",Sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-eye",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),se.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});Xt.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var Q3=["color","size","title","className"];function Tp(){return Tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tp.apply(null,arguments)}function eD(e,t){if(e==null)return{};var r,n,a=tD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var to=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=eD(e,Q3);return se.createElement("svg",Tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-file-earmark-excel",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),se.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});to.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var rD=["color","size","title","className"];function Ap(){return Ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ap.apply(null,arguments)}function nD(e,t){if(e==null)return{};var r,n,a=aD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=nD(e,rD);return se.createElement("svg",Ap({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-file-earmark-text",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),se.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});mS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var sD=["color","size","title","className"];function kp(){return kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kp.apply(null,arguments)}function iD(e,t){if(e==null)return{};var r,n,a=oD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hu=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=iD(e,sD);return se.createElement("svg",kp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-file-earmark",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});hu.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var lD=["color","size","title","className"];function Op(){return Op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Op.apply(null,arguments)}function cD(e,t){if(e==null)return{};var r,n,a=uD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=cD(e,lD);return se.createElement("svg",Op({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-file-text-fill",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});pS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var dD=["color","size","title","className"];function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(null,arguments)}function fD(e,t){if(e==null)return{};var r,n,a=hD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xa=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=fD(e,dD);return se.createElement("svg",Cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-file-text",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),se.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});xa.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var mD=["color","size","title","className"];function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pp.apply(null,arguments)}function pD(e,t){if(e==null)return{};var r,n,a=vD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xo=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=pD(e,mD);return se.createElement("svg",Pp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-funnel",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});xo.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var gD=["color","size","title","className"];function Dp(){return Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dp.apply(null,arguments)}function xD(e,t){if(e==null)return{};var r,n,a=yD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=xD(e,gD);return se.createElement("svg",Dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-gear",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),se.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});vS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var bD=["color","size","title","className"];function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ip.apply(null,arguments)}function wD(e,t){if(e==null)return{};var r,n,a=jD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yo=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=wD(e,bD);return se.createElement("svg",Ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-geo-alt",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),se.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});yo.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var ND=["color","size","title","className"];function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(null,arguments)}function ED(e,t){if(e==null)return{};var r,n,a=_D(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _D(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ED(e,ND);return se.createElement("svg",Rp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-graph-up",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M0 0h1v15h15v1H0zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07"}))});gS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var SD=["color","size","title","className"];function Fp(){return Fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fp.apply(null,arguments)}function TD(e,t){if(e==null)return{};var r,n,a=AD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TD(e,SD);return se.createElement("svg",Fp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-house",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});xS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var kD=["color","size","title","className"];function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lp.apply(null,arguments)}function OD(e,t){if(e==null)return{};var r,n,a=CD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=OD(e,kD);return se.createElement("svg",Lp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-info-circle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),se.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});yS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var PD=["color","size","title","className"];function Mp(){return Mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mp.apply(null,arguments)}function DD(e,t){if(e==null)return{};var r,n,a=ID(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ID(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yl=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=DD(e,PD);return se.createElement("svg",Mp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-key",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),se.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});yl.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var RD=["color","size","title","className"];function Bp(){return Bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bp.apply(null,arguments)}function FD(e,t){if(e==null)return{};var r,n,a=LD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function LD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=FD(e,RD);return se.createElement("svg",Bp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-list",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});bS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var MD=["color","size","title","className"];function $p(){return $p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$p.apply(null,arguments)}function BD(e,t){if(e==null)return{};var r,n,a=$D(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $D(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mi=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=BD(e,MD);return se.createElement("svg",$p({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-pen",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});mi.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var zD=["color","size","title","className"];function zp(){return zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zp.apply(null,arguments)}function UD(e,t){if(e==null)return{};var r,n,a=qD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ya=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=UD(e,zD);return se.createElement("svg",zp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-pencil",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});ya.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var WD=["color","size","title","className"];function Up(){return Up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Up.apply(null,arguments)}function HD(e,t){if(e==null)return{};var r,n,a=VD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Pn=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HD(e,WD);return se.createElement("svg",Up({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-people",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Pn.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var GD=["color","size","title","className"];function qp(){return qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qp.apply(null,arguments)}function KD(e,t){if(e==null)return{};var r,n,a=YD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=KD(e,GD);return se.createElement("svg",qp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-check-fill",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),se.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});wS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var XD=["color","size","title","className"];function Wp(){return Wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wp.apply(null,arguments)}function ZD(e,t){if(e==null)return{};var r,n,a=JD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ha=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ZD(e,XD);return se.createElement("svg",Wp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-check",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),se.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});ha.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var QD=["color","size","title","className"];function Hp(){return Hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hp.apply(null,arguments)}function eI(e,t){if(e==null)return{};var r,n,a=tI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Wi=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=eI(e,QD);return se.createElement("svg",Hp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-circle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),se.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});Wi.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var rI=["color","size","title","className"];function Vp(){return Vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vp.apply(null,arguments)}function nI(e,t){if(e==null)return{};var r,n,a=aI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mu=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=nI(e,rI);return se.createElement("svg",Vp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-dash",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7M11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1m0-7a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),se.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});mu.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var sI=["color","size","title","className"];function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gp.apply(null,arguments)}function iI(e,t){if(e==null)return{};var r,n,a=oI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pi=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=iI(e,sI);return se.createElement("svg",Gp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-plus",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}),se.createElement("path",{fillRule:"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"}))});pi.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var lI=["color","size","title","className"];function Kp(){return Kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kp.apply(null,arguments)}function cI(e,t){if(e==null)return{};var r,n,a=uI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bo=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=cI(e,lI);return se.createElement("svg",Kp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person-x",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),se.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});bo.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var dI=["color","size","title","className"];function Yp(){return Yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yp.apply(null,arguments)}function fI(e,t){if(e==null)return{};var r,n,a=hI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ba=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=fI(e,dI);return se.createElement("svg",Yp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-person",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});ba.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var mI=["color","size","title","className"];function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xp.apply(null,arguments)}function pI(e,t){if(e==null)return{};var r,n,a=vI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Cg=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=pI(e,mI);return se.createElement("svg",Xp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-phone",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),se.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});Cg.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var gI=["color","size","title","className"];function Zp(){return Zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zp.apply(null,arguments)}function xI(e,t){if(e==null)return{};var r,n,a=yI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Pg=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=xI(e,gI);return se.createElement("svg",Zp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-play",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});Pg.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var bI=["color","size","title","className"];function Jp(){return Jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jp.apply(null,arguments)}function wI(e,t){if(e==null)return{};var r,n,a=jI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gn=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=wI(e,bI);return se.createElement("svg",Jp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-plus",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});gn.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var NI=["color","size","title","className"];function Qp(){return Qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qp.apply(null,arguments)}function EI(e,t){if(e==null)return{};var r,n,a=_I(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _I(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var jS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=EI(e,NI);return se.createElement("svg",Qp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-printer",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),se.createElement("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"}))});jS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var SI=["color","size","title","className"];function ev(){return ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ev.apply(null,arguments)}function TI(e,t){if(e==null)return{};var r,n,a=AI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wa=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TI(e,SI);return se.createElement("svg",ev({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-save",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});wa.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var kI=["color","size","title","className"];function tv(){return tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tv.apply(null,arguments)}function OI(e,t){if(e==null)return{};var r,n,a=CI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Dg=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=OI(e,kI);return se.createElement("svg",tv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-search",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});Dg.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var PI=["color","size","title","className"];function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rv.apply(null,arguments)}function DI(e,t){if(e==null)return{};var r,n,a=II(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function II(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var NS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=DI(e,PI);return se.createElement("svg",rv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-send",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});NS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var RI=["color","size","title","className"];function nv(){return nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nv.apply(null,arguments)}function FI(e,t){if(e==null)return{};var r,n,a=LI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function LI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ES=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=FI(e,RI);return se.createElement("svg",nv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-shield-x",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),se.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});ES.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var MI=["color","size","title","className"];function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},av.apply(null,arguments)}function BI(e,t){if(e==null)return{};var r,n,a=$I(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $I(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ig=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=BI(e,MI);return se.createElement("svg",av({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-shield",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});Ig.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var zI=["color","size","title","className"];function sv(){return sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sv.apply(null,arguments)}function UI(e,t){if(e==null)return{};var r,n,a=qI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _S=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=UI(e,zI);return se.createElement("svg",sv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-slash-circle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),se.createElement("path",{d:"M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708"}))});_S.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var WI=["color","size","title","className"];function iv(){return iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iv.apply(null,arguments)}function HI(e,t){if(e==null)return{};var r,n,a=VI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SS=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HI(e,WI);return se.createElement("svg",iv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-square",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});SS.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var GI=["color","size","title","className"];function ov(){return ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ov.apply(null,arguments)}function KI(e,t){if(e==null)return{};var r,n,a=YI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ln=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=KI(e,GI);return se.createElement("svg",ov({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-three-dots-vertical",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});ln.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var XI=["color","size","title","className"];function lv(){return lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lv.apply(null,arguments)}function ZI(e,t){if(e==null)return{};var r,n,a=JI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Oi=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ZI(e,XI);return se.createElement("svg",lv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-trash",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),se.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Oi.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var QI=["color","size","title","className"];function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cv.apply(null,arguments)}function e6(e,t){if(e==null)return{};var r,n,a=t6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function t6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Dn=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=e6(e,QI);return se.createElement("svg",cv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-upload",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),se.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Dn.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var r6=["color","size","title","className"];function uv(){return uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uv.apply(null,arguments)}function n6(e,t){if(e==null)return{};var r,n,a=a6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function a6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var za=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=n6(e,r6);return se.createElement("svg",uv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-x-circle",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),se.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});za.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};var s6=["color","size","title","className"];function dv(){return dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dv.apply(null,arguments)}function i6(e,t){if(e==null)return{};var r,n,a=o6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function o6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ye=_.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,s=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=i6(e,s6);return se.createElement("svg",dv({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:s,height:s,fill:n,className:["bi","bi-x",d].filter(Boolean).join(" ")},u),l?se.createElement("title",null,l):null,se.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Ye.propTypes={color:K.string,size:K.oneOfType([K.string,K.number]),title:K.string,className:K.string};const l6="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function TS(e,t){return function(){return e.apply(t,arguments)}}const{toString:c6}=Object.prototype,{getPrototypeOf:Rg}=Object,{iterator:xd,toStringTag:AS}=Symbol,yd=(e=>t=>{const r=c6.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ja=e=>(e=e.toLowerCase(),t=>yd(t)===e),bd=e=>t=>typeof t===e,{isArray:wo}=Array,ro=bd("undefined");function Kl(e){return e!==null&&!ro(e)&&e.constructor!==null&&!ro(e.constructor)&&hn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const kS=ja("ArrayBuffer");function u6(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&kS(e.buffer),t}const d6=bd("string"),hn=bd("function"),OS=bd("number"),Yl=e=>e!==null&&typeof e=="object",f6=e=>e===!0||e===!1,ou=e=>{if(yd(e)!=="object")return!1;const t=Rg(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(AS in e)&&!(xd in e)},h6=e=>{if(!Yl(e)||Kl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},m6=ja("Date"),p6=ja("File"),v6=ja("Blob"),g6=ja("FileList"),x6=e=>Yl(e)&&hn(e.pipe),y6=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||hn(e.append)&&((t=yd(e))==="formdata"||t==="object"&&hn(e.toString)&&e.toString()==="[object FormData]"))},b6=ja("URLSearchParams"),[w6,j6,N6,E6]=["ReadableStream","Request","Response","Headers"].map(ja),_6=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xl(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),wo(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Kl(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function CS(e,t){if(Kl(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Js=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,PS=e=>!ro(e)&&e!==Js;function fv(){const{caseless:e,skipUndefined:t}=PS(this)&&this||{},r={},n=(a,s)=>{const o=e&&CS(r,s)||s;ou(r[o])&&ou(a)?r[o]=fv(r[o],a):ou(a)?r[o]=fv({},a):wo(a)?r[o]=a.slice():(!t||!ro(a))&&(r[o]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&Xl(arguments[a],n);return r}const S6=(e,t,r,{allOwnKeys:n}={})=>(Xl(t,(a,s)=>{r&&hn(a)?e[s]=TS(a,r):e[s]=a},{allOwnKeys:n}),e),T6=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),A6=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},k6=(e,t,r,n)=>{let a,s,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)o=a[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Rg(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},O6=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},C6=e=>{if(!e)return null;if(wo(e))return e;let t=e.length;if(!OS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},P6=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Rg(Uint8Array)),D6=(e,t)=>{const n=(e&&e[xd]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},I6=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},R6=ja("HTMLFormElement"),F6=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),By=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),L6=ja("RegExp"),DS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Xl(r,(a,s)=>{let o;(o=t(a,s,e))!==!1&&(n[s]=o||a)}),Object.defineProperties(e,n)},M6=e=>{DS(e,(t,r)=>{if(hn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(hn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},B6=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return wo(e)?n(e):n(String(e).split(t)),r},$6=()=>{},z6=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function U6(e){return!!(e&&hn(e.append)&&e[AS]==="FormData"&&e[xd])}const q6=e=>{const t=new Array(10),r=(n,a)=>{if(Yl(n)){if(t.indexOf(n)>=0)return;if(Kl(n))return n;if(!("toJSON"in n)){t[a]=n;const s=wo(n)?[]:{};return Xl(n,(o,l)=>{const c=r(o,a+1);!ro(c)&&(s[l]=c)}),t[a]=void 0,s}}return n};return r(e,0)},W6=ja("AsyncFunction"),H6=e=>e&&(Yl(e)||hn(e))&&hn(e.then)&&hn(e.catch),IS=((e,t)=>e?setImmediate:t?((r,n)=>(Js.addEventListener("message",({source:a,data:s})=>{a===Js&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Js.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",hn(Js.postMessage)),V6=typeof queueMicrotask<"u"?queueMicrotask.bind(Js):typeof process<"u"&&process.nextTick||IS,G6=e=>e!=null&&hn(e[xd]),xe={isArray:wo,isArrayBuffer:kS,isBuffer:Kl,isFormData:y6,isArrayBufferView:u6,isString:d6,isNumber:OS,isBoolean:f6,isObject:Yl,isPlainObject:ou,isEmptyObject:h6,isReadableStream:w6,isRequest:j6,isResponse:N6,isHeaders:E6,isUndefined:ro,isDate:m6,isFile:p6,isBlob:v6,isRegExp:L6,isFunction:hn,isStream:x6,isURLSearchParams:b6,isTypedArray:P6,isFileList:g6,forEach:Xl,merge:fv,extend:S6,trim:_6,stripBOM:T6,inherits:A6,toFlatObject:k6,kindOf:yd,kindOfTest:ja,endsWith:O6,toArray:C6,forEachEntry:D6,matchAll:I6,isHTMLForm:R6,hasOwnProperty:By,hasOwnProp:By,reduceDescriptors:DS,freezeMethods:M6,toObjectSet:B6,toCamelCase:F6,noop:$6,toFiniteNumber:z6,findKey:CS,global:Js,isContextDefined:PS,isSpecCompliantForm:U6,toJSONObject:q6,isAsyncFn:W6,isThenable:H6,setImmediate:IS,asap:V6,isIterable:G6};function nt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}xe.inherits(nt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:xe.toJSONObject(this.config),code:this.code,status:this.status}}});const RS=nt.prototype,FS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{FS[e]={value:e}});Object.defineProperties(nt,FS);Object.defineProperty(RS,"isAxiosError",{value:!0});nt.from=(e,t,r,n,a,s)=>{const o=Object.create(RS);xe.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return nt.call(o,l,c,r,n,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const K6=null;function hv(e){return xe.isPlainObject(e)||xe.isArray(e)}function LS(e){return xe.endsWith(e,"[]")?e.slice(0,-2):e}function $y(e,t,r){return e?e.concat(t).map(function(a,s){return a=LS(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function Y6(e){return xe.isArray(e)&&!e.some(hv)}const X6=xe.toFlatObject(xe,{},null,function(t){return/^is[A-Z]/.test(t)});function wd(e,t,r){if(!xe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,g){return!xe.isUndefined(g[v])});const n=r.metaTokens,a=r.visitor||u,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&xe.isSpecCompliantForm(t);if(!xe.isFunction(a))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(xe.isDate(p))return p.toISOString();if(xe.isBoolean(p))return p.toString();if(!c&&xe.isBlob(p))throw new nt("Blob is not supported. Use a Buffer instead.");return xe.isArrayBuffer(p)||xe.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,v,g){let x=p;if(p&&!g&&typeof p=="object"){if(xe.endsWith(v,"{}"))v=n?v:v.slice(0,-2),p=JSON.stringify(p);else if(xe.isArray(p)&&Y6(p)||(xe.isFileList(p)||xe.endsWith(v,"[]"))&&(x=xe.toArray(p)))return v=LS(v),x.forEach(function(y,w){!(xe.isUndefined(y)||y===null)&&t.append(o===!0?$y([v],w,s):o===null?v:v+"[]",d(y))}),!1}return hv(p)?!0:(t.append($y(g,v,s),d(p)),!1)}const f=[],h=Object.assign(X6,{defaultVisitor:u,convertValue:d,isVisitable:hv});function m(p,v){if(!xe.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(p),xe.forEach(p,function(x,b){(!(xe.isUndefined(x)||x===null)&&a.call(t,x,xe.isString(b)?b.trim():b,v,h))===!0&&m(x,v?v.concat(b):[b])}),f.pop()}}if(!xe.isObject(e))throw new TypeError("data must be an object");return m(e),t}function zy(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Fg(e,t){this._pairs=[],e&&wd(e,this,t)}const MS=Fg.prototype;MS.append=function(t,r){this._pairs.push([t,r])};MS.toString=function(t){const r=t?function(n){return t.call(this,n,zy)}:zy;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Z6(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function BS(e,t,r){if(!t)return e;const n=r&&r.encode||Z6;xe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=xe.isURLSearchParams(t)?t.toString():new Fg(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Uy{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){xe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const $S={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},J6=typeof URLSearchParams<"u"?URLSearchParams:Fg,Q6=typeof FormData<"u"?FormData:null,eR=typeof Blob<"u"?Blob:null,tR={isBrowser:!0,classes:{URLSearchParams:J6,FormData:Q6,Blob:eR},protocols:["http","https","file","blob","url","data"]},Lg=typeof window<"u"&&typeof document<"u",mv=typeof navigator=="object"&&navigator||void 0,rR=Lg&&(!mv||["ReactNative","NativeScript","NS"].indexOf(mv.product)<0),nR=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",aR=Lg&&window.location.href||"http://localhost",sR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Lg,hasStandardBrowserEnv:rR,hasStandardBrowserWebWorkerEnv:nR,navigator:mv,origin:aR},Symbol.toStringTag,{value:"Module"})),Hr={...sR,...tR};function iR(e,t){return wd(e,new Hr.classes.URLSearchParams,{visitor:function(r,n,a,s){return Hr.isNode&&xe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function oR(e){return xe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function lR(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function zS(e){function t(r,n,a,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&xe.isArray(a)?a.length:o,c?(xe.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!xe.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],s)&&xe.isArray(a[o])&&(a[o]=lR(a[o])),!l)}if(xe.isFormData(e)&&xe.isFunction(e.entries)){const r={};return xe.forEachEntry(e,(n,a)=>{t(oR(n),a,r,0)}),r}return null}function cR(e,t,r){if(xe.isString(e))try{return(t||JSON.parse)(e),xe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Zl={transitional:$S,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=xe.isObject(t);if(s&&xe.isHTMLForm(t)&&(t=new FormData(t)),xe.isFormData(t))return a?JSON.stringify(zS(t)):t;if(xe.isArrayBuffer(t)||xe.isBuffer(t)||xe.isStream(t)||xe.isFile(t)||xe.isBlob(t)||xe.isReadableStream(t))return t;if(xe.isArrayBufferView(t))return t.buffer;if(xe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return iR(t,this.formSerializer).toString();if((l=xe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return wd(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),cR(t)):t}],transformResponse:[function(t){const r=this.transitional||Zl.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(xe.isResponse(t)||xe.isReadableStream(t))return t;if(t&&xe.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?nt.from(l,nt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Hr.classes.FormData,Blob:Hr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};xe.forEach(["delete","get","head","post","put","patch"],e=>{Zl.headers[e]={}});const uR=xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dR=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&uR[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},qy=Symbol("internals");function zo(e){return e&&String(e).trim().toLowerCase()}function lu(e){return e===!1||e==null?e:xe.isArray(e)?e.map(lu):String(e)}function fR(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const hR=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function _f(e,t,r,n,a){if(xe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!xe.isString(t)){if(xe.isString(n))return t.indexOf(n)!==-1;if(xe.isRegExp(n))return n.test(t)}}function mR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function pR(e,t){const r=xe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,o){return this[n].call(this,t,a,s,o)},configurable:!0})})}let mn=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(l,c,d){const u=zo(c);if(!u)throw new Error("header name must be a non-empty string");const f=xe.findKey(a,u);(!f||a[f]===void 0||d===!0||d===void 0&&a[f]!==!1)&&(a[f||c]=lu(l))}const o=(l,c)=>xe.forEach(l,(d,u)=>s(d,u,c));if(xe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(xe.isString(t)&&(t=t.trim())&&!hR(t))o(dR(t),r);else if(xe.isObject(t)&&xe.isIterable(t)){let l={},c,d;for(const u of t){if(!xe.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?xe.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=zo(t),t){const n=xe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return fR(a);if(xe.isFunction(r))return r.call(this,a,n);if(xe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zo(t),t){const n=xe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||_f(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(o){if(o=zo(o),o){const l=xe.findKey(n,o);l&&(!r||_f(n,n[l],l,r))&&(delete n[l],a=!0)}}return xe.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||_f(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return xe.forEach(this,(a,s)=>{const o=xe.findKey(n,s);if(o){r[o]=lu(a),delete r[s];return}const l=t?mR(s):String(s).trim();l!==s&&delete r[s],r[l]=lu(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return xe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&xe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[qy]=this[qy]={accessors:{}}).accessors,a=this.prototype;function s(o){const l=zo(o);n[l]||(pR(a,o),n[l]=!0)}return xe.isArray(t)?t.forEach(s):s(t),this}};mn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);xe.reduceDescriptors(mn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});xe.freezeMethods(mn);function Sf(e,t){const r=this||Zl,n=t||r,a=mn.from(n.headers);let s=n.data;return xe.forEach(e,function(l){s=l.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function US(e){return!!(e&&e.__CANCEL__)}function jo(e,t,r){nt.call(this,e??"canceled",nt.ERR_CANCELED,t,r),this.name="CanceledError"}xe.inherits(jo,nt,{__CANCEL__:!0});function qS(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new nt("Request failed with status code "+r.status,[nt.ERR_BAD_REQUEST,nt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function vR(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function gR(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[s];o||(o=d),r[a]=c,n[a]=d;let f=s,h=0;for(;f!==a;)h+=r[f++],f=f%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),d-o<t)return;const m=u&&d-u;return m?Math.round(h*1e3/m):void 0}}function xR(e,t){let r=0,n=1e3/t,a,s;const o=(d,u=Date.now())=>{r=u,a=null,s&&(clearTimeout(s),s=null),e(...d)};return[(...d)=>{const u=Date.now(),f=u-r;f>=n?o(d,u):(a=d,s||(s=setTimeout(()=>{s=null,o(a)},n-f)))},()=>a&&o(a)]}const pu=(e,t,r=3)=>{let n=0;const a=gR(50,250);return xR(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,d=a(c),u=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},Wy=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Hy=e=>(...t)=>xe.asap(()=>e(...t)),yR=Hr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Hr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Hr.origin),Hr.navigator&&/(msie|trident)/i.test(Hr.navigator.userAgent)):()=>!0,bR=Hr.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const o=[e+"="+encodeURIComponent(t)];xe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),xe.isString(n)&&o.push("path="+n),xe.isString(a)&&o.push("domain="+a),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function wR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function jR(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function WS(e,t,r){let n=!wR(t);return e&&(n||r==!1)?jR(e,t):t}const Vy=e=>e instanceof mn?{...e}:e;function vi(e,t){t=t||{};const r={};function n(d,u,f,h){return xe.isPlainObject(d)&&xe.isPlainObject(u)?xe.merge.call({caseless:h},d,u):xe.isPlainObject(u)?xe.merge({},u):xe.isArray(u)?u.slice():u}function a(d,u,f,h){if(xe.isUndefined(u)){if(!xe.isUndefined(d))return n(void 0,d,f,h)}else return n(d,u,f,h)}function s(d,u){if(!xe.isUndefined(u))return n(void 0,u)}function o(d,u){if(xe.isUndefined(u)){if(!xe.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,f){if(f in t)return n(d,u);if(f in e)return n(void 0,d)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,f)=>a(Vy(d),Vy(u),f,!0)};return xe.forEach(Object.keys({...e,...t}),function(u){const f=c[u]||a,h=f(e[u],t[u],u);xe.isUndefined(h)&&f!==l||(r[u]=h)}),r}const HS=e=>{const t=vi({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=mn.from(o),t.url=BS(WS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),xe.isFormData(r)){if(Hr.hasStandardBrowserEnv||Hr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(xe.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,f])=>{d.includes(u.toLowerCase())&&o.set(u,f)})}}if(Hr.hasStandardBrowserEnv&&(n&&xe.isFunction(n)&&(n=n(t)),n||n!==!1&&yR(t.url))){const c=a&&s&&bR.read(s);c&&o.set(a,c)}return t},NR=typeof XMLHttpRequest<"u",ER=NR&&function(e){return new Promise(function(r,n){const a=HS(e);let s=a.data;const o=mn.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,f,h,m,p;function v(){m&&m(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function x(){if(!g)return;const y=mn.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};qS(function(E){r(E),v()},function(E){n(E),v()},j),g=null}"onloadend"in g?g.onloadend=x:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(x)},g.onabort=function(){g&&(n(new nt("Request aborted",nt.ECONNABORTED,e,g)),g=null)},g.onerror=function(w){const j=w&&w.message?w.message:"Network Error",N=new nt(j,nt.ERR_NETWORK,e,g);N.event=w||null,n(N),g=null},g.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const j=a.transitional||$S;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new nt(w,j.clarifyTimeoutError?nt.ETIMEDOUT:nt.ECONNABORTED,e,g)),g=null},s===void 0&&o.setContentType(null),"setRequestHeader"in g&&xe.forEach(o.toJSON(),function(w,j){g.setRequestHeader(j,w)}),xe.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),l&&l!=="json"&&(g.responseType=a.responseType),d&&([h,p]=pu(d,!0),g.addEventListener("progress",h)),c&&g.upload&&([f,m]=pu(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",m)),(a.cancelToken||a.signal)&&(u=y=>{g&&(n(!y||y.type?new jo(null,e,g):y),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const b=vR(a.url);if(b&&Hr.protocols.indexOf(b)===-1){n(new nt("Unsupported protocol "+b+":",nt.ERR_BAD_REQUEST,e));return}g.send(s||null)})},_R=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof nt?u:new jo(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,s(new nt(`timeout ${t} of ms exceeded`,nt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>xe.asap(l),c}},SR=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},TR=async function*(e,t){for await(const r of AR(e))yield*SR(r,t)},AR=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Gy=(e,t,r,n)=>{const a=TR(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let f=u.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},Ky=64*1024,{isFunction:Cc}=xe,kR=(({Request:e,Response:t})=>({Request:e,Response:t}))(xe.global),{ReadableStream:Yy,TextEncoder:Xy}=xe.global,Zy=(e,...t)=>{try{return!!e(...t)}catch{return!1}},OR=e=>{e=xe.merge.call({skipUndefined:!0},kR,e);const{fetch:t,Request:r,Response:n}=e,a=t?Cc(t):typeof fetch=="function",s=Cc(r),o=Cc(n);if(!a)return!1;const l=a&&Cc(Yy),c=a&&(typeof Xy=="function"?(p=>v=>p.encode(v))(new Xy):async p=>new Uint8Array(await new r(p).arrayBuffer())),d=s&&l&&Zy(()=>{let p=!1;const v=new r(Hr.origin,{body:new Yy,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!v}),u=o&&l&&Zy(()=>xe.isReadableStream(new n("").body)),f={stream:u&&(p=>p.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!f[p]&&(f[p]=(v,g)=>{let x=v&&v[p];if(x)return x.call(v);throw new nt(`Response type '${p}' is not supported`,nt.ERR_NOT_SUPPORT,g)})});const h=async p=>{if(p==null)return 0;if(xe.isBlob(p))return p.size;if(xe.isSpecCompliantForm(p))return(await new r(Hr.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(xe.isArrayBufferView(p)||xe.isArrayBuffer(p))return p.byteLength;if(xe.isURLSearchParams(p)&&(p=p+""),xe.isString(p))return(await c(p)).byteLength},m=async(p,v)=>{const g=xe.toFiniteNumber(p.getContentLength());return g??h(v)};return async p=>{let{url:v,method:g,data:x,signal:b,cancelToken:y,timeout:w,onDownloadProgress:j,onUploadProgress:N,responseType:E,headers:S,withCredentials:O="same-origin",fetchOptions:k}=HS(p),T=t||fetch;E=E?(E+"").toLowerCase():"text";let A=_R([b,y&&y.toAbortSignal()],w),P=null;const C=A&&A.unsubscribe&&(()=>{A.unsubscribe()});let F;try{if(N&&d&&g!=="get"&&g!=="head"&&(F=await m(S,x))!==0){let z=new r(v,{method:"POST",body:x,duplex:"half"}),D;if(xe.isFormData(x)&&(D=z.headers.get("content-type"))&&S.setContentType(D),z.body){const[L,q]=Wy(F,pu(Hy(N)));x=Gy(z.body,Ky,L,q)}}xe.isString(O)||(O=O?"include":"omit");const M=s&&"credentials"in r.prototype,H={...k,signal:A,method:g.toUpperCase(),headers:S.normalize().toJSON(),body:x,duplex:"half",credentials:M?O:void 0};P=s&&new r(v,H);let V=await(s?T(P,k):T(v,H));const B=u&&(E==="stream"||E==="response");if(u&&(j||B&&C)){const z={};["status","statusText","headers"].forEach(I=>{z[I]=V[I]});const D=xe.toFiniteNumber(V.headers.get("content-length")),[L,q]=j&&Wy(D,pu(Hy(j),!0))||[];V=new n(Gy(V.body,Ky,L,()=>{q&&q(),C&&C()}),z)}E=E||"text";let W=await f[xe.findKey(f,E)||"text"](V,p);return!B&&C&&C(),await new Promise((z,D)=>{qS(z,D,{data:W,headers:mn.from(V.headers),status:V.status,statusText:V.statusText,config:p,request:P})})}catch(M){throw C&&C(),M&&M.name==="TypeError"&&/Load failed|fetch/i.test(M.message)?Object.assign(new nt("Network Error",nt.ERR_NETWORK,p,P),{cause:M.cause||M}):nt.from(M,M&&M.code,p,P)}}},CR=new Map,VS=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let o=s.length,l=o,c,d,u=CR;for(;l--;)c=s[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:OR(t)),u=d;return d};VS();const pv={http:K6,xhr:ER,fetch:{get:VS}};xe.forEach(pv,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Jy=e=>`- ${e}`,PR=e=>xe.isFunction(e)||e===null||e===!1,GS={getAdapter:(e,t)=>{e=xe.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(a=n,!PR(n)&&(a=pv[(l=String(n)).toLowerCase()],a===void 0))throw new nt(`Unknown adapter '${l}'`);if(a&&(xe.isFunction(a)||(a=a.get(t))))break;s[l||"#"+o]=a}if(!a){const o=Object.entries(s).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(Jy).join(`
`):" "+Jy(o[0]):"as no adapter specified";throw new nt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a},adapters:pv};function Tf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new jo(null,e)}function Qy(e){return Tf(e),e.headers=mn.from(e.headers),e.data=Sf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),GS.getAdapter(e.adapter||Zl.adapter,e)(e).then(function(n){return Tf(e),n.data=Sf.call(e,e.transformResponse,n),n.headers=mn.from(n.headers),n},function(n){return US(n)||(Tf(e),n&&n.response&&(n.response.data=Sf.call(e,e.transformResponse,n.response),n.response.headers=mn.from(n.response.headers))),Promise.reject(n)})}const KS="1.12.2",jd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{jd[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const eb={};jd.transitional=function(t,r,n){function a(s,o){return"[Axios v"+KS+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new nt(a(o," has been removed"+(r?" in "+r:"")),nt.ERR_DEPRECATED);return r&&!eb[o]&&(eb[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};jd.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function DR(e,t,r){if(typeof e!="object")throw new nt("options must be an object",nt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new nt("option "+s+" must be "+c,nt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new nt("Unknown option "+s,nt.ERR_BAD_OPTION)}}const cu={assertOptions:DR,validators:jd},_a=cu.validators;let ai=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Uy,response:new Uy}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=vi(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&cu.assertOptions(n,{silentJSONParsing:_a.transitional(_a.boolean),forcedJSONParsing:_a.transitional(_a.boolean),clarifyTimeoutError:_a.transitional(_a.boolean)},!1),a!=null&&(xe.isFunction(a)?r.paramsSerializer={serialize:a}:cu.assertOptions(a,{encode:_a.function,serialize:_a.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),cu.assertOptions(r,{baseUrl:_a.spelling("baseURL"),withXsrfToken:_a.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&xe.merge(s.common,s[r.method]);s&&xe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete s[p]}),r.headers=mn.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(c=c&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const d=[];this.interceptors.response.forEach(function(v){d.push(v.fulfilled,v.rejected)});let u,f=0,h;if(!c){const p=[Qy.bind(this),void 0];for(p.unshift(...l),p.push(...d),h=p.length,u=Promise.resolve(r);f<h;)u=u.then(p[f++],p[f++]);return u}h=l.length;let m=r;for(;f<h;){const p=l[f++],v=l[f++];try{m=p(m)}catch(g){v.call(this,g);break}}try{u=Qy.call(this,m)}catch(p){return Promise.reject(p)}for(f=0,h=d.length;f<h;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=vi(this.defaults,t);const r=WS(t.baseURL,t.url,t.allowAbsoluteUrls);return BS(r,t.params,t.paramsSerializer)}};xe.forEach(["delete","get","head","options"],function(t){ai.prototype[t]=function(r,n){return this.request(vi(n||{},{method:t,url:r,data:(n||{}).data}))}});xe.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(vi(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}ai.prototype[t]=r(),ai.prototype[t+"Form"]=r(!0)});let IR=class YS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(a);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new jo(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new YS(function(a){t=a}),cancel:t}}};function RR(e){return function(r){return e.apply(null,r)}}function FR(e){return xe.isObject(e)&&e.isAxiosError===!0}const vv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vv).forEach(([e,t])=>{vv[t]=e});function XS(e){const t=new ai(e),r=TS(ai.prototype.request,t);return xe.extend(r,ai.prototype,t,{allOwnKeys:!0}),xe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return XS(vi(e,a))},r}const qt=XS(Zl);qt.Axios=ai;qt.CanceledError=jo;qt.CancelToken=IR;qt.isCancel=US;qt.VERSION=KS;qt.toFormData=wd;qt.AxiosError=nt;qt.Cancel=qt.CanceledError;qt.all=function(t){return Promise.all(t)};qt.spread=RR;qt.isAxiosError=FR;qt.mergeConfig=vi;qt.AxiosHeaders=mn;qt.formToJSON=e=>zS(xe.isHTMLForm(e)?new FormData(e):e);qt.getAdapter=GS.getAdapter;qt.HttpStatusCode=vv;qt.default=qt;const{Axios:Ufe,AxiosError:qfe,CanceledError:Wfe,isCancel:Hfe,CancelToken:Vfe,VERSION:Gfe,all:Kfe,Cancel:Yfe,isAxiosError:Xfe,spread:Zfe,toFormData:Jfe,AxiosHeaders:Qfe,HttpStatusCode:ehe,formToJSON:the,getAdapter:rhe,mergeConfig:nhe}=qt,vu={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},Mg=()=>"/dsfms-template/",LR=(e="/")=>{const r=`${Mg()}${e}`;window.location.href=r},Af=()=>{LR("/")},ZS="https://dsfms.id.vn",Ie=qt.create({baseURL:ZS,timeout:1e4,headers:{"Content-Type":"application/json"}});let kf=!1,gv=[],Pc=0;const tb=2,JS=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},MR=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},rb=(e,t=null)=>{gv.forEach(r=>{e?r.reject(e):r.resolve(t)}),gv=[]};Ie.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(JS(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):MR(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Ie.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&Pc<tb){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),kf)return new Promise((a,s)=>{gv.push({resolve:a,reject:s})}).then(a=>(t.headers.Authorization=`Bearer ${a}`,Ie(t))).catch(a=>Promise.reject(a));t._retry=!0,kf=!0,Pc++;const n=localStorage.getItem("refreshToken");if(n)try{if(console.log(" Token ht hn (401), ang refresh token..."),JS(n))throw new Error("Refresh token is also expired");const a=await qt.post(`${ZS}/auth/refresh`,{refresh_token:n}),{access_token:s,refresh_token:o}=a.data;if(!s||!o)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",s),localStorage.setItem("refreshToken",o),Pc=0,console.log(" Refresh token thnh cng, retry request gc"),rb(null,s),t.headers.Authorization=`Bearer ${s}`,await Ie(t)}catch(a){return console.error(" Refresh token tht bi:",a),rb(a,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Af(),Promise.reject(a)}finally{kf=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Af()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);Pc>=tb&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Af())}return Promise.reject(e)});const Dc=qt.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),xs={login:async e=>{try{return(await Dc.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await Dc.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Ie.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await Dc.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await Dc.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(n){throw n.response?.data||n.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},Qr={getUsers:async(e={})=>{try{return(await Ie.get("/users",{params:e})).data}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{return(await Ie.get(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Ie.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Ie.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Ie.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Ie.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Ie.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{return(await Ie.get("/roles")).data}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Ie.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Ie.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Ie.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Ie.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Ie.get("/users",{params:{includeDeleted:!0,roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},En={getRoles:async(e={})=>{try{return(await Ie.get("/roles",{params:e})).data}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{return(await Ie.get(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{return(await Ie.post("/roles",e)).data}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Ie.put(`/roles/${e}`,t);return console.log(" API updateRole success:",r.data),r.data}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{return(await Ie.delete(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{return(await Ie.patch(`/roles/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{return(await Ie.patch(`/roles/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{return(await Ie.delete(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}}},gt={getDepartments:async(e={})=>{try{return(await Ie.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{return(await Ie.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department:",t),t}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Ie.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{return(await Ie.put(`/departments/${e}`,t)).data}catch(r){throw console.error("Error updating department:",r),r}},deleteDepartment:async e=>{try{return(await Ie.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Ie.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Ie.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Ie.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Ie.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Ie.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Ie.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Ie.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Ie.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},pn={getCourses:async(e={})=>{try{return(await Ie.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await Ie.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Ie.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Ie.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},deleteCourse:async e=>{try{return(await Ie.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},archiveCourse:async e=>{try{return(await Ie.post(`/courses/${e}/archive`)).data}catch(t){throw console.error("Error archiving course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Ie.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Ie.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{return(await Ie.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await Ie.get(`/courses/trainees/${e}/enrollments`)).data},no={getTrainees:async(e={})=>{try{return(await Ie.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Ie.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Ie.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Ie.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Ie.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Ie.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Ie.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Ie.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Ie.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Ie.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Ie.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Ie.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{return(await Ie.get("/users",{params:{includeDeleted:!0,roleName:"TRAINEE",...e}})).data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={trainees:e};console.log("Sending request with format:",t);const r=await Ie.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Ie.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},Pr={getSubjects:async(e={})=>{try{return(await Ie.get("/subjects",{params:e})).data}catch(t){throw console.error("Error fetching subjects:",t),t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;console.log(" API Call - URL:",r),console.log(" API Call - courseId:",e),console.log(" API Call - params:",t);try{const n=await Ie.get(r,{params:t});return console.log(" API Call - Response:",n),console.log(" API Call - Response data:",n.data),n.data}catch(n){throw console.error(" API Call - Error:",n),console.error(" API Call - Error response:",n.response),console.error(" API Call - Error status:",n.response?.status),console.error(" API Call - Error data:",n.response?.data),n}},getSubjectById:async e=>{try{return(await Ie.get(`/subjects/${e}`)).data}catch(t){throw console.error("Error fetching subject:",t),t}},createSubject:async e=>{try{return(await Ie.post("/subjects",e)).data}catch(t){throw console.error("Error creating subject:",t),t}},updateSubject:async(e,t)=>{try{return(await Ie.put(`/subjects/${e}`,t)).data}catch(r){throw console.error("Error updating subject:",r),r}},deleteSubject:async e=>{try{return(await Ie.delete(`/subjects/${e}`)).data}catch(t){throw console.error("Error deleting subject:",t),t}},bulkImportSubjects:async e=>{try{console.log(" Sending bulk import data to API:",e),console.log(" Data type check:",{isArray:Array.isArray(e),length:e.length,firstItem:e[0],firstItemKeys:Object.keys(e[0]||{}),firstItemTypes:Object.keys(e[0]||{}).reduce((a,s)=>(a[s]=typeof e[0][s],a),{})});const r={courseId:e[0]?.courseId,subjects:e.map(a=>{const{courseId:s,...o}=a;return o})};console.log(" Using working format:",r);const n=await Ie.post("/subjects/bulk",r);return console.log(" Bulk import API response:",n.data),n.data}catch(t){throw console.error(" Error bulk importing subjects:",t),console.error(" Error details:",t.response?.data),console.error(" Error status:",t.response?.status),console.error(" Error message:",t.response?.data?.message),console.error(" Validation errors:",t.response?.data?.errors),console.error(" Full error response:",JSON.stringify(t.response?.data,null,2)),t}},assignTrainees:async(e,t)=>{try{console.log(" Assigning trainees to subject:",e),console.log(" Trainee data being sent:",JSON.stringify(t,null,2)),console.log(" Data validation:",{subjectId:e,subjectIdType:typeof e,traineeDataKeys:Object.keys(t),enrolledCount:t.enrolledCount,enrolledArray:t.enrolled,enrolledLength:t.enrolled?.length,firstTrainee:t.enrolled?.[0],firstTraineeKeys:t.enrolled?.[0]?Object.keys(t.enrolled[0]):null});const r=await Ie.post(`/subjects/${e}/assign-trainees`,t);return console.log(" Assign trainees API response:",r.data),r.data}catch(r){throw console.error(" Error assigning trainees to subject:",r),console.error(" Error status:",r.response?.status),console.error(" Error details:",r.response?.data),console.error(" Error message:",r.response?.data?.message),console.error(" Validation errors:",r.response?.data?.errors),console.error(" Full error response:",JSON.stringify(r.response?.data,null,2)),r}},removeTraineeFromSubject:async(e,t,r)=>{try{console.log(" Removing trainee from subject:",{subjectId:e,traineeId:t,batchCode:r});const n={batchCode:r};console.log(" Request data:",JSON.stringify(n,null,2));const a=await Ie.delete(`/subjects/${e}/trainees/${t}`,{data:n});return console.log(" Remove trainee from subject API response:",a.data),a.data}catch(n){throw console.error(" Error removing trainee from subject:",n),console.error(" Error status:",n.response?.status),console.error(" Error details:",n.response?.data),console.error(" Error message:",n.response?.data?.message),n}},addTrainerToSubject:async(e,t)=>{try{const r={trainerUserId:t.trainer_user_id,roleInSubject:t.role_in_subject};return(await Ie.post(`/subjects/${e}/trainers`,r)).data}catch(r){throw r.response?.data||r.message}},getSubjectTrainers:async e=>{try{return(await Ie.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const n={roleInSubject:r.roleInSubject};return(await Ie.put(`/subjects/${e}/trainers/${t}`,n)).data}catch(n){throw n.response?.data||n.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Ie.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}}},Uo={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},ua=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return Uo[e]||e;if(e&&typeof e=="object"){const{message:r,errors:n}=e;let a=r;if(Array.isArray(r))if(r.length>0){const o=r[0];typeof o=="object"&&o!==null?a=o.message||o.field||"Validation failed":a=o}else a="Validation failed";const s=Uo[a]||a;if(n&&Array.isArray(n)&&n.length>0){const o=n.map(l=>{if(typeof l=="string"){const c=l.match(/(\w+)\s+(.+)/);if(c){const[,d,u]=c;return Uo[a]?.fields?.[d]||u}return l}else if(typeof l=="object"&&l!==null)return l.field&&l.message?Uo[a]?.fields?.[l.field]||l.message:l.property&&l.constraints?Uo[a]?.fields?.[l.property]||Object.values(l.constraints)[0]||l.property:JSON.stringify(l);return String(l)});return`${s}

Details:
${o.join(`
`)}`}return s}return e?.response?.data?ua(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},QS=_.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),BR=({children:e})=>{console.log(" AuthProvider initializing...");const[t,r]=_.useState(null),[n,a]=_.useState(null),[s,o]=_.useState([]),[l,c]=_.useState(!1),[d,u]=_.useState(!0);_.useEffect(()=>{(async()=>{try{const x=localStorage.getItem("authToken"),b=localStorage.getItem("user"),y=localStorage.getItem("refreshToken");if(x&&b&&y)try{const w=JSON.parse(atob(x.split(".")[1])),j=Date.now()/1e3;if(w.exp<j){console.log(" Token expired on initialization, attempting refresh...");try{const N=await xs.refreshToken(y);localStorage.setItem("authToken",N.access_token),localStorage.setItem("refreshToken",N.refresh_token);const E=JSON.parse(b);r(E),c(!0);try{const{role:S,permissions:O}=await f(E.role,E.roleId);if(S&&O)a(S),o(O);else throw new Error("Failed to fetch role and permissions")}catch(S){console.error("Failed to fetch role and permissions on initialization:",S),xs.logout(),r(null),a(null),o([]),c(!1)}console.log(" Token refreshed successfully on initialization")}catch(N){console.error(" Token refresh failed on initialization:",N),xs.logout(),r(null),a(null),o([]),c(!1)}}else{const N=JSON.parse(b);r(N),c(!0);try{const{role:E,permissions:S}=await f(N.role,N.roleId);if(E&&S)a(E),o(S);else throw new Error("Failed to fetch role and permissions")}catch(E){console.error("Failed to fetch role and permissions on initialization:",E),xs.logout(),r(null),a(null),o([]),c(!1)}console.log(" Valid token found on initialization")}}catch(w){console.error(" Error parsing token or user data:",w),xs.logout(),r(null),a(null),o([]),c(!1)}else r(null),a(null),o([]),c(!1)}catch(x){console.error("Error accessing localStorage:",x),r(null),a(null),o([]),c(!1)}finally{u(!1)}})()},[]),_.useEffect(()=>{if(!l||d)return;const g=async()=>{const b=localStorage.getItem("authToken"),y=localStorage.getItem("refreshToken");if(!b||!y){console.log(" Missing token or refresh token, logging out"),p();return}try{const w=JSON.parse(atob(b.split(".")[1])),j=Date.now()/1e3,N=w.exp-j;console.log(` Token expires in ${Math.round(N/60)} minutes`),N<300&&(console.log(" Token expires soon, refreshing..."),(await m()).success||(console.error(" Token refresh failed in validation"),p()))}catch(w){console.error(" Token validation failed:",w);try{console.log(" Token invalid, attempting refresh..."),(await m()).success||(console.error(" Token refresh failed after validation error"),p())}catch(j){console.error(" Token refresh failed:",j),p()}}},x=setTimeout(()=>{g();const b=setInterval(g,120*1e3);return()=>clearInterval(b)},500);return()=>clearTimeout(x)},[l,d]);const f=async(g,x)=>{try{if(console.log("Fetching role details for:",{roleName:g,roleId:x}),x)try{const b=await En.getRoleById(x);return console.log("Full role data with permissions:",b),a(b),o(b.permissions||[]),{role:b,permissions:b.permissions||[]}}catch(b){if(console.error("Error fetching role by ID:",b),b.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{const w=await Ie.get("/users/me");if(console.log("User profile with permissions:",w.data),w.data&&w.data.role&&w.data.role.permissions){const j={id:x,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:w.data.role.permissions};return a(j),o(j.permissions),{role:j,permissions:j.permissions}}}catch(w){console.error("Failed to get user profile:",w)}console.warn("Cannot fetch permissions, creating minimal role");const y={id:x,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return a(y),o([]),{role:y,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const b=await En.getRoles();console.log("Roles response:",b);const y=b.data||b;let w;if(y&&y.roles&&Array.isArray(y.roles))w=y.roles;else if(Array.isArray(y))w=y;else throw new Error("Invalid roles data structure");const j=w.find(N=>N.name===g);if(j){const N=await En.getRoleById(j.id);return a(N),o(N.permissions||[]),{role:N,permissions:N.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(b){throw console.error("Fallback method failed:",b),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(b){return console.error("Error fetching user role and permissions:",b),{role:null,permissions:[]}}},h=async g=>{try{u(!0);const x=await xs.login(g);localStorage.setItem("authToken",x.access_token),localStorage.setItem("refreshToken",x.refresh_token);let b;try{const j=JSON.parse(atob(x.access_token.split(".")[1]));if(console.log("Token payload:",j),!j.userId||!j.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");b={id:j.userId,email:g.email,fullName:j.fullName||j.name||"User",role:j.roleName,roleId:j.roleId,department:j.department||"IT",lastLogin:new Date().toISOString()}}catch(j){throw console.error("Error decoding token:",j),new Error("Invalid token format or missing required fields")}console.log("Login response:",x),console.log("User info created:",b),localStorage.setItem("user",JSON.stringify(b));const{role:y,permissions:w}=await f(b.role,b.roleId);if(!y||!w)throw new Error("Failed to fetch user role and permissions");return r(b),a(y),o(w),c(!0),console.log("Login successful:",{user:b,role:y,permissions:w}),console.log(" User permissions for RBAC check:",w.map(j=>({id:j.id,name:j.name,path:j.path,method:j.method}))),{success:!0,user:b,role:y,permissions:w}}catch(x){return{success:!1,error:ua(x)||"Login failed"}}finally{u(!1)}},m=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const x=await xs.refreshToken(g);return localStorage.setItem("authToken",x.access_token),localStorage.setItem("refreshToken",x.refresh_token),{success:!0,tokens:x}}catch(g){return console.error("Manual token refresh failed:",g),p(),{success:!1,error:g.message}}},p=()=>{xs.logout(),r(null),a(null),o([]),c(!1)},v={user:t,setUser:r,userRole:n,userPermissions:s,isAuthenticated:l,setIsAuthenticated:c,isLoading:d,login:h,logout:p,refreshToken:m,fetchUserRoleAndPermissions:f};console.log(" AuthProvider rendering with value:",{user:!!t,userRole:!!n,userPermissions:s.length,isAuthenticated:l,isLoading:d});try{return i.jsx(QS.Provider,{value:v,children:e})}catch(g){return console.error(" AuthProvider error:",g),i.jsxs("div",{style:{padding:"20px",color:"red"},children:[i.jsx("h3",{children:"Authentication Error"}),i.jsx("p",{children:"There was an error initializing the authentication system."}),i.jsxs("details",{children:[i.jsx("summary",{children:"Error Details"}),i.jsx("pre",{children:g.message})]})]})}},bn=()=>{const e=_.useContext(QS);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},nb=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],n=t[1],s=n.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",l={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return n.includes("forgot-password")?"Forgot Password":n.includes("reset-password")?"Reset Password":n.includes("enable")?`Enable ${s.charAt(0).toUpperCase()+s.slice(1)}`:n.includes("archive")?`Archive ${s.charAt(0).toUpperCase()+s.slice(1)}`:n.includes("restore")?`Restore ${s.charAt(0).toUpperCase()+s.slice(1)}`:n.includes("add-trainers")?"Add Trainers to Department":n.includes("remove-trainers")?"Remove Trainers from Department":n.includes("new-feature")?"Create New Feature":n.includes("bulk-import")?"Bulk Import Data":n.includes("export-report")?"Export Report":$R(l,s,n)}return e},$R=(e,t,r)=>{if(r.includes("-")){const n=r.split("/").filter(o=>o&&!o.startsWith(":")),s=n[n.length-1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return`${e} ${s}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},Jl=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!1),[a,s]=_.useState(null),{userPermissions:o,userRole:l}=bn(),c=_.useCallback(async()=>{n(!0),s(null);try{o&&o.length>0?(t(o),console.log(" Using userPermissions from AuthContext:",o.length,"permissions")):(t([]),console.log(" No userPermissions available"))}catch(N){s(N),console.error("Error setting permissions from userPermissions:",N)}finally{n(!1)}},[o]),d=_.useCallback(()=>e.map(N=>({id:N.id,title:N.viewName||N.description||nb(N.name),description:N.description||"",module:N.module,method:N.method,path:N.path,isActive:N.isActive,viewName:N.viewName,viewModule:N.viewModule})),[e]),u=_.useCallback(()=>{const N=d(),E={};return N.forEach(S=>{const O=S.module,k=S.viewModule||`${S.module} Management`;E[O]||(E[O]={id:O,name:k,description:`Manage ${k.toLowerCase()} related permissions`,permissions:[]}),E[O].permissions.push({id:S.id,title:S.title,description:S.description,isActive:S.isActive,method:S.method,path:S.path})}),Object.values(E).sort((S,O)=>S.name.localeCompare(O.name))},[d]),f=_.useCallback(N=>{const E=e.find(S=>S.id===N);return E?E.isActive==="ACTIVE":!0},[e]),h=_.useCallback(N=>e.find(E=>E.id===N),[e]),m=_.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.name)),[o]),p=_.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.path)),[o]),v=_.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.id)),[o]),g=_.useCallback(N=>{if(!o||o.length===0)return console.log(" hasPermission: No user permissions available"),!1;const E=m.has(N),S=p.has(N),O=v.has(N),k=E||S||O;return(N==="PUT /roles/:roleId"||N.includes("roles"))&&console.log(" hasPermission check for role update:",{permissionName:N,hasName:E,hasPath:S,hasId:O,result:k,userPermissionNames:Array.from(m),userPermissionPaths:Array.from(p),userPermissionIds:Array.from(v)}),k},[o,m,p,v]),x=_.useCallback(N=>!o||o.length===0?!1:N.some(E=>g(E)),[o,g]),b=_.useCallback(N=>!o||o.length===0?!1:N.every(E=>g(E)),[o,g]),y=_.useCallback(N=>!o||o.length===0?!1:o.some(E=>E.module===N),[o]),w=_.useCallback(()=>!o||o.length===0?[]:[...new Set(o.map(E=>E.module))],[o]),j=_.useCallback(()=>{if(!o||o.length===0)return[];const N=o.map(S=>({id:S.id,title:S.viewName||S.description||nb(S.name),description:S.description||"",module:S.module,method:S.method,path:S.path,isActive:S.isActive,viewName:S.viewName,viewModule:S.viewModule})),E={};return N.forEach(S=>{const O=S.module,k=S.viewModule||`${S.module} Management`;E[O]||(E[O]={id:O,name:k,description:`Manage ${k.toLowerCase()} related permissions`,permissions:[]}),E[O].permissions.push({id:S.id,title:S.title,description:S.description,isActive:S.isActive,method:S.method,path:S.path})}),Object.values(E).sort((S,O)=>S.name.localeCompare(O.name))},[o]);return _.useEffect(()=>{o&&o.length>0&&c()},[c,o]),{permissions:e,loading:r,error:a,fetchPermissions:c,getUIPermissions:d,getPermissionGroups:u,isPermissionActive:f,getApiPermission:h,hasPermission:g,hasAnyPermission:x,hasAllPermissions:b,hasModuleAccess:y,getAccessibleModules:w,getUserPermissionGroups:j,userPermissions:o,userRole:l}},Me={USERS:{CREATE:"POST /users",VIEW_ALL:"GET /users",VIEW_DETAIL:"GET /users/:userId",UPDATE:"PUT /users/:userId",BULK_CREATE:"POST /users/bulk"},ROLES:{CREATE:"POST /roles",VIEW_ALL:"GET /roles"},DEPARTMENTS:{CREATE:"POST /departments",VIEW_ALL:"GET /departments",VIEW_DETAIL:"GET /departments/:departmentId",REMOVE_TRAINERS:"PATCH /departments/:departmentId/remove-trainers"},COURSES:{CREATE:"POST /courses"},SUBJECTS:{VIEW_DETAIL:"GET /subjects/:id",UPDATE:"PUT /subjects/:id",DELETE:"DELETE /subjects/:id",REMOVE_INSTRUCTOR:"DELETE /subjects/:id/instructors"},TEMPLATES:{CREATE:"POST /templates",VIEW_ALL:"GET /templates"},PROFILES:{VIEW:"GET /profile"},GLOBAL_FIELDS:{VIEW_ALL:"GET /global-fields"},DASHBOARD:{VIEW:"GET /dashboard"},TRAINEES:{VIEW_ALL:"GET /trainees",VIEW_DETAIL:"GET /trainees/:id",UPDATE:"PUT /trainees/:id",DELETE:"DELETE /trainees/:id",VIEW_COURSES:"GET /trainees/:id/courses",VIEW_SUBJECTS:"GET /trainees/:id/subjects",VIEW_ASSESSMENTS:"GET /trainees/:id/assessments"}};function eT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=eT(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=eT(e))&&(n&&(n+=" "),n+=t);return n}function zR(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}zR(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ql=e=>typeof e=="number"&&!isNaN(e),gi=e=>typeof e=="string",Qa=e=>typeof e=="function",UR=e=>gi(e)||Ql(e),xv=e=>gi(e)||Qa(e)?e:null,qR=(e,t)=>e===!1||Ql(e)&&e>0?e:t,yv=e=>_.isValidElement(e)||gi(e)||Qa(e)||Ql(e);function WR(e,t,r=300){let{scrollHeight:n,style:a}=e;requestAnimationFrame(()=>{a.minHeight="initial",a.height=n+"px",a.transition=`all ${r}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,r)})})}function HR({enter:e,exit:t,appendPosition:r=!1,collapse:n=!0,collapseDuration:a=300}){return function({children:s,position:o,preventExitTransition:l,done:c,nodeRef:d,isIn:u,playToast:f}){let h=r?`${e}--${o}`:e,m=r?`${t}--${o}`:t,p=_.useRef(0);return _.useLayoutEffect(()=>{let v=d.current,g=h.split(" "),x=b=>{b.target===d.current&&(f(),v.removeEventListener("animationend",x),v.removeEventListener("animationcancel",x),p.current===0&&b.type!=="animationcancel"&&v.classList.remove(...g))};v.classList.add(...g),v.addEventListener("animationend",x),v.addEventListener("animationcancel",x)},[]),_.useEffect(()=>{let v=d.current,g=()=>{v.removeEventListener("animationend",g),n?WR(v,c,a):c()};u||(l?g():(p.current=1,v.className+=` ${m}`,v.addEventListener("animationend",g)))},[u]),se.createElement(se.Fragment,null,s)}}function ab(e,t){return{content:tT(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function tT(e,t,r=!1){return _.isValidElement(e)&&!gi(e.type)?_.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):Qa(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function VR({closeToast:e,theme:t,ariaLabel:r="close"}){return se.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:n=>{n.stopPropagation(),e(!0)},"aria-label":r},se.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},se.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function GR({delay:e,isRunning:t,closeToast:r,type:n="default",hide:a,className:s,controlledProgress:o,progress:l,rtl:c,isIn:d,theme:u}){let f=a||o&&l===0,h={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(h.transform=`scaleX(${l})`);let m=lt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),p=Qa(s)?s({rtl:c,type:n,defaultClassName:m}):lt(m,s),v={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return se.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},se.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${n}`}),se.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:p,style:h,...v}))}var KR=1,rT=()=>`${KR++}`;function YR(e,t,r){let n=1,a=0,s=[],o=[],l=t,c=new Map,d=new Set,u=b=>(d.add(b),()=>d.delete(b)),f=()=>{o=Array.from(c.values()),d.forEach(b=>b())},h=({containerId:b,toastId:y,updateId:w})=>{let j=b?b!==e:e!==1,N=c.has(y)&&w==null;return j||N},m=(b,y)=>{c.forEach(w=>{var j;(y==null||y===w.props.toastId)&&((j=w.toggle)==null||j.call(w,b))})},p=b=>{var y,w;(w=(y=b.props)==null?void 0:y.onClose)==null||w.call(y,b.removalReason),b.isActive=!1},v=b=>{if(b==null)c.forEach(p);else{let y=c.get(b);y&&p(y)}f()},g=()=>{a-=s.length,s=[]},x=b=>{var y,w;let{toastId:j,updateId:N}=b.props,E=N==null;b.staleId&&c.delete(b.staleId),b.isActive=!0,c.set(j,b),f(),r(ab(b,E?"added":"updated")),E&&((w=(y=b.props).onOpen)==null||w.call(y))};return{id:e,props:l,observe:u,toggle:m,removeToast:v,toasts:c,clearQueue:g,buildToast:(b,y)=>{if(h(y))return;let{toastId:w,updateId:j,data:N,staleId:E,delay:S}=y,O=j==null;O&&a++;let k={...l,style:l.toastStyle,key:n++,...Object.fromEntries(Object.entries(y).filter(([A,P])=>P!=null)),toastId:w,updateId:j,data:N,isIn:!1,className:xv(y.className||l.toastClassName),progressClassName:xv(y.progressClassName||l.progressClassName),autoClose:y.isLoading?!1:qR(y.autoClose,l.autoClose),closeToast(A){c.get(w).removalReason=A,v(w)},deleteToast(){let A=c.get(w);if(A!=null){if(r(ab(A,"removed")),c.delete(w),a--,a<0&&(a=0),s.length>0){x(s.shift());return}f()}}};k.closeButton=l.closeButton,y.closeButton===!1||yv(y.closeButton)?k.closeButton=y.closeButton:y.closeButton===!0&&(k.closeButton=yv(l.closeButton)?l.closeButton:!0);let T={content:b,props:k,staleId:E};l.limit&&l.limit>0&&a>l.limit&&O?s.push(T):Ql(S)?setTimeout(()=>{x(T)},S):x(T)},setProps(b){l=b},setToggle:(b,y)=>{let w=c.get(b);w&&(w.toggle=y)},isToastActive:b=>{var y;return(y=c.get(b))==null?void 0:y.isActive},getSnapshot:()=>o}}var nn=new Map,bl=[],bv=new Set,XR=e=>bv.forEach(t=>t(e)),nT=()=>nn.size>0;function ZR(){bl.forEach(e=>sT(e.content,e.options)),bl=[]}var JR=(e,{containerId:t})=>{var r;return(r=nn.get(t||1))==null?void 0:r.toasts.get(e)};function aT(e,t){var r;if(t)return!!((r=nn.get(t))!=null&&r.isToastActive(e));let n=!1;return nn.forEach(a=>{a.isToastActive(e)&&(n=!0)}),n}function QR(e){if(!nT()){bl=bl.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||UR(e))nn.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=nn.get(e.containerId);t?t.removeToast(e.id):nn.forEach(r=>{r.removeToast(e.id)})}}var e8=(e={})=>{nn.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function sT(e,t){yv(e)&&(nT()||bl.push({content:e,options:t}),nn.forEach(r=>{r.buildToast(e,t)}))}function t8(e){var t;(t=nn.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function iT(e,t){nn.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function r8(e){let t=e.containerId||1;return{subscribe(r){let n=YR(t,e,XR);nn.set(t,n);let a=n.observe(r);return ZR(),()=>{a(),nn.delete(t)}},setProps(r){var n;(n=nn.get(t))==null||n.setProps(r)},getSnapshot(){var r;return(r=nn.get(t))==null?void 0:r.getSnapshot()}}}function n8(e){return bv.add(e),()=>{bv.delete(e)}}function a8(e){return e&&(gi(e.toastId)||Ql(e.toastId))?e.toastId:rT()}function ec(e,t){return sT(e,t),t.toastId}function Nd(e,t){return{...t,type:t&&t.type||e,toastId:a8(t)}}function Ed(e){return(t,r)=>ec(t,Nd(e,r))}function ye(e,t){return ec(e,Nd("default",t))}ye.loading=(e,t)=>ec(e,Nd("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function s8(e,{pending:t,error:r,success:n},a){let s;t&&(s=gi(t)?ye.loading(t,a):ye.loading(t.render,{...a,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,u,f)=>{if(u==null){ye.dismiss(s);return}let h={type:d,...o,...a,data:f},m=gi(u)?{render:u}:u;return s?ye.update(s,{...h,...m}):ye(m.render,{...h,...m}),f},c=Qa(e)?e():e;return c.then(d=>l("success",n,d)).catch(d=>l("error",r,d)),c}ye.promise=s8;ye.success=Ed("success");ye.info=Ed("info");ye.error=Ed("error");ye.warning=Ed("warning");ye.warn=ye.warning;ye.dark=(e,t)=>ec(e,Nd("default",{theme:"dark",...t}));function i8(e){QR(e)}ye.dismiss=i8;ye.clearWaitingQueue=e8;ye.isActive=aT;ye.update=(e,t={})=>{let r=JR(e,t);if(r){let{props:n,content:a}=r,s={delay:100,...n,...t,toastId:t.toastId||e,updateId:rT()};s.toastId!==e&&(s.staleId=e);let o=s.render||a;delete s.render,ec(o,s)}};ye.done=e=>{ye.update(e,{progress:1})};ye.onChange=n8;ye.play=e=>iT(!0,e);ye.pause=e=>iT(!1,e);function o8(e){var t;let{subscribe:r,getSnapshot:n,setProps:a}=_.useRef(r8(e)).current;a(e);let s=(t=_.useSyncExternalStore(r,n,n))==null?void 0:t.slice();function o(l){if(!s)return[];let c=new Map;return e.newestOnTop&&s.reverse(),s.forEach(d=>{let{position:u}=d.props;c.has(u)||c.set(u,[]),c.get(u).push(d)}),Array.from(c,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:aT,count:s?.length}}function l8(e){let[t,r]=_.useState(!1),[n,a]=_.useState(!1),s=_.useRef(null),o=_.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:u,closeOnClick:f}=e;t8({id:e.toastId,containerId:e.containerId,fn:r}),_.useEffect(()=>{if(e.pauseOnFocusLoss)return h(),()=>{m()}},[e.pauseOnFocusLoss]);function h(){document.hasFocus()||x(),window.addEventListener("focus",g),window.addEventListener("blur",x)}function m(){window.removeEventListener("focus",g),window.removeEventListener("blur",x)}function p(E){if(e.draggable===!0||e.draggable===E.pointerType){b();let S=s.current;o.canCloseOnClick=!0,o.canDrag=!0,S.style.transition="none",e.draggableDirection==="x"?(o.start=E.clientX,o.removalDistance=S.offsetWidth*(e.draggablePercent/100)):(o.start=E.clientY,o.removalDistance=S.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function v(E){let{top:S,bottom:O,left:k,right:T}=s.current.getBoundingClientRect();E.nativeEvent.type!=="touchend"&&e.pauseOnHover&&E.clientX>=k&&E.clientX<=T&&E.clientY>=S&&E.clientY<=O?x():g()}function g(){r(!0)}function x(){r(!1)}function b(){o.didMove=!1,document.addEventListener("pointermove",w),document.addEventListener("pointerup",j)}function y(){document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",j)}function w(E){let S=s.current;if(o.canDrag&&S){o.didMove=!0,t&&x(),e.draggableDirection==="x"?o.delta=E.clientX-o.start:o.delta=E.clientY-o.start,o.start!==E.clientX&&(o.canCloseOnClick=!1);let O=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;S.style.transform=`translate3d(${O},0)`,S.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function j(){y();let E=s.current;if(o.canDrag&&o.didMove&&E){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){a(!0),e.closeToast(!0),e.collapseAll();return}E.style.transition="transform 0.2s, opacity 0.2s",E.style.removeProperty("transform"),E.style.removeProperty("opacity")}}let N={onPointerDown:p,onPointerUp:v};return l&&c&&(N.onMouseEnter=x,e.stacked||(N.onMouseLeave=g)),f&&(N.onClick=E=>{u&&u(E),o.canCloseOnClick&&d(!0)}),{playToast:g,pauseToast:x,isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:N}}var c8=typeof window<"u"?_.useLayoutEffect:_.useEffect,_d=({theme:e,type:t,isLoading:r,...n})=>se.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...n});function u8(e){return se.createElement(_d,{...e},se.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function d8(e){return se.createElement(_d,{...e},se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function f8(e){return se.createElement(_d,{...e},se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function h8(e){return se.createElement(_d,{...e},se.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function m8(){return se.createElement("div",{className:"Toastify__spinner"})}var wv={info:d8,warning:u8,success:f8,error:h8,spinner:m8},p8=e=>e in wv;function v8({theme:e,type:t,isLoading:r,icon:n}){let a=null,s={theme:e,type:t};return n===!1||(Qa(n)?a=n({...s,isLoading:r}):_.isValidElement(n)?a=_.cloneElement(n,s):r?a=wv.spinner():p8(t)&&(a=wv[t](s))),a}var g8=e=>{let{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:a,playToast:s}=l8(e),{closeButton:o,children:l,autoClose:c,onClick:d,type:u,hideProgressBar:f,closeToast:h,transition:m,position:p,className:v,style:g,progressClassName:x,updateId:b,role:y,progress:w,rtl:j,toastId:N,deleteToast:E,isIn:S,isLoading:O,closeOnClick:k,theme:T,ariaLabel:A}=e,P=lt("Toastify__toast",`Toastify__toast-theme--${T}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":j},{"Toastify__toast--close-on-click":k}),C=Qa(v)?v({rtl:j,position:p,type:u,defaultClassName:P}):lt(P,v),F=v8(e),M=!!w||!c,H={closeToast:h,type:u,theme:T},V=null;return o===!1||(Qa(o)?V=o(H):_.isValidElement(o)?V=_.cloneElement(o,H):V=VR(H)),se.createElement(m,{isIn:S,done:E,position:p,preventExitTransition:r,nodeRef:n,playToast:s},se.createElement("div",{id:N,tabIndex:0,onClick:d,"data-in":S,className:C,...a,style:g,ref:n,...S&&{role:y,"aria-label":A}},F!=null&&se.createElement("div",{className:lt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!O})},F),tT(l,e,!t),V,!e.customProgressBar&&se.createElement(GR,{...b&&!M?{key:`p-${b}`}:{},rtl:j,theme:T,delay:c,isRunning:t,isIn:S,closeToast:h,hide:f,type:u,className:x,controlledProgress:M,progress:w||0})))},x8=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),y8=HR(x8("bounce",!0)),b8={position:"top-right",transition:y8,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function w8(e){let t={...b8,...e},r=e.stacked,[n,a]=_.useState(!0),s=_.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=o8(t),{className:d,style:u,rtl:f,containerId:h,hotKeys:m}=t;function p(g){let x=lt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":f});return Qa(d)?d({position:g,rtl:f,defaultClassName:x}):lt(x,xv(d))}function v(){r&&(a(!0),ye.play())}return c8(()=>{var g;if(r){let x=s.current.querySelectorAll('[data-in="true"]'),b=12,y=(g=t.position)==null?void 0:g.includes("top"),w=0,j=0;Array.from(x).reverse().forEach((N,E)=>{let S=N;S.classList.add("Toastify__toast--stacked"),E>0&&(S.dataset.collapsed=`${n}`),S.dataset.pos||(S.dataset.pos=y?"top":"bot");let O=w*(n?.2:1)+(n?0:b*E);S.style.setProperty("--y",`${y?O:O*-1}px`),S.style.setProperty("--g",`${b}`),S.style.setProperty("--s",`${1-(n?j:0)}`),w+=S.offsetHeight,j+=.025})}},[n,c,r]),_.useEffect(()=>{function g(x){var b;let y=s.current;m(x)&&((b=y.querySelector('[tabIndex="0"]'))==null||b.focus(),a(!1),ye.pause()),x.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(a(!0),ye.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[m]),se.createElement("section",{ref:s,className:"Toastify",id:h,onMouseEnter:()=>{r&&(a(!1),ye.pause())},onMouseLeave:v,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((g,x)=>{let b=x.length?{...u}:{...u,pointerEvents:"none"};return se.createElement("div",{tabIndex:-1,className:p(g),"data-stacked":r,style:b,key:`c-${g}`},x.map(({content:y,props:w})=>se.createElement(g8,{...w,stacked:r,collapseAll:v,isIn:l(w.toastId,w.containerId),key:`t-${w.key}`},y)))}))}const Sa=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role}:null,status:t.isActive,coursesCount:t.courseCount||0,traineesCount:0,trainersCount:0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),Bg=(e=!0)=>{const[t,r]=_.useState([]),[n,a]=_.useState([]),[s,o]=_.useState(!1),[l,c]=_.useState(null),[d,u]=_.useState(""),[f,h]=_.useState({type:"",status:""}),[m,p]=_.useState({key:null,direction:"asc"}),[v,g]=_.useState([]);return _.useEffect(()=>{if(!e){console.log(" useDepartmentManagement - Skipping department load for non-ACADEMIC_DEPARTMENT role");return}(async()=>{o(!0),c(null);try{const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B)}catch(H){console.error("Error loading departments:",H),c("Failed to load departments"),r([])}finally{o(!1)}})()},[e]),_.useEffect(()=>{let M=t;d&&(M=M.filter(H=>H.name.toLowerCase().includes(d.toLowerCase())||H.code.toLowerCase().includes(d.toLowerCase())||H.description.toLowerCase().includes(d.toLowerCase()))),f.type&&(M=M.filter(H=>H.type===f.type)),f.status&&(M=M.filter(H=>H.status===f.status)),a(M)},[t,d,f]),{departments:n,selectedDepartments:v,loading:s,error:l,searchTerm:d,setSearchTerm:u,filters:f,sortConfig:m,createDepartment:async M=>{o(!0),c(null);try{const H=await gt.createDepartment(M),B=(await gt.getDepartments()).departments||[],W=Sa(B);return r(W),H}catch(H){throw console.error("Error creating department:",H),c("Failed to create department"),H}finally{o(!1)}},updateDepartment:async(M,H)=>{o(!0),c(null);try{const V=await gt.updateDepartment(M,H),W=(await gt.getDepartments()).departments||[],z=Sa(W);return r(z),V}catch(V){throw console.error("Error updating department:",V),c("Failed to update department"),V}finally{o(!1)}},deleteDepartment:async M=>{o(!0),c(null);try{await gt.deleteDepartment(M);const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B)}catch(H){throw console.error("Error deleting department:",H),c("Failed to delete department"),H}finally{o(!1)}},toggleDepartmentStatus:async M=>{o(!0),c(null);try{await gt.toggleDepartmentStatus(M);const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B)}catch(H){throw console.error("Error toggling department status:",H),ye.error("Failed to toggle department status"),H}finally{o(!1)}},disableDepartment:async M=>{o(!0),c(null);try{await gt.disableDepartment(M);const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B)}catch(H){throw console.error("Error disabling department:",H),ye.error("Failed to disable department"),H}finally{o(!1)}},enableDepartment:async M=>{o(!0),c(null);try{await gt.enableDepartment(M);const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B)}catch(H){throw console.error("Error enabling department:",H),ye.error("Failed to enable department"),H}finally{o(!1)}},bulkDeleteDepartments:async M=>{o(!0),c(null);try{await gt.bulkDeleteDepartments(M);const V=(await gt.getDepartments()).departments||[],B=Sa(V);r(B),g([])}catch(H){throw console.error("Error bulk deleting departments:",H),ye.error("Failed to delete departments"),H}finally{o(!1)}},bulkToggleStatus:async(M,H)=>{o(!0),c(null);try{await gt.bulkToggleStatus(M,H);const B=(await gt.getDepartments()).departments||[],W=Sa(B);r(W),g([])}catch(V){throw console.error("Error bulk toggling department status:",V),ye.error("Failed to update department status"),V}finally{o(!1)}},sortDepartments:M=>{let H="asc";m.key===M&&m.direction==="asc"&&(H="desc"),p({key:M,direction:H});const V=[...n].sort((B,W)=>B[M]<W[M]?H==="asc"?-1:1:B[M]>W[M]?H==="asc"?1:-1:0);a(V)},handleSelectDepartment:M=>{g(H=>H.includes(M)?H.filter(V=>V!==M):[...H,M])},handleSelectAll:()=>{v.length===n.length?g([]):g(n.map(M=>M.id))},handleFilterChange:(M,H)=>{h(V=>({...V,[M]:H}))},clearFilters:()=>{h({type:"",status:""}),u("")},getAvailableUsers:async()=>{try{return(await gt.getDepartmentHeads())?.users||[]}catch(M){return console.error("Error fetching department heads:",M),ye.error("Failed to load department heads"),[]}},refreshDepartments:async()=>{o(!0),c(null);try{const H=(await gt.getDepartments()).departments||[],V=Sa(H);r(V)}catch(M){console.error("Error refreshing departments:",M),c("Failed to refresh departments")}finally{o(!1)}},setError:c}},sb=({collapsed:e,onClose:t})=>{const{hasModuleAccess:r,hasPermission:n,userPermissions:a}=Jl(),{user:s}=bn(),o=ki(),l=Et(),{departments:c,loading:d}=Bg(s?.role==="ACADEMIC_DEPARTMENT"),[u,f]=_.useState(!1),[h,m]=_.useState(!1),[p,v]=_.useState(!1),g=_.useRef(null);console.log(" Sidebar - User role:",s?.role),console.log(" Sidebar - User object:",s),console.log(" Sidebar - User permissions:",a),console.log(" Sidebar - Departments:",c),c.filter(y=>y.status==="ACTIVE"),_.useEffect(()=>{if(g.current&&u){const y=g.current,w=y.scrollHeight>y.clientHeight;v(w)}},[u,c]);const b=[{id:"dashboard",label:"Dashboard",icon:xS,path:"/admin/dashboard",permission:Me.DASHBOARD.VIEW,module:"DASHBOARD"},{id:"users",label:"User Management",icon:Pn,path:"/admin/users",permission:Me.USERS.VIEW_ALL,module:"USERS"},{id:"roles",label:"Role Management",icon:Ig,path:"/admin/roles",permission:Me.ROLES.VIEW_ALL,module:"ROLES"},{id:"departments",label:"Departments",icon:Ts,path:"/admin/departments",permission:Me.DEPARTMENTS.VIEW_ALL,module:"DEPARTMENTS"},{id:"forms",label:"Form Templates",icon:xa,path:"/admin/forms",permission:Me.TEMPLATES.VIEW_ALL,module:"TEMPLATES"},{id:"system-config",label:"System Configuration",icon:vS,path:"/admin/system-config",permission:Me.GLOBAL_FIELDS.VIEW_ALL,module:"GLOBAL_FIELDS"},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:ha,path:"/trainee/dashboard",permission:Me.TRAINEES.VIEW_DETAIL,module:"TRAINEES"},{id:"enrolled-courses",label:"Enrolled Course List",icon:ha,path:"/trainee/enrolled-courses",permission:Me.TRAINEES.VIEW_COURSES,module:"TRAINEES"},{id:"all-assessments",label:"All Assessments",icon:ha,path:"/trainee/all-assessments",permission:Me.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES",children:[{id:"your-assessments",label:"Your Assessments",path:"/trainee/your-assessments",permission:Me.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"signature-required",label:"Signature Required List",path:"/trainee/signature-required",permission:Me.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"completion-required",label:"Section Completion Required List",path:"/trainee/completion-required",permission:Me.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:ha,path:"/trainee/create-incident-feedback-report",permission:Me.TRAINEES.VIEW_ALL,module:"TRAINEES"}].filter(y=>{if(console.log(` Filtering item: ${y.id}`,{userRole:s?.role,itemModule:y.module,itemPermission:y.permission,hasModuleAccess:r(y.module),hasPermission:n(y.permission)}),s?.role==="ADMINISTRATOR"){const j=r(y.module)||n(y.permission);return console.log(` ADMINISTRATOR role - ${y.id}: ${j}`),j}if(s?.role==="ACADEMIC_DEPARTMENT"){const j=y.id==="dashboard";return console.log(` ACADEMIC_DEPARTMENT role - ${y.id}: ${j}`),j}if(s?.role==="TRAINEE"){const j=["trainee-dashboard","enrolled-courses","all-assessments","create-issue"].includes(y.id);return console.log(` TRAINEE role - ${y.id}: ${j}`),j}const w=r(y.module)||n(y.permission);return console.log(` Default role - ${y.id}: ${w}`),w}).map(y=>s?.role==="ACADEMIC_DEPARTMENT"&&y.id==="dashboard"?{...y,path:"/academic/dashboard",label:"Academic Dashboard"}:y);return console.log(" Sidebar - Filtered navItems:",b),console.log(" Sidebar - Dashboard permission check:",{permission:Me.DASHBOARD.VIEW,hasPermission:n(Me.DASHBOARD.VIEW),hasModuleAccess:r("DASHBOARD"),userRole:s?.role,userPermissions:a?.map(y=>y.name).filter(y=>y.includes("dashboard")||y.includes("DASHBOARD"))}),console.log(" Sidebar - TRAINEE permissions check:",{userRole:s?.role,TRAINEES_VIEW_DETAIL:{permission:Me.TRAINEES.VIEW_DETAIL,hasPermission:n(Me.TRAINEES.VIEW_DETAIL)},TRAINEES_VIEW_COURSES:{permission:Me.TRAINEES.VIEW_COURSES,hasPermission:n(Me.TRAINEES.VIEW_COURSES)},TRAINEES_VIEW_ASSESSMENTS:{permission:Me.TRAINEES.VIEW_ASSESSMENTS,hasPermission:n(Me.TRAINEES.VIEW_ASSESSMENTS)},TRAINEES_VIEW_ALL:{permission:Me.TRAINEES.VIEW_ALL,hasPermission:n(Me.TRAINEES.VIEW_ALL)},allUserPermissions:a?.map(y=>y.name)}),i.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"sticky",top:0,height:"100vh",overflowY:"hidden",overflowX:"hidden"},children:[i.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&i.jsx(i.Fragment,{children:i.jsx("img",{src:l6,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&i.jsx("div",{children:i.jsx(uS,{size:24})})]}),t&&i.jsx(le,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:t,style:{border:"none",background:"transparent"},children:i.jsx(Ye,{size:20})})]}),i.jsxs(zr,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[b.map(y=>{const w=y.icon,j=o.pathname===y.path;return console.log(` Sidebar - Item: ${y.id}, Path: ${y.path}, Current: ${o.pathname}, Active: ${j}`),y.id==="all-assessments"&&s?.role==="TRAINEE"?i.jsx(zr.Item,{className:"mb-3",children:i.jsxs("div",{className:"position-relative",children:[i.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${o.pathname.startsWith("/trainee/signature-required")||o.pathname.startsWith("/trainee/completion-required")||o.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:o.pathname.startsWith("/trainee/signature-required")||o.pathname.startsWith("/trainee/completion-required")||o.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(l("/trainee/all-assessments"),t()):m(!h)},children:[i.jsx(w,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:y.label}),i.jsx(hi,{size:16,className:`ms-auto transition-transform ${h?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&h&&i.jsx("div",{className:"mt-2 ms-4",children:y.children&&y.children.map(N=>i.jsx(Ef,{to:N.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:o.pathname===N.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",wordWrap:"break-word",overflowWrap:"break-word"},onClick:t,children:i.jsx("span",{className:"sidebar-nav-label",children:N.label})},N.id))})]})},y.id):i.jsx(zr.Item,{className:"mb-3",children:i.jsxs(Ef,{to:y.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${j?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:j?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",wordWrap:e?"normal":"break-word",overflowWrap:"break-word"},onClick:N=>{console.log(` Sidebar - Clicked on: ${y.id}, navigating to: ${y.path}`),console.log(" Sidebar - Current location:",window.location.href),console.log(" Sidebar - Current pathname:",window.location.pathname),t()},children:[i.jsx(w,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&i.jsx("span",{className:"sidebar-nav-label",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:y.label})]})},y.id)}),s?.role==="ACADEMIC_DEPARTMENT"&&i.jsx(zr.Item,{className:"mb-3",children:i.jsxs("div",{className:"position-relative",children:[i.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${o.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:o.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[i.jsx(Ts,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{f(!u),l("/academic/departments")},children:"Department"}),i.jsx(hi,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:u?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{f(!u)}})]})]}),!e&&u&&i.jsx("div",{ref:g,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${p?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:d?i.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:i.jsx("small",{children:"Loading departments..."})}):c.length>0?c.map(y=>i.jsxs(Ef,{to:`/academic/course/${y.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${o.pathname===`/academic/course/${y.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:o.pathname===`/academic/course/${y.id}`?"rgba(255, 255, 255, 0.15)":"transparent",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[i.jsx(Og,{size:12,className:"me-2 sidebar-department-chevron"}),y.code]},y.id)):i.jsx("div",{className:"px-3 py-2 text-white-50",children:i.jsx("small",{children:"No departments found"})})})]})})]})]})},_s={getProfile:async()=>{try{return(await Ie.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,t)=>{try{const n={...t||await _s.getProfile(),avatarUrl:e};return n.address||(n.address=""),n.phoneNumber||(n.phoneNumber=""),n.avatarUrl||(n.avatarUrl=""),n.firstName||(n.firstName=""),n.lastName||(n.lastName=""),n.middleName||(n.middleName=""),Object.keys(n).forEach(s=>{(n[s]===void 0||n[s]===null)&&delete n[s]}),(await Ie.put("/profile",n)).data}catch(r){throw console.error("Error updating avatar:",r),r}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const t=await Ie.put("/profile",e);return console.log("updateProfile - response:",t.data),t.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Ie.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}}},j8=()=>{const[e,t]=_.useState(null),[r,n]=_.useState(!0),[a,s]=_.useState(null),o=async()=>{try{n(!0),s(null);const u=await _s.getProfile();t(u)}catch(u){console.error("Error fetching profile:",u),s(u.message||"Failed to fetch profile")}finally{n(!1)}},l=async u=>{try{n(!0),s(null);const f=await _s.updateProfile(u);return t(f),f}catch(f){throw console.error("Error updating profile:",f),s(f.message||"Failed to update profile"),f}finally{n(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:u,lastName:f,middleName:h}=e,m=[];return u&&m.push(u),h&&m.push(h),f&&m.push(f),m.join(" ")||"User"},d=()=>e?.role?e.role.name:"User";return _.useEffect(()=>{o()},[]),{profile:e,loading:r,error:a,fetchProfile:o,updateProfile:l,getDisplayName:c,getRoleName:d}},N8={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},E8=({onToggleSidebar:e})=>{const t=ki(),r=Et(),[n,a]=_.useState(!1),[s,o]=_.useState(!1),l=_.useRef(null),{user:c,isLoading:d}=bn(),{profile:u,getDisplayName:f,loading:h}=j8();_.useEffect(()=>{console.log("Header - User data:",c),console.log("Header - Profile data:",u),console.log("Header - Profile loading:",h),u&&f&&console.log("Header - Profile display name:",f());try{const w=localStorage.getItem("authToken");if(w){const j=JSON.parse(atob(w.split(".")[1]));console.log("Header - JWT token payload:",j)}}catch(w){console.error("Header - Error parsing JWT token:",w)}},[c,u,h,f]);const m=()=>{if(!c||h)return"Loading...";if(u&&f&&f()&&f()!=="Loading..."){const w=f();if(w&&w.trim()!=="")return w}if(u&&u.firstName){const w=[u.firstName];u.middleName&&w.push(u.middleName),u.lastName&&w.push(u.lastName);const j=w.join(" ").trim();if(j)return j}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const w=localStorage.getItem("authToken");if(w){const j=JSON.parse(atob(w.split(".")[1]));if(j.fullName&&j.fullName!=="User")return j.fullName;if(j.name&&j.name!=="User")return j.name;if(j.firstName&&j.lastName)return`${j.firstName} ${j.lastName}`}}catch(w){console.error("Error parsing JWT token for display name:",w)}return c.name||"User"},p=()=>c&&c.email||"No email",v=w=>{const j={"/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/profile":"Profile","/admin/forms":"Form Templates","/admin/system-config":"System Configuration","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/profile":"Profile","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/all-assessments":"All Assessments","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-issue":"Create Issue Report/Feedback","/trainee/assessment-pending/signature-required":"Signature Required List","/trainee/assessment-pending/section-completion":"Section Completion Required List"};return w.startsWith("/admin/departments/")&&w!=="/admin/departments"?"Edit Department Detail":w.startsWith("/academic/departments/")&&w!=="/academic/departments"?"Department Management":w.includes("/enroll-trainees")?"Trainee Enrollments":w.startsWith("/academic/course/")&&!w.includes("/subject/")?"Department Details":w.startsWith("/academic/course-detail/")?"Course Details":w.includes("/subject/")?"Subject Details":w.includes("/enroll-trainees")?"Enroll Trainees":w.startsWith("/trainee/")&&w!=="/trainee"&&!w.startsWith("/trainee/academic-details")&&!w.startsWith("/trainee/enrolled-courses")&&!w.startsWith("/trainee/assessment-pending")&&!w.startsWith("/trainee/create-issue")?"Trainee Details":w.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Course Details":w.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Subject Details":w.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":w.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":w.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":j[w]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const w=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=w()},x=()=>{a(!n)},b=()=>{a(!1)},y=()=>{r("/admin/profile"),a(!1)};return _.useEffect(()=>{const w=j=>{l.current&&!l.current.contains(j.target)&&o(!1)};return s&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[s]),i.jsxs(i.Fragment,{children:[i.jsx(Ry,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:i.jsxs("div",{className:"container-fluid",children:[i.jsx(le,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:i.jsx(bS,{size:20})}),i.jsx(Ry.Brand,{className:"text-primary-custom fw-bold custom-title",children:v(t.pathname)}),i.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:i.jsxs("div",{ref:l,style:{position:"relative"},children:[i.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>o(!s),children:[i.jsx(Wi,{size:32,className:"me-2"}),i.jsx("span",{children:d||h?"Loading...":m()})]}),i.jsxs("div",{className:`custom-dropdown ${s?"show":"hide"}`,style:N8,children:[i.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[i.jsx("div",{className:"fw-bold text-primary-custom",children:d||h?"Loading...":m()}),i.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:d?"Loading...":p()})]}),i.jsx("div",{className:"dropdown-divider"}),i.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),y()},children:[i.jsx(Wi,{className:"me-2",size:16}),"Profile"]}),i.jsx("div",{className:"dropdown-divider"}),i.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),g()},children:[i.jsx(fp,{className:"me-2",size:16}),"Logout"]})]})]})}),i.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:x,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:i.jsx(Wi,{size:32})})]})}),n&&i.jsx("div",{className:`profile-menu-overlay ${n?"show":""}`,onClick:b}),i.jsxs("div",{className:`profile-menu-slide ${n?"show":""}`,children:[i.jsxs("div",{className:"profile-menu-header",children:[i.jsx("button",{className:"profile-menu-close",onClick:b,"aria-label":"Close profile menu",children:i.jsx(Ye,{size:20})}),i.jsx("div",{className:"profile-avatar",children:i.jsx(Wi,{size:40})}),i.jsx("div",{className:"profile-name",children:d||h?"Loading...":m()}),i.jsx("div",{className:"profile-email",children:d?"Loading...":p()})]}),i.jsxs("ul",{className:"profile-menu-items",children:[i.jsx("li",{className:"profile-menu-item",children:i.jsxs("a",{href:"#",className:"profile-menu-link",onClick:w=>{w.preventDefault(),y()},children:[i.jsx(Wi,{className:"icon"}),"Profile"]})}),i.jsx("li",{className:"profile-menu-item",children:i.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:w=>{w.preventDefault(),b(),g()},children:[i.jsx(fp,{className:"icon"}),"Logout"]})})]})]})]})},_8=({children:e})=>{const[t,r]=_.useState(!1),[n,a]=_.useState(!1),[s,o]=_.useState(!1);_.useEffect(()=>{const d=()=>{a(window.innerWidth<=768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const l=()=>{n?o(!s):r(!t)},c=()=>{n&&o(!1)};return i.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[i.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:i.jsx(sb,{collapsed:t})}),n&&s&&i.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),i.jsx("div",{className:`sidebar-mobile ${s?"show":""}`,children:i.jsx(sb,{collapsed:!1,onClose:c})}),i.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${n?"main-content-mobile":""}`,children:[i.jsx(E8,{onToggleSidebar:l}),i.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},Of=()=>i.jsx(_8,{children:i.jsx(RP,{})}),S8=({children:e})=>(console.log(" AuthWrapper rendering..."),i.jsx(BR,{children:e})),Vs=()=>{const e=FP(),t=Et(),n=(o=>o?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:o?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:o?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),a=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},s=()=>{t(-1)};return i.jsx(He,{fluid:!0,className:"py-5",children:i.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:i.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h1",{className:"display-1 text-muted",children:""}),i.jsx("h2",{className:"text-primary-custom mb-3",children:n.title}),i.jsx("p",{className:"text-muted mb-4",children:n.message}),i.jsx("p",{className:"small text-muted",children:n.suggestion})]}),i.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[i.jsx(le,{variant:"primary",onClick:a,className:"px-4",children:"Go to Dashboard"}),i.jsx(le,{variant:"outline-secondary",onClick:s,className:"px-4",children:"Go Back"})]}),!1]})})})},Ln=({rows:e=5,columns:t=4})=>{const r=()=>i.jsx("tr",{children:Array.from({length:t}).map((n,a)=>i.jsx("td",{children:i.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:i.jsx("span",{className:"placeholder col-12"})})},a))});return i.jsxs(ce,{className:"border-neutral-200",children:[i.jsx(ce.Header,{className:"bg-light-custom border-neutral-200",children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:i.jsx("span",{className:"placeholder col-12"})}),i.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:i.jsx("span",{className:"placeholder col-12"})})]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"table table-hover mb-0",children:[i.jsx("thead",{className:"bg-neutral-50",children:i.jsx("tr",{children:Array.from({length:t}).map((n,a)=>i.jsx("th",{className:"border-neutral-200",children:i.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:i.jsx("span",{className:"placeholder col-12"})})},a))})}),i.jsx("tbody",{children:Array.from({length:e}).map((n,a)=>i.jsx(r,{},a))})]})})})]})},T8=({module:e,children:t,fallback:r=null,showMessage:n=!1,message:a="You do not have access to this module."})=>{const{hasModuleAccess:s}=Jl();return s(e)?t:r||(n?i.jsxs(tt,{variant:"warning",className:"mt-3",children:[i.jsx(tt.Heading,{children:"Module Access Denied"}),i.jsx("p",{children:a})]}):null)},_t=({permission:e,permissions:t=[],requireAll:r=!1,children:n,redirectTo:a=null})=>{const{hasPermission:s,hasAnyPermission:o,hasAllPermissions:l}=Jl(),{user:c}=bn();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?s(e):t&&t.length>0?r?l(t):o(t):!1)?n:i.jsxs("div",{className:"p-4 text-center text-muted",children:[i.jsx("h4",{children:"Access Denied"}),i.jsx("p",{children:"You don't have permission to access this page."}),i.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),i.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},sn=({permission:e,permissions:t=[],requireAll:r=!1,children:n,fallback:a=null,showMessage:s=!1,message:o="You do not have permission to access this feature."})=>{const{hasPermission:l,hasAnyPermission:c,hasAllPermissions:d}=Jl();return(!e&&(!t||t.length===0)?!0:e?l(e):t&&t.length>0?r?d(t):c(t):!1)?n:a||(s?i.jsxs(tt,{variant:"warning",className:"mt-3",children:[i.jsx(tt.Heading,{children:"Access Denied"}),i.jsx("p",{children:o})]}):null)},sa=({trigger:e,items:t=[],align:r="end",className:n="",onItemClick:a,placement:s="bottom-end",disabled:o=!1,...l})=>{const[c,d]=_.useState(!1),[u,f]=_.useState({top:0,left:0}),h=_.useRef(null),m=_.useRef(null),p=()=>{if(!h.current)return;const y=h.current.getBoundingClientRect(),w=200,j=150,N=4;let E,S;switch(s){case"bottom-start":E=y.bottom+N,S=y.left;break;case"bottom-end":E=y.bottom+N,S=y.right-w;break;case"top-start":E=y.top-j-N,S=y.left;break;case"top-end":E=y.top-j-N,S=y.right-w;break;default:E=y.bottom+N,S=y.right-w}E+j>window.innerHeight&&(E=y.top-j-N),E<0&&(E=N),S+w>window.innerWidth&&(S=window.innerWidth-w-N),S<0&&(S=N),f({top:E,left:S})},v=y=>{y.preventDefault(),y.stopPropagation(),!o&&(c||p(),d(!c))},g=()=>{d(!1)},x=y=>{y.onClick&&y.onClick(),a&&a(y),g()};_.useEffect(()=>{const y=j=>{c&&h.current&&!h.current.contains(j.target)&&m.current&&!m.current.contains(j.target)&&g()},w=j=>{j.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",y),document.addEventListener("keydown",w),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",y),document.removeEventListener("keydown",w),document.body.style.overflow=""}},[c]),_.useEffect(()=>{if(c){const y=()=>p(),w=()=>p();return window.addEventListener("scroll",y,!0),window.addEventListener("resize",w),()=>{window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",w)}}},[c,s]);const b=c&&pd.createPortal(i.jsx("div",{ref:m,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:u.top,left:u.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((y,w)=>y.type==="header"?i.jsx("div",{className:`dropdown-header ${y.className||""}`,children:y.content},w):y.type==="divider"?i.jsx("div",{className:"dropdown-divider"},w):i.jsxs("button",{onClick:()=>x(y),className:`dropdown-item ${y.className||""}`,disabled:y.disabled,children:[y.icon&&i.jsx("span",{className:"me-2",children:y.icon}),y.label]},w))}),document.body);return i.jsxs("div",{className:`dropdown ${n}`,children:[i.jsx("button",{ref:h,className:`btn ${e.variant==="link"?"btn-link":"btn-light"} ${e.className||""}`,type:"button",onClick:v,disabled:o,"aria-expanded":c,"aria-haspopup":"true",style:e.style||{},children:e.children}),b]})},Cf=({children:e})=>{const{isAuthenticated:t,isLoading:r}=bn(),n=ki();return r?i.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:(console.log(" User not authenticated, redirecting to login"),i.jsx(LP,{to:"/",state:{from:n},replace:!0}))},ao=({placeholder:e="Search...",value:t,onChange:r,className:n="",size:a="md"})=>i.jsxs(Fy,{className:n,size:a,children:[i.jsx(Fy.Text,{className:"bg-white border-end-0",children:i.jsx(Dg,{className:"text-primary-custom"})}),i.jsx(Y.Control,{type:"text",placeholder:e,value:t,onChange:s=>r(s.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:s=>{s.target.style.borderColor="var(--bs-primary)",s.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:s=>{s.target.style.borderColor="var(--bs-neutral)",s.target.style.boxShadow="none"}})]}),is=({direction:e,size:t=16})=>{const r={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?i.jsx("span",{style:{...r,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?i.jsx("span",{style:{...r,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):i.jsxs("span",{style:r,className:"text-muted sort-icon",children:[i.jsx("span",{style:{display:"inline-block",transform:"translateY(-1px)",opacity:.5,marginRight:"1px"},children:""}),i.jsx("span",{style:{display:"inline-block",transform:"translateY(1px)",opacity:.5},children:""})]})},ib=()=>{const{user:e}=bn(),t=Et();return _.useEffect(()=>{if(e?.role){let r="/admin/dashboard";switch(e.role){case"ACADEMIC_DEPARTMENT":r="/academic/dashboard";break;case"TRAINEE":r="/trainee";break;case"ADMIN":case"ADMINISTRATOR":default:r="/admin/dashboard";break}t(r,{replace:!0})}},[e,t]),null},A8=({show:e,onHide:t})=>{const[r,n]=_.useState(""),[a,s]=_.useState(!1),[o,l]=_.useState(""),c=async u=>{u.preventDefault(),l(""),s(!0);try{const f=await fetch(`${vu.BASE_URL}${vu.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${Mg()}reset-password/`})});if(!f.ok){f.status===405?l("Forgot password feature is not available on this server. Please contact support."):f.status===404?l("Forgot password endpoint not found. Please contact support."):l(`Server error (${f.status}). Please try again later.`);return}try{await f.json()}catch(h){console.error("JSON parsing error:",h),l("Server returned invalid response. Please try again later.");return}ye.success("Password reset link has been sent to your email!"),n(""),t()}catch(f){console.error("Forgot password error:",f),f.name==="TypeError"&&f.message.includes("fetch")?l("Cannot connect to server. Please check your internet connection."):l("An unexpected error occurred. Please try again later.")}finally{s(!1)}},d=()=>{n(""),l(""),t()};return i.jsxs(de,{show:e,onHide:d,centered:!0,children:[i.jsxs(de.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[i.jsxs(de.Title,{className:"d-flex align-items-center text-white",children:[i.jsx(gd,{className:"me-2",size:20}),"Forgot Password"]}),i.jsx(le,{variant:"link",onClick:d,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:i.jsx(Ye,{})})]}),i.jsxs(de.Body,{className:"pt-0",children:[i.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),o&&i.jsx(tt,{variant:"danger",className:"mb-3",children:o}),i.jsxs(Y,{onSubmit:c,children:[i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),i.jsx(Y.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:u=>n(u.target.value),required:!0,disabled:a,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),i.jsxs("div",{className:"d-grid gap-2",children:[i.jsx(le,{type:"submit",variant:"primary",size:"lg",disabled:a||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.transform="translateY(-2px)",u.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:u=>{u.target.style.transform="translateY(0)",u.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),i.jsx(le,{type:"button",variant:"outline-secondary",onClick:d,disabled:a,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.background="var(--bs-neutral-100)",u.target.style.borderColor="var(--bs-primary)",u.target.style.transform="translateY(-1px)"},onMouseLeave:u=>{u.target.style.background="rgba(255, 255, 255, 0.8)",u.target.style.borderColor="var(--bs-neutral-300)",u.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function Pf(){const[e,t]=_.useState(""),[r,n]=_.useState(""),[a,s]=_.useState(!1),[o,l]=_.useState(!1),[c,d]=_.useState(!1),u=Et(),f=ki(),{login:h,isAuthenticated:m,isLoading:p}=bn();if(_.useEffect(()=>{if(m){const g=f.state?.from?.pathname||"/admin";u(g,{replace:!0})}},[m,u,f.state?.from?.pathname]),p)return i.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(m)return null;const v=async g=>{g.preventDefault(),l(!0);try{const x=await h({email:e,password:r});if(x.success){const b=f.state?.from?.pathname||"/admin";u(b,{replace:!0})}else ye.error(x.error||"Email or password is incorrect. Please try again.")}catch{ye.error("Login failed. Please try again.")}finally{l(!1)}};return i.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[i.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),i.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),i.jsx(He,{fluid:!0,className:"position-relative",style:{zIndex:1},children:i.jsxs(Ee,{className:"min-vh-100",children:[i.jsx(oe,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:i.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[i.jsxs("div",{className:"d-flex align-items-center mb-4",children:[i.jsx("div",{className:"dashed-line me-3"}),i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),i.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",i.jsx("br",{}),"ACADEMY"]}),i.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),i.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),i.jsx(oe,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:i.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),i.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),i.jsxs("div",{style:{position:"relative",zIndex:2},children:[i.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[i.jsx("div",{className:"dashed-line me-3"}),i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),i.jsx("div",{className:"dashed-line ms-3"})]}),i.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",i.jsx("br",{}),"ACADEMY"]}),i.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),i.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),i.jsxs(Y,{onSubmit:v,children:[i.jsxs(Y.Group,{className:"mb-3",controlId:"email",children:[i.jsx(Y.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),i.jsx(Y.Control,{type:"email",value:e,onChange:g=>t(g.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),i.jsxs(Y.Group,{className:"mb-4",controlId:"password",children:[i.jsx(Y.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),i.jsxs("div",{className:"position-relative",children:[i.jsx(Y.Control,{type:a?"text":"password",value:r,onChange:g=>n(g.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),i.jsx("span",{role:"button",tabIndex:0,onClick:()=>s(g=>!g),onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&s(x=>!x)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:a?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[i.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),i.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),i.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[i.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),i.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),i.jsx(le,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:o,children:o?i.jsxs(i.Fragment,{children:[i.jsx(ur,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),i.jsx("div",{className:"text-center mb-2",children:i.jsx("button",{type:"button",onClick:()=>d(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),i.jsx("div",{className:"text-center mb-4",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),i.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),i.jsxs("div",{className:"text-center",children:[i.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),i.jsx("div",{className:"text-white-50 small",children:i.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),i.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),i.jsx(A8,{show:c,onHide:()=>d(!1)})]})}const k8=()=>{const[e]=MP(),t=Et(),[r,n]=_.useState({newPassword:"",confirmPassword:""}),[a,s]=_.useState(!1),[o,l]=_.useState(!1),[c,d]=_.useState(!1),[u,f]=_.useState(""),[h,m]=_.useState("");_.useEffect(()=>{const g=e.get("token");g&&m(g)},[e]);const p=g=>{const{name:x,value:b}=g.target;n(y=>({...y,[x]:b})),u&&f("")},v=async g=>{if(g.preventDefault(),f(""),!r.newPassword||!r.confirmPassword){f("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){f("Passwords do not match.");return}d(!0);try{const x=await fetch(`${vu.BASE_URL}${vu.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!x.ok){x.status===405?f("Reset password feature is not available on this server. Please contact support."):x.status===404?f("Reset password endpoint not found. Please contact support."):x.status===400?f("Invalid token or password. Please request a new reset link."):f(`Server error (${x.status}). Please try again later.`);return}try{await x.json()}catch(b){console.error("JSON parsing error:",b),f("Server returned invalid response. Please try again later.");return}ye.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(x){console.error("Reset password error:",x),x.name==="TypeError"&&x.message.includes("fetch")?f("Cannot connect to server. Please check your internet connection."):f("An unexpected error occurred. Please try again later.")}finally{d(!1)}};return i.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:i.jsx(He,{children:i.jsx(Ee,{className:"justify-content-center",children:i.jsx(oe,{md:6,lg:5,xl:4,children:i.jsx(ce,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:i.jsxs(ce.Body,{className:"p-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:i.jsx(yl,{size:24,className:"text-white"})}),i.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),i.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),u&&i.jsx(tt,{variant:"danger",className:"mb-3",children:u}),i.jsxs(Y,{onSubmit:v,children:[i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),i.jsxs("div",{className:"position-relative",children:[i.jsx(Y.Control,{type:a?"text":"password",name:"newPassword",value:r.newPassword,onChange:p,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),i.jsx(le,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>s(!a),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:a?i.jsx(xl,{size:16}):i.jsx(Xt,{size:16})})]})]}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),i.jsxs("div",{className:"position-relative",children:[i.jsx(Y.Control,{type:o?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:p,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),i.jsx(le,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>l(!o),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:o?i.jsx(xl,{size:16}):i.jsx(Xt,{size:16})})]})]}),i.jsxs("div",{className:"d-grid gap-2",children:[i.jsx(le,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),i.jsx(le,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};var Df={},If={},ob;function O8(){return ob||(ob=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(If)),If}var Rf={},lb;function oT(){return lb||(lb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Rf)),Rf}var Ff={},cb;function $g(){return cb||(cb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Ff)),Ff}var Lf={},Mf={},ub;function C8(){return ub||(ub=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Mf)),Mf}var db;function zg(){return db||(db=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=C8(),r=$g();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];d?f==="\\"&&l+1<o?(l++,c+=a[l]):f===d?d="":c+=f:u?f==='"'||f==="'"?d=f:f==="]"?(u=!1,s.push(c),c=""):c+=f:f==="["?(u=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(Lf)),Lf}var fb;function Ug(){return fb||(fb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O8(),r=oT(),n=$g(),a=zg();function s(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?s(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let f=0;f<c.length;f++){if(u==null||t.isUnsafeProperty(c[f]))return d;u=u[c[f]]}return u===void 0?d:u}e.get=s})(Df)),Df}var Bf,hb;function P8(){return hb||(hb=1,Bf=Ug().get),Bf}var D8=P8();const xi=ss(D8);var $f={exports:{}},vt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mb;function I8(){if(mb)return vt;mb=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,f=e?Symbol.for("react.suspense"):60113,h=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,x=e?Symbol.for("react.responder"):60118,b=e?Symbol.for("react.scope"):60119;function y(j){if(typeof j=="object"&&j!==null){var N=j.$$typeof;switch(N){case t:switch(j=j.type,j){case c:case d:case n:case s:case a:case f:return j;default:switch(j=j&&j.$$typeof,j){case l:case u:case p:case m:case o:return j;default:return N}}case r:return N}}}function w(j){return y(j)===d}return vt.AsyncMode=c,vt.ConcurrentMode=d,vt.ContextConsumer=l,vt.ContextProvider=o,vt.Element=t,vt.ForwardRef=u,vt.Fragment=n,vt.Lazy=p,vt.Memo=m,vt.Portal=r,vt.Profiler=s,vt.StrictMode=a,vt.Suspense=f,vt.isAsyncMode=function(j){return w(j)||y(j)===c},vt.isConcurrentMode=w,vt.isContextConsumer=function(j){return y(j)===l},vt.isContextProvider=function(j){return y(j)===o},vt.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===t},vt.isForwardRef=function(j){return y(j)===u},vt.isFragment=function(j){return y(j)===n},vt.isLazy=function(j){return y(j)===p},vt.isMemo=function(j){return y(j)===m},vt.isPortal=function(j){return y(j)===r},vt.isProfiler=function(j){return y(j)===s},vt.isStrictMode=function(j){return y(j)===a},vt.isSuspense=function(j){return y(j)===f},vt.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===n||j===d||j===s||j===a||j===f||j===h||typeof j=="object"&&j!==null&&(j.$$typeof===p||j.$$typeof===m||j.$$typeof===o||j.$$typeof===l||j.$$typeof===u||j.$$typeof===g||j.$$typeof===x||j.$$typeof===b||j.$$typeof===v)},vt.typeOf=y,vt}var pb;function R8(){return pb||(pb=1,$f.exports=I8()),$f.exports}var F8=R8(),_r=e=>e===0?0:e>0?1:-1,xn=e=>typeof e=="number"&&e!=+e,Qs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,qe=e=>(typeof e=="number"||e instanceof Number)&&!xn(e),Ia=e=>qe(e)||typeof e=="string",L8=0,wl=e=>{var t=++L8;return"".concat(e||"").concat(t)},Gr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qe(t)&&typeof t!="string")return n;var s;if(Qs(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return xn(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},lT=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Bt(e,t,r){return qe(e)&&qe(t)?e+r*(t-e):t}function cT(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):xi(n,t))===r)}var Ut=e=>e===null||typeof e>"u",tc=e=>Ut(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),M8=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function qg(e){if(typeof e!="string")return!1;var t=M8;return t.includes(e)}var B8=["viewBox","children"],vb=["points","pathLength"],zf={svg:B8,polygon:vb,polyline:vb},Wg=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(_.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{qg(a)&&(n[a]=(s=>r[a](r,s)))}),n},$8=(e,t,r)=>n=>(e(t,r,n),null),rc=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var s=e[a];qg(a)&&typeof s=="function"&&(n||(n={}),n[a]=$8(s,t,r))}),n},z8=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function uT(e){if(typeof e!="string")return!1;var t=z8;return t.includes(e)}function Na(e){var t=Object.entries(e).filter(r=>{var[n]=r;return uT(n)});return Object.fromEntries(t)}var gb=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",xb=null,Uf=null,dT=e=>{if(e===xb&&Array.isArray(Uf))return Uf;var t=[];return _.Children.forEach(e,r=>{Ut(r)||(F8.isFragment(r)?t=t.concat(dT(r.props.children)):t.push(r))}),Uf=t,xb=e,t};function Hg(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>gb(a)):n=[gb(t)],dT(e).forEach(a=>{var s=xi(a,"type.displayName")||xi(a,"type.name");n.indexOf(s)!==-1&&r.push(a)}),r}var fT=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,U8=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var s=(a=n&&zf?.[n])!==null&&a!==void 0?a:[],o=t.startsWith("data-"),l=typeof e!="function"&&(!!n&&s.includes(t)||uT(t)),c=!!r&&qg(t);return o||l||c},Zt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(_.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(s=>{var o;U8((o=n)===null||o===void 0?void 0:o[s],s,t,r)&&(a[s]=n[s])}),a},q8=["children","width","height","viewBox","className","style","title","desc"];function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jv.apply(null,arguments)}function W8(e,t){if(e==null)return{};var r,n,a=H8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function H8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Vg=_.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:d}=e,u=W8(e,q8),f=s||{width:n,height:a,x:0,y:0},h=lt("recharts-surface",o);return _.createElement("svg",jv({},Zt(u,!0,"svg"),{className:h,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),_.createElement("title",null,c),_.createElement("desc",null,d),r)}),V8=["children","className"];function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nv.apply(null,arguments)}function G8(e,t){if(e==null)return{};var r,n,a=K8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function K8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fr=_.forwardRef((e,t)=>{var{children:r,className:n}=e,a=G8(e,V8),s=lt("recharts-layer",n);return _.createElement("g",Nv({className:s},Zt(a,!0),{ref:t}),r)}),hT=_.createContext(null),Y8=()=>_.useContext(hT);function St(e){return function(){return e}}const mT=Math.cos,gu=Math.sin,Ea=Math.sqrt,xu=Math.PI,Sd=2*xu,Ev=Math.PI,_v=2*Ev,Ks=1e-6,X8=_v-Ks;function pT(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Z8(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return pT;const r=10**t;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class J8{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?pT:Z8(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,s,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,a,s){if(t=+t,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,u=o-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Ks)if(!(Math.abs(f*c-d*u)>Ks)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,p=a-l,v=c*c+d*d,g=m*m+p*p,x=Math.sqrt(v),b=Math.sqrt(h),y=s*Math.tan((Ev-Math.acos((v+h-g)/(2*x*b)))/2),w=y/b,j=y/x;Math.abs(w-1)>Ks&&this._append`L${t+w*u},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*m>u*p)},${this._x1=t+j*c},${this._y1=r+j*d}`}}arc(t,r,n,a,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^o,h=o?a-s:s-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Ks||Math.abs(this._y1-u)>Ks)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%_v+_v),h>X8?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>Ks&&this._append`A${n},${n},0,${+(h>=Ev)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Gg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new J8(t)}function Kg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vT(e){this._context=e}vT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Td(e){return new vT(e)}function gT(e){return e[0]}function xT(e){return e[1]}function yT(e,t){var r=St(!0),n=null,a=Td,s=null,o=Gg(l);e=typeof e=="function"?e:e===void 0?gT:St(e),t=typeof t=="function"?t:t===void 0?xT:St(t);function l(c){var d,u=(c=Kg(c)).length,f,h=!1,m;for(n==null&&(s=a(m=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,d,c),+t(f,d,c));if(m)return s=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:St(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:St(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:St(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function Ic(e,t,r){var n=null,a=St(!0),s=null,o=Td,l=null,c=Gg(d);e=typeof e=="function"?e:e===void 0?gT:St(+e),t=typeof t=="function"?t:St(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?xT:St(+r);function d(f){var h,m,p,v=(f=Kg(f)).length,g,x=!1,b,y=new Array(v),w=new Array(v);for(s==null&&(l=o(b=c())),h=0;h<=v;++h){if(!(h<v&&a(g=f[h],h,f))===x)if(x=!x)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=h-1;p>=m;--p)l.point(y[p],w[p]);l.lineEnd(),l.areaEnd()}x&&(y[h]=+e(g,h,f),w[h]=+t(g,h,f),l.point(n?+n(g,h,f):y[h],r?+r(g,h,f):w[h]))}if(b)return l=null,b+""||null}function u(){return yT().defined(a).curve(o).context(s)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:St(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:St(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:St(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:St(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:St(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:St(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:St(!!f),d):a},d.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),d):o},d.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),d):s},d}class bT{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Q8(e){return new bT(e,!0)}function eF(e){return new bT(e,!1)}const Yg={draw(e,t){const r=Ea(t/xu);e.moveTo(r,0),e.arc(0,0,r,0,Sd)}},tF={draw(e,t){const r=Ea(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},wT=Ea(1/3),rF=wT*2,nF={draw(e,t){const r=Ea(t/rF),n=r*wT;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},aF={draw(e,t){const r=Ea(t),n=-r/2;e.rect(n,n,r,r)}},sF=.8908130915292852,jT=gu(xu/10)/gu(7*xu/10),iF=gu(Sd/10)*jT,oF=-mT(Sd/10)*jT,lF={draw(e,t){const r=Ea(t*sF),n=iF*r,a=oF*r;e.moveTo(0,-r),e.lineTo(n,a);for(let s=1;s<5;++s){const o=Sd*s/5,l=mT(o),c=gu(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},qf=Ea(3),cF={draw(e,t){const r=-Ea(t/(qf*3));e.moveTo(0,r*2),e.lineTo(-qf*r,-r),e.lineTo(qf*r,-r),e.closePath()}},Un=-.5,qn=Ea(3)/2,Sv=1/Ea(12),uF=(Sv/2+1)*3,dF={draw(e,t){const r=Ea(t/uF),n=r/2,a=r*Sv,s=n,o=r*Sv+r,l=-s,c=o;e.moveTo(n,a),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(Un*n-qn*a,qn*n+Un*a),e.lineTo(Un*s-qn*o,qn*s+Un*o),e.lineTo(Un*l-qn*c,qn*l+Un*c),e.lineTo(Un*n+qn*a,Un*a-qn*n),e.lineTo(Un*s+qn*o,Un*o-qn*s),e.lineTo(Un*l+qn*c,Un*c-qn*l),e.closePath()}};function fF(e,t){let r=null,n=Gg(a);e=typeof e=="function"?e:St(e||Yg),t=typeof t=="function"?t:St(t===void 0?64:+t);function a(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:St(s),a):e},a.size=function(s){return arguments.length?(t=typeof s=="function"?s:St(+s),a):t},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function yu(){}function bu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function NT(e){this._context=e}NT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hF(e){return new NT(e)}function ET(e){this._context=e}ET.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mF(e){return new ET(e)}function _T(e){this._context=e}_T.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pF(e){return new _T(e)}function ST(e){this._context=e}ST.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function vF(e){return new ST(e)}function yb(e){return e<0?-1:1}function bb(e,t,r){var n=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(yb(s)+yb(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function wb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Wf(e,t,r){var n=e._x0,a=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,a+l*t,s-l,o-l*r,s,o)}function wu(e){this._context=e}wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Wf(this,this._t0,wb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Wf(this,wb(this,r=bb(this,e,t)),r);break;default:Wf(this,this._t0,r=bb(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function TT(e){this._context=new AT(e)}(TT.prototype=Object.create(wu.prototype)).point=function(e,t){wu.prototype.point.call(this,t,e)};function AT(e){this._context=e}AT.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,s){this._context.bezierCurveTo(t,e,n,r,s,a)}};function gF(e){return new wu(e)}function xF(e){return new TT(e)}function kT(e){this._context=e}kT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=jb(e),a=jb(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function jb(e){var t,r=e.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function yF(e){return new kT(e)}function Ad(e,t){this._context=e,this._t=t}Ad.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function bF(e){return new Ad(e,.5)}function wF(e){return new Ad(e,0)}function jF(e){return new Ad(e,1)}function so(e,t){if((o=e.length)>1)for(var r=1,n,a,s=e[t[0]],o,l=s.length;r<o;++r)for(a=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Tv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function NF(e,t){return e[t]}function EF(e){const t=[];return t.key=e,t}function _F(){var e=St([]),t=Tv,r=so,n=NF;function a(s){var o=Array.from(e.apply(this,arguments),EF),l,c=o.length,d=-1,u;for(const f of s)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(f,o[l].key,d,s)]).data=f;for(l=0,u=Kg(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(s){return arguments.length?(e=typeof s=="function"?s:St(Array.from(s)),a):e},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:St(+s),a):n},a.order=function(s){return arguments.length?(t=s==null?Tv:typeof s=="function"?s:St(Array.from(s)),a):t},a.offset=function(s){return arguments.length?(r=s??so,a):r},a}function SF(e,t){if((n=e.length)>0){for(var r,n,a=0,s=e[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}so(e,t)}}function TF(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}so(e,t)}}function AF(e,t){if(!(!((o=e.length)>0)||!((s=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,m=(f-h)/2,p=0;p<l;++p){var v=e[t[p]],g=v[n][1]||0,x=v[n-1][1]||0;m+=g-x}c+=f,d+=m*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,so(e,t)}}var kF=["type","size","sizeType"];function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(null,arguments)}function Nb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nb(Object(r),!0).forEach(function(n){OF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OF(e,t,r){return(t=CF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CF(e){var t=PF(e,"string");return typeof t=="symbol"?t:t+""}function PF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DF(e,t){if(e==null)return{};var r,n,a=IF(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function IF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var OT={symbolCircle:Yg,symbolCross:tF,symbolDiamond:nF,symbolSquare:aF,symbolStar:lF,symbolTriangle:cF,symbolWye:dF},RF=Math.PI/180,FF=e=>{var t="symbol".concat(tc(e));return OT[t]||Yg},LF=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*RF;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},MF=(e,t)=>{OT["symbol".concat(tc(e))]=t},Xg=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=DF(e,kF),s=Eb(Eb({},a),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var h=FF(o),m=fF().type(h).size(LF(r,n,o));return m()},{className:c,cx:d,cy:u}=s,f=Zt(s,!0);return d===+d&&u===+u&&r===+r?_.createElement("path",Av({},f,{className:lt("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};Xg.registerSymbol=MF;function kv(){return kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kv.apply(null,arguments)}function _b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function BF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_b(Object(r),!0).forEach(function(n){Zg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_b(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zg(e,t,r){return(t=$F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $F(e){var t=zF(e,"string");return typeof t=="symbol"?t:t+""}function zF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wn=32;class Jg extends _.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Wn/2,s=Wn/6,o=Wn/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return _.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Wn,y2:a,className:"recharts-legend-icon"});if(c==="line")return _.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Wn,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return _.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Wn/8,"h").concat(Wn,"v").concat(Wn*3/4,"h").concat(-Wn,"z"),className:"recharts-legend-icon"});if(_.isValidElement(t.legendIcon)){var d=BF({},t);return delete d.legendIcon,_.cloneElement(t.legendIcon,d)}return _.createElement(Xg,{fill:l,cx:a,cy:a,size:Wn,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=this.props,l={x:0,y:0,width:Wn,height:Wn},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((u,f)=>{var h=u.formatter||a,m=lt({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:u.inactive});if(u.type==="none")return null;var p=u.inactive?s:u.color,v=h?h(u.value,u,f):u.value;return _.createElement("li",kv({className:m,style:c,key:"legend-item-".concat(f)},rc(this.props,u,f)),_.createElement(Vg,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(v," legend icon")},this.renderIcon(u,o)),_.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},v))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return _.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Zg(Jg,"displayName","Legend");Zg(Jg,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Hf={},Vf={},Sb;function UF(){return Sb||(Sb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}e.uniqBy=t})(Vf)),Vf}var Gf={},Tb;function CT(){return Tb||(Tb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Gf)),Gf}var Kf={},Yf={},Xf={},Ab;function qF(){return Ab||(Ab=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Xf)),Xf}var kb;function Qg(){return kb||(kb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qF();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Yf)),Yf}var Zf={},Ob;function WF(){return Ob||(Ob=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Zf)),Zf}var Cb;function HF(){return Cb||(Cb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Qg(),r=WF();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Kf)),Kf}var Jf={},Qf={},Pb;function VF(){return Pb||(Pb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ug();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Qf)),Qf}var eh={},th={},rh={},nh={},Db;function PT(){return Db||(Db=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(nh)),nh}var ah={},Ib;function DT(){return Ib||(Ib=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(ah)),ah}var sh={},Rb;function IT(){return Rb||(Rb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(sh)),sh}var Fb;function GF(){return Fb||(Fb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ex(),r=PT(),n=DT(),a=IT();function s(f,h,m){return typeof m!="function"?t.isMatch(f,h):o(f,h,function p(v,g,x,b,y,w){const j=m(v,g,x,b,y,w);return j!==void 0?!!j:o(v,g,p,w)},new Map)}function o(f,h,m,p){if(h===f)return!0;switch(typeof h){case"object":return l(f,h,m,p);case"function":return Object.keys(h).length>0?o(f,{...h},m,p):a.eq(f,h);default:return r.isObject(f)?typeof h=="string"?h==="":!0:a.eq(f,h)}}function l(f,h,m,p){if(h==null)return!0;if(Array.isArray(h))return d(f,h,m,p);if(h instanceof Map)return c(f,h,m,p);if(h instanceof Set)return u(f,h,m,p);const v=Object.keys(h);if(f==null)return v.length===0;if(v.length===0)return!0;if(p&&p.has(h))return p.get(h)===f;p&&p.set(h,f);try{for(let g=0;g<v.length;g++){const x=v[g];if(!n.isPrimitive(f)&&!(x in f)||h[x]===void 0&&f[x]!==void 0||h[x]===null&&f[x]!==null||!m(f[x],h[x],x,f,h,p))return!1}return!0}finally{p&&p.delete(h)}}function c(f,h,m,p){if(h.size===0)return!0;if(!(f instanceof Map))return!1;for(const[v,g]of h.entries()){const x=f.get(v);if(m(x,g,v,f,h,p)===!1)return!1}return!0}function d(f,h,m,p){if(h.length===0)return!0;if(!Array.isArray(f))return!1;const v=new Set;for(let g=0;g<h.length;g++){const x=h[g];let b=!1;for(let y=0;y<f.length;y++){if(v.has(y))continue;const w=f[y];let j=!1;if(m(w,x,g,f,h,p)&&(j=!0),j){v.add(y),b=!0;break}}if(!b)return!1}return!0}function u(f,h,m,p){return h.size===0?!0:f instanceof Set?d([...f],[...h],m,p):!1}e.isMatchWith=s,e.isSetMatch=u})(rh)),rh}var Lb;function ex(){return Lb||(Lb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GF();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(th)),th}var ih={},oh={},lh={},Mb;function KF(){return Mb||(Mb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(lh)),lh}var ch={},Bb;function RT(){return Bb||(Bb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(ch)),ch}var uh={},$b;function FT(){return $b||($b=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",f="[object Function]",h="[object ArrayBuffer]",m="[object Object]",p="[object Error]",v="[object DataView]",g="[object Uint8Array]",x="[object Uint8ClampedArray]",b="[object Uint16Array]",y="[object Uint32Array]",w="[object BigUint64Array]",j="[object Int8Array]",N="[object Int16Array]",E="[object Int32Array]",S="[object BigInt64Array]",O="[object Float32Array]",k="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=h,e.arrayTag=u,e.bigInt64ArrayTag=S,e.bigUint64ArrayTag=w,e.booleanTag=a,e.dataViewTag=v,e.dateTag=l,e.errorTag=p,e.float32ArrayTag=O,e.float64ArrayTag=k,e.functionTag=f,e.int16ArrayTag=N,e.int32ArrayTag=E,e.int8ArrayTag=j,e.mapTag=c,e.numberTag=n,e.objectTag=m,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=b,e.uint32ArrayTag=y,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=x})(uh)),uh}var dh={},zb;function YF(){return zb||(zb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(dh)),dh}var Ub;function LT(){return Ub||(Ub=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KF(),r=RT(),n=FT(),a=DT(),s=YF();function o(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,h,m=new Map,p=void 0){const v=p?.(u,f,h,m);if(v!==void 0)return v;if(a.isPrimitive(u))return u;if(m.has(u))return m.get(u);if(Array.isArray(u)){const g=new Array(u.length);m.set(u,g);for(let x=0;x<u.length;x++)g[x]=l(u[x],x,h,m,p);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;m.set(u,g);for(const[x,b]of u)g.set(x,l(b,x,h,m,p));return g}if(u instanceof Set){const g=new Set;m.set(u,g);for(const x of u)g.add(l(x,void 0,h,m,p));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);m.set(u,g);for(let x=0;x<u.length;x++)g[x]=l(u[x],x,h,m,p);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return m.set(u,g),c(g,u,h,m,p),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return m.set(u,g),c(g,u,h,m,p),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return m.set(u,g),c(g,u,h,m,p),g}if(u instanceof Error){const g=new u.constructor;return m.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,h,m,p),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return m.set(u,g),c(g,u,h,m,p),g}if(u instanceof Number){const g=new Number(u.valueOf());return m.set(u,g),c(g,u,h,m,p),g}if(u instanceof String){const g=new String(u.valueOf());return m.set(u,g),c(g,u,h,m,p),g}if(typeof u=="object"&&d(u)){const g=Object.create(Object.getPrototypeOf(u));return m.set(u,g),c(g,u,h,m,p),g}return u}function c(u,f,h=u,m,p){const v=[...Object.keys(f),...t.getSymbols(f)];for(let g=0;g<v.length;g++){const x=v[g],b=Object.getOwnPropertyDescriptor(u,x);(b==null||b.writable)&&(u[x]=l(f[x],x,h,m,p))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(oh)),oh}var qb;function XF(){return qb||(qb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LT();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(ih)),ih}var Wb;function ZF(){return Wb||(Wb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ex(),r=XF();function n(a){return a=r.cloneDeep(a),s=>t.isMatch(s,a)}e.matches=n})(eh)),eh}var fh={},hh={},mh={},Hb;function JF(){return Hb||(Hb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LT(),r=FT();function n(a,s){return t.cloneDeepWith(a,(o,l,c,d)=>{const u=s?.(o,l,c,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a?.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(mh)),mh}var Vb;function QF(){return Vb||(Vb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JF();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(hh)),hh}var ph={},vh={},Gb;function MT(){return Gb||(Gb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(vh)),vh}var gh={},Kb;function eL(){return Kb||(Kb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RT();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(gh)),gh}var Yb;function tL(){return Yb||(Yb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oT(),r=MT(),n=eL(),a=zg();function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const f=c[u];if((d==null||!Object.hasOwn(d,f))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(f)&&f<d.length))return!1;d=d[f]}return!0}e.has=s})(ph)),ph}var Xb;function rL(){return Xb||(Xb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ex(),r=$g(),n=QF(),a=Ug(),s=tL();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?s.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(fh)),fh}var Zb;function nL(){return Zb||(Zb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CT(),r=VF(),n=ZF(),a=rL();function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(Jf)),Jf}var Jb;function aL(){return Jb||(Jb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UF(),r=CT(),n=HF(),a=nL();function s(o,l=r.identity){return n.isArrayLikeObject(o)?t.uniqBy(Array.from(o),a.iteratee(l)):[]}e.uniqBy=s})(Hf)),Hf}var xh,Qb;function sL(){return Qb||(Qb=1,xh=aL().uniqBy),xh}var iL=sL();const ew=ss(iL);function BT(e,t,r){return t===!0?ew(e,r):typeof t=="function"?ew(e,t):e}var yh={exports:{}},bh={},wh={exports:{}},jh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tw;function oL(){if(tw)return jh;tw=1;var e=vd();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,s=e.useLayoutEffect,o=e.useDebugValue;function l(f,h){var m=h(),p=n({inst:{value:m,getSnapshot:h}}),v=p[0].inst,g=p[1];return s(function(){v.value=m,v.getSnapshot=h,c(v)&&g({inst:v})},[f,m,h]),a(function(){return c(v)&&g({inst:v}),f(function(){c(v)&&g({inst:v})})},[f]),o(m),m}function c(f){var h=f.getSnapshot;f=f.value;try{var m=h();return!r(f,m)}catch{return!0}}function d(f,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return jh.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,jh}var rw;function lL(){return rw||(rw=1,wh.exports=oL()),wh.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nw;function cL(){if(nw)return bh;nw=1;var e=vd(),t=lL();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,s=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return bh.useSyncExternalStoreWithSelector=function(d,u,f,h,m){var p=s(null);if(p.current===null){var v={hasValue:!1,value:null};p.current=v}else v=p.current;p=l(function(){function x(N){if(!b){if(b=!0,y=N,N=h(N),m!==void 0&&v.hasValue){var E=v.value;if(m(E,N))return w=E}return w=N}if(E=w,n(y,N))return E;var S=h(N);return m!==void 0&&m(E,S)?(y=N,E):(y=N,w=S)}var b=!1,y,w,j=f===void 0?null:f;return[function(){return x(u())},j===null?void 0:function(){return x(j())}]},[u,f,h,m]);var g=a(d,p[0],p[1]);return o(function(){v.hasValue=!0,v.value=g},[g]),c(g),g},bh}var aw;function uL(){return aw||(aw=1,yh.exports=cL()),yh.exports}var dL=uL(),tx=_.createContext(null),fL=e=>e,Wt=()=>{var e=_.useContext(tx);return e?e.store.dispatch:fL},uu=()=>{},hL=()=>uu,mL=(e,t)=>e===t;function We(e){var t=_.useContext(tx);return dL.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:hL,t?t.store.getState:uu,t?t.store.getState:uu,t?e:uu,mL)}function pL(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function vL(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function gL(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var sw=e=>Array.isArray(e)?e:[e];function xL(e){const t=Array.isArray(e[0])?e[0]:e;return gL(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function yL(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var bL=class{constructor(e){this.value=e}deref(){return this.value}},wL=typeof WeakRef<"u"?WeakRef:bL,jL=0,iw=1;function Rc(){return{s:jL,v:void 0,o:null,p:null}}function $T(e,t={}){let r=Rc();const{resultEqualityCheck:n}=t;let a,s=0;function o(){let l=r;const{length:c}=arguments;for(let f=0,h=c;f<h;f++){const m=arguments[f];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const v=p.get(m);v===void 0?(l=Rc(),p.set(m,l)):l=v}else{let p=l.p;p===null&&(l.p=p=new Map);const v=p.get(m);v===void 0?(l=Rc(),p.set(m,l)):l=v}}const d=l;let u;if(l.s===iw)u=l.v;else if(u=e.apply(null,arguments),s++,n){const f=a?.deref?.()??a;f!=null&&n(f,u)&&(u=f,s!==0&&s--),a=typeof u=="object"&&u!==null||typeof u=="function"?new wL(u):u}return d.s=iw,d.v=u,u}return o.clearCache=()=>{r=Rc(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function NL(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let s=0,o=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),pL(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:m=$T,argsMemoizeOptions:p=[]}=u,v=sw(h),g=sw(p),x=xL(a),b=f(function(){return s++,d.apply(null,arguments)},...v),y=m(function(){o++;const j=yL(x,arguments);return l=b.apply(null,j),l},...g);return Object.assign(y,{resultFunc:d,memoizedResultFunc:b,dependencies:x,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var pe=NL($T),EL=Object.assign((e,t=pe)=>{vL(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>EL}),Nh={},Eh={},_h={},ow;function _L(){return ow||(ow=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=t(n),l=t(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(_h)),_h}var Sh={},Th={},lw;function zT(){return lw||(lw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Th)),Th}var cw;function SL(){return cw||(cw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zT(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=a})(Sh)),Sh}var uw;function TL(){return uw||(uw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_L(),r=SL(),n=zg();function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(m=>String(m));const d=(m,p)=>{let v=m;for(let g=0;g<p.length&&v!=null;++g)v=v[p[g]];return v},u=(m,p)=>p==null||m==null?p:typeof m=="object"&&"key"in m?Object.hasOwn(p,m.key)?p[m.key]:d(p,m.path):typeof m=="function"?m(p):Array.isArray(m)?d(p,m):typeof p=="object"?p[m]:p,f=o.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return s.map(m=>({original:m,criteria:f.map(p=>u(p,m))})).slice().sort((m,p)=>{for(let v=0;v<f.length;v++){const g=t.compareValues(m.criteria[v],p.criteria[v],l[v]);if(g!==0)return g}return 0}).map(m=>m.original)}e.orderBy=a})(Eh)),Eh}var Ah={},dw;function AL(){return dw||(dw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<s?o(u,c+1):a.push(u)}};return o(r,0),a}e.flatten=t})(Ah)),Ah}var kh={},fw;function UT(){return fw||(fw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MT(),r=Qg(),n=PT(),a=IT();function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}e.isIterateeCall=s})(kh)),kh}var hw;function kL(){return hw||(hw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TL(),r=AL(),n=UT();function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=a})(Nh)),Nh}var Oh,mw;function OL(){return mw||(mw=1,Oh=kL().sortBy),Oh}var CL=OL();const kd=ss(CL);var qT=e=>e.legend.settings,PL=e=>e.legend.size,DL=e=>e.legend.payload,IL=pe([DL,qT],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?kd(n,r):n});function RL(){return We(IL)}var Fc=1;function WT(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=_.useState({height:0,left:0,top:0,width:0}),n=_.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>Fc||Math.abs(o.left-t.left)>Fc||Math.abs(o.top-t.top)>Fc||Math.abs(o.width-t.width)>Fc)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Or(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var FL=typeof Symbol=="function"&&Symbol.observable||"@@observable",pw=FL,Ch=()=>Math.random().toString(36).substring(7).split("").join("."),LL={INIT:`@@redux/INIT${Ch()}`,REPLACE:`@@redux/REPLACE${Ch()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ch()}`},ju=LL;function rx(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function HT(e,t,r){if(typeof e!="function")throw new Error(Or(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Or(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Or(1));return r(HT)(e,t)}let n=e,a=t,s=new Map,o=s,l=0,c=!1;function d(){o===s&&(o=new Map,s.forEach((g,x)=>{o.set(x,g)}))}function u(){if(c)throw new Error(Or(3));return a}function f(g){if(typeof g!="function")throw new Error(Or(4));if(c)throw new Error(Or(5));let x=!0;d();const b=l++;return o.set(b,g),function(){if(x){if(c)throw new Error(Or(6));x=!1,d(),o.delete(b),s=null}}}function h(g){if(!rx(g))throw new Error(Or(7));if(typeof g.type>"u")throw new Error(Or(8));if(typeof g.type!="string")throw new Error(Or(17));if(c)throw new Error(Or(9));try{c=!0,a=n(a,g)}finally{c=!1}return(s=o).forEach(b=>{b()}),g}function m(g){if(typeof g!="function")throw new Error(Or(10));n=g,h({type:ju.REPLACE})}function p(){const g=f;return{subscribe(x){if(typeof x!="object"||x===null)throw new Error(Or(11));function b(){const w=x;w.next&&w.next(u())}return b(),{unsubscribe:g(b)}},[pw](){return this}}}return h({type:ju.INIT}),{dispatch:h,subscribe:f,getState:u,replaceReducer:m,[pw]:p}}function ML(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:ju.INIT})>"u")throw new Error(Or(12));if(typeof r(void 0,{type:ju.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Or(13))})}function VT(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{ML(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<n.length;u++){const f=n[u],h=r[f],m=o[f],p=h(m,l);if(typeof p>"u")throw l&&l.type,new Error(Or(14));d[f]=p,c=c||p!==m}return c=c||n.length!==Object.keys(o).length,c?d:o}}function Nu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function BL(...e){return t=>(r,n)=>{const a=t(r,n);let s=()=>{throw new Error(Or(15))};const o={getState:a.getState,dispatch:(c,...d)=>s(c,...d)},l=e.map(c=>c(o));return s=Nu(...l)(a.dispatch),{...a,dispatch:s}}}function GT(e){return rx(e)&&"type"in e&&typeof e.type=="string"}var KT=Symbol.for("immer-nothing"),vw=Symbol.for("immer-draftable"),In=Symbol.for("immer-state");function da(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var io=Object.getPrototypeOf;function yi(e){return!!e&&!!e[In]}function es(e){return e?YT(e)||Array.isArray(e)||!!e[vw]||!!e.constructor?.[vw]||nc(e)||Cd(e):!1}var $L=Object.prototype.constructor.toString();function YT(e){if(!e||typeof e!="object")return!1;const t=io(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===$L}function Eu(e,t){Od(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Od(e){const t=e[In];return t?t.type_:Array.isArray(e)?1:nc(e)?2:Cd(e)?3:0}function Ov(e,t){return Od(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function XT(e,t,r){const n=Od(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function zL(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function nc(e){return e instanceof Map}function Cd(e){return e instanceof Set}function Ys(e){return e.copy_||e.base_}function Cv(e,t){if(nc(e))return new Map(e);if(Cd(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=YT(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[In];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(io(e),n)}else{const n=io(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function nx(e,t=!1){return Pd(e)||yi(e)||!es(e)||(Od(e)>1&&Object.defineProperties(e,{set:{value:Lc},add:{value:Lc},clear:{value:Lc},delete:{value:Lc}}),Object.freeze(e),t&&Object.values(e).forEach(r=>nx(r,!0))),e}function Lc(){da(2)}function Pd(e){return Object.isFrozen(e)}var UL={};function bi(e){const t=UL[e];return t||da(0,e),t}var jl;function ZT(){return jl}function qL(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function gw(e,t){t&&(bi("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Pv(e){Dv(e),e.drafts_.forEach(WL),e.drafts_=null}function Dv(e){e===jl&&(jl=e.parent_)}function xw(e){return jl=qL(jl,e)}function WL(e){const t=e[In];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function yw(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[In].modified_&&(Pv(t),da(4)),es(e)&&(e=_u(t,e),t.parent_||Su(t,e)),t.patches_&&bi("Patches").generateReplacementPatches_(r[In].base_,e,t.patches_,t.inversePatches_)):e=_u(t,r,[]),Pv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==KT?e:void 0}function _u(e,t,r){if(Pd(t))return t;const n=t[In];if(!n)return Eu(t,(a,s)=>bw(e,n,t,a,s,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Su(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let s=a,o=!1;n.type_===3&&(s=new Set(a),a.clear(),o=!0),Eu(s,(l,c)=>bw(e,n,a,l,c,r,o)),Su(e,a,!1),r&&e.patches_&&bi("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function bw(e,t,r,n,a,s,o){if(yi(a)){const l=s&&t&&t.type_!==3&&!Ov(t.assigned_,n)?s.concat(n):void 0,c=_u(e,a,l);if(XT(r,n,c),yi(c))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(es(a)&&!Pd(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;_u(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(nc(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Su(e,a)}}function Su(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&nx(t,r)}function HL(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:ZT(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=ax;r&&(a=[n],s=Nl);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var ax={get(e,t){if(t===In)return e;const r=Ys(e);if(!Ov(r,t))return VL(e,r,t);const n=r[t];return e.finalized_||!es(n)?n:n===Ph(e.base_,t)?(Dh(e),e.copy_[t]=Rv(n,e)):n},has(e,t){return t in Ys(e)},ownKeys(e){return Reflect.ownKeys(Ys(e))},set(e,t,r){const n=JT(Ys(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Ph(Ys(e),t),s=a?.[In];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(zL(r,a)&&(r!==void 0||Ov(e.base_,t)))return!0;Dh(e),Iv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ph(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Dh(e),Iv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ys(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){da(11)},getPrototypeOf(e){return io(e.base_)},setPrototypeOf(){da(12)}},Nl={};Eu(ax,(e,t)=>{Nl[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Nl.deleteProperty=function(e,t){return Nl.set.call(this,e,t,void 0)};Nl.set=function(e,t,r){return ax.set.call(this,e[0],t,r,e[0])};function Ph(e,t){const r=e[In];return(r?Ys(r):e)[t]}function VL(e,t,r){const n=JT(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function JT(e,t){if(!(t in e))return;let r=io(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=io(r)}}function Iv(e){e.modified_||(e.modified_=!0,e.parent_&&Iv(e.parent_))}function Dh(e){e.copy_||(e.copy_=Cv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var GL=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&da(6),n!==void 0&&typeof n!="function"&&da(7);let a;if(es(t)){const s=xw(this),o=Rv(t,void 0);let l=!0;try{a=r(o),l=!1}finally{l?Pv(s):Dv(s)}return gw(s,n),yw(a,s)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===KT&&(a=void 0),this.autoFreeze_&&nx(a,!0),n){const s=[],o=[];bi("Patches").generateReplacementPatches_(t,a,s,o),n(s,o)}return a}else da(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,a;return[this.produce(t,r,(o,l)=>{n=o,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){es(e)||da(8),yi(e)&&(e=Va(e));const t=xw(this),r=Rv(e,void 0);return r[In].isManual_=!0,Dv(t),r}finishDraft(e,t){const r=e&&e[In];(!r||!r.isManual_)&&da(9);const{scope_:n}=r;return gw(n,t),yw(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=bi("Patches").applyPatches_;return yi(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Rv(e,t){const r=nc(e)?bi("MapSet").proxyMap_(e,t):Cd(e)?bi("MapSet").proxySet_(e,t):HL(e,t);return(t?t.scope_:ZT()).drafts_.push(r),r}function Va(e){return yi(e)||da(10,e),QT(e)}function QT(e){if(!es(e)||Pd(e))return e;const t=e[In];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Cv(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Cv(e,!0);return Eu(r,(n,a)=>{XT(r,n,QT(a))}),t&&(t.finalized_=!1),r}var KL=new GL,eA=KL.produce;function tA(e){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,e):a(s)}var YL=tA(),XL=tA,ZL=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Nu:Nu.apply(null,arguments)};function ra(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Cn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>GT(n)&&n.type===e,r}var rA=class Jo extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Jo.prototype)}static get[Symbol.species](){return Jo}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Jo(...t[0].concat(this)):new Jo(...t.concat(this))}};function ww(e){return es(e)?eA(e,()=>{}):e}function Mc(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function JL(e){return typeof e=="boolean"}var QL=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=t??{};let o=new rA;return r&&(JL(r)?o.push(YL):o.push(XL(r.extraArgument))),o},eM="RTK_autoBatch",jw=e=>t=>{setTimeout(t,e)},tM=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:jw(10):e.type==="callback"?e.queueNotification:jw(e.timeout),d=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const f=()=>a&&u(),h=n.subscribe(f);return l.add(u),()=>{h(),l.delete(u)}},dispatch(u){try{return a=!u?.meta?.[eM],s=!a,s&&(o||(o=!0,c(d))),n.dispatch(u)}finally{a=!0}}})},rM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new rA(e);return n&&a.push(tM(typeof n=="object"?n:void 0)),a};function nM(e){const t=QL(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(rx(r))l=VT(r);else throw new Error(Cn(1));let c;typeof n=="function"?c=n(t):c=t();let d=Nu;a&&(d=ZL({trace:!1,...typeof a=="object"&&a}));const u=BL(...c),f=rM(u);let h=typeof o=="function"?o(f):f();const m=d(...h);return HT(l,s,m)}function nA(e){const t={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Cn(28));if(l in t)throw new Error(Cn(29));return t[l]=o,a},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return e(a),[t,r,n]}function aM(e){return typeof e=="function"}function sM(e,t){let[r,n,a]=nA(t),s;if(aM(e))s=()=>ww(e());else{const l=ww(e);s=()=>l}function o(l=s(),c){let d=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,f)=>{if(f)if(yi(u)){const m=f(u,c);return m===void 0?u:m}else{if(es(u))return eA(u,h=>f(h,c));{const h=f(u,c);if(h===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return u},l)}return o.getInitialState=s,o}var iM="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",oM=(e=21)=>{let t="",r=e;for(;r--;)t+=iM[Math.random()*64|0];return t},lM=Symbol.for("rtk-slice-createasyncthunk");function cM(e,t){return`${e}/${t}`}function uM({creators:e}={}){const t=e?.asyncThunk?.[lM];return function(n){const{name:a,reducerPath:s=a}=n;if(!a)throw new Error(Cn(11));const o=(typeof n.reducers=="function"?n.reducers(fM()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(y,w){const j=typeof y=="string"?y:y.type;if(!j)throw new Error(Cn(12));if(j in c.sliceCaseReducersByType)throw new Error(Cn(13));return c.sliceCaseReducersByType[j]=w,d},addMatcher(y,w){return c.sliceMatchers.push({matcher:y,reducer:w}),d},exposeAction(y,w){return c.actionCreators[y]=w,d},exposeCaseReducer(y,w){return c.sliceCaseReducersByName[y]=w,d}};l.forEach(y=>{const w=o[y],j={reducerName:y,type:cM(a,y),createNotation:typeof n.reducers=="function"};mM(w)?vM(j,w,d,t):hM(j,w,d)});function u(){const[y={},w=[],j=void 0]=typeof n.extraReducers=="function"?nA(n.extraReducers):[n.extraReducers],N={...y,...c.sliceCaseReducersByType};return sM(n.initialState,E=>{for(let S in N)E.addCase(S,N[S]);for(let S of c.sliceMatchers)E.addMatcher(S.matcher,S.reducer);for(let S of w)E.addMatcher(S.matcher,S.reducer);j&&E.addDefaultCase(j)})}const f=y=>y,h=new Map,m=new WeakMap;let p;function v(y,w){return p||(p=u()),p(y,w)}function g(){return p||(p=u()),p.getInitialState()}function x(y,w=!1){function j(E){let S=E[y];return typeof S>"u"&&w&&(S=Mc(m,j,g)),S}function N(E=f){const S=Mc(h,w,()=>new WeakMap);return Mc(S,E,()=>{const O={};for(const[k,T]of Object.entries(n.selectors??{}))O[k]=dM(T,E,()=>Mc(m,E,g),w);return O})}return{reducerPath:y,getSelectors:N,get selectors(){return N(j)},selectSlice:j}}const b={name:a,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...x(s),injectInto(y,{reducerPath:w,...j}={}){const N=w??s;return y.inject({reducerPath:N,reducer:v},j),{...b,...x(N,!0)}}};return b}}function dM(e,t,r,n){function a(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return a.unwrapped=e,a}var Mn=uM();function fM(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function hM({type:e,reducerName:t,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!pM(n))throw new Error(Cn(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?ra(e,o):ra(e))}function mM(e){return e._reducerDefinitionType==="asyncThunk"}function pM(e){return e._reducerDefinitionType==="reducerWithPrepare"}function vM({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Cn(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,f=a(e,s,u);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),d&&n.addMatcher(f.settled,d),n.exposeCaseReducer(t,{fulfilled:o||Bc,pending:l||Bc,rejected:c||Bc,settled:d||Bc})}function Bc(){}var gM="task",aA="listener",sA="completed",sx="cancelled",xM=`task-${sx}`,yM=`task-${sA}`,Fv=`${aA}-${sx}`,bM=`${aA}-${sA}`,Dd=class{constructor(e){this.code=e,this.message=`${gM} ${sx} (reason: ${e})`}name="TaskAbortError";message},ix=(e,t)=>{if(typeof e!="function")throw new TypeError(Cn(32))},Tu=()=>{},iA=(e,t=Tu)=>(e.catch(t),e),oA=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),si=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},ii=e=>{if(e.aborted){const{reason:t}=e;throw new Dd(t)}};function lA(e,t){let r=Tu;return new Promise((n,a)=>{const s=()=>a(new Dd(e.reason));if(e.aborted){s();return}r=oA(e,s),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Tu})}var wM=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Dd?"cancelled":"rejected",error:r}}finally{t?.()}},Au=e=>t=>iA(lA(e,t).then(r=>(ii(e),r))),cA=e=>{const t=Au(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Ki}=Object,Nw={},Id="listenerMiddleware",jM=(e,t)=>{const r=n=>oA(e,()=>si(n,e.reason));return(n,a)=>{ix(n);const s=new AbortController;r(s);const o=wM(async()=>{ii(e),ii(s.signal);const l=await n({pause:Au(s.signal),delay:cA(s.signal),signal:s.signal});return ii(s.signal),l},()=>si(s,yM));return a?.autoJoin&&t.push(o.catch(Tu)),{result:Au(e)(o),cancel(){si(s,xM)}}}},NM=(e,t)=>{const r=async(n,a)=>{ii(t);let s=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});s=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await lA(t,Promise.race(l));return ii(t),c}finally{s()}};return(n,a)=>iA(r(n,a))},uA=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:s}=e;if(t)a=ra(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Cn(21));return ix(s),{predicate:a,type:t,effect:s}},dA=Ki(e=>{const{type:t,predicate:r,effect:n}=uA(e);return{id:oM(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Cn(22))}}},{withTypes:()=>dA}),Ew=(e,t)=>{const{type:r,effect:n,predicate:a}=uA(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},Lv=e=>{e.pending.forEach(t=>{si(t,Fv)})},EM=e=>()=>{e.forEach(Lv),e.clear()},_w=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},fA=Ki(ra(`${Id}/add`),{withTypes:()=>fA}),_M=ra(`${Id}/removeAll`),hA=Ki(ra(`${Id}/remove`),{withTypes:()=>hA}),SM=(...e)=>{console.error(`${Id}/error`,...e)},ac=(e={})=>{const t=new Map,{extra:r,onError:n=SM}=e;ix(n);const a=u=>(u.unsubscribe=()=>t.delete(u.id),t.set(u.id,u),f=>{u.unsubscribe(),f?.cancelActive&&Lv(u)}),s=u=>{const f=Ew(t,u)??dA(u);return a(f)};Ki(s,{withTypes:()=>s});const o=u=>{const f=Ew(t,u);return f&&(f.unsubscribe(),u.cancelActive&&Lv(f)),!!f};Ki(o,{withTypes:()=>o});const l=async(u,f,h,m)=>{const p=new AbortController,v=NM(s,p.signal),g=[];try{u.pending.add(p),await Promise.resolve(u.effect(f,Ki({},h,{getOriginalState:m,condition:(x,b)=>v(x,b).then(Boolean),take:v,delay:cA(p.signal),pause:Au(p.signal),extra:r,signal:p.signal,fork:jM(p.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{t.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((x,b,y)=>{x!==p&&(si(x,Fv),y.delete(x))})},cancel:()=>{si(p,Fv),u.pending.delete(p)},throwIfCancelled:()=>{ii(p.signal)}})))}catch(x){x instanceof Dd||_w(n,x,{raisedBy:"effect"})}finally{await Promise.all(g),si(p,bM),u.pending.delete(p)}},c=EM(t);return{middleware:u=>f=>h=>{if(!GT(h))return f(h);if(fA.match(h))return s(h.payload);if(_M.match(h)){c();return}if(hA.match(h))return o(h.payload);let m=u.getState();const p=()=>{if(m===Nw)throw new Error(Cn(23));return m};let v;try{if(v=f(h),t.size>0){const g=u.getState(),x=Array.from(t.values());for(const b of x){let y=!1;try{y=b.predicate(h,g,m)}catch(w){y=!1,_w(n,w,{raisedBy:"predicate"})}y&&l(b,h,u,p)}}}finally{m=Nw}return v},startListening:s,stopListening:o,clearListeners:c}};function Cn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var TM={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},mA=Mn({name:"chartLayout",initialState:TM,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:AM,setLayout:kM,setChartSize:OM,setScale:CM}=mA.actions,PM=mA.reducer;function Sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sw(Object(r),!0).forEach(function(n){DM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DM(e,t,r){return(t=IM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IM(e){var t=RM(e,"string");return typeof t=="symbol"?t:t+""}function RM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ku=Math.PI/180,FM=e=>e*180/Math.PI,lr=(e,t,r,n)=>({x:e+Math.cos(-ku*n)*r,y:t+Math.sin(-ku*n)*r}),pA=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},LM=(e,t)=>{var{x:r,y:n}=e,{x:a,y:s}=t;return Math.sqrt((r-a)**2+(n-s)**2)},MM=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:s}=t,o=LM({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:FM(c),angleInRadian:c}},BM=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:t-s*360,endAngle:r-s*360}},$M=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return e+o*360},zM=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:s}=MM({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:d}=BM(t),u=s,f;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;f=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=c}return f?Tw(Tw({},t),{},{radius:a,angle:$M(u,t)}):null};function vA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aw(Object(r),!0).forEach(function(n){UM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UM(e,t,r){return(t=qM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qM(e){var t=WM(e,"string");return typeof t=="symbol"?t:t+""}function WM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tt(e,t,r){return Ut(e)||Ut(t)?r:Ia(t)?xi(e,t,r):typeof t=="function"?t(e):r}var HM=(e,t,r,n,a)=>{var s,o=-1,l=(s=t?.length)!==null&&s!==void 0?s:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?r[c-1].coordinate:r[l-1].coordinate,u=r[c].coordinate,f=c>=l-1?r[0].coordinate:r[c+1].coordinate,h=void 0;if(_r(u-d)!==_r(f-u)){var m=[];if(_r(f-u)===_r(a[1]-a[0])){h=f;var p=u+a[1]-a[0];m[0]=Math.min(p,(p+d)/2),m[1]=Math.max(p,(p+d)/2)}else{h=d;var v=f+a[1]-a[0];m[0]=Math.min(u,(v+u)/2),m[1]=Math.max(u,(v+u)/2)}var g=[Math.min(u,(h+u)/2),Math.max(u,(h+u)/2)];if(e>g[0]&&e<=g[1]||e>=m[0]&&e<=m[1]){({index:o}=r[c]);break}}else{var x=Math.min(d,f),b=Math.max(d,f);if(e>(x+u)/2&&e<=(b+u)/2){({index:o}=r[c]);break}}}else if(t){for(var y=0;y<l;y++)if(y===0&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:o}=t[y]);break}}return o},VM=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&qe(e[s]))return Jn(Jn({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&qe(e[o]))return Jn(Jn({},e),{},{[o]:e[o]+(a||0)})}return e},os=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",gA=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,s,o=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(s=!0),l.coordinate));return a||o.push(t),s||o.push(r),o},xA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:f,niceTicks:h,axisType:m}=e;if(!o)return null;var p=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,v=a==="category"&&o.bandwidth?o.bandwidth()/p:0;if(v=m==="angleAxis"&&s&&s.length>=2?_r(s[0]-s[1])*2*v:v,f||h){var g=(f||h||[]).map((x,b)=>{var y=n?n.indexOf(x):x;return{coordinate:o(y)+v,value:x,offset:v,index:b}});return g.filter(x=>!xn(x.coordinate))}return c&&d?d.map((x,b)=>({coordinate:o(x)+v,value:x,index:b,offset:v})):o.ticks&&u!=null?o.ticks(u).map((x,b)=>({coordinate:o(x)+v,value:x,offset:v,index:b})):o.domain().map((x,b)=>({coordinate:o(x)+v,value:n?n[x]:x,index:b,offset:v}))},kw=1e-4,GM=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-kw,s=Math.max(n[0],n[1])+kw,o=e(t[0]),l=e(t[r-1]);(o<a||o>s||l<a||l>s)&&e.domain([t[0],t[r-1]])}},KM=(e,t)=>{if(!t||t.length!==2||!qe(t[0])||!qe(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!qe(e[0])||e[0]<r)&&(a[0]=r),(!qe(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},YM=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,s=0,o=0;o<t;++o){var l=xn(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=a,e[o][r][1]=a+l,a=e[o][r][1]):(e[o][r][0]=s,e[o][r][1]=s+l,s=e[o][r][1])}},XM=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,s=0;s<t;++s){var o=xn(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}},ZM={sign:YM,expand:SF,none:so,silhouette:TF,wiggle:AF,positive:XM},JM=(e,t,r)=>{var n=ZM[r],a=_F().keys(t).value((s,o)=>+Tt(s,o,0)).order(Tv).offset(n);return a(e)};function yA(e){return e==null?void 0:String(e)}function Ow(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ut(a[t.dataKey])){var l=cT(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var c=Tt(a,Ut(o)?t.dataKey:o);return Ut(c)?null:t.scale(c)}var Cw=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Tt(s,t.dataKey,t.scale.domain()[o]);return Ut(l)?null:t.scale(l)-a/2+n},QM=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},e7=e=>{var t=e.flat(2).filter(qe);return[Math.min(...t),Math.max(...t)]},t7=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],r7=(e,t,r)=>{if(e!=null)return t7(Object.keys(e).reduce((n,a)=>{var s=e[a],{stackedData:o}=s,l=o.reduce((c,d)=>{var u=vA(d,t,r),f=e7(u);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},Pw=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Dw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,El=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=kd(t,u=>u.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],d=a[o-1];s=Math.min((c.coordinate||0)-(d.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0};function Iw(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:s}=e;return Jn(Jn({},t),{},{dataKey:r,payload:n,value:a,name:s})}function No(e,t){if(e)return String(e);if(typeof t=="string")return t}function n7(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var s=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return s?{x:e,y:t}:null}return n?zM({x:e,y:t},n):null}var a7=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var s=a.coordinate,{radius:o}=n;return Jn(Jn(Jn({},n),lr(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return Jn(Jn(Jn({},n),lr(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},s7=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,ls=e=>e.layout.width,cs=e=>e.layout.height,i7=e=>e.layout.scale,bA=e=>e.layout.margin,Rd=pe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Fd=pe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),wA="data-recharts-item-index",jA="data-recharts-item-data-key",sc=60;function Rw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $c(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rw(Object(r),!0).forEach(function(n){o7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o7(e,t,r){return(t=l7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l7(e){var t=c7(e,"string");return typeof t=="symbol"?t:t+""}function c7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u7=e=>e.brush.height;function d7(e){var t=Fd(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:sc;return r+a}return r},0)}function f7(e){var t=Fd(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:sc;return r+a}return r},0)}function h7(e){var t=Rd(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function m7(e){var t=Rd(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var yr=pe([ls,cs,bA,u7,d7,f7,h7,m7,qT,PL],(e,t,r,n,a,s,o,l,c,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},h=$c($c({},f),u),m=h.bottom;h.bottom+=n,h=VM(h,c,d);var p=e-h.left-h.right,v=t-h.top-h.bottom;return $c($c({brushBottom:m},h),{},{width:Math.max(p,0),height:Math.max(v,0)})}),p7=pe(yr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ox=pe(ls,cs,(e,t)=>({x:0,y:0,width:e,height:t})),v7=_.createContext(null),wn=()=>_.useContext(v7)!=null,Ld=e=>e.brush,Md=pe([Ld,yr,bA],(e,t,r)=>({height:e.height,x:qe(e.x)?e.x:t.left,y:qe(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:qe(e.width)?e.width:t.width})),lx=()=>{var e,t=wn(),r=We(p7),n=We(Md),a=(e=We(Ld))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},g7={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},NA=()=>{var e;return(e=We(yr))!==null&&e!==void 0?e:g7},cx=()=>We(ls),ux=()=>We(cs),x7=()=>We(e=>e.layout.margin),ut=e=>e.layout.layoutType,Bd=()=>We(ut),y7={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},EA=Mn({name:"legend",initialState:y7,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Va(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Fw,setLegendSettings:b7,addLegendPayload:_A,removeLegendPayload:SA}=EA.actions,w7=EA.reducer,j7=["contextPayload"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(null,arguments)}function Lw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lw(Object(r),!0).forEach(function(n){dx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dx(e,t,r){return(t=N7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N7(e){var t=E7(e,"string");return typeof t=="symbol"?t:t+""}function E7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _7(e,t){if(e==null)return{};var r,n,a=S7(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function S7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function T7(e){return e.value}function A7(e){var{contextPayload:t}=e,r=_7(e,j7),n=BT(t,e.payloadUniqBy,T7),a=oo(oo({},r),{},{payload:n});return _.isValidElement(e.content)?_.cloneElement(e.content,a):typeof e.content=="function"?_.createElement(e.content,a):_.createElement(Jg,a)}function k7(e,t,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=t,d,u;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?d={left:((n||0)-s.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?u={top:((a||0)-s.height)/2}:u=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),oo(oo({},d),u)}function O7(e){var t=Wt();return _.useEffect(()=>{t(b7(e))},[t,e]),null}function C7(e){var t=Wt();return _.useEffect(()=>(t(Fw(e)),()=>{t(Fw({width:0,height:0}))}),[t,e]),null}function P7(e){var t=RL(),r=Y8(),n=x7(),{width:a,height:s,wrapperStyle:o,portal:l}=e,[c,d]=WT([t]),u=cx(),f=ux();if(u==null||f==null)return null;var h=u-(n.left||0)-(n.right||0),m=Yi.getWidthOrHeight(e.layout,s,a,h),p=l?o:oo(oo({position:"absolute",width:m?.width||a||"auto",height:m?.height||s||"auto"},k7(o,e,n,u,f,c)),o),v=l??r;if(v==null)return null;var g=_.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},_.createElement(O7,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),_.createElement(C7,{width:c.width,height:c.height}),_.createElement(A7,Mv({},e,m,{margin:n,chartWidth:u,chartHeight:f,contextPayload:t})));return pd.createPortal(g,v)}class Yi extends _.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&qe(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return _.createElement(P7,this.props)}}dx(Yi,"displayName","Legend");dx(Yi,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bv.apply(null,arguments)}function Mw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mw(Object(r),!0).forEach(function(n){D7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D7(e,t,r){return(t=I7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I7(e){var t=R7(e,"string");return typeof t=="symbol"?t:t+""}function R7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F7(e){return Array.isArray(e)&&Ia(e[0])&&Ia(e[1])?e.join(" ~ "):e}var L7=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:f,accessibilityLayer:h=!1}=e,m=()=>{if(s&&s.length){var j={padding:0,margin:0},N=(l?kd(s,l):s).map((E,S)=>{if(E.type==="none")return null;var O=E.formatter||o||F7,{value:k,name:T}=E,A=k,P=T;if(O){var C=O(k,T,E,S,s);if(Array.isArray(C))[A,P]=C;else if(C!=null)A=C;else return null}var F=Ih({display:"block",paddingTop:4,paddingBottom:4,color:E.color||"#000"},n);return _.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:F},Ia(P)?_.createElement("span",{className:"recharts-tooltip-item-name"},P):null,Ia(P)?_.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,_.createElement("span",{className:"recharts-tooltip-item-value"},A),_.createElement("span",{className:"recharts-tooltip-item-unit"},E.unit||""))});return _.createElement("ul",{className:"recharts-tooltip-item-list",style:j},N)}return null},p=Ih({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=Ih({margin:0},a),g=!Ut(u),x=g?u:"",b=lt("recharts-default-tooltip",c),y=lt("recharts-tooltip-label",d);g&&f&&s!==void 0&&s!==null&&(x=f(u,s));var w=h?{role:"status","aria-live":"assertive"}:{};return _.createElement("div",Bv({className:b,style:p},w),_.createElement("p",{className:y,style:v},_.isValidElement(x)?x:"".concat(x)),m())},qo="recharts-tooltip-wrapper",M7={visibility:"hidden"};function B7(e){var{coordinate:t,translateX:r,translateY:n}=e;return lt(qo,{["".concat(qo,"-right")]:qe(r)&&t&&qe(t.x)&&r>=t.x,["".concat(qo,"-left")]:qe(r)&&t&&qe(t.x)&&r<t.x,["".concat(qo,"-bottom")]:qe(n)&&t&&qe(t.y)&&n>=t.y,["".concat(qo,"-top")]:qe(n)&&t&&qe(t.y)&&n<t.y})}function Bw(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(s&&qe(s[n]))return s[n];var u=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return o[n]?u:f;var h=c[n];if(h==null)return 0;if(o[n]){var m=u,p=h;return m<p?Math.max(f,h):Math.max(u,h)}if(d==null)return 0;var v=f+l,g=h+d;return v>g?Math.max(u,h):Math.max(f,h)}function $7(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function z7(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,d,u,f;return o.height>0&&o.width>0&&r?(u=Bw({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=Bw({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=$7({translateX:u,translateY:f,useTranslate3d:l})):d=M7,{cssProperties:d,cssClasses:B7({translateX:u,translateY:f,coordinate:r})}}function $w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$w(Object(r),!0).forEach(function(n){$v(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$w(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $v(e,t,r){return(t=U7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U7(e){var t=q7(e,"string");return typeof t=="symbol"?t:t+""}function q7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class W7 extends _.PureComponent{constructor(){super(...arguments),$v(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),$v(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:f,useTranslate3d:h,viewBox:m,wrapperStyle:p,lastBoundingBox:v,innerRef:g,hasPortalFromProps:x}=this.props,{cssClasses:b,cssProperties:y}=z7({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:h,viewBox:m}),w=x?{}:zc(zc({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=zc(zc({},w),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},p);return _.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:j,ref:g},s)}}var H7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ls={devToolsEnabled:!1,isSsr:H7()},TA=()=>We(e=>e.rootProps.accessibilityLayer);function Rr(e){return Number.isFinite(e)}function lo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function zv(){return zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zv.apply(null,arguments)}function zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zw(Object(r),!0).forEach(function(n){V7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V7(e,t,r){return(t=G7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G7(e){var t=K7(e,"string");return typeof t=="symbol"?t:t+""}function K7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qw={curveBasisClosed:mF,curveBasisOpen:pF,curveBasis:hF,curveBumpX:Q8,curveBumpY:eF,curveLinearClosed:vF,curveLinear:Td,curveMonotoneX:gF,curveMonotoneY:xF,curveNatural:yF,curveStep:bF,curveStepAfter:jF,curveStepBefore:wF},Uc=e=>Rr(e.x)&&Rr(e.y),Wo=e=>e.x,Ho=e=>e.y,Y7=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(tc(e));return(r==="curveMonotone"||r==="curveBump")&&t?qw["".concat(r).concat(t==="vertical"?"Y":"X")]:qw[r]||Td},X7=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=e,o=Y7(t,a),l=s?r.filter(Uc):r,c;if(Array.isArray(n)){var d=s?n.filter(f=>Uc(f)):n,u=l.map((f,h)=>Uw(Uw({},f),{},{base:d[h]}));return a==="vertical"?c=Ic().y(Ho).x1(Wo).x0(f=>f.base.x):c=Ic().x(Wo).y1(Ho).y0(f=>f.base.y),c.defined(Uc).curve(o),c(u)}return a==="vertical"&&qe(n)?c=Ic().y(Ho).x1(Wo).x0(n):qe(n)?c=Ic().x(Wo).y1(Ho).y0(n):c=yT().x(Wo).y(Ho),c.defined(Uc).curve(o),c(l)},sl=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var s=r&&r.length?X7(e):n;return _.createElement("path",zv({},Na(e),Wg(e),{className:lt("recharts-curve",t),d:s===null?void 0:s,ref:a}))},Z7=["x","y","top","left","width","height","className"];function Uv(){return Uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uv.apply(null,arguments)}function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function J7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(n){Q7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q7(e,t,r){return(t=eB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eB(e){var t=tB(e,"string");return typeof t=="symbol"?t:t+""}function tB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rB(e,t){if(e==null)return{};var r,n,a=nB(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var aB=(e,t,r,n,a,s)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),sB=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=e,c=rB(e,Z7),d=J7({x:t,y:r,top:n,left:a,width:s,height:o},c);return!qe(t)||!qe(r)||!qe(s)||!qe(o)||!qe(n)||!qe(a)?null:_.createElement("path",Uv({},Zt(d,!0),{className:lt("recharts-cross",l),d:aB(t,r,s,o,n,a)}))};function iB(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Hw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hw(Object(r),!0).forEach(function(n){lB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lB(e,t,r){return(t=cB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cB(e){var t=uB(e,"string");return typeof t=="symbol"?t:t+""}function uB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fr(e,t){var r=oB({},e),n=t,a=Object.keys(t),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function dB(){}function Vw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vw(Object(r),!0).forEach(function(n){fB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fB(e,t,r){return(t=hB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hB(e){var t=mB(e,"string");return typeof t=="symbol"?t:t+""}function mB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pB=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),AA=(e,t,r)=>e.map(n=>"".concat(pB(n)," ").concat(t,"ms ").concat(r)).join(","),vB=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),_l=(e,t)=>Object.keys(t).reduce((r,n)=>Gw(Gw({},r),{},{[n]:e(n,t[n])}),{});function Kw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kw(Object(r),!0).forEach(function(n){gB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gB(e,t,r){return(t=xB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xB(e){var t=yB(e,"string");return typeof t=="symbol"?t:t+""}function yB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ou=(e,t,r)=>e+(t-e)*r,qv=e=>{var{from:t,to:r}=e;return t!==r},kA=(e,t,r)=>{var n=_l((a,s)=>{if(qv(s)){var[o,l]=e(s.from,s.to,s.velocity);return Cr(Cr({},s),{},{from:o,velocity:l})}return s},t);return r<1?_l((a,s)=>qv(s)?Cr(Cr({},s),{},{velocity:Ou(s.velocity,n[a].velocity,r),from:Ou(s.from,n[a].from,r)}):s,t):kA(e,n,r-1)};function bB(e,t,r,n,a,s){var o,l=n.reduce((h,m)=>Cr(Cr({},h),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),c=()=>_l((h,m)=>m.from,l),d=()=>!Object.values(l).filter(qv).length,u=null,f=h=>{o||(o=h);var m=h-o,p=m/r.dt;l=kA(r,l,p),a(Cr(Cr(Cr({},e),t),c())),o=h,d()||(u=s.setTimeout(f))};return()=>(u=s.setTimeout(f),()=>{u()})}function wB(e,t,r,n,a,s,o){var l=null,c=a.reduce((f,h)=>Cr(Cr({},f),{},{[h]:[e[h],t[h]]}),{}),d,u=f=>{d||(d=f);var h=(f-d)/n,m=_l((v,g)=>Ou(...g,r(h)),c);if(s(Cr(Cr(Cr({},e),t),m)),h<1)l=o.setTimeout(u);else{var p=_l((v,g)=>Ou(...g,r(1)),c);s(Cr(Cr(Cr({},e),t),p))}};return()=>(l=o.setTimeout(u),()=>{l()})}const jB=(e,t,r,n,a,s)=>{var o=vB(e,t);return r.isStepper===!0?bB(e,t,r,o,a,s):wB(e,t,r,n,o,a,s)};var Cu=1e-4,OA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],CA=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Yw=(e,t)=>r=>{var n=OA(e,t);return CA(n,r)},NB=(e,t)=>r=>{var n=OA(e,t),a=[...n.map((s,o)=>s*o).slice(1),0];return CA(a,r)},Xw=function(){for(var t,r,n,a,s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];if(o.length===1)switch(o[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else o.length===4&&([t,n,r,a]=o);var d=Yw(t,r),u=Yw(n,a),f=NB(t,r),h=p=>p>1?1:p<0?0:p,m=p=>{for(var v=p>1?1:p,g=v,x=0;x<8;++x){var b=d(g)-v,y=f(g);if(Math.abs(b-v)<Cu||y<Cu)return u(g);g=h(g-b/y)}return u(g)};return m.isStepper=!1,m},EB=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,s=(o,l,c)=>{var d=-(o-l)*r,u=c*n,f=c+(d-u)*a/1e3,h=c*a/1e3+o;return Math.abs(h-l)<Cu&&Math.abs(f)<Cu?[l,0]:[h,f]};return s.isStepper=!0,s.dt=a,s},_B=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Xw(e);case"spring":return EB();default:if(e.split("(")[0]==="cubic-bezier")return Xw(e)}return typeof e=="function"?e:null};function SB(e){var t,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){a=e.setTimeout(s.bind(null,d),c);return}s(c),a=e.setTimeout(s.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class TB{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{cancelAnimationFrame(a)}}}function AB(){return SB(new TB)}var kB=_.createContext(AB);function OB(e,t){var r=_.useContext(kB);return _.useMemo(()=>t??r(e),[e,t,r])}var CB={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Zw={t:0},Rh={t:1};function ic(e){var t=Fr(e,CB),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=OB(t.animationId,t.animationManager),[f,h]=_.useState(r?Zw:Rh),m=_.useRef(null);return _.useEffect(()=>{r||h(Rh)},[r]),_.useEffect(()=>{if(!r||!n)return dB;var p=jB(Zw,Rh,_B(s),a,h,u.getTimeoutController()),v=()=>{m.current=p()};return u.start([c,o,v,a,l]),()=>{u.stop(),m.current&&m.current(),l()}},[r,n,a,s,o,c,l,u]),d(f.t)}function oc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=_.useRef(wl(t)),n=_.useRef(e);return n.current!==e&&(r.current=wl(t),n.current=e),r.current}function Jw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jw(Object(r),!0).forEach(function(n){PB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PB(e,t,r){return(t=DB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DB(e){var t=IB(e,"string");return typeof t=="symbol"?t:t+""}function IB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pu(){return Pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pu.apply(null,arguments)}var e2=(e,t,r,n,a)=>{var s=Math.min(Math.abs(r)/2,Math.abs(n)/2),o=n>=0?1:-1,l=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,d;if(s>0&&a instanceof Array){for(var u=[0,0,0,0],f=0,h=4;f<h;f++)u[f]=a[f]>s?s:a[f];d="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*u[1])),d+="L ".concat(e+r,",").concat(t+n-o*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+r-l*u[2],",").concat(t+n)),d+="L ".concat(e+l*u[3],",").concat(t+n),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-o*u[3])),d+="Z"}else if(s>0&&a===+a&&a>0){var m=Math.min(s,a);d="M ".concat(e,",").concat(t+o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+l*m,",").concat(t,`
            L `).concat(e+r-l*m,",").concat(t,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*m,`
            L `).concat(e+r,",").concat(t+n-o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+r-l*m,",").concat(t+n,`
            L `).concat(e+l*m,",").concat(t+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e,",").concat(t+n-o*m," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},RB={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},PA=e=>{var t=Fr(e,RB),r=_.useRef(null),[n,a]=_.useState(-1);_.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var C=r.current.getTotalLength();C&&a(C)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:f,animationDuration:h,animationBegin:m,isAnimationActive:p,isUpdateAnimationActive:v}=t,g=_.useRef(l),x=_.useRef(c),b=_.useRef(s),y=_.useRef(o),w=_.useMemo(()=>({x:s,y:o,width:l,height:c,radius:d}),[s,o,l,c,d]),j=oc(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var N=lt("recharts-rectangle",u);if(!v)return _.createElement("path",Pu({},Zt(t,!0),{className:N,d:e2(s,o,l,c,d)}));var E=g.current,S=x.current,O=b.current,k=y.current,T="0px ".concat(n===-1?1:n,"px"),A="".concat(n,"px 0px"),P=AA(["strokeDasharray"],h,typeof f=="string"?f:void 0);return _.createElement(ic,{animationId:j,key:j,canBegin:n>0,duration:h,easing:f,isActive:v,begin:m},C=>{var F=Bt(E,l,C),M=Bt(S,c,C),H=Bt(O,s,C),V=Bt(k,o,C);r.current&&(g.current=F,x.current=M,b.current=H,y.current=V);var B;return p?C>0?B={transition:P,strokeDasharray:A}:B={strokeDasharray:T}:B={strokeDasharray:A},_.createElement("path",Pu({},Zt(t,!0),{className:N,d:e2(H,V,F,M,d),ref:r,style:Qw(Qw({},B),t.style)}))})};function DA(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:s}=e,o=lr(t,r,n,a),l=lr(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:s}}function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wv.apply(null,arguments)}var FB=(e,t)=>{var r=_r(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},qc=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+n,u=Math.asin(l/d)/ku,f=c?a:a+s*u,h=lr(t,r,d,f),m=lr(t,r,n,f),p=c?a-s*u:a,v=lr(t,r,d*Math.cos(u*ku),p);return{center:h,circleTangency:m,lineTangency:v,theta:u}},IA=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=e,l=FB(s,o),c=s+l,d=lr(t,r,a,s),u=lr(t,r,a,c),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var h=lr(t,r,n,s),m=lr(t,r,n,c);f+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=c),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},LB=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=_r(d-c),{circleTangency:f,lineTangency:h,theta:m}=qc({cx:t,cy:r,radius:a,angle:c,sign:u,cornerRadius:s,cornerIsExternal:l}),{circleTangency:p,lineTangency:v,theta:g}=qc({cx:t,cy:r,radius:a,angle:d,sign:-u,cornerRadius:s,cornerIsExternal:l}),x=l?Math.abs(c-d):Math.abs(c-d)-m-g;if(x<0)return o?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):IA({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:d});var b="M ".concat(h.x,",").concat(h.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(x>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:y,lineTangency:w,theta:j}=qc({cx:t,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:N,lineTangency:E,theta:S}=qc({cx:t,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),O=l?Math.abs(c-d):Math.abs(c-d)-j-S;if(O<0&&s===0)return"".concat(b,"L").concat(t,",").concat(r,"Z");b+="L".concat(E.x,",").concat(E.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(O>180),",").concat(+(u>0),",").concat(y.x,",").concat(y.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,"Z")}else b+="L".concat(t,",").concat(r,"Z");return b},MB={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},RA=e=>{var t=Fr(e,MB),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:f}=t;if(s<a||d===u)return null;var h=lt("recharts-sector",f),m=s-a,p=Gr(o,m,0,!0),v;return p>0&&Math.abs(d-u)<360?v=LB({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(p,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):v=IA({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:d,endAngle:u}),_.createElement("path",Wv({},Zt(t,!0),{className:h,d:v}))};function BB(e,t,r){var n,a,s,o;if(e==="horizontal")n=t.x,s=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,s=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:d,outerRadius:u,angle:f}=t,h=lr(l,c,d,f),m=lr(l,c,u,f);n=h.x,a=h.y,s=m.x,o=m.y}else return DA(t);return[{x:n,y:a},{x:s,y:o}]}var Fh={},Lh={},Mh={},t2;function $B(){return t2||(t2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zT();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Mh)),Mh}var r2;function zB(){return r2||(r2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$B();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Lh)),Lh}var n2;function UB(){return n2||(n2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UT(),r=zB();function n(a,s,o){o&&typeof o!="number"&&t.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=o;return c}e.range=n})(Fh)),Fh}var Bh,a2;function qB(){return a2||(a2=1,Bh=UB().range),Bh}var WB=qB();const FA=ss(WB);function Ss(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function HB(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function fx(e){let t,r,n;e.length!==2?(t=Ss,r=(l,c)=>Ss(e(l),c),n=(l,c)=>e(l)-c):(t=e===Ss||e===HB?e:VB,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function VB(){return 0}function LA(e){return e===null?NaN:+e}function*GB(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const KB=fx(Ss),lc=KB.right;fx(LA).center;class s2 extends Map{constructor(t,r=ZB){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(i2(this,t))}has(t){return super.has(i2(this,t))}set(t,r){return super.set(YB(this,t),r)}delete(t){return super.delete(XB(this,t))}}function i2({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function YB({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function XB({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function ZB(e){return e!==null&&typeof e=="object"?e.valueOf():e}function JB(e=Ss){if(e===Ss)return MA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function MA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const QB=Math.sqrt(50),e9=Math.sqrt(10),t9=Math.sqrt(2);function Du(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=QB?10:s>=e9?5:s>=t9?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Du(e,t,r*2):[l,c,d]}function Hv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,s,o]=n?Du(t,e,r):Du(e,t,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(s-d)/-o;else for(let d=0;d<l;++d)c[d]=(s-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function Vv(e,t,r){return t=+t,e=+e,r=+r,Du(e,t,r)[2]}function Gv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Vv(t,e,r):Vv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function o2(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function l2(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function BA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?MA:JB(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),p=Math.min(n,Math.floor(t+(c-d)*f/c+h));BA(e,t,m,p,a)}const s=e[t];let o=r,l=n;for(Vo(e,r,t),a(e[n],s)>0&&Vo(e,r,n);o<l;){for(Vo(e,o,l),++o,--l;a(e[o],s)<0;)++o;for(;a(e[l],s)>0;)--l}a(e[r],s)===0?Vo(e,r,l):(++l,Vo(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Vo(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function r9(e,t,r){if(e=Float64Array.from(GB(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return l2(e);if(t>=1)return o2(e);var n,a=(n-1)*t,s=Math.floor(a),o=o2(BA(e,s).subarray(0,s+1)),l=l2(e.subarray(s+1));return o+(l-o)*(a-s)}}function n9(e,t,r=LA){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,s=Math.floor(a),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(a-s)}}function a9(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(a);++n<a;)s[n]=e+n*r;return s}function ia(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function us(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Kv=Symbol("implicit");function hx(){var e=new s2,t=[],r=[],n=Kv;function a(s){let o=e.get(s);if(o===void 0){if(n!==Kv)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new s2;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return hx(t,r).unknown(n)},ia.apply(a,arguments),a}function mx(){var e=hx().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,s,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=a<n,p=m?a:n,v=m?n:a;s=(v-p)/Math.max(1,h-c+d*2),l&&(s=Math.floor(s)),p+=(v-p-s*(h-c))*u,o=s*(1-c),l&&(p=Math.round(p),o=Math.round(o));var g=a9(h).map(function(x){return p+s*x});return r(m?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return mx(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},ia.apply(f(),arguments)}function $A(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $A(t())},e}function s9(){return $A(mx.apply(null,arguments).paddingInner(1))}function px(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function zA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function cc(){}var Sl=.7,Iu=1/Sl,Xi="\\s*([+-]?\\d+)\\s*",Tl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Da="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",i9=/^#([0-9a-f]{3,8})$/,o9=new RegExp(`^rgb\\(${Xi},${Xi},${Xi}\\)$`),l9=new RegExp(`^rgb\\(${Da},${Da},${Da}\\)$`),c9=new RegExp(`^rgba\\(${Xi},${Xi},${Xi},${Tl}\\)$`),u9=new RegExp(`^rgba\\(${Da},${Da},${Da},${Tl}\\)$`),d9=new RegExp(`^hsl\\(${Tl},${Da},${Da}\\)$`),f9=new RegExp(`^hsla\\(${Tl},${Da},${Da},${Tl}\\)$`),c2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};px(cc,Al,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:u2,formatHex:u2,formatHex8:h9,formatHsl:m9,formatRgb:d2,toString:d2});function u2(){return this.rgb().formatHex()}function h9(){return this.rgb().formatHex8()}function m9(){return UA(this).formatHsl()}function d2(){return this.rgb().formatRgb()}function Al(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=i9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?f2(t):r===3?new fn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Wc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Wc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=o9.exec(e))?new fn(t[1],t[2],t[3],1):(t=l9.exec(e))?new fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=c9.exec(e))?Wc(t[1],t[2],t[3],t[4]):(t=u9.exec(e))?Wc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=d9.exec(e))?p2(t[1],t[2]/100,t[3]/100,1):(t=f9.exec(e))?p2(t[1],t[2]/100,t[3]/100,t[4]):c2.hasOwnProperty(e)?f2(c2[e]):e==="transparent"?new fn(NaN,NaN,NaN,0):null}function f2(e){return new fn(e>>16&255,e>>8&255,e&255,1)}function Wc(e,t,r,n){return n<=0&&(e=t=r=NaN),new fn(e,t,r,n)}function p9(e){return e instanceof cc||(e=Al(e)),e?(e=e.rgb(),new fn(e.r,e.g,e.b,e.opacity)):new fn}function Yv(e,t,r,n){return arguments.length===1?p9(e):new fn(e,t,r,n??1)}function fn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}px(fn,Yv,zA(cc,{brighter(e){return e=e==null?Iu:Math.pow(Iu,e),new fn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new fn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fn(oi(this.r),oi(this.g),oi(this.b),Ru(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h2,formatHex:h2,formatHex8:v9,formatRgb:m2,toString:m2}));function h2(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}`}function v9(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}${ei((isNaN(this.opacity)?1:this.opacity)*255)}`}function m2(){const e=Ru(this.opacity);return`${e===1?"rgb(":"rgba("}${oi(this.r)}, ${oi(this.g)}, ${oi(this.b)}${e===1?")":`, ${e})`}`}function Ru(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function oi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ei(e){return e=oi(e),(e<16?"0":"")+e.toString(16)}function p2(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new fa(e,t,r,n)}function UA(e){if(e instanceof fa)return new fa(e.h,e.s,e.l,e.opacity);if(e instanceof cc||(e=Al(e)),!e)return new fa;if(e instanceof fa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new fa(o,l,c,e.opacity)}function g9(e,t,r,n){return arguments.length===1?UA(e):new fa(e,t,r,n??1)}function fa(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}px(fa,g9,zA(cc,{brighter(e){return e=e==null?Iu:Math.pow(Iu,e),new fa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new fa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new fn($h(e>=240?e-240:e+120,a,n),$h(e,a,n),$h(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new fa(v2(this.h),Hc(this.s),Hc(this.l),Ru(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ru(this.opacity);return`${e===1?"hsl(":"hsla("}${v2(this.h)}, ${Hc(this.s)*100}%, ${Hc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function v2(e){return e=(e||0)%360,e<0?e+360:e}function Hc(e){return Math.max(0,Math.min(1,e||0))}function $h(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const vx=e=>()=>e;function x9(e,t){return function(r){return e+r*t}}function y9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function b9(e){return(e=+e)==1?qA:function(t,r){return r-t?y9(t,r,e):vx(isNaN(t)?r:t)}}function qA(e,t){var r=t-e;return r?x9(e,r):vx(isNaN(e)?t:e)}const g2=(function e(t){var r=b9(t);function n(a,s){var o=r((a=Yv(a)).r,(s=Yv(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),d=qA(a.opacity,s.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n})(1);function w9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=e[a]*(1-s)+t[a]*s;return n}}function j9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function N9(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=Eo(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function E9(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Fu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _9(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Eo(e[a],t[a]):n[a]=t[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var Xv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zh=new RegExp(Xv.source,"g");function S9(e){return function(){return e}}function T9(e){return function(t){return e(t)+""}}function A9(e,t){var r=Xv.lastIndex=zh.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Xv.exec(e))&&(a=zh.exec(t));)(s=a.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Fu(n,a)})),r=zh.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?T9(c[0].x):S9(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function Eo(e,t){var r=typeof t,n;return t==null||r==="boolean"?vx(t):(r==="number"?Fu:r==="string"?(n=Al(t))?(t=n,g2):A9:t instanceof Al?g2:t instanceof Date?E9:j9(t)?w9:Array.isArray(t)?N9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_9:Fu)(e,t)}function gx(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function k9(e,t){t===void 0&&(t=e,e=Eo);for(var r=0,n=t.length-1,a=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function O9(e){return function(){return e}}function Lu(e){return+e}var x2=[0,1];function an(e){return e}function Zv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:O9(isNaN(t)?NaN:.5)}function C9(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function P9(e,t,r){var n=e[0],a=e[1],s=t[0],o=t[1];return a<n?(n=Zv(a,n),s=r(o,s)):(n=Zv(n,a),s=r(s,o)),function(l){return s(n(l))}}function D9(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=Zv(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=lc(e,l,1,n)-1;return s[c](a[c](l))}}function uc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function $d(){var e=x2,t=x2,r=Eo,n,a,s,o=an,l,c,d;function u(){var h=Math.min(e.length,t.length);return o!==an&&(o=C9(e[0],e[h-1])),l=h>2?D9:P9,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(a((d||(d=l(t,e.map(n),Fu)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Lu),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=gx,u()},f.clamp=function(h){return arguments.length?(o=h?!0:an,u()):o!==an},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,m){return n=h,a=m,u()}}function xx(){return $d()(an,an)}function I9(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Mu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function co(e){return e=Mu(Math.abs(e)),e?e[1]:NaN}function R9(e,t){return function(r,n){for(var a=r.length,s=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function F9(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var L9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kl(e){if(!(t=L9.exec(e)))throw new Error("invalid format: "+e);var t;return new yx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}kl.prototype=yx.prototype;function yx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function M9(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var WA;function B9(e,t){var r=Mu(e,t);if(!r)return e+"";var n=r[0],a=r[1],s=a-(WA=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Mu(e,Math.max(0,t+s-1))[0]}function y2(e,t){var r=Mu(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const b2={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:I9,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>y2(e*100,t),r:y2,s:B9,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function w2(e){return e}var j2=Array.prototype.map,N2=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function $9(e){var t=e.grouping===void 0||e.thousands===void 0?w2:R9(j2.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?w2:F9(j2.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=kl(f);var h=f.fill,m=f.align,p=f.sign,v=f.symbol,g=f.zero,x=f.width,b=f.comma,y=f.precision,w=f.trim,j=f.type;j==="n"?(b=!0,j="g"):b2[j]||(y===void 0&&(y=12),w=!0,j="g"),(g||h==="0"&&m==="=")&&(g=!0,h="0",m="=");var N=v==="$"?r:v==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",E=v==="$"?n:/[%p]/.test(j)?o:"",S=b2[j],O=/[defgprs%]/.test(j);y=y===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function k(T){var A=N,P=E,C,F,M;if(j==="c")P=S(T)+P,T="";else{T=+T;var H=T<0||1/T<0;if(T=isNaN(T)?c:S(Math.abs(T),y),w&&(T=M9(T)),H&&+T==0&&p!=="+"&&(H=!1),A=(H?p==="("?p:l:p==="-"||p==="("?"":p)+A,P=(j==="s"?N2[8+WA/3]:"")+P+(H&&p==="("?")":""),O){for(C=-1,F=T.length;++C<F;)if(M=T.charCodeAt(C),48>M||M>57){P=(M===46?a+T.slice(C+1):T.slice(C))+P,T=T.slice(0,C);break}}}b&&!g&&(T=t(T,1/0));var V=A.length+T.length+P.length,B=V<x?new Array(x-V+1).join(h):"";switch(b&&g&&(T=t(B+T,B.length?x-P.length:1/0),B=""),m){case"<":T=A+T+P+B;break;case"=":T=A+B+T+P;break;case"^":T=B.slice(0,V=B.length>>1)+A+T+P+B.slice(V);break;default:T=B+A+T+P;break}return s(T)}return k.toString=function(){return f+""},k}function u(f,h){var m=d((f=kl(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(co(h)/3)))*3,v=Math.pow(10,-p),g=N2[8+p/3];return function(x){return m(v*x)+g}}return{format:d,formatPrefix:u}}var Vc,bx,HA;z9({thousands:",",grouping:[3],currency:["$",""]});function z9(e){return Vc=$9(e),bx=Vc.format,HA=Vc.formatPrefix,Vc}function U9(e){return Math.max(0,-co(Math.abs(e)))}function q9(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(co(t)/3)))*3-co(Math.abs(e)))}function W9(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,co(t)-co(e))+1}function VA(e,t,r,n){var a=Gv(e,t,r),s;switch(n=kl(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=q9(a,o))&&(n.precision=s),HA(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=W9(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=U9(a))&&(n.precision=s-(n.type==="%")*2);break}}return bx(n)}function Ms(e){var t=e.domain;return e.ticks=function(r){var n=t();return Hv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return VA(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,s=n.length-1,o=n[a],l=n[s],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=s,s=d);u-- >0;){if(d=Vv(o,l,r),d===c)return n[a]=o,n[s]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function GA(){var e=xx();return e.copy=function(){return uc(e,GA())},ia.apply(e,arguments),Ms(e)}function KA(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Lu),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return KA(e).unknown(t)},e=arguments.length?Array.from(e,Lu):[0,1],Ms(r)}function YA(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],s=e[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),e[r]=t.floor(a),e[n]=t.ceil(s),e}function E2(e){return Math.log(e)}function _2(e){return Math.exp(e)}function H9(e){return-Math.log(-e)}function V9(e){return-Math.exp(-e)}function G9(e){return isFinite(e)?+("1e"+e):e<0?0:e}function K9(e){return e===10?G9:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Y9(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function S2(e){return(t,r)=>-e(-t,r)}function wx(e){const t=e(E2,_2),r=t.domain;let n=10,a,s;function o(){return a=Y9(n),s=K9(n),r()[0]<0?(a=S2(a),s=S2(s),e(H9,V9)):e(E2,_2),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=a(d),m=a(u),p,v;const g=l==null?10:+l;let x=[];if(!(n%1)&&m-h<g){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(p=1;p<n;++p)if(v=h<0?p/s(-h):p*s(h),!(v<d)){if(v>u)break;x.push(v)}}else for(;h<=m;++h)for(p=n-1;p>=1;--p)if(v=h>0?p/s(-h):p*s(h),!(v<d)){if(v>u)break;x.push(v)}x.length*2<g&&(x=Hv(d,u,g))}else x=Hv(h,m,Math.min(m-h,g)).map(s);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=kl(c)).precision==null&&(c.trim=!0),c=bx(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/s(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(YA(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),t}function XA(){const e=wx($d()).domain([1,10]);return e.copy=()=>uc(e,XA()).base(e.base()),ia.apply(e,arguments),e}function T2(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function A2(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function jx(e){var t=1,r=e(T2(t),A2(t));return r.constant=function(n){return arguments.length?e(T2(t=+n),A2(t)):t},Ms(r)}function ZA(){var e=jx($d());return e.copy=function(){return uc(e,ZA()).constant(e.constant())},ia.apply(e,arguments)}function k2(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function X9(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Z9(e){return e<0?-e*e:e*e}function Nx(e){var t=e(an,an),r=1;function n(){return r===1?e(an,an):r===.5?e(X9,Z9):e(k2(r),k2(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Ms(t)}function Ex(){var e=Nx($d());return e.copy=function(){return uc(e,Ex()).exponent(e.exponent())},ia.apply(e,arguments),e}function J9(){return Ex.apply(null,arguments).exponent(.5)}function O2(e){return Math.sign(e)*e*e}function Q9(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function JA(){var e=xx(),t=[0,1],r=!1,n;function a(s){var o=Q9(e(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return e.invert(O2(s))},a.domain=function(s){return arguments.length?(e.domain(s),a):e.domain()},a.range=function(s){return arguments.length?(e.range((t=Array.from(s,Lu)).map(O2)),a):t.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(e.clamp(s),a):e.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return JA(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ia.apply(a,arguments),Ms(a)}function QA(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=n9(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[lc(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ss),a()},s.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return QA().domain(e).range(t).unknown(n)},ia.apply(s,arguments)}function ek(){var e=0,t=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[lc(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return ek().domain([e,t]).range(a).unknown(s)},ia.apply(Ms(o),arguments)}function tk(){var e=[.5],t=[0,1],r,n=1;function a(s){return s!=null&&s<=s?t[lc(e,s,0,n)]:r}return a.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return tk().domain(e).range(t).unknown(r)},ia.apply(a,arguments)}const Uh=new Date,qh=new Date;function br(e,t,r,n){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(e(s=new Date(+s)),s),a.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let d;do c.push(d=new Date(+s)),t(s,l),e(s);while(d<s&&s<o);return c},a.filter=s=>br(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(a.count=(s,o)=>(Uh.setTime(+s),qh.setTime(+o),e(Uh),e(qh),Math.floor(r(Uh,qh))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const Bu=br(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Bu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?br(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Bu);Bu.range;const Ua=1e3,Qn=Ua*60,qa=Qn*60,ts=qa*24,_x=ts*7,C2=ts*30,Wh=ts*365,ti=br(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getUTCSeconds());ti.range;const Sx=br(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ua)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getMinutes());Sx.range;const Tx=br(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getUTCMinutes());Tx.range;const Ax=br(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ua-e.getMinutes()*Qn)},(e,t)=>{e.setTime(+e+t*qa)},(e,t)=>(t-e)/qa,e=>e.getHours());Ax.range;const kx=br(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*qa)},(e,t)=>(t-e)/qa,e=>e.getUTCHours());kx.range;const dc=br(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Qn)/ts,e=>e.getDate()-1);dc.range;const zd=br(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ts,e=>e.getUTCDate()-1);zd.range;const rk=br(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ts,e=>Math.floor(e/ts));rk.range;function Ci(e){return br(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Qn)/_x)}const Ud=Ci(0),$u=Ci(1),e$=Ci(2),t$=Ci(3),uo=Ci(4),r$=Ci(5),n$=Ci(6);Ud.range;$u.range;e$.range;t$.range;uo.range;r$.range;n$.range;function Pi(e){return br(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/_x)}const qd=Pi(0),zu=Pi(1),a$=Pi(2),s$=Pi(3),fo=Pi(4),i$=Pi(5),o$=Pi(6);qd.range;zu.range;a$.range;s$.range;fo.range;i$.range;o$.range;const Ox=br(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ox.range;const Cx=br(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Cx.range;const rs=br(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());rs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:br(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});rs.range;const ns=br(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ns.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:br(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ns.range;function nk(e,t,r,n,a,s){const o=[[ti,1,Ua],[ti,5,5*Ua],[ti,15,15*Ua],[ti,30,30*Ua],[s,1,Qn],[s,5,5*Qn],[s,15,15*Qn],[s,30,30*Qn],[a,1,qa],[a,3,3*qa],[a,6,6*qa],[a,12,12*qa],[n,1,ts],[n,2,2*ts],[r,1,_x],[t,1,C2],[t,3,3*C2],[e,1,Wh]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),p=m?m.range(d,+u+1):[];return h?p.reverse():p}function c(d,u,f){const h=Math.abs(u-d)/f,m=fx(([,,g])=>g).right(o,h);if(m===o.length)return e.every(Gv(d/Wh,u/Wh,f));if(m===0)return Bu.every(Math.max(Gv(d,u,f),1));const[p,v]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return p.every(v)}return[l,c]}const[l$,c$]=nk(ns,Cx,qd,rk,kx,Tx),[u$,d$]=nk(rs,Ox,Ud,dc,Ax,Sx);function Hh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Vh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Go(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function f$(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=Ko(a),u=Yo(a),f=Ko(s),h=Yo(s),m=Ko(o),p=Yo(o),v=Ko(l),g=Yo(l),x=Ko(c),b=Yo(c),y={a:H,A:V,b:B,B:W,c:null,d:L2,e:L2,f:R$,g:H$,G:G$,H:P$,I:D$,j:I$,L:ak,m:F$,M:L$,p:z,q:D,Q:$2,s:z2,S:M$,u:B$,U:$$,V:z$,w:U$,W:q$,x:null,X:null,y:W$,Y:V$,Z:K$,"%":B2},w={a:L,A:q,b:I,B:R,c:null,d:M2,e:M2,f:J$,g:lz,G:uz,H:Y$,I:X$,j:Z$,L:ik,m:Q$,M:ez,p:X,q:ae,Q:$2,s:z2,S:tz,u:rz,U:nz,V:az,w:sz,W:iz,x:null,X:null,y:oz,Y:cz,Z:dz,"%":B2},j={a:k,A:T,b:A,B:P,c:C,d:R2,e:R2,f:A$,g:I2,G:D2,H:F2,I:F2,j:E$,L:T$,m:N$,M:_$,p:O,q:j$,Q:O$,s:C$,S:S$,u:g$,U:x$,V:y$,w:v$,W:b$,x:F,X:M,y:I2,Y:D2,Z:w$,"%":k$};y.x=N(r,y),y.X=N(n,y),y.c=N(t,y),w.x=N(r,w),w.X=N(n,w),w.c=N(t,w);function N(Z,ee){return function(ie){var U=[],be=-1,Se=0,Re=Z.length,Le,_e,he;for(ie instanceof Date||(ie=new Date(+ie));++be<Re;)Z.charCodeAt(be)===37&&(U.push(Z.slice(Se,be)),(_e=P2[Le=Z.charAt(++be)])!=null?Le=Z.charAt(++be):_e=Le==="e"?" ":"0",(he=ee[Le])&&(Le=he(ie,_e)),U.push(Le),Se=be+1);return U.push(Z.slice(Se,be)),U.join("")}}function E(Z,ee){return function(ie){var U=Go(1900,void 0,1),be=S(U,Z,ie+="",0),Se,Re;if(be!=ie.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(ee&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(Se=Vh(Go(U.y,0,1)),Re=Se.getUTCDay(),Se=Re>4||Re===0?zu.ceil(Se):zu(Se),Se=zd.offset(Se,(U.V-1)*7),U.y=Se.getUTCFullYear(),U.m=Se.getUTCMonth(),U.d=Se.getUTCDate()+(U.w+6)%7):(Se=Hh(Go(U.y,0,1)),Re=Se.getDay(),Se=Re>4||Re===0?$u.ceil(Se):$u(Se),Se=dc.offset(Se,(U.V-1)*7),U.y=Se.getFullYear(),U.m=Se.getMonth(),U.d=Se.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),Re="Z"in U?Vh(Go(U.y,0,1)).getUTCDay():Hh(Go(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(Re+5)%7:U.w+U.U*7-(Re+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,Vh(U)):Hh(U)}}function S(Z,ee,ie,U){for(var be=0,Se=ee.length,Re=ie.length,Le,_e;be<Se;){if(U>=Re)return-1;if(Le=ee.charCodeAt(be++),Le===37){if(Le=ee.charAt(be++),_e=j[Le in P2?ee.charAt(be++):Le],!_e||(U=_e(Z,ie,U))<0)return-1}else if(Le!=ie.charCodeAt(U++))return-1}return U}function O(Z,ee,ie){var U=d.exec(ee.slice(ie));return U?(Z.p=u.get(U[0].toLowerCase()),ie+U[0].length):-1}function k(Z,ee,ie){var U=m.exec(ee.slice(ie));return U?(Z.w=p.get(U[0].toLowerCase()),ie+U[0].length):-1}function T(Z,ee,ie){var U=f.exec(ee.slice(ie));return U?(Z.w=h.get(U[0].toLowerCase()),ie+U[0].length):-1}function A(Z,ee,ie){var U=x.exec(ee.slice(ie));return U?(Z.m=b.get(U[0].toLowerCase()),ie+U[0].length):-1}function P(Z,ee,ie){var U=v.exec(ee.slice(ie));return U?(Z.m=g.get(U[0].toLowerCase()),ie+U[0].length):-1}function C(Z,ee,ie){return S(Z,t,ee,ie)}function F(Z,ee,ie){return S(Z,r,ee,ie)}function M(Z,ee,ie){return S(Z,n,ee,ie)}function H(Z){return o[Z.getDay()]}function V(Z){return s[Z.getDay()]}function B(Z){return c[Z.getMonth()]}function W(Z){return l[Z.getMonth()]}function z(Z){return a[+(Z.getHours()>=12)]}function D(Z){return 1+~~(Z.getMonth()/3)}function L(Z){return o[Z.getUTCDay()]}function q(Z){return s[Z.getUTCDay()]}function I(Z){return c[Z.getUTCMonth()]}function R(Z){return l[Z.getUTCMonth()]}function X(Z){return a[+(Z.getUTCHours()>=12)]}function ae(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var ee=N(Z+="",y);return ee.toString=function(){return Z},ee},parse:function(Z){var ee=E(Z+="",!1);return ee.toString=function(){return Z},ee},utcFormat:function(Z){var ee=N(Z+="",w);return ee.toString=function(){return Z},ee},utcParse:function(Z){var ee=E(Z+="",!0);return ee.toString=function(){return Z},ee}}}var P2={"-":"",_:" ",0:"0"},Tr=/^\s*\d+/,h$=/^%/,m$=/[\\^$*+?|[\]().{}]/g;function mt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(t)+a:a)}function p$(e){return e.replace(m$,"\\$&")}function Ko(e){return new RegExp("^(?:"+e.map(p$).join("|")+")","i")}function Yo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function v$(e,t,r){var n=Tr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function g$(e,t,r){var n=Tr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function x$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function y$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function b$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function D2(e,t,r){var n=Tr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function I2(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function w$(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function j$(e,t,r){var n=Tr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function N$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function R2(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function E$(e,t,r){var n=Tr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function F2(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function _$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function S$(e,t,r){var n=Tr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function T$(e,t,r){var n=Tr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function A$(e,t,r){var n=Tr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function k$(e,t,r){var n=h$.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function O$(e,t,r){var n=Tr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function C$(e,t,r){var n=Tr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function L2(e,t){return mt(e.getDate(),t,2)}function P$(e,t){return mt(e.getHours(),t,2)}function D$(e,t){return mt(e.getHours()%12||12,t,2)}function I$(e,t){return mt(1+dc.count(rs(e),e),t,3)}function ak(e,t){return mt(e.getMilliseconds(),t,3)}function R$(e,t){return ak(e,t)+"000"}function F$(e,t){return mt(e.getMonth()+1,t,2)}function L$(e,t){return mt(e.getMinutes(),t,2)}function M$(e,t){return mt(e.getSeconds(),t,2)}function B$(e){var t=e.getDay();return t===0?7:t}function $$(e,t){return mt(Ud.count(rs(e)-1,e),t,2)}function sk(e){var t=e.getDay();return t>=4||t===0?uo(e):uo.ceil(e)}function z$(e,t){return e=sk(e),mt(uo.count(rs(e),e)+(rs(e).getDay()===4),t,2)}function U$(e){return e.getDay()}function q$(e,t){return mt($u.count(rs(e)-1,e),t,2)}function W$(e,t){return mt(e.getFullYear()%100,t,2)}function H$(e,t){return e=sk(e),mt(e.getFullYear()%100,t,2)}function V$(e,t){return mt(e.getFullYear()%1e4,t,4)}function G$(e,t){var r=e.getDay();return e=r>=4||r===0?uo(e):uo.ceil(e),mt(e.getFullYear()%1e4,t,4)}function K$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+mt(t/60|0,"0",2)+mt(t%60,"0",2)}function M2(e,t){return mt(e.getUTCDate(),t,2)}function Y$(e,t){return mt(e.getUTCHours(),t,2)}function X$(e,t){return mt(e.getUTCHours()%12||12,t,2)}function Z$(e,t){return mt(1+zd.count(ns(e),e),t,3)}function ik(e,t){return mt(e.getUTCMilliseconds(),t,3)}function J$(e,t){return ik(e,t)+"000"}function Q$(e,t){return mt(e.getUTCMonth()+1,t,2)}function ez(e,t){return mt(e.getUTCMinutes(),t,2)}function tz(e,t){return mt(e.getUTCSeconds(),t,2)}function rz(e){var t=e.getUTCDay();return t===0?7:t}function nz(e,t){return mt(qd.count(ns(e)-1,e),t,2)}function ok(e){var t=e.getUTCDay();return t>=4||t===0?fo(e):fo.ceil(e)}function az(e,t){return e=ok(e),mt(fo.count(ns(e),e)+(ns(e).getUTCDay()===4),t,2)}function sz(e){return e.getUTCDay()}function iz(e,t){return mt(zu.count(ns(e)-1,e),t,2)}function oz(e,t){return mt(e.getUTCFullYear()%100,t,2)}function lz(e,t){return e=ok(e),mt(e.getUTCFullYear()%100,t,2)}function cz(e,t){return mt(e.getUTCFullYear()%1e4,t,4)}function uz(e,t){var r=e.getUTCDay();return e=r>=4||r===0?fo(e):fo.ceil(e),mt(e.getUTCFullYear()%1e4,t,4)}function dz(){return"+0000"}function B2(){return"%"}function $2(e){return+e}function z2(e){return Math.floor(+e/1e3)}var $i,lk,ck;fz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function fz(e){return $i=f$(e),lk=$i.format,$i.parse,ck=$i.utcFormat,$i.utcParse,$i}function hz(e){return new Date(e)}function mz(e){return e instanceof Date?+e:+new Date(+e)}function Px(e,t,r,n,a,s,o,l,c,d){var u=xx(),f=u.invert,h=u.domain,m=d(".%L"),p=d(":%S"),v=d("%I:%M"),g=d("%I %p"),x=d("%a %d"),b=d("%b %d"),y=d("%B"),w=d("%Y");function j(N){return(c(N)<N?m:l(N)<N?p:o(N)<N?v:s(N)<N?g:n(N)<N?a(N)<N?x:b:r(N)<N?y:w)(N)}return u.invert=function(N){return new Date(f(N))},u.domain=function(N){return arguments.length?h(Array.from(N,mz)):h().map(hz)},u.ticks=function(N){var E=h();return e(E[0],E[E.length-1],N??10)},u.tickFormat=function(N,E){return E==null?j:d(E)},u.nice=function(N){var E=h();return(!N||typeof N.range!="function")&&(N=t(E[0],E[E.length-1],N??10)),N?h(YA(E,N)):u},u.copy=function(){return uc(u,Px(e,t,r,n,a,s,o,l,c,d))},u}function pz(){return ia.apply(Px(u$,d$,rs,Ox,Ud,dc,Ax,Sx,ti,lk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vz(){return ia.apply(Px(l$,c$,ns,Cx,qd,zd,kx,Tx,ti,ck).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Wd(){var e=0,t=1,r,n,a,s,o=an,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(h){var m,p;return arguments.length?([m,p]=h,o=f(m,p),d):[o(0),o(1)]}}return d.range=u(Eo),d.rangeRound=u(gx),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return s=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function Bs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function uk(){var e=Ms(Wd()(an));return e.copy=function(){return Bs(e,uk())},us.apply(e,arguments)}function dk(){var e=wx(Wd()).domain([1,10]);return e.copy=function(){return Bs(e,dk()).base(e.base())},us.apply(e,arguments)}function fk(){var e=jx(Wd());return e.copy=function(){return Bs(e,fk()).constant(e.constant())},us.apply(e,arguments)}function Dx(){var e=Nx(Wd());return e.copy=function(){return Bs(e,Dx()).exponent(e.exponent())},us.apply(e,arguments)}function gz(){return Dx.apply(null,arguments).exponent(.5)}function hk(){var e=[],t=an;function r(n){if(n!=null&&!isNaN(n=+n))return t((lc(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ss),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>r9(e,s/n))},r.copy=function(){return hk(t).domain(e)},us.apply(r,arguments)}function Hd(){var e=0,t=.5,r=1,n=1,a,s,o,l,c,d=an,u,f=!1,h;function m(v){return isNaN(v=+v)?h:(v=.5+((v=+u(v))-s)*(n*v<n*s?l:c),d(f?Math.max(0,Math.min(1,v)):v))}m.domain=function(v){return arguments.length?([e,t,r]=v,a=u(e=+e),s=u(t=+t),o=u(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,m):[e,t,r]},m.clamp=function(v){return arguments.length?(f=!!v,m):f},m.interpolator=function(v){return arguments.length?(d=v,m):d};function p(v){return function(g){var x,b,y;return arguments.length?([x,b,y]=g,d=k9(v,[x,b,y]),m):[d(0),d(.5),d(1)]}}return m.range=p(Eo),m.rangeRound=p(gx),m.unknown=function(v){return arguments.length?(h=v,m):h},function(v){return u=v,a=v(e),s=v(t),o=v(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,m}}function mk(){var e=Ms(Hd()(an));return e.copy=function(){return Bs(e,mk())},us.apply(e,arguments)}function pk(){var e=wx(Hd()).domain([.1,1,10]);return e.copy=function(){return Bs(e,pk()).base(e.base())},us.apply(e,arguments)}function vk(){var e=jx(Hd());return e.copy=function(){return Bs(e,vk()).constant(e.constant())},us.apply(e,arguments)}function Ix(){var e=Nx(Hd());return e.copy=function(){return Bs(e,Ix()).exponent(e.exponent())},us.apply(e,arguments)}function xz(){return Ix.apply(null,arguments).exponent(.5)}const Qo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:mx,scaleDiverging:mk,scaleDivergingLog:pk,scaleDivergingPow:Ix,scaleDivergingSqrt:xz,scaleDivergingSymlog:vk,scaleIdentity:KA,scaleImplicit:Kv,scaleLinear:GA,scaleLog:XA,scaleOrdinal:hx,scalePoint:s9,scalePow:Ex,scaleQuantile:QA,scaleQuantize:ek,scaleRadial:JA,scaleSequential:uk,scaleSequentialLog:dk,scaleSequentialPow:Dx,scaleSequentialQuantile:hk,scaleSequentialSqrt:gz,scaleSequentialSymlog:fk,scaleSqrt:J9,scaleSymlog:ZA,scaleThreshold:tk,scaleTime:pz,scaleUtc:vz,tickFormat:VA},Symbol.toStringTag,{value:"Module"}));var $s=e=>e.chartData,Rx=pe([$s],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Vd=(e,t,r,n)=>n?Rx(e):$s(e);function ho(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Rr(t)&&Rr(r))return!0}return!1}function U2(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function yz(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,s;if(Rr(r))a=r;else if(typeof r=="function")return;if(Rr(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(ho(o))return o}}function bz(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ho(n))return U2(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,s]=e,o,l;if(a==="auto")t!=null&&(o=Math.min(...t));else if(qe(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[0]))}catch{}else if(typeof a=="string"&&Pw.test(a)){var c=Pw.exec(a);if(c==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t?.[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(qe(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t?.[1]))}catch{}else if(typeof s=="string"&&Dw.test(s)){var u=Dw.exec(s);if(u==null||t==null)l=void 0;else{var f=+u[1];l=t[1]+f}}else l=t?.[1];var h=[o,l];if(ho(h))return t==null?h:U2(h,t,r)}}}var _o=1e9,wz={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Lx,Rt=!0,na="[DecimalError] ",li=na+"Invalid argument: ",Fx=na+"Exponent out of range: ",So=Math.floor,Xs=Math.pow,jz=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,An,jr=1e7,At=7,gk=9007199254740991,Uu=So(gk/At),Ue={};Ue.absoluteValue=Ue.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ue.comparedTo=Ue.cmp=function(e){var t,r,n,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};Ue.decimalPlaces=Ue.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*At;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Ue.dividedBy=Ue.div=function(e){return Ga(this,new this.constructor(e))};Ue.dividedToIntegerBy=Ue.idiv=function(e){var t=this,r=t.constructor;return Nt(Ga(t,new r(e),0,1),r.precision)};Ue.equals=Ue.eq=function(e){return!this.cmp(e)};Ue.exponent=function(){return cr(this)};Ue.greaterThan=Ue.gt=function(e){return this.cmp(e)>0};Ue.greaterThanOrEqualTo=Ue.gte=function(e){return this.cmp(e)>=0};Ue.isInteger=Ue.isint=function(){return this.e>this.d.length-2};Ue.isNegative=Ue.isneg=function(){return this.s<0};Ue.isPositive=Ue.ispos=function(){return this.s>0};Ue.isZero=function(){return this.s===0};Ue.lessThan=Ue.lt=function(e){return this.cmp(e)<0};Ue.lessThanOrEqualTo=Ue.lte=function(e){return this.cmp(e)<1};Ue.logarithm=Ue.log=function(e){var t,r=this,n=r.constructor,a=n.precision,s=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(An))throw Error(na+"NaN");if(r.s<1)throw Error(na+(r.s?"NaN":"-Infinity"));return r.eq(An)?new n(0):(Rt=!1,t=Ga(Ol(r,s),Ol(e,s),s),Rt=!0,Nt(t,a))};Ue.minus=Ue.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?bk(t,e):xk(t,(e.s=-e.s,e))};Ue.modulo=Ue.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(na+"NaN");return r.s?(Rt=!1,t=Ga(r,e,0,1).times(e),Rt=!0,r.minus(t)):Nt(new n(r),a)};Ue.naturalExponential=Ue.exp=function(){return yk(this)};Ue.naturalLogarithm=Ue.ln=function(){return Ol(this)};Ue.negated=Ue.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ue.plus=Ue.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?xk(t,e):bk(t,(e.s=-e.s,e))};Ue.precision=Ue.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(li+e);if(t=cr(a)+1,n=a.d.length-1,r=n*At+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Ue.squareRoot=Ue.sqrt=function(){var e,t,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(na+"NaN")}for(e=cr(l),Rt=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Ca(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=So((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(Ga(l,s,o+2)).times(.5),Ca(s.d).slice(0,o)===(t=Ca(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Nt(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return Rt=!0,Nt(n,r)};Ue.times=Ue.mul=function(e){var t,r,n,a,s,o,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(s=h,h=m,m=s,o=c,c=d,d=o),s=[],o=c+d,n=o;n--;)s.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=s[a]+m[n]*h[a-n-1]+t,s[a--]=l%jr|0,t=l/jr|0;s[a]=(s[a]+t)%jr|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,Rt?Nt(e,f.precision):e};Ue.toDecimalPlaces=Ue.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ra(e,0,_o),t===void 0?t=n.rounding:Ra(t,0,8),Nt(r,e+cr(r)+1,t))};Ue.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=wi(n,!0):(Ra(e,0,_o),t===void 0?t=a.rounding:Ra(t,0,8),n=Nt(new a(n),e+1,t),r=wi(n,!0,e+1)),r};Ue.toFixed=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?wi(a):(Ra(e,0,_o),t===void 0?t=s.rounding:Ra(t,0,8),n=Nt(new s(a),e+cr(a)+1,t),r=wi(n.abs(),!1,e+cr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Ue.toInteger=Ue.toint=function(){var e=this,t=e.constructor;return Nt(new t(e),cr(e)+1,t.rounding)};Ue.toNumber=function(){return+this};Ue.toPower=Ue.pow=function(e){var t,r,n,a,s,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(An);if(l=new c(l),!l.s){if(e.s<1)throw Error(na+"Infinity");return l}if(l.eq(An))return l;if(n=c.precision,e.eq(An))return Nt(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=u<0?-u:u)<=gk){for(a=new c(An),t=Math.ceil(n/At+4),Rt=!1;r%2&&(a=a.times(l),W2(a.d,t)),r=So(r/2),r!==0;)l=l.times(l),W2(l.d,t);return Rt=!0,e.s<0?new c(An).div(a):Nt(a,n)}}else if(s<0)throw Error(na+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Rt=!1,a=e.times(Ol(l,n+d)),Rt=!0,a=yk(a),a.s=s,a};Ue.toPrecision=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?(r=cr(a),n=wi(a,r<=s.toExpNeg||r>=s.toExpPos)):(Ra(e,1,_o),t===void 0?t=s.rounding:Ra(t,0,8),a=Nt(new s(a),e,t),r=cr(a),n=wi(a,e<=r||r<=s.toExpNeg,e)),n};Ue.toSignificantDigits=Ue.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ra(e,1,_o),t===void 0?t=n.rounding:Ra(t,0,8)),Nt(new n(r),e,t)};Ue.toString=Ue.valueOf=Ue.val=Ue.toJSON=Ue[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=cr(e),r=e.constructor;return wi(e,t<=r.toExpNeg||t>=r.toExpPos)};function xk(e,t){var r,n,a,s,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Rt?Nt(t,f):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(f/At),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=d.length,l-s<0&&(s=l,n=d,d=c,c=n),r=0;s;)r=(c[--s]=c[s]+d[s]+r)/jr|0,c[s]%=jr;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,Rt?Nt(t,f):t}function Ra(e,t,r){if(e!==~~e||e<t||e>r)throw Error(li+e)}function Ca(e){var t,r,n,a=e.length-1,s="",o=e[0];if(a>0){for(s+=o,t=1;t<a;t++)n=e[t]+"",r=At-n.length,r&&(s+=bs(r)),s+=n;o=e[t],n=o+"",r=At-n.length,r&&(s+=bs(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Ga=(function(){function e(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%jr|0,o=s/jr|0;return o&&n.unshift(o),n}function t(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*jr+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,d,u,f,h,m,p,v,g,x,b,y,w,j,N,E,S,O=n.constructor,k=n.s==a.s?1:-1,T=n.d,A=a.d;if(!n.s)return new O(n);if(!a.s)throw Error(na+"Division by zero");for(c=n.e-a.e,E=A.length,j=T.length,m=new O(k),p=m.d=[],d=0;A[d]==(T[d]||0);)++d;if(A[d]>(T[d]||0)&&--c,s==null?b=s=O.precision:o?b=s+(cr(n)-cr(a))+1:b=s,b<0)return new O(0);if(b=b/At+2|0,d=0,E==1)for(u=0,A=A[0],b++;(d<j||u)&&b--;d++)y=u*jr+(T[d]||0),p[d]=y/A|0,u=y%A|0;else{for(u=jr/(A[0]+1)|0,u>1&&(A=e(A,u),T=e(T,u),E=A.length,j=T.length),w=E,v=T.slice(0,E),g=v.length;g<E;)v[g++]=0;S=A.slice(),S.unshift(0),N=A[0],A[1]>=jr/2&&++N;do u=0,l=t(A,v,E,g),l<0?(x=v[0],E!=g&&(x=x*jr+(v[1]||0)),u=x/N|0,u>1?(u>=jr&&(u=jr-1),f=e(A,u),h=f.length,g=v.length,l=t(f,v,h,g),l==1&&(u--,r(f,E<h?S:A,h))):(u==0&&(l=u=1),f=A.slice()),h=f.length,h<g&&f.unshift(0),r(v,f,g),l==-1&&(g=v.length,l=t(A,v,E,g),l<1&&(u++,r(v,E<g?S:A,g))),g=v.length):l===0&&(u++,v=[0]),p[d++]=u,l&&v[0]?v[g++]=T[w]||0:(v=[T[w]],g=1);while((w++<j||v[0]!==void 0)&&b--)}return p[0]||p.shift(),m.e=c,Nt(m,o?s+cr(m)+1:s)}})();function yk(e,t){var r,n,a,s,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(cr(e)>16)throw Error(Fx+cr(e));if(!e.s)return new u(An);for(Rt=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(Xs(2,d))/Math.LN10*2+5|0,l+=n,r=a=s=new u(An),u.precision=l;;){if(a=Nt(a.times(e),l),r=r.times(++c),o=s.plus(Ga(a,r,l)),Ca(o.d).slice(0,l)===Ca(s.d).slice(0,l)){for(;d--;)s=Nt(s.times(s),l);return u.precision=f,t==null?(Rt=!0,Nt(s,f)):s}s=o}}function cr(e){for(var t=e.e*At,r=e.d[0];r>=10;r/=10)t++;return t}function Gh(e,t,r){if(t>e.LN10.sd())throw Rt=!0,r&&(e.precision=r),Error(na+"LN10 precision limit exceeded");return Nt(new e(e.LN10),t)}function bs(e){for(var t="";e--;)t+="0";return t}function Ol(e,t){var r,n,a,s,o,l,c,d,u,f=1,h=10,m=e,p=m.d,v=m.constructor,g=v.precision;if(m.s<1)throw Error(na+(m.s?"NaN":"-Infinity"));if(m.eq(An))return new v(0);if(t==null?(Rt=!1,d=g):d=t,m.eq(10))return t==null&&(Rt=!0),Gh(v,d);if(d+=h,v.precision=d,r=Ca(p),n=r.charAt(0),s=cr(m),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Ca(m.d),n=r.charAt(0),f++;s=cr(m),n>1?(m=new v("0."+r),s++):m=new v(n+"."+r.slice(1))}else return c=Gh(v,d+2,g).times(s+""),m=Ol(new v(n+"."+r.slice(1)),d-h).plus(c),v.precision=g,t==null?(Rt=!0,Nt(m,g)):m;for(l=o=m=Ga(m.minus(An),m.plus(An),d),u=Nt(m.times(m),d),a=3;;){if(o=Nt(o.times(u),d),c=l.plus(Ga(o,new v(a),d)),Ca(c.d).slice(0,d)===Ca(l.d).slice(0,d))return l=l.times(2),s!==0&&(l=l.plus(Gh(v,d+2,g).times(s+""))),l=Ga(l,new v(f),d),v.precision=g,t==null?(Rt=!0,Nt(l,g)):l;l=c,a+=2}}function q2(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=So(r/At),e.d=[],n=(r+1)%At,r<0&&(n+=At),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=At;n<a;)e.d.push(+t.slice(n,n+=At));t=t.slice(n),n=At-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Rt&&(e.e>Uu||e.e<-Uu))throw Error(Fx+r)}else e.s=0,e.e=0,e.d=[0];return e}function Nt(e,t,r){var n,a,s,o,l,c,d,u,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=At,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/At),s=f.length,u>=s)return e;for(d=s=f[u],o=1;s>=10;s/=10)o++;n%=At,a=n-At+o}if(r!==void 0&&(s=Xs(10,o-a-1),l=d/s%10|0,c=t<0||f[u+1]!==void 0||d%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/Xs(10,o-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=cr(e),f.length=1,t=t-s-1,f[0]=Xs(10,(At-t%At)%At),e.e=So(-t/At)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,s=1,u--):(f.length=u+1,s=Xs(10,At-n),f[u]=a>0?(d/Xs(10,o-a)%Xs(10,a)|0)*s:0),c)for(;;)if(u==0){(f[0]+=s)==jr&&(f[0]=1,++e.e);break}else{if(f[u]+=s,f[u]!=jr)break;f[u--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(Rt&&(e.e>Uu||e.e<-Uu))throw Error(Fx+cr(e));return e}function bk(e,t){var r,n,a,s,o,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Rt?Nt(t,m):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(m/At),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=jr-1;--c[s],c[a]+=jr}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Rt?Nt(t,m):t):new h(0)}function wi(e,t,r){var n,a=cr(e),s=Ca(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+bs(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+bs(-a-1)+s,r&&(n=r-o)>0&&(s+=bs(n))):a>=o?(s+=bs(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+bs(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=bs(n))),e.s<0?"-"+s:s}function W2(e,t){if(e.length>t)return e.length=t,!0}function wk(e){var t,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(li+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return q2(o,s.toString())}else if(typeof s!="string")throw Error(li+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,jz.test(s))q2(o,s);else throw Error(li+s)}if(a.prototype=Ue,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=wk,a.config=a.set=Nz,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Nz(e){if(!e||typeof e!="object")throw Error(na+"Object expected");var t,r,n,a=["precision",1,_o,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(So(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(li+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(li+r+": "+n);return this}var Lx=wk(wz);An=new Lx(1);const bt=Lx;var Ez=e=>e,jk={},Nk=e=>e===jk,H2=e=>function t(){return arguments.length===0||arguments.length===1&&Nk(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Ek=(e,t)=>e===1?t:H2(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==jk).length;return s>=e?t(...n):Ek(e-s,H2(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=n.map(u=>Nk(u)?l.shift():u);return t(...d,...l)}))}),Gd=e=>Ek(e.length,e),Jv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},_z=Gd((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Sz=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return Ez;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}},Qv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),_k=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return t&&a.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=a,r=e(...a)),r}};function Sk(e){var t;return e===0?t=1:t=Math.floor(new bt(e).abs().log(10).toNumber())+1,t}function Tk(e,t,r){for(var n=new bt(e),a=0,s=[];n.lt(t)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}Gd((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});Gd((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});Gd((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var Ak=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},kk=(e,t,r)=>{if(e.lte(0))return new bt(0);var n=Sk(e.toNumber()),a=new bt(10).pow(n),s=e.div(a),o=n!==1?.05:.1,l=new bt(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?new bt(c.toNumber()):new bt(Math.ceil(c.toNumber()))},Tz=(e,t,r)=>{var n=new bt(1),a=new bt(e);if(!a.isint()&&r){var s=Math.abs(e);s<1?(n=new bt(10).pow(Sk(e)-1),a=new bt(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new bt(Math.floor(e)))}else e===0?a=new bt(Math.floor((t-1)/2)):r||(a=new bt(Math.floor(e)));var o=Math.floor((t-1)/2),l=Sz(_z(c=>a.add(new bt(c-o).mul(n)).toNumber()),Jv);return l(0,t)},Ok=function(t,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new bt(0),tickMin:new bt(0),tickMax:new bt(0)};var o=kk(new bt(r).sub(t).div(n-1),a,s),l;t<=0&&r>=0?l=new bt(0):(l=new bt(t).add(r).div(2),l=l.sub(new bt(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new bt(r).sub(l).div(o).toNumber()),u=c+d+1;return u>n?Ok(t,r,n,a,s+1):(u<n&&(d=r>0?d+(n-u):d,c=r>0?c:c+(n-u)),{step:o,tickMin:l.sub(new bt(c).mul(o)),tickMax:l.add(new bt(d).mul(o))})};function Az(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(n,2),[o,l]=Ak([t,r]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...Jv(0,n-1).map(()=>1/0)]:[...Jv(0,n-1).map(()=>-1/0),l];return t>r?Qv(c):c}if(o===l)return Tz(o,n,a);var{step:d,tickMin:u,tickMax:f}=Ok(o,l,s,a,0),h=Tk(u,f.add(new bt(.1).mul(d)),d);return t>r?Qv(h):h}function kz(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=Ak([r,n]);if(s===-1/0||o===1/0)return[r,n];if(s===o)return[s];var l=Math.max(t,2),c=kk(new bt(o).sub(s).div(l-1),a,0),d=[...Tk(new bt(s),new bt(o),c),o];return a===!1&&(d=d.map(u=>Math.round(u))),r>n?Qv(d):d}var Oz=_k(Az),Cz=_k(kz),Ck=e=>e.rootProps.maxBarSize,Pz=e=>e.rootProps.barGap,Pk=e=>e.rootProps.barCategoryGap,Dz=e=>e.rootProps.barSize,fc=e=>e.rootProps.stackOffset,Mx=e=>e.options.chartName,Bx=e=>e.rootProps.syncId,Dk=e=>e.rootProps.syncMethod,$x=e=>e.options.eventEmitter,Ba={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},_n={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Kd=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Iz={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ba.angleAxisId,includeHidden:!1,name:void 0,reversed:Ba.reversed,scale:Ba.scale,tick:Ba.tick,tickCount:void 0,ticks:void 0,type:Ba.type,unit:void 0},Rz={allowDataOverflow:_n.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:_n.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:_n.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:_n.scale,tick:_n.tick,tickCount:_n.tickCount,ticks:void 0,type:_n.type,unit:void 0},Fz={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ba.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ba.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ba.scale,tick:Ba.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Lz={allowDataOverflow:_n.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:_n.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:_n.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:_n.scale,tick:_n.tick,tickCount:_n.tickCount,ticks:void 0,type:"category",unit:void 0},zx=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Fz:Iz,Ux=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Lz:Rz,Yd=e=>e.polarOptions,qx=pe([ls,cs,yr],pA),Ik=pe([Yd,qx],(e,t)=>{if(e!=null)return Gr(e.innerRadius,t,0)}),Rk=pe([Yd,qx],(e,t)=>{if(e!=null)return Gr(e.outerRadius,t,t*.8)}),Mz=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},Fk=pe([Yd],Mz);pe([zx,Fk],Kd);var Lk=pe([qx,Ik,Rk],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});pe([Ux,Lk],Kd);var Mk=pe([ut,Yd,Ik,Rk,ls,cs],(e,t,r,n,a,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:Gr(o,a,a/2),cy:Gr(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:d,clockWise:!1}}}),Ft=(e,t)=>t,hc=(e,t,r)=>r;function Xd(e){return e?.id}var wr=e=>{var t=ut(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},To=e=>e.tooltip.settings.axisId,Ar=e=>{var t=wr(e),r=To(e);return mc(e,t,r)},Bk=pe([Ar],e=>e?.dataKey);function $k(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:n;if(!(d==null||d.length===0)){var u=Xd(l);d.forEach((f,h)=>{var m=s==null||a?h:String(Tt(f,s,null)),p=Tt(f,l.dataKey,0),v;o.has(m)?v=o.get(m):v={},Object.assign(v,{[u]:p}),o.set(m,v)})}}),Array.from(o.values())}function Zd(e){return e.stackId!=null&&e.dataKey!=null}function V2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V2(Object(r),!0).forEach(function(n){Bz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bz(e,t,r){return(t=$z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $z(e){var t=zz(e,"string");return typeof t=="symbol"?t:t+""}function zz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eg=[0,"auto"],jn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},zk=(e,t)=>e.cartesianAxis.xAxis[t],ds=(e,t)=>{var r=zk(e,t);return r??jn},Nn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:eg,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:sc},Uk=(e,t)=>e.cartesianAxis.yAxis[t],fs=(e,t)=>{var r=Uk(e,t);return r??Nn},Uz={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Wx=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Uz},nr=(e,t,r)=>{switch(t){case"xAxis":return ds(e,r);case"yAxis":return fs(e,r);case"zAxis":return Wx(e,r);case"angleAxis":return zx(e,r);case"radiusAxis":return Ux(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qz=(e,t,r)=>{switch(t){case"xAxis":return ds(e,r);case"yAxis":return fs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},mc=(e,t,r)=>{switch(t){case"xAxis":return ds(e,r);case"yAxis":return fs(e,r);case"angleAxis":return zx(e,r);case"radiusAxis":return Ux(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qk=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Hx(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Jd=e=>e.graphicalItems.cartesianItems,Wz=pe([Ft,hc],Hx),Vx=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),pc=pe([Jd,nr,Wz],Vx),Wk=pe([pc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Zd)),Hk=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),Vk=pe([pc],Hk),Gx=e=>e.map(t=>t.data).filter(Boolean).flat(1),Hz=pe([pc],Gx),Kx=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Yx=pe([Hz,Vd],Kx),Xx=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Tt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Tt(a,n)}))):e.map(n=>({value:n})),Qd=pe([Yx,nr,pc],Xx);function Gk(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Di(e){return e.filter(t=>Ia(t)||t instanceof Date).map(Number).filter(t=>xn(t)===!1)}function Vz(e,t,r){return!r||typeof t!="number"||xn(t)?[]:r.length?Di(r.flatMap(n=>{var a=Tt(e,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Rr(s)||!Rr(o)))return[t-s,t+o]})):[]}var Gz=pe([Wk,Vd,Ar],$k),Kk=(e,t,r)=>{var n={},a=t.reduce((s,o)=>(o.stackId==null||(s[o.stackId]==null&&(s[o.stackId]=[]),s[o.stackId].push(o)),s),n);return Object.fromEntries(Object.entries(a).map(s=>{var[o,l]=s,c=l.map(Xd);return[o,{stackedData:JM(e,c,r),graphicalItems:l}]}))},Cl=pe([Gz,Wk,fc],Kk),Yk=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var s=r7(e,n,a);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},Kz=pe([Cl,$s,Ft],Yk),Xk=(e,t,r,n,a)=>r.length>0?e.flatMap(s=>r.flatMap(o=>{var l,c,d=(l=n[o.id])===null||l===void 0?void 0:l.filter(f=>Gk(a,f)),u=Tt(s,(c=t.dataKey)!==null&&c!==void 0?c:o.dataKey);return{value:u,errorDomain:Vz(s,u,d)}})).filter(Boolean):t?.dataKey!=null?e.map(s=>({value:Tt(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]})),ef=e=>e.errorBars,Zk=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>Gk(r,n));pe([Vk,ef,Ft],Zk);var Yz=pe([Yx,nr,Vk,ef,Ft],Xk);function Xz(e){var{value:t}=e;if(Ia(t)||t instanceof Date)return t}var G2=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Di(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Zz=(e,t,r)=>{var n=e.map(Xz).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&lT(n))?FA(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},Zx=e=>{var t;if(e==null||!("domain"in e))return eg;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Di(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:eg},Wu=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},Jk=e=>e.referenceElements.dots,Ao=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),Jz=pe([Jk,Ft,hc],Ao),Qk=e=>e.referenceElements.areas,Qz=pe([Qk,Ft,hc],Ao),eO=e=>e.referenceElements.lines,eU=pe([eO,Ft,hc],Ao),tO=(e,t)=>{var r=Di(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},tU=pe(Jz,Ft,tO),rO=(e,t)=>{var r=Di(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},rU=pe([Qz,Ft],rO),nO=(e,t)=>{var r=Di(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},nU=pe(eU,Ft,nO),aU=pe(tU,nU,rU,(e,t,r)=>Wu(e,r,t)),aO=pe([nr],Zx),Jx=(e,t,r,n,a,s,o)=>{var l=yz(t,e.allowDataOverflow);if(l!=null)return l;var c=s==="vertical"&&o==="xAxis"||s==="horizontal"&&o==="yAxis",d=c?Wu(r,a,G2(n)):Wu(a,G2(n));return bz(t,d,e.allowDataOverflow)},sU=pe([nr,aO,Kz,Yz,aU,ut,Ft],Jx),iU=[0,1],Qx=(e,t,r,n,a,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=os(t,s);return d&&l==null?FA(0,r.length):c==="category"?Zz(n,e,d):a==="expand"?iU:o}},e1=pe([nr,ut,Yx,Qd,fc,Ft,sU],Qx),sO=(e,t,r,n,a)=>{if(e!=null){var{scale:s,type:o}=e;if(s==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(tc(s));return l in Qo?l:"point"}}},ko=pe([nr,ut,qk,Mx,Ft],sO);function oU(e){if(e!=null){if(e in Qo)return Qo[e]();var t="scale".concat(tc(e));if(t in Qo)return Qo[t]()}}function t1(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=oU(t);if(a!=null){var s=a.domain(r).range(n);return GM(s),s}}}var r1=(e,t,r)=>{var n=Zx(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ho(e))return Oz(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ho(e))return Cz(e,t.tickCount,t.allowDecimals)}},n1=pe([e1,mc,ko],r1),a1=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&ho(t)&&Array.isArray(r)&&r.length>0){var a=t[0],s=r[0],o=t[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return t},lU=pe([nr,e1,n1,Ft],a1),cU=pe(Qd,nr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Di(e.map(l=>l.value))).sort((l,c)=>l-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var s=0;s<n.length-1;s++){var o=n[s+1]-n[s];r=Math.min(r,o)}return r/a}}),iO=pe(cU,ut,Pk,yr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Rr(e))return 0;var s=t==="vertical"?n.height:n.width;if(a==="gap")return e*s/2;if(a==="no-gap"){var o=Gr(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),uU=(e,t)=>{var r=ds(e,t);return r==null||typeof r.padding!="string"?0:iO(e,"xAxis",t,r.padding)},dU=(e,t)=>{var r=fs(e,t);return r==null||typeof r.padding!="string"?0:iO(e,"yAxis",t,r.padding)},fU=pe(ds,uU,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),hU=pe(fs,dU,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),mU=pe([yr,fU,Md,Ld,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),pU=pe([yr,ut,hU,Md,Ld,(e,t,r)=>r],(e,t,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),vc=(e,t,r,n)=>{var a;switch(t){case"xAxis":return mU(e,r,n);case"yAxis":return pU(e,r,n);case"zAxis":return(a=Wx(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Fk(e);case"radiusAxis":return Lk(e,r);default:return}},oO=pe([nr,vc],Kd),Oo=pe([nr,ko,lU,oO],t1);pe([pc,ef,Ft],Zk);function lO(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var tf=(e,t)=>t,rf=(e,t,r)=>r,vU=pe(Rd,tf,rf,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(lO)),gU=pe(Fd,tf,rf,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(lO)),cO=(e,t)=>({width:e.width,height:t.height}),xU=(e,t)=>{var r=typeof t.width=="number"?t.width:sc;return{width:r,height:e.height}},uO=pe(yr,ds,cO),yU=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},bU=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},wU=pe(cs,yr,vU,tf,rf,(e,t,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=cO(t,l);o==null&&(o=yU(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),s}),jU=pe(ls,yr,gU,tf,rf,(e,t,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=xU(t,l);o==null&&(o=bU(t,n,e));var d=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),s}),NU=(e,t)=>{var r=ds(e,t);if(r!=null)return wU(e,r.orientation,r.mirror)},EU=pe([yr,ds,NU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),_U=(e,t)=>{var r=fs(e,t);if(r!=null)return jU(e,r.orientation,r.mirror)},SU=pe([yr,fs,_U,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),dO=pe(yr,fs,(e,t)=>{var r=typeof t.width=="number"?t.width:sc;return{width:r,height:e.height}}),K2=(e,t,r)=>{switch(t){case"xAxis":return uO(e,r).width;case"yAxis":return dO(e,r).height;default:return}},fO=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=os(e,n),c=t.map(d=>d.value);if(o&&l&&s==="category"&&a&&lT(c))return c}},s1=pe([ut,Qd,nr,Ft],fO),hO=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=os(e,n);if(o&&(a==="number"||s!=="auto"))return t.map(l=>l.value)}},i1=pe([ut,Qd,mc,Ft],hO),Y2=pe([ut,qz,ko,Oo,s1,i1,vc,n1,Ft],(e,t,r,n,a,s,o,l,c)=>{if(t==null)return null;var d=os(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:n}}),TU=(e,t,r,n,a,s,o,l,c)=>{if(!(t==null||n==null)){var d=os(e,c),{type:u,ticks:f,tickCount:h}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,p=u==="category"&&n.bandwidth?n.bandwidth()/m:0;p=c==="angleAxis"&&s!=null&&s.length>=2?_r(s[0]-s[1])*2*p:p;var v=f||a;if(v){var g=v.map((x,b)=>{var y=o?o.indexOf(x):x;return{index:b,coordinate:n(y)+p,value:x,offset:p}});return g.filter(x=>!xn(x.coordinate))}return d&&l?l.map((x,b)=>({coordinate:n(x)+p,value:x,index:b,offset:p})):n.ticks?n.ticks(h).map(x=>({coordinate:n(x)+p,value:x,offset:p})):n.domain().map((x,b)=>({coordinate:n(x)+p,value:o?o[x]:x,index:b,offset:p}))}},mO=pe([ut,mc,ko,Oo,n1,vc,s1,i1,Ft],TU),AU=(e,t,r,n,a,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=os(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&n?.length>=2?_r(n[0]-n[1])*2*d:d,l&&s?s.map((u,f)=>({coordinate:r(u)+d,value:u,index:f,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,f)=>({coordinate:r(u)+d,value:a?a[u]:u,index:f,offset:d}))}},As=pe([ut,mc,Oo,vc,s1,i1,Ft],AU),ks=pe(nr,Oo,(e,t)=>{if(!(e==null||t==null))return qu(qu({},e),{},{scale:t})}),kU=pe([nr,ko,e1,oO],t1);pe((e,t,r)=>Wx(e,r),kU,(e,t)=>{if(!(e==null||t==null))return qu(qu({},e),{},{scale:t})});var OU=pe([ut,Rd,Fd],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),pO=e=>e.options.defaultTooltipEventType,vO=e=>e.options.validateTooltipEventTypes;function gO(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function o1(e,t){var r=pO(e),n=vO(e);return gO(t,r,n)}function CU(e){return We(t=>o1(t,e))}var xO=(e,t)=>{var r,n=Number(t);if(!(xn(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},PU=e=>e.tooltip.settings,js={active:!1,index:null,dataKey:void 0,coordinate:void 0},DU={itemInteraction:{click:js,hover:js},axisInteraction:{click:js,hover:js},keyboardInteraction:js,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},yO=Mn({name:"tooltip",initialState:DU,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Va(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:IU,removeTooltipEntrySettings:RU,setTooltipSettingsState:FU,setActiveMouseOverItemIndex:bO,mouseLeaveItem:LU,mouseLeaveChart:wO,setActiveClickItemIndex:MU,setMouseOverAxisIndex:jO,setMouseClickAxisIndex:BU,setSyncInteraction:tg,setKeyboardInteraction:rg}=yO.actions,$U=yO.reducer;function X2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X2(Object(r),!0).forEach(function(n){zU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zU(e,t,r){return(t=UU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UU(e){var t=qU(e,"string");return typeof t=="symbol"?t:t+""}function qU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WU(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function HU(e){return e.index!=null}var NO=(e,t,r,n)=>{if(t==null)return js;var a=WU(e,t,r);if(a==null)return js;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(HU(a)){if(s)return Gc(Gc({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Gc(Gc({},js),{},{coordinate:a.coordinate})},l1=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Rr(n))return r;var a=0,s=1/0;return t.length>0&&(s=t.length-1),String(Math.max(a,Math.min(n,s)))},EO=(e,t,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,s);if(d!=null)return d;var u=a?.[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},_O=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.dataKey)===a})},gc=e=>e.options.tooltipPayloadSearcher,Co=e=>e.tooltip;function Z2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function J2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z2(Object(r),!0).forEach(function(n){VU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VU(e,t,r){return(t=GU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GU(e){var t=KU(e,"string");return typeof t=="symbol"?t:t+""}function KU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YU(e,t){return e??t}var SO=(e,t,r,n,a,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,f=[];return e.reduce((h,m)=>{var p,{dataDefinedOnItem:v,settings:g}=m,x=YU(v,l),b=Array.isArray(x)?vA(x,d,u):x,y=(p=g?.dataKey)!==null&&p!==void 0?p:n,w=g?.nameKey,j;if(n&&Array.isArray(b)&&!Array.isArray(b[0])&&o==="axis"?j=cT(b,n,a):j=s(b,t,c,w),Array.isArray(j))j.forEach(E=>{var S=J2(J2({},g),{},{name:E.name,unit:E.unit,color:void 0,fill:void 0});h.push(Iw({tooltipEntrySettings:S,dataKey:E.dataKey,payload:E.payload,value:Tt(E.payload,E.dataKey),name:E.name}))});else{var N;h.push(Iw({tooltipEntrySettings:g,dataKey:y,payload:j,value:Tt(j,y),name:(N=Tt(j,w))!==null&&N!==void 0?N:g?.name}))}return h},f)}},c1=pe([Ar,ut,qk,Mx,wr],sO),XU=pe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),ZU=pe([wr,To],Hx),xc=pe([XU,Ar,ZU],Vx),JU=pe([xc],e=>e.filter(Zd)),QU=pe([xc],Gx),Po=pe([QU,$s],Kx),eq=pe([JU,$s,Ar],$k),u1=pe([Po,Ar,xc],Xx),tq=pe([Ar],Zx),rq=pe([xc],e=>e.filter(Zd)),nq=pe([eq,rq,fc],Kk),aq=pe([nq,$s,wr],Yk),sq=pe([xc],Hk),iq=pe([Po,Ar,sq,ef,wr],Xk),oq=pe([Jk,wr,To],Ao),lq=pe([oq,wr],tO),cq=pe([Qk,wr,To],Ao),uq=pe([cq,wr],rO),dq=pe([eO,wr,To],Ao),fq=pe([dq,wr],nO),hq=pe([lq,fq,uq],Wu),mq=pe([Ar,tq,aq,iq,hq,ut,wr],Jx),TO=pe([Ar,ut,Po,u1,fc,wr,mq],Qx),pq=pe([TO,Ar,c1],r1),vq=pe([Ar,TO,pq,wr],a1),AO=e=>{var t=wr(e),r=To(e),n=!1;return vc(e,t,r,n)},kO=pe([Ar,AO],Kd),OO=pe([Ar,c1,vq,kO],t1),gq=pe([ut,u1,Ar,wr],fO),xq=pe([ut,u1,Ar,wr],hO),yq=(e,t,r,n,a,s,o,l)=>{if(t){var{type:c}=t,d=os(e,l);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return f=l==="angleAxis"&&a!=null&&a?.length>=2?_r(a[0]-a[1])*2*f:f,d&&o?o.map((h,m)=>({coordinate:n(h)+f,value:h,index:m,offset:f})):n.domain().map((h,m)=>({coordinate:n(h)+f,value:s?s[h]:h,index:m,offset:f}))}}},hs=pe([ut,Ar,c1,OO,AO,gq,xq,wr],yq),d1=pe([pO,vO,PU],(e,t,r)=>gO(r.shared,e,t)),CO=e=>e.tooltip.settings.trigger,f1=e=>e.tooltip.settings.defaultIndex,nf=pe([Co,d1,CO,f1],NO),Os=pe([nf,Po],l1),PO=pe([hs,Os],xO),DO=pe([nf],e=>{if(e)return e.dataKey}),IO=pe([Co,d1,CO,f1],_O),bq=pe([ls,cs,ut,yr,hs,f1,IO,gc],EO),wq=pe([nf,bq],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),jq=pe([nf],e=>e.active),Nq=pe([IO,Os,$s,Bk,PO,gc,d1],SO),Eq=pe([Nq],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Q2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q2(Object(r),!0).forEach(function(n){_q(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _q(e,t,r){return(t=Sq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sq(e){var t=Tq(e,"string");return typeof t=="symbol"?t:t+""}function Tq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aq=()=>We(Ar),kq=()=>{var e=Aq(),t=We(hs),r=We(OO);return El(ej(ej({},e),{},{scale:r}),t)},RO=()=>We(Mx),h1=(e,t)=>t,FO=(e,t,r)=>r,m1=(e,t,r,n)=>n,Oq=pe(hs,e=>kd(e,t=>t.coordinate)),p1=pe([Co,h1,FO,m1],NO),LO=pe([p1,Po],l1),Cq=(e,t,r)=>{if(t!=null){var n=Co(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},MO=pe([Co,h1,FO,m1],_O),Hu=pe([ls,cs,ut,yr,hs,m1,MO,gc],EO),Pq=pe([p1,Hu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),BO=pe(hs,LO,xO),Dq=pe([MO,LO,$s,Bk,BO,gc,h1],SO),Iq=pe([p1],e=>({isActive:e.active,activeIndex:e.index})),Rq=(e,t,r,n,a,s,o,l)=>{if(!(!e||!t||!n||!a||!s)){var c=n7(e.chartX,e.chartY,t,r,l);if(c){var d=s7(c,t),u=HM(d,o,s,n,a),f=a7(t,s,u,c);return{activeIndex:String(u),activeCoordinate:f}}}};function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ng.apply(null,arguments)}function tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tj(Object(r),!0).forEach(function(n){Fq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fq(e,t,r){return(t=Lq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lq(e){var t=Mq(e,"string");return typeof t=="symbol"?t:t+""}function Mq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bq(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:s,layout:o,cursor:l,tooltipEventType:c,chartName:d}=e,u=t,f=r,h=n;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var m,p;if(d==="ScatterChart")m=u,p=sB;else if(d==="BarChart")m=iB(o,u,a,s),p=PA;else if(o==="radial"){var{cx:v,cy:g,radius:x,startAngle:b,endAngle:y}=DA(u);m={cx:v,cy:g,startAngle:b,endAngle:y,innerRadius:x,outerRadius:x},p=RA}else m={points:BB(o,u,a)},p=sl;var w=typeof l=="object"&&"className"in l?l.className:void 0,j=Kc(Kc(Kc(Kc({stroke:"#ccc",pointerEvents:"none"},a),m),Zt(l,!1)),{},{payload:f,payloadIndex:h,className:lt("recharts-tooltip-cursor",w)});return _.isValidElement(l)?_.cloneElement(l,j):_.createElement(p,j)}function $q(e){var t=kq(),r=NA(),n=Bd(),a=RO();return _.createElement(Bq,ng({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var $O=_.createContext(null),zq=()=>_.useContext($O),Kh={exports:{}},rj;function Uq(){return rj||(rj=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function s(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,f||c,h),p=r?r+d:d;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],m]:c._events[p].push(m):(c._events[p]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,p=new Array(m);h<m;h++)p[h]=f[h].fn;return p},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,p){var v=r?r+d:d;if(!this._events[v])return!1;var g=this._events[v],x=arguments.length,b,y;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),x){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,h),!0;case 5:return g.fn.call(g.context,u,f,h,m),!0;case 6:return g.fn.call(g.context,u,f,h,m,p),!0}for(y=1,b=new Array(x-1);y<x;y++)b[y-1]=arguments[y];g.fn.apply(g.context,b)}else{var w=g.length,j;for(y=0;y<w;y++)switch(g[y].once&&this.removeListener(d,g[y].fn,void 0,!0),x){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,f);break;case 4:g[y].fn.call(g[y].context,u,f,h);break;default:if(!b)for(j=1,b=new Array(x-1);j<x;j++)b[j-1]=arguments[j];g[y].fn.apply(g[y].context,b)}}return!0},l.prototype.on=function(d,u,f){return s(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return s(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var p=this._events[m];if(p.fn)p.fn===u&&(!h||p.once)&&(!f||p.context===f)&&o(this,m);else{for(var v=0,g=[],x=p.length;v<x;v++)(p[v].fn!==u||h&&!p[v].once||f&&p[v].context!==f)&&g.push(p[v]);g.length?this._events[m]=g.length===1?g[0]:g:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Kh)),Kh.exports}var qq=Uq();const Wq=ss(qq);var Pl=new Wq,ag="recharts.syncEvent.tooltip",nj="recharts.syncEvent.brush";function v1(e,t){if(t){var r=Number.parseInt(t,10);if(!xn(r))return e?.[r]}}var Hq={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},zO=Mn({name:"options",initialState:Hq,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Vq=zO.reducer,{createEventEmitter:Gq}=zO.actions;function Kq(e){return e.tooltip.syncInteraction}var Yq={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},UO=Mn({name:"chartData",initialState:Yq,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:aj,setDataStartEndIndexes:Xq,setComputedData:ahe}=UO.actions,Zq=UO.reducer,Jq=["x","y"];function sj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sj(Object(r),!0).forEach(function(n){Qq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qq(e,t,r){return(t=eW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eW(e){var t=tW(e,"string");return typeof t=="symbol"?t:t+""}function tW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rW(e,t){if(e==null)return{};var r,n,a=nW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var qO=()=>{};function aW(){var e=We(Bx),t=We($x),r=Wt(),n=We(Dk),a=We(hs),s=Bd(),o=lx(),l=We(c=>c.rootProps.className);_.useEffect(()=>{if(e==null)return qO;var c=(d,u,f)=>{if(t!==f&&e===d){if(n==="index"){var h;if(o&&u!==null&&u!==void 0&&(h=u.payload)!==null&&h!==void 0&&h.coordinate){var m=u.payload.coordinate,{x:p,y:v}=m,g=rW(m,Jq),x=Gs(Gs(Gs({},g),typeof p=="number"&&{x:Math.max(o.x,Math.min(p,o.x+o.width))}),typeof v=="number"&&{y:Math.max(o.y,Math.min(v,o.y+o.height))}),b=Gs(Gs({},u),{},{payload:Gs(Gs({},u.payload),{},{coordinate:x})});r(b)}else r(u);return}if(a!=null){var y;if(typeof n=="function"){var w={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},j=n(a,w);y=a[j]}else n==="value"&&(y=a.find(P=>String(P.value)===u.payload.label));var{coordinate:N}=u.payload;if(y==null||u.payload.active===!1||N==null||o==null){r(tg({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:E,y:S}=N,O=Math.min(E,o.x+o.width),k=Math.min(S,o.y+o.height),T={x:s==="horizontal"?y.coordinate:O,y:s==="horizontal"?k:y.coordinate},A=tg({active:u.payload.active,coordinate:T,dataKey:u.payload.dataKey,index:String(y.index),label:u.payload.label});r(A)}}};return Pl.on(ag,c),()=>{Pl.off(ag,c)}},[l,r,t,e,n,a,s,o])}function sW(){var e=We(Bx),t=We($x),r=Wt();_.useEffect(()=>{if(e==null)return qO;var n=(a,s,o)=>{t!==o&&e===a&&r(Xq(s))};return Pl.on(nj,n),()=>{Pl.off(nj,n)}},[r,t,e])}function iW(){var e=Wt();_.useEffect(()=>{e(Gq())},[e]),aW(),sW()}function oW(e,t,r,n,a,s){var o=We(h=>Cq(h,e,t)),l=We($x),c=We(Bx),d=We(Dk),u=We(Kq),f=u?.active;_.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=tg({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n});Pl.emit(ag,c,h,l)}},[f,r,o,a,n,l,c,d,s])}function ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ij(Object(r),!0).forEach(function(n){lW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lW(e,t,r){return(t=cW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cW(e){var t=uW(e,"string");return typeof t=="symbol"?t:t+""}function uW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dW(e){return e.dataKey}function fW(e,t){return _.isValidElement(e)?_.cloneElement(e,t):typeof e=="function"?_.createElement(e,t):_.createElement(L7,t)}var lj=[],hW={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ls.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Yh(e){var t=Fr(e,hW),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:s,content:o,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:f,reverseDirection:h,useTranslate3d:m,wrapperStyle:p,cursor:v,shared:g,trigger:x,defaultIndex:b,portal:y,axisId:w}=t,j=Wt(),N=typeof b=="number"?String(b):b;_.useEffect(()=>{j(FU({shared:g,trigger:x,axisId:w,active:r,defaultIndex:N}))},[j,g,x,w,r,N]);var E=lx(),S=TA(),O=CU(g),{activeIndex:k,isActive:T}=We(I=>Iq(I,O,x,N)),A=We(I=>Dq(I,O,x,N)),P=We(I=>BO(I,O,x,N)),C=We(I=>Pq(I,O,x,N)),F=A,M=zq(),H=r??T,[V,B]=WT([F,H]),W=O==="axis"?P:void 0;oW(O,x,C,W,k,H);var z=y??M;if(z==null)return null;var D=F??lj;H||(D=lj),l&&D.length&&(D=BT(F.filter(I=>I.value!=null&&(I.hide!==!0||t.includeHidden)),u,dW));var L=D.length>0,q=_.createElement(W7,{allowEscapeViewBox:n,animationDuration:a,animationEasing:s,isAnimationActive:c,active:H,coordinate:C,hasPayload:L,offset:d,position:f,reverseDirection:h,useTranslate3d:m,viewBox:E,wrapperStyle:p,lastBoundingBox:V,innerRef:B,hasPortalFromProps:!!y},fW(o,oj(oj({},t),{},{payload:D,label:W,active:H,coordinate:C,accessibilityLayer:S})));return _.createElement(_.Fragment,null,pd.createPortal(q,z),H&&_.createElement($q,{cursor:v,tooltipEventType:O,coordinate:C,payload:F,index:k}))}var Xh={},Zh={},Jh={},cj;function mW(){return cj||(cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),d=s==null||s.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{d&&u(),v()};let h=null;const m=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},p=()=>{h!==null&&(clearTimeout(h),h=null)},v=()=>{p(),o=void 0,l=null},g=()=>{u()},x=function(...b){if(a?.aborted)return;o=this,l=b;const y=h==null;m(),c&&y&&u()};return x.schedule=m,x.cancel=v,x.flush=g,a?.addEventListener("abort",v,{once:!0}),x}e.debounce=t})(Jh)),Jh}var uj;function pW(){return uj||(uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mW();function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,f=null;const h=t.debounce(function(...v){u=n.apply(this,v),f=null},a,{edges:d}),m=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(u=n.apply(this,v),f=Date.now(),h.cancel(),h.schedule(),u):(h.apply(this,v),u)},p=()=>(h.flush(),u);return m.cancel=h.cancel,m.flush=p,m}e.debounce=r})(Zh)),Zh}var dj;function vW(){return dj||(dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pW();function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,a,{leading:o,maxWait:a,trailing:l})}e.throttle=r})(Xh)),Xh}var Qh,fj;function gW(){return fj||(fj=1,Qh=vW().throttle),Qh}var xW=gW();const yW=ss(xW);var il=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s]};function hj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hj(Object(r),!0).forEach(function(n){bW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bW(e,t,r){return(t=wW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wW(e){var t=jW(e,"string");return typeof t=="symbol"?t:t+""}function jW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t0=_.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:s="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:f,className:h,onResize:m,style:p={}}=e,v=_.useRef(null),g=_.useRef();g.current=m,_.useImperativeHandle(t,()=>v.current);var[x,b]=_.useState({containerWidth:n.width,containerHeight:n.height}),y=_.useCallback((j,N)=>{b(E=>{var S=Math.round(j),O=Math.round(N);return E.containerWidth===S&&E.containerHeight===O?E:{containerWidth:S,containerHeight:O}})},[]);_.useEffect(()=>{var j=O=>{var k,{width:T,height:A}=O[0].contentRect;y(T,A),(k=g.current)===null||k===void 0||k.call(g,T,A)};u>0&&(j=yW(j,u,{trailing:!0,leading:!1}));var N=new ResizeObserver(j),{width:E,height:S}=v.current.getBoundingClientRect();return y(E,S),N.observe(v.current),()=>{N.disconnect()}},[y,u]);var w=_.useMemo(()=>{var{containerWidth:j,containerHeight:N}=x;if(j<0||N<0)return null;il(Qs(a)||Qs(s),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,s),il(!r||r>0,"The aspect(%s) must be greater than zero.",r);var E=Qs(a)?j:a,S=Qs(s)?N:s;return r&&r>0&&(E?S=E/r:S&&(E=S*r),c&&S>c&&(S=c)),il(E>0||S>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,E,S,a,s,o,l,r),_.Children.map(d,O=>_.cloneElement(O,{width:E,height:S,style:e0({width:E,height:S},O.props.style)}))},[r,d,s,c,l,o,x,a]);return _.createElement("div",{id:f?"".concat(f):void 0,className:lt("recharts-responsive-container",h),style:e0(e0({},p),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:v},_.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),af=e=>null;af.displayName="Cell";function NW(e,t,r){return(t=EW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EW(e){var t=_W(e,"string");return typeof t=="symbol"?t:t+""}function _W(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class SW{constructor(t){NW(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function mj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function TW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mj(Object(r),!0).forEach(function(n){AW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AW(e,t,r){return(t=kW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kW(e){var t=OW(e,"string");return typeof t=="symbol"?t:t+""}function OW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CW={cacheSize:2e3,enableCache:!0},WO=TW({},CW),pj=new SW(WO.cacheSize),PW={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},vj="recharts_measurement_span";function DW(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var gj=(e,t)=>{try{var r=document.getElementById(vj);r||(r=document.createElement("span"),r.setAttribute("id",vj),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,PW,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},ol=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ls.isSsr)return{width:0,height:0};if(!WO.enableCache)return gj(t,r);var n=DW(t,r),a=pj.get(n);if(a)return a;var s=gj(t,r);return pj.set(n,s),s},xj=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yj=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,IW=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,RW=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,HO={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FW=Object.keys(HO),Vi="NaN";function LW(e,t){return e*HO[t]}class cn{static parse(t){var r,[,n,a]=(r=RW.exec(t))!==null&&r!==void 0?r:[];return new cn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,xn(t)&&(this.unit=""),r!==""&&!IW.test(r)&&(this.num=NaN,this.unit=""),FW.includes(r)&&(this.num=LW(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new cn(NaN,""):new cn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new cn(NaN,""):new cn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new cn(NaN,""):new cn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new cn(NaN,""):new cn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return xn(this.num)}}function VO(e){if(e.includes(Vi))return Vi;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,s]=(r=xj.exec(t))!==null&&r!==void 0?r:[],o=cn.parse(n??""),l=cn.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Vi;t=t.replace(xj,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,f,h]=(d=yj.exec(t))!==null&&d!==void 0?d:[],m=cn.parse(u??""),p=cn.parse(h??""),v=f==="+"?m.add(p):m.subtract(p);if(v.isNaN())return Vi;t=t.replace(yj,v.toString())}return t}var bj=/\(([^()]*)\)/;function MW(e){for(var t=e,r;(r=bj.exec(t))!=null;){var[,n]=r;t=t.replace(bj,VO(n))}return t}function BW(e){var t=e.replace(/\s+/g,"");return t=MW(t),t=VO(t),t}function $W(e){try{return BW(e)}catch{return Vi}}function r0(e){var t=$W(e.slice(5,-1));return t===Vi?"":t}var zW=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],UW=["dx","dy","angle","className","breakAll"];function sg(){return sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sg.apply(null,arguments)}function wj(e,t){if(e==null)return{};var r,n,a=qW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var GO=/[ \f\n\r\t\v\u2028\u2029]+/,KO=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Ut(t)||(r?a=t.toString().split(""):a=t.toString().split(GO));var s=a.map(l=>({word:l,width:ol(l,n).width})),o=r?0:ol("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},WW=(e,t,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,d=qe(s),u=o,f=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return T.reduce((A,P)=>{var{word:C,width:F}=P,M=A[A.length-1];if(M&&(n==null||a||M.width+F+r<Number(n)))M.words.push(C),M.width+=F+r;else{var H={words:[C],width:F};A.push(H)}return A},[])},h=f(t),m=k=>k.reduce((T,A)=>T.width>A.width?T:A);if(!d||a)return h;var p=h.length>s||m(h).width>Number(n);if(!p)return h;for(var v="",g=k=>{var T=u.slice(0,k),A=KO({breakAll:c,style:l,children:T+v}).wordsWithComputedWidth,P=f(A),C=P.length>s||m(P).width>Number(n);return[C,P]},x=0,b=u.length-1,y=0,w;x<=b&&y<=u.length-1;){var j=Math.floor((x+b)/2),N=j-1,[E,S]=g(N),[O]=g(j);if(!E&&!O&&(x=j+1),E&&O&&(b=j-1),!E&&O){w=S;break}y++}return w||h},jj=e=>{var t=Ut(e)?[]:e.toString().split(GO);return[{words:t}]},HW=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=e;if((t||r)&&!Ls.isSsr){var l,c,d=KO({breakAll:s,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:f}=d;l=u,c=f}else return jj(n);return WW({breakAll:s,children:n,maxLines:o,style:a},l,c,t,r)}return jj(n)},Nj="#808080",sf=_.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:s="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=Nj}=e,u=wj(e,zW),f=_.useMemo(()=>HW({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:h,dy:m,angle:p,className:v,breakAll:g}=u,x=wj(u,UW);if(!Ia(r)||!Ia(n)||f.length===0)return null;var b=r+(qe(h)?h:0),y=n+(qe(m)?m:0),w;switch(c){case"start":w=r0("calc(".concat(s,")"));break;case"middle":w=r0("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(s," / 2))"));break;default:w=r0("calc(".concat(f.length-1," * -").concat(a,")"));break}var j=[];if(o){var N=f[0].width,{width:E}=u;j.push("scale(".concat(qe(E)?E/N:1,")"))}return p&&j.push("rotate(".concat(p,", ").concat(b,", ").concat(y,")")),j.length&&(x.transform=j.join(" ")),_.createElement("text",sg({},Zt(x,!0),{ref:t,x:b,y,className:lt("recharts-text",v),textAnchor:l,fill:d.includes("url")?Nj:d}),f.map((S,O)=>{var k=S.words.join(g?"":" ");return _.createElement("tspan",{x:b,dy:O===0?w:a,key:"".concat(k,"-").concat(O)},k)}))});sf.displayName="Text";var VW=["labelRef"];function GW(e,t){if(e==null)return{};var r,n,a=KW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ej(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ej(Object(r),!0).forEach(function(n){YW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ej(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YW(e,t,r){return(t=XW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XW(e){var t=ZW(e,"string");return typeof t=="symbol"?t:t+""}function ZW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return $a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$a.apply(null,arguments)}var YO=_.createContext(null),JW=e=>{var{x:t,y:r,width:n,height:a,children:s}=e,o=_.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return _.createElement(YO.Provider,{value:o},s)},XO=()=>{var e=_.useContext(YO),t=lx();return e||t},QW=_.createContext(null),eH=()=>{var e=_.useContext(QW),t=We(Mk);return e||t},tH=e=>{var{value:t,formatter:r}=e,n=Ut(e.children)?t:e.children;return typeof r=="function"?r(n):n},g1=e=>e!=null&&typeof e=="function",rH=(e,t)=>{var r=_r(t-e),n=Math.min(Math.abs(t-e),360);return r*n},nH=(e,t,r,n,a)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:f,endAngle:h,clockWise:m}=a,p=(d+u)/2,v=rH(f,h),g=v>=0?1:-1,x,b;switch(t){case"insideStart":x=f+g*s,b=m;break;case"insideEnd":x=h-g*s,b=!m;break;case"end":x=h+g*s,b=m;break;default:throw new Error("Unsupported position ".concat(t))}b=v<=0?b:!b;var y=lr(l,c,p,x),w=lr(l,c,p,x+(b?1:-1)*359),j="M".concat(y.x,",").concat(y.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(b?0:1,`,
    `).concat(w.x,",").concat(w.y),N=Ut(e.id)?wl("recharts-radial-line-"):e.id;return _.createElement("text",$a({},n,{dominantBaseline:"central",className:lt("recharts-radial-bar-label",o)}),_.createElement("defs",null,_.createElement("path",{id:N,d:j})),_.createElement("textPath",{xlinkHref:"#".concat(N)},r))},aH=(e,t,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:f}=lr(n,a,o+t,d);return{x:u,y:f,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(s+o)/2,{x:m,y:p}=lr(n,a,h,d);return{x:m,y:p,textAnchor:"middle",verticalAnchor:"middle"}},ZO=e=>"cx"in e&&qe(e.cx),sH=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,s;r!=null&&!ZO(r)&&(s=r);var{x:o,y:l,width:c,height:d}=t,u=d>=0?1:-1,f=u*n,h=u>0?"end":"start",m=u>0?"start":"end",p=c>=0?1:-1,v=p*n,g=p>0?"end":"start",x=p>0?"start":"end";if(a==="top"){var b={x:o+c/2,y:l-u*n,textAnchor:"middle",verticalAnchor:h};return tr(tr({},b),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var y={x:o+c/2,y:l+d+f,textAnchor:"middle",verticalAnchor:m};return tr(tr({},y),s?{height:Math.max(s.y+s.height-(l+d),0),width:c}:{})}if(a==="left"){var w={x:o-v,y:l+d/2,textAnchor:g,verticalAnchor:"middle"};return tr(tr({},w),s?{width:Math.max(w.x-s.x,0),height:d}:{})}if(a==="right"){var j={x:o+c+v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"};return tr(tr({},j),s?{width:Math.max(s.x+s.width-j.x,0),height:d}:{})}var N=s?{width:c,height:d}:{};return a==="insideLeft"?tr({x:o+v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"},N):a==="insideRight"?tr({x:o+c-v,y:l+d/2,textAnchor:g,verticalAnchor:"middle"},N):a==="insideTop"?tr({x:o+c/2,y:l+f,textAnchor:"middle",verticalAnchor:m},N):a==="insideBottom"?tr({x:o+c/2,y:l+d-f,textAnchor:"middle",verticalAnchor:h},N):a==="insideTopLeft"?tr({x:o+v,y:l+f,textAnchor:x,verticalAnchor:m},N):a==="insideTopRight"?tr({x:o+c-v,y:l+f,textAnchor:g,verticalAnchor:m},N):a==="insideBottomLeft"?tr({x:o+v,y:l+d-f,textAnchor:x,verticalAnchor:h},N):a==="insideBottomRight"?tr({x:o+c-v,y:l+d-f,textAnchor:g,verticalAnchor:h},N):a&&typeof a=="object"&&(qe(a.x)||Qs(a.x))&&(qe(a.y)||Qs(a.y))?tr({x:o+Gr(a.x,c),y:l+Gr(a.y,d),textAnchor:"end",verticalAnchor:"end"},N):tr({x:o+c/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)},iH={offset:5};function ws(e){var t=Fr(e,iH),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=eH(),f=XO(),h=n==="center"?f:u??f,m=r||h;if(!m||Ut(a)&&Ut(s)&&!_.isValidElement(o)&&typeof o!="function")return null;var p=tr(tr({},t),{},{viewBox:m});if(_.isValidElement(o)){var{labelRef:v}=p,g=GW(p,VW);return _.cloneElement(o,g)}var x;if(typeof o=="function"){if(x=_.createElement(o,p),_.isValidElement(x))return x}else x=tH(t);var b=ZO(m),y=Zt(t,!0);if(b&&(n==="insideStart"||n==="insideEnd"||n==="end"))return nH(t,n,x,y,m);var w=b?aH(m,t.offset,t.position):sH(t,m);return _.createElement(sf,$a({ref:d,className:lt("recharts-label",l)},y,w,{breakAll:c}),x)}ws.displayName="Label";var oH=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?_.createElement(ws,$a({key:"label-implicit"},n)):Ia(e)?_.createElement(ws,$a({key:"label-implicit",value:e},n)):_.isValidElement(e)?e.type===ws?_.cloneElement(e,tr({key:"label-implicit"},n)):_.createElement(ws,$a({key:"label-implicit",content:e},n)):g1(e)?_.createElement(ws,$a({key:"label-implicit",content:e},n)):e&&typeof e=="object"?_.createElement(ws,$a({},e,{key:"label-implicit"},n)):null};function lH(e){var{label:t}=e,r=XO();return oH(t,r)||null}var n0={},a0={},_j;function cH(){return _j||(_j=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(a0)),a0}var s0={},Sj;function uH(){return Sj||(Sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(s0)),s0}var Tj;function dH(){return Tj||(Tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cH(),r=uH(),n=Qg();function a(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=a})(n0)),n0}var i0,Aj;function fH(){return Aj||(Aj=1,i0=dH().last),i0}var hH=fH();const mH=ss(hH);var pH=["valueAccessor"],vH=["dataKey","clockWise","id","textBreakAll"];function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vu.apply(null,arguments)}function kj(e,t){if(e==null)return{};var r,n,a=gH(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xH=e=>Array.isArray(e.value)?mH(e.value):e.value,JO=_.createContext(void 0),QO=JO.Provider,eC=_.createContext(void 0),yH=eC.Provider;function bH(){return _.useContext(JO)}function wH(){return _.useContext(eC)}function du(e){var{valueAccessor:t=xH}=e,r=kj(e,pH),{dataKey:n,clockWise:a,id:s,textBreakAll:o}=r,l=kj(r,vH),c=bH(),d=wH(),u=c||d;return!u||!u.length?null:_.createElement(fr,{className:"recharts-label-list"},u.map((f,h)=>{var m,p=Ut(n)?t(f,h):Tt(f&&f.payload,n),v=Ut(s)?{}:{id:"".concat(s,"-").concat(h)};return _.createElement(ws,Vu({},Zt(f,!0),l,v,{fill:(m=r.fill)!==null&&m!==void 0?m:f.fill,parentViewBox:f.parentViewBox,value:p,textBreakAll:o,viewBox:f.viewBox,key:"label-".concat(h),index:h}))}))}du.displayName="LabelList";function x1(e){var{label:t}=e;return t?t===!0?_.createElement(du,{key:"labelList-implicit"}):_.isValidElement(t)||g1(t)?_.createElement(du,{key:"labelList-implicit",content:t}):typeof t=="object"?_.createElement(du,Vu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function ig(){return ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ig.apply(null,arguments)}var tC=e=>{var{cx:t,cy:r,r:n,className:a}=e,s=lt("recharts-dot",a);return t===+t&&r===+r&&n===+n?_.createElement("circle",ig({},Na(e),Wg(e),{className:s,cx:t,cy:r,r:n})):null},rC=e=>e.graphicalItems.polarItems,jH=pe([Ft,hc],Hx),y1=pe([rC,nr,jH],Vx),NH=pe([y1],Gx),b1=pe([NH,Rx],Kx),EH=pe([b1,nr,y1],Xx),_H=pe([b1,nr,y1],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var s,o=Tt(n,(s=t.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Tt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),Oj=()=>{},SH=pe([nr,aO,Oj,_H,Oj,ut,Ft],Jx),nC=pe([nr,ut,b1,EH,fc,Ft,SH],Qx),TH=pe([nC,nr,ko],r1);pe([nr,nC,TH,Ft],a1);var AH={radiusAxis:{},angleAxis:{}},aC=Mn({name:"polarAxis",initialState:AH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:she,removeRadiusAxis:ihe,addAngleAxis:ohe,removeAngleAxis:lhe}=aC.actions,kH=aC.reducer;function Cj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cj(Object(r),!0).forEach(function(n){OH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OH(e,t,r){return(t=CH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CH(e){var t=PH(e,"string");return typeof t=="symbol"?t:t+""}function PH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DH=(e,t)=>t,w1=pe([rC,DH],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),IH=[],j1=(e,t,r)=>r?.length===0?IH:r,sC=pe([Rx,w1,j1],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>Pj(Pj({},t.presentationProps),s.props))),a!=null)return a}}),RH=pe([sC,w1,j1],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var s,o=Tt(n,t.nameKey,t.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:No(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),FH=pe([sC,w1,j1,yr],(e,t,r,n)=>{if(!(t==null||e==null))return DV({offset:n,pieSettings:t,displayedData:e,cells:r})}),o0={},Dj;function LH(){return Dj||(Dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(o0)),o0}var l0,Ij;function MH(){return Ij||(Ij=1,l0=LH().isPlainObject),l0}var BH=MH();const $H=ss(BH);function Rj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rj(Object(r),!0).forEach(function(n){zH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zH(e,t,r){return(t=UH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UH(e){var t=qH(e,"string");return typeof t=="symbol"?t:t+""}function qH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gu(){return Gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gu.apply(null,arguments)}var Lj=(e,t,r,n,a)=>{var s=r-n,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-s/2,",").concat(t+a),o+="L ".concat(e+r-s/2-n,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z"),o},WH={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},HH=e=>{var t=Fr(e,WH),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:f}=t,h=_.useRef(),[m,p]=_.useState(-1),v=_.useRef(a),g=_.useRef(s),x=_.useRef(o),b=_.useRef(r),y=_.useRef(n),w=oc(e,"trapezoid-");if(_.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var C=h.current.getTotalLength();C&&p(C)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var j=lt("recharts-trapezoid",l);if(!f)return _.createElement("g",null,_.createElement("path",Gu({},Zt(t,!0),{className:j,d:Lj(r,n,a,s,o)})));var N=v.current,E=g.current,S=x.current,O=b.current,k=y.current,T="0px ".concat(m===-1?1:m,"px"),A="".concat(m,"px 0px"),P=AA(["strokeDasharray"],d,c);return _.createElement(ic,{animationId:w,key:w,canBegin:m>0,duration:d,easing:c,isActive:f,begin:u},C=>{var F=Bt(N,a,C),M=Bt(E,s,C),H=Bt(S,o,C),V=Bt(O,r,C),B=Bt(k,n,C);h.current&&(v.current=F,g.current=M,x.current=H,b.current=V,y.current=B);var W=C>0?{transition:P,strokeDasharray:A}:{strokeDasharray:T};return _.createElement("path",Gu({},Zt(t,!0),{className:j,d:Lj(V,B,F,M,H),ref:h,style:Fj(Fj({},W),t.style)}))})},VH=["option","shapeType","propTransformer","activeClassName","isActive"];function GH(e,t){if(e==null)return{};var r,n,a=KH(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Mj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ku(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mj(Object(r),!0).forEach(function(n){YH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YH(e,t,r){return(t=XH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XH(e){var t=ZH(e,"string");return typeof t=="symbol"?t:t+""}function ZH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JH(e,t){return Ku(Ku({},t),e)}function QH(e,t){return e==="symbols"}function Bj(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return _.createElement(PA,r);case"trapezoid":return _.createElement(HH,r);case"sector":return _.createElement(RA,r);case"symbols":if(QH(t))return _.createElement(Xg,r);break;default:return null}}function eV(e){return _.isValidElement(e)?e.props:e}function iC(e){var{option:t,shapeType:r,propTransformer:n=JH,activeClassName:a="recharts-active-shape",isActive:s}=e,o=GH(e,VH),l;if(_.isValidElement(t))l=_.cloneElement(t,Ku(Ku({},o),eV(t)));else if(typeof t=="function")l=t(o);else if($H(t)&&typeof t!="boolean"){var c=n(t,o);l=_.createElement(Bj,{shapeType:r,elementProps:c})}else{var d=o;l=_.createElement(Bj,{shapeType:r,elementProps:d})}return s?_.createElement(fr,{className:a},l):l}var N1=(e,t)=>{var r=Wt();return(n,a)=>s=>{e?.(n,a,s),r(bO({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},E1=e=>{var t=Wt();return(r,n)=>a=>{e?.(r,n,a),t(LU())}},_1=(e,t)=>{var r=Wt();return(n,a)=>s=>{e?.(n,a,s),r(MU({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function S1(e){var{fn:t,args:r}=e,n=Wt(),a=wn();return _.useEffect(()=>{if(!a){var s=t(r);return n(IU(s)),()=>{n(RU(s))}}},[t,r,n,a]),null}var oC=()=>{};function lC(e){var{legendPayload:t}=e,r=Wt(),n=wn();return _.useEffect(()=>n?oC:(r(_A(t)),()=>{r(SA(t))}),[r,n,t]),null}function tV(e){var{legendPayload:t}=e,r=Wt(),n=We(ut);return _.useEffect(()=>n!=="centric"&&n!=="radial"?oC:(r(_A(t)),()=>{r(SA(t))}),[r,n,t]),null}var c0,rV=()=>{var[e]=_.useState(()=>wl("uid-"));return e},nV=(c0=BP.useId)!==null&&c0!==void 0?c0:rV;function aV(e,t){var r=nV();return t||(e?"".concat(e,"-").concat(r):r)}var sV=_.createContext(void 0),T1=e=>{var{id:t,type:r,children:n}=e,a=aV("recharts-".concat(r),t);return _.createElement(sV.Provider,{value:a},n(a))},iV={cartesianItems:[],polarItems:[]},cC=Mn({name:"graphicalItems",initialState:iV,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Va(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Va(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Va(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:oV,replaceCartesianGraphicalItem:lV,removeCartesianGraphicalItem:cV,addPolarGraphicalItem:uV,removePolarGraphicalItem:dV}=cC.actions,fV=cC.reducer;function uC(e){var t=Wt(),r=_.useRef(null);return _.useEffect(()=>{r.current===null?t(oV(e)):r.current!==e&&t(lV({prev:r.current,next:e})),r.current=e},[t,e]),_.useEffect(()=>()=>{r.current&&(t(cV(r.current)),r.current=null)},[t]),null}function hV(e){var t=Wt();return _.useEffect(()=>(t(uV(e)),()=>{t(dV(e))}),[t,e]),null}var mV=["onMouseEnter","onClick","onMouseLeave"],pV=["id"],vV=["id"];function A1(e,t){if(e==null)return{};var r,n,a=gV(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function $j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$j(Object(r),!0).forEach(function(n){xV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$j(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xV(e,t,r){return(t=yV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yV(e){var t=bV(e,"string");return typeof t=="symbol"?t:t+""}function bV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cs(){return Cs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cs.apply(null,arguments)}function wV(e){var t=_.useMemo(()=>Hg(e.children,af),[e.children]),r=We(n=>RH(n,e.id,t));return r==null?null:_.createElement(tV,{legendPayload:r})}function jV(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:n.map(u=>u.tooltipPayload),positions:n.map(u=>u.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:No(l,t),hide:c,type:d,color:o,unit:""}}}var NV=(e,t)=>e>t?"start":e<t?"end":"middle",EV=(e,t,r)=>Gr(typeof t=="function"?t(e):t,r,r*.8),_V=(e,t,r)=>{var{top:n,left:a,width:s,height:o}=t,l=pA(s,o),c=a+Gr(e.cx,s,s/2),d=n+Gr(e.cy,o,o/2),u=Gr(e.innerRadius,l,0),f=EV(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:f,maxRadius:h}},SV=(e,t)=>{var r=_r(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function TV(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var AV=(e,t)=>{if(_.isValidElement(e))return _.cloneElement(e,t);if(typeof e=="function")return e(t);var r=lt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return _.createElement(sl,Cs({},t,{type:"linear",className:r}))},kV=(e,t,r)=>{if(_.isValidElement(e))return _.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),_.isValidElement(n)))return n;var a=lt("recharts-pie-label-text",TV(e));return _.createElement(sf,Cs({},t,{alignmentBaseline:"middle",className:a}),n)};function OV(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!t)return null;var l=Na(r),c=Zt(a,!1),d=Zt(s,!1),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((h,m)=>{var p=(h.startAngle+h.endAngle)/2,v=lr(h.cx,h.cy,h.outerRadius+u,p),g=Dt(Dt(Dt(Dt({},l),h),{},{stroke:"none"},c),{},{index:m,textAnchor:NV(v.x,h.cx)},v),x=Dt(Dt(Dt(Dt({},l),h),{},{fill:"none",stroke:h.fill},d),{},{index:m,points:[lr(h.cx,h.cy,h.outerRadius,p),v],key:"line"});return _.createElement(fr,{key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(m)},s&&AV(s,x),kV(a,g,Tt(h,o)))});return _.createElement(fr,{className:"recharts-pie-labels"},f)}function CV(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?_.createElement(x1,{label:a}):_.createElement(OV,{sectors:t,props:r,showLabels:n})}function PV(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,s=We(Os),{onMouseEnter:o,onClick:l,onMouseLeave:c}=a,d=A1(a,mV),u=N1(o,a.dataKey),f=E1(c),h=_1(l,a.dataKey);return t==null||t.length===0?null:_.createElement(_.Fragment,null,t.map((m,p)=>{if(m?.startAngle===0&&m?.endAngle===0&&t.length!==1)return null;var v=r&&String(p)===s,g=s?n:null,x=v?r:g,b=Dt(Dt({},m),{},{stroke:m.stroke,tabIndex:-1,[wA]:p,[jA]:a.dataKey});return _.createElement(fr,Cs({tabIndex:-1,className:"recharts-pie-sector"},rc(d,m,p),{onMouseEnter:u(m,p),onMouseLeave:f(m,p),onClick:h(m,p),key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(p)}),_.createElement(iC,Cs({option:x,isActive:v,shapeType:"sector"},b)))}))}function DV(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:f}=r,h=Math.abs(r.minAngle),m=SV(l,c),p=Math.abs(m),v=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=n.filter(N=>Tt(N,d,0)!==0).length,x=(p>=360?g:g-1)*v,b=p-g*h-x,y=n.reduce((N,E)=>{var S=Tt(E,d,0);return N+(qe(S)?S:0)},0),w;if(y>0){var j;w=n.map((N,E)=>{var S=Tt(N,d,0),O=Tt(N,u,E),k=_V(r,s,N),T=(qe(S)?S:0)/y,A,P=Dt(Dt({},N),a&&a[E]&&a[E].props);E?A=j.endAngle+_r(m)*v*(S!==0?1:0):A=l;var C=A+_r(m)*((S!==0?h:0)+T*b),F=(A+C)/2,M=(k.innerRadius+k.outerRadius)/2,H=[{name:O,value:S,payload:P,dataKey:d,type:f}],V=lr(k.cx,k.cy,M,F);return j=Dt(Dt(Dt(Dt({},r.presentationProps),{},{percent:T,cornerRadius:o,name:O,tooltipPayload:H,midAngle:F,middleRadius:M,tooltipPosition:V},P),k),{},{value:S,startAngle:A,endAngle:C,payload:P,paddingAngle:_r(m)*v}),j})}return w}function IV(e){var{showLabels:t,sectors:r,children:n}=e,a=_.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return _.createElement(yH,{value:t?a:void 0},n)}function RV(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:s,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:f}=t,h=oc(t,"recharts-pie-"),m=r.current,[p,v]=_.useState(!1),g=_.useCallback(()=>{typeof f=="function"&&f(),v(!1)},[f]),x=_.useCallback(()=>{typeof u=="function"&&u(),v(!0)},[u]);return _.createElement(IV,{showLabels:!p,sectors:n},_.createElement(ic,{animationId:h,begin:s,duration:o,isActive:a,easing:l,onAnimationStart:x,onAnimationEnd:g,key:h},b=>{var y=[],w=n&&n[0],j=w?.startAngle;return n?.forEach((N,E)=>{var S=m&&m[E],O=E>0?xi(N,"paddingAngle",0):0;if(S){var k=Bt(S.endAngle-S.startAngle,N.endAngle-N.startAngle,b),T=Dt(Dt({},N),{},{startAngle:j+O,endAngle:j+k+O});y.push(T),j=T.endAngle}else{var{endAngle:A,startAngle:P}=N,C=Bt(0,A-P,b),F=Dt(Dt({},N),{},{startAngle:j+O,endAngle:j+C+O});y.push(F),j=F.endAngle}}),r.current=y,_.createElement(fr,null,_.createElement(PV,{sectors:y,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),_.createElement(CV,{showLabels:!p,sectors:n,props:t}),t.children)}var FV={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ls.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function LV(e){var{id:t}=e,r=A1(e,pV),{hide:n,className:a,rootTabIndex:s}=e,o=_.useMemo(()=>Hg(e.children,af),[e.children]),l=We(u=>FH(u,t,o)),c=_.useRef(null),d=lt("recharts-pie",a);return n||l==null?(c.current=null,_.createElement(fr,{tabIndex:s,className:d})):_.createElement(_.Fragment,null,_.createElement(S1,{fn:jV,args:Dt(Dt({},e),{},{sectors:l})}),_.createElement(fr,{tabIndex:s,className:d},_.createElement(RV,{props:Dt(Dt({},r),{},{sectors:l}),previousSectorsRef:c})))}function dC(e){var t=Fr(e,FV),{id:r}=t,n=A1(t,vV),a=Na(n);return _.createElement(T1,{id:r,type:"pie"},s=>_.createElement(_.Fragment,null,_.createElement(hV,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),_.createElement(wV,Cs({},n,{id:s})),_.createElement(LV,Cs({},n,{id:s}))))}dC.displayName="Pie";function zj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zj(Object(r),!0).forEach(function(n){MV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MV(e,t,r){return(t=BV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BV(e){var t=$V(e,"string");return typeof t=="symbol"?t:t+""}function $V(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zV={xAxis:{},yAxis:{},zAxis:{}},fC=Mn({name:"cartesianAxis",initialState:zV,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=Uj(Uj({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:UV,removeXAxis:qV,addYAxis:WV,removeYAxis:HV,addZAxis:che,removeZAxis:uhe,updateYAxisWidth:VV}=fC.actions,GV=fC.reducer,KV=pe([yr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),YV=pe([KV,ls,cs],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),k1=()=>We(YV),XV=()=>We(Eq);function qj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qj(Object(r),!0).forEach(function(n){ZV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZV(e,t,r){return(t=JV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JV(e){var t=QV(e,"string");return typeof t=="symbol"?t:t+""}function QV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eG=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:s}=e;if(a===!1||t.x==null||t.y==null)return null;var o=Wj(Wj({index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Zt(a,!1)),Wg(a)),l;return _.isValidElement(a)?l=_.cloneElement(a,o):typeof a=="function"?l=a(o):l=_.createElement(tC,o),_.createElement(fr,{className:"recharts-active-dot"},l)};function Hj(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,s=We(Os),o=XV();if(t==null||o==null)return null;var l=t.find(c=>o.includes(c.payload));return Ut(l)?null:eG({point:l,childIndex:Number(s),mainColor:r,dataKey:a,activeDot:n})}var tG="Invariant failed";function rG(e,t){throw new Error(tG)}var nG=["x","y"];function og(){return og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},og.apply(null,arguments)}function Vj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vj(Object(r),!0).forEach(function(n){aG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aG(e,t,r){return(t=sG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sG(e){var t=iG(e,"string");return typeof t=="symbol"?t:t+""}function iG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oG(e,t){if(e==null)return{};var r,n,a=lG(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cG(e,t){var{x:r,y:n}=e,a=oG(e,nG),s="".concat(r),o=parseInt(s,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),h=parseInt(f,10);return Xo(Xo(Xo(Xo(Xo({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function O1(e){return _.createElement(iC,og({shapeType:"rectangle",propTransformer:cG,activeClassName:"recharts-active-bar"},e))}var uG=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(qe(t))return t;var s=qe(n)||Ut(n);return s?t(n,a):(s||rG(),r)}},dG={},hC=Mn({name:"errorBars",initialState:dG,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:dhe,replaceErrorBar:fhe,removeErrorBar:hhe}=hC.actions,fG=hC.reducer,hG=["children"];function mG(e,t){if(e==null)return{};var r,n,a=pG(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vG={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},gG=_.createContext(vG);function xG(e){var{children:t}=e,r=mG(e,hG);return _.createElement(gG.Provider,{value:r},t)}function C1(e,t){var r,n,a=We(d=>ds(d,e)),s=We(d=>fs(d,t)),o=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:jn.allowDataOverflow,l=(n=s?.allowDataOverflow)!==null&&n!==void 0?n:Nn.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function mC(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=k1(),{needClipX:s,needClipY:o,needClip:l}=C1(t,r);if(!l)return null;var{x:c,y:d,width:u,height:f}=a;return _.createElement("clipPath",{id:"clipPath-".concat(n)},_.createElement("rect",{x:s?c:c-u/2,y:o?d:d-f/2,width:s?u:u*2,height:o?f:f*2}))}var yG=["onMouseEnter","onMouseLeave","onClick"],bG=["value","background","tooltipPosition"],wG=["id"],jG=["onMouseEnter","onClick","onMouseLeave"];function Ps(){return Ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ps.apply(null,arguments)}function Gj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gj(Object(r),!0).forEach(function(n){NG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NG(e,t,r){return(t=EG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EG(e){var t=_G(e,"string");return typeof t=="symbol"?t:t+""}function _G(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yu(e,t){if(e==null)return{};var r,n,a=SG(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function SG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var TG=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:No(r,t),payload:e}]};function AG(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:No(s,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function kG(e){var t=We(Os),{data:r,dataKey:n,background:a,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,d=Yu(s,yG),u=N1(o,n),f=E1(l),h=_1(c,n);if(!a||r==null)return null;var m=Zt(a,!1);return _.createElement(_.Fragment,null,r.map((p,v)=>{var{value:g,background:x,tooltipPosition:b}=p,y=Yu(p,bG);if(!x)return null;var w=u(p,v),j=f(p,v),N=h(p,v),E=rn(rn(rn(rn(rn({option:a,isActive:String(v)===t},y),{},{fill:"#eee"},x),m),rc(d,p,v)),{},{onMouseEnter:w,onMouseLeave:j,onClick:N,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return _.createElement(O1,Ps({key:"background-bar-".concat(E.index)},E))}))}function OG(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(s=>{var o={x:s.x,y:s.y,width:s.width,height:s.height};return rn(rn({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return _.createElement(QO,{value:t?a:void 0},r)}function CG(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=e,l=We(Os),c=We(DO),d=r&&String(s)===l&&(c==null||o===c),u=d?r:t;return _.createElement(O1,Ps({},n,a,{isActive:d,option:u,index:s,dataKey:o}))}function PG(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:s}=e;return _.createElement(O1,Ps({},r,n,{isActive:!1,option:t,index:a,dataKey:s}))}function DG(e){var{data:t,props:r}=e,n=Na(r),{id:a}=n,s=Yu(n,wG),{shape:o,dataKey:l,activeBar:c}=r,{onMouseEnter:d,onClick:u,onMouseLeave:f}=r,h=Yu(r,jG),m=N1(d,l),p=E1(f),v=_1(u,l);return t?_.createElement(_.Fragment,null,t.map((g,x)=>_.createElement(fr,Ps({className:"recharts-bar-rectangle"},rc(h,g,x),{onMouseEnter:m(g,x),onMouseLeave:p(g,x),onClick:v(g,x),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(x)}),c?_.createElement(CG,{shape:o,activeBar:c,baseProps:s,entry:g,index:x,dataKey:l}):_.createElement(PG,{shape:o,baseProps:s,entry:g,index:x,dataKey:l})))):null}function IG(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,f=r.current,h=oc(t,"recharts-bar-"),[m,p]=_.useState(!1),v=!m,g=_.useCallback(()=>{typeof d=="function"&&d(),p(!1)},[d]),x=_.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return _.createElement(OG,{showLabels:v,rects:n},_.createElement(ic,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:g,onAnimationStart:x,key:h},b=>{var y=b===1?n:n?.map((w,j)=>{var N=f&&f[j];if(N)return rn(rn({},w),{},{x:Bt(N.x,w.x,b),y:Bt(N.y,w.y,b),width:Bt(N.width,w.width,b),height:Bt(N.height,w.height,b)});if(a==="horizontal"){var E=Bt(0,w.height,b);return rn(rn({},w),{},{y:w.y+w.height-E,height:E})}var S=Bt(0,w.width,b);return rn(rn({},w),{},{width:S})});return b>0&&(r.current=y??null),y==null?null:_.createElement(fr,null,_.createElement(DG,{props:t,data:y}))}),_.createElement(x1,{label:t.label}),t.children)}function RG(e){var t=_.useRef(null);return _.createElement(IG,{previousRectanglesRef:t,props:e})}var pC=0,FG=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Tt(e,t)}};class LG extends _.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=lt("recharts-bar",a),f=d;return _.createElement(fr,{className:u,id:d},l&&_.createElement("defs",null,_.createElement(mC,{clipPathId:f,xAxisId:s,yAxisId:o})),_.createElement(fr,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},_.createElement(kG,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),_.createElement(RG,this.props)))}}var MG={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ls.isSsr,legendType:"rect",minPointSize:pC,xAxisId:0,yAxisId:0};function BG(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:f}=C1(t,r),h=Bd(),m=wn(),p=Hg(e.children,af),v=We(b=>hK(b,t,r,m,e.id,p));if(h!=="vertical"&&h!=="horizontal")return null;var g,x=v?.[0];return x==null||x.height==null||x.width==null?g=0:g=h==="vertical"?x.height/2:x.width/2,_.createElement(xG,{xAxisId:t,yAxisId:r,data:v,dataPointFormatter:FG,errorBarOffset:g},_.createElement(LG,Ps({},e,{layout:h,needClip:f,data:v,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function $G(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:f,offset:h,cells:m,parentViewBox:p}=e,v=t==="horizontal"?l:o,g=u?v.scale.domain():null,x=QM({numericAxis:v});return f.map((b,y)=>{var w,j,N,E,S,O;u?w=KM(u[y],g):(w=Tt(b,r),Array.isArray(w)||(w=[x,w]));var k=uG(n,pC)(w[1],y);if(t==="horizontal"){var T,[A,P]=[l.scale(w[0]),l.scale(w[1])];j=Cw({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:b,index:y}),N=(T=P??A)!==null&&T!==void 0?T:void 0,E=a.size;var C=A-P;if(S=xn(C)?0:C,O={x:j,y:h.top,width:E,height:h.height},Math.abs(k)>0&&Math.abs(S)<Math.abs(k)){var F=_r(S||k)*(Math.abs(k)-Math.abs(S));N-=F,S+=F}}else{var[M,H]=[o.scale(w[0]),o.scale(w[1])];if(j=M,N=Cw({axis:l,ticks:d,bandSize:s,offset:a.offset,entry:b,index:y}),E=H-M,S=a.size,O={x:h.left,y:N,width:h.width,height:S},Math.abs(k)>0&&Math.abs(E)<Math.abs(k)){var V=_r(E||k)*(Math.abs(k)-Math.abs(E));E+=V}}if(j==null||N==null||E==null||S==null)return null;var B=rn(rn({},b),{},{x:j,y:N,width:E,height:S,value:u?w:w[1],payload:b,background:O,tooltipPosition:{x:j+E/2,y:N+S/2},parentViewBox:p},m&&m[y]&&m[y].props);return B}).filter(Boolean)}function zG(e){var t=Fr(e,MG),r=wn();return _.createElement(T1,{id:t.id,type:"bar"},n=>_.createElement(_.Fragment,null,_.createElement(lC,{legendPayload:TG(t)}),_.createElement(S1,{fn:AG,args:t}),_.createElement(uC,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:yA(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),_.createElement(BG,Ps({},t,{id:n}))))}var lg=_.memo(zG);lg.displayName="Bar";function Kj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kj(Object(r),!0).forEach(function(n){UG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UG(e,t,r){return(t=qG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qG(e){var t=WG(e,"string");return typeof t=="symbol"?t:t+""}function WG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HG=(e,t)=>t,VG=(e,t,r)=>r,GG=(e,t,r,n)=>n,KG=(e,t,r,n,a)=>a,yc=pe([Jd,KG],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),YG=pe([yc],e=>e?.maxBarSize),XG=(e,t,r,n,a,s)=>s,Yj=(e,t,r)=>{var n=r??e;if(!Ut(n))return Gr(n,t,0)},ZG=pe([ut,Jd,HG,VG,GG],(e,t,r,n,a)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),JG=(e,t,r,n)=>{var a=ut(e);return a==="horizontal"?Cl(e,"yAxis",r,n):Cl(e,"xAxis",t,n)},QG=(e,t,r)=>{var n=ut(e);return n==="horizontal"?K2(e,"xAxis",t):K2(e,"yAxis",r)},eK=(e,t,r)=>{var n={},a=e.filter(Zd),s=e.filter(d=>d.stackId==null),o=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),n),l=Object.entries(o).map(d=>{var[u,f]=d,h=f.map(p=>p.dataKey),m=Yj(t,r,f[0].barSize);return{stackId:u,dataKeys:h,barSize:m}}),c=s.map(d=>{var u=[d.dataKey].filter(h=>h!=null),f=Yj(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...c]},tK=pe([ZG,Dz,QG],eK),rK=(e,t,r,n,a)=>{var s,o,l=yc(e,t,r,n,a);if(l!=null){var c=ut(e),d=Ck(e),{maxBarSize:u}=l,f=Ut(u)?d:u,h,m;return c==="horizontal"?(h=ks(e,"xAxis",t,n),m=As(e,"xAxis",t,n)):(h=ks(e,"yAxis",r,n),m=As(e,"yAxis",r,n)),(s=(o=El(h,m,!0))!==null&&o!==void 0?o:f)!==null&&s!==void 0?s:0}},vC=(e,t,r,n)=>{var a=ut(e),s,o;return a==="horizontal"?(s=ks(e,"xAxis",t,n),o=As(e,"xAxis",t,n)):(s=ks(e,"yAxis",r,n),o=As(e,"yAxis",r,n)),El(s,o)};function nK(e,t,r,n,a){var s=n.length;if(!(s<1)){var o=Gr(e,r,0,!0),l,c=[];if(Rr(n[0].barSize)){var d=!1,u=r/s,f=n.reduce((x,b)=>x+(b.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&u>0&&(d=!0,u*=.9,f=s*u);var h=(r-f)/2>>0,m={offset:h-o,size:0};l=n.reduce((x,b)=>{var y,w={stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:m.offset+m.size+o,size:d?u:(y=b.barSize)!==null&&y!==void 0?y:0}},j=[...x,w];return m=j[j.length-1].position,j},c)}else{var p=Gr(t,r,0,!0);r-2*p-(s-1)*o<=0&&(o=0);var v=(r-2*p-(s-1)*o)/s;v>1&&(v>>=0);var g=Rr(a)?Math.min(v,a):v;l=n.reduce((x,b,y)=>[...x,{stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:p+(v+o)*y+(v-g)/2,size:g}}],c)}return l}}var aK=(e,t,r,n,a,s,o)=>{var l=Ut(o)?t:o,c=nK(r,n,a!==s?a:s,e,l);return a!==s&&c!=null&&(c=c.map(d=>Yc(Yc({},d),{},{position:Yc(Yc({},d.position),{},{offset:d.position.offset-a/2})}))),c},sK=pe([tK,Ck,Pz,Pk,rK,vC,YG],aK),iK=(e,t,r,n)=>ks(e,"xAxis",t,n),oK=(e,t,r,n)=>ks(e,"yAxis",r,n),lK=(e,t,r,n)=>As(e,"xAxis",t,n),cK=(e,t,r,n)=>As(e,"yAxis",r,n),uK=pe([sK,yc],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),dK=(e,t)=>{var r=Xd(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}},fK=pe([JG,yc],dK),hK=pe([yr,ox,iK,oK,lK,cK,uK,ut,Vd,vC,fK,yc,XG],(e,t,r,n,a,s,o,l,c,d,u,f,h)=>{var{chartData:m,dataStartIndex:p,dataEndIndex:v}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||d==null)){var{data:g}=f,x;if(g!=null&&g.length>0?x=g:x=m?.slice(p,v+1),x!=null)return $G({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:u,displayedData:x,offset:e,cells:h})}}),gC=e=>{var{chartData:t}=e,r=Wt(),n=wn();return _.useEffect(()=>n?()=>{}:(r(aj(t)),()=>{r(aj(void 0))}),[t,r,n]),null},Xj={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},xC=Mn({name:"brush",initialState:Xj,reducers:{setBrushSettings(e,t){return t.payload==null?Xj:t.payload}}}),{setBrushSettings:mhe}=xC.actions,mK=xC.reducer;function pK(e,t,r){return(t=vK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vK(e){var t=gK(e,"string");return typeof t=="symbol"?t:t+""}function gK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class P1{static create(t){return new P1(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}pK(P1,"EPS",1e-4);function xK(e){return(e%180+180)%180}var yK=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=xK(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},bK={dots:[],areas:[],lines:[]},yC=Mn({name:"referenceElements",initialState:bK,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Va(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Va(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Va(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:phe,removeDot:vhe,addArea:ghe,removeArea:xhe,addLine:yhe,removeLine:bhe}=yC.actions,wK=yC.reducer,jK=_.createContext(void 0),NK=e=>{var{children:t}=e,[r]=_.useState("".concat(wl("recharts"),"-clip")),n=k1();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return _.createElement(jK.Provider,{value:r},_.createElement("defs",null,_.createElement("clipPath",{id:r},_.createElement("rect",{x:a,y:s,height:l,width:o}))),t)};function mo(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function bC(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function EK(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return yK(n,r)}function _K(e,t,r){var n=r==="width",{x:a,y:s,width:o,height:l}=e;return t===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function Xu(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-a)<=0}function SK(e,t){return bC(e,t+1)}function TK(e,t,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,f=function(){var p=n?.[c];if(p===void 0)return{v:bC(n,d)};var v=c,g,x=()=>(g===void 0&&(g=r(p,v)),g),b=p.coordinate,y=c===0||Xu(e,b,x,u,l);y||(c=0,u=o,d+=1),y&&(u=b+e*(x()/2+a),c+=d)},h;d<=s.length;)if(h=f(),h)return h.v;return[]}function Zj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zj(Object(r),!0).forEach(function(n){AK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AK(e,t,r){return(t=kK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kK(e){var t=OK(e,"string");return typeof t=="symbol"?t:t+""}function OK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CK(e,t,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,d=function(h){var m=s[h],p,v=()=>(p===void 0&&(p=r(m,h)),p);if(h===o-1){var g=e*(m.coordinate+e*v()/2-c);s[h]=m=Br(Br({},m),{},{tickCoord:g>0?m.coordinate-g*e:m.coordinate})}else s[h]=m=Br(Br({},m),{},{tickCoord:m.coordinate});var x=Xu(e,m.tickCoord,v,l,c);x&&(c=m.tickCoord-e*(v()/2+a),s[h]=Br(Br({},m),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return s}function PK(e,t,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:d}=t;if(s){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);o[l-1]=u=Br(Br({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=Xu(e,u.tickCoord,()=>f,c,d);m&&(d=u.tickCoord-e*(f/2+a),o[l-1]=Br(Br({},u),{},{isShow:!0}))}for(var p=s?l-1:l,v=function(b){var y=o[b],w,j=()=>(w===void 0&&(w=r(y,b)),w);if(b===0){var N=e*(y.coordinate-e*j()/2-c);o[b]=y=Br(Br({},y),{},{tickCoord:N<0?y.coordinate-N*e:y.coordinate})}else o[b]=y=Br(Br({},y),{},{tickCoord:y.coordinate});var E=Xu(e,y.tickCoord,j,c,d);E&&(c=y.tickCoord+e*(j()/2+a),o[b]=Br(Br({},y),{},{isShow:!0}))},g=0;g<p;g++)v(g);return o}function D1(e,t,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:f}=e;if(!a||!a.length||!n)return[];if(qe(c)||Ls.isSsr){var h;return(h=SK(a,qe(c)?c:0))!==null&&h!==void 0?h:[]}var m=[],p=l==="top"||l==="bottom"?"width":"height",v=u&&p==="width"?ol(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(y,w)=>{var j=typeof d=="function"?d(y.value,w):y.value;return p==="width"?EK(ol(j,{fontSize:t,letterSpacing:r}),v,f):ol(j,{fontSize:t,letterSpacing:r})[p]},x=a.length>=2?_r(a[1].coordinate-a[0].coordinate):1,b=_K(s,x,p);return c==="equidistantPreserveStart"?TK(x,b,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?m=PK(x,b,g,a,o,c==="preserveStartEnd"):m=CK(x,b,g,a,o),m.filter(y=>y.isShow))}var DK=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=e,o=0;if(t){t.forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,d=o+c+l+(r?n:0);return Math.round(d)}return 0},IK=["axisLine","width","height","className","hide","ticks"],RK=["viewBox"],FK=["viewBox"];function cg(e,t){if(e==null)return{};var r,n,a=LK(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function LK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ji(){return ji=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ji.apply(null,arguments)}function Jj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jj(Object(r),!0).forEach(function(n){MK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MK(e,t,r){return(t=BK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BK(e){var t=$K(e,"string");return typeof t=="symbol"?t:t+""}function $K(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I1={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function zK(e){var{x:t,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=mr(mr(mr({},c),Zt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);d=mr(mr({},d),{},{x1:t,y1:r+u*a,x2:t+n,y2:r+u*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);d=mr(mr({},d),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return _.createElement("line",ji({},d,{className:lt("recharts-cartesian-axis-line",xi(l,"className"))}))}function UK(e,t,r,n,a,s,o,l,c){var d,u,f,h,m,p,v=l?-1:1,g=e.tickSize||o,x=qe(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":d=u=e.coordinate,h=r+ +!l*a,f=h-v*g,p=f-v*c,m=x;break;case"left":f=h=e.coordinate,u=t+ +!l*n,d=u-v*g,m=d-v*c,p=x;break;case"right":f=h=e.coordinate,u=t+ +l*n,d=u+v*g,m=d+v*c,p=x;break;default:d=u=e.coordinate,h=r+ +l*a,f=h+v*g,p=f+v*c,m=x;break}return{line:{x1:d,y1:f,x2:u,y2:h},tick:{x:m,y:p}}}function qK(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function WK(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function HK(e){var{option:t,tickProps:r,value:n}=e,a,s=lt(r.className,"recharts-cartesian-axis-tick-value");if(_.isValidElement(t))a=_.cloneElement(t,mr(mr({},r),{},{className:s}));else if(typeof t=="function")a=t(mr(mr({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=lt(o,t?.className)),a=_.createElement(sf,ji({},r,{className:o}),n)}return a}function VK(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:s,unit:o,padding:l,tickTextProps:c,orientation:d,mirror:u,x:f,y:h,width:m,height:p,tickSize:v,tickMargin:g,fontSize:x,letterSpacing:b,getTicksConfig:y,events:w}=e,j=D1(mr(mr({},y),{},{ticks:t}),x,b),N=qK(d,u),E=WK(d,u),S=Na(y),O=Zt(r,!1),k=mr(mr({},S),{},{fill:"none"},Zt(n,!1)),T=j.map((A,P)=>{var{line:C,tick:F}=UK(A,f,h,m,p,d,v,u,g),M=mr(mr(mr(mr({textAnchor:N,verticalAnchor:E},S),{},{stroke:"none",fill:a},O),F),{},{index:P,payload:A,visibleTicksCount:j.length,tickFormatter:s,padding:l},c);return _.createElement(fr,ji({className:"recharts-cartesian-axis-tick",key:"tick-".concat(A.value,"-").concat(A.coordinate,"-").concat(A.tickCoord)},rc(w,A,P)),n&&_.createElement("line",ji({},k,C,{className:lt("recharts-cartesian-axis-tick-line",xi(n,"className"))})),r&&_.createElement(HK,{option:r,tickProps:M,value:"".concat(typeof s=="function"?s(A.value,P):A.value).concat(o||"")}))});return T.length>0?_.createElement("g",{className:"recharts-cartesian-axis-ticks"},T):null}var GK=_.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l}=e,c=cg(e,IK),[d,u]=_.useState(""),[f,h]=_.useState(""),m=_.useRef([]);_.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return DK({ticks:m.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=_.useCallback(v=>{if(v){var g=v.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=Array.from(g);var x=g[0];if(x){var b=window.getComputedStyle(x),y=b.fontSize,w=b.letterSpacing;(y!==d||w!==f)&&(u(y),h(w))}}},[d,f]);return o||n!=null&&n<=0||a!=null&&a<=0?null:_.createElement(fr,{className:lt("recharts-cartesian-axis",s),ref:p},_.createElement(zK,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Na(e)}),_.createElement(VK,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:f,getTicksConfig:e,events:c}),_.createElement(JW,{x:e.x,y:e.y,width:e.width,height:e.height},_.createElement(lH,{label:e.label}),e.children))}),KK=_.memo(GK,(e,t)=>{var{viewBox:r}=e,n=cg(e,RK),{viewBox:a}=t,s=cg(t,FK);return mo(r,a)&&mo(n,s)}),R1=_.forwardRef((e,t)=>{var r=Fr(e,I1);return _.createElement(KK,ji({},r,{ref:t}))});R1.displayName="CartesianAxis";var YK=["x1","y1","x2","y2","key"],XK=["offset"],ZK=["xAxisId","yAxisId"],JK=["xAxisId","yAxisId"];function Qj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qj(Object(r),!0).forEach(function(n){QK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QK(e,t,r){return(t=eY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eY(e){var t=tY(e,"string");return typeof t=="symbol"?t:t+""}function tY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ri(){return ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ri.apply(null,arguments)}function Zu(e,t){if(e==null)return{};var r,n,a=rY(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var nY=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:s,height:o,ry:l}=e;return _.createElement("rect",{x:n,y:a,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function wC(e,t){var r;if(_.isValidElement(e))r=_.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:s,y2:o,key:l}=t,c=Zu(t,YK),d=Na(c),{offset:u}=d,f=Zu(d,XK);r=_.createElement("line",ri({},f,{x1:n,y1:a,x2:s,y2:o,fill:"none",key:l}))}return r}function aY(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Zu(e,ZK),c=a.map((d,u)=>{var f=qr(qr({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return wC(n,f)});return _.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function sY(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Zu(e,JK),c=a.map((d,u)=>{var f=qr(qr({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return wC(n,f)});return _.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function iY(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==d[0]&&d.unshift(0);var u=d.map((f,h)=>{var m=!d[h+1],p=m?a+o-f:d[h+1]-f;if(p<=0)return null;var v=h%t.length;return _.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:p,width:s,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return _.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function oY(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==d[0]&&d.unshift(0);var u=d.map((f,h)=>{var m=!d[h+1],p=m?a+o-f:d[h+1]-f;if(p<=0)return null;var v=h%r.length;return _.createElement("rect",{key:"react-".concat(h),x:f,y:s,width:p,height:l,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return _.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var lY=(e,t)=>{var{xAxis:r,width:n,height:a,offset:s}=e;return gA(D1(qr(qr(qr({},I1),r),{},{ticks:xA(r),viewBox:{x:0,y:0,width:n,height:a}})),s.left,s.left+s.width,t)},cY=(e,t)=>{var{yAxis:r,width:n,height:a,offset:s}=e;return gA(D1(qr(qr(qr({},I1),r),{},{ticks:xA(r),viewBox:{x:0,y:0,width:n,height:a}})),s.top,s.top+s.height,t)},uY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function ug(e){var t=cx(),r=ux(),n=NA(),a=qr(qr({},Fr(e,uY)),{},{x:qe(e.x)?e.x:n.left,y:qe(e.y)?e.y:n.top,width:qe(e.width)?e.width:n.width,height:qe(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:f,horizontalValues:h,verticalValues:m}=a,p=wn(),v=We(O=>Y2(O,"xAxis",s,p)),g=We(O=>Y2(O,"yAxis",o,p));if(!qe(d)||d<=0||!qe(u)||u<=0||!qe(l)||l!==+l||!qe(c)||c!==+c)return null;var x=a.verticalCoordinatesGenerator||lY,b=a.horizontalCoordinatesGenerator||cY,{horizontalPoints:y,verticalPoints:w}=a;if((!y||!y.length)&&typeof b=="function"){var j=h&&h.length,N=b({yAxis:g?qr(qr({},g),{},{ticks:j?h:g.ticks}):void 0,width:t,height:r,offset:n},j?!0:f);il(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(y=N)}if((!w||!w.length)&&typeof x=="function"){var E=m&&m.length,S=x({xAxis:v?qr(qr({},v),{},{ticks:E?m:v.ticks}):void 0,width:t,height:r,offset:n},E?!0:f);il(Array.isArray(S),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(w=S)}return _.createElement("g",{className:"recharts-cartesian-grid"},_.createElement(nY,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),_.createElement(iY,ri({},a,{horizontalPoints:y})),_.createElement(oY,ri({},a,{verticalPoints:w})),_.createElement(aY,ri({},a,{offset:n,horizontalPoints:y,xAxis:v,yAxis:g})),_.createElement(sY,ri({},a,{offset:n,verticalPoints:w,xAxis:v,yAxis:g})))}ug.displayName="CartesianGrid";var jC=(e,t,r,n)=>ks(e,"xAxis",t,n),NC=(e,t,r,n)=>As(e,"xAxis",t,n),EC=(e,t,r,n)=>ks(e,"yAxis",r,n),_C=(e,t,r,n)=>As(e,"yAxis",r,n),dY=pe([ut,jC,EC,NC,_C],(e,t,r,n,a)=>os(e,"xAxis")?El(t,n,!1):El(r,a,!1)),fY=(e,t,r,n,a)=>a,SC=pe([Jd,fY],(e,t)=>e.filter(r=>r.type==="area").find(r=>r.id===t)),hY=(e,t,r,n,a)=>{var s,o=SC(e,t,r,n,a);if(o!=null){var l=ut(e),c=os(l,"xAxis"),d;if(c?d=Cl(e,"yAxis",r,n):d=Cl(e,"xAxis",t,n),d!=null){var{stackId:u}=o,f=Xd(o);if(!(u==null||f==null)){var h=(s=d[u])===null||s===void 0?void 0:s.stackedData;return h?.find(m=>m.key===f)}}}},mY=pe([ut,jC,EC,NC,_C,hY,Vd,dY,SC],(e,t,r,n,a,s,o,l,c)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:f}=o;if(!(c==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||a==null||n.length===0||a.length===0||l==null)){var{data:h}=c,m;if(h&&h.length>0?m=h:m=d?.slice(u,f+1),m!=null){var p=void 0;return RY({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataStartIndex:u,areaSettings:c,stackedData:s,displayedData:m,chartBaseValue:p,bandSize:l})}}}),pY=["id"],vY=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function TC(e,t){if(e==null)return{};var r,n,a=gY(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function eN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eN(Object(r),!0).forEach(function(n){xY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xY(e,t,r){return(t=yY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=bY(e,"string");return typeof t=="symbol"?t:t+""}function bY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ka(){return Ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ka.apply(null,arguments)}function Ju(e,t){return e&&e!=="none"?e:t}var wY=e=>{var{dataKey:t,name:r,stroke:n,fill:a,legendType:s,hide:o}=e;return[{inactive:o,dataKey:t,type:s,color:Ju(n,a),value:No(r,t),payload:e}]};function jY(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:s,name:o,hide:l,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:s,dataKey:t,nameKey:void 0,name:No(o,t),hide:l,type:e.tooltipType,color:Ju(n,s),unit:c}}}var NY=(e,t)=>{var r;if(_.isValidElement(e))r=_.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=lt("recharts-area-dot",typeof e!="boolean"?e.className:"");r=_.createElement(tC,Ka({},t,{className:n}))}return r};function EY(e,t){return e==null?!1:t?!0:e.length===1}function _Y(e){var{clipPathId:t,points:r,props:n}=e,{needClip:a,dot:s,dataKey:o}=n;if(!EY(r,s))return null;var l=fT(s),c=Na(n),d=Zt(s,!0),u=r.map((h,m)=>{var p=Wa(Wa(Wa({key:"dot-".concat(m),r:3},c),d),{},{index:m,cx:h.x,cy:h.y,dataKey:o,value:h.value,payload:h.payload,points:r});return NY(s,p)}),f={clipPath:a?"url(#clipPath-".concat(l?"":"dots-").concat(t,")"):void 0};return _.createElement(fr,Ka({className:"recharts-area-dots"},f),u)}function SY(e){var{showLabels:t,children:r,points:n}=e,a=n.map(s=>{var o={x:s.x,y:s.y,width:0,height:0};return Wa(Wa({},o),{},{value:s.value,payload:s.payload,parentViewBox:void 0,viewBox:o,fill:void 0})});return _.createElement(QO,{value:t?a:null},r)}function tN(e){var{points:t,baseLine:r,needClip:n,clipPathId:a,props:s}=e,{layout:o,type:l,stroke:c,connectNulls:d,isRange:u}=s,{id:f}=s,h=TC(s,pY),m=Na(h);return _.createElement(_.Fragment,null,t?.length>1&&_.createElement(fr,{clipPath:n?"url(#clipPath-".concat(a,")"):void 0},_.createElement(sl,Ka({},m,{id:f,points:t,connectNulls:d,type:l,baseLine:r,layout:o,stroke:"none",className:"recharts-area-area"})),c!=="none"&&_.createElement(sl,Ka({},m,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:t})),c!=="none"&&u&&_.createElement(sl,Ka({},m,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:r}))),_.createElement(_Y,{points:t,props:h,clipPathId:a}))}function TY(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,s=n[0].y,o=n[n.length-1].y;if(!Rr(s)||!Rr(o))return null;var l=t*Math.abs(s-o),c=Math.max(...n.map(d=>d.x||0));return qe(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(d=>d.x||0),c)),qe(c)?_.createElement("rect",{x:0,y:s<o?s:s-l,width:c+(a?parseInt("".concat(a),10):1),height:Math.floor(l)}):null}function AY(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,s=n[0].x,o=n[n.length-1].x;if(!Rr(s)||!Rr(o))return null;var l=t*Math.abs(s-o),c=Math.max(...n.map(d=>d.y||0));return qe(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(d=>d.y||0),c)),qe(c)?_.createElement("rect",{x:s<o?s:s-l,y:0,width:l,height:Math.floor(c+(a?parseInt("".concat(a),10):1))}):null}function kY(e){var{alpha:t,layout:r,points:n,baseLine:a,strokeWidth:s}=e;return r==="vertical"?_.createElement(TY,{alpha:t,points:n,baseLine:a,strokeWidth:s}):_.createElement(AY,{alpha:t,points:n,baseLine:a,strokeWidth:s})}function OY(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:a,previousBaselineRef:s}=e,{points:o,baseLine:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:f,onAnimationStart:h,onAnimationEnd:m}=n,p=oc(n,"recharts-area-"),[v,g]=_.useState(!1),x=!v,b=_.useCallback(()=>{typeof m=="function"&&m(),g(!1)},[m]),y=_.useCallback(()=>{typeof h=="function"&&h(),g(!0)},[h]),w=a.current,j=s.current;return _.createElement(SY,{showLabels:x,points:o},n.children,_.createElement(ic,{animationId:p,begin:d,duration:u,isActive:c,easing:f,onAnimationEnd:b,onAnimationStart:y,key:p},N=>{if(w){var E=w.length/o.length,S=N===1?o:o.map((k,T)=>{var A=Math.floor(T*E);if(w[A]){var P=w[A];return Wa(Wa({},k),{},{x:Bt(P.x,k.x,N),y:Bt(P.y,k.y,N)})}return k}),O;return qe(l)?O=Bt(j,l,N):Ut(l)||xn(l)?O=Bt(j,0,N):O=l.map((k,T)=>{var A=Math.floor(T*E);if(Array.isArray(j)&&j[A]){var P=j[A];return Wa(Wa({},k),{},{x:Bt(P.x,k.x,N),y:Bt(P.y,k.y,N)})}return k}),N>0&&(a.current=S,s.current=O),_.createElement(tN,{points:S,baseLine:O,needClip:t,clipPathId:r,props:n})}return N>0&&(a.current=o,s.current=l),_.createElement(fr,null,c&&_.createElement("defs",null,_.createElement("clipPath",{id:"animationClipPath-".concat(r)},_.createElement(kY,{alpha:N,points:o,baseLine:l,layout:n.layout,strokeWidth:n.strokeWidth}))),_.createElement(fr,{clipPath:"url(#animationClipPath-".concat(r,")")},_.createElement(tN,{points:o,baseLine:l,needClip:t,clipPathId:r,props:n})))}),_.createElement(x1,{label:n.label}))}function CY(e){var{needClip:t,clipPathId:r,props:n}=e,a=_.useRef(null),s=_.useRef();return _.createElement(OY,{needClip:t,clipPathId:r,props:n,previousPointsRef:a,previousBaselineRef:s})}class PY extends _.PureComponent{render(){var t,{hide:r,dot:n,points:a,className:s,top:o,left:l,needClip:c,xAxisId:d,yAxisId:u,width:f,height:h,id:m,baseLine:p}=this.props;if(r)return null;var v=lt("recharts-area",s),g=m,{r:x=3,strokeWidth:b=2}=(t=Zt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},y=fT(n),w=x*2+b;return _.createElement(_.Fragment,null,_.createElement(fr,{className:v},c&&_.createElement("defs",null,_.createElement(mC,{clipPathId:g,xAxisId:d,yAxisId:u}),!y&&_.createElement("clipPath",{id:"clipPath-dots-".concat(g)},_.createElement("rect",{x:l-w/2,y:o-w/2,width:f+w,height:h+w}))),_.createElement(CY,{needClip:c,clipPathId:g,props:this.props})),_.createElement(Hj,{points:a,mainColor:Ju(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(p)&&_.createElement(Hj,{points:p,mainColor:Ju(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var AC={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Ls.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function DY(e){var t,r=Fr(e,AC),{activeDot:n,animationBegin:a,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,fill:d,fillOpacity:u,hide:f,isAnimationActive:h,legendType:m,stroke:p,xAxisId:v,yAxisId:g}=r,x=TC(r,vY),b=Bd(),y=RO(),{needClip:w}=C1(v,g),j=wn(),{points:N,isRange:E,baseLine:S}=(t=We(C=>mY(C,v,g,j,e.id)))!==null&&t!==void 0?t:{},O=k1();if(b!=="horizontal"&&b!=="vertical"||O==null||y!=="AreaChart"&&y!=="ComposedChart")return null;var{height:k,width:T,x:A,y:P}=O;return!N||!N.length?null:_.createElement(PY,Ka({},x,{activeDot:n,animationBegin:a,animationDuration:s,animationEasing:o,baseLine:S,connectNulls:l,dot:c,fill:d,fillOpacity:u,height:k,hide:f,layout:b,isAnimationActive:h,isRange:E,legendType:m,needClip:w,points:N,stroke:p,width:T,left:A,top:P,xAxisId:v,yAxisId:g}))}var IY=(e,t,r,n,a)=>{var s=r??t;if(qe(s))return s;var o=e==="horizontal"?a:n,l=o.scale.domain();if(o.type==="number"){var c=Math.max(l[0],l[1]),d=Math.min(l[0],l[1]);return s==="dataMin"?d:s==="dataMax"||c<0?c:Math.max(Math.min(l[0],l[1]),0)}return s==="dataMin"?l[0]:s==="dataMax"?l[1]:l[0]};function RY(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:a,layout:s,chartBaseValue:o,xAxis:l,yAxis:c,displayedData:d,dataStartIndex:u,xAxisTicks:f,yAxisTicks:h,bandSize:m}=e,p=a&&a.length,v=IY(s,o,r,l,c),g=s==="horizontal",x=!1,b=d.map((w,j)=>{var N;p?N=a[u+j]:(N=Tt(w,n),Array.isArray(N)?x=!0:N=[v,N]);var E=N[1]==null||p&&!t&&Tt(w,n)==null;return g?{x:Ow({axis:l,ticks:f,bandSize:m,entry:w,index:j}),y:E?null:c.scale(N[1]),value:N,payload:w}:{x:E?null:l.scale(N[1]),y:Ow({axis:c,ticks:h,bandSize:m,entry:w,index:j}),value:N,payload:w}}),y;return p||x?y=b.map(w=>{var j=Array.isArray(w.value)?w.value[0]:null;return g?{x:w.x,y:j!=null&&w.y!=null?c.scale(j):null,payload:w.payload}:{x:j!=null?l.scale(j):null,y:w.y,payload:w.payload}}):y=g?c.scale(v):l.scale(v),{points:b,baseLine:y,isRange:x}}function FY(e){var t=Fr(e,AC),r=wn();return _.createElement(T1,{id:t.id,type:"area"},n=>_.createElement(_.Fragment,null,_.createElement(lC,{legendPayload:wY(t)}),_.createElement(S1,{fn:jY,args:t}),_.createElement(uC,{type:"area",id:n,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:yA(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:r,connectNulls:t.connectNulls}),_.createElement(DY,Ka({},t,{id:n}))))}var dg=_.memo(FY);dg.displayName="Area";var LY=["dangerouslySetInnerHTML","ticks"],MY=["id"],BY=["domain"],$Y=["domain"];function fg(){return fg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fg.apply(null,arguments)}function Qu(e,t){if(e==null)return{};var r,n,a=zY(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function UY(e){var t=Wt();return _.useEffect(()=>(t(UV(e)),()=>{t(qV(e))}),[e,t]),null}var qY=e=>{var{xAxisId:t,className:r}=e,n=We(ox),a=wn(),s="xAxis",o=We(g=>Oo(g,s,t,a)),l=We(g=>mO(g,s,t,a)),c=We(g=>uO(g,t)),d=We(g=>EU(g,t)),u=We(g=>zk(g,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:h}=e,m=Qu(e,LY),{id:p}=u,v=Qu(u,MY);return _.createElement(R1,fg({},m,v,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:lt("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:l}))},WY={allowDataOverflow:jn.allowDataOverflow,allowDecimals:jn.allowDecimals,allowDuplicatedCategory:jn.allowDuplicatedCategory,height:jn.height,hide:!1,mirror:jn.mirror,orientation:jn.orientation,padding:jn.padding,reversed:jn.reversed,scale:jn.scale,tickCount:jn.tickCount,type:jn.type,xAxisId:0},HY=e=>{var t,r,n,a,s,o=Fr(e,WY);return _.createElement(_.Fragment,null,_.createElement(UY,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),_.createElement(qY,o))},VY=(e,t)=>{var{domain:r}=e,n=Qu(e,BY),{domain:a}=t,s=Qu(t,$Y);return mo(n,s)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:mo({domain:r},{domain:a}):!1},hg=_.memo(HY,VY);hg.displayName="XAxis";var GY=["dangerouslySetInnerHTML","ticks"],KY=["id"],YY=["domain"],XY=["domain"];function mg(){return mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mg.apply(null,arguments)}function ed(e,t){if(e==null)return{};var r,n,a=ZY(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function JY(e){var t=Wt();return _.useEffect(()=>(t(WV(e)),()=>{t(HV(e))}),[e,t]),null}var QY=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,s=_.useRef(null),o=_.useRef(null),l=We(ox),c=wn(),d=Wt(),u="yAxis",f=We(j=>Oo(j,u,t,c)),h=We(j=>dO(j,t)),m=We(j=>SU(j,t)),p=We(j=>mO(j,u,t,c)),v=We(j=>Uk(j,t));if(_.useLayoutEffect(()=>{if(!(n!=="auto"||!h||g1(a)||_.isValidElement(a)||v==null)){var j=s.current;if(j){var N=j.getCalculatedWidth();Math.round(h.width)!==Math.round(N)&&d(VV({id:t,width:N}))}}},[p,h,d,a,t,n,v]),h==null||m==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:x}=e,b=ed(e,GY),{id:y}=v,w=ed(v,KY);return _.createElement(R1,mg({},b,w,{ref:s,labelRef:o,scale:f,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:h.width,height:h.height,className:lt("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:p}))},eX={allowDataOverflow:Nn.allowDataOverflow,allowDecimals:Nn.allowDecimals,allowDuplicatedCategory:Nn.allowDuplicatedCategory,hide:!1,mirror:Nn.mirror,orientation:Nn.orientation,padding:Nn.padding,reversed:Nn.reversed,scale:Nn.scale,tickCount:Nn.tickCount,type:Nn.type,width:Nn.width,yAxisId:0},tX=e=>{var t,r,n,a,s,o=Fr(e,eX);return _.createElement(_.Fragment,null,_.createElement(JY,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),_.createElement(QY,o))},rX=(e,t)=>{var{domain:r}=e,n=ed(e,YY),{domain:a}=t,s=ed(t,XY);return mo(n,s)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:mo({domain:r},{domain:a}):!1},pg=_.memo(tX,rX);pg.displayName="YAxis";var u0={exports:{}},d0={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rN;function nX(){if(rN)return d0;rN=1;var e=vd();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,s=e.useEffect,o=e.useMemo,l=e.useDebugValue;return d0.useSyncExternalStoreWithSelector=function(c,d,u,f,h){var m=a(null);if(m.current===null){var p={hasValue:!1,value:null};m.current=p}else p=m.current;m=o(function(){function g(j){if(!x){if(x=!0,b=j,j=f(j),h!==void 0&&p.hasValue){var N=p.value;if(h(N,j))return y=N}return y=j}if(N=y,r(b,j))return N;var E=f(j);return h!==void 0&&h(N,E)?(b=j,N):(b=j,y=E)}var x=!1,b,y,w=u===void 0?null:u;return[function(){return g(d())},w===null?void 0:function(){return g(w())}]},[d,u,f,h]);var v=n(c,m[0],m[1]);return s(function(){p.hasValue=!0,p.value=v},[v]),l(v),v},d0}var nN;function aX(){return nN||(nN=1,u0.exports=nX()),u0.exports}aX();function sX(e){e()}function iX(){let e=null,t=null;return{clear(){e=null,t=null},notify(){sX(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var aN={notify(){},get:()=>[]};function oX(e,t){let r,n=aN,a=0,s=!1;function o(v){u();const g=n.subscribe(v);let x=!1;return()=>{x||(x=!0,g(),f())}}function l(){n.notify()}function c(){p.onStateChange&&p.onStateChange()}function d(){return s}function u(){a++,r||(r=e.subscribe(c),n=iX())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=aN)}function h(){s||(s=!0,u())}function m(){s&&(s=!1,f())}const p={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:h,tryUnsubscribe:m,getListeners:()=>n};return p}var lX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",cX=lX(),uX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",dX=uX(),fX=()=>cX||dX?_.useLayoutEffect:_.useEffect,hX=fX(),mX=Symbol.for("react-redux-context"),pX=typeof globalThis<"u"?globalThis:{};function vX(){if(!_.createContext)return{};const e=pX[mX]??=new Map;let t=e.get(_.createContext);return t||(t=_.createContext(null),e.set(_.createContext,t)),t}var gX=vX();function xX(e){const{children:t,context:r,serverState:n,store:a}=e,s=_.useMemo(()=>{const c=oX(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=_.useMemo(()=>a.getState(),[a]);hX(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||gX;return _.createElement(l.Provider,{value:s},t)}var yX=xX,bX=(e,t)=>t,F1=pe([bX,ut,Mk,wr,kO,hs,Oq,yr],Rq),L1=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},kC=ra("mouseClick"),OC=ac();OC.startListening({actionCreator:kC,effect:(e,t)=>{var r=e.payload,n=F1(t.getState(),L1(r));n?.activeIndex!=null&&t.dispatch(BU({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var vg=ra("mouseMove"),CC=ac();CC.startListening({actionCreator:vg,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=o1(n,n.tooltip.settings.shared),s=F1(n,L1(r));a==="axis"&&(s?.activeIndex!=null?t.dispatch(jO({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(wO()))}});var sN={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},PC=Mn({name:"rootProps",initialState:sN,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:sN.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),wX=PC.reducer,{updateOptions:jX}=PC.actions,DC=Mn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:NX}=DC.actions,EX=DC.reducer,IC=ra("keyDown"),RC=ra("focus"),M1=ac();M1.startListening({actionCreator:IC,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=Number(l1(a,Po(r))),l=hs(r);if(s==="Enter"){var c=Hu(r,"axis","hover",String(a.index));t.dispatch(rg({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var d=OU(r),u=d==="left-to-right"?1:-1,f=s==="ArrowRight"?1:-1,h=o+f*u;if(!(l==null||h>=l.length||h<0)){var m=Hu(r,"axis","hover",String(h));t.dispatch(rg({active:!0,activeIndex:h.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});M1.startListening({actionCreator:RC,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=Hu(r,"axis","hover",String(s));t.dispatch(rg({activeDataKey:void 0,active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Vn=ra("externalEvent"),FC=ac();FC.startListening({actionCreator:Vn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:wq(r),activeDataKey:DO(r),activeIndex:Os(r),activeLabel:PO(r),activeTooltipIndex:Os(r),isTooltipActive:jq(r)};e.payload.handler(n,e.payload.reactEvent)}}});var _X=pe([Co],e=>e.tooltipItemPayloads),SX=pe([_X,gc,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=t(s,r);return o}}}),LC=ra("touchMove"),MC=ac();MC.startListening({actionCreator:LC,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=o1(n,n.tooltip.settings.shared);if(a==="axis"){var s=F1(n,L1({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));s?.activeIndex!=null&&t.dispatch(jO({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(a==="item"){var o,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(wA),u=(o=c.getAttribute(jA))!==null&&o!==void 0?o:void 0,f=SX(t.getState(),d,u);t.dispatch(bO({activeDataKey:u,activeIndex:d,activeCoordinate:f}))}}});var TX=VT({brush:mK,cartesianAxis:GV,chartData:Zq,errorBars:fG,graphicalItems:fV,layout:PM,legend:w7,options:Vq,polarAxis:kH,polarOptions:EX,referenceElements:wK,rootProps:wX,tooltip:$U}),AX=function(t){return nM({reducer:TX,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([OC.middleware,CC.middleware,M1.middleware,FC.middleware,MC.middleware]),devTools:Ls.devToolsEnabled})};function BC(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=wn(),s=_.useRef(null);if(a)return r;s.current==null&&(s.current=AX(t));var o=tx;return _.createElement(yX,{context:o,store:s.current},r)}function $C(e){var{layout:t,width:r,height:n,margin:a}=e,s=Wt(),o=wn();return _.useEffect(()=>{o||(s(kM(t)),s(OM({width:r,height:n})),s(AM(a)))},[s,o,t,r,n,a]),null}function zC(e){var t=Wt();return _.useEffect(()=>{t(jX(e))},[t,e]),null}var kX=["children"];function OX(e,t){if(e==null)return{};var r,n,a=CX(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function td(){return td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},td.apply(null,arguments)}var PX={width:"100%",height:"100%"},DX=_.forwardRef((e,t)=>{var r=cx(),n=ux(),a=TA();if(!lo(r)||!lo(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,d,u;return typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?u=o.role:u=a?"application":void 0,_.createElement(Vg,td({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:n,style:PX,ref:t}),s)}),IX=e=>{var{children:t}=e,r=We(Md);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return _.createElement(Vg,{width:n,height:a,x:o,y:s},t)},iN=_.forwardRef((e,t)=>{var{children:r}=e,n=OX(e,kX),a=wn();return a?_.createElement(IX,null,r):_.createElement(DX,td({ref:t},n),r)});function RX(){var e=Wt(),[t,r]=_.useState(null),n=We(i7);return _.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),s=a.width/t.offsetWidth;Rr(s)&&s!==n&&e(CM(s))}},[t,e,n]),r}function oN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oN(Object(r),!0).forEach(function(n){LX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LX(e,t,r){return(t=MX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MX(e){var t=BX(e,"string");return typeof t=="symbol"?t:t+""}function BX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $X=_.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:f,onMouseUp:h,onTouchEnd:m,onTouchMove:p,onTouchStart:v,style:g,width:x}=e,b=Wt(),[y,w]=_.useState(null),[j,N]=_.useState(null);iW();var E=RX(),S=_.useCallback(D=>{E(D),typeof t=="function"&&t(D),w(D),N(D)},[E,t,w,N]),O=_.useCallback(D=>{b(kC(D)),b(Vn({handler:s,reactEvent:D}))},[b,s]),k=_.useCallback(D=>{b(vg(D)),b(Vn({handler:d,reactEvent:D}))},[b,d]),T=_.useCallback(D=>{b(wO()),b(Vn({handler:u,reactEvent:D}))},[b,u]),A=_.useCallback(D=>{b(vg(D)),b(Vn({handler:f,reactEvent:D}))},[b,f]),P=_.useCallback(()=>{b(RC())},[b]),C=_.useCallback(D=>{b(IC(D.key))},[b]),F=_.useCallback(D=>{b(Vn({handler:o,reactEvent:D}))},[b,o]),M=_.useCallback(D=>{b(Vn({handler:l,reactEvent:D}))},[b,l]),H=_.useCallback(D=>{b(Vn({handler:c,reactEvent:D}))},[b,c]),V=_.useCallback(D=>{b(Vn({handler:h,reactEvent:D}))},[b,h]),B=_.useCallback(D=>{b(Vn({handler:v,reactEvent:D}))},[b,v]),W=_.useCallback(D=>{b(LC(D)),b(Vn({handler:p,reactEvent:D}))},[b,p]),z=_.useCallback(D=>{b(Vn({handler:m,reactEvent:D}))},[b,m]);return _.createElement($O.Provider,{value:y},_.createElement(hT.Provider,{value:j},_.createElement("div",{className:lt("recharts-wrapper",n),style:FX({position:"relative",cursor:"default",width:x,height:a},g),onClick:O,onContextMenu:F,onDoubleClick:M,onFocus:P,onKeyDown:C,onMouseDown:H,onMouseEnter:k,onMouseLeave:T,onMouseMove:A,onMouseUp:V,onTouchEnd:z,onTouchMove:W,onTouchStart:B,ref:S},r)))}),zX=["children","className","width","height","style","compact","title","desc"];function UX(e,t){if(e==null)return{};var r,n,a=qX(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UC=_.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:s,style:o,compact:l,title:c,desc:d}=e,u=UX(e,zX),f=Na(u);return l?_.createElement(iN,{otherAttributes:f,title:c,desc:d},r):_.createElement($X,{className:n,style:o,width:a,height:s,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},_.createElement(iN,{otherAttributes:f,title:c,desc:d,ref:t},_.createElement(NK,null,r)))}),WX=["width","height"];function gg(){return gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gg.apply(null,arguments)}function HX(e,t){if(e==null)return{};var r,n,a=VX(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var GX={top:5,right:5,bottom:5,left:5},KX={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:GX,reverseStackOrder:!1,syncMethod:"index"},qC=_.forwardRef(function(t,r){var n,a=Fr(t.categoricalChartProps,KX),{width:s,height:o}=a,l=HX(a,WX);if(!lo(s)||!lo(o))return null;var{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,categoricalChartProps:h}=t,m={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return _.createElement(BC,{preloadedState:{options:m},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:c},_.createElement(gC,{chartData:h.data}),_.createElement($C,{width:s,height:o,layout:a.layout,margin:a.margin}),_.createElement(zC,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),_.createElement(UC,gg({},l,{width:s,height:o,ref:r})))}),YX=["axis","item"],XX=_.forwardRef((e,t)=>_.createElement(qC,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:YX,tooltipPayloadSearcher:v1,categoricalChartProps:e,ref:t}));function ZX(e){var t=Wt();return _.useEffect(()=>{t(NX(e))},[t,e]),null}var JX=["width","height","layout"];function xg(){return xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xg.apply(null,arguments)}function QX(e,t){if(e==null)return{};var r,n,a=eZ(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tZ={top:5,right:5,bottom:5,left:5},rZ={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:tZ,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},nZ=_.forwardRef(function(t,r){var n,a=Fr(t.categoricalChartProps,rZ),{width:s,height:o,layout:l}=a,c=QX(a,JX);if(!lo(s)||!lo(o))return null;var{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:f,tooltipPayloadSearcher:h}=t,m={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:f,tooltipPayloadSearcher:h,eventEmitter:void 0};return _.createElement(BC,{preloadedState:{options:m},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},_.createElement(gC,{chartData:a.data}),_.createElement($C,{width:s,height:o,layout:l,margin:a.margin}),_.createElement(zC,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),_.createElement(ZX,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),_.createElement(UC,xg({width:s,height:o},c,{ref:r})))}),aZ=["item"],sZ={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},iZ=_.forwardRef((e,t)=>{var r=Fr(e,sZ);return _.createElement(nZ,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:aZ,tooltipPayloadSearcher:v1,categoricalChartProps:r,ref:t})}),oZ=["axis"],lZ=_.forwardRef((e,t)=>_.createElement(qC,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:oZ,tooltipPayloadSearcher:v1,categoricalChartProps:e,ref:t}));const cZ=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(""),[a,s]=_.useState(""),[o,l]=_.useState(""),[c,d]=_.useState(!1),[u,f]=_.useState(null),[h,m]=_.useState("view"),[p,v]=_.useState(!1),[g,x]=_.useState(null),[b,y]=_.useState([]),[w,j]=_.useState(""),[N,E]=_.useState(!1),[S,O]=_.useState(null),[k,T]=_.useState("view"),[A,P]=_.useState(!1),[C,F]=_.useState(null);_.useEffect(()=>{t([{id:1,eid:"EMP001",fullName:"John Doe",role:"Admin",department:"IT",status:"Active",email:"john.doe@company.com",phone:"+1-555-0123"},{id:2,eid:"EMP002",fullName:"Jane Smith",role:"Trainee",department:"HR",status:"Active",email:"jane.smith@company.com",phone:"+1-555-0124"},{id:3,eid:"EMP003",fullName:"Bob Johnson",role:"Trainer",department:"Finance",status:"Inactive",email:"bob.johnson@company.com",phone:"+1-555-0125"}]),y([{id:1,name:"Admin",assignedUsers:5,status:"Active",permissions:["read","write","delete","manage_users","manage_roles"]},{id:2,name:"Trainee",assignedUsers:12,status:"Active",permissions:["read","write"]},{id:3,name:"Trainer",assignedUsers:45,status:"Active",permissions:["read","write"]}])},[]);const M=ue=>{n(ue)},H=ue=>{s(ue)},V=ue=>{l(ue)},B=ue=>{f(ue),m("view"),d(!0)},W=ue=>{f(ue),m("edit"),d(!0)},z=()=>{f(null),m("add"),d(!0)},D=async ue=>{if(window.confirm("Are you sure you want to delete this user?")){v(!0);try{await new Promise(je=>setTimeout(je,1e3)),t(e.filter(je=>je.id!==ue)),x(null)}catch{x("Failed to delete user")}finally{v(!1)}}},L=async ue=>{v(!0);try{if(await new Promise(je=>setTimeout(je,1e3)),h==="add"){const je={...ue,id:Math.max(...e.map(Oe=>Oe.id))+1,eid:`EMP${String(Math.max(...e.map(Oe=>parseInt(Oe.eid.replace("EMP",""))))+1).padStart(3,"0")}`};t([...e,je])}else t(e.map(je=>je.id===u.id?{...je,...ue}:je));d(!1),f(null),x(null)}catch{x("Failed to save user")}finally{v(!1)}},q=async ue=>{v(!0);try{await new Promise(Oe=>setTimeout(Oe,2e3));const je=[{id:e.length+1,eid:`EMP${String(e.length+1).padStart(3,"0")}`,fullName:"Imported User 1",role:"Employee",department:"IT",status:"Active",email:"imported1@company.com",phone:"+1-555-0001"},{id:e.length+2,eid:`EMP${String(e.length+2).padStart(3,"0")}`,fullName:"Imported User 2",role:"Employee",department:"HR",status:"Active",email:"imported2@company.com",phone:"+1-555-0002"}];t([...e,...je]),x(null)}catch{x("Failed to import users")}finally{v(!1)}},I=ue=>{j(ue)},R=ue=>{O(ue),T("view"),E(!0)},X=ue=>{O(ue),T("edit"),E(!0)},ae=()=>{O(null),T("add"),E(!0)},Z=async ue=>{if(window.confirm("Are you sure you want to delete this role?")){P(!0);try{await new Promise(je=>setTimeout(je,1e3)),y(b.filter(je=>je.id!==ue)),F(null)}catch{F("Failed to delete role")}finally{P(!1)}}},ee=async ue=>{P(!0);try{if(await new Promise(je=>setTimeout(je,1e3)),k==="add"){const je={...ue,id:Math.max(...b.map(Oe=>Oe.id))+1,assignedUsers:0};y([...b,je])}else y(b.map(je=>je.id===S.id?{...je,...ue}:je));E(!1),O(null),F(null)}catch{F("Failed to save role")}finally{P(!1)}},ie=async ue=>{P(!0);try{await new Promise(je=>setTimeout(je,1e3)),y(b.map(je=>je.id===ue?{...je,status:"Inactive"}:je)),F(null)}catch{F("Failed to disable role")}finally{P(!1)}},U=e.filter(ue=>{const je=ue.fullName.toLowerCase().includes(r.toLowerCase())||ue.eid.toLowerCase().includes(r.toLowerCase())||ue.email.toLowerCase().includes(r.toLowerCase()),Oe=!a||ue.role===a,Ae=!o||ue.department===o;return je&&Oe&&Ae}),be=b.filter(ue=>ue.name.toLowerCase().includes(w.toLowerCase())),Se=[...new Set(e.map(ue=>ue.role))],Re=[...new Set(e.map(ue=>ue.department))];return{users:U,userSearchTerm:r,userRoleFilter:a,userDepartmentFilter:o,uniqueRoles:Se,uniqueDepartments:Re,userModalShow:c,selectedUser:u,userModalMode:h,userLoading:p,userError:g,handleUserSearch:M,handleUserRoleFilter:H,handleUserDepartmentFilter:V,handleUserView:B,handleUserEdit:W,handleUserAdd:z,handleUserDelete:D,handleUserSave:L,handleBulkImport:q,setUserError:x,roles:be,roleSearchTerm:w,roleModalShow:N,selectedRole:S,roleModalMode:k,roleLoading:A,roleError:C,handleRoleSearch:I,handleRoleView:R,handleRoleEdit:X,handleRoleAdd:ae,handleRoleDelete:Z,handleRoleSave:ee,handleDisableRole:ie,setRoleError:F,userStats:[{month:"Jan",active:40,inactive:24},{month:"Feb",active:30,inactive:13},{month:"Mar",active:20,inactive:18},{month:"Apr",active:27,inactive:15},{month:"May",active:18,inactive:12},{month:"Jun",active:23,inactive:19}],roleDistribution:[{name:"Admin",value:5},{name:"Trainer",value:15},{name:"Trainee",value:40},{name:"Manager",value:10}],departmentStats:[{name:"IT",users:25,courses:15},{name:"HR",users:15,courses:8},{name:"Finance",users:20,courses:12},{name:"Operations",users:30,courses:20}]}},uZ=()=>{const{userStats:e,roleDistribution:t,departmentStats:r,userError:n,roleError:a}=cZ();return se.useEffect(()=>{console.log("Dashboard mounted"),console.log("User stats:",e),console.log("Role distribution:",t),console.log("Department stats:",r)},[e,t,r]),se.useEffect(()=>{n&&ye.error(n)},[n]),se.useEffect(()=>{a&&ye.error(a)},[a]),i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsx("h1",{className:"text-primary-custom mb-0 text-mobile-center",children:"Aviation Training Management System"})})}),i.jsxs(Ee,{className:"mb-4",children:[i.jsx(oe,{lg:8,md:12,className:"mb-3 mb-lg-0",children:i.jsx(sn,{permission:Me.USERS.VIEW_ALL,fallback:null,children:i.jsxs(ce,{className:"dashboard-chart-mobile",children:[i.jsx(ce.Header,{children:"User Activity Trends"}),i.jsx(ce.Body,{children:i.jsx(t0,{width:"100%",height:300,className:"chart-mobile-height",children:i.jsxs(lZ,{data:e,children:[i.jsx(ug,{strokeDasharray:"3 3"}),i.jsx(hg,{dataKey:"month"}),i.jsx(pg,{}),i.jsx(Yh,{}),i.jsx(Yi,{}),i.jsx(dg,{type:"monotone",dataKey:"active",stroke:"#8884d8",fill:"#8884d8",name:"Active Users"}),i.jsx(dg,{type:"monotone",dataKey:"inactive",stroke:"#82ca9d",fill:"#82ca9d",name:"Inactive Users"})]})})})]})})}),i.jsx(oe,{lg:4,md:12,children:i.jsx(sn,{permission:Me.ROLES.VIEW_ALL,fallback:null,children:i.jsxs(ce,{className:"dashboard-chart-mobile",children:[i.jsx(ce.Header,{children:"Role Distribution"}),i.jsx(ce.Body,{children:i.jsx(t0,{width:"100%",height:300,className:"chart-mobile-height",children:i.jsxs(iZ,{children:[i.jsx(dC,{data:t,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",fill:"#8884d8"}),i.jsx(Yh,{}),i.jsx(Yi,{})]})})})]})})})]}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsx(T8,{module:"DEPARTMENTS",children:i.jsxs(ce,{className:"dashboard-chart-mobile",children:[i.jsx(ce.Header,{children:"Department Statistics"}),i.jsx(ce.Body,{children:i.jsx(t0,{width:"100%",height:300,className:"chart-mobile-height",children:i.jsxs(XX,{data:r,children:[i.jsx(ug,{strokeDasharray:"3 3"}),i.jsx(hg,{dataKey:"name"}),i.jsx(pg,{}),i.jsx(Yh,{}),i.jsx(Yi,{}),i.jsx(lg,{dataKey:"users",fill:"#8884d8",name:"Users"}),i.jsx(lg,{dataKey:"courses",fill:"#82ca9d",name:"Courses"})]})})})]})})})}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsx(sn,{permission:Me.DASHBOARD.VIEW,fallback:i.jsxs(ce,{className:"dashboard-chart-mobile",children:[i.jsx(ce.Header,{children:"System Status"}),i.jsxs(ce.Body,{children:[i.jsx("p",{className:"text-muted",children:"Dashboard is loading. Please wait for permissions to be loaded."}),i.jsx("p",{className:"text-muted",children:"If you continue to see this message, please contact your administrator."})]})]})})})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rd={};rd.version="0.18.5";var WC=1252,dZ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$1=function(e){dZ.indexOf(e)!=-1&&(WC=B1[0]=e)};function fZ(){$1(1252)}var ma=function(e){$1(e)};function z1(){ma(1200),fZ()}function lN(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function hZ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function HC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var el=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?hZ(e.slice(2)):t==254&&r==255?HC(e.slice(2)):t==65279?e.slice(1):e},Xc=function(t){return String.fromCharCode(t)},cN=function(t){return String.fromCharCode(t)},Dl,Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Il(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),s=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Ns.charAt(s)+Ns.charAt(o)+Ns.charAt(l)+Ns.charAt(c);return t}function Rn(e){var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)s=Ns.indexOf(e.charAt(d++)),o=Ns.indexOf(e.charAt(d++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Ns.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Ns.indexOf(e.charAt(d++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var ot=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ms=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ds(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function uN(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var kn=function(t){return ot?ms(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function of(e){if(typeof ArrayBuffer>"u")return kn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function zs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function mZ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function U1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return U1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Er=ot?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ms(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function pZ(e){for(var t=[],r=0,n=e.length+250,a=Ds(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ds(65535),n=65530)}return t.push(a.slice(0,r)),Er(t)}var on=/\u0000/g,tl=/[\u0001-\u0006]/g;function Zi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pa(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}function q1(e,t){var r=""+e;return r.length>=t?r:Ht(" ",t-r.length)+r}function nd(e,t){var r=""+e;return r.length>=t?r:r+Ht(" ",t-r.length)}function vZ(e,t){var r=""+Math.round(e);return r.length>=t?r:Ht("0",t-r.length)+r}function gZ(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}var dN=Math.pow(2,32);function zi(e,t){if(e>dN||e<-dN)return vZ(e,t);var r=Math.round(e);return gZ(r,t)}function ad(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var fN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function xZ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yZ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sd(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(a);d<t&&(f=Math.floor(a),l=f*o+s,u=f*d+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=s):(u=d,l=o)),!r)return[0,n*l,u];var h=Math.floor(n*l/u);return[h,n*l-h*u,u]}function ni(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=_Z(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var VC=new Date(1899,11,31,0,0,0),bZ=VC.getTime(),wZ=new Date(1900,2,1,0,0,0);function GC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=wZ&&(r+=1440*60*1e3),(r-(bZ+(e.getTimezoneOffset()-VC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function W1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jZ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NZ(e){var t=e<0?12:11,r=W1(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function EZ(e){var t=W1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Rl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NZ(e):t===10?r=e.toFixed(10).substr(0,12):r=EZ(e),W1(jZ(r.toUpperCase()))}function Ni(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Rl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return aa(14,GC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _Z(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SZ(e,t,r,n){var a="",s=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return f0[r.m-1][1];case 5:return f0[r.m-1][0];default:return f0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return fN[r.q][0];default:return fN[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?pa(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(a=pa(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?pa(c,d):"";return u}function Es(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var KC=/%/g;function TZ(e,t,r){var n=t.replace(KC,""),a=t.length-n.length;return Ya(e,n,r*Math.pow(10,2*a))+Ht("%",a)}function AZ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ya(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function YC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+YC(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var XC=/# (\?+)( ?)\/( ?)(\d+)/;function kZ(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Ht(" ",e[1].length+1+e[4].length):q1(o,e[1].length)+e[2]+"/"+e[3]+pa(l,e[4].length))}function OZ(e,t,r){return r+(t===0?"":""+t)+Ht(" ",e[1].length+2+e[4].length)}var ZC=/^#*0*\.([0#]+)/,JC=/\).*[0#]/,QC=/\(###\) ###\\?-####/;function en(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function mN(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function pN(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function CZ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function PZ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Gn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(JC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gn("n",n,r):"("+Gn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return AZ(e,t,r);if(t.indexOf("%")!==-1)return TZ(e,t,r);if(t.indexOf("E")!==-1)return YC(t,r);if(t.charCodeAt(0)===36)return"$"+Gn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+zi(c,t.length);if(t.match(/^[#?]+$/))return a=zi(r,0),a==="0"&&(a=""),a.length>t.length?a:en(t.substr(0,t.length-a.length))+a;if(s=t.match(XC))return kZ(s,c,d);if(t.match(/^#+0+$/))return d+zi(c,t.length-t.indexOf("0"));if(s=t.match(ZC))return a=mN(r,s[1].length).replace(/^([^\.]+)$/,"$1."+en(s[1])).replace(/\.$/,"."+en(s[1])).replace(/\.(\d*)$/,function(p,v){return"."+v+Ht("0",en(s[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+mN(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Es(zi(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gn(e,t,-r):Es(""+(Math.floor(r)+CZ(r,s[1].length)))+"."+pa(pN(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Gn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Zi(Gn(e,t.replace(/[\\-]/g,""),r)),o=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(t.match(QC))return a=Gn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=sd(c,Math.pow(10,o)-1,!1),a=""+d,u=Ya("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=nd(l[2],o),u.length<s[4].length&&(u=en(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=sd(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?q1(l[1],o)+s[2]+"/"+s[3]+nd(l[2],o):Ht(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=zi(r,0),t.length<=a.length?a:en(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,h=t.length-a.length-f;return en(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=pN(r,s[1].length),r<0?"-"+Gn(e,t,-r):Es(PZ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?pa(0,3-p.length):"")+p})+"."+pa(o,s[1].length);switch(t){case"###,##0.00":return Gn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Es(zi(c,0));return m!=="0"?d+m:"";case"###,###.00":return Gn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Gn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function DZ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ya(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function IZ(e,t,r){var n=t.replace(KC,""),a=t.length-n.length;return Ya(e,n,r*Math.pow(10,2*a))+Ht("%",a)}function e4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+e4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(JC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return DZ(e,t,r);if(t.indexOf("%")!==-1)return IZ(e,t,r);if(t.indexOf("E")!==-1)return e4(t,r);if(t.charCodeAt(0)===36)return"$"+Aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+pa(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:en(t.substr(0,t.length-a.length))+a;if(s=t.match(XC))return OZ(s,c,d);if(t.match(/^#+0+$/))return d+pa(c,t.length-t.indexOf("0"));if(s=t.match(ZC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+en(s[1])).replace(/\.$/,"."+en(s[1])),a=a.replace(/\.(\d*)$/,function(p,v){return"."+v+Ht("0",en(s[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Es(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):Es(""+r)+"."+Ht("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Aa(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Zi(Aa(e,t.replace(/[\\-]/g,""),r)),o=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(t.match(QC))return a=Aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=sd(c,Math.pow(10,o)-1,!1),a=""+d,u=Ya("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=nd(l[2],o),u.length<s[4].length&&(u=en(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=sd(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?q1(l[1],o)+s[2]+"/"+s[3]+nd(l[2],o):Ht(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:en(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,h=t.length-a.length-f;return en(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):Es(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?pa(0,3-p.length):"")+p})+"."+pa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Es(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return Aa(e,t.slice(0,t.lastIndexOf(".")),r)+en(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ya(e,t,r){return(r|0)===r?Aa(e,t,r):Gn(e,t,r)}function RZ(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var t4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Do(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ad(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(t4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function FZ(e,t,r,n){for(var a=[],s="",o=0,l="",c="t",d,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!ad(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var m=e.charAt(++o),p=m==="("||m===")"?m:"t";a[a.length]={t:p,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ni(t,r,e.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ni(t,r),d==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var v={t:l,v:l};if(d==null&&(d=ni(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",o+=5,h="h"):(v.t="t",++o),d==null&&v.t==="T")return"";a[a.length]=v,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(t4)){if(d==null&&(d=ni(t,r),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Do(e)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var g=0,x=0,b;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=h,c="h",g<1&&(g=1);break;case"s":(b=a[o].v.match(/\.0+$/))&&(x=Math.max(x,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=SZ(a[o].t.charCodeAt(0),a[o].v,d,x),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;y+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=Ni(t,r);break}var j="",N,E;if(y.length>0){y.charCodeAt(0)==40?(N=t<0&&y.charCodeAt(0)===45?-t:t,E=Ya("n",y,N)):(N=t<0&&n>1?-t:t,E=Ya("n",y,N),N<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),w=E.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var O=a.length;if(S===a.length&&E.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=E.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=E.substr(0,w+1),w=-1),a[o].t="t",O=o);w>=0&&O<a.length&&(a[O].v=E.substr(0,w+1)+a[O].v)}else if(S!==a.length&&E.indexOf("E")===-1){for(w=E.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(u+1);u>=0;--u)w>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(j=E.charAt(w--)+j);a[o].v=j,a[o].t="t",O=o}for(w>=0&&O<a.length&&(a[O].v=E.substr(0,w+1)+a[O].v),w=E.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(u=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,u);u<a[o].v.length;++u)w<E.length&&(j+=E.charAt(w++));a[o].v=j,a[o].t="t",O=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(N=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Ya(a[o].t,a[o].v,N),a[o].t="t");var k="";for(o=0;o!==a.length;++o)a[o]!=null&&(k+=a[o].v);return k}var vN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gN(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function LZ(e,t){var r=RZ(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(vN),l=r[1].match(vN);return gN(t,o)?[n,r[0]]:gN(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function aa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Xe)[e],n==null&&(n=r.table&&r.table[hN[e]]||Xe[hN[e]]),n==null&&(n=yZ[e]||"General");break}if(ad(n,0))return Ni(t,r);t instanceof Date&&(t=GC(t,r.date1904));var a=LZ(n,t);if(ad(a[1]))return Ni(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return FZ(a[1],t,r,a[0])}function Xa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Xe[r]==null){t<0&&(t=r);continue}if(Xe[r]==e){t=r;break}}t<0&&(t=391)}return Xe[t]=e,t}function lf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Xa(e[t],t)}function Io(){Xe=xZ()}var MZ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},r4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function BZ(e){var t=typeof e=="number"?Xe[e]:e;return t=t.replace(r4,"(\\d+)"),new RegExp("^"+t+"$")}function $Z(e,t,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(t.match(r4)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:a=m;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&s==-1?u:d+"T"+u}var zZ=(function(){var e={};e.version="1.2.0";function t(){for(var E=0,S=new Array(256),O=0;O!=256;++O)E=O,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[O]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(E){var S=0,O=0,k=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)T[k]=E[k];for(k=0;k!=256;++k)for(O=E[k],S=256+k;S<4096;S+=256)O=T[S]=O>>>8^E[O&255];var A=[];for(k=1;k!=16;++k)A[k-1]=typeof Int32Array<"u"?T.subarray(k*256,k*256+256):T.slice(k*256,k*256+256);return A}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],d=a[4],u=a[5],f=a[6],h=a[7],m=a[8],p=a[9],v=a[10],g=a[11],x=a[12],b=a[13],y=a[14];function w(E,S){for(var O=S^-1,k=0,T=E.length;k<T;)O=O>>>8^r[(O^E.charCodeAt(k++))&255];return~O}function j(E,S){for(var O=S^-1,k=E.length-15,T=0;T<k;)O=y[E[T++]^O&255]^b[E[T++]^O>>8&255]^x[E[T++]^O>>16&255]^g[E[T++]^O>>>24]^v[E[T++]]^p[E[T++]]^m[E[T++]]^h[E[T++]]^f[E[T++]]^u[E[T++]]^d[E[T++]]^c[E[T++]]^l[E[T++]]^o[E[T++]]^s[E[T++]]^r[E[T++]];for(k+=15;T<k;)O=O>>>8^r[(O^E[T++])&255];return~O}function N(E,S){for(var O=S^-1,k=0,T=E.length,A=0,P=0;k<T;)A=E.charCodeAt(k++),A<128?O=O>>>8^r[(O^A)&255]:A<2048?(O=O>>>8^r[(O^(192|A>>6&31))&255],O=O>>>8^r[(O^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,P=E.charCodeAt(k++)&1023,O=O>>>8^r[(O^(240|A>>8&7))&255],O=O>>>8^r[(O^(128|A>>2&63))&255],O=O>>>8^r[(O^(128|P>>6&15|(A&3)<<4))&255],O=O>>>8^r[(O^(128|P&63))&255]):(O=O>>>8^r[(O^(224|A>>12&15))&255],O=O>>>8^r[(O^(128|A>>6&63))&255],O=O>>>8^r[(O^(128|A&63))&255]);return~O}return e.table=r,e.bstr=w,e.buf=j,e.str=N,e})(),Ge=(function(){var t={};t.version="1.2.1";function r(G,te){for(var J=G.split("/"),Q=te.split("/"),re=0,ne=0,me=Math.min(J.length,Q.length);re<me;++re){if(ne=J[re].length-Q[re].length)return ne;if(J[re]!=Q[re])return J[re]<Q[re]?-1:1}return J.length-Q.length}function n(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:n(G.slice(0,-1));var te=G.lastIndexOf("/");return te===-1?G:G.slice(0,te+1)}function a(G){if(G.charAt(G.length-1)=="/")return a(G.slice(0,-1));var te=G.lastIndexOf("/");return te===-1?G:G.slice(te+1)}function s(G,te){typeof te=="string"&&(te=new Date(te));var J=te.getHours();J=J<<6|te.getMinutes(),J=J<<5|te.getSeconds()>>>1,G.write_shift(2,J);var Q=te.getFullYear()-1980;Q=Q<<4|te.getMonth()+1,Q=Q<<5|te.getDate(),G.write_shift(2,Q)}function o(G){var te=G.read_shift(2)&65535,J=G.read_shift(2)&65535,Q=new Date,re=J&31;J>>>=5;var ne=J&15;J>>>=4,Q.setMilliseconds(0),Q.setFullYear(J+1980),Q.setMonth(ne-1),Q.setDate(re);var me=te&31;te>>>=5;var Ne=te&63;return te>>>=6,Q.setHours(te),Q.setMinutes(Ne),Q.setSeconds(me<<1),Q}function l(G){Dr(G,0);for(var te={},J=0;G.l<=G.length-4;){var Q=G.read_shift(2),re=G.read_shift(2),ne=G.l+re,me={};switch(Q){case 21589:J=G.read_shift(1),J&1&&(me.mtime=G.read_shift(4)),re>5&&(J&2&&(me.atime=G.read_shift(4)),J&4&&(me.ctime=G.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}G.l=ne,te[Q]=me}return te}var c;function d(){return c||(c={})}function u(G,te){if(G[0]==80&&G[1]==75)return Iy(G,te);if((G[0]|32)==109&&(G[1]|32)==105)return _P(G,te);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var J=3,Q=512,re=0,ne=0,me=0,Ne=0,fe=0,ve=[],ge=G.slice(0,512);Dr(ge,0);var ke=f(ge);switch(J=ke[0],J){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(ke[1]==0)return Iy(G,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}Q!==512&&(ge=G.slice(0,Q),Dr(ge,28));var Fe=G.slice(0,Q);h(ge,J);var ze=ge.read_shift(4,"i");if(J===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ge.l+=4,me=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ne=ge.read_shift(4,"i"),re=ge.read_shift(4,"i"),fe=ge.read_shift(4,"i"),ne=ge.read_shift(4,"i");for(var Ce=-1,Be=0;Be<109&&(Ce=ge.read_shift(4,"i"),!(Ce<0));++Be)ve[Be]=Ce;var rt=m(G,Q);g(fe,ne,rt,Q,ve);var Lt=b(rt,me,ve,Q);Lt[me].name="!Directory",re>0&&Ne!==P&&(Lt[Ne].name="!MiniFAT"),Lt[ve[0]].name="!FAT",Lt.fat_addrs=ve,Lt.ssz=Q;var Mt={},Lr=[],Mo=[],Bo=[];y(me,Lt,rt,Lr,re,Mt,Mo,Ne),p(Mo,Bo,Lr),Lr.shift();var $o={FileIndex:Mo,FullPaths:Bo};return te&&te.raw&&($o.raw={header:Fe,sectors:rt}),$o}function f(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(C,"Header Signature: "),G.l+=16;var te=G.read_shift(2,"u");return[G.read_shift(2,"u"),te]}function h(G,te){var J=9;switch(G.l+=2,J=G.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function m(G,te){for(var J=Math.ceil(G.length/te)-1,Q=[],re=1;re<J;++re)Q[re-1]=G.slice(re*te,(re+1)*te);return Q[J-1]=G.slice(J*te),Q}function p(G,te,J){for(var Q=0,re=0,ne=0,me=0,Ne=0,fe=J.length,ve=[],ge=[];Q<fe;++Q)ve[Q]=ge[Q]=Q,te[Q]=J[Q];for(;Ne<ge.length;++Ne)Q=ge[Ne],re=G[Q].L,ne=G[Q].R,me=G[Q].C,ve[Q]===Q&&(re!==-1&&ve[re]!==re&&(ve[Q]=ve[re]),ne!==-1&&ve[ne]!==ne&&(ve[Q]=ve[ne])),me!==-1&&(ve[me]=Q),re!==-1&&Q!=ve[Q]&&(ve[re]=ve[Q],ge.lastIndexOf(re)<Ne&&ge.push(re)),ne!==-1&&Q!=ve[Q]&&(ve[ne]=ve[Q],ge.lastIndexOf(ne)<Ne&&ge.push(ne));for(Q=1;Q<fe;++Q)ve[Q]===Q&&(ne!==-1&&ve[ne]!==ne?ve[Q]=ve[ne]:re!==-1&&ve[re]!==re&&(ve[Q]=ve[re]));for(Q=1;Q<fe;++Q)if(G[Q].type!==0){if(Ne=Q,Ne!=ve[Ne])do Ne=ve[Ne],te[Q]=te[Ne]+"/"+te[Q];while(Ne!==0&&ve[Ne]!==-1&&Ne!=ve[Ne]);ve[Q]=-1}for(te[0]+="/",Q=1;Q<fe;++Q)G[Q].type!==2&&(te[Q]+="/")}function v(G,te,J){for(var Q=G.start,re=G.size,ne=[],me=Q;J&&re>0&&me>=0;)ne.push(te.slice(me*A,me*A+A)),re-=A,me=Zs(J,me*4);return ne.length===0?we(0):Er(ne).slice(0,G.size)}function g(G,te,J,Q,re){var ne=P;if(G===P){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var me=J[G],Ne=(Q>>>2)-1;if(!me)return;for(var fe=0;fe<Ne&&(ne=Zs(me,fe*4))!==P;++fe)re.push(ne);g(Zs(me,Q-4),te-1,J,Q,re)}}function x(G,te,J,Q,re){var ne=[],me=[];re||(re=[]);var Ne=Q-1,fe=0,ve=0;for(fe=te;fe>=0;){re[fe]=!0,ne[ne.length]=fe,me.push(G[fe]);var ge=J[Math.floor(fe*4/Q)];if(ve=fe*4&Ne,Q<4+ve)throw new Error("FAT boundary crossed: "+fe+" 4 "+Q);if(!G[ge])break;fe=Zs(G[ge],ve)}return{nodes:ne,data:kN([me])}}function b(G,te,J,Q){var re=G.length,ne=[],me=[],Ne=[],fe=[],ve=Q-1,ge=0,ke=0,Fe=0,ze=0;for(ge=0;ge<re;++ge)if(Ne=[],Fe=ge+te,Fe>=re&&(Fe-=re),!me[Fe]){fe=[];var Ce=[];for(ke=Fe;ke>=0;){Ce[ke]=!0,me[ke]=!0,Ne[Ne.length]=ke,fe.push(G[ke]);var Be=J[Math.floor(ke*4/Q)];if(ze=ke*4&ve,Q<4+ze)throw new Error("FAT boundary crossed: "+ke+" 4 "+Q);if(!G[Be]||(ke=Zs(G[Be],ze),Ce[ke]))break}ne[Fe]={nodes:Ne,data:kN([fe])}}return ne}function y(G,te,J,Q,re,ne,me,Ne){for(var fe=0,ve=Q.length?2:0,ge=te[G].data,ke=0,Fe=0,ze;ke<ge.length;ke+=128){var Ce=ge.slice(ke,ke+128);Dr(Ce,64),Fe=Ce.read_shift(2),ze=Z1(Ce,0,Fe-ve),Q.push(ze);var Be={name:ze,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},rt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);rt!==0&&(Be.ct=w(Ce,Ce.l-8));var Lt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Lt!==0&&(Be.mt=w(Ce,Ce.l-8)),Be.start=Ce.read_shift(4,"i"),Be.size=Ce.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=P,Be.name=""),Be.type===5?(fe=Be.start,re>0&&fe!==P&&(te[fe].name="!StreamData")):Be.size>=4096?(Be.storage="fat",te[Be.start]===void 0&&(te[Be.start]=x(J,Be.start,te.fat_addrs,te.ssz)),te[Be.start].name=Be.name,Be.content=te[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:fe!==P&&Be.start!==P&&te[fe]&&(Be.content=v(Be,te[fe].data,(te[Ne]||{}).data))),Be.content&&Dr(Be.content,0),ne[ze]=Be,me.push(Be)}}function w(G,te){return new Date((Tn(G,te+4)/1e7*Math.pow(2,32)+Tn(G,te)/1e7-11644473600)*1e3)}function j(G,te){return d(),u(c.readFileSync(G),te)}function N(G,te){var J=te&&te.type;switch(J||ot&&Buffer.isBuffer(G)&&(J="buffer"),J||"base64"){case"file":return j(G,te);case"base64":return u(kn(Rn(G)),te);case"binary":return u(kn(G),te)}return u(G,te)}function E(G,te){var J=te||{},Q=J.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=Q+"/",G.FileIndex[0]={name:Q,type:5}),J.CLSID&&(G.FileIndex[0].clsid=J.CLSID),S(G)}function S(G){var te="Sh33tJ5";if(!Ge.find(G,"/"+te)){var J=we(4);J[0]=55,J[1]=J[3]=50,J[2]=54,G.FileIndex.push({name:te,type:2,content:J,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+te),O(G)}}function O(G,te){E(G);for(var J=!1,Q=!1,re=G.FullPaths.length-1;re>=0;--re){var ne=G.FileIndex[re];switch(ne.type){case 0:Q?J=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ne.R*ne.L*ne.C)&&(J=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!te)){var me=new Date(1987,1,19),Ne=0,fe=Object.create?Object.create(null):{},ve=[];for(re=0;re<G.FullPaths.length;++re)fe[G.FullPaths[re]]=!0,G.FileIndex[re].type!==0&&ve.push([G.FullPaths[re],G.FileIndex[re]]);for(re=0;re<ve.length;++re){var ge=n(ve[re][0]);Q=fe[ge],Q||(ve.push([ge,{name:a(ge).replace("/",""),type:1,clsid:M,ct:me,mt:me,content:null}]),fe[ge]=!0)}for(ve.sort(function(ze,Ce){return r(ze[0],Ce[0])}),G.FullPaths=[],G.FileIndex=[],re=0;re<ve.length;++re)G.FullPaths[re]=ve[re][0],G.FileIndex[re]=ve[re][1];for(re=0;re<ve.length;++re){var ke=G.FileIndex[re],Fe=G.FullPaths[re];if(ke.name=a(Fe).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||M,re===0)ke.C=ve.length>1?1:-1,ke.size=0,ke.type=5;else if(Fe.slice(-1)=="/"){for(Ne=re+1;Ne<ve.length&&n(G.FullPaths[Ne])!=Fe;++Ne);for(ke.C=Ne>=ve.length?-1:Ne,Ne=re+1;Ne<ve.length&&n(G.FullPaths[Ne])!=n(Fe);++Ne);ke.R=Ne>=ve.length?-1:Ne,ke.type=1}else n(G.FullPaths[re+1]||"")==n(Fe)&&(ke.R=re+1),ke.type=2}}}function k(G,te){var J=te||{};if(J.fileType=="mad")return SP(G,J);switch(O(G),J.fileType){case"zip":return yP(G,J)}var Q=(function(ze){for(var Ce=0,Be=0,rt=0;rt<ze.FileIndex.length;++rt){var Lt=ze.FileIndex[rt];if(Lt.content){var Mt=Lt.content.length;Mt>0&&(Mt<4096?Ce+=Mt+63>>6:Be+=Mt+511>>9)}}for(var Lr=ze.FullPaths.length+3>>2,Mo=Ce+7>>3,Bo=Ce+127>>7,$o=Mo+Be+Lr+Bo,Hs=$o+127>>7,Nf=Hs<=109?0:Math.ceil((Hs-109)/127);$o+Hs+Nf+127>>7>Hs;)Nf=++Hs<=109?0:Math.ceil((Hs-109)/127);var Ma=[1,Nf,Hs,Bo,Lr,Be,Ce,0];return ze.FileIndex[0].size=Ce<<6,Ma[7]=(ze.FileIndex[0].start=Ma[0]+Ma[1]+Ma[2]+Ma[3]+Ma[4]+Ma[5])+(Ma[6]+7>>3),Ma})(G),re=we(Q[7]<<9),ne=0,me=0;{for(ne=0;ne<8;++ne)re.write_shift(1,F[ne]);for(ne=0;ne<8;++ne)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ne=0;ne<3;++ne)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Q[2]),re.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:P),re.write_shift(4,Q[3]),re.write_shift(-4,Q[1]?Q[0]-1:P),re.write_shift(4,Q[1]),ne=0;ne<109;++ne)re.write_shift(-4,ne<Q[2]?Q[1]+ne:-1)}if(Q[1])for(me=0;me<Q[1];++me){for(;ne<236+me*127;++ne)re.write_shift(-4,ne<Q[2]?Q[1]+ne:-1);re.write_shift(-4,me===Q[1]-1?P:me+1)}var Ne=function(ze){for(me+=ze;ne<me-1;++ne)re.write_shift(-4,ne+1);ze&&(++ne,re.write_shift(-4,P))};for(me=ne=0,me+=Q[1];ne<me;++ne)re.write_shift(-4,H.DIFSECT);for(me+=Q[2];ne<me;++ne)re.write_shift(-4,H.FATSECT);Ne(Q[3]),Ne(Q[4]);for(var fe=0,ve=0,ge=G.FileIndex[0];fe<G.FileIndex.length;++fe)ge=G.FileIndex[fe],ge.content&&(ve=ge.content.length,!(ve<4096)&&(ge.start=me,Ne(ve+511>>9)));for(Ne(Q[6]+7>>3);re.l&511;)re.write_shift(-4,H.ENDOFCHAIN);for(me=ne=0,fe=0;fe<G.FileIndex.length;++fe)ge=G.FileIndex[fe],ge.content&&(ve=ge.content.length,!(!ve||ve>=4096)&&(ge.start=me,Ne(ve+63>>6)));for(;re.l&511;)re.write_shift(-4,H.ENDOFCHAIN);for(ne=0;ne<Q[4]<<2;++ne){var ke=G.FullPaths[ne];if(!ke||ke.length===0){for(fe=0;fe<17;++fe)re.write_shift(4,0);for(fe=0;fe<3;++fe)re.write_shift(4,-1);for(fe=0;fe<12;++fe)re.write_shift(4,0);continue}ge=G.FileIndex[ne],ne===0&&(ge.start=ge.size?ge.start-1:P);var Fe=ne===0&&J.root||ge.name;if(ve=2*(Fe.length+1),re.write_shift(64,Fe,"utf16le"),re.write_shift(2,ve),re.write_shift(1,ge.type),re.write_shift(1,ge.color),re.write_shift(-4,ge.L),re.write_shift(-4,ge.R),re.write_shift(-4,ge.C),ge.clsid)re.write_shift(16,ge.clsid,"hex");else for(fe=0;fe<4;++fe)re.write_shift(4,0);re.write_shift(4,ge.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,ge.start),re.write_shift(4,ge.size),re.write_shift(4,0)}for(ne=1;ne<G.FileIndex.length;++ne)if(ge=G.FileIndex[ne],ge.size>=4096)if(re.l=ge.start+1<<9,ot&&Buffer.isBuffer(ge.content))ge.content.copy(re,re.l,0,ge.size),re.l+=ge.size+511&-512;else{for(fe=0;fe<ge.size;++fe)re.write_shift(1,ge.content[fe]);for(;fe&511;++fe)re.write_shift(1,0)}for(ne=1;ne<G.FileIndex.length;++ne)if(ge=G.FileIndex[ne],ge.size>0&&ge.size<4096)if(ot&&Buffer.isBuffer(ge.content))ge.content.copy(re,re.l,0,ge.size),re.l+=ge.size+63&-64;else{for(fe=0;fe<ge.size;++fe)re.write_shift(1,ge.content[fe]);for(;fe&63;++fe)re.write_shift(1,0)}if(ot)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function T(G,te){var J=G.FullPaths.map(function(fe){return fe.toUpperCase()}),Q=J.map(function(fe){var ve=fe.split("/");return ve[ve.length-(fe.slice(-1)=="/"?2:1)]}),re=!1;te.charCodeAt(0)===47?(re=!0,te=J[0].slice(0,-1)+te):re=te.indexOf("/")!==-1;var ne=te.toUpperCase(),me=re===!0?J.indexOf(ne):Q.indexOf(ne);if(me!==-1)return G.FileIndex[me];var Ne=!ne.match(tl);for(ne=ne.replace(on,""),Ne&&(ne=ne.replace(tl,"!")),me=0;me<J.length;++me)if((Ne?J[me].replace(tl,"!"):J[me]).replace(on,"")==ne||(Ne?Q[me].replace(tl,"!"):Q[me]).replace(on,"")==ne)return G.FileIndex[me];return null}var A=64,P=-2,C="d0cf11e0a1b11ae1",F=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:C,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(G,te,J){d();var Q=k(G,J);c.writeFileSync(te,Q)}function B(G){for(var te=new Array(G.length),J=0;J<G.length;++J)te[J]=String.fromCharCode(G[J]);return te.join("")}function W(G,te){var J=k(G,te);switch(te&&te.type||"buffer"){case"file":return d(),c.writeFileSync(te.filename,J),J;case"binary":return typeof J=="string"?J:B(J);case"base64":return Il(typeof J=="string"?J:B(J));case"buffer":if(ot)return Buffer.isBuffer(J)?J:ms(J);case"array":return typeof J=="string"?kn(J):J}return J}var z;function D(G){try{var te=G.InflateRaw,J=new te;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)z=G;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function L(G,te){if(!z)return Py(G,te);var J=z.InflateRaw,Q=new J,re=Q._processChunk(G.slice(G.l),Q._finishFlushFlag);return G.l+=Q.bytesRead,re}function q(G){return z?z.deflateRawSync(G):Ve(G)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(G){var te=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(te>>16|te>>8|te)&255}for(var Z=typeof Uint8Array<"u",ee=Z?new Uint8Array(256):[],ie=0;ie<256;++ie)ee[ie]=ae(ie);function U(G,te){var J=ee[G&255];return te<=8?J>>>8-te:(J=J<<8|ee[G>>8&255],te<=16?J>>>16-te:(J=J<<8|ee[G>>16&255],J>>>24-te))}function be(G,te){var J=te&7,Q=te>>>3;return(G[Q]|(J<=6?0:G[Q+1]<<8))>>>J&3}function Se(G,te){var J=te&7,Q=te>>>3;return(G[Q]|(J<=5?0:G[Q+1]<<8))>>>J&7}function Re(G,te){var J=te&7,Q=te>>>3;return(G[Q]|(J<=4?0:G[Q+1]<<8))>>>J&15}function Le(G,te){var J=te&7,Q=te>>>3;return(G[Q]|(J<=3?0:G[Q+1]<<8))>>>J&31}function _e(G,te){var J=te&7,Q=te>>>3;return(G[Q]|(J<=1?0:G[Q+1]<<8))>>>J&127}function he(G,te,J){var Q=te&7,re=te>>>3,ne=(1<<J)-1,me=G[re]>>>Q;return J<8-Q||(me|=G[re+1]<<8-Q,J<16-Q)||(me|=G[re+2]<<16-Q,J<24-Q)||(me|=G[re+3]<<24-Q),me&ne}function ue(G,te,J){var Q=te&7,re=te>>>3;return Q<=5?G[re]|=(J&7)<<Q:(G[re]|=J<<Q&255,G[re+1]=(J&7)>>8-Q),te+3}function je(G,te,J){var Q=te&7,re=te>>>3;return J=(J&1)<<Q,G[re]|=J,te+1}function Oe(G,te,J){var Q=te&7,re=te>>>3;return J<<=Q,G[re]|=J&255,J>>>=8,G[re+1]=J,te+8}function Ae(G,te,J){var Q=te&7,re=te>>>3;return J<<=Q,G[re]|=J&255,J>>>=8,G[re+1]=J&255,G[re+2]=J>>>8,te+16}function Qe(G,te){var J=G.length,Q=2*J>te?2*J:te+5,re=0;if(J>=te)return G;if(ot){var ne=uN(Q);if(G.copy)G.copy(ne);else for(;re<G.length;++re)ne[re]=G[re];return ne}else if(Z){var me=new Uint8Array(Q);if(me.set)me.set(G);else for(;re<J;++re)me[re]=G[re];return me}return G.length=Q,G}function Ke(G){for(var te=new Array(G),J=0;J<G;++J)te[J]=0;return te}function et(G,te,J){var Q=1,re=0,ne=0,me=0,Ne=0,fe=G.length,ve=Z?new Uint16Array(32):Ke(32);for(ne=0;ne<32;++ne)ve[ne]=0;for(ne=fe;ne<J;++ne)G[ne]=0;fe=G.length;var ge=Z?new Uint16Array(fe):Ke(fe);for(ne=0;ne<fe;++ne)ve[re=G[ne]]++,Q<re&&(Q=re),ge[ne]=0;for(ve[0]=0,ne=1;ne<=Q;++ne)ve[ne+16]=Ne=Ne+ve[ne-1]<<1;for(ne=0;ne<fe;++ne)Ne=G[ne],Ne!=0&&(ge[ne]=ve[Ne+16]++);var ke=0;for(ne=0;ne<fe;++ne)if(ke=G[ne],ke!=0)for(Ne=U(ge[ne],Q)>>Q-ke,me=(1<<Q+4-ke)-1;me>=0;--me)te[Ne|me<<ke]=ke&15|ne<<4;return Q}var Qt=Z?new Uint16Array(512):Ke(512),Jr=Z?new Uint16Array(32):Ke(32);if(!Z){for(var it=0;it<512;++it)Qt[it]=0;for(it=0;it<32;++it)Jr[it]=0}(function(){for(var G=[],te=0;te<32;te++)G.push(5);et(G,Jr,32);var J=[];for(te=0;te<=143;te++)J.push(8);for(;te<=255;te++)J.push(9);for(;te<=279;te++)J.push(7);for(;te<=287;te++)J.push(8);et(J,Qt,288)})();var $n=(function(){for(var te=Z?new Uint8Array(32768):[],J=0,Q=0;J<X.length-1;++J)for(;Q<X[J+1];++Q)te[Q]=J;for(;Q<32768;++Q)te[Q]=29;var re=Z?new Uint8Array(259):[];for(J=0,Q=0;J<R.length-1;++J)for(;Q<R[J+1];++Q)re[Q]=J;function ne(Ne,fe){for(var ve=0;ve<Ne.length;){var ge=Math.min(65535,Ne.length-ve),ke=ve+ge==Ne.length;for(fe.write_shift(1,+ke),fe.write_shift(2,ge),fe.write_shift(2,~ge&65535);ge-- >0;)fe[fe.l++]=Ne[ve++]}return fe.l}function me(Ne,fe){for(var ve=0,ge=0,ke=Z?new Uint16Array(32768):[];ge<Ne.length;){var Fe=Math.min(65535,Ne.length-ge);if(Fe<10){for(ve=ue(fe,ve,+(ge+Fe==Ne.length)),ve&7&&(ve+=8-(ve&7)),fe.l=ve/8|0,fe.write_shift(2,Fe),fe.write_shift(2,~Fe&65535);Fe-- >0;)fe[fe.l++]=Ne[ge++];ve=fe.l*8;continue}ve=ue(fe,ve,+(ge+Fe==Ne.length)+2);for(var ze=0;Fe-- >0;){var Ce=Ne[ge];ze=(ze<<5^Ce)&32767;var Be=-1,rt=0;if((Be=ke[ze])&&(Be|=ge&-32768,Be>ge&&(Be-=32768),Be<ge))for(;Ne[Be+rt]==Ne[ge+rt]&&rt<250;)++rt;if(rt>2){Ce=re[rt],Ce<=22?ve=Oe(fe,ve,ee[Ce+1]>>1)-1:(Oe(fe,ve,3),ve+=5,Oe(fe,ve,ee[Ce-23]>>5),ve+=3);var Lt=Ce<8?0:Ce-4>>2;Lt>0&&(Ae(fe,ve,rt-R[Ce]),ve+=Lt),Ce=te[ge-Be],ve=Oe(fe,ve,ee[Ce]>>3),ve-=3;var Mt=Ce<4?0:Ce-2>>1;Mt>0&&(Ae(fe,ve,ge-Be-X[Ce]),ve+=Mt);for(var Lr=0;Lr<rt;++Lr)ke[ze]=ge&32767,ze=(ze<<5^Ne[ge])&32767,++ge;Fe-=rt-1}else Ce<=143?Ce=Ce+48:ve=je(fe,ve,1),ve=Oe(fe,ve,ee[Ce]),ke[ze]=ge&32767,++ge}ve=Oe(fe,ve,0)-1}return fe.l=(ve+7)/8|0,fe.l}return function(fe,ve){return fe.length<8?ne(fe,ve):me(fe,ve)}})();function Ve(G){var te=we(50+Math.floor(G.length*1.1)),J=$n(G,te);return te.slice(0,J)}var pt=Z?new Uint16Array(32768):Ke(32768),zn=Z?new Uint16Array(32768):Ke(32768),hr=Z?new Uint16Array(128):Ke(128),Ws=1,Cy=1;function vP(G,te){var J=Le(G,te)+257;te+=5;var Q=Le(G,te)+1;te+=5;var re=Re(G,te)+4;te+=4;for(var ne=0,me=Z?new Uint8Array(19):Ke(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,ve=Z?new Uint8Array(8):Ke(8),ge=Z?new Uint8Array(8):Ke(8),ke=me.length,Fe=0;Fe<re;++Fe)me[I[Fe]]=ne=Se(G,te),fe<ne&&(fe=ne),ve[ne]++,te+=3;var ze=0;for(ve[0]=0,Fe=1;Fe<=fe;++Fe)ge[Fe]=ze=ze+ve[Fe-1]<<1;for(Fe=0;Fe<ke;++Fe)(ze=me[Fe])!=0&&(Ne[Fe]=ge[ze]++);var Ce=0;for(Fe=0;Fe<ke;++Fe)if(Ce=me[Fe],Ce!=0){ze=ee[Ne[Fe]]>>8-Ce;for(var Be=(1<<7-Ce)-1;Be>=0;--Be)hr[ze|Be<<Ce]=Ce&7|Fe<<3}var rt=[];for(fe=1;rt.length<J+Q;)switch(ze=hr[_e(G,te)],te+=ze&7,ze>>>=3){case 16:for(ne=3+be(G,te),te+=2,ze=rt[rt.length-1];ne-- >0;)rt.push(ze);break;case 17:for(ne=3+Se(G,te),te+=3;ne-- >0;)rt.push(0);break;case 18:for(ne=11+_e(G,te),te+=7;ne-- >0;)rt.push(0);break;default:rt.push(ze),fe<ze&&(fe=ze);break}var Lt=rt.slice(0,J),Mt=rt.slice(J);for(Fe=J;Fe<286;++Fe)Lt[Fe]=0;for(Fe=Q;Fe<30;++Fe)Mt[Fe]=0;return Ws=et(Lt,pt,286),Cy=et(Mt,zn,30),te}function gP(G,te){if(G[0]==3&&!(G[1]&3))return[Ds(te),2];for(var J=0,Q=0,re=uN(te||1<<18),ne=0,me=re.length>>>0,Ne=0,fe=0;(Q&1)==0;){if(Q=Se(G,J),J+=3,Q>>>1)Q>>1==1?(Ne=9,fe=5):(J=vP(G,J),Ne=Ws,fe=Cy);else{J&7&&(J+=8-(J&7));var ve=G[J>>>3]|G[(J>>>3)+1]<<8;if(J+=32,ve>0)for(!te&&me<ne+ve&&(re=Qe(re,ne+ve),me=re.length);ve-- >0;)re[ne++]=G[J>>>3],J+=8;continue}for(;;){!te&&me<ne+32767&&(re=Qe(re,ne+32767),me=re.length);var ge=he(G,J,Ne),ke=Q>>>1==1?Qt[ge]:pt[ge];if(J+=ke&15,ke>>>=4,(ke>>>8&255)===0)re[ne++]=ke;else{if(ke==256)break;ke-=257;var Fe=ke<8?0:ke-4>>2;Fe>5&&(Fe=0);var ze=ne+R[ke];Fe>0&&(ze+=he(G,J,Fe),J+=Fe),ge=he(G,J,fe),ke=Q>>>1==1?Jr[ge]:zn[ge],J+=ke&15,ke>>>=4;var Ce=ke<4?0:ke-2>>1,Be=X[ke];for(Ce>0&&(Be+=he(G,J,Ce),J+=Ce),!te&&me<ze&&(re=Qe(re,ze+100),me=re.length);ne<ze;)re[ne]=re[ne-Be],++ne}}}return te?[re,J+7>>>3]:[re.slice(0,ne),J+7>>>3]}function Py(G,te){var J=G.slice(G.l||0),Q=gP(J,te);return G.l+=Q[1],Q[0]}function Dy(G,te){if(G)typeof console<"u"&&console.error(te);else throw new Error(te)}function Iy(G,te){var J=G;Dr(J,0);var Q=[],re=[],ne={FileIndex:Q,FullPaths:re};E(ne,{root:te.root});for(var me=J.length-4;(J[me]!=80||J[me+1]!=75||J[me+2]!=5||J[me+3]!=6)&&me>=0;)--me;J.l=me+4,J.l+=4;var Ne=J.read_shift(2);J.l+=6;var fe=J.read_shift(4);for(J.l=fe,me=0;me<Ne;++me){J.l+=20;var ve=J.read_shift(4),ge=J.read_shift(4),ke=J.read_shift(2),Fe=J.read_shift(2),ze=J.read_shift(2);J.l+=8;var Ce=J.read_shift(4),Be=l(J.slice(J.l+ke,J.l+ke+Fe));J.l+=ke+Fe+ze;var rt=J.l;J.l=Ce+4,xP(J,ve,ge,ne,Be),J.l=rt}return ne}function xP(G,te,J,Q,re){G.l+=2;var ne=G.read_shift(2),me=G.read_shift(2),Ne=o(G);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var fe=G.read_shift(4),ve=G.read_shift(4),ge=G.read_shift(4),ke=G.read_shift(2),Fe=G.read_shift(2),ze="",Ce=0;Ce<ke;++Ce)ze+=String.fromCharCode(G[G.l++]);if(Fe){var Be=l(G.slice(G.l,G.l+Fe));(Be[21589]||{}).mt&&(Ne=Be[21589].mt),((re||{})[21589]||{}).mt&&(Ne=re[21589].mt)}G.l+=Fe;var rt=G.slice(G.l,G.l+ve);switch(me){case 8:rt=L(G,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var Lt=!1;ne&8&&(fe=G.read_shift(4),fe==134695760&&(fe=G.read_shift(4),Lt=!0),ve=G.read_shift(4),ge=G.read_shift(4)),ve!=te&&Dy(Lt,"Bad compressed size: "+te+" != "+ve),ge!=J&&Dy(Lt,"Bad uncompressed size: "+J+" != "+ge),jf(Q,ze,rt,{unsafe:!0,mt:Ne})}function yP(G,te){var J=te||{},Q=[],re=[],ne=we(1),me=J.compression?8:0,Ne=0,fe=0,ve=0,ge=0,ke=0,Fe=G.FullPaths[0],ze=Fe,Ce=G.FileIndex[0],Be=[],rt=0;for(fe=1;fe<G.FullPaths.length;++fe)if(ze=G.FullPaths[fe].slice(Fe.length),Ce=G.FileIndex[fe],!(!Ce.size||!Ce.content||ze=="Sh33tJ5")){var Lt=ge,Mt=we(ze.length);for(ve=0;ve<ze.length;++ve)Mt.write_shift(1,ze.charCodeAt(ve)&127);Mt=Mt.slice(0,Mt.l),Be[ke]=zZ.buf(Ce.content,0);var Lr=Ce.content;me==8&&(Lr=q(Lr)),ne=we(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,Ne),ne.write_shift(2,me),Ce.mt?s(ne,Ce.mt):ne.write_shift(4,0),ne.write_shift(-4,Be[ke]),ne.write_shift(4,Lr.length),ne.write_shift(4,Ce.content.length),ne.write_shift(2,Mt.length),ne.write_shift(2,0),ge+=ne.length,Q.push(ne),ge+=Mt.length,Q.push(Mt),ge+=Lr.length,Q.push(Lr),ne=we(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,Ne),ne.write_shift(2,me),ne.write_shift(4,0),ne.write_shift(-4,Be[ke]),ne.write_shift(4,Lr.length),ne.write_shift(4,Ce.content.length),ne.write_shift(2,Mt.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Lt),rt+=ne.l,re.push(ne),rt+=Mt.length,re.push(Mt),++ke}return ne=we(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,ke),ne.write_shift(2,ke),ne.write_shift(4,rt),ne.write_shift(4,ge),ne.write_shift(2,0),Er([Er(Q),Er(re),ne])}var Ac={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bP(G,te){if(G.ctype)return G.ctype;var J=G.name||"",Q=J.match(/\.([^\.]+)$/);return Q&&Ac[Q[1]]||te&&(Q=(J=te).match(/[\.\\]([^\.\\])+$/),Q&&Ac[Q[1]])?Ac[Q[1]]:"application/octet-stream"}function wP(G){for(var te=Il(G),J=[],Q=0;Q<te.length;Q+=76)J.push(te.slice(Q,Q+76));return J.join(`\r
`)+`\r
`}function jP(G){var te=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var ge=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],Q=te.split(`\r
`),re=0;re<Q.length;++re){var ne=Q[re];if(ne.length==0){J.push("");continue}for(var me=0;me<ne.length;){var Ne=76,fe=ne.slice(me,me+Ne);fe.charAt(Ne-1)=="="?Ne--:fe.charAt(Ne-2)=="="?Ne-=2:fe.charAt(Ne-3)=="="&&(Ne-=3),fe=ne.slice(me,me+Ne),me+=Ne,me<ne.length&&(fe+="="),J.push(fe)}}return J.join(`\r
`)}function NP(G){for(var te=[],J=0;J<G.length;++J){for(var Q=G[J];J<=G.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+G[++J];te.push(Q)}for(var re=0;re<te.length;++re)te[re]=te[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return kn(te.join(`\r
`))}function EP(G,te,J){for(var Q="",re="",ne="",me,Ne=0;Ne<10;++Ne){var fe=te[Ne];if(!fe||fe.match(/^\s*$/))break;var ve=fe.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":Q=ve[2].trim();break;case"content-type":ne=ve[2].trim();break;case"content-transfer-encoding":re=ve[2].trim();break}}switch(++Ne,re.toLowerCase()){case"base64":me=kn(Rn(te.slice(Ne).join("")));break;case"quoted-printable":me=NP(te.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var ge=jf(G,Q.slice(J.length),me,{unsafe:!0});ne&&(ge.ctype=ne)}function _P(G,te){if(B(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=te&&te.root||"",Q=(ot&&Buffer.isBuffer(G)?G.toString("binary"):B(G)).split(`\r
`),re=0,ne="";for(re=0;re<Q.length;++re)if(ne=Q[re],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),J||(J=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),ne.slice(0,J.length)!=J););var me=(Q[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Ne="--"+(me[1]||""),fe=[],ve=[],ge={FileIndex:fe,FullPaths:ve};E(ge);var ke,Fe=0;for(re=0;re<Q.length;++re){var ze=Q[re];ze!==Ne&&ze!==Ne+"--"||(Fe++&&EP(ge,Q.slice(ke,re),J),ke=re)}return ge}function SP(G,te){var J=te||{},Q=J.boundary||"SheetJS";Q="------="+Q;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ne=G.FullPaths[0],me=ne,Ne=G.FileIndex[0],fe=1;fe<G.FullPaths.length;++fe)if(me=G.FullPaths[fe].slice(ne.length),Ne=G.FileIndex[fe],!(!Ne.size||!Ne.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(rt){return"_x"+rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(rt){return"_u"+rt.charCodeAt(0).toString(16)+"_"});for(var ve=Ne.content,ge=ot&&Buffer.isBuffer(ve)?ve.toString("binary"):B(ve),ke=0,Fe=Math.min(1024,ge.length),ze=0,Ce=0;Ce<=Fe;++Ce)(ze=ge.charCodeAt(Ce))>=32&&ze<128&&++ke;var Be=ke>=Fe*4/5;re.push(Q),re.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+me),re.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),re.push("Content-Type: "+bP(Ne,me)),re.push(""),re.push(Be?jP(ge):wP(ge))}return re.push(Q+`--\r
`),re.join(`\r
`)}function TP(G){var te={};return E(te,G),te}function jf(G,te,J,Q){var re=Q&&Q.unsafe;re||E(G);var ne=!re&&Ge.find(G,te);if(!ne){var me=G.FullPaths[0];te.slice(0,me.length)==me?me=te:(me.slice(-1)!="/"&&(me+="/"),me=(me+te).replace("//","/")),ne={name:a(te),type:2},G.FileIndex.push(ne),G.FullPaths.push(me),re||Ge.utils.cfb_gc(G)}return ne.content=J,ne.size=J?J.length:0,Q&&(Q.CLSID&&(ne.clsid=Q.CLSID),Q.mt&&(ne.mt=Q.mt),Q.ct&&(ne.ct=Q.ct)),ne}function AP(G,te){E(G);var J=Ge.find(G,te);if(J){for(var Q=0;Q<G.FileIndex.length;++Q)if(G.FileIndex[Q]==J)return G.FileIndex.splice(Q,1),G.FullPaths.splice(Q,1),!0}return!1}function kP(G,te,J){E(G);var Q=Ge.find(G,te);if(Q){for(var re=0;re<G.FileIndex.length;++re)if(G.FileIndex[re]==Q)return G.FileIndex[re].name=a(J),G.FullPaths[re]=J,!0}return!1}function OP(G){O(G,!0)}return t.find=T,t.read=N,t.parse=u,t.write=W,t.writeFile=V,t.utils={cfb_new:TP,cfb_add:jf,cfb_del:AP,cfb_mov:kP,cfb_gc:OP,ReadShift:ll,CheckField:E4,prep_blob:Dr,bconcat:Er,use_zlib:D,_deflateRaw:Ve,_inflateRaw:Py,consts:H},t})();function UZ(e){return typeof e=="string"?of(e):Array.isArray(e)?mZ(e):e}function bc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=of(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Pa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([UZ(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=zs(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qZ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Jt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function xN(e,t){for(var r=[],n=Jt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function cf(e){for(var t=[],r=Jt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function uf(e){for(var t=[],r=Jt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function WZ(e){for(var t=[],r=Jt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var id=new Date(1899,11,30,0,0,0);function xr(e,t){var r=e.getTime(),n=id.getTime()+(e.getTimezoneOffset()-id.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var n4=new Date,HZ=id.getTime()+(n4.getTimezoneOffset()-id.getTimezoneOffset())*6e4,yN=n4.getTimezoneOffset();function df(e){var t=new Date;return t.setTime(e*24*60*60*1e3+HZ),t.getTimezoneOffset()!==yN&&t.setTime(t.getTime()+(t.getTimezoneOffset()-yN)*6e4),t}function VZ(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var bN=new Date("2017-02-19T19:06:09.000Z"),a4=isNaN(bN.getFullYear())?new Date("2/19/17"):bN,GZ=a4.getFullYear()==2017;function Ct(e,t){var r=new Date(e);if(GZ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(a4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ei(e,t){if(ot&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pa(HC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Pt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Pt(e[r]));return t}function Ht(e,t){for(var r="";r.length<t;)r+=e;return r}function va(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var KZ=["january","february","march","april","may","june","july","august","september","october","november","december"];function po(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&KZ.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var YZ=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}})();function s4(e){return e?e.content&&e.type?Ei(e.content,!0):e.data?el(e.data):e.asNodeBuffer&&ot?el(e.asNodeBuffer().toString("binary")):e.asBinary?el(e.asBinary()):e._data&&e._data.getContent?el(Ei(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function i4(e){if(!e)return null;if(e.data)return lN(e.data);if(e.asNodeBuffer&&ot)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?lN(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function XZ(e){return e&&e.name.slice(-4)===".bin"?i4(e):s4(e)}function Xn(e,t){for(var r=e.FullPaths||Jt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function H1(e,t){var r=Xn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ir(e,t,r){if(!r)return XZ(H1(e,t));if(!t)return null;try{return ir(e,t)}catch{return null}}function On(e,t,r){if(!r)return s4(H1(e,t));if(!t)return null;try{return On(e,t)}catch{return null}}function ZZ(e,t,r){return i4(H1(e,t))}function wN(e){for(var t=e.FullPaths||Jt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function st(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ot?n=ms(r):n=pZ(r),Ge.utils.cfb_add(e,t,n)}Ge.utils.cfb_add(e,t,r)}else e.file(t,r)}function V1(){return Ge.utils.cfb_new()}function o4(e,t){switch(t.type){case"base64":return Ge.read(e,{type:"base64"});case"binary":return Ge.read(e,{type:"binary"});case"buffer":case"array":return Ge.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function rl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,JZ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,jN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,QZ=/<[^>]*>/g,Zr=ar.match(jN)?jN:QZ,eJ=/<\w*:/,tJ=/<(\/?)\w+:/;function Je(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(JZ),l=0,c="",d=0,u="",f="",h=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+h,f.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var m=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[m]&&u.slice(l-3,l)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function Fa(e){return e.replace(tJ,"<$1")}var l4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},G1=cf(l4),dt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,c){return l4[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}})(),K1=/[&<>'"]/g,rJ=/[\u0000-\u0008\u000b-\u001f]/g;function wt(e){var t=e+"";return t.replace(K1,function(r){return G1[r]}).replace(rJ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function NN(e){return wt(e).replace(/ /g,"_x0020_")}var c4=/[\u0000-\u001f]/g;function Y1(e){var t=e+"";return t.replace(K1,function(r){return G1[r]}).replace(/\n/g,"<br/>").replace(c4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function nJ(e){var t=e+"";return t.replace(K1,function(r){return G1[r]}).replace(c4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var EN=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function aJ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function h0(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function _N(e){var t=Ds(2*e.length),r,n,a=1,s=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function SN(e){return ms(e,"binary").toString("utf8")}var Zc="foo bar baz",jt=ot&&(SN(Zc)==h0(Zc)&&SN||_N(Zc)==h0(Zc)&&_N)||h0,Pa=ot?function(e){return ms(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Fl=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),u4=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),sJ=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),iJ=/<\/?(?:vt:)?variant>/g,oJ=/<(?:vt:)([^>]*)>([\s\S]*)</;function TN(e,t){var r=Je(e),n=e.match(sJ(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(iJ,"").match(oJ);o&&a.push({v:jt(o[2]),t:o[1]})}),a}var d4=/(^\s|\s$|\n)/;function Ir(e,t){return"<"+e+(t.match(d4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ll(e){return Jt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,r){return"<"+e+(r!=null?Ll(r):"")+(t!=null?(t.match(d4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function yg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function lJ(e,t){switch(typeof e){case"string":var r=Pe("vt:lpwstr",wt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",wt(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",yg(e));throw new Error("Unable to serialize "+e)}function X1(e){if(ot&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return jt(zs(U1(e)));throw new Error("Bad input format: expected Buffer or string")}var Ml=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ii=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function cJ(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function uJ(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,o=n?-t:t;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var AN=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},kN=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ms(t)})):AN(e)}:AN,ON=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ha(e,a)));return n.join("").replace(on,"")},Z1=ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(on,""):ON(e,t,r)}:ON,CN=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},f4=ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):CN(e,t,r)}:CN,PN=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Hi(e,a)));return n.join("")},wc=ot?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):PN(t,r,n)}:PN,h4=function(e,t){var r=Tn(e,t);return r>0?wc(e,t+4,t+4+r-1):""},m4=h4,p4=function(e,t){var r=Tn(e,t);return r>0?wc(e,t+4,t+4+r-1):""},v4=p4,g4=function(e,t){var r=2*Tn(e,t);return r>0?wc(e,t+4,t+4+r-1):""},x4=g4,y4=function(t,r){var n=Tn(t,r);return n>0?Z1(t,r+4,r+4+n):""},b4=y4,w4=function(e,t){var r=Tn(e,t);return r>0?wc(e,t+4,t+4+r):""},j4=w4,N4=function(e,t){return cJ(e,t)},od=N4,J1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ot&&(m4=function(t,r){if(!Buffer.isBuffer(t))return h4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},v4=function(t,r){if(!Buffer.isBuffer(t))return p4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},x4=function(t,r){if(!Buffer.isBuffer(t))return g4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},b4=function(t,r){if(!Buffer.isBuffer(t))return y4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},j4=function(t,r){if(!Buffer.isBuffer(t))return w4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},od=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):N4(t,r)},J1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Hi=function(e,t){return e[t]},Ha=function(e,t){return e[t+1]*256+e[t]},dJ=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Tn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},fJ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ll(e,t){var r="",n,a,s=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,ot&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ha(this,d)),d+=2;e*=2;break;case"utf8":r=wc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Z1(this,this.l,this.l+e);break;case"wstr":return ll.call(this,e,"dbcs");case"lpstr-ansi":r=m4(this,this.l),e=4+Tn(this,this.l);break;case"lpstr-cp":r=v4(this,this.l),e=4+Tn(this,this.l);break;case"lpwstr":r=x4(this,this.l),e=4+2*Tn(this,this.l);break;case"lpp4":e=4+Tn(this,this.l),r=b4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Tn(this,this.l),r=j4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Hi(this,this.l+e++))!==0;)s.push(Xc(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Ha(this,this.l+e))!==0;)s.push(Xc(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Hi(this,d),this.l=d+1,l=ll.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Xc(Ha(this,d))),d+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Hi(this,d),this.l=d+1,l=ll.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Xc(Hi(this,d))),d+=1}r=s.join("");break;default:switch(e){case 1:return n=Hi(this,this.l),this.l++,n;case 2:return n=(t==="i"?dJ:Ha)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Zs:fJ)(this,this.l),this.l+=4,n):(a=Tn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=od(this,this.l):a=od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=f4(this,this.l,e);break}}return this.l+=e,r}var hJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},pJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function vJ(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)pJ(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,hJ(this,t,this.l);break;case 8:if(n=8,r==="f"){uJ(this,t,this.l);break}case 16:break;case-4:n=4,mJ(this,t,this.l);break}return this.l+=n,this}function E4(e,t){var r=f4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Dr(e,t){e.l=t,e.read_shift=ll,e.chk=E4,e.write_shift=vJ}function Xr(e,t){e.l+=t}function we(e){var t=Ds(e);return Dr(t,0),t}function ps(e,t,r){if(e){var n,a,s;Dr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=Wl[l]||Wl[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var u=d.f&&d.f(e,s,r);if(e.l=c,t(u,d,l))return}}}function vn(){var e=[],t=ot?256:2048,r=function(d){var u=we(d);return Dr(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},o=function(){return a(),Er(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Te(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Wl[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&J1(r)&&e.push(r)}}function cl(e,t,r){var n=Pt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function DN(e,t,r){var n=Pt(e);return n.s=cl(n.s,t.s,r),n.e=cl(n.e,t.s,r),n}function ul(e,t){if(e.cRel&&e.c<0)for(e=Pt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Pt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ze(e);return!e.cRel&&e.cRel!=null&&(r=yJ(r)),!e.rRel&&e.rRel!=null&&(r=gJ(r)),r}function m0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rr(e.s.r)+":"+(e.e.rRel?"":"$")+rr(e.e.r):ul(e.s,t.biff)+":"+ul(e.e,t.biff)}function Q1(e){return parseInt(xJ(e),10)-1}function rr(e){return""+(e+1)}function gJ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xJ(e){return e.replace(/\$(\d+)$/,"$1")}function ey(e){for(var t=bJ(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function yJ(e){return e.replace(/^([A-Z])/,"$$$1")}function bJ(e){return e.replace(/^\$([A-Z])/,"$1")}function wJ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ze(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yn(e){var t=e.indexOf(":");return t==-1?{s:zt(e),e:zt(e)}:{s:zt(e.slice(0,t)),e:zt(e.slice(t+1))}}function at(e,t){return typeof t>"u"||typeof t=="number"?at(e.s,e.e):(typeof e!="string"&&(e=Ze(e)),typeof t!="string"&&(t=Ze(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function IN(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=aa(e.z,r?xr(t):t)}catch{}try{return e.w=aa((e.XF||{}).numFmtId||(r?14:0),r?xr(t):t)}catch{return""+t}}function as(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?vs[e.v]||e.v:t==null?IN(e,e.v):IN(e,t))}function Us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function _4(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?zt(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=ft(s["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},p=o+f,v=l+h;if(d.s.r>p&&(d.s.r=p),d.s.c>v&&(d.s.c=v),d.e.r<p&&(d.e.r=p),d.e.c<v&&(d.e.c=v),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Xe[14],n.cellDates?(m.t="d",m.w=aa(m.z,xr(m.v))):(m.t="n",m.v=xr(m.v),m.w=aa(m.z,m.v))):m.t="s";if(a)s[p]||(s[p]=[]),s[p][v]&&s[p][v].z&&(m.z=s[p][v].z),s[p][v]=m;else{var g=Ze({c:v,r:p});s[g]&&s[g].z&&(m.z=s[g].z),s[g]=m}}}return d.s.c<1e7&&(s["!ref"]=at(d)),s}function Ro(e,t){return _4(null,e,t)}function jJ(e){return e.read_shift(4,"i")}function ga(e,t){return t||(t=we(4)),t.write_shift(4,e),t}function Kr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Sr(e,t){var r=!1;return t==null&&(r=!0,t=we(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function NJ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function EJ(e,t){return t||(t=we(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ty(e,t){var r=e.l,n=e.read_shift(1),a=Kr(e),s=[],o={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(NJ(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function _J(e,t){var r=!1;return t==null&&(r=!0,t=we(15+4*e.t.length)),t.write_shift(1,0),Sr(e.t,t),r?t.slice(0,t.l):t}var SJ=ty;function TJ(e,t){var r=!1;return t==null&&(r=!0,t=we(23+4*e.t.length)),t.write_shift(1,1),Sr(e.t,t),t.write_shift(4,1),EJ({},t),r?t.slice(0,t.l):t}function oa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ri(e,t){return t==null&&(t=we(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Fi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Li(e,t){return t==null&&(t=we(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var AJ=Kr,S4=Sr;function ry(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ld(e,t){var r=!1;return t==null&&(r=!0,t=we(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var kJ=Kr,bg=ry,ny=ld;function ay(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?od([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zs(t,0)>>2;return r?a/100:a}function T4(e,t){t==null&&(t=we(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function OJ(e,t){return t||(t=we(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Mi=A4,Fo=OJ;function Vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _i(e,t){return(t||we(8)).write_shift(8,e,"f")}function CJ(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=ci[a];d&&(t.rgb=$l(d));break;case 2:t.rgb=$l([o,l,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function cd(e,t){if(t||(t=we(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function PJ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DJ(e,t){t||(t=we(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function k4(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function IJ(e){return k4(e,1)}function RJ(e){return k4(e,2)}var sy=2,un=3,Jc=11,RN=12,ud=19,Qc=64,FJ=65,LJ=71,MJ=4108,BJ=4126,Nr=80,O4=81,$J=[Nr,O4],wg={1:{n:"CodePage",t:sy},2:{n:"Category",t:Nr},3:{n:"PresentationFormat",t:Nr},4:{n:"ByteCount",t:un},5:{n:"LineCount",t:un},6:{n:"ParagraphCount",t:un},7:{n:"SlideCount",t:un},8:{n:"NoteCount",t:un},9:{n:"HiddenCount",t:un},10:{n:"MultimediaClipCount",t:un},11:{n:"ScaleCrop",t:Jc},12:{n:"HeadingPairs",t:MJ},13:{n:"TitlesOfParts",t:BJ},14:{n:"Manager",t:Nr},15:{n:"Company",t:Nr},16:{n:"LinksUpToDate",t:Jc},17:{n:"CharacterCount",t:un},19:{n:"SharedDoc",t:Jc},22:{n:"HyperlinksChanged",t:Jc},23:{n:"AppVersion",t:un,p:"version"},24:{n:"DigSig",t:FJ},26:{n:"ContentType",t:Nr},27:{n:"ContentStatus",t:Nr},28:{n:"Language",t:Nr},29:{n:"Version",t:Nr},255:{},2147483648:{n:"Locale",t:ud},2147483651:{n:"Behavior",t:ud},1919054434:{}},jg={1:{n:"CodePage",t:sy},2:{n:"Title",t:Nr},3:{n:"Subject",t:Nr},4:{n:"Author",t:Nr},5:{n:"Keywords",t:Nr},6:{n:"Comments",t:Nr},7:{n:"Template",t:Nr},8:{n:"LastAuthor",t:Nr},9:{n:"RevNumber",t:Nr},10:{n:"EditTime",t:Qc},11:{n:"LastPrinted",t:Qc},12:{n:"CreatedDate",t:Qc},13:{n:"ModifiedDate",t:Qc},14:{n:"PageCount",t:un},15:{n:"WordCount",t:un},16:{n:"CharCount",t:un},17:{n:"Thumbnail",t:LJ},18:{n:"Application",t:Nr},19:{n:"DocSecurity",t:un},255:{},2147483648:{n:"Locale",t:ud},2147483651:{n:"Behavior",t:ud},1919054434:{}},FN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zJ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UJ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qJ=UJ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ci=Pt(qJ),vs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},C4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ng={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},eu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function iy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function WJ(e){var t=iy();if(!e||!e.match)return t;var r={};if((e.match(Zr)||[]).forEach(function(n){var a=Je(n);switch(a[0].replace(eJ,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Ng[a.ContentType]]!==void 0&&t[Ng[a.ContentType]].push(a.PartName);break}}),t.xmlns!==pr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function P4(e,t){var r=WZ(Ng),n=[],a;n[n.length]=ar,n[n.length]=Pe("Types",null,{xmlns:pr.CT,"xmlns:xsd":pr.xsd,"xmlns:xsi":pr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Pe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:eu[c][t.bookType]||eu[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Pe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:eu[c][t.bookType]||eu[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Pe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function dl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Zr)||[]).forEach(function(a){var s=Je(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:rl(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function Ji(e){var t=[ar,Pe("Relationships",null,{xmlns:pr.RELS})];return Jt(e["!id"]).forEach(function(r){t[t.length]=Pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[ct.HLINK,ct.XPATH,ct.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var HJ="application/vnd.oasis.opendocument.spreadsheet";function VJ(e,t){for(var r=X1(e),n,a;n=Ml.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Je(n[0],!1),a.path=="/"&&a.type!==HJ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function GJ(e){var t=[ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function LN(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function KJ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function YJ(e){var t=[ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(LN(e[r][0],e[r][1])),t.push(KJ("",e[r][0]));return t.push(LN("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function D4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rd.version+"</meta:generator></office:meta></office:document-meta>"}var ta=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],XJ=(function(){for(var e=new Array(ta.length),t=0;t<ta.length;++t){var r=ta[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function I4(e){var t={};e=jt(e);for(var r=0;r<ta.length;++r){var n=ta[r],a=e.match(XJ[r]);a!=null&&a.length>0&&(t[n[1]]=dt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ct(t[n[1]]))}return t}function p0(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=wt(t),n[n.length]=r?Pe(e,t,r):Ir(e,t))}function R4(e,t){var r=t||{},n=[ar,Pe("cp:coreProperties",null,{"xmlns:cp":pr.CORE_PROPS,"xmlns:dc":pr.dc,"xmlns:dcterms":pr.dcterms,"xmlns:dcmitype":pr.dcmitype,"xmlns:xsi":pr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&p0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:yg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&p0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:yg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=ta.length;++s){var o=ta[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&p0(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ui=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],F4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L4(e,t,r,n){var a=[];if(typeof e=="string")a=TN(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var o=typeof t=="string"?TN(t,n).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(c=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function ZJ(e,t,r){var n={};return t||(t={}),e=jt(e),ui.forEach(function(a){var s=(e.match(Fl(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=dt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&L4(n.HeadingPairs,n.TitlesOfParts,t,r),t}function M4(e){var t=[],r=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=ar,t[t.length]=Pe("Properties",null,{xmlns:pr.EXT_PROPS,"xmlns:vt":pr.vt}),ui.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=wt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+wt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var JJ=/<[^>]+>[^<]*/g;function QJ(e,t){var r={},n="",a=e.match(JJ);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Je(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=dt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=dt(u);break;case"bool":r[n]=kt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ct(u);break;case"cy":case"error":r[n]=dt(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function B4(e){var t=[ar,Pe("Properties",null,{xmlns:pr.CUST_PROPS,"xmlns:vt":pr.vt})];if(!e)return t.join("");var r=1;return Jt(e).forEach(function(a){++r,t[t.length]=Pe("property",lJ(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Eg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},v0;function eQ(e,t,r){v0||(v0=cf(Eg)),t=v0[t]||t,e[t]=r}function tQ(e,t){var r=[];return Jt(Eg).map(function(n){for(var a=0;a<ta.length;++a)if(ta[a][1]==n)return ta[a];for(a=0;a<ui.length;++a)if(ui[a][1]==n)return ui[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ir(Eg[n[1]]||n[1],a))}}),Pe("DocumentProperties",r.join(""),{xmlns:Sn.o})}function rQ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Jt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<ta.length;++o)if(s==ta[o][1])return;for(o=0;o<ui.length;++o)if(s==ui[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Pe(NN(s),l,{"dt:dt":c}))}}),t&&Jt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Pe(NN(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Sn.o+'">'+a.join("")+"</"+n+">"}function oy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function nQ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=we(8);return o.write_shift(4,n),o.write_shift(4,a),o}function $4(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function z4(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function U4(e,t,r){return t===31?z4(e):$4(e,t,r)}function _g(e,t,r){return U4(e,t,r===!1?0:4)}function aQ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return U4(e,t,0)}function sQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(on,""),e.l-a&2&&(e.l+=2)}return r}function iQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(on,"");return r}function oQ(e){var t=e.l,r=dd(e,O4);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=dd(e,un);return[r,n]}function lQ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(oQ(e));return r}function MN(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(on,"").replace(tl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function q4(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function cQ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function dd(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==RN&&n!==t&&$J.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===RN?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return $4(e,n,4).replace(on,"");case 31:return z4(e);case 64:return oy(e);case 65:return q4(e);case 71:return cQ(e);case 80:return _g(e,n,!s.raw).replace(on,"");case 81:return aQ(e,n).replace(on,"");case 4108:return lQ(e);case 4126:case 4127:return n==4127?sQ(e):iQ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function BN(e,t){var r=we(4),n=we(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=we(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=nQ(t);break;case 31:case 80:for(n=we(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Er([r,n])}function $N(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0,l=0,c=-1,d={};for(o=0;o!=a;++o){var u=e.read_shift(4),f=e.read_shift(4);s[o]=[u,f+r]}s.sort(function(b,y){return b[1]-y[1]});var h={};for(o=0;o!=a;++o){if(e.l!==s[o][1]){var m=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],m=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],m=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(m=!1,e.l=s[o][1]),m)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[s[o][0]];if(h[p.n]=dd(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(l=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[o][0]===1){if(l=h.CodePage=dd(e,sy),ma(l),c!==-1){var v=e.l;e.l=s[c][1],d=MN(e,l),e.l=v}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}d=MN(e,l)}else{var g=d[s[o][0]],x;switch(e[e.l]){case 65:e.l+=4,x=q4(e);break;case 30:e.l+=4,x=_g(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=_g(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=er(e,4);break;case 64:e.l+=4,x=Ct(oy(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=x}}return e.l=r+n,h}var W4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uQ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function zN(e,t,r){var n=we(8),a=[],s=[],o=8,l=0,c=we(8),d=we(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),s.push(c),a.push(d),o+=8+c.length,!t){d=we(8),d.write_shift(4,0),a.unshift(d);var u=[we(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=we(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Er(u),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(W4.indexOf(e[l][0])>-1||F4.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var p=r[m];if(p.p=="version"&&typeof h=="string"){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}c=BN(p.t,h)}else{var g=uQ(h);g==-1&&(g=31,h=String(h)),c=BN(g,h)}s.push(c),d=we(8),d.write_shift(4,t?m:2+l),a.push(d),o+=8+c.length}var x=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,x),x+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Er([n].concat(a).concat(s))}function UN(e,t,r){var n=e.content;if(!n)return{};Dr(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),u=n.read_shift(16);if(u!==Ge.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=$N(n,t),h={SystemIdentifier:d};for(var m in f)h[m]=f[m];if(h.FMTID=s,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=$N(n,null)}catch{}for(m in p)h[m]=p[m];return h.FMTID=[s,o],h}function qN(e,t,r,n,a,s){var o=we(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ge.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=zN(e,r,n);if(l.push(c),a){var d=zN(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Er(l)}function ys(e,t){return e.read_shift(t),null}function dQ(e,t){t||(t=we(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function fQ(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function er(e,t){return e.read_shift(t)===1}function tn(e,t){return t||(t=we(2)),t.write_shift(2,+!!e),t}function or(e){return e.read_shift(2,"u")}function Zn(e,t){return t||(t=we(2)),t.write_shift(2,e),t}function H4(e,t){return fQ(e,t,or)}function hQ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function V4(e,t,r){return r||(r=we(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function jc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function mQ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*o),n&&(e.l+=l),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function pQ(e){var t=e.t||"",r=we(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=we(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Er(a)}function Si(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Nc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Si(e,n,r)}function Bi(e,t,r){if(r.biff>5)return Nc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function G4(e,t,r){return r||(r=we(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function vQ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function gQ(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(on,"");return n&&(e.l+=24),a}function xQ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(on,"");return r+o}function yQ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gQ(e);case"0303000000000000c000000000000046":return xQ(e);default:throw new Error("Unsupported Moniker "+r)}}function tu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(on,""):"";return r}function WN(e,t){t||(t=we(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function bQ(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,o,l,c,d="",u,f;a&16&&(s=tu(e,r-e.l)),a&128&&(o=tu(e,r-e.l)),(a&257)===257&&(l=tu(e,r-e.l)),(a&257)===1&&(c=yQ(e,r-e.l)),a&8&&(d=tu(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=oy(e)),e.l=r;var h=o||l||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return u&&(m.guid=u),f&&(m.time=f),s&&(m.Tooltip=s),m}function wQ(e){var t=we(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),WN(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&WN(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function K4(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Y4(e,t){var r=K4(e);return r[3]=0,r}function La(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ti(e,t,r,n){return n||(n=we(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function jQ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function NQ(e,t,r){return t===0?"":Bi(e,t,r)}function EQ(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function X4(e){var t=e.read_shift(2),r=ay(e);return[t,r]}function _Q(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=jc(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ff(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Z4(e,t){return t||(t=we(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function J4(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var SQ=J4;function Q4(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function TQ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function AQ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Mr(e){e.l+=2,e.l+=e.read_shift(2)}var kQ={0:Mr,4:Mr,5:Mr,6:Mr,7:AQ,8:Mr,9:Mr,10:Mr,11:Mr,12:Mr,13:TQ,14:Mr,15:Mr,16:Mr,17:Mr,18:Mr,19:Mr,20:Mr,21:Q4};function OQ(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(kQ[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ru(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ly(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=we(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function CQ(e,t){return t===0||e.read_shift(2),1200}function PQ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Bi(e,0,r);return e.read_shift(t+n-e.l),a}function DQ(e,t){var r=!t||t.biff==8,n=we(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function IQ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function RQ(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=jc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function FQ(e,t){var r=!t||t.biff>=8?2:1,n=we(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function LQ(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0;o!=a&&e.l<r;++o)s.push(mQ(e));return s.Count=n,s.Unique=a,s}function MQ(e,t){var r=we(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=pQ(e[a]);var s=Er([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function BQ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function $Q(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function zQ(e){var t=jQ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function UQ(e){return e.read_shift(2),e.read_shift(4)}function HN(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function qQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function WQ(){var e=we(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function HQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function VQ(e){var t=we(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function GQ(){}function KQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=jc(e,0,r),n}function YQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=we(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function XQ(e){var t=La(e);return t.isst=e.read_shift(4),t}function ZQ(e,t,r,n){var a=we(10);return Ti(e,t,n,a),a.write_shift(4,r),a}function JQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=La(e);r.biff==2&&e.l++;var s=Nc(e,n-e.l,r);return a.val=s,a}function QQ(e,t,r,n,a){var s=!a||a.biff==8,o=we(8+ +s+(1+s)*r.length);return Ti(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function eee(e,t,r){var n=e.read_shift(2),a=Bi(e,0,r);return[n,a]}function tee(e,t,r,n){var a=r&&r.biff==5;n||(n=we(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var ree=Bi;function VN(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function nee(e,t){var r=t.biff==8||!t.biff?4:2,n=we(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function aee(e){var t=e.read_shift(2),r=e.read_shift(2),n=X4(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function see(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(X4(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function iee(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function oee(e,t,r,n){var a={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return a.patternType=zJ[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function lee(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=oee(e,t,n.fStyle,r),n}function GN(e,t,r,n){var a=r&&r.biff==5;n||(n=we(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function cee(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function uee(e){var t=we(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function KN(e,t,r){var n=La(e);(r.biff==2||t==9)&&++e.l;var a=hQ(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function dee(e,t,r,n,a,s){var o=we(8);return Ti(e,t,n,o),V4(r,s,o),o}function fee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=La(e),a=Vr(e);return n.val=a,n}function hee(e,t,r,n){var a=we(14);return Ti(e,t,n,a),_i(r,a),a}var YN=NQ;function mee(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Si(e,s),l=[];n>e.l;)l.push(Nc(e));return[s,a,o,l]}function XN(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=_Q(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var pee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ZN(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Si(e,o,r);a&32&&(d=pee[d.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||l===0||!(u>0)?[]:Oae(e,u,r,l);return{chKey:s,Name:d,itab:c,rgce:f}}function e5(e,t,r){if(r.biff<8)return vee(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(EQ(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function vee(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=jc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function gee(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Si(e,n,r),o=Si(e,a,r);return[s,o]}function xee(e,t,r){var n=J4(e);e.l++;var a=e.read_shift(1);return t-=8,[Cae(e,t,r),a,n]}function JN(e,t,r){var n=SQ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Aae(e,t,r)]}function yee(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function bee(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=Bi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,s]}}function wee(e,t,r){return bee(e,t,r)}function jee(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ff(e));return r}function Nee(e){var t=we(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Z4(e[r],t);return t}function Eee(e,t,r){if(r&&r.biff<8)return See(e,t,r);var n=Q4(e),a=OQ(e,t-22,n[1]);return{cmo:n,ft:a}}var _ee={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function See(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_ee[n]||Xr)(e,t,r)),{cmo:[a,n,s],ft:o}}function Tee(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=vQ(e,6,r);var l=e.read_shift(2);e.read_shift(2),or(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=Si(e,e.lens[d+1]-e.lens[d]-1);if(a+=f,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Aee(e,t){var r=ff(e);e.l+=16;var n=bQ(e,t-24);return[r,n]}function kee(e){var t=we(24),r=zt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Er([t,wQ(e[1])])}function Oee(e,t){e.read_shift(2);var r=ff(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(on,""),[r,n]}function Cee(e){var t=e[1].Tooltip,r=we(10+2*(t.length+1));r.write_shift(2,2048);var n=zt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Pee(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=FN[r]||r,r=e.read_shift(2),t[1]=FN[r]||r,t}function Dee(e){return e||(e=we(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Iee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y4(e));return r}function Ree(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y4(e));return r}function Fee(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function t5(e,t,r){if(!r.cellStyles)return Xr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function Lee(e,t){var r=we(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Mee(e,t){var r={};return t<32||(e.l+=16,r.header=Vr(e),r.footer=Vr(e),e.l+=2),r}function Bee(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function $ee(e){for(var t=we(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var zee=La,Uee=H4,qee=Nc;function Wee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Hee(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=La(e);++e.l;var a=Bi(e,t-7,r);return n.t="str",n.val=a,n}function Vee(e){var t=La(e);++e.l;var r=Vr(e);return t.t="n",t.val=r,t}function Gee(e,t,r){var n=we(15);return Tc(n,e,t),n.write_shift(8,r,"f"),n}function Kee(e){var t=La(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Yee(e,t,r){var n=we(9);return Tc(n,e,t),n.write_shift(2,r),n}function Xee(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Zee(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Jee(e,t,r){var n=e.l+t,a=La(e),s=e.read_shift(2),o=Si(e,s,r);return e.l=n,a.t="str",a.val=o,a}var Qee=[2,3,48,49,131,139,140,245],Sg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=cf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Ds(1);switch(c.type){case"base64":u=kn(Rn(l));break;case"binary":u=kn(l);break;case"buffer":case"array":u=l;break}Dr(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,g=521;f==2&&(v=u.read_shift(2)),u.l+=3,f!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(g=u.read_shift(2));var x=u.read_shift(2),b=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var y=[],w={},j=Math.min(u.length,f==2?521:g-10-(m?264:0)),N=p?32:11;u.l<j&&u[u.l]!=13;)switch(w={},w.name=Dl.utils.decode(b,u.slice(u.l,u.l+N)).replace(/[\u0000\r\n].*$/g,""),u.l+=N,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!p&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&y.push(w),f!=2&&(u.l+=p?13:14),w.type){case"B":(!m||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var E=0,S=0;for(d[0]=[],S=0;S!=y.length;++S)d[0][S]=y[S].name;for(;v-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,d[++E]=[],S=0,S=0;S!=y.length;++S){var O=u.slice(u.l,u.l+y[S].len);u.l+=y[S].len,Dr(O,0);var k=Dl.utils.decode(b,O);switch(y[S].type){case"C":k.trim().length&&(d[E][S]=k.replace(/\s+$/,""));break;case"D":k.length===8?d[E][S]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):d[E][S]=k;break;case"F":d[E][S]=parseFloat(k.trim());break;case"+":case"I":d[E][S]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":d[E][S]=!0;break;case"N":case"F":d[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[E][S]="##MEMO##"+(p?parseInt(k.trim(),10):O.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(d[E][S]=+k||0);break;case"@":d[E][S]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":d[E][S]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":d[E][S]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][S]=-O.read_shift(-8,"f");break;case"B":if(m&&y[S].len==8){d[E][S]=O.read_shift(8,"f");break}case"G":case"P":O.l+=y[S].len;break;case"0":if(y[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=Ro(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function a(l,c){try{return Us(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&ma(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=vn(),f=md(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),p=l["!cols"]||[],v=0,g=0,x=0,b=1;for(v=0;v<h.length;++v){if(((p[v]||{}).DBF||{}).name){h[v]=p[v].DBF.name,++x;continue}if(h[v]!=null){if(++x,typeof h[v]=="number"&&(h[v]=h[v].toString(10)),typeof h[v]!="string")throw new Error("DBF Invalid column name "+h[v]+" |"+typeof h[v]+"|");if(h.indexOf(h[v])!==v){for(g=0;g<1024;++g)if(h.indexOf(h[v]+"_"+g)==-1){h[v]+="_"+g;break}}}}var y=ft(l["!ref"]),w=[],j=[],N=[];for(v=0;v<=y.e.c-y.s.c;++v){var E="",S="",O=0,k=[];for(g=0;g<m.length;++g)m[g][v]!=null&&k.push(m[g][v]);if(k.length==0||h[v]==null){w[v]="?";continue}for(g=0;g<k.length;++g){switch(typeof k[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=k[g]instanceof Date?"D":"C";break;default:S="C"}O=Math.max(O,String(k[g]).length),E=E&&E!=S?"C":S}O>250&&(O=250),S=((p[v]||{}).DBF||{}).type,S=="C"&&p[v].DBF.len>O&&(O=p[v].DBF.len),E=="B"&&S=="N"&&(E="N",N[v]=p[v].DBF.dec,O=p[v].DBF.len),j[v]=E=="C"||S=="N"?O:s[E]||0,b+=j[v],w[v]=E}var T=u.next(32);for(T.write_shift(4,318902576),T.write_shift(4,m.length),T.write_shift(2,296+32*x),T.write_shift(2,b),v=0;v<4;++v)T.write_shift(4,0);for(T.write_shift(4,0|(+t[WC]||3)<<8),v=0,g=0;v<h.length;++v)if(h[v]!=null){var A=u.next(32),P=(h[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,P,"sbcs"),A.write_shift(1,w[v]=="?"?"C":w[v],"sbcs"),A.write_shift(4,g),A.write_shift(1,j[v]||s[w[v]]||0),A.write_shift(1,N[v]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=j[v]||s[w[v]]||0}var C=u.next(264);for(C.write_shift(4,13),v=0;v<65;++v)C.write_shift(4,0);for(v=0;v<m.length;++v){var F=u.next(b);for(F.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(w[g]){case"L":F.write_shift(1,m[v][g]==null?63:m[v][g]?84:70);break;case"B":F.write_shift(8,m[v][g]||0,"f");break;case"N":var M="0";for(typeof m[v][g]=="number"&&(M=m[v][g].toFixed(N[g]||0)),x=0;x<j[g]-M.length;++x)F.write_shift(1,32);F.write_shift(1,M,"sbcs");break;case"D":m[v][g]?(F.write_shift(4,("0000"+m[v][g].getFullYear()).slice(-4),"sbcs"),F.write_shift(2,("00"+(m[v][g].getMonth()+1)).slice(-2),"sbcs"),F.write_shift(2,("00"+m[v][g].getDate()).slice(-2),"sbcs")):F.write_shift(8,"00000000","sbcs");break;case"C":var H=String(m[v][g]!=null?m[v][g]:"").slice(0,j[g]);for(F.write_shift(1,H,"sbcs"),x=0;x<j[g]-H.length;++x)F.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),r5=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Jt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var p=e[m];return typeof p=="number"?cN(p):p},n=function(h,m,p){var v=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return v==59?h:cN(v)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return s(Rn(h),m);case"binary":return s(h,m);case"buffer":return s(ot&&Buffer.isBuffer(h)?h.toString("binary"):zs(h),m);case"array":return s(Ei(h),m)}throw new Error("Unrecognized type "+m.type)}function s(h,m){var p=h.split(/[\n\r]+/),v=-1,g=-1,x=0,b=0,y=[],w=[],j=null,N={},E=[],S=[],O=[],k=0,T;for(+m.codepage>=0&&ma(+m.codepage);x!==p.length;++x){k=0;var A=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),P=A.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),C=P[0],F;if(A.length>0)switch(C){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&w.push(A.slice(3).replace(/;;/g,";"));break;case"C":var M=!1,H=!1,V=!1,B=!1,W=-1,z=-1;for(b=1;b<P.length;++b)switch(P[b].charAt(0)){case"A":break;case"X":g=parseInt(P[b].slice(1))-1,H=!0;break;case"Y":for(v=parseInt(P[b].slice(1))-1,H||(g=0),T=y.length;T<=v;++T)y[T]=[];break;case"K":F=P[b].slice(1),F.charAt(0)==='"'?F=F.slice(1,F.length-1):F==="TRUE"?F=!0:F==="FALSE"?F=!1:isNaN(va(F))?isNaN(po(F).getDate())||(F=Ct(F)):(F=va(F),j!==null&&Do(j)&&(F=df(F))),M=!0;break;case"E":B=!0;var D=Qi(P[b].slice(1),{r:v,c:g});y[v][g]=[y[v][g],D];break;case"S":V=!0,y[v][g]=[y[v][g],"S5S"];break;case"G":break;case"R":W=parseInt(P[b].slice(1))-1;break;case"C":z=parseInt(P[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}if(M&&(y[v][g]&&y[v][g].length==2?y[v][g][0]=F:y[v][g]=F,j=null),V){if(B)throw new Error("SYLK shared formula cannot have own formula");var L=W>-1&&y[W][z];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");y[v][g][1]=b5(L[1],{r:v-W,c:g-z})}break;case"F":var q=0;for(b=1;b<P.length;++b)switch(P[b].charAt(0)){case"X":g=parseInt(P[b].slice(1))-1,++q;break;case"Y":for(v=parseInt(P[b].slice(1))-1,T=y.length;T<=v;++T)y[T]=[];break;case"M":k=parseInt(P[b].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(P[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=P[b].slice(1).split(" "),T=parseInt(O[0],10);T<=parseInt(O[1],10);++T)k=parseInt(O[2],10),S[T-1]=k===0?{hidden:!0}:{wch:k},Is(S[T-1]);break;case"C":g=parseInt(P[b].slice(1))-1,S[g]||(S[g]={});break;case"R":v=parseInt(P[b].slice(1))-1,E[v]||(E[v]={}),k>0?(E[v].hpt=k,E[v].hpx=go(k)):k===0&&(E[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}q<1&&(j=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}}return E.length>0&&(N["!rows"]=E),S.length>0&&(N["!cols"]=S),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,N]}function o(h,m){var p=a(h,m),v=p[0],g=p[1],x=Ro(v,m);return Jt(g).forEach(function(b){x[b]=g[b]}),x}function l(h,m){return Us(o(h,m),m)}function c(h,m,p,v){var g="C;Y"+(p+1)+";X"+(v+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+my(h.f,{r:p,c:v}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,m){m.forEach(function(p,v){var g="F;W"+(v+1)+" "+(v+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=zl(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ul(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,m){m.forEach(function(p,v){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*ql(p.hpx)+";"),g.length>2&&h.push(g+"R"+(v+1))})}function f(h,m){var p=["ID;PWXL;N;E"],v=[],g=ft(h["!ref"]),x,b=Array.isArray(h),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&d(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var j=g.s.c;j<=g.e.c;++j){var N=Ze({r:w,c:j});x=b?(h[w]||[])[j]:h[N],!(!x||x.v==null&&(!x.f||x.F))&&v.push(c(x,h,w,j))}return p.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:f}})(),n5=(function(){function e(s,o){switch(o.type){case"base64":return t(Rn(s),o);case"binary":return t(s,o);case"buffer":return t(ot&&Buffer.isBuffer(s)?s.toString("binary"):zs(s),o);case"array":return t(Ei(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=l[u].trim().split(","),m=h[0],p=h[1];++u;for(var v=l[u]||"";(v.match(/["]/g)||[]).length&1&&u<l.length-1;)v+=`
`+l[++u];switch(v=v.trim(),+m){case-1:if(v==="BOT"){f[++c]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[c][d]=!0:v==="FALSE"?f[c][d]=!1:isNaN(va(p))?isNaN(po(p).getDate())?f[c][d]=p:f[c][d]=Ct(p):f[c][d]=va(p),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[c][d++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return Ro(e(s,o),o)}function n(s,o){return Us(r(s,o),o)}var a=(function(){var s=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=ft(c["!ref"]),f,h=Array.isArray(c);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,u.e.r-u.s.r+1,""),s(d,"TUPLES",0,u.e.c-u.s.c+1,""),s(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){o(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var v=Ze({r:m,c:p});if(f=h?(c[m]||[])[p]:c[v],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=aa(f.z||Xe[14],xr(Ct(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var x=`\r
`,b=d.join(x);return b}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),a5=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),p=-1,v=-1,g=0,x=[];g!==m.length;++g){var b=m[g].trim().split(":");if(b[0]==="cell"){var y=zt(b[1]);if(x.length<=y.r)for(p=x.length;p<=y.r;++p)x[p]||(x[p]=[]);switch(p=y.r,v=y.c,b[2]){case"t":x[p][v]=e(b[3]);break;case"v":x[p][v]=+b[3];break;case"vtf":var w=b[b.length-1];case"vtc":switch(b[3]){case"nl":x[p][v]=!!+b[4];break;default:x[p][v]=+b[4];break}b[2]=="vtf"&&(x[p][v]=[x[p][v],w])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return Ro(r(f,h),h)}function a(f,h){return Us(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],p,v="",g=yn(f["!ref"]),x=Array.isArray(f),b=g.s.r;b<=g.e.r;++b)for(var y=g.s.c;y<=g.e.c;++y)if(v=Ze({r:b,c:y}),p=x?(f[b]||[])[y]:f[v],!(!p||p.v==null||p.t==="z")){switch(m=["cell",v,"t"],p.t){case"s":case"str":m.push(t(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=t(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=xr(Ct(p.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=p.w||aa(p.z||Xe[14],w);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,o,l,o,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}})(),vo=(function(){function e(u,f,h,m,p){p.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(va(u))?isNaN(po(u).getDate())?f[h][m]=u:f[h][m]=Ct(u):f[h][m]=va(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var p=u.split(/[\r\n]/),v=p.length-1;v>=0&&p[v].length===0;)--v;for(var g=10,x=0,b=0;b<=v;++b)x=p[b].indexOf(" "),x==-1?x=p[b].length:x++,g=Math.max(g,x);for(b=0;b<=v;++b){m[b]=[];var y=0;for(e(p[b].slice(0,g).trim(),m,b,y,h),y=1;y<=(p[b].length-g)/10+1;++y)e(p[b].slice(g+(y-1)*10,g+y*10).trim(),m,b,y,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},h=!1,m=0,p=0;m<u.length;++m)(p=u.charCodeAt(m))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(v,g){return v[0]-g[0]||n[v[1]]-n[g[1]]}),r[p.pop()[1]]||44}function s(u,f){var h=f||{},m="",p=h.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=a(u.slice(0,1024)):h&&h.FS?m=h.FS:m=a(u.slice(0,1024));var g=0,x=0,b=0,y=0,w=0,j=m.charCodeAt(0),N=!1,E=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=h.dateNF!=null?BZ(h.dateNF):null;function k(){var T=u.slice(y,w),A={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)A.t="z";else if(h.raw)A.t="s",A.v=T;else if(T.trim().length===0)A.t="s",A.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(A.t="s",A.v=T.slice(2,-1).replace(/""/g,'"')):mne(T)?(A.t="n",A.f=T.slice(1)):(A.t="s",A.v=T);else if(T=="TRUE")A.t="b",A.v=!0;else if(T=="FALSE")A.t="b",A.v=!1;else if(!isNaN(b=va(T)))A.t="n",h.cellText!==!1&&(A.w=T),A.v=b;else if(!isNaN(po(T).getDate())||O&&T.match(O)){A.z=h.dateNF||Xe[14];var P=0;O&&T.match(O)&&(T=$Z(T,h.dateNF,T.match(O)||[]),P=1),h.cellDates?(A.t="d",A.v=Ct(T,P)):(A.t="n",A.v=xr(Ct(T,P))),h.cellText!==!1&&(A.w=aa(A.z,A.v instanceof Date?xr(A.v):A.v)),h.cellNF||delete A.z}else A.t="s",A.v=T;if(A.t=="z"||(h.dense?(p[g]||(p[g]=[]),p[g][x]=A):p[Ze({c:x,r:g})]=A),y=w+1,S=u.charCodeAt(y),v.e.c<x&&(v.e.c=x),v.e.r<g&&(v.e.r=g),E==j)++x;else if(x=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;w<u.length;++w)switch(E=u.charCodeAt(w)){case 34:S===34&&(N=!N);break;case j:case 10:case 13:if(!N&&k())break e;break}return w-y>0&&k(),p["!ref"]=at(v),p}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Ro(t(u,f),f)}function l(u,f){var h="",m=f.type=="string"?[0,0,0,0]:jy(u,f);switch(f.type){case"base64":h=Rn(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Dl<"u"||(h=ot&&Buffer.isBuffer(u)?u.toString("binary"):zs(u));break;case"array":h=Ei(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=jt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=jt(h):f.type=="binary"&&typeof Dl<"u",h.slice(0,19)=="socialcalc:version:"?a5.to_sheet(f.type=="string"?h:jt(h),f):o(h,f)}function c(u,f){return Us(l(u,f),f)}function d(u){for(var f=[],h=ft(u["!ref"]),m,p=Array.isArray(u),v=h.s.r;v<=h.e.r;++v){for(var g=[],x=h.s.c;x<=h.e.c;++x){var b=Ze({r:v,c:x});if(m=p?(u[v]||[])[x]:u[b],!m||m.v==null){g.push("          ");continue}for(var y=(m.w||(as(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(x===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function ete(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=r5.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return vo.to_workbook(e,t)}}var di=(function(){function e(D,L,q){if(D){Dr(D,D.l||0);for(var I=q.Enum||W;D.l<D.length;){var R=D.read_shift(2),X=I[R]||I[65535],ae=D.read_shift(2),Z=D.l+ae,ee=X.f&&X.f(D,ae,q);if(D.l=Z,L(ee,X,R))return}}}function t(D,L){switch(L.type){case"base64":return r(kn(Rn(D)),L);case"binary":return r(kn(D),L);case"buffer":case"array":return r(D,L)}throw"Unsupported type "+L.type}function r(D,L){if(!D)return D;var q=L||{},I=q.dense?[]:{},R="Sheet1",X="",ae=0,Z={},ee=[],ie=[],U={s:{r:0,c:0},e:{r:0,c:0}},be=q.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)q.Enum=W,e(D,function(_e,he,ue){switch(ue){case 0:q.vers=_e,_e>=4096&&(q.qpro=!0);break;case 6:U=_e;break;case 204:_e&&(X=_e);break;case 222:X=_e;break;case 15:case 51:q.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:ue==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=q.dateNF||Xe[14],q.cellDates&&(_e[1].t="d",_e[1].v=df(_e[1].v))),q.qpro&&_e[3]>ae&&(I["!ref"]=at(U),Z[R]=I,ee.push(R),I=q.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ae=_e[3],R=X||"Sheet"+(ae+1),X="");var je=q.dense?(I[_e[0].r]||[])[_e[0].c]:I[Ze(_e[0])];if(je){je.t=_e[1].t,je.v=_e[1].v,_e[1].z!=null&&(je.z=_e[1].z),_e[1].f!=null&&(je.f=_e[1].f);break}q.dense?(I[_e[0].r]||(I[_e[0].r]=[]),I[_e[0].r][_e[0].c]=_e[1]):I[Ze(_e[0])]=_e[1];break}},q);else if(D[2]==26||D[2]==14)q.Enum=z,D[2]==14&&(q.qpro=!0,D.l=0),e(D,function(_e,he,ue){switch(ue){case 204:R=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>ae&&(I["!ref"]=at(U),Z[R]=I,ee.push(R),I=q.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ae=_e[3],R="Sheet"+(ae+1)),be>0&&_e[0].r>=be)break;q.dense?(I[_e[0].r]||(I[_e[0].r]=[]),I[_e[0].r][_e[0].c]=_e[1]):I[Ze(_e[0])]=_e[1],U.e.c<_e[0].c&&(U.e.c=_e[0].c),U.e.r<_e[0].r&&(U.e.r=_e[0].r);break;case 27:_e[14e3]&&(ie[_e[14e3][0]]=_e[14e3][1]);break;case 1537:ie[_e[0]]=_e[1],_e[0]==ae&&(R=_e[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(I["!ref"]=at(U),Z[X||R]=I,ee.push(X||R),!ie.length)return{SheetNames:ee,Sheets:Z};for(var Se={},Re=[],Le=0;Le<ie.length;++Le)Z[ee[Le]]?(Re.push(ie[Le]||ee[Le]),Se[ie[Le]]=Z[ie[Le]]||Z[ee[Le]]):(Re.push(ie[Le]),Se[ie[Le]]={"!ref":"A1"});return{SheetNames:Re,Sheets:Se}}function n(D,L){var q=L||{};if(+q.codepage>=0&&ma(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var I=vn(),R=ft(D["!ref"]),X=Array.isArray(D),ae=[];De(I,0,s(1030)),De(I,6,c(R));for(var Z=Math.min(R.e.r,8191),ee=R.s.r;ee<=Z;++ee)for(var ie=rr(ee),U=R.s.c;U<=R.e.c;++U){ee===R.s.r&&(ae[U]=$t(U));var be=ae[U]+ie,Se=X?(D[ee]||[])[U]:D[be];if(!(!Se||Se.t=="z"))if(Se.t=="n")(Se.v|0)==Se.v&&Se.v>=-32768&&Se.v<=32767?De(I,13,m(ee,U,Se.v)):De(I,14,v(ee,U,Se.v));else{var Re=as(Se);De(I,15,f(ee,U,Re.slice(0,239)))}}return De(I,1),I.end()}function a(D,L){var q=L||{};if(+q.codepage>=0&&ma(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var I=vn();De(I,0,o(D));for(var R=0,X=0;R<D.SheetNames.length;++R)(D.Sheets[D.SheetNames[R]]||{})["!ref"]&&De(I,27,B(D.SheetNames[R],X++));var ae=0;for(R=0;R<D.SheetNames.length;++R){var Z=D.Sheets[D.SheetNames[R]];if(!(!Z||!Z["!ref"])){for(var ee=ft(Z["!ref"]),ie=Array.isArray(Z),U=[],be=Math.min(ee.e.r,8191),Se=ee.s.r;Se<=be;++Se)for(var Re=rr(Se),Le=ee.s.c;Le<=ee.e.c;++Le){Se===ee.s.r&&(U[Le]=$t(Le));var _e=U[Le]+Re,he=ie?(Z[Se]||[])[Le]:Z[_e];if(!(!he||he.t=="z"))if(he.t=="n")De(I,23,k(Se,Le,ae,he.v));else{var ue=as(he);De(I,22,E(Se,Le,ae,ue.slice(0,239)))}}++ae}}return De(I,1),I.end()}function s(D){var L=we(2);return L.write_shift(2,D),L}function o(D){var L=we(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var q=0,I=0,R=0,X=0;X<D.SheetNames.length;++X){var ae=D.SheetNames[X],Z=D.Sheets[ae];if(!(!Z||!Z["!ref"])){++R;var ee=yn(Z["!ref"]);q<ee.e.r&&(q=ee.e.r),I<ee.e.c&&(I=ee.e.c)}}return q>8191&&(q=8191),L.write_shift(2,q),L.write_shift(1,R),L.write_shift(1,I),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(D,L,q){var I={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&q.qpro?(I.s.c=D.read_shift(1),D.l++,I.s.r=D.read_shift(2),I.e.c=D.read_shift(1),D.l++,I.e.r=D.read_shift(2),I):(I.s.c=D.read_shift(2),I.s.r=D.read_shift(2),L==12&&q.qpro&&(D.l+=2),I.e.c=D.read_shift(2),I.e.r=D.read_shift(2),L==12&&q.qpro&&(D.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function c(D){var L=we(8);return L.write_shift(2,D.s.c),L.write_shift(2,D.s.r),L.write_shift(2,D.e.c),L.write_shift(2,D.e.r),L}function d(D,L,q){var I=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(I[0].c=D.read_shift(1),I[3]=D.read_shift(1),I[0].r=D.read_shift(2),D.l+=2):(I[2]=D.read_shift(1),I[0].c=D.read_shift(2),I[0].r=D.read_shift(2)),I}function u(D,L,q){var I=D.l+L,R=d(D,L,q);if(R[1].t="s",q.vers==20768){D.l++;var X=D.read_shift(1);return R[1].v=D.read_shift(X,"utf8"),R}return q.qpro&&D.l++,R[1].v=D.read_shift(I-D.l,"cstr"),R}function f(D,L,q){var I=we(7+q.length);I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,D),I.write_shift(1,39);for(var R=0;R<I.length;++R){var X=q.charCodeAt(R);I.write_shift(1,X>=128?95:X)}return I.write_shift(1,0),I}function h(D,L,q){var I=d(D,L,q);return I[1].v=D.read_shift(2,"i"),I}function m(D,L,q){var I=we(7);return I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,D),I.write_shift(2,q,"i"),I}function p(D,L,q){var I=d(D,L,q);return I[1].v=D.read_shift(8,"f"),I}function v(D,L,q){var I=we(13);return I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,D),I.write_shift(8,q,"f"),I}function g(D,L,q){var I=D.l+L,R=d(D,L,q);if(R[1].v=D.read_shift(8,"f"),q.qpro)D.l=I;else{var X=D.read_shift(2);w(D.slice(D.l,D.l+X),R),D.l+=X}return R}function x(D,L,q){var I=L&32768;return L&=-32769,L=(I?D:0)+(L>=8192?L-16384:L),(I?"":"$")+(q?$t(L):rr(L))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(D,L){Dr(D,0);for(var q=[],I=0,R="",X="",ae="",Z="";D.l<D.length;){var ee=D[D.l++];switch(ee){case 0:q.push(D.read_shift(8,"f"));break;case 1:X=x(L[0].c,D.read_shift(2),!0),R=x(L[0].r,D.read_shift(2),!1),q.push(X+R);break;case 2:{var ie=x(L[0].c,D.read_shift(2),!0),U=x(L[0].r,D.read_shift(2),!1);X=x(L[0].c,D.read_shift(2),!0),R=x(L[0].r,D.read_shift(2),!1),q.push(ie+U+":"+X+R)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(D.read_shift(2));break;case 6:{for(var be="";ee=D[D.l++];)be+=String.fromCharCode(ee);q.push('"'+be.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Z=q.pop(),ae=q.pop(),q.push(["AND","OR"][ee-20]+"("+ae+","+Z+")");break;default:if(ee<32&&y[ee])Z=q.pop(),ae=q.pop(),q.push(ae+y[ee]+Z);else if(b[ee]){if(I=b[ee][1],I==69&&(I=D[D.l++]),I>q.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+q.join("|")+"|");return}var Se=q.slice(-I);q.length-=I,q.push(b[ee][0]+"("+Se.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}q.length==1?L[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function j(D){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=D.read_shift(2),L[3]=D[D.l++],L[0].c=D[D.l++],L}function N(D,L){var q=j(D);return q[1].t="s",q[1].v=D.read_shift(L-4,"cstr"),q}function E(D,L,q,I){var R=we(6+I.length);R.write_shift(2,D),R.write_shift(1,q),R.write_shift(1,L),R.write_shift(1,39);for(var X=0;X<I.length;++X){var ae=I.charCodeAt(X);R.write_shift(1,ae>=128?95:ae)}return R.write_shift(1,0),R}function S(D,L){var q=j(D);q[1].v=D.read_shift(2);var I=q[1].v>>1;if(q[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return q[1].v=I,q}function O(D,L){var q=j(D),I=D.read_shift(4),R=D.read_shift(4),X=D.read_shift(2);if(X==65535)return I===0&&R===3221225472?(q[1].t="e",q[1].v=15):I===0&&R===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ae=X&32768;return X=(X&32767)-16446,q[1].v=(1-ae*2)*(R*Math.pow(2,X+32)+I*Math.pow(2,X)),q}function k(D,L,q,I){var R=we(14);if(R.write_shift(2,D),R.write_shift(1,q),R.write_shift(1,L),I==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var X=0,ae=0,Z=0,ee=0;return I<0&&(X=1,I=-I),ae=Math.log2(I)|0,I/=Math.pow(2,ae-31),ee=I>>>0,(ee&2147483648)==0&&(I/=2,++ae,ee=I>>>0),I-=ee,ee|=2147483648,ee>>>=0,I*=Math.pow(2,32),Z=I>>>0,R.write_shift(4,Z),R.write_shift(4,ee),ae+=16383+(X?32768:0),R.write_shift(2,ae),R}function T(D,L){var q=O(D);return D.l+=L-14,q}function A(D,L){var q=j(D),I=D.read_shift(4);return q[1].v=I>>6,q}function P(D,L){var q=j(D),I=D.read_shift(8,"f");return q[1].v=I,q}function C(D,L){var q=P(D);return D.l+=L-10,q}function F(D,L){return D[D.l+L-1]==0?D.read_shift(L,"cstr"):""}function M(D,L){var q=D[D.l++];q>L-1&&(q=L-1);for(var I="";I.length<q;)I+=String.fromCharCode(D[D.l++]);return I}function H(D,L,q){if(!(!q.qpro||L<21)){var I=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var R=D.read_shift(L-21,"cstr");return[I,R]}}function V(D,L){for(var q={},I=D.l+L;D.l<I;){var R=D.read_shift(2);if(R==14e3){for(q[R]=[0,""],q[R][0]=D.read_shift(2);D[D.l];)q[R][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return q}function B(D,L){var q=we(5+D.length);q.write_shift(2,14e3),q.write_shift(2,L);for(var I=0;I<D.length;++I){var R=D.charCodeAt(I);q[q.l++]=R>127?95:R}return q[q.l++]=0,q}var W={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:F},222:{n:"SHEETNAMELP",f:M},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:C},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:F},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function tte(e){var t={},r=e.match(Zr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Je(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=B1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var rte=(function(){var e=Fl("t"),t=Fl("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:dt(o[1])},c=s.match(t);return c&&(l.s=tte(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}})(),nte=(function(){var t=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),ate=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ste=/<(?:\w+:)?r>/,ite=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cy(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=dt(jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=jt(e),r&&(n.h=Y1(n.t))):e.match(ste)&&(n.r=jt(e),n.t=dt(jt((e.replace(ite,"").match(ate)||[]).join("").replace(Zr,""))),r&&(n.h=nte(rte(n.r)))),n):{t:""}}var ote=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,lte=/<(?:\w+:)?(?:si|sstItem)>/g,cte=/<\/(?:\w+:)?(?:si|sstItem)>/;function ute(e,t){var r=[],n="";if(!e)return r;var a=e.match(ote);if(a){n=a[2].replace(lte,"").split(cte);for(var s=0;s!=n.length;++s){var o=cy(n[s].trim(),t);o!=null&&(r[r.length]=o)}a=Je(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var dte=/^\s|\s$|[\t\n\r]/;function s5(e,t){if(!t.bookSST)return"";var r=[ar];r[r.length]=Pe("sst",null,{xmlns:Ii[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(dte)&&(s+=' xml:space="preserve"'),s+=">"+wt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function fte(e){return[e.read_shift(4),e.read_shift(4)]}function hte(e,t){var r=[],n=!1;return ps(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function mte(e,t){return t||(t=we(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var pte=_J;function vte(e){var t=vn();Te(t,159,mte(e));for(var r=0;r<e.length;++r)Te(t,19,pte(e[r]));return Te(t,160),t.end()}function i5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Za(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function gte(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Za(e,4),t.U=Za(e,4),t.W=Za(e,4),t}function xte(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function yte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(xte(e));return t}function bte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function wte(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Za(e,4),t.U=Za(e,4),t.W=Za(e,4),t}function jte(e){var t=wte(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function o5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function l5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Nte(e){var t=Za(e);switch(t.Minor){case 2:return[t.Minor,Ete(e)];case 3:return[t.Minor,_te()];case 4:return[t.Minor,Ste(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Ete(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=o5(e,r),a=l5(e,e.length-e.l);return{t:"Std",h:n,v:a}}function _te(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ste(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Zr,function(s){var o=Je(s);switch(Fa(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Tte(e,t){var r={},n=r.EncryptionVersionInfo=Za(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=o5(e,a),t-=a,r.EncryptionVerifier=l5(e,t),r}function Ate(e){var t={},r=t.EncryptionVersionInfo=Za(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function uy(e){var t=0,r,n=i5(e),a=n.length+1,s,o,l,c,d;for(r=Ds(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var c5=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=i5(o),c=s(l),d=l.length,u=Ds(16),f=0;f!=16;++f)u[f]=0;var h,m,p;for((d&1)===1&&(h=c>>8,u[d]=a(e[0],h),--d,h=c&255,m=l[l.length-1],u[d]=a(m,h));d>0;)--d,h=c>>8,u[d]=a(l[d],h),--d,h=c&255,u[d]=a(l[d],h);for(d=15,p=15-l.length;p>0;)h=c>>8,u[d]=a(e[p],h),--d,--p,h=c&255,u[d]=a(l[d],h),--d,--p;return u}})(),kte=function(e,t,r,n,a){a||(a=t),n||(n=c5(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},Ote=function(e){var t=0,r=c5(e);return function(n){var a=kte("",n,t,r);return t=a[1],a[0]}};function Cte(e,t,r,n){var a={key:or(e),verificationBytes:or(e)};return r.password&&(a.verifier=uy(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Ote(r.password)),a}function Pte(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Ate(e):n.Data=Tte(e,t),n}function Dte(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Pte(e,t-2,n):Cte(e,r.biff>=8?t:t-2,r,n),n}var u5=(function(){function e(a,s){switch(s.type){case"base64":return t(Rn(a),s);case"binary":return t(a,s);case"buffer":return t(ot&&Buffer.isBuffer(a)?a.toString("binary"):zs(a),s);case"array":return t(Ei(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,p,v=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(m,h.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++v,g.length){var x={v:g,t:"s"};Array.isArray(l)?l[f][v]=x:l[Ze({r:f,c:v})]=x}break}m=h.lastIndex}v>d.e.c&&(d.e.c=v)}),l["!ref"]=at(d),l}function r(a,s){return Us(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=ft(a["!ref"]),l,c=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Ze({r:d,c:u});l=c?(a[d]||[])[u]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(as(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Ite(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function $l(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Rte(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),o=a-s;if(o===0)return[0,0,t];var l=0,c=0,d=a+s;switch(c=o/(d>1?2-d:d),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,d/2]}function Fte(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function fd(e,t){if(t===0)return e;var r=Rte(Ite(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),$l(Fte(r))}var d5=6,Lte=15,Mte=1,Wr=d5;function zl(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function Ul(e){return Math.floor((e-5)/Wr*100+.5)/100}function hd(e){return Math.round((e*Wr+5)/Wr*256)/256}function g0(e){return hd(Ul(zl(e)))}function dy(e){var t=Math.abs(e-g0(e)),r=Wr;if(t>.005)for(Wr=Mte;Wr<Lte;++Wr)Math.abs(e-g0(e))<=t&&(t=Math.abs(e-g0(e)),r=Wr);Wr=r}function Is(e){e.width?(e.wpx=zl(e.width),e.wch=Ul(e.wpx),e.MDW=Wr):e.wpx?(e.wch=Ul(e.wpx),e.width=hd(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=hd(e.wch),e.wpx=zl(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var Bte=96,f5=Bte;function ql(e){return e*96/f5}function go(e){return e*f5/96}var $te={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zte(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Je(o);switch(Fa(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=kt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=kt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function Ute(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Je(o);switch(Fa(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function qte(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Je(o);switch(Fa(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=jt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?kt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?kt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?kt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?kt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?kt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?kt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?kt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=B1[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=kt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=ci[a.color.index];a.color.index==81&&(c=ci[1]),c||(c=ci[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=fd(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Wte(e,t,r){t.NumberFmt=[];for(var n=Jt(Xe),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Xe[n[a]];var s=e[0].match(Zr);if(s)for(a=0;a<s.length;++a){var o=Je(s[a]);switch(Fa(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=dt(jt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Xa(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Hte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:n,formatCode:wt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var nu=["numFmtId","fillId","fontId","borderId","xfId"],au=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Vte(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Zr)||[]).forEach(function(s){var o=Je(s),l=0;switch(Fa(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<nu.length;++l)n[nu[l]]&&(n[nu[l]]=parseInt(n[nu[l]],10));for(l=0;l<au.length;++l)n[au[l]]&&(n[au[l]]=kt(n[au[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=kt(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Gte(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(r){t[t.length]=Pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Kte=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&Wte(f,u,d),(f=l.match(a))&&qte(f,u,c,d),(f=l.match(n))&&Ute(f,u,c,d),(f=l.match(s))&&zte(f,u,c,d),(f=l.match(r))&&Vte(f,u,d),u}})();function h5(e,t){var r=[ar,Pe("styleSheet",null,{xmlns:Ii[0],"xmlns:vt":pr.vt})],n;return e.SSF&&(n=Hte(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Gte(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Yte(e,t){var r=e.read_shift(2),n=Kr(e);return[r,n]}function Xte(e,t,r){r||(r=we(6+4*t.length)),r.write_shift(2,e),Sr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Zte(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=PJ(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=CJ(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Kr(e),n}function Jte(e,t){t||(t=we(153)),t.write_shift(2,e.sz*20),DJ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),cd(e.color,t);var n=0;return n=2,t.write_shift(1,n),Sr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Qte=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],x0,ere=Xr;function QN(e,t){t||(t=we(84)),x0||(x0=cf(Qte));var r=x0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(cd({auto:1},t),cd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function tre(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function m5(e,t,r){r||(r=we(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zo(e,t){return t||(t=we(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var rre=Xr;function nre(e,t){return t||(t=we(51)),t.write_shift(1,0),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),t.length>t.l?t.slice(0,t.l):t}function are(e,t){return t||(t=we(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ld(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function sre(e,t,r){var n=we(2052);return n.write_shift(4,e),ld(t,n),ld(r,n),n.length>n.l?n.slice(0,n.l):n}function ire(e,t,r){var n={};n.NumberFmt=[];for(var a in Xe)n.NumberFmt[a]=Xe[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ps(e,function(c,d,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Xa(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=fd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(d.T>0)s.push(u);else if(d.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function ore(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Te(e,615,ga(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Te(e,44,Xte(a,t[a]))}),Te(e,616))}}function lre(e){var t=1;Te(e,611,ga(t)),Te(e,43,Jte({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(e,612)}function cre(e){var t=2;Te(e,603,ga(t)),Te(e,45,QN({patternType:"none"})),Te(e,45,QN({patternType:"gray125"})),Te(e,604)}function ure(e){var t=1;Te(e,613,ga(t)),Te(e,46,nre()),Te(e,614)}function dre(e){var t=1;Te(e,626,ga(t)),Te(e,47,m5({numFmtId:0},65535)),Te(e,627)}function fre(e,t){Te(e,617,ga(t.length)),t.forEach(function(r){Te(e,47,m5(r,0))}),Te(e,618)}function hre(e){var t=1;Te(e,619,ga(t)),Te(e,48,are({xfId:0,name:"Normal"})),Te(e,620)}function mre(e){var t=0;Te(e,505,ga(t)),Te(e,506)}function pre(e){var t=0;Te(e,508,sre(t,"TableStyleMedium9","PivotStyleMedium4")),Te(e,509)}function vre(e,t){var r=vn();return Te(r,278),ore(r,e.SSF),lre(r),cre(r),ure(r),dre(r),fre(r,t.cellXfs),hre(r),mre(r),pre(r),Te(r,279),r.end()}var gre=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xre(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Zr)||[]).forEach(function(a){var s=Je(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[gre.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function yre(){}function bre(){}var wre=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jre=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Nre=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ere(e,t,r){t.themeElements={};var n;[["clrScheme",wre,xre],["fontScheme",jre,yre],["fmtScheme",Nre,bre]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var _re=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function p5(e,t){(!e||e.length===0)&&(e=fy());var r,n={};if(!(r=e.match(_re)))throw new Error("themeElements not found in theme");return Ere(r[0],n,t),n.raw=e,n}function fy(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Sre(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=o4(s,{type:"array"})}catch{return}var l=On(o,"theme/theme/theme1.xml",!0);if(l)return p5(l,r)}}function Tre(e){return e.read_shift(4)}function Are(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=kre(e,4);break;case 2:t.xclrValue=K4(e);break;case 3:t.xclrValue=Tre(e);break;case 4:e.l+=4;break}return e.l+=8,t}function kre(e,t){return Xr(e,t)}function Ore(e,t){return Xr(e,t)}function Cre(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Are(e);break;case 6:n[1]=Ore(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Pre(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Cre(e,r-e.l));return{ixfe:n,ext:s}}function Dre(e,t){t.forEach(function(r){r[0]})}function Ire(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Kr(e)}}function Rre(e){var t=we(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Sr(e.name,t),t.slice(0,t.l)}function Fre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Lre(e){var t=we(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Mre(e,t){var r=we(8+2*t.length);return r.write_shift(4,e),Sr(t,r),r.slice(0,r.l)}function Bre(e){return e.l+=4,e.read_shift(4)!=0}function $re(e,t){var r=we(8);return r.write_shift(4,e),r.write_shift(4,1),r}function zre(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return ps(e,function(c,d,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Ure(){var e=vn();return Te(e,332),Te(e,334,ga(1)),Te(e,335,Rre({name:"XLDAPR",version:12e4,flags:3496657072})),Te(e,336),Te(e,339,Mre(1,"XLDAPR")),Te(e,52),Te(e,35,ga(514)),Te(e,4096,ga(0)),Te(e,4097,Zn(1)),Te(e,36),Te(e,53),Te(e,340),Te(e,337,$re(1)),Te(e,51,Lre([[1,0]])),Te(e,338),Te(e,333),e.end()}function qre(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,o;return e.replace(Zr,function(l){var c=Je(l);switch(Fa(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function v5(){var e=[ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Wre(e){var t=[];if(!e)return t;var r=1;return(e.match(Zr)||[]).forEach(function(n){var a=Je(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Hre(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ze(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Vre(e,t,r){var n=[];return ps(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Gre(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ps(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function Kre(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gi=1024;function g5(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Pe("xml",null,{"xmlns:v":Sn.v,"xmlns:o":Sn.o,"xmlns:x":Sn.x,"xmlns:mv":Sn.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gi<e*1e3;)Gi+=1e3;return t.forEach(function(s){var o=zt(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Pe("v:fill",c,l),u={on:"t",obscured:"t"};++Gi,a=a.concat(["<v:shape"+Ll({id:"_x0000_s"+Gi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Pe("v:shadow",null,u),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ir("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ir("x:AutoFill","False"),Ir("x:Row",String(o.r)),Ir("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function eE(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(o){var l=zt(o.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[o.ref]=s;var c=ft(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=at(c);d!==e["!ref"]&&(e["!ref"]=d)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function Yre(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Je(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=zt(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&cy(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),n.push(d)}}}}),n}function x5(e){var t=[ar,Pe("comments",null,{xmlns:Ii[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=wt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(wt(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Ir("t",wt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(Ir("t",wt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Xre(e,t){var r=[],n=!1,a={},s=0;return e.replace(Zr,function(l,c){var d=Je(l);switch(Fa(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function Zre(e,t,r){var n=[ar,Pe("ThreadedComments",null,{xmlns:pr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Pe("threadedComment",Ir("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Jre(e,t){var r=[],n=!1;return e.replace(Zr,function(s){var o=Je(s);switch(Fa(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function Qre(e){var t=[ar,Pe("personList",null,{xmlns:pr.TCMNT,"xmlns:x":Ii[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ene(e){var t={};t.iauthor=e.read_shift(4);var r=Mi(e);return t.rfx=r.s,t.ref=Ze(r.s),e.l+=16,t}function tne(e,t){return t==null&&(t=we(36)),t.write_shift(4,e[1].iauthor),Fo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var rne=Kr;function nne(e){return Sr(e.slice(0,54))}function ane(e,t){var r=[],n=[],a={},s=!1;return ps(e,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function sne(e){var t=vn(),r=[];return Te(t,628),Te(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Te(t,632,nne(a.a)))})}),Te(t,631),Te(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:zt(n[0]),e:zt(n[0])};Te(t,635,tne([s,a])),a.t&&a.t.length>0&&Te(t,637,TJ(a)),Te(t,636),delete a.iauthor})}),Te(t,634),Te(t,629),t.end()}var ine="application/vnd.ms-office.vbaProject";function one(e){var t=Ge.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ge.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ge.write(t)}function lne(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ge.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var y5=["xlsb","xlsm","xlam","biff8","xla"];function cne(){return{"!type":"dialog"}}function une(){return{"!type":"dialog"}}function dne(){return{"!type":"macro"}}function fne(){return{"!type":"macro"}}var Qi=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,a+(l?"":"$")+$t(u)+(c?"":"$")+rr(d)}return function(a,s){return t=s,a.replace(e,r)}})(),hy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,my=(function(){return function(t,r){return t.replace(hy,function(n,a,s,o,l,c){var d=ey(o)-(s?0:r.c),u=Q1(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=d==0?"":s?d+1:"["+d+"]";return a+"R"+f+"C"+h})}})();function b5(e,t){return e.replace(hy,function(r,n,a,s,o,l){return n+(a=="$"?a+s:$t(ey(s)+t.c))+(o=="$"?o+l:rr(Q1(l)+t.r))})}function hne(e,t,r){var n=yn(t),a=n.s,s=zt(r),o={r:s.r-a.r,c:s.c-a.c};return b5(e,o)}function mne(e){return e.length!=1}function tE(e){return e.replace(/_xlfn\./g,"")}function sr(e){e.l+=1}function Rs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function w5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return j5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=Rs(e),l=Rs(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function j5(e){var t=Rs(e),r=Rs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function pne(e,t,r){if(r.biff<8)return j5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Rs(e),o=Rs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function N5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return vne(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Rs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function vne(e){var t=Rs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function gne(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function xne(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return yne(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function yne(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function bne(e,t,r){var n=(e[e.l++]&96)>>5,a=w5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function wne(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=w5(e,s,r);return[n,a,o]}function jne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Nne(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Ene(e,t,r){var n=(e[e.l++]&96)>>5,a=pne(e,t-1,r);return[n,a]}function _ne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function rE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Sne(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Tne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ane(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kne(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function One(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function E5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Cne(e){return e.read_shift(2),E5(e)}function Pne(e){return e.read_shift(2),E5(e)}function Dne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=N5(e,0,r);return[n,a]}function Ine(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=xne(e,0,r);return[n,a]}function Rne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=N5(e,0,r);return[n,a,s]}function Fne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Bae[a],T5[a],n]}function Lne(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Mne(e);return[a,(s[0]===0?T5:Mae)[s[1]]]}function Mne(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Bne(e,t,r){e.l+=r&&r.biff==2?3:4}function $ne(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function zne(e){return e.l++,vs[e.read_shift(1)]}function Une(e){return e.l++,e.read_shift(2)}function qne(e){return e.l++,e.read_shift(1)!==0}function Wne(e){return e.l++,Vr(e)}function Hne(e,t,r){return e.l++,jc(e,t-1,r)}function Vne(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=er(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=vs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vr(e);break;case 2:r[1]=Bi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Gne(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Mi:ff)(e));return a}function Kne(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=Vne(e,r.biff);return o}function Yne(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Xne(e,t,r){if(r.biff==5)return Zne(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Zne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Jne(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Qne(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function eae(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function tae(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var rae=Xr,nae=Xr,aae=Xr;function Ec(e,t,r){return e.l+=2,[gne(e)]}function py(e){return e.l+=6,[]}var sae=Ec,iae=py,oae=py,lae=Ec;function _5(e){return e.l+=2,[or(e),e.read_shift(2)&1]}var cae=Ec,uae=_5,dae=py,fae=Ec,hae=Ec,mae=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pae(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=mae[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:s}}function vae(e){return e.l+=2,[e.read_shift(4)]}function gae(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function xae(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function yae(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bae(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wae(e){return e.l+=4,[0,0]}var nE={1:{n:"PtgExp",f:$ne},2:{n:"PtgTbl",f:aae},3:{n:"PtgAdd",f:sr},4:{n:"PtgSub",f:sr},5:{n:"PtgMul",f:sr},6:{n:"PtgDiv",f:sr},7:{n:"PtgPower",f:sr},8:{n:"PtgConcat",f:sr},9:{n:"PtgLt",f:sr},10:{n:"PtgLe",f:sr},11:{n:"PtgEq",f:sr},12:{n:"PtgGe",f:sr},13:{n:"PtgGt",f:sr},14:{n:"PtgNe",f:sr},15:{n:"PtgIsect",f:sr},16:{n:"PtgUnion",f:sr},17:{n:"PtgRange",f:sr},18:{n:"PtgUplus",f:sr},19:{n:"PtgUminus",f:sr},20:{n:"PtgPercent",f:sr},21:{n:"PtgParen",f:sr},22:{n:"PtgMissArg",f:sr},23:{n:"PtgStr",f:Hne},26:{n:"PtgSheet",f:gae},27:{n:"PtgEndSheet",f:xae},28:{n:"PtgErr",f:zne},29:{n:"PtgBool",f:qne},30:{n:"PtgInt",f:Une},31:{n:"PtgNum",f:Wne},32:{n:"PtgArray",f:_ne},33:{n:"PtgFunc",f:Fne},34:{n:"PtgFuncVar",f:Lne},35:{n:"PtgName",f:Yne},36:{n:"PtgRef",f:Dne},37:{n:"PtgArea",f:bne},38:{n:"PtgMemArea",f:Jne},39:{n:"PtgMemErr",f:rae},40:{n:"PtgMemNoMem",f:nae},41:{n:"PtgMemFunc",f:Qne},42:{n:"PtgRefErr",f:eae},43:{n:"PtgAreaErr",f:jne},44:{n:"PtgRefN",f:Ine},45:{n:"PtgAreaN",f:Ene},46:{n:"PtgMemAreaN",f:yae},47:{n:"PtgMemNoMemN",f:bae},57:{n:"PtgNameX",f:Xne},58:{n:"PtgRef3d",f:Rne},59:{n:"PtgArea3d",f:wne},60:{n:"PtgRefErr3d",f:tae},61:{n:"PtgAreaErr3d",f:Nne},255:{}},jae={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Nae={1:{n:"PtgElfLel",f:_5},2:{n:"PtgElfRw",f:fae},3:{n:"PtgElfCol",f:sae},6:{n:"PtgElfRwV",f:hae},7:{n:"PtgElfColV",f:lae},10:{n:"PtgElfRadical",f:cae},11:{n:"PtgElfRadicalS",f:dae},13:{n:"PtgElfColS",f:iae},15:{n:"PtgElfColSV",f:oae},16:{n:"PtgElfRadicalLel",f:uae},25:{n:"PtgList",f:pae},29:{n:"PtgSxName",f:vae},255:{}},Eae={0:{n:"PtgAttrNoop",f:wae},1:{n:"PtgAttrSemi",f:One},2:{n:"PtgAttrIf",f:Ane},4:{n:"PtgAttrChoose",f:Sne},8:{n:"PtgAttrGoto",f:Tne},16:{n:"PtgAttrSum",f:Bne},32:{n:"PtgAttrBaxcel",f:rE},33:{n:"PtgAttrBaxcel",f:rE},64:{n:"PtgAttrSpace",f:Cne},65:{n:"PtgAttrSpaceSemi",f:Pne},128:{n:"PtgAttrIfError",f:kne},255:{}};function _c(e,t,r,n){if(n.biff<8)return Xr(e,t);for(var a=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Kne(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Gne(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&s.push(Xr(e,t)),s}function Sc(e,t,r){for(var n=e.l+t,a,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],a=nE[s]||nE[jae[s]],(s===24||s===25)&&(a=(s===24?Nae:Eae)[e[e.l+1]]),!a||!a.f?Xr(e,t):o.push([a.n,a.f(e,t,r)]);return o}function _ae(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Sae={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tae(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function S5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function aE(e,t,r){var n=S5(e,t,r);return n=="#REF"?n:Tae(n,r)}function Ur(e,t,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,h=0,m,p="";if(!e[0]||!e[0][0])return"";for(var v=-1,g="",x=0,b=e[0].length;x<b;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),v>=0){switch(e[0][v][1][0]){case 0:g=Ht(" ",e[0][v][1][1]);break;case 1:g=Ht("\r",e[0][v][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}d=d+g,v=-1}l.push(d+Sae[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=cl(y[1][1],o,a),l.push(ul(u,s));break;case"PtgRefN":u=r?cl(y[1][1],r,a):y[1][1],l.push(ul(u,s));break;case"PtgRef3d":f=y[1][1],u=cl(y[1][2],o,a),p=aE(n,f,a),l.push(p+"!"+ul(u,s));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],j=y[1][1];w||(w=0),w&=127;var N=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=N.shift()),l.push(j+"("+N.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=DN(y[1][1],r?{s:r}:o,a),l.push(m0(m,a));break;case"PtgArea":m=DN(y[1][1],o,a),l.push(m0(m,a));break;case"PtgArea3d":f=y[1][1],m=y[1][2],p=aE(n,f,a),l.push(p+"!"+m0(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],S=E?E.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var O=y[1][1];h=y[1][2];var k;if(a.biff<=5)O<0&&(O=-O),n[O]&&(k=n[O][h]);else{var T="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][h]&&n[O][h].itab>0&&(T=n.SheetNames[n[O][h].itab-1]+"!"):T=n.SheetNames[h-1]+"!"),n[O]&&n[O][h])T+=n[O][h].Name;else if(n[0]&&n[0][h])T+=n[0][h].Name;else{var A=(S5(n,O,a)||"").split(";;");A[h-1]?T=A[h-1]:T+="SH33TJSERRX"}l.push(T);break}k||(k={Name:"SH33TJSERRY"}),l.push(k.Name);break;case"PtgParen":var P="(",C=")";if(v>=0){switch(g="",e[0][v][1][0]){case 2:P=Ht(" ",e[0][v][1][1])+P;break;case 3:P=Ht("\r",e[0][v][1][1])+P;break;case 4:C=Ht(" ",e[0][v][1][1])+C;break;case 5:C=Ht("\r",e[0][v][1][1])+C;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}l.push(P+l.pop()+C);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var F={c:r.c,r:r.r};if(n.sharedf[Ze(u)]){var M=n.sharedf[Ze(u)];l.push(Ur(M,o,F,n,a))}else{var H=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Ur(d[1],o,F,n,a)),H=!0;break}H||l.push(y[1])}break;case"PtgArray":l.push("{"+_ae(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&v>=0&&V.indexOf(e[0][x][0])==-1){y=e[0][v];var B=!0;switch(y[1][0]){case 4:B=!1;case 0:g=Ht(" ",y[1][1]);break;case 5:B=!1;case 1:g=Ht("\r",y[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((B?g:"")+l.pop()+(B?"":g)),v=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function Aae(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Xr(e,t-2)];var l=Sc(e,o,r);return t!==o+a&&(s=_c(e,t-o-a,l,r)),e.l=n,[l,s]}function kae(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Xr(e,t-2)];var l=Sc(e,o,r);return t!==o+a&&(s=_c(e,t-o-a,l,r)),e.l=n,[l,s]}function Oae(e,t,r,n){var a=e.l+t,s=Sc(e,n,r),o;return a!==e.l&&(o=_c(e,a-e.l,s,r)),[s,o]}function Cae(e,t,r){var n=e.l+t,a,s=e.read_shift(2),o=Sc(e,s,r);return s==65535?[[],Xr(e,t-2)]:(t!==s+2&&(a=_c(e,n-s-2,o,r)),[o,a])}function Pae(e){var t;if(Ha(e,e.l+6)!==65535)return[Vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Dae(e){if(e==null){var t=we(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _i(e);return _i(0)}function y0(e,t,r){var n=e.l+t,a=La(e);r.biff==2&&++e.l;var s=Pae(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=kae(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Iae(e,t,r,n,a){var s=Ti(t,r,a),o=Dae(e.v),l=we(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=we(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Er([s,o,l,d]);return f}function hf(e,t,r){var n=e.read_shift(4),a=Sc(e,n,r),s=e.read_shift(4),o=s>0?_c(e,s,a,r):null;return[a,o]}var Rae=hf,mf=hf,Fae=hf,Lae=hf,Mae={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},T5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Bae={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function $ae(e){var t="of:="+e.replace(hy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function b0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function zae(e){return e.replace(/\./,"!")}var fl={},eo={},hl=typeof Map<"u";function vy(e,t,r){var n=0,a=e.length;if(r){if(hl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=hl?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(hl?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function pf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Wr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ul(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=hd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function fi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function qs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Xa(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function A5(e,t,r,n,a,s){try{n.cellNF&&(e.z=Xe[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ct(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Xe[t]==null&&Xa(MZ[t]||"General",t),e.t==="e")e.w=e.w||vs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rl(e.v);else if(e.t==="d"){var o=xr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Rl(o)}else{if(e.v===void 0)return"";e.w=Ni(e.v,eo)}else e.t==="d"?e.w=aa(t,xr(e.v),eo):e.w=aa(t,e.v,eo)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function Uae(e,t,r){if(e&&e["!ref"]){var n=ft(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qae(e,t){var r=ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=at(r))}var Wae=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Hae=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Vae=/<(?:\w:)?hyperlink [^>]*>/mg,Gae=/"(\w*:\w*)"/,Kae=/<(?:\w:)?col\b[^>]*[\/]?>/g,Yae=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Xae=/<(?:\w:)?pageMargins[^>]*\/>/g,k5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Zae=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Jae=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Qae(e,t,r,n,a,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(Hae);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(k5);h?gy(h[0],l,a,r):(h=d.match(Zae))&&tse(h[0],h[1]||"",l,a,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var p=d.slice(m,m+50).match(Gae);p&&qae(l,p[1])}var v=d.match(Jae);v&&v[1]&&mse(v[1],a);var g=[];if(t.cellStyles){var x=d.match(Kae);x&&cse(g,x)}f&&gse(f[1],l,t,c,s,o);var b=u.match(Yae);b&&(l["!autofilter"]=dse(b[0]));var y=[],w=u.match(Wae);if(w)for(m=0;m!=w.length;++m)y[m]=ft(w[m].slice(w[m].indexOf('"')+1));var j=u.match(Vae);j&&ise(l,j,n);var N=u.match(Xae);if(N&&(l["!margins"]=ose(Je(N[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=at(c)),t.sheetRows>0&&l["!ref"]){var E=ft(l["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=at(E))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function ese(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+at(e[r])+'"/>';return t+"</mergeCells>"}function gy(e,t,r,n){var a=Je(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=dt(jt(a.codeName)))}function tse(e,t,r,n,a){gy(e.slice(0,e.indexOf(">")),r,n,a)}function rse(e,t,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Pa(wt(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Pe("outlinePr",null,d)}!s&&!l||(a[a.length]=Pe("sheetPr",l,o))}var nse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ase=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function sse(e){var t={sheet:1};return nse.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ase.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=uy(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function ise(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Je(jt(t[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+dt(s.location))):(s.Target="#"+dt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=ft(s.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Ze({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function ose(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function lse(e){return fi(e),Pe("pageMargins",null,e)}function cse(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Je(t[n],!0);a.hidden&&(a.hidden=kt(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,dy(a.width)),Is(a);s<=o;)e[s++]=Pt(a)}}function use(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Pe("col",null,pf(a,n)));return r[r.length]="</cols>",r.join("")}function dse(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function fse(e,t,r,n){var a=typeof e.ref=="string"?e.ref:at(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=yn(a);o.s.r==o.e.r&&(o.e.r=yn(t["!ref"]).e.r,a=at(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Pe("autoFilter",null,{ref:a})}var hse=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mse(e,t){t.Views||(t.Views=[{}]),(e.match(hse)||[]).forEach(function(r,n){var a=Je(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),kt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function pse(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,a),{})}function vse(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=vs[e.v];break;case"d":n&&n.cellDates?a=Ct(e.v,-1).toISOString():(e=Pt(e),e.t="n",a=""+(e.v=xr(Ct(e.v)))),typeof e.z>"u"&&(e.z=Xe[14]);break;default:a=e.v;break}var l=Ir("v",wt(a)),c={r:t},d=qs(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ir("v",""+vy(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Pe("f",wt(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Pe("c",l,c)}var gse=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Fl("v"),o=Fl("f");return function(c,d,u,f,h,m){for(var p=0,v="",g=[],x=[],b=0,y=0,w=0,j="",N,E,S=0,O=0,k,T,A=0,P=0,C=Array.isArray(m.CellXf),F,M=[],H=[],V=Array.isArray(d),B=[],W={},z=!1,D=!!u.sheetStubs,L=c.split(t),q=0,I=L.length;q!=I;++q){v=L[q].trim();var R=v.length;if(R!==0){var X=0;e:for(p=0;p<R;++p)switch(v[p]){case">":if(v[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(E=Je(v.slice(X,p),!0),S=E.r!=null?parseInt(E.r,10):S+1,O=-1,u.sheetRows&&u.sheetRows<S)continue;W={},z=!1,E.ht&&(z=!0,W.hpt=parseFloat(E.ht),W.hpx=go(W.hpt)),E.hidden=="1"&&(z=!0,W.hidden=!0),E.outlineLevel!=null&&(z=!0,W.level=+E.outlineLevel),z&&(B[S-1]=W)}break;case"<":X=p;break}if(X>=p)break;if(E=Je(v.slice(X,p),!0),S=E.r!=null?parseInt(E.r,10):S+1,O=-1,!(u.sheetRows&&u.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),u&&u.cellStyles&&(W={},z=!1,E.ht&&(z=!0,W.hpt=parseFloat(E.ht),W.hpx=go(W.hpt)),E.hidden=="1"&&(z=!0,W.hidden=!0),E.outlineLevel!=null&&(z=!0,W.level=+E.outlineLevel),z&&(B[S-1]=W)),g=v.slice(p).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),p=0;p!=g.length;++p)if(v=g[p].trim(),v.length!==0){if(x=v.match(r),b=p,y=0,w=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,x!=null&&x.length===2){for(b=0,j=x[1],y=0;y!=j.length&&!((w=j.charCodeAt(y)-64)<1||w>26);++y)b=26*b+w;--b,O=b}else++O;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,E=Je(v.slice(0,y),!0),E.r||(E.r=Ze({r:S-1,c:O})),j=v.slice(y),N={t:""},(x=j.match(s))!=null&&x[1]!==""&&(N.v=dt(x[1])),u.cellFormula){if((x=j.match(o))!=null&&x[1]!==""){if(N.f=dt(jt(x[1])).replace(/\r\n/g,`
`),u.xlfn||(N.f=tE(N.f)),x[0].indexOf('t="array"')>-1)N.F=(j.match(a)||[])[1],N.F.indexOf(":")>-1&&M.push([ft(N.F),N.F]);else if(x[0].indexOf('t="shared"')>-1){T=Je(x[0]);var Z=dt(jt(x[1]));u.xlfn||(Z=tE(Z)),H[parseInt(T.si,10)]=[T,Z,E.r]}}else(x=j.match(/<f[^>]*\/>/))&&(T=Je(x[0]),H[T.si]&&(N.f=hne(H[T.si][1],H[T.si][2],E.r)));var ee=zt(E.r);for(y=0;y<M.length;++y)ee.r>=M[y][0].s.r&&ee.r<=M[y][0].e.r&&ee.c>=M[y][0].s.c&&ee.c<=M[y][0].e.c&&(N.F=M[y][1])}if(E.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(D)N.t="z";else continue;else N.t=E.t||"n";switch(f.s.c>O&&(f.s.c=O),f.e.c<O&&(f.e.c=O),N.t){case"n":if(N.v==""||N.v==null){if(!D)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!D)continue;N.t="z"}else k=fl[parseInt(N.v,10)],N.v=k.t,N.r=k.r,u.cellHTML&&(N.h=k.h);break;case"str":N.t="s",N.v=N.v!=null?jt(N.v):"",u.cellHTML&&(N.h=Y1(N.v));break;case"inlineStr":x=j.match(n),N.t="s",x!=null&&(k=cy(x[1]))?(N.v=k.t,u.cellHTML&&(N.h=k.h)):N.v="";break;case"b":N.v=kt(N.v);break;case"d":u.cellDates?N.v=Ct(N.v,1):(N.v=xr(Ct(N.v,1)),N.t="n");break;case"e":(!u||u.cellText!==!1)&&(N.w=N.v),N.v=C4[N.v];break}if(A=P=0,F=null,C&&E.s!==void 0&&(F=m.CellXf[E.s],F!=null&&(F.numFmtId!=null&&(A=F.numFmtId),u.cellStyles&&F.fillId!=null&&(P=F.fillId))),A5(N,A,P,u,h,m),u.cellDates&&C&&N.t=="n"&&Do(Xe[A])&&(N.t="d",N.v=df(N.v)),E.cm&&u.xlmeta){var ie=(u.xlmeta.Cell||[])[+E.cm-1];ie&&ie.type=="XLDAPR"&&(N.D=!0)}if(V){var U=zt(E.r);d[U.r]||(d[U.r]=[]),d[U.r][U.c]=N}else d[E.r]=N}}}}B.length>0&&(d["!rows"]=B)}})();function xse(e,t,r,n){var a=[],s=[],o=ft(e["!ref"]),l="",c,d="",u=[],f=0,h=0,m=e["!rows"],p=Array.isArray(e),v={r:d},g,x=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=$t(h);for(f=o.s.r;f<=o.e.r;++f){for(s=[],d=rr(f),h=o.s.c;h<=o.e.c;++h){c=u[h]+d;var b=p?(e[f]||[])[h]:e[c];b!==void 0&&(l=vse(b,c,e,t))!=null&&s.push(l)}(s.length>0||m&&m[f])&&(v={r:d},m&&m[f]&&(g=m[f],g.hidden&&(v.hidden=1),x=-1,g.hpx?x=ql(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(v.ht=x,v.customHeight=1),g.level&&(v.outlineLevel=g.level)),a[a.length]=Pe("row",s.join(""),v))}if(m)for(;f<m.length;++f)m&&m[f]&&(v={r:f+1},g=m[f],g.hidden&&(v.hidden=1),x=-1,g.hpx?x=ql(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(v.ht=x,v.customHeight=1),g.level&&(v.outlineLevel=g.level),a[a.length]=Pe("row","",v));return a.join("")}function O5(e,t,r,n){var a=[ar,Pe("worksheet",null,{xmlns:Ii[0],"xmlns:r":pr.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var d=c["!ref"]||"A1",u=ft(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=at(u)}n||(n={}),c["!comments"]=[];var f=[];rse(c,r,e,t,a),a[a.length]=Pe("dimension",null,{ref:d}),a[a.length]=pse(c,t,e,r),t.sheetFormat&&(a[a.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=use(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=xse(c,t),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=sse(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=fse(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=ese(c["!merges"]));var h=-1,m,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(p=yt(n,-1,wt(v[1].Target).replace(/#.*$/,""),ct.HLINK),m["r:id"]="rId"+p),(h=v[1].Target.indexOf("#"))>-1&&(m.location=wt(v[1].Target.slice(h+1))),v[1].Tooltip&&(m.tooltip=wt(v[1].Tooltip)),a[a.length]=Pe("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=lse(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ir("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(p=yt(n,-1,"../drawings/drawing"+(e+1)+".xml",ct.DRAW),a[a.length]=Pe("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ct.VML),a[a.length]=Pe("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function yse(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function bse(e,t,r){var n=we(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=ql(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Ze(d)];p&&(f<0&&(f=m),h=m)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var v=n.l;return n.l=c,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function wse(e,t,r,n){var a=bse(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Te(e,0,a)}var jse=Mi,Nse=Fo;function Ese(){}function _se(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=AJ(e),r}function Sse(e,t,r){r==null&&(r=we(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return cd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),S4(e,r),r.slice(0,r.l)}function Tse(e){var t=oa(e);return[t]}function Ase(e,t,r){return r==null&&(r=we(8)),Ri(t,r)}function kse(e){var t=Fi(e);return[t]}function Ose(e,t,r){return r==null&&(r=we(4)),Li(t,r)}function Cse(e){var t=oa(e),r=e.read_shift(1);return[t,r,"b"]}function Pse(e,t,r){return r==null&&(r=we(9)),Ri(t,r),r.write_shift(1,e.v?1:0),r}function Dse(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"b"]}function Ise(e,t,r){return r==null&&(r=we(5)),Li(t,r),r.write_shift(1,e.v?1:0),r}function Rse(e){var t=oa(e),r=e.read_shift(1);return[t,r,"e"]}function Fse(e,t,r){return r==null&&(r=we(9)),Ri(t,r),r.write_shift(1,e.v),r}function Lse(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"e"]}function Mse(e,t,r){return r==null&&(r=we(8)),Li(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Bse(e){var t=oa(e),r=e.read_shift(4);return[t,r,"s"]}function $se(e,t,r){return r==null&&(r=we(12)),Ri(t,r),r.write_shift(4,t.v),r}function zse(e){var t=Fi(e),r=e.read_shift(4);return[t,r,"s"]}function Use(e,t,r){return r==null&&(r=we(8)),Li(t,r),r.write_shift(4,t.v),r}function qse(e){var t=oa(e),r=Vr(e);return[t,r,"n"]}function Wse(e,t,r){return r==null&&(r=we(16)),Ri(t,r),_i(e.v,r),r}function C5(e){var t=Fi(e),r=Vr(e);return[t,r,"n"]}function Hse(e,t,r){return r==null&&(r=we(12)),Li(t,r),_i(e.v,r),r}function Vse(e){var t=oa(e),r=ay(e);return[t,r,"n"]}function Gse(e,t,r){return r==null&&(r=we(12)),Ri(t,r),T4(e.v,r),r}function Kse(e){var t=Fi(e),r=ay(e);return[t,r,"n"]}function Yse(e,t,r){return r==null&&(r=we(8)),Li(t,r),T4(e.v,r),r}function Xse(e){var t=oa(e),r=ty(e);return[t,r,"is"]}function Zse(e){var t=oa(e),r=Kr(e);return[t,r,"str"]}function Jse(e,t,r){return r==null&&(r=we(12+4*e.v.length)),Ri(t,r),Sr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Qse(e){var t=Fi(e),r=Kr(e);return[t,r,"str"]}function eie(e,t,r){return r==null&&(r=we(8+4*e.v.length)),Li(t,r),Sr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function tie(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=mf(e,n-e.l,r);o[3]=Ur(l,null,a,r.supbooks,r)}else e.l=n;return o}function rie(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=mf(e,n-e.l,r);o[3]=Ur(l,null,a,r.supbooks,r)}else e.l=n;return o}function nie(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var s=Vr(e),o=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=mf(e,n-e.l,r);o[3]=Ur(l,null,a,r.supbooks,r)}else e.l=n;return o}function aie(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var s=Kr(e),o=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=mf(e,n-e.l,r);o[3]=Ur(l,null,a,r.supbooks,r)}else e.l=n;return o}var sie=Mi,iie=Fo;function oie(e,t){return t==null&&(t=we(4)),t.write_shift(4,e),t}function lie(e,t){var r=e.l+t,n=Mi(e),a=ry(e),s=Kr(e),o=Kr(e),l=Kr(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function cie(e,t){var r=we(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Fo({s:zt(e[0]),e:zt(e[0])},r),ny("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Sr(a||"",r),Sr(e[1].Tooltip||"",r),Sr("",r),r.slice(0,r.l)}function uie(){}function die(e,t,r){var n=e.l+t,a=A4(e),s=e.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=Rae(e,n-e.l,r);o[1]=l}else e.l=n;return o}function fie(e,t,r){var n=e.l+t,a=Mi(e),s=[a];if(r.cellFormula){var o=Lae(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function hie(e,t,r){r==null&&(r=we(18));var n=pf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var P5=["left","right","top","bottom","header","footer"];function mie(e){var t={};return P5.forEach(function(r){t[r]=Vr(e)}),t}function pie(e,t){return t==null&&(t=we(48)),fi(e),P5.forEach(function(r){_i(e[r],t)}),t}function vie(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gie(e,t,r){r==null&&(r=we(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function xie(e){var t=we(24);return t.write_shift(4,4),t.write_shift(4,1),Fo(e,t),t}function yie(e,t){return t==null&&(t=we(66)),t.write_shift(2,e.password?uy(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function bie(){}function wie(){}function jie(e,t,r,n,a,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,p,v,g,x,b,y,w,j,N=[];l.biff=12,l["!row"]=0;var E=0,S=!1,O=[],k={},T=l.supbooks||a.supbooks||[[]];if(T.sharedf=k,T.arrayf=O,T.SheetNames=a.SheetNames||a.Sheets.map(function(V){return V.name}),!l.supbooks&&(l.supbooks=T,a.Names))for(var A=0;A<a.Names.length;++A)T[0][A+1]=a.Names[A];var P=[],C=[],F=!1;Wl[16]={n:"BrtShortReal",f:C5};var M;if(ps(e,function(B,W,z){if(!h)switch(z){case 148:d=B;break;case 0:m=B,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),w=rr(g=m.r),l["!row"]=m.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=go(B.hpt)),C[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:B[2]},B[2]){case"n":p.v=B[1];break;case"s":y=fl[B[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!B[1];break;case"e":p.v=B[1],l.cellText!==!1&&(p.w=vs[p.v]);break;case"str":p.t="s",p.v=B[1];break;case"is":p.t="s",p.v=B[1].t;break}if((v=o.CellXf[B[0].iStyleRef])&&A5(p,v.numFmtId,null,l,s,o),x=B[0].c==-1?x+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=p):c[$t(x)+w]=p,l.cellFormula){for(S=!1,E=0;E<O.length;++E){var D=O[E];m.r>=D[0].s.r&&m.r<=D[0].e.r&&x>=D[0].s.c&&x<=D[0].e.c&&(p.F=at(D[0]),S=!0)}!S&&B.length>3&&(p.f=B[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>x&&(u.s.c=x),u.e.r<m.r&&(u.e.r=m.r),u.e.c<x&&(u.e.c=x),l.cellDates&&v&&p.t=="n"&&Do(Xe[v.numFmtId])){var L=ni(p.v);L&&(p.t="d",p.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}M&&(M.type=="XLDAPR"&&(p.D=!0),M=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;p={t:"z",v:void 0},x=B[0].c==-1?x+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=p):c[$t(x)+w]=p,u.s.r>m.r&&(u.s.r=m.r),u.s.c>x&&(u.s.c=x),u.e.r<m.r&&(u.e.r=m.r),u.e.c<x&&(u.e.c=x),M&&(M.type=="XLDAPR"&&(p.D=!0),M=void 0);break;case 176:N.push(B);break;case 49:M=((l.xlmeta||{}).Cell||[])[B-1];break;case 494:var q=n["!id"][B.relId];for(q?(B.Target=q.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=q):B.relId==""&&(B.Target="#"+B.loc),g=B.rfx.s.r;g<=B.rfx.e.r;++g)for(x=B.rfx.s.c;x<=B.rfx.e.c;++x)l.dense?(c[g]||(c[g]=[]),c[g][x]||(c[g][x]={t:"z",v:void 0}),c[g][x].l=B):(b=Ze({c:x,r:g}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=B);break;case 426:if(!l.cellFormula)break;O.push(B),j=l.dense?c[g][x]:c[$t(x)+w],j.f=Ur(B[1],u,{r:m.r,c:x},T,l),j.F=at(B[0]);break;case 427:if(!l.cellFormula)break;k[Ze(B[0].s)]=B[1],j=l.dense?c[g][x]:c[$t(x)+w],j.f=Ur(B[1],u,{r:m.r,c:x},T,l);break;case 60:if(!l.cellStyles)break;for(;B.e>=B.s;)P[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},F||(F=!0,dy(B.w/256)),Is(P[B.e+1]);break;case 161:c["!autofilter"]={ref:at(B)};break;case 476:c["!margins"]=B;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),B.name&&(a.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),B.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!W.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=at(d||u)),l.sheetRows&&c["!ref"]){var H=ft(c["!ref"]);l.sheetRows<=+H.e.r&&(H.e.r=l.sheetRows-1,H.e.r>u.e.r&&(H.e.r=u.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>u.e.c&&(H.e.c=u.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),c["!fullref"]=c["!ref"],c["!ref"]=at(H))}return N.length>0&&(c["!merges"]=N),P.length>0&&(c["!cols"]=P),C.length>0&&(c["!rows"]=C),c}function Nie(e,t,r,n,a,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Pt(t),t.z=t.z||Xe[14],t.v=xr(Ct(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=qs(a.cellXfs,t,a),t.l&&s["!links"].push([Ze(c),t.l]),t.c&&s["!comments"].push([Ze(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=vy(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,o?Te(e,18,Use(t,c)):Te(e,7,$se(t,c))):(c.t="str",o?Te(e,17,eie(t,c)):Te(e,6,Jse(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Te(e,13,Yse(t,c)):Te(e,2,Gse(t,c)):o?Te(e,16,Hse(t,c)):Te(e,5,Wse(t,c)),!0;case"b":return c.t="b",o?Te(e,15,Ise(t,c)):Te(e,4,Pse(t,c)),!0;case"e":return c.t="e",o?Te(e,14,Mse(t,c)):Te(e,3,Fse(t,c)),!0}return o?Te(e,12,Ose(t,c)):Te(e,1,Ase(t,c)),!0}function Eie(e,t,r,n){var a=ft(t["!ref"]||"A1"),s,o="",l=[];Te(e,145);var c=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=d;++u){o=rr(u),wse(e,t,a,u);var f=!1;if(u<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){u===a.s.r&&(l[h]=$t(h)),s=l[h]+o;var m=c?(t[u]||[])[h]:t[s];if(!m){f=!1;continue}f=Nie(e,m,u,h,n,t,f)}}Te(e,146)}function _ie(e,t){!t||!t["!merges"]||(Te(e,177,oie(t["!merges"].length)),t["!merges"].forEach(function(r){Te(e,176,iie(r))}),Te(e,178))}function Sie(e,t){!t||!t["!cols"]||(Te(e,390),t["!cols"].forEach(function(r,n){r&&Te(e,60,hie(n,r))}),Te(e,391))}function Tie(e,t){!t||!t["!ref"]||(Te(e,648),Te(e,649,xie(ft(t["!ref"]))),Te(e,650))}function Aie(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=yt(r,-1,n[1].Target.replace(/#.*$/,""),ct.HLINK);Te(e,494,cie(n,a))}}),delete t["!links"]}function kie(e,t,r,n){if(t["!comments"].length>0){var a=yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ct.VML);Te(e,551,ny("rId"+a)),t["!legacy"]=a}}function Oie(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:at(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=yn(s);l.s.r==l.e.r&&(l.e.r=yn(t["!ref"]).e.r,s=at(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Te(e,161,Fo(ft(s))),Te(e,162)}}function Cie(e,t,r){Te(e,133),Te(e,137,gie(t,r)),Te(e,138),Te(e,134)}function Pie(e,t){t["!protect"]&&Te(e,535,yie(t["!protect"]))}function Die(e,t,r,n){var a=vn(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ft(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(a,129),(r.vbaraw||o["!outline"])&&Te(a,147,Sse(l,o["!outline"])),Te(a,148,Nse(c)),Cie(a,o,r.Workbook),Sie(a,o),Eie(a,o,e,t),Pie(a,o),Oie(a,o,r,e),_ie(a,o),Aie(a,o,n),o["!margins"]&&Te(a,476,pie(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Tie(a,o),kie(a,o,e,n),Te(a,130),a.end()}function Iie(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function Rie(e,t,r,n,a,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Iie(f);u.s.r=u.s.c=0,u.e.c=l,d=$t(l),h[0].forEach(function(m,p){o[d+rr(p)]={t:"n",v:m,z:h[1]},c=p}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=at(u)),o}function Fie(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(k5);return l&&gy(l[0],s,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Lie(e,t){e.l+=10;var r=Kr(e);return{name:r}}function Mie(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ps(e,function(c,d,u){switch(u){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var xy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Bie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$ie=[],zie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function iE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=kt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function oE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=kt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function D5(e){oE(e.WBProps,xy),oE(e.CalcPr,zie),iE(e.WBView,Bie),iE(e.Sheets,$ie),eo.date1904=kt(e.WBProps.date1904)}function Uie(e){return!e.Workbook||!e.Workbook.WBProps?"false":kt(e.Workbook.WBProps.date1904)?"true":"false"}var qie="][*?/\\".split("");function I5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qie.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Wie(e,t,r){e.forEach(function(n,a){I5(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Hie(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Wie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Uae(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Vie=/<\w+:workbook/;function Gie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(e.replace(Zr,function(c,d){var u=Je(c);switch(Fa(u[0])){case"<?xml":break;case"<workbook":c.match(Vie)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":xy.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=kt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=jt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=dt(jt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=jt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),kt(u.hidden||"0")&&(s.Hidden=!0),o=d+c.length;break;case"</definedName>":s.Ref=dt(jt(e.slice(o,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Ii.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return D5(r),r}function R5(e){var t=[ar];t[t.length]=Pe("workbook",null,{xmlns:Ii[0],"xmlns:r":pr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(xy.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Pe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:wt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Pe("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Pe("definedName",wt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Kie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=bg(e),r.name=Kr(e),r}function Yie(e,t){return t||(t=we(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ny(e.strRelID,t),Sr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Xie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Kr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Zie(e,t){t||(t=we(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),S4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Jie(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Qie(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=kJ(e),o=Fae(e,0,r),l=ry(e);e.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function eoe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Wl[16]={n:"BrtFRTArchID$",f:Jie},ps(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ur(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),D5(r),r.Names=s,r.supbooks=o,r}function toe(e,t){Te(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Te(e,156,Yie(a))}Te(e,144)}function roe(e,t){t||(t=we(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Sr("SheetJS",t),Sr(rd.version,t),Sr(rd.version,t),Sr("7262",t),t.length>t.l?t.slice(0,t.l):t}function noe(e,t){t||(t=we(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function aoe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Te(e,135),Te(e,158,noe(a)),Te(e,136))}}function soe(e,t){var r=vn();return Te(r,131),Te(r,128,roe()),Te(r,153,Zie(e.Workbook&&e.Workbook.WBProps||null)),aoe(r,e),toe(r,e),Te(r,132),r.end()}function ioe(e,t,r){return t.slice(-4)===".bin"?eoe(e,r):Gie(e,r)}function ooe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?jie(e,n,r,a,s,o,l):Qae(e,n,r,a,s,o,l)}function loe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Mie(e,n,r,a,s):Fie(e,n,r,a,s)}function coe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?dne():fne()}function uoe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?cne():une()}function doe(e,t,r,n){return t.slice(-4)===".bin"?ire(e,r,n):Kte(e,r,n)}function foe(e,t,r){return p5(e,r)}function hoe(e,t,r){return t.slice(-4)===".bin"?hte(e,r):ute(e,r)}function moe(e,t,r){return t.slice(-4)===".bin"?ane(e,r):Yre(e,r)}function poe(e,t,r){return t.slice(-4)===".bin"?Vre(e):Wre(e)}function voe(e,t,r,n){return r.slice(-4)===".bin"?Gre(e,t,r,n):void 0}function goe(e,t,r){return t.slice(-4)===".bin"?zre(e,t,r):qre(e,t,r)}function xoe(e,t,r){return(t.slice(-4)===".bin"?soe:R5)(e)}function yoe(e,t,r,n,a){return(t.slice(-4)===".bin"?Die:O5)(e,r,n,a)}function boe(e,t,r){return(t.slice(-4)===".bin"?vre:h5)(e,r)}function woe(e,t,r){return(t.slice(-4)===".bin"?vte:s5)(e,r)}function joe(e,t,r){return(t.slice(-4)===".bin"?sne:x5)(e)}function Noe(e){return(e.slice(-4)===".bin"?Ure:v5)()}var F5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,L5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function la(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(F5),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(L5),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Eoe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(F5),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(L5),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var ml;function _oe(e,t){var r=ml[e]||dt(e);return r==="General"?Ni(t):aa(r,t)}function Soe(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=kt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[dt(t)]=a}function Toe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||vs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rl(e.v):e.w=Ni(e.v):e.w=_oe(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=ml[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Do(n)){var a=ni(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function Aoe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=$te[n.Pattern]||n.Pattern)}e[t.ID]=t}function koe(e,t,r,n,a,s,o,l,c,d){var u="General",f=n.StyleID,h={};d=d||{};var m=[],p=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&m.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=kt(e);break;case"String":n.t="s",n.r=EN(dt(e)),n.v=e.indexOf("<")>-1?dt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ct(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=dt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=C4[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=EN(t||e));break}if(Toe(n,u,d),d.cellFormula!==!1)if(n.Formula){var v=dt(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Qi(v,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Qi("RC:RC",a):n.ArrayRange&&(n.F=Qi(n.ArrayRange,a),c.push([ft(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);d.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ooe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function w0(e,t){var r=t||{};Io();var n=el(X1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=jt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Pt(r);return o.type="string",vo.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(he){a.indexOf("<"+he)>=0&&(s=!0)}),s)return ple(n,r);ml={"General Number":"General","General Date":Xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Xe[15],"Short Date":Xe[14],"Long Time":Xe[19],"Medium Time":Xe[18],"Short Time":Xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Xe[2],Standard:Xe[4],Percent:Xe[10],Scientific:Xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],h=r.dense?[]:{},m="",p={},v={},g=la('<Data ss:Type="String">'),x=0,b=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},N={},E="",S=0,O=[],k={},T={},A=0,P=[],C=[],F={},M=[],H,V=!1,B=[],W=[],z={},D=0,L=0,q={Sheets:[],WBProps:{date1904:!1}},I={};Ml.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";l=Ml.exec(n);)switch(l[3]=(R=l[3]).toLowerCase()){case"data":if(R=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?koe(n.slice(x,l.index),E,g,c[c.length-1][0]=="comment"?F:p,{c:b,r:y},j,M[b],v,B,r):(E="",g=la(l[0]),x=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(C.length>0&&(p.c=C),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][b]=p):h[$t(b)+rr(y)]=p),p.HRef&&(p.l={Target:dt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(D=b+(parseInt(p.MergeAcross,10)|0),L=y+(parseInt(p.MergeDown,10)|0),O.push({s:{c:b,r:y},e:{c:D,r:L}})),!r.sheetStubs)p.MergeAcross?b=D+1:++b;else if(p.MergeAcross||p.MergeDown){for(var X=b;X<=D;++X)for(var ae=y;ae<=L;++ae)(X>b||ae>y)&&(r.dense?(h[ae]||(h[ae]=[]),h[ae][X]={t:"z"}):h[$t(X)+rr(ae)]={t:"z"});b=D+1}else++b;else p=Eoe(l[0]),p.Index&&(b=+p.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),l[0].slice(-2)==="/>"&&++b,C=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),l[0].slice(-2)==="/>"&&(v=la(l[0]),v.Index&&(y=+v.Index-1)),b=0,++y):(v=la(l[0]),v.Index&&(y=+v.Index-1),z={},(v.AutoFitHeight=="0"||v.Height)&&(z.hpx=parseInt(v.Height,10),z.hpt=ql(z.hpx),W[y]=z),v.Hidden=="1"&&(z.hidden=!0,W[y]=z));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=at(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=at(w))),O.length&&(h["!merges"]=O),M.length>0&&(h["!cols"]=M),W.length>0&&(h["!rows"]=W),u[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,c.push([l[3],!1]),d=la(l[0]),m=dt(d.Name),h=r.dense?[]:{},O=[],B=[],W=[],I={name:m,Hidden:0},q.Sheets.push(I);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),M=[],V=!1}break;case"style":l[1]==="/"?Aoe(j,N,r):N=la(l[0]);break;case"numberformat":N.nf=dt(la(l[0]).Format||"General"),ml[N.nf]&&(N.nf=ml[N.nf]);for(var Z=0;Z!=392&&Xe[Z]!=N.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(Xe[Z]==null){Xa(N.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(H=la(l[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!V&&H.wpx>10){V=!0,Wr=d5;for(var ee=0;ee<M.length;++ee)M[ee]&&Is(M[ee])}V&&Is(H),M[H.Index-1||M.length]=H;for(var ie=0;ie<+H.Span;++ie)M[M.length]=Pt(H);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var U=Je(l[0]),be={Name:U.Name,Ref:Qi(U.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(be.Sheet=q.Sheets.length-1),q.Names.push(be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=la(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?eQ(k,R,n.slice(A,l.index)):A=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Ooe(F),C.push(F)}else c.push([l[3],!1]),d=la(l[0]),F={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Se=la(l[0]);h["!autofilter"]={ref:Qi(Se.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return fE(n,r);var Re=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Re=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Re=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Re=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Re=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(A,l.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else A=l.index+l[0].length;break;case"header":h["!margins"]||fi(h["!margins"]={},"xlml"),isNaN(+Je(l[0]).Margin)||(h["!margins"].header=+Je(l[0]).Margin);break;case"footer":h["!margins"]||fi(h["!margins"]={},"xlml"),isNaN(+Je(l[0]).Margin)||(h["!margins"].footer=+Je(l[0]).Margin);break;case"pagemargins":var Le=Je(l[0]);h["!margins"]||fi(h["!margins"]={},"xlml"),isNaN(+Le.Top)||(h["!margins"].top=+Le.Top),isNaN(+Le.Left)||(h["!margins"].left=+Le.Left),isNaN(+Le.Right)||(h["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(h["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Re=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Re=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Re=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Re=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Re=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Re=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Re=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Re=!1}break;case"smarttags":break;default:Re=!1;break}if(Re||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Soe(T,R,P,n.slice(A,l.index)):(P=l,A=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=u),_e.SheetNames=f,_e.Workbook=q,_e.SSF=Pt(Xe),_e.Props=k,_e.Custprops=T,_e}function Tg(e,t){switch(by(t=t||{}),t.type||"base64"){case"base64":return w0(Rn(e),t);case"binary":case"buffer":case"file":return w0(e,t);case"array":return w0(zs(e),t)}}function Coe(e,t){var r=[];return e.Props&&r.push(tQ(e.Props,t)),e.Custprops&&r.push(rQ(e.Props,e.Custprops)),r.join("")}function Poe(){return""}function Doe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Pe("NumberFormat",null,{"ss:Format":wt(Xe[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Pe("Style",s.join(""),o))}),Pe("Styles",r.join(""))}function M5(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+my(e.Ref,{r:0,c:0})})}function Ioe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(M5(a)))}return Pe("Names",r.join(""))}function Roe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(M5(l)))}return s.join("")}function Foe(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ir("ProtectContents","True")),e["!protect"].objects&&a.push(Ir("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ir("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ir("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ir("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Pe("WorksheetOptions",a.join(""),{xmlns:Sn.x})}function Loe(e){return e.map(function(t){var r=aJ(t.t||""),n=Pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",n,{"ss:Author":t.a})}).join("")}function Moe(e,t,r,n,a,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+wt(my(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=zt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=wt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=wt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=vs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Xe[14]);break;case"s":f="String",h=nJ(e.v||"");break}var m=qs(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var p=e.v!=null?h:"",v=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(v+=Loe(e.c)),Pe("Cell",v,l)}function Boe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=go(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $oe(e,t,r,n){if(!e["!ref"])return"";var a=ft(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,x){Is(g);var b=!!g.width,y=pf(x,g),w={"ss:Index":x+1};b&&(w["ss:Width"]=zl(y.width)),g.hidden&&(w["ss:Hidden"]="1"),l.push(Pe("Column",null,w))});for(var c=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var u=[Boe(d,(e["!rows"]||[])[d])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>d)&&!(s[o].e.c<f)&&!(s[o].e.r<d)){(s[o].s.c!=f||s[o].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},p=Ze(m),v=c?(e[d]||[])[f]:e[p];u.push(Moe(v,p,e,t,r,n,m))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function zoe(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],o=s?Roe(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?$oe(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Foe(s,t,e,r)),n.join("")}function Uoe(e,t){t||(t={}),e.SSF||(e.SSF=Pt(Xe)),e.SSF&&(Io(),lf(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Coe(e,t)),r.push(Poe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Pe("Worksheet",zoe(n,t,e),{"ss:Name":wt(e.SheetNames[n])}));return r[2]=Doe(e,t),r[3]=Ioe(e),ar+Pe("Workbook",r.join(""),{xmlns:Sn.ss,"xmlns:o":Sn.o,"xmlns:x":Sn.x,"xmlns:ss":Sn.ss,"xmlns:dt":Sn.dt,"xmlns:html":Sn.html})}function qoe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=IJ(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=RJ(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Woe=[60,1084,2066,2165,2175];function Hoe(e,t,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Ha(r,r.l),d=Ag[c],u=0;d!=null&&Woe.indexOf(c)>-1;)s=Ha(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+s),o.push(l),r.l+=4+s,d=Ag[c=Ha(r,r.l)];var f=Er(o);Dr(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Ta(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Xe[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rl(e.v):e.w=Ni(e.v):e.w=aa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Do(Xe[n]||String(n))){var a=ni(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function su(e,t,r){return{v:e,ixfe:t,t:r}}function Voe(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},o={},l=null,c=[],d="",u={},f,h="",m,p,v,g,x={},b=[],y,w,j=[],N=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},O=function(Ve){return Ve<8?ci[Ve]:Ve<64&&N[Ve-8]||ci[Ve]},k=function(Ve,pt,zn){var hr=pt.XF.data;if(!(!hr||!hr.patternType||!zn||!zn.cellStyles)){pt.s={},pt.s.patternType=hr.patternType;var Ws;(Ws=$l(O(hr.icvFore)))&&(pt.s.fgColor={rgb:Ws}),(Ws=$l(O(hr.icvBack)))&&(pt.s.bgColor={rgb:Ws})}},T=function(Ve,pt,zn){if(!(z>1)&&!(zn.sheetRows&&Ve.r>=zn.sheetRows)){if(zn.cellStyles&&pt.XF&&pt.XF.data&&k(Ve,pt,zn),delete pt.ixfe,delete pt.XF,f=Ve,h=Ze(Ve),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<o.s.r&&(o.s.r=Ve.r),Ve.c<o.s.c&&(o.s.c=Ve.c),Ve.r+1>o.e.r&&(o.e.r=Ve.r+1),Ve.c+1>o.e.c&&(o.e.c=Ve.c+1),zn.cellFormula&&pt.f){for(var hr=0;hr<b.length;++hr)if(!(b[hr][0].s.c>Ve.c||b[hr][0].s.r>Ve.r)&&!(b[hr][0].e.c<Ve.c||b[hr][0].e.r<Ve.r)){pt.F=at(b[hr][0]),(b[hr][0].s.c!=Ve.c||b[hr][0].s.r!=Ve.r)&&delete pt.f,pt.f&&(pt.f=""+Ur(b[hr][1],o,Ve,B,A));break}}zn.dense?(a[Ve.r]||(a[Ve.r]=[]),a[Ve.r][Ve.c]=pt):a[h]=pt}},A={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var P,C=[],F=[],M=[],H=[],V=!1,B=[];B.SheetNames=A.snames,B.sharedf=A.sharedf,B.arrayf=A.arrayf,B.names=[],B.XTI=[];var W=0,z=0,D=0,L=[],q=[],I;A.codepage=1200,ma(1200);for(var R=!1;e.l<e.length-1;){var X=e.l,ae=e.read_shift(2);if(ae===0&&W===10)break;var Z=e.l===e.length?0:e.read_shift(2),ee=Ag[ae];if(ee&&ee.f){if(t.bookSheets&&W===133&&ae!==133)break;if(W=ae,ee.r===2||ee.r==12){var ie=e.read_shift(2);if(Z-=2,!A.enc&&ie!==ae&&((ie&255)<<8|ie>>8)!==ae)throw new Error("rt mismatch: "+ie+"!="+ae);ee.r==12&&(e.l+=10,Z-=10)}var U={};if(ae===10?U=ee.f(e,Z,A):U=Hoe(ae,ee,e,Z,A),z==0&&[9,521,1033,2057].indexOf(W)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=U;break;case 66:var be=Number(U);switch(be){case 21010:be=1200;break;case 32768:be=1e4;break;case 32769:be=1252;break}ma(A.codepage=be),R=!0;break;case 317:A.rrtabid=U;break;case 25:A.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:A.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(a["!type"]="dialog"),U.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),U.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(U);break;case 430:B.push([U]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(U);break;case 24:case 536:I={Name:U.Name,Ref:Ur(U.rgce,o,null,B,A)},U.itab>0&&(I.Sheet=U.itab-1),B.names.push(I),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(q[U.itab-1]={ref:at(U.rgce[0][0][1][2])});break;case 22:A.ExternCount=U;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(U),B.XTI=B.XTI.concat(U);break;case 2196:if(A.biff<8)break;I!=null&&(I.Comment=U[1]);break;case 18:a["!protect"]=U;break;case 19:U!==0&&A.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,A.snames.push(U.name);break;case 10:{if(--z)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=at(o),t.sheetRows&&t.sheetRows<=o.e.r){var Se=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=at(o),o.e.r=Se}o.e.r++,o.e.c++}C.length>0&&(a["!merges"]=C),F.length>0&&(a["!objects"]=F),M.length>0&&(a["!cols"]=M),H.length>0&&(a["!rows"]=H),E.Sheets.push(S)}d===""?u=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),A.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(A.biff=5,R=!0,ma(A.codepage=28591)),A.biff==8&&U.BIFFVer==0&&U.dt==16&&(A.biff=2),z++)break;if(a=t.dense?[]:{},A.biff<8&&!R&&(R=!0,ma(A.codepage=t.codepage||1252)),A.biff<5||U.BIFFVer==0&&U.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Re={pos:e.l-Z,name:d};s[Re.pos]=Re,A.snames.push(d)}else d=(s[X]||{name:""}).name;U.dt==32&&(a["!type"]="chart"),U.dt==64&&(a["!type"]="macro"),C=[],F=[],A.arrayf=b=[],M=[],H=[],V=!1,S={Hidden:(s[X]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[U.r]||[])[U.c]:a[Ze({c:U.c,r:U.r})])&&++U.c,y={ixfe:U.ixfe,XF:j[U.ixfe]||{},v:U.val,t:"n"},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t);break;case 5:case 517:y={ixfe:U.ixfe,XF:j[U.ixfe],v:U.val,t:U.t},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t);break;case 638:y={ixfe:U.ixfe,XF:j[U.ixfe],v:U.rknum,t:"n"},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t);break;case 189:for(var Le=U.c;Le<=U.C;++Le){var _e=U.rkrec[Le-U.c][0];y={ixfe:_e,XF:j[_e],v:U.rkrec[Le-U.c][1],t:"n"},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:Le,r:U.r},y,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){l=U;break}if(y=su(U.val,U.cell.ixfe,U.tt),y.XF=j[y.ixfe],t.cellFormula){var he=U.formula;if(he&&he[0]&&he[0][0]&&he[0][0][0]=="PtgExp"){var ue=he[0][0][1][0],je=he[0][0][1][1],Oe=Ze({r:ue,c:je});x[Oe]?y.f=""+Ur(U.formula,o,U.cell,B,A):y.F=((t.dense?(a[ue]||[])[je]:a[Oe])||{}).F}else y.f=""+Ur(U.formula,o,U.cell,B,A)}D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T(U.cell,y,t),l=U}break;case 7:case 519:if(l)l.val=U,y=su(U,l.cell.ixfe,"s"),y.XF=j[y.ixfe],t.cellFormula&&(y.f=""+Ur(l.formula,o,l.cell,B,A)),D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(U);var Ae=Ze(U[0].s);if(m=t.dense?(a[U[0].s.r]||[])[U[0].s.c]:a[Ae],t.cellFormula&&m){if(!l||!Ae||!m)break;m.f=""+Ur(U[1],o,U[0],B,A),m.F=at(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;x[Ze(l.cell)]=U[0],m=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Ze(l.cell)],(m||{}).f=""+Ur(U[0],o,f,B,A)}}break;case 253:y=su(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(y.h=c[U.isst].h),y.XF=j[y.ixfe],D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:U.ixfe,XF:j[U.ixfe],t:"z"},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t));break;case 190:if(t.sheetStubs)for(var Qe=U.c;Qe<=U.C;++Qe){var Ke=U.ixfe[Qe-U.c];y={ixfe:Ke,XF:j[Ke],t:"z"},D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:Qe,r:U.r},y,t)}break;case 214:case 516:case 4:y=su(U.val,U.ixfe,"s"),y.XF=j[y.ixfe],D>0&&(y.z=L[y.ixfe>>8&63]),Ta(y,t,r.opts.Date1904),T({c:U.c,r:U.r},y,t);break;case 0:case 512:z===1&&(o=U);break;case 252:c=U;break;case 1054:if(A.biff==4){L[D++]=U[1];for(var et=0;et<D+163&&Xe[et]!=U[1];++et);et>=163&&Xa(U[1],D+163)}else Xa(U[1],U[0]);break;case 30:{L[D++]=U;for(var Qt=0;Qt<D+163&&Xe[Qt]!=U;++Qt);Qt>=163&&Xa(U,D+163)}break;case 229:C=C.concat(U);break;case 93:F[U.cmo[0]]=A.lastobj=U;break;case 438:A.lastobj.TxO=U;break;case 127:A.lastobj.ImData=U;break;case 440:for(g=U[0].s.r;g<=U[0].e.r;++g)for(v=U[0].s.c;v<=U[0].e.c;++v)m=t.dense?(a[g]||[])[v]:a[Ze({c:v,r:g})],m&&(m.l=U[1]);break;case 2048:for(g=U[0].s.r;g<=U[0].e.r;++g)for(v=U[0].s.c;v<=U[0].e.c;++v)m=t.dense?(a[g]||[])[v]:a[Ze({c:v,r:g})],m&&m.l&&(m.l.Tooltip=U[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;m=t.dense?(a[U[0].r]||[])[U[0].c]:a[Ze(U[0])];var Jr=F[U[2]];m||(t.dense?(a[U[0].r]||(a[U[0].r]=[]),m=a[U[0].r][U[0].c]={t:"z"}):m=a[Ze(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),m.c||(m.c=[]),p={a:U[1],t:Jr.TxO.t},m.c.push(p)}break;case 2173:Dre(j[U.ixfe],U.ext);break;case 125:{if(!A.cellStyles)break;for(;U.e>=U.s;)M[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},V||(V=!0,dy(U.w/256)),Is(M[U.e+1])}break;case 520:{var it={};U.level!=null&&(H[U.r]=it,it.level=U.level),U.hidden&&(H[U.r]=it,it.hidden=!0),U.hpt&&(H[U.r]=it,it.hpt=U.hpt,it.hpx=go(U.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||fi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=U;break;case 161:a["!margins"]||fi(a["!margins"]={}),a["!margins"].header=U.header,a["!margins"].footer=U.footer;break;case 574:U.RTL&&(E.Views[0].RTL=!0);break;case 146:N=U;break;case 2198:P=U;break;case 140:w=U;break;case 442:d?S.CodeName=U||S.name:E.WBProps.CodeName=U||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=Z}return r.SheetNames=Jt(s).sort(function($n,Ve){return Number($n)-Number(Ve)}).map(function($n){return s[$n].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&q.forEach(function($n,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=$n}),r.Strings=c,r.SSF=Pt(Xe),A.enc&&(r.Encryption=A.enc),P&&(r.Themes=P),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),B.names.length>0&&(E.Names=B.names),r.Workbook=E,r}var pl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Goe(e,t,r){var n=Ge.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=UN(n,wg,pl.DSI);for(var s in a)t[s]=a[s]}catch(d){if(r.WTF)throw d}var o=Ge.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=UN(o,jg,pl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(L4(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Koe(e,t){var r=[],n=[],a=[],s=0,o,l=xN(wg,"n"),c=xN(jg,"n");if(e.Props)for(o=Jt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Jt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Custprops[o[s]]]);var d=[];for(s=0;s<a.length;++s)W4.indexOf(a[s][0])>-1||F4.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);n.length&&Ge.utils.cfb_add(t,"/SummaryInformation",qN(n,pl.SI,c,jg)),(r.length||d.length)&&Ge.utils.cfb_add(t,"/DocumentSummaryInformation",qN(r,pl.DSI,l,wg,d.length?d:null,pl.UDI))}function B5(e,t){t||(t={}),by(t),z1(),t.codepage&&$1(t.codepage);var r,n;if(e.FullPaths){if(Ge.find(e,"/encryption"))throw new Error("File is password-protected");r=Ge.find(e,"!CompObj"),n=Ge.find(e,"/Workbook")||Ge.find(e,"/Book")}else{switch(t.type){case"base64":e=kn(Rn(e));break;case"binary":e=kn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Dr(e,0),n={content:e}}var a,s;if(r&&qoe(r),t.bookProps&&!t.bookSheets)a={};else{var o=ot?"buffer":"array";if(n&&n.content)a=Voe(n.content,t);else if((s=Ge.find(e,"PerfectOffice_MAIN"))&&s.content)a=di.to_workbook(s.content,(t.type=o,t));else if((s=Ge.find(e,"NativeContent_MAIN"))&&s.content)a=di.to_workbook(s.content,(t.type=o,t));else throw(s=Ge.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ge.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=one(e))}var l={};return e.FullPaths&&Goe(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function Yoe(e,t){var r=t||{},n=Ge.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ge.utils.cfb_add(n,a,$5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Koe(e,n),r.biff==8&&e.vbaraw&&lne(n,Ge.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Wl={0:{f:yse},1:{f:Tse},2:{f:Vse},3:{f:Rse},4:{f:Cse},5:{f:qse},6:{f:Zse},7:{f:Bse},8:{f:aie},9:{f:nie},10:{f:tie},11:{f:rie},12:{f:kse},13:{f:Kse},14:{f:Lse},15:{f:Dse},16:{f:C5},17:{f:Qse},18:{f:zse},19:{f:ty},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Qie},40:{},42:{},43:{f:Zte},44:{f:Yte},45:{f:ere},46:{f:rre},47:{f:tre},48:{},49:{f:jJ},50:{},51:{f:Fre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:t5},62:{f:Xse},63:{f:Hre},64:{f:bie},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vie},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_se},148:{f:jse,p:16},151:{f:uie},152:{},153:{f:Xie},154:{},155:{},156:{f:Kie},157:{},158:{},159:{T:1,f:fte},160:{T:-1},161:{T:1,f:Mi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sie},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ire},336:{T:-1},337:{f:Bre,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:e5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:die},427:{f:fie},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mie},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ese},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:lie},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rne},633:{T:1},634:{T:-1},635:{T:1,f:ene},636:{T:-1},637:{f:SJ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Lie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wie},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ag={6:{f:y0},10:{f:ys},12:{f:or},13:{f:or},14:{f:er},15:{f:er},16:{f:Vr},17:{f:er},18:{f:er},19:{f:or},20:{f:YN},21:{f:YN},23:{f:e5},24:{f:ZN},25:{f:er},26:{},27:{},28:{f:wee},29:{},34:{f:er},35:{f:XN},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:er},43:{f:er},47:{f:Dte},49:{f:KQ},51:{f:or},60:{},61:{f:qQ},64:{f:er},65:{f:GQ},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:PQ},93:{f:Eee},94:{},95:{f:er},96:{},97:{},99:{f:er},125:{f:t5},128:{f:cee},129:{f:IQ},130:{f:or},131:{f:er},132:{f:er},133:{f:RQ},134:{},140:{f:Pee},141:{f:or},144:{},146:{f:Ree},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:Uee},161:{f:Mee},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:see},190:{f:iee},193:{f:ys},197:{},198:{},199:{},200:{},201:{},202:{f:er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:er},222:{},224:{f:lee},225:{f:CQ},226:{f:ys},227:{},229:{f:jee},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:LQ},253:{f:XQ},255:{f:BQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:H4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:er},353:{f:ys},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mee},431:{f:er},432:{},433:{},434:{},437:{},438:{f:Tee},439:{f:er},440:{f:Aee},441:{},442:{f:Nc},443:{},444:{f:or},445:{},446:{},448:{f:ys},449:{f:UQ,r:2},450:{f:ys},512:{f:VN},513:{f:zee},515:{f:fee},516:{f:JQ},517:{f:KN},519:{f:qee},520:{f:$Q},523:{},545:{f:JN},549:{f:HN},566:{},574:{f:HQ},638:{f:aee},659:{},1048:{},1054:{f:eee},1084:{},1212:{f:xee},2048:{f:Oee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ru},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ys},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Fee,r:12},2173:{f:Pre,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:gee,r:12},2197:{},2198:{f:Sre,r:12},2199:{},2200:{},2201:{},2202:{f:yee,r:12},2203:{f:ys},2204:{},2205:{},2206:{},2207:{},2211:{f:zQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Bee},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Iee},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:VN},1:{},2:{f:Kee},3:{f:Vee},4:{f:Hee},5:{f:KN},7:{f:Xee},8:{},9:{f:ru},11:{},22:{f:or},30:{f:ree},31:{},32:{},33:{f:JN},36:{},37:{f:HN},50:{f:Zee},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:Wee},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Jee},223:{},234:{},354:{},421:{},518:{f:y0},521:{f:ru},536:{f:ZN},547:{f:XN},561:{},579:{},1030:{f:y0},1033:{f:ru},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function De(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&J1(r)&&e.push(r)}}function Xoe(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return De(e,t,r,a);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Tc(e,t,r){return e||(e=we(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Zoe(e,t,r,n){var a=we(9);return Tc(a,e,t),V4(r,n||"b",a),a}function Joe(e,t,r){var n=we(8+2*r.length);return Tc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Qoe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?xr(Ct(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?De(e,2,Yee(r,n,a)):De(e,3,Gee(r,n,a));return;case"b":case"e":De(e,5,Zoe(r,n,t.v,t.t));return;case"s":case"str":De(e,4,Joe(r,n,(t.v||"").slice(0,255)));return}De(e,1,Tc(null,r,n))}function ele(e,t,r,n){var a=Array.isArray(t),s=ft(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=at(s)}for(var d=s.s.r;d<=s.e.r;++d){l=rr(d);for(var u=s.s.c;u<=s.e.c;++u){d===s.s.r&&(c[u]=$t(u)),o=c[u]+l;var f=a?(t[d]||[])[u]:t[o];f&&Qoe(e,f,d,u)}}}function tle(e,t){for(var r=t||{},n=vn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return De(n,r.biff==4?1033:r.biff==3?521:9,ly(e,16,r)),ele(n,e.Sheets[e.SheetNames[a]],a,r),De(n,10),n.end()}function rle(e,t,r){De(e,49,YQ({sz:12,name:"Arial"},r))}function nle(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&De(e,1054,tee(a,t[a],r))})}function ale(e,t){var r=we(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),De(e,2151,r),r=we(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Z4(ft(t["!ref"]||"A1"),r),r.write_shift(4,4),De(e,2152,r)}function sle(e,t){for(var r=0;r<16;++r)De(e,224,GN({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){De(e,224,GN(n,0,t))})}function ile(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];De(e,440,kee(n)),n[1].Tooltip&&De(e,2048,Cee(n))}delete t["!links"]}function ole(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&De(e,125,Lee(pf(a,n),a))})}}function lle(e,t,r,n,a){var s=16+qs(a.cellXfs,t,a);if(t.v==null&&!t.bf){De(e,513,Ti(r,n,s));return}if(t.bf)De(e,6,Iae(t,r,n,a,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?xr(Ct(t.v)):t.v;De(e,515,hee(r,n,o,s));break;case"b":case"e":De(e,517,dee(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=vy(a.Strings,t.v,a.revStrings);De(e,253,ZQ(r,n,l,s))}else De(e,516,QQ(r,n,(t.v||"").slice(0,255),s,a));break;default:De(e,513,Ti(r,n,s))}}function cle(e,t,r){var n=vn(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),d=t.biff==8,u,f="",h=[],m=ft(s["!ref"]||"A1"),p=d?65536:16384;if(m.e.c>255||m.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}De(n,2057,ly(r,16,t)),De(n,13,Zn(1)),De(n,12,Zn(100)),De(n,15,tn(!0)),De(n,17,tn(!1)),De(n,16,_i(.001)),De(n,95,tn(!0)),De(n,42,tn(!1)),De(n,43,tn(!1)),De(n,130,Zn(1)),De(n,128,uee()),De(n,131,tn(!1)),De(n,132,tn(!1)),d&&ole(n,s["!cols"]),De(n,512,nee(m,t)),d&&(s["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){f=rr(v);for(var g=m.s.c;g<=m.e.c;++g){v===m.s.r&&(h[g]=$t(g)),u=h[g]+f;var x=c?(s[v]||[])[g]:s[u];x&&(lle(n,x,v,g,t),d&&x.l&&s["!links"].push([u,x.l]))}}var b=l.CodeName||l.name||a;return d&&De(n,574,VQ((o.Views||[])[0])),d&&(s["!merges"]||[]).length&&De(n,229,Nee(s["!merges"])),d&&ile(n,s),De(n,442,G4(b)),d&&ale(n,s),De(n,10),n.end()}function ule(e,t,r){var n=vn(),a=(e||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(De(n,2057,ly(e,5,r)),r.bookType=="xla"&&De(n,135),De(n,225,l?Zn(1200):null),De(n,193,dQ(2)),c&&De(n,191),c&&De(n,192),De(n,226),De(n,92,DQ("SheetJS",r)),De(n,66,Zn(l?1200:1252)),l&&De(n,353,Zn(0)),l&&De(n,448),De(n,317,$ee(e.SheetNames.length)),l&&e.vbaraw&&De(n,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";De(n,442,G4(d))}De(n,156,Zn(17)),De(n,25,tn(!1)),De(n,18,tn(!1)),De(n,19,Zn(0)),l&&De(n,431,tn(!1)),l&&De(n,444,Zn(0)),De(n,61,WQ()),De(n,64,tn(!1)),De(n,141,Zn(0)),De(n,34,tn(Uie(e)=="true")),De(n,14,tn(!0)),l&&De(n,439,tn(!1)),De(n,218,Zn(0)),rle(n,e,r),nle(n,e.SSF,r),sle(n,r),l&&De(n,352,tn(!1));var u=n.end(),f=vn();l&&De(f,140,Dee()),l&&r.Strings&&Xoe(f,252,MQ(r.Strings)),De(f,10);var h=f.end(),m=vn(),p=0,v=0;for(v=0;v<e.SheetNames.length;++v)p+=(l?12:11)+(l?2:1)*e.SheetNames[v].length;var g=u.length+p+h.length;for(v=0;v<e.SheetNames.length;++v){var x=s[v]||{};De(m,133,FQ({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[v]},r)),g+=t[v].length}var b=m.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var y=[];return u.length&&y.push(u),b.length&&y.push(b),h.length&&y.push(h),Er(y)}function dle(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Pt(Xe)),e&&e.SSF&&(Io(),lf(e.SSF),r.revssf=uf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,wy(r),r.cellXfs=[],qs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=cle(a,r,e);return n.unshift(ule(e,n,r)),Er(n)}function $5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=yn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return dle(e,t);case 4:case 3:case 2:return tle(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function lE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,l=s&&s.index||e.length,c=YZ(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var v=c[o].trim(),g=v.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=v.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var b=x[l].trim();if(b.match(/<t[dh]/i)){for(var y=b,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var j=0;j<p.length;++j){var N=p[j];N.s.c==u&&N.s.r<d&&d<=N.e.r&&(u=N.e.c+1,j=-1)}var E=Je(b.slice(0,b.indexOf(">")));h=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||h>1)&&p.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var S=E.t||E["data-t"]||"";if(!y.length){u+=h;continue}if(y=u4(y),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!y.length){u+=h;continue}var O={t:"s",v:y};r.raw||!y.trim().length||S=="s"||(y==="TRUE"?O={t:"b",v:!0}:y==="FALSE"?O={t:"b",v:!1}:isNaN(va(y))?isNaN(po(y).getDate())||(O={t:"d",v:Ct(y)},r.cellDates||(O={t:"n",v:xr(O.v)}),O.z=r.dateNF||Xe[14]):O={t:"n",v:va(y)}),r.dense?(n[d]||(n[d]=[]),n[d][u]=O):n[Ze({r:d,c:u})]=O,u+=h}}}}return n["!ref"]=at(m),p.length&&(n["!merges"]=p),n}function fle(e,t,r,n){for(var a=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var u=Ze({r,c:o}),f=n.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||Y1(f.w||(as(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+u,s.push(Pe("td",h,m))}}var p="<tr>";return p+s.join("")+"</tr>"}var hle='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mle="</body></html>";function ple(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Us(lE(r[0],t),t);var n=_y();return r.forEach(function(a,s){Sy(n,lE(a,t),"Sheet"+(s+1))}),n}function vle(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function z5(e,t){var r=t||{},n=r.header!=null?r.header:hle,a=r.footer!=null?r.footer:mle,s=[n],o=yn(e["!ref"]);r.dense=Array.isArray(e),s.push(vle(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(fle(e,o,l,r));return s.push("</table>"+a),s.join("")}function U5(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?zt(n.origin):n.origin;a=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=yn(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),a==-1&&(d.e.r=a=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),p=0,v=0,g=0,x=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<l.length&&v<c;++p){var w=l[p];if(cE(w)){if(n.display)continue;m[v]={hidden:!0}}var j=w.children;for(g=x=0;g<j.length;++g){var N=j[g];if(!(n.display&&cE(N))){var E=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):u4(N.innerHTML),S=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<f.length;++h){var O=f[h];O.s.c==x+s&&O.s.r<v+a&&v+a<=O.e.r&&(x=O.e.c+1-s,h=-1)}y=+N.getAttribute("colspan")||1,((b=+N.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:v+a,c:x+s},e:{r:v+a+(b||1)-1,c:x+s+(y||1)-1}});var k={t:"s",v:E},T=N.getAttribute("data-t")||N.getAttribute("t")||"";E!=null&&(E.length==0?k.t=T||"z":n.raw||E.trim().length==0||T=="s"||(E==="TRUE"?k={t:"b",v:!0}:E==="FALSE"?k={t:"b",v:!1}:isNaN(va(E))?isNaN(po(E).getDate())||(k={t:"d",v:Ct(E)},n.cellDates||(k={t:"n",v:xr(k.v)}),k.z=n.dateNF||Xe[14]):k={t:"n",v:va(E)})),k.z===void 0&&S!=null&&(k.z=S);var A="",P=N.getElementsByTagName("A");if(P&&P.length)for(var C=0;C<P.length&&!(P[C].hasAttribute("href")&&(A=P[C].getAttribute("href"),A.charAt(0)!="#"));++C);A&&A.charAt(0)!="#"&&(k.l={Target:A}),n.dense?(e[v+a]||(e[v+a]=[]),e[v+a][x+s]=k):e[Ze({c:x+s,r:v+a})]=k,d.e.c<x+s&&(d.e.c=x+s),x+=y}}++v}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,v-1+a),e["!ref"]=at(d),v>=c&&(e["!fullref"]=at((d.e.r=l.length-p+v-1+a,d))),e}function q5(e,t){var r=t||{},n=r.dense?[]:{};return U5(n,e,t)}function gle(e,t){return Us(q5(e,t),t)}function cE(e){var t="",r=xle(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function xle(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function yle(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=dt(t.replace(/<[^>]*>/g,""));return[r]}var uE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function W5(e,t){var r=t||{},n=X1(e),a=[],s,o,l={name:""},c="",d=0,u,f,h={},m=[],p=r.dense?[]:{},v,g,x={value:""},b="",y=0,w=[],j=-1,N=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,O={},k=[],T={},A=0,P=0,C=[],F=1,M=1,H=[],V={Names:[]},B={},W=["",""],z=[],D={},L="",q=0,I=!1,R=!1,X=0;for(Ml.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Ml.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=at(E):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=at(E)),k.length&&(p["!merges"]=k),C.length&&(p["!rows"]=C),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),h[u.name]=p,R=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Je(v[0],!1),j=N=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=r.dense?[]:{},k=[],C=[],R=!0);break;case"table-row-group":v[1]==="/"?--S:++S;break;case"table-row":case"":if(v[1]==="/"){j+=F,F=1;break}if(f=Je(v[0],!1),f.?j=f.-1:j==-1&&(j=0),F=+f["number-rows-repeated"]||1,F<10)for(X=0;X<F;++X)S>0&&(C[j+X]={level:S});N=-1;break;case"covered-table-cell":v[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[j]||(p[j]=[]),p[j][N]={t:"z"}):p[Ze({r:j,c:N})]={t:"z"}),b="",w=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++N,x=Je(v[0],!1),M=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=sE(dt(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=dt(x["string-value"]||""),r.dense?(p[j]||(p[j]=[]),p[j][N]=g):p[Ze({r:j,c:N})]=g),N+=M-1;else if(v[1]!=="/"){++N,b="",y=0,w=[],M=1;var ae=F?j+F-1:j;if(N>E.e.c&&(E.e.c=N),N<E.s.c&&(E.s.c=N),j<E.s.r&&(E.s.r=j),ae>E.e.r&&(E.e.r=ae),x=Je(v[0],!1),z=[],D={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=dt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(A=parseInt(x["number-matrix-rows-spanned"],10)||0,P=parseInt(x["number-matrix-columns-spanned"],10)||0,T={s:{r:j,c:N},e:{r:j+A-1,c:N+P-1}},g.F=at(T),H.push([T,g.F])),x.formula)g.f=sE(x.formula);else for(X=0;X<H.length;++X)j>=H[X][0].s.r&&j<=H[X][0].e.r&&N>=H[X][0].s.c&&N<=H[X][0].e.c&&(g.F=H[X][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(A=parseInt(x["number-rows-spanned"],10)||0,P=parseInt(x["number-columns-spanned"],10)||0,T={s:{r:j,c:N},e:{r:j+A-1,c:N+P-1}},k.push(T)),x["number-columns-repeated"]&&(M=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=kt(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=Ct(x["date-value"]),r.cellDates||(g.t="n",g.v=xr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=VZ(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=df(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(b=dt(x["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(I=!1,g.t==="s"&&(g.v=b||"",w.length&&(g.R=w),I=y==0),B.Target&&(g.l=B),z.length>0&&(g.c=z,z=[]),b&&r.cellText!==!1&&(g.w=b),I&&(g.t="z",delete g.v),(!I||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Z=0;Z<F;++Z){if(M=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[j+Z]||(p[j+Z]=[]),p[j+Z][N]=Z==0?g:Pt(g);--M>0;)p[j+Z][N+M]=Pt(g);else for(p[Ze({r:j+Z,c:N})]=g;--M>0;)p[Ze({r:j+Z,c:N+M})]=Pt(g);E.e.c<=N&&(E.e.c=N)}M=parseInt(x["number-columns-repeated"]||"1",10),N+=M-1,M=0,g={},b="",w=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s;D.t=b,w.length&&(D.R=w),D.a=L,z.push(D)}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);L="",q=0,b="",y=0,w=[];break;case"creator":v[1]==="/"?L=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);b="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(O[l.name]=c,(s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(c="",l=Je(v[0],!1),a.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Je(v[0],!1),c+=uE[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Je(v[0],!1),c+=uE[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":o=Je(v[0],!1),W=b0(o["cell-range-address"]);var ee={Name:o.name,Ref:W[0]+"!"+W[1]};R&&(ee.Sheet=m.length),V.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(v[1]==="/"&&(!x||!x["string-value"])){var ie=yle(n.slice(y,v.index));b=(b.length>0?b+`
`:"")+ie[0]}else Je(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{W=b0(Je(v[0])["target-range-address"]),h[W[0]]["!autofilter"]={ref:W[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(B=Je(v[0],!1),!B.href)break;B.Target=dt(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(W=b0(B.Target.slice(1)),B.Target="#"+W[0]+"!"+W[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var U={Sheets:h,SheetNames:m,Workbook:V};return r.bookSheets&&delete U.Sheets,U}function dE(e,t){t=t||{},Xn(e,"META-INF/manifest.xml")&&VJ(ir(e,"META-INF/manifest.xml"),t);var r=On(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=W5(jt(r),t);return Xn(e,"meta.xml")&&(n.Props=I4(ir(e,"meta.xml"))),n}function fE(e,t){return W5(e,t)}var ble=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ll({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ar+t}})(),hE=(function(){var e=function(s){return wt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+wt(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=yn(s["!ref"]||"A1"),h=s["!merges"]||[],m=0,p=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",g=s["!rows"]||[];for(d=0;d<f.s.r;++d)v=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;d<=f.e.r;++d){for(v=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+v+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var x=!1,b={},y="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(x=!0),b["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,b["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(x){c.push(r);continue}var w=Ze({r:d,c:u}),j=p?(s[d]||[])[u]:s[w];if(j&&j.f&&(b["table:formula"]=wt($ae(j.f)),j.F&&j.F.slice(0,w.length)==w)){var N=yn(j.F);b["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,b["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":y=j.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=j.v?"true":"false";break;case"n":y=j.w||String(j.v||0),b["office:value-type"]="float",b["office:value"]=j.v||0;break;case"s":case"str":y=j.v==null?"":j.v,b["office:value-type"]="string";break;case"d":y=j.w||Ct(j.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ct(j.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var E=e(y);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+zae(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),E=Pe("text:a",E,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Pe("table:table-cell",Pe("text:p",E,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Is(f),f.ods=l;var h=d["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ar],d=Ll({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ll({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(D4().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function H5(e,t){if(t.bookType=="fods")return hE(e,t);var r=V1(),n="",a=[],s=[];return n="mimetype",st(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",st(r,n,hE(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",st(r,n,ble(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",st(r,n,ar+D4()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",st(r,n,YJ(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",st(r,n,GJ(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ai(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):jt(zs(e))}function wle(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):kn(Pa(e))}function jle(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Fs(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function mE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Nle(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Ele(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Hl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function xt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ht(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Hl(e,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Hl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:s};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function kr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(xt(n*8+a.type)),a.type==2&&t.push(xt(a.data.length)),t.push(a.data))})}),Fs(t)}function yy(e,t){return e?.map(function(r){return t(r.data)})||[]}function Kn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Hl(e,n),s=ht(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=ht(l.data),d=Kt(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=s[3])!=null&&t[0]&&(o.merge=Kt(s[3][0].data)>>>0>0),r.push(o)}return r}function Ui(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:xt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:xt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:xt(o.data.length)}],n[2].push({data:kr(o.meta),type:2})});var s=kr(n);t.push(xt(s.length)),t.push(s),a.forEach(function(o){return t.push(o)})}),Fs(t)}function _le(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Hl(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(s==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Fs(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var u=Fs(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Yn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_le(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fs(t)}function qi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=xt(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Fs(t)}function Sle(e,t,r,n){var a=Ai(e),s=a.getUint32(4,!0),o=(n>1?12:8)+mE(s&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=mE(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(d=a.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Tle(e,t,r){var n=Ai(e),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);a&1&&(c=Nle(e,s),s+=16),a&2&&(d=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function j0(e,t){var r=new Uint8Array(32),n=Ai(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Ele(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function N0(e,t){var r=new Uint8Array(32),n=Ai(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Ale(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Sle(e,t,r,e[0]);case 5:return Tle(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function $r(e){var t=ht(e);return Hl(t[1][0].data)}function pE(e,t){var r=ht(t.data),n=Kt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=ht(o.data),c=Kt(l[1][0].data)>>>0;switch(n){case 1:s[c]=kg(l[3][0].data);break;case 8:{var d=e[$r(l[9][0].data)][0],u=ht(d.data),f=e[$r(u[1][0].data)][0],h=Kt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ht(f.data);s[c]=m[3].map(function(p){return kg(p.data)}).join("")}break}}),s}function kle(e,t){var r,n,a,s,o,l,c,d,u,f,h,m,p,v,g=ht(e),x=Kt(g[1][0].data)>>>0,b=Kt(g[2][0].data)>>>0,y=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Kt(g[8][0].data)>0||!1,w,j;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&t!=0)w=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,j=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)w=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,j=(v=(p=g[3])==null?void 0:p[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=y?4:1,E=Ai(w),S=[],O=0;O<w.length/2;++O){var k=E.getUint16(O*2,!0);k<65535&&S.push([O,k])}if(S.length!=b)throw"Expected ".concat(b," cells, found ").concat(S.length);var T=[];for(O=0;O<S.length-1;++O)T[S[O][0]]=j.subarray(S[O][1]*N,S[O+1][1]*N);return S.length>=1&&(T[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*N)),{R:x,cells:T}}function Ole(e,t){var r,n=ht(t.data),a=(r=n?.[7])!=null&&r[0]?Kt(n[7][0].data)>>>0>0?1:0:-1,s=yy(n[5],function(o){return kle(o,a)});return{nrows:Kt(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Cle(e,t,r){var n,a=ht(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Kt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=at(s);var o=ht(a[4][0].data),l=pE(e,e[$r(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?pE(e,e[$r(o[17][0].data)][0]):[],d=ht(o[3][0].data),u=0;d[1].forEach(function(f){var h=ht(f.data),m=e[$r(h[2][0].data)][0],p=Kt(m.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var v=Ole(e,m);v.data.forEach(function(g,x){g.forEach(function(b,y){var w=Ze({r:u+x,c:y}),j=Ale(b,l,c);j&&(r[w]=j)})}),u+=v.nrows})}function Ple(e,t){var r=ht(t.data),n={"!ref":"A1"},a=e[$r(r[2][0].data)],s=Kt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Cle(e,a[0],n),n}function Dle(e,t){var r,n=ht(t.data),a={name:(r=n[1])!=null&&r[0]?kg(n[1][0].data):"",sheets:[]},s=yy(n[2],$r);return s.forEach(function(o){e[o].forEach(function(l){var c=Kt(l.meta[1][0].data);c==6e3&&a.sheets.push(Ple(e,l))})}),a}function Ile(e,t){var r=_y(),n=ht(t.data),a=yy(n[1],$r);if(a.forEach(function(s){e[s].forEach(function(o){var l=Kt(o.meta[1][0].data);if(l==2){var c=Dle(e,o);c.sheets.forEach(function(d,u){Sy(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function E0(e){var t,r,n,a,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Yn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Kn(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(d){var u=Kt(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Ile(s,l)}function Rle(e,t,r){var n,a,s,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Kt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Ai(e[7][0].data),u=0,f=[],h=Ai(e[4][0].data),m=0,p=[],v=0;v<t.length;++v){if(t[v]==null){d.setUint16(v*2,65535,!0),h.setUint16(v*2,65535);continue}d.setUint16(v*2,u,!0),h.setUint16(v*2,m,!0);var g,x;switch(typeof t[v]){case"string":g=j0({t:"s",v:t[v]},r),x=N0({t:"s",v:t[v]},r);break;case"number":g=j0({t:"n",v:t[v]},r),x=N0({t:"n",v:t[v]},r);break;case"boolean":g=j0({t:"b",v:t[v]},r),x=N0({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}f.push(g),u+=g.length,p.push(x),m+=x.length,++c}for(e[2][0].data=xt(c);v<e[7][0].data.length/2;++v)d.setUint16(v*2,65535,!0),h.setUint16(v*2,65535,!0);return e[6][0].data=Fs(f),e[3][0].data=Fs(p),c}function Fle(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=yn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(at(n)));var s=md(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(q){typeof q=="string"&&o.push(q)})});var l={},c=[],d=Ge.read(t.numbers,{type:"base64"});d.FileIndex.map(function(L,q){return[L,d.FullPaths[q]]}).forEach(function(L){var q=L[0],I=L[1];if(q.type==2&&q.name.match(/\.iwa/)){var R=q.content,X=Yn(R),ae=Kn(X);ae.forEach(function(Z){c.push(Z.id),l[Z.id]={deps:[],location:I,type:Kt(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(L,q){return L-q});var u=c.filter(function(L){return L>1}).map(function(L){return[L,xt(L)]});d.FileIndex.map(function(L,q){return[L,d.FullPaths[q]]}).forEach(function(L){var q=L[0];if(L[1],!!q.name.match(/\.iwa/)){var I=Kn(Yn(q.content));I.forEach(function(R){R.messages.forEach(function(X){u.forEach(function(ae){R.messages.some(function(Z){return Kt(Z.meta[1][0].data)!=11006&&jle(Z.data,ae[1])})&&l[ae[0]].deps.push(R.id)})})})}});for(var f=Ge.find(d,l[1].location),h=Kn(Yn(f.content)),m,p=0;p<h.length;++p){var v=h[p];v.id==1&&(m=v)}var g=$r(ht(m.messages[0].data)[1][0].data);for(f=Ge.find(d,l[g].location),h=Kn(Yn(f.content)),p=0;p<h.length;++p)v=h[p],v.id==g&&(m=v);for(g=$r(ht(m.messages[0].data)[2][0].data),f=Ge.find(d,l[g].location),h=Kn(Yn(f.content)),p=0;p<h.length;++p)v=h[p],v.id==g&&(m=v);for(g=$r(ht(m.messages[0].data)[2][0].data),f=Ge.find(d,l[g].location),h=Kn(Yn(f.content)),p=0;p<h.length;++p)v=h[p],v.id==g&&(m=v);var x=ht(m.messages[0].data);{x[6][0].data=xt(n.e.r+1),x[7][0].data=xt(n.e.c+1);var b=$r(x[46][0].data),y=Ge.find(d,l[b].location),w=Kn(Yn(y.content));{for(var j=0;j<w.length&&w[j].id!=b;++j);if(w[j].id!=b)throw"Bad ColumnRowUIDMapArchive";var N=ht(w[j].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var E=0;E<=n.e.c;++E){var S=[];S[1]=S[2]=[{type:0,data:xt(E+420690)}],N[1].push({type:2,data:kr(S)}),N[2].push({type:0,data:xt(E)}),N[3].push({type:0,data:xt(E)})}N[4]=[],N[5]=[],N[6]=[];for(var O=0;O<=n.e.r;++O)S=[],S[1]=S[2]=[{type:0,data:xt(O+726270)}],N[4].push({type:2,data:kr(S)}),N[5].push({type:0,data:xt(O)}),N[6].push({type:0,data:xt(O)});w[j].messages[0].data=kr(N)}y.content=qi(Ui(w)),y.size=y.content.length,delete x[46];var k=ht(x[4][0].data);{k[7][0].data=xt(n.e.r+1);var T=ht(k[1][0].data),A=$r(T[2][0].data);y=Ge.find(d,l[A].location),w=Kn(Yn(y.content));{if(w[0].id!=A)throw"Bad HeaderStorageBucket";var P=ht(w[0].messages[0].data);for(O=0;O<s.length;++O){var C=ht(P[2][0].data);C[1][0].data=xt(O),C[4][0].data=xt(s[O].length),P[2][O]={type:P[2][0].type,data:kr(C)}}w[0].messages[0].data=kr(P)}y.content=qi(Ui(w)),y.size=y.content.length;var F=$r(k[2][0].data);y=Ge.find(d,l[F].location),w=Kn(Yn(y.content));{if(w[0].id!=F)throw"Bad HeaderStorageBucket";for(P=ht(w[0].messages[0].data),E=0;E<=n.e.c;++E)C=ht(P[2][0].data),C[1][0].data=xt(E),C[4][0].data=xt(n.e.r+1),P[2][E]={type:P[2][0].type,data:kr(C)};w[0].messages[0].data=kr(P)}y.content=qi(Ui(w)),y.size=y.content.length;var M=$r(k[4][0].data);(function(){for(var L=Ge.find(d,l[M].location),q=Kn(Yn(L.content)),I,R=0;R<q.length;++R){var X=q[R];X.id==M&&(I=X)}var ae=ht(I.messages[0].data);{ae[3]=[];var Z=[];o.forEach(function(U,be){Z[1]=[{type:0,data:xt(be)}],Z[2]=[{type:0,data:xt(1)}],Z[3]=[{type:2,data:wle(U)}],ae[3].push({type:2,data:kr(Z)})})}I.messages[0].data=kr(ae);var ee=Ui(q),ie=qi(ee);L.content=ie,L.size=L.content.length})();var H=ht(k[3][0].data);{var V=H[1][0];delete H[2];var B=ht(V.data);{var W=$r(B[2][0].data);(function(){for(var L=Ge.find(d,l[W].location),q=Kn(Yn(L.content)),I,R=0;R<q.length;++R){var X=q[R];X.id==W&&(I=X)}var ae=ht(I.messages[0].data);{delete ae[6],delete H[7];var Z=new Uint8Array(ae[5][0].data);ae[5]=[];for(var ee=0,ie=0;ie<=n.e.r;++ie){var U=ht(Z);ee+=Rle(U,s[ie],o),U[1][0].data=xt(ie),ae[5].push({data:kr(U),type:2})}ae[1]=[{type:0,data:xt(n.e.c+1)}],ae[2]=[{type:0,data:xt(n.e.r+1)}],ae[3]=[{type:0,data:xt(ee)}],ae[4]=[{type:0,data:xt(n.e.r+1)}]}I.messages[0].data=kr(ae);var be=Ui(q),Se=qi(be);L.content=Se,L.size=L.content.length})()}V.data=kr(B)}k[3][0].data=kr(H)}x[4][0].data=kr(k)}m.messages[0].data=kr(x);var z=Ui(h),D=qi(z);return f.content=D,f.size=f.content.length,d}function V5(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function by(e){V5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function wy(e){V5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Lle(e){return ct.WS.indexOf(e)>-1?"sheet":e==ct.CS?"chart":e==ct.DS?"dialog":e==ct.MS?"macro":e&&e.length?e:"sheet"}function Mle(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Lle(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Ble(e,t,r,n,a,s,o,l,c,d,u,f){try{s[n]=dl(On(e,r,!0),t);var h=ir(e,t),m;switch(l){case"sheet":m=ooe(h,t,a,c,s[n],d,u,f);break;case"chart":if(m=loe(h,t,a,c,s[n],d,u,f),!m||!m["!drawel"])break;var p=rl(m["!drawel"].Target,t),v=Bl(p),g=Kre(On(e,p,!0),dl(On(e,v,!0),p)),x=rl(g,p),b=Bl(x);m=Rie(On(e,x,!0),x,c,dl(On(e,b,!0),x),d,m);break;case"macro":m=coe(h,t,a,c,s[n],d,u,f);break;case"dialog":m=uoe(h,t,a,c,s[n],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=m;var y=[];s&&s[n]&&Jt(s[n]).forEach(function(w){var j="";if(s[n][w].Type==ct.CMNT){j=rl(s[n][w].Target,t);var N=moe(ir(e,j,!0),j,c);if(!N||!N.length)return;eE(m,N,!1)}s[n][w].Type==ct.TCMNT&&(j=rl(s[n][w].Target,t),y=y.concat(Xre(ir(e,j,!0),c)))}),y&&y.length&&eE(m,y,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function Hn(e){return e.charAt(0)=="/"?e.slice(1):e}function $le(e,t){if(Io(),t=t||{},by(t),Xn(e,"META-INF/manifest.xml")||Xn(e,"objectdata.xml"))return dE(e,t);if(Xn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof E0<"u"){if(e.FileIndex)return E0(e);var r=Ge.utils.cfb_new();return wN(e).forEach(function(C){st(r,C,ZZ(e,C))}),E0(r)}throw new Error("Unsupported NUMBERS file")}if(!Xn(e,"[Content_Types].xml"))throw Xn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=wN(e),a=WJ(On(e,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ir(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ir(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(fl=[],a.sst)try{fl=hoe(ir(e,Hn(a.sst)),a.sst,t)}catch(C){if(t.WTF)throw C}t.cellStyles&&a.themes.length&&(c=foe(On(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=doe(ir(e,Hn(a.style)),a.style,c,t))}a.links.map(function(C){try{var F=dl(On(e,Bl(Hn(C))),C);return voe(ir(e,Hn(C)),F,C,t)}catch{}});var u=ioe(ir(e,Hn(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=ir(e,Hn(a.coreprops[0]),!0),h&&(f=I4(h)),a.extprops.length!==0&&(h=ir(e,Hn(a.extprops[0]),!0),h&&ZJ(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=On(e,Hn(a.custprops[0]),!0),h&&(m=QJ(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(F){return F.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=m),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var v={};t.bookDeps&&a.calcchain&&(v=poe(ir(e,Hn(a.calcchain)),a.calcchain));var g=0,x={},b,y;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var N=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Xn(e,S)||(S="xl/_rels/workbook."+N+".rels");var O=dl(On(e,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=goe(ir(e,Hn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Jre(ir(e,Hn(a.people[0])),t)),O&&(O=Mle(O,u.Sheets));var k=ir(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var T="sheet";if(O&&O[g]?(b="xl/"+O[g][1].replace(/[\/]?xl\//,""),Xn(e,b)||(b=O[g][1]),Xn(e,b)||(b=S.replace(/_rels\/.*$/,"")+O[g][1]),T=O[g][2]):(b="xl/worksheets/sheet"+(g+1-k)+"."+N,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,P=0;P!=t.sheets.length;++P)typeof t.sheets[P]=="number"&&t.sheets[P]==g&&(A=1),typeof t.sheets[P]=="string"&&t.sheets[P].toLowerCase()==f.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}Ble(e,b,y,f.SheetNames[g],g,x,o,T,t,u,c,d)}return p={Directory:a,Workbook:u,Props:f,Custprops:m,Deps:v,Sheets:o,SheetNames:f.SheetNames,Strings:fl,Styles:d,Themes:c,SSF:Pt(Xe)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(C,F){C=C.replace(/^Root Entry[\/]/,""),p.keys.push(C),p.files[C]=e.FileIndex[F]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=ir(e,Hn(a.vba[0]),!0):a.defaults&&a.defaults.bin===ine&&(p.vbaraw=ir(e,"xl/vbaProject.bin",!0))),p}function zle(e,t){var r=t||{},n="Workbook",a=Ge.find(e,n);try{if(n="/!DataSpaces/Version",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(gte(a.content),n="/!DataSpaces/DataSpaceMap",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=yte(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=bte(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);jte(a.content)}catch{}if(n="/EncryptionInfo",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Nte(a.content);if(n="/EncryptedPackage",a=Ge.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Ule(e,t){return t.bookType=="ods"?H5(e,t):t.bookType=="numbers"?Fle(e,t):t.bookType=="xlsb"?qle(e,t):Wle(e,t)}function qle(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=Pt(Xe)),e&&e.SSF&&(Io(),lf(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=y5.indexOf(t.bookType)>-1,a=iy();wy(t=t||{});var s=V1(),o="",l=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",st(s,o,R4(e.Props,t)),a.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,st(s,o,M4(e.Props)),a.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&Jt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",st(s,o,B4(e.Custprops)),a.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,st(s,o,yoe(l-1,o,t,e,u)),a.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ct.WS[0])}if(f){var m=f["!comments"],p=!1,v="";m&&m.length>0&&(v="xl/comments"+l+"."+r,st(s,v,joe(m,v)),a.comments.push(v),yt(u,-1,"../comments"+l+"."+r,ct.CMNT),p=!0),f["!legacy"]&&p&&st(s,"xl/drawings/vmlDrawing"+l+".vml",g5(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&st(s,Bl(o),Ji(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,st(s,o,woe(t.Strings,o,t)),a.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+r,ct.SST)),o="xl/workbook."+r,st(s,o,xoe(e,o)),a.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",st(s,o,fy(e.Themes,t)),a.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+r,st(s,o,boe(e,o,t)),a.styles.push(o),yt(t.wbrels,-1,"styles."+r,ct.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",st(s,o,e.vbaraw),a.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+r,st(s,o,Noe(o)),a.metadata.push(o),yt(t.wbrels,-1,"metadata."+r,ct.XLMETA),st(s,"[Content_Types].xml",P4(a,t)),st(s,"_rels/.rels",Ji(t.rels)),st(s,"xl/_rels/workbook."+r+".rels",Ji(t.wbrels)),delete t.revssf,delete t.ssf,s}function Wle(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=Pt(Xe)),e&&e.SSF&&(Io(),lf(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=y5.indexOf(t.bookType)>-1,a=iy();wy(t=t||{});var s=V1(),o="",l=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",st(s,o,R4(e.Props,t)),a.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,st(s,o,M4(e.Props)),a.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&Jt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",st(s,o,B4(e.Custprops)),a.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,st(s,o,O5(l-1,t,e,f)),a.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ct.WS[0])}if(h){var p=h["!comments"],v=!1,g="";if(p&&p.length>0){var x=!1;p.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+l+"."+r,st(s,g,Zre(p,u,t)),a.threadedcomments.push(g),yt(f,-1,"../threadedComments/threadedComment"+l+"."+r,ct.TCMNT)),g="xl/comments"+l+"."+r,st(s,g,x5(p)),a.comments.push(g),yt(f,-1,"../comments"+l+"."+r,ct.CMNT),v=!0}h["!legacy"]&&v&&st(s,"xl/drawings/vmlDrawing"+l+".vml",g5(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&st(s,Bl(o),Ji(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,st(s,o,s5(t.Strings,t)),a.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+r,ct.SST)),o="xl/workbook."+r,st(s,o,R5(e)),a.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",st(s,o,fy(e.Themes,t)),a.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+r,st(s,o,h5(e,t)),a.styles.push(o),yt(t.wbrels,-1,"styles."+r,ct.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",st(s,o,e.vbaraw),a.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+r,st(s,o,v5()),a.metadata.push(o),yt(t.wbrels,-1,"metadata."+r,ct.XLMETA),u.length>1&&(o="xl/persons/person.xml",st(s,o,Qre(u)),a.people.push(o),yt(t.wbrels,-1,"persons/person.xml",ct.PEOPLE)),st(s,"[Content_Types].xml",P4(a,t)),st(s,"_rels/.rels",Ji(t.rels)),st(s,"xl/_rels/workbook."+r+".rels",Ji(t.wbrels)),delete t.revssf,delete t.ssf,s}function jy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Rn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Hle(e,t){return Ge.find(e,"EncryptedPackage")?zle(e,t):B5(e,t)}function Vle(e,t){var r,n=e,a=t||{};return a.type||(a.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),r=o4(n,a),$le(r,a)}function G5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Tg(e.slice(r),t);default:break e}return vo.to_workbook(e,t)}function Gle(e,t){var r="",n=jy(e,t);switch(t.type){case"base64":r=Rn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ei(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=jt(r)),t.type="binary",G5(r,t)}function Kle(e,t){var r=e;return t.type=="base64"&&(r=Rn(r)),r=Dl.utils.decode(1200,r.slice(2),"str"),t.type="binary",G5(r,t)}function Yle(e){return e.match(/[^\x00-\x7F]/)?Pa(e):e}function _0(e,t,r,n){return n?(r.type="string",vo.to_workbook(e,r)):vo.to_workbook(t,r)}function Vl(e,t){z1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Vl(new Uint8Array(e),(r=Pt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eo={},r.dateNF&&(eo.dateNF=r.dateNF),r.type||(r.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ot?"buffer":"binary",n=qZ(e),typeof Uint8Array<"u"&&!ot&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Yle(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Pt(r),r.type="array",Vl(U1(n),r)}switch((a=jy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Hle(Ge.read(n,r),r);break;case 9:if(a[1]<=8)return B5(n,r);break;case 60:return Tg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return ete(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return n5.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Vle(n,r):_0(e,n,r,s);case 239:return a[3]===60?Tg(n,r):_0(e,n,r,s);case 255:if(a[1]===254)return Kle(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return di.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return di.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Sg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return u5.to_workbook(n,r);break;case 10:case 13:case 32:return Gle(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Qee.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Sg.to_workbook(n,r):_0(e,n,r,s)}function K5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bc(t.file,Ge.write(e,{type:ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ge.write(e,t)}function Xle(e,t){var r=Pt(t||{}),n=Ule(e,r);return Zle(n,r)}function Zle(e,t){var r={},n=ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ge.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(of(a))}return t.password&&typeof encrypt_agile<"u"?K5(encrypt_agile(a,t.password),t):t.type==="file"?bc(t.file,a):t.type=="string"?jt(a):a}function Jle(e,t){var r=t||{},n=Yoe(e,r);return K5(n,r)}function ka(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Il(Pa(n));case"binary":return Pa(n);case"string":return e;case"file":return bc(t.file,n,"utf8");case"buffer":return ot?ms(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ka(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Qle(e,t){switch(t.type){case"base64":return Il(e);case"binary":return e;case"string":return e;case"file":return bc(t.file,e,"binary");case"buffer":return ot?ms(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Il(r):t.type=="string"?jt(r):r;case"file":return bc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Y5(e,t){z1(),Hie(e);var r=Pt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Y5(e,r);return r.type="array",of(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ka(Uoe(e,r),r);case"slk":case"sylk":return ka(r5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ka(z5(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Qle(X5(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ka(Ey(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ka(n5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return iu(Sg.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ka(vo.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ka(u5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ka(a5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ka(H5(e,r),r);case"wk1":return iu(di.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return iu(di.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),iu($5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Jle(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Xle(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ece(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ny(e,t,r){var n={};return n.type="file",n.file=t,ece(n),Y5(e,n)}function tce(e,t,r,n,a,s,o,l){var c=rr(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var p=o?e[r][m]:e[n[m]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;s[m]!=null&&(h[s[m]]=d);continue}var v=p.v;switch(p.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[m]!=null){if(v==null)if(p.t=="e"&&v===null)h[s[m]]=null;else if(d!==void 0)h[s[m]]=d;else if(u&&v===null)h[s[m]]=null;else continue;else h[s[m]]=u&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?v:as(p,v,l);v!=null&&(f=!1)}}return{row:h,isempty:f}}function md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=ft(u);break;case"number":c=ft(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var f=rr(c.s.r),h=[],m=[],p=0,v=0,g=Array.isArray(e),x=c.s.r,b=0,y={};g&&!e[x]&&(e[x]=[]);var w=d.skipHidden&&e["!cols"]||[],j=d.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(w[b]||{}).hidden)switch(h[b]=$t(b),r=g?e[x][b]:e[h[b]+f],n){case 1:s[b]=b-c.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=d.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=as(r,null,d),v=y[o]||0,!v)y[o]=1;else{do l=o+"_"+v++;while(y[l]);y[o]=v,y[l]=1}s[b]=l}for(x=c.s.r+a;x<=c.e.r;++x)if(!(j[x]||{}).hidden){var N=tce(e,c,x,h,n,s,g,d);(N.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[p++]=N.row)}return m.length=p,m}var vE=/"/g;function rce(e,t,r,n,a,s,o,l){for(var c=!0,d=[],u="",f=rr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=l.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(l.rawNumbers&&m.t=="n"?m.v:as(m,null,l));for(var p=0,v=0;p!==u.length;++p)if((v=u.charCodeAt(p))===a||v===s||v===34||l.forceQuotes){u='"'+u.replace(vE,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(vE,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function Ey(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ft(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(f[p]=$t(p));for(var v=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(u=rce(e,a,g,f,o,c,s,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((v++?l:"")+u)));return delete n.dense,r.join("")}function X5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ey(e,t);return r}function nce(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ft(e["!ref"]),s="",o=[],l,c=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=$t(l);for(var u=a.s.r;u<=a.e.r;++u)for(s=rr(u),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+s,r=d?(e[u]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Z5(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?zt(n.origin):n.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var f=ft(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+a)}else o==-1&&(o=0,u.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(v,g){Jt(v).forEach(function(x){(m=h.indexOf(x))==-1&&(h[m=h.length]=x);var b=v[x],y="z",w="",j=Ze({c:l+m,r:o+g+a});d=Gl(s,j),b&&typeof b=="object"&&!(b instanceof Date)?s[j]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",n.cellDates||(y="n",b=xr(b)),w=n.dateNF||Xe[14]):b===null&&n.nullError&&(y="e",b=0),d?(d.t=y,d.v=b,delete d.w,delete d.R,w&&(d.z=w)):s[j]=d={t:y,v:b},w&&(d.z=w))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var p=rr(o);if(a)for(m=0;m<h.length;++m)s[$t(m+l)+p]={t:"s",v:h[m]};return s["!ref"]=at(u),s}function ace(e,t){return Z5(null,e,t)}function Gl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gl(e,Ze(t)):Gl(e,Ze({r:t,c:r||0}))}function sce(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _y(){return{SheetNames:[],Sheets:{}}}function Sy(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(I5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ice(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=sce(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function oce(e,t){return e.z=t,e}function J5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function lce(e,t,r){return J5(e,"#"+t,r)}function cce(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function uce(e,t,r,n){for(var a=typeof t!="string"?t:ft(t),s=typeof t=="string"?t:at(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Gl(e,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var ea={encode_col:$t,encode_row:rr,encode_cell:Ze,encode_range:at,decode_col:ey,decode_row:Q1,split_cell:wJ,decode_cell:zt,decode_range:yn,format_cell:as,sheet_add_aoa:_4,sheet_add_json:Z5,sheet_add_dom:U5,aoa_to_sheet:Ro,json_to_sheet:ace,table_to_sheet:q5,table_to_book:gle,sheet_to_csv:Ey,sheet_to_txt:X5,sheet_to_json:md,sheet_to_html:z5,sheet_to_formulae:nce,sheet_to_row_object_array:md,sheet_get_cell:Gl,book_new:_y,book_append_sheet:Sy,book_set_sheet_visibility:ice,cell_set_number_format:oce,cell_set_hyperlink:J5,cell_set_internal_link:lce,cell_add_comment:cce,sheet_set_array_formula:uce,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const dce=({show:e,onClose:t,onImport:r,loading:n=!1})=>{const[a,s]=_.useState(!1),[o,l]=_.useState(null),[c,d]=_.useState([]),[u,f]=_.useState([]),[h,m]=_.useState([]),[p,v]=_.useState([]),[g,x]=_.useState(!1),b=_.useRef(null),y=["first_name","last_name","email","role"],w=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];_.useEffect(()=>{e&&j()},[e]);const j=async()=>{try{x(!0);const M=await Qr.getRoles();v(M.roles||[])}catch(M){console.error("Failed to fetch roles:",M),f(["Failed to load roles. Please refresh the page."])}finally{x(!1)}},N=M=>{if(!M||!p.length)return null;const H=M.toUpperCase().trim(),V=p.find(D=>D.name.toUpperCase()===H);if(V)return V.id;const W={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT"}[H];if(W){const D=p.find(L=>L.name.toUpperCase()===W);if(D)return D.id}const z=p.find(D=>D.name.toUpperCase().includes(H)||H.includes(D.name.toUpperCase()));return z?z.id:null},E=()=>{const M=[w,["John","Michael","Doe","123 Main Street, Ho Chi Minh City","john.doe@example.com","+84 123 456 789","TRAINER","CERT001","Flight Training","5","1990-01-15","BATCH2023-01","P123456789","Vietnam"]],H=ea.aoa_to_sheet(M),V=ea.book_new();ea.book_append_sheet(V,H,"Users"),Ny(V,"User_Upload_Template.xlsx")},S=M=>{M.preventDefault(),M.stopPropagation(),M.type==="dragenter"||M.type==="dragover"?s(!0):M.type==="dragleave"&&s(!1)},O=M=>{M.preventDefault(),M.stopPropagation(),s(!1),M.dataTransfer.files&&M.dataTransfer.files[0]&&T(M.dataTransfer.files[0])},k=M=>{M.target.files&&M.target.files[0]&&T(M.target.files[0])},T=M=>{if(!M.name.match(/\.(xlsx|xls)$/)){f(["Please upload an Excel file (.xlsx or .xls)"]);return}if(M.size>100*1024*1024){f(["File size must be less than 100MB"]);return}l(M),f([]),m([]),d([]);const H=new FileReader;H.onload=V=>{try{const B=new Uint8Array(V.target.result),W=Vl(B,{type:"array"}),z=W.SheetNames[0],D=W.Sheets[z],L=ea.sheet_to_json(D,{header:1});if(L.length<2){f(["File must contain at least a header row and one data row"]);return}const q=L[0].map(ie=>ie?ie.toString().toLowerCase().replace(/\s+/g,"_"):""),I=L.slice(1),R={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation"},ae=q.map(ie=>R[ie]||ie).filter(ie=>w.includes(ie)),Z=y.filter(ie=>!ae.includes(ie));if(Z.length>0){m([`Your file is missing these essential data to create a user: ${Z.join(", ")}`]);return}const ee=I.map((ie,U)=>{const be={};let Se=!1;const Re=[];return q.forEach((Le,_e)=>{const he=R[Le]||Le;if(w.includes(he)){const ue=ie[_e]?ie[_e].toString().trim():"";be[he]=ue}}),ae.forEach(Le=>{const _e=be[Le]||"";y.includes(Le)&&!_e&&(Se=!0,Re.push("Required field missing")),Le==="email"&&_e&&!/\S+@\S+\.\S+/.test(_e)&&(Se=!0,Re.push("Invalid email")),Le==="role"&&_e&&(N(_e)||(Se=!0,Re.push("Invalid role"))),Le==="phone_number"&&_e&&_e.length>15&&(Se=!0,Re.push("Phone number too long (max 15 characters)")),Le==="years_of_experience"&&_e&&isNaN(_e)&&(Se=!0,Re.push("Invalid experience value"))}),{id:U+1,...be,hasError:Se,errors:Re,status:Se?"error":"valid"}});d(ee)}catch{f(["Error reading file. Please make sure it's a valid Excel file."])}},H.readAsArrayBuffer(M)},A=async()=>{const M=c.filter(V=>!V.hasError);if(M.length===0){f(["No valid users to import"]);return}if(!p.length){f(["Roles not loaded. Please wait and try again."]);return}const H=M.map(V=>{const B=V.phone_number?V.phone_number.substring(0,15):"",W=N(V.role);if(!W)throw new Error(`Role "${V.role}" not found in system`);const z={firstName:V.first_name||"",middleName:V.middle_name||"",lastName:V.last_name||"",address:V.address||"",email:V.email||"",phoneNumber:B,avatarUrl:V.avatar_url||"",gender:V.gender||"MALE",role:{id:W,name:V.role||""}};return V.role==="TRAINER"?z.trainerProfile={specialization:V.specialization||"",yearsOfExp:V.years_of_experience?parseInt(V.years_of_experience):0,certificationNumber:V.certification_number||"",bio:V.bio||""}:V.role==="TRAINEE"&&(z.traineeProfile={dob:V.date_of_birth||"",enrollmentDate:V.enrollment_date||new Date().toISOString().split("T")[0],trainingBatch:V.training_batch||"",passportNo:V.passport_no||"",nation:V.nation||""}),z});try{await r(H),P()}catch(V){f([V.message||"Failed to import users. Please try again."])}},P=()=>{l(null),d([]),f([]),m([]),s(!1),t()},C=M=>{d(H=>H.filter(V=>V.id!==M))},F=M=>M==="valid"?i.jsx(It,{className:"text-success",size:16}):i.jsx(za,{className:"text-danger",size:16});return i.jsxs(de,{show:e,onHide:P,size:"xl",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-2",size:20}),"Bulk Import Users"]}),i.jsx(le,{variant:"link",onClick:P,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&i.jsxs("div",{className:"text-center mb-3",children:[i.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),i.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),i.jsx(ce,{className:"mb-4",children:i.jsxs(ce.Body,{children:[i.jsxs("div",{className:`upload-area ${a?"drag-active":""}`,onDragEnter:S,onDragLeave:S,onDragOver:S,onDrop:O,onClick:()=>b.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:a?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[i.jsx(to,{size:48,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),i.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),i.jsx("input",{ref:b,type:"file",accept:".xlsx,.xls",onChange:k,style:{display:"none"}})]}),i.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[i.jsxs("div",{children:[o&&i.jsxs("p",{className:"text-success mb-1",children:[i.jsx("strong",{children:"Uploaded file:"})," ",o.name]}),i.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."})]}),i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:E,className:"d-flex align-items-center",children:[i.jsx(Ja,{className:"me-1",size:14}),"Download Template"]})]})]})}),u.length>0&&i.jsx("div",{className:"alert alert-danger mb-3",children:i.jsx("ul",{className:"mb-0",children:u.map((M,H)=>i.jsx("li",{children:M},H))})}),h.length>0&&i.jsx(tt,{variant:"warning",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:h.map((M,H)=>i.jsx("li",{children:M},H))})}),c.length>0&&i.jsxs(ce,{children:[i.jsx(ce.Header,{children:i.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:i.jsxs(Yt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{style:{minWidth:"50px"},children:"NO."}),i.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),i.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),i.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),i.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),i.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),i.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),i.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),i.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),i.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),i.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),i.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),i.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),i.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),i.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),i.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),i.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),i.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),i.jsx("tbody",{children:c.map(M=>i.jsxs("tr",{className:M.hasError?"table-danger":"",children:[i.jsx("td",{children:M.id}),i.jsx("td",{children:M.first_name||M.full_name||"-"}),i.jsx("td",{children:M.middle_name||"-"}),i.jsx("td",{children:M.last_name||"-"}),i.jsx("td",{children:M.email||"-"}),i.jsx("td",{children:M.role||"-"}),i.jsx("td",{children:M.phone_number||"-"}),i.jsx("td",{children:M.gender||"-"}),i.jsx("td",{children:M.certification_number||"-"}),i.jsx("td",{children:M.specialization||"-"}),i.jsx("td",{children:M.years_of_experience||"-"}),i.jsx("td",{children:M.date_of_birth||"-"}),i.jsx("td",{children:M.training_batch||"-"}),i.jsx("td",{children:M.passport_no||"-"}),i.jsx("td",{children:M.nation||"-"}),i.jsx("td",{className:"text-center",children:F(M.status)}),i.jsx("td",{children:M.errors.length>0&&i.jsx("small",{className:"text-danger",children:M.errors.length>1?`${M.errors[0]} (+${M.errors.length-1} more)`:M.errors[0]})}),i.jsx("td",{children:i.jsx(le,{variant:"outline-danger",size:"sm",onClick:()=>C(M.id),children:i.jsx(Oi,{size:14})})})]},M.id))})]})})})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:P,disabled:n,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&i.jsx(CP,{placement:"top",overlay:i.jsxs(PP,{id:"import-tooltip",children:["Only ",c.filter(M=>!M.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:i.jsx(le,{variant:"primary",onClick:A,disabled:n||c.filter(M=>!M.hasError).length===0,children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Dn,{className:"me-2",size:16}),"Import All (",c.filter(M=>!M.hasError).length," users)"]})})})]})]})},fce=({show:e,user:t,onConfirm:r,onCancel:n,loading:a=!1})=>{if(!t)return null;const s=t.status==="ACTIVE",o=s?"Disable":"Enable",c=s?bo:It;return i.jsxs(de,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[i.jsx(de.Header,{closeButton:!0,className:`border-0 ${s?"bg-warning-subtle":"bg-success-subtle"}`,children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:`me-2 ${s?"text-warning":"text-success"}`,size:20}),o," User"]})}),i.jsxs(de.Body,{className:"py-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${s?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:i.jsx(c,{size:32,className:s?"text-warning":"text-success"})}),i.jsx("h5",{className:"mb-3",children:s?"Disable User Account":"Enable User Account"}),i.jsx("p",{className:"text-muted mb-4",children:s?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),i.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[i.jsxs("div",{className:"d-flex align-items-center mb-2",children:[i.jsx("div",{className:"me-3",children:i.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:i.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:t.fullName}),i.jsx("small",{className:"text-muted",children:t.email})]})]}),i.jsxs("div",{className:"row text-center",children:[i.jsxs("div",{className:"col-4",children:[i.jsx("div",{className:"text-muted small",children:"EID"}),i.jsx("div",{className:"fw-medium",children:t.eid})]}),i.jsxs("div",{className:"col-4",children:[i.jsx("div",{className:"text-muted small",children:"Role"}),i.jsx("div",{className:"fw-medium",children:t.role})]}),i.jsxs("div",{className:"col-4",children:[i.jsx("div",{className:"text-muted small",children:"Department"}),i.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),s?i.jsxs(tt,{variant:"warning",className:"mb-0",children:[i.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),i.jsxs("ul",{className:"mb-0 small",children:[i.jsx("li",{children:"User cannot log into the system"}),i.jsx("li",{children:"All active sessions will be terminated"}),i.jsx("li",{children:"User data will be preserved but access restricted"}),i.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):i.jsxs(tt,{variant:"success",className:"mb-0",children:[i.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),i.jsxs("ul",{className:"mb-0 small",children:[i.jsx("li",{children:"User can log into the system normally"}),i.jsx("li",{children:"All permissions and access will be restored"}),i.jsx("li",{children:"User will receive notification of account activation"}),i.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),i.jsxs(de.Footer,{className:"border-0 bg-light",children:[i.jsx(le,{variant:"outline-secondary",onClick:n,disabled:a,children:"Cancel"}),i.jsx(le,{variant:s?"warning":"success",onClick:r,disabled:a,className:"d-flex align-items-center",children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s?"Disabling...":"Enabling..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{className:"me-2",size:16}),o," User"]})})]})]})},hce=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:n,onRoleToggle:a,onDepartmentToggle:s,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return i.jsxs(vr,{className:`filter-panel-dropdown ${l}`,children:[i.jsx(vr.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xo,{size:14,className:"me-2"}),"Filters",c&&i.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]})}),i.jsxs(vr.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[i.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`role-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),i.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),n.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>s("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:n.includes(d),onChange:()=>s(d),className:"mb-1"},d))})]}),c&&i.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:i.jsxs(le,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[i.jsx(Ye,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},mce=({show:e,user:t,newRole:r,onConfirm:n,onCancel:a,loading:s=!1})=>{if(!t)return null;const o=d=>{switch(d){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},l=o(t.role),c=o(r);return i.jsxs(de,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[i.jsx(de.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),i.jsxs(de.Body,{className:"py-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:i.jsx(Gt,{size:32,className:"text-warning"})}),i.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),i.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),i.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[i.jsxs("div",{className:"d-flex align-items-center mb-2",children:[i.jsx("div",{className:"me-3",children:i.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:i.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:t.fullName}),i.jsx("small",{className:"text-muted",children:t.email})]})]}),i.jsxs("div",{className:"row text-center",children:[i.jsxs("div",{className:"col-6",children:[i.jsx("div",{className:"text-muted small",children:"Current Role"}),i.jsx("div",{className:"fw-medium",children:t.role})]}),i.jsxs("div",{className:"col-6",children:[i.jsx("div",{className:"text-muted small",children:"New Role"}),i.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),i.jsxs(tt,{variant:"warning",className:"mb-0",children:[i.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),i.jsxs("ul",{className:"mb-0 small",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",l,")"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),i.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),i.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),i.jsxs(de.Footer,{className:"border-0 bg-light",children:[i.jsxs(le,{variant:"outline-secondary",onClick:a,disabled:s,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"warning",onClick:()=>{n()},disabled:s,className:"d-flex align-items-center",children:s?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(It,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},pce=({show:e,user:t,mode:r,onSave:n,onClose:a})=>{const[s,o]=_.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[l,c]=_.useState({}),[d,u]=_.useState(!1),[f,h]=_.useState([]),[m,p]=_.useState(!1),[v,g]=_.useState([]),[x,b]=_.useState(!1),[y,w]=_.useState([]),j=async()=>{p(!0);try{const C=await gt.getDepartments(),M=(C.departments||C.data||[]).map(H=>H.name);h(M)}catch(C){console.error("Error fetching departments:",C),ye.error("Failed to load departments"),h([])}finally{p(!1)}},N=async()=>{b(!0);try{const C=await En.getRoles(),M=(C.roles||C.data||[]).map(H=>H.name);g(M)}catch(C){console.error("Error fetching roles:",C),ye.error("Failed to load roles"),g([])}finally{b(!1)}},E=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],S=async()=>{try{const F=(await gt.getDepartments({includeDeleted:!0}))?.departments?.filter(M=>M.headUser)||[];w(F)}catch(C){console.error("Error fetching departments with heads:",C),w([])}};_.useEffect(()=>{e&&(j(),N(),S())},[e]),_.useEffect(()=>{t&&r!=="add"?o({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&o({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const O=()=>{const C={};if(s.firstName.trim()?/^[a-zA-Z\s]+$/.test(s.firstName.trim())||(C.firstName="First name can only contain letters and spaces"):C.firstName="First name is required",s.lastName.trim()?/^[a-zA-Z\s]+$/.test(s.lastName.trim())||(C.lastName="Last name can only contain letters and spaces"):C.lastName="Last name is required",s.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(s.middleName.trim())&&(C.middleName="Middle name can only contain letters and spaces"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(C.email="Email is invalid"):C.email="Email is required",!s.phoneNumber.trim())C.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(s.phoneNumber))C.phoneNumber="Phone number cannot contain letters";else{const F=s.phoneNumber.replace(/[^\d+]/g,"");(F.length<7||F.length>16)&&(C.phoneNumber="Phone number must be 7-16 digits")}if(s.role||(C.role="Role is required"),s.role==="DEPARTMENT_HEAD")if(!s.department.trim())C.department="Department is required for department heads";else{const F=y.find(M=>{const H=M.name,V=s.department,B=M.headUser?.id,W=H&&V&&H.toLowerCase()===V.toLowerCase(),z=r!=="edit"||B!==t?.id;return W&&z});if(F){const M=`${F.headUser?.firstName||""} ${F.headUser?.lastName||""}`.trim();C.department=`Department "${s.department}" already has a head: ${M}`}}return s.role==="TRAINER"&&(s.specialization.trim()||(C.specialization="Specialization is required for trainers"),s.certificationNumber.trim()||(C.certificationNumber="Certification number is required for trainers")),s.role==="TRAINEE"&&(s.trainingBatch.trim()||(C.trainingBatch="Training batch is required for trainees"),s.passportNo.trim()?/^\d{1,9}$/.test(s.passportNo.trim())||(C.passportNo="Passport number must be 1-9 digits only"):C.passportNo="Passport number is required for trainees",s.dateOfBirth.trim()?s.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(s.dateOfBirth)?C.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(s.dateOfBirth)>=new Date&&(C.dateOfBirth="Date of birth must be in the past"):C.dateOfBirth="Date of birth is required for trainees"),c(C),Object.keys(C).length===0},k=async C=>{if(C.preventDefault(),!!O()&&!d){u(!0);try{await n(s)}catch(F){console.error("Error in handleSubmit:",F)}finally{u(!1)}}},T=(C,F)=>{o(M=>({...M,[C]:F})),c(M=>{const H={...M};if(H[C]&&delete H[C],C==="role"&&(delete H.specialization,delete H.certificationNumber,delete H.trainingBatch,delete H.passportNo,delete H.dateOfBirth,delete H.department),C==="department"&&(delete H.department,s.role==="DEPARTMENT_HEAD"))if(!F.trim())H.department="Department is required for department heads";else{const V=y.find(B=>{const W=B.name,z=F,D=B.headUser?.id;return W&&z&&W.toLowerCase()===z.toLowerCase()&&(r!=="edit"||D!==t?.id)});if(V){const B=`${V.headUser?.firstName||""} ${V.headUser?.lastName||""}`.trim();H.department=`Department "${F}" already has a head: ${B}`}}return H})},A=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},P=r==="view";return i.jsxs(de,{show:e,onHide:a,size:"lg",centered:!0,children:[i.jsx(de.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[r==="view"?i.jsx(Xt,{className:"me-2",size:20}):i.jsx(wa,{className:"me-2",size:20}),A()]})}),i.jsxs(Y,{onSubmit:k,children:[i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(l).length>0&&i.jsxs("div",{className:"alert alert-danger mb-3",children:[i.jsx("strong",{children:"Please fix the following errors:"}),i.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([C,F])=>i.jsx("li",{children:F},C))})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:4,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),i.jsx(Y.Control,{type:"text",value:s.firstName,onChange:C=>T("firstName",C.target.value),isInvalid:!!l.firstName,readOnly:P,style:{borderColor:l.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.firstName})]})}),i.jsx(oe,{md:4,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),i.jsx(Y.Control,{type:"text",value:s.middleName,onChange:C=>T("middleName",C.target.value),isInvalid:!!l.middleName,readOnly:P,style:{borderColor:l.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.middleName})]})}),i.jsx(oe,{md:4,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),i.jsx(Y.Control,{type:"text",value:s.lastName,onChange:C=>T("lastName",C.target.value),isInvalid:!!l.lastName,readOnly:P,style:{borderColor:l.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),i.jsx(Y.Control,{type:"email",value:s.email,onChange:C=>T("email",C.target.value),isInvalid:!!l.email,readOnly:P,style:{borderColor:l.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.email})]})})}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),i.jsx(Y.Control,{type:"tel",value:s.phoneNumber,onChange:C=>T("phoneNumber",C.target.value),isInvalid:!!l.phoneNumber,readOnly:P,placeholder:"Enter phone number",style:{borderColor:l.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.phoneNumber})]})})}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),i.jsx(Y.Control,{as:"textarea",rows:3,value:s.address,onChange:C=>T("address",C.target.value),readOnly:P,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),i.jsxs(Ee,{children:[i.jsx(oe,{md:s.role==="DEPT_HEAD"||s.role==="TRAINER"?6:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),i.jsxs(Y.Select,{value:s.role,onChange:C=>T("role",C.target.value),isInvalid:!!l.role,disabled:P||x,style:{borderColor:l.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[i.jsx("option",{value:"",children:x?"Loading roles...":"Select a role"}),v.map(C=>i.jsx("option",{value:C,children:C},C))]}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.role})]})}),(s.role==="DEPARTMENT_HEAD"||s.role==="TRAINER")&&i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),i.jsxs(Y.Select,{value:s.department,onChange:C=>T("department",C.target.value),isInvalid:!!l.department,disabled:P||m,style:{borderColor:l.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[i.jsx("option",{value:"",children:m?"Loading departments...":"Select a department"}),f.map(C=>i.jsx("option",{value:C,children:C},C))]}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.department})]})})]}),s.role==="TRAINER"&&i.jsxs(i.Fragment,{children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),i.jsx(Y.Control,{type:"text",value:s.specialization,onChange:C=>T("specialization",C.target.value),isInvalid:!!l.specialization,readOnly:P,placeholder:"Enter specialization",style:{borderColor:l.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.specialization})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),i.jsx(Y.Control,{type:"text",value:s.certificationNumber,onChange:C=>T("certificationNumber",C.target.value),isInvalid:!!l.certificationNumber,readOnly:P,placeholder:"Enter certification number",style:{borderColor:l.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.certificationNumber})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),i.jsx(Y.Control,{type:"number",value:s.yearsOfExperience,onChange:C=>T("yearsOfExperience",C.target.value),readOnly:P,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})})]}),s.role==="TRAINEE"&&i.jsxs(i.Fragment,{children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),i.jsx(Y.Control,{type:"date",value:s.dateOfBirth,onChange:C=>{const F=C.target.value;(F===""||F.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(F))&&T("dateOfBirth",F)},isInvalid:!!l.dateOfBirth,readOnly:P,max:"2024-12-31",min:"1900-01-01",style:{borderColor:l.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.dateOfBirth})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),i.jsx(Y.Control,{type:"text",value:s.trainingBatch,onChange:C=>T("trainingBatch",C.target.value),isInvalid:!!l.trainingBatch,readOnly:P,placeholder:"Enter training batch",style:{borderColor:l.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.trainingBatch})]})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),i.jsx(Y.Control,{type:"text",value:s.passportNo,onChange:C=>T("passportNo",C.target.value),isInvalid:!!l.passportNo,readOnly:P,placeholder:"Enter passport number",style:{borderColor:l.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.passportNo})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),i.jsxs(Y.Select,{value:s.nation,onChange:C=>T("nation",C.target.value),disabled:P,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[i.jsx("option",{value:"",children:"Select a nation"}),E.map(C=>i.jsx("option",{value:C,children:C},C))]})]})})]})]}),r==="view"&&t&&i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),i.jsx(Y.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:a,disabled:d,children:[i.jsx(Ye,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&i.jsx(le,{variant:"primary-custom",type:"submit",disabled:d,children:d?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},vce=({user:e,index:t,onView:r,onEdit:n,onDisable:a})=>{const s=l=>l==="ACTIVE"?"success":"secondary",o=l=>l==="ACTIVE"?"":"";return i.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx("span",{className:"text-dark",children:e.email})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:e.department})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsxs($e,{bg:s(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[i.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:o(e.status)}),e.status]})}),i.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:i.jsx(sn,{permissions:[Me.USERS.VIEW_DETAIL,Me.USERS.UPDATE],fallback:null,children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Details",icon:i.jsx(Xt,{}),onClick:()=>r(e),permission:Me.USERS.VIEW_DETAIL},{label:"Edit User",icon:i.jsx(ya,{}),onClick:()=>n(e),permission:Me.USERS.UPDATE},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:i.jsx(bo,{}),className:"text-danger",onClick:()=>a(e),permission:Me.USERS.UPDATE}]})})})]})},Bn=(e,t=null,r="asc")=>{const[n,a]=_.useState({key:t,direction:r});return{sortedData:_.useMemo(()=>!n.key||!e?e:[...e].sort((d,u)=>{let f=d[n.key],h=u[n.key];if(n.key.includes(".")){const m=n.key.split(".");f=m.reduce((p,v)=>p?.[v],d),h=m.reduce((p,v)=>p?.[v],u)}if(n.key.includes("length")){const m=n.key.replace(".length","");f=d[m]?.length||0,h=u[m]?.length||0}return typeof f=="string"&&typeof h=="string"&&(f=f.toLowerCase(),h=h.toLowerCase()),f<h?n.direction==="asc"?-1:1:f>h?n.direction==="asc"?1:-1:0}),[e,n]),sortConfig:n,handleSort:d=>{let u="asc";if(n.key===d&&n.direction==="asc")u="desc";else if(n.key===d&&n.direction==="desc"){a({key:null,direction:"asc"});return}a({key:d,direction:u})},getSortIcon:d=>n.key!==d?"":n.direction==="asc"?"":"",getSortClass:d=>n.key!==d?"text-muted":(n.direction==="asc","text-primary")}},gce=({users:e,loading:t,onView:r,onEdit:n,onDisable:a})=>{const{sortedData:s,sortConfig:o,handleSort:l}=Bn(e);if(t)return i.jsx(Ln,{rows:5,columns:6});if(e.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No users found"}),i.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:d,children:u,className:f=""})=>{const h=o.key===d,m=h?o.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${f} ${h?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="transparent",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"600":"500"},children:u}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:m,size:14})})]}),h&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsx("div",{className:"scrollable-table-container admin-table",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[i.jsx("thead",{className:"sticky-header",children:i.jsxs("tr",{children:[i.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),i.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),i.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),i.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),i.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),i.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:s.map((d,u)=>i.jsx(vce,{user:d,index:u,onView:r,onEdit:n,onDisable:a},d.id))})]})})},xce=()=>{const[e,t]=_.useState([]),[r,n]=_.useState([]),[a,s]=_.useState(""),[o,l]=_.useState([]),[c,d]=_.useState([]),[u,f]=_.useState(!1),[h,m]=_.useState(null),[p,v]=_.useState("view"),[g,x]=_.useState(!1),[b,y]=_.useState(null),[w,j]=_.useState(!1),[N,E]=_.useState(null);_.useEffect(()=>{(async()=>{x(!0);try{const[R,X]=await Promise.all([Qr.getUsers({includeDeleted:!0}),gt.getDepartments({includeDeleted:!0})]),ae=R.data.map(ee=>({id:ee.id,eid:ee.eid,fullName:[ee.firstName,ee.middleName,ee.lastName].filter(Boolean).join(" "),firstName:ee.firstName,middleName:ee.middleName,lastName:ee.lastName,role:ee.role?.name||"N/A",roleId:ee.role?.id||"",department:ee.department?.name||"N/A",status:ee.status,email:ee.email,phoneNumber:ee.phoneNumber||"",address:ee.address||"",certificationNumber:ee.certificationNumber||"",specialization:ee.specialization||"",yearsOfExperience:ee.yearsOfExperience||"",dateOfBirth:ee.dateOfBirth||"",trainingBatch:ee.trainingBatch||"",passportNo:ee.passportNo||"",nation:ee.nation||"",createdAt:ee.createdAt,lastLogin:ee.lastLogin||""})),Z=X.departments||X||[];t(ae),n(Z),y(null)}catch(R){const X=ua(R,{});y(X)}finally{x(!1)}})()},[]);const S=[...new Set(e.map(I=>I.role).filter(Boolean))],O=[...new Set(r.map(I=>I.name).filter(Boolean)),...new Set(e.map(I=>I.department).filter(Boolean))].filter((I,R,X)=>X.indexOf(I)===R),k=e.filter(I=>{const R=!a||I.fullName.toLowerCase().includes(a.toLowerCase())||I.eid.toLowerCase().includes(a.toLowerCase())||I.email.toLowerCase().includes(a.toLowerCase()),X=o.length===0||o.includes(I.role),ae=c.length===0||c.includes(I.department);return R&&X&&ae}),T=I=>s(I),A=I=>{l(R=>R.includes(I)?R.filter(X=>X!==I):[...R,I])},P=I=>{d(R=>R.includes(I)?R.filter(X=>X!==I):[...R,I])},C=()=>{l([]),d([]),s("")},F=async I=>{try{x(!0);const R=await Qr.getUserById(I.id),X={id:R.id,eid:R.eid,fullName:[R.firstName,R.middleName,R.lastName].filter(Boolean).join(" "),firstName:R.firstName,middleName:R.middleName,lastName:R.lastName,role:R.role?.name||"N/A",roleId:R.role?.id||"",department:R.department?.name||"N/A",status:R.status,email:R.email,phoneNumber:R.phoneNumber||"",address:R.address||"",certificationNumber:R.trainerProfile?.certificationNumber||"",specialization:R.trainerProfile?.specialization||"",yearsOfExperience:R.trainerProfile?.yearsOfExp||"",dateOfBirth:R.traineeProfile?.dob?R.traineeProfile.dob.split("T")[0]:"",trainingBatch:R.traineeProfile?.trainingBatch||"",passportNo:R.traineeProfile?.passportNo||"",nation:R.traineeProfile?.nation||"",createdAt:R.createdAt,lastLogin:R.lastLogin||""};m(X),v("view"),f(!0)}catch{y("Unable to load user details")}finally{x(!1)}},M=async I=>{try{x(!0);const R=await Qr.getUserById(I.id),X={id:R.id,eid:R.eid,fullName:[R.firstName,R.middleName,R.lastName].filter(Boolean).join(" "),firstName:R.firstName,middleName:R.middleName,lastName:R.lastName,role:R.role?.name||"N/A",roleId:R.role?.id||"",department:R.department?.name||"N/A",status:R.status,email:R.email,phoneNumber:R.phoneNumber||"",address:R.address||"",certificationNumber:R.trainerProfile?.certificationNumber||"",specialization:R.trainerProfile?.specialization||"",yearsOfExperience:R.trainerProfile?.yearsOfExp||"",dateOfBirth:R.traineeProfile?.dob?R.traineeProfile.dob.split("T")[0]:"",trainingBatch:R.traineeProfile?.trainingBatch||"",passportNo:R.traineeProfile?.passportNo||"",nation:R.traineeProfile?.nation||"",createdAt:R.createdAt,lastLogin:R.lastLogin||""};m(X),v("edit"),f(!0)}catch{y("Unable to load user details")}finally{x(!1)}},H=()=>{m(null),v("add"),f(!0)},V=async I=>{try{x(!0);let R,X;I.status==="ACTIVE"?(R=await Qr.disableUser(I.id),X="disabled"):(R=await Qr.enableUser(I.id),X="enabled");const[ae,Z]=await Promise.all([Qr.getUsers({includeDeleted:!0}),gt.getDepartments({includeDeleted:!0})]),ee=ae.data.map(be=>({id:be.id,eid:be.eid,fullName:[be.firstName,be.middleName,be.lastName].filter(Boolean).join(" "),firstName:be.firstName,middleName:be.middleName,lastName:be.lastName,role:be.role?.name||"N/A",roleId:be.role?.id||"",department:be.department?.name||"N/A",status:be.status,email:be.email,phoneNumber:be.phoneNumber||"",address:be.address||"",certificationNumber:be.trainerProfile?.certificationNumber||"",specialization:be.trainerProfile?.specialization||"",yearsOfExperience:be.trainerProfile?.yearsOfExp||"",dateOfBirth:be.traineeProfile?.dob?be.traineeProfile.dob.split("T")[0]:"",trainingBatch:be.traineeProfile?.trainingBatch||"",passportNo:be.traineeProfile?.passportNo||"",nation:be.traineeProfile?.nation||"",createdAt:be.createdAt,lastLogin:be.lastLogin||""})),ie=Z.departments||Z||[];t(ee),n(ie);const U=R?.message||`User has been ${X} successfully!`;ye.success(U)}catch(R){const X=ua(R,{});y(X),ye.error(X)}finally{x(!1)}},B=async I=>{try{if(x(!0),p==="edit"&&h&&h.role!==I.role){E(I),j(!0),x(!1);return}await W(I)}catch{x(!1)}},W=async I=>{try{x(!0);let R=null;try{const be=(await Qr.getRoles()).roles?.find(Se=>Se.name===I.role);if(be)R=be.id;else throw new Error(`Role '${I.role}' not found in backend`)}catch(U){throw new Error(`Failed to get role ID for '${I.role}': ${U.message}`)}const X={firstName:I.firstName,middleName:I.middleName||"",lastName:I.lastName,address:I.address||"",email:I.email,gender:"MALE",avatarUrl:"",phoneNumber:I.phoneNumber||"",role:{id:R,name:I.role}};I.role==="TRAINER"?X.trainerProfile={specialization:I.specialization||"",certificationNumber:I.certificationNumber||"",yearsOfExp:I.yearsOfExperience?parseInt(I.yearsOfExperience):0,bio:""}:I.role==="TRAINEE"&&(I.dateOfBirth||I.trainingBatch||I.passportNo||I.nation)&&(X.traineeProfile={dob:I.dateOfBirth||null,enrollmentDate:new Date().toISOString().split("T")[0],trainingBatch:I.trainingBatch||"",passportNo:I.passportNo||"",nation:I.nation||""}),p==="add"?(await Qr.createUser(X),ye.success("User created successfully!")):p==="edit"&&(await Qr.updateUser(h.id,X),ye.success("User updated successfully!")),f(!1);const[ae,Z]=await Promise.all([Qr.getUsers({includeDeleted:!0}),gt.getDepartments({includeDeleted:!0})]);if(p==="edit"&&h?.id){const U=ae.data.find(be=>be.id===h.id)}const ee=ae.data.map(U=>({id:U.id,eid:U.eid,fullName:[U.firstName,U.middleName,U.lastName].filter(Boolean).join(" "),firstName:U.firstName,middleName:U.middleName,lastName:U.lastName,role:U.role?.name||"N/A",roleId:U.role?.id||"",department:U.department?.name||"N/A",status:U.status,email:U.email,phoneNumber:U.phoneNumber||"",address:U.address||"",certificationNumber:U.trainerProfile?.certificationNumber||"",specialization:U.trainerProfile?.specialization||"",yearsOfExperience:U.trainerProfile?.yearsOfExp||"",dateOfBirth:U.traineeProfile?.dob?U.traineeProfile.dob.split("T")[0]:"",trainingBatch:U.traineeProfile?.trainingBatch||"",passportNo:U.traineeProfile?.passportNo||"",nation:U.traineeProfile?.nation||"",createdAt:U.createdAt,lastLogin:U.lastLogin||""})),ie=Z.departments||Z||[];t(ee),n(ie)}catch(R){const X=ua(R,{});throw y(X),new Error(X)}finally{x(!1)}};return{users:k,searchTerm:a,selectedRoles:o,selectedDepartments:c,uniqueRoles:S,uniqueDepartments:O,modalShow:u,selectedUser:h,modalMode:p,loading:g,error:b,confirmRoleChange:w,pendingUserData:N,handleSearch:T,handleRoleToggle:A,handleDepartmentToggle:P,handleClearFilters:C,handleView:F,handleEdit:M,handleAdd:H,handleDisable:V,handleSave:B,handleBulkImport:async I=>{try{x(!0);const R=await Qr.bulkImportUsers(I);if(R.success&&R.success.length>0&&ye.success(`Successfully imported ${R.success.length} users!`),R.failed&&R.failed.length>0){const ie=R.failed.map(U=>`User ${U.index+1}: ${U.error}`);ye.error(`Failed to import ${R.failed.length} users: ${ie.join(", ")}`)}const[X,ae]=await Promise.all([Qr.getUsers({includeDeleted:!0}),gt.getDepartments({includeDeleted:!0})]),Z=X.data.map(ie=>({id:ie.id,eid:ie.eid,fullName:[ie.firstName,ie.middleName,ie.lastName].filter(Boolean).join(" "),firstName:ie.firstName,middleName:ie.middleName,lastName:ie.lastName,role:ie.role?.name||"N/A",roleId:ie.role?.id||"",department:ie.department?.name||"N/A",status:ie.status,email:ie.email,phoneNumber:ie.phoneNumber||"",address:ie.address||"",certificationNumber:ie.trainerProfile?.certificationNumber||"",specialization:ie.trainerProfile?.specialization||"",yearsOfExperience:ie.trainerProfile?.yearsOfExp||"",dateOfBirth:ie.traineeProfile?.dob?ie.traineeProfile.dob.split("T")[0]:"",trainingBatch:ie.traineeProfile?.trainingBatch||"",passportNo:ie.traineeProfile?.passportNo||"",nation:ie.traineeProfile?.nation||"",createdAt:ie.createdAt,lastLogin:ie.lastLogin||""})),ee=ae.departments||ae||[];t(Z),n(ee)}catch(R){const X=ua(R,{});y(X),ye.error(X)}finally{x(!1)}},handleModalClose:()=>{f(!1),m(null)},handleConfirmRoleChange:async()=>{j(!1),N&&(await W(N),E(null))},handleCancelRoleChange:()=>{j(!1),E(null)},setError:y}},yce=()=>{const[e,t]=_.useState(!1),[r,n]=_.useState(null),[a,s]=_.useState(!1),[o,l]=_.useState(!1),{users:c,loading:d,error:u,searchTerm:f,selectedRoles:h,selectedDepartments:m,uniqueRoles:p,uniqueDepartments:v,modalShow:g,selectedUser:x,modalMode:b,confirmRoleChange:y,pendingUserData:w,handleSearch:j,handleRoleToggle:N,handleDepartmentToggle:E,handleClearFilters:S,handleView:O,handleEdit:k,handleAdd:T,handleDisable:A,handleSave:P,handleBulkImport:C,handleModalClose:F,handleConfirmRoleChange:M,handleCancelRoleChange:H}=xce(),V=z=>{n(z),t(!0)},B=async()=>{if(r){s(!0);try{await A(r),t(!1),n(null)}catch(z){console.error("Error disabling user:",z)}finally{s(!1)}}},W=()=>{t(!1),n(null)};return se.useEffect(()=>{u&&ye.error(u)},[u]),i.jsx(He,{fluid:!0,className:"py-4 user-management-page",children:i.jsxs(ce,{className:"border-neutral-200 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-light-custom border-neutral-200",children:i.jsx(Ee,{className:"align-items-center",children:i.jsx(oe,{xs:12,className:"mt-2 mt-md-0 mb-3",children:i.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[i.jsx(sn,{permission:Me.USERS.BULK_CREATE,fallback:null,children:i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:()=>l(!0),className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-1",size:16}),i.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),i.jsx("span",{className:"d-sm-none",children:"Import"})]})}),i.jsx(sn,{permission:Me.USERS.CREATE,fallback:null,children:i.jsxs(le,{variant:"primary-custom",size:"sm",onClick:T,className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-1",size:16}),"Add User"]})})]})})})}),i.jsxs(ce.Body,{children:[i.jsxs(Ee,{className:"mb-3 form-mobile-stack search-filter-section",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search users by name, EID, or email...",value:f,onChange:j,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(hce,{uniqueRoles:p,uniqueDepartments:v,selectedRoles:h,selectedDepartments:m,onRoleToggle:N,onDepartmentToggle:E,onClearFilters:S,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[c.length," user",c.length!==1?"s":""]})})})]}),i.jsxs("div",{className:"position-relative",children:[i.jsx(gce,{users:c,loading:d,onView:O,onEdit:k,onDisable:V}),c.length>8&&i.jsxs("div",{className:"scroll-indicator",children:[i.jsx(hi,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),i.jsx(pce,{show:g,user:x,mode:b,onSave:P,onClose:F}),i.jsx(dce,{show:o,onClose:()=>l(!1),onImport:C,loading:d}),i.jsx(fce,{show:e,user:r,onConfirm:B,onCancel:W,loading:a}),i.jsx(mce,{show:y,user:x,newRole:w?.role,onConfirm:M,onCancel:H,loading:d})]})]})})},bce=({show:e,role:t,onConfirm:r,onCancel:n,loading:a})=>{if(!t)return null;const s=t.status==="Active",o=s?"Disable":"Enable",c=s?ES:It;return i.jsxs(de,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[i.jsx(de.Header,{closeButton:!0,className:`text-white ${s?"bg-warning":"bg-success"}`,style:{borderBottom:"none"},children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(c,{size:24,className:"me-2"}),o," Role: ",t.name]})}),i.jsxs(de.Body,{className:"py-4",children:[i.jsxs("div",{className:"d-flex align-items-center mb-3",children:[i.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:s?"var(--bs-warning)":"var(--bs-success)",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("h6",{className:"mb-0",children:t.name}),i.jsx("small",{className:"text-muted",children:t.description})]})]}),s?i.jsxs(tt,{variant:"warning",className:"mb-3",children:[i.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2"})," Warning: Disabling Role"]}),i.jsxs("p",{className:"mb-1",children:["This action will disable the ",i.jsx("span",{className:"fw-bold",children:t.name})," role."]}),i.jsxs("ul",{className:"mb-0 ps-3",children:[i.jsx("li",{children:"Users with this role will lose access to associated permissions."}),i.jsx("li",{children:"Role data will be preserved but access will be restricted."}),i.jsx("li",{children:"Role can be re-enabled later by an administrator."}),i.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):i.jsxs(tt,{variant:"success",className:"mb-3",children:[i.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[i.jsx(It,{className:"me-2"})," Confirm: Enabling Role"]}),i.jsxs("p",{className:"mb-1",children:["This action will restore the ",i.jsx("span",{className:"fw-bold",children:t.name})," role."]}),i.jsxs("ul",{className:"mb-0 ps-3",children:[i.jsx("li",{children:"Users with this role will regain access to associated permissions."}),i.jsx("li",{children:"All role permissions and access will be restored."}),i.jsx("li",{children:"Role will be available for assignment to new users."}),i.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),i.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[i.jsx(le,{variant:"outline-secondary",onClick:n,disabled:a,children:"Cancel"}),i.jsx(le,{variant:s?"warning":"success",onClick:r,disabled:a,className:"d-flex align-items-center",children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s?"Disabling...":"Enabling..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{size:16,className:"me-2"}),o," Role"]})})]})]})]})},wce=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:n,className:a=""})=>{const s=t.length>0;return i.jsxs(vr,{className:`filter-panel-dropdown ${a}`,children:[i.jsx(vr.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xo,{size:14,className:"me-2"}),"Filters",s&&i.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),i.jsxs(vr.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[i.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>i.jsx(Y.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),s&&i.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:i.jsxs(le,{variant:"outline-danger",size:"sm",className:"w-100",onClick:n,children:[i.jsx(Ye,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},jce=["ADMINISTRATOR"],gE=e=>jce.includes(e?.toUpperCase()),Nce=({show:e,role:t,mode:r,onSave:n,onClose:a})=>{const[s,o]=_.useState({name:"",description:"",permissionIds:[]}),[l,c]=_.useState({}),[d,u]=_.useState(!1),[f,h]=_.useState({}),{getPermissionGroups:m,loading:p,error:v}=Jl(),g=_.useMemo(()=>{const S=m();if(r==="view"&&t?.permissions){const O=t.permissions.map(k=>k.id||k);return S.map(k=>({...k,permissions:k.permissions.filter(T=>O.includes(T.id))})).filter(k=>k.permissions.length>0)}return S},[m,r,t?.permissions]);_.useEffect(()=>{if(console.log("RoleModal useEffect - Role:",t),console.log("RoleModal useEffect - Mode:",r),console.log("RoleModal useEffect - Role permissions:",t?.permissions),t&&r!=="add"){const S=t.permissions?t.permissions.map(O=>O.id||O):[];console.log("RoleModal useEffect - Mapped permission IDs:",S),o({name:t.name||"",description:t.description||"",permissionIds:S})}else r==="add"&&o({name:"",description:"",permissionIds:[]});c({})},[t,r,e]),_.useEffect(()=>{if(r==="view"){const S={};g.map(k=>k.id).forEach(k=>{S[k]=!0}),h(S)}else if(r==="edit"){const S={};g.map(k=>k.id).forEach(k=>{S[k]=!0}),h(S)}else h({})},[r,g]);const x=()=>{const S={};return s.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(s.name.trim())||(S.name="Role name cannot contain special characters"):S.name="Role name is required",s.permissionIds.length===0&&(S.permissionIds="At least one permission is required"),c(S),Object.keys(S).length===0},b=async S=>{if(S.preventDefault(),!!x()){u(!0);try{await n(s)}catch(O){console.error("Error saving role:",O)}finally{u(!1)}}},y=(S,O)=>{o(k=>({...k,[S]:O})),l[S]&&c(k=>({...k,[S]:""}))},w=S=>{o(O=>({...O,permissionIds:O.permissionIds.includes(S)?O.permissionIds.filter(k=>k!==S):[...O.permissionIds,S]})),l.permissionIds&&c(O=>({...O,permissionIds:""}))},j=S=>{h(O=>({...O,[S]:!O[S]}))},N=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},E=r==="view";return i.jsxs(de,{show:e,onHide:a,size:"lg",centered:!0,children:[i.jsx(de.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[r==="view"?i.jsx(Xt,{className:"me-2",size:20}):i.jsx(Ig,{className:"me-2",size:20}),N()]})}),i.jsxs(Y,{onSubmit:b,children:[i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&gE(t.name)&&r==="edit"&&i.jsxs(tt,{variant:"warning",className:"mb-3",children:[i.jsx(Gt,{className:"me-2"}),i.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(l).length>0&&i.jsxs("div",{className:"alert alert-danger mb-3",children:[i.jsx("strong",{children:"Please fix the following errors:"}),i.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([S,O])=>i.jsx("li",{children:O},S))})]}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsx(Y.Group,{className:"mb-4",children:i.jsxs(Ee,{className:"align-items-center",children:[i.jsx(oe,{md:3,children:i.jsx(Y.Label,{className:"text-primary-custom fw-semibold fs-5 mb-0",children:"Role Name *"})}),i.jsxs(oe,{md:6,children:[i.jsx(Y.Control,{type:"text",value:s.name,onChange:S=>{const O=S.target.value;/^[a-zA-Z0-9\s_]*$/.test(O)&&y("name",O)},isInvalid:!!l.name,readOnly:E,style:{borderColor:l.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.name})]})]})})})}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsx(Y.Group,{className:"mb-4",children:i.jsxs(Ee,{className:"align-items-start",children:[i.jsx(oe,{md:3,children:i.jsx(Y.Label,{className:"text-primary-custom fw-semibold fs-5 mb-0",children:"Description"})}),i.jsx(oe,{md:6,children:i.jsx(Y.Control,{as:"textarea",rows:3,value:s.description,onChange:S=>y("description",S.target.value),readOnly:E,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px",resize:"none"}})})]})})})}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),l.permissionIds&&i.jsx("div",{className:"text-danger small mb-2",children:l.permissionIds}),v&&i.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",v.message||"Unknown error"]}),i.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"190px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:p?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(ur,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):i.jsx(i.Fragment,{children:g.map(S=>{const O=f[S.id];return i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${E?"":"cursor-pointer"}`,onClick:()=>!E&&j(S.id),role:E?void 0:"button",tabIndex:E?void 0:0,onKeyDown:E?void 0:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),j(S.id))},"aria-expanded":E?void 0:O,children:i.jsxs("div",{className:"d-flex align-items-center",children:[!E&&(O?i.jsx(hi,{className:"me-2",size:16}):i.jsx(Og,{className:"me-2",size:16})),i.jsxs("div",{children:[i.jsx("div",{className:"fw-bold text-primary-custom",children:S.name}),i.jsx("small",{className:"text-muted",children:S.description})]})]})}),O&&i.jsx("div",{className:"ms-3 mt-2",children:i.jsx(Ly,{variant:"flush",children:S.permissions.map(k=>i.jsx(Ly.Item,{className:`border-0 px-0 py-2 permission-item ${E?"":"cursor-pointer"}`,onClick:()=>!E&&w(k.id),role:E?void 0:"button",tabIndex:E?void 0:0,onKeyDown:E?void 0:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),w(k.id))},children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Y.Check,{type:"checkbox",id:`permission-${k.id}`,checked:s.permissionIds.includes(k.id),onChange:()=>w(k.id),disabled:E,className:"me-3",style:{pointerEvents:E?"none":"auto"},"aria-label":`${k.title}: ${k.description}`}),i.jsxs("div",{className:"flex-grow-1",children:[i.jsx("div",{className:"fw-medium text-dark",children:k.title}),i.jsx("small",{className:"text-muted",children:k.description})]}),!E&&s.permissionIds.includes(k.id)&&i.jsx($e,{bg:"primary",className:"ms-2",children:"Selected"})]})},k.id))})})]},S.id)})})}),i.jsx("div",{className:"mt-2",children:i.jsxs("small",{className:"text-muted",children:[s.permissionIds.length," of ",g.reduce((S,O)=>S+O.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[i.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx("small",{className:"text-muted",children:"Assigned Users:"}),i.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx("small",{className:"text-muted",children:"Total Permissions:"}),i.jsx("div",{className:"fw-medium",children:s.permissionIds.length})]})]})]})})})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:a,disabled:d,children:[i.jsx(Ye,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&i.jsx(le,{variant:"primary-custom",type:"submit",disabled:d||t&&gE(t.name),children:d?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},Ece=({roles:e,loading:t,actionsComponent:r,onView:n,onEdit:a,onDisable:s})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Bn(e);if(t)return i.jsx(Ln,{rows:4,columns:4});if(e.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No roles found"}),i.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const d=({columnKey:u,children:f,className:h=""})=>{const m=l.key===u,p=m?l.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${h} ${m?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>c(u),onMouseEnter:v=>{v.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",v.target.style.transform="translateY(-1px)",v.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:v=>{v.target.style.backgroundColor="transparent",v.target.style.transform="translateY(0)",v.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"700":"600"},children:f}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:p,size:14})})]}),m&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsx("div",{className:"scrollable-table-container admin-table",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[i.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:i.jsxs("tr",{children:[i.jsx(d,{columnKey:"name",className:"show-mobile",children:"Role Name"}),i.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx(d,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),i.jsx(d,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:o.map((u,f)=>i.jsxs("tr",{children:[i.jsx("td",{className:"show-mobile",children:u.name}),i.jsx("td",{className:"show-mobile",children:i.jsxs($e,{bg:u.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[i.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="Active"?"":""}),u.status]})}),i.jsx("td",{className:"show-mobile",children:u.assignedUsers}),i.jsx("td",{className:"show-mobile",children:u.lastModified}),i.jsx("td",{className:"text-center show-mobile",children:i.jsx(r,{role:u})})]},u.id))})]})})},_ce=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(""),[a,s]=_.useState([]),[o,l]=_.useState(!1),[c,d]=_.useState(null),[u,f]=_.useState("view"),[h,m]=_.useState(!1),[p,v]=_.useState(null);_.useEffect(()=>{(async()=>{m(!0);try{const P=(await En.getRoles({includeDeleted:!0})).roles.map(C=>({id:C.id,name:C.name,description:C.description||"",assignedUsers:C.userCount||0,status:C.isActive==="ACTIVE"?"Active":"Inactive",createdAt:C.createdAt?C.createdAt.split("T")[0]:"",lastModified:C.updatedAt?C.updatedAt.split("T")[0]:"",isActive:C.isActive,permissions:C.permissions||[],originalData:C}));t(P),v(null)}catch(A){const P=ua(A,{});v(P),console.error("Error fetching roles:",A)}finally{m(!1)}})()},[]);const g=T=>n(T),x=T=>{s(T==="clear"?[]:A=>A.includes(T)?A.filter(P=>P!==T):[...A,T])},b=()=>{s([])},y=async T=>{try{m(!0);const A=await En.getRoleById(T.id);d(A),f("view"),l(!0)}catch(A){const P=ua(A,{});v(P),console.error("Error fetching role details:",A)}finally{m(!1)}},w=async T=>{try{m(!0);const A=await En.getRoleById(T.id),P={id:A.id,name:A.name,description:A.description||"",assignedUsers:A.userCount||0,status:A.isActive?"Active":"Inactive",createdAt:A.createdAt?A.createdAt.split("T")[0]:"",lastModified:A.updatedAt?A.updatedAt.split("T")[0]:"",isActive:A.isActive,permissions:A.permissions||[],originalData:A};d(P),f("edit"),l(!0),v(null)}catch(A){const P=ua(A,{});v(P)}finally{m(!1)}},j=()=>{d(null),f("add"),l(!0)},N=async T=>{if(window.confirm("Are you sure you want to delete this role?")){m(!0);try{await new Promise(A=>setTimeout(A,1e3)),t(A=>A.filter(P=>P.id!==T)),v(null)}catch{v("Failed to delete role")}finally{m(!1)}}},E=async T=>{m(!0);try{u==="add"?(await En.createRole(T),ye.success("Role created successfully!")):(console.log(" Updating role with data:",{roleId:c.id,roleData:T,selectedRole:c}),await En.updateRole(c.id,T),ye.success("Role updated successfully!"));const P=(await En.getRoles({includeDeleted:!0})).roles.map(C=>({id:C.id,name:C.name,description:C.description||"",assignedUsers:C.userCount||0,status:C.isActive==="ACTIVE"?"Active":"Inactive",createdAt:C.createdAt?C.createdAt.split("T")[0]:"",lastModified:C.updatedAt?C.updatedAt.split("T")[0]:"",isActive:C.isActive,originalData:C}));t(P),l(!1),d(null),v(null)}catch(A){const P=ua(A,{});v(P),ye.error(P)}finally{m(!1)}},S=async T=>{m(!0);try{const A=e.find(V=>V.id===T);if(!A)throw new Error("Role not found");let P,C;A.isActive==="ACTIVE"?(P=await En.disableRole(T),C="disabled"):(P=await En.enableRole(T),C="enabled");const M=(await En.getRoles({includeDeleted:!0})).roles.map(V=>({id:V.id,name:V.name,description:V.description||"",assignedUsers:V.userCount||0,status:V.isActive==="ACTIVE"?"Active":"Inactive",createdAt:V.createdAt?V.createdAt.split("T")[0]:"",lastModified:V.updatedAt?V.updatedAt.split("T")[0]:"",isActive:V.isActive,originalData:V}));t(M);const H=P?.message||`Role has been ${C} successfully!`;ye.success(H),v(null)}catch(A){const P=ua(A,{});v(P),ye.error(P)}finally{m(!1)}},O=[...new Set(e.map(T=>T.status))];return{roles:e.filter(T=>{const A=T.name.toLowerCase().includes(r.toLowerCase()),P=a.length===0||a.includes(T.status);return A&&P}),loading:h,error:p,searchTerm:r,selectedStatuses:a,uniqueStatuses:O,modalShow:o,selectedRole:c,modalMode:u,handleSearch:g,handleStatusToggle:x,handleClearFilters:b,handleView:y,handleEdit:w,handleAdd:j,handleDelete:N,handleSave:E,handleDisable:S,handleModalClose:()=>l(!1),setError:v}},Sce=()=>{const[e,t]=_.useState(!1),[r,n]=_.useState(null),[a,s]=_.useState(!1),{roles:o,loading:l,error:c,searchTerm:d,selectedStatuses:u,uniqueStatuses:f,modalShow:h,selectedRole:m,modalMode:p,handleSearch:v,handleStatusToggle:g,handleClearFilters:x,handleView:b,handleEdit:y,handleAdd:w,handleSave:j,handleDisable:N,handleModalClose:E}=_ce(),S=A=>{n(A),t(!0)},O=async()=>{if(r){s(!0);try{await N(r.id),t(!1),n(null)}catch(A){console.error("Error disabling role:",A)}finally{s(!1)}}},k=()=>{t(!1),n(null)},T=({role:A})=>i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:i.jsx(ln,{size:16})},items:[{label:"View Details",icon:i.jsx(Xt,{}),onClick:()=>b(A)},{label:"Edit Role",icon:i.jsx(ya,{}),onClick:()=>y(A)},...A.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:A.status==="Active"?"Disable Role":"Enable Role",icon:i.jsx(bo,{}),className:A.status==="Active"?"text-warning":"text-success",onClick:()=>S(A)}]:[]]});return se.useEffect(()=>{c&&ye.error(c)},[c]),i.jsx(He,{fluid:!0,className:"py-4 role-management-page",children:i.jsxs(ce,{className:"border-neutral-200 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-light-custom border-neutral-200",children:i.jsx(Ee,{className:"align-items-center",children:i.jsx(oe,{xs:12,className:"mt-2 mt-md-0 mb-3",children:i.jsx("div",{className:"d-flex justify-content-end",children:i.jsx(sn,{permission:Me.ROLES.CREATE,fallback:null,children:i.jsxs(le,{variant:"primary-custom",size:"sm",onClick:w,className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-1",size:16}),"Add Role"]})})})})})}),i.jsxs(ce.Body,{children:[i.jsxs(Ee,{className:"mb-3 form-mobile-stack search-filter-section",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search roles by name...",value:d,onChange:v,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(wce,{uniqueStatuses:f,selectedStatuses:u,onStatusToggle:g,onClearFilters:x,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[o.length," role",o.length!==1?"s":""]})})})]}),i.jsx(Ece,{roles:o,loading:l,actionsComponent:T,onView:b,onEdit:y,onDisable:N}),i.jsx(Nce,{show:h,role:m,mode:p,onSave:j,onClose:E}),i.jsx(bce,{show:e,role:r,onConfirm:O,onCancel:k,loading:a})]})]})})},Tce=({show:e,department:t,onClose:r,onAssign:n,availableInstructors:a=[],assignedInstructors:s=[]})=>{const[o,l]=_.useState([]),[c,d]=_.useState("");_.useEffect(()=>{e&&(l([]),d(""))},[e]);const u=p=>{l(v=>v.includes(p)?v.filter(g=>g!==p):[...v,p])},f=()=>{n(o),l([])},h=p=>{console.log("Remove instructor:",p)},m=a.filter(p=>p.name.toLowerCase().includes(c.toLowerCase())||p.email.toLowerCase().includes(c.toLowerCase()));return!e||!t?null:i.jsxs(de,{show:e,onHide:r,size:"xl",centered:!0,children:[i.jsx(de.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(pi,{className:"me-2",size:20}),"Assign Instructors - ",t.name]})}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Available Instructors"}),i.jsx(Y.Control,{type:"text",placeholder:"Search instructors...",value:c,onChange:p=>d(p.target.value),className:"mb-3",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}}),i.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-primary)"},children:m.length===0?i.jsx("div",{className:"p-4 text-center text-muted",children:"No available instructors found"}):m.map(p=>i.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom",style:{backgroundColor:o.includes(p.id)?"var(--bs-primary-bg-subtle)":"transparent"},children:[i.jsx(Y.Check,{type:"checkbox",checked:o.includes(p.id),onChange:()=>u(p.id),className:"me-3"}),i.jsxs("div",{className:"flex-grow-1",children:[i.jsx("div",{className:"fw-semibold text-dark",children:p.name}),i.jsx("div",{className:"text-muted small",children:p.email}),i.jsx("div",{className:"text-muted small",children:p.specialization||"No specialization"})]})]},p.id))})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Currently Assigned"}),i.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-success)"},children:s.length===0?i.jsx("div",{className:"p-4 text-center text-muted",children:"No instructors assigned yet"}):s.map(p=>i.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom bg-light",children:[i.jsxs("div",{className:"flex-grow-1",children:[i.jsx("div",{className:"fw-semibold text-dark",children:p.name}),i.jsx("div",{className:"text-muted small",children:p.email}),i.jsx("div",{className:"text-muted small",children:p.specialization||"No specialization"})]}),i.jsx(le,{variant:"outline-danger",size:"sm",onClick:()=>h(p.id),title:"Remove instructor",children:i.jsx(mu,{size:14})})]},p.id))})]})})]}),o.length>0&&i.jsxs(tt,{variant:"info",className:"mt-3",children:[i.jsx("strong",{children:o.length})," instructor(s) selected for assignment"]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:r,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsxs(le,{variant:"primary",onClick:f,disabled:o.length===0,children:[i.jsx(pi,{className:"me-2",size:16}),"Assign ",o.length," Instructor(s)"]})]})]})},Ace=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const n=a=>{switch(a){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return i.jsxs(de,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[i.jsx(de.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Ts,{className:"me-2",size:20}),"Department Details"]})}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[i.jsxs(Ee,{className:"mb-4",children:[i.jsxs(oe,{md:8,children:[i.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),i.jsx("p",{className:"text-muted mb-3",children:t.description})]}),i.jsx(oe,{md:4,className:"text-end",children:i.jsx($e,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),i.jsxs(Ee,{className:"mb-4",children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),i.jsx("div",{className:"p-3 bg-light rounded",children:i.jsx($e,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),i.jsx("div",{className:"p-3 bg-light rounded",children:i.jsx($e,{bg:n(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{md:12,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),i.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(ha,{className:"me-3 text-primary",size:24}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),i.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):i.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),i.jsx(Ee,{className:"mb-4",children:i.jsxs(oe,{md:12,children:[i.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),i.jsxs(Ee,{children:[i.jsx(oe,{md:4,children:i.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[i.jsx(gr,{className:"text-primary mb-2",size:32}),i.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),i.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),i.jsx(oe,{md:4,children:i.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[i.jsx(Pn,{className:"text-success mb-2",size:32}),i.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),i.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),i.jsx(oe,{md:4,children:i.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[i.jsx(ha,{className:"text-info mb-2",size:32}),i.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),i.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),i.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),i.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),i.jsx(de.Footer,{className:"border-0 p-4",children:i.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[i.jsx(Ye,{className:"me-2",size:16}),"Close"]})})]})},kce=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:n,onTypeToggle:a,onStatusToggle:s,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return i.jsxs(vr,{className:`filter-panel-dropdown ${l}`,children:[i.jsxs(vr.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xo,{size:14,className:"me-2"}),"Filters",c&&i.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]}),i.jsx("div",{className:"position-absolute end-0 me-3",children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:i.jsx("path",{d:"M6 8L2 4h8L6 8z"})})})]}),i.jsxs(vr.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[i.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Types"}),r.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`type-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),i.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>s("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:n.includes(d),onChange:()=>s(d),className:"mb-1"},d))})]}),c&&i.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:i.jsxs(le,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[i.jsx(Ye,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Oce=({show:e,department:t,mode:r,onSave:n,onClose:a,availableUsers:s})=>{const[o,l]=_.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,d]=_.useState({}),[u,f]=_.useState(!1);_.useEffect(()=>{t&&r!=="add"?l({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&l({name:"",code:"",description:"",departmentHeadId:""}),d({})},[t,r,e]);const h=()=>{const x={};return o.name.trim()?o.name.trim().length<3?x.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(o.name.trim())||(x.name="Department name cannot contain special characters"):x.name="Department name is required",o.code.trim()?/^[A-Z]{2,5}$/.test(o.code.trim())||(x.code="Department code must be 2-5 uppercase letters"):x.code="Department code is required",o.departmentHeadId||(x.departmentHeadId="Department head is required"),d(x),Object.keys(x).length===0},m=async x=>{if(x.preventDefault(),!!h()){f(!0);try{const b={name:o.name.trim(),code:o.code.trim(),description:o.description.trim(),headUserId:o.departmentHeadId};console.log(" Department data being sent:",b),await n(b)}catch(b){console.error("Error saving department:",b)}finally{f(!1)}}},p=(x,b)=>{l(y=>({...y,[x]:b})),c[x]&&d(y=>({...y,[x]:""}))},v=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return i.jsxs(de,{show:e,onHide:a,size:"lg",centered:!0,children:[i.jsx(de.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[r==="view"?i.jsx(Xt,{className:"me-2",size:20}):i.jsx(wa,{className:"me-2",size:20}),v()]})}),i.jsxs(Y,{onSubmit:m,children:[i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&i.jsxs("div",{className:"alert alert-danger mb-3",children:[i.jsx("strong",{children:"Please fix the following errors:"}),i.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([x,b])=>i.jsx("li",{children:b},x))})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:8,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),i.jsx(Y.Control,{type:"text",value:o.name,onChange:x=>p("name",x.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:c.name})]})}),i.jsx(oe,{md:4,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),i.jsx(Y.Control,{type:"text",value:o.code,onChange:x=>p("code",x.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),i.jsx(Y.Control.Feedback,{type:"invalid",children:c.code})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),i.jsxs(Y.Select,{value:o.departmentHeadId,onChange:x=>p("departmentHeadId",x.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[i.jsx("option",{value:"",children:"Select department head"}),s.map(x=>i.jsxs("option",{value:x.id,children:[x.firstName," ",x.lastName," (",x.eid,")"]},x.id))]}),i.jsx(Y.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),i.jsx(Y.Control,{as:"textarea",rows:4,value:o.description,onChange:x=>p("description",x.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),i.jsx(Y.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),i.jsx(Y.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),i.jsx(Y.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),i.jsx(Y.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:a,disabled:u,children:[i.jsx(Ye,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&i.jsx(le,{variant:"primary-custom",type:"submit",disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},Cce=({department:e,index:t,onView:r,onToggleStatus:n})=>{const a=o=>o==="ACTIVE"?"success":"secondary",s=o=>o==="ACTIVE"?"":"";return i.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx("div",{className:"fw-medium text-dark",children:e.name})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:e.coursesCount})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:e.traineesCount})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:e.trainersCount})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsxs($e,{bg:a(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[i.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:s(e.status)}),e.status]})}),i.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Details",icon:i.jsx(Xt,{}),onClick:()=>r(e)},{type:"divider"},{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:i.jsx(bo,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>n(e)}]})})]})},Pce=({departments:e,loading:t,onView:r,onToggleStatus:n})=>{const{sortedData:a,sortConfig:s,handleSort:o}=Bn(e);if(t)return i.jsx(Ln,{rows:5,columns:6});if(e.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No departments found"}),i.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const f=s.key===c,h=f?s.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${u} ${f?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>o(c),onMouseEnter:m=>{m.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",m.target.style.transform="translateY(-1px)",m.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:m=>{m.target.style.backgroundColor="transparent",m.target.style.transform="translateY(0)",m.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500"},children:d}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:h,size:14})})]}),f&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsx("div",{className:"scrollable-table-container",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[i.jsx("thead",{className:"sticky-header",children:i.jsxs("tr",{children:[i.jsx(l,{columnKey:"name",className:"show-mobile",children:"Department Name"}),i.jsx(l,{columnKey:"code",className:"show-mobile",children:"Code"}),i.jsx(l,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),i.jsx(l,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),i.jsx(l,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),i.jsx(l,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),i.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:a.map((c,d)=>i.jsx(Cce,{department:c,index:d,onView:r,onToggleStatus:n},c.id))})]})})},Dce=({show:e,department:t,onConfirm:r,onCancel:n,isProcessing:a})=>{if(!t)return null;const s=t.status==="ACTIVE",o=s?"deactivate":"activate",l=s?"Deactivate":"Activate";return i.jsxs(de,{show:e,onHide:n,centered:!0,children:[i.jsx(de.Header,{className:"border-0 pb-0",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2 text-warning",size:20}),l," Department"]})}),i.jsxs(de.Body,{className:"pt-0",children:[i.jsx(tt,{variant:s?"warning":"info",className:"mb-3",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx(Gt,{className:"me-2 mt-1",size:16}),i.jsxs("div",{children:[i.jsxs("strong",{children:["Are you sure you want to ",o," this department?"]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),s&&i.jsxs("div",{className:"mt-2",children:[i.jsx("strong",{children:"Warning:"})," Deactivating this department will:",i.jsxs("ul",{className:"mb-0 mt-1",children:[i.jsx("li",{children:"Make it unavailable for new course assignments"}),i.jsx("li",{children:"Hide it from department selection dropdowns"}),i.jsx("li",{children:"Not affect existing courses and users"})]})]}),!s&&i.jsxs("div",{className:"mt-2",children:[i.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",i.jsxs("ul",{className:"mb-0 mt-1",children:[i.jsx("li",{children:"New course assignments"}),i.jsx("li",{children:"Department selection in forms"}),i.jsx("li",{children:"User management operations"})]})]})]})]})}),i.jsxs("div",{className:"bg-light p-3 rounded",children:[i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-6",children:[i.jsx("strong",{children:"Department Head:"}),i.jsx("br",{}),i.jsx("span",{className:"text-muted",children:t.departmentHead?.name||"N/A"})]}),i.jsxs("div",{className:"col-6",children:[i.jsx("strong",{children:"Current Status:"}),i.jsx("br",{}),i.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,children:t.status})]})]}),i.jsxs("div",{className:"row mt-2",children:[i.jsxs("div",{className:"col-4",children:[i.jsx("strong",{children:"Courses:"})," ",t.coursesCount||0]}),i.jsxs("div",{className:"col-4",children:[i.jsx("strong",{children:"Trainees:"})," ",t.traineesCount||0]}),i.jsxs("div",{className:"col-4",children:[i.jsx("strong",{children:"Trainers:"})," ",t.trainersCount||0]})]})]})]}),i.jsxs(de.Footer,{className:"border-0",children:[i.jsxs(le,{variant:"outline-secondary",onClick:n,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:s?"warning":"success",onClick:r,disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Gt,{className:"me-2",size:16}),l," Department"]})})]})]})},Ice=()=>{const e=Et(),{departments:t,loading:r,searchTerm:n,setSearchTerm:a,createDepartment:s,updateDepartment:o,disableDepartment:l,enableDepartment:c,getAvailableUsers:d}=Bg(),[u,f]=_.useState(!1),[h,m]=_.useState(!1),[p,v]=_.useState(!1),[g,x]=_.useState(!1),[b,y]=_.useState("add"),[w,j]=_.useState(null),[N,E]=_.useState(!1),[S,O]=_.useState([]),[k,T]=_.useState([]),[A,P]=_.useState([]);_.useEffect(()=>{(async()=>{try{const U=await d();P(U)}catch(U){console.error("Error loading available users:",U),P([])}})()},[]);const C=()=>{j(null),y("add"),f(!0)},F=ie=>{e(`/admin/departments/${ie.id}`)},M=ie=>{j(ie),m(!0)},H=()=>{f(!1),j(null),y("add")},V=()=>{m(!1),j(null)},B=()=>{v(!1),j(null)},W=()=>{x(!1),j(null)},z=ie=>{console.log("Assign instructors:",ie,"to department:",w.name),B()},D=async ie=>{try{b==="add"?(await s(ie),ye.success("Department created successfully")):b==="edit"&&(await o(w.id,ie),ye.success("Department updated successfully")),H()}catch(U){console.error("Error saving department:",U),ye.error("Failed to save department")}},L=async()=>{try{w&&(w.status==="ACTIVE"?(await l(w.id),ye.success("Department disabled successfully")):(await c(w.id),ye.success("Department enabled successfully")),V())}catch(ie){console.error("Error toggling department status:",ie),ye.error("Failed to toggle department status")}},q=ie=>{a(ie)},I=ie=>{O(ie==="clear"?[]:U=>U.includes(ie)?U.filter(be=>be!==ie):[...U,ie])},R=ie=>{T(ie==="clear"?[]:U=>U.includes(ie)?U.filter(be=>be!==ie):[...U,ie])},X=()=>{O([]),T([])},ae=[...new Set(t.map(ie=>ie.type).filter(Boolean))],Z=["ACTIVE","INACTIVE"],ee=t.filter(ie=>{const U=S.length===0||S.includes(ie.type),be=k.length===0||k.includes(ie.status);return U&&be});return i.jsxs(He,{fluid:!0,className:"py-4 department-management-page",children:[i.jsxs(ce,{className:"shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-0 pb-0",children:i.jsx(Ee,{className:"align-items-center",children:i.jsx(oe,{xs:12,className:"mt-2 mt-md-0 mb-3",children:i.jsx("div",{className:"d-flex justify-content-end",children:i.jsx(sn,{permission:Me.DEPARTMENTS.CREATE,fallback:null,children:i.jsxs(le,{variant:"primary-custom",size:"sm",onClick:C,className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-1",size:16}),"Add Department"]})})})})})}),i.jsxs(ce.Body,{children:[i.jsxs(Ee,{className:"mb-4 form-mobile-stack",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search departments by name, code, or description...",value:n,onChange:q,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(kce,{uniqueTypes:ae,uniqueStatuses:Z,selectedTypes:S,selectedStatuses:k,onTypeToggle:I,onStatusToggle:R,onClearFilters:X,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[ee.length," department",ee.length!==1?"s":""]})})})]}),i.jsx("div",{className:"position-relative mt-3",children:i.jsx(Pce,{departments:ee,loading:r,onView:F,onToggleStatus:M})})]})]}),u&&i.jsx(Oce,{show:u,department:w,mode:b,onSave:D,onClose:H,availableUsers:A}),h&&w&&i.jsx(Dce,{show:h,department:w,onConfirm:L,onCancel:V,isProcessing:r}),p&&w&&i.jsx(Tce,{show:p,department:w,onClose:B,onAssign:z,availableInstructors:A.filter(ie=>ie.role==="TRAINER"),assignedInstructors:[]}),g&&w&&i.jsx(Ace,{show:g,department:w,onClose:W})]})},Rce=({department:e,onBack:t})=>i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsx(le,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:i.jsx(dr,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"mb-1",children:e.name}),i.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),Fce=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:yS,description:"View department overview"},{id:"trainers",label:"Manage Trainers",icon:pi,description:"Assign trainers to department"},{id:"edit",label:"Edit Details",icon:ya,description:"Modify department information"}];return i.jsxs("div",{className:"department-tabs",children:[i.jsx("div",{className:"tab-navigation",children:r.map(n=>{const a=n.icon,s=e===n.id;return i.jsxs("button",{className:`tab-button ${s?"active":""}`,onClick:()=>t(n.id),children:[i.jsx("div",{className:"tab-icon",children:i.jsx(a,{size:20})}),i.jsxs("div",{className:"tab-content",children:[i.jsx("div",{className:"tab-label",children:n.label}),i.jsx("div",{className:"tab-description",children:n.description})]}),s&&i.jsx("div",{className:"tab-indicator"})]},n.id)})}),i.jsx("div",{className:"tab-separator"})]})},Lce=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),Mce=({department:e,onUpdate:t})=>{const[r,n]=_.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[a,s]=_.useState(!1),[o,l]=_.useState([]);_.useEffect(()=>{(async()=>{try{const f=await gt.getDepartmentHeads();l(f)}catch(f){console.error("Error loading department heads:",f),ye.error("Failed to load department heads"),l([])}})()},[]);const c=u=>{const{name:f,value:h}=u.target;n(m=>({...m,[f]:h}))},d=async u=>{u.preventDefault(),s(!0);try{const f=await gt.updateDepartment(e.id,r),h=Lce(f);t(h),ye.success("Department updated successfully!")}catch(f){console.error("Error updating department:",f),ye.error("Failed to update department")}finally{s(!1)}};return i.jsxs("div",{children:[i.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),i.jsxs("form",{onSubmit:d,children:[i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),i.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),i.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[i.jsx("option",{value:"",children:"Select Department Head"}),o.map(u=>i.jsxs("option",{value:u.id,children:["[",u.eid,"] - ",u.firstName," ",u.lastName]},u.id))]}),r.headUserId&&(()=>{const u=o.find(f=>f.id===r.headUserId);return u?i.jsxs("div",{className:"form-text",children:["Current selection: [",u.eid,"] - ",u.firstName," ",u.lastName]}):null})()]})})}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),i.jsx("div",{className:"d-flex gap-2",children:i.jsx(le,{type:"submit",variant:"primary",disabled:a,children:a?"Updating...":"Update Department"})})]})]})},Bce=({trainers:e=[],loading:t=!1,showAddButton:r=!1,onAddClick:n,departmentId:a,onTrainerRemoved:s})=>{const[o,l]=_.useState(!1),[c,d]=_.useState(null),[u,f]=_.useState(!1);if(t)return i.jsxs("div",{className:"text-center py-4",children:[i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading trainers..."})]});if(!e||e.length===0)return i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ha,{size:48,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"No trainers assigned"}),i.jsx("p",{className:"text-muted",children:"This department doesn't have any trainers assigned yet."})]});const h=g=>{const{firstName:x,middleName:b,lastName:y}=g;return[x,b,y].filter(Boolean).join(" ")},m=g=>{d(g),l(!0)},p=async()=>{if(!(!c||!a)){f(!0);try{await gt.removeTrainersFromDepartment(a,[c.eid]),ye.success(`Successfully removed ${h(c)} from department`),s&&s(),l(!1),d(null)}catch(g){console.error("Error removing trainer:",g),ye.error("Failed to remove trainer from department")}finally{f(!1)}}},v=()=>{l(!1),d(null)};return i.jsxs("div",{className:"assigned-trainers-table",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[i.jsxs("h5",{className:"mb-0",children:[i.jsx(ha,{className:"me-2"}),"Assigned Trainers (",e.length,")"]}),r&&i.jsxs(le,{variant:"primary",onClick:n,className:"d-flex align-items-center",children:[i.jsx(pi,{className:"me-2",size:16}),"Add Trainers to Department"]})]}),i.jsx("div",{className:"table-responsive",children:i.jsxs(Yt,{hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{children:"EID"}),i.jsx("th",{children:"Full Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsx("th",{width:"80",children:"Actions"})]})}),i.jsx("tbody",{children:e.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("code",{className:"text-primary",children:g.eid})}),i.jsx("td",{children:i.jsx("div",{className:"fw-medium",children:h(g)})}),i.jsx("td",{children:i.jsx("span",{children:g.email})}),i.jsx("td",{children:g.phoneNumber?i.jsx("span",{children:g.phoneNumber}):i.jsx("span",{className:"text-muted",children:"-"})}),i.jsx("td",{children:g.address?i.jsx("span",{className:"text-truncate",style:{maxWidth:"200px"},title:g.address,children:g.address}):i.jsx("span",{className:"text-muted",children:"-"})}),i.jsx("td",{children:i.jsx(sn,{permission:Me.DEPARTMENTS.REMOVE_TRAINERS,fallback:null,children:i.jsxs(vr,{align:"end",children:[i.jsx(vr.Toggle,{variant:"outline-secondary",size:"sm",className:"border-0 bg-transparent p-1",children:i.jsx(ln,{size:16})}),i.jsx(vr.Menu,{children:i.jsxs(vr.Item,{onClick:()=>m(g),className:"text-danger",children:[i.jsx(mu,{className:"me-2",size:14}),"Remove from Department"]})})]})})})]},g.id))})]})}),i.jsxs(de,{show:o,onHide:v,centered:!0,children:[i.jsx(de.Header,{closeButton:!0,children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(mu,{className:"me-2 text-danger",size:20}),"Remove Trainer"]})}),i.jsxs(de.Body,{children:[i.jsxs("p",{children:["Are you sure you want to remove ",i.jsx("strong",{children:c?h(c):""})," from this department?"]}),i.jsx("p",{className:"text-muted small mb-0",children:"This action cannot be undone. The trainer will no longer be associated with this department."})]}),i.jsxs(de.Footer,{children:[i.jsx(le,{variant:"secondary",onClick:v,disabled:u,children:"Cancel"}),i.jsx(le,{variant:"danger",onClick:p,disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):"Remove Trainer"})]})]})]})},$ce=({show:e,onHide:t,departmentId:r,assignedTrainers:n=[],onTrainersAdded:a})=>{const[s,o]=_.useState([]),[l,c]=_.useState([]),[d,u]=_.useState(""),[f,h]=_.useState(!1),[m,p]=_.useState(!1);_.useEffect(()=>{e&&r&&v()},[e,r,n]);const v=async()=>{h(!0);try{const T=((await Qr.getUsers()).data||[]).filter(C=>C.role&&C.role.name==="TRAINER").map(C=>({id:C.id,eid:C.eid,firstName:C.firstName,middleName:C.middleName,lastName:C.lastName,email:C.email,status:C.status,address:C.address,gender:C.gender,phoneNumber:C.phoneNumber})),A=n.map(C=>C.id),P=T.filter(C=>!A.includes(C.id));o(P)}catch(S){console.error("Error loading available trainers:",S),ye.error("Failed to load available trainers")}finally{h(!1)}},g=(S,O)=>{c(O?k=>[...k,S]:k=>k.filter(T=>T!==S))},x=S=>{if(S){const O=b();c(O.map(k=>k.id))}else c([])},b=()=>{if(!d)return s;const S=d.toLowerCase();return s.filter(O=>O.eid?.toLowerCase().includes(S)||O.firstName?.toLowerCase().includes(S)||O.lastName?.toLowerCase().includes(S)||O.email?.toLowerCase().includes(S))},y=S=>{const{firstName:O,middleName:k,lastName:T}=S;return[O,k,T].filter(Boolean).join(" ")},w=async()=>{if(l.length===0){ye.warning("Please select at least one trainer");return}p(!0);try{const S=l.map(O=>{const k=s.find(T=>T.id===O);return k?k.eid:null}).filter(O=>O!==null);await gt.assignTrainersToDepartment(r,S),ye.success(`Successfully assigned ${S.length} trainer(s) to department`),a(),j()}catch(S){console.error("Error assigning trainers:",S),ye.error("Failed to assign trainers")}finally{p(!1)}},j=()=>{c([]),u(""),t()},N=b(),E=N.length>0&&N.every(S=>l.includes(S.id));return i.jsxs(de,{show:e,onHide:j,size:"xl",centered:!0,children:[i.jsxs(de.Header,{className:"border-0 pb-0 d-flex align-items-center justify-content-between",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[i.jsx("div",{}),i.jsxs(de.Title,{className:"d-flex align-items-center text-white",children:[i.jsx(pi,{className:"me-2",size:20}),"Add Trainers to Department"]}),i.jsx(le,{variant:"link",onClick:j,className:"p-0",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:i.jsx(Ye,{})})]}),i.jsxs(de.Body,{className:"pt-0",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-muted mb-3",style:{padding:"20px 24px"},children:"Select trainers to assign to this department."}),i.jsxs(Ee,{className:"align-items-center",children:[i.jsx(oe,{md:8,children:i.jsx(Y.Control,{type:"text",placeholder:"Search by EID, name, or email...",value:d,onChange:S=>u(S.target.value)})}),i.jsx(oe,{md:4,className:"text-end",children:i.jsxs("span",{className:"text-muted",children:[N.length," trainer",N.length!==1?"s":""," found"]})})]})]}),f?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading available trainers..."})]}):i.jsx("div",{className:"table-responsive",style:{maxHeight:"400px"},children:i.jsxs(Yt,{hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"table-light sticky-top",children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"50px",padding:"16px 12px"},children:i.jsx(Y.Check,{type:"checkbox",checked:E,onChange:S=>x(S.target.checked)})}),i.jsx("th",{style:{padding:"16px 12px"},children:"EID"}),i.jsx("th",{style:{padding:"16px 12px"},children:"Full Name"}),i.jsx("th",{style:{padding:"16px 12px"},children:"Email"})]})}),i.jsx("tbody",{children:N.map(S=>i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"16px 12px"},children:i.jsx(Y.Check,{type:"checkbox",checked:l.includes(S.id),onChange:O=>g(S.id,O.target.checked)})}),i.jsx("td",{style:{padding:"16px 12px"},children:i.jsx("code",{className:"text-primary",children:S.eid})}),i.jsx("td",{style:{padding:"16px 12px"},children:i.jsx("span",{children:y(S)})}),i.jsx("td",{style:{padding:"16px 12px"},children:S.email})]},S.id))})]})}),N.length===0&&!f&&i.jsxs("div",{className:"text-center py-4",children:[i.jsx(pi,{size:48,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"No trainers available"}),i.jsx("p",{className:"text-muted",children:d?"No trainers match your search criteria.":"All trainers are already assigned to departments."})]})]}),i.jsxs(de.Footer,{className:"border-0",children:[i.jsx(le,{variant:"outline-secondary",onClick:j,disabled:m,children:"Cancel"}),i.jsx(le,{variant:"primary",onClick:w,disabled:l.length===0||m,children:m?i.jsxs(i.Fragment,{children:[i.jsx(ur,{size:"sm",className:"me-2"}),"Assigning..."]}):`Assign ${l.length} Trainer${l.length!==1?"s":""}`})]})]})},zce=({department:e,onDepartmentUpdate:t})=>{const[r,n]=_.useState(!1),a=e?.trainers||[],s=()=>{t&&t()};return i.jsxs("div",{children:[i.jsx(Bce,{trainers:a,loading:!1,showAddButton:!0,onAddClick:()=>n(!0),departmentId:e?.id,onTrainerRemoved:s}),i.jsx($ce,{show:r,onHide:()=>n(!1),departmentId:e?.id,assignedTrainers:a,onTrainersAdded:s})]})},xE=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return i.jsxs("div",{className:"department-info",children:[i.jsx("h4",{className:"mb-4",children:"Department Overview"}),i.jsxs(Ee,{className:"g-4",children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"info-card",children:[i.jsxs("div",{className:"info-header",children:[i.jsx(gr,{className:"info-icon"}),i.jsx("h6",{children:"Basic Information"})]}),i.jsxs("div",{className:"info-content",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Name:"}),i.jsx("span",{className:"info-value",children:e.name})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Code:"}),i.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Description:"}),i.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"info-card",children:[i.jsxs("div",{className:"info-header",children:[i.jsx(Pn,{className:"info-icon"}),i.jsx("h6",{children:"Department Statistics"})]}),i.jsxs("div",{className:"info-content",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Course Count:"}),i.jsx("span",{className:"info-value",children:e.courseCount||0})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Trainee Count:"}),i.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Trainer Count:"}),i.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Head of Department:"}),i.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"info-card",children:[i.jsxs("div",{className:"info-header",children:[i.jsx(Yr,{className:"info-icon"}),i.jsx("h6",{children:"Timeline"})]}),i.jsxs("div",{className:"info-content",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Created:"}),i.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Last Updated:"}),i.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&i.jsxs("div",{className:"info-item",children:[i.jsx("span",{className:"info-label",children:"Deleted:"}),i.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},Uce=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),qce=()=>{const{id:e}=Fn(),t=Et(),[r,n]=_.useState(null),[a,s]=_.useState(!0),[o,l]=_.useState(null),[c,d]=_.useState("info"),u=_.useCallback(async()=>{if(!e){ye.error("Department ID is required"),s(!1);return}s(!0),l(null);try{const p=await gt.getDepartmentById(e),v=Uce(p);n(v)}catch(p){console.error("Error loading department:",p),ye.error("Failed to load department details"),l("Failed to load department details")}finally{s(!1)}},[e]);_.useEffect(()=>{u()},[u]);const f=()=>{t("/admin/departments")},h=p=>{d(p)};if(a)return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:i.jsx(ur,{animation:"border",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(o)return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsxs("div",{className:"text-danger mb-3",children:[i.jsx("h5",{children:"Unable to load department"}),i.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),i.jsxs(le,{variant:"outline-primary",onClick:f,children:[i.jsx(dr,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsxs("div",{className:"text-warning mb-3",children:[i.jsx("h5",{children:"Department not found"}),i.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),i.jsxs(le,{variant:"outline-primary",onClick:f,children:[i.jsx(dr,{className:"me-2"}),"Back to Departments"]})]})});const m=()=>{switch(c){case"info":return i.jsx(xE,{department:r});case"trainers":return i.jsx(zce,{department:r,onDepartmentUpdate:u});case"edit":return i.jsx(Mce,{department:r,onUpdate:n});default:return i.jsx(xE,{department:r})}};return i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Rce,{department:r,onBack:f}),i.jsx(Fce,{activeTab:c,onTabChange:h}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsx(ce,{className:"shadow-sm",children:i.jsx(ce.Body,{className:"p-4",children:m()})})})})]})},Wce=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,s]=_.useState({newPassword:"",confirmPassword:""}),[o,l]=_.useState(!1),[c,d]=_.useState(!1),[u,f]=_.useState({show:!1,message:"",variant:"success"}),h=v=>{const{name:g,value:x}=v.target;s(b=>({...b,[g]:x})),u.show&&f({show:!1,message:"",variant:"success"})},m=async v=>{if(v.preventDefault(),a.newPassword!==a.confirmPassword){f({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(a.newPassword.length<6){f({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(a),f({show:!0,message:"Password updated successfully!",variant:"success"}),s({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),f({show:!1,message:"",variant:"success"})},1500)}catch{f({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},p=()=>{s({newPassword:"",confirmPassword:""}),f({show:!1,message:"",variant:"success"}),t()};return i.jsxs(de,{show:e,onHide:p,size:"md",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary text-white",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(yl,{className:"me-2",size:20}),"Reset Password"]}),i.jsx(le,{variant:"link",className:"text-white p-0",onClick:p,style:{textDecoration:"none"},children:i.jsx(Ye,{size:20})})]}),i.jsxs(de.Body,{className:"p-4",children:[u.show&&i.jsx(tt,{variant:u.variant,className:"mb-3",children:u.message}),i.jsxs(Y,{onSubmit:m,children:[i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{className:"fw-semibold",children:"New Password"}),i.jsxs("div",{className:"position-relative",children:[i.jsx(Y.Control,{type:o?"text":"password",name:"newPassword",value:a.newPassword,onChange:h,required:!0,minLength:6,placeholder:"Enter new password"}),i.jsx(le,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>l(!o),type:"button",children:o?i.jsx(xl,{size:16}):i.jsx(Xt,{size:16})})]})]}),i.jsxs(Y.Group,{className:"mb-4",children:[i.jsx(Y.Label,{className:"fw-semibold",children:"Confirm New Password"}),i.jsxs("div",{className:"position-relative",children:[i.jsx(Y.Control,{type:c?"text":"password",name:"confirmPassword",value:a.confirmPassword,onChange:h,required:!0,minLength:6,placeholder:"Confirm new password"}),i.jsx(le,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>d(!c),type:"button",children:c?i.jsx(xl,{size:16}):i.jsx(Xt,{size:16})})]})]}),i.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[i.jsx(le,{variant:"outline-secondary",onClick:p,disabled:n,children:"Cancel"}),i.jsx(le,{type:"submit",variant:"secondary",disabled:n,children:n?"Updating...":i.jsxs(i.Fragment,{children:[i.jsx(yl,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},Hce=({profileData:e,user:t,onResetPassword:r,onAvatarUpdated:n})=>{const a=_.useRef(null),[s,o]=_.useState(!1),[l,c]=_.useState(null),d=x=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",SQA_AUDITOR:"secondary"})[x]||"secondary",u=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",f=()=>e?.email||t?.email||"user@example.com",h=()=>e?.role?.name||t?.role||"USER",m=l||e?.avatarUrl||"",p=()=>{a.current&&a.current.click()},v=(x,b=200,y=200,w=.8)=>new Promise(j=>{const N=document.createElement("canvas"),E=N.getContext("2d"),S=new window.Image;S.onload=()=>{let{width:O,height:k}=S;O>k?O>b&&(k=k*b/O,O=b):k>y&&(O=O*y/k,k=y),N.width=O,N.height=k,E.drawImage(S,0,0,O,k);const T=N.toDataURL("image/jpeg",w);j(T)},S.src=URL.createObjectURL(x)}),g=async x=>{const b=x.target.files&&x.target.files[0];if(b){if(b.size>5*1024*1024){ye.error("File size too large. Please choose an image smaller than 5MB.");return}try{o(!0);const y=await v(b,200,200,.7);c(y);const w=await _s.updateAvatar(y,e);ye.success("Avatar updated successfully"),n&&n(w)}catch(y){console.error("Update avatar failed:",y),y.response?.status===422?ye.error("Invalid avatar format. Please try a different image."):y.response?.status===413?ye.error("Image too large. Please choose a smaller image."):ye.error("Failed to update avatar. Please try again."),c(null)}finally{o(!1),a.current&&(a.current.value="")}}};return i.jsx(ce,{className:"h-100",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[m?i.jsx(DP,{roundedCircle:!0,src:m,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):i.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:i.jsx(ba,{size:48,className:"text-white"})}),i.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:p,disabled:s,children:s?i.jsx(ur,{animation:"border",size:"sm"}):""}),i.jsx("input",{ref:a,type:"file",accept:"image/*",className:"d-none",onChange:g})]}),i.jsx("h4",{className:"mb-1",children:u()}),i.jsx("p",{className:"text-muted mb-2",children:f()}),i.jsx($e,{bg:d(h()),className:"mb-3",children:h()}),i.jsxs("div",{className:"text-start",children:[e?.address&&i.jsxs("div",{className:"mb-3",children:[i.jsx("strong",{children:"Address:"}),i.jsx("br",{}),i.jsx("span",{className:"text-muted",children:e.address})]}),i.jsx("div",{className:"d-flex justify-content-center",children:i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[i.jsx(yl,{size:14,className:"me-2"}),"Reset Password"]})})]})]})})},Vce=({profileData:e,user:t,onUpdate:r})=>{const[n,a]=_.useState(!1),[s,o]=_.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[l,c]=_.useState(!1);_.useEffect(()=>{if(e&&e.firstName){const f={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};o(f),c(!0)}},[e,l]);const d=f=>{const{name:h,value:m}=f.target;o(p=>({...p,[h]:m}))},u=async f=>{f.preventDefault(),a(!0);try{r?await r(s):(await _s.updateProfile(s),ye.success("Personal information updated successfully!"))}catch(h){console.error("Error updating personal info:",h),r||ye.error("Failed to update personal information. Please try again.")}finally{a(!1)}};return i.jsxs(ce,{children:[i.jsx(ce.Header,{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(ba,{size:20,className:"me-2 text-primary"}),i.jsx("h5",{className:"mb-0",children:"Personal Information"})]})}),i.jsx(ce.Body,{children:i.jsxs(Y,{onSubmit:u,children:[i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-md-4 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"First Name"}),i.jsx(Y.Control,{type:"text",name:"firstName",value:s.firstName,onChange:d,required:!0})]})}),i.jsx("div",{className:"col-md-4 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Middle Name"}),i.jsx(Y.Control,{type:"text",name:"middleName",value:s.middleName,onChange:d})]})}),i.jsx("div",{className:"col-md-4 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Last Name"}),i.jsx(Y.Control,{type:"text",name:"lastName",value:s.lastName,onChange:d,required:!0})]})})]}),i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-md-6 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Email"}),i.jsx(Y.Control,{type:"email",name:"email",value:s.email,onChange:d,required:!0})]})}),i.jsx("div",{className:"col-md-6 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Phone Number"}),i.jsx(Y.Control,{type:"tel",name:"phoneNumber",value:s.phoneNumber,onChange:d})]})})]}),i.jsx("div",{className:"row",children:i.jsx("div",{className:"col-md-6 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Gender"}),i.jsxs(Y.Select,{name:"gender",value:s.gender,onChange:d,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"MALE",children:"Male"}),i.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),i.jsx("div",{className:"row",children:i.jsx("div",{className:"col-md-12 mb-3",children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Address"}),i.jsx(Y.Control,{as:"textarea",rows:3,name:"address",value:s.address,onChange:d,placeholder:"Enter your address"})]})})}),i.jsx("div",{className:"d-flex justify-content-end",children:i.jsx(le,{type:"submit",variant:"primary",disabled:n,children:n?"Saving...":i.jsxs(i.Fragment,{children:[i.jsx(wa,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},Gce=()=>{const{user:e}=bn(),[t,r]=_.useState(!1),[n,a]=_.useState(!1),[s,o]=_.useState(null),[l,c]=_.useState(!0),d=async()=>{try{c(!0);const h=await _s.getProfile();o(h)}catch(h){console.error("Failed to refresh profile:",h)}finally{c(!1)}};_.useEffect(()=>{d()},[]);const u=async h=>{r(!0);try{const m=await _s.updateProfile(h);o(m),ye.success("Personal information updated successfully!")}catch(m){throw console.error("Error updating profile:",m),ye.error("Failed to update personal information. Please try again."),m}finally{r(!1)}},f=async h=>{r(!0);try{const m=await _s.resetPassword(h);ye.success(m.message||"Password updated successfully!")}catch(m){throw ye.error(m.message||"Failed to update password. Please check your current password."),m}finally{r(!1)}};return l?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsxs(Ee,{children:[i.jsx(oe,{lg:4,className:"mb-4",children:i.jsx(Hce,{profileData:s,user:e,onResetPassword:()=>a(!0),onAvatarUpdated:d})}),i.jsx(oe,{lg:8,className:"mb-4",children:i.jsx(Vce,{profileData:s,user:e,onUpdate:u})})]}),i.jsx(Wce,{show:n,onClose:()=>a(!1),onSave:f,loading:t})]})},Kce=()=>{const{user:e}=bn(),t=Et(),{departments:r,loading:n,error:a}=Bg(),s=r.filter(l=>l.status==="ACTIVE"),o=l=>{t(`/academic/course/${l}`)};return i.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:i.jsxs(He,{className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ts,{size:48,className:"text-primary mb-3"}),i.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),i.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),i.jsxs("p",{className:"text-muted small",children:["Total Departments: ",i.jsx("strong",{children:s.length})]})]})})}),i.jsx(Ee,{className:"mb-5",children:n?i.jsxs(oe,{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):a?i.jsx(oe,{className:"text-center py-5",children:i.jsxs("p",{className:"text-danger",children:["Error loading departments: ",a.message]})}):s.map(l=>i.jsx(oe,{md:6,lg:4,className:"mb-4",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:i.jsxs(ce.Body,{className:"p-4 d-flex flex-column",children:[i.jsxs("div",{className:"d-flex align-items-center mb-3",children:[i.jsx("div",{className:"course-icon me-3",children:i.jsx(gr,{size:24,className:"text-primary"})}),i.jsxs("div",{children:[i.jsx("h5",{className:"mb-1",children:l.name}),i.jsx($e,{bg:"secondary",className:"text-white",children:l.code})]})]}),i.jsx("p",{className:"text-muted mb-3 flex-grow-1",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.4",maxHeight:"4.2em"},children:l.description}),i.jsxs(le,{variant:"outline-primary",className:"w-100 mt-auto",onClick:()=>o(l.id),children:["View Details",i.jsx(vl,{size:16,className:"ms-2"})]})]})})},l.id))})]})})},Yce=()=>{const e=Et(),t={totalCourses:24,activeCourses:18,totalTrainees:156,completedCourses:89,upcomingSessions:12,averageCompletion:78},r=[{id:1,type:"course_completed",title:"Safety Procedures Course",trainee:"John Smith",time:"2 hours ago",icon:gl},{id:2,type:"new_enrollment",title:"Emergency Response Training",trainee:"Sarah Johnson",time:"4 hours ago",icon:ha},{id:3,type:"course_scheduled",title:"First Aid Training",trainee:"Mike Wilson",time:"6 hours ago",icon:Yr}],n=[{title:"View All Departments",description:"Browse and manage academic departments",icon:Ts,action:()=>e("/academic/departments"),color:"primary"},{title:"Course Management",description:"Create and manage training courses",icon:gr,action:()=>e("/academic/departments"),color:"success"},{title:"Trainee Reports",description:"View trainee progress and reports",icon:xa,action:()=>e("/academic/departments"),color:"info"}];return i.jsx("div",{style:{paddingBottom:"2rem"},children:i.jsxs(He,{className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsx("div",{className:"d-flex justify-content-between align-items-center",children:i.jsx("div",{children:i.jsx("h2",{className:"mb-1",children:"Academic Dashboard"})})})})}),i.jsxs(Ee,{className:"mb-4",children:[i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(gr,{size:32,className:"text-primary mb-2"}),i.jsx("h4",{className:"mb-1",children:t.totalCourses}),i.jsx("p",{className:"text-muted mb-0 small",children:"Total Courses"})]})})}),i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(gS,{size:32,className:"text-success mb-2"}),i.jsx("h4",{className:"mb-1",children:t.activeCourses}),i.jsx("p",{className:"text-muted mb-0 small",children:"Active Courses"})]})})}),i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(Pn,{size:32,className:"text-info mb-2"}),i.jsx("h4",{className:"mb-1",children:t.totalTrainees}),i.jsx("p",{className:"text-muted mb-0 small",children:"Total Trainees"})]})})}),i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(gl,{size:32,className:"text-warning mb-2"}),i.jsx("h4",{className:"mb-1",children:t.completedCourses}),i.jsx("p",{className:"text-muted mb-0 small",children:"Completed"})]})})}),i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(Yr,{size:32,className:"text-danger mb-2"}),i.jsx("h4",{className:"mb-1",children:t.upcomingSessions}),i.jsx("p",{className:"text-muted mb-0 small",children:"Upcoming"})]})})}),i.jsx(oe,{md:6,lg:2,className:"mb-3",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"text-center",children:[i.jsx(Oa,{size:32,className:"text-secondary mb-2"}),i.jsxs("h4",{className:"mb-1",children:[t.averageCompletion,"%"]}),i.jsx("p",{className:"text-muted mb-0 small",children:"Avg. Completion"})]})})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{lg:8,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),i.jsx(ce.Body,{children:i.jsx(Ee,{children:n.map((a,s)=>i.jsx(oe,{md:4,className:"mb-3",children:i.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:a.action,children:[i.jsxs("div",{className:"d-flex align-items-center mb-2",children:[i.jsx(a.icon,{size:24,className:`text-${a.color} me-2`}),i.jsx("h6",{className:"mb-0",children:a.title})]}),i.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:a.description}),i.jsx(vl,{size:16,className:`text-${a.color} ms-auto`})]})},s))})})]})}),i.jsx(oe,{lg:4,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsx("h5",{className:"mb-0",children:"Recent Activities"})}),i.jsxs(ce.Body,{children:[r.map(a=>i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsx("div",{className:"me-3",children:i.jsx(a.icon,{size:20,className:"text-primary"})}),i.jsxs("div",{className:"flex-grow-1",children:[i.jsx("h6",{className:"mb-1 small",children:a.title}),i.jsx("p",{className:"text-muted mb-1 small",children:a.trainee}),i.jsx("p",{className:"text-muted mb-0 small",children:a.time})]})]},a.id)),i.jsx(le,{variant:"outline-primary",size:"sm",className:"w-100",children:"View All Activities"})]})]})})]})]})})},Xce=({courses:e,loading:t,actionsComponent:r,onView:n,onDisable:a})=>{const{sortedData:s,sortConfig:o,handleSort:l}=Bn(e);if(t)return i.jsx(Ln,{rows:4,columns:6});if(e.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No courses found"}),i.jsx("p",{children:"This department doesn't have any courses yet."})]})});const c=({columnKey:d,children:u,className:f=""})=>{const h=o.key===d,m=h?o.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${f} ${h?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="transparent",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600"},children:u}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:m,size:14})})]}),h&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsx("div",{className:"department-table-container",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[i.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:i.jsxs("tr",{children:[i.jsx(c,{columnKey:"name",className:"show-mobile",children:"Course Name"}),i.jsx(c,{columnKey:"code",className:"show-mobile",children:"Code"}),i.jsx(c,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),i.jsx(c,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),i.jsx(c,{columnKey:"venue",className:"show-mobile",children:"Venue"}),i.jsx(c,{columnKey:"note",className:"show-mobile",children:"Note"}),i.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:s.map((d,u)=>i.jsxs("tr",{children:[i.jsx("td",{className:"show-mobile",children:i.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>n(d.id),style:{cursor:"pointer"},children:d.name})}),i.jsx("td",{className:"show-mobile",children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.code})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:14,className:"me-1 text-muted"}),i.jsx("span",{className:"text-dark",children:d.startDate||"N/A"})]})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:14,className:"me-1 text-muted"}),i.jsx("span",{className:"text-dark",children:d.endDate||"N/A"})]})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(yo,{size:14,className:"me-1 text-muted"}),i.jsx("span",{className:"text-dark",children:d.venue||"N/A"})]})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xa,{size:14,className:"me-1 text-muted"}),i.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.note||"N/A"})]})}),i.jsx("td",{className:"show-mobile",children:i.jsx($e,{bg:d.status==="ACTIVE"?"success":d.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.status||"N/A"})}),i.jsx("td",{className:"text-center show-mobile",children:i.jsx(r,{course:d,onView:n,onDisable:a})})]},d.id))})]})})},Zce=({children:e,trigger:t,className:r="",menuClassName:n="",placement:a="bottom-end",disabled:s=!1})=>{const[o,l]=_.useState(!1),[c,d]=_.useState({top:0,left:0}),u=_.useRef(null),f=_.useRef(null),h=()=>{if(!u.current)return;const g=u.current.getBoundingClientRect(),x=200,b=150,y=4;let w,j;switch(a){case"bottom-start":w=g.bottom+y,j=g.left;break;case"bottom-end":w=g.bottom+y,j=g.right-x;break;case"top-start":w=g.top-b-y,j=g.left;break;case"top-end":w=g.top-b-y,j=g.right-x;break;default:w=g.bottom+y,j=g.right-x}w+b>window.innerHeight&&(w=g.top-b-y),w<0&&(w=y),j+x>window.innerWidth&&(j=window.innerWidth-x-y),j<0&&(j=y),d({top:w,left:j})},m=g=>{g.preventDefault(),g.stopPropagation(),!s&&(o||h(),l(!o))},p=()=>{l(!1)};_.useEffect(()=>{const g=b=>{o&&u.current&&!u.current.contains(b.target)&&f.current&&!f.current.contains(b.target)&&p()},x=b=>{b.key==="Escape"&&p()};return o&&(document.addEventListener("mousedown",g),document.addEventListener("keydown",x),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",g),document.removeEventListener("keydown",x),document.body.style.overflow=""}},[o]),_.useEffect(()=>{if(o){const g=()=>h(),x=()=>h();return window.addEventListener("scroll",g,!0),window.addEventListener("resize",x),()=>{window.removeEventListener("scroll",g,!0),window.removeEventListener("resize",x)}}},[o,a]);const v=o&&pd.createPortal(i.jsx("div",{ref:f,className:`dropdown-menu show portal-dropdown ${n}`,style:{position:"fixed",top:c.top,left:c.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:e}),document.body);return i.jsxs("div",{className:`dropdown ${r}`,children:[i.jsx("button",{ref:u,className:"btn btn-link dropdown-toggle",type:"button",onClick:m,disabled:s,"aria-expanded":o,"aria-haspopup":"true",children:t}),v]})},Jce=({course:e,onView:t,onDisable:r})=>{const n=()=>{t(e.id)},a=()=>{r(e.id)};return i.jsx("div",{className:"position-relative course-actions-dropdown",children:i.jsxs(Zce,{trigger:i.jsx(ln,{size:16}),placement:"bottom-end",className:"d-inline-block",children:[i.jsxs("button",{onClick:n,className:"dropdown-item d-flex align-items-center transition-all border-bottom",style:{transition:"all 0.2s ease",cursor:"pointer",padding:"0.5rem 1rem",display:"flex",alignItems:"center"},onMouseEnter:s=>s.target.style.backgroundColor="#f8f9fa",onMouseLeave:s=>s.target.style.backgroundColor="transparent",children:[i.jsx(Xt,{className:"me-2",size:16}),"View Details"]}),i.jsxs("button",{onClick:a,className:"dropdown-item d-flex align-items-center transition-all text-warning",style:{transition:"all 0.2s ease",cursor:"pointer",padding:"0.5rem 1rem",display:"flex",alignItems:"center"},onMouseEnter:s=>s.target.style.backgroundColor="#f8f9fa",onMouseLeave:s=>s.target.style.backgroundColor="transparent",children:[i.jsx(za,{className:"me-2",size:16}),"Archive Course"]})]})})},Qce=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,s]=_.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[o,l]=_.useState({});_.useEffect(()=>{e&&(s({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}))},[e]);const c=()=>{s({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}),t()},d=h=>{const{name:m,value:p}=h.target;if(s(v=>({...v,[m]:p})),o[m]&&l(v=>({...v,[m]:""})),m==="startDate"&&p){const v=new Date;v.setHours(0,0,0,0),new Date(p+"T00:00:00")<v&&l(x=>({...x,startDate:"Start date cannot be in the past"}))}if(m==="endDate"&&p){const v=new Date;v.setHours(0,0,0,0),new Date(p+"T00:00:00")<v&&l(x=>({...x,endDate:"End date cannot be in the past"}))}},u=()=>{const h={};if(a.name.trim()||(h.name="Course name is required"),a.code.trim()||(h.code="Course code is required"),a.description.trim()||(h.description="Description is required"),(!a.maxNumTrainee||isNaN(a.maxNumTrainee)||parseInt(a.maxNumTrainee)<=0)&&(h.maxNumTrainee="Max trainees must be a positive number"),a.venue.trim()||(h.venue="Venue is required"),(!a.passScore||isNaN(a.passScore)||!Number.isInteger(parseFloat(a.passScore))||parseInt(a.passScore)<0||parseInt(a.passScore)>100)&&(h.passScore="Pass score must be an integer between 0 and 100"),!a.startDate)h.startDate="Start date is required";else{const m=new Date;m.setHours(0,0,0,0),new Date(a.startDate+"T00:00:00")<m&&(h.startDate="Start date cannot be in the past")}if(!a.endDate)h.endDate="End date is required";else{const m=new Date;m.setHours(0,0,0,0),new Date(a.endDate+"T00:00:00")<m&&(h.endDate="End date cannot be in the past")}return a.startDate&&a.endDate&&new Date(a.startDate+"T00:00:00")>=new Date(a.endDate+"T00:00:00")&&(h.endDate="End date must be after start date"),l(h),Object.keys(h).length===0},f=async h=>{if(h.preventDefault(),!!u())try{await r(a),c()}catch{}};return i.jsxs(de,{show:e,onHide:c,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-2",size:20}),"Add New Course"]}),i.jsx(le,{variant:"link",onClick:c,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(Y,{onSubmit:f,children:[i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Course Name *"}),i.jsx(Y.Control,{type:"text",name:"name",value:a.name,onChange:d,isInvalid:!!o.name,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.name})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Course Code *"}),i.jsx(Y.Control,{type:"text",name:"code",value:a.code,onChange:d,isInvalid:!!o.code,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.code})]})})]}),i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Max Trainees *"}),i.jsx(Y.Control,{type:"number",name:"maxNumTrainee",value:a.maxNumTrainee,onChange:d,isInvalid:!!o.maxNumTrainee,disabled:n,min:"1"}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.maxNumTrainee})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Pass Score *"}),i.jsx(Y.Control,{type:"number",name:"passScore",value:a.passScore,onChange:d,isInvalid:!!o.passScore,disabled:n,min:"0",max:"100",step:"1"}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Level"}),i.jsxs(Y.Select,{name:"level",value:a.level,onChange:d,disabled:n,children:[i.jsx("option",{value:"BEGINNER",children:"Beginner"}),i.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),i.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Venue *"}),i.jsx(Y.Control,{type:"text",name:"venue",value:a.venue,onChange:d,isInvalid:!!o.venue,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.venue})]})})]}),i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Start Date *"}),i.jsx(Y.Control,{type:"date",name:"startDate",value:a.startDate,onChange:d,isInvalid:!!o.startDate,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.startDate})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"End Date *"}),i.jsx(Y.Control,{type:"date",name:"endDate",value:a.endDate,onChange:d,isInvalid:!!o.endDate,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Description *"}),i.jsx(Y.Control,{as:"textarea",rows:3,name:"description",value:a.description,onChange:d,isInvalid:!!o.description,disabled:n}),i.jsx(Y.Control.Feedback,{type:"invalid",children:o.description})]})})}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Note"}),i.jsx(Y.Control,{as:"textarea",rows:2,name:"note",value:a.note,onChange:d,disabled:n})]})})})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:c,disabled:n,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary-custom",type:"submit",disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},eue=({show:e,onClose:t,onArchive:r,course:n,loading:a=!1})=>{const[s,o]=_.useState(""),[l,c]=_.useState(""),u=s==="ARCHIVE",f=()=>{o(""),c(""),t()},h=async()=>{if(!u){c('Please type "ARCHIVE" to confirm');return}try{await r(n?.id),f()}catch(p){c(p.message||"Failed to archive course. Please try again.")}},m=p=>{o(p.target.value),c("")};return i.jsxs(de,{show:e,onHide:f,centered:!0,children:[i.jsx(de.Header,{className:"bg-warning text-dark border-0",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2",size:20}),"Archive Course"]})}),i.jsxs(de.Body,{className:"p-4",children:[l&&i.jsx(tt,{variant:"danger",className:"mb-3",children:l}),i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),i.jsxs("div",{className:"bg-light p-3 rounded",children:[i.jsx("strong",{children:"Course Code:"})," ",n?.code,i.jsx("br",{}),i.jsx("strong",{children:"Course Name:"})," ",n?.name,i.jsx("br",{}),n?.description&&i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:"Description:"})," ",n?.description,i.jsx("br",{})]}),n?.venue&&i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:"Venue:"})," ",n?.venue,i.jsx("br",{})]}),n?.startDate&&n?.endDate&&i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:"Duration:"})," ",n?.startDate," to ",n?.endDate]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("p",{className:"text-danger mb-2",children:[i.jsx("strong",{children:"Warning:"})," This action will:"]}),i.jsxs("ul",{className:"text-danger mb-3",children:[i.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),i.jsx("li",{children:"Move the course to archived status"}),i.jsx("li",{children:"Preserve all course data and trainee progress"}),i.jsx("li",{children:"Allow course to be restored if needed"})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",i.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),i.jsx("input",{type:"text",className:`form-control ${s&&!u?"is-invalid":""}`,id:"confirmText",value:s,onChange:m,placeholder:"Type ARCHIVE here",disabled:a}),s&&!u&&i.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:f,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"warning",onClick:h,disabled:a||!u,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Archiving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Gt,{className:"me-2",size:16}),"Archive Course"]})})]})]})},tue=({show:e,onClose:t,departmentHead:r,department:n})=>r?i.jsxs(de,{show:e,onHide:t,size:"lg",centered:!0,children:[i.jsx(de.Header,{closeButton:!0,children:i.jsxs(de.Title,{children:[i.jsx(ba,{className:"me-2"}),"Department Head Details"]})}),i.jsx(de.Body,{children:i.jsxs(Ee,{className:"g-3",children:[i.jsx(oe,{md:4,children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:i.jsx(ba,{size:40,className:"text-white"})}),i.jsxs("h5",{className:"mb-1",children:[r.firstName," ",r.lastName]}),i.jsx($e,{bg:"primary",className:"mb-2",children:"Department Head"}),i.jsx("p",{className:"text-muted small mb-0",children:n?.name})]})}),i.jsx(oe,{md:8,children:i.jsxs(Ee,{className:"g-3",children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(gd,{size:16,className:"me-2 text-primary"}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Email"}),i.jsx("div",{className:"fw-semibold",children:r.email})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Cg,{size:16,className:"me-2 text-primary"}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Phone"}),i.jsx("div",{className:"fw-semibold",children:r.phone||"N/A"})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Ts,{size:16,className:"me-2 text-primary"}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Department"}),i.jsxs("div",{className:"fw-semibold",children:[n?.name," (",n?.code,")"]})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:16,className:"me-2 text-primary"}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Appointed Date"}),i.jsx("div",{className:"fw-semibold",children:r.appointedDate||"N/A"})]})]})}),i.jsx(oe,{md:12,children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx(gl,{size:16,className:"me-2 text-primary mt-1"}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Responsibilities"}),i.jsx("div",{className:"fw-semibold",children:r.responsibilities||"Oversee department operations, manage training programs, and ensure compliance with safety standards."})]})]})})]})})]})}),i.jsx(de.Footer,{children:i.jsx(le,{variant:"secondary",onClick:t,children:"Close"})})]}):null,rue=({courseId:e})=>{const t=Et(),[r,n]=_.useState(null),[a,s]=_.useState([]),[o,l]=_.useState(!0),[c,d]=_.useState(!1),[u,f]=_.useState("add"),[h,m]=_.useState(!1),[p,v]=_.useState(null),[g,x]=_.useState(null),[b,y]=_.useState(!1),[w,j]=_.useState(!1),N={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},E=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];_.useEffect(()=>{e&&(async()=>{l(!0);try{const F=await pn.getDepartmentById(e);if(!F)throw new Error(`Department with ID ${e} not found in API response`);const M={id:F.id,name:F.name,code:F.code,description:F.description,duration:"N/A",status:F.isActive,totalSubjects:F.courseCount||0,totalTrainers:F.trainerCount||0};n(M);const H=F.courses?.map(V=>({id:V.id,name:V.name,code:V.code,startDate:V.startDate?new Date(V.startDate).toISOString().split("T")[0]:"N/A",endDate:V.endDate?new Date(V.endDate).toISOString().split("T")[0]:"N/A",venue:V.venue||"N/A",note:V.note||"N/A",status:V.status,description:V.description,maxNumTrainee:V.maxNumTrainee,passScore:V.passScore,level:V.level,subjectCount:V.subjectCount||0}))||[];s(H),F.headUser&&x(F.headUser),l(!1)}catch{l(!1);const C=N[e];C&&(n(C),s(E))}})()},[e]);const S=()=>{f("add"),d(!0)},O=P=>{const C=a.find(F=>F.id===P);v(C),m(!0)},k=async P=>{try{await pn.archiveCourse(P),ye.success("Course archived successfully"),s(C=>C.map(F=>F.id===P?{...F,status:"ARCHIVED"}:F)),m(!1),v(null)}catch(C){throw ye.error("Failed to archive course. Please try again."),C}},T=P=>{t(`/academic/course-detail/${P}`,{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},A=async P=>{try{j(!0);const C={departmentId:r.id,name:P.name,description:P.description,code:P.code,maxNumTrainee:Number(P.maxNumTrainee),venue:P.venue,note:P.note,passScore:Number(P.passScore),startDate:P.startDate?new Date(P.startDate).toISOString():null,endDate:P.endDate?new Date(P.endDate).toISOString():null,level:P.level},F=await pn.createCourse(C);ye.success("Course created successfully");const M={id:F.id,name:F.name,code:F.code,startDate:F.startDate?new Date(F.startDate).toISOString().split("T")[0]:"N/A",endDate:F.endDate?new Date(F.endDate).toISOString().split("T")[0]:"N/A",venue:F.venue||"N/A",note:F.note||"N/A",status:F.status||"PLANNED",description:F.description,maxNumTrainee:F.maxNumTrainee,passScore:F.passScore,level:F.level,department:F.department};s(H=>[M,...H])}catch(C){throw C.response?.status,ye.error(C.response?.data?.message||"Failed to create course"),C}finally{j(!1)}};return o?i.jsx(He,{className:"py-4",children:i.jsx("div",{className:"text-center",children:i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?i.jsxs(He,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[i.jsx(Ee,{className:"mb-1 flex-shrink-0",children:i.jsx(oe,{children:i.jsx(ce,{className:"border-0 shadow-sm",children:i.jsxs(ce.Body,{className:"p-2",children:[i.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:i.jsxs("div",{children:[i.jsxs("h4",{className:"mb-1",children:[i.jsx(gr,{className:"me-2 text-primary"}),r.name]}),i.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),i.jsx("p",{className:"text-muted mb-1 small",children:r.description}),i.jsxs(Ee,{className:"g-2",children:[i.jsx(oe,{md:4,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xa,{className:"me-2 text-primary",size:16}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Total Subjects"}),i.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),i.jsx(oe,{md:4,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Pn,{className:"me-2 text-primary",size:16}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Total Trainers"}),i.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),i.jsx(oe,{md:4,children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(ba,{className:"me-2 text-primary",size:16}),i.jsxs("div",{children:[i.jsx("small",{className:"text-muted",children:"Department Head"}),i.jsx("div",{className:"fw-semibold small",children:g?i.jsxs(le,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>y(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName," ",g.lastName]}):"Not assigned"})]})]})})]})]})})})}),i.jsx(Ee,{className:"mt-3",children:i.jsx(oe,{children:i.jsxs(ce,{className:"border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom flex-shrink-0",children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("h5",{className:"mb-0",children:[i.jsx(xa,{className:"me-2"}),"Courses (",a.length,")"]}),i.jsx(sn,{permission:Me.COURSES.CREATE,children:i.jsxs(le,{variant:"primary-custom",size:"sm",onClick:S,children:[i.jsx(gn,{size:16,className:"me-1"}),"Add New Course"]})})]})}),i.jsx("div",{className:"p-0",children:i.jsx(Xce,{courses:a,loading:!1,actionsComponent:Jce,onView:T,onDisable:O})})]})})}),i.jsx(Qce,{show:c&&u==="add",onClose:()=>d(!1),onSave:A,loading:w}),i.jsx(eue,{show:h,onClose:()=>m(!1),onArchive:k,course:p}),i.jsx(tue,{show:b,onClose:()=>y(!1),departmentHead:g,department:r})]}):i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center text-muted",children:[i.jsx(gr,{size:48,className:"mb-3"}),i.jsx("h4",{children:"Department not found"}),i.jsx("p",{children:"The requested department could not be found."})]})})},nue=()=>{const{courseId:e}=Fn();return i.jsx(rue,{courseId:e})},aue=({trainer:e,onEdit:t,onDelete:r})=>i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:i.jsx(ln,{size:16})},items:[{label:"Edit Trainer",icon:i.jsx(ya,{}),onClick:()=>t(e.id),permission:Me.SUBJECTS.UPDATE},{type:"divider"},{label:"Remove Trainer",icon:i.jsx(Oi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Me.SUBJECTS.REMOVE_INSTRUCTOR}]}),Q5=({show:e,onClose:t,onDisable:r,subject:n,loading:a=!1})=>{const[s,o]=_.useState(""),[l,c]=_.useState(""),u=s==="DISABLE",f=()=>{o(""),c(""),t()},h=async()=>{if(!u){c('Please type "DISABLE" to confirm');return}try{await r(n?.id),f()}catch(p){c(p.message||"Failed to disable subject. Please try again.")}},m=p=>{o(p.target.value),c("")};return i.jsxs(de,{show:e,onHide:f,centered:!0,children:[i.jsx(de.Header,{className:"bg-warning text-dark border-0",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2",size:20}),"Disable Subject"]})}),i.jsxs(de.Body,{className:"p-4",children:[l&&i.jsx(tt,{variant:"danger",className:"mb-3",children:l}),i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"mb-2",children:"You are about to disable the following subject:"}),i.jsxs("div",{className:"bg-light p-3 rounded",children:[i.jsx("strong",{children:"Subject Code:"})," ",n?.code,i.jsx("br",{}),i.jsx("strong",{children:"Subject Name:"})," ",n?.name,i.jsx("br",{}),n?.description&&i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:"Description:"})," ",n?.description]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("p",{className:"text-danger mb-2",children:[i.jsx("strong",{children:"Warning:"})," This action will:"]}),i.jsxs("ul",{className:"text-danger mb-3",children:[i.jsx("li",{children:"Make the subject unavailable for new enrollments"}),i.jsx("li",{children:"Remove the subject from active course offerings"}),i.jsx("li",{children:"Affect any ongoing training sessions"})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",i.jsx("strong",{children:"DISABLE"})," in the box below:"]}),i.jsx("input",{type:"text",className:`form-control ${s&&!u?"is-invalid":""}`,id:"confirmText",value:s,onChange:m,placeholder:"Type DISABLE here",disabled:a}),s&&!u&&i.jsx("div",{className:"invalid-feedback",children:'Please type "DISABLE" exactly as shown'})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsx(le,{variant:"outline-secondary",onClick:f,disabled:a,children:"Cancel"}),i.jsx(le,{variant:"warning",onClick:h,disabled:a||!u,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Disabling..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Gt,{className:"me-2",size:16}),"Disable Subject"]})})]})]})},sue=({show:e,onClose:t,onSave:r,subject:n,loading:a=!1})=>{const[s,o]=_.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[l,c]=_.useState([]);_.useEffect(()=>{n&&e&&(o({name:n.name||"",code:n.code||"",description:n.description||"",duration:n.duration||"",level:n.level||"Beginner"}),c([]))},[n,e]);const d=m=>{const{name:p,value:v}=m.target;o(g=>({...g,[p]:v}))},u=()=>{const m=[];return s.name.trim()||m.push("Subject name is required"),s.code.trim()||m.push("Subject code is required"),s.description.trim()||m.push("Description is required"),s.duration.trim()||m.push("Duration is required"),c(m),m.length===0},f=async m=>{if(m.preventDefault(),!!u())try{await r(s),h()}catch{}},h=()=>{o({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),t()};return i.jsxs(de,{show:e,onHide:h,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(ya,{className:"me-2",size:20}),"Edit Subject"]}),i.jsx(le,{variant:"link",onClick:h,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",children:[l.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:l.map((m,p)=>i.jsx("li",{children:m},p))})}),i.jsxs(Y,{onSubmit:f,children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Subject Name *"}),i.jsx(Y.Control,{type:"text",name:"name",value:s.name,onChange:d,placeholder:"Enter subject name",disabled:a})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Subject Code *"}),i.jsx(Y.Control,{type:"text",name:"code",value:s.code,onChange:d,placeholder:"Enter subject code",disabled:a})]})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Duration *"}),i.jsx(Y.Control,{type:"text",name:"duration",value:s.duration,onChange:d,placeholder:"e.g., 2 weeks, 1 month",disabled:a})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Level"}),i.jsxs(Y.Select,{name:"level",value:s.level,onChange:d,disabled:a,children:[i.jsx("option",{value:"Beginner",children:"Beginner"}),i.jsx("option",{value:"Intermediate",children:"Intermediate"}),i.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Description *"}),i.jsx(Y.Control,{as:"textarea",rows:4,name:"description",value:s.description,onChange:d,placeholder:"Enter subject description",disabled:a})]})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:h,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary",onClick:f,disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ya,{className:"me-2",size:16}),"Save Changes"]})})]})]})},iue=({show:e,onClose:t,onSave:r,trainer:n,loading:a=!1})=>{const[s,o]=_.useState({roleInSubject:"ASSISTANT_INSTRUCTOR"}),[l,c]=_.useState([]);_.useEffect(()=>{n&&e&&(o({roleInSubject:n.role||"ASSISTANT_INSTRUCTOR"}),c([]))},[n,e]);const d=m=>{const{name:p,value:v}=m.target;o(g=>({...g,[p]:v}))},u=()=>{const m=[];return s.roleInSubject||m.push("Role in subject is required"),c(m),m.length===0},f=async m=>{if(m.preventDefault(),!!u())try{await r(s),h()}catch{}},h=()=>{o({roleInSubject:"ASSISTANT_INSTRUCTOR"}),c([]),t()};return i.jsxs(de,{show:e,onHide:h,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(ya,{className:"me-2",size:20}),"Edit Trainer"]}),i.jsx(le,{variant:"link",onClick:h,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",children:[l.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:l.map((m,p)=>i.jsx("li",{children:m},p))})}),i.jsxs(Y,{onSubmit:f,children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Trainer Name"}),i.jsx(Y.Control,{type:"text",value:n?.name||"",disabled:!0,className:"bg-light"})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"EID"}),i.jsx(Y.Control,{type:"text",value:n?.eid||"",disabled:!0,className:"bg-light"})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{md:12,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Role in Subject *"}),i.jsxs(Y.Select,{name:"roleInSubject",value:s.roleInSubject,onChange:d,disabled:a,children:[i.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),i.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),i.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),i.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),i.jsx(Y.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:h,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary",onClick:f,disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ya,{className:"me-2",size:16}),"Save Changes"]})})]})]})},oue=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,s]=_.useState({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),[o,l]=_.useState([]),[c,d]=_.useState([]),[u,f]=_.useState(!1),h=async()=>{f(!0);try{const x=await Qr.getTrainers();x&&x.data?d(x.data):d([])}catch{d([])}finally{f(!1)}};_.useEffect(()=>{e&&(s({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),l([]),h())},[e]);const m=x=>{const{name:b,value:y}=x.target;s(w=>({...w,[b]:y}))},p=()=>{const x=[];return a.trainer_user_id||x.push("Please select a trainer"),a.role_in_subject||x.push("Role in subject is required"),l(x),x.length===0},v=async x=>{if(x.preventDefault(),!!p())try{await r(a),g()}catch{}},g=()=>{s({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),l([]),t()};return i.jsxs(de,{show:e,onHide:g,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-2",size:20}),"Add Trainer"]}),i.jsx(le,{variant:"link",onClick:g,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",children:[o.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:o.map((x,b)=>i.jsx("li",{children:x},b))})}),i.jsx(Y,{onSubmit:v,children:i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Select Trainer *"}),i.jsxs(Y.Select,{name:"trainer_user_id",value:a.trainer_user_id,onChange:m,disabled:n||u,children:[i.jsx("option",{value:"",children:u?"Loading trainers...":"Choose a trainer..."}),c.map(x=>i.jsxs("option",{value:x.id,children:[x.firstName," ",x.lastName," - ",x.department?.name||"General"]},x.id))]}),u&&i.jsxs("div",{className:"mt-2 text-center",children:[i.jsx(ur,{animation:"border",size:"sm",className:"me-2"}),i.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Role in Subject *"}),i.jsxs(Y.Select,{name:"role_in_subject",value:a.role_in_subject,onChange:m,disabled:n,children:[i.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),i.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),i.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),i.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),i.jsx(Y.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})]})})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:g,disabled:n,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary",onClick:v,disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Adding..."]}):i.jsxs(i.Fragment,{children:[i.jsx(gn,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},lue=({subjectId:e,courseId:t})=>{const r=Et(),n=ki(),[a,s]=_.useState(null),[o,l]=_.useState([]),[c,d]=_.useState(!0),[u,f]=_.useState(!1),[h,m]=_.useState(!1),[p,v]=_.useState(!1),[g,x]=_.useState(!1),[b,y]=_.useState(null),[w,j]=_.useState(!1),[N,E]=_.useState(!1),[S,O]=_.useState(!1),[k,T]=_.useState(!1),[A,P]=_.useState("subject-info"),{sortedData:C}=Bn(o),F=L=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[L]||{text:L,variant:"light"},M=_.useCallback(L=>{if(console.log(" NEW CODE: Loading trainers from subject data:",L),L&&L.instructors){console.log(" Raw instructors data:",L.instructors);const q=L.instructors.map(I=>({id:I.id,eid:I.eid,name:`${I.firstName} ${I.lastName}`,role:I.roleInSubject,assignedAt:I.assignedAt}));console.log(" Transformed trainers:",q),l(q)}else console.log(" No instructors data in subject"),l([])},[]);_.useEffect(()=>{e&&(async()=>{if(e){d(!0);try{const q=await Pr.getSubjectById(e);q?(s(q),M(q)):s(null)}catch{s(null)}finally{d(!1)}}})()},[e,M]);const H=async L=>{E(!0);try{await new Promise(q=>setTimeout(q,1e3)),s(q=>({...q,...L})),ye.success("Subject updated successfully!"),m(!1)}catch{ye.error("Failed to update subject")}finally{E(!1)}},V=async()=>{j(!0);try{await new Promise(L=>setTimeout(L,1e3)),f(!1)}catch{}finally{j(!1)}},B=async L=>{O(!0);try{await Pr.addTrainerToSubject(e,L);const q=await Pr.getSubjectById(e);q&&(s(q),M(q)),ye.success("Trainer added successfully!"),v(!1)}catch(q){console.error("Error adding trainer:",q);const I=q?.message||q?.error||"Failed to add trainer";ye.error(I)}finally{O(!1)}},W=async L=>{if(b){T(!0);try{await Pr.updateTrainerRole(e,b.id,L);const q=await Pr.getSubjectById(e);q&&(s(q),M(q)),ye.success("Trainer role updated successfully!"),x(!1)}catch(q){console.error("Error updating trainer role:",q);const I=q?.message||q?.error||"Failed to update trainer role";ye.error(I)}finally{T(!1)}}},z=async L=>{if(L)try{await Pr.removeTrainerFromSubject(e,L);const q=await Pr.getSubjectById(e);q&&(s(q),M(q)),ye.success("Trainer removed successfully!")}catch(q){console.error("Error removing trainer:",q);const I=q?.message||q?.error||"Failed to remove trainer";ye.error(I)}},D=()=>{if(t)r(`/academic/course-detail/${t}`);else if(n.state?.courseId)r(`/academic/course-detail/${n.state.courseId}`);else if(document.referrer){const L=document.referrer.match(/\/course-detail\/([^/]+)/);r(L?`/academic/course-detail/${L[1]}`:-1)}else a?.courseId?r(`/academic/course-detail/${a.courseId}`):r(-1)};return c?i.jsx(He,{className:"py-4",children:i.jsx(Ln,{rows:4,columns:3})}):a?i.jsxs(He,{className:"py-4 subject-details",children:[i.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsxs(le,{variant:"outline-secondary",onClick:D,className:"me-3",children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Course"]}),i.jsxs("div",{children:[i.jsx("h2",{className:"mb-1",children:a.name}),i.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",a.code]})]})]})}),i.jsx(ce,{className:"border-0 shadow-sm",children:i.jsxs(dn.Container,{activeKey:A,onSelect:P,children:[i.jsx(ce.Header,{className:"border-bottom py-2",children:i.jsxs(zr,{variant:"tabs",className:"border-0",children:[i.jsx(zr.Item,{children:i.jsxs(zr.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",color:A==="subject-info"?"#0d6efd":"#6c757d",fontWeight:A==="subject-info"?"600":"400"},children:[i.jsx(pS,{className:"me-2",size:16}),"Subject Information"]})}),i.jsx(zr.Item,{children:i.jsxs(zr.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",color:A==="trainers"?"#0d6efd":"#6c757d",fontWeight:A==="trainers"?"600":"400"},children:[i.jsx(wS,{className:"me-2",size:16}),"Trainers (",o.length,")"]})})]})}),i.jsx(ce.Body,{className:"p-4",children:i.jsxs(dn.Content,{children:[i.jsxs(dn.Pane,{eventKey:"subject-info",children:[i.jsxs(Ee,{children:[i.jsxs(oe,{md:6,children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Code:"})," ",a.code]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",a.description]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Method:"})," ",a.method]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Duration:"})," ",a.duration," days"]})]}),i.jsxs(oe,{md:6,children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Type:"})," ",a.type]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Pass Score:"})," ",a.passScore,"%"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Room:"})," ",a.roomName]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Time Slot:"})," ",a.timeSlot]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Start Date:"})," ",new Date(a.startDate).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"End Date:"})," ",new Date(a.endDate).toLocaleDateString()]})]})]}),a.remarkNote&&i.jsx(Ee,{children:i.jsx(oe,{xs:12,children:i.jsxs("p",{children:[i.jsx("strong",{children:"Remark Note:"})," ",a.remarkNote]})})})]}),i.jsxs(dn.Pane,{eventKey:"trainers",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[i.jsxs("h6",{className:"mb-0",children:["Trainers (",o.length,")"]}),i.jsxs(le,{variant:"primary",size:"sm",onClick:()=>v(!0),children:[i.jsx(gn,{size:14,className:"me-1"}),"Add Trainer"]})]}),i.jsxs(Yt,{hover:!0,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"EID"}),i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Assigned Date"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:C.map(L=>{const q=F(L.role);return i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx($e,{bg:"secondary",className:"text-white",children:L.eid})}),i.jsx("td",{children:L.name}),i.jsx("td",{children:i.jsx($e,{bg:q.variant,children:q.text})}),i.jsx("td",{children:new Date(L.assignedAt).toLocaleDateString()}),i.jsx("td",{children:i.jsx(aue,{trainer:L,onEdit:()=>{y(L),x(!0)},onDelete:z})})]},L.id)})})]})]})]})})]})}),i.jsx(Q5,{show:u,onClose:()=>f(!1),onConfirm:V,subject:a,loading:w}),i.jsx(sue,{show:h,onClose:()=>m(!1),onSave:H,subject:a,loading:N}),i.jsx(oue,{show:p,onClose:()=>v(!1),onSave:B,loading:S}),i.jsx(iue,{show:g,onClose:()=>x(!1),onSave:W,trainer:b,loading:k})]}):i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{children:"Subject not found"}),i.jsx("p",{children:"The requested subject could not be found."}),i.jsxs(le,{variant:"primary",onClick:D,children:[i.jsx(dr,{className:"me-2",size:16}),"Go Back"]})]})})},yE=()=>{const{subjectId:e,courseId:t}=Fn();return i.jsx(lue,{subjectId:e,courseId:t})},cue=({subject:e,onView:t,onEdit:r,onDelete:n})=>{const a=()=>{t&&t(e.id)},s=()=>{n&&n(e.id)};return i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Details",icon:i.jsx(Xt,{}),onClick:a,permission:Me.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Disable Subject",icon:i.jsx(_S,{}),className:"text-warning",onClick:s,permission:Me.SUBJECTS.DELETE}]})},uue=e=>(console.log(" mapApiSubjectToTable - API subject fields:",Object.keys(e)),console.log(" mapApiSubjectToTable - start_date:",e.start_date,"startDate:",e.startDate),console.log(" mapApiSubjectToTable - end_date:",e.end_date,"endDate:",e.endDate),{id:e.id,name:e.name,code:e.code,method:e.method,duration:fue(e.duration),startDate:bE(e.startDate||e.start_date),endDate:bE(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.deletedAt?"INACTIVE":"ACTIVE",description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),due=e=>{console.log(" mapApiSubjectsToTable - Input:",e),console.log(" mapApiSubjectsToTable - Input length:",e.length);const t=e.map(uue);return console.log(" mapApiSubjectsToTable - Output:",t),console.log(" mapApiSubjectsToTable - Output length:",t.length),t},fue=e=>e?e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`:"N/A",bE=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch(t){return console.error("Error formatting date:",t),"Invalid Date"}},hue=e=>{switch(e){case"ACTIVE":return"success";case"INACTIVE":return"secondary";default:return"secondary"}},mue=e=>{switch(e){case"CLASSROOM":return"info";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},pue=({subjects:e=[],loading:t=!1,onView:r,onEdit:n,onDelete:a})=>{console.log(" SubjectTable - Received subjects:",e),console.log(" SubjectTable - subjects length:",e.length),console.log(" SubjectTable - loading:",t);const s=due(e);console.log(" SubjectTable - mappedApiSubjects:",s),console.log(" SubjectTable - mappedApiSubjects length:",s.length);const{sortedData:o,sortConfig:l,handleSort:c}=Bn(s);if(t)return i.jsx(Ln,{rows:4,columns:5});if(s.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No subjects found"}),i.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const d=({columnKey:u,children:f,className:h=""})=>{const m=l.key===u,p=m?l.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${h} ${m?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>c(u),onMouseEnter:v=>{v.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",v.target.style.transform="translateY(-1px)",v.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:v=>{v.target.style.backgroundColor="transparent",v.target.style.transform="translateY(0)",v.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:f}),i.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:i.jsx(is,{direction:p,size:14})})]}),m&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[i.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:i.jsxs("tr",{children:[i.jsx(d,{columnKey:"name",className:"show-mobile",children:"Name"}),i.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),i.jsx(d,{columnKey:"method",className:"show-mobile",children:"Method"}),i.jsx(d,{columnKey:"duration",className:"show-mobile",children:"Duration"}),i.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),i.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),i.jsx(d,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),i.jsx(d,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),i.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:i.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),i.jsx("tbody",{children:o.map(u=>i.jsxs("tr",{children:[i.jsx("td",{className:"show-mobile",children:i.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(u.id),style:{cursor:"pointer"},children:u.name})}),i.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.code,children:u.code})}),i.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:i.jsx($e,{bg:mue(u.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.method,children:u.method})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",children:u.duration})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",children:u.startDate})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",children:u.endDate})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",children:u.roomName})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Pn,{size:14,className:"me-1 text-muted"}),i.jsx("span",{className:"text-dark",children:u.trainees||0})]})}),i.jsx("td",{className:"show-mobile",children:i.jsxs($e,{bg:hue(u.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[i.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="ACTIVE"?"":""}),u.status==="ACTIVE"?"Active":"Inactive"]})}),i.jsx("td",{className:"text-center show-mobile",children:i.jsx(cue,{subject:u,onView:r,onEdit:n,onDelete:a})})]},u.id))})]})})},vue=({trainee:e,onView:t,onRemove:r})=>{const n=()=>{t&&t(e)},a=()=>{r&&r(e)};return i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Details",icon:i.jsx(Xt,{}),onClick:n,permission:Me.TRAINEES.VIEW_DETAIL},{type:"divider"},{label:"Remove from Course",icon:i.jsx(bo,{}),className:"text-danger",onClick:a,permission:Me.TRAINEES?.DELETE}]})},gue=({show:e,onClose:t,onConfirm:r,trainee:n,subject:a,loading:s=!1})=>{if(!n||!a)return null;const o=()=>{r(n.id,a.id)};return i.jsxs(de,{show:e,onHide:t,centered:!0,children:[i.jsx(de.Header,{closeButton:!0,className:"border-bottom",children:i.jsxs(de.Title,{className:"d-flex align-items-center text-danger",children:[i.jsx(Gt,{className:"me-2",size:20}),"Remove Subject"]})}),i.jsxs(de.Body,{className:"p-4",children:[i.jsxs(tt,{variant:"warning",className:"mb-3",children:[i.jsx(Gt,{className:"me-2",size:16}),i.jsx("strong",{children:"Warning:"})," This action cannot be undone."]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("p",{className:"mb-2",children:["Are you sure you want to remove ",i.jsxs("strong",{children:['"',a.name,'"']})," from trainee ",i.jsxs("strong",{children:['"',n.name,'"']}),"?"]}),i.jsx("div",{className:"bg-light p-3 rounded",children:i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx("small",{className:"text-muted",children:"Trainee:"}),i.jsx("div",{className:"fw-semibold",children:n.name}),i.jsx("div",{className:"text-muted small",children:n.eid})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx("small",{className:"text-muted",children:"Subject:"}),i.jsx("div",{className:"fw-semibold",children:a.name}),i.jsx("div",{className:"text-muted small",children:a.code})]})]})})]}),i.jsx("p",{className:"text-muted small mb-0",children:"The trainee will no longer be enrolled in this subject and will lose access to related materials and assessments."})]}),i.jsxs(de.Footer,{className:"border-top",children:[i.jsx(le,{variant:"secondary",onClick:t,disabled:s,children:"Cancel"}),i.jsx(le,{variant:"danger",onClick:o,disabled:s,className:"d-flex align-items-center",children:s?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Removing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Oi,{className:"me-2",size:16}),"Remove Subject"]})})]})]})},xue=({show:e,onClose:t,trainee:r,onRemoveSubject:n,loading:a=!1})=>{const[s,o]=_.useState(!1),[l,c]=_.useState(null),[d,u]=_.useState(!1);if(!r)return null;const f=(p,v)=>{const g=r.subjects.find(x=>x.id===p);g&&(c(g),o(!0))},h=async(p,v)=>{u(!0);try{await n(p,v),o(!1),c(null)}catch(g){console.error("Error removing subject:",g)}finally{u(!1)}},m=()=>{o(!1),c(null)};return i.jsxs(de,{show:e,onHide:t,size:"lg",centered:!0,children:[i.jsx(de.Header,{closeButton:!0,className:"border-bottom",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(ba,{className:"me-2 text-primary",size:20}),"Trainee Details"]})}),i.jsxs(de.Body,{className:"p-4",children:[i.jsxs(Ee,{className:"mb-4",children:[i.jsxs(oe,{md:6,children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Full Name"}),i.jsx("p",{className:"mb-0 fw-semibold",children:r.name})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Employee ID"}),i.jsx($e,{bg:"secondary",className:"px-2 py-1",children:r.eid})]})]}),i.jsxs(oe,{md:6,children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Email"}),i.jsx("span",{children:r.email})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Phone"}),i.jsx("span",{children:r.phone})]})]})]}),i.jsxs(Ee,{className:"mb-4",children:[i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Enroll Date"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:16,className:"me-2 text-primary"}),i.jsx("span",{children:r.enrollDate||"N/A"})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{className:"text-muted mb-1",children:"Enroll Batch"}),i.jsx($e,{bg:"info",className:"px-2 py-1",children:r.enrollBatch||"N/A"})]})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("h6",{className:"text-muted mb-3 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2 text-primary",size:16}),"Enrolled Subjects (",r.subjects?.length||0,")"]}),r.subjects&&r.subjects.length>0?i.jsx("div",{className:"table-responsive",children:i.jsxs(Yt,{hover:!0,size:"sm",className:"mb-0",children:[i.jsx("thead",{className:"bg-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-0",children:"Subject Name"}),i.jsx("th",{className:"border-0",children:"Code"}),i.jsx("th",{className:"border-0",children:"Status"}),i.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),i.jsx("tbody",{children:r.subjects.map((p,v)=>i.jsxs("tr",{children:[i.jsxs("td",{className:"border-0",children:[i.jsx("div",{className:"fw-semibold",children:p.name}),p.description&&i.jsx("small",{className:"text-muted",children:p.description})]}),i.jsx("td",{className:"border-0",children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:p.code})}),i.jsx("td",{className:"border-0",children:i.jsx($e,{bg:p.status==="ACTIVE"?"success":p.status==="COMPLETED"?"primary":"warning",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:p.status})}),i.jsx("td",{className:"border-0 text-center",children:i.jsx(le,{variant:"outline-danger",size:"sm",onClick:()=>f(p.id||v,p.name),disabled:a,className:"p-1",style:{minWidth:"32px"},children:i.jsx(Oi,{size:14})})})]},v))})]})}):i.jsxs("div",{className:"text-center text-muted py-3",children:[i.jsx(gr,{size:32,className:"mb-2"}),i.jsx("p",{className:"mb-0",children:"No subjects enrolled"})]})]})]}),i.jsx(de.Footer,{className:"border-top",children:i.jsx(le,{variant:"secondary",onClick:t,children:"Close"})}),i.jsx(gue,{show:s,onClose:m,onConfirm:h,trainee:r,subject:l,loading:d})]})},yue=({course:e,loading:t=!1,onView:r,onRemove:n})=>{const{courseId:a}=Fn(),[s,o]=_.useState(null),[l,c]=_.useState(!1),[d,u]=_.useState([]),[f,h]=_.useState(!0),[m,p]=_.useState(null),{sortedData:v,sortConfig:g,handleSort:x}=Bn(d),b=_.useCallback(async()=>{h(!0),p(null);try{const S=await no.getTraineesForEnrollment();if(!S||!S.data){u([]);return}const O=[];for(const k of S.data)try{const T=await pn.getTraineeEnrollments(k.id);if(T&&T.enrollments&&T.enrollments.length>0){const A=T.enrollments.filter(P=>P.enrollment?.status==="ENROLLED");if(A.length>0){const P=A.map(F=>F.subject.id),C={id:k.id,eid:k.eid,name:`${k.firstName} ${k.lastName}`.trim(),email:k.email,subjects:P,userId:k.id,department:k.department,enrollmentCount:A.length,enrollDate:A[0]?.enrollment?.enrollmentDate?new Date(A[0].enrollment.enrollmentDate).toLocaleDateString():"N/A",enrollBatch:A[0]?.enrollment?.batchCode||"N/A"};O.push(C)}}}catch{}u(O)}catch{u([])}finally{h(!1)}},[]);_.useEffect(()=>{a&&b()},[a,b]);const y=async S=>{try{const O=await pn.getTraineeEnrollments(S.userId),k=O.enrollments?.filter(A=>A.enrollment?.status==="ENROLLED")||[],T={...S,enrollmentDetails:O,subjects:k.map(A=>({id:A.subject.id,name:A.subject.name,code:A.subject.code,status:A.subject.status,type:A.subject.type,method:A.subject.method,startDate:A.subject.startDate,endDate:A.subject.endDate,course:A.subject.course,enrollment:A.enrollment}))};o(T),c(!0)}catch{o(S),c(!0)}},w=()=>{c(!1),o(null)},j=async S=>{if(window.confirm(`Are you sure you want to remove ${S.name} from this course?`))try{const O=await pn.getTraineeEnrollments(S.userId);if(O&&O.enrollments&&O.enrollments.length>0){const T=O.enrollments.map(async A=>{const P=A.subject.id,C=A.enrollment?.batchCode||"TEST0012025";return A.enrollment?.status!=="ENROLLED"?null:Pr.removeTraineeFromSubject(P,S.userId,C)}).filter(A=>A!==null);T.length>0&&await Promise.all(T),await b()}}catch(O){console.error("Error removing trainee:",O)}},N=async(S,O)=>{try{const k=d.find(P=>P.id===S);if(!k)return;const T=s?.subjects?.find(P=>P.id===O);if(!T)return;const A=T.enrollment?.batchCode||"TEST0012025";if(T.enrollment?.status!=="ENROLLED")throw new Error("Cannot remove trainee from inactive enrollment");await Pr.removeTraineeFromSubject(O,k.userId,A),await b(),c(!1)}catch(k){throw console.error("Error removing subject:",k),k}};if(f)return i.jsx(Ln,{rows:4,columns:7});if(m)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-danger",children:[i.jsx("h5",{children:"Error loading trainees"}),i.jsx("p",{children:m}),i.jsx("button",{className:"btn btn-outline-primary",onClick:fetchTrainees,children:"Try Again"})]})});if(d.length===0)return i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No trainees found"}),i.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})});const E=({columnKey:S,children:O,className:k=""})=>{const T=g.key===S,A=T?g.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${k} ${T?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>x(S),onMouseEnter:P=>{P.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",P.target.style.transform="translateY(-1px)",P.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:P=>{P.target.style.backgroundColor="transparent",P.target.style.transform="translateY(0)",P.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:O}),i.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:i.jsx(is,{direction:A,size:14})})]}),T&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"department-table-container trainee-table-scroll",style:{overflowX:"hidden"},children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[i.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:i.jsxs("tr",{children:[i.jsx(E,{columnKey:"eid",className:"show-mobile",children:"EID"}),i.jsx(E,{columnKey:"name",className:"show-mobile",children:"Full Name"}),i.jsx(E,{columnKey:"email",className:"show-mobile",children:"Email"}),i.jsx(E,{columnKey:"subjects",className:"show-mobile",children:"Number of Subjects"}),i.jsx(E,{columnKey:"enrollDate",className:"show-mobile",children:"Enroll Date"}),i.jsx(E,{columnKey:"enrollBatch",className:"show-mobile",children:"Enroll Batch"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:i.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),i.jsx("tbody",{children:v.map(S=>i.jsxs("tr",{children:[i.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:S.eid,children:S.eid})}),i.jsx("td",{className:"show-mobile",children:i.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>y(S),style:{cursor:"pointer"},children:S.name})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",style:{fontSize:"0.85rem"},children:S.email})}),i.jsx("td",{className:"show-mobile",children:i.jsx($e,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:S.enrollmentCount})}),i.jsx("td",{className:"show-mobile",children:i.jsx("span",{className:"text-dark",children:S.enrollDate})}),i.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:i.jsx($e,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:S.enrollBatch,children:S.enrollBatch})}),i.jsx("td",{className:"text-center show-mobile",children:i.jsx(vue,{trainee:S,onView:y,onRemove:j})})]},S.id))})]})}),i.jsx(xue,{show:l,onClose:w,trainee:s,onRemoveSubject:N})]})},bue=({show:e,onClose:t,onSave:r,loading:n=!1,courseId:a})=>{const[s,o]=_.useState({courseId:a||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[l,c]=_.useState([]),[d,u]=_.useState(!1),[f,h]=_.useState([]),[m,p]=_.useState(!1);_.useEffect(()=>{e&&v()},[e]);const v=async()=>{p(!0);try{const w=await pn.getCourses();w&&w.courses?h(w.courses):Array.isArray(w)&&h(w)}catch{ye.error("Failed to load courses")}finally{p(!1)}},g=w=>{const{name:j,value:N,type:E,checked:S}=w.target;o(O=>({...O,[j]:E==="checkbox"?S:N}))},x=()=>{const w=[];return s.courseId.trim()||w.push("Course is required"),s.name.trim()||w.push("Subject name is required"),s.code.trim()||w.push("Subject code is required"),s.description.trim()||w.push("Description is required"),s.duration.trim()?(isNaN(s.duration)||parseInt(s.duration)<=0)&&w.push("Duration must be a positive number"):w.push("Duration is required"),s.passScore.trim()?(isNaN(s.passScore)||parseInt(s.passScore)<0||parseInt(s.passScore)>100)&&w.push("Pass score must be between 0 and 100"):w.push("Pass score is required"),s.startDate.trim()||w.push("Start date is required"),s.endDate.trim()||w.push("End date is required"),s.startDate&&s.endDate&&new Date(s.startDate)>=new Date(s.endDate)&&w.push("End date must be after start date"),c(w),w.length===0},b=async w=>{if(w.preventDefault(),!!x()){u(!0);try{const j={courseId:a,name:s.name.trim(),code:s.code.trim(),description:s.description.trim(),method:s.method,duration:parseInt(s.duration),type:s.type,roomName:s.roomName.trim(),remarkNote:s.remarkNote.trim(),timeSlot:s.timeSlot.trim(),isSIM:s.isSIM,passScore:parseInt(s.passScore),startDate:new Date(s.startDate).toISOString(),endDate:new Date(s.endDate).toISOString()},N=await Ie.post("/subjects",j);ye.success("Subject created successfully!"),r&&await r(N.data||j),y()}catch(j){const N=j.response?.data?.message||j.message||"Failed to create subject";ye.error(`Error: ${N}`),c([N])}finally{u(!1)}}},y=()=>{o({courseId:a||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),u(!1),t()};return i.jsxs(de,{show:e,onHide:y,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-2",size:20}),"Add New Subject"]}),i.jsx(le,{variant:"link",onClick:y,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[l.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:l.map((w,j)=>i.jsx("li",{children:w},j))})}),i.jsxs(Y,{onSubmit:b,children:[i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Course *"}),i.jsxs(Y.Select,{name:"courseId",value:s.courseId,onChange:g,required:!0,disabled:m,children:[i.jsx("option",{value:"",children:m?"Loading courses...":"Select a course"}),f.map(w=>i.jsxs("option",{value:w.id,children:[w.name," (",w.code,")"]},w.id))]})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Subject Name *"}),i.jsx(Y.Control,{type:"text",name:"name",value:s.name,onChange:g,placeholder:"Enter subject name",required:!0})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Subject Code *"}),i.jsx(Y.Control,{type:"text",name:"code",value:s.code,onChange:g,placeholder:"Enter subject code",required:!0})]})})]}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Description *"}),i.jsx(Y.Control,{as:"textarea",rows:3,name:"description",value:s.description,onChange:g,placeholder:"Enter subject description",required:!0})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Method *"}),i.jsxs(Y.Select,{name:"method",value:s.method,onChange:g,required:!0,children:[i.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),i.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),i.jsx("option",{value:"ERO",children:"ERO"})]})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Duration (days) *"}),i.jsx(Y.Control,{type:"number",name:"duration",value:s.duration,onChange:g,placeholder:"Enter duration in days",min:"1",required:!0})]})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Type *"}),i.jsxs(Y.Select,{name:"type",value:s.type,onChange:g,required:!0,children:[i.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),i.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Room Name"}),i.jsx(Y.Control,{type:"text",name:"roomName",value:s.roomName,onChange:g,placeholder:"Enter room name"})]})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Time Slot"}),i.jsx(Y.Control,{type:"text",name:"timeSlot",value:s.timeSlot,onChange:g,placeholder:"e.g., 09:00-11:00"})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Pass Score *"}),i.jsx(Y.Control,{type:"number",name:"passScore",value:s.passScore,onChange:g,placeholder:"Enter pass score (0-100)",min:"0",max:"100",required:!0})]})})]}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Start Date *"}),i.jsx(Y.Control,{type:"datetime-local",name:"startDate",value:s.startDate,onChange:g,required:!0})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"End Date *"}),i.jsx(Y.Control,{type:"datetime-local",name:"endDate",value:s.endDate,onChange:g,required:!0})]})})]}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Remark Note"}),i.jsx(Y.Control,{as:"textarea",rows:2,name:"remarkNote",value:s.remarkNote,onChange:g,placeholder:"Enter remark note"})]}),i.jsx(Y.Group,{className:"mb-3",children:i.jsx(Y.Check,{type:"checkbox",name:"isSIM",checked:s.isSIM,onChange:g,label:"Is Simulator"})})]})]}),i.jsxs(de.Footer,{className:"border-0",children:[i.jsx(le,{variant:"secondary",onClick:y,children:"Cancel"}),i.jsx(le,{variant:"primary",onClick:b,disabled:d,children:d?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"16px",height:"16px"}}),"Creating..."]}):"Create Subject"})]})]})},wue=({show:e,onClose:t,onImport:r,loading:n=!1,courseId:a})=>{const[s,o]=_.useState(!1),[l,c]=_.useState(null),[d,u]=_.useState([]),[f,h]=_.useState([]),[m,p]=_.useState([]),v=_.useRef(null),g=["code","name","course_id"],x=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date"],b=T=>{T.preventDefault(),T.stopPropagation(),T.type==="dragenter"||T.type==="dragover"?o(!0):T.type==="dragleave"&&o(!1)},y=T=>{T.preventDefault(),T.stopPropagation(),o(!1),T.dataTransfer.files&&T.dataTransfer.files[0]&&j(T.dataTransfer.files[0])},w=T=>{T.target.files&&T.target.files[0]&&j(T.target.files[0])},j=T=>{if(!T.name.match(/\.(xlsx|xls)$/)){h(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(T.size>100*1024*1024){h(["File size must be less than 100MB"]);return}c(T),h([]),N(T)},N=T=>{const A=new FileReader;A.onload=P=>{try{const C=new Uint8Array(P.target.result),F=Vl(C,{type:"array"}),M=F.SheetNames[0],H=F.Sheets[M],V=ea.sheet_to_json(H,{header:1});if(V.length<2){h(["Excel file must contain at least a header row and one data row"]);return}const B=V[0].map(L=>L?.toString().toLowerCase().trim()),W=V.slice(1),z=g.filter(L=>!B.includes(L));if(z.length>0){h([`Missing required columns: ${z.join(", ")}`]);return}const D=W.map((L,q)=>{const I={id:`temp_${q}`,rowNumber:q+2,code:L[B.indexOf("code")]?.toString().trim()||"",name:L[B.indexOf("name")]?.toString().trim()||"",course_id:L[B.indexOf("course_id")]?.toString().trim()||"",description:L[B.indexOf("description")]?.toString().trim()||"",method:L[B.indexOf("method")]?.toString().trim()||"THEORY",duration:L[B.indexOf("duration")]?.toString().trim()||"",type:L[B.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:L[B.indexOf("room_name")]?.toString().trim()||"",remark_note:L[B.indexOf("remark_note")]?.toString().trim()||"",time_slot:L[B.indexOf("time_slot")]?.toString().trim()||"",pass_score:L[B.indexOf("pass_score")]?.toString().trim()||"",start_date:L[B.indexOf("start_date")]?.toString().trim()||"",end_date:L[B.indexOf("end_date")]?.toString().trim()||"",hasError:!1,errors:[]};if(I.code||(I.hasError=!0,I.errors.push("Subject code is required")),I.name||(I.hasError=!0,I.errors.push("Subject name is required")),I.course_id?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(I.course_id)||(I.hasError=!0,I.errors.push("Course ID must be a valid UUID format")):(I.hasError=!0,I.errors.push("Course ID is required")),I.duration&&(isNaN(I.duration)||parseInt(I.duration)<=0)&&(I.hasError=!0,I.errors.push("Duration must be a positive number")),I.pass_score&&(isNaN(I.pass_score)||parseFloat(I.pass_score)<0||parseFloat(I.pass_score)>100)&&(I.hasError=!0,I.errors.push("Pass score must be between 0 and 100")),I.method&&!["E_LEARNING","CLASSROOM","ERO"].includes(I.method.toUpperCase())&&(I.hasError=!0,I.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO")),I.type&&!["UNLIMIT","RECURRENT"].includes(I.type.toUpperCase())&&(I.hasError=!0,I.errors.push("Type must be UNLIMIT or RECURRENT")),I.start_date){let R;if(typeof I.start_date=="number"&&I.start_date>1e4){const X=parseFloat(I.start_date);R=new Date((X-25569)*86400*1e3).toISOString().replace("T"," ").replace("Z","")}else{const X=String(I.start_date).trim();/^\d{4}-\d{2}-\d{2}/.test(X)?R=X:R=X.replace(/\s+(AM|PM)/gi,"").replace(/\s+/g," ").replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})/,"$3-$1-$2 $4:$5:$6")}isNaN(Date.parse(R))?(I.hasError=!0,I.errors.push("Start date must be a valid date")):I.start_date=R}if(I.end_date){let R;if(typeof I.end_date=="number"&&I.end_date>1e4){const X=parseFloat(I.end_date);R=new Date((X-25569)*86400*1e3).toISOString().replace("T"," ").replace("Z","")}else{const X=String(I.end_date).trim();/^\d{4}-\d{2}-\d{2}/.test(X)?R=X:R=X.replace(/\s+(AM|PM)/gi,"").replace(/\s+/g," ").replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})/,"$3-$1-$2 $4:$5:$6")}isNaN(Date.parse(R))?(I.hasError=!0,I.errors.push("End date must be a valid date")):I.end_date=R}return I}).filter(L=>L.code||L.name);u(D),p([])}catch{h(["Failed to parse Excel file. Please check the file format."])}},A.readAsArrayBuffer(T)},E=async()=>{const T=d.filter(P=>!P.hasError);if(T.length===0){h(["No valid subjects to import"]);return}const A=T.map(P=>({code:P.code,name:P.name,courseId:String(a||P.course_id),description:P.description||"",method:P.method?P.method.toUpperCase():"CLASSROOM",duration:P.duration?parseInt(P.duration):1,type:P.type?P.type.toUpperCase():"UNLIMIT",room_name:P.room_name||"",remark_note:P.remark_note||"",time_slot:P.time_slot||"",pass_score:P.pass_score?parseFloat(P.pass_score):70,start_date:P.start_date||null,end_date:P.end_date||null}));try{await r(A),S()}catch(P){h([P.message||"Failed to import subjects. Please try again."])}},S=()=>{c(null),u([]),h([]),p([]),o(!1),t()},O=T=>T==="valid"?i.jsx(It,{className:"text-success",size:16}):i.jsx(za,{className:"text-danger",size:16}),k=()=>{const T=[x,["MATH101","Mathematics",a||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",a||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",a||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],A=ea.aoa_to_sheet(T),P=ea.book_new();ea.book_append_sheet(P,A,"Subjects"),Ny(P,"Subject_Upload_Template.xlsx")};return i.jsxs(de,{show:e,onHide:S,size:"xl",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-2",size:20}),"Bulk Import Subjects"]}),i.jsx(le,{variant:"link",onClick:S,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[f.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:f.map((T,A)=>i.jsx("li",{children:T},A))})}),i.jsx(ce,{className:"mb-4",children:i.jsxs(ce.Body,{children:[i.jsxs("div",{className:`upload-area ${s?"drag-active":""}`,onDragEnter:b,onDragLeave:b,onDragOver:b,onDrop:y,onClick:()=>v.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:s?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[i.jsx(to,{size:48,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),i.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),i.jsx("input",{ref:v,type:"file",accept:".xlsx,.xls",onChange:w,style:{display:"none"}})]}),i.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[i.jsxs("div",{children:[i.jsxs("small",{className:"text-muted",children:[i.jsx("strong",{children:"Required columns:"})," Code, Name, Course ID (UUID format)"]}),i.jsx("br",{}),i.jsxs("small",{className:"text-muted",children:[i.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:k,className:"d-flex align-items-center",children:[i.jsx(Ja,{className:"me-1",size:14}),"Download Template"]}),l&&i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(to,{className:"text-success me-2",size:16}),i.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})]})}),d.length>0&&i.jsxs(ce,{children:[i.jsx(ce.Header,{className:"bg-light",children:i.jsxs("h6",{className:"mb-0",children:["Preview Data (",d.length," subjects)",i.jsxs("span",{className:"ms-2",children:[i.jsx(It,{className:"text-success me-1",size:16}),d.filter(T=>!T.hasError).length," valid",i.jsx(za,{className:"text-danger ms-2 me-1",size:16}),d.filter(T=>T.hasError).length," invalid"]})]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:i.jsxs(Yt,{hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"bg-light sticky-top",children:i.jsxs("tr",{children:[i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Code"}),i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Course ID"}),i.jsx("th",{children:"Method"}),i.jsx("th",{children:"Duration"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Pass Score"}),i.jsx("th",{children:"Errors"})]})}),i.jsx("tbody",{children:d.map((T,A)=>i.jsxs("tr",{className:T.hasError?"table-danger":"table-success",children:[i.jsx("td",{children:O(T.hasError?"invalid":"valid")}),i.jsx("td",{children:T.code}),i.jsx("td",{children:T.name}),i.jsx("td",{children:T.course_id}),i.jsx("td",{children:T.method}),i.jsx("td",{children:T.duration}),i.jsx("td",{children:T.type}),i.jsx("td",{children:T.pass_score}),i.jsx("td",{children:T.errors.length>0&&i.jsx("small",{className:"text-danger",children:T.errors.join(", ")})})]},T.id))})]})})})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:S,disabled:n,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),d.length>0&&i.jsx(le,{variant:"primary",onClick:E,disabled:n||d.filter(T=>!T.hasError).length===0,children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Dn,{className:"me-2",size:16}),"Import All (",d.filter(T=>!T.hasError).length," subjects)"]})})]})]})},jue=({show:e,onClose:t,onSave:r,course:n,loading:a=!1})=>{const[s,o]=_.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[l,c]=_.useState({});_.useEffect(()=>{n&&o({name:n.name||"",code:n.code||"",description:n.description||"",maxTrainees:n.maxNumTrainee||n.maxTrainees||"",venue:n.venue||"",note:n.note||"",passScore:n.passScore||"",startDate:n.startDate||"",endDate:n.endDate||"",level:n.level||"BEGINNER",status:n.status||"ACTIVE"})},[n]);const d=()=>{o({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}),t()},u=m=>{const{name:p,value:v}=m.target;o(g=>({...g,[p]:v})),l[p]&&c(g=>({...g,[p]:""}))},f=()=>{const m={};if(s.name.trim()||(m.name="Course name is required"),s.code.trim()||(m.code="Course code is required"),s.description.trim()||(m.description="Description is required"),(!s.maxTrainees||isNaN(s.maxTrainees)||parseInt(s.maxTrainees)<=0)&&(m.maxTrainees="Max trainees must be a positive number"),s.venue.trim()||(m.venue="Venue is required"),(!s.passScore||isNaN(s.passScore)||parseInt(s.passScore)<0||parseInt(s.passScore)>100)&&(m.passScore="Pass score must be between 0 and 100"),!s.startDate)m.startDate="Start date is required";else{const p=new Date;p.setHours(0,0,0,0),new Date(s.startDate)<p&&(m.startDate="Start date cannot be in the past")}return s.endDate||(m.endDate="End date is required"),s.startDate&&s.endDate&&new Date(s.startDate)>=new Date(s.endDate)&&(m.endDate="End date must be after start date"),c(m),Object.keys(m).length===0},h=async m=>{if(m.preventDefault(),!!f())try{const p={name:s.name.trim(),description:s.description.trim(),code:s.code.trim(),maxNumTrainee:parseInt(s.maxTrainees),venue:s.venue.trim(),note:s.note.trim(),passScore:parseInt(s.passScore),startDate:new Date(s.startDate).toISOString(),endDate:new Date(s.endDate).toISOString(),level:s.level},v=await Ie.put(`/courses/${n.id}`,p);ye.success("Course updated successfully!"),r&&await r(v.data||p),d()}catch(p){const v=p.response?.data?.message||p.message||"Failed to update course";ye.error(`Error: ${v}`)}};return i.jsxs(de,{show:e,onHide:d,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(ya,{className:"me-2",size:20}),"Edit Course"]}),i.jsx(le,{variant:"link",onClick:d,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(Y,{onSubmit:h,children:[i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Course Name *"}),i.jsx(Y.Control,{type:"text",name:"name",value:s.name,onChange:u,isInvalid:!!l.name,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.name})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Course Code *"}),i.jsx(Y.Control,{type:"text",name:"code",value:s.code,onChange:u,isInvalid:!!l.code,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.code})]})})]}),i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Max Trainees *"}),i.jsx(Y.Control,{type:"number",name:"maxTrainees",value:s.maxTrainees,onChange:u,isInvalid:!!l.maxTrainees,disabled:a,min:"1"}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.maxTrainees})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Pass Score (%) *"}),i.jsx(Y.Control,{type:"number",name:"passScore",value:s.passScore,onChange:u,isInvalid:!!l.passScore,disabled:a,min:"0",max:"100"}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Level"}),i.jsxs(Y.Select,{name:"level",value:s.level,onChange:u,disabled:a,children:[i.jsx("option",{value:"BEGINNER",children:"Beginner"}),i.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),i.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),i.jsxs(Ee,{className:"mb-3",children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Start Date *"}),i.jsx(Y.Control,{type:"date",name:"startDate",value:s.startDate,onChange:u,isInvalid:!!l.startDate,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.startDate})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"End Date *"}),i.jsx(Y.Control,{type:"date",name:"endDate",value:s.endDate,onChange:u,isInvalid:!!l.endDate,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Venue *"}),i.jsx(Y.Control,{type:"text",name:"venue",value:s.venue,onChange:u,isInvalid:!!l.venue,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.venue})]})})}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Description *"}),i.jsx(Y.Control,{as:"textarea",rows:3,name:"description",value:s.description,onChange:u,isInvalid:!!l.description,disabled:a}),i.jsx(Y.Control.Feedback,{type:"invalid",children:l.description})]})})}),i.jsx(Ee,{className:"mb-3",children:i.jsx(oe,{children:i.jsxs(Y.Group,{children:[i.jsx(Y.Label,{children:"Note"}),i.jsx(Y.Control,{as:"textarea",rows:2,name:"note",value:s.note,onChange:u,disabled:a})]})})})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:d,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary",type:"submit",disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},Nue=({course:e,department:t})=>{const r=Et(),{courseId:n}=Fn();console.log(" InPageCourseDetail - courseId from URL params:",n),console.log(" InPageCourseDetail - course prop:",e),console.log(" InPageCourseDetail - department prop:",t);const[a,s]=_.useState(!1),[o,l]=_.useState(!1),[c,d]=_.useState(!1),[u,f]=_.useState(!1),[h,m]=_.useState(null),[p,v]=_.useState(!1),[g,x]=_.useState(null),[b,y]=_.useState([]),[w,j]=_.useState(!0),[N,E]=_.useState("course-info"),S=_.useCallback(async()=>{console.log(" Loading subjects...");try{const B=await Pr.getSubjects();console.log(" API Response:",B),B&&B.subjects?(console.log(" Found subjects:",B.subjects.length,"subjects"),y(B.subjects)):(console.log(" No subjects found in response"),y([]))}catch(B){console.error(" Error loading subjects:",B),console.error(" Error details:",B.response?.data),console.error(" Error status:",B.response?.status)}},[]),O=_.useCallback(async()=>{},[]);_.useEffect(()=>{O()},[n,O]),_.useEffect(()=>{(async()=>{if(n){j(!0);try{const W=await pn.getCourseById(n),z={name:W.name,code:W.code,description:W.description,maxTrainees:W.maxNumTrainee,venue:W.venue,note:W.note,passScore:W.passScore,startDate:W.startDate?new Date(W.startDate).toISOString().split("T")[0]:"N/A",endDate:W.endDate?new Date(W.endDate).toISOString().split("T")[0]:"N/A",level:W.level,status:W.status,department:W.department,subjectCount:W.subjectCount||0,traineeCount:W.traineeCount||0,trainerCount:W.trainerCount||0,subjects:W.subjects||[]};x(z),j(!1)}catch{j(!1);const W={name:e?.name||"Course Name",code:e?.code||"COURSE001",description:"Comprehensive safety procedures training covering emergency protocols, evacuation procedures, and safety equipment usage. This course ensures all personnel are equipped with essential safety knowledge and skills required for aviation operations.",maxTrainees:50,venue:"Training Center A - Room 101",note:"",passScore:80,startDate:"2024-01-15",endDate:"2024-01-29",level:"Intermediate",status:"ACTIVE"};x(W)}}})(),S()},[n,e,S]);const k=()=>{t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(w)return i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!g)return i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h5",{className:"text-muted",children:"Course not found"}),i.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),i.jsxs(le,{variant:"primary",onClick:k,children:[i.jsx(dr,{className:"me-2"}),"Back to Department"]})]})});const T=B=>{r(`/academic/course/${n}/subject/${B}`)},A=()=>{},P=B=>{const W=b.find(z=>z.id===B);W&&(m(W),f(!0))},C=async()=>{if(h){v(!0);try{await Pr.deleteSubject(h.id),await S(),f(!1),m(null)}catch(B){console.error("Error disabling subject:",B)}finally{v(!1)}}},F=()=>{r(`/academic/course/${e.id}/enroll-trainees`)},M=async B=>{try{await Pr.createSubject({...B,courseId:n}),await S(),s(!1)}catch(W){console.error("Error adding subject:",W)}},H=async B=>{try{await Pr.bulkImportSubjects(B),await S(),l(!1)}catch(W){console.error("Error bulk importing subjects:",W)}},V=async B=>{try{await pn.updateCourse(n,B);const W=await pn.getCourseById(n),z={name:W.name,code:W.code,description:W.description,maxTrainees:W.maxNumTrainee,venue:W.venue,note:W.note,passScore:W.passScore,startDate:W.startDate?new Date(W.startDate).toISOString().split("T")[0]:"N/A",endDate:W.endDate?new Date(W.endDate).toISOString().split("T")[0]:"N/A",level:W.level,status:W.status,department:W.department,subjectCount:W.subjectCount||0,traineeCount:W.traineeCount||0,trainerCount:W.trainerCount||0,subjects:W.subjects||[]};x(z),d(!1)}catch(W){console.error("Error updating course:",W)}};return i.jsxs(He,{fluid:!0,className:"py-2 course-detail",children:[i.jsxs("div",{className:"d-flex align-items-center mb-2",children:[i.jsxs(le,{variant:"outline-secondary",size:"sm",onClick:k,className:"me-3",children:[i.jsx(dr,{size:16,className:"me-1"}),"Back"]}),i.jsxs("div",{children:[i.jsxs("h4",{className:"mb-0 text-primary",children:[i.jsx("strong",{children:e.name}),"  ",e.code]}),i.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("div",{className:"d-flex",children:i.jsxs(le,{size:"sm",variant:"primary",onClick:F,children:[i.jsx(Pn,{size:14,className:"me-1"})," Enroll Trainees"]})}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsxs(le,{size:"sm",variant:"outline-secondary",onClick:()=>d(!0),children:[i.jsx(ya,{size:14,className:"me-1"})," Edit Course"]}),i.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),i.jsxs(le,{size:"sm",variant:"primary",onClick:()=>s(!0),children:[i.jsx(gn,{size:14,className:"me-1"})," Add Subject"]}),i.jsxs(le,{size:"sm",variant:"outline-primary",onClick:()=>l(!0),children:[i.jsx(Dn,{size:14,className:"me-1"})," Import Bulk Subjects"]})]})]}),i.jsx(ce,{className:"border-0 shadow-sm mb-2",children:i.jsxs(dn.Container,{activeKey:N,onSelect:E,children:[i.jsx(ce.Header,{className:"border-bottom py-2",children:i.jsxs(zr,{variant:"tabs",className:"border-0",children:[i.jsx(zr.Item,{children:i.jsxs(zr.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",color:N==="course-info"?"#0d6efd":"#6c757d",fontWeight:N==="course-info"?"600":"400"},children:[i.jsx(gr,{className:"me-2",size:16}),"Course Information"]})}),i.jsx(zr.Item,{children:i.jsxs(zr.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",color:N==="subjects"?"#0d6efd":"#6c757d",fontWeight:N==="subjects"?"600":"400"},children:[i.jsx(xa,{className:"me-2",size:16}),"Subjects"]})}),i.jsx(zr.Item,{children:i.jsxs(zr.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",color:N==="trainees"?"#0d6efd":"#6c757d",fontWeight:N==="trainees"?"600":"400"},children:[i.jsx(Pn,{className:"me-2",size:16}),"Trainees Roster"]})})]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsxs(dn.Content,{children:[i.jsx(dn.Pane,{eventKey:"course-info",children:i.jsx("div",{className:"p-4",children:i.jsxs(Ee,{className:"g-4",children:[i.jsxs(oe,{md:6,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Course Name"}),i.jsx("p",{className:"mb-0 fw-semibold",children:g.name})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Course Code"}),i.jsx($e,{bg:"secondary",className:"px-2 py-1",children:g.code})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Description"}),i.jsx("p",{className:"mb-0 text-muted small",children:g.description})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Level"}),i.jsx($e,{bg:"info",className:"px-2 py-1",children:g.level})]})]}),i.jsxs(oe,{md:6,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Max Number of Trainees"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(ha,{size:16,className:"me-2 text-primary"}),i.jsx("span",{className:"fw-semibold",children:g.maxTrainees})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Venue"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(yo,{size:16,className:"me-2 text-primary"}),i.jsx("span",{className:"fw-semibold",children:g.venue})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Pass Score"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(gl,{size:16,className:"me-2 text-primary"}),i.jsxs("span",{className:"fw-semibold",children:[g.passScore,"%"]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Status"}),i.jsx($e,{bg:g.status==="ACTIVE"?"success":g.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:g.status})]})]}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"Start Date"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:16,className:"me-2 text-primary"}),i.jsx("span",{className:"fw-semibold",children:g.startDate})]})]})}),i.jsx(oe,{md:6,children:i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-muted mb-2",children:"End Date"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{size:16,className:"me-2 text-primary"}),i.jsx("span",{className:"fw-semibold",children:g.endDate})]})]})})]})})}),i.jsx(dn.Pane,{eventKey:"subjects",children:i.jsx(pue,{subjects:b,loading:!1,onView:T,onEdit:A,onDelete:P})}),i.jsx(dn.Pane,{eventKey:"trainees",style:{height:"100%"},children:i.jsx(yue,{course:e,loading:!1,onView:B=>{console.log("View trainee:",B)},onRemove:B=>{console.log("Remove trainee:",B)}})})]})})]})}),i.jsx(bue,{show:a,onClose:()=>s(!1),onSave:M,courseId:n}),i.jsx(wue,{show:o,onClose:()=>l(!1),onImport:H,courseId:n}),i.jsx(jue,{show:c,onClose:()=>d(!1),onSave:V,course:e}),i.jsx(Q5,{show:u,onClose:()=>{f(!1),m(null)},onDisable:C,subject:h,loading:p})]})},Eue=()=>{const{courseId:e}=Fn(),t=ki(),[r,n]=_.useState(null),[a,s]=_.useState(null),[o,l]=_.useState(!0);return _.useEffect(()=>{e&&(async()=>{try{l(!0);try{const d=await pn.getCourseById(e);n(d),d.department&&s(d.department)}catch{const u={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},f={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};n(u),s(f)}l(!1)}catch{l(!1)}})()},[e]),o?i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?i.jsx(He,{className:"py-3",children:i.jsx(Nue,{course:r,department:a})}):i.jsx(He,{className:"py-4",children:i.jsxs("div",{className:"text-center text-muted",children:[i.jsx("h4",{children:"Course not found"}),i.jsx("p",{children:"The requested course could not be found."})]})})},_ue=({selectedSubjects:e,onSelectionChange:t})=>{const[r,n]=_.useState(""),[a,s]=_.useState([]),[o,l]=_.useState(!0),[c,d]=_.useState(null);_.useEffect(()=>{(async()=>{try{l(!0),d(null);const v=await Pr.getSubjects();if(v&&v.subjects){const g=v.subjects.map(x=>({id:x.id,name:x.name,code:x.code}));s(g)}else s([])}catch{d("Failed to load subjects"),s([])}finally{l(!1)}})()},[]);const u=a.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())||p.code.toLowerCase().includes(r.toLowerCase())),f=()=>{e.length===u.length?t([]):t(u.map(p=>p.id))},h=p=>{e.includes(p)?t(e.filter(v=>v!==p)):t([...e,p])},m=u.length>0&&e.length===u.length;return i.jsxs(ce,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[i.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),i.jsx(le,{variant:"outline-light",size:"sm",onClick:f,children:m?"Deselect All":"Select All"})]})}),i.jsxs(ce.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[i.jsx("div",{className:"p-2 border-bottom",children:i.jsx(Y.Control,{type:"text",placeholder:"Search subjects...",value:r,onChange:p=>n(p.target.value),size:"sm"})}),i.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0},children:o?i.jsxs("div",{className:"p-3 text-center",children:[i.jsx(ur,{animation:"border",size:"sm",className:"me-2"}),i.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?i.jsx("div",{className:"p-3 text-center text-danger",children:i.jsx("p",{className:"mb-0",children:c})}):u.length===0?i.jsx("div",{className:"p-3 text-center text-muted",children:i.jsx("p",{className:"mb-0",children:"No subjects found"})}):u.map(p=>i.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>h(p.id),children:[i.jsx("div",{className:"me-3",children:e.includes(p.id)?i.jsx(fS,{size:20,className:"text-primary"}):i.jsx(SS,{size:20,className:"text-muted"})}),i.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[i.jsx("div",{className:"fw-semibold text-truncate",title:p.name,children:p.name}),i.jsx("small",{className:"text-muted text-truncate d-block",title:p.code,children:p.code})]})]},p.id))}),i.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:i.jsxs("small",{className:"text-muted",children:[e.length," of ",u.length," subjects selected"]})})]})]})},Sue=({selectedTrainees:e,onSelectionChange:t})=>{const[r,n]=_.useState(""),[a,s]=_.useState(!1),[o,l]=_.useState([]),[c,d]=_.useState(!1),[u,f]=_.useState(null),h=_.useRef(null);_.useEffect(()=>{m()},[]),_.useEffect(()=>{const x=b=>{h.current&&!h.current.contains(b.target)&&s(!1)};return a&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[a]);const m=async()=>{d(!0),f(null);try{const x=await no.getTraineesForEnrollment();if(x&&x.data){const b=x.data.map(y=>({id:y.id,eid:y.eid,name:`${y.firstName} ${y.lastName}`.trim(),firstName:y.firstName,lastName:y.lastName,email:y.email,status:y.status}));l(b)}else l([])}catch{f("Failed to load trainees"),l([])}finally{d(!1)}},p=o.filter(x=>x.name.toLowerCase().includes(r.toLowerCase())||x.eid.toLowerCase().includes(r.toLowerCase())),v=x=>{e.find(b=>b.id===x.id)||t([...e,x])},g=x=>{t(e.filter(b=>b.id!==x))};return i.jsxs(ce,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[i.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",children:i.jsx("div",{className:"d-flex justify-content-between align-items-center",children:i.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),i.jsxs(ce.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[i.jsxs("div",{className:"flex-shrink-0",style:{position:"relative"},ref:h,children:[i.jsx("div",{className:"p-2 border-bottom",children:i.jsx(Y.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:x=>n(x.target.value),size:"sm"})}),i.jsx("div",{className:"p-2",children:i.jsxs(le,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>s(!a),disabled:c,children:[i.jsxs("span",{children:[i.jsx(Pn,{className:"me-2",size:16}),c?"Loading...":`Show All Available Trainees (${o.length})`]}),i.jsx(hi,{size:16})]})}),a&&i.jsx("div",{className:"border bg-white shadow-sm",style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1050,maxHeight:"200px",overflowY:"auto",borderRadius:"0 0 8px 8px"},children:c?i.jsxs("div",{className:"p-3 text-center",children:[i.jsx(ur,{animation:"border",size:"sm",className:"me-2"}),i.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):u?i.jsxs("div",{className:"p-3 text-center text-danger",children:[i.jsx("p",{className:"mb-0",children:u}),i.jsx(le,{size:"sm",variant:"outline-danger",onClick:m,className:"mt-2",children:"Retry"})]}):p.length===0?i.jsx("div",{className:"p-3 text-center text-muted",children:i.jsx("p",{className:"mb-0",children:"No trainees found"})}):p.map(x=>i.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>v(x),children:[i.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[i.jsx("div",{className:"fw-semibold text-truncate",title:x.name,children:x.name}),i.jsx("small",{className:"text-muted text-truncate d-block",title:x.eid,children:x.eid})]}),i.jsx(gn,{size:14,className:"text-primary flex-shrink-0"})]},x.id))})]}),i.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0},children:[i.jsx("div",{className:"p-2 bg-light border-bottom",children:i.jsxs("small",{className:"text-muted fw-semibold",children:["Selected Trainees (",e.length,")"]})}),i.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?i.jsx("div",{className:"p-3 text-center text-muted",children:i.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(x=>i.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0},children:[i.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[i.jsx("div",{className:"fw-semibold text-truncate",title:x.name,children:x.name}),i.jsx("small",{className:"text-muted text-truncate d-block",title:x.eid,children:x.eid})]}),i.jsx(le,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>g(x.id),children:i.jsx(Ye,{size:14})})]},x.id))})]})]})]})},Tue=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:i.jsx(ln,{size:16})},items:[{label:"View Subject List",icon:i.jsx(Xt,{}),onClick:()=>t(e),permission:Me.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:i.jsx(Oi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Me.SUBJECTS.DELETE}]}),Aue=({show:e,onClose:t,onConfirm:r,trainee:n,subjectName:a=null,loading:s=!1})=>{const o=!a,l=o?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=o?"Remove from All Subjects":"Remove from Subject",d=()=>{r(),t()};return i.jsxs(de,{show:e,onHide:t,centered:!0,children:[i.jsx(de.Header,{className:"bg-danger text-white border-0",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2",size:20}),l]})}),i.jsxs(de.Body,{className:"p-4",children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",i.jsxs("strong",{children:['"',n?.name,'"']}),o?" from ALL subjects":` from "${a}"`,"?"]}),i.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[i.jsx("strong",{children:"Trainee:"})," ",n?.name,i.jsx("br",{}),i.jsx("strong",{children:"EID:"})," ",n?.eid,!o&&i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsx("strong",{children:"Subject:"})," ",a]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("p",{className:"text-danger mb-2",children:[i.jsx("strong",{children:"Warning:"})," This action will:"]}),i.jsxs("ul",{className:"text-danger mb-3",children:[o?i.jsxs(i.Fragment,{children:[i.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),i.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),i.jsx("li",{children:"Remove the trainee from the course completely"})]}):i.jsxs(i.Fragment,{children:[i.jsx("li",{children:"Remove the trainee from this specific subject only"}),i.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),i.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),i.jsx("li",{children:i.jsx("strong",{children:"Cannot be undone"})})]})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsx(le,{variant:"outline-secondary",onClick:t,disabled:s,children:"Cancel"}),i.jsx(le,{variant:"danger",onClick:d,disabled:s,children:s?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Oi,{className:"me-2",size:16}),c]})})]})]})},kue=({courseId:e,loading:t=!1})=>{const[r,n]=_.useState([]),[a,s]=_.useState(!0),[o,l]=_.useState(!1),[c,d]=_.useState(null),[u,f]=_.useState(!1),[h,m]=_.useState(null),[p,v]=_.useState(null),[g,x]=_.useState(!1),{sortedData:b,sortConfig:y,handleSort:w}=Bn(r),j=_.useCallback(async()=>{s(!0);try{const A=await no.getTraineesForEnrollment();if(!A||!A.data){n([]);return}const P=[];for(const C of A.data)try{const F=await pn.getTraineeEnrollments(C.id);if(F&&F.enrollments&&F.enrollments.length>0){const M=F.enrollments.filter(H=>H.enrollment?.status==="ENROLLED");if(M.length>0){const H=M.map(B=>B.subject.id),V={id:C.id,eid:C.eid,name:`${C.firstName} ${C.lastName}`.trim(),subjects:H,userId:C.id,email:C.email,department:C.department};P.push(V)}}}catch{}n(P)}catch{n([])}finally{s(!1)}},[]);_.useEffect(()=>{e&&j()},[e,j]);const N=async A=>{try{const P=await pn.getTraineeEnrollments(A.userId),C=P.enrollments?.filter(M=>M.enrollment?.status==="ENROLLED")||[],F={...A,enrollmentDetails:P,subjects:C.map(M=>({id:M.subject.id,name:M.subject.name,code:M.subject.code,status:M.subject.status,type:M.subject.type,method:M.subject.method,startDate:M.subject.startDate,endDate:M.subject.endDate,course:M.subject.course,enrollment:M.enrollment}))};d(F),l(!0)}catch{d(A),l(!0)}},E=A=>{const P=r.find(C=>C.id===A);P&&(m(P),v(null),f(!0))},S=async()=>{if(h){x(!0);try{const A=await pn.getTraineeEnrollments(h.userId);if(A&&A.enrollments&&A.enrollments.length>0){const C=A.enrollments.map(async F=>{const M=F.subject.id,H=F.enrollment?.batchCode||"TEST0012025";return F.enrollment?.status!=="ENROLLED"?null:Pr.removeTraineeFromSubject(M,h.userId,H)}).filter(F=>F!==null);C.length>0&&await Promise.all(C),await j(),f(!1)}else f(!1)}catch{}finally{x(!1)}}},O=(A,P)=>{const C=r.find(H=>H.id===A);if(!C)return;const F=c?.subjects?.find(H=>H.id===P),M=F?F.name:"Unknown Subject";m(C),v(M),f(!0)},k=async()=>{if(!h||!p)return;const A=c?.subjects?.find(P=>P.name===p);if(A){x(!0);try{const P=A.enrollment?.batchCode||"TEST0012025";if(A.enrollment?.status!=="ENROLLED")return;await Pr.removeTraineeFromSubject(A.id,h.userId,P),await j(),f(!1),l(!1)}catch{}finally{x(!1)}}};if(t||a)return i.jsxs(ce,{className:"h-100",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsx("h6",{className:"mb-0",children:"Enrolled Trainees"})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(Ln,{rows:4,columns:4})})]});if(r.length===0)return i.jsxs(ce,{className:"h-100",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsx("h6",{className:"mb-0",children:"Enrolled Trainees (0)"})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No enrolled trainees"}),i.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})})})]});const T=({columnKey:A,children:P,className:C=""})=>{const F=y.key===A,M=F?y.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${C} ${F?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>w(A),onMouseEnter:H=>{H.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",H.target.style.transform="translateY(-1px)",H.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:H=>{H.target.style.backgroundColor="transparent",H.target.style.transform="translateY(0)",H.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:F?"700":"600"},children:P}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:M,size:14})})]}),F&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return i.jsxs(i.Fragment,{children:[i.jsxs(ce,{className:"d-flex flex-column mb-5",style:{height:"400px",marginBottom:"2rem",marginTop:"12rem"},children:[i.jsx(ce.Header,{className:"bg-white border-bottom",style:{flexShrink:0},children:i.jsxs("h6",{className:"mb-0",children:["Enrolled Trainees (",r.length,")"]})}),i.jsx(ce.Body,{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:i.jsx("div",{style:{height:"100%",overflowY:"auto"},children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[i.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:i.jsxs("tr",{children:[i.jsx(T,{columnKey:"name",className:"show-mobile",children:"Trainee"}),i.jsx(T,{columnKey:"eid",className:"show-mobile",children:"EID"}),i.jsx(T,{columnKey:"subjects",className:"show-mobile",children:"Subjects"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:b.map(A=>i.jsxs("tr",{children:[i.jsx("td",{className:"show-mobile",children:i.jsx("div",{className:"fw-semibold text-primary-custom",children:A.name})}),i.jsx("td",{className:"show-mobile",children:i.jsx($e,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:A.eid})}),i.jsx("td",{className:"show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Pn,{size:14,className:"me-1 text-muted"}),i.jsxs($e,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[A.subjects.length," subjects"]})]})}),i.jsx("td",{className:"text-center show-mobile",children:i.jsx(Tue,{trainee:A,onViewSubjects:N,onRemoveTrainee:E})})]},A.id))})]})})})]}),i.jsxs(de,{show:o,onHide:()=>l(!1),size:"lg",children:[i.jsx(de.Header,{closeButton:!0,className:"border-bottom",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Pn,{className:"me-2",size:20}),c?.name," - Enrolled Subjects"]})}),i.jsx(de.Body,{className:"p-4",children:c&&i.jsxs("div",{children:[i.jsx("div",{className:"mb-4 p-3 bg-light rounded",children:i.jsxs("div",{className:"row align-items-center",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx("h6",{className:"mb-1 text-primary",children:"Trainee Information"}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx($e,{bg:"secondary",className:"me-2",children:"EID"}),i.jsx("span",{className:"fw-semibold",children:c.eid})]})]}),i.jsx("div",{className:"col-md-6 text-md-end",children:i.jsx("div",{className:"text-muted small",children:i.jsxs("div",{children:["Total Subjects: ",i.jsx($e,{bg:"info",children:c.subjects.length})]})})})]})}),i.jsx("div",{className:"row g-3",children:c.subjects.map(A=>i.jsx("div",{className:"col-12",children:i.jsx(ce,{className:"border-0 shadow-sm",children:i.jsx(ce.Body,{className:"p-3",children:i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-8",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h6",{className:"mb-1 text-dark",children:A.name}),i.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[i.jsx($e,{bg:"outline-secondary",className:"text-dark border",children:A.code}),i.jsx($e,{bg:A.status==="ACTIVE"?"success":"secondary",children:A.status})]})]}),i.jsx(le,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{O(c.id,A.id)},children:i.jsx(Ye,{size:14})})]}),i.jsxs("div",{className:"row g-2 mb-3",children:[i.jsx("div",{className:"col-sm-6",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("span",{className:"text-muted small me-2",children:"Type:"}),i.jsx($e,{bg:"outline-primary",className:"text-primary border",children:A.type})]})}),i.jsx("div",{className:"col-sm-6",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("span",{className:"text-muted small me-2",children:"Method:"}),i.jsx($e,{bg:"outline-info",className:"text-info border",children:A.method})]})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("span",{className:"text-muted small me-2",children:"Course:"}),i.jsx("span",{className:"fw-medium",children:A.course?.name})]})]}),A.enrollment&&i.jsx("div",{className:"col-md-4",children:i.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[i.jsx("h6",{className:"text-primary mb-2",children:"Enrollment Details"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsx("span",{className:"text-muted small",children:"Status:"}),i.jsx($e,{bg:"info",children:A.enrollment.status})]}),i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsx("span",{className:"text-muted small",children:"Batch:"}),i.jsx("span",{className:"fw-medium small",children:A.enrollment.batchCode})]}),i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsx("span",{className:"text-muted small",children:"Enrolled:"}),i.jsx("span",{className:"fw-medium small",children:new Date(A.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},A.id))})]})}),i.jsx(de.Footer,{className:"border-top",children:i.jsx(le,{variant:"secondary",onClick:()=>l(!1),children:"Close"})})]}),i.jsx(Aue,{show:u,onClose:()=>{f(!1),m(null),v(null),x(!1)},onConfirm:p?k:S,trainee:h,subjectName:p,loading:g})]})},Oue=({show:e,onClose:t,onImport:r,loading:n=!1})=>{const[a,s]=_.useState(!1),[o,l]=_.useState(null),[c,d]=_.useState([]),[u,f]=_.useState(null),[h,m]=_.useState([]),[p,v]=_.useState([]),[g,x]=_.useState([]),[b,y]=_.useState(!1),w=_.useRef(null),j=["eid","email"],N=V=>{V.preventDefault(),V.stopPropagation(),V.type==="dragenter"||V.type==="dragover"?s(!0):V.type==="dragleave"&&s(!1)},E=V=>{V.preventDefault(),V.stopPropagation(),s(!1),V.dataTransfer.files&&V.dataTransfer.files[0]&&O(V.dataTransfer.files[0])},S=V=>{V.target.files&&V.target.files[0]&&O(V.target.files[0])},O=V=>{if(!V.name.match(/\.(xlsx|xls)$/)){v(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(V.size>100*1024*1024){v(["File size must be less than 100MB"]);return}l(V),v([]),k(V)},k=V=>{const B=new FileReader;B.onload=W=>{try{const z=new Uint8Array(W.target.result),D=Vl(z,{type:"array"}),L=D.SheetNames[0],q=D.Sheets[L],I=ea.sheet_to_json(q,{header:1});if(I.length<2){v(["Excel file must contain at least a header row and one data row"]);return}const R=I[0].map(ie=>ie?.toString().toLowerCase().trim()),X=I.slice(1),ae=j.filter(ie=>!R.includes(ie));if(ae.length>0){v([`Missing required columns: ${ae.join(", ")}`]);return}const ee=X.map((ie,U)=>{const be=ie[R.indexOf("eid")]?.toString().trim()||"",Se=ie[R.indexOf("email")]?.toString().trim()||"";return{id:`temp_${U}`,rowNumber:U+2,eid:be,email:Se,hasError:!1,errors:[]}}).filter(ie=>ie.eid||ie.email).map(ie=>(ie.eid||(ie.hasError=!0,ie.errors.push("EID is required")),ie.email?/\S+@\S+\.\S+/.test(ie.email)||(ie.hasError=!0,ie.errors.push("Email format is invalid")):(ie.hasError=!0,ie.errors.push("Email is required")),ie));d(ee),x([])}catch{v(["Failed to parse Excel file. Please check the file format."])}},B.readAsArrayBuffer(V)},T=async()=>{const V=c.filter(B=>!B.hasError);if(V.length===0){v(["No valid identifiers to lookup"]);return}y(!0),v([]);try{const B=V.map(I=>({eid:I.eid,email:I.email}));console.log("Sending lookup request with identifiers:",B);const W=await no.lookupTrainees(B);console.log("Lookup response:",W),console.log("Found users:",W.foundUsers),console.log("Not found:",W.notFoundIdentifiers),W.foundUsers&&W.foundUsers.length>0&&(console.log(" First found user structure:",W.foundUsers[0]),console.log(" All found user IDs:",W.foundUsers.map(I=>({id:I.id,eid:I.eid,email:I.email}))));const z=(W.foundUsers||[]).filter(I=>B.some(R=>R.eid===I.eid&&R.email===I.email)),D=B.filter(I=>!z.some(R=>R.eid===I.eid&&R.email===I.email)),L=z.map(I=>{if(console.log(" Validating trainee:",{id:I.id,eid:I.eid,email:I.email,firstName:I.firstName,lastName:I.lastName}),!I.id||typeof I.id!="string"||I.id.length<10)throw new Error(`Trainee ${I.eid} has invalid UUID: ${I.id}`);if(!I.firstName||!I.lastName)throw new Error(`Trainee ${I.eid} has missing name fields`);return I}),q={foundUsers:L,notFoundIdentifiers:D,uploadedIdentifiers:B};console.log("Exact matches found:",L),console.log("Not found identifiers:",D),f(q),m(L),console.log("Set selected trainees (exact matches only):",L)}catch(B){console.error("Lookup error:",B),console.error("Error response:",B.response?.data),v([B.response?.data?.message||B.message||"Failed to lookup trainees. Please try again."])}finally{y(!1)}},A=(V,B)=>{m(B?W=>[...W,V]:W=>W.filter(z=>z.id!==V.id))},P=V=>{m(V?u?.foundUsers||[]:[])},C=async()=>{if(h.length===0){v(["Please select at least one trainee to import"]);return}try{r&&await r(h),F()}catch(V){v([V.message||"Failed to import selected trainees. Please try again."])}},F=()=>{l(null),d([]),f(null),m([]),v([]),x([]),s(!1),y(!1),t()},M=V=>V==="valid"?i.jsx(It,{className:"text-success",size:16}):i.jsx(za,{className:"text-danger",size:16}),H=()=>{const V=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","jane.smith@example.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],B=ea.book_new(),W=ea.aoa_to_sheet(V);W["!cols"]=[{wch:15},{wch:30}],ea.book_append_sheet(B,W,"Trainees Lookup Template"),Ny(B,"Trainees_Lookup_Template.xlsx")};return i.jsxs(de,{show:e,onHide:F,size:"xl",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-2",size:20}),"Bulk Import Trainees"]}),i.jsx(le,{variant:"link",onClick:F,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[p.length>0&&i.jsx(tt,{variant:"danger",className:"mb-3",children:i.jsx("ul",{className:"mb-0",children:p.map((V,B)=>i.jsx("li",{children:V},B))})}),i.jsx(ce,{className:"mb-4",children:i.jsxs(ce.Body,{children:[i.jsxs("div",{className:`upload-area ${a?"drag-active":""}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:E,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:a?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[i.jsx(to,{size:48,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),i.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),i.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:S,style:{display:"none"}})]}),i.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[i.jsxs("div",{children:[i.jsxs("small",{className:"text-muted",children:[i.jsx("strong",{children:"Required columns:"})," eid, email"]}),i.jsx("div",{className:"mt-1",children:i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:H,className:"d-flex align-items-center",children:[i.jsx(Ja,{className:"me-1",size:14}),"Download Template"]})})]}),o&&i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(to,{className:"text-success me-2",size:16}),i.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})}),c.length>0&&i.jsxs(ce,{className:"mb-4",children:[i.jsx(ce.Header,{className:"bg-light",children:i.jsxs("h6",{className:"mb-0",children:["Uploaded Identifiers (",c.length," entries)",i.jsxs("span",{className:"ms-2",children:[i.jsx(It,{className:"text-success me-1",size:16}),c.filter(V=>!V.hasError).length," valid",i.jsx(za,{className:"text-danger ms-2 me-1",size:16}),c.filter(V=>V.hasError).length," invalid"]})]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:i.jsxs(Yt,{hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"bg-light sticky-top",children:i.jsxs("tr",{children:[i.jsx("th",{children:"Status"}),i.jsx("th",{children:"EID"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Errors"})]})}),i.jsx("tbody",{children:c.map((V,B)=>i.jsxs("tr",{className:V.hasError?"table-danger":"table-success",children:[i.jsx("td",{children:M(V.hasError?"invalid":"valid")}),i.jsx("td",{children:V.eid}),i.jsx("td",{children:V.email}),i.jsx("td",{children:V.errors.length>0&&i.jsx("small",{className:"text-danger",children:V.errors.join(", ")})})]},V.id))})]})})}),i.jsx(ce.Footer,{className:"bg-light",children:i.jsx(le,{variant:"primary",onClick:T,disabled:b||c.filter(V=>!V.hasError).length===0,className:"d-flex align-items-center",children:b?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Looking up..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Dg,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(V=>!V.hasError).length," valid)"]})})})]}),u&&i.jsxs(ce,{children:[i.jsx(ce.Header,{className:"bg-light",children:i.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",i.jsxs("span",{className:"ms-2",children:[i.jsx(It,{className:"text-success me-1",size:16}),u.foundUsers?.length||0," matched",i.jsx(za,{className:"text-danger ms-2 me-1",size:16}),u.notFoundIdentifiers?.length||0," not found"]})]})}),i.jsx(ce.Body,{className:"p-0",children:u.foundUsers?.length>0?i.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:i.jsxs(Yt,{hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"bg-light sticky-top",children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsx(Y.Check,{type:"checkbox",checked:h.length===(u.foundUsers?.length||0)&&(u.foundUsers?.length||0)>0,onChange:V=>P(V.target.checked)})}),i.jsx("th",{children:"EID"}),i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Matched From Excel"})]})}),i.jsx("tbody",{children:u.foundUsers?.map(V=>u.uploadedIdentifiers?.find(W=>W.eid===V.eid&&W.email===V.email)?i.jsxs("tr",{className:h.some(W=>W.id===V.id)?"table-success":"",children:[i.jsx("td",{children:i.jsx(Y.Check,{type:"checkbox",checked:h.some(W=>W.id===V.id),onChange:W=>A(V,W.target.checked)})}),i.jsx("td",{children:V.eid}),i.jsxs("td",{children:[V.firstName," ",V.lastName]}),i.jsx("td",{children:V.email}),i.jsx("td",{children:V.phoneNumber}),i.jsx("td",{children:i.jsx($e,{bg:V.status==="ACTIVE"?"success":"secondary",children:V.status})}),i.jsx("td",{children:i.jsx($e,{bg:"success",children:" Exact Match"})})]},V.id):null).filter(Boolean)})]})}):i.jsxs("div",{className:"p-4 text-center",children:[i.jsx(za,{size:48,className:"text-muted mb-3"}),i.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),i.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),u.notFoundIdentifiers?.length>0&&i.jsx(ce.Footer,{className:"bg-warning bg-opacity-10",children:i.jsxs(tt,{variant:"warning",className:"mb-0",children:[i.jsxs("strong",{children:["Identifiers Not Found in System (",u.notFoundIdentifiers.length,"):"]}),i.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),i.jsx("ul",{className:"mb-0",children:u.notFoundIdentifiers.map((V,B)=>i.jsxs("li",{children:[i.jsx("strong",{children:V.eid})," - ",V.email]},B))})]})})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:F,disabled:n,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),u&&u.foundUsers?.length>0&&h.length>0&&i.jsx(le,{variant:"primary",onClick:C,disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Dn,{className:"me-2",size:16}),"Import Selected (",h.length," matched trainees)"]})})]})]})},Cue=({show:e,onClose:t,onConfirm:r,loading:n=!1})=>{const[a,s]=_.useState(""),[o,l]=_.useState("");_.useEffect(()=>{e&&(s(""),l(""))},[e]);const c=h=>!h||h.trim()===""?"Batch code is required":h.length<3?"Batch code must be at least 3 characters long":h.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(h)?"Batch code can only contain letters, numbers, and underscores":null,d=h=>{const m=h.target.value;s(m),o&&l("")},u=()=>{const h=c(a);if(h){l(h);return}r(a.trim())},f=h=>{h.key==="Enter"&&(h.preventDefault(),u())};return i.jsxs(de,{show:e,onHide:t,centered:!0,backdrop:"static",children:[i.jsx(de.Header,{closeButton:!0,children:i.jsxs(de.Title,{children:[i.jsx(Gt,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),i.jsxs(de.Body,{children:[i.jsx(Y,{children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsxs(Y.Label,{children:["Batch Code ",i.jsx("span",{className:"text-danger",children:"*"})]}),i.jsx(Y.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:a,onChange:d,onKeyPress:f,isInvalid:!!o,disabled:n,autoFocus:!0}),i.jsx(Y.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),o&&i.jsx(Y.Control.Feedback,{type:"invalid",children:o})]})}),i.jsx(tt,{variant:"info",className:"mb-0",children:i.jsxs("small",{children:[i.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),i.jsxs(de.Footer,{children:[i.jsx(le,{variant:"secondary",onClick:t,disabled:n,children:"Cancel"}),i.jsx(le,{variant:"primary",onClick:u,disabled:n||!a.trim(),children:n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},Pue=()=>{const e=Et(),{courseId:t}=Fn(),r={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[n,a]=_.useState([]),[s,o]=_.useState([]),[l,c]=_.useState(!1),[d,u]=_.useState(!1),[f,h]=_.useState(!1),[m,p]=_.useState(!1),[v,g]=_.useState(0),x=()=>{e(`/academic/course-detail/${t}`)},b=()=>{c(!0)},y=async N=>{if(f){console.log(" Bulk import already in progress, skipping...");return}h(!0);try{console.log(" Bulk import trainees received:",N);const E=N.map(S=>(console.log(" Processing bulk import trainee:",{id:S.id,eid:S.eid,firstName:S.firstName,lastName:S.lastName}),{id:S.id,eid:S.eid,name:`${S.firstName} ${S.lastName}`.trim(),firstName:S.firstName,lastName:S.lastName,email:S.email,phoneNumber:S.phoneNumber,status:S.status,subjects:[]}));console.log(" New trainees to add:",E),o(S=>{const O=new Set(S.map(T=>T.id)),k=E.filter(T=>!O.has(T.id));return console.log(" Existing trainee IDs:",Array.from(O)),console.log(" New unique trainees to add:",k),console.log(" Duplicates filtered out:",E.length-k.length),k.length===0&&E.length>0?setTimeout(()=>{ye.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):k.length<E.length&&k.length>0&&setTimeout(()=>{ye.warning(`Added ${k.length} new trainees. ${E.length-k.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100),[...S,...k]}),await new Promise(S=>setTimeout(S,1e3))}catch(E){throw E}finally{h(!1)}},w=()=>{if(n.length===0||s.length===0){ye.warning("Please select both subjects and trainees to enroll");return}u(!0)},j=async N=>{p(!0),u(!1);try{console.log(" Selected trainees for enrollment:",s),console.log(" Using batch code:",N);const E={batchCode:N,traineeUserIds:s.map(k=>{if(console.log(" Processing trainee:",{id:k.id,eid:k.eid,name:`${k.firstName} ${k.lastName}`}),!k.id)throw new Error(`Trainee ${k.eid} (${k.firstName} ${k.lastName}) is missing UUID`);return k.id})};console.log(" Final trainee data for API:",E),console.log(" Note: Server will validate for duplicate enrollments");const S=n.map(async k=>{if(!k)throw new Error(`Invalid subject ID: ${k}`);const T=await Pr.assignTrainees(k,E);return{subjectId:k,response:T}}),O=await Promise.all(S);console.log(" All enrollments completed successfully:",O),g(k=>k+1),o([]),a([]),ye.success(`Successfully enrolled ${s.length} trainees to ${n.length} subject(s) with batch code: ${N}`)}catch(E){let S="Failed to enroll trainees. Please try again.";E.response?.data?.message?S=E.response.data.message:E.response?.data?.errors?S=`Validation errors: ${JSON.stringify(E.response.data.errors)}`:E.message&&(S=E.message),ye.error(S)}finally{p(!1)}};return i.jsxs(He,{fluid:!0,className:"py-4 px-4 enroll-page",children:[i.jsxs("div",{className:"d-flex flex-column",children:[i.jsxs("div",{className:"flex-shrink-0 mb-3",children:[i.jsxs("div",{className:"d-flex align-items-center mb-2",children:[i.jsxs(le,{variant:"outline-secondary",size:"sm",onClick:x,className:"me-3",children:[i.jsx(dr,{size:16,className:"me-1"}),"Back"]}),i.jsx("div",{children:i.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",i.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),i.jsx(ce,{className:"mb-2",children:i.jsx(ce.Body,{className:"py-2",children:i.jsxs(Ee,{children:[i.jsx(oe,{md:8,children:i.jsx("p",{className:"mb-0 text-muted",children:r.description})}),i.jsxs(oe,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[i.jsx(le,{size:"sm",variant:"primary",onClick:w,disabled:n.length===0||s.length===0||m,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:m?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):i.jsxs(i.Fragment,{children:[i.jsx(gn,{size:12,className:"me-1"})," Enroll"]})}),i.jsxs(le,{size:"sm",variant:"outline-primary",onClick:b,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[i.jsx(Dn,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),i.jsx("div",{className:"mb-4",children:i.jsxs(Ee,{className:"g-3",children:[i.jsx(oe,{lg:6,children:i.jsx("div",{style:{height:"500px"},children:i.jsx(_ue,{selectedSubjects:n,onSelectionChange:a})})}),i.jsx(oe,{lg:6,children:i.jsx("div",{style:{height:"500px"},children:i.jsx(Sue,{selectedTrainees:s,onSelectionChange:o})})})]})}),i.jsx("div",{className:"mt-4",children:i.jsx(kue,{courseId:t,loading:!1},v)})]}),i.jsx(Oue,{show:l,onClose:()=>c(!1),onImport:y,loading:f}),i.jsx(Cue,{show:d,onClose:()=>u(!1),onConfirm:j,loading:m})]})},wE=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:n,onLevelToggle:a,onStatusToggle:s,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return i.jsxs(vr,{className:`filter-panel-dropdown course-filter-dropdown ${l}`,children:[i.jsx(vr.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xo,{size:14,className:"me-2"}),"Filters",c&&i.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]})}),i.jsxs(vr.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[i.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`level-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),i.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),n.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>s("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>i.jsx(Y.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:n.includes(d),onChange:()=>s(d),className:"mb-1"},d))})]}),c&&i.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:i.jsxs(le,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[i.jsx(Ye,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},eP=document.createElement("style");eP.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(eP);const Due=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Due,document.head.appendChild(e)}const tP=({traineeId:e})=>{const t=Et(),[r,n]=_.useState([]),[a,s]=_.useState(!0),[o,l]=_.useState(""),[c,d]=_.useState([]),[u,f]=_.useState([]),h=[...new Set(r.map(T=>T.level).filter(Boolean))],m=[...new Set(r.map(T=>T.status).filter(Boolean))],p=_.useMemo(()=>r.filter(T=>{const A=!o||T.name.toLowerCase().includes(o.toLowerCase())||T.code.toLowerCase().includes(o.toLowerCase())||T.description.toLowerCase().includes(o.toLowerCase()),P=c.length===0||c.includes(T.level),C=u.length===0||u.includes(T.status);return A&&P&&C}),[r,o,c,u]),{sortedData:v,sortConfig:g,handleSort:x}=Bn(p);_.useEffect(()=>{e&&b()},[e]);const b=async()=>{try{s(!0);const T=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ACTIVE",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ACTIVE",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}}];await new Promise(A=>setTimeout(A,300)),n(T)}catch(T){console.error("Error loading trainee courses:",T),ye.error("Failed to load enrolled courses")}finally{s(!1)}},y=T=>{const P={ACTIVE:{variant:"success",text:"Active"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[T]||{variant:"secondary",text:T};return i.jsx($e,{bg:P.variant,children:P.text})},w=T=>{const P={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[T]||{variant:"secondary",text:T};return i.jsx($e,{bg:P.variant,children:P.text})},j=T=>{t(`/trainee/${e}/course/${T.id}`)},N=T=>{t(`/trainee/${e}/course/${T.id}`)},E=T=>{d(T==="clear"?[]:A=>A.includes(T)?A.filter(P=>P!==T):[...A,T])},S=T=>{f(T==="clear"?[]:A=>A.includes(T)?A.filter(P=>P!==T):[...A,T])},O=()=>{d([]),f([]),l("")},k=({columnKey:T,children:A,className:P=""})=>{const C=g.key===T,F=C?g.direction:null;return i.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${P} ${C?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>x(T),onMouseEnter:M=>{M.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",M.target.style.transform="translateY(-1px)",M.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:M=>{M.target.style.backgroundColor="transparent",M.target.style.transform="translateY(0)",M.target.style.boxShadow="none"},children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[i.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500"},children:A}),i.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:i.jsx(is,{direction:F,size:14})})]}),C&&i.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return a?i.jsx(Ln,{rows:5,columns:8}):r.length===0?i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No enrolled courses"}),i.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):p.length===0&&(o||c.length>0||u.length>0)?i.jsxs("div",{children:[i.jsxs(Ee,{className:"mb-3 form-mobile-stack search-filter-section",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(wE,{uniqueLevels:h,uniqueStatuses:m,selectedLevels:c,selectedStatuses:u,onLevelToggle:E,onStatusToggle:S,onClearFilters:O,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[p.length," course",p.length!==1?"s":""]})})})]}),i.jsx("div",{className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("h5",{children:"No courses found"}),i.jsx("p",{children:"Try adjusting your search criteria or filters."}),i.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:O,children:"Clear Filters"})]})})]}):i.jsxs("div",{children:[i.jsxs(Ee,{className:"mb-3 form-mobile-stack search-filter-section",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(wE,{uniqueLevels:h,uniqueStatuses:m,selectedLevels:c,selectedStatuses:u,onLevelToggle:E,onStatusToggle:S,onClearFilters:O,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[p.length," course",p.length!==1?"s":""]})})})]}),i.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[i.jsx("thead",{className:"sticky-header",children:i.jsxs("tr",{children:[i.jsx(k,{columnKey:"code",className:"show-mobile",children:"Course Code"}),i.jsx(k,{columnKey:"name",className:"show-mobile",children:"Course Name"}),i.jsx(k,{columnKey:"level",className:"show-mobile",children:"Level"}),i.jsx(k,{columnKey:"status",className:"show-mobile",children:"Status"}),i.jsx(k,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),i.jsx(k,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),i.jsx(k,{columnKey:"progress",className:"show-mobile",children:"Progress"}),i.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),i.jsx("tbody",{children:v.map((T,A)=>i.jsxs("tr",{className:`${A%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:P=>{P.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:P=>{P.currentTarget.style.backgroundColor=A%2===0?"white":"var(--bs-neutral-50)"},children:[i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsx($e,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:T.code})}),i.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[i.jsx("div",{className:"fw-medium text-dark",children:T.name}),i.jsx("small",{className:"text-muted",children:T.description})]}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:w(T.level)}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:y(T.status)}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:T.startDate?new Date(T.startDate).toLocaleDateString():"N/A"})}),i.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:i.jsx("span",{className:"text-dark",children:T.endDate?new Date(T.endDate).toLocaleDateString():"N/A"})}),i.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${T.progress||0}%`}})}),i.jsxs("small",{className:"text-muted",children:[T.progress||0,"%"]})]})}),i.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Course Details",icon:i.jsx(Xt,{}),onClick:()=>j(T)},{label:"View Course Info",icon:i.jsx(Xt,{}),onClick:()=>N(T)}]})})]},T.id))})]})})]})},rP=({traineeId:e})=>{const t=Et(),[r,n]=_.useState(null),[a,s]=_.useState(!0),[o,l]=_.useState("");_.useEffect(()=>{e&&c()},[e]);const c=async()=>{try{s(!0),l("");const u={id:e,firstName:"John",middleName:"Michael",lastName:"Doe",email:"john.doe@company.com",phoneNumber:"+1 (555) 123-4567",dateOfBirth:"1990-05-15",address:"123 Main Street, New York, NY 10001",department:{id:1,name:"Flight Operations",code:"FO"},createdAt:"2024-01-15T10:00:00.000Z",updatedAt:"2024-02-01T14:30:00.000Z"};await new Promise(f=>setTimeout(f,500)),n(u)}catch(u){console.error("Error loading trainee details:",u),l("Failed to load trainee details"),ye.error("Failed to load trainee details")}finally{s(!1)}},d=()=>{t("/trainee")};return a?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading trainee details..."})]})}):o||!r?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs(tt,{variant:"danger",children:[i.jsx(tt.Heading,{children:"Error"}),i.jsx("p",{children:o||"Trainee not found"}),i.jsxs(le,{variant:"outline-danger",onClick:d,children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Trainees"]})]})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:d,className:"me-3",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[i.jsx(ba,{className:"me-2",size:28}),r.firstName," ",r.lastName]}),i.jsx("p",{className:"text-muted mb-0",children:r.department?.name||"No Department"})]})]}),i.jsx("div",{className:"d-flex align-items-center gap-2",children:i.jsx(sn,{permission:Me.TRAINEES.UPDATE,children:i.jsx(le,{variant:"outline-primary",size:"sm",children:"Edit Trainee"})})})]})})}),i.jsxs(Ee,{children:[i.jsx(oe,{lg:4,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(ba,{className:"me-2",size:20}),"Academic Details"]})}),i.jsxs(ce.Body,{children:[i.jsx("div",{className:"text-center mb-4",children:i.jsxs("h4",{className:"mb-1",children:[r.firstName," ",r.middleName," ",r.lastName]})}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(gd,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Email"}),i.jsx("div",{className:"text-muted",children:r.email||"N/A"})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Cg,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Phone"}),i.jsx("div",{className:"text-muted",children:r.phoneNumber||"N/A"})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Date of Birth"}),i.jsx("div",{className:"text-muted",children:r.dateOfBirth?new Date(r.dateOfBirth).toLocaleDateString():"N/A"})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(yo,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Address"}),i.jsx("div",{className:"text-muted",children:r.address||"N/A"})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Ts,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Department"}),i.jsx("div",{className:"text-muted",children:r.department?.name||"N/A"})]})]})]})]})]})}),i.jsx(oe,{lg:8,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:20}),"Enrolled Course List"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(sn,{permission:Me.TRAINEES.VIEW_COURSES,children:i.jsx(tP,{traineeId:e})})})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{lg:8,className:"offset-lg-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:20}),"Assessment Pending List"]})}),i.jsx(ce.Body,{className:"p-3",children:i.jsxs("div",{className:"text-center text-muted",children:[i.jsx(Vt,{size:48,className:"mb-3"}),i.jsx("p",{children:"Assessment pending list component is being updated."})]})})]})})})]})},Iue=()=>{const{traineeId:e}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(rP,{traineeId:e})})},Rue=({traineeId:e,courseId:t})=>{const r=Et(),[n,a]=_.useState([]),[s,o]=_.useState(!0);_.useEffect(()=>{e&&t&&l()},[e,t]);const l=async()=>{try{o(!0);const f=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(h=>setTimeout(h,300)),a(f)}catch(f){console.error("Error loading trainee subjects:",f),ye.error("Failed to load subjects")}finally{o(!1)}},c=f=>{const m={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[f]||{variant:"secondary",text:f};return i.jsx($e,{bg:m.variant,children:m.text})},d=f=>{const m={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[f]||{variant:"secondary",text:f};return i.jsx($e,{bg:m.variant,children:m.text})},u=f=>{r(`/trainee/${e}/course/${t}/subject/${f}`)};return s?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(ur,{animation:"border",variant:"primary",size:"sm"}),i.jsx("p",{className:"mt-2 text-muted small",children:"Loading subjects..."})]}):n.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(gr,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No subjects found"})]}):i.jsx("div",{className:"trainee-subjects-table",children:i.jsxs(Yt,{responsive:!0,hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:"Subject Code"}),i.jsx("th",{className:"text-start",children:"Subject Name"}),i.jsx("th",{className:"text-start",children:"Level"}),i.jsx("th",{className:"text-start",children:"Duration"}),i.jsx("th",{className:"text-start",children:"Method"}),i.jsx("th",{className:"text-start",children:"Status"}),i.jsx("th",{className:"text-start",children:"Progress"}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(f=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx($e,{bg:"primary",className:"fw-normal",children:f.code})}),i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:f.name}),i.jsx("small",{className:"text-muted",children:f.description})]}),i.jsx("td",{children:d(f.level)}),i.jsx("td",{children:i.jsxs("div",{className:"fw-semibold",children:[f.duration," hours"]})}),i.jsx("td",{children:i.jsx($e,{bg:"info",className:"fw-normal",children:f.method||"Classroom"})}),i.jsx("td",{children:c(f.status)}),i.jsx("td",{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress||0}%`}})}),i.jsxs("small",{className:"text-muted",children:[f.progress||0,"%"]})]})}),i.jsx("td",{children:i.jsx(le,{variant:"outline-primary",size:"sm",onClick:()=>u(f.id),children:i.jsx(Xt,{size:14})})})]},f.id))})]})})},nP=({traineeId:e,courseId:t})=>{const[r,n]=_.useState([]),[a,s]=_.useState(!0);_.useEffect(()=>{e&&o()},[e,t]);const o=async()=>{try{s(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(u){console.error("Error loading upcoming assessments:",u),ye.error("Failed to load upcoming assessments")}finally{s(!1)}},l=u=>{const h={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[u]||{variant:"secondary",text:u};return i.jsx($e,{bg:h.variant,children:h.text})},c=u=>{const h={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[u?.toUpperCase()]||{variant:"secondary",text:u};return i.jsx($e,{bg:h.variant,children:h.text})},d=u=>{console.log("Start assessment:",u)};return a?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(ur,{animation:"border",variant:"primary",size:"sm"}),i.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):r.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Yr,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):i.jsx("div",{className:"trainee-upcoming-assessments",children:i.jsxs(Yt,{responsive:!0,hover:!0,className:"mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:"Assessment"}),i.jsx("th",{className:"text-start",children:"Subject"}),i.jsx("th",{className:"text-start",children:"Type"}),i.jsx("th",{className:"text-start",children:"Priority"}),i.jsx("th",{className:"text-start",children:"Due Date"}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(u=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:u.name})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:u.subject})}),i.jsx("td",{children:c(u.type)}),i.jsx("td",{children:l(u.priority)}),i.jsxs("td",{children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Oa,{className:"text-muted me-1",size:14}),new Date(u.dueDate).toLocaleDateString()]}),i.jsx("small",{className:"text-muted",children:new Date(u.dueDate).toLocaleTimeString()})]}),i.jsx("td",{children:i.jsxs(le,{variant:"primary",size:"sm",onClick:()=>d(u.id),children:[i.jsx(Vt,{className:"me-1",size:14}),"Start"]})})]},u.id))})]})})},Ot=({title:e,sortKey:t,sortConfig:r,onSort:n})=>{const a=()=>{n(t)},s=()=>r.key===t?r.direction==="asc"?i.jsx(hS,{size:12,className:"ms-1"}):i.jsx(hi,{size:12,className:"ms-1"}):i.jsx(is,{size:12,className:"ms-1"});return i.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:a,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[i.jsx("span",{className:"me-1",children:e}),s()]})},Fue=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Fue,document.head.appendChild(e)}const Ty=({traineeId:e,courseId:t,subjectId:r})=>{const[n,a]=_.useState([]),[s,o]=_.useState(!0),{sortedData:l,sortConfig:c,handleSort:d}=Bn(n);_.useEffect(()=>{u()},[e,t,r]);const u=async()=>{try{o(!0);let v=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(v=v.filter(g=>g.course?.code==="SAF001")),r&&(v=v.filter(g=>g.subject?.code==="BSP")),await new Promise(g=>setTimeout(g,300)),a(v)}catch(p){console.error("Error loading completed assessments:",p),ye.error("Failed to load completed assessments")}finally{o(!1)}},f=p=>{const g={COMPLETED:{variant:"success",text:"Completed",icon:It},PASSED:{variant:"success",text:"Passed",icon:It},FAILED:{variant:"danger",text:"Failed",icon:Gt}}[p]||{variant:"secondary",text:p,icon:It},x=g.icon;return i.jsxs($e,{bg:g.variant,className:"d-flex align-items-center",children:[i.jsx(x,{size:12,className:"me-1"}),g.text]})},h=(p,v)=>{const g=p/v*100;let x="success";return g<60?x="danger":g<80&&(x="warning"),i.jsxs($e,{bg:x,children:[p,"/",v," (",g.toFixed(0),"%)"]})},m=p=>{console.log("View completed assessment:",p.id)};return s?i.jsx("div",{className:"text-center py-4",children:i.jsx(Ln,{count:5})}):n.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(It,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):i.jsx("div",{className:"scrollable-table-container admin-table completed-assessments-table-no-borders",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Assessment",sortKey:"name",sortConfig:c,onSort:d})}),!r&&i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Subject",sortKey:"subject",sortConfig:c,onSort:d})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Type",sortKey:"type",sortConfig:c,onSort:d})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Score",sortKey:"score",sortConfig:c,onSort:d})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Completed Date",sortKey:"completedDate",sortConfig:c,onSort:d})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Status",sortKey:"status",sortConfig:c,onSort:d})}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:l.map(p=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:p.name}),i.jsx("small",{className:"text-muted",children:p.description})]}),!r&&i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:p.subject?.name||"N/A"}),i.jsx("small",{className:"text-muted",children:p.subject?.code||""})]}),i.jsx("td",{children:i.jsx($e,{bg:"primary",className:"fw-normal",children:p.type||"Assessment"})}),i.jsx("td",{children:h(p.score,p.maxScore)}),i.jsx("td",{children:p.completedDate?new Date(p.completedDate).toLocaleDateString():"N/A"}),i.jsx("td",{children:f(p.status)}),i.jsx("td",{children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"View Results",icon:i.jsx(It,{}),onClick:()=>m(p)}]})})]},p.id))})]})})},Lue=({traineeId:e,courseId:t})=>{const r=Et(),[n,a]=_.useState(null),[s,o]=_.useState(null),[l,c]=_.useState(!0),[d,u]=_.useState("");_.useEffect(()=>{e&&t&&f()},[e,t]);const f=async()=>{try{c(!0),u(""),o({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),a({id:t,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(v){console.error("Error loading course details:",v),u("Failed to load course details"),ye.error("Failed to load course details")}finally{c(!1)}},h=()=>{r("/trainee/enrolled-courses")},m=v=>{const x={ACTIVE:{variant:"success",text:"Active"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[v]||{variant:"secondary",text:v};return i.jsx($e,{bg:x.variant,className:"fs-6",children:x.text})},p=v=>{const x={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[v]||{variant:"secondary",text:v};return i.jsx($e,{bg:x.variant,children:x.text})};return l?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):d||!n?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs(tt,{variant:"danger",children:[i.jsx(tt.Heading,{children:"Error"}),i.jsx("p",{children:d||"Course not found"}),i.jsxs(le,{variant:"outline-danger",onClick:h,children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Trainee"]})]})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:h,className:"me-3",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:28}),n.name]}),i.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",s?.firstName," ",s?.lastName]})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(n.status),p(n.level)]})]})})}),i.jsxs(Ee,{children:[i.jsxs(oe,{lg:8,className:"mb-4",children:[i.jsx(Ee,{children:i.jsx(oe,{className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:20}),"Subject List"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(Rue,{traineeId:e,courseId:t})})]})})}),i.jsx(Ee,{children:i.jsx(oe,{className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(nP,{traineeId:e,courseId:t})})]})})}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(It,{className:"me-2",size:20}),"Completed Assessments"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(Ty,{traineeId:e,courseId:t})})]})})})]}),i.jsx(oe,{lg:4,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:20}),"Enrolled Course Details"]})}),i.jsxs(ce.Body,{children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Start Date"}),i.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"End Date"}),i.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(yo,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Venue"}),i.jsx("div",{className:"text-muted",children:n.venue})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Pn,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Max Trainees"}),i.jsx("div",{className:"text-muted",children:n.maxNumTrainee})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Oa,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Pass Score"}),i.jsxs("div",{className:"text-muted",children:[n.passScore,"%"]})]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("span",{className:"fw-semibold",children:"Progress"}),i.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),i.jsx("div",{className:"progress",children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("h6",{children:"Description"}),i.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},Mue=()=>{const{traineeId:e,courseId:t}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(Lue,{traineeId:e,courseId:t})})},Bue=({traineeId:e,courseId:t,subjectId:r})=>{const n=Et(),[a,s]=_.useState(null),[o,l]=_.useState(null),[c,d]=_.useState(!0),[u,f]=_.useState("");_.useEffect(()=>{e&&t&&r&&h()},[e,t,r]);const h=async()=>{try{d(!0),f("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},x={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};s(g),l(x)}catch(g){console.error("Error loading subject details:",g),f("Failed to load subject details"),ye.error("Failed to load subject details")}finally{d(!1)}},m=()=>{n(`/trainee/${e}/course/${t}`)},p=g=>{const b={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return i.jsx($e,{bg:b.variant,className:"fs-6",children:b.text})},v=g=>{const b={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return i.jsx($e,{bg:b.variant,children:b.text})};return c?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):u||!a?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs(tt,{variant:"danger",children:[i.jsx(tt.Heading,{children:"Error"}),i.jsx("p",{children:u||"Subject not found"}),i.jsxs(le,{variant:"outline-danger",onClick:m,children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Course"]})]})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:m,className:"me-3",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:28}),a.name]}),i.jsxs("p",{className:"text-muted mb-0",children:[a.code,"  ",o?.firstName," ",o?.lastName]})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(a.status),v(a.level)]})]})})}),i.jsxs(Ee,{children:[i.jsxs(oe,{lg:8,className:"mb-4",children:[i.jsx(Ee,{children:i.jsx(oe,{className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(nP,{traineeId:e,courseId:t,subjectId:r})})]})})}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(It,{className:"me-2",size:20}),"Completed Assessments"]})}),i.jsx(ce.Body,{className:"p-0",children:i.jsx(Ty,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),i.jsx(oe,{lg:4,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(gr,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),i.jsxs(ce.Body,{children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Start Date"}),i.jsx("div",{className:"text-muted",children:new Date(a.startDate).toLocaleDateString()})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Yr,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"End Date"}),i.jsx("div",{className:"text-muted",children:new Date(a.endDate).toLocaleDateString()})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Oa,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Duration"}),i.jsxs("div",{className:"text-muted",children:[a.duration," hours"]})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(yo,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Room"}),i.jsx("div",{className:"text-muted",children:a.roomName})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(ba,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Trainer"}),i.jsx("div",{className:"text-muted",children:a.trainer?.name})]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("span",{className:"fw-semibold",children:"Progress"}),i.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),i.jsx("div",{className:"progress",children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${a.progress}%`}})})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("h6",{children:"Description"}),i.jsx("p",{className:"text-muted",children:a.description})]})]})]})})]})]})},$ue=()=>{const{traineeId:e,courseId:t,subjectId:r}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(Bue,{traineeId:e,courseId:t,subjectId:r})})},zue=({traineeId:e})=>{const t=Et(),[r,n]=_.useState(null),[a,s]=_.useState([]),[o,l]=_.useState([]),[c,d]=_.useState([]),[u,f]=_.useState(!0),[h,m]=_.useState("");_.useEffect(()=>{e&&p()},[e]);const p=async()=>{try{f(!0),m("");const N=await no.getTraineeById(e);n(N);const E=await no.getTraineeAssessments(e);s(E.assessments||E.data||[]);const S=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],O=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];l(S),d(O)}catch(N){console.error("Error loading assessment data:",N),m("Failed to load assessment data"),ye.error("Failed to load assessment data")}finally{f(!1)}},v=()=>{t(`/trainee/${e}`)},g=N=>{const S={PENDING:{variant:"warning",text:"Pending",icon:Oa},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Vt},COMPLETED:{variant:"success",text:"Completed",icon:It},OVERDUE:{variant:"danger",text:"Overdue",icon:Gt}}[N]||{variant:"secondary",text:N,icon:Vt},O=S.icon;return i.jsxs($e,{bg:S.variant,className:"d-flex align-items-center",children:[i.jsx(O,{size:12,className:"me-1"}),S.text]})},x=N=>{const S={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[N]||{variant:"secondary",text:N};return i.jsx($e,{bg:S.variant,children:S.text})},b=N=>{console.log("Start assessment:",N)},y=N=>{console.log("View assessment:",N)},w=N=>{console.log("Open signature pad for:",N)},j=N=>{console.log("Complete section:",N)};return u?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):h||!r?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs(tt,{variant:"danger",children:[i.jsx(tt.Heading,{children:"Error"}),i.jsx("p",{children:h||"Trainee not found"}),i.jsxs(le,{variant:"outline-danger",onClick:v,children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Trainee"]})]})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsx("div",{className:"d-flex justify-content-between align-items-center",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:v,className:"me-3",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:28}),"Assessment Management"]}),i.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),i.jsx(Ee,{children:i.jsx(oe,{children:i.jsx(ce,{className:"border-0 shadow-sm",children:i.jsx(ce.Body,{className:"p-0",children:i.jsxs(lS,{defaultActiveKey:"pending",className:"border-bottom",children:[i.jsx(dn,{eventKey:"pending",title:"Pending Assessments",children:i.jsx("div",{className:"p-4",children:a.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Vt,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):i.jsx("div",{className:"trainee-assessments-table",children:i.jsxs("table",{className:"table table-hover mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:"Assessment"}),i.jsx("th",{className:"text-start",children:"Course"}),i.jsx("th",{className:"text-start",children:"Subject"}),i.jsx("th",{className:"text-start",children:"Type"}),i.jsx("th",{className:"text-start",children:"Priority"}),i.jsx("th",{className:"text-start",children:"Due Date"}),i.jsx("th",{className:"text-start",children:"Status"}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:a.map(N=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:N.name}),i.jsx("small",{className:"text-muted",children:N.description})]}),i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:N.course?.name||"N/A"}),i.jsx("small",{className:"text-muted",children:N.course?.code||""})]}),i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:N.subject?.name||"N/A"}),i.jsx("small",{className:"text-muted",children:N.subject?.code||""})]}),i.jsx("td",{children:i.jsx($e,{bg:"info",className:"fw-normal",children:N.type||"Assessment"})}),i.jsx("td",{children:x(N.priority)}),i.jsx("td",{children:N.dueDate?new Date(N.dueDate).toLocaleDateString():"N/A"}),i.jsx("td",{children:g(N.status)}),i.jsx("td",{children:i.jsx("div",{className:"d-flex gap-1",children:N.status==="PENDING"||N.status==="IN_PROGRESS"?i.jsx(le,{variant:"primary",size:"sm",onClick:()=>b(N.id),children:"Start"}):i.jsx(le,{variant:"outline-primary",size:"sm",onClick:()=>y(N.id),children:"View"})})})]},N.id))})]})})})}),i.jsx(dn,{eventKey:"signature",title:"Signature Required",children:i.jsx("div",{className:"p-4",children:o.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(mi,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):i.jsx("div",{className:"trainee-assessments-table",children:i.jsxs("table",{className:"table table-hover mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:"Document"}),i.jsx("th",{className:"text-start",children:"Course"}),i.jsx("th",{className:"text-start",children:"Subject"}),i.jsx("th",{className:"text-start",children:"Due Date"}),i.jsx("th",{className:"text-start",children:"Status"}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:o.map(N=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.name})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.course})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.subject})}),i.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),i.jsx("td",{children:g(N.status)}),i.jsx("td",{children:i.jsxs(le,{variant:"primary",size:"sm",onClick:()=>w(N.id),children:[i.jsx(mi,{className:"me-1",size:14}),"Sign"]})})]},N.id))})]})})})}),i.jsx(dn,{eventKey:"completion",title:"Section Completion",children:i.jsx("div",{className:"p-4",children:c.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(It,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):i.jsx("div",{className:"trainee-assessments-table",children:i.jsxs("table",{className:"table table-hover mb-0",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:"Section"}),i.jsx("th",{className:"text-start",children:"Course"}),i.jsx("th",{className:"text-start",children:"Subject"}),i.jsx("th",{className:"text-start",children:"Type"}),i.jsx("th",{className:"text-start",children:"Due Date"}),i.jsx("th",{className:"text-start",children:"Progress"}),i.jsx("th",{className:"text-start",children:"Status"}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:c.map(N=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.name})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.course})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:N.subject})}),i.jsx("td",{children:i.jsx($e,{bg:"info",className:"fw-normal",children:N.section})}),i.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),i.jsx("td",{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${N.progress}%`}})}),i.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),i.jsx("td",{children:g(N.status)}),i.jsx("td",{children:i.jsx(le,{variant:"primary",size:"sm",onClick:()=>j(N.id),children:N.status==="COMPLETED"?"View":"Complete"})})]},N.id))})]})})})})]})})})})})]})},Uue=()=>{const{traineeId:e}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(zue,{traineeId:e})})},que=({show:e,onClose:t,onSave:r,documentName:n,loading:a=!1})=>{const s=_.useRef(null),[o,l]=_.useState(!1),[c,d]=_.useState(!1),[u,f]=_.useState("");_.useEffect(()=>{e&&(d(!1),f(""),h())},[e]);const h=()=>{const b=s.current;b&&(b.getContext("2d").clearRect(0,0,b.width,b.height),d(!1))},m=b=>{l(!0);const y=s.current,w=y.getBoundingClientRect(),j=y.getContext("2d");j.beginPath(),j.moveTo(b.clientX-w.left,b.clientY-w.top)},p=b=>{if(!o)return;const y=s.current,w=y.getBoundingClientRect(),j=y.getContext("2d");j.lineTo(b.clientX-w.left,b.clientY-w.top),j.stroke(),d(!0)},v=()=>{l(!1)},g=async()=>{if(!c){f("Please provide your signature before saving");return}try{const y=s.current.toDataURL("image/png");await r({documentName:n,signature:y,timestamp:new Date().toISOString()}),t()}catch{f("Failed to save signature. Please try again.")}},x=()=>{h(),f(""),t()};return i.jsxs(de,{show:e,onHide:x,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(mi,{className:"me-2",size:20}),"Digital Signature"]}),i.jsx(le,{variant:"link",onClick:x,className:"text-white p-0",children:i.jsx(Ye,{size:24})})]}),i.jsxs(de.Body,{className:"p-4",children:[u&&i.jsx(tt,{variant:"danger",className:"mb-3",children:u}),i.jsxs("div",{className:"text-center mb-4",children:[i.jsxs("h5",{children:["Sign Document: ",n]}),i.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),i.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:i.jsx("canvas",{ref:s,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:m,onMouseMove:p,onMouseUp:v,onMouseLeave:v,onTouchStart:b=>{b.preventDefault();const y=b.touches[0],w=new MouseEvent("mousedown",{clientX:y.clientX,clientY:y.clientY});m(w)},onTouchMove:b=>{b.preventDefault();const y=b.touches[0],w=new MouseEvent("mousemove",{clientX:y.clientX,clientY:y.clientY});p(w)},onTouchEnd:b=>{b.preventDefault(),v()}})}),i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs(le,{variant:"outline-secondary",onClick:h,disabled:a,children:[i.jsx(dS,{className:"me-2",size:16}),"Clear"]}),i.jsx("div",{className:"text-muted small",children:c?i.jsx("span",{className:"text-success",children:" Signature captured"}):i.jsx("span",{children:"Please sign above"})})]}),i.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[i.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),i.jsxs("ul",{className:"mb-0 small text-muted",children:[i.jsx("li",{children:"Sign within the designated area"}),i.jsx("li",{children:"Use your full legal signature"}),i.jsx("li",{children:"Ensure the signature is clear and readable"}),i.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:x,disabled:a,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),i.jsx(le,{variant:"primary",onClick:g,disabled:a||!c,children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wa,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Wue=()=>{const{traineeId:e,documentId:t}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(que,{show:!0,documentName:`Document ${t}`,onClose:()=>window.history.back(),onSave:r=>{console.log("Signature saved:",r)}})})},Hue=({traineeId:e,sectionId:t})=>{const r=Et(),[n,a]=_.useState(null),[s,o]=_.useState(!0),[l,c]=_.useState("");_.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{o(!0),c(""),a({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(p){console.error("Error loading section details:",p),c("Failed to load assessment section details"),ye.error("Failed to load assessment section details")}finally{o(!1)}},u=()=>{r(`/trainee/${e}/assessments`)},f=p=>{const g={PENDING:{variant:"warning",text:"Pending",icon:Oa},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Vt},COMPLETED:{variant:"success",text:"Completed",icon:It},OVERDUE:{variant:"danger",text:"Overdue",icon:Gt}}[p]||{variant:"secondary",text:p,icon:Vt},x=g.icon;return i.jsxs($e,{bg:g.variant,className:"d-flex align-items-center",children:[i.jsx(x,{size:12,className:"me-1"}),g.text]})},h=()=>{console.log("Start assessment section:",t)},m=()=>{console.log("Continue assessment section:",t)};return s?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(ur,{animation:"border",variant:"primary"}),i.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):l||!n?i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs(tt,{variant:"danger",children:[i.jsx(tt.Heading,{children:"Error"}),i.jsx("p",{children:l||"Assessment section not found"}),i.jsxs(le,{variant:"outline-danger",onClick:u,children:[i.jsx(dr,{className:"me-2",size:16}),"Back to Assessments"]})]})}):i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:u,className:"me-3",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:28}),n.name]}),i.jsxs("p",{className:"text-muted mb-0",children:[n.course,"  ",n.subject]})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[f(n.status),i.jsx($e,{bg:"info",className:"fw-normal",children:n.type})]})]})})}),i.jsxs(Ee,{children:[i.jsx(oe,{lg:8,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(Vt,{className:"me-2",size:20}),"Assessment Section Details"]})}),i.jsxs(ce.Body,{children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{children:"Description"}),i.jsx("p",{className:"text-muted",children:n.description})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{children:"Instructions"}),i.jsx("ul",{className:"list-unstyled",children:n.instructions.map((p,v)=>i.jsxs("li",{className:"mb-2",children:[i.jsx("span",{className:"text-primary me-2",children:""}),p]},v))})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{children:"Questions Overview"}),i.jsx("div",{className:"row",children:n.questions.map((p,v)=>i.jsx("div",{className:"col-md-6 mb-3",children:i.jsxs("div",{className:`p-3 border rounded ${p.isAnswered||p.isCompleted?"bg-light":""}`,children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsxs("span",{className:"fw-semibold",children:["Question ",v+1]}),p.isAnswered||p.isCompleted?i.jsx($e,{bg:"success",className:"small",children:"Completed"}):i.jsx($e,{bg:"warning",className:"small",children:"Pending"})]}),i.jsx("p",{className:"mb-0 small text-muted",children:p.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},p.id))})]}),i.jsx("div",{className:"d-flex justify-content-center",children:n.status==="PENDING"?i.jsxs(le,{variant:"primary",size:"lg",onClick:h,children:[i.jsx(Pg,{className:"me-2",size:20}),"Start Assessment"]}):i.jsxs(le,{variant:"primary",size:"lg",onClick:m,children:[i.jsx(Vt,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),i.jsx(oe,{lg:4,className:"mb-4",children:i.jsxs(ce,{className:"h-100 border-0 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-white border-bottom",children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(Oa,{className:"me-2",size:20}),"Assessment Information"]})}),i.jsxs(ce.Body,{children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Oa,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Time Limit"}),i.jsxs("div",{className:"text-muted",children:[n.timeLimit," minutes"]})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Oa,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Due Date"}),i.jsx("div",{className:"text-muted",children:new Date(n.dueDate).toLocaleDateString()})]})]}),i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Vt,{className:"text-muted me-3",size:18}),i.jsxs("div",{children:[i.jsx("div",{className:"fw-semibold",children:"Total Questions"}),i.jsx("div",{className:"text-muted",children:n.questions.length})]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("span",{className:"fw-semibold",children:"Progress"}),i.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),i.jsx(IP,{now:n.progress,variant:"primary",className:"mb-3"}),i.jsx("div",{className:"text-center",children:i.jsxs("small",{className:"text-muted",children:[n.questions.filter(p=>p.isAnswered||p.isCompleted).length," of ",n.questions.length," questions completed"]})})]}),i.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[i.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),i.jsxs("ul",{className:"mb-0 small text-muted",children:[i.jsx("li",{children:"Read questions carefully"}),i.jsx("li",{children:"Manage your time wisely"}),i.jsx("li",{children:"Save progress regularly"}),i.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},Vue=()=>{const{traineeId:e,sectionId:t}=Fn();return i.jsx(He,{className:"py-3",children:i.jsx(Hue,{traineeId:e,sectionId:t})})},Gue=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Gue,document.head.appendChild(e)}const jE=()=>{const e=Et(),t=[{title:"Academic Details",description:"View your personal and academic information",icon:ba,path:"/trainee/academic-details",color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:gr,path:"/trainee/enrolled-courses",color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:Vt,path:"/trainee/assessment-pending",color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Gt,path:"/trainee/create-issue",color:"danger"}];return i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsx("h3",{className:"mb-3",children:"Quick Actions"})})}),i.jsx(Ee,{children:t.map((r,n)=>{const a=r.icon;return i.jsx(oe,{lg:6,xl:3,className:"mb-4",children:i.jsx(ce,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:s=>{s.currentTarget.style.transform="translateY(-5px)",s.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:s=>{s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:i.jsxs(ce.Body,{className:"p-4",children:[i.jsxs("div",{className:"d-flex align-items-center mb-3",children:[i.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:i.jsx(a,{size:24})}),i.jsx("div",{className:"flex-grow-1",children:i.jsx("h5",{className:"mb-1",children:r.title})}),i.jsx(vl,{size:20,className:"text-muted"})]}),i.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},n)})}),i.jsxs(Ee,{className:"mt-4",children:[i.jsx(oe,{lg:6,className:"d-flex",children:i.jsxs(ce,{className:"border-0 shadow-sm w-100 training-progress-card",children:[i.jsx(ce.Header,{children:i.jsx("h5",{className:"mb-0",children:"Training Progress"})}),i.jsx(ce.Body,{className:"d-flex flex-column justify-content-center",children:i.jsxs("div",{className:"text-center py-4",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),i.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),i.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),i.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),i.jsx(oe,{lg:6,className:"d-flex",children:i.jsxs(ce,{className:"border-0 shadow-sm w-100 assessments-card",children:[i.jsx(ce.Header,{children:i.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),i.jsx(ce.Body,{className:"d-flex flex-column justify-content-center",children:i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Vt,{size:48,className:"text-muted mb-3"}),i.jsx("h6",{className:"text-muted",children:"No assessments pending"}),i.jsx("p",{className:"text-muted small mb-3",children:"Complete your assessment confirmations to track progress."}),i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/assessment-pending/signature-required"),className:"d-flex align-items-center justify-content-center mx-auto",children:[i.jsx(Vt,{size:16,className:"me-2"}),"Go to Assessments",i.jsx(vl,{size:16,className:"ms-2"})]})]})})]})})]})]})},Kue=()=>{const{user:e}=bn();return e?i.jsx(He,{className:"py-3",children:i.jsx(rP,{traineeId:e.id})}):i.jsx(He,{className:"py-3",children:i.jsx("div",{className:"text-center",children:i.jsx("p",{children:"Please log in to view your academic details."})})})},Yue=()=>{const{user:e}=bn();return e?i.jsx(He,{className:"py-3",children:i.jsx(tP,{traineeId:e.id})}):i.jsx(He,{className:"py-3",children:i.jsx("div",{className:"text-center",children:i.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Xue=()=>{const e=Et();return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx(ce,{className:"shadow-sm",children:i.jsx(ce.Body,{className:"p-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Vt,{size:64,className:"text-muted mb-3"}),i.jsx("h4",{className:"mb-3",children:"All Assessments"}),i.jsx("p",{className:"text-muted mb-4",children:"This page provides an overview of all assessment-related activities. Use the navigation menu to access specific assessment types."}),i.jsxs("div",{className:"row g-3",children:[i.jsx("div",{className:"col-md-4",children:i.jsx("div",{className:"card h-100 border-0 shadow-sm",children:i.jsxs("div",{className:"card-body text-center",children:[i.jsx(mi,{size:32,className:"text-primary mb-2"}),i.jsx("h6",{className:"card-title",children:"Signature Required"}),i.jsx("p",{className:"card-text text-muted small",children:"Documents that require your signature"}),i.jsx(le,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/signature-required"),children:"View Documents"})]})})}),i.jsx("div",{className:"col-md-4",children:i.jsx("div",{className:"card h-100 border-0 shadow-sm",children:i.jsxs("div",{className:"card-body text-center",children:[i.jsx(It,{size:32,className:"text-success mb-2"}),i.jsx("h6",{className:"card-title",children:"Section Completion"}),i.jsx("p",{className:"card-text text-muted small",children:"Training sections that need completion"}),i.jsx(le,{variant:"outline-success",size:"sm",onClick:()=>e("/trainee/completion-required"),children:"View Sections"})]})})}),i.jsx("div",{className:"col-md-4",children:i.jsx("div",{className:"card h-100 border-0 shadow-sm",children:i.jsxs("div",{className:"card-body text-center",children:[i.jsx(Vt,{size:32,className:"text-info mb-2"}),i.jsx("h6",{className:"card-title",children:"Your Assessments"}),i.jsx("p",{className:"card-text text-muted small",children:"Upcoming and completed assessments"}),i.jsx(le,{variant:"outline-info",size:"sm",onClick:()=>e("/trainee/your-assessments"),children:"View Assessments"})]})})})]})]})})})})},Zue=({show:e,onHide:t,onImportSuccess:r,onImportError:n})=>{const a=Et(),[s,o]=_.useState("with-fields"),[l,c]=_.useState(null),[d,u]=_.useState(!1),f=_.useRef(null),h=y=>{const w=y.target.files[0];if(w){const j=[".docx"],N=w.name.toLowerCase().substring(w.name.lastIndexOf("."));if(!j.includes(N)){ye.error("Please select a valid Word document file (.docx)");return}if(w.size>10*1024*1024){ye.error("File size must be less than 10MB");return}c(w)}},m=async()=>{if(!l){ye.error("Please select a file to import");return}u(!0);try{s==="with-fields"?await p(l):await v(l);const y=await b(l,s);a("/admin/forms/editor",{state:{content:y,fileName:l.name,importType:s==="with-fields"?"File with fields":"File without fields"}}),g(),r(s==="with-fields"?"File with fields":"File without fields",l.name)}catch(y){n(y.message||"Import failed")}finally{u(!1)}},p=async y=>{await new Promise(w=>setTimeout(w,2e3))},v=async y=>{await new Promise(w=>setTimeout(w,2e3))},g=()=>{c(null),o("with-fields"),f.current&&(f.current.value=""),t()},x=y=>{ye.info(`Downloading ${y} template...`)},b=async(y,w)=>(await new Promise(j=>setTimeout(j,500)),w==="with-fields"?`
        <h1 style="text-align: center;">Imported Word Document with Fields</h1>
        <p><strong>Source Document:</strong> ${y.name}</p>
        <p><strong>Document Type:</strong> Word Document (.docx)</p>
        <hr>
        <p><strong>Customer Name:</strong> {{customer_name}}</p>
        <p><strong>Email Address:</strong> {{email}}</p>
        <p><strong>Phone Number:</strong> {{phone}}</p>
        <p><strong>Company Name:</strong> {{company_name}}</p>
        <p><strong>Invoice Date:</strong> {{invoice_date}}</p>
        <p><strong>Invoice Total:</strong> {{invoice_total}}</p>
        <p><strong>Address:</strong> {{address}}</p>
        <p><strong>Signature:</strong> {{signature}}</p>
        <hr>
        <p><em>This document was automatically parsed from a Word document with predefined fields.</em></p>
      `:`
        <h1 style="text-align: center;">Imported Raw Word Document</h1>
        <p><strong>Source Document:</strong> ${y.name}</p>
        <p><strong>Document Type:</strong> Word Document (.docx)</p>
        <hr>
        <p>This is a raw Word document that was imported. The content has been converted to HTML format.</p>
        <p>You can now add merge fields and structure as needed using the field buttons on the left.</p>
        <p>Use the editor to format and customize the content to create your form template.</p>
        <hr>
        <p><em>This document was imported as raw content. Add fields manually using the merge field buttons.</em></p>
      `);return i.jsxs(de,{show:e,onHide:g,size:"lg",centered:!0,children:[i.jsx(de.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-2",size:20}),"Import Form File"]})}),i.jsxs(de.Body,{className:"p-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsx(ce,{className:`h-100 cursor-pointer ${s==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("with-fields"),style:{cursor:"pointer"},children:i.jsxs(ce.Body,{className:"text-center p-4",children:[i.jsx(mS,{size:48,className:"text-primary mb-3"}),i.jsx("h6",{className:"text-primary",children:"File with Fields"}),i.jsx("p",{className:"text-muted small mb-3",children:"Import a Word document that already contains predefined form fields and structure. The system will automatically parse and create form templates."}),i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:y=>{y.stopPropagation(),x("with-fields")},children:[i.jsx(Ja,{className:"me-1",size:14}),"Download Template"]})]})})}),i.jsx(oe,{md:6,children:i.jsx(ce,{className:`h-100 cursor-pointer ${s==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("without-fields"),style:{cursor:"pointer"},children:i.jsxs(ce.Body,{className:"text-center p-4",children:[i.jsx(hu,{size:48,className:"text-success mb-3"}),i.jsx("h6",{className:"text-success",children:"File without Fields"}),i.jsx("p",{className:"text-muted small mb-3",children:"Import a raw Word document without predefined structure. You will manually define form fields and mapping after import."}),i.jsxs(le,{variant:"outline-success",size:"sm",onClick:y=>{y.stopPropagation(),x("without-fields")},children:[i.jsx(Ja,{className:"me-1",size:14}),"Download Template"]})]})})})]})]}),!s&&i.jsxs(tt,{variant:"info",className:"mb-4",children:[i.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),i.jsx("p",{className:"mb-0 small",children:'Choose between "File with Fields" or "File without Fields" above to continue with the import process.'})]}),s&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),i.jsxs(Y.Group,{children:[i.jsx(Y.Control,{ref:f,type:"file",accept:".docx",onChange:h,className:"mb-2"}),i.jsx(Y.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),l&&i.jsx(tt,{variant:"info",className:"mb-4",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(hu,{className:"me-2",size:20}),i.jsxs("div",{children:[i.jsx("strong",{children:"Selected File:"})," ",l.name,i.jsx("br",{}),i.jsxs("small",{className:"text-muted",children:["Size: ",(l.size/1024/1024).toFixed(2)," MB"]})]})]})}),i.jsxs(tt,{variant:"light",className:"mb-0",children:[i.jsx("h6",{className:"text-primary-custom mb-2",children:"Import Instructions"}),s==="with-fields"?i.jsxs("ul",{className:"mb-0 small",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Automatic Processing:"})," System will parse Word document and create form templates automatically"]}),i.jsx("li",{children:"Document should contain predefined form fields and structure"}),i.jsx("li",{children:"Form fields will be automatically mapped and validated"}),i.jsx("li",{children:"Content will be converted to editable form template"}),i.jsx("li",{children:"Download the template above for the correct format"})]}):i.jsxs("ul",{className:"mb-0 small",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manual Processing:"})," You will define form fields and mapping after import"]}),i.jsx("li",{children:"Document can contain raw content without predefined form structure"}),i.jsx("li",{children:"Content will be imported as-is, then you configure fields manually"}),i.jsx("li",{children:"More flexible but requires additional setup steps"}),i.jsx("li",{children:"Perfect for converting existing documents to forms"})]})]})]})]}),i.jsxs(de.Footer,{className:"border-0 p-4",children:[i.jsxs(le,{variant:"outline-secondary",onClick:g,disabled:d,children:[i.jsx(Ye,{className:"me-2",size:16}),"Cancel"]}),s&&i.jsx(le,{variant:"primary-custom",onClick:m,disabled:!l||d,children:d?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Dn,{className:"me-2",size:16}),"Import File"]})})]})]})},Jue=()=>{const e=Et(),[t,r]=_.useState(!1),n=()=>{r(!0)},a=()=>{e("/admin/forms/editor",{state:{content:'<h1 style="text-align: center;">New Form</h1><p>Start creating your form here...</p>',fileName:"New Form",importType:"New Form"}})},s=(l,c)=>{ye.success(`${l} file "${c}" imported successfully!`),r(!1)},o=l=>{ye.error(`Import failed: ${l}`)};return i.jsx(He,{fluid:!0,className:"py-4 forms-page",children:i.jsxs(ce,{className:"border-neutral-200 shadow-sm",children:[i.jsx(ce.Header,{className:"bg-light-custom border-neutral-200",children:i.jsx(Ee,{className:"align-items-center",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xa,{className:"me-2 text-primary-custom",size:24}),i.jsx("h4",{className:"mb-0 text-primary-custom",children:"Form Templates"})]})})})}),i.jsxs(ce.Body,{children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"text-center py-5",children:[i.jsx(hu,{size:64,className:"text-muted mb-3"}),i.jsx("h5",{className:"text-muted",children:"No form templates found"}),i.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."}),i.jsxs("div",{className:"d-flex justify-content-center gap-3",children:[i.jsx(sn,{permission:Me.TEMPLATES.CREATE,fallback:null,children:i.jsxs(le,{variant:"outline-primary",onClick:a,className:"d-flex align-items-center",children:[i.jsx(gn,{className:"me-2",size:16}),"Create New Form"]})}),i.jsx(sn,{permission:Me.TEMPLATES.CREATE,fallback:null,children:i.jsxs(le,{variant:"primary-custom",onClick:n,className:"d-flex align-items-center",children:[i.jsx(Dn,{className:"me-2",size:16}),"Import File"]})})]})]})})}),i.jsx(Zue,{show:t,onHide:()=>r(!1),onImportSuccess:s,onImportError:o})]})]})})},Que=({fileName:e="Untitled Document",hasUnsavedChanges:t=!1,isSaving:r=!1,onSave:n,onPreview:a,onExport:s,content:o="",className:l=""})=>i.jsxs("div",{className:`d-flex justify-content-between align-items-center ${l}`,children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xa,{className:"me-2 text-primary-custom",size:20}),i.jsxs("h5",{className:"mb-0 text-primary-custom",children:[e,t&&i.jsx("span",{className:"text-warning ms-2",children:""})]})]}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsxs(le,{variant:"outline-secondary",size:"sm",onClick:a,disabled:!o.trim(),children:[i.jsx(Xt,{className:"me-1",size:14}),"Preview"]}),i.jsxs(le,{variant:"outline-primary",size:"sm",onClick:s,disabled:!o.trim(),children:[i.jsx(Ja,{className:"me-1",size:14}),"Export"]}),i.jsxs(le,{variant:"primary-custom",size:"sm",onClick:n,disabled:r||!t,children:[r?i.jsx(ur,{size:"sm",className:"me-1"}):i.jsx(wa,{className:"me-1",size:14}),r?"Saving...":"Save"]})]})]}),aP=[{name:"customer_name",label:"Customer Name",category:"customer"},{name:"invoice_total",label:"Invoice Total",category:"financial"},{name:"invoice_date",label:"Invoice Date",category:"date"},{name:"company_name",label:"Company Name",category:"company"},{name:"address",label:"Address",category:"location"},{name:"phone",label:"Phone",category:"contact"},{name:"email",label:"Email",category:"contact"},{name:"signature",label:"Signature",category:"signature"}];[...aP];const ede=({mergeFields:e=[],onInsertField:t,readOnly:r=!1,className:n="",showCategories:a=!1,selectedCategory:s=null})=>{const o=e.length>0?e:aP;return i.jsxs("div",{className:`p-3 bg-light ${n}`,children:[i.jsx("h6",{className:"mb-3 text-muted",children:"Merge Fields"}),i.jsx("div",{className:"d-grid gap-2",children:o.map(l=>i.jsx(le,{variant:"outline-secondary",size:"sm",className:"text-start d-flex align-items-center",onClick:()=>t(l.name),disabled:r,children:i.jsxs("div",{children:[i.jsx("div",{className:"fw-bold",children:l.label}),i.jsx("small",{className:"text-muted",children:l.name})]})},l.name))}),i.jsxs(tt,{variant:"info",className:"mt-3 mb-0",style:{fontSize:"0.8rem"},children:[i.jsx("strong",{children:"Tip:"})," Click any field to insert it into your document. Merge fields will be replaced with actual data when the form is used."]})]})};var S0,NE;function tde(){if(NE)return S0;NE=1;function e(){this.__data__=[],this.size=0}return S0=e,S0}var T0,EE;function sP(){if(EE)return T0;EE=1;function e(t,r){return t===r||t!==t&&r!==r}return T0=e,T0}var A0,_E;function vf(){if(_E)return A0;_E=1;var e=sP();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return A0=t,A0}var k0,SE;function rde(){if(SE)return k0;SE=1;var e=vf(),t=Array.prototype,r=t.splice;function n(a){var s=this.__data__,o=e(s,a);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return k0=n,k0}var O0,TE;function nde(){if(TE)return O0;TE=1;var e=vf();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return O0=t,O0}var C0,AE;function ade(){if(AE)return C0;AE=1;var e=vf();function t(r){return e(this.__data__,r)>-1}return C0=t,C0}var P0,kE;function sde(){if(kE)return P0;kE=1;var e=vf();function t(r,n){var a=this.__data__,s=e(a,r);return s<0?(++this.size,a.push([r,n])):a[s][1]=n,this}return P0=t,P0}var D0,OE;function gf(){if(OE)return D0;OE=1;var e=tde(),t=rde(),r=nde(),n=ade(),a=sde();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,D0=s,D0}var I0,CE;function ide(){if(CE)return I0;CE=1;var e=gf();function t(){this.__data__=new e,this.size=0}return I0=t,I0}var R0,PE;function ode(){if(PE)return R0;PE=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return R0=e,R0}var F0,DE;function lde(){if(DE)return F0;DE=1;function e(t){return this.__data__.get(t)}return F0=e,F0}var L0,IE;function cde(){if(IE)return L0;IE=1;function e(t){return this.__data__.has(t)}return L0=e,L0}var M0,RE;function iP(){if(RE)return M0;RE=1;var e=typeof kc=="object"&&kc&&kc.Object===Object&&kc;return M0=e,M0}var B0,FE;function gs(){if(FE)return B0;FE=1;var e=iP(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return B0=r,B0}var $0,LE;function Ay(){if(LE)return $0;LE=1;var e=gs(),t=e.Symbol;return $0=t,$0}var z0,ME;function ude(){if(ME)return z0;ME=1;var e=Ay(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function s(o){var l=r.call(o,a),c=o[a];try{o[a]=void 0;var d=!0}catch{}var u=n.call(o);return d&&(l?o[a]=c:delete o[a]),u}return z0=s,z0}var U0,BE;function dde(){if(BE)return U0;BE=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return U0=r,U0}var q0,$E;function xf(){if($E)return q0;$E=1;var e=Ay(),t=ude(),r=dde(),n="[object Null]",a="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?a:n:s&&s in Object(l)?t(l):r(l)}return q0=o,q0}var W0,zE;function oP(){if(zE)return W0;zE=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return W0=e,W0}var H0,UE;function lP(){if(UE)return H0;UE=1;var e=xf(),t=oP(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==n||c==a||c==r||c==s}return H0=o,H0}var V0,qE;function fde(){if(qE)return V0;qE=1;var e=gs(),t=e["__core-js_shared__"];return V0=t,V0}var G0,WE;function hde(){if(WE)return G0;WE=1;var e=fde(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return G0=r,G0}var K0,HE;function cP(){if(HE)return K0;HE=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return K0=r,K0}var Y0,VE;function mde(){if(VE)return Y0;VE=1;var e=lP(),t=hde(),r=oP(),n=cP(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!r(h)||t(h))return!1;var m=e(h)?u:s;return m.test(n(h))}return Y0=f,Y0}var X0,GE;function pde(){if(GE)return X0;GE=1;function e(t,r){return t?.[r]}return X0=e,X0}var Z0,KE;function Lo(){if(KE)return Z0;KE=1;var e=mde(),t=pde();function r(n,a){var s=t(n,a);return e(s)?s:void 0}return Z0=r,Z0}var J0,YE;function ky(){if(YE)return J0;YE=1;var e=Lo(),t=gs(),r=e(t,"Map");return J0=r,J0}var Q0,XE;function yf(){if(XE)return Q0;XE=1;var e=Lo(),t=e(Object,"create");return Q0=t,Q0}var em,ZE;function vde(){if(ZE)return em;ZE=1;var e=yf();function t(){this.__data__=e?e(null):{},this.size=0}return em=t,em}var tm,JE;function gde(){if(JE)return tm;JE=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return tm=e,tm}var rm,QE;function xde(){if(QE)return rm;QE=1;var e=yf(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return n.call(o,s)?o[s]:void 0}return rm=a,rm}var nm,e_;function yde(){if(e_)return nm;e_=1;var e=yf(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var s=this.__data__;return e?s[a]!==void 0:r.call(s,a)}return nm=n,nm}var am,t_;function bde(){if(t_)return am;t_=1;var e=yf(),t="__lodash_hash_undefined__";function r(n,a){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&a===void 0?t:a,this}return am=r,am}var sm,r_;function wde(){if(r_)return sm;r_=1;var e=vde(),t=gde(),r=xde(),n=yde(),a=bde();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,sm=s,sm}var im,n_;function jde(){if(n_)return im;n_=1;var e=wde(),t=gf(),r=ky();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return im=n,im}var om,a_;function Nde(){if(a_)return om;a_=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return om=e,om}var lm,s_;function bf(){if(s_)return lm;s_=1;var e=Nde();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return lm=t,lm}var cm,i_;function Ede(){if(i_)return cm;i_=1;var e=bf();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return cm=t,cm}var um,o_;function _de(){if(o_)return um;o_=1;var e=bf();function t(r){return e(this,r).get(r)}return um=t,um}var dm,l_;function Sde(){if(l_)return dm;l_=1;var e=bf();function t(r){return e(this,r).has(r)}return dm=t,dm}var fm,c_;function Tde(){if(c_)return fm;c_=1;var e=bf();function t(r,n){var a=e(this,r),s=a.size;return a.set(r,n),this.size+=a.size==s?0:1,this}return fm=t,fm}var hm,u_;function uP(){if(u_)return hm;u_=1;var e=jde(),t=Ede(),r=_de(),n=Sde(),a=Tde();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,hm=s,hm}var mm,d_;function Ade(){if(d_)return mm;d_=1;var e=gf(),t=ky(),r=uP(),n=200;function a(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,o),this.size=l.size,this}return mm=a,mm}var pm,f_;function kde(){if(f_)return pm;f_=1;var e=gf(),t=ide(),r=ode(),n=lde(),a=cde(),s=Ade();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,pm=o,pm}var vm,h_;function Ode(){if(h_)return vm;h_=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return vm=t,vm}var gm,m_;function Cde(){if(m_)return gm;m_=1;function e(t){return this.__data__.has(t)}return gm=e,gm}var xm,p_;function Pde(){if(p_)return xm;p_=1;var e=uP(),t=Ode(),r=Cde();function n(a){var s=-1,o=a==null?0:a.length;for(this.__data__=new e;++s<o;)this.add(a[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,xm=n,xm}var ym,v_;function Dde(){if(v_)return ym;v_=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return ym=e,ym}var bm,g_;function Ide(){if(g_)return bm;g_=1;function e(t,r){return t.has(r)}return bm=e,bm}var wm,x_;function dP(){if(x_)return wm;x_=1;var e=Pde(),t=Dde(),r=Ide(),n=1,a=2;function s(o,l,c,d,u,f){var h=c&n,m=o.length,p=l.length;if(m!=p&&!(h&&p>m))return!1;var v=f.get(o),g=f.get(l);if(v&&g)return v==l&&g==o;var x=-1,b=!0,y=c&a?new e:void 0;for(f.set(o,l),f.set(l,o);++x<m;){var w=o[x],j=l[x];if(d)var N=h?d(j,w,x,l,o,f):d(w,j,x,o,l,f);if(N!==void 0){if(N)continue;b=!1;break}if(y){if(!t(l,function(E,S){if(!r(y,S)&&(w===E||u(w,E,c,d,f)))return y.push(S)})){b=!1;break}}else if(!(w===j||u(w,j,c,d,f))){b=!1;break}}return f.delete(o),f.delete(l),b}return wm=s,wm}var jm,y_;function Rde(){if(y_)return jm;y_=1;var e=gs(),t=e.Uint8Array;return jm=t,jm}var Nm,b_;function Fde(){if(b_)return Nm;b_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,s){n[++r]=[s,a]}),n}return Nm=e,Nm}var Em,w_;function Lde(){if(w_)return Em;w_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return Em=e,Em}var _m,j_;function Mde(){if(j_)return _m;j_=1;var e=Ay(),t=Rde(),r=sP(),n=dP(),a=Fde(),s=Lde(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",h="[object Number]",m="[object RegExp]",p="[object Set]",v="[object String]",g="[object Symbol]",x="[object ArrayBuffer]",b="[object DataView]",y=e?e.prototype:void 0,w=y?y.valueOf:void 0;function j(N,E,S,O,k,T,A){switch(S){case b:if(N.byteLength!=E.byteLength||N.byteOffset!=E.byteOffset)return!1;N=N.buffer,E=E.buffer;case x:return!(N.byteLength!=E.byteLength||!T(new t(N),new t(E)));case c:case d:case h:return r(+N,+E);case u:return N.name==E.name&&N.message==E.message;case m:case v:return N==E+"";case f:var P=a;case p:var C=O&o;if(P||(P=s),N.size!=E.size&&!C)return!1;var F=A.get(N);if(F)return F==E;O|=l,A.set(N,E);var M=n(P(N),P(E),O,k,T,A);return A.delete(N),M;case g:if(w)return w.call(N)==w.call(E)}return!1}return _m=j,_m}var Sm,N_;function Bde(){if(N_)return Sm;N_=1;function e(t,r){for(var n=-1,a=r.length,s=t.length;++n<a;)t[s+n]=r[n];return t}return Sm=e,Sm}var Tm,E_;function Oy(){if(E_)return Tm;E_=1;var e=Array.isArray;return Tm=e,Tm}var Am,__;function $de(){if(__)return Am;__=1;var e=Bde(),t=Oy();function r(n,a,s){var o=a(n);return t(n)?o:e(o,s(n))}return Am=r,Am}var km,S_;function zde(){if(S_)return km;S_=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,s=0,o=[];++n<a;){var l=t[n];r(l,n,t)&&(o[s++]=l)}return o}return km=e,km}var Om,T_;function Ude(){if(T_)return Om;T_=1;function e(){return[]}return Om=e,Om}var Cm,A_;function qde(){if(A_)return Cm;A_=1;var e=zde(),t=Ude(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(o){return o==null?[]:(o=Object(o),e(a(o),function(l){return n.call(o,l)}))}:t;return Cm=s,Cm}var Pm,k_;function Wde(){if(k_)return Pm;k_=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return Pm=e,Pm}var Dm,O_;function wf(){if(O_)return Dm;O_=1;function e(t){return t!=null&&typeof t=="object"}return Dm=e,Dm}var Im,C_;function Hde(){if(C_)return Im;C_=1;var e=xf(),t=wf(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return Im=n,Im}var Rm,P_;function Vde(){if(P_)return Rm;P_=1;var e=Hde(),t=wf(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,s=e((function(){return arguments})())?e:function(o){return t(o)&&n.call(o,"callee")&&!a.call(o,"callee")};return Rm=s,Rm}var nl={exports:{}},Fm,D_;function Gde(){if(D_)return Fm;D_=1;function e(){return!1}return Fm=e,Fm}nl.exports;var I_;function fP(){return I_||(I_=1,(function(e,t){var r=gs(),n=Gde(),a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(nl,nl.exports)),nl.exports}var Lm,R_;function Kde(){if(R_)return Lm;R_=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var s=typeof n;return a=a??e,!!a&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return Lm=r,Lm}var Mm,F_;function hP(){if(F_)return Mm;F_=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Mm=t,Mm}var Bm,L_;function Yde(){if(L_)return Bm;L_=1;var e=xf(),t=hP(),r=wf(),n="[object Arguments]",a="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",h="[object RegExp]",m="[object Set]",p="[object String]",v="[object WeakMap]",g="[object ArrayBuffer]",x="[object DataView]",b="[object Float32Array]",y="[object Float64Array]",w="[object Int8Array]",j="[object Int16Array]",N="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",O="[object Uint16Array]",k="[object Uint32Array]",T={};T[b]=T[y]=T[w]=T[j]=T[N]=T[E]=T[S]=T[O]=T[k]=!0,T[n]=T[a]=T[g]=T[s]=T[x]=T[o]=T[l]=T[c]=T[d]=T[u]=T[f]=T[h]=T[m]=T[p]=T[v]=!1;function A(P){return r(P)&&t(P.length)&&!!T[e(P)]}return Bm=A,Bm}var $m,M_;function Xde(){if(M_)return $m;M_=1;function e(t){return function(r){return t(r)}}return $m=e,$m}var al={exports:{}};al.exports;var B_;function Zde(){return B_||(B_=1,(function(e,t){var r=iP(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,o=s&&r.process,l=(function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}})();e.exports=l})(al,al.exports)),al.exports}var zm,$_;function mP(){if($_)return zm;$_=1;var e=Yde(),t=Xde(),r=Zde(),n=r&&r.isTypedArray,a=n?t(n):e;return zm=a,zm}var Um,z_;function Jde(){if(z_)return Um;z_=1;var e=Wde(),t=Vde(),r=Oy(),n=fP(),a=Kde(),s=mP(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=r(d),h=!f&&t(d),m=!f&&!h&&n(d),p=!f&&!h&&!m&&s(d),v=f||h||m||p,g=v?e(d.length,String):[],x=g.length;for(var b in d)(u||l.call(d,b))&&!(v&&(b=="length"||m&&(b=="offset"||b=="parent")||p&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||a(b,x)))&&g.push(b);return g}return Um=c,Um}var qm,U_;function Qde(){if(U_)return qm;U_=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return qm=t,qm}var Wm,q_;function efe(){if(q_)return Wm;q_=1;function e(t,r){return function(n){return t(r(n))}}return Wm=e,Wm}var Hm,W_;function tfe(){if(W_)return Hm;W_=1;var e=efe(),t=e(Object.keys,Object);return Hm=t,Hm}var Vm,H_;function rfe(){if(H_)return Vm;H_=1;var e=Qde(),t=tfe(),r=Object.prototype,n=r.hasOwnProperty;function a(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return Vm=a,Vm}var Gm,V_;function nfe(){if(V_)return Gm;V_=1;var e=lP(),t=hP();function r(n){return n!=null&&t(n.length)&&!e(n)}return Gm=r,Gm}var Km,G_;function afe(){if(G_)return Km;G_=1;var e=Jde(),t=rfe(),r=nfe();function n(a){return r(a)?e(a):t(a)}return Km=n,Km}var Ym,K_;function sfe(){if(K_)return Ym;K_=1;var e=$de(),t=qde(),r=afe();function n(a){return e(a,r,t)}return Ym=n,Ym}var Xm,Y_;function ife(){if(Y_)return Xm;Y_=1;var e=sfe(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(s,o,l,c,d,u){var f=l&t,h=e(s),m=h.length,p=e(o),v=p.length;if(m!=v&&!f)return!1;for(var g=m;g--;){var x=h[g];if(!(f?x in o:n.call(o,x)))return!1}var b=u.get(s),y=u.get(o);if(b&&y)return b==o&&y==s;var w=!0;u.set(s,o),u.set(o,s);for(var j=f;++g<m;){x=h[g];var N=s[x],E=o[x];if(c)var S=f?c(E,N,x,o,s,u):c(N,E,x,s,o,u);if(!(S===void 0?N===E||d(N,E,l,c,u):S)){w=!1;break}j||(j=x=="constructor")}if(w&&!j){var O=s.constructor,k=o.constructor;O!=k&&"constructor"in s&&"constructor"in o&&!(typeof O=="function"&&O instanceof O&&typeof k=="function"&&k instanceof k)&&(w=!1)}return u.delete(s),u.delete(o),w}return Xm=a,Xm}var Zm,X_;function ofe(){if(X_)return Zm;X_=1;var e=Lo(),t=gs(),r=e(t,"DataView");return Zm=r,Zm}var Jm,Z_;function lfe(){if(Z_)return Jm;Z_=1;var e=Lo(),t=gs(),r=e(t,"Promise");return Jm=r,Jm}var Qm,J_;function cfe(){if(J_)return Qm;J_=1;var e=Lo(),t=gs(),r=e(t,"Set");return Qm=r,Qm}var ep,Q_;function ufe(){if(Q_)return ep;Q_=1;var e=Lo(),t=gs(),r=e(t,"WeakMap");return ep=r,ep}var tp,eS;function dfe(){if(eS)return tp;eS=1;var e=ofe(),t=ky(),r=lfe(),n=cfe(),a=ufe(),s=xf(),o=cP(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",h="[object DataView]",m=o(e),p=o(t),v=o(r),g=o(n),x=o(a),b=s;return(e&&b(new e(new ArrayBuffer(1)))!=h||t&&b(new t)!=l||r&&b(r.resolve())!=d||n&&b(new n)!=u||a&&b(new a)!=f)&&(b=function(y){var w=s(y),j=w==c?y.constructor:void 0,N=j?o(j):"";if(N)switch(N){case m:return h;case p:return l;case v:return d;case g:return u;case x:return f}return w}),tp=b,tp}var rp,tS;function ffe(){if(tS)return rp;tS=1;var e=kde(),t=dP(),r=Mde(),n=ife(),a=dfe(),s=Oy(),o=fP(),l=mP(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",h=Object.prototype,m=h.hasOwnProperty;function p(v,g,x,b,y,w){var j=s(v),N=s(g),E=j?u:a(v),S=N?u:a(g);E=E==d?f:E,S=S==d?f:S;var O=E==f,k=S==f,T=E==S;if(T&&o(v)){if(!o(g))return!1;j=!0,O=!1}if(T&&!O)return w||(w=new e),j||l(v)?t(v,g,x,b,y,w):r(v,g,E,x,b,y,w);if(!(x&c)){var A=O&&m.call(v,"__wrapped__"),P=k&&m.call(g,"__wrapped__");if(A||P){var C=A?v.value():v,F=P?g.value():g;return w||(w=new e),y(C,F,x,b,w)}}return T?(w||(w=new e),n(v,g,x,b,y,w)):!1}return rp=p,rp}var np,rS;function hfe(){if(rS)return np;rS=1;var e=ffe(),t=wf();function r(n,a,s,o,l){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,s,o,r,l)}return np=r,np}var ap,nS;function mfe(){if(nS)return ap;nS=1;var e=hfe();function t(r,n){return e(r,n)}return ap=t,ap}var fu={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var pfe=fu.exports,aS;function vfe(){return aS||(aS=1,(function(e,t){(function(n,a){e.exports=a()})(typeof self<"u"?self:pfe,function(){return(function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="",a(a.s=109)})([(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(17),o=a(18),l=a(19),c=a(45),d=a(46),u=a(47),f=a(48),h=a(49),m=a(12),p=a(32),v=a(33),g=a(31),x=a(1),b={Scope:x.Scope,create:x.create,find:x.find,query:x.query,register:x.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:f.default,Scroll:c.default,Block:u.default,Inline:d.default,Text:h.default,Attributor:{Attribute:m.default,Class:p.default,Style:v.default,Store:g.default}};n.default=b}),(function(r,n,a){var s=this&&this.__extends||(function(){var g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,b){x.__proto__=b}||function(x,b){for(var y in b)b.hasOwnProperty(y)&&(x[y]=b[y])};return function(x,b){g(x,b);function y(){this.constructor=x}x.prototype=b===null?Object.create(b):(y.prototype=b.prototype,new y)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=(function(g){s(x,g);function x(b){var y=this;return b="[Parchment] "+b,y=g.call(this,b)||this,y.message=b,y.name=y.constructor.name,y}return x})(Error);n.ParchmentError=o;var l={},c={},d={},u={};n.DATA_KEY="__blot";var f;(function(g){g[g.TYPE=3]="TYPE",g[g.LEVEL=12]="LEVEL",g[g.ATTRIBUTE=13]="ATTRIBUTE",g[g.BLOT=14]="BLOT",g[g.INLINE=7]="INLINE",g[g.BLOCK=11]="BLOCK",g[g.BLOCK_BLOT=10]="BLOCK_BLOT",g[g.INLINE_BLOT=6]="INLINE_BLOT",g[g.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",g[g.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",g[g.ANY=15]="ANY"})(f=n.Scope||(n.Scope={}));function h(g,x){var b=p(g);if(b==null)throw new o("Unable to create "+g+" blot");var y=b,w=g instanceof Node||g.nodeType===Node.TEXT_NODE?g:y.create(x);return new y(w,x)}n.create=h;function m(g,x){return x===void 0&&(x=!1),g==null?null:g[n.DATA_KEY]!=null?g[n.DATA_KEY].blot:x?m(g.parentNode,x):null}n.find=m;function p(g,x){x===void 0&&(x=f.ANY);var b;if(typeof g=="string")b=u[g]||l[g];else if(g instanceof Text||g.nodeType===Node.TEXT_NODE)b=u.text;else if(typeof g=="number")g&f.LEVEL&f.BLOCK?b=u.block:g&f.LEVEL&f.INLINE&&(b=u.inline);else if(g instanceof HTMLElement){var y=(g.getAttribute("class")||"").split(/\s+/);for(var w in y)if(b=c[y[w]],b)break;b=b||d[g.tagName]}return b==null?null:x&f.LEVEL&b.scope&&x&f.TYPE&b.scope?b:null}n.query=p;function v(){for(var g=[],x=0;x<arguments.length;x++)g[x]=arguments[x];if(g.length>1)return g.map(function(w){return v(w)});var b=g[0];if(typeof b.blotName!="string"&&typeof b.attrName!="string")throw new o("Invalid definition");if(b.blotName==="abstract")throw new o("Cannot register abstract class");if(u[b.blotName||b.attrName]=b,typeof b.keyName=="string")l[b.keyName]=b;else if(b.className!=null&&(c[b.className]=b),b.tagName!=null){Array.isArray(b.tagName)?b.tagName=b.tagName.map(function(w){return w.toUpperCase()}):b.tagName=b.tagName.toUpperCase();var y=Array.isArray(b.tagName)?b.tagName:[b.tagName];y.forEach(function(w){(d[w]==null||b.className==null)&&(d[w]=b)})}return b}n.register=v}),(function(r,n,a){var s=a(51),o=a(11),l=a(3),c=a(20),d="\0",u=function(f){Array.isArray(f)?this.ops=f:f!=null&&Array.isArray(f.ops)?this.ops=f.ops:this.ops=[]};u.prototype.insert=function(f,h){var m={};return f.length===0?this:(m.insert=f,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(m.attributes=h),this.push(m))},u.prototype.delete=function(f){return f<=0?this:this.push({delete:f})},u.prototype.retain=function(f,h){if(f<=0)return this;var m={retain:f};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(m.attributes=h),this.push(m)},u.prototype.push=function(f){var h=this.ops.length,m=this.ops[h-1];if(f=l(!0,{},f),typeof m=="object"){if(typeof f.delete=="number"&&typeof m.delete=="number")return this.ops[h-1]={delete:m.delete+f.delete},this;if(typeof m.delete=="number"&&f.insert!=null&&(h-=1,m=this.ops[h-1],typeof m!="object"))return this.ops.unshift(f),this;if(o(f.attributes,m.attributes)){if(typeof f.insert=="string"&&typeof m.insert=="string")return this.ops[h-1]={insert:m.insert+f.insert},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this;if(typeof f.retain=="number"&&typeof m.retain=="number")return this.ops[h-1]={retain:m.retain+f.retain},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this}}return h===this.ops.length?this.ops.push(f):this.ops.splice(h,0,f),this},u.prototype.chop=function(){var f=this.ops[this.ops.length-1];return f&&f.retain&&!f.attributes&&this.ops.pop(),this},u.prototype.filter=function(f){return this.ops.filter(f)},u.prototype.forEach=function(f){this.ops.forEach(f)},u.prototype.map=function(f){return this.ops.map(f)},u.prototype.partition=function(f){var h=[],m=[];return this.forEach(function(p){var v=f(p)?h:m;v.push(p)}),[h,m]},u.prototype.reduce=function(f,h){return this.ops.reduce(f,h)},u.prototype.changeLength=function(){return this.reduce(function(f,h){return h.insert?f+c.length(h):h.delete?f-h.delete:f},0)},u.prototype.length=function(){return this.reduce(function(f,h){return f+c.length(h)},0)},u.prototype.slice=function(f,h){f=f||0,typeof h!="number"&&(h=1/0);for(var m=[],p=c.iterator(this.ops),v=0;v<h&&p.hasNext();){var g;v<f?g=p.next(f-v):(g=p.next(h-v),m.push(g)),v+=c.length(g)}return new u(m)},u.prototype.compose=function(f){var h=c.iterator(this.ops),m=c.iterator(f.ops),p=[],v=m.peek();if(v!=null&&typeof v.retain=="number"&&v.attributes==null){for(var g=v.retain;h.peekType()==="insert"&&h.peekLength()<=g;)g-=h.peekLength(),p.push(h.next());v.retain-g>0&&m.next(v.retain-g)}for(var x=new u(p);h.hasNext()||m.hasNext();)if(m.peekType()==="insert")x.push(m.next());else if(h.peekType()==="delete")x.push(h.next());else{var b=Math.min(h.peekLength(),m.peekLength()),y=h.next(b),w=m.next(b);if(typeof w.retain=="number"){var j={};typeof y.retain=="number"?j.retain=b:j.insert=y.insert;var N=c.attributes.compose(y.attributes,w.attributes,typeof y.retain=="number");if(N&&(j.attributes=N),x.push(j),!m.hasNext()&&o(x.ops[x.ops.length-1],j)){var E=new u(h.rest());return x.concat(E).chop()}}else typeof w.delete=="number"&&typeof y.retain=="number"&&x.push(w)}return x.chop()},u.prototype.concat=function(f){var h=new u(this.ops.slice());return f.ops.length>0&&(h.push(f.ops[0]),h.ops=h.ops.concat(f.ops.slice(1))),h},u.prototype.diff=function(f,h){if(this.ops===f.ops)return new u;var m=[this,f].map(function(b){return b.map(function(y){if(y.insert!=null)return typeof y.insert=="string"?y.insert:d;var w=b===f?"on":"with";throw new Error("diff() called "+w+" non-document")}).join("")}),p=new u,v=s(m[0],m[1],h),g=c.iterator(this.ops),x=c.iterator(f.ops);return v.forEach(function(b){for(var y=b[1].length;y>0;){var w=0;switch(b[0]){case s.INSERT:w=Math.min(x.peekLength(),y),p.push(x.next(w));break;case s.DELETE:w=Math.min(y,g.peekLength()),g.next(w),p.delete(w);break;case s.EQUAL:w=Math.min(g.peekLength(),x.peekLength(),y);var j=g.next(w),N=x.next(w);o(j.insert,N.insert)?p.retain(w,c.attributes.diff(j.attributes,N.attributes)):p.push(N).delete(w);break}y-=w}}),p.chop()},u.prototype.eachLine=function(f,h){h=h||`
`;for(var m=c.iterator(this.ops),p=new u,v=0;m.hasNext();){if(m.peekType()!=="insert")return;var g=m.peek(),x=c.length(g)-m.peekLength(),b=typeof g.insert=="string"?g.insert.indexOf(h,x)-x:-1;if(b<0)p.push(m.next());else if(b>0)p.push(m.next(b));else{if(f(p,m.next(1).attributes||{},v)===!1)return;v+=1,p=new u}}p.length()>0&&f(p,{},v)},u.prototype.transform=function(f,h){if(h=!!h,typeof f=="number")return this.transformPosition(f,h);for(var m=c.iterator(this.ops),p=c.iterator(f.ops),v=new u;m.hasNext()||p.hasNext();)if(m.peekType()==="insert"&&(h||p.peekType()!=="insert"))v.retain(c.length(m.next()));else if(p.peekType()==="insert")v.push(p.next());else{var g=Math.min(m.peekLength(),p.peekLength()),x=m.next(g),b=p.next(g);if(x.delete)continue;b.delete?v.push(b):v.retain(g,c.attributes.transform(x.attributes,b.attributes,h))}return v.chop()},u.prototype.transformPosition=function(f,h){h=!!h;for(var m=c.iterator(this.ops),p=0;m.hasNext()&&p<=f;){var v=m.peekLength(),g=m.peekType();if(m.next(),g==="delete"){f-=Math.min(v,f-p);continue}else g==="insert"&&(p<f||!h)&&(f+=v);p+=v}return f},r.exports=u}),(function(r,n){var a=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,c=function(m){return typeof Array.isArray=="function"?Array.isArray(m):s.call(m)==="[object Array]"},d=function(m){if(!m||s.call(m)!=="[object Object]")return!1;var p=a.call(m,"constructor"),v=m.constructor&&m.constructor.prototype&&a.call(m.constructor.prototype,"isPrototypeOf");if(m.constructor&&!p&&!v)return!1;var g;for(g in m);return typeof g>"u"||a.call(m,g)},u=function(m,p){o&&p.name==="__proto__"?o(m,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):m[p.name]=p.newValue},f=function(m,p){if(p==="__proto__")if(a.call(m,p)){if(l)return l(m,p).value}else return;return m[p]};r.exports=function h(){var m,p,v,g,x,b,y=arguments[0],w=1,j=arguments.length,N=!1;for(typeof y=="boolean"&&(N=y,y=arguments[1]||{},w=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});w<j;++w)if(m=arguments[w],m!=null)for(p in m)v=f(y,p),g=f(m,p),y!==g&&(N&&g&&(d(g)||(x=c(g)))?(x?(x=!1,b=v&&c(v)?v:[]):b=v&&d(v)?v:{},u(y,{name:p,newValue:h(N,b,g)})):typeof g<"u"&&u(y,{name:p,newValue:g}));return y}}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=(function(){function T(A,P){for(var C=0;C<P.length;C++){var F=P[C];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(A,F.key,F)}}return function(A,P,C){return P&&T(A.prototype,P),C&&T(A,C),A}})(),o=function T(A,P,C){A===null&&(A=Function.prototype);var F=Object.getOwnPropertyDescriptor(A,P);if(F===void 0){var M=Object.getPrototypeOf(A);return M===null?void 0:T(M,P,C)}else{if("value"in F)return F.value;var H=F.get;return H===void 0?void 0:H.call(C)}},l=a(3),c=y(l),d=a(2),u=y(d),f=a(0),h=y(f),m=a(16),p=y(m),v=a(6),g=y(v),x=a(7),b=y(x);function y(T){return T&&T.__esModule?T:{default:T}}function w(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}function j(T,A){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:T}function N(T,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);T.prototype=Object.create(A&&A.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(T,A):T.__proto__=A)}var E=1,S=(function(T){N(A,T);function A(){return w(this,A),j(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return s(A,[{key:"attach",value:function(){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"attach",this).call(this),this.attributes=new h.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new u.default().insert(this.value(),(0,c.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(C,F){var M=h.default.query(C,h.default.Scope.BLOCK_ATTRIBUTE);M!=null&&this.attributes.attribute(M,F)}},{key:"formatAt",value:function(C,F,M,H){this.format(M,H)}},{key:"insertAt",value:function(C,F,M){if(typeof F=="string"&&F.endsWith(`
`)){var H=h.default.create(O.blotName);this.parent.insertBefore(H,C===0?this:this.next),H.insertAt(0,F.slice(0,-1))}else o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertAt",this).call(this,C,F,M)}}]),A})(h.default.Embed);S.scope=h.default.Scope.BLOCK_BLOT;var O=(function(T){N(A,T);function A(P){w(this,A);var C=j(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,P));return C.cache={},C}return s(A,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(h.default.Leaf).reduce(function(C,F){return F.length()===0?C:C.insert(F.value(),k(F))},new u.default).insert(`
`,k(this))),this.cache.delta}},{key:"deleteAt",value:function(C,F){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"deleteAt",this).call(this,C,F),this.cache={}}},{key:"formatAt",value:function(C,F,M,H){F<=0||(h.default.query(M,h.default.Scope.BLOCK)?C+F===this.length()&&this.format(M,H):o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"formatAt",this).call(this,C,Math.min(F,this.length()-C-1),M,H),this.cache={})}},{key:"insertAt",value:function(C,F,M){if(M!=null)return o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertAt",this).call(this,C,F,M);if(F.length!==0){var H=F.split(`
`),V=H.shift();V.length>0&&(C<this.length()-1||this.children.tail==null?o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertAt",this).call(this,Math.min(C,this.length()-1),V):this.children.tail.insertAt(this.children.tail.length(),V),this.cache={});var B=this;H.reduce(function(W,z){return B=B.split(W,!0),B.insertAt(0,z),z.length},C+V.length)}}},{key:"insertBefore",value:function(C,F){var M=this.children.head;o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertBefore",this).call(this,C,F),M instanceof p.default&&M.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"length",this).call(this)+E),this.cache.length}},{key:"moveChildren",value:function(C,F){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"moveChildren",this).call(this,C,F),this.cache={}}},{key:"optimize",value:function(C){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"optimize",this).call(this,C),this.cache={}}},{key:"path",value:function(C){return o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"path",this).call(this,C,!0)}},{key:"removeChild",value:function(C){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"removeChild",this).call(this,C),this.cache={}}},{key:"split",value:function(C){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F&&(C===0||C>=this.length()-E)){var M=this.clone();return C===0?(this.parent.insertBefore(M,this),this):(this.parent.insertBefore(M,this.next),M)}else{var H=o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"split",this).call(this,C,F);return this.cache={},H}}}]),A})(h.default.Block);O.blotName="block",O.tagName="P",O.defaultChild="break",O.allowedChildren=[g.default,h.default.Embed,b.default];function k(T){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return T==null||(typeof T.formats=="function"&&(A=(0,c.default)(A,T.formats())),T.parent==null||T.parent.blotName=="scroll"||T.parent.statics.scope!==T.statics.scope)?A:k(T.parent,A)}n.bubbleFormats=k,n.BlockEmbed=S,n.default=O}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},o=(function(){function B(W,z){var D=[],L=!0,q=!1,I=void 0;try{for(var R=W[Symbol.iterator](),X;!(L=(X=R.next()).done)&&(D.push(X.value),!(z&&D.length===z));L=!0);}catch(ae){q=!0,I=ae}finally{try{!L&&R.return&&R.return()}finally{if(q)throw I}}return D}return function(W,z){if(Array.isArray(W))return W;if(Symbol.iterator in Object(W))return B(W,z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function B(W,z){for(var D=0;D<z.length;D++){var L=z[D];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(W,L.key,L)}}return function(W,z,D){return z&&B(W.prototype,z),D&&B(W,D),W}})();a(50);var c=a(2),d=k(c),u=a(14),f=k(u),h=a(8),m=k(h),p=a(9),v=k(p),g=a(0),x=k(g),b=a(15),y=k(b),w=a(3),j=k(w),N=a(10),E=k(N),S=a(34),O=k(S);function k(B){return B&&B.__esModule?B:{default:B}}function T(B,W,z){return W in B?Object.defineProperty(B,W,{value:z,enumerable:!0,configurable:!0,writable:!0}):B[W]=z,B}function A(B,W){if(!(B instanceof W))throw new TypeError("Cannot call a class as a function")}var P=(0,E.default)("quill"),C=(function(){l(B,null,[{key:"debug",value:function(z){z===!0&&(z="log"),E.default.level(z)}},{key:"find",value:function(z){return z.__quill||x.default.find(z)}},{key:"import",value:function(z){return this.imports[z]==null&&P.error("Cannot import "+z+". Are you sure it was registered?"),this.imports[z]}},{key:"register",value:function(z,D){var L=this,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof z!="string"){var I=z.attrName||z.blotName;typeof I=="string"?this.register("formats/"+I,z,D):Object.keys(z).forEach(function(R){L.register(R,z[R],D)})}else this.imports[z]!=null&&!q&&P.warn("Overwriting "+z+" with",D),this.imports[z]=D,(z.startsWith("blots/")||z.startsWith("formats/"))&&D.blotName!=="abstract"?x.default.register(D):z.startsWith("modules")&&typeof D.register=="function"&&D.register()}}]);function B(W){var z=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(A(this,B),this.options=F(W,D),this.container=this.options.container,this.container==null)return P.error("Invalid Quill container",W);this.options.debug&&B.debug(this.options.debug);var L=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new m.default,this.scroll=x.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new f.default(this.scroll),this.selection=new y.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(m.default.events.EDITOR_CHANGE,function(I){I===m.default.events.TEXT_CHANGE&&z.root.classList.toggle("ql-blank",z.editor.isBlank())}),this.emitter.on(m.default.events.SCROLL_UPDATE,function(I,R){var X=z.selection.lastRange,ae=X&&X.length===0?X.index:void 0;M.call(z,function(){return z.editor.update(null,R,ae)},I)});var q=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+L+"<p><br></p></div>");this.setContents(q),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(B,[{key:"addContainer",value:function(z){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof z=="string"){var L=z;z=document.createElement("div"),z.classList.add(L)}return this.container.insertBefore(z,D),z}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(z,D,L){var q=this,I=H(z,D,L),R=o(I,4);return z=R[0],D=R[1],L=R[3],M.call(this,function(){return q.editor.deleteText(z,D)},L,z,-1*D)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(z),this.container.classList.toggle("ql-disabled",!z)}},{key:"focus",value:function(){var z=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=z,this.scrollIntoView()}},{key:"format",value:function(z,D){var L=this,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.default.sources.API;return M.call(this,function(){var I=L.getSelection(!0),R=new d.default;if(I==null)return R;if(x.default.query(z,x.default.Scope.BLOCK))R=L.editor.formatLine(I.index,I.length,T({},z,D));else{if(I.length===0)return L.selection.format(z,D),R;R=L.editor.formatText(I.index,I.length,T({},z,D))}return L.setSelection(I,m.default.sources.SILENT),R},q)}},{key:"formatLine",value:function(z,D,L,q,I){var R=this,X=void 0,ae=H(z,D,L,q,I),Z=o(ae,4);return z=Z[0],D=Z[1],X=Z[2],I=Z[3],M.call(this,function(){return R.editor.formatLine(z,D,X)},I,z,0)}},{key:"formatText",value:function(z,D,L,q,I){var R=this,X=void 0,ae=H(z,D,L,q,I),Z=o(ae,4);return z=Z[0],D=Z[1],X=Z[2],I=Z[3],M.call(this,function(){return R.editor.formatText(z,D,X)},I,z,0)}},{key:"getBounds",value:function(z){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=void 0;typeof z=="number"?L=this.selection.getBounds(z,D):L=this.selection.getBounds(z.index,z.length);var q=this.container.getBoundingClientRect();return{bottom:L.bottom-q.top,height:L.height,left:L.left-q.left,right:L.right-q.left,top:L.top-q.top,width:L.width}}},{key:"getContents",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-z,L=H(z,D),q=o(L,2);return z=q[0],D=q[1],this.editor.getContents(z,D)}},{key:"getFormat",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof z=="number"?this.editor.getFormat(z,D):this.editor.getFormat(z.index,z.length)}},{key:"getIndex",value:function(z){return z.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(z){return this.scroll.leaf(z)}},{key:"getLine",value:function(z){return this.scroll.line(z)}},{key:"getLines",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof z!="number"?this.scroll.lines(z.index,z.length):this.scroll.lines(z,D)}},{key:"getModule",value:function(z){return this.theme.modules[z]}},{key:"getSelection",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return z&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-z,L=H(z,D),q=o(L,2);return z=q[0],D=q[1],this.editor.getText(z,D)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(z,D,L){var q=this,I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:B.sources.API;return M.call(this,function(){return q.editor.insertEmbed(z,D,L)},I,z)}},{key:"insertText",value:function(z,D,L,q,I){var R=this,X=void 0,ae=H(z,0,L,q,I),Z=o(ae,4);return z=Z[0],X=Z[2],I=Z[3],M.call(this,function(){return R.editor.insertText(z,D,X)},I,z,D.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(z,D,L){this.clipboard.dangerouslyPasteHTML(z,D,L)}},{key:"removeFormat",value:function(z,D,L){var q=this,I=H(z,D,L),R=o(I,4);return z=R[0],D=R[1],L=R[3],M.call(this,function(){return q.editor.removeFormat(z,D)},L,z)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(z){var D=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API;return M.call(this,function(){z=new d.default(z);var q=D.getLength(),I=D.editor.deleteText(0,q),R=D.editor.applyDelta(z),X=R.ops[R.ops.length-1];X!=null&&typeof X.insert=="string"&&X.insert[X.insert.length-1]===`
`&&(D.editor.deleteText(D.getLength()-1,1),R.delete(1));var ae=I.compose(R);return ae},L)}},{key:"setSelection",value:function(z,D,L){if(z==null)this.selection.setRange(null,D||B.sources.API);else{var q=H(z,D,L),I=o(q,4);z=I[0],D=I[1],L=I[3],this.selection.setRange(new b.Range(z,D),L),L!==m.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(z){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API,L=new d.default().insert(z);return this.setContents(L,D)}},{key:"update",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m.default.sources.USER,D=this.scroll.update(z);return this.selection.update(z),D}},{key:"updateContents",value:function(z){var D=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API;return M.call(this,function(){return z=new d.default(z),D.editor.applyDelta(z,L)},L,!0)}}]),B})();C.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},C.events=m.default.events,C.sources=m.default.sources,C.version="1.3.7",C.imports={delta:d.default,parchment:x.default,"core/module":v.default,"core/theme":O.default};function F(B,W){if(W=(0,j.default)(!0,{container:B,modules:{clipboard:!0,keyboard:!0,history:!0}},W),!W.theme||W.theme===C.DEFAULTS.theme)W.theme=O.default;else if(W.theme=C.import("themes/"+W.theme),W.theme==null)throw new Error("Invalid theme "+W.theme+". Did you register it?");var z=(0,j.default)(!0,{},W.theme.DEFAULTS);[z,W].forEach(function(q){q.modules=q.modules||{},Object.keys(q.modules).forEach(function(I){q.modules[I]===!0&&(q.modules[I]={})})});var D=Object.keys(z.modules).concat(Object.keys(W.modules)),L=D.reduce(function(q,I){var R=C.import("modules/"+I);return R==null?P.error("Cannot load "+I+" module. Are you sure you registered it?"):q[I]=R.DEFAULTS||{},q},{});return W.modules!=null&&W.modules.toolbar&&W.modules.toolbar.constructor!==Object&&(W.modules.toolbar={container:W.modules.toolbar}),W=(0,j.default)(!0,{},C.DEFAULTS,{modules:L},z,W),["bounds","container","scrollingContainer"].forEach(function(q){typeof W[q]=="string"&&(W[q]=document.querySelector(W[q]))}),W.modules=Object.keys(W.modules).reduce(function(q,I){return W.modules[I]&&(q[I]=W.modules[I]),q},{}),W}function M(B,W,z,D){if(this.options.strict&&!this.isEnabled()&&W===m.default.sources.USER)return new d.default;var L=z==null?null:this.getSelection(),q=this.editor.delta,I=B();if(L!=null&&(z===!0&&(z=L.index),D==null?L=V(L,I,W):D!==0&&(L=V(L,z,D,W)),this.setSelection(L,m.default.sources.SILENT)),I.length()>0){var R,X=[m.default.events.TEXT_CHANGE,I,q,W];if((R=this.emitter).emit.apply(R,[m.default.events.EDITOR_CHANGE].concat(X)),W!==m.default.sources.SILENT){var ae;(ae=this.emitter).emit.apply(ae,X)}}return I}function H(B,W,z,D,L){var q={};return typeof B.index=="number"&&typeof B.length=="number"?typeof W!="number"?(L=D,D=z,z=W,W=B.length,B=B.index):(W=B.length,B=B.index):typeof W!="number"&&(L=D,D=z,z=W,W=0),(typeof z>"u"?"undefined":s(z))==="object"?(q=z,L=D):typeof z=="string"&&(D!=null?q[z]=D:L=z),L=L||m.default.sources.API,[B,W,q,L]}function V(B,W,z,D){if(B==null)return null;var L=void 0,q=void 0;if(W instanceof d.default){var I=[B.index,B.index+B.length].map(function(Z){return W.transformPosition(Z,D!==m.default.sources.USER)}),R=o(I,2);L=R[0],q=R[1]}else{var X=[B.index,B.index+B.length].map(function(Z){return Z<W||Z===W&&D===m.default.sources.USER?Z:z>=0?Z+z:Math.max(W,Z+z)}),ae=o(X,2);L=ae[0],q=ae[1]}return new b.Range(L,q-L)}n.expandConfig=F,n.overload=H,n.default=C}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function g(x,b){for(var y=0;y<b.length;y++){var w=b[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}return function(x,b,y){return b&&g(x.prototype,b),y&&g(x,y),x}})(),o=function g(x,b,y){x===null&&(x=Function.prototype);var w=Object.getOwnPropertyDescriptor(x,b);if(w===void 0){var j=Object.getPrototypeOf(x);return j===null?void 0:g(j,b,y)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(y)}},l=a(7),c=f(l),d=a(0),u=f(d);function f(g){return g&&g.__esModule?g:{default:g}}function h(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function m(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function p(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var v=(function(g){p(x,g);function x(){return h(this,x),m(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"formatAt",value:function(y,w,j,N){if(x.compare(this.statics.blotName,j)<0&&u.default.query(j,u.default.Scope.BLOT)){var E=this.isolate(y,w);N&&E.wrap(j,N)}else o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"formatAt",this).call(this,y,w,j,N)}},{key:"optimize",value:function(y){if(o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,y),this.parent instanceof x&&x.compare(this.statics.blotName,this.parent.statics.blotName)>0){var w=this.parent.isolate(this.offset(),this.length());this.moveChildren(w),w.wrap(this)}}}],[{key:"compare",value:function(y,w){var j=x.order.indexOf(y),N=x.order.indexOf(w);return j>=0||N>=0?j-N:y===w?0:y<w?-1:1}}]),x})(u.default.Inline);v.allowedChildren=[v,u.default.Embed,c.default],v.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=v}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function d(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function u(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=(function(h){u(m,h);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m})(o.default.Text);n.default=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function b(y,w){for(var j=0;j<w.length;j++){var N=w[j];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(y,N.key,N)}}return function(y,w,j){return w&&b(y.prototype,w),j&&b(y,j),y}})(),o=function b(y,w,j){y===null&&(y=Function.prototype);var N=Object.getOwnPropertyDescriptor(y,w);if(N===void 0){var E=Object.getPrototypeOf(y);return E===null?void 0:b(E,w,j)}else{if("value"in N)return N.value;var S=N.get;return S===void 0?void 0:S.call(j)}},l=a(54),c=f(l),d=a(10),u=f(d);function f(b){return b&&b.__esModule?b:{default:b}}function h(b,y){if(!(b instanceof y))throw new TypeError("Cannot call a class as a function")}function m(b,y){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:b}function p(b,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);b.prototype=Object.create(y&&y.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(b,y):b.__proto__=y)}var v=(0,u.default)("quill:events"),g=["selectionchange","mousedown","mouseup","click"];g.forEach(function(b){document.addEventListener(b,function(){for(var y=arguments.length,w=Array(y),j=0;j<y;j++)w[j]=arguments[j];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(N){if(N.__quill&&N.__quill.emitter){var E;(E=N.__quill.emitter).handleDOM.apply(E,w)}})})});var x=(function(b){p(y,b);function y(){h(this,y);var w=m(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return w.listeners={},w.on("error",v.error),w}return s(y,[{key:"emit",value:function(){v.log.apply(v,arguments),o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(j){for(var N=arguments.length,E=Array(N>1?N-1:0),S=1;S<N;S++)E[S-1]=arguments[S];(this.listeners[j.type]||[]).forEach(function(O){var k=O.node,T=O.handler;(j.target===k||k.contains(j.target))&&T.apply(void 0,[j].concat(E))})}},{key:"listenDOM",value:function(j,N,E){this.listeners[j]||(this.listeners[j]=[]),this.listeners[j].push({node:N,handler:E})}}]),y})(c.default);x.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},x.sources={API:"api",SILENT:"silent",USER:"user"},n.default=x}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});function s(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function l(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=c,this.options=d};o.DEFAULTS={},n.default=o}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(d){if(s.indexOf(d)<=s.indexOf(o)){for(var u,f=arguments.length,h=Array(f>1?f-1:0),m=1;m<f;m++)h[m-1]=arguments[m];(u=console)[d].apply(u,h)}}function c(d){return s.reduce(function(u,f){return u[f]=l.bind(console,f,d),u},{})}l.level=c.level=function(d){o=d},n.default=c}),(function(r,n,a){var s=Array.prototype.slice,o=a(52),l=a(53),c=r.exports=function(h,m,p){return p||(p={}),h===m?!0:h instanceof Date&&m instanceof Date?h.getTime()===m.getTime():!h||!m||typeof h!="object"&&typeof m!="object"?p.strict?h===m:h==m:f(h,m,p)};function d(h){return h==null}function u(h){return!(!h||typeof h!="object"||typeof h.length!="number"||typeof h.copy!="function"||typeof h.slice!="function"||h.length>0&&typeof h[0]!="number")}function f(h,m,p){var v,g;if(d(h)||d(m)||h.prototype!==m.prototype)return!1;if(l(h))return l(m)?(h=s.call(h),m=s.call(m),c(h,m,p)):!1;if(u(h)){if(!u(m)||h.length!==m.length)return!1;for(v=0;v<h.length;v++)if(h[v]!==m[v])return!1;return!0}try{var x=o(h),b=o(m)}catch{return!1}if(x.length!=b.length)return!1;for(x.sort(),b.sort(),v=x.length-1;v>=0;v--)if(x[v]!=b[v])return!1;for(v=x.length-1;v>=0;v--)if(g=x[v],!c(h[g],m[g],p))return!1;return typeof h==typeof m}}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(1),o=(function(){function l(c,d,u){u===void 0&&(u={}),this.attrName=c,this.keyName=d;var f=s.Scope.TYPE&s.Scope.ATTRIBUTE;u.scope!=null?this.scope=u.scope&s.Scope.LEVEL|f:this.scope=s.Scope.ATTRIBUTE,u.whitelist!=null&&(this.whitelist=u.whitelist)}return l.keys=function(c){return[].map.call(c.attributes,function(d){return d.name})},l.prototype.add=function(c,d){return this.canAdd(c,d)?(c.setAttribute(this.keyName,d),!0):!1},l.prototype.canAdd=function(c,d){var u=s.query(c,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return u==null?!1:this.whitelist==null?!0:typeof d=="string"?this.whitelist.indexOf(d.replace(/["']/g,""))>-1:this.whitelist.indexOf(d)>-1},l.prototype.remove=function(c){c.removeAttribute(this.keyName)},l.prototype.value=function(c){var d=c.getAttribute(this.keyName);return this.canAdd(c,d)&&d?d:""},l})();n.default=o}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=(function(){function S(O,k){var T=[],A=!0,P=!1,C=void 0;try{for(var F=O[Symbol.iterator](),M;!(A=(M=F.next()).done)&&(T.push(M.value),!(k&&T.length===k));A=!0);}catch(H){P=!0,C=H}finally{try{!A&&F.return&&F.return()}finally{if(P)throw C}}return T}return function(O,k){if(Array.isArray(O))return O;if(Symbol.iterator in Object(O))return S(O,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function S(O,k){for(var T=0;T<k.length;T++){var A=k[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(O,A.key,A)}}return function(O,k,T){return k&&S(O.prototype,k),T&&S(O,T),O}})(),l=function S(O,k,T){O===null&&(O=Function.prototype);var A=Object.getOwnPropertyDescriptor(O,k);if(A===void 0){var P=Object.getPrototypeOf(O);return P===null?void 0:S(P,k,T)}else{if("value"in A)return A.value;var C=A.get;return C===void 0?void 0:C.call(T)}},c=a(2),d=b(c),u=a(0),f=b(u),h=a(4),m=b(h),p=a(6),v=b(p),g=a(7),x=b(g);function b(S){return S&&S.__esModule?S:{default:S}}function y(S,O){if(!(S instanceof O))throw new TypeError("Cannot call a class as a function")}function w(S,O){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:S}function j(S,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);S.prototype=Object.create(O&&O.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(S,O):S.__proto__=O)}var N=(function(S){j(O,S);function O(){return y(this,O),w(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return O})(v.default);N.blotName="code",N.tagName="CODE";var E=(function(S){j(O,S);function O(){return y(this,O),w(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return o(O,[{key:"delta",value:function(){var T=this,A=this.domNode.textContent;return A.endsWith(`
`)&&(A=A.slice(0,-1)),A.split(`
`).reduce(function(P,C){return P.insert(C).insert(`
`,T.formats())},new d.default)}},{key:"format",value:function(T,A){if(!(T===this.statics.blotName&&A)){var P=this.descendant(x.default,this.length()-1),C=s(P,1),F=C[0];F?.deleteAt(F.length()-1,1),l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"format",this).call(this,T,A)}}},{key:"formatAt",value:function(T,A,P,C){if(A!==0&&!(f.default.query(P,f.default.Scope.BLOCK)==null||P===this.statics.blotName&&C===this.statics.formats(this.domNode))){var F=this.newlineIndex(T);if(!(F<0||F>=T+A)){var M=this.newlineIndex(T,!0)+1,H=F-M+1,V=this.isolate(M,H),B=V.next;V.format(P,C),B instanceof O&&B.formatAt(0,T-M+A-H,P,C)}}}},{key:"insertAt",value:function(T,A,P){if(P==null){var C=this.descendant(x.default,T),F=s(C,2),M=F[0],H=F[1];M.insertAt(H,A)}}},{key:"length",value:function(){var T=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?T:T+1}},{key:"newlineIndex",value:function(T){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(A)return this.domNode.textContent.slice(0,T).lastIndexOf(`
`);var P=this.domNode.textContent.slice(T).indexOf(`
`);return P>-1?T+P:-1}},{key:"optimize",value:function(T){this.domNode.textContent.endsWith(`
`)||this.appendChild(f.default.create("text",`
`)),l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,T);var A=this.next;A!=null&&A.prev===this&&A.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===A.statics.formats(A.domNode)&&(A.optimize(T),A.moveChildren(this),A.remove())}},{key:"replace",value:function(T){l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replace",this).call(this,T),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(A){var P=f.default.find(A);P==null?A.parentNode.removeChild(A):P instanceof f.default.Embed?P.remove():P.unwrap()})}}],[{key:"create",value:function(T){var A=l(O.__proto__||Object.getPrototypeOf(O),"create",this).call(this,T);return A.setAttribute("spellcheck",!1),A}},{key:"formats",value:function(){return!0}}]),O})(m.default);E.blotName="code-block",E.tagName="PRE",E.TAB="  ",n.Code=N,n.default=E}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},o=(function(){function B(W,z){var D=[],L=!0,q=!1,I=void 0;try{for(var R=W[Symbol.iterator](),X;!(L=(X=R.next()).done)&&(D.push(X.value),!(z&&D.length===z));L=!0);}catch(ae){q=!0,I=ae}finally{try{!L&&R.return&&R.return()}finally{if(q)throw I}}return D}return function(W,z){if(Array.isArray(W))return W;if(Symbol.iterator in Object(W))return B(W,z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function B(W,z){for(var D=0;D<z.length;D++){var L=z[D];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(W,L.key,L)}}return function(W,z,D){return z&&B(W.prototype,z),D&&B(W,D),W}})(),c=a(2),d=A(c),u=a(20),f=A(u),h=a(0),m=A(h),p=a(13),v=A(p),g=a(24),x=A(g),b=a(4),y=A(b),w=a(16),j=A(w),N=a(21),E=A(N),S=a(11),O=A(S),k=a(3),T=A(k);function A(B){return B&&B.__esModule?B:{default:B}}function P(B,W,z){return W in B?Object.defineProperty(B,W,{value:z,enumerable:!0,configurable:!0,writable:!0}):B[W]=z,B}function C(B,W){if(!(B instanceof W))throw new TypeError("Cannot call a class as a function")}var F=/^[ -~]*$/,M=(function(){function B(W){C(this,B),this.scroll=W,this.delta=this.getDelta()}return l(B,[{key:"applyDelta",value:function(z){var D=this,L=!1;this.scroll.update();var q=this.scroll.length();return this.scroll.batchStart(),z=V(z),z.reduce(function(I,R){var X=R.retain||R.delete||R.insert.length||1,ae=R.attributes||{};if(R.insert!=null){if(typeof R.insert=="string"){var Z=R.insert;Z.endsWith(`
`)&&L&&(L=!1,Z=Z.slice(0,-1)),I>=q&&!Z.endsWith(`
`)&&(L=!0),D.scroll.insertAt(I,Z);var ee=D.scroll.line(I),ie=o(ee,2),U=ie[0],be=ie[1],Se=(0,T.default)({},(0,b.bubbleFormats)(U));if(U instanceof y.default){var Re=U.descendant(m.default.Leaf,be),Le=o(Re,1),_e=Le[0];Se=(0,T.default)(Se,(0,b.bubbleFormats)(_e))}ae=f.default.attributes.diff(Se,ae)||{}}else if(s(R.insert)==="object"){var he=Object.keys(R.insert)[0];if(he==null)return I;D.scroll.insertAt(I,he,R.insert[he])}q+=X}return Object.keys(ae).forEach(function(ue){D.scroll.formatAt(I,X,ue,ae[ue])}),I+X},0),z.reduce(function(I,R){return typeof R.delete=="number"?(D.scroll.deleteAt(I,R.delete),I):I+(R.retain||R.insert.length||1)},0),this.scroll.batchEnd(),this.update(z)}},{key:"deleteText",value:function(z,D){return this.scroll.deleteAt(z,D),this.update(new d.default().retain(z).delete(D))}},{key:"formatLine",value:function(z,D){var L=this,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(q).forEach(function(I){if(!(L.scroll.whitelist!=null&&!L.scroll.whitelist[I])){var R=L.scroll.lines(z,Math.max(D,1)),X=D;R.forEach(function(ae){var Z=ae.length();if(!(ae instanceof v.default))ae.format(I,q[I]);else{var ee=z-ae.offset(L.scroll),ie=ae.newlineIndex(ee+X)-ee+1;ae.formatAt(ee,ie,I,q[I])}X-=Z})}}),this.scroll.optimize(),this.update(new d.default().retain(z).retain(D,(0,E.default)(q)))}},{key:"formatText",value:function(z,D){var L=this,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(q).forEach(function(I){L.scroll.formatAt(z,D,I,q[I])}),this.update(new d.default().retain(z).retain(D,(0,E.default)(q)))}},{key:"getContents",value:function(z,D){return this.delta.slice(z,z+D)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(z,D){return z.concat(D.delta())},new d.default)}},{key:"getFormat",value:function(z){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=[],q=[];D===0?this.scroll.path(z).forEach(function(R){var X=o(R,1),ae=X[0];ae instanceof y.default?L.push(ae):ae instanceof m.default.Leaf&&q.push(ae)}):(L=this.scroll.lines(z,D),q=this.scroll.descendants(m.default.Leaf,z,D));var I=[L,q].map(function(R){if(R.length===0)return{};for(var X=(0,b.bubbleFormats)(R.shift());Object.keys(X).length>0;){var ae=R.shift();if(ae==null)return X;X=H((0,b.bubbleFormats)(ae),X)}return X});return T.default.apply(T.default,I)}},{key:"getText",value:function(z,D){return this.getContents(z,D).filter(function(L){return typeof L.insert=="string"}).map(function(L){return L.insert}).join("")}},{key:"insertEmbed",value:function(z,D,L){return this.scroll.insertAt(z,D,L),this.update(new d.default().retain(z).insert(P({},D,L)))}},{key:"insertText",value:function(z,D){var L=this,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return D=D.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(z,D),Object.keys(q).forEach(function(I){L.scroll.formatAt(z,D.length,I,q[I])}),this.update(new d.default().retain(z).insert(D,(0,E.default)(q)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var z=this.scroll.children.head;return z.statics.blotName!==y.default.blotName||z.children.length>1?!1:z.children.head instanceof j.default}},{key:"removeFormat",value:function(z,D){var L=this.getText(z,D),q=this.scroll.line(z+D),I=o(q,2),R=I[0],X=I[1],ae=0,Z=new d.default;R!=null&&(R instanceof v.default?ae=R.newlineIndex(X)-X+1:ae=R.length()-X,Z=R.delta().slice(X,X+ae-1).insert(`
`));var ee=this.getContents(z,D+ae),ie=ee.diff(new d.default().insert(L).concat(Z)),U=new d.default().retain(z).concat(ie);return this.applyDelta(U)}},{key:"update",value:function(z){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,q=this.delta;if(D.length===1&&D[0].type==="characterData"&&D[0].target.data.match(F)&&m.default.find(D[0].target)){var I=m.default.find(D[0].target),R=(0,b.bubbleFormats)(I),X=I.offset(this.scroll),ae=D[0].oldValue.replace(x.default.CONTENTS,""),Z=new d.default().insert(ae),ee=new d.default().insert(I.value()),ie=new d.default().retain(X).concat(Z.diff(ee,L));z=ie.reduce(function(U,be){return be.insert?U.insert(be.insert,R):U.push(be)},new d.default),this.delta=q.compose(z)}else this.delta=this.getDelta(),(!z||!(0,O.default)(q.compose(z),this.delta))&&(z=q.diff(this.delta,L));return z}}]),B})();function H(B,W){return Object.keys(W).reduce(function(z,D){return B[D]==null||(W[D]===B[D]?z[D]=W[D]:Array.isArray(W[D])?W[D].indexOf(B[D])<0&&(z[D]=W[D].concat([B[D]])):z[D]=[W[D],B[D]]),z},{})}function V(B){return B.reduce(function(W,z){if(z.insert===1){var D=(0,E.default)(z.attributes);return delete D.image,W.insert({image:z.attributes.image},D)}if(z.attributes!=null&&(z.attributes.list===!0||z.attributes.bullet===!0)&&(z=(0,E.default)(z),z.attributes.list?z.attributes.list="ordered":(z.attributes.list="bullet",delete z.attributes.bullet)),typeof z.insert=="string"){var L=z.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return W.insert(L,z.attributes)}return W.push(z)},new d.default)}n.default=M}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=(function(){function S(O,k){var T=[],A=!0,P=!1,C=void 0;try{for(var F=O[Symbol.iterator](),M;!(A=(M=F.next()).done)&&(T.push(M.value),!(k&&T.length===k));A=!0);}catch(H){P=!0,C=H}finally{try{!A&&F.return&&F.return()}finally{if(P)throw C}}return T}return function(O,k){if(Array.isArray(O))return O;if(Symbol.iterator in Object(O))return S(O,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function S(O,k){for(var T=0;T<k.length;T++){var A=k[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(O,A.key,A)}}return function(O,k,T){return k&&S(O.prototype,k),T&&S(O,T),O}})(),l=a(0),c=x(l),d=a(21),u=x(d),f=a(11),h=x(f),m=a(8),p=x(m),v=a(10),g=x(v);function x(S){return S&&S.__esModule?S:{default:S}}function b(S){if(Array.isArray(S)){for(var O=0,k=Array(S.length);O<S.length;O++)k[O]=S[O];return k}else return Array.from(S)}function y(S,O){if(!(S instanceof O))throw new TypeError("Cannot call a class as a function")}var w=(0,g.default)("quill:selection"),j=function S(O){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;y(this,S),this.index=O,this.length=k},N=(function(){function S(O,k){var T=this;y(this,S),this.emitter=k,this.scroll=O,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=c.default.create("cursor",this),this.lastRange=this.savedRange=new j(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){T.mouseDown||setTimeout(T.update.bind(T,p.default.sources.USER),1)}),this.emitter.on(p.default.events.EDITOR_CHANGE,function(A,P){A===p.default.events.TEXT_CHANGE&&P.length()>0&&T.update(p.default.sources.SILENT)}),this.emitter.on(p.default.events.SCROLL_BEFORE_UPDATE,function(){if(T.hasFocus()){var A=T.getNativeRange();A!=null&&A.start.node!==T.cursor.textNode&&T.emitter.once(p.default.events.SCROLL_UPDATE,function(){try{T.setNativeRange(A.start.node,A.start.offset,A.end.node,A.end.offset)}catch{}})}}),this.emitter.on(p.default.events.SCROLL_OPTIMIZE,function(A,P){if(P.range){var C=P.range,F=C.startNode,M=C.startOffset,H=C.endNode,V=C.endOffset;T.setNativeRange(F,M,H,V)}}),this.update(p.default.sources.SILENT)}return o(S,[{key:"handleComposition",value:function(){var k=this;this.root.addEventListener("compositionstart",function(){k.composing=!0}),this.root.addEventListener("compositionend",function(){if(k.composing=!1,k.cursor.parent){var T=k.cursor.restore();if(!T)return;setTimeout(function(){k.setNativeRange(T.startNode,T.startOffset,T.endNode,T.endOffset)},1)}})}},{key:"handleDragging",value:function(){var k=this;this.emitter.listenDOM("mousedown",document.body,function(){k.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){k.mouseDown=!1,k.update(p.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(k,T){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[k])){this.scroll.update();var A=this.getNativeRange();if(!(A==null||!A.native.collapsed||c.default.query(k,c.default.Scope.BLOCK))){if(A.start.node!==this.cursor.textNode){var P=c.default.find(A.start.node,!1);if(P==null)return;if(P instanceof c.default.Leaf){var C=P.split(A.start.offset);P.parent.insertBefore(this.cursor,C)}else P.insertBefore(this.cursor,A.start.node);this.cursor.attach()}this.cursor.format(k,T),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=this.scroll.length();k=Math.min(k,A-1),T=Math.min(k+T,A-1)-k;var P=void 0,C=this.scroll.leaf(k),F=s(C,2),M=F[0],H=F[1];if(M==null)return null;var V=M.position(H,!0),B=s(V,2);P=B[0],H=B[1];var W=document.createRange();if(T>0){W.setStart(P,H);var z=this.scroll.leaf(k+T),D=s(z,2);if(M=D[0],H=D[1],M==null)return null;var L=M.position(H,!0),q=s(L,2);return P=q[0],H=q[1],W.setEnd(P,H),W.getBoundingClientRect()}else{var I="left",R=void 0;return P instanceof Text?(H<P.data.length?(W.setStart(P,H),W.setEnd(P,H+1)):(W.setStart(P,H-1),W.setEnd(P,H),I="right"),R=W.getBoundingClientRect()):(R=M.domNode.getBoundingClientRect(),H>0&&(I="right")),{bottom:R.top+R.height,height:R.height,left:R[I],right:R[I],top:R.top,width:0}}}},{key:"getNativeRange",value:function(){var k=document.getSelection();if(k==null||k.rangeCount<=0)return null;var T=k.getRangeAt(0);if(T==null)return null;var A=this.normalizeNative(T);return w.info("getNativeRange",A),A}},{key:"getRange",value:function(){var k=this.getNativeRange();if(k==null)return[null,null];var T=this.normalizedToRange(k);return[T,k]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(k){var T=this,A=[[k.start.node,k.start.offset]];k.native.collapsed||A.push([k.end.node,k.end.offset]);var P=A.map(function(M){var H=s(M,2),V=H[0],B=H[1],W=c.default.find(V,!0),z=W.offset(T.scroll);return B===0?z:W instanceof c.default.Container?z+W.length():z+W.index(V,B)}),C=Math.min(Math.max.apply(Math,b(P)),this.scroll.length()-1),F=Math.min.apply(Math,[C].concat(b(P)));return new j(F,C-F)}},{key:"normalizeNative",value:function(k){if(!E(this.root,k.startContainer)||!k.collapsed&&!E(this.root,k.endContainer))return null;var T={start:{node:k.startContainer,offset:k.startOffset},end:{node:k.endContainer,offset:k.endOffset},native:k};return[T.start,T.end].forEach(function(A){for(var P=A.node,C=A.offset;!(P instanceof Text)&&P.childNodes.length>0;)if(P.childNodes.length>C)P=P.childNodes[C],C=0;else if(P.childNodes.length===C)P=P.lastChild,C=P instanceof Text?P.data.length:P.childNodes.length+1;else break;A.node=P,A.offset=C}),T}},{key:"rangeToNative",value:function(k){var T=this,A=k.collapsed?[k.index]:[k.index,k.index+k.length],P=[],C=this.scroll.length();return A.forEach(function(F,M){F=Math.min(C-1,F);var H=void 0,V=T.scroll.leaf(F),B=s(V,2),W=B[0],z=B[1],D=W.position(z,M!==0),L=s(D,2);H=L[0],z=L[1],P.push(H,z)}),P.length<2&&(P=P.concat(P)),P}},{key:"scrollIntoView",value:function(k){var T=this.lastRange;if(T!=null){var A=this.getBounds(T.index,T.length);if(A!=null){var P=this.scroll.length()-1,C=this.scroll.line(Math.min(T.index,P)),F=s(C,1),M=F[0],H=M;if(T.length>0){var V=this.scroll.line(Math.min(T.index+T.length,P)),B=s(V,1);H=B[0]}if(!(M==null||H==null)){var W=k.getBoundingClientRect();A.top<W.top?k.scrollTop-=W.top-A.top:A.bottom>W.bottom&&(k.scrollTop+=A.bottom-W.bottom)}}}}},{key:"setNativeRange",value:function(k,T){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:k,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:T,C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(w.info("setNativeRange",k,T,A,P),!(k!=null&&(this.root.parentNode==null||k.parentNode==null||A.parentNode==null))){var F=document.getSelection();if(F!=null)if(k!=null){this.hasFocus()||this.root.focus();var M=(this.getNativeRange()||{}).native;if(M==null||C||k!==M.startContainer||T!==M.startOffset||A!==M.endContainer||P!==M.endOffset){k.tagName=="BR"&&(T=[].indexOf.call(k.parentNode.childNodes,k),k=k.parentNode),A.tagName=="BR"&&(P=[].indexOf.call(A.parentNode.childNodes,A),A=A.parentNode);var H=document.createRange();H.setStart(k,T),H.setEnd(A,P),F.removeAllRanges(),F.addRange(H)}}else F.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:p.default.sources.API;if(typeof T=="string"&&(A=T,T=!1),w.info("setRange",k),k!=null){var P=this.rangeToNative(k);this.setNativeRange.apply(this,b(P).concat([T]))}else this.setNativeRange(null);this.update(A)}},{key:"update",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p.default.sources.USER,T=this.lastRange,A=this.getRange(),P=s(A,2),C=P[0],F=P[1];if(this.lastRange=C,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,h.default)(T,this.lastRange)){var M;!this.composing&&F!=null&&F.native.collapsed&&F.start.node!==this.cursor.textNode&&this.cursor.restore();var H=[p.default.events.SELECTION_CHANGE,(0,u.default)(this.lastRange),(0,u.default)(T),k];if((M=this.emitter).emit.apply(M,[p.default.events.EDITOR_CHANGE].concat(H)),k!==p.default.sources.SILENT){var V;(V=this.emitter).emit.apply(V,H)}}}}]),S})();function E(S,O){try{O.parentNode}catch{return!1}return O instanceof Text&&(O=O.parentNode),S.contains(O)}n.Range=j,n.default=N}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function p(v,g){for(var x=0;x<g.length;x++){var b=g[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,g,x){return g&&p(v.prototype,g),x&&p(v,x),v}})(),o=function p(v,g,x){v===null&&(v=Function.prototype);var b=Object.getOwnPropertyDescriptor(v,g);if(b===void 0){var y=Object.getPrototypeOf(v);return y===null?void 0:p(y,g,x)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(x)}},l=a(0),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(){return u(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,[{key:"insertInto",value:function(x,b){x.children.length===0?o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"insertInto",this).call(this,x,b):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),v})(c.default.Embed);m.blotName="break",m.tagName="BR",n.default=m}),(function(r,n,a){var s=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,m){h.__proto__=m}||function(h,m){for(var p in m)m.hasOwnProperty(p)&&(h[p]=m[p])};return function(h,m){f(h,m);function p(){this.constructor=h}h.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(44),l=a(30),c=a(1),d=(function(f){s(h,f);function h(m){var p=f.call(this,m)||this;return p.build(),p}return h.prototype.appendChild=function(m){this.insertBefore(m)},h.prototype.attach=function(){f.prototype.attach.call(this),this.children.forEach(function(m){m.attach()})},h.prototype.build=function(){var m=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(p){try{var v=u(p);m.insertBefore(v,m.children.head||void 0)}catch(g){if(g instanceof c.ParchmentError)return;throw g}})},h.prototype.deleteAt=function(m,p){if(m===0&&p===this.length())return this.remove();this.children.forEachAt(m,p,function(v,g,x){v.deleteAt(g,x)})},h.prototype.descendant=function(m,p){var v=this.children.find(p),g=v[0],x=v[1];return m.blotName==null&&m(g)||m.blotName!=null&&g instanceof m?[g,x]:g instanceof h?g.descendant(m,x):[null,-1]},h.prototype.descendants=function(m,p,v){p===void 0&&(p=0),v===void 0&&(v=Number.MAX_VALUE);var g=[],x=v;return this.children.forEachAt(p,v,function(b,y,w){(m.blotName==null&&m(b)||m.blotName!=null&&b instanceof m)&&g.push(b),b instanceof h&&(g=g.concat(b.descendants(m,y,x))),x-=w}),g},h.prototype.detach=function(){this.children.forEach(function(m){m.detach()}),f.prototype.detach.call(this)},h.prototype.formatAt=function(m,p,v,g){this.children.forEachAt(m,p,function(x,b,y){x.formatAt(b,y,v,g)})},h.prototype.insertAt=function(m,p,v){var g=this.children.find(m),x=g[0],b=g[1];if(x)x.insertAt(b,p,v);else{var y=v==null?c.create("text",p):c.create(p,v);this.appendChild(y)}},h.prototype.insertBefore=function(m,p){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(v){return m instanceof v}))throw new c.ParchmentError("Cannot insert "+m.statics.blotName+" into "+this.statics.blotName);m.insertInto(this,p)},h.prototype.length=function(){return this.children.reduce(function(m,p){return m+p.length()},0)},h.prototype.moveChildren=function(m,p){this.children.forEach(function(v){m.insertBefore(v,p)})},h.prototype.optimize=function(m){if(f.prototype.optimize.call(this,m),this.children.length===0)if(this.statics.defaultChild!=null){var p=c.create(this.statics.defaultChild);this.appendChild(p),p.optimize(m)}else this.remove()},h.prototype.path=function(m,p){p===void 0&&(p=!1);var v=this.children.find(m,p),g=v[0],x=v[1],b=[[this,m]];return g instanceof h?b.concat(g.path(x,p)):(g!=null&&b.push([g,x]),b)},h.prototype.removeChild=function(m){this.children.remove(m)},h.prototype.replace=function(m){m instanceof h&&m.moveChildren(this),f.prototype.replace.call(this,m)},h.prototype.split=function(m,p){if(p===void 0&&(p=!1),!p){if(m===0)return this;if(m===this.length())return this.next}var v=this.clone();return this.parent.insertBefore(v,this.next),this.children.forEachAt(m,this.length(),function(g,x,b){g=g.split(x,p),v.appendChild(g)}),v},h.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},h.prototype.update=function(m,p){var v=this,g=[],x=[];m.forEach(function(b){b.target===v.domNode&&b.type==="childList"&&(g.push.apply(g,b.addedNodes),x.push.apply(x,b.removedNodes))}),x.forEach(function(b){if(!(b.parentNode!=null&&b.tagName!=="IFRAME"&&document.body.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var y=c.find(b);y!=null&&(y.domNode.parentNode==null||y.domNode.parentNode===v.domNode)&&y.detach()}}),g.filter(function(b){return b.parentNode==v.domNode}).sort(function(b,y){return b===y?0:b.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(b){var y=null;b.nextSibling!=null&&(y=c.find(b.nextSibling));var w=u(b);(w.next!=y||w.next==null)&&(w.parent!=null&&w.parent.removeChild(v),v.insertBefore(w,y||void 0))})},h})(l.default);function u(f){var h=c.find(f);if(h==null)try{h=c.create(f)}catch{h=c.create(c.Scope.INLINE),[].slice.call(f.childNodes).forEach(function(p){h.domNode.appendChild(p)}),f.parentNode&&f.parentNode.replaceChild(h.domNode,f),h.attach()}return h}n.default=d}),(function(r,n,a){var s=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,m){h.__proto__=m}||function(h,m){for(var p in m)m.hasOwnProperty(p)&&(h[p]=m[p])};return function(h,m){f(h,m);function p(){this.constructor=h}h.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12),l=a(31),c=a(17),d=a(1),u=(function(f){s(h,f);function h(m){var p=f.call(this,m)||this;return p.attributes=new l.default(p.domNode),p}return h.formats=function(m){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return m.tagName.toLowerCase()},h.prototype.format=function(m,p){var v=d.query(m);v instanceof o.default?this.attributes.attribute(v,p):p&&v!=null&&(m!==this.statics.blotName||this.formats()[m]!==p)&&this.replaceWith(m,p)},h.prototype.formats=function(){var m=this.attributes.values(),p=this.statics.formats(this.domNode);return p!=null&&(m[this.statics.blotName]=p),m},h.prototype.replaceWith=function(m,p){var v=f.prototype.replaceWith.call(this,m,p);return this.attributes.copy(v),v},h.prototype.update=function(m,p){var v=this;f.prototype.update.call(this,m,p),m.some(function(g){return g.target===v.domNode&&g.type==="attributes"})&&this.attributes.build()},h.prototype.wrap=function(m,p){var v=f.prototype.wrap.call(this,m,p);return v instanceof h&&v.statics.scope===this.statics.scope&&this.attributes.move(v),v},h})(c.default);n.default=u}),(function(r,n,a){var s=this&&this.__extends||(function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(30),l=a(1),c=(function(d){s(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.value=function(f){return!0},u.prototype.index=function(f,h){return this.domNode===f||this.domNode.compareDocumentPosition(f)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(h,1):-1},u.prototype.position=function(f,h){var m=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return f>0&&(m+=1),[this.parent.domNode,m]},u.prototype.value=function(){var f;return f={},f[this.statics.blotName]=this.statics.value(this.domNode)||!0,f},u.scope=l.Scope.INLINE_BLOT,u})(o.default);n.default=c}),(function(r,n,a){var s=a(11),o=a(3),l={attributes:{compose:function(d,u,f){typeof d!="object"&&(d={}),typeof u!="object"&&(u={});var h=o(!0,{},u);f||(h=Object.keys(h).reduce(function(p,v){return h[v]!=null&&(p[v]=h[v]),p},{}));for(var m in d)d[m]!==void 0&&u[m]===void 0&&(h[m]=d[m]);return Object.keys(h).length>0?h:void 0},diff:function(d,u){typeof d!="object"&&(d={}),typeof u!="object"&&(u={});var f=Object.keys(d).concat(Object.keys(u)).reduce(function(h,m){return s(d[m],u[m])||(h[m]=u[m]===void 0?null:u[m]),h},{});return Object.keys(f).length>0?f:void 0},transform:function(d,u,f){if(typeof d!="object")return u;if(typeof u=="object"){if(!f)return u;var h=Object.keys(u).reduce(function(m,p){return d[p]===void 0&&(m[p]=u[p]),m},{});return Object.keys(h).length>0?h:void 0}}},iterator:function(d){return new c(d)},length:function(d){return typeof d.delete=="number"?d.delete:typeof d.retain=="number"?d.retain:typeof d.insert=="string"?d.insert.length:1}};function c(d){this.ops=d,this.index=0,this.offset=0}c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(d){d||(d=1/0);var u=this.ops[this.index];if(u){var f=this.offset,h=l.length(u);if(d>=h-f?(d=h-f,this.index+=1,this.offset=0):this.offset+=d,typeof u.delete=="number")return{delete:d};var m={};return u.attributes&&(m.attributes=u.attributes),typeof u.retain=="number"?m.retain=d:typeof u.insert=="string"?m.insert=u.insert.substr(f,d):m.insert=u.insert,m}else return{retain:1/0}},c.prototype.peek=function(){return this.ops[this.index]},c.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},c.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var d=this.offset,u=this.index,f=this.next(),h=this.ops.slice(this.index);return this.offset=d,this.index=u,[f].concat(h)}else return[]},r.exports=l}),(function(r,n){var a=(function(){function s(v,g){return g!=null&&v instanceof g}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var c;try{c=Promise}catch{c=function(){}}function d(v,g,x,b,y){typeof g=="object"&&(x=g.depth,b=g.prototype,y=g.includeNonEnumerable,g=g.circular);var w=[],j=[],N=typeof Buffer<"u";typeof g>"u"&&(g=!0),typeof x>"u"&&(x=1/0);function E(S,O){if(S===null)return null;if(O===0)return S;var k,T;if(typeof S!="object")return S;if(s(S,o))k=new o;else if(s(S,l))k=new l;else if(s(S,c))k=new c(function(W,z){S.then(function(D){W(E(D,O-1))},function(D){z(E(D,O-1))})});else if(d.__isArray(S))k=[];else if(d.__isRegExp(S))k=new RegExp(S.source,p(S)),S.lastIndex&&(k.lastIndex=S.lastIndex);else if(d.__isDate(S))k=new Date(S.getTime());else{if(N&&Buffer.isBuffer(S))return Buffer.allocUnsafe?k=Buffer.allocUnsafe(S.length):k=new Buffer(S.length),S.copy(k),k;s(S,Error)?k=Object.create(S):typeof b>"u"?(T=Object.getPrototypeOf(S),k=Object.create(T)):(k=Object.create(b),T=b)}if(g){var A=w.indexOf(S);if(A!=-1)return j[A];w.push(S),j.push(k)}s(S,o)&&S.forEach(function(W,z){var D=E(z,O-1),L=E(W,O-1);k.set(D,L)}),s(S,l)&&S.forEach(function(W){var z=E(W,O-1);k.add(z)});for(var P in S){var C;T&&(C=Object.getOwnPropertyDescriptor(T,P)),!(C&&C.set==null)&&(k[P]=E(S[P],O-1))}if(Object.getOwnPropertySymbols)for(var F=Object.getOwnPropertySymbols(S),P=0;P<F.length;P++){var M=F[P],H=Object.getOwnPropertyDescriptor(S,M);H&&!H.enumerable&&!y||(k[M]=E(S[M],O-1),H.enumerable||Object.defineProperty(k,M,{enumerable:!1}))}if(y)for(var V=Object.getOwnPropertyNames(S),P=0;P<V.length;P++){var B=V[P],H=Object.getOwnPropertyDescriptor(S,B);H&&H.enumerable||(k[B]=E(S[B],O-1),Object.defineProperty(k,B,{enumerable:!1}))}return k}return E(v,x)}d.clonePrototype=function(g){if(g===null)return null;var x=function(){};return x.prototype=g,new x};function u(v){return Object.prototype.toString.call(v)}d.__objToStr=u;function f(v){return typeof v=="object"&&u(v)==="[object Date]"}d.__isDate=f;function h(v){return typeof v=="object"&&u(v)==="[object Array]"}d.__isArray=h;function m(v){return typeof v=="object"&&u(v)==="[object RegExp]"}d.__isRegExp=m;function p(v){var g="";return v.global&&(g+="g"),v.ignoreCase&&(g+="i"),v.multiline&&(g+="m"),g}return d.__getRegExpFlags=p,d})();typeof r=="object"&&r.exports&&(r.exports=a)}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function k(T,A){var P=[],C=!0,F=!1,M=void 0;try{for(var H=T[Symbol.iterator](),V;!(C=(V=H.next()).done)&&(P.push(V.value),!(A&&P.length===A));C=!0);}catch(B){F=!0,M=B}finally{try{!C&&H.return&&H.return()}finally{if(F)throw M}}return P}return function(T,A){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return k(T,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function k(T,A){for(var P=0;P<A.length;P++){var C=A[P];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(T,C.key,C)}}return function(T,A,P){return A&&k(T.prototype,A),P&&k(T,P),T}})(),l=function k(T,A,P){T===null&&(T=Function.prototype);var C=Object.getOwnPropertyDescriptor(T,A);if(C===void 0){var F=Object.getPrototypeOf(T);return F===null?void 0:k(F,A,P)}else{if("value"in C)return C.value;var M=C.get;return M===void 0?void 0:M.call(P)}},c=a(0),d=w(c),u=a(8),f=w(u),h=a(4),m=w(h),p=a(16),v=w(p),g=a(13),x=w(g),b=a(25),y=w(b);function w(k){return k&&k.__esModule?k:{default:k}}function j(k,T){if(!(k instanceof T))throw new TypeError("Cannot call a class as a function")}function N(k,T){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:k}function E(k,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);k.prototype=Object.create(T&&T.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(k,T):k.__proto__=T)}function S(k){return k instanceof m.default||k instanceof h.BlockEmbed}var O=(function(k){E(T,k);function T(A,P){j(this,T);var C=N(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,A));return C.emitter=P.emitter,Array.isArray(P.whitelist)&&(C.whitelist=P.whitelist.reduce(function(F,M){return F[M]=!0,F},{})),C.domNode.addEventListener("DOMNodeInserted",function(){}),C.optimize(),C.enable(),C}return o(T,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(P,C){var F=this.line(P),M=s(F,2),H=M[0],V=M[1],B=this.line(P+C),W=s(B,1),z=W[0];if(l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"deleteAt",this).call(this,P,C),z!=null&&H!==z&&V>0){if(H instanceof h.BlockEmbed||z instanceof h.BlockEmbed){this.optimize();return}if(H instanceof x.default){var D=H.newlineIndex(H.length(),!0);if(D>-1&&(H=H.split(D+1),H===z)){this.optimize();return}}else if(z instanceof x.default){var L=z.newlineIndex(0);L>-1&&z.split(L+1)}var q=z.children.head instanceof v.default?null:z.children.head;H.moveChildren(z,q),H.remove()}this.optimize()}},{key:"enable",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",P)}},{key:"formatAt",value:function(P,C,F,M){this.whitelist!=null&&!this.whitelist[F]||(l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"formatAt",this).call(this,P,C,F,M),this.optimize())}},{key:"insertAt",value:function(P,C,F){if(!(F!=null&&this.whitelist!=null&&!this.whitelist[C])){if(P>=this.length())if(F==null||d.default.query(C,d.default.Scope.BLOCK)==null){var M=d.default.create(this.statics.defaultChild);this.appendChild(M),F==null&&C.endsWith(`
`)&&(C=C.slice(0,-1)),M.insertAt(0,C,F)}else{var H=d.default.create(C,F);this.appendChild(H)}else l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertAt",this).call(this,P,C,F);this.optimize()}}},{key:"insertBefore",value:function(P,C){if(P.statics.scope===d.default.Scope.INLINE_BLOT){var F=d.default.create(this.statics.defaultChild);F.appendChild(P),P=F}l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertBefore",this).call(this,P,C)}},{key:"leaf",value:function(P){return this.path(P).pop()||[null,-1]}},{key:"line",value:function(P){return P===this.length()?this.line(P-1):this.descendant(S,P)}},{key:"lines",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,F=function M(H,V,B){var W=[],z=B;return H.children.forEachAt(V,B,function(D,L,q){S(D)?W.push(D):D instanceof d.default.Container&&(W=W.concat(M(D,L,z))),z-=q}),W};return F(this,P,C)}},{key:"optimize",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,P,C),P.length>0&&this.emitter.emit(f.default.events.SCROLL_OPTIMIZE,P,C))}},{key:"path",value:function(P){return l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"path",this).call(this,P).slice(1)}},{key:"update",value:function(P){if(this.batch!==!0){var C=f.default.sources.USER;typeof P=="string"&&(C=P),Array.isArray(P)||(P=this.observer.takeRecords()),P.length>0&&this.emitter.emit(f.default.events.SCROLL_BEFORE_UPDATE,C,P),l(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"update",this).call(this,P.concat([])),P.length>0&&this.emitter.emit(f.default.events.SCROLL_UPDATE,C,P)}}}]),T})(d.default.Scroll);O.blotName="scroll",O.className="ql-editor",O.tagName="DIV",O.defaultChild="block",O.allowedChildren=[m.default,h.BlockEmbed,y.default],n.default=O}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o=(function(){function R(X,ae){var Z=[],ee=!0,ie=!1,U=void 0;try{for(var be=X[Symbol.iterator](),Se;!(ee=(Se=be.next()).done)&&(Z.push(Se.value),!(ae&&Z.length===ae));ee=!0);}catch(Re){ie=!0,U=Re}finally{try{!ee&&be.return&&be.return()}finally{if(ie)throw U}}return Z}return function(X,ae){if(Array.isArray(X))return X;if(Symbol.iterator in Object(X))return R(X,ae);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function R(X,ae){for(var Z=0;Z<ae.length;Z++){var ee=ae[Z];ee.enumerable=ee.enumerable||!1,ee.configurable=!0,"value"in ee&&(ee.writable=!0),Object.defineProperty(X,ee.key,ee)}}return function(X,ae,Z){return ae&&R(X.prototype,ae),Z&&R(X,Z),X}})(),c=a(21),d=k(c),u=a(11),f=k(u),h=a(3),m=k(h),p=a(2),v=k(p),g=a(20),x=k(g),b=a(0),y=k(b),w=a(5),j=k(w),N=a(10),E=k(N),S=a(9),O=k(S);function k(R){return R&&R.__esModule?R:{default:R}}function T(R,X,ae){return X in R?Object.defineProperty(R,X,{value:ae,enumerable:!0,configurable:!0,writable:!0}):R[X]=ae,R}function A(R,X){if(!(R instanceof X))throw new TypeError("Cannot call a class as a function")}function P(R,X){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return X&&(typeof X=="object"||typeof X=="function")?X:R}function C(R,X){if(typeof X!="function"&&X!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof X);R.prototype=Object.create(X&&X.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),X&&(Object.setPrototypeOf?Object.setPrototypeOf(R,X):R.__proto__=X)}var F=(0,E.default)("quill:keyboard"),M=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",H=(function(R){C(X,R),l(X,null,[{key:"match",value:function(Z,ee){return ee=I(ee),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ie){return!!ee[ie]!==Z[ie]&&ee[ie]!==null})?!1:ee.key===(Z.which||Z.keyCode)}}]);function X(ae,Z){A(this,X);var ee=P(this,(X.__proto__||Object.getPrototypeOf(X)).call(this,ae,Z));return ee.bindings={},Object.keys(ee.options.bindings).forEach(function(ie){ie==="list autofill"&&ae.scroll.whitelist!=null&&!ae.scroll.whitelist.list||ee.options.bindings[ie]&&ee.addBinding(ee.options.bindings[ie])}),ee.addBinding({key:X.keys.ENTER,shiftKey:null},D),ee.addBinding({key:X.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(ee.addBinding({key:X.keys.BACKSPACE},{collapsed:!0},B),ee.addBinding({key:X.keys.DELETE},{collapsed:!0},W)):(ee.addBinding({key:X.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},B),ee.addBinding({key:X.keys.DELETE},{collapsed:!0,suffix:/^.?$/},W)),ee.addBinding({key:X.keys.BACKSPACE},{collapsed:!1},z),ee.addBinding({key:X.keys.DELETE},{collapsed:!1},z),ee.addBinding({key:X.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},B),ee.listen(),ee}return l(X,[{key:"addBinding",value:function(Z){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},U=I(Z);if(U==null||U.key==null)return F.warn("Attempted to add invalid keyboard binding",U);typeof ee=="function"&&(ee={handler:ee}),typeof ie=="function"&&(ie={handler:ie}),U=(0,m.default)(U,ee,ie),this.bindings[U.key]=this.bindings[U.key]||[],this.bindings[U.key].push(U)}},{key:"listen",value:function(){var Z=this;this.quill.root.addEventListener("keydown",function(ee){if(!ee.defaultPrevented){var ie=ee.which||ee.keyCode,U=(Z.bindings[ie]||[]).filter(function(Ve){return X.match(ee,Ve)});if(U.length!==0){var be=Z.quill.getSelection();if(!(be==null||!Z.quill.hasFocus())){var Se=Z.quill.getLine(be.index),Re=o(Se,2),Le=Re[0],_e=Re[1],he=Z.quill.getLeaf(be.index),ue=o(he,2),je=ue[0],Oe=ue[1],Ae=be.length===0?[je,Oe]:Z.quill.getLeaf(be.index+be.length),Qe=o(Ae,2),Ke=Qe[0],et=Qe[1],Qt=je instanceof y.default.Text?je.value().slice(0,Oe):"",Jr=Ke instanceof y.default.Text?Ke.value().slice(et):"",it={collapsed:be.length===0,empty:be.length===0&&Le.length()<=1,format:Z.quill.getFormat(be),offset:_e,prefix:Qt,suffix:Jr},$n=U.some(function(Ve){if(Ve.collapsed!=null&&Ve.collapsed!==it.collapsed||Ve.empty!=null&&Ve.empty!==it.empty||Ve.offset!=null&&Ve.offset!==it.offset)return!1;if(Array.isArray(Ve.format)){if(Ve.format.every(function(pt){return it.format[pt]==null}))return!1}else if(s(Ve.format)==="object"&&!Object.keys(Ve.format).every(function(pt){return Ve.format[pt]===!0?it.format[pt]!=null:Ve.format[pt]===!1?it.format[pt]==null:(0,f.default)(Ve.format[pt],it.format[pt])}))return!1;return Ve.prefix!=null&&!Ve.prefix.test(it.prefix)||Ve.suffix!=null&&!Ve.suffix.test(it.suffix)?!1:Ve.handler.call(Z,be,it)!==!0});$n&&ee.preventDefault()}}}})}}]),X})(O.default);H.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},H.DEFAULTS={bindings:{bold:q("bold"),italic:q("italic"),underline:q("underline"),indent:{key:H.keys.TAB,format:["blockquote","indent","list"],handler:function(X,ae){if(ae.collapsed&&ae.offset!==0)return!0;this.quill.format("indent","+1",j.default.sources.USER)}},outdent:{key:H.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(X,ae){if(ae.collapsed&&ae.offset!==0)return!0;this.quill.format("indent","-1",j.default.sources.USER)}},"outdent backspace":{key:H.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(X,ae){ae.format.indent!=null?this.quill.format("indent","-1",j.default.sources.USER):ae.format.list!=null&&this.quill.format("list",!1,j.default.sources.USER)}},"indent code-block":L(!0),"outdent code-block":L(!1),"remove tab":{key:H.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(X){this.quill.deleteText(X.index-1,1,j.default.sources.USER)}},tab:{key:H.keys.TAB,handler:function(X){this.quill.history.cutoff();var ae=new v.default().retain(X.index).delete(X.length).insert("	");this.quill.updateContents(ae,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(X.index+1,j.default.sources.SILENT)}},"list empty enter":{key:H.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(X,ae){this.quill.format("list",!1,j.default.sources.USER),ae.format.indent&&this.quill.format("indent",!1,j.default.sources.USER)}},"checklist enter":{key:H.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(X){var ae=this.quill.getLine(X.index),Z=o(ae,2),ee=Z[0],ie=Z[1],U=(0,m.default)({},ee.formats(),{list:"checked"}),be=new v.default().retain(X.index).insert(`
`,U).retain(ee.length()-ie-1).retain(1,{list:"unchecked"});this.quill.updateContents(be,j.default.sources.USER),this.quill.setSelection(X.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:H.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(X,ae){var Z=this.quill.getLine(X.index),ee=o(Z,2),ie=ee[0],U=ee[1],be=new v.default().retain(X.index).insert(`
`,ae.format).retain(ie.length()-U-1).retain(1,{header:null});this.quill.updateContents(be,j.default.sources.USER),this.quill.setSelection(X.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(X,ae){var Z=ae.prefix.length,ee=this.quill.getLine(X.index),ie=o(ee,2),U=ie[0],be=ie[1];if(be>Z)return!0;var Se=void 0;switch(ae.prefix.trim()){case"[]":case"[ ]":Se="unchecked";break;case"[x]":Se="checked";break;case"-":case"*":Se="bullet";break;default:Se="ordered"}this.quill.insertText(X.index," ",j.default.sources.USER),this.quill.history.cutoff();var Re=new v.default().retain(X.index-be).delete(Z+1).retain(U.length()-2-be).retain(1,{list:Se});this.quill.updateContents(Re,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(X.index-Z,j.default.sources.SILENT)}},"code exit":{key:H.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(X){var ae=this.quill.getLine(X.index),Z=o(ae,2),ee=Z[0],ie=Z[1],U=new v.default().retain(X.index+ee.length()-ie-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(U,j.default.sources.USER)}},"embed left":V(H.keys.LEFT,!1),"embed left shift":V(H.keys.LEFT,!0),"embed right":V(H.keys.RIGHT,!1),"embed right shift":V(H.keys.RIGHT,!0)}};function V(R,X){var ae,Z=R===H.keys.LEFT?"prefix":"suffix";return ae={key:R,shiftKey:X,altKey:null},T(ae,Z,/^$/),T(ae,"handler",function(ie){var U=ie.index;R===H.keys.RIGHT&&(U+=ie.length+1);var be=this.quill.getLeaf(U),Se=o(be,1),Re=Se[0];return Re instanceof y.default.Embed?(R===H.keys.LEFT?X?this.quill.setSelection(ie.index-1,ie.length+1,j.default.sources.USER):this.quill.setSelection(ie.index-1,j.default.sources.USER):X?this.quill.setSelection(ie.index,ie.length+1,j.default.sources.USER):this.quill.setSelection(ie.index+ie.length+1,j.default.sources.USER),!1):!0}),ae}function B(R,X){if(!(R.index===0||this.quill.getLength()<=1)){var ae=this.quill.getLine(R.index),Z=o(ae,1),ee=Z[0],ie={};if(X.offset===0){var U=this.quill.getLine(R.index-1),be=o(U,1),Se=be[0];if(Se!=null&&Se.length()>1){var Re=ee.formats(),Le=this.quill.getFormat(R.index-1,1);ie=x.default.attributes.diff(Re,Le)||{}}}var _e=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(X.prefix)?2:1;this.quill.deleteText(R.index-_e,_e,j.default.sources.USER),Object.keys(ie).length>0&&this.quill.formatLine(R.index-_e,_e,ie,j.default.sources.USER),this.quill.focus()}}function W(R,X){var ae=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(X.suffix)?2:1;if(!(R.index>=this.quill.getLength()-ae)){var Z={},ee=0,ie=this.quill.getLine(R.index),U=o(ie,1),be=U[0];if(X.offset>=be.length()-1){var Se=this.quill.getLine(R.index+1),Re=o(Se,1),Le=Re[0];if(Le){var _e=be.formats(),he=this.quill.getFormat(R.index,1);Z=x.default.attributes.diff(_e,he)||{},ee=Le.length()}}this.quill.deleteText(R.index,ae,j.default.sources.USER),Object.keys(Z).length>0&&this.quill.formatLine(R.index+ee-1,ae,Z,j.default.sources.USER)}}function z(R){var X=this.quill.getLines(R),ae={};if(X.length>1){var Z=X[0].formats(),ee=X[X.length-1].formats();ae=x.default.attributes.diff(ee,Z)||{}}this.quill.deleteText(R,j.default.sources.USER),Object.keys(ae).length>0&&this.quill.formatLine(R.index,1,ae,j.default.sources.USER),this.quill.setSelection(R.index,j.default.sources.SILENT),this.quill.focus()}function D(R,X){var ae=this;R.length>0&&this.quill.scroll.deleteAt(R.index,R.length);var Z=Object.keys(X.format).reduce(function(ee,ie){return y.default.query(ie,y.default.Scope.BLOCK)&&!Array.isArray(X.format[ie])&&(ee[ie]=X.format[ie]),ee},{});this.quill.insertText(R.index,`
`,Z,j.default.sources.USER),this.quill.setSelection(R.index+1,j.default.sources.SILENT),this.quill.focus(),Object.keys(X.format).forEach(function(ee){Z[ee]==null&&(Array.isArray(X.format[ee])||ee!=="link"&&ae.quill.format(ee,X.format[ee],j.default.sources.USER))})}function L(R){return{key:H.keys.TAB,shiftKey:!R,format:{"code-block":!0},handler:function(ae){var Z=y.default.query("code-block"),ee=ae.index,ie=ae.length,U=this.quill.scroll.descendant(Z,ee),be=o(U,2),Se=be[0],Re=be[1];if(Se!=null){var Le=this.quill.getIndex(Se),_e=Se.newlineIndex(Re,!0)+1,he=Se.newlineIndex(Le+Re+ie),ue=Se.domNode.textContent.slice(_e,he).split(`
`);Re=0,ue.forEach(function(je,Oe){R?(Se.insertAt(_e+Re,Z.TAB),Re+=Z.TAB.length,Oe===0?ee+=Z.TAB.length:ie+=Z.TAB.length):je.startsWith(Z.TAB)&&(Se.deleteAt(_e+Re,Z.TAB.length),Re-=Z.TAB.length,Oe===0?ee-=Z.TAB.length:ie-=Z.TAB.length),Re+=je.length+1}),this.quill.update(j.default.sources.USER),this.quill.setSelection(ee,ie,j.default.sources.SILENT)}}}}function q(R){return{key:R[0].toUpperCase(),shortKey:!0,handler:function(ae,Z){this.quill.format(R,!Z.format[R],j.default.sources.USER)}}}function I(R){if(typeof R=="string"||typeof R=="number")return I({key:R});if((typeof R>"u"?"undefined":s(R))==="object"&&(R=(0,d.default)(R,!1)),typeof R.key=="string")if(H.keys[R.key.toUpperCase()]!=null)R.key=H.keys[R.key.toUpperCase()];else if(R.key.length===1)R.key=R.key.toUpperCase().charCodeAt(0);else return null;return R.shortKey&&(R[M]=R.shortKey,delete R.shortKey),R}n.default=H,n.SHORTKEY=M}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function x(b,y){var w=[],j=!0,N=!1,E=void 0;try{for(var S=b[Symbol.iterator](),O;!(j=(O=S.next()).done)&&(w.push(O.value),!(y&&w.length===y));j=!0);}catch(k){N=!0,E=k}finally{try{!j&&S.return&&S.return()}finally{if(N)throw E}}return w}return function(b,y){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return x(b,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=function x(b,y,w){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,y);if(j===void 0){var N=Object.getPrototypeOf(b);return N===null?void 0:x(N,y,w)}else{if("value"in j)return j.value;var E=j.get;return E===void 0?void 0:E.call(w)}},l=(function(){function x(b,y){for(var w=0;w<y.length;w++){var j=y[w];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,y,w){return y&&x(b.prototype,y),w&&x(b,w),b}})(),c=a(0),d=h(c),u=a(7),f=h(u);function h(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function p(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function v(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var g=(function(x){v(b,x),l(b,null,[{key:"value",value:function(){}}]);function b(y,w){m(this,b);var j=p(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,y));return j.selection=w,j.textNode=document.createTextNode(b.CONTENTS),j.domNode.appendChild(j.textNode),j._length=0,j}return l(b,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(w,j){if(this._length!==0)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,w,j);for(var N=this,E=0;N!=null&&N.statics.scope!==d.default.Scope.BLOCK_BLOT;)E+=N.offset(N.parent),N=N.parent;N!=null&&(this._length=b.CONTENTS.length,N.optimize(),N.formatAt(E,b.CONTENTS.length,w,j),this._length=0)}},{key:"index",value:function(w,j){return w===this.textNode?0:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,w,j)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var w=this.textNode,j=this.selection.getNativeRange(),N=void 0,E=void 0,S=void 0;if(j!=null&&j.start.node===w&&j.end.node===w){var O=[w,j.start.offset,j.end.offset];N=O[0],E=O[1],S=O[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==b.CONTENTS){var k=this.textNode.data.split(b.CONTENTS).join("");this.next instanceof f.default?(N=this.next.domNode,this.next.insertAt(0,k),this.textNode.data=b.CONTENTS):(this.textNode.data=k,this.parent.insertBefore(d.default.create(this.textNode),this),this.textNode=document.createTextNode(b.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),E!=null){var T=[E,S].map(function(P){return Math.max(0,Math.min(N.data.length,P-1))}),A=s(T,2);return E=A[0],S=A[1],{startNode:N,startOffset:E,endNode:N,endOffset:S}}}}},{key:"update",value:function(w,j){var N=this;if(w.some(function(S){return S.type==="characterData"&&S.target===N.textNode})){var E=this.restore();E&&(j.range=E)}}},{key:"value",value:function(){return""}}]),b})(d.default.Embed);g.blotName="cursor",g.className="ql-cursor",g.tagName="span",g.CONTENTS="\uFEFF",n.default=g}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=d(s),l=a(4),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(){return u(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v})(o.default.Container);m.allowedChildren=[c.default,l.BlockEmbed,m],n.default=m}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=(function(){function g(x,b){for(var y=0;y<b.length;y++){var w=b[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}return function(x,b,y){return b&&g(x.prototype,b),y&&g(x,y),x}})(),o=function g(x,b,y){x===null&&(x=Function.prototype);var w=Object.getOwnPropertyDescriptor(x,b);if(w===void 0){var j=Object.getPrototypeOf(x);return j===null?void 0:g(j,b,y)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(y)}},l=a(0),c=d(l);function d(g){return g&&g.__esModule?g:{default:g}}function u(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function f(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function h(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var m=(function(g){h(x,g);function x(){return u(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"value",value:function(y){var w=o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"value",this).call(this,y);return w.startsWith("rgb(")?(w=w.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+w.split(",").map(function(j){return("00"+parseInt(j).toString(16)).slice(-2)}).join("")):w}}]),x})(c.default.Attributor.Style),p=new c.default.Attributor.Class("color","ql-color",{scope:c.default.Scope.INLINE}),v=new m("color","color",{scope:c.default.Scope.INLINE});n.ColorAttributor=m,n.ColorClass=p,n.ColorStyle=v}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=(function(){function v(g,x){for(var b=0;b<x.length;b++){var y=x[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(g,y.key,y)}}return function(g,x,b){return x&&v(g.prototype,x),b&&v(g,b),g}})(),o=function v(g,x,b){g===null&&(g=Function.prototype);var y=Object.getOwnPropertyDescriptor(g,x);if(y===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,x,b)}else{if("value"in y)return y.value;var j=y.get;return j===void 0?void 0:j.call(b)}},l=a(6),c=d(l);function d(v){return v&&v.__esModule?v:{default:v}}function u(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function f(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function h(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var m=(function(v){h(g,v);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"format",value:function(b,y){if(b!==this.statics.blotName||!y)return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"format",this).call(this,b,y);y=this.constructor.sanitize(y),this.domNode.setAttribute("href",y)}}],[{key:"create",value:function(b){var y=o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,b);return b=this.sanitize(b),y.setAttribute("href",b),y.setAttribute("rel","noopener noreferrer"),y.setAttribute("target","_blank"),y}},{key:"formats",value:function(b){return b.getAttribute("href")}},{key:"sanitize",value:function(b){return p(b,this.PROTOCOL_WHITELIST)?b:this.SANITIZED_URL}}]),g})(c.default);m.blotName="link",m.tagName="A",m.SANITIZED_URL="about:blank",m.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function p(v,g){var x=document.createElement("a");x.href=v;var b=x.href.slice(0,x.href.indexOf(":"));return g.indexOf(b)>-1}n.default=m,n.sanitize=p}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},o=(function(){function g(x,b){for(var y=0;y<b.length;y++){var w=b[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}return function(x,b,y){return b&&g(x.prototype,b),y&&g(x,y),x}})(),l=a(23),c=f(l),d=a(107),u=f(d);function f(g){return g&&g.__esModule?g:{default:g}}function h(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}var m=0;function p(g,x){g.setAttribute(x,g.getAttribute(x)!=="true")}var v=(function(){function g(x){var b=this;h(this,g),this.select=x,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){b.togglePicker()}),this.label.addEventListener("keydown",function(y){switch(y.keyCode){case c.default.keys.ENTER:b.togglePicker();break;case c.default.keys.ESCAPE:b.escape(),y.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(g,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),p(this.label,"aria-expanded"),p(this.options,"aria-hidden")}},{key:"buildItem",value:function(b){var y=this,w=document.createElement("span");return w.tabIndex="0",w.setAttribute("role","button"),w.classList.add("ql-picker-item"),b.hasAttribute("value")&&w.setAttribute("data-value",b.getAttribute("value")),b.textContent&&w.setAttribute("data-label",b.textContent),w.addEventListener("click",function(){y.selectItem(w,!0)}),w.addEventListener("keydown",function(j){switch(j.keyCode){case c.default.keys.ENTER:y.selectItem(w,!0),j.preventDefault();break;case c.default.keys.ESCAPE:y.escape(),j.preventDefault();break}}),w}},{key:"buildLabel",value:function(){var b=document.createElement("span");return b.classList.add("ql-picker-label"),b.innerHTML=u.default,b.tabIndex="0",b.setAttribute("role","button"),b.setAttribute("aria-expanded","false"),this.container.appendChild(b),b}},{key:"buildOptions",value:function(){var b=this,y=document.createElement("span");y.classList.add("ql-picker-options"),y.setAttribute("aria-hidden","true"),y.tabIndex="-1",y.id="ql-picker-options-"+m,m+=1,this.label.setAttribute("aria-controls",y.id),this.options=y,[].slice.call(this.select.options).forEach(function(w){var j=b.buildItem(w);y.appendChild(j),w.selected===!0&&b.selectItem(j)}),this.container.appendChild(y)}},{key:"buildPicker",value:function(){var b=this;[].slice.call(this.select.attributes).forEach(function(y){b.container.setAttribute(y.name,y.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var b=this;this.close(),setTimeout(function(){return b.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(b){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=this.container.querySelector(".ql-selected");if(b!==w&&(w?.classList.remove("ql-selected"),b!=null&&(b.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(b.parentNode.children,b),b.hasAttribute("data-value")?this.label.setAttribute("data-value",b.getAttribute("data-value")):this.label.removeAttribute("data-value"),b.hasAttribute("data-label")?this.label.setAttribute("data-label",b.getAttribute("data-label")):this.label.removeAttribute("data-label"),y))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var j=document.createEvent("Event");j.initEvent("change",!0,!0),this.select.dispatchEvent(j)}this.close()}}},{key:"update",value:function(){var b=void 0;if(this.select.selectedIndex>-1){var y=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];b=this.select.options[this.select.selectedIndex],this.selectItem(y)}else this.selectItem(null);var w=b!=null&&b!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",w)}}]),g})();n.default=v}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=F(s),l=a(5),c=F(l),d=a(4),u=F(d),f=a(16),h=F(f),m=a(25),p=F(m),v=a(24),g=F(v),x=a(35),b=F(x),y=a(6),w=F(y),j=a(22),N=F(j),E=a(7),S=F(E),O=a(55),k=F(O),T=a(42),A=F(T),P=a(23),C=F(P);function F(M){return M&&M.__esModule?M:{default:M}}c.default.register({"blots/block":u.default,"blots/block/embed":d.BlockEmbed,"blots/break":h.default,"blots/container":p.default,"blots/cursor":g.default,"blots/embed":b.default,"blots/inline":w.default,"blots/scroll":N.default,"blots/text":S.default,"modules/clipboard":k.default,"modules/history":A.default,"modules/keyboard":C.default}),o.default.register(u.default,h.default,g.default,w.default,N.default,S.default),n.default=c.default}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(1),o=(function(){function l(c){this.domNode=c,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(c){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var d;return Array.isArray(this.tagName)?(typeof c=="string"&&(c=c.toUpperCase(),parseInt(c).toString()===c&&(c=parseInt(c))),typeof c=="number"?d=document.createElement(this.tagName[c-1]):this.tagName.indexOf(c)>-1?d=document.createElement(c):d=document.createElement(this.tagName[0])):d=document.createElement(this.tagName),this.className&&d.classList.add(this.className),d},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var c=this.domNode.cloneNode(!1);return s.create(c)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(c,d){var u=this.isolate(c,d);u.remove()},l.prototype.formatAt=function(c,d,u,f){var h=this.isolate(c,d);if(s.query(u,s.Scope.BLOT)!=null&&f)h.wrap(u,f);else if(s.query(u,s.Scope.ATTRIBUTE)!=null){var m=s.create(this.statics.scope);h.wrap(m),m.format(u,f)}},l.prototype.insertAt=function(c,d,u){var f=u==null?s.create("text",d):s.create(d,u),h=this.split(c);this.parent.insertBefore(f,h)},l.prototype.insertInto=function(c,d){d===void 0&&(d=null),this.parent!=null&&this.parent.children.remove(this);var u=null;c.children.insertBefore(this,d),d!=null&&(u=d.domNode),(this.domNode.parentNode!=c.domNode||this.domNode.nextSibling!=u)&&c.domNode.insertBefore(this.domNode,u),this.parent=c,this.attach()},l.prototype.isolate=function(c,d){var u=this.split(c);return u.split(d),u},l.prototype.length=function(){return 1},l.prototype.offset=function(c){return c===void 0&&(c=this.parent),this.parent==null||this==c?0:this.parent.children.offset(this)+this.parent.offset(c)},l.prototype.optimize=function(c){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(c){c.parent!=null&&(c.parent.insertBefore(this,c.next),c.remove())},l.prototype.replaceWith=function(c,d){var u=typeof c=="string"?s.create(c,d):c;return u.replace(this),u},l.prototype.split=function(c,d){return c===0?this:this.next},l.prototype.update=function(c,d){},l.prototype.wrap=function(c,d){var u=typeof c=="string"?s.create(c,d):c;return this.parent!=null&&this.parent.insertBefore(u,this.next),u.appendChild(this),u},l.blotName="abstract",l})();n.default=o}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(12),o=a(32),l=a(33),c=a(1),d=(function(){function u(f){this.attributes={},this.domNode=f,this.build()}return u.prototype.attribute=function(f,h){h?f.add(this.domNode,h)&&(f.value(this.domNode)!=null?this.attributes[f.attrName]=f:delete this.attributes[f.attrName]):(f.remove(this.domNode),delete this.attributes[f.attrName])},u.prototype.build=function(){var f=this;this.attributes={};var h=s.default.keys(this.domNode),m=o.default.keys(this.domNode),p=l.default.keys(this.domNode);h.concat(m).concat(p).forEach(function(v){var g=c.query(v,c.Scope.ATTRIBUTE);g instanceof s.default&&(f.attributes[g.attrName]=g)})},u.prototype.copy=function(f){var h=this;Object.keys(this.attributes).forEach(function(m){var p=h.attributes[m].value(h.domNode);f.format(m,p)})},u.prototype.move=function(f){var h=this;this.copy(f),Object.keys(this.attributes).forEach(function(m){h.attributes[m].remove(h.domNode)}),this.attributes={}},u.prototype.values=function(){var f=this;return Object.keys(this.attributes).reduce(function(h,m){return h[m]=f.attributes[m].value(f.domNode),h},{})},u})();n.default=d}),(function(r,n,a){var s=this&&this.__extends||(function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12);function l(d,u){var f=d.getAttribute("class")||"";return f.split(/\s+/).filter(function(h){return h.indexOf(u+"-")===0})}var c=(function(d){s(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("class")||"").split(/\s+/).map(function(h){return h.split("-").slice(0,-1).join("-")})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(this.remove(f),f.classList.add(this.keyName+"-"+h),!0):!1},u.prototype.remove=function(f){var h=l(f,this.keyName);h.forEach(function(m){f.classList.remove(m)}),f.classList.length===0&&f.removeAttribute("class")},u.prototype.value=function(f){var h=l(f,this.keyName)[0]||"",m=h.slice(this.keyName.length+1);return this.canAdd(f,m)?m:""},u})(o.default);n.default=c}),(function(r,n,a){var s=this&&this.__extends||(function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12);function l(d){var u=d.split("-"),f=u.slice(1).map(function(h){return h[0].toUpperCase()+h.slice(1)}).join("");return u[0]+f}var c=(function(d){s(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("style")||"").split(";").map(function(h){var m=h.split(":");return m[0].trim()})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(f.style[l(this.keyName)]=h,!0):!1},u.prototype.remove=function(f){f.style[l(this.keyName)]="",f.getAttribute("style")||f.removeAttribute("style")},u.prototype.value=function(f){var h=f.style[l(this.keyName)];return this.canAdd(f,h)?h:""},u})(o.default);n.default=c}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function c(d,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}return function(d,u,f){return u&&c(d.prototype,u),f&&c(d,f),d}})();function o(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}var l=(function(){function c(d,u){o(this,c),this.quill=d,this.options=u,this.modules={}}return s(c,[{key:"init",value:function(){var u=this;Object.keys(this.options.modules).forEach(function(f){u.modules[f]==null&&u.addModule(f)})}},{key:"addModule",value:function(u){var f=this.quill.constructor.import("modules/"+u);return this.modules[u]=new f(this.quill,this.options.modules[u]||{}),this.modules[u]}}]),c})();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function x(b,y){for(var w=0;w<y.length;w++){var j=y[w];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,y,w){return y&&x(b.prototype,y),w&&x(b,w),b}})(),o=function x(b,y,w){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,y);if(j===void 0){var N=Object.getPrototypeOf(b);return N===null?void 0:x(N,y,w)}else{if("value"in j)return j.value;var E=j.get;return E===void 0?void 0:E.call(w)}},l=a(0),c=f(l),d=a(7),u=f(d);function f(x){return x&&x.__esModule?x:{default:x}}function h(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function m(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function p(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v="\uFEFF",g=(function(x){p(b,x);function b(y){h(this,b);var w=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,y));return w.contentNode=document.createElement("span"),w.contentNode.setAttribute("contenteditable",!1),[].slice.call(w.domNode.childNodes).forEach(function(j){w.contentNode.appendChild(j)}),w.leftGuard=document.createTextNode(v),w.rightGuard=document.createTextNode(v),w.domNode.appendChild(w.leftGuard),w.domNode.appendChild(w.contentNode),w.domNode.appendChild(w.rightGuard),w}return s(b,[{key:"index",value:function(w,j){return w===this.leftGuard?0:w===this.rightGuard?1:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,w,j)}},{key:"restore",value:function(w){var j=void 0,N=void 0,E=w.data.split(v).join("");if(w===this.leftGuard)if(this.prev instanceof u.default){var S=this.prev.length();this.prev.insertAt(S,E),j={startNode:this.prev.domNode,startOffset:S+E.length}}else N=document.createTextNode(E),this.parent.insertBefore(c.default.create(N),this),j={startNode:N,startOffset:E.length};else w===this.rightGuard&&(this.next instanceof u.default?(this.next.insertAt(0,E),j={startNode:this.next.domNode,startOffset:E.length}):(N=document.createTextNode(E),this.parent.insertBefore(c.default.create(N),this.next),j={startNode:N,startOffset:E.length}));return w.data=v,j}},{key:"update",value:function(w,j){var N=this;w.forEach(function(E){if(E.type==="characterData"&&(E.target===N.leftGuard||E.target===N.rightGuard)){var S=N.restore(E.target);S&&(j.range=S)}})}}]),b})(c.default.Embed);n.default=g}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=a(0),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}var c={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},d=new o.default.Attributor.Attribute("align","align",c),u=new o.default.Attributor.Class("align","ql-align",c),f=new o.default.Attributor.Style("align","text-align",c);n.AlignAttribute=d,n.AlignClass=u,n.AlignStyle=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=a(0),o=c(s),l=a(26);function c(f){return f&&f.__esModule?f:{default:f}}var d=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),u=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=d,n.BackgroundStyle=u}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=a(0),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}var c={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},d=new o.default.Attributor.Attribute("direction","dir",c),u=new o.default.Attributor.Class("direction","ql-direction",c),f=new o.default.Attributor.Style("direction","direction",c);n.DirectionAttribute=d,n.DirectionClass=u,n.DirectionStyle=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=(function(){function x(b,y){for(var w=0;w<y.length;w++){var j=y[w];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,y,w){return y&&x(b.prototype,y),w&&x(b,w),b}})(),o=function x(b,y,w){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,y);if(j===void 0){var N=Object.getPrototypeOf(b);return N===null?void 0:x(N,y,w)}else{if("value"in j)return j.value;var E=j.get;return E===void 0?void 0:E.call(w)}},l=a(0),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function f(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function h(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var m={scope:c.default.Scope.INLINE,whitelist:["serif","monospace"]},p=new c.default.Attributor.Class("font","ql-font",m),v=(function(x){h(b,x);function b(){return u(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"value",value:function(w){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,w).replace(/["']/g,"")}}]),b})(c.default.Attributor.Style),g=new v("font","font-family",m);n.FontStyle=g,n.FontClass=p}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=a(0),o=l(s);function l(u){return u&&u.__esModule?u:{default:u}}var c=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),d=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=c,n.SizeStyle=d}),(function(r,n,a){r.exports={align:{"":a(76),center:a(77),right:a(78),justify:a(79)},background:a(80),blockquote:a(81),bold:a(82),clean:a(83),code:a(58),"code-block":a(58),color:a(84),direction:{"":a(85),rtl:a(86)},float:{center:a(87),full:a(88),left:a(89),right:a(90)},formula:a(91),header:{1:a(92),2:a(93)},italic:a(94),image:a(95),indent:{"+1":a(96),"-1":a(97)},link:a(98),list:{ordered:a(99),bullet:a(100),check:a(101)},script:{sub:a(102),super:a(103)},strike:a(104),underline:a(105),video:a(106)}}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=(function(){function y(w,j){for(var N=0;N<j.length;N++){var E=j[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,j,N){return j&&y(w.prototype,j),N&&y(w,N),w}})(),o=a(0),l=h(o),c=a(5),d=h(c),u=a(9),f=h(u);function h(y){return y&&y.__esModule?y:{default:y}}function m(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}function p(y,w){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:y}function v(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(y,w):y.__proto__=w)}var g=(function(y){v(w,y);function w(j,N){m(this,w);var E=p(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,j,N));return E.lastRecorded=0,E.ignoreChange=!1,E.clear(),E.quill.on(d.default.events.EDITOR_CHANGE,function(S,O,k,T){S!==d.default.events.TEXT_CHANGE||E.ignoreChange||(!E.options.userOnly||T===d.default.sources.USER?E.record(O,k):E.transform(O))}),E.quill.keyboard.addBinding({key:"Z",shortKey:!0},E.undo.bind(E)),E.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},E.redo.bind(E)),/Win/i.test(navigator.platform)&&E.quill.keyboard.addBinding({key:"Y",shortKey:!0},E.redo.bind(E)),E}return s(w,[{key:"change",value:function(N,E){if(this.stack[N].length!==0){var S=this.stack[N].pop();this.stack[E].push(S),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(S[N],d.default.sources.USER),this.ignoreChange=!1;var O=b(S[N]);this.quill.setSelection(O)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(N,E){if(N.ops.length!==0){this.stack.redo=[];var S=this.quill.getContents().diff(E),O=Date.now();if(this.lastRecorded+this.options.delay>O&&this.stack.undo.length>0){var k=this.stack.undo.pop();S=S.compose(k.undo),N=k.redo.compose(N)}else this.lastRecorded=O;this.stack.undo.push({redo:N,undo:S}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(N){this.stack.undo.forEach(function(E){E.undo=N.transform(E.undo,!0),E.redo=N.transform(E.redo,!0)}),this.stack.redo.forEach(function(E){E.undo=N.transform(E.undo,!0),E.redo=N.transform(E.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),w})(f.default);g.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function x(y){var w=y.ops[y.ops.length-1];return w==null?!1:w.insert!=null?typeof w.insert=="string"&&w.insert.endsWith(`
`):w.attributes!=null?Object.keys(w.attributes).some(function(j){return l.default.query(j,l.default.Scope.BLOCK)!=null}):!1}function b(y){var w=y.reduce(function(N,E){return N+=E.delete||0,N},0),j=y.length()-w;return x(y)&&(j-=1),j}n.default=g,n.getLastChangeIndex=b}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=(function(){function D(L,q){for(var I=0;I<q.length;I++){var R=q[I];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(L,R.key,R)}}return function(L,q,I){return q&&D(L.prototype,q),I&&D(L,I),L}})(),o=function D(L,q,I){L===null&&(L=Function.prototype);var R=Object.getOwnPropertyDescriptor(L,q);if(R===void 0){var X=Object.getPrototypeOf(L);return X===null?void 0:D(X,q,I)}else{if("value"in R)return R.value;var ae=R.get;return ae===void 0?void 0:ae.call(I)}},l=a(3),c=O(l),d=a(2),u=O(d),f=a(8),h=O(f),m=a(23),p=O(m),v=a(34),g=O(v),x=a(59),b=O(x),y=a(60),w=O(y),j=a(28),N=O(j),E=a(61),S=O(E);function O(D){return D&&D.__esModule?D:{default:D}}function k(D,L){if(!(D instanceof L))throw new TypeError("Cannot call a class as a function")}function T(D,L){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L&&(typeof L=="object"||typeof L=="function")?L:D}function A(D,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof L);D.prototype=Object.create(L&&L.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),L&&(Object.setPrototypeOf?Object.setPrototypeOf(D,L):D.__proto__=L)}var P=[!1,"center","right","justify"],C=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],F=[!1,"serif","monospace"],M=["1","2","3",!1],H=["small",!1,"large","huge"],V=(function(D){A(L,D);function L(q,I){k(this,L);var R=T(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,q,I)),X=function ae(Z){if(!document.body.contains(q.root))return document.body.removeEventListener("click",ae);R.tooltip!=null&&!R.tooltip.root.contains(Z.target)&&document.activeElement!==R.tooltip.textbox&&!R.quill.hasFocus()&&R.tooltip.hide(),R.pickers!=null&&R.pickers.forEach(function(ee){ee.container.contains(Z.target)||ee.close()})};return q.emitter.listenDOM("click",document.body,X),R}return s(L,[{key:"addModule",value:function(I){var R=o(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"addModule",this).call(this,I);return I==="toolbar"&&this.extendToolbar(R),R}},{key:"buildButtons",value:function(I,R){I.forEach(function(X){var ae=X.getAttribute("class")||"";ae.split(/\s+/).forEach(function(Z){if(Z.startsWith("ql-")&&(Z=Z.slice(3),R[Z]!=null))if(Z==="direction")X.innerHTML=R[Z][""]+R[Z].rtl;else if(typeof R[Z]=="string")X.innerHTML=R[Z];else{var ee=X.value||"";ee!=null&&R[Z][ee]&&(X.innerHTML=R[Z][ee])}})})}},{key:"buildPickers",value:function(I,R){var X=this;this.pickers=I.map(function(Z){if(Z.classList.contains("ql-align"))return Z.querySelector("option")==null&&z(Z,P),new w.default(Z,R.align);if(Z.classList.contains("ql-background")||Z.classList.contains("ql-color")){var ee=Z.classList.contains("ql-background")?"background":"color";return Z.querySelector("option")==null&&z(Z,C,ee==="background"?"#ffffff":"#000000"),new b.default(Z,R[ee])}else return Z.querySelector("option")==null&&(Z.classList.contains("ql-font")?z(Z,F):Z.classList.contains("ql-header")?z(Z,M):Z.classList.contains("ql-size")&&z(Z,H)),new N.default(Z)});var ae=function(){X.pickers.forEach(function(ee){ee.update()})};this.quill.on(h.default.events.EDITOR_CHANGE,ae)}}]),L})(g.default);V.DEFAULTS=(0,c.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var L=this,q=this.container.querySelector("input.ql-image[type=file]");q==null&&(q=document.createElement("input"),q.setAttribute("type","file"),q.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),q.classList.add("ql-image"),q.addEventListener("change",function(){if(q.files!=null&&q.files[0]!=null){var I=new FileReader;I.onload=function(R){var X=L.quill.getSelection(!0);L.quill.updateContents(new u.default().retain(X.index).delete(X.length).insert({image:R.target.result}),h.default.sources.USER),L.quill.setSelection(X.index+1,h.default.sources.SILENT),q.value=""},I.readAsDataURL(q.files[0])}}),this.container.appendChild(q)),q.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var B=(function(D){A(L,D);function L(q,I){k(this,L);var R=T(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,q,I));return R.textbox=R.root.querySelector('input[type="text"]'),R.listen(),R}return s(L,[{key:"listen",value:function(){var I=this;this.textbox.addEventListener("keydown",function(R){p.default.match(R,"enter")?(I.save(),R.preventDefault()):p.default.match(R,"escape")&&(I.cancel(),R.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),R!=null?this.textbox.value=R:I!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+I)||""),this.root.setAttribute("data-mode",I)}},{key:"restoreFocus",value:function(){var I=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=I}},{key:"save",value:function(){var I=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var R=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",I,h.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",I,h.default.sources.USER)),this.quill.root.scrollTop=R;break}case"video":I=W(I);case"formula":{if(!I)break;var X=this.quill.getSelection(!0);if(X!=null){var ae=X.index+X.length;this.quill.insertEmbed(ae,this.root.getAttribute("data-mode"),I,h.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(ae+1," ",h.default.sources.USER),this.quill.setSelection(ae+2,h.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),L})(S.default);function W(D){var L=D.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||D.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return L?(L[1]||"https")+"://www.youtube.com/embed/"+L[2]+"?showinfo=0":(L=D.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(L[1]||"https")+"://player.vimeo.com/video/"+L[2]+"/":D}function z(D,L){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;L.forEach(function(I){var R=document.createElement("option");I===q?R.setAttribute("selected","selected"):R.setAttribute("value",I),D.appendChild(R)})}n.BaseTooltip=B,n.default=V}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var c,d=this.iterator();c=d();)if(c===l)return!0;return!1},o.prototype.insertBefore=function(l,c){l&&(l.next=c,c!=null?(l.prev=c.prev,c.prev!=null&&(c.prev.next=l),c.prev=l,c===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var c=0,d=this.head;d!=null;){if(d===l)return c;c+=d.length(),d=d.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var c=l;return l!=null&&(l=l.next),c}},o.prototype.find=function(l,c){c===void 0&&(c=!1);for(var d,u=this.iterator();d=u();){var f=d.length();if(l<f||c&&l===f&&(d.next==null||d.next.length()!==0))return[d,l];l-=f}return[null,0]},o.prototype.forEach=function(l){for(var c,d=this.iterator();c=d();)l(c)},o.prototype.forEachAt=function(l,c,d){if(!(c<=0))for(var u=this.find(l),f=u[0],h=u[1],m,p=l-h,v=this.iterator(f);(m=v())&&p<l+c;){var g=m.length();l>p?d(m,l-p,Math.min(c,p+g-l)):d(m,0,Math.min(g,l+c-p)),p+=g}},o.prototype.map=function(l){return this.reduce(function(c,d){return c.push(l(d)),c},[])},o.prototype.reduce=function(l,c){for(var d,u=this.iterator();d=u();)c=l(c,d);return c},o})();n.default=s}),(function(r,n,a){var s=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,m){h.__proto__=m}||function(h,m){for(var p in m)m.hasOwnProperty(p)&&(h[p]=m[p])};return function(h,m){f(h,m);function p(){this.constructor=h}h.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(17),l=a(1),c={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},d=100,u=(function(f){s(h,f);function h(m){var p=f.call(this,m)||this;return p.scroll=p,p.observer=new MutationObserver(function(v){p.update(v)}),p.observer.observe(p.domNode,c),p.attach(),p}return h.prototype.detach=function(){f.prototype.detach.call(this),this.observer.disconnect()},h.prototype.deleteAt=function(m,p){this.update(),m===0&&p===this.length()?this.children.forEach(function(v){v.remove()}):f.prototype.deleteAt.call(this,m,p)},h.prototype.formatAt=function(m,p,v,g){this.update(),f.prototype.formatAt.call(this,m,p,v,g)},h.prototype.insertAt=function(m,p,v){this.update(),f.prototype.insertAt.call(this,m,p,v)},h.prototype.optimize=function(m,p){var v=this;m===void 0&&(m=[]),p===void 0&&(p={}),f.prototype.optimize.call(this,p);for(var g=[].slice.call(this.observer.takeRecords());g.length>0;)m.push(g.pop());for(var x=function(j,N){N===void 0&&(N=!0),!(j==null||j===v)&&j.domNode.parentNode!=null&&(j.domNode[l.DATA_KEY].mutations==null&&(j.domNode[l.DATA_KEY].mutations=[]),N&&x(j.parent))},b=function(j){j.domNode[l.DATA_KEY]==null||j.domNode[l.DATA_KEY].mutations==null||(j instanceof o.default&&j.children.forEach(b),j.optimize(p))},y=m,w=0;y.length>0;w+=1){if(w>=d)throw new Error("[Parchment] Maximum optimize iterations reached");for(y.forEach(function(j){var N=l.find(j.target,!0);N!=null&&(N.domNode===j.target&&(j.type==="childList"?(x(l.find(j.previousSibling,!1)),[].forEach.call(j.addedNodes,function(E){var S=l.find(E,!1);x(S,!1),S instanceof o.default&&S.children.forEach(function(O){x(O,!1)})})):j.type==="attributes"&&x(N.prev)),x(N))}),this.children.forEach(b),y=[].slice.call(this.observer.takeRecords()),g=y.slice();g.length>0;)m.push(g.pop())}},h.prototype.update=function(m,p){var v=this;p===void 0&&(p={}),m=m||this.observer.takeRecords(),m.map(function(g){var x=l.find(g.target,!0);return x==null?null:x.domNode[l.DATA_KEY].mutations==null?(x.domNode[l.DATA_KEY].mutations=[g],x):(x.domNode[l.DATA_KEY].mutations.push(g),null)}).forEach(function(g){g==null||g===v||g.domNode[l.DATA_KEY]==null||g.update(g.domNode[l.DATA_KEY].mutations||[],p)}),this.domNode[l.DATA_KEY].mutations!=null&&f.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,p),this.optimize(m,p)},h.blotName="scroll",h.defaultChild="block",h.scope=l.Scope.BLOCK_BLOT,h.tagName="DIV",h})(o.default);n.default=u}),(function(r,n,a){var s=this&&this.__extends||(function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,h){f.__proto__=h}||function(f,h){for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m])};return function(f,h){u(f,h);function m(){this.constructor=f}f.prototype=h===null?Object.create(h):(m.prototype=h.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(18),l=a(1);function c(u,f){if(Object.keys(u).length!==Object.keys(f).length)return!1;for(var h in u)if(u[h]!==f[h])return!1;return!0}var d=(function(u){s(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(h){if(h.tagName!==f.tagName)return u.formats.call(this,h)},f.prototype.format=function(h,m){var p=this;h===this.statics.blotName&&!m?(this.children.forEach(function(v){v instanceof o.default||(v=v.wrap(f.blotName,!0)),p.attributes.copy(v)}),this.unwrap()):u.prototype.format.call(this,h,m)},f.prototype.formatAt=function(h,m,p,v){if(this.formats()[p]!=null||l.query(p,l.Scope.ATTRIBUTE)){var g=this.isolate(h,m);g.format(p,v)}else u.prototype.formatAt.call(this,h,m,p,v)},f.prototype.optimize=function(h){u.prototype.optimize.call(this,h);var m=this.formats();if(Object.keys(m).length===0)return this.unwrap();var p=this.next;p instanceof f&&p.prev===this&&c(m,p.formats())&&(p.moveChildren(this),p.remove())},f.blotName="inline",f.scope=l.Scope.INLINE_BLOT,f.tagName="SPAN",f})(o.default);n.default=d}),(function(r,n,a){var s=this&&this.__extends||(function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(18),l=a(1),c=(function(d){s(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.formats=function(f){var h=l.query(u.blotName).tagName;if(f.tagName!==h)return d.formats.call(this,f)},u.prototype.format=function(f,h){l.query(f,l.Scope.BLOCK)!=null&&(f===this.statics.blotName&&!h?this.replaceWith(u.blotName):d.prototype.format.call(this,f,h))},u.prototype.formatAt=function(f,h,m,p){l.query(m,l.Scope.BLOCK)!=null?this.format(m,p):d.prototype.formatAt.call(this,f,h,m,p)},u.prototype.insertAt=function(f,h,m){if(m==null||l.query(h,l.Scope.INLINE)!=null)d.prototype.insertAt.call(this,f,h,m);else{var p=this.split(f),v=l.create(h,m);p.parent.insertBefore(v,p)}},u.prototype.update=function(f,h){navigator.userAgent.match(/Trident/)?this.build():d.prototype.update.call(this,f,h)},u.blotName="block",u.scope=l.Scope.BLOCK_BLOT,u.tagName="P",u})(o.default);n.default=c}),(function(r,n,a){var s=this&&this.__extends||(function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,u){d.__proto__=u}||function(d,u){for(var f in u)u.hasOwnProperty(f)&&(d[f]=u[f])};return function(d,u){c(d,u);function f(){this.constructor=d}d.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(19),l=(function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.formats=function(u){},d.prototype.format=function(u,f){c.prototype.formatAt.call(this,0,this.length(),u,f)},d.prototype.formatAt=function(u,f,h,m){u===0&&f===this.length()?this.format(h,m):c.prototype.formatAt.call(this,u,f,h,m)},d.prototype.formats=function(){return this.statics.formats(this.domNode)},d})(o.default);n.default=l}),(function(r,n,a){var s=this&&this.__extends||(function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=a(19),l=a(1),c=(function(d){s(u,d);function u(f){var h=d.call(this,f)||this;return h.text=h.statics.value(h.domNode),h}return u.create=function(f){return document.createTextNode(f)},u.value=function(f){var h=f.data;return h.normalize&&(h=h.normalize()),h},u.prototype.deleteAt=function(f,h){this.domNode.data=this.text=this.text.slice(0,f)+this.text.slice(f+h)},u.prototype.index=function(f,h){return this.domNode===f?h:-1},u.prototype.insertAt=function(f,h,m){m==null?(this.text=this.text.slice(0,f)+h+this.text.slice(f),this.domNode.data=this.text):d.prototype.insertAt.call(this,f,h,m)},u.prototype.length=function(){return this.text.length},u.prototype.optimize=function(f){d.prototype.optimize.call(this,f),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof u&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},u.prototype.position=function(f,h){return[this.domNode,f]},u.prototype.split=function(f,h){if(h===void 0&&(h=!1),!h){if(f===0)return this;if(f===this.length())return this.next}var m=l.create(this.domNode.splitText(f));return this.parent.insertBefore(m,this.next),this.text=this.statics.value(this.domNode),m},u.prototype.update=function(f,h){var m=this;f.some(function(p){return p.type==="characterData"&&p.target===m.domNode})&&(this.text=this.statics.value(this.domNode))},u.prototype.value=function(){return this.text},u.blotName="text",u.scope=l.Scope.INLINE_BLOT,u})(o.default);n.default=c}),(function(r,n,a){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,c){return arguments.length>1&&!this.contains(l)==!c?c:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,c){return c=c||0,this.substr(c,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,c){var d=this.toString();(typeof c!="number"||!isFinite(c)||Math.floor(c)!==c||c>d.length)&&(c=d.length),c-=l.length;var u=d.indexOf(l,c);return u!==-1&&u===c}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(c){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof c!="function")throw new TypeError("predicate must be a function");for(var d=Object(this),u=d.length>>>0,f=arguments[1],h,m=0;m<u;m++)if(h=d[m],c.call(f,h,m,d))return h}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})}),(function(r,n){var a=-1,s=1,o=0;function l(w,j,N){if(w==j)return w?[[o,w]]:[];(N<0||w.length<N)&&(N=null);var E=f(w,j),S=w.substring(0,E);w=w.substring(E),j=j.substring(E),E=h(w,j);var O=w.substring(w.length-E);w=w.substring(0,w.length-E),j=j.substring(0,j.length-E);var k=c(w,j);return S&&k.unshift([o,S]),O&&k.push([o,O]),p(k),N!=null&&(k=x(k,N)),k=b(k),k}function c(w,j){var N;if(!w)return[[s,j]];if(!j)return[[a,w]];var E=w.length>j.length?w:j,S=w.length>j.length?j:w,O=E.indexOf(S);if(O!=-1)return N=[[s,E.substring(0,O)],[o,S],[s,E.substring(O+S.length)]],w.length>j.length&&(N[0][0]=N[2][0]=a),N;if(S.length==1)return[[a,w],[s,j]];var k=m(w,j);if(k){var T=k[0],A=k[1],P=k[2],C=k[3],F=k[4],M=l(T,P),H=l(A,C);return M.concat([[o,F]],H)}return d(w,j)}function d(w,j){for(var N=w.length,E=j.length,S=Math.ceil((N+E)/2),O=S,k=2*S,T=new Array(k),A=new Array(k),P=0;P<k;P++)T[P]=-1,A[P]=-1;T[O+1]=0,A[O+1]=0;for(var C=N-E,F=C%2!=0,M=0,H=0,V=0,B=0,W=0;W<S;W++){for(var z=-W+M;z<=W-H;z+=2){var D=O+z,L;z==-W||z!=W&&T[D-1]<T[D+1]?L=T[D+1]:L=T[D-1]+1;for(var q=L-z;L<N&&q<E&&w.charAt(L)==j.charAt(q);)L++,q++;if(T[D]=L,L>N)H+=2;else if(q>E)M+=2;else if(F){var I=O+C-z;if(I>=0&&I<k&&A[I]!=-1){var R=N-A[I];if(L>=R)return u(w,j,L,q)}}}for(var X=-W+V;X<=W-B;X+=2){var I=O+X,R;X==-W||X!=W&&A[I-1]<A[I+1]?R=A[I+1]:R=A[I-1]+1;for(var ae=R-X;R<N&&ae<E&&w.charAt(N-R-1)==j.charAt(E-ae-1);)R++,ae++;if(A[I]=R,R>N)B+=2;else if(ae>E)V+=2;else if(!F){var D=O+C-X;if(D>=0&&D<k&&T[D]!=-1){var L=T[D],q=O+L-D;if(R=N-R,L>=R)return u(w,j,L,q)}}}}return[[a,w],[s,j]]}function u(w,j,N,E){var S=w.substring(0,N),O=j.substring(0,E),k=w.substring(N),T=j.substring(E),A=l(S,O),P=l(k,T);return A.concat(P)}function f(w,j){if(!w||!j||w.charAt(0)!=j.charAt(0))return 0;for(var N=0,E=Math.min(w.length,j.length),S=E,O=0;N<S;)w.substring(O,S)==j.substring(O,S)?(N=S,O=N):E=S,S=Math.floor((E-N)/2+N);return S}function h(w,j){if(!w||!j||w.charAt(w.length-1)!=j.charAt(j.length-1))return 0;for(var N=0,E=Math.min(w.length,j.length),S=E,O=0;N<S;)w.substring(w.length-S,w.length-O)==j.substring(j.length-S,j.length-O)?(N=S,O=N):E=S,S=Math.floor((E-N)/2+N);return S}function m(w,j){var N=w.length>j.length?w:j,E=w.length>j.length?j:w;if(N.length<4||E.length*2<N.length)return null;function S(H,V,B){for(var W=H.substring(B,B+Math.floor(H.length/4)),z=-1,D="",L,q,I,R;(z=V.indexOf(W,z+1))!=-1;){var X=f(H.substring(B),V.substring(z)),ae=h(H.substring(0,B),V.substring(0,z));D.length<ae+X&&(D=V.substring(z-ae,z)+V.substring(z,z+X),L=H.substring(0,B-ae),q=H.substring(B+X),I=V.substring(0,z-ae),R=V.substring(z+X))}return D.length*2>=H.length?[L,q,I,R,D]:null}var O=S(N,E,Math.ceil(N.length/4)),k=S(N,E,Math.ceil(N.length/2)),T;if(!O&&!k)return null;k?O?T=O[4].length>k[4].length?O:k:T=k:T=O;var A,P,C,F;w.length>j.length?(A=T[0],P=T[1],C=T[2],F=T[3]):(C=T[0],F=T[1],A=T[2],P=T[3]);var M=T[4];return[A,P,C,F,M]}function p(w){w.push([o,""]);for(var j=0,N=0,E=0,S="",O="",k;j<w.length;)switch(w[j][0]){case s:E++,O+=w[j][1],j++;break;case a:N++,S+=w[j][1],j++;break;case o:N+E>1?(N!==0&&E!==0&&(k=f(O,S),k!==0&&(j-N-E>0&&w[j-N-E-1][0]==o?w[j-N-E-1][1]+=O.substring(0,k):(w.splice(0,0,[o,O.substring(0,k)]),j++),O=O.substring(k),S=S.substring(k)),k=h(O,S),k!==0&&(w[j][1]=O.substring(O.length-k)+w[j][1],O=O.substring(0,O.length-k),S=S.substring(0,S.length-k))),N===0?w.splice(j-E,N+E,[s,O]):E===0?w.splice(j-N,N+E,[a,S]):w.splice(j-N-E,N+E,[a,S],[s,O]),j=j-N-E+(N?1:0)+(E?1:0)+1):j!==0&&w[j-1][0]==o?(w[j-1][1]+=w[j][1],w.splice(j,1)):j++,E=0,N=0,S="",O="";break}w[w.length-1][1]===""&&w.pop();var T=!1;for(j=1;j<w.length-1;)w[j-1][0]==o&&w[j+1][0]==o&&(w[j][1].substring(w[j][1].length-w[j-1][1].length)==w[j-1][1]?(w[j][1]=w[j-1][1]+w[j][1].substring(0,w[j][1].length-w[j-1][1].length),w[j+1][1]=w[j-1][1]+w[j+1][1],w.splice(j-1,1),T=!0):w[j][1].substring(0,w[j+1][1].length)==w[j+1][1]&&(w[j-1][1]+=w[j+1][1],w[j][1]=w[j][1].substring(w[j+1][1].length)+w[j+1][1],w.splice(j+1,1),T=!0)),j++;T&&p(w)}var v=l;v.INSERT=s,v.DELETE=a,v.EQUAL=o,r.exports=v;function g(w,j){if(j===0)return[o,w];for(var N=0,E=0;E<w.length;E++){var S=w[E];if(S[0]===a||S[0]===o){var O=N+S[1].length;if(j===O)return[E+1,w];if(j<O){w=w.slice();var k=j-N,T=[S[0],S[1].slice(0,k)],A=[S[0],S[1].slice(k)];return w.splice(E,1,T,A),[E+1,w]}else N=O}}throw new Error("cursor_pos is out of bounds!")}function x(w,j){var N=g(w,j),E=N[1],S=N[0],O=E[S],k=E[S+1];if(O==null)return w;if(O[0]!==o)return w;if(k!=null&&O[1]+k[1]===k[1]+O[1])return E.splice(S,2,k,O),y(E,S,2);if(k!=null&&k[1].indexOf(O[1])===0){E.splice(S,2,[k[0],O[1]],[0,O[1]]);var T=k[1].slice(O[1].length);return T.length>0&&E.splice(S+2,0,[k[0],T]),y(E,S,3)}else return w}function b(w){for(var j=!1,N=function(k){return k.charCodeAt(0)>=56320&&k.charCodeAt(0)<=57343},E=function(k){return k.charCodeAt(k.length-1)>=55296&&k.charCodeAt(k.length-1)<=56319},S=2;S<w.length;S+=1)w[S-2][0]===o&&E(w[S-2][1])&&w[S-1][0]===a&&N(w[S-1][1])&&w[S][0]===s&&N(w[S][1])&&(j=!0,w[S-1][1]=w[S-2][1].slice(-1)+w[S-1][1],w[S][1]=w[S-2][1].slice(-1)+w[S][1],w[S-2][1]=w[S-2][1].slice(0,-1));if(!j)return w;for(var O=[],S=0;S<w.length;S+=1)w[S][1].length>0&&O.push(w[S]);return O}function y(w,j,N){for(var E=j+N-1;E>=0&&E>=j-1;E--)if(E+1<w.length){var S=w[E],O=w[E+1];S[0]===O[1]&&w.splice(E,2,[S[0],S[1]+O[1]])}return w}}),(function(r,n){n=r.exports=typeof Object.keys=="function"?Object.keys:a,n.shim=a;function a(s){var o=[];for(var l in s)o.push(l);return o}}),(function(r,n){var a=(function(){return Object.prototype.toString.call(arguments)})()=="[object Arguments]";n=r.exports=a?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}}),(function(r,n){var a=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,h;if(this._eventsCount===0)return u;for(h in f=this._events)a.call(f,h)&&u.push(s?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u,f){var h=s?s+u:u,m=this._events[h];if(f)return!!m;if(!m)return[];if(m.fn)return[m.fn];for(var p=0,v=m.length,g=new Array(v);p<v;p++)g[p]=m[p].fn;return g},c.prototype.emit=function(u,f,h,m,p,v){var g=s?s+u:u;if(!this._events[g])return!1;var x=this._events[g],b=arguments.length,y,w;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),b){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,f),!0;case 3:return x.fn.call(x.context,f,h),!0;case 4:return x.fn.call(x.context,f,h,m),!0;case 5:return x.fn.call(x.context,f,h,m,p),!0;case 6:return x.fn.call(x.context,f,h,m,p,v),!0}for(w=1,y=new Array(b-1);w<b;w++)y[w-1]=arguments[w];x.fn.apply(x.context,y)}else{var j=x.length,N;for(w=0;w<j;w++)switch(x[w].once&&this.removeListener(u,x[w].fn,void 0,!0),b){case 1:x[w].fn.call(x[w].context);break;case 2:x[w].fn.call(x[w].context,f);break;case 3:x[w].fn.call(x[w].context,f,h);break;case 4:x[w].fn.call(x[w].context,f,h,m);break;default:if(!y)for(N=1,y=new Array(b-1);N<b;N++)y[N-1]=arguments[N];x[w].fn.apply(x[w].context,y)}}return!0},c.prototype.on=function(u,f,h){var m=new l(f,h||this),p=s?s+u:u;return this._events[p]?this._events[p].fn?this._events[p]=[this._events[p],m]:this._events[p].push(m):(this._events[p]=m,this._eventsCount++),this},c.prototype.once=function(u,f,h){var m=new l(f,h||this,!0),p=s?s+u:u;return this._events[p]?this._events[p].fn?this._events[p]=[this._events[p],m]:this._events[p].push(m):(this._events[p]=m,this._eventsCount++),this},c.prototype.removeListener=function(u,f,h,m){var p=s?s+u:u;if(!this._events[p])return this;if(!f)return--this._eventsCount===0?this._events=new o:delete this._events[p],this;var v=this._events[p];if(v.fn)v.fn===f&&(!m||v.once)&&(!h||v.context===h)&&(--this._eventsCount===0?this._events=new o:delete this._events[p]);else{for(var g=0,x=[],b=v.length;g<b;g++)(v[g].fn!==f||m&&!v[g].once||h&&v[g].context!==h)&&x.push(v[g]);x.length?this._events[p]=x.length===1?x[0]:x:--this._eventsCount===0?this._events=new o:delete this._events[p]}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=s?s+u:u,this._events[f]&&(--this._eventsCount===0?this._events=new o:delete this._events[f])):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=s,c.EventEmitter=c,typeof r<"u"&&(r.exports=c)}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(he){return typeof he}:function(he){return he&&typeof Symbol=="function"&&he.constructor===Symbol&&he!==Symbol.prototype?"symbol":typeof he},o=(function(){function he(ue,je){var Oe=[],Ae=!0,Qe=!1,Ke=void 0;try{for(var et=ue[Symbol.iterator](),Qt;!(Ae=(Qt=et.next()).done)&&(Oe.push(Qt.value),!(je&&Oe.length===je));Ae=!0);}catch(Jr){Qe=!0,Ke=Jr}finally{try{!Ae&&et.return&&et.return()}finally{if(Qe)throw Ke}}return Oe}return function(ue,je){if(Array.isArray(ue))return ue;if(Symbol.iterator in Object(ue))return he(ue,je);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function he(ue,je){for(var Oe=0;Oe<je.length;Oe++){var Ae=je[Oe];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(ue,Ae.key,Ae)}}return function(ue,je,Oe){return je&&he(ue.prototype,je),Oe&&he(ue,Oe),ue}})(),c=a(3),d=A(c),u=a(2),f=A(u),h=a(0),m=A(h),p=a(5),v=A(p),g=a(10),x=A(g),b=a(9),y=A(b),w=a(36),j=a(37),N=a(13),E=A(N),S=a(26),O=a(38),k=a(39),T=a(40);function A(he){return he&&he.__esModule?he:{default:he}}function P(he,ue,je){return ue in he?Object.defineProperty(he,ue,{value:je,enumerable:!0,configurable:!0,writable:!0}):he[ue]=je,he}function C(he,ue){if(!(he instanceof ue))throw new TypeError("Cannot call a class as a function")}function F(he,ue){if(!he)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue&&(typeof ue=="object"||typeof ue=="function")?ue:he}function M(he,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ue);he.prototype=Object.create(ue&&ue.prototype,{constructor:{value:he,enumerable:!1,writable:!0,configurable:!0}}),ue&&(Object.setPrototypeOf?Object.setPrototypeOf(he,ue):he.__proto__=ue)}var H=(0,x.default)("quill:clipboard"),V="__ql-matcher",B=[[Node.TEXT_NODE,_e],[Node.TEXT_NODE,Se],["br",ie],[Node.ELEMENT_NODE,Se],[Node.ELEMENT_NODE,ee],[Node.ELEMENT_NODE,Re],[Node.ELEMENT_NODE,Z],[Node.ELEMENT_NODE,Le],["li",be],["b",ae.bind(ae,"bold")],["i",ae.bind(ae,"italic")],["style",U]],W=[w.AlignAttribute,O.DirectionAttribute].reduce(function(he,ue){return he[ue.keyName]=ue,he},{}),z=[w.AlignStyle,j.BackgroundStyle,S.ColorStyle,O.DirectionStyle,k.FontStyle,T.SizeStyle].reduce(function(he,ue){return he[ue.keyName]=ue,he},{}),D=(function(he){M(ue,he);function ue(je,Oe){C(this,ue);var Ae=F(this,(ue.__proto__||Object.getPrototypeOf(ue)).call(this,je,Oe));return Ae.quill.root.addEventListener("paste",Ae.onPaste.bind(Ae)),Ae.container=Ae.quill.addContainer("ql-clipboard"),Ae.container.setAttribute("contenteditable",!0),Ae.container.setAttribute("tabindex",-1),Ae.matchers=[],B.concat(Ae.options.matchers).forEach(function(Qe){var Ke=o(Qe,2),et=Ke[0],Qt=Ke[1];!Oe.matchVisual&&Qt===Re||Ae.addMatcher(et,Qt)}),Ae}return l(ue,[{key:"addMatcher",value:function(Oe,Ae){this.matchers.push([Oe,Ae])}},{key:"convert",value:function(Oe){if(typeof Oe=="string")return this.container.innerHTML=Oe.replace(/\>\r?\n +\</g,"><"),this.convert();var Ae=this.quill.getFormat(this.quill.selection.savedRange.index);if(Ae[E.default.blotName]){var Qe=this.container.innerText;return this.container.innerHTML="",new f.default().insert(Qe,P({},E.default.blotName,Ae[E.default.blotName]))}var Ke=this.prepareMatching(),et=o(Ke,2),Qt=et[0],Jr=et[1],it=X(this.container,Qt,Jr);return I(it,`
`)&&it.ops[it.ops.length-1].attributes==null&&(it=it.compose(new f.default().retain(it.length()-1).delete(1))),H.log("convert",this.container.innerHTML,it),this.container.innerHTML="",it}},{key:"dangerouslyPasteHTML",value:function(Oe,Ae){var Qe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.default.sources.API;if(typeof Oe=="string")this.quill.setContents(this.convert(Oe),Ae),this.quill.setSelection(0,v.default.sources.SILENT);else{var Ke=this.convert(Ae);this.quill.updateContents(new f.default().retain(Oe).concat(Ke),Qe),this.quill.setSelection(Oe+Ke.length(),v.default.sources.SILENT)}}},{key:"onPaste",value:function(Oe){var Ae=this;if(!(Oe.defaultPrevented||!this.quill.isEnabled())){var Qe=this.quill.getSelection(),Ke=new f.default().retain(Qe.index),et=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(v.default.sources.SILENT),setTimeout(function(){Ke=Ke.concat(Ae.convert()).delete(Qe.length),Ae.quill.updateContents(Ke,v.default.sources.USER),Ae.quill.setSelection(Ke.length()-Qe.length,v.default.sources.SILENT),Ae.quill.scrollingContainer.scrollTop=et,Ae.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Oe=this,Ae=[],Qe=[];return this.matchers.forEach(function(Ke){var et=o(Ke,2),Qt=et[0],Jr=et[1];switch(Qt){case Node.TEXT_NODE:Qe.push(Jr);break;case Node.ELEMENT_NODE:Ae.push(Jr);break;default:[].forEach.call(Oe.container.querySelectorAll(Qt),function(it){it[V]=it[V]||[],it[V].push(Jr)});break}}),[Ae,Qe]}}]),ue})(y.default);D.DEFAULTS={matchers:[],matchVisual:!0};function L(he,ue,je){return(typeof ue>"u"?"undefined":s(ue))==="object"?Object.keys(ue).reduce(function(Oe,Ae){return L(Oe,Ae,ue[Ae])},he):he.reduce(function(Oe,Ae){return Ae.attributes&&Ae.attributes[ue]?Oe.push(Ae):Oe.insert(Ae.insert,(0,d.default)({},P({},ue,je),Ae.attributes))},new f.default)}function q(he){if(he.nodeType!==Node.ELEMENT_NODE)return{};var ue="__ql-computed-style";return he[ue]||(he[ue]=window.getComputedStyle(he))}function I(he,ue){for(var je="",Oe=he.ops.length-1;Oe>=0&&je.length<ue.length;--Oe){var Ae=he.ops[Oe];if(typeof Ae.insert!="string")break;je=Ae.insert+je}return je.slice(-1*ue.length)===ue}function R(he){if(he.childNodes.length===0)return!1;var ue=q(he);return["block","list-item"].indexOf(ue.display)>-1}function X(he,ue,je){return he.nodeType===he.TEXT_NODE?je.reduce(function(Oe,Ae){return Ae(he,Oe)},new f.default):he.nodeType===he.ELEMENT_NODE?[].reduce.call(he.childNodes||[],function(Oe,Ae){var Qe=X(Ae,ue,je);return Ae.nodeType===he.ELEMENT_NODE&&(Qe=ue.reduce(function(Ke,et){return et(Ae,Ke)},Qe),Qe=(Ae[V]||[]).reduce(function(Ke,et){return et(Ae,Ke)},Qe)),Oe.concat(Qe)},new f.default):new f.default}function ae(he,ue,je){return L(je,he,!0)}function Z(he,ue){var je=m.default.Attributor.Attribute.keys(he),Oe=m.default.Attributor.Class.keys(he),Ae=m.default.Attributor.Style.keys(he),Qe={};return je.concat(Oe).concat(Ae).forEach(function(Ke){var et=m.default.query(Ke,m.default.Scope.ATTRIBUTE);et!=null&&(Qe[et.attrName]=et.value(he),Qe[et.attrName])||(et=W[Ke],et!=null&&(et.attrName===Ke||et.keyName===Ke)&&(Qe[et.attrName]=et.value(he)||void 0),et=z[Ke],et!=null&&(et.attrName===Ke||et.keyName===Ke)&&(et=z[Ke],Qe[et.attrName]=et.value(he)||void 0))}),Object.keys(Qe).length>0&&(ue=L(ue,Qe)),ue}function ee(he,ue){var je=m.default.query(he);if(je==null)return ue;if(je.prototype instanceof m.default.Embed){var Oe={},Ae=je.value(he);Ae!=null&&(Oe[je.blotName]=Ae,ue=new f.default().insert(Oe,je.formats(he)))}else typeof je.formats=="function"&&(ue=L(ue,je.blotName,je.formats(he)));return ue}function ie(he,ue){return I(ue,`
`)||ue.insert(`
`),ue}function U(){return new f.default}function be(he,ue){var je=m.default.query(he);if(je==null||je.blotName!=="list-item"||!I(ue,`
`))return ue;for(var Oe=-1,Ae=he.parentNode;!Ae.classList.contains("ql-clipboard");)(m.default.query(Ae)||{}).blotName==="list"&&(Oe+=1),Ae=Ae.parentNode;return Oe<=0?ue:ue.compose(new f.default().retain(ue.length()-1).retain(1,{indent:Oe}))}function Se(he,ue){return I(ue,`
`)||(R(he)||ue.length()>0&&he.nextSibling&&R(he.nextSibling))&&ue.insert(`
`),ue}function Re(he,ue){if(R(he)&&he.nextElementSibling!=null&&!I(ue,`

`)){var je=he.offsetHeight+parseFloat(q(he).marginTop)+parseFloat(q(he).marginBottom);he.nextElementSibling.offsetTop>he.offsetTop+je*1.5&&ue.insert(`
`)}return ue}function Le(he,ue){var je={},Oe=he.style||{};return Oe.fontStyle&&q(he).fontStyle==="italic"&&(je.italic=!0),Oe.fontWeight&&(q(he).fontWeight.startsWith("bold")||parseInt(q(he).fontWeight)>=700)&&(je.bold=!0),Object.keys(je).length>0&&(ue=L(ue,je)),parseFloat(Oe.textIndent||0)>0&&(ue=new f.default().insert("	").concat(ue)),ue}function _e(he,ue){var je=he.data;if(he.parentNode.tagName==="O:P")return ue.insert(je.trim());if(je.trim().length===0&&he.parentNode.classList.contains("ql-clipboard"))return ue;if(!q(he.parentNode).whiteSpace.startsWith("pre")){var Oe=function(Qe,Ke){return Ke=Ke.replace(/[^\u00a0]/g,""),Ke.length<1&&Qe?" ":Ke};je=je.replace(/\r\n/g," ").replace(/\n/g," "),je=je.replace(/\s\s+/g,Oe.bind(Oe,!0)),(he.previousSibling==null&&R(he.parentNode)||he.previousSibling!=null&&R(he.previousSibling))&&(je=je.replace(/^\s+/,Oe.bind(Oe,!1))),(he.nextSibling==null&&R(he.parentNode)||he.nextSibling!=null&&R(he.nextSibling))&&(je=je.replace(/\s+$/,Oe.bind(Oe,!1)))}return ue.insert(je)}n.default=D,n.matchAttributor=Z,n.matchBlot=ee,n.matchNewline=Se,n.matchSpacing=Re,n.matchText=_e}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function p(v,g){for(var x=0;x<g.length;x++){var b=g[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,g,x){return g&&p(v.prototype,g),x&&p(v,x),v}})(),o=function p(v,g,x){v===null&&(v=Function.prototype);var b=Object.getOwnPropertyDescriptor(v,g);if(b===void 0){var y=Object.getPrototypeOf(v);return y===null?void 0:p(y,g,x)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(x)}},l=a(6),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(){return u(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,[{key:"optimize",value:function(x){o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"optimize",this).call(this,x),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),v})(c.default);m.blotName="bold",m.tagName=["STRONG","B"],n.default=m}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=(function(){function T(A,P){var C=[],F=!0,M=!1,H=void 0;try{for(var V=A[Symbol.iterator](),B;!(F=(B=V.next()).done)&&(C.push(B.value),!(P&&C.length===P));F=!0);}catch(W){M=!0,H=W}finally{try{!F&&V.return&&V.return()}finally{if(M)throw H}}return C}return function(A,P){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return T(A,P);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function T(A,P){for(var C=0;C<P.length;C++){var F=P[C];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(A,F.key,F)}}return function(A,P,C){return P&&T(A.prototype,P),C&&T(A,C),A}})(),l=a(2),c=x(l),d=a(0),u=x(d),f=a(5),h=x(f),m=a(10),p=x(m),v=a(9),g=x(v);function x(T){return T&&T.__esModule?T:{default:T}}function b(T,A,P){return A in T?Object.defineProperty(T,A,{value:P,enumerable:!0,configurable:!0,writable:!0}):T[A]=P,T}function y(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}function w(T,A){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:T}function j(T,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);T.prototype=Object.create(A&&A.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(T,A):T.__proto__=A)}var N=(0,p.default)("quill:toolbar"),E=(function(T){j(A,T);function A(P,C){y(this,A);var F=w(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,P,C));if(Array.isArray(F.options.container)){var M=document.createElement("div");O(M,F.options.container),P.container.parentNode.insertBefore(M,P.container),F.container=M}else typeof F.options.container=="string"?F.container=document.querySelector(F.options.container):F.container=F.options.container;if(!(F.container instanceof HTMLElement)){var H;return H=N.error("Container required for toolbar",F.options),w(F,H)}return F.container.classList.add("ql-toolbar"),F.controls=[],F.handlers={},Object.keys(F.options.handlers).forEach(function(V){F.addHandler(V,F.options.handlers[V])}),[].forEach.call(F.container.querySelectorAll("button, select"),function(V){F.attach(V)}),F.quill.on(h.default.events.EDITOR_CHANGE,function(V,B){V===h.default.events.SELECTION_CHANGE&&F.update(B)}),F.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){var V=F.quill.selection.getRange(),B=s(V,1),W=B[0];F.update(W)}),F}return o(A,[{key:"addHandler",value:function(C,F){this.handlers[C]=F}},{key:"attach",value:function(C){var F=this,M=[].find.call(C.classList,function(V){return V.indexOf("ql-")===0});if(M){if(M=M.slice(3),C.tagName==="BUTTON"&&C.setAttribute("type","button"),this.handlers[M]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[M]==null){N.warn("ignoring attaching to disabled format",M,C);return}if(u.default.query(M)==null){N.warn("ignoring attaching to nonexistent format",M,C);return}}var H=C.tagName==="SELECT"?"change":"click";C.addEventListener(H,function(V){var B=void 0;if(C.tagName==="SELECT"){if(C.selectedIndex<0)return;var W=C.options[C.selectedIndex];W.hasAttribute("selected")?B=!1:B=W.value||!1}else C.classList.contains("ql-active")?B=!1:B=C.value||!C.hasAttribute("value"),V.preventDefault();F.quill.focus();var z=F.quill.selection.getRange(),D=s(z,1),L=D[0];if(F.handlers[M]!=null)F.handlers[M].call(F,B);else if(u.default.query(M).prototype instanceof u.default.Embed){if(B=prompt("Enter "+M),!B)return;F.quill.updateContents(new c.default().retain(L.index).delete(L.length).insert(b({},M,B)),h.default.sources.USER)}else F.quill.format(M,B,h.default.sources.USER);F.update(L)}),this.controls.push([M,C])}}},{key:"update",value:function(C){var F=C==null?{}:this.quill.getFormat(C);this.controls.forEach(function(M){var H=s(M,2),V=H[0],B=H[1];if(B.tagName==="SELECT"){var W=void 0;if(C==null)W=null;else if(F[V]==null)W=B.querySelector("option[selected]");else if(!Array.isArray(F[V])){var z=F[V];typeof z=="string"&&(z=z.replace(/\"/g,'\\"')),W=B.querySelector('option[value="'+z+'"]')}W==null?(B.value="",B.selectedIndex=-1):W.selected=!0}else if(C==null)B.classList.remove("ql-active");else if(B.hasAttribute("value")){var D=F[V]===B.getAttribute("value")||F[V]!=null&&F[V].toString()===B.getAttribute("value")||F[V]==null&&!B.getAttribute("value");B.classList.toggle("ql-active",D)}else B.classList.toggle("ql-active",F[V]!=null)})}}]),A})(g.default);E.DEFAULTS={};function S(T,A,P){var C=document.createElement("button");C.setAttribute("type","button"),C.classList.add("ql-"+A),P!=null&&(C.value=P),T.appendChild(C)}function O(T,A){Array.isArray(A[0])||(A=[A]),A.forEach(function(P){var C=document.createElement("span");C.classList.add("ql-formats"),P.forEach(function(F){if(typeof F=="string")S(C,F);else{var M=Object.keys(F)[0],H=F[M];Array.isArray(H)?k(C,M,H):S(C,M,H)}}),T.appendChild(C)})}function k(T,A,P){var C=document.createElement("select");C.classList.add("ql-"+A),P.forEach(function(F){var M=document.createElement("option");F!==!1?M.setAttribute("value",F):M.setAttribute("selected","selected"),C.appendChild(M)}),T.appendChild(C)}E.DEFAULTS={container:null,handlers:{clean:function(){var A=this,P=this.quill.getSelection();if(P!=null)if(P.length==0){var C=this.quill.getFormat();Object.keys(C).forEach(function(F){u.default.query(F,u.default.Scope.INLINE)!=null&&A.quill.format(F,!1)})}else this.quill.removeFormat(P,h.default.sources.USER)},direction:function(A){var P=this.quill.getFormat().align;A==="rtl"&&P==null?this.quill.format("align","right",h.default.sources.USER):!A&&P==="right"&&this.quill.format("align",!1,h.default.sources.USER),this.quill.format("direction",A,h.default.sources.USER)},indent:function(A){var P=this.quill.getSelection(),C=this.quill.getFormat(P),F=parseInt(C.indent||0);if(A==="+1"||A==="-1"){var M=A==="+1"?1:-1;C.direction==="rtl"&&(M*=-1),this.quill.format("indent",F+M,h.default.sources.USER)}},link:function(A){A===!0&&(A=prompt("Enter link URL:")),this.quill.format("link",A,h.default.sources.USER)},list:function(A){var P=this.quill.getSelection(),C=this.quill.getFormat(P);A==="check"?C.list==="checked"||C.list==="unchecked"?this.quill.format("list",!1,h.default.sources.USER):this.quill.format("list","unchecked",h.default.sources.USER):this.quill.format("list",A,h.default.sources.USER)}}},n.default=E,n.addControls=O}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function p(v,g){for(var x=0;x<g.length;x++){var b=g[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,g,x){return g&&p(v.prototype,g),x&&p(v,x),v}})(),o=function p(v,g,x){v===null&&(v=Function.prototype);var b=Object.getOwnPropertyDescriptor(v,g);if(b===void 0){var y=Object.getPrototypeOf(v);return y===null?void 0:p(y,g,x)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(x)}},l=a(28),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(g,x){u(this,v);var b=f(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,g));return b.label.innerHTML=x,b.container.classList.add("ql-color-picker"),[].slice.call(b.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(y){y.classList.add("ql-primary")}),b}return s(v,[{key:"buildItem",value:function(x){var b=o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"buildItem",this).call(this,x);return b.style.backgroundColor=x.getAttribute("value")||"",b}},{key:"selectItem",value:function(x,b){o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"selectItem",this).call(this,x,b);var y=this.label.querySelector(".ql-color-label"),w=x&&x.getAttribute("data-value")||"";y&&(y.tagName==="line"?y.style.stroke=w:y.style.fill=w)}}]),v})(c.default);n.default=m}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function p(v,g){for(var x=0;x<g.length;x++){var b=g[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,g,x){return g&&p(v.prototype,g),x&&p(v,x),v}})(),o=function p(v,g,x){v===null&&(v=Function.prototype);var b=Object.getOwnPropertyDescriptor(v,g);if(b===void 0){var y=Object.getPrototypeOf(v);return y===null?void 0:p(y,g,x)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(x)}},l=a(28),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(g,x){u(this,v);var b=f(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,g));return b.container.classList.add("ql-icon-picker"),[].forEach.call(b.container.querySelectorAll(".ql-picker-item"),function(y){y.innerHTML=x[y.getAttribute("data-value")||""]}),b.defaultItem=b.container.querySelector(".ql-selected"),b.selectItem(b.defaultItem),b}return s(v,[{key:"selectItem",value:function(x,b){o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"selectItem",this).call(this,x,b),x=x||this.defaultItem,this.label.innerHTML=x.innerHTML}}]),v})(c.default);n.default=m}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function c(d,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}return function(d,u,f){return u&&c(d.prototype,u),f&&c(d,f),d}})();function o(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}var l=(function(){function c(d,u){var f=this;o(this,c),this.quill=d,this.boundsContainer=u||document.body,this.root=d.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){f.root.style.marginTop=-1*f.quill.root.scrollTop+"px"}),this.hide()}return s(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(u){var f=u.left+u.width/2-this.root.offsetWidth/2,h=u.bottom+this.quill.root.scrollTop;this.root.style.left=f+"px",this.root.style.top=h+"px",this.root.classList.remove("ql-flip");var m=this.boundsContainer.getBoundingClientRect(),p=this.root.getBoundingClientRect(),v=0;if(p.right>m.right&&(v=m.right-p.right,this.root.style.left=f+v+"px"),p.left<m.left&&(v=m.left-p.left,this.root.style.left=f+v+"px"),p.bottom>m.bottom){var g=p.bottom-p.top,x=u.bottom-u.top+g;this.root.style.top=h-x+"px",this.root.classList.add("ql-flip")}return v}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c})();n.default=l}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function k(T,A){var P=[],C=!0,F=!1,M=void 0;try{for(var H=T[Symbol.iterator](),V;!(C=(V=H.next()).done)&&(P.push(V.value),!(A&&P.length===A));C=!0);}catch(B){F=!0,M=B}finally{try{!C&&H.return&&H.return()}finally{if(F)throw M}}return P}return function(T,A){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return k(T,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=function k(T,A,P){T===null&&(T=Function.prototype);var C=Object.getOwnPropertyDescriptor(T,A);if(C===void 0){var F=Object.getPrototypeOf(T);return F===null?void 0:k(F,A,P)}else{if("value"in C)return C.value;var M=C.get;return M===void 0?void 0:M.call(P)}},l=(function(){function k(T,A){for(var P=0;P<A.length;P++){var C=A[P];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(T,C.key,C)}}return function(T,A,P){return A&&k(T.prototype,A),P&&k(T,P),T}})(),c=a(3),d=y(c),u=a(8),f=y(u),h=a(43),m=y(h),p=a(27),v=y(p),g=a(15),x=a(41),b=y(x);function y(k){return k&&k.__esModule?k:{default:k}}function w(k,T){if(!(k instanceof T))throw new TypeError("Cannot call a class as a function")}function j(k,T){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:k}function N(k,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);k.prototype=Object.create(T&&T.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(k,T):k.__proto__=T)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],S=(function(k){N(T,k);function T(A,P){w(this,T),P.modules.toolbar!=null&&P.modules.toolbar.container==null&&(P.modules.toolbar.container=E);var C=j(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,A,P));return C.quill.container.classList.add("ql-snow"),C}return l(T,[{key:"extendToolbar",value:function(P){P.container.classList.add("ql-snow"),this.buildButtons([].slice.call(P.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(P.container.querySelectorAll("select")),b.default),this.tooltip=new O(this.quill,this.options.bounds),P.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(C,F){P.handlers.link.call(P,!F.format.link)})}}]),T})(m.default);S.DEFAULTS=(0,d.default)(!0,{},m.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(T){if(T){var A=this.quill.getSelection();if(A==null||A.length==0)return;var P=this.quill.getText(A);/^\S+@\S+\.\S+$/.test(P)&&P.indexOf("mailto:")!==0&&(P="mailto:"+P);var C=this.quill.theme.tooltip;C.edit("link",P)}else this.quill.format("link",!1)}}}}});var O=(function(k){N(T,k);function T(A,P){w(this,T);var C=j(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,A,P));return C.preview=C.root.querySelector("a.ql-preview"),C}return l(T,[{key:"listen",value:function(){var P=this;o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(C){P.root.classList.contains("ql-editing")?P.save():P.edit("link",P.preview.textContent),C.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(C){if(P.linkRange!=null){var F=P.linkRange;P.restoreFocus(),P.quill.formatText(F,"link",!1,f.default.sources.USER),delete P.linkRange}C.preventDefault(),P.hide()}),this.quill.on(f.default.events.SELECTION_CHANGE,function(C,F,M){if(C!=null){if(C.length===0&&M===f.default.sources.USER){var H=P.quill.scroll.descendant(v.default,C.index),V=s(H,2),B=V[0],W=V[1];if(B!=null){P.linkRange=new g.Range(C.index-W,B.length());var z=v.default.formats(B.domNode);P.preview.textContent=z,P.preview.setAttribute("href",z),P.show(),P.position(P.quill.getBounds(P.linkRange));return}}else delete P.linkRange;P.hide()}})}},{key:"show",value:function(){o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),T})(h.BaseTooltip);O.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=S}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(29),o=Ae(s),l=a(36),c=a(38),d=a(64),u=a(65),f=Ae(u),h=a(66),m=Ae(h),p=a(67),v=Ae(p),g=a(37),x=a(26),b=a(39),y=a(40),w=a(56),j=Ae(w),N=a(68),E=Ae(N),S=a(27),O=Ae(S),k=a(69),T=Ae(k),A=a(70),P=Ae(A),C=a(71),F=Ae(C),M=a(72),H=Ae(M),V=a(73),B=Ae(V),W=a(13),z=Ae(W),D=a(74),L=Ae(D),q=a(75),I=Ae(q),R=a(57),X=Ae(R),ae=a(41),Z=Ae(ae),ee=a(28),ie=Ae(ee),U=a(59),be=Ae(U),Se=a(60),Re=Ae(Se),Le=a(61),_e=Ae(Le),he=a(108),ue=Ae(he),je=a(62),Oe=Ae(je);function Ae(Qe){return Qe&&Qe.__esModule?Qe:{default:Qe}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":g.BackgroundClass,"attributors/class/color":x.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":b.FontClass,"attributors/class/size":y.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":g.BackgroundStyle,"attributors/style/color":x.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":b.FontStyle,"attributors/style/size":y.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":d.IndentClass,"formats/background":g.BackgroundStyle,"formats/color":x.ColorStyle,"formats/font":b.FontClass,"formats/size":y.SizeClass,"formats/blockquote":f.default,"formats/code-block":z.default,"formats/header":m.default,"formats/list":v.default,"formats/bold":j.default,"formats/code":W.Code,"formats/italic":E.default,"formats/link":O.default,"formats/script":T.default,"formats/strike":P.default,"formats/underline":F.default,"formats/image":H.default,"formats/video":B.default,"formats/list/item":p.ListItem,"modules/formula":L.default,"modules/syntax":I.default,"modules/toolbar":X.default,"themes/bubble":ue.default,"themes/snow":Oe.default,"ui/icons":Z.default,"ui/picker":ie.default,"ui/icon-picker":Re.default,"ui/color-picker":be.default,"ui/tooltip":_e.default},!0),n.default=o.default}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=(function(){function v(g,x){for(var b=0;b<x.length;b++){var y=x[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(g,y.key,y)}}return function(g,x,b){return x&&v(g.prototype,x),b&&v(g,b),g}})(),o=function v(g,x,b){g===null&&(g=Function.prototype);var y=Object.getOwnPropertyDescriptor(g,x);if(y===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,x,b)}else{if("value"in y)return y.value;var j=y.get;return j===void 0?void 0:j.call(b)}},l=a(0),c=d(l);function d(v){return v&&v.__esModule?v:{default:v}}function u(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function f(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function h(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var m=(function(v){h(g,v);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"add",value:function(b,y){if(y==="+1"||y==="-1"){var w=this.value(b)||0;y=y==="+1"?w+1:w-1}return y===0?(this.remove(b),!0):o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"add",this).call(this,b,y)}},{key:"canAdd",value:function(b,y){return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"canAdd",this).call(this,b,y)||o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"canAdd",this).call(this,b,parseInt(y))}},{key:"value",value:function(b){return parseInt(o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"value",this).call(this,b))||void 0}}]),g})(c.default.Attributor.Class),p=new m("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=p}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(4),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function d(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function u(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=(function(h){u(m,h);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m})(o.default);f.blotName="blockquote",f.tagName="blockquote",n.default=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function m(p,v){for(var g=0;g<v.length;g++){var x=v[g];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,v,g){return v&&m(p.prototype,v),g&&m(p,g),p}})(),o=a(4),l=c(o);function c(m){return m&&m.__esModule?m:{default:m}}function d(m,p){if(!(m instanceof p))throw new TypeError("Cannot call a class as a function")}function u(m,p){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:m}function f(m,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);m.prototype=Object.create(p&&p.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(m,p):m.__proto__=p)}var h=(function(m){f(p,m);function p(){return d(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,null,[{key:"formats",value:function(g){return this.tagName.indexOf(g.tagName)+1}}]),p})(l.default);h.blotName="header",h.tagName=["H1","H2","H3","H4","H5","H6"],n.default=h}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=(function(){function w(j,N){for(var E=0;E<N.length;E++){var S=N[E];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(j,S.key,S)}}return function(j,N,E){return N&&w(j.prototype,N),E&&w(j,E),j}})(),o=function w(j,N,E){j===null&&(j=Function.prototype);var S=Object.getOwnPropertyDescriptor(j,N);if(S===void 0){var O=Object.getPrototypeOf(j);return O===null?void 0:w(O,N,E)}else{if("value"in S)return S.value;var k=S.get;return k===void 0?void 0:k.call(E)}},l=a(0),c=m(l),d=a(4),u=m(d),f=a(25),h=m(f);function m(w){return w&&w.__esModule?w:{default:w}}function p(w,j,N){return j in w?Object.defineProperty(w,j,{value:N,enumerable:!0,configurable:!0,writable:!0}):w[j]=N,w}function v(w,j){if(!(w instanceof j))throw new TypeError("Cannot call a class as a function")}function g(w,j){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:w}function x(w,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);w.prototype=Object.create(j&&j.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(w,j):w.__proto__=j)}var b=(function(w){x(j,w);function j(){return v(this,j),g(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,[{key:"format",value:function(E,S){E===y.blotName&&!S?this.replaceWith(c.default.create(this.statics.scope)):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,E,S)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,S){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,S),this):(this.parent.unwrap(),o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replaceWith",this).call(this,E,S))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(j.__proto__||Object.getPrototypeOf(j),"formats",this).call(this,E)}}]),j})(u.default);b.blotName="list-item",b.tagName="LI";var y=(function(w){x(j,w),s(j,null,[{key:"create",value:function(E){var S=E==="ordered"?"OL":"UL",O=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,S);return(E==="checked"||E==="unchecked")&&O.setAttribute("data-checked",E==="checked"),O}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function j(N){v(this,j);var E=g(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,N)),S=function(k){if(k.target.parentNode===N){var T=E.statics.formats(N),A=c.default.find(k.target);T==="checked"?A.format("list","unchecked"):T==="unchecked"&&A.format("list","checked")}};return N.addEventListener("touchstart",S),N.addEventListener("mousedown",S),E}return s(j,[{key:"format",value:function(E,S){this.children.length>0&&this.children.tail.format(E,S)}},{key:"formats",value:function(){return p({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,S){if(E instanceof b)o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertBefore",this).call(this,E,S);else{var O=S==null?this.length():S.offset(this),k=this.split(O);k.parent.insertBefore(E,k)}}},{key:"optimize",value:function(E){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"optimize",this).call(this,E);var S=this.next;S!=null&&S.prev===this&&S.statics.blotName===this.statics.blotName&&S.domNode.tagName===this.domNode.tagName&&S.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(S.moveChildren(this),S.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var S=c.default.create(this.statics.defaultChild);E.moveChildren(S),this.appendChild(S)}o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replace",this).call(this,E)}}]),j})(h.default);y.blotName="list",y.scope=c.default.Scope.BLOCK_BLOT,y.tagName=["OL","UL"],y.defaultChild="list-item",y.allowedChildren=[b],n.ListItem=b,n.default=y}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(56),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function d(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function u(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=(function(h){u(m,h);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m})(o.default);f.blotName="italic",f.tagName=["EM","I"],n.default=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function p(v,g){for(var x=0;x<g.length;x++){var b=g[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,g,x){return g&&p(v.prototype,g),x&&p(v,x),v}})(),o=function p(v,g,x){v===null&&(v=Function.prototype);var b=Object.getOwnPropertyDescriptor(v,g);if(b===void 0){var y=Object.getPrototypeOf(v);return y===null?void 0:p(y,g,x)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(x)}},l=a(6),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var m=(function(p){h(v,p);function v(){return u(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,null,[{key:"create",value:function(x){return x==="super"?document.createElement("sup"):x==="sub"?document.createElement("sub"):o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,x)}},{key:"formats",value:function(x){if(x.tagName==="SUB")return"sub";if(x.tagName==="SUP")return"super"}}]),v})(c.default);m.blotName="script",m.tagName=["SUB","SUP"],n.default=m}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(6),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function d(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function u(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=(function(h){u(m,h);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m})(o.default);f.blotName="strike",f.tagName="S",n.default=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(6),o=l(s);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function d(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function u(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var f=(function(h){u(m,h);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m})(o.default);f.blotName="underline",f.tagName="U",n.default=f}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function g(x,b){for(var y=0;y<b.length;y++){var w=b[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}return function(x,b,y){return b&&g(x.prototype,b),y&&g(x,y),x}})(),o=function g(x,b,y){x===null&&(x=Function.prototype);var w=Object.getOwnPropertyDescriptor(x,b);if(w===void 0){var j=Object.getPrototypeOf(x);return j===null?void 0:g(j,b,y)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(y)}},l=a(0),c=u(l),d=a(27);function u(g){return g&&g.__esModule?g:{default:g}}function f(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function h(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function m(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var p=["alt","height","width"],v=(function(g){m(x,g);function x(){return f(this,x),h(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"format",value:function(y,w){p.indexOf(y)>-1?w?this.domNode.setAttribute(y,w):this.domNode.removeAttribute(y):o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"format",this).call(this,y,w)}}],[{key:"create",value:function(y){var w=o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,y);return typeof y=="string"&&w.setAttribute("src",this.sanitize(y)),w}},{key:"formats",value:function(y){return p.reduce(function(w,j){return y.hasAttribute(j)&&(w[j]=y.getAttribute(j)),w},{})}},{key:"match",value:function(y){return/\.(jpe?g|gif|png)$/.test(y)||/^data:image\/.+;base64/.test(y)}},{key:"sanitize",value:function(y){return(0,d.sanitize)(y,["http","https","data"])?y:"//:0"}},{key:"value",value:function(y){return y.getAttribute("src")}}]),x})(c.default.Embed);v.blotName="image",v.tagName="IMG",n.default=v}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=(function(){function g(x,b){for(var y=0;y<b.length;y++){var w=b[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}return function(x,b,y){return b&&g(x.prototype,b),y&&g(x,y),x}})(),o=function g(x,b,y){x===null&&(x=Function.prototype);var w=Object.getOwnPropertyDescriptor(x,b);if(w===void 0){var j=Object.getPrototypeOf(x);return j===null?void 0:g(j,b,y)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(y)}},l=a(4),c=a(27),d=u(c);function u(g){return g&&g.__esModule?g:{default:g}}function f(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function h(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function m(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var p=["height","width"],v=(function(g){m(x,g);function x(){return f(this,x),h(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"format",value:function(y,w){p.indexOf(y)>-1?w?this.domNode.setAttribute(y,w):this.domNode.removeAttribute(y):o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"format",this).call(this,y,w)}}],[{key:"create",value:function(y){var w=o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,y);return w.setAttribute("frameborder","0"),w.setAttribute("allowfullscreen",!0),w.setAttribute("src",this.sanitize(y)),w}},{key:"formats",value:function(y){return p.reduce(function(w,j){return y.hasAttribute(j)&&(w[j]=y.getAttribute(j)),w},{})}},{key:"sanitize",value:function(y){return d.default.sanitize(y)}},{key:"value",value:function(y){return y.getAttribute("src")}}]),x})(l.BlockEmbed);v.blotName="video",v.className="ql-video",v.tagName="IFRAME",n.default=v}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=(function(){function y(w,j){for(var N=0;N<j.length;N++){var E=j[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,j,N){return j&&y(w.prototype,j),N&&y(w,N),w}})(),o=function y(w,j,N){w===null&&(w=Function.prototype);var E=Object.getOwnPropertyDescriptor(w,j);if(E===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:y(S,j,N)}else{if("value"in E)return E.value;var O=E.get;return O===void 0?void 0:O.call(N)}},l=a(35),c=m(l),d=a(5),u=m(d),f=a(9),h=m(f);function m(y){return y&&y.__esModule?y:{default:y}}function p(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}function v(y,w){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:y}function g(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(y,w):y.__proto__=w)}var x=(function(y){g(w,y);function w(){return p(this,w),v(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,null,[{key:"create",value:function(N){var E=o(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,N);return typeof N=="string"&&(window.katex.render(N,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",N)),E}},{key:"value",value:function(N){return N.getAttribute("data-value")}}]),w})(c.default);x.blotName="formula",x.className="ql-formula",x.tagName="SPAN";var b=(function(y){g(w,y),s(w,null,[{key:"register",value:function(){u.default.register(x,!0)}}]);function w(){p(this,w);var j=v(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return j}return w})(h.default);n.FormulaBlot=x,n.default=b}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=(function(){function N(E,S){for(var O=0;O<S.length;O++){var k=S[O];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(E,k.key,k)}}return function(E,S,O){return S&&N(E.prototype,S),O&&N(E,O),E}})(),o=function N(E,S,O){E===null&&(E=Function.prototype);var k=Object.getOwnPropertyDescriptor(E,S);if(k===void 0){var T=Object.getPrototypeOf(E);return T===null?void 0:N(T,S,O)}else{if("value"in k)return k.value;var A=k.get;return A===void 0?void 0:A.call(O)}},l=a(0),c=v(l),d=a(5),u=v(d),f=a(9),h=v(f),m=a(13),p=v(m);function v(N){return N&&N.__esModule?N:{default:N}}function g(N,E){if(!(N instanceof E))throw new TypeError("Cannot call a class as a function")}function x(N,E){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:N}function b(N,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);N.prototype=Object.create(E&&E.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(N,E):N.__proto__=E)}var y=(function(N){b(E,N);function E(){return g(this,E),x(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,[{key:"replaceWith",value:function(O){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,O)}},{key:"highlight",value:function(O){var k=this.domNode.textContent;this.cachedText!==k&&((k.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=O(k),this.domNode.normalize(),this.attach()),this.cachedText=k)}}]),E})(p.default);y.className="ql-syntax";var w=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),j=(function(N){b(E,N),s(E,null,[{key:"register",value:function(){u.default.register(w,!0),u.default.register(y,!0)}}]);function E(S,O){g(this,E);var k=x(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,S,O));if(typeof k.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var T=null;return k.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(T),T=setTimeout(function(){k.highlight(),T=null},k.options.interval)}),k.highlight(),k}return s(E,[{key:"highlight",value:function(){var O=this;if(!this.quill.selection.composing){this.quill.update(u.default.sources.USER);var k=this.quill.getSelection();this.quill.scroll.descendants(y).forEach(function(T){T.highlight(O.options.highlight)}),this.quill.update(u.default.sources.SILENT),k!=null&&this.quill.setSelection(k,u.default.sources.SILENT)}}}]),E})(h.default);j.DEFAULTS={highlight:(function(){return window.hljs==null?null:function(N){var E=window.hljs.highlightAuto(N);return E.value}})(),interval:1e3},n.CodeBlock=y,n.CodeToken=w,n.default=j}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'}),(function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'}),(function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'}),(function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'}),(function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'}),(function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'}),(function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function E(S,O,k){S===null&&(S=Function.prototype);var T=Object.getOwnPropertyDescriptor(S,O);if(T===void 0){var A=Object.getPrototypeOf(S);return A===null?void 0:E(A,O,k)}else{if("value"in T)return T.value;var P=T.get;return P===void 0?void 0:P.call(k)}},o=(function(){function E(S,O){for(var k=0;k<O.length;k++){var T=O[k];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}return function(S,O,k){return O&&E(S.prototype,O),k&&E(S,k),S}})(),l=a(3),c=g(l),d=a(8),u=g(d),f=a(43),h=g(f),m=a(15),p=a(41),v=g(p);function g(E){return E&&E.__esModule?E:{default:E}}function x(E,S){if(!(E instanceof S))throw new TypeError("Cannot call a class as a function")}function b(E,S){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:E}function y(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);E.prototype=Object.create(S&&S.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(E,S):E.__proto__=S)}var w=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],j=(function(E){y(S,E);function S(O,k){x(this,S),k.modules.toolbar!=null&&k.modules.toolbar.container==null&&(k.modules.toolbar.container=w);var T=b(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,O,k));return T.quill.container.classList.add("ql-bubble"),T}return o(S,[{key:"extendToolbar",value:function(k){this.tooltip=new N(this.quill,this.options.bounds),this.tooltip.root.appendChild(k.container),this.buildButtons([].slice.call(k.container.querySelectorAll("button")),v.default),this.buildPickers([].slice.call(k.container.querySelectorAll("select")),v.default)}}]),S})(h.default);j.DEFAULTS=(0,c.default)(!0,{},h.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(S){S?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var N=(function(E){y(S,E);function S(O,k){x(this,S);var T=b(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,O,k));return T.quill.on(u.default.events.EDITOR_CHANGE,function(A,P,C,F){if(A===u.default.events.SELECTION_CHANGE)if(P!=null&&P.length>0&&F===u.default.sources.USER){T.show(),T.root.style.left="0px",T.root.style.width="",T.root.style.width=T.root.offsetWidth+"px";var M=T.quill.getLines(P.index,P.length);if(M.length===1)T.position(T.quill.getBounds(P));else{var H=M[M.length-1],V=T.quill.getIndex(H),B=Math.min(H.length()-1,P.index+P.length-V),W=T.quill.getBounds(new m.Range(V,B));T.position(W)}}else document.activeElement!==T.textbox&&T.quill.hasFocus()&&T.hide()}),T}return o(S,[{key:"listen",value:function(){var k=this;s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){k.root.classList.remove("ql-editing")}),this.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!k.root.classList.contains("ql-hidden")){var T=k.quill.getSelection();T!=null&&k.position(k.quill.getBounds(T))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(k){var T=s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"position",this).call(this,k),A=this.root.querySelector(".ql-tooltip-arrow");if(A.style.marginLeft="",T===0)return T;A.style.marginLeft=-1*T-A.offsetWidth/2+"px"}}]),S})(f.BaseTooltip);N.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=N,n.default=j}),(function(r,n,a){r.exports=a(63)})]).default})})(fu)),fu.exports}var ca,sS;function gfe(){if(sS)return ca;sS=1;var e=ca&&ca.__extends||(function(){var u=function(f,h){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var v in p)p.hasOwnProperty(v)&&(m[v]=p[v])},u(f,h)};return function(f,h){u(f,h);function m(){this.constructor=f}f.prototype=h===null?Object.create(h):(m.prototype=h.prototype,new m)}})(),t=ca&&ca.__assign||function(){return t=Object.assign||function(u){for(var f,h=1,m=arguments.length;h<m;h++){f=arguments[h];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(u[p]=f[p])}return u},t.apply(this,arguments)},r=ca&&ca.__spreadArrays||function(){for(var u=0,f=0,h=arguments.length;f<h;f++)u+=arguments[f].length;for(var m=Array(u),p=0,f=0;f<h;f++)for(var v=arguments[f],g=0,x=v.length;g<x;g++,p++)m[p]=v[g];return m},n=ca&&ca.__importDefault||function(u){return u&&u.__esModule?u:{default:u}},a=n(vd()),s=n(cS()),o=n(mfe()),l=n(vfe()),c=(function(u){e(f,u);function f(h){var m=u.call(this,h)||this;m.dirtyProps=["modules","formats","bounds","theme","children"],m.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],m.state={generation:0},m.selection=null,m.onEditorChange=function(v,g,x,b){var y,w,j,N;v==="text-change"?(w=(y=m).onEditorChangeText)===null||w===void 0||w.call(y,m.editor.root.innerHTML,g,b,m.unprivilegedEditor):v==="selection-change"&&((N=(j=m).onEditorChangeSelection)===null||N===void 0||N.call(j,g,b,m.unprivilegedEditor))};var p=m.isControlled()?h.value:h.defaultValue;return m.value=p??"",m}return f.prototype.validateProps=function(h){var m;if(a.default.Children.count(h.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(a.default.Children.count(h.children)){var p=a.default.Children.only(h.children);if(((m=p)===null||m===void 0?void 0:m.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&h.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},f.prototype.shouldComponentUpdate=function(h,m){var p=this,v;if(this.validateProps(h),!this.editor||this.state.generation!==m.generation)return!0;if("value"in h){var g=this.getEditorContents(),x=(v=h.value,v??"");this.isEqualValue(x,g)||this.setEditorContents(this.editor,x)}return h.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,h.readOnly),r(this.cleanProps,this.dirtyProps).some(function(b){return!o.default(h[b],p.props[b])})},f.prototype.shouldComponentRegenerate=function(h){var m=this;return this.dirtyProps.some(function(p){return!o.default(h[p],m.props[p])})},f.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},f.prototype.componentWillUnmount=function(){this.destroyEditor()},f.prototype.componentDidUpdate=function(h,m){var p=this;if(this.editor&&this.shouldComponentRegenerate(h)){var v=this.editor.getContents(),g=this.editor.getSelection();this.regenerationSnapshot={delta:v,selection:g},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==m.generation){var x=this.regenerationSnapshot,v=x.delta,b=x.selection;delete this.regenerationSnapshot,this.instantiateEditor();var y=this.editor;y.setContents(v),d(function(){return p.setEditorSelection(y,b)})}},f.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},f.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},f.prototype.isControlled=function(){return"value"in this.props},f.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},f.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},f.prototype.createEditor=function(h,m){var p=new l.default(h,m);return m.tabIndex!=null&&this.setEditorTabIndex(p,m.tabIndex),this.hookEditor(p),p},f.prototype.hookEditor=function(h){this.unprivilegedEditor=this.makeUnprivilegedEditor(h),h.on("editor-change",this.onEditorChange)},f.prototype.unhookEditor=function(h){h.off("editor-change",this.onEditorChange)},f.prototype.getEditorContents=function(){return this.value},f.prototype.getEditorSelection=function(){return this.selection},f.prototype.isDelta=function(h){return h&&h.ops},f.prototype.isEqualValue=function(h,m){return this.isDelta(h)&&this.isDelta(m)?o.default(h.ops,m.ops):o.default(h,m)},f.prototype.setEditorContents=function(h,m){var p=this;this.value=m;var v=this.getEditorSelection();typeof m=="string"?h.setContents(h.clipboard.convert(m)):h.setContents(m),d(function(){return p.setEditorSelection(h,v)})},f.prototype.setEditorSelection=function(h,m){if(this.selection=m,m){var p=h.getLength();m.index=Math.max(0,Math.min(m.index,p-1)),m.length=Math.max(0,Math.min(m.length,p-1-m.index)),h.setSelection(m)}},f.prototype.setEditorTabIndex=function(h,m){var p,v;!((v=(p=h)===null||p===void 0?void 0:p.scroll)===null||v===void 0)&&v.domNode&&(h.scroll.domNode.tabIndex=m)},f.prototype.setEditorReadOnly=function(h,m){m?h.disable():h.enable()},f.prototype.makeUnprivilegedEditor=function(h){var m=h;return{getHTML:function(){return m.root.innerHTML},getLength:m.getLength.bind(m),getText:m.getText.bind(m),getContents:m.getContents.bind(m),getSelection:m.getSelection.bind(m),getBounds:m.getBounds.bind(m)}},f.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var h=s.default.findDOMNode(this.editingArea);if(!h)throw new Error("Cannot find element for editing area");if(h.nodeType===3)throw new Error("Editing area cannot be a text node");return h},f.prototype.renderEditingArea=function(){var h=this,m=this.props,p=m.children,v=m.preserveWhitespace,g=this.state.generation,x={key:g,ref:function(b){h.editingArea=b}};return a.default.Children.count(p)?a.default.cloneElement(a.default.Children.only(p),x):v?a.default.createElement("pre",t({},x)):a.default.createElement("div",t({},x))},f.prototype.render=function(){var h;return a.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(h=this.props.className,h??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},f.prototype.onEditorChangeText=function(h,m,p,v){var g,x;if(this.editor){var b=this.isDelta(this.value)?v.getContents():v.getHTML();b!==this.getEditorContents()&&(this.lastDeltaChangeSet=m,this.value=b,(x=(g=this.props).onChange)===null||x===void 0||x.call(g,h,m,p,v))}},f.prototype.onEditorChangeSelection=function(h,m,p){var v,g,x,b,y,w;if(this.editor){var j=this.getEditorSelection(),N=!j&&h,E=j&&!h;o.default(h,j)||(this.selection=h,(g=(v=this.props).onChangeSelection)===null||g===void 0||g.call(v,h,m,p),N?(b=(x=this.props).onFocus)===null||b===void 0||b.call(x,h,m,p):E&&((w=(y=this.props).onBlur)===null||w===void 0||w.call(y,j,m,p)))}},f.prototype.focus=function(){this.editor&&this.editor.focus()},f.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},f.displayName="React Quill",f.Quill=l.default,f.defaultProps={theme:"snow",modules:{},readOnly:!1},f})(a.default.Component);function d(u){Promise.resolve().then(u)}return ca=c,ca}var xfe=gfe();const yfe=ss(xfe),bfe=({content:e="",onChange:t,onInsertField:r,readOnly:n=!1,placeholder:a="Start typing your form content here...",height:s="400px",modules:o=null,formats:l=null,className:c=""})=>{const d=_.useRef(null),u={toolbar:!1},f=["bold","italic","underline"],h=m=>{if(d.current){const p=d.current.getEditor(),v=p.getSelection(),g=v?v.index:p.getLength();p.insertText(g,`{{${m}}}`,"user"),p.formatText(g,`{{${m}}}`.length,{color:"#007bff",background:"#e3f2fd",bold:!0}),p.focus()}};return _.useEffect(()=>{r&&d.current&&(d.current.insertField=h)},[r]),n?i.jsx("div",{className:`border rounded p-3 bg-light ${c}`,style:{minHeight:s},dangerouslySetInnerHTML:{__html:e}}):i.jsx("div",{className:c,children:i.jsx(yfe,{ref:d,theme:"snow",value:e,onChange:t,modules:o||u,formats:l||f,style:{height:s},placeholder:a})})},wfe=({fileName:e="Untitled Document",hasUnsavedChanges:t=!1,isSaving:r=!1,onSave:n,onPreview:a,onExport:s,content:o="",onContentChange:l,onInsertField:c,readOnly:d=!1,placeholder:u="Start typing your form content here...",editorHeight:f="400px",editorModules:h=null,editorFormats:m=null,mergeFields:p=[],showMergeFields:v=!0,mergeFieldsWidth:g=3,editorWidth:x=9,showImportInfo:b=!1,importType:y="",className:w="",headerClassName:j="",bodyClassName:N="",mergeFieldsClassName:E="",editorClassName:S=""})=>{const O=k=>{c&&c(k)};return i.jsxs(ce,{className:`border-neutral-200 shadow-sm ${w}`,children:[i.jsx(ce.Header,{className:`bg-light-custom border-neutral-200 ${j}`,children:i.jsx(Que,{fileName:e,hasUnsavedChanges:t,isSaving:r,onSave:n,onPreview:a,onExport:s,content:o})}),i.jsxs(ce.Body,{className:`p-0 ${N}`,children:[b&&y&&i.jsxs(tt,{variant:"info",className:"m-3 mb-0",children:[i.jsx("strong",{children:"Import Info:"})," This form was created from a ",y.toLowerCase()," file. You can now edit the content and add merge fields as needed."]}),i.jsxs(Ee,{className:"g-0",children:[v&&i.jsx(oe,{md:g,className:"border-end",children:i.jsx(ede,{mergeFields:p,onInsertField:O,readOnly:d,className:E})}),i.jsx(oe,{md:x,children:i.jsx("div",{className:"p-3",children:i.jsx(bfe,{content:o,onChange:l,onInsertField:c,readOnly:d,placeholder:u,height:f,modules:h,formats:m,className:S})})})]})]})]})},jfe=({initialContent:e="",fileName:t="Untitled Document",onSave:r,onPreview:n,onExport:a,readOnly:s=!1,mergeFields:o=[],showMergeFields:l=!0,showImportInfo:c=!1,importType:d="",className:u=""})=>{const[f,h]=_.useState(e),[m,p]=_.useState(!1),[v,g]=_.useState(!1);_.useRef(null),_.useEffect(()=>{h(e)},[e]);const x=N=>{h(N),g(!0)},b=N=>{const E=`{{${N}}}`,S=f?f+" "+E:E;h(S),g(!0),ye.success(`Inserted {{${N}}} field`)},y=async()=>{if(r){p(!0);try{await r(f),g(!1),ye.success("Form saved successfully!")}catch(N){ye.error(N.message||"Failed to save form"),console.error("Save error:",N)}finally{p(!1)}}},w=()=>{n?n(f):window.open("","_blank").document.write(`
        <html>
          <head>
            <title>Preview: ${t}</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              .merge-field { 
                background: #e3f2fd; 
                color: #007bff; 
                padding: 2px 6px; 
                border-radius: 3px; 
                font-weight: bold; 
              }
            </style>
          </head>
          <body>
            <h2>Preview: ${t}</h2>
            <div>${f.replace(/\{\{([^}]+)\}\}/g,'<span class="merge-field">{{$1}}</span>')}</div>
          </body>
        </html>
      `)},j=()=>{a?a(f,t):ye.info("Export functionality will be implemented soon!")};return i.jsx("div",{className:`form-editor ${u}`,children:i.jsx(wfe,{fileName:t,hasUnsavedChanges:v,isSaving:m,onSave:y,onPreview:w,onExport:j,content:f,onContentChange:x,onInsertField:b,readOnly:s,mergeFields:o,showMergeFields:l,showImportInfo:c,importType:d})})},Nfe=({show:e,onHide:t,content:r,fileName:n})=>{const a=()=>{const o=window.open("","_blank");o.document.write(`
      <html>
        <head>
          <title>Print: ${n}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              line-height: 1.6;
            }
            .merge-field { 
              background: #e3f2fd; 
              color: #007bff; 
              padding: 2px 6px; 
              border-radius: 3px; 
              font-weight: bold; 
              border: 1px solid #bbdefb;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="no-print" style="margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ddd;">
            <h2>Preview: ${n}</h2>
            <p class="text-muted">This is how your form will look when printed or exported.</p>
          </div>
          <div>${r.replace(/\{\{([^}]+)\}\}/g,'<span class="merge-field">{{$1}}</span>')}</div>
        </body>
      </html>
    `),o.document.close(),o.print()},s=()=>{const o=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>${n}</title>
          <meta charset="UTF-8">
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              line-height: 1.6;
            }
            .merge-field { 
              background: #e3f2fd; 
              color: #007bff; 
              padding: 2px 6px; 
              border-radius: 3px; 
              font-weight: bold; 
              border: 1px solid #bbdefb;
            }
          </style>
        </head>
        <body>
          <h1>${n}</h1>
          <div>${r.replace(/\{\{([^}]+)\}\}/g,'<span class="merge-field">{{$1}}</span>')}</div>
        </body>
      </html>
    `,l=new Blob([o],{type:"text/html"}),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=`${n.replace(/\.[^/.]+$/,"")}.html`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)};return i.jsxs(de,{show:e,onHide:t,size:"lg",centered:!0,children:[i.jsxs(de.Header,{className:"bg-primary-custom text-white border-0",children:[i.jsxs(de.Title,{className:"d-flex align-items-center",children:[i.jsx(xa,{className:"me-2",size:20}),"Preview: ",n]}),i.jsx(le,{variant:"link",onClick:t,className:"text-white p-0",children:i.jsx(Ye,{size:20})})]}),i.jsx(de.Body,{className:"p-0",children:i.jsx("div",{className:"p-3",children:i.jsx("div",{className:"border rounded p-3 bg-white",style:{minHeight:"400px"},dangerouslySetInnerHTML:{__html:r.replace(/\{\{([^}]+)\}\}/g,'<span style="background: #e3f2fd; color: #007bff; padding: 2px 6px; border-radius: 3px; font-weight: bold; border: 1px solid #bbdefb;">{{$1}}</span>')}})})}),i.jsxs(de.Footer,{className:"bg-light border-0",children:[i.jsx(le,{variant:"outline-secondary",onClick:t,children:"Close"}),i.jsxs(le,{variant:"outline-primary",onClick:a,children:[i.jsx(jS,{className:"me-2",size:16}),"Print"]}),i.jsxs(le,{variant:"primary-custom",onClick:s,children:[i.jsx(Ja,{className:"me-2",size:16}),"Download HTML"]})]})]})},Efe=()=>{const e=Et(),t=ki(),[r,n]=_.useState(""),[a,s]=_.useState("Untitled Document"),[o,l]=_.useState(""),[c,d]=_.useState(!1);_.useEffect(()=>{if(t.state){const{content:p,fileName:v,importType:g}=t.state;n(p||""),s(v||"Untitled Document"),l(g||"")}},[t.state]);const u=async p=>{try{await new Promise(v=>setTimeout(v,1e3)),console.log("Saving content:",p),console.log("File name:",a),ye.success(`Form "${a}" saved successfully!`)}catch{throw new Error("Failed to save form")}},f=p=>{n(p),d(!0)},h=(p,v)=>{ye.info(`Exporting "${v}" to Word/PDF...`),setTimeout(()=>{ye.success("Export completed! (Demo mode)")},2e3)},m=()=>{e("/admin/forms")};return i.jsx(sn,{permission:Me.TEMPLATES.CREATE,fallback:i.jsx(He,{fluid:!0,className:"py-4",children:i.jsxs("div",{className:"text-center text-muted",children:[i.jsx("h4",{children:"Access Denied"}),i.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:i.jsxs(He,{fluid:!0,className:"py-4 form-editor-page",children:[i.jsxs(ce,{className:"border-neutral-200 shadow-sm",children:[i.jsxs(ce.Header,{className:"bg-light-custom border-neutral-200 d-flex justify-content-between align-items-center",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(le,{variant:"outline-secondary",onClick:m,className:"me-3",size:"sm",children:i.jsx(dr,{size:16})}),i.jsxs("div",{children:[i.jsx("h4",{className:"mb-0 text-primary-custom",children:a}),o&&i.jsxs("small",{className:"text-muted",children:["Import Type: ",o]})]})]}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsxs(le,{variant:"outline-primary",onClick:()=>d(!0),size:"sm",children:[i.jsx(Xt,{className:"me-2",size:16}),"Preview"]}),i.jsxs(le,{variant:"primary-custom",onClick:()=>h(r,a),size:"sm",children:[i.jsx(Ja,{className:"me-2",size:16}),"Export"]})]})]}),i.jsxs(ce.Body,{className:"p-0",children:[o&&i.jsxs(tt,{variant:"info",className:"m-3 mb-0",children:[i.jsx("strong",{children:"Import Info:"})," This form was created from a ",o.toLowerCase()," file. You can now edit the content and add merge fields as needed."]}),i.jsx(jfe,{initialContent:r,fileName:a,onSave:u,onPreview:f,onExport:h})]})]}),i.jsx(Nfe,{show:c,onHide:()=>d(!1),content:r,fileName:a})]})})},_fe=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=_fe,document.head.appendChild(e)}const Sfe=({traineeId:e})=>{const[t,r]=_.useState([]),[n,a]=_.useState(!0),{sortedData:s,sortConfig:o,handleSort:l}=Bn(t);_.useEffect(()=>{c()},[e]);const c=async()=>{try{a(!0);const f=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(h=>setTimeout(h,300)),r(f)}catch(f){console.error("Error loading signature required:",f),ye.error("Failed to load signature requirements")}finally{a(!1)}},d=f=>{const m={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return i.jsx($e,{bg:m.variant,children:m.text})},u=f=>{console.log("Open signature pad for document:",f),ye.info("Signature pad functionality coming soon")};return n?i.jsx("div",{className:"text-center py-4",children:i.jsx(Ln,{count:5})}):t.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(mi,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):i.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Document",sortKey:"name",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Course",sortKey:"course",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Status",sortKey:"status",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:s.map(f=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.name})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.course})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.subject})}),i.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),i.jsx("td",{children:d(f.status)}),i.jsx("td",{children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:"Sign Document",icon:i.jsx(mi,{}),onClick:()=>u(f.id)}]})})]},f.id))})]})})},iS=()=>{const{user:e}=bn();return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx(Sfe,{traineeId:e?.id})})},Tfe=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Tfe,document.head.appendChild(e)}const Afe=({traineeId:e})=>{const[t,r]=_.useState([]),[n,a]=_.useState(!0),{sortedData:s,sortConfig:o,handleSort:l}=Bn(t);_.useEffect(()=>{c()},[e]);const c=async()=>{try{a(!0);const f=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(h=>setTimeout(h,300)),r(f)}catch(f){console.error("Error loading section completion:",f),ye.error("Failed to load section completion requirements")}finally{a(!1)}},d=f=>{const m={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return i.jsx($e,{bg:m.variant,children:m.text})},u=f=>{console.log("Complete section:",f),ye.info("Section completion functionality coming soon")};return n?i.jsx("div",{className:"text-center py-4",children:i.jsx(Ln,{count:5})}):t.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(It,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):i.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Section",sortKey:"name",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Course",sortKey:"course",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Type",sortKey:"section",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Progress",sortKey:"progress",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Status",sortKey:"status",sortConfig:o,onSort:l})}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:s.map(f=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.name})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.course})}),i.jsx("td",{children:i.jsx("div",{className:"fw-semibold",children:f.subject})}),i.jsx("td",{children:i.jsx($e,{bg:"primary",className:"fw-normal",children:f.section})}),i.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),i.jsx("td",{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:i.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress}%`}})}),i.jsxs("small",{className:"text-muted",children:[f.progress,"%"]})]})}),i.jsx("td",{children:d(f.status)}),i.jsx("td",{children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:f.status==="COMPLETED"?"View Section":"Complete Section",icon:f.status==="COMPLETED"?i.jsx(Xt,{}):i.jsx(It,{}),onClick:()=>u(f.id)}]})})]},f.id))})]})})},oS=()=>{const{user:e}=bn();return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx(Afe,{traineeId:e?.id})})},kfe=({uniqueTypes:e,uniqueStatuses:t,uniquePriorities:r,selectedTypes:n,selectedStatuses:a,selectedPriorities:s,onTypeToggle:o,onStatusToggle:l,onPriorityToggle:c,onClearFilters:d,className:u=""})=>{const f=n.length>0||a.length>0||s.length>0;return i.jsxs(vr,{className:`filter-panel-dropdown course-filter-dropdown ${u}`,children:[i.jsx(vr.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(xo,{size:14,className:"me-2"}),"Filters",f&&i.jsx("span",{className:"badge bg-primary ms-2",children:n.length+a.length+s.length})]})}),i.jsxs(vr.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[i.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),n.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(h=>i.jsx(Y.Check,{type:"checkbox",id:`type-${h}`,label:h,checked:n.includes(h),onChange:()=>o(h),className:"mb-1"},h))})]}),i.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),a.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(h=>i.jsx(Y.Check,{type:"checkbox",id:`status-${h}`,label:h,checked:a.includes(h),onChange:()=>l(h),className:"mb-1"},h))})]}),i.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[i.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),s.length>0&&i.jsx(le,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:i.jsx(Ye,{size:12})})]}),i.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(h=>i.jsx(Y.Check,{type:"checkbox",id:`priority-${h}`,label:h,checked:s.includes(h),onChange:()=>c(h),className:"mb-1"},h))})]}),f&&i.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:i.jsxs(le,{variant:"outline-danger",size:"sm",className:"w-100",onClick:d,children:[i.jsx(Ye,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},pP=document.createElement("style");pP.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(pP);const Ofe=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Ofe,document.head.appendChild(e)}const Cfe=({traineeId:e})=>{Et();const[t,r]=_.useState([]),[n,a]=_.useState(!0),[s,o]=_.useState(""),[l,c]=_.useState([]),[d,u]=_.useState([]),[f,h]=_.useState([]),{sortedData:m,sortConfig:p,handleSort:v}=Bn(t);_.useEffect(()=>{g()},[e]);const g=async()=>{try{a(!0);const C=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(F=>setTimeout(F,300)),r(C)}catch(C){console.error("Error loading assessments:",C),ye.error("Failed to load assessments")}finally{a(!1)}},x=_.useMemo(()=>t.filter(C=>{const F=s===""||C.name.toLowerCase().includes(s.toLowerCase())||C.description.toLowerCase().includes(s.toLowerCase())||C.course?.name.toLowerCase().includes(s.toLowerCase())||C.subject?.name.toLowerCase().includes(s.toLowerCase()),M=l.length===0||l.includes(C.type),H=d.length===0||d.includes(C.status),V=f.length===0||f.includes(C.priority);return F&&M&&H&&V}),[t,s,l,d,f]),b=_.useMemo(()=>[...new Set(t.map(F=>F.type))].filter(Boolean),[t]),y=_.useMemo(()=>[...new Set(t.map(F=>F.status))].filter(Boolean),[t]),w=_.useMemo(()=>[...new Set(t.map(F=>F.priority))].filter(Boolean),[t]),j=C=>{o(C.target.value)},N=C=>{c(F=>F.includes(C)?F.filter(M=>M!==C):[...F,C])},E=C=>{u(F=>F.includes(C)?F.filter(M=>M!==C):[...F,C])},S=C=>{h(F=>F.includes(C)?F.filter(M=>M!==C):[...F,C])},O=()=>{c([]),u([]),h([]),o("")},k=C=>{const M={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[C]||{variant:"secondary",text:C};return i.jsx($e,{bg:M.variant,children:M.text})},T=C=>{const M={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[C]||{variant:"secondary",text:C};return i.jsx($e,{bg:M.variant,children:M.text})},A=C=>{console.log("Start assessment:",C.id),ye.info("Assessment functionality coming soon")},P=C=>{console.log("View assessment:",C.id),ye.info("Assessment details functionality coming soon")};return n?i.jsx("div",{className:"text-center py-4",children:i.jsx(Ln,{count:8})}):i.jsx("div",{className:"trainee-your-assessments",children:i.jsx(ce,{className:"shadow-sm",children:i.jsx(ce.Body,{className:"p-0",children:i.jsxs(lS,{defaultActiveKey:"upcoming",className:"border-bottom",children:[i.jsx(dn,{eventKey:"upcoming",title:"Upcoming Assessments",children:i.jsxs("div",{className:"p-3",children:[i.jsx("div",{style:{marginBottom:"3rem"},children:i.jsxs(Ee,{className:"form-mobile-stack",children:[i.jsx(oe,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:i.jsx(ao,{placeholder:"Search assessments by name, description, course, or subject...",value:s,onChange:j,className:"search-bar-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:i.jsx(kfe,{uniqueTypes:b,uniqueStatuses:y,uniquePriorities:w,selectedTypes:l,selectedStatuses:d,selectedPriorities:f,onTypeToggle:N,onStatusToggle:E,onPriorityToggle:S,onClearFilters:O,className:"filter-panel-mobile"})}),i.jsx(oe,{xs:12,lg:3,md:3,children:i.jsx("div",{className:"text-end text-mobile-center",children:i.jsxs("small",{className:"text-muted",children:[x.length," assessment",x.length!==1?"s":""]})})})]})}),x.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Vt,{size:32,className:"text-muted mb-2"}),i.jsx("p",{className:"text-muted mb-0",children:t.length===0?"No upcoming assessments":"No assessments match your filters"})]}):i.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:i.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Assessment",sortKey:"name",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Course",sortKey:"course",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Subject",sortKey:"subject",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Type",sortKey:"type",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Priority",sortKey:"priority",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Due Date",sortKey:"dueDate",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:i.jsx(Ot,{title:"Status",sortKey:"status",sortConfig:p,onSort:v})}),i.jsx("th",{className:"text-start",children:"Actions"})]})}),i.jsx("tbody",{children:m.map(C=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:C.name}),i.jsx("small",{className:"text-muted",children:C.description})]}),i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:C.course?.name||"N/A"}),i.jsx("small",{className:"text-muted",children:C.course?.code||""})]}),i.jsxs("td",{children:[i.jsx("div",{className:"fw-semibold",children:C.subject?.name||"N/A"}),i.jsx("small",{className:"text-muted",children:C.subject?.code||""})]}),i.jsx("td",{children:i.jsx($e,{bg:"primary",className:"fw-normal",children:C.type||"Assessment"})}),i.jsx("td",{children:T(C.priority)}),i.jsx("td",{children:C.dueDate?new Date(C.dueDate).toLocaleDateString():"N/A"}),i.jsx("td",{children:k(C.status)}),i.jsx("td",{children:i.jsx(sa,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:i.jsx(ln,{size:16})},items:[{label:C.status==="PENDING"||C.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:C.status==="PENDING"||C.status==="IN_PROGRESS"?i.jsx(Pg,{}):i.jsx(Xt,{}),onClick:()=>C.status==="PENDING"||C.status==="IN_PROGRESS"?A(C):P(C)}]})})]},C.id))})]})})]})}),i.jsx(dn,{eventKey:"completed",title:"Completed Assessments",children:i.jsx("div",{className:"p-3",children:i.jsx(Ty,{traineeId:e})})})]})})})})},Pfe=()=>{const{user:e}=bn();return i.jsx(He,{fluid:!0,className:"py-4",children:i.jsx(Cfe,{traineeId:e?.id})})},Dfe=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Dfe,document.head.appendChild(e)}const Ife=()=>{const[e,t]=_.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[r,n]=_.useState(!1),a=o=>{const{name:l,value:c,type:d,checked:u}=o.target;t(f=>({...f,[l]:d==="checkbox"?u:c}))},s=async o=>{o.preventDefault(),n(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(l=>setTimeout(l,1e3)),ye.success("Incident/Feedback report submitted successfully!"),t({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(l){console.error("Error submitting incident/feedback report:",l),ye.error("Failed to submit incident/feedback report. Please try again.")}finally{n(!1)}};return i.jsxs(He,{fluid:!0,className:"py-4",children:[i.jsx(Ee,{className:"mb-4",children:i.jsx(oe,{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx(Gt,{className:"me-2",size:28}),i.jsxs("div",{children:[i.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),i.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})]})})}),i.jsxs(Ee,{className:"mt-4",children:[i.jsx(oe,{lg:8,children:i.jsxs(ce,{className:"border-0 shadow-sm create-issue-form",children:[i.jsx(ce.Header,{children:i.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[i.jsx(xa,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),i.jsx(ce.Body,{children:i.jsxs(Y,{onSubmit:s,children:[i.jsxs(Ee,{children:[i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Title"}),i.jsx(Y.Control,{type:"text",name:"title",value:e.title,onChange:a,placeholder:"Brief description of the incident or feedback"})]})}),i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Request Type *"}),i.jsxs(Y.Select,{name:"request_type",value:e.request_type,onChange:a,required:!0,children:[i.jsx("option",{value:"",children:"Select request type"}),i.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),i.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"})]})]})})]}),i.jsx(Ee,{children:i.jsx(oe,{md:6,children:i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Severity"}),i.jsxs(Y.Select,{name:"severity",value:e.severity,onChange:a,children:[i.jsx("option",{value:"LOW",children:"Low"}),i.jsx("option",{value:"MEDIUM",children:"Medium"}),i.jsx("option",{value:"HIGH",children:"High"}),i.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Description"}),i.jsx(Y.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:a,placeholder:"Please provide detailed information about the incident or feedback..."})]}),i.jsxs(Y.Group,{className:"mb-3",children:[i.jsx(Y.Label,{children:"Actions Taken"}),i.jsx(Y.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:a,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),i.jsx(Y.Group,{className:"mb-4",children:i.jsx(Y.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:a,label:"Submit anonymously (your identity will be kept confidential)"})}),i.jsx("div",{className:"d-flex justify-content-end",children:i.jsx(le,{type:"submit",variant:"primary",disabled:r,children:r?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(NS,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),i.jsx(oe,{lg:4,children:i.jsxs(ce,{className:"border-0 shadow-sm create-issue-guidelines",children:[i.jsx(ce.Header,{children:i.jsx("h5",{className:"mb-0",children:"Guidelines"})}),i.jsxs(ce.Body,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{children:"Before submitting:"}),i.jsxs("ul",{className:"small text-muted mb-0",children:[i.jsx("li",{children:"Check if the incident has already been reported"}),i.jsx("li",{children:"Provide clear and specific details"}),i.jsx("li",{children:"Include steps to reproduce the incident"}),i.jsx("li",{children:"Attach screenshots if applicable"})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h6",{children:"Response time:"}),i.jsxs("ul",{className:"small text-muted mb-0",children:[i.jsx("li",{children:"High priority: Within 24 hours"}),i.jsx("li",{children:"Medium priority: Within 2-3 days"}),i.jsx("li",{children:"Low priority: Within 1 week"})]})]}),i.jsxs(tt,{variant:"info",className:"small",children:[i.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},Rfe=$P([{path:"/",element:i.jsx(Pf,{}),errorElement:i.jsx(Vs,{})},{path:"/login",element:i.jsx(Pf,{}),errorElement:i.jsx(Vs,{})},{path:"/reset-password",element:i.jsx(k8,{}),errorElement:i.jsx(Vs,{})},{path:"/admin",element:i.jsx(Cf,{children:i.jsx(Of,{})}),errorElement:i.jsx(Vs,{}),children:[{path:"",element:i.jsx(ib,{})},{path:"dashboard",element:i.jsx(_t,{permission:Me.DASHBOARD.VIEW,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access the dashboard."}),children:i.jsx(uZ,{})})},{path:"users",element:i.jsx(_t,{permission:Me.USERS.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:i.jsx(yce,{})})},{path:"roles",element:i.jsx(_t,{permission:Me.ROLES.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:i.jsx(Sce,{})})},{path:"departments",element:i.jsx(_t,{permission:Me.DEPARTMENTS.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:i.jsx(Ice,{})})},{path:"departments/:id",element:i.jsx(_t,{permission:Me.DEPARTMENTS.VIEW_DETAIL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:i.jsx(qce,{})})},{path:"profile",element:i.jsx(_t,{permission:Me.PROFILES.VIEW,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:i.jsx(Gce,{})})},{path:"forms",element:i.jsx(_t,{permission:Me.TEMPLATES.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:i.jsx(Jue,{})})},{path:"forms/editor",element:i.jsx(_t,{permission:Me.TEMPLATES.CREATE,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:i.jsx(Efe,{})})},{path:"system-config",element:i.jsx(_t,{permission:Me.GLOBAL_FIELDS.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:i.jsx("div",{children:"System Configuration Page"})})}]},{path:"/academic",element:i.jsx(Cf,{children:i.jsx(Of,{})}),errorElement:i.jsx(Vs,{}),children:[{path:"",element:i.jsx(ib,{})},{path:"dashboard",element:i.jsx(Yce,{})},{path:"departments",element:i.jsx(Kce,{})},{path:"course/:courseId",element:i.jsx(nue,{})},{path:"course-detail/:courseId",element:i.jsx(Eue,{})},{path:"course/:courseId/enroll-trainees",element:i.jsx(Pue,{})},{path:"subject/:subjectId",element:i.jsx(yE,{})},{path:"course/:courseId/subject/:subjectId",element:i.jsx(yE,{})}]},{path:"/trainee",element:i.jsx(Cf,{children:i.jsx(Of,{})}),errorElement:i.jsx(Vs,{}),children:[{path:"",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:i.jsx(jE,{})})},{path:"dashboard",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_DETAIL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:i.jsx(jE,{})})},{path:":traineeId",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_DETAIL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:i.jsx(Iue,{})})},{path:":traineeId/course/:courseId",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_COURSES,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:i.jsx(Mue,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_SUBJECTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:i.jsx($ue,{})})},{path:":traineeId/assessments",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:i.jsx(Uue,{})})},{path:":traineeId/signature-pad/:documentId",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:i.jsx(Wue,{})})},{path:":traineeId/assessment-section/:sectionId",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:i.jsx(Vue,{})})},{path:"academic-details",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_DETAIL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:i.jsx(Kue,{})})},{path:"enrolled-courses",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_COURSES,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:i.jsx(Yue,{})})},{path:"all-assessments",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view all assessments."}),children:i.jsx(Xue,{})})},{path:"signature-required",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:i.jsx(iS,{})})},{path:"completion-required",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:i.jsx(oS,{})})},{path:"your-assessments",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:i.jsx(Pfe,{})})},{path:"create-incident-feedback-report",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ALL,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:i.jsx(Ife,{})})},{path:"assessment-pending/signature-required",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:i.jsx(iS,{})})},{path:"assessment-pending/section-completion",element:i.jsx(_t,{permission:Me.TRAINEES.VIEW_ASSESSMENTS,fallback:i.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:i.jsx(oS,{})})}]},{path:"*",element:i.jsx(Pf,{}),errorElement:i.jsx(Vs,{})}],{basename:Mg()});function Ffe(){return _.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,n=t.hash,a=r.match(/\?\/(.+?)(?:&|$)/);if(a){const o=`/${a[1].replace(/~and~/g,"&")}${n}`;window.history.replaceState(null,"",o)}}})()},[]),i.jsxs(S8,{children:[i.jsx(zP,{router:Rfe}),i.jsx(w8,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}qP.createRoot(document.getElementById("root")).render(i.jsx(_.StrictMode,{children:i.jsx(Ffe,{})}));
