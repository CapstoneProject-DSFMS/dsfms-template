import{P as I,j as t,B as se,N as Et,a as bd,T as gt,C as Ee,b as R,A as Ae,S as St,I as jd,F as E,M as le,R as oe,c as F,O as Of,d as Lf,D as xs,e as Te,L as yd,f as Mf,g as qt,h as gc,i as Il}from"./bootstrap-CWMFl6nP.js";import{r as b,R as J,u as wa,b as qe,L as ml,O as Bf,c as zf,d as $f,N as Uf,e as o0,f as Jt,g as Wf,h as Hf}from"./router-BHpdjI-O.js";import{a as Vf}from"./vendor-D3F3s8fL.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var oi={},Nd;function Gf(){if(Nd)return oi;Nd=1;var e=Vf();return oi.createRoot=e.createRoot,oi.hydrateRoot=e.hydrateRoot,oi}var qf=Gf(),Yf=["color","size","title","className"];function Pl(){return Pl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Pl.apply(null,arguments)}function Kf(e,r){if(e==null)return{};var s,a,n=Xf(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Xf(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var c0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Kf(e,Yf);return J.createElement("svg",Pl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-airplane",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});c0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Jf=["color","size","title","className"];function Rl(){return Rl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Rl.apply(null,arguments)}function Zf(e,r){if(e==null)return{};var s,a,n=Qf(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Qf(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var d0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Zf(e,Jf);return J.createElement("svg",Rl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-archive",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});d0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ex=["color","size","title","className"];function Fl(){return Fl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Fl.apply(null,arguments)}function tx(e,r){if(e==null)return{};var s,a,n=sx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function sx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var m0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=tx(e,ex);return J.createElement("svg",Fl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-clockwise",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),J.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});m0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var rx=["color","size","title","className"];function Ol(){return Ol=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ol.apply(null,arguments)}function ax(e,r){if(e==null)return{};var s,a,n=nx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function nx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var u0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=ax(e,rx);return J.createElement("svg",Ol({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-counterclockwise",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"}),J.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"}))});u0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ix=["color","size","title","className"];function Ll(){return Ll=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ll.apply(null,arguments)}function lx(e,r){if(e==null)return{};var s,a,n=ox(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function ox(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var wn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=lx(e,ix);return J.createElement("svg",Ll({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-down",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});wn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var cx=["color","size","title","className"];function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ml.apply(null,arguments)}function dx(e,r){if(e==null)return{};var s,a,n=mx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function mx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var bt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=dx(e,cx);return J.createElement("svg",Ml({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-left",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});bt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ux=["color","size","title","className"];function Bl(){return Bl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Bl.apply(null,arguments)}function hx(e,r){if(e==null)return{};var s,a,n=fx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function fx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Gr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=hx(e,ux);return J.createElement("svg",Bl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-right",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});Gr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var xx=["color","size","title","className"];function zl(){return zl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},zl.apply(null,arguments)}function px(e,r){if(e==null)return{};var s,a,n=gx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function gx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Wn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=px(e,xx);return J.createElement("svg",zl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-award",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),J.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});Wn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var vx=["color","size","title","className"];function $l(){return $l=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},$l.apply(null,arguments)}function bx(e,r){if(e==null)return{};var s,a,n=jx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function jx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var it=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=bx(e,vx);return J.createElement("svg",$l({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-book",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});it.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var yx=["color","size","title","className"];function Ul(){return Ul=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ul.apply(null,arguments)}function Nx(e,r){if(e==null)return{};var s,a,n=wx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function wx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Wl=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Nx(e,yx);return J.createElement("svg",Ul({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-box-arrow-right",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),J.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});Wl.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Sx=["color","size","title","className"];function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Hl.apply(null,arguments)}function Tx(e,r){if(e==null)return{};var s,a,n=Ex(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ex(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Tr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Tx(e,Sx);return J.createElement("svg",Hl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-building",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),J.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Tr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Cx=["color","size","title","className"];function Vl(){return Vl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Vl.apply(null,arguments)}function _x(e,r){if(e==null)return{};var s,a,n=kx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function kx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ba=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=_x(e,Cx);return J.createElement("svg",Vl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar-event",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});Ba.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ax=["color","size","title","className"];function Gl(){return Gl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Gl.apply(null,arguments)}function Dx(e,r){if(e==null)return{};var s,a,n=Ix(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ix(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Lt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Dx(e,Ax);return J.createElement("svg",Gl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});Lt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Px=["color","size","title","className"];function ql(){return ql=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ql.apply(null,arguments)}function Rx(e,r){if(e==null)return{};var s,a,n=Fx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Fx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var h0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Rx(e,Px);return J.createElement("svg",ql({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chat-dots",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),J.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});h0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ox=["color","size","title","className"];function Yl(){return Yl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Yl.apply(null,arguments)}function Lx(e,r){if(e==null)return{};var s,a,n=Mx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Mx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var rt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Lx(e,Ox);return J.createElement("svg",Yl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});rt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Bx=["color","size","title","className"];function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Kl.apply(null,arguments)}function zx(e,r){if(e==null)return{};var s,a,n=$x(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function $x(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var f0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=zx(e,Bx);return J.createElement("svg",Kl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-square",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});f0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ux=["color","size","title","className"];function Xl(){return Xl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Xl.apply(null,arguments)}function Wx(e,r){if(e==null)return{};var s,a,n=Hx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Hx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var x0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Wx(e,Ux);return J.createElement("svg",Xl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});x0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Vx=["color","size","title","className"];function Jl(){return Jl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Jl.apply(null,arguments)}function Gx(e,r){if(e==null)return{};var s,a,n=qx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function qx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Cr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Gx(e,Vx);return J.createElement("svg",Jl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-down",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});Cr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Yx=["color","size","title","className"];function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Zl.apply(null,arguments)}function Kx(e,r){if(e==null)return{};var s,a,n=Xx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Xx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Hn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Kx(e,Yx);return J.createElement("svg",Zl({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-right",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Hn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Jx=["color","size","title","className"];function Ql(){return Ql=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ql.apply(null,arguments)}function Zx(e,r){if(e==null)return{};var s,a,n=Qx(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Qx(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var p0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Zx(e,Jx);return J.createElement("svg",Ql({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-up",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});p0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ep=["color","size","title","className"];function eo(){return eo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},eo.apply(null,arguments)}function tp(e,r){if(e==null)return{};var s,a,n=sp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function sp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var vt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=tp(e,ep);return J.createElement("svg",eo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clipboard-check",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),J.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});vt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var rp=["color","size","title","className"];function to(){return to=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},to.apply(null,arguments)}function ap(e,r){if(e==null)return{};var s,a,n=np(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function np(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var et=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=ap(e,rp);return J.createElement("svg",to({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),J.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});et.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ip=["color","size","title","className"];function so(){return so=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},so.apply(null,arguments)}function lp(e,r){if(e==null)return{};var s,a,n=op(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function op(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var qr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=lp(e,ip);return J.createElement("svg",so({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-download",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});qr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var cp=["color","size","title","className"];function ro(){return ro=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ro.apply(null,arguments)}function dp(e,r){if(e==null)return{};var s,a,n=mp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function mp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var ha=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=dp(e,cp);return J.createElement("svg",ro({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-envelope",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});ha.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var up=["color","size","title","className"];function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ao.apply(null,arguments)}function hp(e,r){if(e==null)return{};var s,a,n=fp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function fp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var g0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=hp(e,up);return J.createElement("svg",ao({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});g0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var xp=["color","size","title","className"];function no(){return no=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},no.apply(null,arguments)}function pp(e,r){if(e==null)return{};var s,a,n=gp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function gp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Wt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=pp(e,xp);return J.createElement("svg",no({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-triangle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),J.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Wt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var vp=["color","size","title","className"];function io(){return io=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},io.apply(null,arguments)}function bp(e,r){if(e==null)return{};var s,a,n=jp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function jp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Sn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=bp(e,vp);return J.createElement("svg",io({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye-slash",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),J.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),J.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});Sn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var yp=["color","size","title","className"];function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},lo.apply(null,arguments)}function Np(e,r){if(e==null)return{};var s,a,n=wp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function wp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var xt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Np(e,yp);return J.createElement("svg",lo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),J.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});xt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Sp=["color","size","title","className"];function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},oo.apply(null,arguments)}function Tp(e,r){if(e==null)return{};var s,a,n=Ep(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ep(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ha=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Tp(e,Sp);return J.createElement("svg",oo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-excel",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});Ha.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Cp=["color","size","title","className"];function co(){return co=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},co.apply(null,arguments)}function _p(e,r){if(e==null)return{};var s,a,n=kp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function kp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var vc=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=_p(e,Cp);return J.createElement("svg",co({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-pdf",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),J.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});vc.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ap=["color","size","title","className"];function mo(){return mo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},mo.apply(null,arguments)}function Dp(e,r){if(e==null)return{};var s,a,n=Ip(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ip(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Hi=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Dp(e,Ap);return J.createElement("svg",mo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-text",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),J.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Hi.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Pp=["color","size","title","className"];function uo(){return uo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},uo.apply(null,arguments)}function Rp(e,r){if(e==null)return{};var s,a,n=Fp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Fp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ei=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Rp(e,Pp);return J.createElement("svg",uo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});Ei.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Op=["color","size","title","className"];function ho(){return ho=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ho.apply(null,arguments)}function Lp(e,r){if(e==null)return{};var s,a,n=Mp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Mp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var v0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Lp(e,Op);return J.createElement("svg",ho({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text-fill",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});v0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Bp=["color","size","title","className"];function fo(){return fo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},fo.apply(null,arguments)}function zp(e,r){if(e==null)return{};var s,a,n=$p(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function $p(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var $s=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=zp(e,Bp);return J.createElement("svg",fo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),J.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});$s.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Up=["color","size","title","className"];function xo(){return xo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},xo.apply(null,arguments)}function Wp(e,r){if(e==null)return{};var s,a,n=Hp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Hp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Sa=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Wp(e,Up);return J.createElement("svg",xo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-funnel",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});Sa.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Vp=["color","size","title","className"];function po(){return po=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},po.apply(null,arguments)}function Gp(e,r){if(e==null)return{};var s,a,n=qp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function qp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var b0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Gp(e,Vp);return J.createElement("svg",po({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-gear",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),J.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});b0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Yp=["color","size","title","className"];function go(){return go=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},go.apply(null,arguments)}function Kp(e,r){if(e==null)return{};var s,a,n=Xp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Xp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Vn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Kp(e,Yp);return J.createElement("svg",go({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-geo-alt",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),J.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});Vn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Jp=["color","size","title","className"];function vo(){return vo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},vo.apply(null,arguments)}function Zp(e,r){if(e==null)return{};var s,a,n=Qp(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Qp(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var j0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Zp(e,Jp);return J.createElement("svg",vo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-info-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});j0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var eg=["color","size","title","className"];function bo(){return bo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},bo.apply(null,arguments)}function tg(e,r){if(e==null)return{};var s,a,n=sg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function sg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Tn=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=tg(e,eg);return J.createElement("svg",bo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-key",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),J.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Tn.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var rg=["color","size","title","className"];function jo(){return jo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},jo.apply(null,arguments)}function ag(e,r){if(e==null)return{};var s,a,n=ng(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function ng(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var y0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=ag(e,rg);return J.createElement("svg",jo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});y0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ig=["color","size","title","className"];function yo(){return yo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},yo.apply(null,arguments)}function lg(e,r){if(e==null)return{};var s,a,n=og(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function og(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Fr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=lg(e,ig);return J.createElement("svg",yo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pen",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});Fr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var cg=["color","size","title","className"];function No(){return No=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},No.apply(null,arguments)}function dg(e,r){if(e==null)return{};var s,a,n=mg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function mg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var bc=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=dg(e,cg);return J.createElement("svg",No({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil-square",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),J.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});bc.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var ug=["color","size","title","className"];function wo(){return wo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},wo.apply(null,arguments)}function hg(e,r){if(e==null)return{};var s,a,n=fg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function fg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var bs=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=hg(e,ug);return J.createElement("svg",wo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});bs.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var xg=["color","size","title","className"];function So(){return So=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},So.apply(null,arguments)}function pg(e,r){if(e==null)return{};var s,a,n=gg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function gg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var rs=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=pg(e,xg);return J.createElement("svg",So({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-people",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});rs.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var vg=["color","size","title","className"];function To(){return To=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},To.apply(null,arguments)}function bg(e,r){if(e==null)return{};var s,a,n=jg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function jg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var N0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=bg(e,vg);return J.createElement("svg",To({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check-fill",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});N0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var yg=["color","size","title","className"];function Eo(){return Eo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Eo.apply(null,arguments)}function Ng(e,r){if(e==null)return{};var s,a,n=wg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function wg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ls=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Ng(e,yg);return J.createElement("svg",Eo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),J.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});Ls.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Sg=["color","size","title","className"];function Co(){return Co=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Co.apply(null,arguments)}function Tg(e,r){if(e==null)return{};var s,a,n=Eg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Eg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Oa=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Tg(e,Sg);return J.createElement("svg",Co({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),J.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});Oa.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Cg=["color","size","title","className"];function _o(){return _o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_o.apply(null,arguments)}function _g(e,r){if(e==null)return{};var s,a,n=kg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function kg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ci=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=_g(e,Cg);return J.createElement("svg",_o({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-dash",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7M11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1m0-7a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),J.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});Ci.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ag=["color","size","title","className"];function ko(){return ko=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ko.apply(null,arguments)}function Dg(e,r){if(e==null)return{};var s,a,n=Ig(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ig(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var fa=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Dg(e,Ag);return J.createElement("svg",ko({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-plus",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}),J.createElement("path",{fillRule:"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"}))});fa.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Pg=["color","size","title","className"];function Ao(){return Ao=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ao.apply(null,arguments)}function Rg(e,r){if(e==null)return{};var s,a,n=Fg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Fg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Xa=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Rg(e,Pg);return J.createElement("svg",Ao({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-x",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});Xa.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Og=["color","size","title","className"];function Do(){return Do=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Do.apply(null,arguments)}function Lg(e,r){if(e==null)return{};var s,a,n=Mg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Mg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Dt=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Lg(e,Og);return J.createElement("svg",Do({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Dt.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Bg=["color","size","title","className"];function Io(){return Io=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Io.apply(null,arguments)}function zg(e,r){if(e==null)return{};var s,a,n=$g(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function $g(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var w0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=zg(e,Bg);return J.createElement("svg",Io({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-phone",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});w0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Ug=["color","size","title","className"];function Po(){return Po=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Po.apply(null,arguments)}function Wg(e,r){if(e==null)return{};var s,a,n=Hg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Hg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ro=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Wg(e,Ug);return J.createElement("svg",Po({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});Ro.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Vg=["color","size","title","className"];function Fo(){return Fo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Fo.apply(null,arguments)}function Gg(e,r){if(e==null)return{};var s,a,n=qg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function qg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var jc=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Gg(e,Vg);return J.createElement("svg",Fo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});jc.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Yg=["color","size","title","className"];function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Oo.apply(null,arguments)}function Kg(e,r){if(e==null)return{};var s,a,n=Xg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Xg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var ks=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Kg(e,Yg);return J.createElement("svg",Oo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});ks.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var Jg=["color","size","title","className"];function Lo(){return Lo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Lo.apply(null,arguments)}function Zg(e,r){if(e==null)return{};var s,a,n=Qg(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Qg(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var cr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=Zg(e,Jg);return J.createElement("svg",Lo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-save",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});cr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var e1=["color","size","title","className"];function Mo(){return Mo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Mo.apply(null,arguments)}function t1(e,r){if(e==null)return{};var s,a,n=s1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function s1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var yc=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=t1(e,e1);return J.createElement("svg",Mo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-search",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});yc.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var r1=["color","size","title","className"];function Bo(){return Bo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Bo.apply(null,arguments)}function a1(e,r){if(e==null)return{};var s,a,n=n1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function n1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var S0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=a1(e,r1);return J.createElement("svg",Bo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-send",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});S0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var i1=["color","size","title","className"];function zo(){return zo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},zo.apply(null,arguments)}function l1(e,r){if(e==null)return{};var s,a,n=o1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function o1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var T0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=l1(e,i1);return J.createElement("svg",zo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield-x",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),J.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});T0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var c1=["color","size","title","className"];function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},$o.apply(null,arguments)}function d1(e,r){if(e==null)return{};var s,a,n=m1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function m1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Nc=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=d1(e,c1);return J.createElement("svg",$o({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});Nc.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var u1=["color","size","title","className"];function Uo(){return Uo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Uo.apply(null,arguments)}function h1(e,r){if(e==null)return{};var s,a,n=f1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function f1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var E0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=h1(e,u1);return J.createElement("svg",Uo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-square",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});E0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var x1=["color","size","title","className"];function Wo(){return Wo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Wo.apply(null,arguments)}function p1(e,r){if(e==null)return{};var s,a,n=g1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function g1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var C0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=p1(e,x1);return J.createElement("svg",Wo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-star",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});C0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var v1=["color","size","title","className"];function Ho(){return Ho=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ho.apply(null,arguments)}function b1(e,r){if(e==null)return{};var s,a,n=j1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function j1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ct=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=b1(e,v1);return J.createElement("svg",Ho({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-three-dots-vertical",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});Ct.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var y1=["color","size","title","className"];function Vo(){return Vo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Vo.apply(null,arguments)}function N1(e,r){if(e==null)return{};var s,a,n=w1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function w1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Zr=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=N1(e,y1);return J.createElement("svg",Vo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trash",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),J.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Zr.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var S1=["color","size","title","className"];function Go(){return Go=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Go.apply(null,arguments)}function T1(e,r){if(e==null)return{};var s,a,n=E1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function E1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var _0=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=T1(e,S1);return J.createElement("svg",Go({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trophy",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});_0.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var C1=["color","size","title","className"];function qo(){return qo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},qo.apply(null,arguments)}function _1(e,r){if(e==null)return{};var s,a,n=k1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function k1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Hs=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=_1(e,C1);return J.createElement("svg",qo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-upload",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Hs.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var A1=["color","size","title","className"];function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Yo.apply(null,arguments)}function D1(e,r){if(e==null)return{};var s,a,n=I1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function I1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ms=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=D1(e,A1);return J.createElement("svg",Yo({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Ms.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};var P1=["color","size","title","className"];function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ko.apply(null,arguments)}function R1(e,r){if(e==null)return{};var s,a,n=F1(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function F1(e,r){if(e==null)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;s[a]=e[a]}return s}var Ge=b.forwardRef(function(e,r){var s=e.color,a=s===void 0?"currentColor":s,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,d=c===void 0?"":c,m=R1(e,P1);return J.createElement("svg",Ko({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x",d].filter(Boolean).join(" ")},m),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Ge.propTypes={color:I.string,size:I.oneOfType([I.string,I.number]),title:I.string,className:I.string};const O1="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function k0(e,r){return function(){return e.apply(r,arguments)}}const{toString:L1}=Object.prototype,{getPrototypeOf:wc}=Object,{iterator:Vi,toStringTag:A0}=Symbol,Gi=(e=>r=>{const s=L1.call(r);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),vr=e=>(e=e.toLowerCase(),r=>Gi(r)===e),qi=e=>r=>typeof r===e,{isArray:Ja}=Array,Va=qi("undefined");function Gn(e){return e!==null&&!Va(e)&&e.constructor!==null&&!Va(e.constructor)&&Vs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const D0=vr("ArrayBuffer");function M1(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&D0(e.buffer),r}const B1=qi("string"),Vs=qi("function"),I0=qi("number"),qn=e=>e!==null&&typeof e=="object",z1=e=>e===!0||e===!1,wi=e=>{if(Gi(e)!=="object")return!1;const r=wc(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(A0 in e)&&!(Vi in e)},$1=e=>{if(!qn(e)||Gn(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},U1=vr("Date"),W1=vr("File"),H1=vr("Blob"),V1=vr("FileList"),G1=e=>qn(e)&&Vs(e.pipe),q1=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Vs(e.append)&&((r=Gi(e))==="formdata"||r==="object"&&Vs(e.toString)&&e.toString()==="[object FormData]"))},Y1=vr("URLSearchParams"),[K1,X1,J1,Z1]=["ReadableStream","Request","Response","Headers"].map(vr),Q1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Yn(e,r,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),Ja(e))for(a=0,n=e.length;a<n;a++)r.call(null,e[a],a,e);else{if(Gn(e))return;const i=s?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(a=0;a<l;a++)o=i[a],r.call(null,e[o],o,e)}}function P0(e,r){if(Gn(e))return null;r=r.toLowerCase();const s=Object.keys(e);let a=s.length,n;for(;a-- >0;)if(n=s[a],r===n.toLowerCase())return n;return null}const na=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,R0=e=>!Va(e)&&e!==na;function Xo(){const{caseless:e,skipUndefined:r}=R0(this)&&this||{},s={},a=(n,i)=>{const l=e&&P0(s,i)||i;wi(s[l])&&wi(n)?s[l]=Xo(s[l],n):wi(n)?s[l]=Xo({},n):Ja(n)?s[l]=n.slice():(!r||!Va(n))&&(s[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Yn(arguments[n],a);return s}const ev=(e,r,s,{allOwnKeys:a}={})=>(Yn(r,(n,i)=>{s&&Vs(n)?e[i]=k0(n,s):e[i]=n},{allOwnKeys:a}),e),tv=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),sv=(e,r,s,a)=>{e.prototype=Object.create(r.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),s&&Object.assign(e.prototype,s)},rv=(e,r,s,a)=>{let n,i,l;const o={};if(r=r||{},e==null)return r;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!a||a(l,e,r))&&!o[l]&&(r[l]=e[l],o[l]=!0);e=s!==!1&&wc(e)}while(e&&(!s||s(e,r))&&e!==Object.prototype);return r},av=(e,r,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=r.length;const a=e.indexOf(r,s);return a!==-1&&a===s},nv=e=>{if(!e)return null;if(Ja(e))return e;let r=e.length;if(!I0(r))return null;const s=new Array(r);for(;r-- >0;)s[r]=e[r];return s},iv=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&wc(Uint8Array)),lv=(e,r)=>{const a=(e&&e[Vi]).call(e);let n;for(;(n=a.next())&&!n.done;){const i=n.value;r.call(e,i[0],i[1])}},ov=(e,r)=>{let s;const a=[];for(;(s=e.exec(r))!==null;)a.push(s);return a},cv=vr("HTMLFormElement"),dv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,n){return a.toUpperCase()+n}),wd=(({hasOwnProperty:e})=>(r,s)=>e.call(r,s))(Object.prototype),mv=vr("RegExp"),F0=(e,r)=>{const s=Object.getOwnPropertyDescriptors(e),a={};Yn(s,(n,i)=>{let l;(l=r(n,i,e))!==!1&&(a[i]=l||n)}),Object.defineProperties(e,a)},uv=e=>{F0(e,(r,s)=>{if(Vs(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=e[s];if(Vs(a)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},hv=(e,r)=>{const s={},a=n=>{n.forEach(i=>{s[i]=!0})};return Ja(e)?a(e):a(String(e).split(r)),s},fv=()=>{},xv=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function pv(e){return!!(e&&Vs(e.append)&&e[A0]==="FormData"&&e[Vi])}const gv=e=>{const r=new Array(10),s=(a,n)=>{if(qn(a)){if(r.indexOf(a)>=0)return;if(Gn(a))return a;if(!("toJSON"in a)){r[n]=a;const i=Ja(a)?[]:{};return Yn(a,(l,o)=>{const c=s(l,n+1);!Va(c)&&(i[o]=c)}),r[n]=void 0,i}}return a};return s(e,0)},vv=vr("AsyncFunction"),bv=e=>e&&(qn(e)||Vs(e))&&Vs(e.then)&&Vs(e.catch),O0=((e,r)=>e?setImmediate:r?((s,a)=>(na.addEventListener("message",({source:n,data:i})=>{n===na&&i===s&&a.length&&a.shift()()},!1),n=>{a.push(n),na.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Vs(na.postMessage)),jv=typeof queueMicrotask<"u"?queueMicrotask.bind(na):typeof process<"u"&&process.nextTick||O0,yv=e=>e!=null&&Vs(e[Vi]),ve={isArray:Ja,isArrayBuffer:D0,isBuffer:Gn,isFormData:q1,isArrayBufferView:M1,isString:B1,isNumber:I0,isBoolean:z1,isObject:qn,isPlainObject:wi,isEmptyObject:$1,isReadableStream:K1,isRequest:X1,isResponse:J1,isHeaders:Z1,isUndefined:Va,isDate:U1,isFile:W1,isBlob:H1,isRegExp:mv,isFunction:Vs,isStream:G1,isURLSearchParams:Y1,isTypedArray:iv,isFileList:V1,forEach:Yn,merge:Xo,extend:ev,trim:Q1,stripBOM:tv,inherits:sv,toFlatObject:rv,kindOf:Gi,kindOfTest:vr,endsWith:av,toArray:nv,forEachEntry:lv,matchAll:ov,isHTMLForm:cv,hasOwnProperty:wd,hasOwnProp:wd,reduceDescriptors:F0,freezeMethods:uv,toObjectSet:hv,toCamelCase:dv,noop:fv,toFiniteNumber:xv,findKey:P0,global:na,isContextDefined:R0,isSpecCompliantForm:pv,toJSONObject:gv,isAsyncFn:vv,isThenable:bv,setImmediate:O0,asap:jv,isIterable:yv};function ct(e,r,s,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),s&&(this.config=s),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}ve.inherits(ct,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ve.toJSONObject(this.config),code:this.code,status:this.status}}});const L0=ct.prototype,M0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{M0[e]={value:e}});Object.defineProperties(ct,M0);Object.defineProperty(L0,"isAxiosError",{value:!0});ct.from=(e,r,s,a,n,i)=>{const l=Object.create(L0);ve.toFlatObject(e,l,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=r==null&&e?e.code:r;return ct.call(l,o,c,s,a,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const Nv=null;function Jo(e){return ve.isPlainObject(e)||ve.isArray(e)}function B0(e){return ve.endsWith(e,"[]")?e.slice(0,-2):e}function Sd(e,r,s){return e?e.concat(r).map(function(n,i){return n=B0(n),!s&&i?"["+n+"]":n}).join(s?".":""):r}function wv(e){return ve.isArray(e)&&!e.some(Jo)}const Sv=ve.toFlatObject(ve,{},null,function(r){return/^is[A-Z]/.test(r)});function Yi(e,r,s){if(!ve.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,s=ve.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,g){return!ve.isUndefined(g[f])});const a=s.metaTokens,n=s.visitor||m,i=s.dots,l=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&ve.isSpecCompliantForm(r);if(!ve.isFunction(n))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(ve.isDate(x))return x.toISOString();if(ve.isBoolean(x))return x.toString();if(!c&&ve.isBlob(x))throw new ct("Blob is not supported. Use a Buffer instead.");return ve.isArrayBuffer(x)||ve.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function m(x,f,g){let v=x;if(x&&!g&&typeof x=="object"){if(ve.endsWith(f,"{}"))f=a?f:f.slice(0,-2),x=JSON.stringify(x);else if(ve.isArray(x)&&wv(x)||(ve.isFileList(x)||ve.endsWith(f,"[]"))&&(v=ve.toArray(x)))return f=B0(f),v.forEach(function(j,S){!(ve.isUndefined(j)||j===null)&&r.append(l===!0?Sd([f],S,i):l===null?f:f+"[]",d(j))}),!1}return Jo(x)?!0:(r.append(Sd(g,f,i),d(x)),!1)}const u=[],h=Object.assign(Sv,{defaultVisitor:m,convertValue:d,isVisitable:Jo});function p(x,f){if(!ve.isUndefined(x)){if(u.indexOf(x)!==-1)throw Error("Circular reference detected in "+f.join("."));u.push(x),ve.forEach(x,function(v,N){(!(ve.isUndefined(v)||v===null)&&n.call(r,v,ve.isString(N)?N.trim():N,f,h))===!0&&p(v,f?f.concat(N):[N])}),u.pop()}}if(!ve.isObject(e))throw new TypeError("data must be an object");return p(e),r}function Td(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return r[a]})}function Sc(e,r){this._pairs=[],e&&Yi(e,this,r)}const z0=Sc.prototype;z0.append=function(r,s){this._pairs.push([r,s])};z0.toString=function(r){const s=r?function(a){return r.call(this,a,Td)}:Td;return this._pairs.map(function(n){return s(n[0])+"="+s(n[1])},"").join("&")};function Tv(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $0(e,r,s){if(!r)return e;const a=s&&s.encode||Tv;ve.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let i;if(n?i=n(r,s):i=ve.isURLSearchParams(r)?r.toString():new Sc(r,s).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Ed{constructor(){this.handlers=[]}use(r,s,a){return this.handlers.push({fulfilled:r,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){ve.forEach(this.handlers,function(a){a!==null&&r(a)})}}const U0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ev=typeof URLSearchParams<"u"?URLSearchParams:Sc,Cv=typeof FormData<"u"?FormData:null,_v=typeof Blob<"u"?Blob:null,kv={isBrowser:!0,classes:{URLSearchParams:Ev,FormData:Cv,Blob:_v},protocols:["http","https","file","blob","url","data"]},Tc=typeof window<"u"&&typeof document<"u",Zo=typeof navigator=="object"&&navigator||void 0,Av=Tc&&(!Zo||["ReactNative","NativeScript","NS"].indexOf(Zo.product)<0),Dv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Iv=Tc&&window.location.href||"http://localhost",Pv=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Tc,hasStandardBrowserEnv:Av,hasStandardBrowserWebWorkerEnv:Dv,navigator:Zo,origin:Iv},Symbol.toStringTag,{value:"Module"})),Es={...Pv,...kv};function Rv(e,r){return Yi(e,new Es.classes.URLSearchParams,{visitor:function(s,a,n,i){return Es.isNode&&ve.isBuffer(s)?(this.append(a,s.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...r})}function Fv(e){return ve.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function Ov(e){const r={},s=Object.keys(e);let a;const n=s.length;let i;for(a=0;a<n;a++)i=s[a],r[i]=e[i];return r}function W0(e){function r(s,a,n,i){let l=s[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=s.length;return l=!l&&ve.isArray(n)?n.length:l,c?(ve.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!ve.isObject(n[l]))&&(n[l]=[]),r(s,a,n[l],i)&&ve.isArray(n[l])&&(n[l]=Ov(n[l])),!o)}if(ve.isFormData(e)&&ve.isFunction(e.entries)){const s={};return ve.forEachEntry(e,(a,n)=>{r(Fv(a),n,s,0)}),s}return null}function Lv(e,r,s){if(ve.isString(e))try{return(r||JSON.parse)(e),ve.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(e)}const Kn={transitional:U0,adapter:["xhr","http","fetch"],transformRequest:[function(r,s){const a=s.getContentType()||"",n=a.indexOf("application/json")>-1,i=ve.isObject(r);if(i&&ve.isHTMLForm(r)&&(r=new FormData(r)),ve.isFormData(r))return n?JSON.stringify(W0(r)):r;if(ve.isArrayBuffer(r)||ve.isBuffer(r)||ve.isStream(r)||ve.isFile(r)||ve.isBlob(r)||ve.isReadableStream(r))return r;if(ve.isArrayBufferView(r))return r.buffer;if(ve.isURLSearchParams(r))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Rv(r,this.formSerializer).toString();if((o=ve.isFileList(r))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Yi(o?{"files[]":r}:r,c&&new c,this.formSerializer)}}return i||n?(s.setContentType("application/json",!1),Lv(r)):r}],transformResponse:[function(r){const s=this.transitional||Kn.transitional,a=s&&s.forcedJSONParsing,n=this.responseType==="json";if(ve.isResponse(r)||ve.isReadableStream(r))return r;if(r&&ve.isString(r)&&(a&&!this.responseType||n)){const l=!(s&&s.silentJSONParsing)&&n;try{return JSON.parse(r,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?ct.from(o,ct.ERR_BAD_RESPONSE,this,null,this.response):o}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Es.classes.FormData,Blob:Es.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ve.forEach(["delete","get","head","post","put","patch"],e=>{Kn.headers[e]={}});const Mv=ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Bv=e=>{const r={};let s,a,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),s=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!s||r[s]&&Mv[s])&&(s==="set-cookie"?r[s]?r[s].push(a):r[s]=[a]:r[s]=r[s]?r[s]+", "+a:a)}),r},Cd=Symbol("internals");function ln(e){return e&&String(e).trim().toLowerCase()}function Si(e){return e===!1||e==null?e:ve.isArray(e)?e.map(Si):String(e)}function zv(e){const r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)r[a[1]]=a[2];return r}const $v=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ul(e,r,s,a,n){if(ve.isFunction(a))return a.call(this,r,s);if(n&&(r=s),!!ve.isString(r)){if(ve.isString(a))return r.indexOf(a)!==-1;if(ve.isRegExp(a))return a.test(r)}}function Uv(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,s,a)=>s.toUpperCase()+a)}function Wv(e,r){const s=ve.toCamelCase(" "+r);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(n,i,l){return this[a].call(this,r,n,i,l)},configurable:!0})})}let Gs=class{constructor(r){r&&this.set(r)}set(r,s,a){const n=this;function i(o,c,d){const m=ln(c);if(!m)throw new Error("header name must be a non-empty string");const u=ve.findKey(n,m);(!u||n[u]===void 0||d===!0||d===void 0&&n[u]!==!1)&&(n[u||c]=Si(o))}const l=(o,c)=>ve.forEach(o,(d,m)=>i(d,m,c));if(ve.isPlainObject(r)||r instanceof this.constructor)l(r,s);else if(ve.isString(r)&&(r=r.trim())&&!$v(r))l(Bv(r),s);else if(ve.isObject(r)&&ve.isIterable(r)){let o={},c,d;for(const m of r){if(!ve.isArray(m))throw TypeError("Object iterator must return a key-value pair");o[d=m[0]]=(c=o[d])?ve.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}l(o,s)}else r!=null&&i(s,r,a);return this}get(r,s){if(r=ln(r),r){const a=ve.findKey(this,r);if(a){const n=this[a];if(!s)return n;if(s===!0)return zv(n);if(ve.isFunction(s))return s.call(this,n,a);if(ve.isRegExp(s))return s.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,s){if(r=ln(r),r){const a=ve.findKey(this,r);return!!(a&&this[a]!==void 0&&(!s||ul(this,this[a],a,s)))}return!1}delete(r,s){const a=this;let n=!1;function i(l){if(l=ln(l),l){const o=ve.findKey(a,l);o&&(!s||ul(a,a[o],o,s))&&(delete a[o],n=!0)}}return ve.isArray(r)?r.forEach(i):i(r),n}clear(r){const s=Object.keys(this);let a=s.length,n=!1;for(;a--;){const i=s[a];(!r||ul(this,this[i],i,r,!0))&&(delete this[i],n=!0)}return n}normalize(r){const s=this,a={};return ve.forEach(this,(n,i)=>{const l=ve.findKey(a,i);if(l){s[l]=Si(n),delete s[i];return}const o=r?Uv(i):String(i).trim();o!==i&&delete s[i],s[o]=Si(n),a[o]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const s=Object.create(null);return ve.forEach(this,(a,n)=>{a!=null&&a!==!1&&(s[n]=r&&ve.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,s])=>r+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...s){const a=new this(r);return s.forEach(n=>a.set(n)),a}static accessor(r){const a=(this[Cd]=this[Cd]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=ln(l);a[o]||(Wv(n,l),a[o]=!0)}return ve.isArray(r)?r.forEach(i):i(r),this}};Gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ve.reduceDescriptors(Gs.prototype,({value:e},r)=>{let s=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(a){this[s]=a}}});ve.freezeMethods(Gs);function hl(e,r){const s=this||Kn,a=r||s,n=Gs.from(a.headers);let i=a.data;return ve.forEach(e,function(o){i=o.call(s,i,n.normalize(),r?r.status:void 0)}),n.normalize(),i}function H0(e){return!!(e&&e.__CANCEL__)}function Za(e,r,s){ct.call(this,e??"canceled",ct.ERR_CANCELED,r,s),this.name="CanceledError"}ve.inherits(Za,ct,{__CANCEL__:!0});function V0(e,r,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?e(s):r(new ct("Request failed with status code "+s.status,[ct.ERR_BAD_REQUEST,ct.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Hv(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function Vv(e,r){e=e||10;const s=new Array(e),a=new Array(e);let n=0,i=0,l;return r=r!==void 0?r:1e3,function(c){const d=Date.now(),m=a[i];l||(l=d),s[n]=c,a[n]=d;let u=i,h=0;for(;u!==n;)h+=s[u++],u=u%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),d-l<r)return;const p=m&&d-m;return p?Math.round(h*1e3/p):void 0}}function Gv(e,r){let s=0,a=1e3/r,n,i;const l=(d,m=Date.now())=>{s=m,n=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const m=Date.now(),u=m-s;u>=a?l(d,m):(n=d,i||(i=setTimeout(()=>{i=null,l(n)},a-u)))},()=>n&&l(n)]}const _i=(e,r,s=3)=>{let a=0;const n=Vv(50,250);return Gv(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-a,d=n(c),m=l<=o;a=l;const u={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&m?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[r?"download":"upload"]:!0};e(u)},s)},_d=(e,r)=>{const s=e!=null;return[a=>r[0]({lengthComputable:s,total:e,loaded:a}),r[1]]},kd=e=>(...r)=>ve.asap(()=>e(...r)),qv=Es.hasStandardBrowserEnv?((e,r)=>s=>(s=new URL(s,Es.origin),e.protocol===s.protocol&&e.host===s.host&&(r||e.port===s.port)))(new URL(Es.origin),Es.navigator&&/(msie|trident)/i.test(Es.navigator.userAgent)):()=>!0,Yv=Es.hasStandardBrowserEnv?{write(e,r,s,a,n,i){const l=[e+"="+encodeURIComponent(r)];ve.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),ve.isString(a)&&l.push("path="+a),ve.isString(n)&&l.push("domain="+n),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Kv(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Xv(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function G0(e,r,s){let a=!Kv(r);return e&&(a||s==!1)?Xv(e,r):r}const Ad=e=>e instanceof Gs?{...e}:e;function xa(e,r){r=r||{};const s={};function a(d,m,u,h){return ve.isPlainObject(d)&&ve.isPlainObject(m)?ve.merge.call({caseless:h},d,m):ve.isPlainObject(m)?ve.merge({},m):ve.isArray(m)?m.slice():m}function n(d,m,u,h){if(ve.isUndefined(m)){if(!ve.isUndefined(d))return a(void 0,d,u,h)}else return a(d,m,u,h)}function i(d,m){if(!ve.isUndefined(m))return a(void 0,m)}function l(d,m){if(ve.isUndefined(m)){if(!ve.isUndefined(d))return a(void 0,d)}else return a(void 0,m)}function o(d,m,u){if(u in r)return a(d,m);if(u in e)return a(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,m,u)=>n(Ad(d),Ad(m),u,!0)};return ve.forEach(Object.keys({...e,...r}),function(m){const u=c[m]||n,h=u(e[m],r[m],m);ve.isUndefined(h)&&u!==o||(s[m]=h)}),s}const q0=e=>{const r=xa({},e);let{data:s,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=r;if(r.headers=l=Gs.from(l),r.url=$0(G0(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ve.isFormData(s)){if(Es.hasStandardBrowserEnv||Es.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ve.isFunction(s.getHeaders)){const c=s.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([m,u])=>{d.includes(m.toLowerCase())&&l.set(m,u)})}}if(Es.hasStandardBrowserEnv&&(a&&ve.isFunction(a)&&(a=a(r)),a||a!==!1&&qv(r.url))){const c=n&&i&&Yv.read(i);c&&l.set(n,c)}return r},Jv=typeof XMLHttpRequest<"u",Zv=Jv&&function(e){return new Promise(function(s,a){const n=q0(e);let i=n.data;const l=Gs.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=n,m,u,h,p,x;function f(){p&&p(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function v(){if(!g)return;const j=Gs.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:j,config:e,request:g};V0(function(y){s(y),f()},function(y){a(y),f()},C),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(a(new ct("Request aborted",ct.ECONNABORTED,e,g)),g=null)},g.onerror=function(S){const C=S&&S.message?S.message:"Network Error",w=new ct(C,ct.ERR_NETWORK,e,g);w.event=S||null,a(w),g=null},g.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const C=n.transitional||U0;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),a(new ct(S,C.clarifyTimeoutError?ct.ETIMEDOUT:ct.ECONNABORTED,e,g)),g=null},i===void 0&&l.setContentType(null),"setRequestHeader"in g&&ve.forEach(l.toJSON(),function(S,C){g.setRequestHeader(C,S)}),ve.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),o&&o!=="json"&&(g.responseType=n.responseType),d&&([h,x]=_i(d,!0),g.addEventListener("progress",h)),c&&g.upload&&([u,p]=_i(c),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",p)),(n.cancelToken||n.signal)&&(m=j=>{g&&(a(!j||j.type?new Za(null,e,g):j),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const N=Hv(n.url);if(N&&Es.protocols.indexOf(N)===-1){a(new ct("Unsupported protocol "+N+":",ct.ERR_BAD_REQUEST,e));return}g.send(i||null)})},Qv=(e,r)=>{const{length:s}=e=e?e.filter(Boolean):[];if(r||s){let a=new AbortController,n;const i=function(d){if(!n){n=!0,o();const m=d instanceof Error?d:this.reason;a.abort(m instanceof ct?m:new Za(m instanceof Error?m.message:m))}};let l=r&&setTimeout(()=>{l=null,i(new ct(`timeout ${r} of ms exceeded`,ct.ETIMEDOUT))},r);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>ve.asap(o),c}},eb=function*(e,r){let s=e.byteLength;if(s<r){yield e;return}let a=0,n;for(;a<s;)n=a+r,yield e.slice(a,n),a=n},tb=async function*(e,r){for await(const s of sb(e))yield*eb(s,r)},sb=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:s,value:a}=await r.read();if(s)break;yield a}}finally{await r.cancel()}},Dd=(e,r,s,a)=>{const n=tb(e,r);let i=0,l,o=c=>{l||(l=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:m}=await n.next();if(d){o(),c.close();return}let u=m.byteLength;if(s){let h=i+=u;s(h)}c.enqueue(new Uint8Array(m))}catch(d){throw o(d),d}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},Id=64*1024,{isFunction:ci}=ve,rb=(({Request:e,Response:r})=>({Request:e,Response:r}))(ve.global),{ReadableStream:Pd,TextEncoder:Rd}=ve.global,Fd=(e,...r)=>{try{return!!e(...r)}catch{return!1}},ab=e=>{e=ve.merge.call({skipUndefined:!0},rb,e);const{fetch:r,Request:s,Response:a}=e,n=r?ci(r):typeof fetch=="function",i=ci(s),l=ci(a);if(!n)return!1;const o=n&&ci(Pd),c=n&&(typeof Rd=="function"?(x=>f=>x.encode(f))(new Rd):async x=>new Uint8Array(await new s(x).arrayBuffer())),d=i&&o&&Fd(()=>{let x=!1;const f=new s(Es.origin,{body:new Pd,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!f}),m=l&&o&&Fd(()=>ve.isReadableStream(new a("").body)),u={stream:m&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!u[x]&&(u[x]=(f,g)=>{let v=f&&f[x];if(v)return v.call(f);throw new ct(`Response type '${x}' is not supported`,ct.ERR_NOT_SUPPORT,g)})});const h=async x=>{if(x==null)return 0;if(ve.isBlob(x))return x.size;if(ve.isSpecCompliantForm(x))return(await new s(Es.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(ve.isArrayBufferView(x)||ve.isArrayBuffer(x))return x.byteLength;if(ve.isURLSearchParams(x)&&(x=x+""),ve.isString(x))return(await c(x)).byteLength},p=async(x,f)=>{const g=ve.toFiniteNumber(x.getContentLength());return g??h(f)};return async x=>{let{url:f,method:g,data:v,signal:N,cancelToken:j,timeout:S,onDownloadProgress:C,onUploadProgress:w,responseType:y,headers:T,withCredentials:k="same-origin",fetchOptions:P}=q0(x),A=r||fetch;y=y?(y+"").toLowerCase():"text";let _=Qv([N,j&&j.toAbortSignal()],S),U=null;const D=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let W;try{if(w&&d&&g!=="get"&&g!=="head"&&(W=await p(T,v))!==0){let ie=new s(f,{method:"POST",body:v,duplex:"half"}),B;if(ve.isFormData(v)&&(B=ie.headers.get("content-type"))&&T.setContentType(B),ie.body){const[V,z]=_d(W,_i(kd(w)));v=Dd(ie.body,Id,V,z)}}ve.isString(k)||(k=k?"include":"omit");const q=i&&"credentials"in s.prototype,Y={...P,signal:_,method:g.toUpperCase(),headers:T.normalize().toJSON(),body:v,duplex:"half",credentials:q?k:void 0};U=i&&new s(f,Y);let K=await(i?A(U,P):A(f,Y));const H=m&&(y==="stream"||y==="response");if(m&&(C||H&&D)){const ie={};["status","statusText","headers"].forEach(L=>{ie[L]=K[L]});const B=ve.toFiniteNumber(K.headers.get("content-length")),[V,z]=C&&_d(B,_i(kd(C),!0))||[];K=new a(Dd(K.body,Id,V,()=>{z&&z(),D&&D()}),ie)}y=y||"text";let je=await u[ve.findKey(u,y)||"text"](K,x);return!H&&D&&D(),await new Promise((ie,B)=>{V0(ie,B,{data:je,headers:Gs.from(K.headers),status:K.status,statusText:K.statusText,config:x,request:U})})}catch(q){throw D&&D(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new ct("Network Error",ct.ERR_NETWORK,x,U),{cause:q.cause||q}):ct.from(q,q&&q.code,x,U)}}},nb=new Map,Y0=e=>{let r=e?e.env:{};const{fetch:s,Request:a,Response:n}=r,i=[a,n,s];let l=i.length,o=l,c,d,m=nb;for(;o--;)c=i[o],d=m.get(c),d===void 0&&m.set(c,d=o?new Map:ab(r)),m=d;return d};Y0();const Qo={http:Nv,xhr:Zv,fetch:{get:Y0}};ve.forEach(Qo,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const Od=e=>`- ${e}`,ib=e=>ve.isFunction(e)||e===null||e===!1,K0={getAdapter:(e,r)=>{e=ve.isArray(e)?e:[e];const{length:s}=e;let a,n;const i={};for(let l=0;l<s;l++){a=e[l];let o;if(n=a,!ib(a)&&(n=Qo[(o=String(a)).toLowerCase()],n===void 0))throw new ct(`Unknown adapter '${o}'`);if(n&&(ve.isFunction(n)||(n=n.get(r))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=s?l.length>1?`since :
`+l.map(Od).join(`
`):" "+Od(l[0]):"as no adapter specified";throw new ct("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Qo};function fl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Za(null,e)}function Ld(e){return fl(e),e.headers=Gs.from(e.headers),e.data=hl.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),K0.getAdapter(e.adapter||Kn.adapter,e)(e).then(function(a){return fl(e),a.data=hl.call(e,e.transformResponse,a),a.headers=Gs.from(a.headers),a},function(a){return H0(a)||(fl(e),a&&a.response&&(a.response.data=hl.call(e,e.transformResponse,a.response),a.response.headers=Gs.from(a.response.headers))),Promise.reject(a)})}const X0="1.12.2",Ki={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Ki[e]=function(a){return typeof a===e||"a"+(r<1?"n ":" ")+e}});const Md={};Ki.transitional=function(r,s,a){function n(i,l){return"[Axios v"+X0+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(r===!1)throw new ct(n(l," has been removed"+(s?" in "+s:"")),ct.ERR_DEPRECATED);return s&&!Md[l]&&(Md[l]=!0,console.warn(n(l," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(i,l,o):!0}};Ki.spelling=function(r){return(s,a)=>(console.warn(`${a} is likely a misspelling of ${r}`),!0)};function lb(e,r,s){if(typeof e!="object")throw new ct("options must be an object",ct.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const i=a[n],l=r[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new ct("option "+i+" must be "+c,ct.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new ct("Unknown option "+i,ct.ERR_BAD_OPTION)}}const Ti={assertOptions:lb,validators:Ki},br=Ti.validators;let la=class{constructor(r){this.defaults=r||{},this.interceptors={request:new Ed,response:new Ed}}async request(r,s){try{return await this._request(r,s)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(r,s){typeof r=="string"?(s=s||{},s.url=r):s=r||{},s=xa(this.defaults,s);const{transitional:a,paramsSerializer:n,headers:i}=s;a!==void 0&&Ti.assertOptions(a,{silentJSONParsing:br.transitional(br.boolean),forcedJSONParsing:br.transitional(br.boolean),clarifyTimeoutError:br.transitional(br.boolean)},!1),n!=null&&(ve.isFunction(n)?s.paramsSerializer={serialize:n}:Ti.assertOptions(n,{encode:br.function,serialize:br.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Ti.assertOptions(s,{baseUrl:br.spelling("baseURL"),withXsrfToken:br.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=i&&ve.merge(i.common,i[s.method]);i&&ve.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),s.headers=Gs.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(s)===!1||(c=c&&f.synchronous,o.unshift(f.fulfilled,f.rejected))});const d=[];this.interceptors.response.forEach(function(f){d.push(f.fulfilled,f.rejected)});let m,u=0,h;if(!c){const x=[Ld.bind(this),void 0];for(x.unshift(...o),x.push(...d),h=x.length,m=Promise.resolve(s);u<h;)m=m.then(x[u++],x[u++]);return m}h=o.length;let p=s;for(;u<h;){const x=o[u++],f=o[u++];try{p=x(p)}catch(g){f.call(this,g);break}}try{m=Ld.call(this,p)}catch(x){return Promise.reject(x)}for(u=0,h=d.length;u<h;)m=m.then(d[u++],d[u++]);return m}getUri(r){r=xa(this.defaults,r);const s=G0(r.baseURL,r.url,r.allowAbsoluteUrls);return $0(s,r.params,r.paramsSerializer)}};ve.forEach(["delete","get","head","options"],function(r){la.prototype[r]=function(s,a){return this.request(xa(a||{},{method:r,url:s,data:(a||{}).data}))}});ve.forEach(["post","put","patch"],function(r){function s(a){return function(i,l,o){return this.request(xa(o||{},{method:r,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}la.prototype[r]=s(),la.prototype[r+"Form"]=s(!0)});let ob=class J0{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(i){s=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},r(function(i,l,o){a.reason||(a.reason=new Za(i,l,o),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const r=new AbortController,s=a=>{r.abort(a)};return this.subscribe(s),r.signal.unsubscribe=()=>this.unsubscribe(s),r.signal}static source(){let r;return{token:new J0(function(n){r=n}),cancel:r}}};function cb(e){return function(s){return e.apply(null,s)}}function db(e){return ve.isObject(e)&&e.isAxiosError===!0}const ec={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ec).forEach(([e,r])=>{ec[r]=e});function Z0(e){const r=new la(e),s=k0(la.prototype.request,r);return ve.extend(s,la.prototype,r,{allOwnKeys:!0}),ve.extend(s,r,null,{allOwnKeys:!0}),s.create=function(n){return Z0(xa(e,n))},s}const Xt=Z0(Kn);Xt.Axios=la;Xt.CanceledError=Za;Xt.CancelToken=ob;Xt.isCancel=H0;Xt.VERSION=X0;Xt.toFormData=Yi;Xt.AxiosError=ct;Xt.Cancel=Xt.CanceledError;Xt.all=function(r){return Promise.all(r)};Xt.spread=cb;Xt.isAxiosError=db;Xt.mergeConfig=xa;Xt.AxiosHeaders=Gs;Xt.formToJSON=e=>W0(ve.isHTMLForm(e)?new FormData(e):e);Xt.getAdapter=K0.getAdapter;Xt.HttpStatusCode=ec;Xt.default=Xt;const{Axios:XA,AxiosError:JA,CanceledError:ZA,isCancel:QA,CancelToken:e6,VERSION:t6,all:s6,Cancel:r6,isAxiosError:a6,spread:n6,toFormData:i6,AxiosHeaders:l6,HttpStatusCode:o6,formToJSON:c6,getAdapter:d6,mergeConfig:m6}=Xt,ki={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},Ec=()=>"/dsfms-template/",mb=(e="/")=>{const s=`${Ec()}${e}`;window.location.href=s},xl=()=>{mb("/")},Q0="https://dsfms.id.vn",De=Xt.create({baseURL:Q0,timeout:1e4,headers:{"Content-Type":"application/json"}});let pl=!1,tc=[],di=0;const Bd=2,eu=e=>{try{const r=JSON.parse(atob(e.split(".")[1])),s=Date.now()/1e3;return r.exp<s}catch{return!0}},ub=e=>{try{const r=JSON.parse(atob(e.split(".")[1])),s=Date.now()/1e3;return r.exp-s<300}catch{return!0}},zd=(e,r=null)=>{tc.forEach(s=>{e?s.reject(e):s.resolve(r)}),tc=[]};De.interceptors.request.use(e=>{const r=localStorage.getItem("authToken");return r&&(eu(r)?console.log(" Token is expired, will trigger refresh in response interceptor"):ub(r)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${r}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));De.interceptors.response.use(e=>e,async e=>{const r=e.config,s=e.response?.status;if(s===401&&!r._retry&&!r.url?.includes("/auth/")&&di<Bd){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),pl)return new Promise((n,i)=>{tc.push({resolve:n,reject:i})}).then(n=>(r.headers.Authorization=`Bearer ${n}`,De(r))).catch(n=>Promise.reject(n));r._retry=!0,pl=!0,di++;const a=localStorage.getItem("refreshToken");if(a)try{if(console.log(" Token ht hn (401), ang refresh token..."),eu(a))throw new Error("Refresh token is also expired");const n=await Xt.post(`${Q0}/auth/refresh`,{refresh_token:a}),{access_token:i,refresh_token:l}=n.data;if(!i||!l)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",l),di=0,console.log(" Refresh token thnh cng, retry request gc"),zd(null,i),r.headers.Authorization=`Bearer ${i}`,await De(r)}catch(n){return console.error(" Refresh token tht bi:",n),zd(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),xl(),Promise.reject(n)}finally{pl=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),xl()}else{if(s===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);di>=Bd&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),xl())}return Promise.reject(e)});const mi=Xt.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),$r={login:async e=>{try{return(await mi.post("/auth/login",e)).data}catch(r){throw r.response?.data||r.message}},refreshToken:async e=>{try{return(await mi.post("/auth/refresh",{refresh_token:e})).data}catch(r){throw r.response?.data||r.message}},checkStatus:async()=>{try{return(await De.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,r)=>{try{return(await mi.post("/auth/forgot-password",{email:e,magicLink:r})).data}catch(s){throw s.response?.data||s.message}},resetPasswordWithToken:async(e,r,s)=>{try{return(await mi.post("/auth/reset-password",{token:e,newPassword:r,confirmPassword:s})).data}catch(a){throw a.response?.data||a.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},Is={getUsers:async(e={})=>{try{return(await De.get("/users",{params:e})).data}catch(r){throw r.response?.data||r.message}},getUserById:async e=>{try{return(await De.get(`/users/${e}`)).data}catch(r){throw r.response?.data||r.message}},getProfile:async()=>{try{return(await De.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await De.post("/users",e)).data}catch(r){throw r.response?.data||r.message}},updateUser:async(e,r)=>{try{return(await De.put(`/users/${e}`,r)).data}catch(s){throw s.response?.data||s.message}},deleteUser:async e=>{try{return(await De.delete(`/users/${e}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportUsers:async e=>{try{return(await De.post("/users/bulk",{users:e})).data}catch(r){throw r.response?.data||r.message}},getRoles:async()=>{try{return(await De.get("/roles")).data}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await De.patch(`/users/${e}/enable`)).data}catch(r){throw r.response?.data||r.message}},disableUser:async e=>{try{return(await De.delete(`/users/${e}`)).data}catch(r){throw r.response?.data||r.message}},toggleUserStatus:async(e,r)=>{try{return(await De.patch(`/users/${e}`,{status:r})).data}catch(s){throw s.response?.data||s.message}},resetPassword:async e=>{try{return(await De.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(r){throw r.response?.data||r.message}},getTrainers:async(e={})=>{try{return(await De.get("/users",{params:{includeDeleted:!0,roleName:"TRAINER",...e}})).data}catch(r){throw r.response?.data||r.message}}},Ps={getRoles:async(e={})=>{try{return(await De.get("/roles",{params:e})).data}catch(r){throw r.response?.data||r.message}},getRoleById:async e=>{try{return(await De.get(`/roles/${e}`)).data}catch(r){throw r.response?.data||r.message}},createRole:async e=>{try{return(await De.post("/roles",e)).data}catch(r){throw r.response?.data||r.message}},updateRole:async(e,r)=>{try{console.log(" API updateRole called with:",{id:e,roleData:r,url:`/roles/${e}`,method:"PUT"});const s=await De.put(`/roles/${e}`,r);return console.log(" API updateRole success:",s.data),s.data}catch(s){throw console.error(" API updateRole error:",{status:s.response?.status,statusText:s.response?.statusText,data:s.response?.data,message:s.message}),s.response?.data||s.message}},deleteRole:async e=>{try{return(await De.delete(`/roles/${e}`)).data}catch(r){throw r.response?.data||r.message}},toggleRoleStatus:async e=>{try{return(await De.patch(`/roles/${e}/toggle-status`)).data}catch(r){throw r.response?.data||r.message}},enableRole:async e=>{try{return(await De.patch(`/roles/${e}/enable`)).data}catch(r){throw r.response?.data||r.message}},disableRole:async e=>{try{return(await De.delete(`/roles/${e}`)).data}catch(r){throw r.response?.data||r.message}}},Nt={getDepartments:async(e={})=>{try{return(await De.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(r){throw console.error("Error fetching departments:",r),r}},getDepartmentById:async e=>{try{return(await De.get(`/departments/${e}`,{params:{includeDeleted:!0}})).data}catch(r){throw console.error("Error fetching department:",r),r}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const r=await De.post("/departments",e);return console.log(" API - Department created successfully:",r.data),r.data}catch(r){throw console.error(" API - Error creating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),r}},updateDepartment:async(e,r)=>{try{return(await De.put(`/departments/${e}`,r)).data}catch(s){throw console.error("Error updating department:",s),s}},deleteDepartment:async e=>{try{return(await De.delete(`/departments/${e}`)).data}catch(r){throw console.error("Error deleting department:",r),r}},disableDepartment:async e=>{try{return(await De.delete(`/departments/${e}`)).data}catch(r){throw console.error("Error disabling department:",r),r}},enableDepartment:async e=>{try{return(await De.patch(`/departments/${e}/enable`)).data}catch(r){throw console.error("Error enabling department:",r),r}},toggleDepartmentStatus:async e=>{try{return(await De.patch(`/departments/${e}/toggle-status`)).data}catch(r){throw console.error("Error toggling department status:",r),r}},bulkDeleteDepartments:async e=>{try{return(await De.delete("/departments/bulk",{data:{ids:e}})).data}catch(r){throw console.error("Error bulk deleting departments:",r),r}},bulkToggleStatus:async(e,r)=>{try{return(await De.patch("/departments/bulk/toggle-status",{ids:e,status:r})).data}catch(s){throw console.error("Error bulk toggling department status:",s),s}},getDepartmentHeads:async()=>{try{return(await De.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,r)=>{try{return(await De.patch(`/departments/${e}/add-trainers`,{trainerEids:r})).data}catch(s){throw console.error("Error assigning trainers to department:",s),s}},removeTrainersFromDepartment:async(e,r)=>{try{return(await De.patch(`/departments/${e}/remove-trainers`,{trainerEids:r})).data}catch(s){throw console.error("Error removing trainers from department:",s),s}}},Ss={getCourses:async(e={})=>{try{return(await De.get("/courses",{params:e})).data}catch(r){throw console.error("Error fetching courses:",r),r}},getCourseById:async e=>{try{return(await De.get(`/courses/${e}`)).data}catch(r){throw console.error("Error fetching course:",r),r}},createCourse:async e=>{try{return(await De.post("/courses",e)).data}catch(r){throw console.error("Error creating course:",r),r}},updateCourse:async(e,r)=>{try{return(await De.put(`/courses/${e}`,r)).data}catch(s){throw console.error("Error updating course:",s),s}},deleteCourse:async e=>{try{return(await De.delete(`/courses/${e}`)).data}catch(r){throw console.error("Error deleting course:",r),r}},archiveCourse:async e=>{try{return(await De.patch(`/courses/${e}/archive`)).data}catch(r){throw console.error("Error archiving course:",r),r}},restoreCourse:async e=>{try{return(await De.post(`/courses/${e}/restore`)).data}catch(r){throw console.error("Error restoring course:",r),r}},getCoursesByDepartment:async(e,r={})=>{try{return(await De.get("/courses",{params:{departmentId:e,...r}})).data}catch(s){throw console.error("Error fetching courses by department:",s),s}},getDepartmentWithCourses:async e=>{try{return(await De.get(`/courses/department/${e}`)).data}catch(r){throw console.error("Error fetching department with courses:",r),r}},getDepartmentById:async e=>{try{return(await De.get(`/departments/${e}`)).data}catch(r){throw console.error("Error fetching department by ID:",r),r}},getTraineeEnrollments:async e=>(await De.get(`/courses/trainees/${e}/enrollments`)).data,getCourseTrainees:async e=>{try{return(await De.get(`/courses/${e}/trainees`)).data}catch(r){throw console.error("Error fetching course trainees:",r),r}}},En={getTrainees:async(e={})=>{try{return(await De.get("/trainees",{params:e})).data}catch(r){throw r.response?.data||r.message}},getTraineeById:async e=>{try{return(await De.get(`/trainees/${e}`)).data}catch(r){throw r.response?.data||r.message}},createTrainee:async e=>{try{return(await De.post("/trainees",e)).data}catch(r){throw r.response?.data||r.message}},updateTrainee:async(e,r)=>{try{return(await De.put(`/trainees/${e}`,r)).data}catch(s){throw s.response?.data||s.message}},deleteTrainee:async e=>{try{return(await De.delete(`/trainees/${e}`)).data}catch(r){throw r.response?.data||r.message}},toggleTraineeStatus:async e=>{try{return(await De.patch(`/trainees/${e}/toggle-status`)).data}catch(r){throw r.response?.data||r.message}},getTraineeCourses:async e=>{try{return(await De.get(`/trainees/${e}/courses`)).data}catch(r){throw r.response?.data||r.message}},getTraineeSubjects:async(e,r=null)=>{try{const s=r?`/trainees/${e}/subjects?courseId=${r}`:`/trainees/${e}/subjects`;return(await De.get(s)).data}catch(s){throw s.response?.data||s.message}},getTraineeAssessments:async e=>{try{return(await De.get(`/trainees/${e}/assessments`)).data}catch(r){throw r.response?.data||r.message}},enrollTrainee:async(e,r)=>{try{return(await De.post(`/trainees/${e}/enroll`,{courseId:r})).data}catch(s){throw s.response?.data||s.message}},unenrollTrainee:async(e,r)=>{try{return(await De.delete(`/trainees/${e}/enroll/${r}`)).data}catch(s){throw s.response?.data||s.message}},bulkImportTrainees:async e=>{try{return(await De.post("/trainees/bulk-import",e)).data}catch(r){throw r.response?.data||r.message}},getTraineesForEnrollment:async(e={})=>{try{return(await De.get("/users",{params:{includeDeleted:!0,roleName:"TRAINEE",...e}})).data}catch(r){throw r.response?.data||r.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const r={trainees:e};console.log("Sending request with format:",r);const s=await De.post("/subjects/trainees/lookup",r);return console.log("API response:",s.data),s.data}catch(r){throw console.error("Lookup failed:",r.response?.data),r.response?.data||r.message}},getTraineesByCourseId:async e=>{try{return(await De.get(`/courses/${e}/trainees`)).data}catch(r){throw console.error("Error fetching trainees by course ID:",r),r}}},Os={getSubjects:async(e={})=>{try{return(await De.get("/subjects",{params:e})).data}catch(r){throw console.error("Error fetching subjects:",r),r}},getSubjectsByCourse:async(e,r={})=>{const s=`/subjects/course/${e}`;console.log(" API Call - URL:",s),console.log(" API Call - courseId:",e),console.log(" API Call - params:",r);try{const a=await De.get(s,{params:r});return console.log(" API Call - Response:",a),console.log(" API Call - Response data:",a.data),a.data}catch(a){throw console.error(" API Call - Error:",a),console.error(" API Call - Error response:",a.response),console.error(" API Call - Error status:",a.response?.status),console.error(" API Call - Error data:",a.response?.data),a}},getSubjectById:async e=>{try{console.log(" Fetching subject by ID:",e),console.log(" SubjectId type:",typeof e),console.log(" SubjectId length:",e?.length);const r=await De.get(`/subjects/${e}`,{data:void 0,transformRequest:[(s,a)=>{delete a["Content-Type"]}]});return console.log(" Subject detail response:",r),console.log(" Response data:",r.data),r.data&&r.data.data?r.data.data:r.data}catch(r){throw console.error(" Error fetching subject:",r),console.error(" Error response:",r.response?.data),console.error(" Error status:",r.response?.status),console.error(" Error config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data,headers:r.config?.headers}),r.response?.data?.errors&&Array.isArray(r.response.data.errors)&&(console.error(" Validation errors:",JSON.stringify(r.response.data.errors,null,2)),r.response.data.errors.forEach((s,a)=>{console.error(` Error ${a+1}:`,{field:s.field,message:s.message,code:s.code,value:s.value})})),r}},createSubject:async e=>{try{return(await De.post("/subjects",e)).data}catch(r){throw console.error("Error creating subject:",r),r}},updateSubject:async(e,r)=>{try{return(await De.put(`/subjects/${e}`,r)).data}catch(s){throw console.error("Error updating subject:",s),s}},deleteSubject:async e=>{try{return(await De.delete(`/subjects/${e}`)).data}catch(r){throw console.error("Error deleting subject:",r),r}},archiveSubject:async e=>{try{return(await De.patch(`/subjects/${e}/archive`)).data}catch(r){throw console.error("Error archiving subject:",r),r}},bulkImportSubjects:async e=>{try{console.log(" Sending bulk import data to API:",e),console.log(" Data type check:",{isArray:Array.isArray(e),length:e.length,firstItem:e[0],firstItemKeys:Object.keys(e[0]||{}),firstItemTypes:Object.keys(e[0]||{}).reduce((n,i)=>(n[i]=typeof e[0][i],n),{})});const s={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...l}=n;return l})};console.log(" Using working format:",s);const a=await De.post("/subjects/bulk",s);return console.log(" Bulk import API response:",a.data),a.data}catch(r){throw console.error(" Error bulk importing subjects:",r),console.error(" Error details:",r.response?.data),console.error(" Error status:",r.response?.status),console.error(" Error message:",r.response?.data?.message),console.error(" Validation errors:",r.response?.data?.errors),console.error(" Full error response:",JSON.stringify(r.response?.data,null,2)),r}},assignTrainees:async(e,r)=>{try{console.log(" Assigning trainees to subject:",e),console.log(" Trainee data being sent:",JSON.stringify(r,null,2)),console.log(" Data validation:",{subjectId:e,subjectIdType:typeof e,traineeDataKeys:Object.keys(r),enrolledCount:r.enrolledCount,enrolledArray:r.enrolled,enrolledLength:r.enrolled?.length,firstTrainee:r.enrolled?.[0],firstTraineeKeys:r.enrolled?.[0]?Object.keys(r.enrolled[0]):null});const s=await De.post(`/subjects/${e}/assign-trainees`,r);return console.log(" Assign trainees API response:",s.data),s.data}catch(s){throw console.error(" Error assigning trainees to subject:",s),console.error(" Error status:",s.response?.status),console.error(" Error details:",s.response?.data),console.error(" Error message:",s.response?.data?.message),console.error(" Validation errors:",s.response?.data?.errors),console.error(" Full error response:",JSON.stringify(s.response?.data,null,2)),s}},removeTraineeFromSubject:async(e,r,s)=>{try{console.log(" Removing trainee from subject:",{subjectId:e,traineeId:r,batchCode:s});const a={batchCode:s};console.log(" Request data:",JSON.stringify(a,null,2));const n=await De.delete(`/subjects/${e}/trainees/${r}`,{data:a});return console.log(" Remove trainee from subject API response:",n.data),n.data}catch(a){throw console.error(" Error removing trainee from subject:",a),console.error(" Error status:",a.response?.status),console.error(" Error details:",a.response?.data),console.error(" Error message:",a.response?.data?.message),a}},addTrainerToSubject:async(e,r)=>{try{const s={trainerUserId:r.trainer_user_id,roleInSubject:r.role_in_subject};return(await De.post(`/subjects/${e}/trainers`,s)).data}catch(s){throw s.response?.data||s.message}},getSubjectTrainers:async e=>{try{return(await De.get(`/subjects/${e}/trainers`)).data}catch(r){throw r.response?.data||r.message}},updateTrainerRole:async(e,r,s)=>{try{const a={roleInSubject:s.roleInSubject};return(await De.put(`/subjects/${e}/trainers/${r}`,a)).data}catch(a){throw a.response?.data||a.message}},removeTrainerFromSubject:async(e,r)=>{try{return(await De.delete(`/subjects/${e}/trainers/${r}`)).data}catch(s){throw s.response?.data||s.message}}},Ai={uploadDocument:async(e,r)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const s=["files"];for(const a of s)try{const n=new FormData;n.append(a,e),console.log(` Testing field name: "${a}"`);const i=await De.post(`/media/docs/upload/${r}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${a}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${a}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`},on={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},hr=(e,r={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return on[e]||e;if(e&&typeof e=="object"){const{message:s,errors:a}=e;let n=s;if(Array.isArray(s))if(s.length>0){const l=s[0];typeof l=="object"&&l!==null?n=l.message||l.field||"Validation failed":n=l}else n="Validation failed";const i=on[n]||n;if(a&&Array.isArray(a)&&a.length>0){const l=a.map(o=>{if(typeof o=="string"){const c=o.match(/(\w+)\s+(.+)/);if(c){const[,d,m]=c;return on[n]?.fields?.[d]||m}return o}else if(typeof o=="object"&&o!==null)return o.field&&o.message?on[n]?.fields?.[o.field]||o.message:o.property&&o.constraints?on[n]?.fields?.[o.property]||Object.values(o.constraints)[0]||o.property:JSON.stringify(o);return String(o)});return`${i}

Details:
${l.join(`
`)}`}return i}return e?.response?.data?hr(e.response.data,r):e?.message||"An unknown error occurred. Please try again."},tu=b.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),hb=({children:e})=>{const[r,s]=b.useState(null),[a,n]=b.useState(null),[i,l]=b.useState([]),[o,c]=b.useState(!1),[d,m]=b.useState(!0);b.useEffect(()=>{(async()=>{try{const v=localStorage.getItem("authToken"),N=localStorage.getItem("user"),j=localStorage.getItem("refreshToken");if(v&&N&&j)try{const S=JSON.parse(atob(v.split(".")[1])),C=Date.now()/1e3;if(S.exp<C)try{const w=await $r.refreshToken(j);localStorage.setItem("authToken",w.access_token),localStorage.setItem("refreshToken",w.refresh_token);const y=JSON.parse(N);s(y),c(!0);try{const{role:T,permissions:k}=await u(y.role,y.roleId);if(T&&k)n(T),l(k);else throw new Error("Failed to fetch role and permissions")}catch(T){console.error("Failed to fetch role and permissions on initialization:",T),$r.logout(),s(null),n(null),l([]),c(!1)}}catch{$r.logout(),s(null),n(null),l([]),c(!1)}else{const w=JSON.parse(N);s(w),c(!0);try{const{role:y,permissions:T}=await u(w.role,w.roleId);if(y&&T)n(y),l(T);else throw new Error("Failed to fetch role and permissions")}catch(y){console.error("Failed to fetch role and permissions on initialization:",y),$r.logout(),s(null),n(null),l([]),c(!1)}}}catch(S){console.error(" Error parsing token or user data:",S),$r.logout(),s(null),n(null),l([]),c(!1)}else s(null),n(null),l([]),c(!1)}catch(v){console.error("Error accessing localStorage:",v),s(null),n(null),l([]),c(!1)}finally{m(!1)}})()},[]),b.useEffect(()=>{if(!o||d)return;const g=async()=>{const N=localStorage.getItem("authToken"),j=localStorage.getItem("refreshToken");if(!N||!j){x();return}try{const S=JSON.parse(atob(N.split(".")[1])),C=Date.now()/1e3;S.exp-C<300&&((await p()).success||(console.error(" Token refresh failed in validation"),x()))}catch(S){console.error(" Token validation failed:",S);try{(await p()).success||(console.error(" Token refresh failed after validation error"),x())}catch(C){console.error(" Token refresh failed:",C),x()}}},v=setTimeout(()=>{g();const N=setInterval(g,120*1e3);return()=>clearInterval(N)},500);return()=>clearTimeout(v)},[o,d]);const u=async(g,v)=>{try{if(v)try{const N=await Ps.getRoleById(v);return n(N),l(N.permissions||[]),{role:N,permissions:N.permissions||[]}}catch(N){if(console.error("Error fetching role by ID:",N),N.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{const S=await De.get("/users/me");if(S.data&&S.data.role&&S.data.role.permissions){const C={id:v,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:S.data.role.permissions};return n(C),l(C.permissions),{role:C,permissions:C.permissions}}}catch(S){console.error("Failed to get user profile:",S)}console.warn("Cannot fetch permissions, creating minimal role");const j={id:v,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return n(j),l([]),{role:j,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const N=await Ps.getRoles(),j=N.data||N;let S;if(j&&j.roles&&Array.isArray(j.roles))S=j.roles;else if(Array.isArray(j))S=j;else throw new Error("Invalid roles data structure");const C=S.find(w=>w.name===g);if(C){const w=await Ps.getRoleById(C.id);return n(w),l(w.permissions||[]),{role:w,permissions:w.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(N){throw console.error("Fallback method failed:",N),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(N){return console.error("Error fetching user role and permissions:",N),{role:null,permissions:[]}}},h=async g=>{try{m(!0);const v=await $r.login(g);localStorage.setItem("authToken",v.access_token),localStorage.setItem("refreshToken",v.refresh_token);let N;try{const C=JSON.parse(atob(v.access_token.split(".")[1]));if(!C.userId||!C.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");N={id:C.userId,email:g.email,fullName:C.fullName||C.name||"User",role:C.roleName,roleId:C.roleId,department:C.department||"IT",lastLogin:new Date().toISOString()},g.email==="depthead@test.com"&&(N.role="DEPARTMENT_HEAD",N.roleId="dept-head-001")}catch(C){throw console.error("Error decoding token:",C),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(N));const{role:j,permissions:S}=await u(N.role,N.roleId);if(!j||!S)throw new Error("Failed to fetch user role and permissions");return s(N),n(j),l(S),c(!0),{success:!0,user:N,role:j,permissions:S}}catch(v){return{success:!1,error:hr(v)||"Login failed"}}finally{m(!1)}},p=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const v=await $r.refreshToken(g);return localStorage.setItem("authToken",v.access_token),localStorage.setItem("refreshToken",v.refresh_token),{success:!0,tokens:v}}catch(g){return console.error("Manual token refresh failed:",g),x(),{success:!1,error:g.message}}},x=()=>{$r.logout(),s(null),n(null),l([]),c(!1)},f={user:r,setUser:s,userRole:a,userPermissions:i,isAuthenticated:o,setIsAuthenticated:c,isLoading:d,login:h,logout:x,refreshToken:p,fetchUserRoleAndPermissions:u};try{return t.jsx(tu.Provider,{value:f,children:e})}catch(g){return console.error(" AuthProvider error:",g),t.jsxs("div",{style:{padding:"20px",color:"red"},children:[t.jsx("h3",{children:"Authentication Error"}),t.jsx("p",{children:"There was an error initializing the authentication system."}),t.jsxs("details",{children:[t.jsx("summary",{children:"Error Details"}),t.jsx("pre",{children:g.message})]})]})}},Us=()=>{const e=b.useContext(tu);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},fb={getPermissions:async(e={})=>{try{return(await De.get("/permissions",{params:e})).data}catch(r){throw r.response?.data||r.message}},getPermissionById:async e=>{try{return(await De.get(`/permissions/${e}`)).data}catch(r){throw r.response?.data||r.message}},createPermission:async e=>{try{return(await De.post("/permissions",e)).data}catch(r){throw r.response?.data||r.message}},updatePermission:async(e,r)=>{try{return(await De.put(`/permissions/${e}`,r)).data}catch(s){throw s.response?.data||s.message}},deletePermission:async e=>{try{return(await De.delete(`/permissions/${e}`)).data}catch(r){throw r.response?.data||r.message}},enablePermission:async e=>{try{return(await De.patch(`/permissions/${e}/enable`)).data}catch(r){throw r.response?.data||r.message}}},$d=e=>{if(!e)return"";const r=e.split(" ");if(r.length>=2){const s=r[0],a=r[1],i=a.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",o={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[s]||s;return a.includes("forgot-password")?"Forgot Password":a.includes("reset-password")?"Reset Password":a.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("add-trainers")?"Add Trainers to Department":a.includes("remove-trainers")?"Remove Trainers from Department":a.includes("new-feature")?"Create New Feature":a.includes("bulk-import")?"Bulk Import Data":a.includes("export-report")?"Export Report":xb(o,i,a)}return e},xb=(e,r,s)=>{if(s.includes("-")){const a=s.split("/").filter(l=>l&&!l.startsWith(":")),i=a[a.length-1].split("-").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${r.charAt(0).toUpperCase()+r.slice(1)}`},Xi=()=>{const[e,r]=b.useState([]),[s,a]=b.useState(!1),[n,i]=b.useState(null),{userPermissions:l,userRole:o}=Us(),c=b.useCallback(async()=>{a(!0),i(null);try{l&&l.length>0?r(l):(r([]),console.log(" No userPermissions available"))}catch(w){console.error("Error setting permissions:",w),i(w),r([])}finally{a(!1)}},[l]),d=b.useCallback(()=>e.map(w=>({id:w.id,title:w.viewName||w.description||$d(w.name),description:w.description||"",module:w.module,method:w.method,path:w.path,isActive:w.isActive,viewName:w.viewName,viewModule:w.viewModule})),[e]),m=b.useCallback(()=>{const w=d(),y={};return w.forEach(T=>{const k=T.module,P=T.viewModule||`${T.module} Management`;y[k]||(y[k]={id:k,name:P,description:`Manage ${P.toLowerCase()} related permissions`,permissions:[]}),y[k].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(y).sort((T,k)=>T.name.localeCompare(k.name))},[d]),u=b.useCallback(w=>{const y=e.find(T=>T.id===w);return y?y.isActive==="ACTIVE":!0},[e]),h=b.useCallback(w=>e.find(y=>y.id===w),[e]),p=b.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(w=>w.name)),[l]),x=b.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(w=>w.path)),[l]),f=b.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(w=>w.id)),[l]),g=b.useCallback(w=>{if(!l||l.length===0)return!1;const T=(D=>{const W=D.trim().split(/\s+/);if(W.length>=2){const q=W[0],Y=W.slice(1).join(" ");return{method:q,path:Y}}return{method:null,path:D}})(w),k=p.has(w),P=x.has(w),A=f.has(w);if(k||P||A||T.method&&T.path&&l.some(W=>{const q=W.method&&W.method.toUpperCase()===T.method.toUpperCase();let Y=!1;if(W.path)if(W.path===T.path)Y=!0;else{const K=H=>H.replace(/:\w+/g,":param");(K(W.path)===K(T.path)||W.name&&W.name.includes(T.path.replace("/","")))&&(Y=!0)}return q&&Y}))return!0;const _=w.toLowerCase().replace(/\s+/g," ");return l.some(D=>{if(!D.name)return!1;const W=D.name.toLowerCase(),q=_.split(/[\s/:]+/).filter(Y=>Y.length>2&&!["get","post","put","patch","delete"].includes(Y));return q.length>0?q.some(Y=>W.includes(Y)):!1})},[l,p,x,f]),v=b.useCallback(w=>!l||l.length===0?!1:w.some(y=>g(y)),[l,g]),N=b.useCallback(w=>!l||l.length===0?!1:w.every(y=>g(y)),[l,g]),j=b.useCallback(w=>!l||l.length===0?!1:l.some(y=>y.module===w),[l]),S=b.useCallback(()=>!l||l.length===0?[]:[...new Set(l.map(y=>y.module))],[l]),C=b.useCallback(()=>{if(!l||l.length===0)return[];const w=l.map(T=>({id:T.id,title:T.viewName||T.description||$d(T.name),description:T.description||"",module:T.module,method:T.method,path:T.path,isActive:T.isActive,viewName:T.viewName,viewModule:T.viewModule})),y={};return w.forEach(T=>{const k=T.module,P=T.viewModule||`${T.module} Management`;y[k]||(y[k]={id:k,name:P,description:`Manage ${P.toLowerCase()} related permissions`,permissions:[]}),y[k].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(y).sort((T,k)=>T.name.localeCompare(k.name))},[l]);return b.useEffect(()=>{c()},[c]),{permissions:e,loading:s,error:n,fetchPermissions:c,getUIPermissions:d,getPermissionGroups:m,isPermissionActive:u,getApiPermission:h,hasPermission:g,hasAnyPermission:v,hasAllPermissions:N,hasModuleAccess:j,getAccessibleModules:S,getUserPermissionGroups:C,userPermissions:l,userRole:o}},pb=()=>{const[e,r]=b.useState([]),[s,a]=b.useState(!1),[n,i]=b.useState(null),l=b.useCallback(async()=>{a(!0),i(null);try{const o=await fb.getPermissions({includeDeleted:!0});let c=null;if(o&&o.data&&o.data.modules&&Array.isArray(o.data.modules))c=o.data.modules;else if(Array.isArray(o))c=o;else if(o&&o.data&&Array.isArray(o.data))c=o.data;else if(o&&typeof o=="object"){const m=Object.keys(o).find(u=>Array.isArray(o[u]));m&&(c=o[m])}if(c&&Array.isArray(c)){const d=[];c.forEach(m=>{m.module&&m.module.listPermissions&&m.module.listPermissions.forEach(u=>{const h=u.id||u.permissionId;d.push({id:h,name:u.name,module:m.module.name,viewName:u.name,viewModule:m.module.name,isActive:!0})})}),r(d)}else r([])}catch(o){console.error("Error fetching all permissions from API:",o),i(o),r([])}finally{a(!1)}},[]);return{allPermissions:e,loading:s,error:n,fetchAllPermissions:l}},be={USERS:{CREATE:"POST /users",VIEW_ALL:"GET /users",VIEW_DETAIL:"GET /users/:userId",UPDATE:"PUT /users/:userId",BULK_CREATE:"POST /users/bulk"},ROLES:{CREATE:"POST /roles",VIEW_ALL:"GET /roles"},DEPARTMENTS:{CREATE:"POST /departments",VIEW_ALL:"GET /departments",VIEW_DETAIL:"GET /departments/:departmentId",UPDATE:"PUT /departments/:departmentId",REMOVE_TRAINERS:"PATCH /departments/:departmentId/remove-trainers"},COURSES:{CREATE:"POST /courses",VIEW_ALL:"GET /courses",VIEW_DETAIL:"GET /courses/:id",UPDATE:"PUT /courses/:id",RESTORE:"POST /courses/:id/restore",ARCHIVE:"PATCH /courses/:courseId/archive"},SUBJECTS:{VIEW_DETAIL:"GET /subjects/:id",UPDATE:"PUT /subjects/:id",DELETE:"DELETE /subjects/:id",ARCHIVE:"PATCH /subjects/:subjectId/archive",REMOVE_INSTRUCTOR:"DELETE /subjects/:id/instructors"},ASSESSMENTS:{VIEW_ALL:"GET /assessments",VIEW_RESULTS:"GET /assessments/results",APPROVE:"POST /assessments/:assessmentId/approve"},TEMPLATES:{CREATE:"POST /templates",VIEW_ALL:"GET /templates"},PROFILES:{VIEW:"GET /profile"},GLOBAL_FIELDS:{VIEW_ALL:"GET /global-fields"},DASHBOARD:{VIEW:"GET /dashboard"},TRAINEES:{VIEW_ALL:"GET /trainees",VIEW_DETAIL:"GET /trainees/:id",UPDATE:"PUT /trainees/:id",DELETE:"DELETE /trainees/:id",VIEW_COURSES:"GET /trainees/:id/courses",VIEW_SUBJECTS:"GET /trainees/:id/subjects",VIEW_ASSESSMENTS:"GET /trainees/:id/assessments"},SQA:{VIEW_TEMPLATES:"GET /templates",VIEW_TEMPLATE_DETAIL:"GET /templates/:id"}};function su(e){var r,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(r=0;r<n;r++)e[r]&&(s=su(e[r]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function oa(){for(var e,r,s=0,a="",n=arguments.length;s<n;s++)(e=arguments[s])&&(r=su(e))&&(a&&(a+=" "),a+=r);return a}function gb(e){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}gb(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Xn=e=>typeof e=="number"&&!isNaN(e),pa=e=>typeof e=="string",Or=e=>typeof e=="function",vb=e=>pa(e)||Xn(e),sc=e=>pa(e)||Or(e)?e:null,bb=(e,r)=>e===!1||Xn(e)&&e>0?e:r,rc=e=>b.isValidElement(e)||pa(e)||Or(e)||Xn(e);function jb(e,r,s=300){let{scrollHeight:a,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${s}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(r,s)})})}function yb({enter:e,exit:r,appendPosition:s=!1,collapse:a=!0,collapseDuration:n=300}){return function({children:i,position:l,preventExitTransition:o,done:c,nodeRef:d,isIn:m,playToast:u}){let h=s?`${e}--${l}`:e,p=s?`${r}--${l}`:r,x=b.useRef(0);return b.useLayoutEffect(()=>{let f=d.current,g=h.split(" "),v=N=>{N.target===d.current&&(u(),f.removeEventListener("animationend",v),f.removeEventListener("animationcancel",v),x.current===0&&N.type!=="animationcancel"&&f.classList.remove(...g))};f.classList.add(...g),f.addEventListener("animationend",v),f.addEventListener("animationcancel",v)},[]),b.useEffect(()=>{let f=d.current,g=()=>{f.removeEventListener("animationend",g),a?jb(f,c,n):c()};m||(o?g():(x.current=1,f.className+=` ${p}`,f.addEventListener("animationend",g)))},[m]),J.createElement(J.Fragment,null,i)}}function Ud(e,r){return{content:ru(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:r}}function ru(e,r,s=!1){return b.isValidElement(e)&&!pa(e.type)?b.cloneElement(e,{closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:s}):Or(e)?e({closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:s}):e}function Nb({closeToast:e,theme:r,ariaLabel:s="close"}){return J.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:a=>{a.stopPropagation(),e(!0)},"aria-label":s},J.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},J.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function wb({delay:e,isRunning:r,closeToast:s,type:a="default",hide:n,className:i,controlledProgress:l,progress:o,rtl:c,isIn:d,theme:m}){let u=n||l&&o===0,h={animationDuration:`${e}ms`,animationPlayState:r?"running":"paused"};l&&(h.transform=`scaleX(${o})`);let p=oa("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${m}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":c}),x=Or(i)?i({rtl:c,type:a,defaultClassName:p}):oa(p,i),f={[l&&o>=1?"onTransitionEnd":"onAnimationEnd"]:l&&o<1?null:()=>{d&&s()}};return J.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":u},J.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${m} Toastify__progress-bar--${a}`}),J.createElement("div",{role:"progressbar","aria-hidden":u?"true":"false","aria-label":"notification timer",className:x,style:h,...f}))}var Sb=1,au=()=>`${Sb++}`;function Tb(e,r,s){let a=1,n=0,i=[],l=[],o=r,c=new Map,d=new Set,m=N=>(d.add(N),()=>d.delete(N)),u=()=>{l=Array.from(c.values()),d.forEach(N=>N())},h=({containerId:N,toastId:j,updateId:S})=>{let C=N?N!==e:e!==1,w=c.has(j)&&S==null;return C||w},p=(N,j)=>{c.forEach(S=>{var C;(j==null||j===S.props.toastId)&&((C=S.toggle)==null||C.call(S,N))})},x=N=>{var j,S;(S=(j=N.props)==null?void 0:j.onClose)==null||S.call(j,N.removalReason),N.isActive=!1},f=N=>{if(N==null)c.forEach(x);else{let j=c.get(N);j&&x(j)}u()},g=()=>{n-=i.length,i=[]},v=N=>{var j,S;let{toastId:C,updateId:w}=N.props,y=w==null;N.staleId&&c.delete(N.staleId),N.isActive=!0,c.set(C,N),u(),s(Ud(N,y?"added":"updated")),y&&((S=(j=N.props).onOpen)==null||S.call(j))};return{id:e,props:o,observe:m,toggle:p,removeToast:f,toasts:c,clearQueue:g,buildToast:(N,j)=>{if(h(j))return;let{toastId:S,updateId:C,data:w,staleId:y,delay:T}=j,k=C==null;k&&n++;let P={...o,style:o.toastStyle,key:a++,...Object.fromEntries(Object.entries(j).filter(([_,U])=>U!=null)),toastId:S,updateId:C,data:w,isIn:!1,className:sc(j.className||o.toastClassName),progressClassName:sc(j.progressClassName||o.progressClassName),autoClose:j.isLoading?!1:bb(j.autoClose,o.autoClose),closeToast(_){c.get(S).removalReason=_,f(S)},deleteToast(){let _=c.get(S);if(_!=null){if(s(Ud(_,"removed")),c.delete(S),n--,n<0&&(n=0),i.length>0){v(i.shift());return}u()}}};P.closeButton=o.closeButton,j.closeButton===!1||rc(j.closeButton)?P.closeButton=j.closeButton:j.closeButton===!0&&(P.closeButton=rc(o.closeButton)?o.closeButton:!0);let A={content:N,props:P,staleId:y};o.limit&&o.limit>0&&n>o.limit&&k?i.push(A):Xn(T)?setTimeout(()=>{v(A)},T):v(A)},setProps(N){o=N},setToggle:(N,j)=>{let S=c.get(N);S&&(S.toggle=j)},isToastActive:N=>{var j;return(j=c.get(N))==null?void 0:j.isActive},getSnapshot:()=>l}}var Bs=new Map,Cn=[],ac=new Set,Eb=e=>ac.forEach(r=>r(e)),nu=()=>Bs.size>0;function Cb(){Cn.forEach(e=>lu(e.content,e.options)),Cn=[]}var _b=(e,{containerId:r})=>{var s;return(s=Bs.get(r||1))==null?void 0:s.toasts.get(e)};function iu(e,r){var s;if(r)return!!((s=Bs.get(r))!=null&&s.isToastActive(e));let a=!1;return Bs.forEach(n=>{n.isToastActive(e)&&(a=!0)}),a}function kb(e){if(!nu()){Cn=Cn.filter(r=>e!=null&&r.options.toastId!==e);return}if(e==null||vb(e))Bs.forEach(r=>{r.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let r=Bs.get(e.containerId);r?r.removeToast(e.id):Bs.forEach(s=>{s.removeToast(e.id)})}}var Ab=(e={})=>{Bs.forEach(r=>{r.props.limit&&(!e.containerId||r.id===e.containerId)&&r.clearQueue()})};function lu(e,r){rc(e)&&(nu()||Cn.push({content:e,options:r}),Bs.forEach(s=>{s.buildToast(e,r)}))}function Db(e){var r;(r=Bs.get(e.containerId||1))==null||r.setToggle(e.id,e.fn)}function ou(e,r){Bs.forEach(s=>{(r==null||!(r!=null&&r.containerId)||r?.containerId===s.id)&&s.toggle(e,r?.id)})}function Ib(e){let r=e.containerId||1;return{subscribe(s){let a=Tb(r,e,Eb);Bs.set(r,a);let n=a.observe(s);return Cb(),()=>{n(),Bs.delete(r)}},setProps(s){var a;(a=Bs.get(r))==null||a.setProps(s)},getSnapshot(){var s;return(s=Bs.get(r))==null?void 0:s.getSnapshot()}}}function Pb(e){return ac.add(e),()=>{ac.delete(e)}}function Rb(e){return e&&(pa(e.toastId)||Xn(e.toastId))?e.toastId:au()}function Jn(e,r){return lu(e,r),r.toastId}function Ji(e,r){return{...r,type:r&&r.type||e,toastId:Rb(r)}}function Zi(e){return(r,s)=>Jn(r,Ji(e,s))}function de(e,r){return Jn(e,Ji("default",r))}de.loading=(e,r)=>Jn(e,Ji("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...r}));function Fb(e,{pending:r,error:s,success:a},n){let i;r&&(i=pa(r)?de.loading(r,n):de.loading(r.render,{...n,...r}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},o=(d,m,u)=>{if(m==null){de.dismiss(i);return}let h={type:d,...l,...n,data:u},p=pa(m)?{render:m}:m;return i?de.update(i,{...h,...p}):de(p.render,{...h,...p}),u},c=Or(e)?e():e;return c.then(d=>o("success",a,d)).catch(d=>o("error",s,d)),c}de.promise=Fb;de.success=Zi("success");de.info=Zi("info");de.error=Zi("error");de.warning=Zi("warning");de.warn=de.warning;de.dark=(e,r)=>Jn(e,Ji("default",{theme:"dark",...r}));function Ob(e){kb(e)}de.dismiss=Ob;de.clearWaitingQueue=Ab;de.isActive=iu;de.update=(e,r={})=>{let s=_b(e,r);if(s){let{props:a,content:n}=s,i={delay:100,...a,...r,toastId:r.toastId||e,updateId:au()};i.toastId!==e&&(i.staleId=e);let l=i.render||n;delete i.render,Jn(l,i)}};de.done=e=>{de.update(e,{progress:1})};de.onChange=Pb;de.play=e=>ou(!0,e);de.pause=e=>ou(!1,e);function Lb(e){var r;let{subscribe:s,getSnapshot:a,setProps:n}=b.useRef(Ib(e)).current;n(e);let i=(r=b.useSyncExternalStore(s,a,a))==null?void 0:r.slice();function l(o){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(d=>{let{position:m}=d.props;c.has(m)||c.set(m,[]),c.get(m).push(d)}),Array.from(c,d=>o(d[0],d[1]))}return{getToastToRender:l,isToastActive:iu,count:i?.length}}function Mb(e){let[r,s]=b.useState(!1),[a,n]=b.useState(!1),i=b.useRef(null),l=b.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:c,closeToast:d,onClick:m,closeOnClick:u}=e;Db({id:e.toastId,containerId:e.containerId,fn:s}),b.useEffect(()=>{if(e.pauseOnFocusLoss)return h(),()=>{p()}},[e.pauseOnFocusLoss]);function h(){document.hasFocus()||v(),window.addEventListener("focus",g),window.addEventListener("blur",v)}function p(){window.removeEventListener("focus",g),window.removeEventListener("blur",v)}function x(y){if(e.draggable===!0||e.draggable===y.pointerType){N();let T=i.current;l.canCloseOnClick=!0,l.canDrag=!0,T.style.transition="none",e.draggableDirection==="x"?(l.start=y.clientX,l.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(l.start=y.clientY,l.removalDistance=T.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function f(y){let{top:T,bottom:k,left:P,right:A}=i.current.getBoundingClientRect();y.nativeEvent.type!=="touchend"&&e.pauseOnHover&&y.clientX>=P&&y.clientX<=A&&y.clientY>=T&&y.clientY<=k?v():g()}function g(){s(!0)}function v(){s(!1)}function N(){l.didMove=!1,document.addEventListener("pointermove",S),document.addEventListener("pointerup",C)}function j(){document.removeEventListener("pointermove",S),document.removeEventListener("pointerup",C)}function S(y){let T=i.current;if(l.canDrag&&T){l.didMove=!0,r&&v(),e.draggableDirection==="x"?l.delta=y.clientX-l.start:l.delta=y.clientY-l.start,l.start!==y.clientX&&(l.canCloseOnClick=!1);let k=e.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;T.style.transform=`translate3d(${k},0)`,T.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function C(){j();let y=i.current;if(l.canDrag&&l.didMove&&y){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}y.style.transition="transform 0.2s, opacity 0.2s",y.style.removeProperty("transform"),y.style.removeProperty("opacity")}}let w={onPointerDown:x,onPointerUp:f};return o&&c&&(w.onMouseEnter=v,e.stacked||(w.onMouseLeave=g)),u&&(w.onClick=y=>{m&&m(y),l.canCloseOnClick&&d(!0)}),{playToast:g,pauseToast:v,isRunning:r,preventExitTransition:a,toastRef:i,eventHandlers:w}}var Bb=typeof window<"u"?b.useLayoutEffect:b.useEffect,Qi=({theme:e,type:r,isLoading:s,...a})=>J.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...a});function zb(e){return J.createElement(Qi,{...e},J.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function $b(e){return J.createElement(Qi,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Ub(e){return J.createElement(Qi,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Wb(e){return J.createElement(Qi,{...e},J.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Hb(){return J.createElement("div",{className:"Toastify__spinner"})}var nc={info:$b,warning:zb,success:Ub,error:Wb,spinner:Hb},Vb=e=>e in nc;function Gb({theme:e,type:r,isLoading:s,icon:a}){let n=null,i={theme:e,type:r};return a===!1||(Or(a)?n=a({...i,isLoading:s}):b.isValidElement(a)?n=b.cloneElement(a,i):s?n=nc.spinner():Vb(r)&&(n=nc[r](i))),n}var qb=e=>{let{isRunning:r,preventExitTransition:s,toastRef:a,eventHandlers:n,playToast:i}=Mb(e),{closeButton:l,children:o,autoClose:c,onClick:d,type:m,hideProgressBar:u,closeToast:h,transition:p,position:x,className:f,style:g,progressClassName:v,updateId:N,role:j,progress:S,rtl:C,toastId:w,deleteToast:y,isIn:T,isLoading:k,closeOnClick:P,theme:A,ariaLabel:_}=e,U=oa("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${m}`,{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":P}),D=Or(f)?f({rtl:C,position:x,type:m,defaultClassName:U}):oa(U,f),W=Gb(e),q=!!S||!c,Y={closeToast:h,type:m,theme:A},K=null;return l===!1||(Or(l)?K=l(Y):b.isValidElement(l)?K=b.cloneElement(l,Y):K=Nb(Y)),J.createElement(p,{isIn:T,done:y,position:x,preventExitTransition:s,nodeRef:a,playToast:i},J.createElement("div",{id:w,tabIndex:0,onClick:d,"data-in":T,className:D,...n,style:g,ref:a,...T&&{role:j,"aria-label":_}},W!=null&&J.createElement("div",{className:oa("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!k})},W),ru(o,e,!r),K,!e.customProgressBar&&J.createElement(wb,{...N&&!q?{key:`p-${N}`}:{},rtl:C,theme:A,delay:c,isRunning:r,isIn:T,closeToast:h,hide:u,type:m,className:v,controlledProgress:q,progress:S||0})))},Yb=(e,r=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:r}),Kb=yb(Yb("bounce",!0)),Xb={position:"top-right",transition:Kb,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function Jb(e){let r={...Xb,...e},s=e.stacked,[a,n]=b.useState(!0),i=b.useRef(null),{getToastToRender:l,isToastActive:o,count:c}=Lb(r),{className:d,style:m,rtl:u,containerId:h,hotKeys:p}=r;function x(g){let v=oa("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":u});return Or(d)?d({position:g,rtl:u,defaultClassName:v}):oa(v,sc(d))}function f(){s&&(n(!0),de.play())}return Bb(()=>{var g;if(s){let v=i.current.querySelectorAll('[data-in="true"]'),N=12,j=(g=r.position)==null?void 0:g.includes("top"),S=0,C=0;Array.from(v).reverse().forEach((w,y)=>{let T=w;T.classList.add("Toastify__toast--stacked"),y>0&&(T.dataset.collapsed=`${a}`),T.dataset.pos||(T.dataset.pos=j?"top":"bot");let k=S*(a?.2:1)+(a?0:N*y);T.style.setProperty("--y",`${j?k:k*-1}px`),T.style.setProperty("--g",`${N}`),T.style.setProperty("--s",`${1-(a?C:0)}`),S+=T.offsetHeight,C+=.025})}},[a,c,s]),b.useEffect(()=>{function g(v){var N;let j=i.current;p(v)&&((N=j.querySelector('[tabIndex="0"]'))==null||N.focus(),n(!1),de.pause()),v.key==="Escape"&&(document.activeElement===j||j!=null&&j.contains(document.activeElement))&&(n(!0),de.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[p]),J.createElement("section",{ref:i,className:"Toastify",id:h,onMouseEnter:()=>{s&&(n(!1),de.pause())},onMouseLeave:f,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":r["aria-label"]},l((g,v)=>{let N=v.length?{...m}:{...m,pointerEvents:"none"};return J.createElement("div",{tabIndex:-1,className:x(g),"data-stacked":s,style:N,key:`c-${g}`},v.map(({content:j,props:S})=>J.createElement(qb,{...S,stacked:s,collapseAll:f,isIn:o(S.toastId,S.containerId),key:`t-${S.key}`},j)))}))}const jr=e=>e.map(r=>({id:r.id,name:r.name,code:r.code,type:r.code,description:r.description,departmentHeadId:r.headUserId,departmentHead:r.headUser?{id:r.headUser.id,name:r.headUser.name||r.headUser.email,email:r.headUser.email,role:r.headUser.role}:null,status:r.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:r.courseCount||r.coursesCount||0,traineesCount:r.traineeCount||r.traineesCount||0,trainersCount:r.trainerCount||r.trainersCount||0,createdAt:r.createdAt,updatedAt:r.updatedAt,deletedAt:r.deletedAt})),Cc=(e=!0)=>{const[r,s]=b.useState([]),[a,n]=b.useState([]),[i,l]=b.useState(!1),[o,c]=b.useState(null),[d,m]=b.useState(""),[u,h]=b.useState({type:"",status:""}),[p,x]=b.useState({key:null,direction:"asc"}),[f,g]=b.useState([]);return b.useEffect(()=>{if(!e)return;(async()=>{l(!0),c(null);try{const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H)}catch(Y){console.error("Error loading departments:",Y),c("Failed to load departments"),s([])}finally{l(!1)}})()},[e]),b.useEffect(()=>{let q=r;d&&(q=q.filter(Y=>Y.name.toLowerCase().includes(d.toLowerCase())||Y.code.toLowerCase().includes(d.toLowerCase())||Y.description.toLowerCase().includes(d.toLowerCase()))),u.type&&(q=q.filter(Y=>Y.type===u.type)),u.status&&(q=q.filter(Y=>Y.status===u.status)),n(q)},[r,d,u]),{departments:a,selectedDepartments:f,loading:i,error:o,searchTerm:d,setSearchTerm:m,filters:u,sortConfig:p,createDepartment:async q=>{l(!0),c(null);try{const Y=await Nt.createDepartment(q),H=(await Nt.getDepartments()).departments||[],je=jr(H);return s(je),Y}catch(Y){throw console.error("Error creating department:",Y),c("Failed to create department"),Y}finally{l(!1)}},updateDepartment:async(q,Y)=>{l(!0),c(null);try{const K=await Nt.updateDepartment(q,Y),je=(await Nt.getDepartments()).departments||[],ie=jr(je);return s(ie),K}catch(K){throw console.error("Error updating department:",K),c("Failed to update department"),K}finally{l(!1)}},deleteDepartment:async q=>{l(!0),c(null);try{await Nt.deleteDepartment(q);const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H)}catch(Y){throw console.error("Error deleting department:",Y),c("Failed to delete department"),Y}finally{l(!1)}},toggleDepartmentStatus:async q=>{l(!0),c(null);try{await Nt.toggleDepartmentStatus(q);const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H)}catch(Y){throw console.error("Error toggling department status:",Y),de.error("Failed to toggle department status"),Y}finally{l(!1)}},disableDepartment:async q=>{l(!0),c(null);try{await Nt.disableDepartment(q);const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H)}catch(Y){throw console.error("Error disabling department:",Y),de.error("Failed to disable department"),Y}finally{l(!1)}},enableDepartment:async q=>{l(!0),c(null);try{await Nt.enableDepartment(q);const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H)}catch(Y){throw console.error("Error enabling department:",Y),de.error("Failed to enable department"),Y}finally{l(!1)}},bulkDeleteDepartments:async q=>{l(!0),c(null);try{await Nt.bulkDeleteDepartments(q);const K=(await Nt.getDepartments()).departments||[],H=jr(K);s(H),g([])}catch(Y){throw console.error("Error bulk deleting departments:",Y),de.error("Failed to delete departments"),Y}finally{l(!1)}},bulkToggleStatus:async(q,Y)=>{l(!0),c(null);try{await Nt.bulkToggleStatus(q,Y);const H=(await Nt.getDepartments()).departments||[],je=jr(H);s(je),g([])}catch(K){throw console.error("Error bulk toggling department status:",K),de.error("Failed to update department status"),K}finally{l(!1)}},sortDepartments:q=>{let Y="asc";p.key===q&&p.direction==="asc"&&(Y="desc"),x({key:q,direction:Y});const K=[...a].sort((H,je)=>H[q]<je[q]?Y==="asc"?-1:1:H[q]>je[q]?Y==="asc"?1:-1:0);n(K)},handleSelectDepartment:q=>{g(Y=>Y.includes(q)?Y.filter(K=>K!==q):[...Y,q])},handleSelectAll:()=>{f.length===a.length?g([]):g(a.map(q=>q.id))},handleFilterChange:(q,Y)=>{h(K=>({...K,[q]:Y}))},clearFilters:()=>{h({type:"",status:""}),m("")},getAvailableUsers:async()=>{try{return(await Nt.getDepartmentHeads())?.users||[]}catch(q){return console.error("Error fetching department heads:",q),de.error("Failed to load department heads"),[]}},refreshDepartments:async()=>{l(!0),c(null);try{const Y=(await Nt.getDepartments()).departments||[],K=jr(Y);s(K)}catch(q){console.error("Error refreshing departments:",q),c("Failed to refresh departments")}finally{l(!1)}},setError:c}},Wd=({collapsed:e,onClose:r})=>{const{hasModuleAccess:s,hasPermission:a}=Xi(),{user:n}=Us(),i=wa(),l=qe(),{departments:o,loading:c}=Cc(n?.role==="ACADEMIC_DEPARTMENT"),[d,m]=b.useState(!1),[u,h]=b.useState(!1),[p,x]=b.useState(!1),f=b.useRef(null);b.useEffect(()=>{if(f.current&&d){const v=f.current,N=v.scrollHeight>v.clientHeight;x(N)}},[d,o]);const g=b.useMemo(()=>[{id:"users",label:"User Management",icon:rs,path:"/admin/users",permission:be.USERS.VIEW_ALL,module:"USERS"},{id:"roles",label:"Role Management",icon:Nc,path:"/admin/roles",permission:be.ROLES.VIEW_ALL,module:"ROLES"},{id:"departments",label:"Departments",icon:Tr,path:"/admin/departments",permission:be.DEPARTMENTS.VIEW_ALL,module:"DEPARTMENTS"},{id:"forms",label:"Form Templates",icon:$s,path:"/admin/forms",permission:be.TEMPLATES.VIEW_ALL,module:"TEMPLATES"},{id:"system-config",label:"System Configuration",icon:b0,path:"/admin/system-config",permission:be.GLOBAL_FIELDS.VIEW_ALL,module:"GLOBAL_FIELDS"},{id:"academic-dashboard",label:"Academic Dashboard",icon:Tr,path:"/academic/dashboard",permission:be.DASHBOARD.VIEW,module:"ACADEMIC"},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:Ls,path:"/trainee/dashboard",permission:be.TRAINEES.VIEW_DETAIL,module:"TRAINEES"},{id:"enrolled-courses",label:"Enrolled Course List",icon:Ls,path:"/trainee/enrolled-courses",permission:be.TRAINEES.VIEW_COURSES,module:"TRAINEES"},{id:"all-assessments",label:"All Assessments",icon:Ls,path:"/trainee/all-assessments",permission:be.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES",children:[{id:"your-assessments",label:"Your Assessments",path:"/trainee/your-assessments",permission:be.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"signature-required",label:"Signature Required List",path:"/trainee/signature-required",permission:be.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"completion-required",label:"Section Completion Required List",path:"/trainee/completion-required",permission:be.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:Ls,path:"/trainee/create-incident-feedback-report",permission:be.TRAINEES.VIEW_ALL,module:"TRAINEES"},{id:"upcoming-assessments",label:"List Upcoming Assessment",icon:et,path:"/trainer/upcoming-assessments",permission:be.ASSESSMENTS.VIEW_ALL,module:"TRAINER"},{id:"assessment-results",label:"List Assessment Result",icon:rt,path:"/trainer/assessment-results",permission:be.ASSESSMENTS.VIEW_RESULTS,module:"TRAINER"},{id:"instructed-courses",label:"List Instructed Course",icon:it,path:"/trainer/instructed-courses",permission:be.COURSES.VIEW_ALL,module:"TRAINER"},{id:"department-dashboard",label:"Department Dashboard",icon:Tr,path:"/department-head/dashboard",permission:be.DASHBOARD.VIEW,module:"DEPARTMENT_HEAD"},{id:"my-department-details",label:"My Department Details",icon:it,path:"/department-head/my-department-details",permission:be.DEPARTMENTS.VIEW_DETAIL,module:"DEPARTMENT_HEAD"},{id:"assessment-review-requests",label:"List Assessment Review Requests",icon:vt,path:"/department-head/assessment-review-requests",permission:be.ASSESSMENTS.VIEW_ALL,module:"DEPARTMENT_HEAD"},{id:"issue-list",label:"Issue List",icon:Wt,path:"/sqa/issues",permission:be.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"feedback-list",label:"Feedback List",icon:h0,path:"/sqa/feedback",permission:be.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"template-list",label:"Template List",icon:Hi,path:"/sqa/templates",permission:be.SQA.VIEW_TEMPLATES,module:"SQA",children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:be.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:be.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:be.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:be.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"}]}].filter(N=>n?.role==="ADMINISTRATOR"?["users","roles","departments","forms","system-config"].includes(N.id)?s(N.module)||a(N.permission):!1:n?.role==="ACADEMIC_DEPARTMENT"?["academic-dashboard"].includes(N.id):n?.role==="TRAINEE"?["trainee-dashboard","enrolled-courses","all-assessments","create-issue"].includes(N.id):n?.role==="TRAINER"?["upcoming-assessments","assessment-results","instructed-courses"].includes(N.id):n?.role==="SQA_AUDITOR"?["issue-list","feedback-list","template-list"].includes(N.id):n?.role==="DEPARTMENT_HEAD"?["department-dashboard","my-department-details","assessment-review-requests"].includes(N.id):s(N.module)||a(N.permission)),[n?.role,s,a]);return t.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"sticky",top:0,height:"100vh",overflowY:"hidden",overflowX:"hidden"},children:[t.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&t.jsx(t.Fragment,{children:t.jsx("img",{src:O1,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&t.jsx("div",{children:t.jsx(c0,{size:24})})]}),r&&t.jsx(se,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:r,style:{border:"none",background:"transparent"},children:t.jsx(Ge,{size:20})})]}),t.jsxs(Et,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[g.map(v=>{const N=v.icon,j=i.pathname===v.path;return v.id==="all-assessments"&&n?.role==="TRAINEE"?t.jsx(Et.Item,{className:"mb-3",children:t.jsxs("div",{className:"position-relative",children:[t.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(l("/trainee/all-assessments"),r()):h(!u)},children:[t.jsx(N,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:v.label}),t.jsx(Cr,{size:16,className:`ms-auto transition-transform ${u?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&u&&t.jsx("div",{className:"mt-2 ms-4",children:v.children&&v.children.map(S=>t.jsx(ml,{to:S.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:i.pathname===S.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",wordWrap:"break-word",overflowWrap:"break-word"},onClick:r,children:t.jsx("span",{className:"sidebar-nav-label",children:S.label})},S.id))})]})},v.id):t.jsx(Et.Item,{className:"mb-3",children:t.jsxs(ml,{to:v.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${j?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:j?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",wordWrap:e?"normal":"break-word",overflowWrap:"break-word"},onClick:()=>{r()},children:[t.jsx(N,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&t.jsx("span",{className:"sidebar-nav-label",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:v.label})]})},v.id)}),n?.role==="ACADEMIC_DEPARTMENT"&&t.jsx(Et.Item,{className:"mb-3",children:t.jsxs("div",{className:"position-relative",children:[t.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[t.jsx(Tr,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{m(!d),l("/academic/departments")},children:"Department"}),t.jsx(Cr,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:d?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{m(!d)}})]})]}),!e&&d&&t.jsx("div",{ref:f,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${p?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:c?t.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:t.jsx("small",{children:"Loading departments..."})}):o.length>0?o.map(v=>t.jsxs(ml,{to:`/academic/course/${v.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${i.pathname===`/academic/course/${v.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:i.pathname===`/academic/course/${v.id}`?"rgba(255, 255, 255, 0.15)":"transparent",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{r&&r()},children:[t.jsx(Hn,{size:12,className:"me-2 sidebar-department-chevron"}),v.code]},v.id)):t.jsx("div",{className:"px-3 py-2 text-white-50",children:t.jsx("small",{children:"No departments found"})})})]})})]})]})},Vr={getProfile:async()=>{try{return(await De.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,r)=>{try{const a={...r||await Vr.getProfile(),avatarUrl:e};return a.address||(a.address=""),a.phoneNumber||(a.phoneNumber=""),a.avatarUrl||(a.avatarUrl=""),a.firstName||(a.firstName=""),a.lastName||(a.lastName=""),a.middleName||(a.middleName=""),Object.keys(a).forEach(i=>{(a[i]===void 0||a[i]===null)&&delete a[i]}),(await De.put("/profile",a)).data}catch(s){throw console.error("Error updating avatar:",s),s}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const r=await De.put("/profile",e);return console.log("updateProfile - response:",r.data),r.data}catch(r){throw console.error("Error updating profile:",r),console.error("Error response:",r.response?.data),r.response?.data?.errors&&console.error("Validation errors:",r.response.data.errors),r}},resetPassword:async e=>{try{return(await De.put("/profile/password",e)).data}catch(r){throw console.error("Error resetting password:",r),r}}},Zb=()=>{const[e,r]=b.useState(null),[s,a]=b.useState(!0),[n,i]=b.useState(null),l=async()=>{try{a(!0),i(null);const m=await Vr.getProfile();r(m)}catch(m){console.error("Error fetching profile:",m),i(m.message||"Failed to fetch profile")}finally{a(!1)}},o=async m=>{try{a(!0),i(null);const u=await Vr.updateProfile(m);return r(u),u}catch(u){throw console.error("Error updating profile:",u),i(u.message||"Failed to update profile"),u}finally{a(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:m,lastName:u,middleName:h}=e,p=[];return m&&p.push(m),h&&p.push(h),u&&p.push(u),p.join(" ")||"User"},d=()=>e?.role?e.role.name:"User";return b.useEffect(()=>{l()},[]),{profile:e,loading:s,error:n,fetchProfile:l,updateProfile:o,getDisplayName:c,getRoleName:d}},Qb={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},ej=({onToggleSidebar:e})=>{const r=wa(),s=qe(),[a,n]=b.useState(!1),[i,l]=b.useState(!1),o=b.useRef(null),{user:c,isLoading:d}=Us(),{profile:m,getDisplayName:u,loading:h}=Zb(),p=()=>{if(!c||h)return"Loading...";if(m&&u&&u()&&u()!=="Loading..."){const S=u();if(S&&S.trim()!=="")return S}if(m&&m.firstName){const S=[m.firstName];m.middleName&&S.push(m.middleName),m.lastName&&S.push(m.lastName);const C=S.join(" ").trim();if(C)return C}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const S=localStorage.getItem("authToken");if(S){const C=JSON.parse(atob(S.split(".")[1]));if(C.fullName&&C.fullName!=="User")return C.fullName;if(C.name&&C.name!=="User")return C.name;if(C.firstName&&C.lastName)return`${C.firstName} ${C.lastName}`}}catch(S){console.error("Error parsing JWT token for display name:",S)}return c.name||"User"},x=()=>c&&c.email||"No email",f=S=>{const C={"/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/profile":"Profile","/admin/forms":"Form Templates","/admin/system-config":"System Configuration","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/profile":"Profile","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Create Incident/Feedback Report","/trainee/assessment-pending/section-completion":"Section Completion Required List","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessments","/trainer/assessment-results":"Assessment Results","/trainer/instructed-courses":"Instructed Courses","/trainer/courses":"Course Details","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue List","/sqa/issues":"Issue List","/sqa/feedback":"Feedback List","/sqa/templates":"Template List","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview"};return S.startsWith("/admin/departments/")&&S!=="/admin/departments"?"Edit Department Detail":S.startsWith("/academic/departments/")&&S!=="/academic/departments"?"Department Management":S.includes("/enroll-trainees")?"Trainee Enrollments":S.startsWith("/academic/course/")&&!S.includes("/subject/")?"Department Details":S.startsWith("/academic/course-detail/")?"Course Details":S.includes("/subject/")?"Subject Details":S.includes("/enroll-trainees")?"Enroll Trainees":S.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Course Details":S.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Subject Details":S.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":S.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":S.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":S.startsWith("/sqa/templates/")&&S!=="/sqa/templates"?"Template Detail":S.startsWith("/trainer/trainees/")?"Trainee Details":S.startsWith("/trainer/subjects/")?"Subject Details":S.startsWith("/trainer/courses/")?"Course Details":S.startsWith("/trainer/assessment-details/")?"Assessment Result Details":S.startsWith("/trainer/approval-notes/")?"Result Approval Note":S.includes("/department-head/courses/")&&S.includes("/subjects/")?"Subject Details":S.startsWith("/department-head/trainees/")||S.startsWith("/trainee/")&&S!=="/trainee"&&!S.startsWith("/trainee/dashboard")&&!S.startsWith("/trainee/academic-details")&&!S.startsWith("/trainee/enrolled-courses")&&!S.startsWith("/trainee/assessment-pending")&&!S.startsWith("/trainee/create-incident-feedback-report")&&!S.startsWith("/trainee/signature-required")&&!S.startsWith("/trainee/completion-required")&&!S.startsWith("/trainee/your-assessments")?"Trainee Details":C[S]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const S=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=S()},v=()=>{n(!a)},N=()=>{n(!1)},j=()=>{s("/admin/profile"),n(!1)};return b.useEffect(()=>{const S=C=>{o.current&&!o.current.contains(C.target)&&l(!1)};return i&&document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[i]),t.jsxs(t.Fragment,{children:[t.jsx(bd,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:t.jsxs("div",{className:"container-fluid",children:[t.jsx(se,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:t.jsx(y0,{size:20})}),t.jsx(bd.Brand,{className:"text-primary-custom fw-bold custom-title",children:f(r.pathname)}),t.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:t.jsxs("div",{ref:o,style:{position:"relative"},children:[t.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>l(!i),children:[t.jsx(Oa,{size:32,className:"me-2"}),t.jsx("span",{children:d||h?"Loading...":p()})]}),t.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:Qb,children:[t.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[t.jsx("div",{className:"fw-bold text-primary-custom",children:d||h?"Loading...":p()}),t.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:d?"Loading...":x()})]}),t.jsx("div",{className:"dropdown-divider"}),t.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),j()},children:[t.jsx(Oa,{className:"me-2",size:16}),"Profile"]}),t.jsx("div",{className:"dropdown-divider"}),t.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),g()},children:[t.jsx(Wl,{className:"me-2",size:16}),"Logout"]})]})]})}),t.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:v,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:t.jsx(Oa,{size:32})})]})}),a&&t.jsx("div",{className:`profile-menu-overlay ${a?"show":""}`,onClick:N}),t.jsxs("div",{className:`profile-menu-slide ${a?"show":""}`,children:[t.jsxs("div",{className:"profile-menu-header",children:[t.jsx("button",{className:"profile-menu-close",onClick:N,"aria-label":"Close profile menu",children:t.jsx(Ge,{size:20})}),t.jsx("div",{className:"profile-avatar",children:t.jsx(Oa,{size:40})}),t.jsx("div",{className:"profile-name",children:d||h?"Loading...":p()}),t.jsx("div",{className:"profile-email",children:d?"Loading...":x()})]}),t.jsxs("ul",{className:"profile-menu-items",children:[t.jsx("li",{className:"profile-menu-item",children:t.jsxs("a",{href:"#",className:"profile-menu-link",onClick:S=>{S.preventDefault(),j()},children:[t.jsx(Oa,{className:"icon"}),"Profile"]})}),t.jsx("li",{className:"profile-menu-item",children:t.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:S=>{S.preventDefault(),N(),g()},children:[t.jsx(Wl,{className:"icon"}),"Logout"]})})]})]})]})},tj=({children:e})=>{const[r,s]=b.useState(!1),[a,n]=b.useState(!1),[i,l]=b.useState(!1);b.useEffect(()=>{const d=()=>{n(window.innerWidth<=768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const o=()=>{a?l(!i):s(!r)},c=()=>{a&&l(!1)};return t.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[t.jsx("div",{className:`sidebar-desktop ${r?"sidebar-collapsed":""}`,children:t.jsx(Wd,{collapsed:r})}),a&&i&&t.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),t.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,children:t.jsx(Wd,{collapsed:!1,onClose:c})}),t.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${a?"main-content-mobile":""}`,children:[t.jsx(ej,{onToggleSidebar:o}),t.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},Da=()=>t.jsx(tj,{children:t.jsx(Bf,{})}),Ot=(e,r=null,s="asc")=>{const[a,n]=b.useState({key:r,direction:s});return{sortedData:b.useMemo(()=>!a.key||!e?e:[...e].sort((d,m)=>{let u=d[a.key],h=m[a.key];if(a.key.includes(".")){const p=a.key.split(".");u=p.reduce((x,f)=>x?.[f],d),h=p.reduce((x,f)=>x?.[f],m)}if(a.key.includes("length")){const p=a.key.replace(".length","");u=d[p]?.length||0,h=m[p]?.length||0}return typeof u=="string"&&typeof h=="string"&&(u=u.toLowerCase(),h=h.toLowerCase()),u<h?a.direction==="asc"?-1:1:u>h?a.direction==="asc"?1:-1:0}),[e,a]),sortConfig:a,handleSort:d=>{let m="asc";if(a.key===d&&a.direction==="asc")m="desc";else if(a.key===d&&a.direction==="desc"){n({key:null,direction:"asc"});return}n({key:d,direction:m})},getSortIcon:d=>a.key!==d?"":a.direction==="asc"?"":"",getSortClass:d=>a.key!==d?"text-muted":(a.direction==="asc","text-primary")}},Ga=({data:e,loading:r,columns:s,renderRow:a,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:l,sortConfig:o,handleSort:c}=Ot(e);if(r)return t.jsx(It,{rows:5,columns:s.length});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:n}),t.jsx("p",{children:i})]})});const d=({columnKey:m,children:u,className:h=""})=>{const p=o.key===m,x=p?o.direction:null;return t.jsxs("th",{className:`text-primary-custom fw-semibold ${h} ${p?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>c(m),onMouseEnter:f=>{f.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",f.target.style.transform="translateY(-1px)",f.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:f=>{f.target.style.backgroundColor="transparent",f.target.style.transform="translateY(0)",f.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:p?"600":"500"},children:u}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:x,size:14})})]}),p&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsx("tr",{children:s.map((m,u)=>m.sortable?t.jsx(d,{columnKey:m.key,className:m.className||"",children:m.title},u):t.jsx("th",{className:`text-primary-custom fw-semibold ${m.className||""}`,children:m.title},u))})}),t.jsx("tbody",{children:l.map((m,u)=>a(m,u))})]})})},sj=({children:e})=>t.jsx(hb,{children:e}),yr=()=>{const e=zf(),r=qe(),a=(l=>l?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:l?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:l?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{r((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{r(-1)};return t.jsx(Ee,{fluid:!0,className:"py-5",children:t.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:t.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h1",{className:"display-1 text-muted",children:""}),t.jsx("h2",{className:"text-primary-custom mb-3",children:a.title}),t.jsx("p",{className:"text-muted mb-4",children:a.message}),t.jsx("p",{className:"small text-muted",children:a.suggestion})]}),t.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[t.jsx(se,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),t.jsx(se,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},It=({rows:e=5,columns:r=4})=>{const s=()=>t.jsx("tr",{children:Array.from({length:r}).map((a,n)=>t.jsx("td",{children:t.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:t.jsx("span",{className:"placeholder col-12"})})},n))});return t.jsxs(R,{className:"border-neutral-200",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:t.jsx("span",{className:"placeholder col-12"})}),t.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:t.jsx("span",{className:"placeholder col-12"})})]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"bg-neutral-50",children:t.jsx("tr",{children:Array.from({length:r}).map((a,n)=>t.jsx("th",{className:"border-neutral-200",children:t.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:t.jsx("span",{className:"placeholder col-12"})})},n))})}),t.jsx("tbody",{children:Array.from({length:e}).map((a,n)=>t.jsx(s,{},n))})]})})})]})},nt=({permission:e,permissions:r=[],requireAll:s=!1,children:a,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:l,hasAllPermissions:o}=Xi(),{user:c}=Us();return(!e&&(!r||r.length===0)||c?.role==="TRAINEE"?!0:e?i(e):r&&r.length>0?s?o(r):l(r):!1)?a:t.jsxs("div",{className:"p-4 text-center text-muted",children:[t.jsx("h4",{children:"Access Denied"}),t.jsx("p",{children:"You don't have permission to access this page."}),t.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||r.join(", ")]}),t.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},Ht=({permission:e,permissions:r=[],requireAll:s=!1,children:a,fallback:n=null,showMessage:i=!1,message:l="You do not have permission to access this feature."})=>{const{hasPermission:o,hasAnyPermission:c,hasAllPermissions:d}=Xi();return(!e&&(!r||r.length===0)?!0:e?o(e):r&&r.length>0?s?d(r):c(r):!1)?a:n||(i?t.jsxs(Ae,{variant:"warning",className:"mt-3",children:[t.jsx(Ae.Heading,{children:"Access Denied"}),t.jsx("p",{children:l})]}):null)},Pt=({trigger:e,items:r=[],align:s="end",className:a="",onItemClick:n,placement:i="bottom-end",disabled:l=!1,...o})=>{const[c,d]=b.useState(!1),[m,u]=b.useState({top:0,left:0}),h=b.useRef(null),p=b.useRef(null),x=()=>{if(!h.current)return;const j=h.current.getBoundingClientRect(),S=200,C=150,w=4;let y,T;switch(i){case"bottom-start":y=j.bottom+w,T=j.left;break;case"bottom-end":y=j.bottom+w,T=j.right-S;break;case"top-start":y=j.top-C-w,T=j.left;break;case"top-end":y=j.top-C-w,T=j.right-S;break;default:y=j.bottom+w,T=j.right-S}y+C>window.innerHeight&&(y=j.top-C-w),y<0&&(y=w),T+S>window.innerWidth&&(T=window.innerWidth-S-w),T<0&&(T=w),u({top:y,left:T})},f=j=>{j.preventDefault(),j.stopPropagation(),!l&&(c||x(),d(!c))},g=()=>{d(!1)},v=j=>{j.onClick&&j.onClick(),n&&n(j),g()};b.useEffect(()=>{const j=C=>{c&&h.current&&!h.current.contains(C.target)&&p.current&&!p.current.contains(C.target)&&g()},S=C=>{C.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",j),document.addEventListener("keydown",S),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",S),document.body.style.overflow=""}},[c]),b.useEffect(()=>{if(c){const j=()=>x(),S=()=>x();return window.addEventListener("scroll",j,!0),window.addEventListener("resize",S),()=>{window.removeEventListener("scroll",j,!0),window.removeEventListener("resize",S)}}},[c,i]);const N=c&&$f.createPortal(t.jsx("div",{ref:p,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:m.top,left:m.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:r.map((j,S)=>j.type==="header"?t.jsx("div",{className:`dropdown-header ${j.className||""}`,children:j.content},S):j.type==="divider"?t.jsx("div",{className:"dropdown-divider"},S):t.jsxs("button",{onClick:()=>v(j),className:`dropdown-item ${j.className||""}`,disabled:j.disabled,children:[j.icon&&t.jsx("span",{className:"me-2",children:j.icon}),j.label]},S))}),document.body);return t.jsxs("div",{className:`dropdown ${a}`,children:[t.jsx("button",{ref:h,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:f,disabled:l,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),N]})},Ia=({children:e})=>{const{isAuthenticated:r,isLoading:s}=Us(),a=wa();return s?t.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:t.jsxs("div",{className:"text-center",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):r?e:t.jsx(Uf,{to:"/",state:{from:a},replace:!0})},ds=({placeholder:e="Search...",value:r,onChange:s,className:a="",size:n="md"})=>t.jsxs(jd,{className:a,size:n,children:[t.jsx(jd.Text,{className:"bg-white border-end-0",children:t.jsx(yc,{className:"text-primary-custom"})}),t.jsx(E.Control,{type:"text",placeholder:e,value:r,onChange:i=>s(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),zt=({direction:e,size:r=16})=>{const s={fontSize:`${r}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?t.jsx("span",{style:{...s,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?t.jsx("span",{style:{...s,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):t.jsxs("span",{style:s,className:"text-muted sort-icon",children:[t.jsx("span",{style:{display:"inline-block",transform:"translateY(-1px)",opacity:.5,marginRight:"1px"},children:""}),t.jsx("span",{style:{display:"inline-block",transform:"translateY(1px)",opacity:.5},children:""})]})},cn=()=>{const{user:e}=Us(),r=qe();return b.useEffect(()=>{if(e?.role){let s="/admin/users";switch(e.role){case"ACADEMIC_DEPARTMENT":s="/academic/dashboard";break;case"TRAINEE":s="/trainee";break;case"TRAINER":s="/trainer/upcoming-assessments";break;case"SQA_AUDITOR":s="/sqa/issues";break;case"DEPARTMENT_HEAD":s="/department-head/dashboard";break;case"ADMIN":case"ADMINISTRATOR":default:s="/admin/users";break}r(s,{replace:!0})}},[e,r]),null},rj=({show:e,onHide:r})=>{const[s,a]=b.useState(""),[n,i]=b.useState(!1),[l,o]=b.useState(""),c=async m=>{m.preventDefault(),o(""),i(!0);try{const u=await fetch(`${ki.BASE_URL}${ki.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,magicLink:`${window.location.origin}${Ec()}reset-password/`})});if(!u.ok){u.status===405?o("Forgot password feature is not available on this server. Please contact support."):u.status===404?o("Forgot password endpoint not found. Please contact support."):o(`Server error (${u.status}). Please try again later.`);return}try{await u.json()}catch(h){console.error("JSON parsing error:",h),o("Server returned invalid response. Please try again later.");return}de.success("Password reset link has been sent to your email!"),a(""),r()}catch(u){console.error("Forgot password error:",u),u.name==="TypeError"&&u.message.includes("fetch")?o("Cannot connect to server. Please check your internet connection."):o("An unexpected error occurred. Please try again later.")}finally{i(!1)}},d=()=>{a(""),o(""),r()};return t.jsxs(le,{show:e,onHide:d,centered:!0,children:[t.jsxs(le.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[t.jsxs(le.Title,{className:"d-flex align-items-center text-white",children:[t.jsx(ha,{className:"me-2",size:20}),"Forgot Password"]}),t.jsx(se,{variant:"link",onClick:d,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:t.jsx(Ge,{})})]}),t.jsxs(le.Body,{className:"pt-0",children:[t.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),l&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:l}),t.jsxs(E,{onSubmit:c,children:[t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),t.jsx(E.Control,{type:"email",placeholder:"Enter your email",value:s,onChange:m=>a(m.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),t.jsxs("div",{className:"d-grid gap-2",children:[t.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:n||!s.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:m=>{m.target.style.transform="translateY(-2px)",m.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:m=>{m.target.style.transform="translateY(0)",m.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),t.jsx(se,{type:"button",variant:"outline-secondary",onClick:d,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:m=>{m.target.style.background="var(--bs-neutral-100)",m.target.style.borderColor="var(--bs-primary)",m.target.style.transform="translateY(-1px)"},onMouseLeave:m=>{m.target.style.background="rgba(255, 255, 255, 0.8)",m.target.style.borderColor="var(--bs-neutral-300)",m.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function gl(){const[e,r]=b.useState(""),[s,a]=b.useState(""),[n,i]=b.useState(!1),[l,o]=b.useState(!1),[c,d]=b.useState(!1),m=qe(),u=wa(),{login:h,isAuthenticated:p,isLoading:x}=Us();if(b.useEffect(()=>{if(p){const g=u.state?.from?.pathname||"/admin";m(g,{replace:!0})}},[p,m,u.state?.from?.pathname]),x)return t.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:t.jsxs("div",{className:"text-center",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(p)return null;const f=async g=>{g.preventDefault(),o(!0);try{const v=await h({email:e,password:s});if(v.success){const N=u.state?.from?.pathname||"/admin";m(N,{replace:!0})}else de.error(v.error||"Email or password is incorrect. Please try again.")}catch{de.error("Login failed. Please try again.")}finally{o(!1)}};return t.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[t.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),t.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),t.jsx(Ee,{fluid:!0,className:"position-relative",style:{zIndex:1},children:t.jsxs(oe,{className:"min-vh-100",children:[t.jsx(F,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:t.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[t.jsxs("div",{className:"d-flex align-items-center mb-4",children:[t.jsx("div",{className:"dashed-line me-3"}),t.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),t.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",t.jsx("br",{}),"ACADEMY"]}),t.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),t.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),t.jsx(F,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:t.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),t.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),t.jsxs("div",{style:{position:"relative",zIndex:2},children:[t.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[t.jsx("div",{className:"dashed-line me-3"}),t.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),t.jsx("div",{className:"dashed-line ms-3"})]}),t.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",t.jsx("br",{}),"ACADEMY"]}),t.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),t.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),t.jsxs(E,{onSubmit:f,children:[t.jsxs(E.Group,{className:"mb-3",controlId:"email",children:[t.jsx(E.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),t.jsx(E.Control,{type:"email",value:e,onChange:g=>r(g.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),t.jsxs(E.Group,{className:"mb-4",controlId:"password",children:[t.jsx(E.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),t.jsxs("div",{className:"position-relative",children:[t.jsx(E.Control,{type:n?"text":"password",value:s,onChange:g=>a(g.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),t.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(g=>!g),onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&i(v=>!v)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?t.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[t.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),t.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),t.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):t.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[t.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),t.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),t.jsx(se,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:l,children:l?t.jsxs(t.Fragment,{children:[t.jsx(St,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),t.jsx("div",{className:"text-center mb-2",children:t.jsx("button",{type:"button",onClick:()=>d(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),t.jsx("div",{className:"text-center mb-4",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),t.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),t.jsxs("div",{className:"text-center",children:[t.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),t.jsx("div",{className:"text-white-50 small",children:t.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),t.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),t.jsx(rj,{show:c,onHide:()=>d(!1)})]})}const aj=()=>{const[e]=o0(),r=qe(),[s,a]=b.useState({newPassword:"",confirmPassword:""}),[n,i]=b.useState(!1),[l,o]=b.useState(!1),[c,d]=b.useState(!1),[m,u]=b.useState(""),[h,p]=b.useState("");b.useEffect(()=>{const g=e.get("token");g&&p(g)},[e]);const x=g=>{const{name:v,value:N}=g.target;a(j=>({...j,[v]:N})),m&&u("")},f=async g=>{if(g.preventDefault(),u(""),!s.newPassword||!s.confirmPassword){u("Please fill in all fields.");return}if(s.newPassword!==s.confirmPassword){u("Passwords do not match.");return}d(!0);try{const v=await fetch(`${ki.BASE_URL}${ki.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,newPassword:s.newPassword,confirmPassword:s.confirmPassword})});if(!v.ok){v.status===405?u("Reset password feature is not available on this server. Please contact support."):v.status===404?u("Reset password endpoint not found. Please contact support."):v.status===400?u("Invalid token or password. Please request a new reset link."):u(`Server error (${v.status}). Please try again later.`);return}try{await v.json()}catch(N){console.error("JSON parsing error:",N),u("Server returned invalid response. Please try again later.");return}de.success("Password has been reset successfully! You can now login with your new password."),r("/login")}catch(v){console.error("Reset password error:",v),v.name==="TypeError"&&v.message.includes("fetch")?u("Cannot connect to server. Please check your internet connection."):u("An unexpected error occurred. Please try again later.")}finally{d(!1)}};return t.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:t.jsx(Ee,{children:t.jsx(oe,{className:"justify-content-center",children:t.jsx(F,{md:6,lg:5,xl:4,children:t.jsx(R,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:t.jsxs(R.Body,{className:"p-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:t.jsx(Tn,{size:24,className:"text-white"})}),t.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),t.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),m&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:m}),t.jsxs(E,{onSubmit:f,children:[t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),t.jsxs("div",{className:"position-relative",children:[t.jsx(E.Control,{type:n?"text":"password",name:"newPassword",value:s.newPassword,onChange:x,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),t.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?t.jsx(Sn,{size:16}):t.jsx(xt,{size:16})})]})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),t.jsxs("div",{className:"position-relative",children:[t.jsx(E.Control,{type:l?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:x,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),t.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>o(!l),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:l?t.jsx(Sn,{size:16}):t.jsx(xt,{size:16})})]})]}),t.jsxs("div",{className:"d-grid gap-2",children:[t.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:c||!s.newPassword||!s.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),t.jsx(se,{type:"button",variant:"outline-secondary",onClick:()=>r("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Di={};Di.version="0.18.5";var cu=1252,nj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_c={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},kc=function(e){nj.indexOf(e)!=-1&&(cu=_c[0]=e)};function ij(){kc(1252)}var fr=function(e){kc(e)};function Ac(){fr(1200),ij()}function Hd(e){for(var r=[],s=0,a=e.length;s<a;++s)r[s]=e.charCodeAt(s);return r}function lj(e){for(var r=[],s=0;s<e.length>>1;++s)r[s]=String.fromCharCode(e.charCodeAt(2*s)+(e.charCodeAt(2*s+1)<<8));return r.join("")}function du(e){for(var r=[],s=0;s<e.length>>1;++s)r[s]=String.fromCharCode(e.charCodeAt(2*s+1)+(e.charCodeAt(2*s)<<8));return r.join("")}var un=function(e){var r=e.charCodeAt(0),s=e.charCodeAt(1);return r==255&&s==254?lj(e.slice(2)):r==254&&s==255?du(e.slice(2)):r==65279?e.slice(1):e},ui=function(r){return String.fromCharCode(r)},Vd=function(r){return String.fromCharCode(r)},_n,Wr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kn(e){for(var r="",s=0,a=0,n=0,i=0,l=0,o=0,c=0,d=0;d<e.length;)s=e.charCodeAt(d++),i=s>>2,a=e.charCodeAt(d++),l=(s&3)<<4|a>>4,n=e.charCodeAt(d++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=Wr.charAt(i)+Wr.charAt(l)+Wr.charAt(o)+Wr.charAt(c);return r}function er(e){var r="",s=0,a=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Wr.indexOf(e.charAt(d++)),l=Wr.indexOf(e.charAt(d++)),s=i<<2|l>>4,r+=String.fromCharCode(s),o=Wr.indexOf(e.charAt(d++)),a=(l&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=Wr.indexOf(e.charAt(d++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var ut=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Mr=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,s){return s?new Buffer(r,s):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Yr(e){return ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Gd(e){return ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zs=function(r){return ut?Mr(r,"binary"):r.split("").map(function(s){return s.charCodeAt(0)&255})};function el(e){if(typeof ArrayBuffer>"u")return Zs(e);for(var r=new ArrayBuffer(e.length),s=new Uint8Array(r),a=0;a!=e.length;++a)s[a]=e.charCodeAt(a)&255;return r}function Qr(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],s=0;s<e.length;++s)r[s]=String.fromCharCode(e[s]);return r.join("")}function oj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Dc(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Dc(new Uint8Array(e));for(var r=new Array(e.length),s=0;s<e.length;++s)r[s]=e[s];return r}var hs=ut?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Mr(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,s=0;for(r=0;r<e.length;++r)s+=e[r].length;var a=new Uint8Array(s),n=0;for(r=0,s=0;r<e.length;s+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],s);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),s)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function cj(e){for(var r=[],s=0,a=e.length+250,n=Yr(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[s++]=l;else if(l<2048)n[s++]=192|l>>6&31,n[s++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[s++]=240|l>>8&7,n[s++]=128|l>>2&63,n[s++]=128|o>>6&15|(l&3)<<4,n[s++]=128|o&63}else n[s++]=224|l>>12&15,n[s++]=128|l>>6&63,n[s++]=128|l&63;s>a&&(r.push(n.slice(0,s)),s=0,n=Yr(65535),a=65530)}return r.push(n.slice(0,s)),hs(r)}var zs=/\u0000/g,hn=/[\u0001-\u0006]/g;function za(e){for(var r="",s=e.length-1;s>=0;)r+=e.charAt(s--);return r}function xr(e,r){var s=""+e;return s.length>=r?s:Zt("0",r-s.length)+s}function Ic(e,r){var s=""+e;return s.length>=r?s:Zt(" ",r-s.length)+s}function Ii(e,r){var s=""+e;return s.length>=r?s:s+Zt(" ",r-s.length)}function dj(e,r){var s=""+Math.round(e);return s.length>=r?s:Zt("0",r-s.length)+s}function mj(e,r){var s=""+e;return s.length>=r?s:Zt("0",r-s.length)+s}var qd=Math.pow(2,32);function Pa(e,r){if(e>qd||e<-qd)return dj(e,r);var s=Math.round(e);return mj(s,r)}function Pi(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Yd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function uj(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Kd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ri(e,r,s){for(var a=e<0?-1:1,n=e*a,i=0,l=1,o=0,c=1,d=0,m=0,u=Math.floor(n);d<r&&(u=Math.floor(n),o=u*l+i,m=u*d+c,!(n-u<5e-8));)n=1/(n-u),i=l,l=o,c=d,d=m;if(m>r&&(d>r?(m=c,o=i):(m=d,o=l)),!s)return[0,a*o,m];var h=Math.floor(a*o/m);return[h,a*o-h*m,m]}function ia(e,r,s){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,l=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=s?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=s?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),s&&(i=bj(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var mu=new Date(1899,11,31,0,0,0),fj=mu.getTime(),xj=new Date(1900,2,1,0,0,0);function uu(e,r){var s=e.getTime();return r?s-=1461*24*60*60*1e3:e>=xj&&(s+=1440*60*1e3),(s-(fj+(e.getTimezoneOffset()-mu.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Pc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pj(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gj(e){var r=e<0?12:11,s=Pc(e.toFixed(12));return s.length<=r||(s=e.toPrecision(10),s.length<=r)?s:e.toExponential(5)}function vj(e){var r=Pc(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function An(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),s;return r>=-4&&r<=-1?s=e.toPrecision(10+r):Math.abs(r)<=9?s=gj(e):r===10?s=e.toFixed(10).substr(0,12):s=vj(e),Pc(pj(s.toUpperCase()))}function ga(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):An(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return dr(14,uu(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function bj(e,r){r[0]-=581;var s=e.getDay();return e<60&&(s=(s+6)%7),s}function jj(e,r,s,a){var n="",i=0,l=0,o=s.y,c,d=0;switch(e){case 98:o=s.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(r.length){case 1:case 2:c=s.m,d=r.length;break;case 3:return vl[s.m-1][1];case 5:return vl[s.m-1][0];default:return vl[s.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=s.d,d=r.length;break;case 3:return Yd[s.q][0];default:return Yd[s.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(s.H+11)%12,d=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=s.H,d=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=s.M,d=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return s.u===0&&(r=="s"||r=="ss")?xr(s.S,r.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(s.S+s.u)),i>=60*l&&(i=0),r==="s"?i===0?"0":""+i/l:(n=xr(i,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=s.D*24+s.H;break;case"[m]":case"[mm]":c=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":c=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+r}d=r.length===3?1:2;break;case 101:c=o,d=1;break}var m=d>0?xr(c,d):"";return m}function Hr(e){var r=3;if(e.length<=r)return e;for(var s=e.length%r,a=e.substr(0,s);s!=e.length;s+=r)a+=(a.length>0?",":"")+e.substr(s,r);return a}var hu=/%/g;function yj(e,r,s){var a=r.replace(hu,""),n=r.length-a.length;return Ir(e,a,s*Math.pow(10,2*n))+Zt("%",n)}function Nj(e,r,s){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Ir(e,r.substr(0,a),s/Math.pow(10,3*(r.length-a)))}function fu(e,r){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+fu(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),s=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),s.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,n)+"."+s.substr(2+n),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,m){return c+d+m.substr(0,(n+i)%n)+"."+m.substr(i)+"E"})}else s=r.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var xu=/# (\?+)( ?)\/( ?)(\d+)/;function wj(e,r,s){var a=parseInt(e[4],10),n=Math.round(r*a),i=Math.floor(n/a),l=n-i*a,o=a;return s+(i===0?"":""+i)+" "+(l===0?Zt(" ",e[1].length+1+e[4].length):Ic(l,e[1].length)+e[2]+"/"+e[3]+xr(o,e[4].length))}function Sj(e,r,s){return s+(r===0?"":""+r)+Zt(" ",e[1].length+2+e[4].length)}var pu=/^#*0*\.([0#]+)/,gu=/\).*[0#]/,vu=/\(###\) ###\\?-####/;function Rs(e){for(var r="",s,a=0;a!=e.length;++a)switch(s=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(s)}return r}function Xd(e,r){var s=Math.pow(10,r);return""+Math.round(e*s)/s}function Jd(e,r){var s=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(s*a)).length?0:Math.round(s*a)}function Tj(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Ej(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function sr(e,r,s){if(e.charCodeAt(0)===40&&!r.match(gu)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?sr("n",a,s):"("+sr("n",a,-s)+")"}if(r.charCodeAt(r.length-1)===44)return Nj(e,r,s);if(r.indexOf("%")!==-1)return yj(e,r,s);if(r.indexOf("E")!==-1)return fu(r,s);if(r.charCodeAt(0)===36)return"$"+sr(e,r.substr(r.charAt(1)==" "?2:1),s);var n,i,l,o,c=Math.abs(s),d=s<0?"-":"";if(r.match(/^00+$/))return d+Pa(c,r.length);if(r.match(/^[#?]+$/))return n=Pa(s,0),n==="0"&&(n=""),n.length>r.length?n:Rs(r.substr(0,r.length-n.length))+n;if(i=r.match(xu))return wj(i,c,d);if(r.match(/^#+0+$/))return d+Pa(c,r.length-r.indexOf("0"));if(i=r.match(pu))return n=Xd(s,i[1].length).replace(/^([^\.]+)$/,"$1."+Rs(i[1])).replace(/\.$/,"."+Rs(i[1])).replace(/\.(\d*)$/,function(x,f){return"."+f+Zt("0",Rs(i[1]).length-f.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+Xd(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+Hr(Pa(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+sr(e,r,-s):Hr(""+(Math.floor(s)+Tj(s,i[1].length)))+"."+xr(Jd(s,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return sr(e,r.replace(/^#,#*,/,""),s);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=za(sr(e,r.replace(/[\\-]/g,""),s)),l=0,za(za(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(r.match(vu))return n=sr(e,"##########",s),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Ri(c,Math.pow(10,l)-1,!1),n=""+d,m=Ir("n",i[1],o[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+i[2]+"/"+i[3],m=Ii(o[2],l),m.length<i[4].length&&(m=Rs(i[4].substr(i[4].length-m.length))+m),n+=m,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Ri(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ic(o[1],l)+i[2]+"/"+i[3]+Ii(o[2],l):Zt(" ",2*l+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=Pa(s,0),r.length<=n.length?n:Rs(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var u=r.indexOf(".")-l,h=r.length-n.length-u;return Rs(r.substr(0,u)+n+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return l=Jd(s,i[1].length),s<0?"-"+sr(e,r,-s):Hr(Ej(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?xr(0,3-x.length):"")+x})+"."+xr(l,i[1].length);switch(r){case"###,##0.00":return sr(e,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var p=Hr(Pa(c,0));return p!=="0"?d+p:"";case"###,###.00":return sr(e,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return sr(e,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Cj(e,r,s){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Ir(e,r.substr(0,a),s/Math.pow(10,3*(r.length-a)))}function _j(e,r,s){var a=r.replace(hu,""),n=r.length-a.length;return Ir(e,a,s*Math.pow(10,2*n))+Zt("%",n)}function bu(e,r){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+bu(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),s=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!s.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,m){return c+d+m.substr(0,(n+i)%n)+"."+m.substr(i)+"E"})}else s=r.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function wr(e,r,s){if(e.charCodeAt(0)===40&&!r.match(gu)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?wr("n",a,s):"("+wr("n",a,-s)+")"}if(r.charCodeAt(r.length-1)===44)return Cj(e,r,s);if(r.indexOf("%")!==-1)return _j(e,r,s);if(r.indexOf("E")!==-1)return bu(r,s);if(r.charCodeAt(0)===36)return"$"+wr(e,r.substr(r.charAt(1)==" "?2:1),s);var n,i,l,o,c=Math.abs(s),d=s<0?"-":"";if(r.match(/^00+$/))return d+xr(c,r.length);if(r.match(/^[#?]+$/))return n=""+s,s===0&&(n=""),n.length>r.length?n:Rs(r.substr(0,r.length-n.length))+n;if(i=r.match(xu))return Sj(i,c,d);if(r.match(/^#+0+$/))return d+xr(c,r.length-r.indexOf("0"));if(i=r.match(pu))return n=(""+s).replace(/^([^\.]+)$/,"$1."+Rs(i[1])).replace(/\.$/,"."+Rs(i[1])),n=n.replace(/\.(\d*)$/,function(x,f){return"."+f+Zt("0",Rs(i[1]).length-f.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+Hr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+wr(e,r,-s):Hr(""+s)+"."+Zt("0",i[1].length);if(i=r.match(/^#,#*,#0/))return wr(e,r.replace(/^#,#*,/,""),s);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=za(wr(e,r.replace(/[\\-]/g,""),s)),l=0,za(za(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(r.match(vu))return n=wr(e,"##########",s),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Ri(c,Math.pow(10,l)-1,!1),n=""+d,m=Ir("n",i[1],o[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+i[2]+"/"+i[3],m=Ii(o[2],l),m.length<i[4].length&&(m=Rs(i[4].substr(i[4].length-m.length))+m),n+=m,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Ri(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ic(o[1],l)+i[2]+"/"+i[3]+Ii(o[2],l):Zt(" ",2*l+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+s,r.length<=n.length?n:Rs(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var u=r.indexOf(".")-l,h=r.length-n.length-u;return Rs(r.substr(0,u)+n+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return s<0?"-"+wr(e,r,-s):Hr(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?xr(0,3-x.length):"")+x})+"."+xr(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=Hr(""+c);return p!=="0"?d+p:"";default:if(r.match(/\.[0#?]*$/))return wr(e,r.slice(0,r.lastIndexOf(".")),s)+Rs(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ir(e,r,s){return(s|0)===s?wr(e,r,s):sr(e,r,s)}function kj(e){for(var r=[],s=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),s===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var ju=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qa(e){for(var r=0,s="",a="";r<e.length;)switch(s=e.charAt(r)){case"G":Pi(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(a=s;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(ju))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++r))>-1||s=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===s;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Aj(e,r,s,a){for(var n=[],i="",l=0,o="",c="t",d,m,u,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Pi(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(u=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(u);n[n.length]={t:"t",v:i},++l;break;case"\\":var p=e.charAt(++l),x=p==="("||p===")"?p:"t";n[n.length]={t:x,v:p},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:r},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=ia(r,s,e.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||d==null&&(d=ia(r,s),d==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var f={t:o,v:o};if(d==null&&(d=ia(r,s)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(f.v=d.H>=12?"P":"A"),f.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(f.v=d.H>=12?"PM":"AM"),f.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(f.v=d.H>=12?"":""),f.t="T",l+=5,h="h"):(f.t="t",++l),d==null&&f.t==="T")return"";n[n.length]=f,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ju)){if(d==null&&(d=ia(r,s),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qa(e)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var g=0,v=0,N;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=h,c="h",g<1&&(g=1);break;case"s":(N=n[l].v.match(/\.0+$/))&&(v=Math.max(v,N[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[l].v.match(/[Hh]/)&&(g=1),g<2&&n[l].v.match(/[Mm]/)&&(g=2),g<3&&n[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var j="",S;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=jj(n[l].t.charCodeAt(0),n[l].v,d,v),n[l].t="t";break;case"n":case"?":for(S=l+1;n[S]!=null&&((o=n[S].t)==="?"||o==="D"||(o===" "||o==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[l].v+=n[S].v,n[S]={v:"",t:";"},++S;j+=n[l].v,l=S-1;break;case"G":n[l].t="t",n[l].v=ga(r,s);break}var C="",w,y;if(j.length>0){j.charCodeAt(0)==40?(w=r<0&&j.charCodeAt(0)===45?-r:r,y=Ir("n",j,w)):(w=r<0&&a>1?-r:r,y=Ir("n",j,w),w<0&&n[0]&&n[0].t=="t"&&(y=y.substr(1),n[0].v="-"+n[0].v)),S=y.length-1;var T=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){T=l;break}var k=n.length;if(T===n.length&&y.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(S>=n[l].v.length-1?(S-=n[l].v.length,n[l].v=y.substr(S+1,n[l].v.length)):S<0?n[l].v="":(n[l].v=y.substr(0,S+1),S=-1),n[l].t="t",k=l);S>=0&&k<n.length&&(n[k].v=y.substr(0,S+1)+n[k].v)}else if(T!==n.length&&y.indexOf("E")===-1){for(S=y.indexOf(".")-1,l=T;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(m=n[l].v.indexOf(".")>-1&&l===T?n[l].v.indexOf(".")-1:n[l].v.length-1,C=n[l].v.substr(m+1);m>=0;--m)S>=0&&(n[l].v.charAt(m)==="0"||n[l].v.charAt(m)==="#")&&(C=y.charAt(S--)+C);n[l].v=C,n[l].t="t",k=l}for(S>=0&&k<n.length&&(n[k].v=y.substr(0,S+1)+n[k].v),S=y.indexOf(".")+1,l=T;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==T)){for(m=n[l].v.indexOf(".")>-1&&l===T?n[l].v.indexOf(".")+1:0,C=n[l].v.substr(0,m);m<n[l].v.length;++m)S<y.length&&(C+=y.charAt(S++));n[l].v=C,n[l].t="t",k=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(w=a>1&&r<0&&l>0&&n[l-1].v==="-"?-r:r,n[l].v=Ir(n[l].t,n[l].v,w),n[l].t="t");var P="";for(l=0;l!==n.length;++l)n[l]!=null&&(P+=n[l].v);return P}var Zd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qd(e,r){if(r==null)return!1;var s=parseFloat(r[2]);switch(r[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0;break}return!1}function Dj(e,r){var s=kj(e),a=s.length,n=s[a-1].indexOf("@");if(a<4&&n>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof r!="number")return[4,s.length===4||n>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=n>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=n>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=n>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var i=r>0?s[0]:r<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[a,i];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var l=s[0].match(Zd),o=s[1].match(Zd);return Qd(r,l)?[a,s[0]]:Qd(r,o)?[a,s[1]]:[a,s[l!=null&&o!=null?2:1]]}return[a,i]}function dr(e,r,s){s==null&&(s={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&s.dateNF?a=s.dateNF:a=e;break;case"number":e==14&&s.dateNF?a=s.dateNF:a=(s.table!=null?s.table:Je)[e],a==null&&(a=s.table&&s.table[Kd[e]]||Je[Kd[e]]),a==null&&(a=hj[e]||"General");break}if(Pi(a,0))return ga(r,s);r instanceof Date&&(r=uu(r,s.date1904));var n=Dj(a,r);if(Pi(n[1]))return ga(r,s);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Aj(n[1],r,s,n[0])}function Pr(e,r){if(typeof r!="number"){r=+r||-1;for(var s=0;s<392;++s){if(Je[s]==null){r<0&&(r=s);continue}if(Je[s]==e){r=s;break}}r<0&&(r=391)}return Je[r]=e,r}function tl(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Pr(e[r],r)}function en(){Je=uj()}var Ij={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},yu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Pj(e){var r=typeof e=="number"?Je[e]:e;return r=r.replace(yu,"(\\d+)"),new RegExp("^"+r+"$")}function Rj(e,r,s){var a=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(r.match(yu)||[]).forEach(function(u,h){var p=parseInt(s[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=p;break;case"d":i=p;break;case"h":l=p;break;case"s":c=p;break;case"m":l>=0?o=p:n=p;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?d:a==-1&&n==-1&&i==-1?m:d+"T"+m}var Fj=(function(){var e={};e.version="1.2.0";function r(){for(var y=0,T=new Array(256),k=0;k!=256;++k)y=k,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,T[k]=y;return typeof Int32Array<"u"?new Int32Array(T):T}var s=r();function a(y){var T=0,k=0,P=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)A[P]=y[P];for(P=0;P!=256;++P)for(k=y[P],T=256+P;T<4096;T+=256)k=A[T]=k>>>8^y[k&255];var _=[];for(P=1;P!=16;++P)_[P-1]=typeof Int32Array<"u"?A.subarray(P*256,P*256+256):A.slice(P*256,P*256+256);return _}var n=a(s),i=n[0],l=n[1],o=n[2],c=n[3],d=n[4],m=n[5],u=n[6],h=n[7],p=n[8],x=n[9],f=n[10],g=n[11],v=n[12],N=n[13],j=n[14];function S(y,T){for(var k=T^-1,P=0,A=y.length;P<A;)k=k>>>8^s[(k^y.charCodeAt(P++))&255];return~k}function C(y,T){for(var k=T^-1,P=y.length-15,A=0;A<P;)k=j[y[A++]^k&255]^N[y[A++]^k>>8&255]^v[y[A++]^k>>16&255]^g[y[A++]^k>>>24]^f[y[A++]]^x[y[A++]]^p[y[A++]]^h[y[A++]]^u[y[A++]]^m[y[A++]]^d[y[A++]]^c[y[A++]]^o[y[A++]]^l[y[A++]]^i[y[A++]]^s[y[A++]];for(P+=15;A<P;)k=k>>>8^s[(k^y[A++])&255];return~k}function w(y,T){for(var k=T^-1,P=0,A=y.length,_=0,U=0;P<A;)_=y.charCodeAt(P++),_<128?k=k>>>8^s[(k^_)&255]:_<2048?(k=k>>>8^s[(k^(192|_>>6&31))&255],k=k>>>8^s[(k^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,U=y.charCodeAt(P++)&1023,k=k>>>8^s[(k^(240|_>>8&7))&255],k=k>>>8^s[(k^(128|_>>2&63))&255],k=k>>>8^s[(k^(128|U>>6&15|(_&3)<<4))&255],k=k>>>8^s[(k^(128|U&63))&255]):(k=k>>>8^s[(k^(224|_>>12&15))&255],k=k>>>8^s[(k^(128|_>>6&63))&255],k=k>>>8^s[(k^(128|_&63))&255]);return~k}return e.table=s,e.bstr=S,e.buf=C,e.str=w,e})(),Ye=(function(){var r={};r.version="1.2.1";function s(O,Z){for(var G=O.split("/"),X=Z.split("/"),Q=0,ee=0,xe=Math.min(G.length,X.length);Q<xe;++Q){if(ee=G[Q].length-X[Q].length)return ee;if(G[Q]!=X[Q])return G[Q]<X[Q]?-1:1}return G.length-X.length}function a(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:a(O.slice(0,-1));var Z=O.lastIndexOf("/");return Z===-1?O:O.slice(0,Z+1)}function n(O){if(O.charAt(O.length-1)=="/")return n(O.slice(0,-1));var Z=O.lastIndexOf("/");return Z===-1?O:O.slice(Z+1)}function i(O,Z){typeof Z=="string"&&(Z=new Date(Z));var G=Z.getHours();G=G<<6|Z.getMinutes(),G=G<<5|Z.getSeconds()>>>1,O.write_shift(2,G);var X=Z.getFullYear()-1980;X=X<<4|Z.getMonth()+1,X=X<<5|Z.getDate(),O.write_shift(2,X)}function l(O){var Z=O.read_shift(2)&65535,G=O.read_shift(2)&65535,X=new Date,Q=G&31;G>>>=5;var ee=G&15;G>>>=4,X.setMilliseconds(0),X.setFullYear(G+1980),X.setMonth(ee-1),X.setDate(Q);var xe=Z&31;Z>>>=5;var we=Z&63;return Z>>>=6,X.setHours(Z),X.setMinutes(we),X.setSeconds(xe<<1),X}function o(O){gs(O,0);for(var Z={},G=0;O.l<=O.length-4;){var X=O.read_shift(2),Q=O.read_shift(2),ee=O.l+Q,xe={};switch(X){case 21589:G=O.read_shift(1),G&1&&(xe.mtime=O.read_shift(4)),Q>5&&(G&2&&(xe.atime=O.read_shift(4)),G&4&&(xe.ctime=O.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}O.l=ee,Z[X]=xe}return Z}var c;function d(){return c||(c={})}function m(O,Z){if(O[0]==80&&O[1]==75)return vd(O,Z);if((O[0]|32)==109&&(O[1]|32)==105)return Af(O,Z);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var G=3,X=512,Q=0,ee=0,xe=0,we=0,fe=0,pe=[],ge=O.slice(0,512);gs(ge,0);var Pe=u(ge);switch(G=Pe[0],G){case 3:X=512;break;case 4:X=4096;break;case 0:if(Pe[1]==0)return vd(O,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}X!==512&&(ge=O.slice(0,X),gs(ge,28));var Le=O.slice(0,X);h(ge,G);var He=ge.read_shift(4,"i");if(G===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);ge.l+=4,xe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),we=ge.read_shift(4,"i"),Q=ge.read_shift(4,"i"),fe=ge.read_shift(4,"i"),ee=ge.read_shift(4,"i");for(var Re=-1,$e=0;$e<109&&(Re=ge.read_shift(4,"i"),!(Re<0));++$e)pe[$e]=Re;var lt=p(O,X);g(fe,ee,lt,X,pe);var Vt=N(lt,xe,pe,X);Vt[xe].name="!Directory",Q>0&&we!==U&&(Vt[we].name="!MiniFAT"),Vt[pe[0]].name="!FAT",Vt.fat_addrs=pe,Vt.ssz=X;var Gt={},js=[],rn=[],an=[];j(xe,Vt,lt,js,Q,Gt,rn,we),x(rn,an,js),js.shift();var nn={FileIndex:rn,FullPaths:an};return Z&&Z.raw&&(nn.raw={header:Le,sectors:lt}),nn}function u(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(D,"Header Signature: "),O.l+=16;var Z=O.read_shift(2,"u");return[O.read_shift(2,"u"),Z]}function h(O,Z){var G=9;switch(O.l+=2,G=O.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function p(O,Z){for(var G=Math.ceil(O.length/Z)-1,X=[],Q=1;Q<G;++Q)X[Q-1]=O.slice(Q*Z,(Q+1)*Z);return X[G-1]=O.slice(G*Z),X}function x(O,Z,G){for(var X=0,Q=0,ee=0,xe=0,we=0,fe=G.length,pe=[],ge=[];X<fe;++X)pe[X]=ge[X]=X,Z[X]=G[X];for(;we<ge.length;++we)X=ge[we],Q=O[X].L,ee=O[X].R,xe=O[X].C,pe[X]===X&&(Q!==-1&&pe[Q]!==Q&&(pe[X]=pe[Q]),ee!==-1&&pe[ee]!==ee&&(pe[X]=pe[ee])),xe!==-1&&(pe[xe]=X),Q!==-1&&X!=pe[X]&&(pe[Q]=pe[X],ge.lastIndexOf(Q)<we&&ge.push(Q)),ee!==-1&&X!=pe[X]&&(pe[ee]=pe[X],ge.lastIndexOf(ee)<we&&ge.push(ee));for(X=1;X<fe;++X)pe[X]===X&&(ee!==-1&&pe[ee]!==ee?pe[X]=pe[ee]:Q!==-1&&pe[Q]!==Q&&(pe[X]=pe[Q]));for(X=1;X<fe;++X)if(O[X].type!==0){if(we=X,we!=pe[we])do we=pe[we],Z[X]=Z[we]+"/"+Z[X];while(we!==0&&pe[we]!==-1&&we!=pe[we]);pe[X]=-1}for(Z[0]+="/",X=1;X<fe;++X)O[X].type!==2&&(Z[X]+="/")}function f(O,Z,G){for(var X=O.start,Q=O.size,ee=[],xe=X;G&&Q>0&&xe>=0;)ee.push(Z.slice(xe*_,xe*_+_)),Q-=_,xe=aa(G,xe*4);return ee.length===0?ye(0):hs(ee).slice(0,O.size)}function g(O,Z,G,X,Q){var ee=U;if(O===U){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var xe=G[O],we=(X>>>2)-1;if(!xe)return;for(var fe=0;fe<we&&(ee=aa(xe,fe*4))!==U;++fe)Q.push(ee);g(aa(xe,X-4),Z-1,G,X,Q)}}function v(O,Z,G,X,Q){var ee=[],xe=[];Q||(Q=[]);var we=X-1,fe=0,pe=0;for(fe=Z;fe>=0;){Q[fe]=!0,ee[ee.length]=fe,xe.push(O[fe]);var ge=G[Math.floor(fe*4/X)];if(pe=fe*4&we,X<4+pe)throw new Error("FAT boundary crossed: "+fe+" 4 "+X);if(!O[ge])break;fe=aa(O[ge],pe)}return{nodes:ee,data:mm([xe])}}function N(O,Z,G,X){var Q=O.length,ee=[],xe=[],we=[],fe=[],pe=X-1,ge=0,Pe=0,Le=0,He=0;for(ge=0;ge<Q;++ge)if(we=[],Le=ge+Z,Le>=Q&&(Le-=Q),!xe[Le]){fe=[];var Re=[];for(Pe=Le;Pe>=0;){Re[Pe]=!0,xe[Pe]=!0,we[we.length]=Pe,fe.push(O[Pe]);var $e=G[Math.floor(Pe*4/X)];if(He=Pe*4&pe,X<4+He)throw new Error("FAT boundary crossed: "+Pe+" 4 "+X);if(!O[$e]||(Pe=aa(O[$e],He),Re[Pe]))break}ee[Le]={nodes:we,data:mm([fe])}}return ee}function j(O,Z,G,X,Q,ee,xe,we){for(var fe=0,pe=X.length?2:0,ge=Z[O].data,Pe=0,Le=0,He;Pe<ge.length;Pe+=128){var Re=ge.slice(Pe,Pe+128);gs(Re,64),Le=Re.read_shift(2),He=zc(Re,0,Le-pe),X.push(He);var $e={name:He,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},lt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);lt!==0&&($e.ct=S(Re,Re.l-8));var Vt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Vt!==0&&($e.mt=S(Re,Re.l-8)),$e.start=Re.read_shift(4,"i"),$e.size=Re.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=U,$e.name=""),$e.type===5?(fe=$e.start,Q>0&&fe!==U&&(Z[fe].name="!StreamData")):$e.size>=4096?($e.storage="fat",Z[$e.start]===void 0&&(Z[$e.start]=v(G,$e.start,Z.fat_addrs,Z.ssz)),Z[$e.start].name=$e.name,$e.content=Z[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:fe!==U&&$e.start!==U&&Z[fe]&&($e.content=f($e,Z[fe].data,(Z[we]||{}).data))),$e.content&&gs($e.content,0),ee[He]=$e,xe.push($e)}}function S(O,Z){return new Date((Js(O,Z+4)/1e7*Math.pow(2,32)+Js(O,Z)/1e7-11644473600)*1e3)}function C(O,Z){return d(),m(c.readFileSync(O),Z)}function w(O,Z){var G=Z&&Z.type;switch(G||ut&&Buffer.isBuffer(O)&&(G="buffer"),G||"base64"){case"file":return C(O,Z);case"base64":return m(Zs(er(O)),Z);case"binary":return m(Zs(O),Z)}return m(O,Z)}function y(O,Z){var G=Z||{},X=G.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=X+"/",O.FileIndex[0]={name:X,type:5}),G.CLSID&&(O.FileIndex[0].clsid=G.CLSID),T(O)}function T(O){var Z="Sh33tJ5";if(!Ye.find(O,"/"+Z)){var G=ye(4);G[0]=55,G[1]=G[3]=50,G[2]=54,O.FileIndex.push({name:Z,type:2,content:G,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+Z),k(O)}}function k(O,Z){y(O);for(var G=!1,X=!1,Q=O.FullPaths.length-1;Q>=0;--Q){var ee=O.FileIndex[Q];switch(ee.type){case 0:X?G=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(ee.R*ee.L*ee.C)&&(G=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!Z)){var xe=new Date(1987,1,19),we=0,fe=Object.create?Object.create(null):{},pe=[];for(Q=0;Q<O.FullPaths.length;++Q)fe[O.FullPaths[Q]]=!0,O.FileIndex[Q].type!==0&&pe.push([O.FullPaths[Q],O.FileIndex[Q]]);for(Q=0;Q<pe.length;++Q){var ge=a(pe[Q][0]);X=fe[ge],X||(pe.push([ge,{name:n(ge).replace("/",""),type:1,clsid:q,ct:xe,mt:xe,content:null}]),fe[ge]=!0)}for(pe.sort(function(He,Re){return s(He[0],Re[0])}),O.FullPaths=[],O.FileIndex=[],Q=0;Q<pe.length;++Q)O.FullPaths[Q]=pe[Q][0],O.FileIndex[Q]=pe[Q][1];for(Q=0;Q<pe.length;++Q){var Pe=O.FileIndex[Q],Le=O.FullPaths[Q];if(Pe.name=n(Le).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||q,Q===0)Pe.C=pe.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Le.slice(-1)=="/"){for(we=Q+1;we<pe.length&&a(O.FullPaths[we])!=Le;++we);for(Pe.C=we>=pe.length?-1:we,we=Q+1;we<pe.length&&a(O.FullPaths[we])!=a(Le);++we);Pe.R=we>=pe.length?-1:we,Pe.type=1}else a(O.FullPaths[Q+1]||"")==a(Le)&&(Pe.R=Q+1),Pe.type=2}}}function P(O,Z){var G=Z||{};if(G.fileType=="mad")return Df(O,G);switch(k(O),G.fileType){case"zip":return Sf(O,G)}var X=(function(He){for(var Re=0,$e=0,lt=0;lt<He.FileIndex.length;++lt){var Vt=He.FileIndex[lt];if(Vt.content){var Gt=Vt.content.length;Gt>0&&(Gt<4096?Re+=Gt+63>>6:$e+=Gt+511>>9)}}for(var js=He.FullPaths.length+3>>2,rn=Re+7>>3,an=Re+127>>7,nn=rn+$e+js+an,ra=nn+127>>7,dl=ra<=109?0:Math.ceil((ra-109)/127);nn+ra+dl+127>>7>ra;)dl=++ra<=109?0:Math.ceil((ra-109)/127);var Ar=[1,dl,ra,an,js,$e,Re,0];return He.FileIndex[0].size=Re<<6,Ar[7]=(He.FileIndex[0].start=Ar[0]+Ar[1]+Ar[2]+Ar[3]+Ar[4]+Ar[5])+(Ar[6]+7>>3),Ar})(O),Q=ye(X[7]<<9),ee=0,xe=0;{for(ee=0;ee<8;++ee)Q.write_shift(1,W[ee]);for(ee=0;ee<8;++ee)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),ee=0;ee<3;++ee)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,X[2]),Q.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:U),Q.write_shift(4,X[3]),Q.write_shift(-4,X[1]?X[0]-1:U),Q.write_shift(4,X[1]),ee=0;ee<109;++ee)Q.write_shift(-4,ee<X[2]?X[1]+ee:-1)}if(X[1])for(xe=0;xe<X[1];++xe){for(;ee<236+xe*127;++ee)Q.write_shift(-4,ee<X[2]?X[1]+ee:-1);Q.write_shift(-4,xe===X[1]-1?U:xe+1)}var we=function(He){for(xe+=He;ee<xe-1;++ee)Q.write_shift(-4,ee+1);He&&(++ee,Q.write_shift(-4,U))};for(xe=ee=0,xe+=X[1];ee<xe;++ee)Q.write_shift(-4,Y.DIFSECT);for(xe+=X[2];ee<xe;++ee)Q.write_shift(-4,Y.FATSECT);we(X[3]),we(X[4]);for(var fe=0,pe=0,ge=O.FileIndex[0];fe<O.FileIndex.length;++fe)ge=O.FileIndex[fe],ge.content&&(pe=ge.content.length,!(pe<4096)&&(ge.start=xe,we(pe+511>>9)));for(we(X[6]+7>>3);Q.l&511;)Q.write_shift(-4,Y.ENDOFCHAIN);for(xe=ee=0,fe=0;fe<O.FileIndex.length;++fe)ge=O.FileIndex[fe],ge.content&&(pe=ge.content.length,!(!pe||pe>=4096)&&(ge.start=xe,we(pe+63>>6)));for(;Q.l&511;)Q.write_shift(-4,Y.ENDOFCHAIN);for(ee=0;ee<X[4]<<2;++ee){var Pe=O.FullPaths[ee];if(!Pe||Pe.length===0){for(fe=0;fe<17;++fe)Q.write_shift(4,0);for(fe=0;fe<3;++fe)Q.write_shift(4,-1);for(fe=0;fe<12;++fe)Q.write_shift(4,0);continue}ge=O.FileIndex[ee],ee===0&&(ge.start=ge.size?ge.start-1:U);var Le=ee===0&&G.root||ge.name;if(pe=2*(Le.length+1),Q.write_shift(64,Le,"utf16le"),Q.write_shift(2,pe),Q.write_shift(1,ge.type),Q.write_shift(1,ge.color),Q.write_shift(-4,ge.L),Q.write_shift(-4,ge.R),Q.write_shift(-4,ge.C),ge.clsid)Q.write_shift(16,ge.clsid,"hex");else for(fe=0;fe<4;++fe)Q.write_shift(4,0);Q.write_shift(4,ge.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,ge.start),Q.write_shift(4,ge.size),Q.write_shift(4,0)}for(ee=1;ee<O.FileIndex.length;++ee)if(ge=O.FileIndex[ee],ge.size>=4096)if(Q.l=ge.start+1<<9,ut&&Buffer.isBuffer(ge.content))ge.content.copy(Q,Q.l,0,ge.size),Q.l+=ge.size+511&-512;else{for(fe=0;fe<ge.size;++fe)Q.write_shift(1,ge.content[fe]);for(;fe&511;++fe)Q.write_shift(1,0)}for(ee=1;ee<O.FileIndex.length;++ee)if(ge=O.FileIndex[ee],ge.size>0&&ge.size<4096)if(ut&&Buffer.isBuffer(ge.content))ge.content.copy(Q,Q.l,0,ge.size),Q.l+=ge.size+63&-64;else{for(fe=0;fe<ge.size;++fe)Q.write_shift(1,ge.content[fe]);for(;fe&63;++fe)Q.write_shift(1,0)}if(ut)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function A(O,Z){var G=O.FullPaths.map(function(fe){return fe.toUpperCase()}),X=G.map(function(fe){var pe=fe.split("/");return pe[pe.length-(fe.slice(-1)=="/"?2:1)]}),Q=!1;Z.charCodeAt(0)===47?(Q=!0,Z=G[0].slice(0,-1)+Z):Q=Z.indexOf("/")!==-1;var ee=Z.toUpperCase(),xe=Q===!0?G.indexOf(ee):X.indexOf(ee);if(xe!==-1)return O.FileIndex[xe];var we=!ee.match(hn);for(ee=ee.replace(zs,""),we&&(ee=ee.replace(hn,"!")),xe=0;xe<G.length;++xe)if((we?G[xe].replace(hn,"!"):G[xe]).replace(zs,"")==ee||(we?X[xe].replace(hn,"!"):X[xe]).replace(zs,"")==ee)return O.FileIndex[xe];return null}var _=64,U=-2,D="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(O,Z,G){d();var X=P(O,G);c.writeFileSync(Z,X)}function H(O){for(var Z=new Array(O.length),G=0;G<O.length;++G)Z[G]=String.fromCharCode(O[G]);return Z.join("")}function je(O,Z){var G=P(O,Z);switch(Z&&Z.type||"buffer"){case"file":return d(),c.writeFileSync(Z.filename,G),G;case"binary":return typeof G=="string"?G:H(G);case"base64":return kn(typeof G=="string"?G:H(G));case"buffer":if(ut)return Buffer.isBuffer(G)?G:Mr(G);case"array":return typeof G=="string"?Zs(G):G}return G}var ie;function B(O){try{var Z=O.InflateRaw,G=new Z;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)ie=O;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function V(O,Z){if(!ie)return ii(O,Z);var G=ie.InflateRaw,X=new G,Q=X._processChunk(O.slice(O.l),X._finishFlushFlag);return O.l+=X.bytesRead,Q}function z(O){return ie?ie.deflateRawSync(O):We(O)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(O){var Z=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Ne=typeof Uint8Array<"u",ae=Ne?new Uint8Array(256):[],re=0;re<256;++re)ae[re]=ue(re);function M(O,Z){var G=ae[O&255];return Z<=8?G>>>8-Z:(G=G<<8|ae[O>>8&255],Z<=16?G>>>16-Z:(G=G<<8|ae[O>>16&255],G>>>24-Z))}function _e(O,Z){var G=Z&7,X=Z>>>3;return(O[X]|(G<=6?0:O[X+1]<<8))>>>G&3}function ke(O,Z){var G=Z&7,X=Z>>>3;return(O[X]|(G<=5?0:O[X+1]<<8))>>>G&7}function ze(O,Z){var G=Z&7,X=Z>>>3;return(O[X]|(G<=4?0:O[X+1]<<8))>>>G&15}function ce(O,Z){var G=Z&7,X=Z>>>3;return(O[X]|(G<=3?0:O[X+1]<<8))>>>G&31}function Se(O,Z){var G=Z&7,X=Z>>>3;return(O[X]|(G<=1?0:O[X+1]<<8))>>>G&127}function Me(O,Z,G){var X=Z&7,Q=Z>>>3,ee=(1<<G)-1,xe=O[Q]>>>X;return G<8-X||(xe|=O[Q+1]<<8-X,G<16-X)||(xe|=O[Q+2]<<16-X,G<24-X)||(xe|=O[Q+3]<<24-X),xe&ee}function Ve(O,Z,G){var X=Z&7,Q=Z>>>3;return X<=5?O[Q]|=(G&7)<<X:(O[Q]|=G<<X&255,O[Q+1]=(G&7)>>8-X),Z+3}function Ue(O,Z,G){var X=Z&7,Q=Z>>>3;return G=(G&1)<<X,O[Q]|=G,Z+1}function Tt(O,Z,G){var X=Z&7,Q=Z>>>3;return G<<=X,O[Q]|=G&255,G>>>=8,O[Q+1]=G,Z+8}function ot(O,Z,G){var X=Z&7,Q=Z>>>3;return G<<=X,O[Q]|=G&255,G>>>=8,O[Q+1]=G&255,O[Q+2]=G>>>8,Z+16}function he(O,Z){var G=O.length,X=2*G>Z?2*G:Z+5,Q=0;if(G>=Z)return O;if(ut){var ee=Gd(X);if(O.copy)O.copy(ee);else for(;Q<O.length;++Q)ee[Q]=O[Q];return ee}else if(Ne){var xe=new Uint8Array(X);if(xe.set)xe.set(O);else for(;Q<G;++Q)xe[Q]=O[Q];return xe}return O.length=X,O}function me(O){for(var Z=new Array(O),G=0;G<O;++G)Z[G]=0;return Z}function Be(O,Z,G){var X=1,Q=0,ee=0,xe=0,we=0,fe=O.length,pe=Ne?new Uint16Array(32):me(32);for(ee=0;ee<32;++ee)pe[ee]=0;for(ee=fe;ee<G;++ee)O[ee]=0;fe=O.length;var ge=Ne?new Uint16Array(fe):me(fe);for(ee=0;ee<fe;++ee)pe[Q=O[ee]]++,X<Q&&(X=Q),ge[ee]=0;for(pe[0]=0,ee=1;ee<=X;++ee)pe[ee+16]=we=we+pe[ee-1]<<1;for(ee=0;ee<fe;++ee)we=O[ee],we!=0&&(ge[ee]=pe[we+16]++);var Pe=0;for(ee=0;ee<fe;++ee)if(Pe=O[ee],Pe!=0)for(we=M(ge[ee],X)>>X-Pe,xe=(1<<X+4-Pe)-1;xe>=0;--xe)Z[we|xe<<Pe]=Pe&15|ee<<4;return X}var ht=Ne?new Uint16Array(512):me(512),tt=Ne?new Uint16Array(32):me(32);if(!Ne){for(var Xe=0;Xe<512;++Xe)ht[Xe]=0;for(Xe=0;Xe<32;++Xe)tt[Xe]=0}(function(){for(var O=[],Z=0;Z<32;Z++)O.push(5);Be(O,tt,32);var G=[];for(Z=0;Z<=143;Z++)G.push(8);for(;Z<=255;Z++)G.push(9);for(;Z<=279;Z++)G.push(7);for(;Z<=287;Z++)G.push(8);Be(G,ht,288)})();var Rt=(function(){for(var Z=Ne?new Uint8Array(32768):[],G=0,X=0;G<ne.length-1;++G)for(;X<ne[G+1];++X)Z[X]=G;for(;X<32768;++X)Z[X]=29;var Q=Ne?new Uint8Array(259):[];for(G=0,X=0;G<te.length-1;++G)for(;X<te[G+1];++X)Q[X]=G;function ee(we,fe){for(var pe=0;pe<we.length;){var ge=Math.min(65535,we.length-pe),Pe=pe+ge==we.length;for(fe.write_shift(1,+Pe),fe.write_shift(2,ge),fe.write_shift(2,~ge&65535);ge-- >0;)fe[fe.l++]=we[pe++]}return fe.l}function xe(we,fe){for(var pe=0,ge=0,Pe=Ne?new Uint16Array(32768):[];ge<we.length;){var Le=Math.min(65535,we.length-ge);if(Le<10){for(pe=Ve(fe,pe,+(ge+Le==we.length)),pe&7&&(pe+=8-(pe&7)),fe.l=pe/8|0,fe.write_shift(2,Le),fe.write_shift(2,~Le&65535);Le-- >0;)fe[fe.l++]=we[ge++];pe=fe.l*8;continue}pe=Ve(fe,pe,+(ge+Le==we.length)+2);for(var He=0;Le-- >0;){var Re=we[ge];He=(He<<5^Re)&32767;var $e=-1,lt=0;if(($e=Pe[He])&&($e|=ge&-32768,$e>ge&&($e-=32768),$e<ge))for(;we[$e+lt]==we[ge+lt]&&lt<250;)++lt;if(lt>2){Re=Q[lt],Re<=22?pe=Tt(fe,pe,ae[Re+1]>>1)-1:(Tt(fe,pe,3),pe+=5,Tt(fe,pe,ae[Re-23]>>5),pe+=3);var Vt=Re<8?0:Re-4>>2;Vt>0&&(ot(fe,pe,lt-te[Re]),pe+=Vt),Re=Z[ge-$e],pe=Tt(fe,pe,ae[Re]>>3),pe-=3;var Gt=Re<4?0:Re-2>>1;Gt>0&&(ot(fe,pe,ge-$e-ne[Re]),pe+=Gt);for(var js=0;js<lt;++js)Pe[He]=ge&32767,He=(He<<5^we[ge])&32767,++ge;Le-=lt-1}else Re<=143?Re=Re+48:pe=Ue(fe,pe,1),pe=Tt(fe,pe,ae[Re]),Pe[He]=ge&32767,++ge}pe=Tt(fe,pe,0)-1}return fe.l=(pe+7)/8|0,fe.l}return function(fe,pe){return fe.length<8?ee(fe,pe):xe(fe,pe)}})();function We(O){var Z=ye(50+Math.floor(O.length*1.1)),G=Rt(O,Z);return Z.slice(0,G)}var at=Ne?new Uint16Array(32768):me(32768),Ie=Ne?new Uint16Array(32768):me(32768),Ke=Ne?new Uint16Array(128):me(128),pt=1,Ze=1;function ts(O,Z){var G=ce(O,Z)+257;Z+=5;var X=ce(O,Z)+1;Z+=5;var Q=ze(O,Z)+4;Z+=4;for(var ee=0,xe=Ne?new Uint8Array(19):me(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,pe=Ne?new Uint8Array(8):me(8),ge=Ne?new Uint8Array(8):me(8),Pe=xe.length,Le=0;Le<Q;++Le)xe[L[Le]]=ee=ke(O,Z),fe<ee&&(fe=ee),pe[ee]++,Z+=3;var He=0;for(pe[0]=0,Le=1;Le<=fe;++Le)ge[Le]=He=He+pe[Le-1]<<1;for(Le=0;Le<Pe;++Le)(He=xe[Le])!=0&&(we[Le]=ge[He]++);var Re=0;for(Le=0;Le<Pe;++Le)if(Re=xe[Le],Re!=0){He=ae[we[Le]]>>8-Re;for(var $e=(1<<7-Re)-1;$e>=0;--$e)Ke[He|$e<<Re]=Re&7|Le<<3}var lt=[];for(fe=1;lt.length<G+X;)switch(He=Ke[Se(O,Z)],Z+=He&7,He>>>=3){case 16:for(ee=3+_e(O,Z),Z+=2,He=lt[lt.length-1];ee-- >0;)lt.push(He);break;case 17:for(ee=3+ke(O,Z),Z+=3;ee-- >0;)lt.push(0);break;case 18:for(ee=11+Se(O,Z),Z+=7;ee-- >0;)lt.push(0);break;default:lt.push(He),fe<He&&(fe=He);break}var Vt=lt.slice(0,G),Gt=lt.slice(G);for(Le=G;Le<286;++Le)Vt[Le]=0;for(Le=X;Le<30;++Le)Gt[Le]=0;return pt=Be(Vt,at,286),Ze=Be(Gt,Ie,30),Z}function Ks(O,Z){if(O[0]==3&&!(O[1]&3))return[Yr(Z),2];for(var G=0,X=0,Q=Gd(Z||1<<18),ee=0,xe=Q.length>>>0,we=0,fe=0;(X&1)==0;){if(X=ke(O,G),G+=3,X>>>1)X>>1==1?(we=9,fe=5):(G=ts(O,G),we=pt,fe=Ze);else{G&7&&(G+=8-(G&7));var pe=O[G>>>3]|O[(G>>>3)+1]<<8;if(G+=32,pe>0)for(!Z&&xe<ee+pe&&(Q=he(Q,ee+pe),xe=Q.length);pe-- >0;)Q[ee++]=O[G>>>3],G+=8;continue}for(;;){!Z&&xe<ee+32767&&(Q=he(Q,ee+32767),xe=Q.length);var ge=Me(O,G,we),Pe=X>>>1==1?ht[ge]:at[ge];if(G+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)Q[ee++]=Pe;else{if(Pe==256)break;Pe-=257;var Le=Pe<8?0:Pe-4>>2;Le>5&&(Le=0);var He=ee+te[Pe];Le>0&&(He+=Me(O,G,Le),G+=Le),ge=Me(O,G,fe),Pe=X>>>1==1?tt[ge]:Ie[ge],G+=Pe&15,Pe>>>=4;var Re=Pe<4?0:Pe-2>>1,$e=ne[Pe];for(Re>0&&($e+=Me(O,G,Re),G+=Re),!Z&&xe<He&&(Q=he(Q,He+100),xe=Q.length);ee<He;)Q[ee]=Q[ee-$e],++ee}}}return Z?[Q,G+7>>>3]:[Q.slice(0,ee),G+7>>>3]}function ii(O,Z){var G=O.slice(O.l||0),X=Ks(G,Z);return O.l+=X[1],X[0]}function gd(O,Z){if(O)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function vd(O,Z){var G=O;gs(G,0);var X=[],Q=[],ee={FileIndex:X,FullPaths:Q};y(ee,{root:Z.root});for(var xe=G.length-4;(G[xe]!=80||G[xe+1]!=75||G[xe+2]!=5||G[xe+3]!=6)&&xe>=0;)--xe;G.l=xe+4,G.l+=4;var we=G.read_shift(2);G.l+=6;var fe=G.read_shift(4);for(G.l=fe,xe=0;xe<we;++xe){G.l+=20;var pe=G.read_shift(4),ge=G.read_shift(4),Pe=G.read_shift(2),Le=G.read_shift(2),He=G.read_shift(2);G.l+=8;var Re=G.read_shift(4),$e=o(G.slice(G.l+Pe,G.l+Pe+Le));G.l+=Pe+Le+He;var lt=G.l;G.l=Re+4,wf(G,pe,ge,ee,$e),G.l=lt}return ee}function wf(O,Z,G,X,Q){O.l+=2;var ee=O.read_shift(2),xe=O.read_shift(2),we=l(O);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var fe=O.read_shift(4),pe=O.read_shift(4),ge=O.read_shift(4),Pe=O.read_shift(2),Le=O.read_shift(2),He="",Re=0;Re<Pe;++Re)He+=String.fromCharCode(O[O.l++]);if(Le){var $e=o(O.slice(O.l,O.l+Le));($e[21589]||{}).mt&&(we=$e[21589].mt),((Q||{})[21589]||{}).mt&&(we=Q[21589].mt)}O.l+=Le;var lt=O.slice(O.l,O.l+pe);switch(xe){case 8:lt=V(O,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var Vt=!1;ee&8&&(fe=O.read_shift(4),fe==134695760&&(fe=O.read_shift(4),Vt=!0),pe=O.read_shift(4),ge=O.read_shift(4)),pe!=Z&&gd(Vt,"Bad compressed size: "+Z+" != "+pe),ge!=G&&gd(Vt,"Bad uncompressed size: "+G+" != "+ge),cl(X,He,lt,{unsafe:!0,mt:we})}function Sf(O,Z){var G=Z||{},X=[],Q=[],ee=ye(1),xe=G.compression?8:0,we=0,fe=0,pe=0,ge=0,Pe=0,Le=O.FullPaths[0],He=Le,Re=O.FileIndex[0],$e=[],lt=0;for(fe=1;fe<O.FullPaths.length;++fe)if(He=O.FullPaths[fe].slice(Le.length),Re=O.FileIndex[fe],!(!Re.size||!Re.content||He=="Sh33tJ5")){var Vt=ge,Gt=ye(He.length);for(pe=0;pe<He.length;++pe)Gt.write_shift(1,He.charCodeAt(pe)&127);Gt=Gt.slice(0,Gt.l),$e[Pe]=Fj.buf(Re.content,0);var js=Re.content;xe==8&&(js=z(js)),ee=ye(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,we),ee.write_shift(2,xe),Re.mt?i(ee,Re.mt):ee.write_shift(4,0),ee.write_shift(-4,$e[Pe]),ee.write_shift(4,js.length),ee.write_shift(4,Re.content.length),ee.write_shift(2,Gt.length),ee.write_shift(2,0),ge+=ee.length,X.push(ee),ge+=Gt.length,X.push(Gt),ge+=js.length,X.push(js),ee=ye(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,we),ee.write_shift(2,xe),ee.write_shift(4,0),ee.write_shift(-4,$e[Pe]),ee.write_shift(4,js.length),ee.write_shift(4,Re.content.length),ee.write_shift(2,Gt.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,Vt),lt+=ee.l,Q.push(ee),lt+=Gt.length,Q.push(Gt),++Pe}return ee=ye(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,Pe),ee.write_shift(2,Pe),ee.write_shift(4,lt),ee.write_shift(4,ge),ee.write_shift(2,0),hs([hs(X),hs(Q),ee])}var li={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tf(O,Z){if(O.ctype)return O.ctype;var G=O.name||"",X=G.match(/\.([^\.]+)$/);return X&&li[X[1]]||Z&&(X=(G=Z).match(/[\.\\]([^\.\\])+$/),X&&li[X[1]])?li[X[1]]:"application/octet-stream"}function Ef(O){for(var Z=kn(O),G=[],X=0;X<Z.length;X+=76)G.push(Z.slice(X,X+76));return G.join(`\r
`)+`\r
`}function Cf(O){var Z=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ge=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],X=Z.split(`\r
`),Q=0;Q<X.length;++Q){var ee=X[Q];if(ee.length==0){G.push("");continue}for(var xe=0;xe<ee.length;){var we=76,fe=ee.slice(xe,xe+we);fe.charAt(we-1)=="="?we--:fe.charAt(we-2)=="="?we-=2:fe.charAt(we-3)=="="&&(we-=3),fe=ee.slice(xe,xe+we),xe+=we,xe<ee.length&&(fe+="="),G.push(fe)}}return G.join(`\r
`)}function _f(O){for(var Z=[],G=0;G<O.length;++G){for(var X=O[G];G<=O.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+O[++G];Z.push(X)}for(var Q=0;Q<Z.length;++Q)Z[Q]=Z[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return Zs(Z.join(`\r
`))}function kf(O,Z,G){for(var X="",Q="",ee="",xe,we=0;we<10;++we){var fe=Z[we];if(!fe||fe.match(/^\s*$/))break;var pe=fe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":X=pe[2].trim();break;case"content-type":ee=pe[2].trim();break;case"content-transfer-encoding":Q=pe[2].trim();break}}switch(++we,Q.toLowerCase()){case"base64":xe=Zs(er(Z.slice(we).join("")));break;case"quoted-printable":xe=_f(Z.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var ge=cl(O,X.slice(G.length),xe,{unsafe:!0});ee&&(ge.ctype=ee)}function Af(O,Z){if(H(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=Z&&Z.root||"",X=(ut&&Buffer.isBuffer(O)?O.toString("binary"):H(O)).split(`\r
`),Q=0,ee="";for(Q=0;Q<X.length;++Q)if(ee=X[Q],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),G||(G=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),ee.slice(0,G.length)!=G););var xe=(X[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var we="--"+(xe[1]||""),fe=[],pe=[],ge={FileIndex:fe,FullPaths:pe};y(ge);var Pe,Le=0;for(Q=0;Q<X.length;++Q){var He=X[Q];He!==we&&He!==we+"--"||(Le++&&kf(ge,X.slice(Pe,Q),G),Pe=Q)}return ge}function Df(O,Z){var G=Z||{},X=G.boundary||"SheetJS";X="------="+X;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],ee=O.FullPaths[0],xe=ee,we=O.FileIndex[0],fe=1;fe<O.FullPaths.length;++fe)if(xe=O.FullPaths[fe].slice(ee.length),we=O.FileIndex[fe],!(!we.size||!we.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(lt){return"_x"+lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(lt){return"_u"+lt.charCodeAt(0).toString(16)+"_"});for(var pe=we.content,ge=ut&&Buffer.isBuffer(pe)?pe.toString("binary"):H(pe),Pe=0,Le=Math.min(1024,ge.length),He=0,Re=0;Re<=Le;++Re)(He=ge.charCodeAt(Re))>=32&&He<128&&++Pe;var $e=Pe>=Le*4/5;Q.push(X),Q.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+xe),Q.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),Q.push("Content-Type: "+Tf(we,xe)),Q.push(""),Q.push($e?Cf(ge):Ef(ge))}return Q.push(X+`--\r
`),Q.join(`\r
`)}function If(O){var Z={};return y(Z,O),Z}function cl(O,Z,G,X){var Q=X&&X.unsafe;Q||y(O);var ee=!Q&&Ye.find(O,Z);if(!ee){var xe=O.FullPaths[0];Z.slice(0,xe.length)==xe?xe=Z:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+Z).replace("//","/")),ee={name:n(Z),type:2},O.FileIndex.push(ee),O.FullPaths.push(xe),Q||Ye.utils.cfb_gc(O)}return ee.content=G,ee.size=G?G.length:0,X&&(X.CLSID&&(ee.clsid=X.CLSID),X.mt&&(ee.mt=X.mt),X.ct&&(ee.ct=X.ct)),ee}function Pf(O,Z){y(O);var G=Ye.find(O,Z);if(G){for(var X=0;X<O.FileIndex.length;++X)if(O.FileIndex[X]==G)return O.FileIndex.splice(X,1),O.FullPaths.splice(X,1),!0}return!1}function Rf(O,Z,G){y(O);var X=Ye.find(O,Z);if(X){for(var Q=0;Q<O.FileIndex.length;++Q)if(O.FileIndex[Q]==X)return O.FileIndex[Q].name=n(G),O.FullPaths[Q]=G,!0}return!1}function Ff(O){k(O,!0)}return r.find=A,r.read=w,r.parse=m,r.write=je,r.writeFile=K,r.utils={cfb_new:If,cfb_add:cl,cfb_del:Pf,cfb_mov:Rf,cfb_gc:Ff,ReadShift:xn,CheckField:Wu,prep_blob:gs,bconcat:hs,use_zlib:B,_deflateRaw:We,_inflateRaw:ii,consts:Y},r})();function Oj(e){return typeof e=="string"?el(e):Array.isArray(e)?oj(e):e}function Zn(e,r,s){if(typeof Deno<"u"){if(s&&typeof r=="string")switch(s){case"utf8":r=new TextEncoder(s).encode(r);break;case"binary":r=el(r);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(e,r)}var a=s=="utf8"?Er(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([Oj(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=Qr(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Lj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var s=r.read();return r.close(),s}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function es(e){for(var r=Object.keys(e),s=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&s.push(r[a]);return s}function em(e,r){for(var s=[],a=es(e),n=0;n!==a.length;++n)s[e[a[n]][r]]==null&&(s[e[a[n]][r]]=a[n]);return s}function sl(e){for(var r=[],s=es(e),a=0;a!==s.length;++a)r[e[s[a]]]=s[a];return r}function rl(e){for(var r=[],s=es(e),a=0;a!==s.length;++a)r[e[s[a]]]=parseInt(s[a],10);return r}function Mj(e){for(var r=[],s=es(e),a=0;a!==s.length;++a)r[e[s[a]]]==null&&(r[e[s[a]]]=[]),r[e[s[a]]].push(s[a]);return r}var Fi=new Date(1899,11,30,0,0,0);function ms(e,r){var s=e.getTime(),a=Fi.getTime()+(e.getTimezoneOffset()-Fi.getTimezoneOffset())*6e4;return(s-a)/(1440*60*1e3)}var Nu=new Date,Bj=Fi.getTime()+(Nu.getTimezoneOffset()-Fi.getTimezoneOffset())*6e4,tm=Nu.getTimezoneOffset();function al(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Bj),r.getTimezoneOffset()!==tm&&r.setTime(r.getTime()+(r.getTimezoneOffset()-tm)*6e4),r}function zj(e){var r=0,s=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(s=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":s*=24;case"H":s*=60;case"M":if(a)s*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=s*parseInt(n[i],10)}return r}var sm=new Date("2017-02-19T19:06:09.000Z"),wu=isNaN(sm.getFullYear())?new Date("2/19/17"):sm,$j=wu.getFullYear()==2017;function $t(e,r){var s=new Date(e);if($j)return r>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):r<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(e instanceof Date)return e;if(wu.getFullYear()==1917&&!isNaN(s.getFullYear())){var a=s.getFullYear();return e.indexOf(""+a)>-1||s.setFullYear(s.getFullYear()+100),s}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function va(e,r){if(ut&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Er(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Er(du(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Er(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Er(new TextDecoder("utf-16be").decode(e.slice(2)))}var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return s[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Ut(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Ut(e[s]));return r}function Zt(e,r){for(var s="";s.length<r;)s+=e;return s}function pr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var s=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return s=-s,i}),!isNaN(r=Number(a)))?r/s:r}var Uj=["january","february","march","april","may","june","july","august","september","october","november","december"];function qa(e){var r=new Date(e),s=new Date(NaN),a=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return s;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&Uj.indexOf(l)==-1)return s}else if(l.match(/[a-z]/))return s;return a<0||a>8099?s:(n>0||i>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?s:r}var Wj=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(s,a,n){if(e||typeof a=="string")return s.split(a);for(var i=s.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}})();function Su(e){return e?e.content&&e.type?va(e.content,!0):e.data?un(e.data):e.asNodeBuffer&&ut?un(e.asNodeBuffer().toString("binary")):e.asBinary?un(e.asBinary()):e._data&&e._data.getContent?un(va(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Tu(e){if(!e)return null;if(e.data)return Hd(e.data);if(e.asNodeBuffer&&ut)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Hd(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Hj(e){return e&&e.name.slice(-4)===".bin"?Tu(e):Su(e)}function nr(e,r){for(var s=e.FullPaths||es(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<s.length;++i){var l=s[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[s[i]]:e.FileIndex[i]}return null}function Rc(e,r){var s=nr(e,r);if(s==null)throw new Error("Cannot find file "+r+" in zip");return s}function ls(e,r,s){if(!s)return Hj(Rc(e,r));if(!r)return null;try{return ls(e,r)}catch{return null}}function Qs(e,r,s){if(!s)return Su(Rc(e,r));if(!r)return null;try{return Qs(e,r)}catch{return null}}function Vj(e,r,s){return Tu(Rc(e,r))}function rm(e){for(var r=e.FullPaths||es(e.files),s=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&s.push(r[a].replace(/^Root Entry[\/]/,""));return s.sort()}function mt(e,r,s){if(e.FullPaths){if(typeof s=="string"){var a;return ut?a=Mr(s):a=cj(s),Ye.utils.cfb_add(e,r,a)}Ye.utils.cfb_add(e,r,s)}else e.file(r,s)}function Fc(){return Ye.utils.cfb_new()}function Eu(e,r){switch(r.type){case"base64":return Ye.read(e,{type:"base64"});case"binary":return Ye.read(e,{type:"binary"});case"buffer":case"array":return Ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function fn(e,r){if(e.charAt(0)=="/")return e.slice(1);var s=r.split("/");r.slice(-1)!="/"&&s.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?s.pop():n!=="."&&s.push(n)}return s.join("/")}var ns=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Gj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,am=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qj=/<[^>]*>/g,Ds=ns.match(am)?am:qj,Yj=/<\w*:/,Kj=/<(\/?)\w+:/;function st(e,r,s){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(Gj),o=0,c="",d=0,m="",u="",h=1;if(l)for(d=0;d!=l.length;++d){for(u=l[d],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(m=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(h=(n=u.charCodeAt(i+1))==34||n==39?1:0,c=u.slice(i+1+h,u.length-h),o=0;o!=m.length&&m.charCodeAt(o)!==58;++o);if(o===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=c,a[m.toLowerCase()]=c;else{var p=(o===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(o+1);if(a[p]&&m.slice(o-3,o)=="ext")continue;a[p]=c,a[p.toLowerCase()]=c}}return a}function _r(e){return e.replace(Kj,"<$1")}var Cu={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Oc=sl(Cu),jt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function s(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return Cu[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return s(n.slice(0,i))+n.slice(i+9,l)+s(n.slice(l+3))}})(),Lc=/[&<>'"]/g,Xj=/[\u0000-\u0008\u000b-\u001f]/g;function At(e){var r=e+"";return r.replace(Lc,function(s){return Oc[s]}).replace(Xj,function(s){return"_x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nm(e){return At(e).replace(/ /g,"_x0020_")}var _u=/[\u0000-\u001f]/g;function Mc(e){var r=e+"";return r.replace(Lc,function(s){return Oc[s]}).replace(/\n/g,"<br/>").replace(_u,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}function Jj(e){var r=e+"";return r.replace(Lc,function(s){return Oc[s]}).replace(_u,function(s){return"&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"})}var im=(function(){var e=/&#(\d+);/g;function r(s,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function Zj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bl(e){for(var r="",s=0,a=0,n=0,i=0,l=0,o=0;s<e.length;){if(a=e.charCodeAt(s++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(s++),a>191&&a<224){l=(a&31)<<6,l|=n&63,r+=String.fromCharCode(l);continue}if(i=e.charCodeAt(s++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(s++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function lm(e){var r=Yr(2*e.length),s,a,n=1,i=0,l=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?s=o:o<224?(s=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(s=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,s=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),s-=65536,l=55296+(s>>>10&1023),s=56320+(s&1023)),l!==0&&(r[i++]=l&255,r[i++]=l>>>8,l=0),r[i++]=s%256,r[i++]=s>>>8;return r.slice(0,i).toString("ucs2")}function om(e){return Mr(e,"binary").toString("utf8")}var hi="foo bar baz",Ft=ut&&(om(hi)==bl(hi)&&om||lm(hi)==bl(hi)&&lm)||bl,Er=ut?function(e){return Mr(e,"utf8").toString("binary")}:function(e){for(var r=[],s=0,a=0,n=0;s<e.length;)switch(a=e.charCodeAt(s++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(s++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Dn=(function(){var e={};return function(s,a){var n=s+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",a||"")}})(),ku=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(s){for(var a=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),Qj=(function(){var e={};return function(s){return e[s]!==void 0?e[s]:e[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}})(),ey=/<\/?(?:vt:)?variant>/g,ty=/<(?:vt:)([^>]*)>([\s\S]*)</;function cm(e,r){var s=st(e),a=e.match(Qj(s.baseType))||[],n=[];if(a.length!=s.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+s.size);return n}return a.forEach(function(i){var l=i.replace(ey,"").match(ty);l&&n.push({v:Ft(l[2]),t:l[1]})}),n}var Au=/(^\s|\s$|\n)/;function vs(e,r){return"<"+e+(r.match(Au)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function In(e){return es(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Fe(e,r,s){return"<"+e+(s!=null?In(s):"")+(r!=null?(r.match(Au)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function ic(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(s){if(r)throw s}return""}function sy(e,r){switch(typeof e){case"string":var s=Fe("vt:lpwstr",At(e));return s=s.replace(/&quot;/g,"_x0022_"),s;case"number":return Fe((e|0)==e?"vt:i4":"vt:r8",At(String(e)));case"boolean":return Fe("vt:bool",e?"true":"false")}if(e instanceof Date)return Fe("vt:filetime",ic(e));throw new Error("Unable to serialize "+e)}function Bc(e){if(ut&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ft(Qr(Dc(e)));throw new Error("Bad input format: expected Buffer or string")}var Pn=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ta=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ry(e,r){for(var s=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,i=5;i>=0;--i)n=n*256+e[r+i];return a==2047?n==0?s*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),s*Math.pow(2,a-52)*n)}function ay(e,r,s){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,l=a?-r:r;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[s+o]=i&255;e[s+6]=(n&15)<<4|i&15,e[s+7]=n>>4|a}var dm=function(e){for(var r=[],s=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=s)r.push.apply(r,e[0][a].slice(n,n+s));return r},mm=ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Mr(r)})):dm(e)}:dm,um=function(e,r,s){for(var a=[],n=r;n<s;n+=2)a.push(String.fromCharCode(Dr(e,n)));return a.join("").replace(zs,"")},zc=ut?function(e,r,s){return Buffer.isBuffer(e)?e.toString("utf16le",r,s).replace(zs,""):um(e,r,s)}:um,hm=function(e,r,s){for(var a=[],n=r;n<r+s;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Du=ut?function(e,r,s){return Buffer.isBuffer(e)?e.toString("hex",r,r+s):hm(e,r,s)}:hm,fm=function(e,r,s){for(var a=[],n=r;n<s;n++)a.push(String.fromCharCode(La(e,n)));return a.join("")},Qn=ut?function(r,s,a){return Buffer.isBuffer(r)?r.toString("utf8",s,a):fm(r,s,a)}:fm,Iu=function(e,r){var s=Js(e,r);return s>0?Qn(e,r+4,r+4+s-1):""},Pu=Iu,Ru=function(e,r){var s=Js(e,r);return s>0?Qn(e,r+4,r+4+s-1):""},Fu=Ru,Ou=function(e,r){var s=2*Js(e,r);return s>0?Qn(e,r+4,r+4+s-1):""},Lu=Ou,Mu=function(r,s){var a=Js(r,s);return a>0?zc(r,s+4,s+4+a):""},Bu=Mu,zu=function(e,r){var s=Js(e,r);return s>0?Qn(e,r+4,r+4+s):""},$u=zu,Uu=function(e,r){return ry(e,r)},Oi=Uu,$c=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ut&&(Pu=function(r,s){if(!Buffer.isBuffer(r))return Iu(r,s);var a=r.readUInt32LE(s);return a>0?r.toString("utf8",s+4,s+4+a-1):""},Fu=function(r,s){if(!Buffer.isBuffer(r))return Ru(r,s);var a=r.readUInt32LE(s);return a>0?r.toString("utf8",s+4,s+4+a-1):""},Lu=function(r,s){if(!Buffer.isBuffer(r))return Ou(r,s);var a=2*r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+a-1)},Bu=function(r,s){if(!Buffer.isBuffer(r))return Mu(r,s);var a=r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+a)},$u=function(r,s){if(!Buffer.isBuffer(r))return zu(r,s);var a=r.readUInt32LE(s);return r.toString("utf8",s+4,s+4+a)},Oi=function(r,s){return Buffer.isBuffer(r)?r.readDoubleLE(s):Uu(r,s)},$c=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var La=function(e,r){return e[r]},Dr=function(e,r){return e[r+1]*256+e[r]},ny=function(e,r){var s=e[r+1]*256+e[r];return s<32768?s:(65535-s+1)*-1},Js=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},aa=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},iy=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function xn(e,r){var s="",a,n,i=[],l,o,c,d;switch(r){case"dbcs":if(d=this.l,ut&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)s+=String.fromCharCode(Dr(this,d)),d+=2;e*=2;break;case"utf8":s=Qn(this,this.l,this.l+e);break;case"utf16le":e*=2,s=zc(this,this.l,this.l+e);break;case"wstr":return xn.call(this,e,"dbcs");case"lpstr-ansi":s=Pu(this,this.l),e=4+Js(this,this.l);break;case"lpstr-cp":s=Fu(this,this.l),e=4+Js(this,this.l);break;case"lpwstr":s=Lu(this,this.l),e=4+2*Js(this,this.l);break;case"lpp4":e=4+Js(this,this.l),s=Bu(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Js(this,this.l),s=$u(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,s="";(l=La(this,this.l+e++))!==0;)i.push(ui(l));s=i.join("");break;case"_wstr":for(e=0,s="";(l=Dr(this,this.l+e))!==0;)i.push(ui(l)),e+=2;e+=2,s=i.join("");break;case"dbcs-cont":for(s="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=La(this,d),this.l=d+1,o=xn.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ui(Dr(this,d))),d+=2}s=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(s="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=La(this,d),this.l=d+1,o=xn.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ui(La(this,d))),d+=1}s=i.join("");break;default:switch(e){case 1:return a=La(this,this.l),this.l++,a;case 2:return a=(r==="i"?ny:Dr)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?aa:iy)(this,this.l),this.l+=4,a):(n=Js(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Oi(this,this.l):n=Oi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:s=Du(this,this.l,e);break}}return this.l+=e,s}var ly=function(e,r,s){e[s]=r&255,e[s+1]=r>>>8&255,e[s+2]=r>>>16&255,e[s+3]=r>>>24&255},oy=function(e,r,s){e[s]=r&255,e[s+1]=r>>8&255,e[s+2]=r>>16&255,e[s+3]=r>>24&255},cy=function(e,r,s){e[s]=r&255,e[s+1]=r>>>8&255};function dy(e,r,s){var a=0,n=0;if(s==="dbcs"){for(n=0;n!=r.length;++n)cy(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(s==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(s==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(s==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var l=r.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,ly(this,r,this.l);break;case 8:if(a=8,s==="f"){ay(this,r,this.l);break}case 16:break;case-4:a=4,oy(this,r,this.l);break}return this.l+=a,this}function Wu(e,r){var s=Du(this,this.l,e.length>>1);if(s!==e)throw new Error(r+"Expected "+e+" saw "+s);this.l+=e.length>>1}function gs(e,r){e.l=r,e.read_shift=xn,e.chk=Wu,e.write_shift=dy}function As(e,r){e.l+=r}function ye(e){var r=Yr(e);return gs(r,0),r}function Br(e,r,s){if(e){var a,n,i;gs(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=Bn[o]||Bn[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var m=d.f&&d.f(e,i,s);if(e.l=c,r(m,d,o))return}}}function qs(){var e=[],r=ut?256:2048,s=function(d){var m=ye(d);return gs(m,0),m},a=s(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(n(),a=s(Math.max(d+1,r)))},l=function(){return n(),hs(e)},o=function(d){n(),a=d,a.l==null&&(a.l=a.length),i(r)};return{next:i,push:o,end:l,_bufs:e}}function Ce(e,r,s,a){var n=+r,i;if(!isNaN(n)){a||(a=Bn[n].p||(s||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&$c(s)&&e.push(s)}}function pn(e,r,s){var a=Ut(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!s||s.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function xm(e,r,s){var a=Ut(e);return a.s=pn(a.s,r.s,s),a.e=pn(a.e,r.s,s),a}function gn(e,r){if(e.cRel&&e.c<0)for(e=Ut(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ut(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var s=Qe(e);return!e.cRel&&e.cRel!=null&&(s=hy(s)),!e.rRel&&e.rRel!=null&&(s=my(s)),s}function jl(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Yt(e.s.c)+":"+(e.e.cRel?"":"$")+Yt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+as(e.s.r)+":"+(e.e.rRel?"":"$")+as(e.e.r):gn(e.s,r.biff)+":"+gn(e.e,r.biff)}function Uc(e){return parseInt(uy(e),10)-1}function as(e){return""+(e+1)}function my(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uy(e){return e.replace(/\$(\d+)$/,"$1")}function Wc(e){for(var r=fy(e),s=0,a=0;a!==r.length;++a)s=26*s+r.charCodeAt(a)-64;return s-1}function Yt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function hy(e){return e.replace(/^([A-Z])/,"$$$1")}function fy(e){return e.replace(/^\$([A-Z])/,"$1")}function xy(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(e){for(var r=0,s=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(s=26*s+(n-64))}return{c:s-1,r:r-1}}function Qe(e){for(var r=e.c+1,s="";r;r=(r-1)/26|0)s=String.fromCharCode((r-1)%26+65)+s;return s+(e.r+1)}function Ys(e){var r=e.indexOf(":");return r==-1?{s:Kt(e),e:Kt(e)}:{s:Kt(e.slice(0,r)),e:Kt(e.slice(r+1))}}function dt(e,r){return typeof r>"u"||typeof r=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof r!="string"&&(r=Qe(r)),e==r?e:e+":"+r)}function yt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},s=0,a=0,n=0,i=e.length;for(s=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)s=26*s+n;for(r.s.c=--s,s=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)s=10*s+n;if(r.s.r=--s,a===i||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,s=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)s=26*s+n;for(r.e.c=--s,s=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)s=10*s+n;return r.e.r=--s,r}function pm(e,r){var s=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=dr(e.z,s?ms(r):r)}catch{}try{return e.w=dr((e.XF||{}).numFmtId||(s?14:0),s?ms(r):r)}catch{return""+r}}function Lr(e,r,s){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&s&&s.dateNF&&(e.z=s.dateNF),e.t=="e"?zr[e.v]||e.v:r==null?pm(e,e.v):pm(e,r))}function ea(e,r){var s=r&&r.sheet?r.sheet:"Sheet1",a={};return a[s]=e,{SheetNames:[s],Sheets:a}}function Hu(e,r,s){var a=s||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Kt(a.origin):a.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=yt(i["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[u].length;++h)if(!(typeof r[u][h]>"u")){var p={v:r[u][h]},x=l+u,f=o+h;if(d.s.r>x&&(d.s.r=x),d.s.c>f&&(d.s.c=f),d.e.r<x&&(d.e.r=x),d.e.c<f&&(d.e.c=f),r[u][h]&&typeof r[u][h]=="object"&&!Array.isArray(r[u][h])&&!(r[u][h]instanceof Date))p=r[u][h];else if(Array.isArray(p.v)&&(p.f=r[u][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||Je[14],a.cellDates?(p.t="d",p.w=dr(p.z,ms(p.v))):(p.t="n",p.v=ms(p.v),p.w=dr(p.z,p.v))):p.t="s";if(n)i[x]||(i[x]=[]),i[x][f]&&i[x][f].z&&(p.z=i[x][f].z),i[x][f]=p;else{var g=Qe({c:f,r:x});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return d.s.c<1e7&&(i["!ref"]=dt(d)),i}function tn(e,r){return Hu(null,e,r)}function py(e){return e.read_shift(4,"i")}function gr(e,r){return r||(r=ye(4)),r.write_shift(4,e),r}function _s(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function fs(e,r){var s=!1;return r==null&&(s=!0,r=ye(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),s?r.slice(0,r.l):r}function gy(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vy(e,r){return r||(r=ye(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Hc(e,r){var s=e.l,a=e.read_shift(1),n=_s(e),i=[],l={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(gy(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=s+r,l}function by(e,r){var s=!1;return r==null&&(s=!0,r=ye(15+4*e.t.length)),r.write_shift(1,0),fs(e.t,r),s?r.slice(0,r.l):r}var jy=Hc;function yy(e,r){var s=!1;return r==null&&(s=!0,r=ye(23+4*e.t.length)),r.write_shift(1,1),fs(e.t,r),r.write_shift(4,1),vy({},r),s?r.slice(0,r.l):r}function mr(e){var r=e.read_shift(4),s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:s}}function Ea(e,r){return r==null&&(r=ye(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ca(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function _a(e,r){return r==null&&(r=ye(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Ny=_s,Vu=fs;function Vc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Li(e,r){var s=!1;return r==null&&(s=!0,r=ye(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),s?r.slice(0,r.l):r}var wy=_s,lc=Vc,Gc=Li;function qc(e){var r=e.slice(e.l,e.l+4),s=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Oi([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):aa(r,0)>>2;return s?n/100:n}function Gu(e,r){r==null&&(r=ye(4));var s=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,s=1),a)r.write_shift(-4,((s?n:e)<<2)+(s+2));else throw new Error("unsupported RkNumber "+e)}function qu(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Sy(e,r){return r||(r=ye(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var ka=qu,sn=Sy;function Cs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ba(e,r){return(r||ye(8)).write_shift(8,e,"f")}function Ty(e){var r={},s=e.read_shift(1),a=s>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var d=ca[n];d&&(r.rgb=Fn(d));break;case 2:r.rgb=Fn([l,o,c]);break;case 3:r.theme=n;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function Mi(e,r){if(r||(r=ye(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var s=e.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),r.write_shift(2,s),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function Ey(e){var r=e.read_shift(1);e.l++;var s={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return s}function Cy(e,r){r||(r=ye(2));var s=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,s),r.write_shift(1,0),r}function Yu(e,r){var s={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return s[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function _y(e){return Yu(e,1)}function ky(e){return Yu(e,2)}var Yc=2,Ws=3,fi=11,gm=12,Bi=19,xi=64,Ay=65,Dy=71,Iy=4108,Py=4126,us=80,Ku=81,Ry=[us,Ku],oc={1:{n:"CodePage",t:Yc},2:{n:"Category",t:us},3:{n:"PresentationFormat",t:us},4:{n:"ByteCount",t:Ws},5:{n:"LineCount",t:Ws},6:{n:"ParagraphCount",t:Ws},7:{n:"SlideCount",t:Ws},8:{n:"NoteCount",t:Ws},9:{n:"HiddenCount",t:Ws},10:{n:"MultimediaClipCount",t:Ws},11:{n:"ScaleCrop",t:fi},12:{n:"HeadingPairs",t:Iy},13:{n:"TitlesOfParts",t:Py},14:{n:"Manager",t:us},15:{n:"Company",t:us},16:{n:"LinksUpToDate",t:fi},17:{n:"CharacterCount",t:Ws},19:{n:"SharedDoc",t:fi},22:{n:"HyperlinksChanged",t:fi},23:{n:"AppVersion",t:Ws,p:"version"},24:{n:"DigSig",t:Ay},26:{n:"ContentType",t:us},27:{n:"ContentStatus",t:us},28:{n:"Language",t:us},29:{n:"Version",t:us},255:{},2147483648:{n:"Locale",t:Bi},2147483651:{n:"Behavior",t:Bi},1919054434:{}},cc={1:{n:"CodePage",t:Yc},2:{n:"Title",t:us},3:{n:"Subject",t:us},4:{n:"Author",t:us},5:{n:"Keywords",t:us},6:{n:"Comments",t:us},7:{n:"Template",t:us},8:{n:"LastAuthor",t:us},9:{n:"RevNumber",t:us},10:{n:"EditTime",t:xi},11:{n:"LastPrinted",t:xi},12:{n:"CreatedDate",t:xi},13:{n:"ModifiedDate",t:xi},14:{n:"PageCount",t:Ws},15:{n:"WordCount",t:Ws},16:{n:"CharCount",t:Ws},17:{n:"Thumbnail",t:Dy},18:{n:"Application",t:us},19:{n:"DocSecurity",t:Ws},255:{},2147483648:{n:"Locale",t:Bi},2147483651:{n:"Behavior",t:Bi},1919054434:{}},vm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Fy=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Oy(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Ly=Oy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ca=Ut(Ly),zr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Xu={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Kc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function My(e){var r=Kc();if(!e||!e.match)return r;var s={};if((e.match(Ds)||[]).forEach(function(a){var n=st(a);switch(n[0].replace(Yj,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":s[n.Extension]=n.ContentType;break;case"<Override":r[dc[n.ContentType]]!==void 0&&r[dc[n.ContentType]].push(n.PartName);break}}),r.xmlns!==cs.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=s,delete r.calcchains,r}function Ju(e,r){var s=Mj(dc),a=[],n;a[a.length]=ns,a[a.length]=Fe("Types",null,{xmlns:cs.CT,"xmlns:xsd":cs.xsd,"xmlns:xsi":cs.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Fe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Fe("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:pi[c][r.bookType]||pi[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:pi[c][r.bookType]||pi[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:s[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rn(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function vn(e,r){var s={"!id":{}};if(!e)return s;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Ds)||[]).forEach(function(n){var i=st(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:fn(i.Target,r);s[o]=l,a[i.Id]=l}}),s["!id"]=a,s}function $a(e){var r=[ns,Fe("Relationships",null,{xmlns:cs.RELS})];return es(e["!id"]).forEach(function(s){r[r.length]=Fe("Relationship",null,e["!id"][s])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function kt(e,r,s,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,n.Id="rId"+r,n.Type=a,n.Target=s,[ft.HLINK,ft.XPATH,ft.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}var By="application/vnd.oasis.opendocument.spreadsheet";function zy(e,r){for(var s=Bc(e),a,n;a=Pn.exec(s);)switch(a[3]){case"manifest":break;case"file-entry":if(n=st(a[0],!1),n.path=="/"&&n.type!==By)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function $y(e){var r=[ns];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var s=0;s<e.length;++s)r.push('  <manifest:file-entry manifest:full-path="'+e[s][0]+'" manifest:media-type="'+e[s][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function bm(e,r,s){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Uy(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Wy(e){var r=[ns];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var s=0;s!=e.length;++s)r.push(bm(e[s][0],e[s][1])),r.push(Uy("",e[s][0]));return r.push(bm("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Zu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Di.version+"</meta:generator></office:meta></office:document-meta>"}var or=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Hy=(function(){for(var e=new Array(or.length),r=0;r<or.length;++r){var s=or[r],a="(?:"+s[0].slice(0,s[0].indexOf(":"))+":)"+s[0].slice(s[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function Qu(e){var r={};e=Ft(e);for(var s=0;s<or.length;++s){var a=or[s],n=e.match(Hy[s]);n!=null&&n.length>0&&(r[a[1]]=jt(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=$t(r[a[1]]))}return r}function yl(e,r,s,a,n){n[e]!=null||r==null||r===""||(n[e]=r,r=At(r),a[a.length]=s?Fe(e,r,s):vs(e,r))}function eh(e,r){var s=r||{},a=[ns,Fe("cp:coreProperties",null,{"xmlns:cp":cs.CORE_PROPS,"xmlns:dc":cs.dc,"xmlns:dcterms":cs.dcterms,"xmlns:dcmitype":cs.dcmitype,"xmlns:xsi":cs.xsi})],n={};if(!e&&!s.Props)return a.join("");e&&(e.CreatedDate!=null&&yl("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ic(e.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&yl("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ic(e.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=or.length;++i){var l=or[i],o=s.Props&&s.Props[l[1]]!=null?s.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&yl(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var da=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],th=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sh(e,r,s,a){var n=[];if(typeof e=="string")n=cm(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(m){return{v:m}}));var l=typeof r=="string"?cm(r,a).map(function(m){return m.v}):r,o=0,c=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(c=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":s.Worksheets=c,s.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":s.NamedRanges=c,s.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":s.Chartsheets=c,s.ChartNames=l.slice(o,o+c);break}o+=c}}function Vy(e,r,s){var a={};return r||(r={}),e=Ft(e),da.forEach(function(n){var i=(e.match(Dn(n[0]))||[])[1];switch(n[2]){case"string":i&&(r[n[1]]=jt(i));break;case"bool":r[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&sh(a.HeadingPairs,a.TitlesOfParts,r,s),r}function rh(e){var r=[],s=Fe;return e||(e={}),e.Application="SheetJS",r[r.length]=ns,r[r.length]=Fe("Properties",null,{xmlns:cs.EXT_PROPS,"xmlns:vt":cs.vt}),da.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=At(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(r[r.length]=s(a[0],n))}}),r[r.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=s("TitlesOfParts",s("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+At(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Gy=/<[^>]+>[^<]*/g;function qy(e,r){var s={},a="",n=e.match(Gy);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=st(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=jt(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),d=c[0].slice(4),m=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":s[a]=jt(m);break;case"bool":s[a]=Mt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":s[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":s[a]=parseFloat(m);break;case"filetime":case"date":s[a]=$t(m);break;case"cy":case"error":s[a]=jt(m);break;default:if(d.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,c)}}else if(l.slice(0,2)!=="</"){if(r.WTF)throw new Error(l)}}}return s}function ah(e){var r=[ns,Fe("Properties",null,{xmlns:cs.CUST_PROPS,"xmlns:vt":cs.vt})];if(!e)return r.join("");var s=1;return es(e).forEach(function(n){++s,r[r.length]=Fe("property",sy(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:At(n)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var mc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nl;function Yy(e,r,s){Nl||(Nl=sl(mc)),r=Nl[r]||r,e[r]=s}function Ky(e,r){var s=[];return es(mc).map(function(a){for(var n=0;n<or.length;++n)if(or[n][1]==a)return or[n];for(n=0;n<da.length;++n)if(da[n][1]==a)return da[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),s.push(vs(mc[a[1]]||a[1],n))}}),Fe("DocumentProperties",s.join(""),{xmlns:Xs.o})}function Xy(e,r){var s=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&es(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<or.length;++l)if(i==or[l][1])return;for(l=0;l<da.length;++l)if(i==da[l][1])return;for(l=0;l<s.length;++l)if(i==s[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Fe(nm(i),o,{"dt:dt":c}))}}),r&&es(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=r[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Fe(nm(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+Xs.o+'">'+n.join("")+"</"+a+">"}function Xc(e){var r=e.read_shift(4),s=e.read_shift(4);return new Date((s/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Jy(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,s=r.getTime()/1e3+11644473600,a=s%Math.pow(2,32),n=(s-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=ye(8);return l.write_shift(4,a),l.write_shift(4,n),l}function nh(e,r,s){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(s)for(;e.l-a&3;)++e.l;return n}function ih(e,r,s){var a=e.read_shift(0,"lpwstr");return a}function lh(e,r,s){return r===31?ih(e):nh(e,r,s)}function uc(e,r,s){return lh(e,r,s===!1?0:4)}function Zy(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return lh(e,r,0)}function Qy(e){for(var r=e.read_shift(4),s=[],a=0;a!=r;++a){var n=e.l;s[a]=e.read_shift(0,"lpwstr").replace(zs,""),e.l-n&2&&(e.l+=2)}return s}function e2(e){for(var r=e.read_shift(4),s=[],a=0;a!=r;++a)s[a]=e.read_shift(0,"lpstr-cp").replace(zs,"");return s}function t2(e){var r=e.l,s=zi(e,Ku);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=zi(e,Ws);return[s,a]}function s2(e){for(var r=e.read_shift(4),s=[],a=0;a<r/2;++a)s.push(t2(e));return s}function jm(e,r){for(var s=e.read_shift(4),a={},n=0;n!=s;++n){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,r===1200?"utf16le":"utf8").replace(zs,"").replace(hn,"!"),r===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function oh(e){var r=e.read_shift(4),s=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),s}function r2(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function zi(e,r,s){var a=e.read_shift(2),n,i=s||{};if(e.l+=2,r!==gm&&a!==r&&Ry.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===gm?a:r){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return nh(e,a,4).replace(zs,"");case 31:return ih(e);case 64:return Xc(e);case 65:return oh(e);case 71:return r2(e);case 80:return uc(e,a,!i.raw).replace(zs,"");case 81:return Zy(e,a).replace(zs,"");case 4108:return s2(e);case 4126:case 4127:return a==4127?Qy(e):e2(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function ym(e,r){var s=ye(4),a=ye(4);switch(s.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,r);break;case 5:a=ye(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=Jy(r);break;case 31:case 80:for(a=ye(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return hs([s,a])}function Nm(e,r){var s=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,d={};for(l=0;l!=n;++l){var m=e.read_shift(4),u=e.read_shift(4);i[l]=[m,u+s]}i.sort(function(N,j){return N[1]-j[1]});var h={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var p=!0;if(l>0&&r)switch(r[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],p=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],p=!1);break}if((!r||l==0)&&e.l<=i[l][1]&&(p=!1,e.l=i[l][1]),p)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(r){var x=r[i[l][0]];if(h[x.n]=zi(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fr(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[l][0]===1){if(o=h.CodePage=zi(e,Yc),fr(o),c!==-1){var f=e.l;e.l=i[c][1],d=jm(e,o),e.l=f}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}d=jm(e,o)}else{var g=d[i[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=oh(e);break;case 30:e.l+=4,v=uc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=uc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=ss(e,4);break;case 64:e.l+=4,v=$t(Xc(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=s+a,h}var ch=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function a2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function wm(e,r,s){var a=ye(8),n=[],i=[],l=8,o=0,c=ye(8),d=ye(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),n.push(d),l+=8+c.length,!r){d=ye(8),d.write_shift(4,0),n.unshift(d);var m=[ye(4)];for(m[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for(c=ye(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);m.push(c)}c=hs(m),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(ch.indexOf(e[o][0])>-1||th.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(r){p=+r[e[o][0]];var x=s[p];if(x.p=="version"&&typeof h=="string"){var f=h.split(".");h=(+f[0]<<16)+(+f[1]||0)}c=ym(x.t,h)}else{var g=a2(h);g==-1&&(g=31,h=String(h)),c=ym(g,h)}i.push(c),d=ye(8),d.write_shift(4,r?p:2+o),n.push(d),l+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),hs([a].concat(n).concat(i))}function Sm(e,r,s){var a=e.content;if(!a)return{};gs(a,0);var n,i,l,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),m=a.read_shift(16);if(m!==Ye.utils.consts.HEADER_CLSID&&m!==s)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),c=a.read_shift(4));var u=Nm(a,r),h={SystemIdentifier:d};for(var p in u)h[p]=u[p];if(h.FMTID=i,n===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=Nm(a,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[i,l],h}function Tm(e,r,s,a,n,i){var l=ye(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,r,"hex"),l.write_shift(4,n?68:48);var c=wm(e,s,a);if(o.push(c),n){var d=wm(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(d)}return hs(o)}function Ur(e,r){return e.read_shift(r),null}function n2(e,r){r||(r=ye(e));for(var s=0;s<e;++s)r.write_shift(1,0);return r}function i2(e,r,s){for(var a=[],n=e.l+r;e.l<n;)a.push(s(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function ss(e,r){return e.read_shift(r)===1}function Fs(e,r){return r||(r=ye(2)),r.write_shift(2,+!!e),r}function os(e){return e.read_shift(2,"u")}function ir(e,r){return r||(r=ye(2)),r.write_shift(2,e),r}function dh(e,r){return i2(e,r,os)}function l2(e){var r=e.read_shift(1),s=e.read_shift(1);return s===1?r:r===1}function mh(e,r,s){return s||(s=ye(2)),s.write_shift(1,r=="e"?+e:+!!e),s.write_shift(1,r=="e"?1:0),s}function ei(e,r,s){var a=e.read_shift(s&&s.biff>=12?2:1),n="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else s.biff==12&&(n="wstr");s.biff>=2&&s.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function o2(e){var r=e.read_shift(2),s=e.read_shift(1),a=s&4,n=s&8,i=1+(s&1),l=0,o,c={};n&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",m=r===0?"":e.read_shift(r,d);return n&&(e.l+=4*l),a&&(e.l+=o),c.t=m,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function c2(e){var r=e.t||"",s=ye(3);s.write_shift(2,r.length),s.write_shift(1,1);var a=ye(2*r.length);a.write_shift(2*r.length,r,"utf16le");var n=[s,a];return hs(n)}function ja(e,r,s){var a;if(s){if(s.biff>=2&&s.biff<=5)return e.read_shift(r,"cpstr");if(s.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function ti(e,r,s){var a=e.read_shift(s&&s.biff==2?1:2);return a===0?(e.l++,""):ja(e,a,s)}function Aa(e,r,s){if(s.biff>5)return ti(e,r,s);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,s.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function uh(e,r,s){return s||(s=ye(3+2*e.length)),s.write_shift(2,e.length),s.write_shift(1,1),s.write_shift(31,e,"utf16le"),s}function d2(e){var r=e.read_shift(1);e.l++;var s=e.read_shift(2);return e.l+=2,[r,s]}function m2(e){var r=e.read_shift(4),s=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=s);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(zs,"");return a&&(e.l+=24),n}function u2(e){for(var r=e.read_shift(2),s="";r-- >0;)s+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return s+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(zs,"");return s+l}function h2(e,r){var s=e.read_shift(16);switch(s){case"e0c9ea79f9bace118c8200aa004ba90b":return m2(e);case"0303000000000000c000000000000046":return u2(e);default:throw new Error("Unsupported Moniker "+s)}}function gi(e){var r=e.read_shift(4),s=r>0?e.read_shift(r,"utf16le").replace(zs,""):"";return s}function Em(e,r){r||(r=ye(6+e.length*2)),r.write_shift(4,1+e.length);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function f2(e,r){var s=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,l,o,c,d="",m,u;n&16&&(i=gi(e,s-e.l)),n&128&&(l=gi(e,s-e.l)),(n&257)===257&&(o=gi(e,s-e.l)),(n&257)===1&&(c=h2(e,s-e.l)),n&8&&(d=gi(e,s-e.l)),n&32&&(m=e.read_shift(16)),n&64&&(u=Xc(e)),e.l=s;var h=l||o||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return m&&(p.guid=m),u&&(p.time=u),i&&(p.Tooltip=i),p}function x2(e){var r=ye(512),s=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(s=0;s<l.length;++s)r.write_shift(4,l[s]);if(i==28)a=a.slice(1),Em(a,r);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<l.length;++s)r.write_shift(1,parseInt(l[s],16));var o=n>-1?a.slice(0,n):a;for(r.write_shift(4,2*(o.length+1)),s=0;s<o.length;++s)r.write_shift(2,o.charCodeAt(s));r.write_shift(2,0),i&8&&Em(n>-1?a.slice(n+1):"",r)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<l.length;++s)r.write_shift(1,parseInt(l[s],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,a.length-3*c+1),s=0;s<a.length-3*c;++s)r.write_shift(1,a.charCodeAt(s+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),s=0;s<6;++s)r.write_shift(4,0)}return r.slice(0,r.l)}function hh(e){var r=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,s,a,n]}function fh(e,r){var s=hh(e);return s[3]=0,s}function kr(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return{r,c:s,ixfe:a}}function ya(e,r,s,a){return a||(a=ye(6)),a.write_shift(2,e),a.write_shift(2,r),a.write_shift(2,s||0),a}function p2(e){var r=e.read_shift(2),s=e.read_shift(2);return e.l+=8,{type:r,flags:s}}function g2(e,r,s){return r===0?"":Aa(e,r,s)}function v2(e,r,s){var a=s.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,i,l]}function xh(e){var r=e.read_shift(2),s=qc(e);return[r,s]}function b2(e,r,s){e.l+=4,r-=4;var a=e.l+r,n=ei(e,r,s),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function nl(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:s}}}function ph(e,r){return r||(r=ye(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function gh(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:s}}}var j2=gh;function vh(e){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[s,r,a]}function y2(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function N2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function ys(e){e.l+=2,e.l+=e.read_shift(2)}var w2={0:ys,4:ys,5:ys,6:ys,7:N2,8:ys,9:ys,10:ys,11:ys,12:ys,13:y2,14:ys,15:ys,16:ys,17:ys,18:ys,19:ys,20:ys,21:vh};function S2(e,r){for(var s=e.l+r,a=[];e.l<s;){var n=e.read_shift(2);e.l-=2;try{a.push(w2[n](e,s-e.l))}catch{return e.l=s,a}}return e.l!=s&&(e.l=s),a}function vi(e,r){var s={BIFFVer:0,dt:0};switch(s.BIFFVer=e.read_shift(2),r-=2,r>=2&&(s.dt=e.read_shift(2),e.l-=2),s.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+s.BIFFVer)}return e.read_shift(r),s}function Jc(e,r,s){var a=1536,n=16;switch(s.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ye(n);return i.write_shift(2,a),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function T2(e,r){return r===0||e.read_shift(2),1200}function E2(e,r,s){if(s.enc)return e.l+=r,"";var a=e.l,n=Aa(e,0,s);return e.read_shift(r+a-e.l),n}function C2(e,r){var s=!r||r.biff==8,a=ye(s?112:54);for(a.write_shift(r.biff==8?2:1,7),s&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(s?0:536870912));a.l<a.length;)a.write_shift(1,s?0:32);return a}function _2(e,r,s){var a=s&&s.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function k2(e,r,s){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=ei(e,0,s);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function A2(e,r){var s=!r||r.biff>=8?2:1,a=ye(8+s*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(s*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function D2(e,r){for(var s=e.l+r,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<s;++l)i.push(o2(e));return i.Count=a,i.Unique=n,i}function I2(e,r){var s=ye(8);s.write_shift(4,e.Count),s.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=c2(e[n]);var i=hs([s].concat(a));return i.parts=[s.length].concat(a.map(function(l){return l.length})),i}function P2(e,r){var s={};return s.dsst=e.read_shift(2),e.l+=r-2,s}function R2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var s=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=s/20),r}function F2(e){var r=p2(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var s=e.read_shift(4);return s!==0}function O2(e){return e.read_shift(2),e.read_shift(4)}function Cm(e,r,s){var a=0;s&&s.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);s&&s.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function L2(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[r,s],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:d}}function M2(){var e=ye(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function B2(e,r,s){if(s&&s.biff>=2&&s.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function z2(e){var r=ye(18),s=1718;return e&&e.RTL&&(s|=64),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function $2(){}function U2(e,r,s){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(s&&s.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ei(e,0,s),a}function W2(e,r){var s=e.name||"Arial",a=r&&r.biff==5,n=a?15+s.length:16+2*s.length,i=ye(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,s.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*s.length,s,a?"sbcs":"utf16le"),i}function H2(e){var r=kr(e);return r.isst=e.read_shift(4),r}function V2(e,r,s,a){var n=ye(10);return ya(e,r,a,n),n.write_shift(4,s),n}function G2(e,r,s){s.biffguess&&s.biff==2&&(s.biff=5);var a=e.l+r,n=kr(e);s.biff==2&&e.l++;var i=ti(e,a-e.l,s);return n.val=i,n}function q2(e,r,s,a,n){var i=!n||n.biff==8,l=ye(8+ +i+(1+i)*s.length);return ya(e,r,a,l),l.write_shift(2,s.length),i&&l.write_shift(1,1),l.write_shift((1+i)*s.length,s,i?"utf16le":"sbcs"),l}function Y2(e,r,s){var a=e.read_shift(2),n=Aa(e,0,s);return[a,n]}function K2(e,r,s,a){var n=s&&s.biff==5;a||(a=ye(n?3+r.length:5+2*r.length)),a.write_shift(2,e),a.write_shift(n?1:2,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var X2=Aa;function _m(e,r,s){var a=e.l+r,n=s.biff==8||!s.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:l,c}}}function J2(e,r){var s=r.biff==8||!r.biff?4:2,a=ye(2*s+6);return a.write_shift(s,e.s.r),a.write_shift(s,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Z2(e){var r=e.read_shift(2),s=e.read_shift(2),a=xh(e);return{r,c:s,ixfe:a[0],rknum:a[1]}}function Q2(e,r){for(var s=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<s;)i.push(xh(e));if(e.l!==s)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function eN(e,r){for(var s=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<s;)i.push(e.read_shift(2));if(e.l!==s)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function tN(e,r,s,a){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=Fy[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function sN(e,r,s){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=tN(e,r,a.fStyle,s),a}function km(e,r,s,a){var n=s&&s.biff==5;a||(a=ye(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function rN(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function aN(e){var r=ye(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Am(e,r,s){var a=kr(e);(s.biff==2||r==9)&&++e.l;var n=l2(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function nN(e,r,s,a,n,i){var l=ye(8);return ya(e,r,a,l),mh(s,i,l),l}function iN(e,r,s){s.biffguess&&s.biff==2&&(s.biff=5);var a=kr(e),n=Cs(e);return a.val=n,a}function lN(e,r,s,a){var n=ye(14);return ya(e,r,a,n),ba(s,n),n}var Dm=g2;function oN(e,r,s){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(2);if(s.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=ja(e,i),o=[];a>e.l;)o.push(ti(e));return[i,n,l,o]}function Im(e,r,s){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return s.sbcch===14849&&(n=b2(e,r-2,s)),i.body=n||e.read_shift(r-2),typeof n=="string"&&(i.Name=n),i}var cN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Pm(e,r,s){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(s&&s.biff==2?1:2),c=0;(!s||s.biff>=5)&&(s.biff!=5&&(e.l+=2),c=e.read_shift(2),s.biff==5&&(e.l+=2),e.l+=4);var d=ja(e,l,s);n&32&&(d=cN[d.charCodeAt(0)]);var m=a-e.l;s&&s.biff==2&&--m;var u=a==e.l||o===0||!(m>0)?[]:SE(e,m,s,o);return{chKey:i,Name:d,itab:c,rgce:u}}function bh(e,r,s){if(s.biff<8)return dN(e,r,s);for(var a=[],n=e.l+r,i=e.read_shift(s.biff>8?4:2);i--!==0;)a.push(v2(e,s.biff>8?12:6,s));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function dN(e,r,s){e[e.l+1]==3&&e[e.l]++;var a=ei(e,r,s);return a.charCodeAt(0)==3?a.slice(1):a}function mN(e,r,s){if(s.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),i=ja(e,a,s),l=ja(e,n,s);return[i,l]}function uN(e,r,s){var a=gh(e);e.l++;var n=e.read_shift(1);return r-=8,[TE(e,r,s),n,a]}function Rm(e,r,s){var a=j2(e);switch(s.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,NE(e,r,s)]}function hN(e){var r=e.read_shift(4)!==0,s=e.read_shift(4)!==0,a=e.read_shift(4);return[r,s,a]}function fN(e,r,s){if(!(s.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=Aa(e,0,s);return s.biff<8&&e.read_shift(1),[{r:a,c:n},o,l,i]}}function xN(e,r,s){return fN(e,r,s)}function pN(e,r){for(var s=[],a=e.read_shift(2);a--;)s.push(nl(e));return s}function gN(e){var r=ye(2+e.length*8);r.write_shift(2,e.length);for(var s=0;s<e.length;++s)ph(e[s],r);return r}function vN(e,r,s){if(s&&s.biff<8)return jN(e,r,s);var a=vh(e),n=S2(e,r-22,a[1]);return{cmo:a,ft:n}}var bN={8:function(e,r){var s=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=s,{fmt:a}}};function jN(e,r,s){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var l=[];return l.push((bN[a]||As)(e,r,s)),{cmo:[n,a,i],ft:l}}function yN(e,r,s){var a=e.l,n="";try{e.l+=4;var i=(s.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=d2(e,6,s);var o=e.read_shift(2);e.read_shift(2),os(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var m=e[e.l],u=ja(e,e.lens[d+1]-e.lens[d]-1);if(n+=u,n.length>=(m?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function NN(e,r){var s=nl(e);e.l+=16;var a=f2(e,r-24);return[s,a]}function wN(e){var r=ye(24),s=Kt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(a[n],16));return hs([r,x2(e[1])])}function SN(e,r){e.read_shift(2);var s=nl(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(zs,""),[s,a]}function TN(e){var r=e[1].Tooltip,s=ye(10+2*(r.length+1));s.write_shift(2,2048);var a=Kt(e[0]);s.write_shift(2,a.r),s.write_shift(2,a.r),s.write_shift(2,a.c),s.write_shift(2,a.c);for(var n=0;n<r.length;++n)s.write_shift(2,r.charCodeAt(n));return s.write_shift(2,0),s}function EN(e){var r=[0,0],s;return s=e.read_shift(2),r[0]=vm[s]||s,s=e.read_shift(2),r[1]=vm[s]||s,r}function CN(e){return e||(e=ye(4)),e.write_shift(2,1),e.write_shift(2,1),e}function _N(e){for(var r=e.read_shift(2),s=[];r-- >0;)s.push(fh(e));return s}function kN(e){for(var r=e.read_shift(2),s=[];r-- >0;)s.push(fh(e));return s}function AN(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function jh(e,r,s){if(!s.cellStyles)return As(e,r);var a=s&&s.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s:n,e:i,w:l,ixfe:o,flags:c};return(s.biff>=5||!s.biff)&&(d.level=c>>8&7),d}function DN(e,r){var s=ye(12);s.write_shift(2,r),s.write_shift(2,r),s.write_shift(2,e.width*256),s.write_shift(2,0);var a=0;return e.hidden&&(a|=1),s.write_shift(1,a),a=e.level||0,s.write_shift(1,a),s.write_shift(2,0),s}function IN(e,r){var s={};return r<32||(e.l+=16,s.header=Cs(e),s.footer=Cs(e),e.l+=2),s}function PN(e,r,s){var a={area:!1};if(s.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function RN(e){for(var r=ye(2*e),s=0;s<e;++s)r.write_shift(2,s+1);return r}var FN=kr,ON=dh,LN=ti;function MN(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:s,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function BN(e,r,s){s.biffguess&&s.biff==5&&(s.biff=2);var a=kr(e);++e.l;var n=Aa(e,r-7,s);return a.t="str",a.val=n,a}function zN(e){var r=kr(e);++e.l;var s=Cs(e);return r.t="n",r.val=s,r}function $N(e,r,s){var a=ye(15);return ni(a,e,r),a.write_shift(8,s,"f"),a}function UN(e){var r=kr(e);++e.l;var s=e.read_shift(2);return r.t="n",r.val=s,r}function WN(e,r,s){var a=ye(9);return ni(a,e,r),a.write_shift(2,s),a}function HN(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function VN(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function GN(e,r,s){var a=e.l+r,n=kr(e),i=e.read_shift(2),l=ja(e,i,s);return e.l=a,n.t="str",n.val=l,n}var qN=[2,3,48,49,131,139,140,245],hc=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=sl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(o,c){var d=[],m=Yr(1);switch(c.type){case"base64":m=Zs(er(o));break;case"binary":m=Zs(o);break;case"buffer":case"array":m=o;break}gs(m,0);var u=m.read_shift(1),h=!!(u&136),p=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var f=0,g=521;u==2&&(f=m.read_shift(2)),m.l+=3,u!=2&&(f=m.read_shift(4)),f>1048576&&(f=1e6),u!=2&&(g=m.read_shift(2));var v=m.read_shift(2),N=c.codepage||1252;u!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(N=e[m[m.l]]),m.l+=1,m.l+=2),x&&(m.l+=36);for(var j=[],S={},C=Math.min(m.length,u==2?521:g-10-(p?264:0)),w=x?32:11;m.l<C&&m[m.l]!=13;)switch(S={},S.name=_n.utils.decode(N,m.slice(m.l,m.l+w)).replace(/[\u0000\r\n].*$/g,""),m.l+=w,S.type=String.fromCharCode(m.read_shift(1)),u!=2&&!x&&(S.offset=m.read_shift(4)),S.len=m.read_shift(1),u==2&&(S.offset=m.read_shift(2)),S.dec=m.read_shift(1),S.name.length&&j.push(S),u!=2&&(m.l+=x?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(m[m.l]!==13&&(m.l=g-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=g;var y=0,T=0;for(d[0]=[],T=0;T!=j.length;++T)d[0][T]=j[T].name;for(;f-- >0;){if(m[m.l]===42){m.l+=v;continue}for(++m.l,d[++y]=[],T=0,T=0;T!=j.length;++T){var k=m.slice(m.l,m.l+j[T].len);m.l+=j[T].len,gs(k,0);var P=_n.utils.decode(N,k);switch(j[T].type){case"C":P.trim().length&&(d[y][T]=P.replace(/\s+$/,""));break;case"D":P.length===8?d[y][T]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):d[y][T]=P;break;case"F":d[y][T]=parseFloat(P.trim());break;case"+":case"I":d[y][T]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":d[y][T]=!0;break;case"N":case"F":d[y][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));d[y][T]="##MEMO##"+(x?parseInt(P.trim(),10):k.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(d[y][T]=+P||0);break;case"@":d[y][T]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[y][T]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[y][T]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[y][T]=-k.read_shift(-8,"f");break;case"B":if(p&&j[T].len==8){d[y][T]=k.read_shift(8,"f");break}case"G":case"P":k.l+=j[T].len;break;case"0":if(j[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[T].type)}}}if(u!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=j,d}function a(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var m=tn(s(o,d),d);return m["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,m}function n(o,c){try{return ea(a(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var d=c||{};if(+d.codepage>=0&&fr(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=qs(),u=Wi(o,{header:1,raw:!0,cellDates:!0}),h=u[0],p=u.slice(1),x=o["!cols"]||[],f=0,g=0,v=0,N=1;for(f=0;f<h.length;++f){if(((x[f]||{}).DBF||{}).name){h[f]=x[f].DBF.name,++v;continue}if(h[f]!=null){if(++v,typeof h[f]=="number"&&(h[f]=h[f].toString(10)),typeof h[f]!="string")throw new Error("DBF Invalid column name "+h[f]+" |"+typeof h[f]+"|");if(h.indexOf(h[f])!==f){for(g=0;g<1024;++g)if(h.indexOf(h[f]+"_"+g)==-1){h[f]+="_"+g;break}}}}var j=yt(o["!ref"]),S=[],C=[],w=[];for(f=0;f<=j.e.c-j.s.c;++f){var y="",T="",k=0,P=[];for(g=0;g<p.length;++g)p[g][f]!=null&&P.push(p[g][f]);if(P.length==0||h[f]==null){S[f]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=P[g]instanceof Date?"D":"C";break;default:T="C"}k=Math.max(k,String(P[g]).length),y=y&&y!=T?"C":T}k>250&&(k=250),T=((x[f]||{}).DBF||{}).type,T=="C"&&x[f].DBF.len>k&&(k=x[f].DBF.len),y=="B"&&T=="N"&&(y="N",w[f]=x[f].DBF.dec,k=x[f].DBF.len),C[f]=y=="C"||T=="N"?k:i[y]||0,N+=C[f],S[f]=y}var A=m.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*v),A.write_shift(2,N),f=0;f<4;++f)A.write_shift(4,0);for(A.write_shift(4,0|(+r[cu]||3)<<8),f=0,g=0;f<h.length;++f)if(h[f]!=null){var _=m.next(32),U=(h[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,U,"sbcs"),_.write_shift(1,S[f]=="?"?"C":S[f],"sbcs"),_.write_shift(4,g),_.write_shift(1,C[f]||i[S[f]]||0),_.write_shift(1,w[f]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),g+=C[f]||i[S[f]]||0}var D=m.next(264);for(D.write_shift(4,13),f=0;f<65;++f)D.write_shift(4,0);for(f=0;f<p.length;++f){var W=m.next(N);for(W.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(S[g]){case"L":W.write_shift(1,p[f][g]==null?63:p[f][g]?84:70);break;case"B":W.write_shift(8,p[f][g]||0,"f");break;case"N":var q="0";for(typeof p[f][g]=="number"&&(q=p[f][g].toFixed(w[g]||0)),v=0;v<C[g]-q.length;++v)W.write_shift(1,32);W.write_shift(1,q,"sbcs");break;case"D":p[f][g]?(W.write_shift(4,("0000"+p[f][g].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(p[f][g].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+p[f][g].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(p[f][g]!=null?p[f][g]:"").slice(0,C[g]);for(W.write_shift(1,Y,"sbcs"),v=0;v<C[g]-Y.length;++v)W.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),yh=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+es(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(h,p){var x=e[p];return typeof x=="number"?Vd(x):x},a=function(h,p,x){var f=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return f==59?h:Vd(f)};e["|"]=254;function n(h,p){switch(p.type){case"base64":return i(er(h),p);case"binary":return i(h,p);case"buffer":return i(ut&&Buffer.isBuffer(h)?h.toString("binary"):Qr(h),p);case"array":return i(va(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var x=h.split(/[\n\r]+/),f=-1,g=-1,v=0,N=0,j=[],S=[],C=null,w={},y=[],T=[],k=[],P=0,A;for(+p.codepage>=0&&fr(+p.codepage);v!==x.length;++v){P=0;var _=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,s),U=_.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),D=U[0],W;if(_.length>0)switch(D){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&S.push(_.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,Y=!1,K=!1,H=!1,je=-1,ie=-1;for(N=1;N<U.length;++N)switch(U[N].charAt(0)){case"A":break;case"X":g=parseInt(U[N].slice(1))-1,Y=!0;break;case"Y":for(f=parseInt(U[N].slice(1))-1,Y||(g=0),A=j.length;A<=f;++A)j[A]=[];break;case"K":W=U[N].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(pr(W))?isNaN(qa(W).getDate())||(W=$t(W)):(W=pr(W),C!==null&&Qa(C)&&(W=al(W))),q=!0;break;case"E":H=!0;var B=Ua(U[N].slice(1),{r:f,c:g});j[f][g]=[j[f][g],B];break;case"S":K=!0,j[f][g]=[j[f][g],"S5S"];break;case"G":break;case"R":je=parseInt(U[N].slice(1))-1;break;case"C":ie=parseInt(U[N].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+_)}if(q&&(j[f][g]&&j[f][g].length==2?j[f][g][0]=W:j[f][g]=W,C=null),K){if(H)throw new Error("SYLK shared formula cannot have own formula");var V=je>-1&&j[je][ie];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");j[f][g][1]=Bh(V[1],{r:f-je,c:g-ie})}break;case"F":var z=0;for(N=1;N<U.length;++N)switch(U[N].charAt(0)){case"X":g=parseInt(U[N].slice(1))-1,++z;break;case"Y":for(f=parseInt(U[N].slice(1))-1,A=j.length;A<=f;++A)j[A]=[];break;case"M":P=parseInt(U[N].slice(1))/20;break;case"F":break;case"G":break;case"P":C=S[parseInt(U[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=U[N].slice(1).split(" "),A=parseInt(k[0],10);A<=parseInt(k[1],10);++A)P=parseInt(k[2],10),T[A-1]=P===0?{hidden:!0}:{wch:P},Kr(T[A-1]);break;case"C":g=parseInt(U[N].slice(1))-1,T[g]||(T[g]={});break;case"R":f=parseInt(U[N].slice(1))-1,y[f]||(y[f]={}),P>0?(y[f].hpt=P,y[f].hpx=Ka(P)):P===0&&(y[f].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+_)}z<1&&(C=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+_)}}return y.length>0&&(w["!rows"]=y),T.length>0&&(w["!cols"]=T),p&&p.sheetRows&&(j=j.slice(0,p.sheetRows)),[j,w]}function l(h,p){var x=n(h,p),f=x[0],g=x[1],v=tn(f,p);return es(g).forEach(function(N){v[N]=g[N]}),v}function o(h,p){return ea(l(h,p),p)}function c(h,p,x,f){var g="C;Y"+(x+1)+";X"+(f+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+rd(h.f,{r:x,c:f}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,p){p.forEach(function(x,f){var g="F;W"+(f+1)+" "+(f+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=On(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Ln(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function m(h,p){p.forEach(function(x,f){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Mn(x.hpx)+";"),g.length>2&&h.push(g+"R"+(f+1))})}function u(h,p){var x=["ID;PWXL;N;E"],f=[],g=yt(h["!ref"]),v,N=Array.isArray(h),j=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&m(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var C=g.s.c;C<=g.e.c;++C){var w=Qe({r:S,c:C});v=N?(h[S]||[])[C]:h[w],!(!v||v.v==null&&(!v.f||v.F))&&f.push(c(v,h,S,C))}return x.join(j)+j+f.join(j)+j+"E"+j}return{to_workbook:o,to_sheet:l,from_sheet:u}})(),Nh=(function(){function e(i,l){switch(l.type){case"base64":return r(er(i),l);case"binary":return r(i,l);case"buffer":return r(ut&&Buffer.isBuffer(i)?i.toString("binary"):Qr(i),l);case"array":return r(va(i),l)}throw new Error("Unrecognized type "+l.type)}function r(i,l){for(var o=i.split(`
`),c=-1,d=-1,m=0,u=[];m!==o.length;++m){if(o[m].trim()==="BOT"){u[++c]=[],d=0;continue}if(!(c<0)){var h=o[m].trim().split(","),p=h[0],x=h[1];++m;for(var f=o[m]||"";(f.match(/["]/g)||[]).length&1&&m<o.length-1;)f+=`
`+o[++m];switch(f=f.trim(),+p){case-1:if(f==="BOT"){u[++c]=[],d=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:f==="TRUE"?u[c][d]=!0:f==="FALSE"?u[c][d]=!1:isNaN(pr(x))?isNaN(qa(x).getDate())?u[c][d]=x:u[c][d]=$t(x):u[c][d]=pr(x),++d;break;case 1:f=f.slice(1,f.length-1),f=f.replace(/""/g,'"'),f&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),u[c][d++]=f!==""?f:null;break}if(f==="EOD")break}}return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),u}function s(i,l){return tn(e(i,l),l)}function a(i,l){return ea(s(i,l),l)}var n=(function(){var i=function(c,d,m,u,h){c.push(d),c.push(m+","+u),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,d,m,u){c.push(d+","+m),c.push(d==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var d=[],m=yt(c["!ref"]),u,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,m.e.r-m.s.r+1,""),i(d,"TUPLES",0,m.e.c-m.s.c+1,""),i(d,"DATA",0,0,"");for(var p=m.s.r;p<=m.e.r;++p){l(d,-1,0,"BOT");for(var x=m.s.c;x<=m.e.c;++x){var f=Qe({r:p,c:x});if(u=h?(c[p]||[])[x]:c[f],!u){l(d,1,0,"");continue}switch(u.t){case"n":var g=u.w;!g&&u.v!=null&&(g=u.v),g==null?u.f&&!u.F?l(d,1,0,"="+u.f):l(d,1,0,""):l(d,0,g,"V");break;case"b":l(d,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=dr(u.z||Je[14],ms($t(u.v)))),l(d,0,u.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var v=`\r
`,N=d.join(v);return N}})();return{to_workbook:a,to_sheet:s,from_sheet:n}})(),wh=(function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(u,h){for(var p=u.split(`
`),x=-1,f=-1,g=0,v=[];g!==p.length;++g){var N=p[g].trim().split(":");if(N[0]==="cell"){var j=Kt(N[1]);if(v.length<=j.r)for(x=v.length;x<=j.r;++x)v[x]||(v[x]=[]);switch(x=j.r,f=j.c,N[2]){case"t":v[x][f]=e(N[3]);break;case"v":v[x][f]=+N[3];break;case"vtf":var S=N[N.length-1];case"vtc":switch(N[3]){case"nl":v[x][f]=!!+N[4];break;default:v[x][f]=+N[4];break}N[2]=="vtf"&&(v[x][f]=[v[x][f],S])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function a(u,h){return tn(s(u,h),h)}function n(u,h){return ea(a(u,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(u){if(!u||!u["!ref"])return"";for(var h=[],p=[],x,f="",g=Ys(u["!ref"]),v=Array.isArray(u),N=g.s.r;N<=g.e.r;++N)for(var j=g.s.c;j<=g.e.c;++j)if(f=Qe({r:N,c:j}),x=v?(u[N]||[])[j]:u[f],!(!x||x.v==null||x.t==="z")){switch(p=["cell",f,"t"],x.t){case"s":case"str":p.push(r(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=r(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=ms($t(x.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=x.w||dr(x.z||Je[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function m(u){return[i,l,o,l,d(u),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}})(),Ya=(function(){function e(m,u,h,p,x){x.raw?u[h][p]=m:m===""||(m==="TRUE"?u[h][p]=!0:m==="FALSE"?u[h][p]=!1:isNaN(pr(m))?isNaN(qa(m).getDate())?u[h][p]=m:u[h][p]=$t(m):u[h][p]=pr(m))}function r(m,u){var h=u||{},p=[];if(!m||m.length===0)return p;for(var x=m.split(/[\r\n]/),f=x.length-1;f>=0&&x[f].length===0;)--f;for(var g=10,v=0,N=0;N<=f;++N)v=x[N].indexOf(" "),v==-1?v=x[N].length:v++,g=Math.max(g,v);for(N=0;N<=f;++N){p[N]=[];var j=0;for(e(x[N].slice(0,g).trim(),p,N,j,h),j=1;j<=(x[N].length-g)/10+1;++j)e(x[N].slice(g+(j-1)*10,g+j*10).trim(),p,N,j,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var s={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var u={},h=!1,p=0,x=0;p<m.length;++p)(x=m.charCodeAt(p))==34?h=!h:!h&&x in s&&(u[x]=(u[x]||0)+1);x=[];for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&x.push([u[p],p]);if(!x.length){u=a;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&x.push([u[p],p])}return x.sort(function(f,g){return f[0]-g[0]||a[f[1]]-a[g[1]]}),s[x.pop()[1]]||44}function i(m,u){var h=u||{},p="",x=h.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(p=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(p=m.charAt(4),m=m.slice(6)):p=n(m.slice(0,1024)):h&&h.FS?p=h.FS:p=n(m.slice(0,1024));var g=0,v=0,N=0,j=0,S=0,C=p.charCodeAt(0),w=!1,y=0,T=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var k=h.dateNF!=null?Pj(h.dateNF):null;function P(){var A=m.slice(j,S),_={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)_.t="z";else if(h.raw)_.t="s",_.v=A;else if(A.trim().length===0)_.t="s",_.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(_.t="s",_.v=A.slice(2,-1).replace(/""/g,'"')):oT(A)?(_.t="n",_.f=A.slice(1)):(_.t="s",_.v=A);else if(A=="TRUE")_.t="b",_.v=!0;else if(A=="FALSE")_.t="b",_.v=!1;else if(!isNaN(N=pr(A)))_.t="n",h.cellText!==!1&&(_.w=A),_.v=N;else if(!isNaN(qa(A).getDate())||k&&A.match(k)){_.z=h.dateNF||Je[14];var U=0;k&&A.match(k)&&(A=Rj(A,h.dateNF,A.match(k)||[]),U=1),h.cellDates?(_.t="d",_.v=$t(A,U)):(_.t="n",_.v=ms($t(A,U))),h.cellText!==!1&&(_.w=dr(_.z,_.v instanceof Date?ms(_.v):_.v)),h.cellNF||delete _.z}else _.t="s",_.v=A;if(_.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][v]=_):x[Qe({c:v,r:g})]=_),j=S+1,T=m.charCodeAt(j),f.e.c<v&&(f.e.c=v),f.e.r<g&&(f.e.r=g),y==C)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;S<m.length;++S)switch(y=m.charCodeAt(S)){case 34:T===34&&(w=!w);break;case C:case 10:case 13:if(!w&&P())break e;break}return S-j>0&&P(),x["!ref"]=dt(f),x}function l(m,u){return!(u&&u.PRN)||u.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,u):tn(r(m,u),u)}function o(m,u){var h="",p=u.type=="string"?[0,0,0,0]:md(m,u);switch(u.type){case"base64":h=er(m);break;case"binary":h=m;break;case"buffer":u.codepage==65001?h=m.toString("utf8"):u.codepage&&typeof _n<"u"||(h=ut&&Buffer.isBuffer(m)?m.toString("binary"):Qr(m));break;case"array":h=va(m);break;case"string":h=m;break;default:throw new Error("Unrecognized type "+u.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Ft(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=Ft(h):u.type=="binary"&&typeof _n<"u",h.slice(0,19)=="socialcalc:version:"?wh.to_sheet(u.type=="string"?h:Ft(h),u):l(h,u)}function c(m,u){return ea(o(m,u),u)}function d(m){for(var u=[],h=yt(m["!ref"]),p,x=Array.isArray(m),f=h.s.r;f<=h.e.r;++f){for(var g=[],v=h.s.c;v<=h.e.c;++v){var N=Qe({r:f,c:v});if(p=x?(m[f]||[])[v]:m[N],!p||p.v==null){g.push("          ");continue}for(var j=(p.w||(Lr(p),p.w)||"").slice(0,10);j.length<10;)j+=" ";g.push(j+(v===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}})();function YN(e,r){var s=r||{},a=!!s.WTF;s.WTF=!0;try{var n=yh.to_workbook(e,s);return s.WTF=a,n}catch(i){if(s.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Ya.to_workbook(e,r)}}var ma=(function(){function e(B,V,z){if(B){gs(B,B.l||0);for(var L=z.Enum||je;B.l<B.length;){var te=B.read_shift(2),ne=L[te]||L[65535],ue=B.read_shift(2),Ne=B.l+ue,ae=ne.f&&ne.f(B,ue,z);if(B.l=Ne,V(ae,ne,te))return}}}function r(B,V){switch(V.type){case"base64":return s(Zs(er(B)),V);case"binary":return s(Zs(B),V);case"buffer":case"array":return s(B,V)}throw"Unsupported type "+V.type}function s(B,V){if(!B)return B;var z=V||{},L=z.dense?[]:{},te="Sheet1",ne="",ue=0,Ne={},ae=[],re=[],M={s:{r:0,c:0},e:{r:0,c:0}},_e=z.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)z.Enum=je,e(B,function(Se,Me,Ve){switch(Ve){case 0:z.vers=Se,Se>=4096&&(z.qpro=!0);break;case 6:M=Se;break;case 204:Se&&(ne=Se);break;case 222:ne=Se;break;case 15:case 51:z.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:Ve==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=z.dateNF||Je[14],z.cellDates&&(Se[1].t="d",Se[1].v=al(Se[1].v))),z.qpro&&Se[3]>ue&&(L["!ref"]=dt(M),Ne[te]=L,ae.push(te),L=z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},ue=Se[3],te=ne||"Sheet"+(ue+1),ne="");var Ue=z.dense?(L[Se[0].r]||[])[Se[0].c]:L[Qe(Se[0])];if(Ue){Ue.t=Se[1].t,Ue.v=Se[1].v,Se[1].z!=null&&(Ue.z=Se[1].z),Se[1].f!=null&&(Ue.f=Se[1].f);break}z.dense?(L[Se[0].r]||(L[Se[0].r]=[]),L[Se[0].r][Se[0].c]=Se[1]):L[Qe(Se[0])]=Se[1];break}},z);else if(B[2]==26||B[2]==14)z.Enum=ie,B[2]==14&&(z.qpro=!0,B.l=0),e(B,function(Se,Me,Ve){switch(Ve){case 204:te=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>ue&&(L["!ref"]=dt(M),Ne[te]=L,ae.push(te),L=z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},ue=Se[3],te="Sheet"+(ue+1)),_e>0&&Se[0].r>=_e)break;z.dense?(L[Se[0].r]||(L[Se[0].r]=[]),L[Se[0].r][Se[0].c]=Se[1]):L[Qe(Se[0])]=Se[1],M.e.c<Se[0].c&&(M.e.c=Se[0].c),M.e.r<Se[0].r&&(M.e.r=Se[0].r);break;case 27:Se[14e3]&&(re[Se[14e3][0]]=Se[14e3][1]);break;case 1537:re[Se[0]]=Se[1],Se[0]==ue&&(te=Se[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(L["!ref"]=dt(M),Ne[ne||te]=L,ae.push(ne||te),!re.length)return{SheetNames:ae,Sheets:Ne};for(var ke={},ze=[],ce=0;ce<re.length;++ce)Ne[ae[ce]]?(ze.push(re[ce]||ae[ce]),ke[re[ce]]=Ne[re[ce]]||Ne[ae[ce]]):(ze.push(re[ce]),ke[re[ce]]={"!ref":"A1"});return{SheetNames:ze,Sheets:ke}}function a(B,V){var z=V||{};if(+z.codepage>=0&&fr(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var L=qs(),te=yt(B["!ref"]),ne=Array.isArray(B),ue=[];Oe(L,0,i(1030)),Oe(L,6,c(te));for(var Ne=Math.min(te.e.r,8191),ae=te.s.r;ae<=Ne;++ae)for(var re=as(ae),M=te.s.c;M<=te.e.c;++M){ae===te.s.r&&(ue[M]=Yt(M));var _e=ue[M]+re,ke=ne?(B[ae]||[])[M]:B[_e];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?Oe(L,13,p(ae,M,ke.v)):Oe(L,14,f(ae,M,ke.v));else{var ze=Lr(ke);Oe(L,15,u(ae,M,ze.slice(0,239)))}}return Oe(L,1),L.end()}function n(B,V){var z=V||{};if(+z.codepage>=0&&fr(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var L=qs();Oe(L,0,l(B));for(var te=0,ne=0;te<B.SheetNames.length;++te)(B.Sheets[B.SheetNames[te]]||{})["!ref"]&&Oe(L,27,H(B.SheetNames[te],ne++));var ue=0;for(te=0;te<B.SheetNames.length;++te){var Ne=B.Sheets[B.SheetNames[te]];if(!(!Ne||!Ne["!ref"])){for(var ae=yt(Ne["!ref"]),re=Array.isArray(Ne),M=[],_e=Math.min(ae.e.r,8191),ke=ae.s.r;ke<=_e;++ke)for(var ze=as(ke),ce=ae.s.c;ce<=ae.e.c;++ce){ke===ae.s.r&&(M[ce]=Yt(ce));var Se=M[ce]+ze,Me=re?(Ne[ke]||[])[ce]:Ne[Se];if(!(!Me||Me.t=="z"))if(Me.t=="n")Oe(L,23,P(ke,ce,ue,Me.v));else{var Ve=Lr(Me);Oe(L,22,y(ke,ce,ue,Ve.slice(0,239)))}}++ue}}return Oe(L,1),L.end()}function i(B){var V=ye(2);return V.write_shift(2,B),V}function l(B){var V=ye(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var z=0,L=0,te=0,ne=0;ne<B.SheetNames.length;++ne){var ue=B.SheetNames[ne],Ne=B.Sheets[ue];if(!(!Ne||!Ne["!ref"])){++te;var ae=Ys(Ne["!ref"]);z<ae.e.r&&(z=ae.e.r),L<ae.e.c&&(L=ae.e.c)}}return z>8191&&(z=8191),V.write_shift(2,z),V.write_shift(1,te),V.write_shift(1,L),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(B,V,z){var L={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&z.qpro?(L.s.c=B.read_shift(1),B.l++,L.s.r=B.read_shift(2),L.e.c=B.read_shift(1),B.l++,L.e.r=B.read_shift(2),L):(L.s.c=B.read_shift(2),L.s.r=B.read_shift(2),V==12&&z.qpro&&(B.l+=2),L.e.c=B.read_shift(2),L.e.r=B.read_shift(2),V==12&&z.qpro&&(B.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(B){var V=ye(8);return V.write_shift(2,B.s.c),V.write_shift(2,B.s.r),V.write_shift(2,B.e.c),V.write_shift(2,B.e.r),V}function d(B,V,z){var L=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(L[0].c=B.read_shift(1),L[3]=B.read_shift(1),L[0].r=B.read_shift(2),B.l+=2):(L[2]=B.read_shift(1),L[0].c=B.read_shift(2),L[0].r=B.read_shift(2)),L}function m(B,V,z){var L=B.l+V,te=d(B,V,z);if(te[1].t="s",z.vers==20768){B.l++;var ne=B.read_shift(1);return te[1].v=B.read_shift(ne,"utf8"),te}return z.qpro&&B.l++,te[1].v=B.read_shift(L-B.l,"cstr"),te}function u(B,V,z){var L=ye(7+z.length);L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,B),L.write_shift(1,39);for(var te=0;te<L.length;++te){var ne=z.charCodeAt(te);L.write_shift(1,ne>=128?95:ne)}return L.write_shift(1,0),L}function h(B,V,z){var L=d(B,V,z);return L[1].v=B.read_shift(2,"i"),L}function p(B,V,z){var L=ye(7);return L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,B),L.write_shift(2,z,"i"),L}function x(B,V,z){var L=d(B,V,z);return L[1].v=B.read_shift(8,"f"),L}function f(B,V,z){var L=ye(13);return L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,B),L.write_shift(8,z,"f"),L}function g(B,V,z){var L=B.l+V,te=d(B,V,z);if(te[1].v=B.read_shift(8,"f"),z.qpro)B.l=L;else{var ne=B.read_shift(2);S(B.slice(B.l,B.l+ne),te),B.l+=ne}return te}function v(B,V,z){var L=V&32768;return V&=-32769,V=(L?B:0)+(V>=8192?V-16384:V),(L?"":"$")+(z?Yt(V):as(V))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(B,V){gs(B,0);for(var z=[],L=0,te="",ne="",ue="",Ne="";B.l<B.length;){var ae=B[B.l++];switch(ae){case 0:z.push(B.read_shift(8,"f"));break;case 1:ne=v(V[0].c,B.read_shift(2),!0),te=v(V[0].r,B.read_shift(2),!1),z.push(ne+te);break;case 2:{var re=v(V[0].c,B.read_shift(2),!0),M=v(V[0].r,B.read_shift(2),!1);ne=v(V[0].c,B.read_shift(2),!0),te=v(V[0].r,B.read_shift(2),!1),z.push(re+M+":"+ne+te)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(B.read_shift(2));break;case 6:{for(var _e="";ae=B[B.l++];)_e+=String.fromCharCode(ae);z.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Ne=z.pop(),ue=z.pop(),z.push(["AND","OR"][ae-20]+"("+ue+","+Ne+")");break;default:if(ae<32&&j[ae])Ne=z.pop(),ue=z.pop(),z.push(ue+j[ae]+Ne);else if(N[ae]){if(L=N[ae][1],L==69&&(L=B[B.l++]),L>z.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+z.join("|")+"|");return}var ke=z.slice(-L);z.length-=L,z.push(N[ae][0]+"("+ke.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}z.length==1?V[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function C(B){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=B.read_shift(2),V[3]=B[B.l++],V[0].c=B[B.l++],V}function w(B,V){var z=C(B);return z[1].t="s",z[1].v=B.read_shift(V-4,"cstr"),z}function y(B,V,z,L){var te=ye(6+L.length);te.write_shift(2,B),te.write_shift(1,z),te.write_shift(1,V),te.write_shift(1,39);for(var ne=0;ne<L.length;++ne){var ue=L.charCodeAt(ne);te.write_shift(1,ue>=128?95:ue)}return te.write_shift(1,0),te}function T(B,V){var z=C(B);z[1].v=B.read_shift(2);var L=z[1].v>>1;if(z[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return z[1].v=L,z}function k(B,V){var z=C(B),L=B.read_shift(4),te=B.read_shift(4),ne=B.read_shift(2);if(ne==65535)return L===0&&te===3221225472?(z[1].t="e",z[1].v=15):L===0&&te===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var ue=ne&32768;return ne=(ne&32767)-16446,z[1].v=(1-ue*2)*(te*Math.pow(2,ne+32)+L*Math.pow(2,ne)),z}function P(B,V,z,L){var te=ye(14);if(te.write_shift(2,B),te.write_shift(1,z),te.write_shift(1,V),L==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ne=0,ue=0,Ne=0,ae=0;return L<0&&(ne=1,L=-L),ue=Math.log2(L)|0,L/=Math.pow(2,ue-31),ae=L>>>0,(ae&2147483648)==0&&(L/=2,++ue,ae=L>>>0),L-=ae,ae|=2147483648,ae>>>=0,L*=Math.pow(2,32),Ne=L>>>0,te.write_shift(4,Ne),te.write_shift(4,ae),ue+=16383+(ne?32768:0),te.write_shift(2,ue),te}function A(B,V){var z=k(B);return B.l+=V-14,z}function _(B,V){var z=C(B),L=B.read_shift(4);return z[1].v=L>>6,z}function U(B,V){var z=C(B),L=B.read_shift(8,"f");return z[1].v=L,z}function D(B,V){var z=U(B);return B.l+=V-10,z}function W(B,V){return B[B.l+V-1]==0?B.read_shift(V,"cstr"):""}function q(B,V){var z=B[B.l++];z>V-1&&(z=V-1);for(var L="";L.length<z;)L+=String.fromCharCode(B[B.l++]);return L}function Y(B,V,z){if(!(!z.qpro||V<21)){var L=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var te=B.read_shift(V-21,"cstr");return[L,te]}}function K(B,V){for(var z={},L=B.l+V;B.l<L;){var te=B.read_shift(2);if(te==14e3){for(z[te]=[0,""],z[te][0]=B.read_shift(2);B[B.l];)z[te][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return z}function H(B,V){var z=ye(5+B.length);z.write_shift(2,14e3),z.write_shift(2,V);for(var L=0;L<B.length;++L){var te=B.charCodeAt(L);z[z.l++]=te>127?95:te}return z[z.l++]=0,z}var je={0:{n:"BOF",f:os},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}})();function KN(e){var r={},s=e.match(Ds),a=0,n=!1;if(s)for(;a!=s.length;++a){var i=st(s[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=_c[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return r}var XN=(function(){var e=Dn("t"),r=Dn("rPr");function s(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:jt(l[1])},c=i.match(r);return c&&(o.s=KN(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(s).filter(function(o){return o.v})}})(),JN=(function(){var r=/(\r\n|\n)/g;function s(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&s(n.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),ZN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,QN=/<(?:\w+:)?r>/,ew=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zc(e,r){var s=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=jt(Ft(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ft(e),s&&(a.h=Mc(a.t))):e.match(QN)&&(a.r=Ft(e),a.t=jt(Ft((e.replace(ew,"").match(ZN)||[]).join("").replace(Ds,""))),s&&(a.h=JN(XN(a.r)))),a):{t:""}}var tw=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sw=/<(?:\w+:)?(?:si|sstItem)>/g,rw=/<\/(?:\w+:)?(?:si|sstItem)>/;function aw(e,r){var s=[],a="";if(!e)return s;var n=e.match(tw);if(n){a=n[2].replace(sw,"").split(rw);for(var i=0;i!=a.length;++i){var l=Zc(a[i].trim(),r);l!=null&&(s[s.length]=l)}n=st(n[1]),s.Count=n.count,s.Unique=n.uniqueCount}return s}var nw=/^\s|\s$|[\t\n\r]/;function Sh(e,r){if(!r.bookSST)return"";var s=[ns];s[s.length]=Fe("sst",null,{xmlns:Ta[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(nw)&&(i+=' xml:space="preserve"'),i+=">"+At(n.t)+"</t>"),i+="</si>",s[s.length]=i}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}function iw(e){return[e.read_shift(4),e.read_shift(4)]}function lw(e,r){var s=[],a=!1;return Br(e,function(i,l,o){switch(o){case 159:s.Count=i[0],s.Unique=i[1];break;case 19:s.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),s}function ow(e,r){return r||(r=ye(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var cw=by;function dw(e){var r=qs();Ce(r,159,ow(e));for(var s=0;s<e.length;++s)Ce(r,19,cw(e[s]));return Ce(r,160),r.end()}function Th(e){for(var r=[],s=e.split(""),a=0;a<s.length;++a)r[a]=s[a].charCodeAt(0);return r}function Rr(e,r){var s={};return s.Major=e.read_shift(2),s.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),s}function mw(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Rr(e,4),r.U=Rr(e,4),r.W=Rr(e,4),r}function uw(e){for(var r=e.read_shift(4),s=e.l+r-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=s)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+s);return a}function hw(e){var r=[];e.l+=4;for(var s=e.read_shift(4);s-- >0;)r.push(uw(e));return r}function fw(e){var r=[];e.l+=4;for(var s=e.read_shift(4);s-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function xw(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Rr(e,4),r.U=Rr(e,4),r.W=Rr(e,4),r}function pw(e){var r=xw(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Eh(e,r){var s=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(s-e.l>>1,"utf16le"),e.l=s,a}function Ch(e,r){var s={},a=e.l+r;return e.l+=4,s.Salt=e.slice(e.l,e.l+16),e.l+=16,s.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),s.VerifierHash=e.slice(e.l,a),e.l=a,s}function gw(e){var r=Rr(e);switch(r.Minor){case 2:return[r.Minor,vw(e)];case 3:return[r.Minor,bw()];case 4:return[r.Minor,jw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function vw(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var s=e.read_shift(4),a=Eh(e,s),n=Ch(e,e.length-e.l);return{t:"Std",h:a,v:n}}function bw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jw(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var s=e.read_shift(e.length-e.l,"utf8"),a={};return s.replace(Ds,function(i){var l=st(i);switch(_r(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function yw(e,r){var s={},a=s.EncryptionVersionInfo=Rr(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);s.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,s.EncryptionHeader=Eh(e,n),r-=n,s.EncryptionVerifier=Ch(e,r),s}function Nw(e){var r={},s=r.EncryptionVersionInfo=Rr(e,4);if(s.Major!=1||s.Minor!=1)throw"unrecognized version code "+s.Major+" : "+s.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Qc(e){var r=0,s,a=Th(e),n=a.length+1,i,l,o,c,d;for(s=Yr(n),s[0]=a.length,i=1;i!=n;++i)s[i]=a[i-1];for(i=n-1;i>=0;--i)l=s[i],o=(r&16384)===0?0:1,c=r<<1&32767,d=o|c,r=d^l;return r^52811}var _h=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],s=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=r[l.length-1],c=104,d=l.length-1;d>=0;--d)for(var m=l[d],u=0;u!=7;++u)m&64&&(o^=s[c]),m*=2,--c;return o};return function(l){for(var o=Th(l),c=i(o),d=o.length,m=Yr(16),u=0;u!=16;++u)m[u]=0;var h,p,x;for((d&1)===1&&(h=c>>8,m[d]=n(e[0],h),--d,h=c&255,p=o[o.length-1],m[d]=n(p,h));d>0;)--d,h=c>>8,m[d]=n(o[d],h),--d,h=c&255,m[d]=n(o[d],h);for(d=15,x=15-o.length;x>0;)h=c>>8,m[d]=n(e[x],h),--d,--x,h=c&255,m[d]=n(o[d],h),--d,--x;return m}})(),ww=function(e,r,s,a,n){n||(n=r),a||(a=_h(e));var i,l;for(i=0;i!=r.length;++i)l=r[i],l^=a[s],l=(l>>5|l<<3)&255,n[i]=l,++s;return[n,s,a]},Sw=function(e){var r=0,s=_h(e);return function(a){var n=ww("",a,r,s);return r=n[1],n[0]}};function Tw(e,r,s,a){var n={key:os(e),verificationBytes:os(e)};return s.password&&(n.verifier=Qc(s.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Sw(s.password)),n}function Ew(e,r,s){var a=s||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Nw(e):a.Data=yw(e,r),a}function Cw(e,r,s){var a={Type:s.biff>=8?e.read_shift(2):0};return a.Type?Ew(e,r-2,a):Tw(e,s.biff>=8?r:r-2,s,a),a}var kh=(function(){function e(n,i){switch(i.type){case"base64":return r(er(n),i);case"binary":return r(n,i);case"buffer":return r(ut&&Buffer.isBuffer(n)?n.toString("binary"):Qr(n),i);case"array":return r(va(n),i)}throw new Error("Unrecognized type "+i.type)}function r(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(m,u){Array.isArray(o)&&(o[u]=[]);for(var h=/\\\w+\b/g,p=0,x,f=-1;x=h.exec(m);){switch(x[0]){case"\\cell":var g=m.slice(p,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++f,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[u][f]=v:o[Qe({r:u,c:f})]=v}break}p=h.lastIndex}f>d.e.c&&(d.e.c=f)}),o["!ref"]=dt(d),o}function s(n,i){return ea(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=yt(n["!ref"]),o,c=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var u=Qe({r:d,c:m});o=c?(n[d]||[])[m]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Lr(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:s,to_sheet:e,from_sheet:a}})();function _w(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Fn(e){for(var r=0,s=1;r!=3;++r)s=s*256+(e[r]>255?255:e[r]<0?0:e[r]);return s.toString(16).toUpperCase().slice(1)}function kw(e){var r=e[0]/255,s=e[1]/255,a=e[2]/255,n=Math.max(r,s,a),i=Math.min(r,s,a),l=n-i;if(l===0)return[0,0,r];var o=0,c=0,d=n+i;switch(c=l/(d>1?2-d:d),n){case r:o=((s-a)/l+6)%6;break;case s:o=(a-r)/l+2;break;case a:o=(r-s)/l+4;break}return[o/6,c,d/2]}function Aw(e){var r=e[0],s=e[1],a=e[2],n=s*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*r,c;if(s!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function $i(e,r){if(r===0)return e;var s=kw(_w(e));return r<0?s[2]=s[2]*(1+r):s[2]=1-(1-s[2])*(1-r),Fn(Aw(s))}var Ah=6,Dw=15,Iw=1,Ts=Ah;function On(e){return Math.floor((e+Math.round(128/Ts)/256)*Ts)}function Ln(e){return Math.floor((e-5)/Ts*100+.5)/100}function Ui(e){return Math.round((e*Ts+5)/Ts*256)/256}function wl(e){return Ui(Ln(On(e)))}function ed(e){var r=Math.abs(e-wl(e)),s=Ts;if(r>.005)for(Ts=Iw;Ts<Dw;++Ts)Math.abs(e-wl(e))<=r&&(r=Math.abs(e-wl(e)),s=Ts);Ts=s}function Kr(e){e.width?(e.wpx=On(e.width),e.wch=Ln(e.wpx),e.MDW=Ts):e.wpx?(e.wch=Ln(e.wpx),e.width=Ui(e.wch),e.MDW=Ts):typeof e.wch=="number"&&(e.width=Ui(e.wch),e.wpx=On(e.width),e.MDW=Ts),e.customWidth&&delete e.customWidth}var Pw=96,Dh=Pw;function Mn(e){return e*96/Dh}function Ka(e){return e*Dh/96}var Rw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Fw(e,r,s,a){r.Borders=[];var n={},i=!1;(e[0].match(Ds)||[]).forEach(function(l){var o=st(l);switch(_r(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=Mt(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=Mt(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Ow(e,r,s,a){r.Fills=[];var n={},i=!1;(e[0].match(Ds)||[]).forEach(function(l){var o=st(l);switch(_r(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Lw(e,r,s,a){r.Fonts=[];var n={},i=!1;(e[0].match(Ds)||[]).forEach(function(l){var o=st(l);switch(_r(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Ft(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?Mt(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?Mt(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?Mt(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?Mt(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?Mt(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?Mt(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?Mt(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=_c[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=Mt(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=ca[n.color.index];n.color.index==81&&(c=ca[1]),c||(c=ca[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&s.themeElements&&s.themeElements.clrScheme&&(n.color.rgb=$i(s.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Mw(e,r,s){r.NumberFmt=[];for(var a=es(Je),n=0;n<a.length;++n)r.NumberFmt[a[n]]=Je[a[n]];var i=e[0].match(Ds);if(i)for(n=0;n<i.length;++n){var l=st(i[n]);switch(_r(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=jt(Ft(l.formatCode)),c=parseInt(l.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Pr(o,c)}}break;case"</numFmt>":break;default:if(s.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function Bw(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)e[a]!=null&&(r[r.length]=Fe("numFmt",null,{numFmtId:a,formatCode:At(e[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Fe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var bi=["numFmtId","fillId","fontId","borderId","xfId"],ji=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zw(e,r,s){r.CellXf=[];var a,n=!1;(e[0].match(Ds)||[]).forEach(function(i){var l=st(i),o=0;switch(_r(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<bi.length;++o)a[bi[o]]&&(a[bi[o]]=parseInt(a[bi[o]],10));for(o=0;o<ji.length;++o)a[ji[o]]&&(a[ji[o]]=Mt(a[ji[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=Mt(l.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s&&s.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function $w(e){var r=[];return r[r.length]=Fe("cellXfs",null),e.forEach(function(s){r[r.length]=Fe("xf",null,s)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Fe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Uw=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var m={};if(!o)return m;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&Mw(u,m,d),(u=o.match(n))&&Lw(u,m,c,d),(u=o.match(a))&&Ow(u,m,c,d),(u=o.match(i))&&Fw(u,m,c,d),(u=o.match(s))&&zw(u,m,d),m}})();function Ih(e,r){var s=[ns,Fe("styleSheet",null,{xmlns:Ta[0],"xmlns:vt":cs.vt})],a;return e.SSF&&(a=Bw(e.SSF))!=null&&(s[s.length]=a),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=$w(r.cellXfs))&&(s[s.length]=a),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Ww(e,r){var s=e.read_shift(2),a=_s(e);return[s,a]}function Hw(e,r,s){s||(s=ye(6+4*r.length)),s.write_shift(2,e),fs(r,s);var a=s.length>s.l?s.slice(0,s.l):s;return s.l==null&&(s.l=s.length),a}function Vw(e,r,s){var a={};a.sz=e.read_shift(2)/20;var n=Ey(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Ty(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=_s(e),a}function Gw(e,r){r||(r=ye(153)),r.write_shift(2,e.sz*20),Cy(e,r),r.write_shift(2,e.bold?700:400);var s=0;e.vertAlign=="superscript"?s=1:e.vertAlign=="subscript"&&(s=2),r.write_shift(2,s),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Mi(e.color,r);var a=0;return a=2,r.write_shift(1,a),fs(e.name,r),r.length>r.l?r.slice(0,r.l):r}var qw=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sl,Yw=As;function Fm(e,r){r||(r=ye(84)),Sl||(Sl=sl(qw));var s=Sl[e.patternType];s==null&&(s=40),r.write_shift(4,s);var a=0;if(s!=40)for(Mi({auto:1},r),Mi({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Kw(e,r){var s=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=s,{ixfe:a,numFmtId:n}}function Ph(e,r,s){s||(s=ye(16)),s.write_shift(2,r||0),s.write_shift(2,e.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);var a=0;return s.write_shift(1,a),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function dn(e,r){return r||(r=ye(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var Xw=As;function Jw(e,r){return r||(r=ye(51)),r.write_shift(1,0),dn(null,r),dn(null,r),dn(null,r),dn(null,r),dn(null,r),r.length>r.l?r.slice(0,r.l):r}function Zw(e,r){return r||(r=ye(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Li(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Qw(e,r,s){var a=ye(2052);return a.write_shift(4,e),Li(r,a),Li(s,a),a.length>a.l?a.slice(0,a.l):a}function eS(e,r,s){var a={};a.NumberFmt=[];for(var n in Je)a.NumberFmt[n]=Je[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return Br(e,function(c,d,m){switch(m){case 44:a.NumberFmt[c[0]]=c[1],Pr(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=$i(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(m),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(m);else if(d.T<0)i.pop();else if(!l||s.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function tS(e,r){if(r){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&++s}),s!=0&&(Ce(e,615,gr(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&Ce(e,44,Hw(n,r[n]))}),Ce(e,616))}}function sS(e){var r=1;Ce(e,611,gr(r)),Ce(e,43,Gw({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function rS(e){var r=2;Ce(e,603,gr(r)),Ce(e,45,Fm({patternType:"none"})),Ce(e,45,Fm({patternType:"gray125"})),Ce(e,604)}function aS(e){var r=1;Ce(e,613,gr(r)),Ce(e,46,Jw()),Ce(e,614)}function nS(e){var r=1;Ce(e,626,gr(r)),Ce(e,47,Ph({numFmtId:0},65535)),Ce(e,627)}function iS(e,r){Ce(e,617,gr(r.length)),r.forEach(function(s){Ce(e,47,Ph(s,0))}),Ce(e,618)}function lS(e){var r=1;Ce(e,619,gr(r)),Ce(e,48,Zw({xfId:0,name:"Normal"})),Ce(e,620)}function oS(e){var r=0;Ce(e,505,gr(r)),Ce(e,506)}function cS(e){var r=0;Ce(e,508,Qw(r,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function dS(e,r){var s=qs();return Ce(s,278),tS(s,e.SSF),sS(s),rS(s),aS(s),nS(s),iS(s,r.cellXfs),lS(s),oS(s),cS(s),Ce(s,279),s.end()}var mS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uS(e,r,s){r.themeElements.clrScheme=[];var a={};(e[0].match(Ds)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[mS.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(s&&s.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function hS(){}function fS(){}var xS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gS=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vS(e,r,s){r.themeElements={};var a;[["clrScheme",xS,uS],["fontScheme",pS,hS],["fmtScheme",gS,fS]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,s)})}var bS=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Rh(e,r){(!e||e.length===0)&&(e=td());var s,a={};if(!(s=e.match(bS)))throw new Error("themeElements not found in theme");return vS(s[0],a,r),a.raw=e,a}function td(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var s=[ns];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function jS(e,r,s){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!s.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=Eu(i,{type:"array"})}catch{return}var o=Qs(l,"theme/theme/theme1.xml",!0);if(o)return Rh(o,s)}}function yS(e){return e.read_shift(4)}function NS(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=wS(e,4);break;case 2:r.xclrValue=hh(e);break;case 3:r.xclrValue=yS(e);break;case 4:e.l+=4;break}return e.l+=8,r}function wS(e,r){return As(e,r)}function SS(e,r){return As(e,r)}function TS(e){var r=e.read_shift(2),s=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=NS(e);break;case 6:a[1]=SS(e,s);break;case 14:case 15:a[1]=e.read_shift(s===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+s)}return a}function ES(e,r){var s=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(TS(e,s-e.l));return{ixfe:a,ext:i}}function CS(e,r){r.forEach(function(s){s[0]})}function _S(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:_s(e)}}function kS(e){var r=ye(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),fs(e.name,r),r.slice(0,r.l)}function AS(e){for(var r=[],s=e.read_shift(4);s-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function DS(e){var r=ye(4+8*e.length);r.write_shift(4,e.length);for(var s=0;s<e.length;++s)r.write_shift(4,e[s][0]),r.write_shift(4,e[s][1]);return r}function IS(e,r){var s=ye(8+2*r.length);return s.write_shift(4,e),fs(r,s),s.slice(0,s.l)}function PS(e){return e.l+=4,e.read_shift(4)!=0}function RS(e,r){var s=ye(8);return s.write_shift(4,e),s.write_shift(4,1),s}function FS(e,r,s){var a={Types:[],Cell:[],Value:[]},n=s||{},i=[],l=!1,o=2;return Br(e,function(c,d,m){switch(m){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):o==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(m),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function OS(){var e=qs();return Ce(e,332),Ce(e,334,gr(1)),Ce(e,335,kS({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,IS(1,"XLDAPR")),Ce(e,52),Ce(e,35,gr(514)),Ce(e,4096,gr(0)),Ce(e,4097,ir(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,RS(1)),Ce(e,51,DS([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function LS(e,r,s){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,l;return e.replace(Ds,function(o){var c=st(o);switch(_r(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&s.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function Fh(){var e=[ns];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function MS(e){var r=[];if(!e)return r;var s=1;return(e.match(Ds)||[]).forEach(function(a){var n=st(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?s=n.i:n.i=s,r.push(n);break}}),r}function BS(e){var r={};r.i=e.read_shift(4);var s={};s.r=e.read_shift(4),s.c=e.read_shift(4),r.r=Qe(s);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function zS(e,r,s){var a=[];return Br(e,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function $S(e,r,s,a){if(!e)return e;var n=a||{},i=!1;Br(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function US(e,r){if(!e)return"??";var s=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][s].Target}var Ma=1024;function Oh(e,r){for(var s=[21600,21600],a=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),n=[Fe("xml",null,{"xmlns:v":Xs.v,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:mv":Xs.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:a})];Ma<e*1e3;)Ma+=1e3;return r.forEach(function(i){var l=Kt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Fe("v:fill",c,o),m={on:"t",obscured:"t"};++Ma,n=n.concat(["<v:shape"+In({id:"_x0000_s"+Ma,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Fe("v:shadow",null,m),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vs("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),vs("x:AutoFill","False"),vs("x:Row",String(l.r)),vs("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Om(e,r,s,a){var n=Array.isArray(e),i;r.forEach(function(l){var o=Kt(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=yt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=dt(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var m={a:l.author,t:l.t,r:l.r,T:s};l.h&&(m.h=l.h);for(var u=i.c.length-1;u>=0;--u){if(!s&&i.c[u].T)return;s&&!i.c[u].T&&i.c.splice(u,1)}if(s&&a){for(u=0;u<a.length;++u)if(m.a==a[u].id){m.a=a[u].name||m.a;break}}i.c.push(m)})}function WS(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var s=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&s.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=st(o[0]),d={author:c.authorId&&s[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},m=Kt(c.ref);if(!(r.sheetRows&&r.sheetRows<=m.r)){var u=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!u&&!!u[1]&&Zc(u[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function Lh(e){var r=[ns,Fe("comments",null,{xmlns:Ta[0]})],s=[];return r.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=At(n.a);s.indexOf(i)==-1&&(s.push(i),r.push("<author>"+i+"</author>")),n.T&&n.ID&&s.indexOf("tc="+n.ID)==-1&&(s.push("tc="+n.ID),r.push("<author>tc="+n.ID+"</author>"))})}),s.length==0&&(s.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=s.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=s.indexOf(At(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)r.push(vs("t",At(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;r.push(vs("t",At(l)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function HS(e,r){var s=[],a=!1,n={},i=0;return e.replace(Ds,function(o,c){var d=st(o);switch(_r(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&s.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),s}function VS(e,r,s){var a=[ns,Fe("ThreadedComments",null,{xmlns:cs.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&r.indexOf(l.a)==-1&&r.push(l.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(l.a)).slice(-12)+"}"),a.push(Fe("threadedComment",vs("text",l.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function GS(e,r){var s=[],a=!1;return e.replace(Ds,function(i){var l=st(i);switch(_r(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":s.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),s}function qS(e){var r=[ns,Fe("personList",null,{xmlns:cs.TCMNT,"xmlns:x":Ta[0]}).replace(/[\/]>/,">")];return e.forEach(function(s,a){r.push(Fe("person",null,{displayName:s,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:s,providerId:"None"}))}),r.push("</personList>"),r.join("")}function YS(e){var r={};r.iauthor=e.read_shift(4);var s=ka(e);return r.rfx=s.s,r.ref=Qe(s.s),e.l+=16,r}function KS(e,r){return r==null&&(r=ye(36)),r.write_shift(4,e[1].iauthor),sn(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var XS=_s;function JS(e){return fs(e.slice(0,54))}function ZS(e,r){var s=[],a=[],n={},i=!1;return Br(e,function(o,c,d){switch(d){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,s.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function QS(e){var r=qs(),s=[];return Ce(r,628),Ce(r,630),e.forEach(function(a){a[1].forEach(function(n){s.indexOf(n.a)>-1||(s.push(n.a.slice(0,54)),Ce(r,632,JS(n.a)))})}),Ce(r,631),Ce(r,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=s.indexOf(n.a);var i={s:Kt(a[0]),e:Kt(a[0])};Ce(r,635,KS([i,n])),n.t&&n.t.length>0&&Ce(r,637,yy(n)),Ce(r,636),delete n.iauthor})}),Ce(r,634),Ce(r,629),r.end()}var eT="application/vnd.ms-office.vbaProject";function tT(e){var r=Ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(s,a){if(!(s.slice(-1)==="/"||!s.match(/_VBA_PROJECT_CUR/))){var n=s.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(r,n,e.FileIndex[a].content)}}),Ye.write(r)}function sT(e,r){r.FullPaths.forEach(function(s,a){if(a!=0){var n=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ye.utils.cfb_add(e,n,r.FileIndex[a].content)}})}var Mh=["xlsb","xlsm","xlam","biff8","xla"];function rT(){return{"!type":"dialog"}}function aT(){return{"!type":"dialog"}}function nT(){return{"!type":"macro"}}function iT(){return{"!type":"macro"}}var Ua=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function s(a,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return o?m+=r.c:--m,c?d+=r.r:--d,n+(o?"":"$")+Yt(m)+(c?"":"$")+as(d)}return function(n,i){return r=i,n.replace(e,s)}})(),sd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rd=(function(){return function(r,s){return r.replace(sd,function(a,n,i,l,o,c){var d=Wc(l)-(i?0:s.c),m=Uc(c)-(o?0:s.r),u=m==0?"":o?m+1:"["+m+"]",h=d==0?"":i?d+1:"["+d+"]";return n+"R"+u+"C"+h})}})();function Bh(e,r){return e.replace(sd,function(s,a,n,i,l,o){return a+(n=="$"?n+i:Yt(Wc(i)+r.c))+(l=="$"?l+o:as(Uc(o)+r.r))})}function lT(e,r,s){var a=Ys(r),n=a.s,i=Kt(s),l={r:i.r-n.r,c:i.c-n.c};return Bh(e,l)}function oT(e){return e.length!=1}function Lm(e){return e.replace(/_xlfn\./g,"")}function is(e){e.l+=1}function Xr(e,r){var s=e.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function zh(e,r,s){var a=2;if(s){if(s.biff>=2&&s.biff<=5)return $h(e);s.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),l=Xr(e),o=Xr(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function $h(e){var r=Xr(e),s=Xr(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:s[0],c:n,cRel:s[1],rRel:s[2]}}}function cT(e,r,s){if(s.biff<8)return $h(e);var a=e.read_shift(s.biff==12?4:2),n=e.read_shift(s.biff==12?4:2),i=Xr(e),l=Xr(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function Uh(e,r,s){if(s&&s.biff>=2&&s.biff<=5)return dT(e);var a=e.read_shift(s&&s.biff==12?4:2),n=Xr(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function dT(e){var r=Xr(e),s=e.read_shift(1);return{r:r[0],c:s,cRel:r[1],rRel:r[2]}}function mT(e){var r=e.read_shift(2),s=e.read_shift(2);return{r,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function uT(e,r,s){var a=s&&s.biff?s.biff:8;if(a>=2&&a<=5)return hT(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function hT(e){var r=e.read_shift(2),s=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&s>=128&&(s=s-256),{r,c:s,cRel:n,rRel:a}}function fT(e,r,s){var a=(e[e.l++]&96)>>5,n=zh(e,s.biff>=2&&s.biff<=5?6:8,s);return[a,n]}function xT(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(s)switch(s.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=zh(e,i,s);return[a,n,l]}function pT(e,r,s){var a=(e[e.l++]&96)>>5;return e.l+=s&&s.biff>8?12:s.biff<8?6:8,[a]}function gT(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(s)switch(s.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function vT(e,r,s){var a=(e[e.l++]&96)>>5,n=cT(e,r-1,s);return[a,n]}function bT(e,r,s){var a=(e[e.l++]&96)>>5;return e.l+=s.biff==2?6:s.biff==12?14:7,[a]}function Mm(e){var r=e[e.l+1]&1,s=1;return e.l+=4,[r,s]}function jT(e,r,s){e.l+=2;for(var a=e.read_shift(s&&s.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(s&&s.biff==2?1:2));return n}function yT(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function NT(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function wT(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function ST(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=s&&s.biff==2?3:4,[a]}function Wh(e){var r=e.read_shift(1),s=e.read_shift(1);return[r,s]}function TT(e){return e.read_shift(2),Wh(e)}function ET(e){return e.read_shift(2),Wh(e)}function CT(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=Uh(e,0,s);return[a,n]}function _T(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=uT(e,0,s);return[a,n]}function kT(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);s&&s.biff==5&&(e.l+=12);var i=Uh(e,0,s);return[a,n,i]}function AT(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(s&&s.biff<=3?1:2);return[PE[n],Gh[n],a]}function DT(e,r,s){var a=e[e.l++],n=e.read_shift(1),i=s&&s.biff<=3?[a==88?-1:0,e.read_shift(1)]:IT(e);return[n,(i[0]===0?Gh:IE)[i[1]]]}function IT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PT(e,r,s){e.l+=s&&s.biff==2?3:4}function RT(e,r,s){if(e.l++,s&&s.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function FT(e){return e.l++,zr[e.read_shift(1)]}function OT(e){return e.l++,e.read_shift(2)}function LT(e){return e.l++,e.read_shift(1)!==0}function MT(e){return e.l++,Cs(e)}function BT(e,r,s){return e.l++,ei(e,r-1,s)}function zT(e,r){var s=[e.read_shift(1)];if(r==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=ss(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:s[1]=zr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:s[1]=Cs(e);break;case 2:s[1]=Aa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function $T(e,r,s){for(var a=e.read_shift(s.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((s.biff==12?ka:nl)(e));return n}function UT(e,r,s){var a=0,n=0;s.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),s.biff>=2&&s.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=zT(e,s.biff);return l}function WT(e,r,s){var a=e.read_shift(1)>>>5&3,n=!s||s.biff>=8?4:2,i=e.read_shift(n);switch(s.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function HT(e,r,s){if(s.biff==5)return VT(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function VT(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,s,a]}function GT(e,r,s){var a=e.read_shift(1)>>>5&3;e.l+=s&&s.biff==2?3:4;var n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function qT(e,r,s){var a=e.read_shift(1)>>>5&3,n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function YT(e,r,s){var a=e.read_shift(1)>>>5&3;return e.l+=4,s.biff<8&&e.l--,s.biff==12&&(e.l+=2),[a]}function KT(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(s)switch(s.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var XT=As,JT=As,ZT=As;function si(e,r,s){return e.l+=2,[mT(e)]}function ad(e){return e.l+=6,[]}var QT=si,eE=ad,tE=ad,sE=si;function Hh(e){return e.l+=2,[os(e),e.read_shift(2)&1]}var rE=si,aE=Hh,nE=ad,iE=si,lE=si,oE=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function cE(e){e.l+=2;var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=oE[s>>2&31];return{ixti:r,coltype:s&3,rt:l,idx:a,c:n,C:i}}function dE(e){return e.l+=2,[e.read_shift(4)]}function mE(e,r,s){return e.l+=5,e.l+=2,e.l+=s.biff==2?1:4,["PTGSHEET"]}function uE(e,r,s){return e.l+=s.biff==2?4:5,["PTGENDSHEET"]}function hE(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[r,s]}function fE(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[r,s]}function xE(e){return e.l+=4,[0,0]}var Bm={1:{n:"PtgExp",f:RT},2:{n:"PtgTbl",f:ZT},3:{n:"PtgAdd",f:is},4:{n:"PtgSub",f:is},5:{n:"PtgMul",f:is},6:{n:"PtgDiv",f:is},7:{n:"PtgPower",f:is},8:{n:"PtgConcat",f:is},9:{n:"PtgLt",f:is},10:{n:"PtgLe",f:is},11:{n:"PtgEq",f:is},12:{n:"PtgGe",f:is},13:{n:"PtgGt",f:is},14:{n:"PtgNe",f:is},15:{n:"PtgIsect",f:is},16:{n:"PtgUnion",f:is},17:{n:"PtgRange",f:is},18:{n:"PtgUplus",f:is},19:{n:"PtgUminus",f:is},20:{n:"PtgPercent",f:is},21:{n:"PtgParen",f:is},22:{n:"PtgMissArg",f:is},23:{n:"PtgStr",f:BT},26:{n:"PtgSheet",f:mE},27:{n:"PtgEndSheet",f:uE},28:{n:"PtgErr",f:FT},29:{n:"PtgBool",f:LT},30:{n:"PtgInt",f:OT},31:{n:"PtgNum",f:MT},32:{n:"PtgArray",f:bT},33:{n:"PtgFunc",f:AT},34:{n:"PtgFuncVar",f:DT},35:{n:"PtgName",f:WT},36:{n:"PtgRef",f:CT},37:{n:"PtgArea",f:fT},38:{n:"PtgMemArea",f:GT},39:{n:"PtgMemErr",f:XT},40:{n:"PtgMemNoMem",f:JT},41:{n:"PtgMemFunc",f:qT},42:{n:"PtgRefErr",f:YT},43:{n:"PtgAreaErr",f:pT},44:{n:"PtgRefN",f:_T},45:{n:"PtgAreaN",f:vT},46:{n:"PtgMemAreaN",f:hE},47:{n:"PtgMemNoMemN",f:fE},57:{n:"PtgNameX",f:HT},58:{n:"PtgRef3d",f:kT},59:{n:"PtgArea3d",f:xT},60:{n:"PtgRefErr3d",f:KT},61:{n:"PtgAreaErr3d",f:gT},255:{}},pE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gE={1:{n:"PtgElfLel",f:Hh},2:{n:"PtgElfRw",f:iE},3:{n:"PtgElfCol",f:QT},6:{n:"PtgElfRwV",f:lE},7:{n:"PtgElfColV",f:sE},10:{n:"PtgElfRadical",f:rE},11:{n:"PtgElfRadicalS",f:nE},13:{n:"PtgElfColS",f:eE},15:{n:"PtgElfColSV",f:tE},16:{n:"PtgElfRadicalLel",f:aE},25:{n:"PtgList",f:cE},29:{n:"PtgSxName",f:dE},255:{}},vE={0:{n:"PtgAttrNoop",f:xE},1:{n:"PtgAttrSemi",f:ST},2:{n:"PtgAttrIf",f:NT},4:{n:"PtgAttrChoose",f:jT},8:{n:"PtgAttrGoto",f:yT},16:{n:"PtgAttrSum",f:PT},32:{n:"PtgAttrBaxcel",f:Mm},33:{n:"PtgAttrBaxcel",f:Mm},64:{n:"PtgAttrSpace",f:TT},65:{n:"PtgAttrSpaceSemi",f:ET},128:{n:"PtgAttrIfError",f:wT},255:{}};function ri(e,r,s,a){if(a.biff<8)return As(e,r);for(var n=e.l+r,i=[],l=0;l!==s.length;++l)switch(s[l][0]){case"PtgArray":s[l][1]=UT(e,0,a),i.push(s[l][1]);break;case"PtgMemArea":s[l][2]=$T(e,s[l][1],a),i.push(s[l][2]);break;case"PtgExp":a&&a.biff==12&&(s[l][1][1]=e.read_shift(4),i.push(s[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[l][0]}return r=n-e.l,r!==0&&i.push(As(e,r)),i}function ai(e,r,s){for(var a=e.l+r,n,i,l=[];a!=e.l;)r=a-e.l,i=e[e.l],n=Bm[i]||Bm[pE[i]],(i===24||i===25)&&(n=(i===24?gE:vE)[e[e.l+1]]),!n||!n.f?As(e,r):l.push([n.n,n.f(e,r,s)]);return l}function bE(e){for(var r=[],s=0;s<e.length;++s){for(var a=e[s],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var jE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yE(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Vh(e,r,s){if(!e)return"SH33TJSERR0";if(s.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(s.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(s.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return s.SID!=null?e.SheetNames[s.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function zm(e,r,s){var a=Vh(e,r,s);return a=="#REF"?a:yE(a,s)}function ws(e,r,s,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,d,m,u=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var f=-1,g="",v=0,N=e[0].length;v<N;++v){var j=e[0][v];switch(j[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),f>=0){switch(e[0][f][1][0]){case 0:g=Zt(" ",e[0][f][1][1]);break;case 1:g=Zt("\r",e[0][f][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}d=d+g,f=-1}o.push(d+jE[j[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=pn(j[1][1],l,n),o.push(gn(m,i));break;case"PtgRefN":m=s?pn(j[1][1],s,n):j[1][1],o.push(gn(m,i));break;case"PtgRef3d":u=j[1][1],m=pn(j[1][2],l,n),x=zm(a,u,n),o.push(x+"!"+gn(m,i));break;case"PtgFunc":case"PtgFuncVar":var S=j[1][0],C=j[1][1];S||(S=0),S&=127;var w=S==0?[]:o.slice(-S);o.length-=S,C==="User"&&(C=w.shift()),o.push(C+"("+w.join(",")+")");break;case"PtgBool":o.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(j[1]);break;case"PtgNum":o.push(String(j[1]));break;case"PtgStr":o.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(j[1]);break;case"PtgAreaN":p=xm(j[1][1],s?{s}:l,n),o.push(jl(p,n));break;case"PtgArea":p=xm(j[1][1],l,n),o.push(jl(p,n));break;case"PtgArea3d":u=j[1][1],p=j[1][2],x=zm(a,u,n),o.push(x+"!"+jl(p,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=j[1][2];var y=(a.names||[])[h-1]||(a[0]||[])[h],T=y?y.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!n.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var k=j[1][1];h=j[1][2];var P;if(n.biff<=5)k<0&&(k=-k),a[k]&&(P=a[k][h]);else{var A="";if(((a[k]||[])[0]||[])[0]==14849||(((a[k]||[])[0]||[])[0]==1025?a[k][h]&&a[k][h].itab>0&&(A=a.SheetNames[a[k][h].itab-1]+"!"):A=a.SheetNames[h-1]+"!"),a[k]&&a[k][h])A+=a[k][h].Name;else if(a[0]&&a[0][h])A+=a[0][h].Name;else{var _=(Vh(a,k,n)||"").split(";;");_[h-1]?A=_[h-1]:A+="SH33TJSERRX"}o.push(A);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var U="(",D=")";if(f>=0){switch(g="",e[0][f][1][0]){case 2:U=Zt(" ",e[0][f][1][1])+U;break;case 3:U=Zt("\r",e[0][f][1][1])+U;break;case 4:D=Zt(" ",e[0][f][1][1])+D;break;case 5:D=Zt("\r",e[0][f][1][1])+D;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}o.push(U+o.pop()+D);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":m={c:j[1][1],r:j[1][0]};var W={c:s.c,r:s.r};if(a.sharedf[Qe(m)]){var q=a.sharedf[Qe(m)];o.push(ws(q,l,W,a,n))}else{var Y=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){o.push(ws(d[1],l,W,a,n)),Y=!0;break}Y||o.push(j[1])}break;case"PtgArray":o.push("{"+bE(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&f>=0&&K.indexOf(e[0][v][0])==-1){j=e[0][f];var H=!0;switch(j[1][0]){case 4:H=!1;case 0:g=Zt(" ",j[1][1]);break;case 5:H=!1;case 1:g=Zt("\r",j[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}o.push((H?g:"")+o.pop()+(H?"":g)),f=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function NE(e,r,s){var a=e.l+r,n=s.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],As(e,r-2)];var o=ai(e,l,s);return r!==l+n&&(i=ri(e,r-l-n,o,s)),e.l=a,[o,i]}function wE(e,r,s){var a=e.l+r,n=s.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],As(e,r-2)];var o=ai(e,l,s);return r!==l+n&&(i=ri(e,r-l-n,o,s)),e.l=a,[o,i]}function SE(e,r,s,a){var n=e.l+r,i=ai(e,a,s),l;return n!==e.l&&(l=ri(e,n-e.l,i,s)),[i,l]}function TE(e,r,s){var a=e.l+r,n,i=e.read_shift(2),l=ai(e,i,s);return i==65535?[[],As(e,r-2)]:(r!==i+2&&(n=ri(e,a-i-2,l,s)),[l,n])}function EE(e){var r;if(Dr(e,e.l+6)!==65535)return[Cs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function CE(e){if(e==null){var r=ye(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ba(e);return ba(0)}function Tl(e,r,s){var a=e.l+r,n=kr(e);s.biff==2&&++e.l;var i=EE(e),l=e.read_shift(1);s.biff!=2&&(e.read_shift(1),s.biff>=5&&e.read_shift(4));var o=wE(e,a-e.l,s);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function _E(e,r,s,a,n){var i=ya(r,s,n),l=CE(e.v),o=ye(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=ye(e.bf.length),m=0;m<e.bf.length;++m)d[m]=e.bf[m];var u=hs([i,l,o,d]);return u}function il(e,r,s){var a=e.read_shift(4),n=ai(e,a,s),i=e.read_shift(4),l=i>0?ri(e,i,n,s):null;return[n,l]}var kE=il,ll=il,AE=il,DE=il,IE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Gh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $m(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,s){return s.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function RE(e){var r="of:="+e.replace(sd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function El(e){var r=e.split(":"),s=r[0].split(".")[0];return[s,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function FE(e){return e.replace(/\./,"!")}var bn={},Wa={},jn=typeof Map<"u";function nd(e,r,s){var a=0,n=e.length;if(s){if(jn?s.has(r):Object.prototype.hasOwnProperty.call(s,r)){for(var i=jn?s.get(r):s[r];a<i.length;++a)if(e[i[a]].t===r)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===r)return e.Count++,a;return e[n]={t:r},e.Count++,e.Unique++,s&&(jn?(s.has(r)||s.set(r,[]),s.get(r).push(n)):(Object.prototype.hasOwnProperty.call(s,r)||(s[r]=[]),s[r].push(n))),n}function ol(e,r){var s={min:e+1,max:e+1},a=-1;return r.MDW&&(Ts=r.MDW),r.width!=null?s.customWidth=1:r.wpx!=null?a=Ln(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(s.width=Ui(a),s.customWidth=1):r.width!=null&&(s.width=r.width),r.hidden&&(s.hidden=!0),r.level!=null&&(s.outlineLevel=s.level=r.level),s}function ua(e,r){if(e){var s=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(s=[1,1,1,1,.5,.5]),e.left==null&&(e.left=s[0]),e.right==null&&(e.right=s[1]),e.top==null&&(e.top=s[2]),e.bottom==null&&(e.bottom=s[3]),e.header==null&&(e.header=s[4]),e.footer==null&&(e.footer=s[5])}}function ta(e,r,s){var a=s.revssf[r.z!=null?r.z:"General"],n=60,i=e.length;if(a==null&&s.ssf){for(;n<392;++n)if(s.ssf[n]==null){Pr(r.z,n),s.ssf[n]=r.z,s.revssf[r.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function qh(e,r,s,a,n,i){try{a.cellNF&&(e.z=Je[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$t(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Je[r]==null&&Pr(Ij[r]||"General",r),e.t==="e")e.w=e.w||zr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v);else if(e.t==="d"){var l=ms(e.v);(l|0)===l?e.w=l.toString(10):e.w=An(l)}else{if(e.v===void 0)return"";e.w=ga(e.v,Wa)}else e.t==="d"?e.w=dr(r,ms(e.v),Wa):e.w=dr(r,e.v,Wa)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&s!=null)try{e.s=i.Fills[s],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=$i(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=$i(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function OE(e,r,s){if(e&&e["!ref"]){var a=yt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+s+"): "+e["!ref"])}}function LE(e,r){var s=yt(r);s.s.r<=s.e.r&&s.s.c<=s.e.c&&s.s.r>=0&&s.s.c>=0&&(e["!ref"]=dt(s))}var ME=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,BE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zE=/<(?:\w:)?hyperlink [^>]*>/mg,$E=/"(\w*:\w*)"/,UE=/<(?:\w:)?col\b[^>]*[\/]?>/g,WE=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HE=/<(?:\w:)?pageMargins[^>]*\/>/g,Yh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,VE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,GE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qE(e,r,s,a,n,i,l){if(!e)return e;a||(a={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",u=e.match(BE);u?(d=e.slice(0,u.index),m=e.slice(u.index+u[0].length)):d=m=e;var h=d.match(Yh);h?id(h[0],o,n,s):(h=d.match(VE))&&KE(h[0],h[1]||"",o,n,s);var p=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=d.slice(p,p+50).match($E);x&&LE(o,x[1])}var f=d.match(GE);f&&f[1]&&o4(f[1],n);var g=[];if(r.cellStyles){var v=d.match(UE);v&&r4(g,v)}u&&m4(u[1],o,r,c,i,l);var N=m.match(WE);N&&(o["!autofilter"]=n4(N[0]));var j=[],S=m.match(ME);if(S)for(p=0;p!=S.length;++p)j[p]=yt(S[p].slice(S[p].indexOf('"')+1));var C=m.match(zE);C&&e4(o,C,a);var w=m.match(HE);if(w&&(o["!margins"]=t4(st(w[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=dt(c)),r.sheetRows>0&&o["!ref"]){var y=yt(o["!ref"]);r.sheetRows<=+y.e.r&&(y.e.r=r.sheetRows-1,y.e.r>c.e.r&&(y.e.r=c.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>c.e.c&&(y.e.c=c.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=dt(y))}return g.length>0&&(o["!cols"]=g),j.length>0&&(o["!merges"]=j),o}function YE(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',s=0;s!=e.length;++s)r+='<mergeCell ref="'+dt(e[s])+'"/>';return r+"</mergeCells>"}function id(e,r,s,a){var n=st(e);s.Sheets[a]||(s.Sheets[a]={}),n.codeName&&(s.Sheets[a].CodeName=jt(Ft(n.codeName)))}function KE(e,r,s,a,n){id(e.slice(0,e.indexOf(">")),s,a,n)}function XE(e,r,s,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[s];try{r.Workbook&&(c=r.Workbook.Sheets[s].CodeName||c)}catch{}i=!0,l.codeName=Er(At(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+Fe("outlinePr",null,d)}!i&&!o||(n[n.length]=Fe("sheetPr",o,l))}var JE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ZE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function QE(e){var r={sheet:1};return JE.forEach(function(s){e[s]!=null&&e[s]&&(r[s]="1")}),ZE.forEach(function(s){e[s]!=null&&!e[s]&&(r[s]="0")}),e.password&&(r.password=Qc(e.password).toString(16).toUpperCase()),Fe("sheetProtection",null,r)}function e4(e,r,s){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var i=st(Ft(r[n]),!0);if(!i.ref)return;var l=((s||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+jt(i.location))):(i.Target="#"+jt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=yt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var m=Qe({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=i)}}}function t4(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(s){e[s]&&(r[s]=parseFloat(e[s]))}),r}function s4(e){return ua(e),Fe("pageMargins",null,e)}function r4(e,r){for(var s=!1,a=0;a!=r.length;++a){var n=st(r[a],!0);n.hidden&&(n.hidden=Mt(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!s&&n.width&&(s=!0,ed(n.width)),Kr(n);i<=l;)e[i++]=Ut(n)}}function a4(e,r){for(var s=["<cols>"],a,n=0;n!=r.length;++n)(a=r[n])&&(s[s.length]=Fe("col",null,ol(n,a)));return s[s.length]="</cols>",s.join("")}function n4(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function i4(e,r,s,a){var n=typeof e.ref=="string"?e.ref:dt(e.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var i=s.Workbook.Names,l=Ys(n);l.s.r==l.e.r&&(l.e.r=Ys(r["!ref"]).e.r,n=dt(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+s.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+n}),Fe("autoFilter",null,{ref:n})}var l4=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function o4(e,r){r.Views||(r.Views=[{}]),(e.match(l4)||[]).forEach(function(s,a){var n=st(s);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Mt(n.rightToLeft)&&(r.Views[a].RTL=!0)})}function c4(e,r,s,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,n),{})}function d4(e,r,s,a){if(e.c&&s["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=zr[e.v];break;case"d":a&&a.cellDates?n=$t(e.v,-1).toISOString():(e=Ut(e),e.t="n",n=""+(e.v=ms($t(e.v)))),typeof e.z>"u"&&(e.z=Je[14]);break;default:n=e.v;break}var o=vs("v",At(n)),c={r},d=ta(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=vs("v",""+nd(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=Fe("f",At(e.f),m)+(e.v!=null?o:"")}return e.l&&s["!links"].push([r,e.l]),e.D&&(c.cm=1),Fe("c",o,c)}var m4=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,s=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Dn("v"),l=Dn("f");return function(c,d,m,u,h,p){for(var x=0,f="",g=[],v=[],N=0,j=0,S=0,C="",w,y,T=0,k=0,P,A,_=0,U=0,D=Array.isArray(p.CellXf),W,q=[],Y=[],K=Array.isArray(d),H=[],je={},ie=!1,B=!!m.sheetStubs,V=c.split(r),z=0,L=V.length;z!=L;++z){f=V[z].trim();var te=f.length;if(te!==0){var ne=0;e:for(x=0;x<te;++x)switch(f[x]){case">":if(f[x-1]!="/"){++x;break e}if(m&&m.cellStyles){if(y=st(f.slice(ne,x),!0),T=y.r!=null?parseInt(y.r,10):T+1,k=-1,m.sheetRows&&m.sheetRows<T)continue;je={},ie=!1,y.ht&&(ie=!0,je.hpt=parseFloat(y.ht),je.hpx=Ka(je.hpt)),y.hidden=="1"&&(ie=!0,je.hidden=!0),y.outlineLevel!=null&&(ie=!0,je.level=+y.outlineLevel),ie&&(H[T-1]=je)}break;case"<":ne=x;break}if(ne>=x)break;if(y=st(f.slice(ne,x),!0),T=y.r!=null?parseInt(y.r,10):T+1,k=-1,!(m.sheetRows&&m.sheetRows<T)){u.s.r>T-1&&(u.s.r=T-1),u.e.r<T-1&&(u.e.r=T-1),m&&m.cellStyles&&(je={},ie=!1,y.ht&&(ie=!0,je.hpt=parseFloat(y.ht),je.hpx=Ka(je.hpt)),y.hidden=="1"&&(ie=!0,je.hidden=!0),y.outlineLevel!=null&&(ie=!0,je.level=+y.outlineLevel),ie&&(H[T-1]=je)),g=f.slice(x).split(e);for(var ue=0;ue!=g.length&&g[ue].trim().charAt(0)=="<";++ue);for(g=g.slice(ue),x=0;x!=g.length;++x)if(f=g[x].trim(),f.length!==0){if(v=f.match(s),N=x,j=0,S=0,f="<c "+(f.slice(0,1)=="<"?">":"")+f,v!=null&&v.length===2){for(N=0,C=v[1],j=0;j!=C.length&&!((S=C.charCodeAt(j)-64)<1||S>26);++j)N=26*N+S;--N,k=N}else++k;for(j=0;j!=f.length&&f.charCodeAt(j)!==62;++j);if(++j,y=st(f.slice(0,j),!0),y.r||(y.r=Qe({r:T-1,c:k})),C=f.slice(j),w={t:""},(v=C.match(i))!=null&&v[1]!==""&&(w.v=jt(v[1])),m.cellFormula){if((v=C.match(l))!=null&&v[1]!==""){if(w.f=jt(Ft(v[1])).replace(/\r\n/g,`
`),m.xlfn||(w.f=Lm(w.f)),v[0].indexOf('t="array"')>-1)w.F=(C.match(n)||[])[1],w.F.indexOf(":")>-1&&q.push([yt(w.F),w.F]);else if(v[0].indexOf('t="shared"')>-1){A=st(v[0]);var Ne=jt(Ft(v[1]));m.xlfn||(Ne=Lm(Ne)),Y[parseInt(A.si,10)]=[A,Ne,y.r]}}else(v=C.match(/<f[^>]*\/>/))&&(A=st(v[0]),Y[A.si]&&(w.f=lT(Y[A.si][1],Y[A.si][2],y.r)));var ae=Kt(y.r);for(j=0;j<q.length;++j)ae.r>=q[j][0].s.r&&ae.r<=q[j][0].e.r&&ae.c>=q[j][0].s.c&&ae.c<=q[j][0].e.c&&(w.F=q[j][1])}if(y.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(B)w.t="z";else continue;else w.t=y.t||"n";switch(u.s.c>k&&(u.s.c=k),u.e.c<k&&(u.e.c=k),w.t){case"n":if(w.v==""||w.v==null){if(!B)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!B)continue;w.t="z"}else P=bn[parseInt(w.v,10)],w.v=P.t,w.r=P.r,m.cellHTML&&(w.h=P.h);break;case"str":w.t="s",w.v=w.v!=null?Ft(w.v):"",m.cellHTML&&(w.h=Mc(w.v));break;case"inlineStr":v=C.match(a),w.t="s",v!=null&&(P=Zc(v[1]))?(w.v=P.t,m.cellHTML&&(w.h=P.h)):w.v="";break;case"b":w.v=Mt(w.v);break;case"d":m.cellDates?w.v=$t(w.v,1):(w.v=ms($t(w.v,1)),w.t="n");break;case"e":(!m||m.cellText!==!1)&&(w.w=w.v),w.v=Xu[w.v];break}if(_=U=0,W=null,D&&y.s!==void 0&&(W=p.CellXf[y.s],W!=null&&(W.numFmtId!=null&&(_=W.numFmtId),m.cellStyles&&W.fillId!=null&&(U=W.fillId))),qh(w,_,U,m,h,p),m.cellDates&&D&&w.t=="n"&&Qa(Je[_])&&(w.t="d",w.v=al(w.v)),y.cm&&m.xlmeta){var re=(m.xlmeta.Cell||[])[+y.cm-1];re&&re.type=="XLDAPR"&&(w.D=!0)}if(K){var M=Kt(y.r);d[M.r]||(d[M.r]=[]),d[M.r][M.c]=w}else d[y.r]=w}}}}H.length>0&&(d["!rows"]=H)}})();function u4(e,r,s,a){var n=[],i=[],l=yt(e["!ref"]),o="",c,d="",m=[],u=0,h=0,p=e["!rows"],x=Array.isArray(e),f={r:d},g,v=-1;for(h=l.s.c;h<=l.e.c;++h)m[h]=Yt(h);for(u=l.s.r;u<=l.e.r;++u){for(i=[],d=as(u),h=l.s.c;h<=l.e.c;++h){c=m[h]+d;var N=x?(e[u]||[])[h]:e[c];N!==void 0&&(o=d4(N,c,e,r))!=null&&i.push(o)}(i.length>0||p&&p[u])&&(f={r:d},p&&p[u]&&(g=p[u],g.hidden&&(f.hidden=1),v=-1,g.hpx?v=Mn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(f.ht=v,f.customHeight=1),g.level&&(f.outlineLevel=g.level)),n[n.length]=Fe("row",i.join(""),f))}if(p)for(;u<p.length;++u)p&&p[u]&&(f={r:u+1},g=p[u],g.hidden&&(f.hidden=1),v=-1,g.hpx?v=Mn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(f.ht=v,f.customHeight=1),g.level&&(f.outlineLevel=g.level),n[n.length]=Fe("row","",f));return n.join("")}function Kh(e,r,s,a){var n=[ns,Fe("worksheet",null,{xmlns:Ta[0],"xmlns:r":cs.r})],i=s.SheetNames[e],l=0,o="",c=s.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",m=yt(d);if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=dt(m)}a||(a={}),c["!comments"]=[];var u=[];XE(c,s,e,r,n),n[n.length]=Fe("dimension",null,{ref:d}),n[n.length]=c4(c,r,e,s),r.sheetFormat&&(n[n.length]=Fe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=a4(c,c["!cols"])),n[l=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=u4(c,r),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),c["!protect"]&&(n[n.length]=QE(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=i4(c["!autofilter"],c,s,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=YE(c["!merges"]));var h=-1,p,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(f){f[1].Target&&(p={ref:f[0]},f[1].Target.charAt(0)!="#"&&(x=kt(a,-1,At(f[1].Target).replace(/#.*$/,""),ft.HLINK),p["r:id"]="rId"+x),(h=f[1].Target.indexOf("#"))>-1&&(p.location=At(f[1].Target.slice(h+1))),f[1].Tooltip&&(p.tooltip=At(f[1].Tooltip)),n[n.length]=Fe("hyperlink",null,p))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=s4(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(n[n.length]=vs("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),u.length>0&&(x=kt(a,-1,"../drawings/drawing"+(e+1)+".xml",ft.DRAW),n[n.length]=Fe("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=u),c["!comments"].length>0&&(x=kt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ft.VML),n[n.length]=Fe("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function h4(e,r){var s={},a=e.l+r;s.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(s.level=i&7),i&16&&(s.hidden=!0),i&32&&(s.hpt=n/20),s}function f4(e,r,s){var a=ye(145),n=(s["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=Mn(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var d={r:e,c:0},m=0;m<16;++m)if(!(r.s.c>m+1<<10||r.e.c<m<<10)){for(var u=-1,h=-1,p=m<<10;p<m+1<<10;++p){d.c=p;var x=Array.isArray(s)?(s[d.r]||[])[d.c]:s[Qe(d)];x&&(u<0&&(u=p),h=p)}u<0||(++o,a.write_shift(4,u),a.write_shift(4,h))}var f=a.l;return a.l=c,a.write_shift(4,o),a.l=f,a.length>a.l?a.slice(0,a.l):a}function x4(e,r,s,a){var n=f4(a,s,r);(n.length>17||(r["!rows"]||[])[a])&&Ce(e,0,n)}var p4=ka,g4=sn;function v4(){}function b4(e,r){var s={},a=e[e.l];return++e.l,s.above=!(a&64),s.left=!(a&128),e.l+=18,s.name=Ny(e),s}function j4(e,r,s){s==null&&(s=ye(84+4*e.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),s.write_shift(1,a);for(var n=1;n<3;++n)s.write_shift(1,0);return Mi({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),Vu(e,s),s.slice(0,s.l)}function y4(e){var r=mr(e);return[r]}function N4(e,r,s){return s==null&&(s=ye(8)),Ea(r,s)}function w4(e){var r=Ca(e);return[r]}function S4(e,r,s){return s==null&&(s=ye(4)),_a(r,s)}function T4(e){var r=mr(e),s=e.read_shift(1);return[r,s,"b"]}function E4(e,r,s){return s==null&&(s=ye(9)),Ea(r,s),s.write_shift(1,e.v?1:0),s}function C4(e){var r=Ca(e),s=e.read_shift(1);return[r,s,"b"]}function _4(e,r,s){return s==null&&(s=ye(5)),_a(r,s),s.write_shift(1,e.v?1:0),s}function k4(e){var r=mr(e),s=e.read_shift(1);return[r,s,"e"]}function A4(e,r,s){return s==null&&(s=ye(9)),Ea(r,s),s.write_shift(1,e.v),s}function D4(e){var r=Ca(e),s=e.read_shift(1);return[r,s,"e"]}function I4(e,r,s){return s==null&&(s=ye(8)),_a(r,s),s.write_shift(1,e.v),s.write_shift(2,0),s.write_shift(1,0),s}function P4(e){var r=mr(e),s=e.read_shift(4);return[r,s,"s"]}function R4(e,r,s){return s==null&&(s=ye(12)),Ea(r,s),s.write_shift(4,r.v),s}function F4(e){var r=Ca(e),s=e.read_shift(4);return[r,s,"s"]}function O4(e,r,s){return s==null&&(s=ye(8)),_a(r,s),s.write_shift(4,r.v),s}function L4(e){var r=mr(e),s=Cs(e);return[r,s,"n"]}function M4(e,r,s){return s==null&&(s=ye(16)),Ea(r,s),ba(e.v,s),s}function Xh(e){var r=Ca(e),s=Cs(e);return[r,s,"n"]}function B4(e,r,s){return s==null&&(s=ye(12)),_a(r,s),ba(e.v,s),s}function z4(e){var r=mr(e),s=qc(e);return[r,s,"n"]}function $4(e,r,s){return s==null&&(s=ye(12)),Ea(r,s),Gu(e.v,s),s}function U4(e){var r=Ca(e),s=qc(e);return[r,s,"n"]}function W4(e,r,s){return s==null&&(s=ye(8)),_a(r,s),Gu(e.v,s),s}function H4(e){var r=mr(e),s=Hc(e);return[r,s,"is"]}function V4(e){var r=mr(e),s=_s(e);return[r,s,"str"]}function G4(e,r,s){return s==null&&(s=ye(12+4*e.v.length)),Ea(r,s),fs(e.v,s),s.length>s.l?s.slice(0,s.l):s}function q4(e){var r=Ca(e),s=_s(e);return[r,s,"str"]}function Y4(e,r,s){return s==null&&(s=ye(8+4*e.v.length)),_a(r,s),fs(e.v,s),s.length>s.l?s.slice(0,s.l):s}function K4(e,r,s){var a=e.l+r,n=mr(e);n.r=s["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(s.cellFormula){e.l+=2;var o=ll(e,a-e.l,s);l[3]=ws(o,null,n,s.supbooks,s)}else e.l=a;return l}function X4(e,r,s){var a=e.l+r,n=mr(e);n.r=s["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(s.cellFormula){e.l+=2;var o=ll(e,a-e.l,s);l[3]=ws(o,null,n,s.supbooks,s)}else e.l=a;return l}function J4(e,r,s){var a=e.l+r,n=mr(e);n.r=s["!row"];var i=Cs(e),l=[n,i,"n"];if(s.cellFormula){e.l+=2;var o=ll(e,a-e.l,s);l[3]=ws(o,null,n,s.supbooks,s)}else e.l=a;return l}function Z4(e,r,s){var a=e.l+r,n=mr(e);n.r=s["!row"];var i=_s(e),l=[n,i,"str"];if(s.cellFormula){e.l+=2;var o=ll(e,a-e.l,s);l[3]=ws(o,null,n,s.supbooks,s)}else e.l=a;return l}var Q4=ka,eC=sn;function tC(e,r){return r==null&&(r=ye(4)),r.write_shift(4,e),r}function sC(e,r){var s=e.l+r,a=ka(e),n=Vc(e),i=_s(e),l=_s(e),o=_s(e);e.l=s;var c={rfx:a,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function rC(e,r){var s=ye(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));sn({s:Kt(e[0]),e:Kt(e[0])},s),Gc("rId"+r,s);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return fs(n||"",s),fs(e[1].Tooltip||"",s),fs("",s),s.slice(0,s.l)}function aC(){}function nC(e,r,s){var a=e.l+r,n=qu(e),i=e.read_shift(1),l=[n];if(l[2]=i,s.cellFormula){var o=kE(e,a-e.l,s);l[1]=o}else e.l=a;return l}function iC(e,r,s){var a=e.l+r,n=ka(e),i=[n];if(s.cellFormula){var l=DE(e,a-e.l,s);i[1]=l,e.l=a}else e.l=a;return i}function lC(e,r,s){s==null&&(s=ye(18));var a=ol(e,r);s.write_shift(-4,e),s.write_shift(-4,e),s.write_shift(4,(a.width||10)*256),s.write_shift(4,0);var n=0;return r.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),r.level&&(n|=r.level<<8),s.write_shift(2,n),s}var Jh=["left","right","top","bottom","header","footer"];function oC(e){var r={};return Jh.forEach(function(s){r[s]=Cs(e)}),r}function cC(e,r){return r==null&&(r=ye(48)),ua(e),Jh.forEach(function(s){ba(e[s],r)}),r}function dC(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function mC(e,r,s){s==null&&(s=ye(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}function uC(e){var r=ye(24);return r.write_shift(4,4),r.write_shift(4,1),sn(e,r),r}function hC(e,r){return r==null&&(r=ye(66)),r.write_shift(2,e.password?Qc(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(s){s[1]?r.write_shift(4,e[s[0]]!=null&&!e[s[0]]?1:0):r.write_shift(4,e[s[0]]!=null&&e[s[0]]?0:1)}),r}function fC(){}function xC(){}function pC(e,r,s,a,n,i,l){if(!e)return e;var o=r||{};a||(a={"!id":{}});var c=o.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,h=!1,p,x,f,g,v,N,j,S,C,w=[];o.biff=12,o["!row"]=0;var y=0,T=!1,k=[],P={},A=o.supbooks||n.supbooks||[[]];if(A.sharedf=P,A.arrayf=k,A.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=A,n.Names))for(var _=0;_<n.Names.length;++_)A[0][_+1]=n.Names[_];var U=[],D=[],W=!1;Bn[16]={n:"BrtShortReal",f:Xh};var q;if(Br(e,function(H,je,ie){if(!h)switch(ie){case 148:d=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),S=as(g=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Ka(H.hpt)),D[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":j=bn[H[1]],x.v=j.t,x.r=j.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],o.cellText!==!1&&(x.w=zr[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((f=l.CellXf[H[0].iStyleRef])&&qh(x,f.numFmtId,null,o,i,l),v=H[0].c==-1?v+1:H[0].c,o.dense?(c[g]||(c[g]=[]),c[g][v]=x):c[Yt(v)+S]=x,o.cellFormula){for(T=!1,y=0;y<k.length;++y){var B=k[y];p.r>=B[0].s.r&&p.r<=B[0].e.r&&v>=B[0].s.c&&v<=B[0].e.c&&(x.F=dt(B[0]),T=!0)}!T&&H.length>3&&(x.f=H[3])}if(m.s.r>p.r&&(m.s.r=p.r),m.s.c>v&&(m.s.c=v),m.e.r<p.r&&(m.e.r=p.r),m.e.c<v&&(m.e.c=v),o.cellDates&&f&&x.t=="n"&&Qa(Je[f.numFmtId])){var V=ia(x.v);V&&(x.t="d",x.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;x={t:"z",v:void 0},v=H[0].c==-1?v+1:H[0].c,o.dense?(c[g]||(c[g]=[]),c[g][v]=x):c[Yt(v)+S]=x,m.s.r>p.r&&(m.s.r=p.r),m.s.c>v&&(m.s.c=v),m.e.r<p.r&&(m.e.r=p.r),m.e.c<v&&(m.e.c=v),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:w.push(H);break;case 49:q=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var z=a["!id"][H.relId];for(z?(H.Target=z.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=z):H.relId==""&&(H.Target="#"+H.loc),g=H.rfx.s.r;g<=H.rfx.e.r;++g)for(v=H.rfx.s.c;v<=H.rfx.e.c;++v)o.dense?(c[g]||(c[g]=[]),c[g][v]||(c[g][v]={t:"z",v:void 0}),c[g][v].l=H):(N=Qe({c:v,r:g}),c[N]||(c[N]={t:"z",v:void 0}),c[N].l=H);break;case 426:if(!o.cellFormula)break;k.push(H),C=o.dense?c[g][v]:c[Yt(v)+S],C.f=ws(H[1],m,{r:p.r,c:v},A,o),C.F=dt(H[0]);break;case 427:if(!o.cellFormula)break;P[Qe(H[0].s)]=H[1],C=o.dense?c[g][v]:c[Yt(v)+S],C.f=ws(H[1],m,{r:p.r,c:v},A,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)U[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},W||(W=!0,ed(H.w/256)),Kr(U[H.e+1]);break;case 161:c["!autofilter"]={ref:dt(H)};break;case 476:c["!margins"]=H;break;case 147:n.Sheets[s]||(n.Sheets[s]={}),H.name&&(n.Sheets[s].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),H.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!je.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=dt(d||m)),o.sheetRows&&c["!ref"]){var Y=yt(c["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>m.e.r&&(Y.e.r=m.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>m.e.c&&(Y.e.c=m.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=dt(Y))}return w.length>0&&(c["!merges"]=w),U.length>0&&(c["!cols"]=U),D.length>0&&(c["!rows"]=D),c}function gC(e,r,s,a,n,i,l){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Ut(r),r.z=r.z||Je[14],r.v=ms($t(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:s,c:a};switch(c.s=ta(n.cellXfs,r,n),r.l&&i["!links"].push([Qe(c),r.l]),r.c&&i["!comments"].push([Qe(c),r.c]),r.t){case"s":case"str":return n.bookSST?(o=nd(n.Strings,r.v,n.revStrings),c.t="s",c.v=o,l?Ce(e,18,O4(r,c)):Ce(e,7,R4(r,c))):(c.t="str",l?Ce(e,17,Y4(r,c)):Ce(e,6,G4(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?l?Ce(e,13,W4(r,c)):Ce(e,2,$4(r,c)):l?Ce(e,16,B4(r,c)):Ce(e,5,M4(r,c)),!0;case"b":return c.t="b",l?Ce(e,15,_4(r,c)):Ce(e,4,E4(r,c)),!0;case"e":return c.t="e",l?Ce(e,14,I4(r,c)):Ce(e,3,A4(r,c)),!0}return l?Ce(e,12,S4(r,c)):Ce(e,1,N4(r,c)),!0}function vC(e,r,s,a){var n=yt(r["!ref"]||"A1"),i,l="",o=[];Ce(e,145);var c=Array.isArray(r),d=n.e.r;r["!rows"]&&(d=Math.max(n.e.r,r["!rows"].length-1));for(var m=n.s.r;m<=d;++m){l=as(m),x4(e,r,n,m);var u=!1;if(m<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){m===n.s.r&&(o[h]=Yt(h)),i=o[h]+l;var p=c?(r[m]||[])[h]:r[i];if(!p){u=!1;continue}u=gC(e,p,m,h,a,r,u)}}Ce(e,146)}function bC(e,r){!r||!r["!merges"]||(Ce(e,177,tC(r["!merges"].length)),r["!merges"].forEach(function(s){Ce(e,176,eC(s))}),Ce(e,178))}function jC(e,r){!r||!r["!cols"]||(Ce(e,390),r["!cols"].forEach(function(s,a){s&&Ce(e,60,lC(a,s))}),Ce(e,391))}function yC(e,r){!r||!r["!ref"]||(Ce(e,648),Ce(e,649,uC(yt(r["!ref"]))),Ce(e,650))}function NC(e,r,s){r["!links"].forEach(function(a){if(a[1].Target){var n=kt(s,-1,a[1].Target.replace(/#.*$/,""),ft.HLINK);Ce(e,494,rC(a,n))}}),delete r["!links"]}function wC(e,r,s,a){if(r["!comments"].length>0){var n=kt(a,-1,"../drawings/vmlDrawing"+(s+1)+".vml",ft.VML);Ce(e,551,Gc("rId"+n)),r["!legacy"]=n}}function SC(e,r,s,a){if(r["!autofilter"]){var n=r["!autofilter"],i=typeof n.ref=="string"?n.ref:dt(n.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var l=s.Workbook.Names,o=Ys(i);o.s.r==o.e.r&&(o.e.r=Ys(r["!ref"]).e.r,i=dt(o));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+s.SheetNames[a]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+i}),Ce(e,161,sn(yt(i))),Ce(e,162)}}function TC(e,r,s){Ce(e,133),Ce(e,137,mC(r,s)),Ce(e,138),Ce(e,134)}function EC(e,r){r["!protect"]&&Ce(e,535,hC(r["!protect"]))}function CC(e,r,s,a){var n=qs(),i=s.SheetNames[e],l=s.Sheets[i]||{},o=i;try{s&&s.Workbook&&(o=s.Workbook.Sheets[e].CodeName||o)}catch{}var c=yt(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ce(n,129),(s.vbaraw||l["!outline"])&&Ce(n,147,j4(o,l["!outline"])),Ce(n,148,g4(c)),TC(n,l,s.Workbook),jC(n,l),vC(n,l,e,r),EC(n,l),SC(n,l,s,e),bC(n,l),NC(n,l,a),l["!margins"]&&Ce(n,476,cC(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&yC(n,l),wC(n,l,e,a),Ce(n,130),n.end()}function _C(e){var r=[],s=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(r[+l[1]]=s?+l[2]:l[2])});var n=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[r,n,a]}function kC(e,r,s,a,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var h=_C(u);m.s.r=m.s.c=0,m.e.c=o,d=Yt(o),h[0].forEach(function(p,x){l[d+as(x)]={t:"n",v:p,z:h[1]},c=x}),m.e.r<c&&(m.e.r=c),++o}),o>0&&(l["!ref"]=dt(m)),l}function AC(e,r,s,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(Yh);return o&&id(o[0],i,n,s),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function DC(e,r){e.l+=10;var s=_s(e);return{name:s}}function IC(e,r,s,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Br(e,function(c,d,m){switch(m){case 550:i["!rel"]=c;break;case 651:n.Sheets[s]||(n.Sheets[s]={}),c.name&&(n.Sheets[s].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},r),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var ld=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],RC=[],FC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Um(e,r){for(var s=0;s!=e.length;++s)for(var a=e[s],n=0;n!=r.length;++n){var i=r[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Mt(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Wm(e,r){for(var s=0;s!=r.length;++s){var a=r[s];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Mt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Zh(e){Wm(e.WBProps,ld),Wm(e.CalcPr,FC),Um(e.WBView,PC),Um(e.Sheets,RC),Wa.date1904=Mt(e.WBProps.date1904)}function OC(e){return!e.Workbook||!e.Workbook.WBProps?"false":Mt(e.Workbook.WBProps.date1904)?"true":"false"}var LC="][*?/\\".split("");function Qh(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return LC.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}function MC(e,r,s){e.forEach(function(a,n){Qh(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(s){var l=r&&r[n]&&r[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function BC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];MC(e.SheetNames,r,!!e.vbaraw);for(var s=0;s<e.SheetNames.length;++s)OE(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}var zC=/<\w+:workbook/;function $C(e,r){if(!e)throw new Error("Could not find file");var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(e.replace(Ds,function(c,d){var m=st(c);switch(_r(m[0])){case"<?xml":break;case"<workbook":c.match(zC)&&(n="xmlns"+c.match(/<(\w+):/)[1]),s.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],s.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ld.forEach(function(u){if(m[u[0]]!=null)switch(u[2]){case"bool":s.WBProps[u[0]]=Mt(m[u[0]]);break;case"int":s.WBProps[u[0]]=parseInt(m[u[0]],10);break;default:s.WBProps[u[0]]=m[u[0]]}}),m.codeName&&(s.WBProps.CodeName=Ft(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],s.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=jt(Ft(m.name)),delete m[0],s.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Ft(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),Mt(m.hidden||"0")&&(i.Hidden=!0),l=d+c.length;break;case"</definedName>":i.Ref=jt(Ft(e.slice(l,d))),s.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],s.CalcPr=m;break;case"<calcPr/>":delete m[0],s.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return c}),Ta.indexOf(s.xmlns)===-1)throw new Error("Unknown Namespace: "+s.xmlns);return Zh(s),s}function ef(e){var r=[ns];r[r.length]=Fe("workbook",null,{xmlns:Ta[0],"xmlns:r":cs.r});var s=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ld.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=Fe("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:At(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}r[r.length]=Fe("sheet",null,l)}return r[r.length]="</sheets>",s&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=Fe("definedName",At(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function UC(e,r){var s={};return s.Hidden=e.read_shift(4),s.iTabID=e.read_shift(4),s.strRelID=lc(e),s.name=_s(e),s}function WC(e,r){return r||(r=ye(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),Gc(e.strRelID,r),fs(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function HC(e,r){var s={},a=e.read_shift(4);s.defaultThemeVersion=e.read_shift(4);var n=r>8?_s(e):"";return n.length>0&&(s.CodeName=n),s.autoCompressPictures=!!(a&65536),s.backupFile=!!(a&64),s.checkCompatibility=!!(a&4096),s.date1904=!!(a&1),s.filterPrivacy=!!(a&8),s.hidePivotFieldList=!!(a&1024),s.promptedSolutions=!!(a&16),s.publishItems=!!(a&2048),s.refreshAllConnections=!!(a&262144),s.saveExternalLinkValues=!!(a&128),s.showBorderUnselectedTables=!!(a&4),s.showInkAnnotation=!!(a&32),s.showObjects=["all","placeholders","none"][a>>13&3],s.showPivotChartFilter=!!(a&32768),s.updateLinks=["userSet","never","always"][a>>8&3],s}function VC(e,r){r||(r=ye(72));var s=0;return e&&e.filterPrivacy&&(s|=8),r.write_shift(4,s),r.write_shift(4,0),Vu(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function GC(e,r){var s={};return e.read_shift(4),s.ArchID=e.read_shift(4),e.l+=r-8,s}function qC(e,r,s){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),i=wy(e),l=AE(e,0,s),o=Vc(e);e.l=a;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function YC(e,r){var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Bn[16]={n:"BrtFRTArchID$",f:GC},Br(e,function(c,d,m){switch(m){case 156:l.SheetNames.push(c.name),s.Sheets.push(c);break;case 153:s.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=ws(c.Ptg,null,null,l,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,c]):l[0]=[m,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},r),Zh(s),s.Names=i,s.supbooks=l,s}function KC(e,r){Ce(e,143);for(var s=0;s!=r.SheetNames.length;++s){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[s]&&r.Workbook.Sheets[s].Hidden||0,n={Hidden:a,iTabID:s+1,strRelID:"rId"+(s+1),name:r.SheetNames[s]};Ce(e,156,WC(n))}Ce(e,144)}function XC(e,r){r||(r=ye(127));for(var s=0;s!=4;++s)r.write_shift(4,0);return fs("SheetJS",r),fs(Di.version,r),fs(Di.version,r),fs("7262",r),r.length>r.l?r.slice(0,r.l):r}function JC(e,r){r||(r=ye(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var s=120;return r.write_shift(1,s),r.length>r.l?r.slice(0,r.l):r}function ZC(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var s=r.Workbook.Sheets,a=0,n=-1,i=-1;a<s.length;++a)!s[a]||!s[a].Hidden&&n==-1?n=a:s[a].Hidden==1&&i==-1&&(i=a);i>n||(Ce(e,135),Ce(e,158,JC(n)),Ce(e,136))}}function QC(e,r){var s=qs();return Ce(s,131),Ce(s,128,XC()),Ce(s,153,VC(e.Workbook&&e.Workbook.WBProps||null)),ZC(s,e),KC(s,e),Ce(s,132),s.end()}function e5(e,r,s){return r.slice(-4)===".bin"?YC(e,s):$C(e,s)}function t5(e,r,s,a,n,i,l,o){return r.slice(-4)===".bin"?pC(e,a,s,n,i,l,o):qE(e,a,s,n,i,l,o)}function s5(e,r,s,a,n,i,l,o){return r.slice(-4)===".bin"?IC(e,a,s,n,i):AC(e,a,s,n,i)}function r5(e,r,s,a,n,i,l,o){return r.slice(-4)===".bin"?nT():iT()}function a5(e,r,s,a,n,i,l,o){return r.slice(-4)===".bin"?rT():aT()}function n5(e,r,s,a){return r.slice(-4)===".bin"?eS(e,s,a):Uw(e,s,a)}function i5(e,r,s){return Rh(e,s)}function l5(e,r,s){return r.slice(-4)===".bin"?lw(e,s):aw(e,s)}function o5(e,r,s){return r.slice(-4)===".bin"?ZS(e,s):WS(e,s)}function c5(e,r,s){return r.slice(-4)===".bin"?zS(e):MS(e)}function d5(e,r,s,a){return s.slice(-4)===".bin"?$S(e,r,s,a):void 0}function m5(e,r,s){return r.slice(-4)===".bin"?FS(e,r,s):LS(e,r,s)}function u5(e,r,s){return(r.slice(-4)===".bin"?QC:ef)(e)}function h5(e,r,s,a,n){return(r.slice(-4)===".bin"?CC:Kh)(e,s,a,n)}function f5(e,r,s){return(r.slice(-4)===".bin"?dS:Ih)(e,s)}function x5(e,r,s){return(r.slice(-4)===".bin"?dw:Sh)(e,s)}function p5(e,r,s){return(r.slice(-4)===".bin"?QS:Lh)(e)}function g5(e){return(e.slice(-4)===".bin"?OS:Fh)()}var tf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ur(e,r){var s=e.split(/\s+/),a=[];if(a[0]=s[0],s.length===1)return a;var n=e.match(tf),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(sf),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function v5(e){var r=e.split(/\s+/),s={};if(r.length===1)return s;var a=e.match(tf),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(sf),(i=n[1].indexOf(":"))===-1?s[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),s[l]=n[2].slice(1,n[2].length-1));return s}var yn;function b5(e,r){var s=yn[e]||jt(e);return s==="General"?ga(r):dr(s,r)}function j5(e,r,s,a){var n=a;switch((s[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Mt(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=$t(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+s[0])}e[jt(r)]=n}function y5(e,r,s){if(e.t!=="z"){if(!s||s.cellText!==!1)try{e.t==="e"?e.w=e.w||zr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v):e.w=ga(e.v):e.w=b5(r||"General",e.v)}catch(i){if(s.WTF)throw i}try{var a=yn[r]||r||"General";if(s.cellNF&&(e.z=a),s.cellDates&&e.t=="n"&&Qa(a)){var n=ia(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(s.WTF)throw i}}}function N5(e,r,s){if(s.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Rw[a.Pattern]||a.Pattern)}e[r.ID]=r}function w5(e,r,s,a,n,i,l,o,c,d){var m="General",u=a.StyleID,h={};d=d||{};var p=[],x=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&l&&(u=l.StyleID);i[u]!==void 0&&(i[u].nf&&(m=i[u].nf),i[u].Interior&&p.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(s.Type){case"Boolean":a.t="b",a.v=Mt(e);break;case"String":a.t="s",a.r=im(jt(e)),a.v=e.indexOf("<")>-1?jt(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=($t(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=jt(e):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Xu[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=im(r||e));break}if(y5(a,m,d),d.cellFormula!==!1)if(a.Formula){var f=jt(a.Formula);f.charCodeAt(0)==61&&(f=f.slice(1)),a.f=Ua(f,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Ua("RC:RC",n):a.ArrayRange&&(a.F=Ua(a.ArrayRange,n),c.push([yt(a.F),a.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(a.F=c[x][1]);d.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function S5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Cl(e,r){var s=r||{};en();var a=un(Bc(e));(s.type=="binary"||s.type=="array"||s.type=="base64")&&(a=Ft(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Ut(s);return l.type="string",Ya.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){n.indexOf("<"+Me)>=0&&(i=!0)}),i)return c_(a,s);yn={"General Number":"General","General Date":Je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Je[15],"Short Date":Je[14],"Long Time":Je[19],"Medium Time":Je[18],"Short Time":Je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Je[2],Standard:Je[4],Percent:Je[10],Scientific:Je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,m={},u=[],h=s.dense?[]:{},p="",x={},f={},g=ur('<Data ss:Type="String">'),v=0,N=0,j=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},w={},y="",T=0,k=[],P={},A={},_=0,U=[],D=[],W={},q=[],Y,K=!1,H=[],je=[],ie={},B=0,V=0,z={Sheets:[],WBProps:{date1904:!1}},L={};Pn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=Pn.exec(a);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?w5(a.slice(v,o.index),y,g,c[c.length-1][0]=="comment"?W:x,{c:N,r:j},C,q[N],f,H,s):(y="",g=ur(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(D.length>0&&(x.c=D),(!s.sheetRows||s.sheetRows>j)&&x.v!==void 0&&(s.dense?(h[j]||(h[j]=[]),h[j][N]=x):h[Yt(N)+as(j)]=x),x.HRef&&(x.l={Target:jt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=N+(parseInt(x.MergeAcross,10)|0),V=j+(parseInt(x.MergeDown,10)|0),k.push({s:{c:N,r:j},e:{c:B,r:V}})),!s.sheetStubs)x.MergeAcross?N=B+1:++N;else if(x.MergeAcross||x.MergeDown){for(var ne=N;ne<=B;++ne)for(var ue=j;ue<=V;++ue)(ne>N||ue>j)&&(s.dense?(h[ue]||(h[ue]=[]),h[ue][ne]={t:"z"}):h[Yt(ne)+as(ue)]={t:"z"});N=B+1}else++N;else x=v5(o[0]),x.Index&&(N=+x.Index-1),N<S.s.c&&(S.s.c=N),N>S.e.c&&(S.e.c=N),o[0].slice(-2)==="/>"&&++N,D=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(j<S.s.r&&(S.s.r=j),j>S.e.r&&(S.e.r=j),o[0].slice(-2)==="/>"&&(f=ur(o[0]),f.Index&&(j=+f.Index-1)),N=0,++j):(f=ur(o[0]),f.Index&&(j=+f.Index-1),ie={},(f.AutoFitHeight=="0"||f.Height)&&(ie.hpx=parseInt(f.Height,10),ie.hpt=Mn(ie.hpx),je[j]=ie),f.Hidden=="1"&&(ie.hidden=!0,je[j]=ie));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));u.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=dt(S),s.sheetRows&&s.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=s.sheetRows-1,h["!ref"]=dt(S))),k.length&&(h["!merges"]=k),q.length>0&&(h["!cols"]=q),je.length>0&&(h["!rows"]=je),m[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=N=0,c.push([o[3],!1]),d=ur(o[0]),p=jt(d.Name),h=s.dense?[]:{},k=[],H=[],je=[],L={name:p,Hidden:0},z.Sheets.push(L);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),q=[],K=!1}break;case"style":o[1]==="/"?N5(C,w,s):w=ur(o[0]);break;case"numberformat":w.nf=jt(ur(o[0]).Format||"General"),yn[w.nf]&&(w.nf=yn[w.nf]);for(var Ne=0;Ne!=392&&Je[Ne]!=w.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(Je[Ne]==null){Pr(w.nf,Ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=ur(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!K&&Y.wpx>10){K=!0,Ts=Ah;for(var ae=0;ae<q.length;++ae)q[ae]&&Kr(q[ae])}K&&Kr(Y),q[Y.Index-1||q.length]=Y;for(var re=0;re<+Y.Span;++re)q[q.length]=Ut(Y);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var M=st(o[0]),_e={Name:M.Name,Ref:Ua(M.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(_e.Sheet=z.Sheets.length-1),z.Names.push(_e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=a.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!s.cellStyles)break;w.Interior=ur(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Yy(P,te,a.slice(_,o.index)):_=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));S5(W),D.push(W)}else c.push([o[3],!1]),d=ur(o[0]),W={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=ur(o[0]);h["!autofilter"]={ref:Ua(ke.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Ym(a,s);var ze=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(_,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else _=o.index+o[0].length;break;case"header":h["!margins"]||ua(h["!margins"]={},"xlml"),isNaN(+st(o[0]).Margin)||(h["!margins"].header=+st(o[0]).Margin);break;case"footer":h["!margins"]||ua(h["!margins"]={},"xlml"),isNaN(+st(o[0]).Margin)||(h["!margins"].footer=+st(o[0]).Margin);break;case"pagemargins":var ce=st(o[0]);h["!margins"]||ua(h["!margins"]={},"xlml"),isNaN(+ce.Top)||(h["!margins"].top=+ce.Top),isNaN(+ce.Left)||(h["!margins"].left=+ce.Left),isNaN(+ce.Right)||(h["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(h["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ze=!1}break;case"smarttags":break;default:ze=!1;break}if(ze||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?j5(A,te,U,a.slice(_,o.index)):(U=o,_=o.index+o[0].length);break}if(s.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Se={};return!s.bookSheets&&!s.bookProps&&(Se.Sheets=m),Se.SheetNames=u,Se.Workbook=z,Se.SSF=Ut(Je),Se.Props=P,Se.Custprops=A,Se}function fc(e,r){switch(cd(r=r||{}),r.type||"base64"){case"base64":return Cl(er(e),r);case"binary":case"buffer":case"file":return Cl(e,r);case"array":return Cl(Qr(e),r)}}function T5(e,r){var s=[];return e.Props&&s.push(Ky(e.Props,r)),e.Custprops&&s.push(Xy(e.Props,e.Custprops)),s.join("")}function E5(){return""}function C5(e,r){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,n){var i=[];i.push(Fe("NumberFormat",null,{"ss:Format":At(Je[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};s.push(Fe("Style",i.join(""),l))}),Fe("Styles",s.join(""))}function rf(e){return Fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+rd(e.Ref,{r:0,c:0})})}function _5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,s=[],a=0;a<r.length;++a){var n=r[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||s.push(rf(n)))}return Fe("Names",s.join(""))}function k5(e,r,s,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==s&&(o.Name.match(/^_xlfn\./)||i.push(rf(o)))}return i.join("")}function A5(e,r,s,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Fe("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[s])if(a.Workbook.Sheets[s].Hidden)n.push(Fe("Visible",a.Workbook.Sheets[s].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<s&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==s&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(vs("ProtectContents","True")),e["!protect"].objects&&n.push(vs("ProtectObjects","True")),e["!protect"].scenarios&&n.push(vs("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(vs("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(vs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Fe("WorksheetOptions",n.join(""),{xmlns:Xs.x})}function D5(e){return e.map(function(r){var s=Zj(r.t||""),a=Fe("ss:Data",s,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",a,{"ss:Author":r.a})}).join("")}function I5(e,r,s,a,n,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+At(rd(e.f,l))),e.F&&e.F.slice(0,r.length)==r){var c=Kt(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=At(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=At(e.l.Tooltip))),s["!merges"])for(var d=s["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(o["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(o["ss:MergeDown"]=d[m].e.r-d[m].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=zr[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Je[14]);break;case"s":u="String",h=Jj(e.v||"");break}var p=ta(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=l.c+1;var x=e.v!=null?h:"",f=e.t=="z"?"":'<Data ss:Type="'+u+'">'+x+"</Data>";return(e.c||[]).length>0&&(f+=D5(e.c)),Fe("Cell",f,o)}function P5(e,r){var s='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ka(r.hpt)),r.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(s+=' ss:Hidden="1"')),s+">"}function R5(e,r,s,a){if(!e["!ref"])return"";var n=yt(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Kr(g);var N=!!g.width,j=ol(v,g),S={"ss:Index":v+1};N&&(S["ss:Width"]=On(j.width)),g.hidden&&(S["ss:Hidden"]="1"),o.push(Fe("Column",null,S))});for(var c=Array.isArray(e),d=n.s.r;d<=n.e.r;++d){for(var m=[P5(d,(e["!rows"]||[])[d])],u=n.s.c;u<=n.e.c;++u){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>u)&&!(i[l].s.r>d)&&!(i[l].e.c<u)&&!(i[l].e.r<d)){(i[l].s.c!=u||i[l].s.r!=d)&&(h=!0);break}if(!h){var p={r:d,c:u},x=Qe(p),f=c?(e[d]||[])[u]:e[x];m.push(I5(f,x,e,r,s,a,p))}}m.push("</Row>"),m.length>2&&o.push(m.join(""))}return o.join("")}function F5(e,r,s){var a=[],n=s.SheetNames[e],i=s.Sheets[n],l=i?k5(i,r,e,s):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?R5(i,r,e,s):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(A5(i,r,e,s)),a.join("")}function O5(e,r){r||(r={}),e.SSF||(e.SSF=Ut(Je)),e.SSF&&(en(),tl(e.SSF),r.revssf=rl(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ta(r.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(T5(e,r)),s.push(E5()),s.push(""),s.push("");for(var a=0;a<e.SheetNames.length;++a)s.push(Fe("Worksheet",F5(a,r,e),{"ss:Name":At(e.SheetNames[a])}));return s[2]=C5(e,r),s[3]=_5(e),ns+Fe("Workbook",s.join(""),{xmlns:Xs.ss,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:ss":Xs.ss,"xmlns:dt":Xs.dt,"xmlns:html":Xs.html})}function L5(e){var r={},s=e.content;if(s.l=28,r.AnsiUserType=s.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=_y(s),s.length-s.l<=4)return r;var a=s.read_shift(4);if(a==0||a>40||(s.l-=4,r.Reserved1=s.read_shift(0,"lpstr-ansi"),s.length-s.l<=4)||(a=s.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=ky(s),a=s.read_shift(4),a==0||a>40))return r;s.l-=4,r.Reserved2=s.read_shift(0,"lpwstr")}var M5=[60,1084,2066,2165,2175];function B5(e,r,s,a,n){var i=a,l=[],o=s.slice(s.l,s.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),s.l+=i;for(var c=Dr(s,s.l),d=xc[c],m=0;d!=null&&M5.indexOf(c)>-1;)i=Dr(s,s.l+2),m=s.l+4,c==2066?m+=4:(c==2165||c==2175)&&(m+=12),o=s.slice(m,s.l+4+i),l.push(o),s.l+=4+i,d=xc[c=Dr(s,s.l)];var u=hs(l);gs(u,0);var h=0;u.lens=[];for(var p=0;p<l.length;++p)u.lens.push(h),h+=l[p].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return r.f(u,u.length,n)}function Nr(e,r,s){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=Je[a])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v):e.w=ga(e.v):e.w=dr(a,e.v,{date1904:!!s,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&a&&e.t=="n"&&Qa(Je[a]||String(a))){var n=ia(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function yi(e,r,s){return{v:e,ixfe:r,t:s}}function z5(e,r){var s={opts:{}},a={},n=r.dense?[]:{},i={},l={},o=null,c=[],d="",m={},u,h="",p,x,f,g,v={},N=[],j,S,C=[],w=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=function(We){return We<8?ca[We]:We<64&&w[We-8]||ca[We]},P=function(We,at,Ie){var Ke=at.XF.data;if(!(!Ke||!Ke.patternType||!Ie||!Ie.cellStyles)){at.s={},at.s.patternType=Ke.patternType;var pt;(pt=Fn(k(Ke.icvFore)))&&(at.s.fgColor={rgb:pt}),(pt=Fn(k(Ke.icvBack)))&&(at.s.bgColor={rgb:pt})}},A=function(We,at,Ie){if(!(ie>1)&&!(Ie.sheetRows&&We.r>=Ie.sheetRows)){if(Ie.cellStyles&&at.XF&&at.XF.data&&P(We,at,Ie),delete at.ixfe,delete at.XF,u=We,h=Qe(We),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),We.r<l.s.r&&(l.s.r=We.r),We.c<l.s.c&&(l.s.c=We.c),We.r+1>l.e.r&&(l.e.r=We.r+1),We.c+1>l.e.c&&(l.e.c=We.c+1),Ie.cellFormula&&at.f){for(var Ke=0;Ke<N.length;++Ke)if(!(N[Ke][0].s.c>We.c||N[Ke][0].s.r>We.r)&&!(N[Ke][0].e.c<We.c||N[Ke][0].e.r<We.r)){at.F=dt(N[Ke][0]),(N[Ke][0].s.c!=We.c||N[Ke][0].s.r!=We.r)&&delete at.f,at.f&&(at.f=""+ws(N[Ke][1],l,We,H,_));break}}Ie.dense?(n[We.r]||(n[We.r]=[]),n[We.r][We.c]=at):n[h]=at}},_={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(_.password=r.password);var U,D=[],W=[],q=[],Y=[],K=!1,H=[];H.SheetNames=_.snames,H.sharedf=_.sharedf,H.arrayf=_.arrayf,H.names=[],H.XTI=[];var je=0,ie=0,B=0,V=[],z=[],L;_.codepage=1200,fr(1200);for(var te=!1;e.l<e.length-1;){var ne=e.l,ue=e.read_shift(2);if(ue===0&&je===10)break;var Ne=e.l===e.length?0:e.read_shift(2),ae=xc[ue];if(ae&&ae.f){if(r.bookSheets&&je===133&&ue!==133)break;if(je=ue,ae.r===2||ae.r==12){var re=e.read_shift(2);if(Ne-=2,!_.enc&&re!==ue&&((re&255)<<8|re>>8)!==ue)throw new Error("rt mismatch: "+re+"!="+ue);ae.r==12&&(e.l+=10,Ne-=10)}var M={};if(ue===10?M=ae.f(e,Ne,_):M=B5(ue,ae,e,Ne,_),ie==0&&[9,521,1033,2057].indexOf(je)===-1)continue;switch(ue){case 34:s.opts.Date1904=y.WBProps.date1904=M;break;case 134:s.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=M,!r.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=M;break;case 66:var _e=Number(M);switch(_e){case 21010:_e=1200;break;case 32768:_e=1e4;break;case 32769:_e=1252;break}fr(_.codepage=_e),te=!0;break;case 317:_.rrtabid=M;break;case 25:_.winlocked=M;break;case 439:s.opts.RefreshAll=M;break;case 12:s.opts.CalcCount=M;break;case 16:s.opts.CalcDelta=M;break;case 17:s.opts.CalcIter=M;break;case 13:s.opts.CalcMode=M;break;case 14:s.opts.CalcPrecision=M;break;case 95:s.opts.CalcSaveRecalc=M;break;case 15:_.CalcRefMode=M;break;case 2211:s.opts.FullCalc=M;break;case 129:M.fDialog&&(n["!type"]="dialog"),M.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),M.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:C.push(M);break;case 430:H.push([M]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(M);break;case 24:case 536:L={Name:M.Name,Ref:ws(M.rgce,l,null,H,_)},M.itab>0&&(L.Sheet=M.itab-1),H.names.push(L),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(z[M.itab-1]={ref:dt(M.rgce[0][0][1][2])});break;case 22:_.ExternCount=M;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(M),H.XTI=H.XTI.concat(M);break;case 2196:if(_.biff<8)break;L!=null&&(L.Comment=M[1]);break;case 18:n["!protect"]=M;break;case 19:M!==0&&_.WTF&&console.error("Password verifier: "+M);break;case 133:i[M.pos]=M,_.snames.push(M.name);break;case 10:{if(--ie)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=dt(l),r.sheetRows&&r.sheetRows<=l.e.r){var ke=l.e.r;l.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=dt(l),l.e.r=ke}l.e.r++,l.e.c++}D.length>0&&(n["!merges"]=D),W.length>0&&(n["!objects"]=W),q.length>0&&(n["!cols"]=q),Y.length>0&&(n["!rows"]=Y),y.Sheets.push(T)}d===""?m=n:a[d]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),_.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(_.biff=5,te=!0,fr(_.codepage=28591)),_.biff==8&&M.BIFFVer==0&&M.dt==16&&(_.biff=2),ie++)break;if(n=r.dense?[]:{},_.biff<8&&!te&&(te=!0,fr(_.codepage=r.codepage||1252)),_.biff<5||M.BIFFVer==0&&M.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ze={pos:e.l-Ne,name:d};i[ze.pos]=ze,_.snames.push(d)}else d=(i[ne]||{name:""}).name;M.dt==32&&(n["!type"]="chart"),M.dt==64&&(n["!type"]="macro"),D=[],W=[],_.arrayf=N=[],q=[],Y=[],K=!1,T={Hidden:(i[ne]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[M.r]||[])[M.c]:n[Qe({c:M.c,r:M.r})])&&++M.c,j={ixfe:M.ixfe,XF:C[M.ixfe]||{},v:M.val,t:"n"},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r);break;case 5:case 517:j={ixfe:M.ixfe,XF:C[M.ixfe],v:M.val,t:M.t},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r);break;case 638:j={ixfe:M.ixfe,XF:C[M.ixfe],v:M.rknum,t:"n"},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r);break;case 189:for(var ce=M.c;ce<=M.C;++ce){var Se=M.rkrec[ce-M.c][0];j={ixfe:Se,XF:C[Se],v:M.rkrec[ce-M.c][1],t:"n"},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:ce,r:M.r},j,r)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(j=yi(M.val,M.cell.ixfe,M.tt),j.XF=C[j.ixfe],r.cellFormula){var Me=M.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var Ve=Me[0][0][1][0],Ue=Me[0][0][1][1],Tt=Qe({r:Ve,c:Ue});v[Tt]?j.f=""+ws(M.formula,l,M.cell,H,_):j.F=((r.dense?(n[Ve]||[])[Ue]:n[Tt])||{}).F}else j.f=""+ws(M.formula,l,M.cell,H,_)}B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A(M.cell,j,r),o=M}break;case 7:case 519:if(o)o.val=M,j=yi(M,o.cell.ixfe,"s"),j.XF=C[j.ixfe],r.cellFormula&&(j.f=""+ws(o.formula,l,o.cell,H,_)),B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A(o.cell,j,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(M);var ot=Qe(M[0].s);if(p=r.dense?(n[M[0].s.r]||[])[M[0].s.c]:n[ot],r.cellFormula&&p){if(!o||!ot||!p)break;p.f=""+ws(M[1],l,M[0],H,_),p.F=dt(M[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;v[Qe(o.cell)]=M[0],p=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[Qe(o.cell)],(p||{}).f=""+ws(M[0],l,u,H,_)}}break;case 253:j=yi(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(j.h=c[M.isst].h),j.XF=C[j.ixfe],B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r);break;case 513:r.sheetStubs&&(j={ixfe:M.ixfe,XF:C[M.ixfe],t:"z"},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r));break;case 190:if(r.sheetStubs)for(var he=M.c;he<=M.C;++he){var me=M.ixfe[he-M.c];j={ixfe:me,XF:C[me],t:"z"},B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:he,r:M.r},j,r)}break;case 214:case 516:case 4:j=yi(M.val,M.ixfe,"s"),j.XF=C[j.ixfe],B>0&&(j.z=V[j.ixfe>>8&63]),Nr(j,r,s.opts.Date1904),A({c:M.c,r:M.r},j,r);break;case 0:case 512:ie===1&&(l=M);break;case 252:c=M;break;case 1054:if(_.biff==4){V[B++]=M[1];for(var Be=0;Be<B+163&&Je[Be]!=M[1];++Be);Be>=163&&Pr(M[1],B+163)}else Pr(M[1],M[0]);break;case 30:{V[B++]=M;for(var ht=0;ht<B+163&&Je[ht]!=M;++ht);ht>=163&&Pr(M,B+163)}break;case 229:D=D.concat(M);break;case 93:W[M.cmo[0]]=_.lastobj=M;break;case 438:_.lastobj.TxO=M;break;case 127:_.lastobj.ImData=M;break;case 440:for(g=M[0].s.r;g<=M[0].e.r;++g)for(f=M[0].s.c;f<=M[0].e.c;++f)p=r.dense?(n[g]||[])[f]:n[Qe({c:f,r:g})],p&&(p.l=M[1]);break;case 2048:for(g=M[0].s.r;g<=M[0].e.r;++g)for(f=M[0].s.c;f<=M[0].e.c;++f)p=r.dense?(n[g]||[])[f]:n[Qe({c:f,r:g})],p&&p.l&&(p.l.Tooltip=M[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;p=r.dense?(n[M[0].r]||[])[M[0].c]:n[Qe(M[0])];var tt=W[M[2]];p||(r.dense?(n[M[0].r]||(n[M[0].r]=[]),p=n[M[0].r][M[0].c]={t:"z"}):p=n[Qe(M[0])]={t:"z"},l.e.r=Math.max(l.e.r,M[0].r),l.s.r=Math.min(l.s.r,M[0].r),l.e.c=Math.max(l.e.c,M[0].c),l.s.c=Math.min(l.s.c,M[0].c)),p.c||(p.c=[]),x={a:M[1],t:tt.TxO.t},p.c.push(x)}break;case 2173:CS(C[M.ixfe],M.ext);break;case 125:{if(!_.cellStyles)break;for(;M.e>=M.s;)q[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},K||(K=!0,ed(M.w/256)),Kr(q[M.e+1])}break;case 520:{var Xe={};M.level!=null&&(Y[M.r]=Xe,Xe.level=M.level),M.hidden&&(Y[M.r]=Xe,Xe.hidden=!0),M.hpt&&(Y[M.r]=Xe,Xe.hpt=M.hpt,Xe.hpx=Ka(M.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ua(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=M;break;case 161:n["!margins"]||ua(n["!margins"]={}),n["!margins"].header=M.header,n["!margins"].footer=M.footer;break;case 574:M.RTL&&(y.Views[0].RTL=!0);break;case 146:w=M;break;case 2198:U=M;break;case 140:S=M;break;case 442:d?T.CodeName=M||T.name:y.WBProps.CodeName=M||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=Ne}return s.SheetNames=es(i).sort(function(Rt,We){return Number(Rt)-Number(We)}).map(function(Rt){return i[Rt].name}),r.bookSheets||(s.Sheets=a),!s.SheetNames.length&&m["!ref"]?(s.SheetNames.push("Sheet1"),s.Sheets&&(s.Sheets.Sheet1=m)):s.Preamble=m,s.Sheets&&z.forEach(function(Rt,We){s.Sheets[s.SheetNames[We]]["!autofilter"]=Rt}),s.Strings=c,s.SSF=Ut(Je),_.enc&&(s.Encryption=_.enc),U&&(s.Themes=U),s.Metadata={},S!==void 0&&(s.Metadata.Country=S),H.names.length>0&&(y.Names=H.names),s.Workbook=y,s}var Nn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $5(e,r,s){var a=Ye.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Sm(a,oc,Nn.DSI);for(var i in n)r[i]=n[i]}catch(d){if(s.WTF)throw d}var l=Ye.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Sm(l,cc,Nn.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(d){if(s.WTF)throw d}r.HeadingPairs&&r.TitlesOfParts&&(sh(r.HeadingPairs,r.TitlesOfParts,r,s),delete r.HeadingPairs,delete r.TitlesOfParts)}function U5(e,r){var s=[],a=[],n=[],i=0,l,o=em(oc,"n"),c=em(cc,"n");if(e.Props)for(l=es(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?s:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=es(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?s:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<n.length;++i)ch.indexOf(n[i][0])>-1||th.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);a.length&&Ye.utils.cfb_add(r,"/SummaryInformation",Tm(a,Nn.SI,c,cc)),(s.length||d.length)&&Ye.utils.cfb_add(r,"/DocumentSummaryInformation",Tm(s,Nn.DSI,o,oc,d.length?d:null,Nn.UDI))}function af(e,r){r||(r={}),cd(r),Ac(),r.codepage&&kc(r.codepage);var s,a;if(e.FullPaths){if(Ye.find(e,"/encryption"))throw new Error("File is password-protected");s=Ye.find(e,"!CompObj"),a=Ye.find(e,"/Workbook")||Ye.find(e,"/Book")}else{switch(r.type){case"base64":e=Zs(er(e));break;case"binary":e=Zs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}gs(e,0),a={content:e}}var n,i;if(s&&L5(s),r.bookProps&&!r.bookSheets)n={};else{var l=ut?"buffer":"array";if(a&&a.content)n=z5(a.content,r);else if((i=Ye.find(e,"PerfectOffice_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=l,r));else if((i=Ye.find(e,"NativeContent_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=l,r));else throw(i=Ye.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=tT(e))}var o={};return e.FullPaths&&$5(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}function W5(e,r){var s=r||{},a=Ye.utils.cfb_new({root:"R"}),n="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":n="/Workbook",s.biff=8;break;case"biff5":n="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return Ye.utils.cfb_add(a,n,nf(e,s)),s.biff==8&&(e.Props||e.Custprops)&&U5(e,a),s.biff==8&&e.vbaraw&&sT(a,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Bn={0:{f:h4},1:{f:y4},2:{f:z4},3:{f:k4},4:{f:T4},5:{f:L4},6:{f:V4},7:{f:P4},8:{f:Z4},9:{f:J4},10:{f:K4},11:{f:X4},12:{f:w4},13:{f:U4},14:{f:D4},15:{f:C4},16:{f:Xh},17:{f:q4},18:{f:F4},19:{f:Hc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qC},40:{},42:{},43:{f:Vw},44:{f:Ww},45:{f:Yw},46:{f:Xw},47:{f:Kw},48:{},49:{f:py},50:{},51:{f:AS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jh},62:{f:H4},63:{f:BS},64:{f:fC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:As,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:b4},148:{f:p4,p:16},151:{f:aC},152:{},153:{f:HC},154:{},155:{},156:{f:UC},157:{},158:{},159:{T:1,f:iw},160:{T:-1},161:{T:1,f:ka},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_S},336:{T:-1},337:{f:PS,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:bh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nC},427:{f:iC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:v4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XS},633:{T:1},634:{T:-1},635:{T:1,f:YS},636:{T:-1},637:{f:jy},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},xc={6:{f:Tl},10:{f:Ur},12:{f:os},13:{f:os},14:{f:ss},15:{f:ss},16:{f:Cs},17:{f:ss},18:{f:ss},19:{f:os},20:{f:Dm},21:{f:Dm},23:{f:bh},24:{f:Pm},25:{f:ss},26:{},27:{},28:{f:xN},29:{},34:{f:ss},35:{f:Im},38:{f:Cs},39:{f:Cs},40:{f:Cs},41:{f:Cs},42:{f:ss},43:{f:ss},47:{f:Cw},49:{f:U2},51:{f:os},60:{},61:{f:L2},64:{f:ss},65:{f:$2},66:{f:os},77:{},80:{},81:{},82:{},85:{f:os},89:{},90:{},91:{},92:{f:E2},93:{f:vN},94:{},95:{f:ss},96:{},97:{},99:{f:ss},125:{f:jh},128:{f:rN},129:{f:_2},130:{f:os},131:{f:ss},132:{f:ss},133:{f:k2},134:{},140:{f:EN},141:{f:os},144:{},146:{f:kN},151:{},152:{},153:{},154:{},155:{},156:{f:os},157:{},158:{},160:{f:ON},161:{f:IN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Q2},190:{f:eN},193:{f:Ur},197:{},198:{},199:{},200:{},201:{},202:{f:ss},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:os},220:{},221:{f:ss},222:{},224:{f:sN},225:{f:T2},226:{f:Ur},227:{},229:{f:pN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:D2},253:{f:H2},255:{f:P2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ss},353:{f:Ur},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oN},431:{f:ss},432:{},433:{},434:{},437:{},438:{f:yN},439:{f:ss},440:{f:NN},441:{},442:{f:ti},443:{},444:{f:os},445:{},446:{},448:{f:Ur},449:{f:O2,r:2},450:{f:Ur},512:{f:_m},513:{f:FN},515:{f:iN},516:{f:G2},517:{f:Am},519:{f:LN},520:{f:R2},523:{},545:{f:Rm},549:{f:Cm},566:{},574:{f:B2},638:{f:Z2},659:{},1048:{},1054:{f:Y2},1084:{},1212:{f:uN},2048:{f:SN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ur},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AN,r:12},2173:{f:ES,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ss,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:mN,r:12},2197:{},2198:{f:jS,r:12},2199:{},2200:{},2201:{},2202:{f:hN,r:12},2203:{f:Ur},2204:{},2205:{},2206:{},2207:{},2211:{f:F2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:os},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_N},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_m},1:{},2:{f:UN},3:{f:zN},4:{f:BN},5:{f:Am},7:{f:HN},8:{},9:{f:vi},11:{},22:{f:os},30:{f:X2},31:{},32:{},33:{f:Rm},36:{},37:{f:Cm},50:{f:VN},62:{},52:{},67:{},68:{f:os},69:{},86:{},126:{},127:{f:MN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:GN},223:{},234:{},354:{},421:{},518:{f:Tl},521:{f:vi},536:{f:Pm},547:{f:Im},561:{},579:{},1030:{f:Tl},1033:{f:vi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(e,r,s,a){var n=r;if(!isNaN(n)){var i=a||(s||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&$c(s)&&e.push(s)}}function H5(e,r,s,a){var n=(s||[]).length||0;if(n<=8224)return Oe(e,r,s,n);var i=r;if(!isNaN(i)){for(var l=s.parts||[],o=0,c=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var m=e.next(4);for(m.write_shift(2,i),m.write_shift(2,d),e.push(s.slice(c,c+d)),c+=d;c<n;){for(m=e.next(4),m.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;m.write_shift(2,d),e.push(s.slice(c,c+d)),c+=d}}}function ni(e,r,s){return e||(e=ye(7)),e.write_shift(2,r),e.write_shift(2,s),e.write_shift(2,0),e.write_shift(1,0),e}function V5(e,r,s,a){var n=ye(9);return ni(n,e,r),mh(s,a||"b",n),n}function G5(e,r,s){var a=ye(8+2*s.length);return ni(a,e,r),a.write_shift(1,s.length),a.write_shift(s.length,s,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function q5(e,r,s,a){if(r.v!=null)switch(r.t){case"d":case"n":var n=r.t=="d"?ms($t(r.v)):r.v;n==(n|0)&&n>=0&&n<65536?Oe(e,2,WN(s,a,n)):Oe(e,3,$N(s,a,n));return;case"b":case"e":Oe(e,5,V5(s,a,r.v,r.t));return;case"s":case"str":Oe(e,4,G5(s,a,(r.v||"").slice(0,255)));return}Oe(e,1,ni(null,s,a))}function Y5(e,r,s,a){var n=Array.isArray(r),i=yt(r["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=dt(i)}for(var d=i.s.r;d<=i.e.r;++d){o=as(d);for(var m=i.s.c;m<=i.e.c;++m){d===i.s.r&&(c[m]=Yt(m)),l=c[m]+o;var u=n?(r[d]||[])[m]:r[l];u&&q5(e,u,d,m)}}}function K5(e,r){for(var s=r||{},a=qs(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==s.sheet&&(n=i);if(n==0&&s.sheet&&e.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return Oe(a,s.biff==4?1033:s.biff==3?521:9,Jc(e,16,s)),Y5(a,e.Sheets[e.SheetNames[n]],n,s),Oe(a,10),a.end()}function X5(e,r,s){Oe(e,49,W2({sz:12,name:"Arial"},s))}function J5(e,r,s){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&Oe(e,1054,K2(n,r[n],s))})}function Z5(e,r){var s=ye(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),Oe(e,2151,s),s=ye(39),s.write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),ph(yt(r["!ref"]||"A1"),s),s.write_shift(4,4),Oe(e,2152,s)}function Q5(e,r){for(var s=0;s<16;++s)Oe(e,224,km({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){Oe(e,224,km(a,0,r))})}function e_(e,r){for(var s=0;s<r["!links"].length;++s){var a=r["!links"][s];Oe(e,440,wN(a)),a[1].Tooltip&&Oe(e,2048,TN(a))}delete r["!links"]}function t_(e,r){if(r){var s=0;r.forEach(function(a,n){++s<=256&&a&&Oe(e,125,DN(ol(n,a),n))})}}function s_(e,r,s,a,n){var i=16+ta(n.cellXfs,r,n);if(r.v==null&&!r.bf){Oe(e,513,ya(s,a,i));return}if(r.bf)Oe(e,6,_E(r,s,a,n,i));else switch(r.t){case"d":case"n":var l=r.t=="d"?ms($t(r.v)):r.v;Oe(e,515,lN(s,a,l,i));break;case"b":case"e":Oe(e,517,nN(s,a,r.v,i,n,r.t));break;case"s":case"str":if(n.bookSST){var o=nd(n.Strings,r.v,n.revStrings);Oe(e,253,V2(s,a,o,i))}else Oe(e,516,q2(s,a,(r.v||"").slice(0,255),i,n));break;default:Oe(e,513,ya(s,a,i))}}function r_(e,r,s){var a=qs(),n=s.SheetNames[e],i=s.Sheets[n]||{},l=(s||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=r.biff==8,m,u="",h=[],p=yt(i["!ref"]||"A1"),x=d?65536:16384;if(p.e.c>255||p.e.r>=x){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Oe(a,2057,Jc(s,16,r)),Oe(a,13,ir(1)),Oe(a,12,ir(100)),Oe(a,15,Fs(!0)),Oe(a,17,Fs(!1)),Oe(a,16,ba(.001)),Oe(a,95,Fs(!0)),Oe(a,42,Fs(!1)),Oe(a,43,Fs(!1)),Oe(a,130,ir(1)),Oe(a,128,aN()),Oe(a,131,Fs(!1)),Oe(a,132,Fs(!1)),d&&t_(a,i["!cols"]),Oe(a,512,J2(p,r)),d&&(i["!links"]=[]);for(var f=p.s.r;f<=p.e.r;++f){u=as(f);for(var g=p.s.c;g<=p.e.c;++g){f===p.s.r&&(h[g]=Yt(g)),m=h[g]+u;var v=c?(i[f]||[])[g]:i[m];v&&(s_(a,v,f,g,r),d&&v.l&&i["!links"].push([m,v.l]))}}var N=o.CodeName||o.name||n;return d&&Oe(a,574,z2((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&Oe(a,229,gN(i["!merges"])),d&&e_(a,i),Oe(a,442,uh(N)),d&&Z5(a,i),Oe(a,10),a.end()}function a_(e,r,s){var a=qs(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=s.biff==8,c=s.biff==5;if(Oe(a,2057,Jc(e,5,s)),s.bookType=="xla"&&Oe(a,135),Oe(a,225,o?ir(1200):null),Oe(a,193,n2(2)),c&&Oe(a,191),c&&Oe(a,192),Oe(a,226),Oe(a,92,C2("SheetJS",s)),Oe(a,66,ir(o?1200:1252)),o&&Oe(a,353,ir(0)),o&&Oe(a,448),Oe(a,317,RN(e.SheetNames.length)),o&&e.vbaraw&&Oe(a,211),o&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";Oe(a,442,uh(d))}Oe(a,156,ir(17)),Oe(a,25,Fs(!1)),Oe(a,18,Fs(!1)),Oe(a,19,ir(0)),o&&Oe(a,431,Fs(!1)),o&&Oe(a,444,ir(0)),Oe(a,61,M2()),Oe(a,64,Fs(!1)),Oe(a,141,ir(0)),Oe(a,34,Fs(OC(e)=="true")),Oe(a,14,Fs(!0)),o&&Oe(a,439,Fs(!1)),Oe(a,218,ir(0)),X5(a,e,s),J5(a,e.SSF,s),Q5(a,s),o&&Oe(a,352,Fs(!1));var m=a.end(),u=qs();o&&Oe(u,140,CN()),o&&s.Strings&&H5(u,252,I2(s.Strings)),Oe(u,10);var h=u.end(),p=qs(),x=0,f=0;for(f=0;f<e.SheetNames.length;++f)x+=(o?12:11)+(o?2:1)*e.SheetNames[f].length;var g=m.length+x+h.length;for(f=0;f<e.SheetNames.length;++f){var v=i[f]||{};Oe(p,133,A2({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[f]},s)),g+=r[f].length}var N=p.end();if(x!=N.length)throw new Error("BS8 "+x+" != "+N.length);var j=[];return m.length&&j.push(m),N.length&&j.push(N),h.length&&j.push(h),hs(j)}function n_(e,r){var s=r||{},a=[];e&&!e.SSF&&(e.SSF=Ut(Je)),e&&e.SSF&&(en(),tl(e.SSF),s.revssf=rl(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,dd(s),s.cellXfs=[],ta(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=r_(n,s,e);return a.unshift(a_(e,a,s)),hs(a)}function nf(e,r){for(var s=0;s<=e.SheetNames.length;++s){var a=e.Sheets[e.SheetNames[s]];if(!(!a||!a["!ref"])){var n=Ys(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[s]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return n_(e,r);case 4:case 3:case 2:return K5(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Hm(e,r){var s=r||{},a=s.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=Wj(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,u=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(l=0;l<c.length;++l){var f=c[l].trim(),g=f.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,s.sheetRows&&s.sheetRows<=d){--d;break}m=0;continue}if(!(g!="<td"&&g!="<th")){var v=f.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var N=v[o].trim();if(N.match(/<t[dh]/i)){for(var j=N,S=0;j.charAt(0)=="<"&&(S=j.indexOf(">"))>-1;)j=j.slice(S+1);for(var C=0;C<x.length;++C){var w=x[C];w.s.c==m&&w.s.r<d&&d<=w.e.r&&(m=w.e.c+1,C=-1)}var y=st(N.slice(0,N.indexOf(">")));h=y.colspan?+y.colspan:1,((u=+y.rowspan)>1||h>1)&&x.push({s:{r:d,c:m},e:{r:d+(u||1)-1,c:m+h-1}});var T=y.t||y["data-t"]||"";if(!j.length){m+=h;continue}if(j=ku(j),p.s.r>d&&(p.s.r=d),p.e.r<d&&(p.e.r=d),p.s.c>m&&(p.s.c=m),p.e.c<m&&(p.e.c=m),!j.length){m+=h;continue}var k={t:"s",v:j};s.raw||!j.trim().length||T=="s"||(j==="TRUE"?k={t:"b",v:!0}:j==="FALSE"?k={t:"b",v:!1}:isNaN(pr(j))?isNaN(qa(j).getDate())||(k={t:"d",v:$t(j)},s.cellDates||(k={t:"n",v:ms(k.v)}),k.z=s.dateNF||Je[14]):k={t:"n",v:pr(j)}),s.dense?(a[d]||(a[d]=[]),a[d][m]=k):a[Qe({r:d,c:m})]=k,m+=h}}}}return a["!ref"]=dt(p),x.length&&(a["!merges"]=x),a}function i_(e,r,s,a){for(var n=e["!merges"]||[],i=[],l=r.s.c;l<=r.e.c;++l){for(var o=0,c=0,d=0;d<n.length;++d)if(!(n[d].s.r>s||n[d].s.c>l)&&!(n[d].e.r<s||n[d].e.c<l)){if(n[d].s.r<s||n[d].s.c<l){o=-1;break}o=n[d].e.r-n[d].s.r+1,c=n[d].e.c-n[d].s.c+1;break}if(!(o<0)){var m=Qe({r:s,c:l}),u=a.dense?(e[s]||[])[l]:e[m],h=u&&u.v!=null&&(u.h||Mc(u.w||(Lr(u),u.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(p["data-t"]=u&&u.t||"z",u.v!=null&&(p["data-v"]=u.v),u.z!=null&&(p["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),p.id=(a.id||"sjs")+"-"+m,i.push(Fe("td",h,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var l_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',o_="</body></html>";function c_(e,r){var s=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!s||s.length==0)throw new Error("Invalid HTML: could not find <table>");if(s.length==1)return ea(Hm(s[0],r),r);var a=fd();return s.forEach(function(n,i){xd(a,Hm(n,r),"Sheet"+(i+1))}),a}function d_(e,r,s){var a=[];return a.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function lf(e,r){var s=r||{},a=s.header!=null?s.header:l_,n=s.footer!=null?s.footer:o_,i=[a],l=Ys(e["!ref"]);s.dense=Array.isArray(e),i.push(d_(e,l,s));for(var o=l.s.r;o<=l.e.r;++o)i.push(i_(e,l,o,s));return i.push("</table>"+n),i.join("")}function of(e,r,s){var a=s||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Kt(a.origin):a.origin;n=l.r,i=l.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var m=Ys(e["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),n==-1&&(d.e.r=n=m.e.r+1)}var u=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,f=0,g=0,v=0,N=0,j=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&f<c;++x){var S=o[x];if(Vm(S)){if(a.display)continue;p[f]={hidden:!0}}var C=S.children;for(g=v=0;g<C.length;++g){var w=C[g];if(!(a.display&&Vm(w))){var y=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):ku(w.innerHTML),T=w.getAttribute("data-z")||w.getAttribute("z");for(h=0;h<u.length;++h){var k=u[h];k.s.c==v+i&&k.s.r<f+n&&f+n<=k.e.r&&(v=k.e.c+1-i,h=-1)}j=+w.getAttribute("colspan")||1,((N=+w.getAttribute("rowspan")||1)>1||j>1)&&u.push({s:{r:f+n,c:v+i},e:{r:f+n+(N||1)-1,c:v+i+(j||1)-1}});var P={t:"s",v:y},A=w.getAttribute("data-t")||w.getAttribute("t")||"";y!=null&&(y.length==0?P.t=A||"z":a.raw||y.trim().length==0||A=="s"||(y==="TRUE"?P={t:"b",v:!0}:y==="FALSE"?P={t:"b",v:!1}:isNaN(pr(y))?isNaN(qa(y).getDate())||(P={t:"d",v:$t(y)},a.cellDates||(P={t:"n",v:ms(P.v)}),P.z=a.dateNF||Je[14]):P={t:"n",v:pr(y)})),P.z===void 0&&T!=null&&(P.z=T);var _="",U=w.getElementsByTagName("A");if(U&&U.length)for(var D=0;D<U.length&&!(U[D].hasAttribute("href")&&(_=U[D].getAttribute("href"),_.charAt(0)!="#"));++D);_&&_.charAt(0)!="#"&&(P.l={Target:_}),a.dense?(e[f+n]||(e[f+n]=[]),e[f+n][v+i]=P):e[Qe({c:v+i,r:f+n})]=P,d.e.c<v+i&&(d.e.c=v+i),v+=j}}++f}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),d.e.r=Math.max(d.e.r,f-1+n),e["!ref"]=dt(d),f>=c&&(e["!fullref"]=dt((d.e.r=o.length-x+f-1+n,d))),e}function cf(e,r){var s=r||{},a=s.dense?[]:{};return of(a,e,r)}function m_(e,r){return ea(cf(e,r),r)}function Vm(e){var r="",s=u_(e);return s&&(r=s(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function u_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function h_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),s=jt(r.replace(/<[^>]*>/g,""));return[s]}var Gm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function df(e,r){var s=r||{},a=Bc(e),n=[],i,l,o={name:""},c="",d=0,m,u,h={},p=[],x=s.dense?[]:{},f,g,v={value:""},N="",j=0,S=[],C=-1,w=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,k={},P=[],A={},_=0,U=0,D=[],W=1,q=1,Y=[],K={Names:[]},H={},je=["",""],ie=[],B={},V="",z=0,L=!1,te=!1,ne=0;for(Pn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");f=Pn.exec(a);)switch(f[3]=f[3].replace(/_.*$/,"")){case"table":case"":f[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?x["!ref"]=dt(y):x["!ref"]="A1:A1",s.sheetRows>0&&s.sheetRows<=y.e.r&&(x["!fullref"]=x["!ref"],y.e.r=s.sheetRows-1,x["!ref"]=dt(y)),P.length&&(x["!merges"]=P),D.length&&(x["!rows"]=D),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),p.push(m.name),h[m.name]=x,te=!1):f[0].charAt(f[0].length-2)!=="/"&&(m=st(f[0],!1),C=w=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,x=s.dense?[]:{},P=[],D=[],te=!0);break;case"table-row-group":f[1]==="/"?--T:++T;break;case"table-row":case"":if(f[1]==="/"){C+=W,W=1;break}if(u=st(f[0],!1),u.?C=u.-1:C==-1&&(C=0),W=+u["number-rows-repeated"]||1,W<10)for(ne=0;ne<W;++ne)T>0&&(D[C+ne]={level:T});w=-1;break;case"covered-table-cell":f[1]!=="/"&&++w,s.sheetStubs&&(s.dense?(x[C]||(x[C]=[]),x[C][w]={t:"z"}):x[Qe({r:C,c:w})]={t:"z"}),N="",S=[];break;case"table-cell":case"":if(f[0].charAt(f[0].length-2)==="/")++w,v=st(f[0],!1),q=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&s.cellFormula!=!1&&(g.f=$m(jt(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=jt(v["string-value"]||""),s.dense?(x[C]||(x[C]=[]),x[C][w]=g):x[Qe({r:C,c:w})]=g),w+=q-1;else if(f[1]!=="/"){++w,N="",j=0,S=[],q=1;var ue=W?C+W-1:C;if(w>y.e.c&&(y.e.c=w),w<y.s.c&&(y.s.c=w),C<y.s.r&&(y.s.r=C),ue>y.e.r&&(y.e.r=ue),v=st(f[0],!1),ie=[],B={},g={t:v.||v["value-type"],v:null},s.cellFormula)if(v.formula&&(v.formula=jt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(_=parseInt(v["number-matrix-rows-spanned"],10)||0,U=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:C,c:w},e:{r:C+_-1,c:w+U-1}},g.F=dt(A),Y.push([A,g.F])),v.formula)g.f=$m(v.formula);else for(ne=0;ne<Y.length;++ne)C>=Y[ne][0].s.r&&C<=Y[ne][0].e.r&&w>=Y[ne][0].s.c&&w<=Y[ne][0].e.c&&(g.F=Y[ne][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(_=parseInt(v["number-rows-spanned"],10)||0,U=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:C,c:w},e:{r:C+_-1,c:w+U-1}},P.push(A)),v["number-columns-repeated"]&&(q=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Mt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=$t(v["date-value"]),s.cellDates||(g.t="n",g.v=ms(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=zj(v["time-value"])/86400,s.cellDates&&(g.t="d",g.v=al(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(N=jt(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(L=!1,g.t==="s"&&(g.v=N||"",S.length&&(g.R=S),L=j==0),H.Target&&(g.l=H),ie.length>0&&(g.c=ie,ie=[]),N&&s.cellText!==!1&&(g.w=N),L&&(g.t="z",delete g.v),(!L||s.sheetStubs)&&!(s.sheetRows&&s.sheetRows<=C))for(var Ne=0;Ne<W;++Ne){if(q=parseInt(v["number-columns-repeated"]||"1",10),s.dense)for(x[C+Ne]||(x[C+Ne]=[]),x[C+Ne][w]=Ne==0?g:Ut(g);--q>0;)x[C+Ne][w+q]=Ut(g);else for(x[Qe({r:C+Ne,c:w})]=g;--q>0;)x[Qe({r:C+Ne,c:w+q})]=Ut(g);y.e.c<=w&&(y.e.c=w)}q=parseInt(v["number-columns-repeated"]||"1",10),w+=q-1,q=0,g={},N="",S=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(f[1]==="/"){if((i=n.pop())[0]!==f[3])throw"Bad state: "+i}else f[0].charAt(f[0].length-2)!=="/"&&n.push([f[3],!0]);break;case"annotation":if(f[1]==="/"){if((i=n.pop())[0]!==f[3])throw"Bad state: "+i;B.t=N,S.length&&(B.R=S),B.a=V,ie.push(B)}else f[0].charAt(f[0].length-2)!=="/"&&n.push([f[3],!1]);V="",z=0,N="",j=0,S=[];break;case"creator":f[1]==="/"?V=a.slice(z,f.index):z=f.index+f[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(f[1]==="/"){if((i=n.pop())[0]!==f[3])throw"Bad state: "+i}else f[0].charAt(f[0].length-2)!=="/"&&n.push([f[3],!1]);N="",j=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(f[1]==="/"){if(k[o.name]=c,(i=n.pop())[0]!==f[3])throw"Bad state: "+i}else f[0].charAt(f[0].length-2)!=="/"&&(c="",o=st(f[0],!1),n.push([f[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=st(f[0],!1),c+=Gm[f[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=st(f[0],!1),c+=Gm[f[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(f[0].slice(-2)==="/>")break;if(f[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,f.index);break}else d=f.index+f[0].length;break;case"named-range":l=st(f[0],!1),je=El(l["cell-range-address"]);var ae={Name:l.name,Ref:je[0]+"!"+je[1]};te&&(ae.Sheet=p.length),K.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(f[1]==="/"&&(!v||!v["string-value"])){var re=h_(a.slice(j,f.index));N=(N.length>0?N+`
`:"")+re[0]}else st(f[0],!1),j=f.index+f[0].length;break;case"s":break;case"database-range":if(f[1]==="/")break;try{je=El(st(f[0])["target-range-address"]),h[je[0]]["!autofilter"]={ref:je[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(f[1]!=="/"){if(H=st(f[0],!1),!H.href)break;H.Target=jt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(je=El(H.Target.slice(1)),H.Target="#"+je[0]+"!"+je[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(f[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(s.WTF)throw new Error(f)}}var M={Sheets:h,SheetNames:p,Workbook:K};return s.bookSheets&&delete M.Sheets,M}function qm(e,r){r=r||{},nr(e,"META-INF/manifest.xml")&&zy(ls(e,"META-INF/manifest.xml"),r);var s=Qs(e,"content.xml");if(!s)throw new Error("Missing content.xml in ODS / UOF file");var a=df(Ft(s),r);return nr(e,"meta.xml")&&(a.Props=Qu(ls(e,"meta.xml"))),a}function Ym(e,r){return df(e,r)}var f_=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+In({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ns+r}})(),Km=(function(){var e=function(i){return At(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,s=`          <table:covered-table-cell/>
`,a=function(i,l,o){var c=[];c.push('      <table:table table:name="'+At(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,m=0,u=Ys(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(m=0;m<=u.e.c;++m)c.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var f="",g=i["!rows"]||[];for(d=0;d<u.s.r;++d)f=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+f+`></table:table-row>
`);for(;d<=u.e.r;++d){for(f=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+f+`>
`),m=0;m<u.s.c;++m)c.push(r);for(;m<=u.e.c;++m){var v=!1,N={},j="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>m)&&!(h[p].s.r>d)&&!(h[p].e.c<m)&&!(h[p].e.r<d)){(h[p].s.c!=m||h[p].s.r!=d)&&(v=!0),N["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,N["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){c.push(s);continue}var S=Qe({r:d,c:m}),C=x?(i[d]||[])[m]:i[S];if(C&&C.f&&(N["table:formula"]=At(RE(C.f)),C.F&&C.F.slice(0,S.length)==S)){var w=Ys(C.F);N["table:number-matrix-columns-spanned"]=w.e.c-w.s.c+1,N["table:number-matrix-rows-spanned"]=w.e.r-w.s.r+1}if(!C){c.push(r);continue}switch(C.t){case"b":j=C.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=C.v?"true":"false";break;case"n":j=C.w||String(C.v||0),N["office:value-type"]="float",N["office:value"]=C.v||0;break;case"s":case"str":j=C.v==null?"":C.v,N["office:value-type"]="string";break;case"d":j=C.w||$t(C.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=$t(C.v).toISOString(),N["table:style-name"]="ce1";break;default:c.push(r);continue}var y=e(j);if(C.l&&C.l.Target){var T=C.l.Target;T=T.charAt(0)=="#"?"#"+FE(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),y=Fe("text:a",y,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+Fe("table:table-cell",Fe("text:p",y,{}),N)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var u=d["!cols"][m];if(u.width==null&&u.wpx==null&&u.wch==null)continue;Kr(u),u.ods=o;var h=d["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=c;var u=d["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[ns],d=In({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=In({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+m+`>
`),c.push(Zu().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),n(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=l.SheetNames.length;++u)c.push(a(l.Sheets[l.SheetNames[u]],l,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function mf(e,r){if(r.bookType=="fods")return Km(e,r);var s=Fc(),a="",n=[],i=[];return a="mimetype",mt(s,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",mt(s,a,Km(e,r)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",mt(s,a,f_(e,r)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",mt(s,a,ns+Zu()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",mt(s,a,Wy(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",mt(s,a,$y(n)),s}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Na(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function pc(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ft(Qr(e))}function x_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Zs(Er(e))}function p_(e,r){e:for(var s=0;s<=e.length-r.length;++s){for(var a=0;a<r.length;++a)if(e[s+a]!=r[a])continue e;return!0}return!1}function Jr(e){var r=e.reduce(function(n,i){return n+i.length},0),s=new Uint8Array(r),a=0;return e.forEach(function(n){s.set(n,a),a+=n.length}),s}function Xm(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function g_(e,r){for(var s=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,s-6176)}function v_(e,r,s){var a=Math.floor(s==0?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,n=s/Math.pow(10,a-6176);e[r+15]|=a>>7,e[r+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=n&255;e[r+15]|=s>=0?0:128}function zn(e,r){var s=r?r[0]:0,a=e[s]&127;e:if(e[s++]>=128&&(a|=(e[s]&127)<<7,e[s++]<128||(a|=(e[s]&127)<<14,e[s++]<128)||(a|=(e[s]&127)<<21,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,28),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,35),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,42),++s,e[s++]<128)))break e;return r&&(r[0]=s),a}function _t(e){var r=new Uint8Array(7);r[0]=e&127;var s=1;e:if(e>127){if(r[s-1]|=128,r[s]=e>>7&127,++s,e<=16383||(r[s-1]|=128,r[s]=e>>14&127,++s,e<=2097151)||(r[s-1]|=128,r[s]=e>>21&127,++s,e<=268435455)||(r[s-1]|=128,r[s]=e/256>>>21&127,++s,e<=34359738367)||(r[s-1]|=128,r[s]=e/65536>>>21&127,++s,e<=4398046511103))break e;r[s-1]|=128,r[s]=e/16777216>>>21&127,++s}return r.slice(0,s)}function Qt(e){var r=0,s=e[r]&127;e:if(e[r++]>=128){if(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128))break e;s|=(e[r]&127)<<28}return s}function wt(e){for(var r=[],s=[0];s[0]<e.length;){var a=s[0],n=zn(e,s),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=s[0];e[s[0]++]>=128;);o=e.slice(c,s[0])}break;case 5:l=4,o=e.slice(s[0],s[0]+l),s[0]+=l;break;case 1:l=8,o=e.slice(s[0],s[0]+l),s[0]+=l;break;case 2:l=zn(e,s),o=e.slice(s[0],s[0]+l),s[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var d={data:o,type:i};r[n]==null?r[n]=[d]:r[n].push(d)}return r}function ps(e){var r=[];return e.forEach(function(s,a){s.forEach(function(n){n.data&&(r.push(_t(a*8+n.type)),n.type==2&&r.push(_t(n.data.length)),r.push(n.data))})}),Jr(r)}function od(e,r){return e?.map(function(s){return r(s.data)})||[]}function rr(e){for(var r,s=[],a=[0];a[0]<e.length;){var n=zn(e,a),i=wt(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:Qt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=wt(o.data),d=Qt(c[3][0].data);l.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(r=i[3])!=null&&r[0]&&(l.merge=Qt(i[3][0].data)>>>0>0),s.push(l)}return s}function Ra(e){var r=[];return e.forEach(function(s){var a=[];a[1]=[{data:_t(s.id),type:0}],a[2]=[],s.merge!=null&&(a[3]=[{data:_t(+!!s.merge),type:0}]);var n=[];s.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:_t(l.data.length)}],a[2].push({data:ps(l.meta),type:2})});var i=ps(a);r.push(_t(i.length)),r.push(i),n.forEach(function(l){return r.push(l)})}),Jr(r)}function b_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var s=[0],a=zn(r,s),n=[];s[0]<r.length;){var i=r[s[0]]&3;if(i==0){var l=r[s[0]++]>>2;if(l<60)++l;else{var o=l-59;l=r[s[0]],o>1&&(l|=r[s[0]+1]<<8),o>2&&(l|=r[s[0]+2]<<16),o>3&&(l|=r[s[0]+3]<<24),l>>>=0,l++,s[0]+=o}n.push(r.slice(s[0],s[0]+l)),s[0]+=l;continue}else{var c=0,d=0;if(i==1?(d=(r[s[0]]>>2&7)+4,c=(r[s[0]++]&224)<<3,c|=r[s[0]++]):(d=(r[s[0]++]>>2)+1,i==2?(c=r[s[0]]|r[s[0]+1]<<8,s[0]+=2):(c=(r[s[0]]|r[s[0]+1]<<8|r[s[0]+2]<<16|r[s[0]+3]<<24)>>>0,s[0]+=4)),n=[Jr(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(n.push(n[0].slice(-c)),d-=c;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-c,-c+d))}}var m=Jr(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function ar(e){for(var r=[],s=0;s<e.length;){var a=e[s++],n=e[s]|e[s+1]<<8|e[s+2]<<16;s+=3,r.push(b_(a,e.slice(s,s+n))),s+=n}if(s!==e.length)throw new Error("data is not a valid framed stream!");return Jr(r)}function Fa(e){for(var r=[],s=0;s<e.length;){var a=Math.min(e.length-s,268435455),n=new Uint8Array(4);r.push(n);var i=_t(a),l=i.length;r.push(i),a<=60?(l++,r.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(e.slice(s,s+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,s+=a}return Jr(r)}function j_(e,r,s,a){var n=Na(e),i=n.getUint32(4,!0),l=(a>1?12:8)+Xm(i&(a>1?3470:398))*4,o=-1,c=-1,d=NaN,m=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=Xm(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(d=n.getFloat64(l,!0),l+=8),i&64&&(m.setTime(m.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:d};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:m};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:s[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(d))u={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function y_(e,r,s){var a=Na(e),n=a.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,d=NaN,m=new Date(2001,0,1);n&1&&(c=g_(e,i),i+=16),n&2&&(d=a.getFloat64(i,!0),i+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:m};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:s[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function _l(e,r){var s=new Uint8Array(32),a=Na(s),n=12,i=0;switch(s[0]=5,e.t){case"n":s[1]=2,v_(s,n,e.v),i|=1,n+=16;break;case"b":s[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[1]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),s.slice(0,n)}function kl(e,r){var s=new Uint8Array(32),a=Na(s),n=12,i=0;switch(s[0]=3,e.t){case"n":s[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":s[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[2]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),s.slice(0,n)}function N_(e,r,s){switch(e[0]){case 0:case 1:case 2:case 3:return j_(e,r,s,e[0]);case 5:return y_(e,r,s);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ns(e){var r=wt(e);return zn(r[1][0].data)}function Jm(e,r){var s=wt(r.data),a=Qt(s[1][0].data),n=s[3],i=[];return(n||[]).forEach(function(l){var o=wt(l.data),c=Qt(o[1][0].data)>>>0;switch(a){case 1:i[c]=pc(o[3][0].data);break;case 8:{var d=e[Ns(o[9][0].data)][0],m=wt(d.data),u=e[Ns(m[1][0].data)][0],h=Qt(u.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=wt(u.data);i[c]=p[3].map(function(x){return pc(x.data)}).join("")}break}}),i}function w_(e,r){var s,a,n,i,l,o,c,d,m,u,h,p,x,f,g=wt(e),v=Qt(g[1][0].data)>>>0,N=Qt(g[2][0].data)>>>0,j=((a=(s=g[8])==null?void 0:s[0])==null?void 0:a.data)&&Qt(g[8][0].data)>0||!1,S,C;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&r!=0)S=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,C=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((u=(m=g[4])==null?void 0:m[0])!=null&&u.data&&r!=1)S=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,C=(f=(x=g[3])==null?void 0:x[0])==null?void 0:f.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var w=j?4:1,y=Na(S),T=[],k=0;k<S.length/2;++k){var P=y.getUint16(k*2,!0);P<65535&&T.push([k,P])}if(T.length!=N)throw"Expected ".concat(N," cells, found ").concat(T.length);var A=[];for(k=0;k<T.length-1;++k)A[T[k][0]]=C.subarray(T[k][1]*w,T[k+1][1]*w);return T.length>=1&&(A[T[T.length-1][0]]=C.subarray(T[T.length-1][1]*w)),{R:v,cells:A}}function S_(e,r){var s,a=wt(r.data),n=(s=a?.[7])!=null&&s[0]?Qt(a[7][0].data)>>>0>0?1:0:-1,i=od(a[5],function(l){return w_(l,n)});return{nrows:Qt(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,d){if(l[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));l[o.R][d]=c}),l},[])}}function T_(e,r,s){var a,n=wt(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Qt(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Qt(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));s["!ref"]=dt(i);var l=wt(n[4][0].data),o=Jm(e,e[Ns(l[4][0].data)][0]),c=(a=l[17])!=null&&a[0]?Jm(e,e[Ns(l[17][0].data)][0]):[],d=wt(l[3][0].data),m=0;d[1].forEach(function(u){var h=wt(u.data),p=e[Ns(h[2][0].data)][0],x=Qt(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var f=S_(e,p);f.data.forEach(function(g,v){g.forEach(function(N,j){var S=Qe({r:m+v,c:j}),C=N_(N,o,c);C&&(s[S]=C)})}),m+=f.nrows})}function E_(e,r){var s=wt(r.data),a={"!ref":"A1"},n=e[Ns(s[2][0].data)],i=Qt(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return T_(e,n[0],a),a}function C_(e,r){var s,a=wt(r.data),n={name:(s=a[1])!=null&&s[0]?pc(a[1][0].data):"",sheets:[]},i=od(a[2],Ns);return i.forEach(function(l){e[l].forEach(function(o){var c=Qt(o.meta[1][0].data);c==6e3&&n.sheets.push(E_(e,o))})}),n}function __(e,r){var s=fd(),a=wt(r.data),n=od(a[1],Ns);if(n.forEach(function(i){e[i].forEach(function(l){var o=Qt(l.meta[1][0].data);if(o==2){var c=C_(e,l);c.sheets.forEach(function(d,m){xd(s,d,m==0?c.name:c.name+"_"+m,!0)})}})}),s.SheetNames.length==0)throw new Error("Empty NUMBERS file");return s}function Al(e){var r,s,a,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=ar(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var m;try{m=rr(d)}catch(u){return console.log("## "+(u.message||u))}m.forEach(function(u){i[u.id]=u.messages,l.push(u.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(s=(r=i?.[1])==null?void 0:r[0])==null?void 0:s.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Qt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(d){var m=Qt(d.meta[1][0].data)>>>0;if(m==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return __(i,o)}function k_(e,r,s){var a,n,i,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Qt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=Na(e[7][0].data),m=0,u=[],h=Na(e[4][0].data),p=0,x=[],f=0;f<r.length;++f){if(r[f]==null){d.setUint16(f*2,65535,!0),h.setUint16(f*2,65535);continue}d.setUint16(f*2,m,!0),h.setUint16(f*2,p,!0);var g,v;switch(typeof r[f]){case"string":g=_l({t:"s",v:r[f]},s),v=kl({t:"s",v:r[f]},s);break;case"number":g=_l({t:"n",v:r[f]},s),v=kl({t:"n",v:r[f]},s);break;case"boolean":g=_l({t:"b",v:r[f]},s),v=kl({t:"b",v:r[f]},s);break;default:throw new Error("Unsupported value "+r[f])}u.push(g),m+=g.length,x.push(v),p+=v.length,++c}for(e[2][0].data=_t(c);f<e[7][0].data.length/2;++f)d.setUint16(f*2,65535,!0),h.setUint16(f*2,65535,!0);return e[6][0].data=Jr(u),e[3][0].data=Jr(x),c}function A_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ys(s["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(dt(a)));var i=Wi(s,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(V){return V.forEach(function(z){typeof z=="string"&&l.push(z)})});var o={},c=[],d=Ye.read(r.numbers,{type:"base64"});d.FileIndex.map(function(V,z){return[V,d.FullPaths[z]]}).forEach(function(V){var z=V[0],L=V[1];if(z.type==2&&z.name.match(/\.iwa/)){var te=z.content,ne=ar(te),ue=rr(ne);ue.forEach(function(Ne){c.push(Ne.id),o[Ne.id]={deps:[],location:L,type:Qt(Ne.messages[0].meta[1][0].data)}})}}),c.sort(function(V,z){return V-z});var m=c.filter(function(V){return V>1}).map(function(V){return[V,_t(V)]});d.FileIndex.map(function(V,z){return[V,d.FullPaths[z]]}).forEach(function(V){var z=V[0];if(V[1],!!z.name.match(/\.iwa/)){var L=rr(ar(z.content));L.forEach(function(te){te.messages.forEach(function(ne){m.forEach(function(ue){te.messages.some(function(Ne){return Qt(Ne.meta[1][0].data)!=11006&&p_(Ne.data,ue[1])})&&o[ue[0]].deps.push(te.id)})})})}});for(var u=Ye.find(d,o[1].location),h=rr(ar(u.content)),p,x=0;x<h.length;++x){var f=h[x];f.id==1&&(p=f)}var g=Ns(wt(p.messages[0].data)[1][0].data);for(u=Ye.find(d,o[g].location),h=rr(ar(u.content)),x=0;x<h.length;++x)f=h[x],f.id==g&&(p=f);for(g=Ns(wt(p.messages[0].data)[2][0].data),u=Ye.find(d,o[g].location),h=rr(ar(u.content)),x=0;x<h.length;++x)f=h[x],f.id==g&&(p=f);for(g=Ns(wt(p.messages[0].data)[2][0].data),u=Ye.find(d,o[g].location),h=rr(ar(u.content)),x=0;x<h.length;++x)f=h[x],f.id==g&&(p=f);var v=wt(p.messages[0].data);{v[6][0].data=_t(a.e.r+1),v[7][0].data=_t(a.e.c+1);var N=Ns(v[46][0].data),j=Ye.find(d,o[N].location),S=rr(ar(j.content));{for(var C=0;C<S.length&&S[C].id!=N;++C);if(S[C].id!=N)throw"Bad ColumnRowUIDMapArchive";var w=wt(S[C].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var y=0;y<=a.e.c;++y){var T=[];T[1]=T[2]=[{type:0,data:_t(y+420690)}],w[1].push({type:2,data:ps(T)}),w[2].push({type:0,data:_t(y)}),w[3].push({type:0,data:_t(y)})}w[4]=[],w[5]=[],w[6]=[];for(var k=0;k<=a.e.r;++k)T=[],T[1]=T[2]=[{type:0,data:_t(k+726270)}],w[4].push({type:2,data:ps(T)}),w[5].push({type:0,data:_t(k)}),w[6].push({type:0,data:_t(k)});S[C].messages[0].data=ps(w)}j.content=Fa(Ra(S)),j.size=j.content.length,delete v[46];var P=wt(v[4][0].data);{P[7][0].data=_t(a.e.r+1);var A=wt(P[1][0].data),_=Ns(A[2][0].data);j=Ye.find(d,o[_].location),S=rr(ar(j.content));{if(S[0].id!=_)throw"Bad HeaderStorageBucket";var U=wt(S[0].messages[0].data);for(k=0;k<i.length;++k){var D=wt(U[2][0].data);D[1][0].data=_t(k),D[4][0].data=_t(i[k].length),U[2][k]={type:U[2][0].type,data:ps(D)}}S[0].messages[0].data=ps(U)}j.content=Fa(Ra(S)),j.size=j.content.length;var W=Ns(P[2][0].data);j=Ye.find(d,o[W].location),S=rr(ar(j.content));{if(S[0].id!=W)throw"Bad HeaderStorageBucket";for(U=wt(S[0].messages[0].data),y=0;y<=a.e.c;++y)D=wt(U[2][0].data),D[1][0].data=_t(y),D[4][0].data=_t(a.e.r+1),U[2][y]={type:U[2][0].type,data:ps(D)};S[0].messages[0].data=ps(U)}j.content=Fa(Ra(S)),j.size=j.content.length;var q=Ns(P[4][0].data);(function(){for(var V=Ye.find(d,o[q].location),z=rr(ar(V.content)),L,te=0;te<z.length;++te){var ne=z[te];ne.id==q&&(L=ne)}var ue=wt(L.messages[0].data);{ue[3]=[];var Ne=[];l.forEach(function(M,_e){Ne[1]=[{type:0,data:_t(_e)}],Ne[2]=[{type:0,data:_t(1)}],Ne[3]=[{type:2,data:x_(M)}],ue[3].push({type:2,data:ps(Ne)})})}L.messages[0].data=ps(ue);var ae=Ra(z),re=Fa(ae);V.content=re,V.size=V.content.length})();var Y=wt(P[3][0].data);{var K=Y[1][0];delete Y[2];var H=wt(K.data);{var je=Ns(H[2][0].data);(function(){for(var V=Ye.find(d,o[je].location),z=rr(ar(V.content)),L,te=0;te<z.length;++te){var ne=z[te];ne.id==je&&(L=ne)}var ue=wt(L.messages[0].data);{delete ue[6],delete Y[7];var Ne=new Uint8Array(ue[5][0].data);ue[5]=[];for(var ae=0,re=0;re<=a.e.r;++re){var M=wt(Ne);ae+=k_(M,i[re],l),M[1][0].data=_t(re),ue[5].push({data:ps(M),type:2})}ue[1]=[{type:0,data:_t(a.e.c+1)}],ue[2]=[{type:0,data:_t(a.e.r+1)}],ue[3]=[{type:0,data:_t(ae)}],ue[4]=[{type:0,data:_t(a.e.r+1)}]}L.messages[0].data=ps(ue);var _e=Ra(z),ke=Fa(_e);V.content=ke,V.size=V.content.length})()}K.data=ps(H)}P[3][0].data=ps(Y)}v[4][0].data=ps(P)}p.messages[0].data=ps(v);var ie=Ra(h),B=Fa(ie);return u.content=B,u.size=u.content.length,d}function uf(e){return function(s){for(var a=0;a!=e.length;++a){var n=e[a];s[n[0]]===void 0&&(s[n[0]]=n[1]),n[2]==="n"&&(s[n[0]]=Number(s[n[0]]))}}}function cd(e){uf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function dd(e){uf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function D_(e){return ft.WS.indexOf(e)>-1?"sheet":e==ft.CS?"chart":e==ft.DS?"dialog":e==ft.MS?"macro":e&&e.length?e:"sheet"}function I_(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,D_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function P_(e,r,s,a,n,i,l,o,c,d,m,u){try{i[a]=vn(Qs(e,s,!0),r);var h=ls(e,r),p;switch(o){case"sheet":p=t5(h,r,n,c,i[a],d,m,u);break;case"chart":if(p=s5(h,r,n,c,i[a],d,m,u),!p||!p["!drawel"])break;var x=fn(p["!drawel"].Target,r),f=Rn(x),g=US(Qs(e,x,!0),vn(Qs(e,f,!0),x)),v=fn(g,x),N=Rn(v);p=kC(Qs(e,v,!0),v,c,vn(Qs(e,N,!0),v),d,p);break;case"macro":p=r5(h,r,n,c,i[a],d,m,u);break;case"dialog":p=a5(h,r,n,c,i[a],d,m,u);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=p;var j=[];i&&i[a]&&es(i[a]).forEach(function(S){var C="";if(i[a][S].Type==ft.CMNT){C=fn(i[a][S].Target,r);var w=o5(ls(e,C,!0),C,c);if(!w||!w.length)return;Om(p,w,!1)}i[a][S].Type==ft.TCMNT&&(C=fn(i[a][S].Target,r),j=j.concat(HS(ls(e,C,!0),c)))}),j&&j.length&&Om(p,j,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function tr(e){return e.charAt(0)=="/"?e.slice(1):e}function R_(e,r){if(en(),r=r||{},cd(r),nr(e,"META-INF/manifest.xml")||nr(e,"objectdata.xml"))return qm(e,r);if(nr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Al<"u"){if(e.FileIndex)return Al(e);var s=Ye.utils.cfb_new();return rm(e).forEach(function(D){mt(s,D,Vj(e,D))}),Al(s)}throw new Error("Unsupported NUMBERS file")}if(!nr(e,"[Content_Types].xml"))throw nr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):nr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=rm(e),n=My(Qs(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",ls(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!ls(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!r.bookSheets&&!r.bookProps){if(bn=[],n.sst)try{bn=l5(ls(e,tr(n.sst)),n.sst,r)}catch(D){if(r.WTF)throw D}r.cellStyles&&n.themes.length&&(c=i5(Qs(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(d=n5(ls(e,tr(n.style)),n.style,c,r))}n.links.map(function(D){try{var W=vn(Qs(e,Rn(tr(D))),D);return d5(ls(e,tr(D)),W,D,r)}catch{}});var m=e5(ls(e,tr(n.workbooks[0])),n.workbooks[0],r),u={},h="";n.coreprops.length&&(h=ls(e,tr(n.coreprops[0]),!0),h&&(u=Qu(h)),n.extprops.length!==0&&(h=ls(e,tr(n.extprops[0]),!0),h&&Vy(h,u,r)));var p={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(h=Qs(e,tr(n.custprops[0]),!0),h&&(p=qy(h,r)));var x={};if((r.bookSheets||r.bookProps)&&(m.Sheets?l=m.Sheets.map(function(W){return W.name}):u.Worksheets&&u.SheetNames.length>0&&(l=u.SheetNames),r.bookProps&&(x.Props=u,x.Custprops=p),r.bookSheets&&typeof l<"u"&&(x.SheetNames=l),r.bookSheets?x.SheetNames:r.bookProps))return x;l={};var f={};r.bookDeps&&n.calcchain&&(f=c5(ls(e,tr(n.calcchain)),n.calcchain));var g=0,v={},N,j;{var S=m.Sheets;u.Worksheets=S.length,u.SheetNames=[];for(var C=0;C!=S.length;++C)u.SheetNames[C]=S[C].name}var w=i?"bin":"xml",y=n.workbooks[0].lastIndexOf("/"),T=(n.workbooks[0].slice(0,y+1)+"_rels/"+n.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");nr(e,T)||(T="xl/_rels/workbook."+w+".rels");var k=vn(Qs(e,T,!0),T.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=m5(ls(e,tr(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=GS(ls(e,tr(n.people[0])),r)),k&&(k=I_(k,m.Sheets));var P=ls(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var A="sheet";if(k&&k[g]?(N="xl/"+k[g][1].replace(/[\/]?xl\//,""),nr(e,N)||(N=k[g][1]),nr(e,N)||(N=T.replace(/_rels\/.*$/,"")+k[g][1]),A=k[g][2]):(N="xl/worksheets/sheet"+(g+1-P)+"."+w,N=N.replace(/sheet0\./,"sheet.")),j=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var _=!1,U=0;U!=r.sheets.length;++U)typeof r.sheets[U]=="number"&&r.sheets[U]==g&&(_=1),typeof r.sheets[U]=="string"&&r.sheets[U].toLowerCase()==u.SheetNames[g].toLowerCase()&&(_=1);if(!_)continue e}}P_(e,N,j,u.SheetNames[g],g,v,l,A,r,m,c,d)}return x={Directory:n,Workbook:m,Props:u,Custprops:p,Deps:f,Sheets:l,SheetNames:u.SheetNames,Strings:bn,Styles:d,Themes:c,SSF:Ut(Je)},r&&r.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(D,W){D=D.replace(/^Root Entry[\/]/,""),x.keys.push(D),x.files[D]=e.FileIndex[W]}))),r&&r.bookVBA&&(n.vba.length>0?x.vbaraw=ls(e,tr(n.vba[0]),!0):n.defaults&&n.defaults.bin===eT&&(x.vbaraw=ls(e,"xl/vbaProject.bin",!0))),x}function F_(e,r){var s=r||{},a="Workbook",n=Ye.find(e,a);try{if(a="/!DataSpaces/Version",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(mw(n.content),a="/!DataSpaces/DataSpaceMap",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=hw(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=fw(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);pw(n.content)}catch{}if(a="/EncryptionInfo",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=gw(n.content);if(a="/EncryptedPackage",n=Ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,s.password||"",s);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,s.password||"",s);throw new Error("File is password-protected")}function O_(e,r){return r.bookType=="ods"?mf(e,r):r.bookType=="numbers"?A_(e,r):r.bookType=="xlsb"?L_(e,r):M_(e,r)}function L_(e,r){Ma=1024,e&&!e.SSF&&(e.SSF=Ut(Je)),e&&e.SSF&&(en(),tl(e.SSF),r.revssf=rl(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var s=r.bookType=="xlsb"?"bin":"xml",a=Mh.indexOf(r.bookType)>-1,n=Kc();dd(r=r||{});var i=Fc(),l="",o=0;if(r.cellXfs=[],ta(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(i,l,eh(e.Props,r)),n.coreprops.push(l),kt(r.rels,2,l,ft.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(i,l,rh(e.Props)),n.extprops.push(l),kt(r.rels,3,l,ft.EXT_PROPS),e.Custprops!==e.Props&&es(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(i,l,ah(e.Custprops)),n.custprops.push(l),kt(r.rels,4,l,ft.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+s,mt(i,l,h5(o-1,l,r,e,m)),n.sheets.push(l),kt(r.wbrels,-1,"worksheets/sheet"+o+"."+s,ft.WS[0])}if(u){var p=u["!comments"],x=!1,f="";p&&p.length>0&&(f="xl/comments"+o+"."+s,mt(i,f,p5(p,f)),n.comments.push(f),kt(m,-1,"../comments"+o+"."+s,ft.CMNT),x=!0),u["!legacy"]&&x&&mt(i,"xl/drawings/vmlDrawing"+o+".vml",Oh(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}m["!id"].rId1&&mt(i,Rn(l),$a(m))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+s,mt(i,l,x5(r.Strings,l,r)),n.strs.push(l),kt(r.wbrels,-1,"sharedStrings."+s,ft.SST)),l="xl/workbook."+s,mt(i,l,u5(e,l)),n.workbooks.push(l),kt(r.rels,1,l,ft.WB),l="xl/theme/theme1.xml",mt(i,l,td(e.Themes,r)),n.themes.push(l),kt(r.wbrels,-1,"theme/theme1.xml",ft.THEME),l="xl/styles."+s,mt(i,l,f5(e,l,r)),n.styles.push(l),kt(r.wbrels,-1,"styles."+s,ft.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",mt(i,l,e.vbaraw),n.vba.push(l),kt(r.wbrels,-1,"vbaProject.bin",ft.VBA)),l="xl/metadata."+s,mt(i,l,g5(l)),n.metadata.push(l),kt(r.wbrels,-1,"metadata."+s,ft.XLMETA),mt(i,"[Content_Types].xml",Ju(n,r)),mt(i,"_rels/.rels",$a(r.rels)),mt(i,"xl/_rels/workbook."+s+".rels",$a(r.wbrels)),delete r.revssf,delete r.ssf,i}function M_(e,r){Ma=1024,e&&!e.SSF&&(e.SSF=Ut(Je)),e&&e.SSF&&(en(),tl(e.SSF),r.revssf=rl(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var s="xml",a=Mh.indexOf(r.bookType)>-1,n=Kc();dd(r=r||{});var i=Fc(),l="",o=0;if(r.cellXfs=[],ta(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(i,l,eh(e.Props,r)),n.coreprops.push(l),kt(r.rels,2,l,ft.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,mt(i,l,rh(e.Props)),n.extprops.push(l),kt(r.rels,3,l,ft.EXT_PROPS),e.Custprops!==e.Props&&es(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(i,l,ah(e.Custprops)),n.custprops.push(l),kt(r.rels,4,l,ft.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:l="xl/worksheets/sheet"+o+"."+s,mt(i,l,Kh(o-1,r,e,u)),n.sheets.push(l),kt(r.wbrels,-1,"worksheets/sheet"+o+"."+s,ft.WS[0])}if(h){var x=h["!comments"],f=!1,g="";if(x&&x.length>0){var v=!1;x.forEach(function(N){N[1].forEach(function(j){j.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+s,mt(i,g,VS(x,m,r)),n.threadedcomments.push(g),kt(u,-1,"../threadedComments/threadedComment"+o+"."+s,ft.TCMNT)),g="xl/comments"+o+"."+s,mt(i,g,Lh(x)),n.comments.push(g),kt(u,-1,"../comments"+o+"."+s,ft.CMNT),f=!0}h["!legacy"]&&f&&mt(i,"xl/drawings/vmlDrawing"+o+".vml",Oh(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&mt(i,Rn(l),$a(u))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+s,mt(i,l,Sh(r.Strings,r)),n.strs.push(l),kt(r.wbrels,-1,"sharedStrings."+s,ft.SST)),l="xl/workbook."+s,mt(i,l,ef(e)),n.workbooks.push(l),kt(r.rels,1,l,ft.WB),l="xl/theme/theme1.xml",mt(i,l,td(e.Themes,r)),n.themes.push(l),kt(r.wbrels,-1,"theme/theme1.xml",ft.THEME),l="xl/styles."+s,mt(i,l,Ih(e,r)),n.styles.push(l),kt(r.wbrels,-1,"styles."+s,ft.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",mt(i,l,e.vbaraw),n.vba.push(l),kt(r.wbrels,-1,"vbaProject.bin",ft.VBA)),l="xl/metadata."+s,mt(i,l,Fh()),n.metadata.push(l),kt(r.wbrels,-1,"metadata."+s,ft.XLMETA),m.length>1&&(l="xl/persons/person.xml",mt(i,l,qS(m)),n.people.push(l),kt(r.wbrels,-1,"persons/person.xml",ft.PEOPLE)),mt(i,"[Content_Types].xml",Ju(n,r)),mt(i,"_rels/.rels",$a(r.rels)),mt(i,"xl/_rels/workbook."+s+".rels",$a(r.wbrels)),delete r.revssf,delete r.ssf,i}function md(e,r){var s="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":s=er(e.slice(0,12));break;case"binary":s=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function B_(e,r){return Ye.find(e,"EncryptedPackage")?F_(e,r):af(e,r)}function z_(e,r){var s,a=e,n=r||{};return n.type||(n.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),s=Eu(a,n),R_(s,n)}function hf(e,r){var s=0;e:for(;s<e.length;)switch(e.charCodeAt(s)){case 10:case 13:case 32:++s;break;case 60:return fc(e.slice(s),r);default:break e}return Ya.to_workbook(e,r)}function $_(e,r){var s="",a=md(e,r);switch(r.type){case"base64":s=er(e);break;case"binary":s=e;break;case"buffer":s=e.toString("binary");break;case"array":s=va(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(s=Ft(s)),r.type="binary",hf(s,r)}function U_(e,r){var s=e;return r.type=="base64"&&(s=er(s)),s=_n.utils.decode(1200,s.slice(2),"str"),r.type="binary",hf(s,r)}function W_(e){return e.match(/[^\x00-\x7F]/)?Er(e):e}function Dl(e,r,s,a){return a?(s.type="string",Ya.to_workbook(e,s)):Ya.to_workbook(r,s)}function $n(e,r){Ac();var s=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $n(new Uint8Array(e),(s=Ut(s),s.type="array",s));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!s.type&&(s.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),Wa={},s.dateNF&&(Wa.dateNF=s.dateNF),s.type||(s.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),s.type=="file"&&(s.type=ut?"buffer":"binary",a=Lj(e),typeof Uint8Array<"u"&&!ut&&(s.type="array")),s.type=="string"&&(i=!0,s.type="binary",s.codepage=65001,a=W_(e)),s.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return s=Ut(s),s.type="array",$n(Dc(a),s)}switch((n=md(a,s))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return B_(Ye.read(a,s),s);break;case 9:if(n[1]<=8)return af(a,s);break;case 60:return fc(a,s);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return YN(a,s);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return Nh.to_workbook(a,s);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?z_(a,s):Dl(e,a,s,i);case 239:return n[3]===60?fc(a,s):Dl(e,a,s,i);case 255:if(n[1]===254)return U_(a,s);if(n[1]===0&&n[2]===2&&n[3]===0)return ma.to_workbook(a,s);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ma.to_workbook(a,s);break;case 3:case 131:case 139:case 140:return hc.to_workbook(a,s);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return kh.to_workbook(a,s);break;case 10:case 13:case 32:return $_(a,s);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qN.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?hc.to_workbook(a,s):Dl(e,a,s,i)}function ff(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Zn(r.file,Ye.write(e,{type:ut?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Ye.write(e,r)}function H_(e,r){var s=Ut(r||{}),a=O_(e,s);return V_(a,s)}function V_(e,r){var s={},a=ut?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(s.compression="DEFLATE"),r.password)s.type=a;else switch(r.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":s.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var n=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!r.compression}):e.generate(s);if(typeof Deno<"u"&&typeof n=="string"){if(r.type=="binary"||r.type=="base64")return n;n=new Uint8Array(el(n))}return r.password&&typeof encrypt_agile<"u"?ff(encrypt_agile(n,r.password),r):r.type==="file"?Zn(r.file,n):r.type=="string"?Ft(n):n}function G_(e,r){var s=r||{},a=W5(e,s);return ff(a,s)}function Sr(e,r,s){s||(s="");var a=s+e;switch(r.type){case"base64":return kn(Er(a));case"binary":return Er(a);case"string":return e;case"file":return Zn(r.file,a,"utf8");case"buffer":return ut?Mr(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Sr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function q_(e,r){switch(r.type){case"base64":return kn(e);case"binary":return e;case"string":return e;case"file":return Zn(r.file,e,"binary");case"buffer":return ut?Mr(e,"binary"):e.split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Ni(e,r){switch(r.type){case"string":case"base64":case"binary":for(var s="",a=0;a<e.length;++a)s+=String.fromCharCode(e[a]);return r.type=="base64"?kn(s):r.type=="string"?Ft(s):s;case"file":return Zn(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function xf(e,r){Ac(),BC(e);var s=Ut(r||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),s.type=="array"){s.type="binary";var a=xf(e,s);return s.type="array",el(a)}var n=0;if(s.sheet&&(typeof s.sheet=="number"?n=s.sheet:n=e.SheetNames.indexOf(s.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return Sr(O5(e,s),s);case"slk":case"sylk":return Sr(yh.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"htm":case"html":return Sr(lf(e.Sheets[e.SheetNames[n]],s),s);case"txt":return q_(pf(e.Sheets[e.SheetNames[n]],s),s);case"csv":return Sr(hd(e.Sheets[e.SheetNames[n]],s),s,"\uFEFF");case"dif":return Sr(Nh.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"dbf":return Ni(hc.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"prn":return Sr(Ya.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"rtf":return Sr(kh.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"eth":return Sr(wh.from_sheet(e.Sheets[e.SheetNames[n]],s),s);case"fods":return Sr(mf(e,s),s);case"wk1":return Ni(ma.sheet_to_wk1(e.Sheets[e.SheetNames[n]],s),s);case"wk3":return Ni(ma.book_to_wk3(e,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),Ni(nf(e,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),G_(e,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return H_(e,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function Y_(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},s=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(e.bookType=s.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function ud(e,r,s){var a=s||{};return a.type="file",a.file=r,Y_(a),xf(e,a)}function K_(e,r,s,a,n,i,l,o){var c=as(s),d=o.defval,m=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:s,enumerable:!1})}catch{h.__rowNum__=s}else h.__rowNum__=s;if(!l||e[s])for(var p=r.s.c;p<=r.e.c;++p){var x=l?e[s][p]:e[a[p]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[p]!=null&&(h[i[p]]=d);continue}var f=x.v;switch(x.t){case"z":if(f==null)break;continue;case"e":f=f==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(f==null)if(x.t=="e"&&f===null)h[i[p]]=null;else if(d!==void 0)h[i[p]]=d;else if(m&&f===null)h[i[p]]=null;else continue;else h[i[p]]=m&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?f:Lr(x,f,o);f!=null&&(u=!1)}}return{row:h,isempty:u}}function Wi(e,r){if(e==null||e["!ref"]==null)return[];var s={t:"n",v:0},a=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=r||{},m=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof m){case"string":c=yt(m);break;case"number":c=yt(e["!ref"]),c.s.r=m;break;default:c=m}a>0&&(n=0);var u=as(c.s.r),h=[],p=[],x=0,f=0,g=Array.isArray(e),v=c.s.r,N=0,j={};g&&!e[v]&&(e[v]=[]);var S=d.skipHidden&&e["!cols"]||[],C=d.skipHidden&&e["!rows"]||[];for(N=c.s.c;N<=c.e.c;++N)if(!(S[N]||{}).hidden)switch(h[N]=Yt(N),s=g?e[v][N]:e[h[N]+u],a){case 1:i[N]=N-c.s.c;break;case 2:i[N]=h[N];break;case 3:i[N]=d.header[N-c.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),o=l=Lr(s,null,d),f=j[l]||0,!f)j[l]=1;else{do o=l+"_"+f++;while(j[o]);j[l]=f,j[o]=1}i[N]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(C[v]||{}).hidden){var w=K_(e,c,v,h,a,i,g,d);(w.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(p[x++]=w.row)}return p.length=x,p}var Zm=/"/g;function X_(e,r,s,a,n,i,l,o){for(var c=!0,d=[],m="",u=as(s),h=r.s.c;h<=r.e.c;++h)if(a[h]){var p=o.dense?(e[s]||[])[h]:e[a[h]+u];if(p==null)m="";else if(p.v!=null){c=!1,m=""+(o.rawNumbers&&p.t=="n"?p.v:Lr(p,null,o));for(var x=0,f=0;x!==m.length;++x)if((f=m.charCodeAt(x))===n||f===i||f===34||o.forceQuotes){m='"'+m.replace(Zm,'""')+'"';break}m=="ID"&&(m='"ID"')}else p.f!=null&&!p.F?(c=!1,m="="+p.f,m.indexOf(",")>=0&&(m='"'+m.replace(Zm,'""')+'"')):m="";d.push(m)}return o.blankrows===!1&&c?null:d.join(l)}function hd(e,r){var s=[],a=r??{};if(e==null||e["!ref"]==null)return"";var n=yt(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),m="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(u[x]=Yt(x));for(var f=0,g=n.s.r;g<=n.e.r;++g)(p[g]||{}).hidden||(m=X_(e,n,g,u,l,c,i,a),m!=null&&(a.strip&&(m=m.replace(d,"")),(m||a.blankrows!==!1)&&s.push((f++?o:"")+m)));return delete a.dense,s.join("")}function pf(e,r){r||(r={}),r.FS="	",r.RS=`
`;var s=hd(e,r);return s}function J_(e){var r="",s,a="";if(e==null||e["!ref"]==null)return[];var n=yt(e["!ref"]),i="",l=[],o,c=[],d=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=Yt(o);for(var m=n.s.r;m<=n.e.r;++m)for(i=as(m),o=n.s.c;o<=n.e.c;++o)if(r=l[o]+i,s=d?(e[m]||[])[o]:e[r],a="",s!==void 0){if(s.F!=null){if(r=s.F,!s.f)continue;a=s.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(s.f!=null)a=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)a=""+s.v;else if(s.t=="b")a=s.v?"TRUE":"FALSE";else if(s.w!==void 0)a="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?a="'"+s.v:a=""+s.v}}c[c.length]=r+"="+a}return c}function gf(e,r,s){var a=s||{},n=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Kt(a.origin):a.origin;l=c.r,o=c.c}var d,m={s:{c:0,r:0},e:{c:o,r:l+r.length-1+n}};if(i["!ref"]){var u=yt(i["!ref"]);m.e.c=Math.max(m.e.c,u.e.c),m.e.r=Math.max(m.e.r,u.e.r),l==-1&&(l=u.e.r+1,m.e.r=l+r.length-1+n)}else l==-1&&(l=0,m.e.r=r.length-1+n);var h=a.header||[],p=0;r.forEach(function(f,g){es(f).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var N=f[v],j="z",S="",C=Qe({c:o+p,r:l+g+n});d=Un(i,C),N&&typeof N=="object"&&!(N instanceof Date)?i[C]=N:(typeof N=="number"?j="n":typeof N=="boolean"?j="b":typeof N=="string"?j="s":N instanceof Date?(j="d",a.cellDates||(j="n",N=ms(N)),S=a.dateNF||Je[14]):N===null&&a.nullError&&(j="e",N=0),d?(d.t=j,d.v=N,delete d.w,delete d.R,S&&(d.z=S)):i[C]=d={t:j,v:N},S&&(d.z=S))})}),m.e.c=Math.max(m.e.c,o+h.length-1);var x=as(l);if(n)for(p=0;p<h.length;++p)i[Yt(p+o)+x]={t:"s",v:h[p]};return i["!ref"]=dt(m),i}function Z_(e,r){return gf(null,e,r)}function Un(e,r,s){if(typeof r=="string"){if(Array.isArray(e)){var a=Kt(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Un(e,Qe(r)):Un(e,Qe({r,c:s||0}))}function Q_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var s=e.SheetNames.indexOf(r);if(s>-1)return s;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function fd(){return{SheetNames:[],Sheets:{}}}function xd(e,r,s,a){var n=1;if(!s)for(;n<=65535&&e.SheetNames.indexOf(s="Sheet"+n)!=-1;++n,s=void 0);if(!s||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(s)>=0){var i=s.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||s;for(++n;n<=65535&&e.SheetNames.indexOf(s=l+n)!=-1;++n);}if(Qh(s),e.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return e.SheetNames.push(s),e.Sheets[s]=r,s}function e3(e,r,s){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Q_(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}e.Workbook.Sheets[a].Hidden=s}function t3(e,r){return e.z=r,e}function vf(e,r,s){return r?(e.l={Target:r},s&&(e.l.Tooltip=s)):delete e.l,e}function s3(e,r,s){return vf(e,"#"+r,s)}function r3(e,r,s){e.c||(e.c=[]),e.c.push({t:r,a:s||"SheetJS"})}function a3(e,r,s,a){for(var n=typeof r!="string"?r:yt(r),i=typeof r=="string"?r:dt(r),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=Un(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=s,a&&(c.D=!0))}return e}var lr={encode_col:Yt,encode_row:as,encode_cell:Qe,encode_range:dt,decode_col:Wc,decode_row:Uc,split_cell:xy,decode_cell:Kt,decode_range:Ys,format_cell:Lr,sheet_add_aoa:Hu,sheet_add_json:gf,sheet_add_dom:of,aoa_to_sheet:tn,json_to_sheet:Z_,table_to_sheet:cf,table_to_book:m_,sheet_to_csv:hd,sheet_to_txt:pf,sheet_to_json:Wi,sheet_to_html:lf,sheet_to_formulae:J_,sheet_to_row_object_array:Wi,sheet_get_cell:Un,book_new:fd,book_append_sheet:xd,book_set_sheet_visibility:e3,cell_set_number_format:t3,cell_set_hyperlink:vf,cell_set_internal_link:s3,cell_add_comment:r3,sheet_set_array_formula:a3,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const n3=({show:e,onClose:r,onImport:s,loading:a=!1})=>{const[n,i]=b.useState(!1),[l,o]=b.useState(null),[c,d]=b.useState([]),[m,u]=b.useState([]),[h,p]=b.useState([]),[x,f]=b.useState([]),[g,v]=b.useState(!1),N=b.useRef(null),j=["first_name","last_name","email","role"],S=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","department","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];b.useEffect(()=>{e&&C()},[e]);const C=async()=>{try{v(!0);const ie=await Is.getRoles();f(ie.roles||[])}catch(ie){console.error("Failed to fetch roles:",ie),u(["Failed to load roles. Please refresh the page."])}finally{v(!1)}},w=ie=>{if(!ie)return"";try{return decodeURIComponent(escape(ie)).trim()}catch{return ie.toString().trim()}},y=ie=>{if(!ie)return"";try{let B;if(ie instanceof Date)B=ie;else{const z=ie.toString().trim();if(!z||z===""||z==="null"||z==="undefined")return"";if(z.includes("/")){const L=z.split("/");L.length===3&&(B=new Date(L[2],L[0]-1,L[1]))}else if(z.includes("-")){const L=z.split("-");L.length===3&&(L[0].length===4?B=new Date(L[0],L[1]-1,L[2]):B=new Date(L[2],L[1]-1,L[0]))}else B=new Date(z)}if(isNaN(B.getTime()))return"";const V=B.getFullYear();return V<1900||V>2100?"":B.toISOString()}catch(B){return console.error("Error formatting date:",B,"Input:",ie),""}},T=ie=>{if(!ie)return"MALE";const B=ie.toString().toUpperCase().trim();return B==="MALE"||B==="FEMALE"?B:{M:"MALE",F:"FEMALE"}[B]||"MALE"},k=ie=>{if(!ie)return null;const B=ie.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(B)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},P=ie=>{if(!ie||!x.length)return null;const B=ie.toUpperCase().trim(),V=x.find(ne=>ne.name.toUpperCase()===B);if(V)return V.id;const L={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT"}[B];if(L){const ne=x.find(ue=>ue.name.toUpperCase()===L);if(ne)return ne.id}const te=x.find(ne=>ne.name.toUpperCase().includes(B)||B.includes(ne.name.toUpperCase()));return te?te.id:null},A=ie=>{if(!ie||!x.length)return null;const B=ie.toUpperCase().trim(),V=x.find(ne=>ne.name.toUpperCase()===B);if(V)return V.name;const L={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT"}[B];if(L){const ne=x.find(ue=>ue.name.toUpperCase()===L);if(ne)return ne.name}const te=x.find(ne=>ne.name.toUpperCase().includes(B)||B.includes(ne.name.toUpperCase()));return te?te.name:null},_=()=>{const ie=[S,["Nguyn","Vn","An","123 ng L Li, Qun 1, TP.HCM","nguyen.van.an@example.com","+84 123 456 789","TRAINER","M","1","CERT001","Flight Training","5","1990-01-15","BATCH2023-01","P123456789","Vietnam"]],B=lr.aoa_to_sheet(ie),V=lr.book_new();lr.book_append_sheet(V,B,"Users"),ud(V,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},U=ie=>{ie.preventDefault(),ie.stopPropagation(),ie.type==="dragenter"||ie.type==="dragover"?i(!0):ie.type==="dragleave"&&i(!1)},D=ie=>{ie.preventDefault(),ie.stopPropagation(),i(!1),ie.dataTransfer.files&&ie.dataTransfer.files[0]&&q(ie.dataTransfer.files[0])},W=ie=>{ie.target.files&&ie.target.files[0]&&q(ie.target.files[0])},q=ie=>{if(!ie.name.match(/\.(xlsx|xls)$/)){u(["Please upload an Excel file (.xlsx or .xls)"]);return}if(ie.size>100*1024*1024){u(["File size must be less than 100MB"]);return}o(ie),u([]),p([]),d([]);const B=new FileReader;B.onload=V=>{try{const z=new Uint8Array(V.target.result),L=$n(z,{type:"array",cellText:!1,cellDates:!0,raw:!1}),te=L.SheetNames[0],ne=L.Sheets[te],ue=lr.sheet_to_json(ne,{header:1,defval:"",raw:!1});if(ue.length<2){u(["File must contain at least a header row and one data row"]);return}const Ne=ue[0].map(ce=>ce?ce.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),ae=ue.slice(1),re={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",department:"department",dept:"department",dept_id:"department",department_id:"department",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},_e=Ne.map(ce=>re[ce]||ce).filter(ce=>S.includes(ce)),ke=j.filter(ce=>!_e.includes(ce));if(ke.length>0){p([`Your file is missing these essential data to create a user: ${ke.join(", ")}`]);return}const ze=ae.map((ce,Se)=>{const Me={};let Ve=!1;const Ue=[];Ne.forEach((ot,he)=>{const me=re[ot]||ot;if(S.includes(me)){let Be="";ce[he]!==null&&ce[he]!==void 0&&(typeof ce[he]=="string"?Be=w(ce[he]):typeof ce[he]=="number"?Be=ce[he].toString():Be=w(ce[he].toString())),me==="gender"&&(Be=T(Be)),Me[me]=Be}}),_e.forEach(ot=>{const he=Me[ot]||"";if(j.includes(ot)&&!he&&(Ve=!0,Ue.push("Required field missing")),ot==="email"&&he&&!/\S+@\S+\.\S+/.test(he)&&(Ve=!0,Ue.push("Invalid email")),ot==="role"&&he&&(P(he)||(Ve=!0,Ue.push("Invalid role"))),ot==="phone_number"&&he&&he.length>15&&(Ve=!0,Ue.push("Phone number too long (max 15 characters)")),ot==="years_of_experience"&&he&&isNaN(he)&&(Ve=!0,Ue.push("Invalid experience value")),ot==="gender"&&he){const me=k(he);me&&(Ve=!0,Ue.push(me))}});const Tt=A(Me.role);return Tt==="TRAINER"?((!Me.specialization||Me.specialization.trim()==="")&&(Ve=!0,Ue.push("Trainer requires specialization")),(!Me.years_of_experience||Me.years_of_experience.trim()==="")&&(Ve=!0,Ue.push("Trainer requires years of experience")),Me.department&&Me.department.trim()!==""&&Me.department.trim()!=="-"&&(Ve=!0,Ue.push("Department is not allowed for Trainer role"))):Tt==="TRAINEE"&&(!Me.date_of_birth||Me.date_of_birth.trim()===""?(Ve=!0,Ue.push("Trainee requires date of birth")):y(Me.date_of_birth)||(Ve=!0,Ue.push(`Invalid date format for date of birth: "${Me.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!Me.training_batch||Me.training_batch.trim()==="")&&(Ve=!0,Ue.push("Trainee requires training batch")),(!Me.passport_no||Me.passport_no.trim()==="")&&(Ve=!0,Ue.push("Trainee requires passport number")),(!Me.nation||Me.nation.trim()==="")&&(Ve=!0,Ue.push("Trainee requires nation")),Me.enrollment_date&&Me.enrollment_date.trim()!==""&&(y(Me.enrollment_date)||(Ve=!0,Ue.push(`Invalid date format for enrollment date: "${Me.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Se+1,...Me,hasError:Ve,errors:Ue,status:Ve?"error":"valid"}});d(ze)}catch{u(["Error reading file. Please make sure it's a valid Excel file."])}},B.readAsArrayBuffer(ie)},Y=async()=>{const ie=c.filter(V=>!V.hasError);if(ie.length===0){u(["No valid users to import"]);return}if(!x.length){u(["Roles not loaded. Please wait and try again."]);return}const B=ie.map(V=>{const z=V.phone_number?V.phone_number.substring(0,15):"",L=P(V.role),te=A(V.role);if(!L||!te)throw new Error(`Role "${V.role}" not found in system`);const ne={firstName:V.first_name||"",middleName:V.middle_name||"",lastName:V.last_name||"",address:V.address||"",email:V.email||"",phoneNumber:z,avatarUrl:V.avatar_url||"",gender:T(V.gender),role:{id:L,name:te}};if(te==="DEPARTMENT_HEAD"?V.department&&V.department.trim()!==""&&V.department.trim()!=="-"?ne.departmentId=V.department:ne.departmentId=null:te!=="TRAINER"&&V.department&&V.department.trim()!==""&&V.department.trim()!=="-"&&(ne.departmentId=V.department),te==="TRAINER")ne.trainerProfile={specialization:V.specialization||"",yearsOfExp:V.years_of_experience?parseInt(V.years_of_experience):0,certificationNumber:V.certification_number||"",bio:V.bio||""};else if(te==="TRAINEE"){const ue={trainingBatch:V.training_batch||"",passportNo:V.passport_no||"",nation:V.nation||""},Ne=y(V.date_of_birth);Ne&&(ue.dob=Ne);const ae=y(V.enrollment_date);ae?ue.enrollmentDate=ae:ue.enrollmentDate=new Date().toISOString(),ne.traineeProfile=ue}return ne});try{await s(B),K()}catch(V){u([V.message||"Failed to import users. Please try again."])}},K=()=>{o(null),d([]),u([]),p([]),i(!1),r()},H=ie=>{d(B=>B.filter(V=>V.id!==ie))},je=ie=>ie==="valid"?t.jsx(rt,{className:"text-success",size:16}):t.jsx(Ms,{className:"text-danger",size:16});return t.jsxs(le,{show:e,onHide:K,size:"xl",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-2",size:20}),"Bulk Import Users"]}),t.jsx(se,{variant:"link",onClick:K,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&t.jsxs("div",{className:"text-center mb-3",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:t.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),t.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),t.jsx(R,{className:"mb-4",children:t.jsxs(R.Body,{children:[t.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:U,onDragLeave:U,onDragOver:U,onDrop:D,onClick:()=>N.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[t.jsx(Ha,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),t.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),t.jsx("input",{ref:N,type:"file",accept:".xlsx,.xls",onChange:W,style:{display:"none"}})]}),t.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[t.jsxs("div",{children:[l&&t.jsxs("p",{className:"text-success mb-1",children:[t.jsx("strong",{children:"Uploaded file:"})," ",l.name]}),t.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),t.jsxs("small",{className:"text-info d-block mt-1",children:[t.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:_,className:"d-flex align-items-center",children:[t.jsx(qr,{className:"me-1",size:14}),"Download Template"]})]})]})}),m.length>0&&t.jsx("div",{className:"alert alert-danger mb-3",children:t.jsx("ul",{className:"mb-0",children:m.map((ie,B)=>t.jsx("li",{children:ie},B))})}),h.length>0&&t.jsx(Ae,{variant:"warning",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:h.map((ie,B)=>t.jsx("li",{children:ie},B))})}),c.length>0&&t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:t.jsxs(gt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{style:{minWidth:"50px"},children:"NO."}),t.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),t.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),t.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),t.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),t.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),t.jsx("th",{style:{minWidth:"100px"},children:"DEPARTMENT"}),t.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),t.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),t.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),t.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),t.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),t.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),t.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),t.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),t.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),t.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),t.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),t.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),t.jsx("tbody",{children:c.map(ie=>t.jsxs("tr",{className:ie.hasError?"table-danger":"",children:[t.jsx("td",{children:ie.id}),t.jsx("td",{children:ie.first_name||ie.full_name||"-"}),t.jsx("td",{children:ie.middle_name||"-"}),t.jsx("td",{children:ie.last_name||"-"}),t.jsx("td",{children:ie.email||"-"}),t.jsx("td",{children:ie.role||"-"}),t.jsx("td",{children:ie.department||"-"}),t.jsx("td",{children:ie.phone_number||"-"}),t.jsx("td",{children:ie.gender?t.jsx("span",{title:`Original: ${ie.gender}`,children:T(ie.gender)}):"-"}),t.jsx("td",{children:ie.certification_number||"-"}),t.jsx("td",{children:ie.specialization||"-"}),t.jsx("td",{children:ie.years_of_experience||"-"}),t.jsx("td",{children:ie.date_of_birth||"-"}),t.jsx("td",{children:ie.training_batch||"-"}),t.jsx("td",{children:ie.passport_no||"-"}),t.jsx("td",{children:ie.nation||"-"}),t.jsx("td",{className:"text-center",children:je(ie.status)}),t.jsx("td",{children:ie.errors.length>0&&t.jsx("small",{className:"text-danger",children:ie.errors.length>1?`${ie.errors[0]} (+${ie.errors.length-1} more)`:ie.errors[0]})}),t.jsx("td",{children:t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>H(ie.id),children:t.jsx(Zr,{size:14})})})]},ie.id))})]})})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:K,disabled:a,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&t.jsx(Of,{placement:"top",overlay:t.jsxs(Lf,{id:"import-tooltip",children:["Only ",c.filter(ie=>!ie.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:t.jsx(se,{variant:"primary",onClick:Y,disabled:a||c.filter(ie=>!ie.hasError).length===0,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"me-2",size:16}),"Import All (",c.filter(ie=>!ie.hasError).length," users)"]})})})]})]})},i3=({show:e,user:r,onConfirm:s,onCancel:a,loading:n=!1})=>{if(!r)return null;const i=r.status==="ACTIVE",l=i?"Disable":"Enable",c=i?Xa:rt;return t.jsxs(le,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[t.jsx(le.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),l," User"]})}),t.jsxs(le.Body,{className:"py-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:t.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),t.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),t.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),t.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[t.jsxs("div",{className:"d-flex align-items-center mb-2",children:[t.jsx("div",{className:"me-3",children:t.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:t.jsx("span",{className:"fw-bold",children:r.fullName.charAt(0)})})}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:r.fullName}),t.jsx("small",{className:"text-muted",children:r.email})]})]}),t.jsxs("div",{className:"row text-center",children:[t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"text-muted small",children:"EID"}),t.jsx("div",{className:"fw-medium",children:r.eid})]}),t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"text-muted small",children:"Role"}),t.jsx("div",{className:"fw-medium",children:r.role})]}),t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"text-muted small",children:"Department"}),t.jsx("div",{className:"fw-medium",children:r.department})]})]})]}),i?t.jsxs(Ae,{variant:"warning",className:"mb-0",children:[t.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),t.jsxs("ul",{className:"mb-0 small",children:[t.jsx("li",{children:"User cannot log into the system"}),t.jsx("li",{children:"All active sessions will be terminated"}),t.jsx("li",{children:"User data will be preserved but access restricted"}),t.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):t.jsxs(Ae,{variant:"success",className:"mb-0",children:[t.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),t.jsxs("ul",{className:"mb-0 small",children:[t.jsx("li",{children:"User can log into the system normally"}),t.jsx("li",{children:"All permissions and access will be restored"}),t.jsx("li",{children:"User will receive notification of account activation"}),t.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),t.jsxs(le.Footer,{className:"border-0 bg-light",children:[t.jsx(se,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),t.jsx(se,{variant:i?"warning":"success",onClick:s,disabled:n,className:"d-flex align-items-center",children:n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):t.jsxs(t.Fragment,{children:[t.jsx(c,{className:"me-2",size:16}),l," User"]})})]})]})},l3=({uniqueRoles:e,uniqueDepartments:r,selectedRoles:s,selectedDepartments:a,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:l,className:o=""})=>{const c=s.length>0||a.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown ${o}`,children:[t.jsx(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",c&&t.jsx("span",{className:"badge bg-primary ms-2",children:s.length+a.length})]})}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),s.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>t.jsx(E.Check,{type:"checkbox",id:`role-${d}`,label:d,checked:s.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),a.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(d=>t.jsx(E.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},o3=({show:e,user:r,newRole:s,onConfirm:a,onCancel:n,loading:i=!1})=>{if(!r)return null;const l=d=>{switch(d){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},o=l(r.role),c=l(s);return t.jsxs(le,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[t.jsx(le.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),t.jsxs(le.Body,{className:"py-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:t.jsx(Wt,{size:32,className:"text-warning"})}),t.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),t.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),t.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[t.jsxs("div",{className:"d-flex align-items-center mb-2",children:[t.jsx("div",{className:"me-3",children:t.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:t.jsx("span",{className:"fw-bold",children:r.fullName.charAt(0)})})}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:r.fullName}),t.jsx("small",{className:"text-muted",children:r.email})]})]}),t.jsxs("div",{className:"row text-center",children:[t.jsxs("div",{className:"col-6",children:[t.jsx("div",{className:"text-muted small",children:"Current Role"}),t.jsx("div",{className:"fw-medium",children:r.role})]}),t.jsxs("div",{className:"col-6",children:[t.jsx("div",{className:"text-muted small",children:"New Role"}),t.jsx("div",{className:"fw-medium text-primary",children:s})]})]})]}),t.jsxs(Ae,{variant:"warning",className:"mb-0",children:[t.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),t.jsxs("ul",{className:"mb-0 small",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Current EID:"})," ",r.eid," (Prefix: ",o,")"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),t.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),t.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),t.jsxs(le.Footer,{className:"border-0 bg-light",children:[t.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:i,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"warning",onClick:()=>{a()},disabled:i,className:"d-flex align-items-center",children:i?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(rt,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},c3=({show:e,user:r,mode:s,onSave:a,onClose:n})=>{const[i,l]=b.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[o,c]=b.useState({}),[d,m]=b.useState(!1),[u,h]=b.useState([]),[p,x]=b.useState(!1),[f,g]=b.useState([]),[v,N]=b.useState(!1),[j,S]=b.useState([]),C=async()=>{x(!0);try{const D=await Nt.getDepartments(),q=(D.departments||D.data||[]).map(Y=>Y.name);h(q)}catch(D){console.error("Error fetching departments:",D),de.error("Failed to load departments"),h([])}finally{x(!1)}},w=async()=>{N(!0);try{const D=await Ps.getRoles(),q=(D.roles||D.data||[]).map(Y=>Y.name);g(q)}catch(D){console.error("Error fetching roles:",D),de.error("Failed to load roles"),g([])}finally{N(!1)}},y=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],T=async()=>{try{const W=(await Nt.getDepartments({includeDeleted:!0}))?.departments?.filter(q=>q.headUser)||[];S(W)}catch(D){console.error("Error fetching departments with heads:",D),S([])}};b.useEffect(()=>{e&&(C(),w(),T())},[e]),b.useEffect(()=>{r&&s!=="add"?l({firstName:r.firstName||"",middleName:r.middleName||"",lastName:r.lastName||"",address:r.address||"",email:r.email||"",phoneNumber:r.phoneNumber||"",role:r.role||"",roleId:r.roleId||"",certificationNumber:r.certificationNumber||"",specialization:r.specialization||"",yearsOfExperience:r.yearsOfExperience||"",dateOfBirth:r.dateOfBirth||"",trainingBatch:r.trainingBatch||"",passportNo:r.passportNo||"",nation:r.nation||"",department:r.department||""}):s==="add"&&l({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[r,s,e]);const k=()=>{const D={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(D.firstName="First name can only contain letters and spaces"):D.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(D.lastName="Last name can only contain letters and spaces"):D.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(D.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(D.email="Email is invalid"):D.email="Email is required",!i.phoneNumber.trim())D.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))D.phoneNumber="Phone number cannot contain letters";else{const W=i.phoneNumber.replace(/[^\d+]/g,"");(W.length<7||W.length>16)&&(D.phoneNumber="Phone number must be 7-16 digits")}if(i.role||(D.role="Role is required"),i.role==="DEPARTMENT_HEAD"&&i.department&&i.department.trim()){const W=j.find(q=>{const Y=q.name,K=i.department,H=q.headUser?.id,je=Y&&K&&Y.toLowerCase()===K.toLowerCase(),ie=s!=="edit"||H!==r?.id;return je&&ie});if(W){const q=`${W.headUser?.firstName||""} ${W.headUser?.lastName||""}`.trim();D.department=`Department "${i.department}" already has a head: ${q}`}}return i.role==="TRAINER"&&(i.specialization.trim()||(D.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(D.certificationNumber="Certification number is required for trainers"),i.department&&i.department.trim()!==""&&(D.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(D.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(D.passportNo="Passport number must be 1-20 digits only"):D.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?D.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(D.dateOfBirth="Date of birth must be in the past"):D.dateOfBirth="Date of birth is required for trainees"),c(D),Object.keys(D).length===0},P=async D=>{if(D.preventDefault(),!!k()&&!d){m(!0);try{await a(i)}catch(W){console.error("Error in handleSubmit:",W)}finally{m(!1)}}},A=(D,W)=>{l(q=>({...q,[D]:W})),c(q=>{const Y={...q};if(Y[D]&&delete Y[D],D==="role"&&(delete Y.specialization,delete Y.certificationNumber,delete Y.trainingBatch,delete Y.passportNo,delete Y.dateOfBirth,delete Y.department),D==="department"){if(delete Y.department,i.role==="TRAINER")W&&W.trim()!==""&&(Y.department="Department is not allowed for Trainer role");else if(i.role==="DEPARTMENT_HEAD"&&W&&W.trim()){const K=j.find(H=>{const je=H.name,ie=W,B=H.headUser?.id;return je&&ie&&je.toLowerCase()===ie.toLowerCase()&&(s!=="edit"||B!==r?.id)});if(K){const H=`${K.headUser?.firstName||""} ${K.headUser?.lastName||""}`.trim();Y.department=`Department "${W}" already has a head: ${H}`}}}return D==="role"&&W==="TRAINER"&&l(K=>({...K,department:""})),Y})},_=()=>{switch(s){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},U=s==="view";return t.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[t.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[s==="view"?t.jsx(xt,{className:"me-2",size:20}):t.jsx(cr,{className:"me-2",size:20}),_()]})}),t.jsxs(E,{onSubmit:P,children:[t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(o).length>0&&t.jsxs("div",{className:"alert alert-danger mb-3",children:[t.jsx("strong",{children:"Please fix the following errors:"}),t.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([D,W])=>t.jsx("li",{children:W},D))})]}),t.jsxs(oe,{children:[t.jsx(F,{md:4,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),t.jsx(E.Control,{type:"text",value:i.firstName,onChange:D=>A("firstName",D.target.value),isInvalid:!!o.firstName,readOnly:U,style:{borderColor:o.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.firstName})]})}),t.jsx(F,{md:4,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),t.jsx(E.Control,{type:"text",value:i.middleName,onChange:D=>A("middleName",D.target.value),isInvalid:!!o.middleName,readOnly:U,style:{borderColor:o.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.middleName})]})}),t.jsx(F,{md:4,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),t.jsx(E.Control,{type:"text",value:i.lastName,onChange:D=>A("lastName",D.target.value),isInvalid:!!o.lastName,readOnly:U,style:{borderColor:o.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.lastName})]})})]}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),t.jsx(E.Control,{type:"email",value:i.email,onChange:D=>A("email",D.target.value),isInvalid:!!o.email,readOnly:U,style:{borderColor:o.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.email})]})})}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),t.jsx(E.Control,{type:"tel",value:i.phoneNumber,onChange:D=>A("phoneNumber",D.target.value),isInvalid:!!o.phoneNumber,readOnly:U,placeholder:"Enter phone number",style:{borderColor:o.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.phoneNumber})]})})}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),t.jsx(E.Control,{as:"textarea",rows:3,value:i.address,onChange:D=>A("address",D.target.value),readOnly:U,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),t.jsxs(oe,{children:[t.jsx(F,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),t.jsxs(E.Select,{value:i.role,onChange:D=>A("role",D.target.value),isInvalid:!!o.role,disabled:U||v,style:{borderColor:o.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[t.jsx("option",{value:"",children:v?"Loading roles...":"Select a role"}),f.map(D=>t.jsx("option",{value:D,children:D},D))]}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.role})]})}),i.role==="DEPARTMENT_HEAD"&&t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),t.jsxs(E.Select,{value:i.department,onChange:D=>A("department",D.target.value),isInvalid:!!o.department,disabled:U||p,style:{borderColor:o.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[t.jsx("option",{value:"",children:p?"Loading departments...":"Select a department"}),u.map(D=>t.jsx("option",{value:D,children:D},D))]}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.department})]})})]}),i.role==="TRAINER"&&t.jsxs(t.Fragment,{children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),t.jsx(E.Control,{type:"text",value:i.specialization,onChange:D=>A("specialization",D.target.value),isInvalid:!!o.specialization,readOnly:U,placeholder:"Enter specialization",style:{borderColor:o.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.specialization})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),t.jsx(E.Control,{type:"text",value:i.certificationNumber,onChange:D=>A("certificationNumber",D.target.value),isInvalid:!!o.certificationNumber,readOnly:U,placeholder:"Enter certification number",style:{borderColor:o.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.certificationNumber})]})})]}),t.jsx(oe,{children:t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),t.jsx(E.Control,{type:"number",value:i.yearsOfExperience,onChange:D=>A("yearsOfExperience",D.target.value),readOnly:U,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})})]}),i.role==="TRAINEE"&&t.jsxs(t.Fragment,{children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),t.jsx(E.Control,{type:"date",value:i.dateOfBirth,onChange:D=>{const W=D.target.value;(W===""||W.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(W))&&A("dateOfBirth",W)},isInvalid:!!o.dateOfBirth,readOnly:U,max:"2024-12-31",min:"1900-01-01",style:{borderColor:o.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.dateOfBirth})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),t.jsx(E.Control,{type:"text",value:i.trainingBatch,onChange:D=>A("trainingBatch",D.target.value),isInvalid:!!o.trainingBatch,readOnly:U,placeholder:"Enter training batch",style:{borderColor:o.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.trainingBatch})]})})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),t.jsx(E.Control,{type:"text",value:i.passportNo,onChange:D=>A("passportNo",D.target.value),isInvalid:!!o.passportNo,readOnly:U,placeholder:"Enter passport number",style:{borderColor:o.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.passportNo})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),t.jsxs(E.Select,{value:i.nation,onChange:D=>A("nation",D.target.value),disabled:U,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[t.jsx("option",{value:"",children:"Select a nation"}),y.map(D=>t.jsx("option",{value:D,children:D},D))]})]})})]})]}),s==="view"&&r&&t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),t.jsx(E.Control,{type:"text",value:r.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:d,children:[t.jsx(Ge,{className:"me-2",size:16}),s==="view"?"Close":"Cancel"]}),s!=="view"&&t.jsx(se,{variant:"primary-custom",type:"submit",disabled:d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),s==="add"?"Add User":"Save Changes"]})})]})]})]})},d3=({user:e,index:r,onView:s,onEdit:a,onDisable:n})=>{const i=o=>o==="ACTIVE"?"success":"secondary",l=o=>o==="ACTIVE"?"":"";return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-dark",children:e.email})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:e.department})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs(Te,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:l(e.status)}),e.status]})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.USERS.VIEW_DETAIL,be.USERS.UPDATE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(e),permission:be.USERS.VIEW_DETAIL},{label:"Edit User",icon:t.jsx(bs,{}),onClick:()=>a(e),permission:be.USERS.UPDATE},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:t.jsx(Xa,{}),className:"text-danger",onClick:()=>n(e),permission:be.USERS.UPDATE}]})})})]})},m3=({users:e,loading:r,onView:s,onEdit:a,onDisable:n})=>{const{sortedData:i,sortConfig:l,handleSort:o}=Ot(e);if(r)return t.jsx(It,{rows:5,columns:6});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No users found"}),t.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:d,children:m,className:u=""})=>{const h=l.key===d,p=h?l.direction:null;return t.jsxs("th",{className:`text-primary-custom fw-semibold ${u} ${h?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>o(d),onMouseEnter:x=>{x.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="transparent",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"600":"500"},children:m}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:p,size:14})})]}),h&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),t.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),t.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),t.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),t.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),t.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:i.map((d,m)=>t.jsx(d3,{user:d,index:m,onView:s,onEdit:a,onDisable:n},d.id))})]})})},u3=()=>{const[e,r]=b.useState([]),[s,a]=b.useState([]),[n,i]=b.useState(""),[l,o]=b.useState([]),[c,d]=b.useState([]),[m,u]=b.useState(!1),[h,p]=b.useState(null),[x,f]=b.useState("view"),[g,v]=b.useState(!1),[N,j]=b.useState(null),[S,C]=b.useState(!1),[w,y]=b.useState(null);b.useEffect(()=>{(async()=>{v(!0);try{const[te,ne]=await Promise.all([Is.getUsers({includeDeleted:!0}),Nt.getDepartments({includeDeleted:!0})]),ue=te.data.map(ae=>({id:ae.id,eid:ae.eid,fullName:[ae.firstName,ae.middleName,ae.lastName].filter(Boolean).join(" "),firstName:ae.firstName,middleName:ae.middleName,lastName:ae.lastName,role:ae.role?.name||"N/A",roleId:ae.role?.id||"",department:ae.department?.name||"N/A",status:ae.status,email:ae.email,phoneNumber:ae.phoneNumber||"",address:ae.address||"",certificationNumber:ae.certificationNumber||"",specialization:ae.specialization||"",yearsOfExperience:ae.yearsOfExperience||"",dateOfBirth:ae.dateOfBirth||"",trainingBatch:ae.trainingBatch||"",passportNo:ae.passportNo||"",nation:ae.nation||"",createdAt:ae.createdAt,lastLogin:ae.lastLogin||""})),Ne=ne.departments||ne||[];r(ue),a(Ne),j(null)}catch(te){const ne=hr(te,{});j(ne)}finally{v(!1)}})()},[]);const T=[...new Set(e.map(L=>L.role).filter(Boolean))],k=[...new Set(s.map(L=>L.name).filter(Boolean)),...new Set(e.map(L=>L.department).filter(Boolean))].filter((L,te,ne)=>ne.indexOf(L)===te),P=e.filter(L=>{const te=!n||L.fullName.toLowerCase().includes(n.toLowerCase())||L.eid.toLowerCase().includes(n.toLowerCase())||L.email.toLowerCase().includes(n.toLowerCase()),ne=l.length===0||l.includes(L.role),ue=c.length===0||c.includes(L.department);return te&&ne&&ue}),A=L=>i(L),_=L=>{o(te=>te.includes(L)?te.filter(ne=>ne!==L):[...te,L])},U=L=>{d(te=>te.includes(L)?te.filter(ne=>ne!==L):[...te,L])},D=()=>{o([]),d([]),i("")},W=async L=>{try{v(!0);const te=await Is.getUserById(L.id),ne={id:te.id,eid:te.eid,fullName:[te.firstName,te.middleName,te.lastName].filter(Boolean).join(" "),firstName:te.firstName,middleName:te.middleName,lastName:te.lastName,role:te.role?.name||"N/A",roleId:te.role?.id||"",department:te.department?.name||"N/A",status:te.status,email:te.email,phoneNumber:te.phoneNumber||"",address:te.address||"",certificationNumber:te.trainerProfile?.certificationNumber||"",specialization:te.trainerProfile?.specialization||"",yearsOfExperience:te.trainerProfile?.yearsOfExp||"",dateOfBirth:te.traineeProfile?.dob?te.traineeProfile.dob.split("T")[0]:"",trainingBatch:te.traineeProfile?.trainingBatch||"",passportNo:te.traineeProfile?.passportNo||"",nation:te.traineeProfile?.nation||"",createdAt:te.createdAt,lastLogin:te.lastLogin||""};p(ne),f("view"),u(!0)}catch{j("Unable to load user details")}finally{v(!1)}},q=async L=>{try{v(!0);const te=await Is.getUserById(L.id),ne={id:te.id,eid:te.eid,fullName:[te.firstName,te.middleName,te.lastName].filter(Boolean).join(" "),firstName:te.firstName,middleName:te.middleName,lastName:te.lastName,role:te.role?.name||"N/A",roleId:te.role?.id||"",department:te.department?.name||"N/A",status:te.status,email:te.email,phoneNumber:te.phoneNumber||"",address:te.address||"",certificationNumber:te.trainerProfile?.certificationNumber||"",specialization:te.trainerProfile?.specialization||"",yearsOfExperience:te.trainerProfile?.yearsOfExp||"",dateOfBirth:te.traineeProfile?.dob?te.traineeProfile.dob.split("T")[0]:"",trainingBatch:te.traineeProfile?.trainingBatch||"",passportNo:te.traineeProfile?.passportNo||"",nation:te.traineeProfile?.nation||"",createdAt:te.createdAt,lastLogin:te.lastLogin||""};p(ne),f("edit"),u(!0)}catch{j("Unable to load user details")}finally{v(!1)}},Y=()=>{p(null),f("add"),u(!0)},K=async L=>{try{v(!0);let te,ne;L.status==="ACTIVE"?(te=await Is.disableUser(L.id),ne="disabled"):(te=await Is.enableUser(L.id),ne="enabled");const[ue,Ne]=await Promise.all([Is.getUsers({includeDeleted:!0}),Nt.getDepartments({includeDeleted:!0})]),ae=ue.data.map(_e=>({id:_e.id,eid:_e.eid,fullName:[_e.firstName,_e.middleName,_e.lastName].filter(Boolean).join(" "),firstName:_e.firstName,middleName:_e.middleName,lastName:_e.lastName,role:_e.role?.name||"N/A",roleId:_e.role?.id||"",department:_e.department?.name||"N/A",status:_e.status,email:_e.email,phoneNumber:_e.phoneNumber||"",address:_e.address||"",certificationNumber:_e.trainerProfile?.certificationNumber||"",specialization:_e.trainerProfile?.specialization||"",yearsOfExperience:_e.trainerProfile?.yearsOfExp||"",dateOfBirth:_e.traineeProfile?.dob?_e.traineeProfile.dob.split("T")[0]:"",trainingBatch:_e.traineeProfile?.trainingBatch||"",passportNo:_e.traineeProfile?.passportNo||"",nation:_e.traineeProfile?.nation||"",createdAt:_e.createdAt,lastLogin:_e.lastLogin||""})),re=Ne.departments||Ne||[];r(ae),a(re);const M=te?.message||`User has been ${ne} successfully!`;de.success(M)}catch(te){const ne=hr(te,{});j(ne),de.error(ne)}finally{v(!1)}},H=async L=>{try{if(v(!0),x==="edit"&&h&&h.role!==L.role){y(L),C(!0),v(!1);return}await je(L)}catch{v(!1)}},je=async L=>{try{v(!0);let te=null;try{const _e=(await Is.getRoles()).roles?.find(ke=>ke.name===L.role);if(_e)te=_e.id;else throw new Error(`Role '${L.role}' not found in backend`)}catch(M){throw new Error(`Failed to get role ID for '${L.role}': ${M.message}`)}const ne={firstName:L.firstName,middleName:L.middleName||"",lastName:L.lastName,address:L.address||"",email:L.email,gender:"MALE",avatarUrl:"",phoneNumber:L.phoneNumber||"",role:{id:te,name:L.role}};if(L.role==="TRAINER")ne.trainerProfile={specialization:L.specialization||"",certificationNumber:L.certificationNumber||"",yearsOfExp:L.yearsOfExperience?parseInt(L.yearsOfExperience):0,bio:""};else if(L.role==="DEPARTMENT_HEAD")if(L.department&&L.department.trim()){const M=s.find(_e=>_e.name===L.department);if(M)ne.departmentId=M.id;else throw new Error(`Department '${L.department}' not found`)}else ne.departmentId=null;else L.role==="TRAINEE"&&(L.dateOfBirth||L.trainingBatch||L.passportNo||L.nation)&&(ne.traineeProfile={dob:L.dateOfBirth?new Date(L.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:L.trainingBatch||"",passportNo:L.passportNo||"",nation:L.nation||""});x==="add"?(await Is.createUser(ne),de.success("User created successfully!")):x==="edit"&&(await Is.updateUser(h.id,ne),de.success("User updated successfully!")),u(!1);const[ue,Ne]=await Promise.all([Is.getUsers({includeDeleted:!0}),Nt.getDepartments({includeDeleted:!0})]);if(x==="edit"&&h?.id){const M=ue.data.find(_e=>_e.id===h.id)}const ae=ue.data.map(M=>({id:M.id,eid:M.eid,fullName:[M.firstName,M.middleName,M.lastName].filter(Boolean).join(" "),firstName:M.firstName,middleName:M.middleName,lastName:M.lastName,role:M.role?.name||"N/A",roleId:M.role?.id||"",department:M.department?.name||"N/A",status:M.status,email:M.email,phoneNumber:M.phoneNumber||"",address:M.address||"",certificationNumber:M.trainerProfile?.certificationNumber||"",specialization:M.trainerProfile?.specialization||"",yearsOfExperience:M.trainerProfile?.yearsOfExp||"",dateOfBirth:M.traineeProfile?.dob?M.traineeProfile.dob.split("T")[0]:"",trainingBatch:M.traineeProfile?.trainingBatch||"",passportNo:M.traineeProfile?.passportNo||"",nation:M.traineeProfile?.nation||"",createdAt:M.createdAt,lastLogin:M.lastLogin||""})),re=Ne.departments||Ne||[];r(ae),a(re)}catch(te){const ne=hr(te,{});throw j(ne),new Error(ne)}finally{v(!1)}};return{users:P,searchTerm:n,selectedRoles:l,selectedDepartments:c,uniqueRoles:T,uniqueDepartments:k,modalShow:m,selectedUser:h,modalMode:x,loading:g,error:N,confirmRoleChange:S,pendingUserData:w,handleSearch:A,handleRoleToggle:_,handleDepartmentToggle:U,handleClearFilters:D,handleView:W,handleEdit:q,handleAdd:Y,handleDisable:K,handleSave:H,handleBulkImport:async L=>{try{v(!0);const te=await Is.bulkImportUsers(L);if(te.success&&te.success.length>0&&de.success(`Successfully imported ${te.success.length} users!`),te.failed&&te.failed.length>0){const re=te.failed.map(M=>`User ${M.index+1}: ${M.error}`);de.error(`Failed to import ${te.failed.length} users: ${re.join(", ")}`)}const[ne,ue]=await Promise.all([Is.getUsers({includeDeleted:!0}),Nt.getDepartments({includeDeleted:!0})]),Ne=ne.data.map(re=>({id:re.id,eid:re.eid,fullName:[re.firstName,re.middleName,re.lastName].filter(Boolean).join(" "),firstName:re.firstName,middleName:re.middleName,lastName:re.lastName,role:re.role?.name||"N/A",roleId:re.role?.id||"",department:re.department?.name||"N/A",status:re.status,email:re.email,phoneNumber:re.phoneNumber||"",address:re.address||"",certificationNumber:re.trainerProfile?.certificationNumber||"",specialization:re.trainerProfile?.specialization||"",yearsOfExperience:re.trainerProfile?.yearsOfExp||"",dateOfBirth:re.traineeProfile?.dob?re.traineeProfile.dob.split("T")[0]:"",trainingBatch:re.traineeProfile?.trainingBatch||"",passportNo:re.traineeProfile?.passportNo||"",nation:re.traineeProfile?.nation||"",createdAt:re.createdAt,lastLogin:re.lastLogin||""})),ae=ue.departments||ue||[];r(Ne),a(ae)}catch(te){const ne=hr(te,{});j(ne),de.error(ne)}finally{v(!1)}},handleModalClose:()=>{u(!1),p(null)},handleConfirmRoleChange:async()=>{C(!1),w&&(await je(w),y(null))},handleCancelRoleChange:()=>{C(!1),y(null)},setError:j}},h3=()=>{const[e,r]=b.useState(!1),[s,a]=b.useState(null),[n,i]=b.useState(!1),[l,o]=b.useState(!1),{users:c,loading:d,error:m,searchTerm:u,selectedRoles:h,selectedDepartments:p,uniqueRoles:x,uniqueDepartments:f,modalShow:g,selectedUser:v,modalMode:N,confirmRoleChange:j,pendingUserData:S,handleSearch:C,handleRoleToggle:w,handleDepartmentToggle:y,handleClearFilters:T,handleView:k,handleEdit:P,handleAdd:A,handleDisable:_,handleSave:U,handleBulkImport:D,handleModalClose:W,handleConfirmRoleChange:q,handleCancelRoleChange:Y}=u3(),K=ie=>{a(ie),r(!0)},H=async()=>{if(s){i(!0);try{await _(s),r(!1),a(null)}catch(ie){console.error("Error disabling user:",ie)}finally{i(!1)}}},je=()=>{r(!1),a(null)};return J.useEffect(()=>{m&&de.error(m)},[m]),t.jsx(Ee,{fluid:!0,className:"py-4 user-management-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[t.jsx(Ht,{permission:be.USERS.BULK_CREATE,fallback:null,children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>o(!0),className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-1",size:16}),t.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),t.jsx("span",{className:"d-sm-none",children:"Import"})]})}),t.jsx(Ht,{permission:be.USERS.CREATE,fallback:null,children:t.jsxs(se,{variant:"primary-custom",size:"sm",onClick:A,className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-1",size:16}),"Add User"]})})]})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search users by name, EID, or email...",value:u,onChange:C,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(l3,{uniqueRoles:x,uniqueDepartments:f,selectedRoles:h,selectedDepartments:p,onRoleToggle:w,onDepartmentToggle:y,onClearFilters:T,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[c.length," user",c.length!==1?"s":""]})})})]}),t.jsxs("div",{className:"position-relative",children:[t.jsx(m3,{users:c,loading:d,onView:k,onEdit:P,onDisable:K}),c.length>8&&t.jsxs("div",{className:"scroll-indicator",children:[t.jsx(Cr,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),t.jsx(c3,{show:g,user:v,mode:N,onSave:U,onClose:W}),t.jsx(n3,{show:l,onClose:()=>o(!1),onImport:D,loading:d}),t.jsx(i3,{show:e,user:s,onConfirm:H,onCancel:je,loading:n}),t.jsx(o3,{show:j,user:v,newRole:S?.role,onConfirm:q,onCancel:Y,loading:d})]})]})})},f3=({show:e,role:r,onConfirm:s,onCancel:a,loading:n})=>{if(!r)return null;const i=r.status==="Active",l=i?"Disable":"Enable",c=i?T0:rt;return t.jsxs(le,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[t.jsx(le.Header,{closeButton:!0,className:`text-white ${i?"bg-warning":"bg-success"}`,style:{borderBottom:"none"},children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(c,{size:24,className:"me-2"}),l," Role: ",r.name]})}),t.jsxs(le.Body,{className:"py-4",children:[t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-warning)":"var(--bs-success)",fontSize:"1.5rem",fontWeight:"bold"},children:r.name.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("h6",{className:"mb-0",children:r.name}),t.jsx("small",{className:"text-muted",children:r.description})]})]}),i?t.jsxs(Ae,{variant:"warning",className:"mb-3",children:[t.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2"})," Warning: Disabling Role"]}),t.jsxs("p",{className:"mb-1",children:["This action will disable the ",t.jsx("span",{className:"fw-bold",children:r.name})," role."]}),t.jsxs("ul",{className:"mb-0 ps-3",children:[t.jsx("li",{children:"Users with this role will lose access to associated permissions."}),t.jsx("li",{children:"Role data will be preserved but access will be restricted."}),t.jsx("li",{children:"Role can be re-enabled later by an administrator."}),t.jsxs("li",{children:["Currently assigned to ",r.assignedUsers," user",r.assignedUsers!==1?"s":"","."]})]})]}):t.jsxs(Ae,{variant:"success",className:"mb-3",children:[t.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[t.jsx(rt,{className:"me-2"})," Confirm: Enabling Role"]}),t.jsxs("p",{className:"mb-1",children:["This action will restore the ",t.jsx("span",{className:"fw-bold",children:r.name})," role."]}),t.jsxs("ul",{className:"mb-0 ps-3",children:[t.jsx("li",{children:"Users with this role will regain access to associated permissions."}),t.jsx("li",{children:"All role permissions and access will be restored."}),t.jsx("li",{children:"Role will be available for assignment to new users."}),t.jsxs("li",{children:["Currently assigned to ",r.assignedUsers," user",r.assignedUsers!==1?"s":"","."]})]})]}),t.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[t.jsx(se,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),t.jsx(se,{variant:i?"warning":"success",onClick:s,disabled:n,className:"d-flex align-items-center",children:n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):t.jsxs(t.Fragment,{children:[t.jsx(c,{size:16,className:"me-2"}),l," Role"]})})]})]})]})},x3=({uniqueStatuses:e,selectedStatuses:r,onStatusToggle:s,onClearFilters:a,className:n=""})=>{const i=r.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown ${n}`,children:[t.jsx(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",i&&t.jsx("span",{className:"badge bg-primary ms-2",children:r.length})]})}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),r.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>s("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>t.jsx(E.Check,{type:"checkbox",id:`status-${l}`,label:l,checked:r.includes(l),onChange:()=>s(l),className:"mb-1"},l))})]}),i&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},p3=["ADMINISTRATOR"],Qm=e=>p3.includes(e?.toUpperCase()),g3=({show:e,role:r,mode:s,onSave:a,onClose:n})=>{const[i,l]=b.useState({name:"",description:"",permissionIds:[]}),[o,c]=b.useState({}),[d,m]=b.useState(!1),[u,h]=b.useState({}),{allPermissions:p,loading:x,error:f,fetchAllPermissions:g}=pb(),v=b.useMemo(()=>{if(!p||p.length===0)return[];const P={};return p.forEach(A=>{const _=A.module,U=A.viewModule||`${A.module} Management`;P[_]||(P[_]={id:_,name:U,description:`Manage ${U.toLowerCase()} related permissions`,permissions:[]});const D=A.id||A.permissionId;D&&P[_].permissions.push({id:D,title:A.viewName||A.name,description:A.description||"",isActive:A.isActive,method:A.method,path:A.path})}),Object.values(P).sort((A,_)=>A.name.localeCompare(_.name))},[p]),N=b.useMemo(()=>{const P=v;if(s==="view"&&r?.permissions){const A=r.permissions.map(_=>_.id||_);return P.map(_=>({..._,permissions:_.permissions.filter(U=>A.includes(U.id))})).filter(_=>_.permissions.length>0)}return P},[v,s,r?.permissions]);b.useEffect(()=>{if(r&&s!=="add"){const P=r.permissions?r.permissions.map(A=>A.id||A):[];l({name:r.name||"",description:r.description||"",permissionIds:P})}else s==="add"&&l({name:"",description:"",permissionIds:[]});c({})},[r,s,e]),b.useEffect(()=>{e&&g()},[e,g]),b.useEffect(()=>{if(s==="view"){const P={};N.map(_=>_.id).forEach(_=>{P[_]=!0}),h(P)}else if(s==="edit"){const P={};N.map(_=>_.id).forEach(_=>{P[_]=!0}),h(P)}else h({})},[s,N]);const j=()=>{const P={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(P.name="Role name cannot contain special characters"):P.name="Role name is required",i.permissionIds.length===0&&(P.permissionIds="At least one permission is required"),c(P),Object.keys(P).length===0},S=async P=>{if(P.preventDefault(),!!j()){m(!0);try{await a(i)}catch(A){console.error("Error saving role:",A)}finally{m(!1)}}},C=(P,A)=>{l(_=>({..._,[P]:A})),o[P]&&c(_=>({..._,[P]:""}))},w=P=>{!P||P===null||P===void 0||(l(A=>{const _=A.permissionIds||[],U=_.some(D=>String(D)===String(P));return{...A,permissionIds:U?_.filter(D=>String(D)!==String(P)):[..._,P]}}),o.permissionIds&&c(A=>({...A,permissionIds:""})))},y=P=>{h(A=>({...A,[P]:!A[P]}))},T=()=>{switch(s){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},k=s==="view";return t.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[t.jsx(le.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[s==="view"?t.jsx(xt,{className:"me-2",size:20}):t.jsx(Nc,{className:"me-2",size:20}),T()]})}),t.jsxs(E,{onSubmit:S,children:[t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[r&&Qm(r.name)&&s==="edit"&&t.jsxs(Ae,{variant:"warning",className:"mb-3",children:[t.jsx(Wt,{className:"me-2"}),t.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(o).length>0&&t.jsxs("div",{className:"alert alert-danger mb-3",children:[t.jsx("strong",{children:"Please fix the following errors:"}),t.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([P,A])=>t.jsx("li",{children:A},P))})]}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsx(E.Group,{className:"mb-3",children:t.jsxs(oe,{className:"align-items-center",children:[t.jsx(F,{md:2,children:t.jsx(E.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),t.jsxs(F,{md:4,children:[t.jsx(E.Control,{type:"text",size:"sm",value:i.name,onChange:P=>{const A=P.target.value;/^[a-zA-Z0-9\s_]*$/.test(A)&&C("name",A)},isInvalid:!!o.name,readOnly:k,style:{borderColor:o.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.name})]})]})})})}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsx(E.Group,{className:"mb-3",children:t.jsxs(oe,{className:"align-items-start",children:[t.jsx(F,{md:2,children:t.jsx(E.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),t.jsx(F,{md:4,children:t.jsx(E.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:P=>C("description",P.target.value),readOnly:k,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),o.permissionIds&&t.jsx("div",{className:"text-danger small mb-2",children:o.permissionIds}),f&&t.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",f.message||"Unknown error"]}),t.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"300px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:x?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(St,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):N.length>0?t.jsx(t.Fragment,{children:N.map(P=>{const A=u[P.id];return t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${k?"":"cursor-pointer"}`,onClick:()=>!k&&y(P.id),role:k?void 0:"button",tabIndex:k?void 0:0,onKeyDown:k?void 0:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),y(P.id))},"aria-expanded":k?void 0:A,children:t.jsxs("div",{className:"d-flex align-items-center",children:[!k&&(A?t.jsx(Cr,{className:"me-2",size:16}):t.jsx(Hn,{className:"me-2",size:16})),t.jsxs("div",{children:[t.jsx("div",{className:"fw-bold text-primary-custom",children:P.name}),t.jsx("small",{className:"text-muted",children:P.description})]})]})}),A&&P.permissions.length>0&&t.jsx("div",{className:"ms-3 mt-2",children:t.jsx(yd,{variant:"flush",children:P.permissions.map(_=>{const U=_.id;return U?t.jsx(yd.Item,{className:"border-0 px-0 py-2 permission-item",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"form-check me-3",children:t.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${U}`,checked:i.permissionIds.some(D=>String(D)===String(U)),onChange:D=>{D.stopPropagation(),!k&&U&&w(U)},onClick:D=>{D.stopPropagation()},disabled:k,style:{cursor:k?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("div",{className:"fw-medium text-dark",children:_.title}),t.jsx("small",{className:"text-muted",children:_.description})]}),!k&&i.permissionIds.some(D=>String(D)===String(U))&&t.jsx(Te,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${P.id}-${U}`):null})})})]},P.id)})}):t.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),t.jsx("div",{className:"mt-2",children:t.jsxs("small",{className:"text-muted",children:[i.permissionIds.length," of ",N.reduce((P,A)=>P+A.permissions.length,0)," permissions assigned"]})})]})})}),s==="view"&&r&&t.jsx(oe,{children:t.jsx(F,{children:t.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[t.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsx("small",{className:"text-muted",children:"Assigned Users:"}),t.jsx("div",{className:"fw-medium",children:r.assignedUsers||0})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("small",{className:"text-muted",children:"Total Permissions:"}),t.jsx("div",{className:"fw-medium",children:i.permissionIds.length})]})]})]})})})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:d,children:[t.jsx(Ge,{className:"me-2",size:16}),s==="view"?"Close":"Cancel"]}),s!=="view"&&t.jsx(se,{variant:"primary-custom",type:"submit",disabled:d||r&&Qm(r.name),children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),s==="add"?"Add Role":"Save Changes"]})})]})]})]})},v3=({roles:e,loading:r,actionsComponent:s,onView:a,onEdit:n,onDisable:i})=>{const{sortedData:l,sortConfig:o,handleSort:c}=Ot(e);if(r)return t.jsx(It,{rows:4,columns:4});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No roles found"}),t.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const d=({columnKey:m,children:u,className:h=""})=>{const p=o.key===m,x=p?o.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${h} ${p?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>c(m),onMouseEnter:f=>{f.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",f.target.style.transform="translateY(-1px)",f.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:f=>{f.target.style.backgroundColor="transparent",f.target.style.transform="translateY(0)",f.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:p?"700":"600"},children:u}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:x,size:14})})]}),p&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[t.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:t.jsxs("tr",{children:[t.jsx(d,{columnKey:"name",className:"show-mobile",children:"Role Name"}),t.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(d,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),t.jsx(d,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:l.map((m,u)=>t.jsxs("tr",{children:[t.jsx("td",{className:"show-mobile",children:m.name}),t.jsx("td",{className:"show-mobile",children:t.jsxs(Te,{bg:m.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:m.status==="Active"?"":""}),m.status]})}),t.jsx("td",{className:"show-mobile",children:m.assignedUsers}),t.jsx("td",{className:"show-mobile",children:m.lastModified}),t.jsx("td",{className:"text-center show-mobile",children:t.jsx(s,{role:m})})]},m.id))})]})})},mn=e=>e===!0||e==="ACTIVE",b3=()=>{const[e,r]=b.useState([]),[s,a]=b.useState(""),[n,i]=b.useState([]),[l,o]=b.useState(!1),[c,d]=b.useState(null),[m,u]=b.useState("view"),[h,p]=b.useState(!1),[x,f]=b.useState(null);b.useEffect(()=>{(async()=>{p(!0);try{const U=(await Ps.getRoles({includeDeleted:!0})).roles.map(D=>({id:D.id,name:D.name,description:D.description||"",assignedUsers:D.userCount||0,status:mn(D.isActive)?"Active":"Inactive",createdAt:D.createdAt?D.createdAt.split("T")[0]:"",lastModified:D.updatedAt?D.updatedAt.split("T")[0]:"",isActive:D.isActive,permissions:D.permissions||[],originalData:D}));r(U),f(null)}catch(_){const U=hr(_,{});f(U),console.error("Error fetching roles:",_)}finally{p(!1)}})()},[]);const g=A=>a(A),v=A=>{i(A==="clear"?[]:_=>_.includes(A)?_.filter(U=>U!==A):[..._,A])},N=()=>{i([])},j=async A=>{try{p(!0);const _=await Ps.getRoleById(A.id);d(_),u("view"),o(!0)}catch(_){const U=hr(_,{});f(U),console.error("Error fetching role details:",_)}finally{p(!1)}},S=async A=>{try{p(!0);const _=await Ps.getRoleById(A.id),U={id:_.id,name:_.name,description:_.description||"",assignedUsers:_.userCount||0,status:mn(_.isActive)?"Active":"Inactive",createdAt:_.createdAt?_.createdAt.split("T")[0]:"",lastModified:_.updatedAt?_.updatedAt.split("T")[0]:"",isActive:_.isActive,permissions:_.permissions||[],originalData:_};d(U),u("edit"),o(!0),f(null)}catch(_){const U=hr(_,{});f(U)}finally{p(!1)}},C=()=>{d(null),u("add"),o(!0)},w=async A=>{if(window.confirm("Are you sure you want to delete this role?")){p(!0);try{await new Promise(_=>setTimeout(_,1e3)),r(_=>_.filter(U=>U.id!==A)),f(null)}catch{f("Failed to delete role")}finally{p(!1)}}},y=async A=>{p(!0);try{m==="add"?(await Ps.createRole(A),de.success("Role created successfully!")):(await Ps.updateRole(c.id,A),de.success("Role updated successfully!"));const U=(await Ps.getRoles({includeDeleted:!0})).roles.map(D=>({id:D.id,name:D.name,description:D.description||"",assignedUsers:D.userCount||0,status:mn(D.isActive)?"Active":"Inactive",createdAt:D.createdAt?D.createdAt.split("T")[0]:"",lastModified:D.updatedAt?D.updatedAt.split("T")[0]:"",isActive:D.isActive,originalData:D}));r(U),o(!1),d(null),f(null)}catch(_){const U=hr(_,{});f(U),de.error(U)}finally{p(!1)}},T=async A=>{p(!0);try{const _=e.find(H=>H.id===A);if(!_)throw new Error("Role not found");let U,D;mn(_.isActive)?(U=await Ps.disableRole(A),D="disabled"):(U=await Ps.enableRole(A),D="enabled");const Y=(await Ps.getRoles({includeDeleted:!0})).roles.map(H=>({id:H.id,name:H.name,description:H.description||"",assignedUsers:H.userCount||0,status:mn(H.isActive)?"Active":"Inactive",createdAt:H.createdAt?H.createdAt.split("T")[0]:"",lastModified:H.updatedAt?H.updatedAt.split("T")[0]:"",isActive:H.isActive,originalData:H}));r(Y);const K=U?.message||`Role has been ${D} successfully!`;de.success(K),f(null)}catch(_){const U=hr(_,{});f(U)}finally{p(!1)}},k=[...new Set(e.map(A=>A.status))];return{roles:e.filter(A=>{const _=A.name.toLowerCase().includes(s.toLowerCase()),U=n.length===0||n.includes(A.status);return _&&U}),loading:h,error:x,searchTerm:s,selectedStatuses:n,uniqueStatuses:k,modalShow:l,selectedRole:c,modalMode:m,handleSearch:g,handleStatusToggle:v,handleClearFilters:N,handleView:j,handleEdit:S,handleAdd:C,handleDelete:w,handleSave:y,handleDisable:T,handleModalClose:()=>o(!1),setError:f}},j3=()=>{const[e,r]=b.useState(!1),[s,a]=b.useState(null),[n,i]=b.useState(!1),{roles:l,loading:o,error:c,searchTerm:d,selectedStatuses:m,uniqueStatuses:u,modalShow:h,selectedRole:p,modalMode:x,handleSearch:f,handleStatusToggle:g,handleClearFilters:v,handleView:N,handleEdit:j,handleAdd:S,handleSave:C,handleDisable:w,handleModalClose:y}=b3(),T=_=>{a(_),r(!0)},k=async()=>{if(s){i(!0);try{await w(s.id),r(!1),a(null)}catch(_){console.error("Error disabling role:",_)}finally{i(!1)}}},P=()=>{r(!1),a(null)},A=({role:_})=>t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>N(_)},{label:"Edit Role",icon:t.jsx(bs,{}),onClick:()=>j(_)},..._.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:_.status==="Active"?"Disable Role":"Enable Role",icon:t.jsx(Xa,{}),className:_.status==="Active"?"text-warning":"text-success",onClick:()=>T(_)}]:[]]});return J.useEffect(()=>{c&&de.error(c)},[c]),t.jsx(Ee,{fluid:!0,className:"py-4 role-management-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsx("div",{className:"d-flex justify-content-end",children:t.jsx(Ht,{permission:be.ROLES.CREATE,fallback:null,children:t.jsxs(se,{variant:"primary-custom",size:"sm",onClick:S,className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-1",size:16}),"Add Role"]})})})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search roles by name...",value:d,onChange:f,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(x3,{uniqueStatuses:u,selectedStatuses:m,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[l.length," role",l.length!==1?"s":""]})})})]}),t.jsx(v3,{roles:l,loading:o,actionsComponent:A,onView:N,onEdit:j,onDisable:w}),t.jsx(g3,{show:h,role:p,mode:x,onSave:C,onClose:y}),t.jsx(f3,{show:e,role:s,onConfirm:k,onCancel:P,loading:n})]})]})})},y3=({show:e,department:r,onClose:s,onAssign:a,availableInstructors:n=[],assignedInstructors:i=[]})=>{const[l,o]=b.useState([]),[c,d]=b.useState("");b.useEffect(()=>{e&&(o([]),d(""))},[e]);const m=x=>{o(f=>f.includes(x)?f.filter(g=>g!==x):[...f,x])},u=()=>{a(l),o([])},h=x=>{console.log("Remove instructor:",x)},p=n.filter(x=>x.name.toLowerCase().includes(c.toLowerCase())||x.email.toLowerCase().includes(c.toLowerCase()));return!e||!r?null:t.jsxs(le,{show:e,onHide:s,size:"xl",centered:!0,children:[t.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(fa,{className:"me-2",size:20}),"Assign Instructors - ",r.name]})}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Available Instructors"}),t.jsx(E.Control,{type:"text",placeholder:"Search instructors...",value:c,onChange:x=>d(x.target.value),className:"mb-3",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}}),t.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-primary)"},children:p.length===0?t.jsx("div",{className:"p-4 text-center text-muted",children:"No available instructors found"}):p.map(x=>t.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom",style:{backgroundColor:l.includes(x.id)?"var(--bs-primary-bg-subtle)":"transparent"},children:[t.jsx(E.Check,{type:"checkbox",checked:l.includes(x.id),onChange:()=>m(x.id),className:"me-3"}),t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("div",{className:"fw-semibold text-dark",children:x.name}),t.jsx("div",{className:"text-muted small",children:x.email}),t.jsx("div",{className:"text-muted small",children:x.specialization||"No specialization"})]})]},x.id))})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Currently Assigned"}),t.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-success)"},children:i.length===0?t.jsx("div",{className:"p-4 text-center text-muted",children:"No instructors assigned yet"}):i.map(x=>t.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom bg-light",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("div",{className:"fw-semibold text-dark",children:x.name}),t.jsx("div",{className:"text-muted small",children:x.email}),t.jsx("div",{className:"text-muted small",children:x.specialization||"No specialization"})]}),t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>h(x.id),title:"Remove instructor",children:t.jsx(Ci,{size:14})})]},x.id))})]})})]}),l.length>0&&t.jsxs(Ae,{variant:"info",className:"mt-3",children:[t.jsx("strong",{children:l.length})," instructor(s) selected for assignment"]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:s,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsxs(se,{variant:"primary",onClick:u,disabled:l.length===0,children:[t.jsx(fa,{className:"me-2",size:16}),"Assign ",l.length," Instructor(s)"]})]})]})},N3=({show:e,department:r,onClose:s})=>{if(!e||!r)return null;const a=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return t.jsxs(le,{show:e,onHide:s,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[t.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Tr,{className:"me-2",size:20}),"Department Details"]})}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t.jsxs(oe,{className:"mb-4",children:[t.jsxs(F,{md:8,children:[t.jsx("h3",{className:"fw-bold text-dark mb-2",children:r.name}),t.jsx("p",{className:"text-muted mb-3",children:r.description})]}),t.jsx(F,{md:4,className:"text-end",children:t.jsx(Te,{bg:r.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:r.status})})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),t.jsx("div",{className:"p-3 bg-light rounded",children:t.jsx(Te,{bg:"primary",className:"px-3 py-2 fs-6",children:r.code})})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),t.jsx("div",{className:"p-3 bg-light rounded",children:t.jsx(Te,{bg:a(r.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:r.type})})]})})]}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{md:12,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),t.jsx("div",{className:"p-3 bg-light rounded",children:r.departmentHead?t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Ls,{className:"me-3 text-primary",size:24}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold text-dark",children:r.departmentHead.name}),t.jsx("div",{className:"text-muted",children:r.departmentHead.email})]})]}):t.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsxs(F,{md:12,children:[t.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),t.jsxs(oe,{children:[t.jsx(F,{md:4,children:t.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[t.jsx(it,{className:"text-primary mb-2",size:32}),t.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:r.coursesCount||0}),t.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),t.jsx(F,{md:4,children:t.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[t.jsx(rs,{className:"text-success mb-2",size:32}),t.jsx("div",{className:"h3 fw-bold text-success mb-1",children:r.traineesCount||0}),t.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),t.jsx(F,{md:4,children:t.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[t.jsx(Ls,{className:"text-info mb-2",size:32}),t.jsx("div",{className:"h3 fw-bold text-info mb-1",children:r.trainersCount||0}),t.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),t.jsx("div",{className:"p-3 bg-light rounded",children:new Date(r.createdAt).toLocaleDateString()})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),t.jsx("div",{className:"p-3 bg-light rounded",children:new Date(r.updatedAt).toLocaleDateString()})]})})]})]}),t.jsx(le.Footer,{className:"border-0 p-4",children:t.jsxs("button",{className:"btn btn-secondary",onClick:s,children:[t.jsx(Ge,{className:"me-2",size:16}),"Close"]})})]})},w3=({uniqueTypes:e,uniqueStatuses:r,selectedTypes:s,selectedStatuses:a,onTypeToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=s.length>0||a.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown ${o}`,children:[t.jsxs(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",c&&t.jsx("span",{className:"badge bg-primary ms-2",children:s.length+a.length})]}),t.jsx("div",{className:"position-absolute end-0 me-3",children:t.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:t.jsx("path",{d:"M6 8L2 4h8L6 8z"})})})]}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Types"}),s.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>t.jsx(E.Check,{type:"checkbox",id:`type-${d}`,label:d,checked:s.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),a.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(d=>t.jsx(E.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},S3=({show:e,department:r,mode:s,onSave:a,onClose:n,availableUsers:i})=>{const[l,o]=b.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,d]=b.useState({}),[m,u]=b.useState(!1);b.useEffect(()=>{r&&s!=="add"?o({name:r.name||"",code:r.code||"",description:r.description||"",departmentHeadId:r.departmentHeadId||""}):s==="add"&&o({name:"",code:"",description:"",departmentHeadId:""}),d({})},[r,s,e]);const h=()=>{const v={};return l.name.trim()?l.name.trim().length<3?v.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(l.name.trim())||(v.name="Department name cannot contain special characters"):v.name="Department name is required",l.code.trim()?/^[A-Z]{2,5}$/.test(l.code.trim())||(v.code="Department code must be 2-5 uppercase letters"):v.code="Department code is required",l.departmentHeadId||(v.departmentHeadId="Department head is required"),d(v),Object.keys(v).length===0},p=async v=>{if(v.preventDefault(),!!h()){u(!0);try{const N={name:l.name.trim(),code:l.code.trim(),description:l.description.trim(),headUserId:l.departmentHeadId};console.log(" Department data being sent:",N),await a(N)}catch(N){console.error("Error saving department:",N)}finally{u(!1)}}},x=(v,N)=>{o(j=>({...j,[v]:N})),c[v]&&d(j=>({...j,[v]:""}))},f=()=>{switch(s){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=s==="view";return t.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[t.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[s==="view"?t.jsx(xt,{className:"me-2",size:20}):t.jsx(cr,{className:"me-2",size:20}),f()]})}),t.jsxs(E,{onSubmit:p,children:[t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&t.jsxs("div",{className:"alert alert-danger mb-3",children:[t.jsx("strong",{children:"Please fix the following errors:"}),t.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([v,N])=>t.jsx("li",{children:N},v))})]}),t.jsxs(oe,{children:[t.jsx(F,{md:8,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),t.jsx(E.Control,{type:"text",value:l.name,onChange:v=>x("name",v.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:c.name})]})}),t.jsx(F,{md:4,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),t.jsx(E.Control,{type:"text",value:l.code,onChange:v=>x("code",v.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),t.jsx(E.Control.Feedback,{type:"invalid",children:c.code})]})})]}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),t.jsxs(E.Select,{value:l.departmentHeadId,onChange:v=>x("departmentHeadId",v.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[t.jsx("option",{value:"",children:"Select department head"}),i.map(v=>t.jsxs("option",{value:v.id,children:[v.firstName," ",v.lastName," (",v.eid,")"]},v.id))]}),t.jsx(E.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),t.jsx(E.Control,{as:"textarea",rows:4,value:l.description,onChange:v=>x("description",v.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s==="view"&&r&&t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),t.jsx(E.Control,{type:"text",value:r.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),t.jsx(E.Control,{type:"text",value:r.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),t.jsx(E.Control,{type:"text",value:r.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),t.jsx(E.Control,{type:"text",value:new Date(r.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:m,children:[t.jsx(Ge,{className:"me-2",size:16}),s==="view"?"Close":"Cancel"]}),s!=="view"&&t.jsx(se,{variant:"primary-custom",type:"submit",disabled:m,children:m?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),s==="add"?"Add Department":"Save Changes"]})})]})]})]})},T3=({department:e,index:r,onView:s,onToggleStatus:a})=>{const n=l=>l==="ACTIVE"?"success":"secondary",i=l=>l==="ACTIVE"?"":"";return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("div",{className:"fw-medium text-dark",children:e.name})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:e.coursesCount})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:e.traineesCount})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:e.trainersCount})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsxs(Te,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.DEPARTMENTS.VIEW_DETAIL,be.DEPARTMENTS.UPDATE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(e),permission:be.DEPARTMENTS.VIEW_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:t.jsx(Xa,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>a(e),permission:be.DEPARTMENTS.UPDATE}]})})})]})},E3=({departments:e,loading:r,onView:s,onToggleStatus:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=Ot(e);if(r)return t.jsx(It,{rows:5,columns:6});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No departments found"}),t.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const o=({columnKey:c,children:d,className:m=""})=>{const u=i.key===c,h=u?i.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${m} ${u?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>l(c),onMouseEnter:p=>{p.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="transparent",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:u?"600":"500"},children:d}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:h,size:14})})]}),u&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"scrollable-table-container",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(o,{columnKey:"name",className:"show-mobile",children:"Department Name"}),t.jsx(o,{columnKey:"code",className:"show-mobile",children:"Code"}),t.jsx(o,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),t.jsx(o,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),t.jsx(o,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),t.jsx(o,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),t.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:n.map((c,d)=>t.jsx(T3,{department:c,index:d,onView:s,onToggleStatus:a},c.id))})]})})},C3=({show:e,department:r,onConfirm:s,onCancel:a,isProcessing:n})=>{const[i,l]=b.useState({courseCount:0,traineeCount:0,trainerCount:0}),[o,c]=b.useState(!1);b.useEffect(()=>{e&&r?.id&&d()},[e,r?.id]);const d=async()=>{if(r?.id){c(!0);try{const x=await Nt.getDepartmentById(r.id);console.log(" DisableDepartmentModal - Statistics API response:",x),l({courseCount:x.courseCount||x.coursesCount||0,traineeCount:x.traineeCount||x.traineesCount||0,trainerCount:x.trainerCount||x.trainersCount||0})}catch(x){console.error("Error fetching department statistics:",x),l({courseCount:r.courseCount||r.coursesCount||0,traineeCount:r.traineeCount||r.traineesCount||0,trainerCount:r.trainerCount||r.trainersCount||0})}finally{c(!1)}}};if(!r)return null;const m=r.status==="ACTIVE",u=m?"deactivate":"activate",h=m?"Deactivate":"Activate",p=!m||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return t.jsxs(le,{show:e,onHide:a,centered:!0,children:[t.jsx(le.Header,{className:"border-0 pb-0",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2 text-warning",size:20}),h," Department"]})}),t.jsxs(le.Body,{className:"pt-0",children:[t.jsx(Ae,{variant:m?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:t.jsx("div",{className:"d-flex align-items-start",children:t.jsxs("div",{children:[t.jsxs("strong",{children:["Are you sure you want to ",u," this department?"]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("strong",{children:"Department:"})," ",r.name," (",r.code,")"]}),m&&t.jsx("div",{className:"mt-2",children:p?t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Warning:"})," Deactivating this department will:",t.jsxs("ul",{className:"mb-0 mt-1",children:[t.jsx("li",{children:"Make it unavailable for new course assignments"}),t.jsx("li",{children:"Hide it from department selection dropdowns"}),t.jsx("li",{children:"Not affect existing courses and users"})]})]}):t.jsxs("div",{className:"text-danger",children:[t.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!m&&t.jsxs("div",{className:"mt-2",children:[t.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",t.jsxs("ul",{className:"mb-0 mt-1",children:[t.jsx("li",{children:"New course assignments"}),t.jsx("li",{children:"Department selection in forms"}),t.jsx("li",{children:"User management operations"})]})]})]})})}),t.jsxs("div",{className:"bg-light p-4 rounded",children:[t.jsxs("div",{className:"row g-3",children:[t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"d-flex flex-column",children:[t.jsx("strong",{className:"mb-1",children:"Department Head:"}),t.jsx("span",{className:"text-muted text-break",children:r.departmentHead?.name||r.departmentHead?.email||"N/A"})]})}),t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"d-flex flex-column",children:[t.jsx("strong",{className:"mb-1",children:"Current Status:"}),t.jsx("span",{className:`badge ${r.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:r.status==="ACTIVE"?"#28a745":"#1b3c53"},children:r.status})]})})]}),t.jsx("hr",{className:"my-3"}),t.jsxs("div",{className:"row g-3",children:[t.jsx("div",{className:"col-4",children:t.jsxs("div",{className:"text-center",children:[o?t.jsx(St,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):t.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),t.jsx("small",{className:"text-muted",children:"Courses"})]})}),t.jsx("div",{className:"col-4",children:t.jsxs("div",{className:"text-center",children:[o?t.jsx(St,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):t.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),t.jsx("small",{className:"text-muted",children:"Trainees"})]})}),t.jsx("div",{className:"col-4",children:t.jsxs("div",{className:"text-center",children:[o?t.jsx(St,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):t.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),t.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),t.jsxs(le.Footer,{className:"border-0",children:[t.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:m?"warning":"success",onClick:s,disabled:n||m&&!p,style:{backgroundColor:m?"#ffc107":"#28a745",borderColor:m?"#ffc107":"#28a745",opacity:m&&!p?.5:1},children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.8rem",height:"0.8rem"}}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{className:"me-2",size:16}),m&&!p?"Cannot Deactivate":`${h} Department`]})})]})]})},_3=()=>{const e=qe(),{departments:r,loading:s,searchTerm:a,setSearchTerm:n,createDepartment:i,updateDepartment:l,disableDepartment:o,enableDepartment:c,getAvailableUsers:d}=Cc(),[m,u]=b.useState(!1),[h,p]=b.useState(!1),[x,f]=b.useState(!1),[g,v]=b.useState(!1),[N,j]=b.useState("add"),[S,C]=b.useState(null),[w,y]=b.useState(!1),[T,k]=b.useState([]),[P,A]=b.useState([]),[_,U]=b.useState([]);b.useEffect(()=>{(async()=>{try{const M=await d();U(M)}catch(M){console.error("Error loading available users:",M),U([])}})()},[]);const D=()=>{C(null),j("add"),u(!0)},W=re=>{e(`/admin/departments/${re.id}`)},q=re=>{C(re),p(!0)},Y=()=>{u(!1),C(null),j("add")},K=()=>{p(!1),C(null)},H=()=>{f(!1),C(null)},je=()=>{v(!1),C(null)},ie=re=>{console.log("Assign instructors:",re,"to department:",S.name),H()},B=async re=>{try{N==="add"?(await i(re),de.success("Department created successfully")):N==="edit"&&(await l(S.id,re),de.success("Department updated successfully")),Y()}catch(M){console.error("Error saving department:",M),de.error("Failed to save department")}},V=async()=>{try{S&&(S.status==="ACTIVE"?(await o(S.id),de.success("Department disabled successfully")):(await c(S.id),de.success("Department enabled successfully")),K())}catch(re){console.error("Error toggling department status:",re),de.error("Failed to toggle department status")}},z=re=>{n(re)},L=re=>{k(re==="clear"?[]:M=>M.includes(re)?M.filter(_e=>_e!==re):[...M,re])},te=re=>{A(re==="clear"?[]:M=>M.includes(re)?M.filter(_e=>_e!==re):[...M,re])},ne=()=>{k([]),A([])},ue=[...new Set(r.map(re=>re.type).filter(Boolean))],Ne=["ACTIVE","INACTIVE"],ae=r.filter(re=>{const M=T.length===0||T.includes(re.type),_e=P.length===0||P.includes(re.status);return M&&_e});return t.jsxs(Ee,{fluid:!0,className:"py-4 department-management-page",children:[t.jsxs(R,{className:"shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-0 pb-0",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsx("div",{className:"d-flex justify-content-end",children:t.jsx(Ht,{permission:be.DEPARTMENTS.CREATE,fallback:null,children:t.jsxs(se,{variant:"primary-custom",size:"sm",onClick:D,className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-1",size:16}),"Add Department"]})})})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-4 form-mobile-stack",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search departments by name, code, or description...",value:a,onChange:z,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(w3,{uniqueTypes:ue,uniqueStatuses:Ne,selectedTypes:T,selectedStatuses:P,onTypeToggle:L,onStatusToggle:te,onClearFilters:ne,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[ae.length," department",ae.length!==1?"s":""]})})})]}),t.jsx("div",{className:"position-relative mt-3",children:t.jsx(E3,{departments:ae,loading:s,onView:W,onToggleStatus:q})})]})]}),m&&t.jsx(S3,{show:m,department:S,mode:N,onSave:B,onClose:Y,availableUsers:_}),h&&S&&t.jsx(C3,{show:h,department:S,onConfirm:V,onCancel:K,isProcessing:s}),x&&S&&t.jsx(y3,{show:x,department:S,onClose:H,onAssign:ie,availableInstructors:_.filter(re=>re.role==="TRAINER"),assignedInstructors:[]}),g&&S&&t.jsx(N3,{show:g,department:S,onClose:je})]})},k3=({department:e,onBack:r})=>t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-start mb-3",children:[t.jsx(se,{variant:"outline-secondary",onClick:r,className:"me-3 mt-1",size:"sm",children:t.jsx(bt,{})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:e.name}),t.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),A3=({activeTab:e,onTabChange:r})=>{const s=[{id:"info",label:"Department Info",icon:j0,description:"View department overview"},{id:"trainers",label:"Manage Trainers",icon:fa,description:"Assign trainers to department"},{id:"edit",label:"Edit Details",icon:bs,description:"Modify department information"}];return t.jsxs("div",{className:"department-tabs",children:[t.jsx("div",{className:"tab-navigation",children:s.map(a=>{const n=a.icon,i=e===a.id;return t.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>r(a.id),children:[t.jsx("div",{className:"tab-icon",children:t.jsx(n,{size:20})}),t.jsxs("div",{className:"tab-content",children:[t.jsx("div",{className:"tab-label",children:a.label}),t.jsx("div",{className:"tab-description",children:a.description})]}),i&&t.jsx("div",{className:"tab-indicator"})]},a.id)})}),t.jsx("div",{className:"tab-separator"})]})},D3=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),I3=({department:e,onUpdate:r})=>{const[s,a]=b.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=b.useState(!1),[l,o]=b.useState([]);b.useEffect(()=>{(async()=>{try{const u=await Nt.getDepartmentHeads(),h=Array.isArray(u)?u:u.data||u.users||[];o(h)}catch(u){console.error("Error loading department heads:",u),de.error("Failed to load department heads"),o([])}})()},[]);const c=m=>{const{name:u,value:h}=m.target;a(p=>({...p,[u]:h}))},d=async m=>{m.preventDefault(),i(!0);try{const u=await Nt.updateDepartment(e.id,s),h=D3(u);r(h),de.success("Department updated successfully!")}catch(u){console.error("Error updating department:",u),de.error("Failed to update department")}finally{i(!1)}};return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),t.jsxs("form",{onSubmit:d,children:[t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),t.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:s.name,onChange:c,required:!0})]})})}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),t.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:s.headUserId,onChange:c,children:[t.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(l)&&l.map(m=>t.jsxs("option",{value:m.id,children:["[",m.eid,"] - ",m.firstName," ",m.lastName]},m.id))]}),s.headUserId&&(()=>{const m=Array.isArray(l)?l.find(u=>u.id===s.headUserId):null;return m?t.jsxs("div",{className:"form-text",children:["Current selection: [",m.eid,"] - ",m.firstName," ",m.lastName]}):null})()]})})}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),t.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:s.description,onChange:c})]}),t.jsx("div",{className:"d-flex gap-2",children:t.jsx(se,{type:"submit",variant:"primary",disabled:n,children:n?"Updating...":"Update Department"})})]})]})},P3=({trainers:e=[],loading:r=!1,showAddButton:s=!1,onAddClick:a,departmentId:n,onTrainerRemoved:i})=>{const[l,o]=b.useState(!1),[c,d]=b.useState(null),[m,u]=b.useState(!1);if(r)return t.jsxs("div",{className:"text-center py-4",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading trainers..."})]});if(!e||e.length===0)return t.jsxs("div",{className:"text-center py-5",children:[t.jsx(Ls,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No trainers assigned"}),t.jsx("p",{className:"text-muted",children:"This department doesn't have any trainers assigned yet."})]});const h=g=>{const{firstName:v,middleName:N,lastName:j}=g;return[v,N,j].filter(Boolean).join(" ")},p=g=>{d(g),o(!0)},x=async()=>{if(!(!c||!n)){u(!0);try{await Nt.removeTrainersFromDepartment(n,[c.eid]),de.success(`Successfully removed ${h(c)} from department`),i&&i(),o(!1),d(null)}catch(g){console.error("Error removing trainer:",g),de.error("Failed to remove trainer from department")}finally{u(!1)}}},f=()=>{o(!1),d(null)};return t.jsxs("div",{className:"assigned-trainers-table",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[t.jsxs("h5",{className:"mb-0",children:[t.jsx(Ls,{className:"me-2"}),"Assigned Trainers (",e.length,")"]}),s&&t.jsxs(se,{variant:"primary",onClick:a,className:"d-flex align-items-center",children:[t.jsx(fa,{className:"me-2",size:16}),"Add Trainers to Department"]})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"EID"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Full Name"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Email"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Phone"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Address"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",width:"80",children:"Actions"})]})}),t.jsx("tbody",{children:e.map((g,v)=>t.jsxs("tr",{className:`${v%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:N=>{N.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:N=>{N.currentTarget.style.backgroundColor=v%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("span",{className:"fw-semibold text-primary-custom",children:g.eid})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("div",{className:"fw-medium text-dark",children:h(g)})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("span",{className:"text-dark",children:g.email})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:g.phoneNumber?t.jsx("span",{className:"text-dark",children:g.phoneNumber}):t.jsx("span",{className:"text-muted",children:"-"})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:g.address?t.jsx("span",{className:"text-truncate text-dark",style:{maxWidth:"200px"},title:g.address,children:g.address}):t.jsx("span",{className:"text-muted",children:"-"})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsx(Ht,{permission:be.DEPARTMENTS.REMOVE_TRAINERS,fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"Remove from Department",icon:t.jsx(Ci,{}),className:"text-danger",onClick:()=>p(g)}]})})})]},g.id))})]})}),t.jsxs(le,{show:l,onHide:f,centered:!0,children:[t.jsx(le.Header,{closeButton:!0,children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Ci,{className:"me-2 text-danger",size:20}),"Remove Trainer"]})}),t.jsxs(le.Body,{children:[t.jsxs("p",{children:["Are you sure you want to remove ",t.jsx("strong",{children:c?h(c):""})," from this department?"]}),t.jsx("p",{className:"text-muted small mb-0",children:"This action cannot be undone. The trainer will no longer be associated with this department."})]}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"secondary",onClick:f,disabled:m,children:"Cancel"}),t.jsx(se,{variant:"danger",onClick:x,disabled:m,children:m?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):"Remove Trainer"})]})]})]})},R3=({show:e,onHide:r,departmentId:s,assignedTrainers:a=[],onTrainersAdded:n})=>{const[i,l]=b.useState([]),[o,c]=b.useState([]),[d,m]=b.useState(""),[u,h]=b.useState(!1),[p,x]=b.useState(!1);b.useEffect(()=>{e&&s&&f()},[e,s,a]);const f=async()=>{h(!0);try{const A=((await Is.getUsers()).data||[]).filter(D=>D.role&&D.role.name==="TRAINER").map(D=>({id:D.id,eid:D.eid,firstName:D.firstName,middleName:D.middleName,lastName:D.lastName,email:D.email,status:D.status,address:D.address,gender:D.gender,phoneNumber:D.phoneNumber})),_=a.map(D=>D.id),U=A.filter(D=>!_.includes(D.id));l(U)}catch(T){console.error("Error loading available trainers:",T),de.error("Failed to load available trainers")}finally{h(!1)}},g=(T,k)=>{c(k?P=>[...P,T]:P=>P.filter(A=>A!==T))},v=T=>{if(T){const k=N();c(k.map(P=>P.id))}else c([])},N=()=>{if(!d)return i;const T=d.toLowerCase();return i.filter(k=>k.eid?.toLowerCase().includes(T)||k.firstName?.toLowerCase().includes(T)||k.lastName?.toLowerCase().includes(T)||k.email?.toLowerCase().includes(T))},j=T=>{const{firstName:k,middleName:P,lastName:A}=T;return[k,P,A].filter(Boolean).join(" ")},S=async()=>{if(o.length===0){de.warning("Please select at least one trainer");return}x(!0);try{const T=o.map(k=>{const P=i.find(A=>A.id===k);return P?P.eid:null}).filter(k=>k!==null);await Nt.assignTrainersToDepartment(s,T),de.success(`Successfully assigned ${T.length} trainer(s) to department`),n(),C()}catch(T){console.error("Error assigning trainers:",T),de.error("Failed to assign trainers")}finally{x(!1)}},C=()=>{c([]),m(""),r()},w=N(),y=w.length>0&&w.every(T=>o.includes(T.id));return t.jsxs(le,{show:e,onHide:C,size:"xl",centered:!0,children:[t.jsxs(le.Header,{className:"border-0 pb-0 d-flex align-items-center justify-content-between",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[t.jsx("div",{}),t.jsxs(le.Title,{className:"d-flex align-items-center text-white",children:[t.jsx(fa,{className:"me-2",size:20}),"Add Trainers to Department"]}),t.jsx(se,{variant:"link",onClick:C,className:"p-0",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:t.jsx(Ge,{})})]}),t.jsxs(le.Body,{className:"pt-0",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-muted mb-3",style:{padding:"20px 24px"},children:"Select trainers to assign to this department."}),t.jsxs(oe,{className:"align-items-center",children:[t.jsx(F,{md:8,children:t.jsx(E.Control,{type:"text",placeholder:"Search by EID, name, or email...",value:d,onChange:T=>m(T.target.value)})}),t.jsx(F,{md:4,className:"text-end",children:t.jsxs("span",{className:"text-muted",children:[w.length," trainer",w.length!==1?"s":""," found"]})})]})]}),u?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading available trainers..."})]}):t.jsx("div",{className:"table-responsive",style:{maxHeight:"400px"},children:t.jsxs(gt,{hover:!0,className:"mb-0",children:[t.jsx("thead",{className:"table-light sticky-top",children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"50px",padding:"16px 12px"},children:t.jsx(E.Check,{type:"checkbox",checked:y,onChange:T=>v(T.target.checked)})}),t.jsx("th",{style:{padding:"16px 12px"},children:"EID"}),t.jsx("th",{style:{padding:"16px 12px"},children:"Full Name"}),t.jsx("th",{style:{padding:"16px 12px"},children:"Email"})]})}),t.jsx("tbody",{children:w.map(T=>t.jsxs("tr",{children:[t.jsx("td",{style:{padding:"16px 12px"},children:t.jsx(E.Check,{type:"checkbox",checked:o.includes(T.id),onChange:k=>g(T.id,k.target.checked)})}),t.jsx("td",{style:{padding:"16px 12px"},children:t.jsx("code",{className:"text-primary",children:T.eid})}),t.jsx("td",{style:{padding:"16px 12px"},children:t.jsx("span",{children:j(T)})}),t.jsx("td",{style:{padding:"16px 12px"},children:T.email})]},T.id))})]})}),w.length===0&&!u&&t.jsxs("div",{className:"text-center py-4",children:[t.jsx(fa,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No trainers available"}),t.jsx("p",{className:"text-muted",children:d?"No trainers match your search criteria.":"All trainers are already assigned to departments."})]})]}),t.jsxs(le.Footer,{className:"border-0",children:[t.jsx(se,{variant:"outline-secondary",onClick:C,disabled:p,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:S,disabled:o.length===0||p,children:p?t.jsxs(t.Fragment,{children:[t.jsx(St,{size:"sm",className:"me-2"}),"Assigning..."]}):`Assign ${o.length} Trainer${o.length!==1?"s":""}`})]})]})},F3=({department:e,onDepartmentUpdate:r})=>{const[s,a]=b.useState(!1),n=e?.trainers||[],i=()=>{r&&r()};return t.jsxs("div",{children:[t.jsx(P3,{trainers:n,loading:!1,showAddButton:!0,onAddClick:()=>a(!0),departmentId:e?.id,onTrainerRemoved:i}),t.jsx(R3,{show:s,onHide:()=>a(!1),departmentId:e?.id,assignedTrainers:n,onTrainersAdded:i})]})},e0=({department:e})=>{const r=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return t.jsxs("div",{className:"department-info",children:[t.jsx("h4",{className:"mb-4",children:"Department Overview"}),t.jsxs(oe,{className:"g-4",children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"info-card",children:[t.jsxs("div",{className:"info-header",children:[t.jsx(it,{className:"info-icon"}),t.jsx("h6",{children:"Basic Information"})]}),t.jsxs("div",{className:"info-content",children:[t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Name:"}),t.jsx("span",{className:"info-value",children:e.name})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Code:"}),t.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Description:"}),t.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"info-card",children:[t.jsxs("div",{className:"info-header",children:[t.jsx(rs,{className:"info-icon"}),t.jsx("h6",{children:"Department Statistics"})]}),t.jsxs("div",{className:"info-content",children:[t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Total Courses:"}),t.jsx("span",{className:"info-value",children:e.courseCount||0})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Total Trainees:"}),t.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Total Trainers:"}),t.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Head of Department:"}),t.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"info-card",children:[t.jsxs("div",{className:"info-header",children:[t.jsx(Lt,{className:"info-icon"}),t.jsx("h6",{children:"Timeline"})]}),t.jsxs("div",{className:"info-content",children:[t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Created:"}),t.jsx("span",{className:"info-value",children:r(e.createdAt)})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Last Updated:"}),t.jsx("span",{className:"info-value",children:r(e.updatedAt)})]}),e.deletedAt&&t.jsxs("div",{className:"info-item",children:[t.jsx("span",{className:"info-label",children:"Deleted:"}),t.jsx("span",{className:"info-value",children:r(e.deletedAt)})]})]})]})})]})]})},O3=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),L3=()=>{const{id:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState("info"),m=b.useCallback(async()=>{if(!e){de.error("Department ID is required"),i(!1);return}i(!0),o(null);try{const x=await Nt.getDepartmentById(e),f=O3(x);a(f)}catch(x){console.error("Error loading department:",x),de.error("Failed to load department details"),o("Failed to load department details")}finally{i(!1)}},[e]);b.useEffect(()=>{m()},[m]);const u=()=>{r("/admin/departments")},h=x=>{d(x)};if(n)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:t.jsx(St,{animation:"border",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(l)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsxs("div",{className:"text-danger mb-3",children:[t.jsx("h5",{children:"Unable to load department"}),t.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),t.jsxs(se,{variant:"outline-primary",onClick:u,children:[t.jsx(bt,{className:"me-2"}),"Back to Departments"]})]})});if(!s)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsxs("div",{className:"text-warning mb-3",children:[t.jsx("h5",{children:"Department not found"}),t.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),t.jsxs(se,{variant:"outline-primary",onClick:u,children:[t.jsx(bt,{className:"me-2"}),"Back to Departments"]})]})});const p=()=>{switch(c){case"info":return t.jsx(e0,{department:s});case"trainers":return t.jsx(F3,{department:s,onDepartmentUpdate:m});case"edit":return t.jsx(I3,{department:s,onUpdate:a});default:return t.jsx(e0,{department:s})}};return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(k3,{department:s,onBack:u}),t.jsx(A3,{activeTab:c,onTabChange:h}),t.jsx(oe,{children:t.jsx(F,{children:t.jsx(R,{className:"shadow-sm",children:t.jsx(R.Body,{className:"p-4",children:p()})})})})]})},M3=({show:e,onClose:r,onSave:s,loading:a=!1})=>{const[n,i]=b.useState({newPassword:"",confirmPassword:""}),[l,o]=b.useState(!1),[c,d]=b.useState(!1),[m,u]=b.useState({show:!1,message:"",variant:"success"}),h=f=>{const{name:g,value:v}=f.target;i(N=>({...N,[g]:v})),m.show&&u({show:!1,message:"",variant:"success"})},p=async f=>{if(f.preventDefault(),n.newPassword!==n.confirmPassword){u({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(n.newPassword.length<6){u({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await s(n),u({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{r(),u({show:!1,message:"",variant:"success"})},1500)}catch{u({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},x=()=>{i({newPassword:"",confirmPassword:""}),u({show:!1,message:"",variant:"success"}),r()};return t.jsxs(le,{show:e,onHide:x,size:"md",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary text-white",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Tn,{className:"me-2",size:20}),"Reset Password"]}),t.jsx(se,{variant:"link",className:"text-white p-0",onClick:x,style:{textDecoration:"none"},children:t.jsx(Ge,{size:20})})]}),t.jsxs(le.Body,{className:"p-4",children:[m.show&&t.jsx(Ae,{variant:m?.variant,className:"mb-3",children:m?.message}),t.jsxs(E,{onSubmit:p,children:[t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{className:"fw-semibold",children:"New Password"}),t.jsxs("div",{className:"position-relative",children:[t.jsx(E.Control,{type:l?"text":"password",name:"newPassword",value:n.newPassword,onChange:h,required:!0,minLength:6,placeholder:"Enter new password"}),t.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>o(!l),type:"button",children:l?t.jsx(Sn,{size:16}):t.jsx(xt,{size:16})})]})]}),t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{className:"fw-semibold",children:"Confirm New Password"}),t.jsxs("div",{className:"position-relative",children:[t.jsx(E.Control,{type:c?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:h,required:!0,minLength:6,placeholder:"Confirm new password"}),t.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>d(!c),type:"button",children:c?t.jsx(Sn,{size:16}):t.jsx(xt,{size:16})})]})]}),t.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[t.jsx(se,{variant:"outline-secondary",onClick:x,disabled:a,children:"Cancel"}),t.jsx(se,{type:"submit",variant:"secondary",disabled:a,children:a?"Updating...":t.jsxs(t.Fragment,{children:[t.jsx(Tn,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},B3=({profileData:e,user:r,onResetPassword:s,onAvatarUpdated:a,onConfigureSignature:n})=>{const i=b.useRef(null),[l,o]=b.useState(!1),[c,d]=b.useState(null),m=N=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",SQA_AUDITOR:"secondary"})[N]||"secondary",u=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",h=()=>e?.email||r?.email||"user@example.com",p=()=>e?.role?.name||r?.role||"USER",x=c||e?.avatarUrl||"",f=()=>{i.current&&i.current.click()},g=(N,j=200,S=200,C=.8)=>new Promise(w=>{const y=document.createElement("canvas"),T=y.getContext("2d"),k=new window.Image;k.onload=()=>{let{width:P,height:A}=k;P>A?P>j&&(A=A*j/P,P=j):A>S&&(P=P*S/A,A=S),y.width=P,y.height=A,T.drawImage(k,0,0,P,A);const _=y.toDataURL("image/jpeg",C);w(_)},k.src=URL.createObjectURL(N)}),v=async N=>{const j=N.target.files&&N.target.files[0];if(j){if(j.size>5*1024*1024){de.error("File size too large. Please choose an image smaller than 5MB.");return}try{o(!0);const S=await g(j,200,200,.7);d(S);const C=await Vr.updateAvatar(S,e);de.success("Avatar updated successfully"),a&&a(C)}catch(S){console.error("Update avatar failed:",S),S.response?.status===422?de.error("Invalid avatar format. Please try a different image."):S.response?.status===413?de.error("Image too large. Please choose a smaller image."):de.error("Failed to update avatar. Please try again."),d(null)}finally{o(!1),i.current&&(i.current.value="")}}};return t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[x?t.jsx(Mf,{roundedCircle:!0,src:x,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):t.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:t.jsx(Dt,{size:48,className:"text-white"})}),t.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:f,disabled:l,children:l?t.jsx(St,{animation:"border",size:"sm"}):""}),t.jsx("input",{ref:i,type:"file",accept:"image/*",className:"d-none",onChange:v})]}),t.jsx("h4",{className:"mb-1",children:u()}),t.jsx("p",{className:"text-muted mb-2",children:h()}),t.jsx(Te,{bg:m(p()),className:"mb-3",children:p()}),t.jsxs("div",{className:"text-start",children:[e?.address&&t.jsxs("div",{className:"mb-3",children:[t.jsx("strong",{children:"Address:"}),t.jsx("br",{}),t.jsx("span",{className:"text-muted",children:e.address})]}),t.jsxs("div",{className:"d-flex flex-column gap-2",children:[t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:s,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[t.jsx(Tn,{size:14,className:"me-2"}),"Reset Password"]}),t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[t.jsx(Fr,{size:14,className:"me-2"}),"Configure Signature"]})]})]})]})})},z3=({profileData:e,user:r,onUpdate:s})=>{const[a,n]=b.useState(!1),[i,l]=b.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[o,c]=b.useState(!1);b.useEffect(()=>{if(e&&e.firstName){const u={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};l(u),c(!0)}},[e,o]);const d=u=>{const{name:h,value:p}=u.target;l(x=>({...x,[h]:p}))},m=async u=>{u.preventDefault(),n(!0);try{s?await s(i):(await Vr.updateProfile(i),de.success("Personal information updated successfully!"))}catch(h){console.error("Error updating personal info:",h),s||de.error("Failed to update personal information. Please try again.")}finally{n(!1)}};return t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:20,className:"me-2 text-primary"}),t.jsx("h5",{className:"mb-0",children:"Personal Information"})]})}),t.jsx(R.Body,{children:t.jsxs(E,{onSubmit:m,children:[t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-4 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"First Name"}),t.jsx(E.Control,{type:"text",name:"firstName",value:i.firstName,onChange:d,required:!0})]})}),t.jsx("div",{className:"col-md-4 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Middle Name"}),t.jsx(E.Control,{type:"text",name:"middleName",value:i.middleName,onChange:d})]})}),t.jsx("div",{className:"col-md-4 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Last Name"}),t.jsx(E.Control,{type:"text",name:"lastName",value:i.lastName,onChange:d,required:!0})]})})]}),t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-6 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Email"}),t.jsx(E.Control,{type:"email",name:"email",value:i.email,onChange:d,required:!0})]})}),t.jsx("div",{className:"col-md-6 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Phone Number"}),t.jsx(E.Control,{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:d})]})})]}),t.jsx("div",{className:"row",children:t.jsx("div",{className:"col-md-6 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Gender"}),t.jsxs(E.Select,{name:"gender",value:i.gender,onChange:d,children:[t.jsx("option",{value:"",children:"Select Gender"}),t.jsx("option",{value:"MALE",children:"Male"}),t.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),t.jsx("div",{className:"row",children:t.jsx("div",{className:"col-md-12 mb-3",children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Address"}),t.jsx(E.Control,{as:"textarea",rows:3,name:"address",value:i.address,onChange:d,placeholder:"Enter your address"})]})})}),t.jsx("div",{className:"d-flex justify-content-end",children:t.jsx(se,{type:"submit",variant:"primary",disabled:a,children:a?"Saving...":t.jsxs(t.Fragment,{children:[t.jsx(cr,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},$3=()=>{const{user:e}=Us(),r=qe(),[s,a]=b.useState(!1),[n,i]=b.useState(!1),[l,o]=b.useState(null),[c,d]=b.useState(!0),m=async()=>{try{d(!0);const x=await Vr.getProfile();o(x)}catch(x){console.error("Failed to refresh profile:",x)}finally{d(!1)}};b.useEffect(()=>{m()},[]);const u=async x=>{a(!0);try{const f=await Vr.updateProfile(x);o(f),de.success("Personal information updated successfully!")}catch(f){throw console.error("Error updating profile:",f),de.error("Failed to update personal information. Please try again."),f}finally{a(!1)}},h=async x=>{a(!0);try{const f=await Vr.resetPassword(x);de.success(f.message||"Password updated successfully!")}catch(f){throw de.error(f.message||"Failed to update password. Please check your current password."),f}finally{a(!1)}},p=()=>{e?.role,r("/trainer/configure-signature")};return c?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsxs(oe,{children:[t.jsx(F,{lg:4,className:"mb-4",children:t.jsx(B3,{profileData:l,user:e,onResetPassword:()=>i(!0),onAvatarUpdated:m,onConfigureSignature:p})}),t.jsx(F,{lg:8,className:"mb-4",children:t.jsx(z3,{profileData:l,user:e,onUpdate:u})})]}),t.jsx(M3,{show:n,onClose:()=>i(!1),onSave:h,loading:s})]})},U3=()=>{const{user:e}=Us(),r=qe(),{departments:s,loading:a,error:n}=Cc(),i=s.filter(o=>o.status==="ACTIVE"),l=o=>{r(`/academic/course/${o}`)};return t.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:t.jsxs(Ee,{className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"text-center",children:[t.jsx(Tr,{size:48,className:"text-primary mb-3"}),t.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),t.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),t.jsxs("p",{className:"text-muted small",children:["Total Departments: ",t.jsx("strong",{children:i.length})]})]})})}),t.jsx(oe,{className:"mb-5",children:a?t.jsxs(F,{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):n?t.jsx(F,{className:"text-center py-5",children:t.jsxs("p",{className:"text-danger",children:["Error loading departments: ",n.message]})}):i.map(o=>t.jsx(F,{md:6,lg:4,className:"mb-4",children:t.jsx(R,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:t.jsxs(R.Body,{className:"p-4 d-flex flex-column h-100",children:[t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("div",{className:"course-icon me-3",children:t.jsx(it,{size:24,className:"text-primary"})}),t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("h5",{className:"mb-1",children:o.name}),t.jsx(Te,{bg:"secondary",className:"text-white",children:o.code})]})]}),t.jsx("div",{className:"text-muted description-container",children:o.description||t.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),t.jsxs(se,{variant:"outline-primary",className:"w-100",onClick:()=>l(o.id),children:["View Details",t.jsx(Gr,{size:16,className:"ms-2"})]})]})})},o.id))})]})})},W3=()=>{const e=qe(),r=[{id:1,type:"course_completed",title:"Safety Procedures Course",trainee:"John Smith",time:"2 hours ago",icon:Wn},{id:2,type:"new_enrollment",title:"Emergency Response Training",trainee:"Sarah Johnson",time:"4 hours ago",icon:Ls},{id:3,type:"course_scheduled",title:"First Aid Training",trainee:"Mike Wilson",time:"6 hours ago",icon:Lt}],s=[{title:"View All Departments",description:"Browse and manage academic departments",icon:Tr,action:()=>e("/academic/departments"),color:"primary"},{title:"Course Management",description:"Create and manage training courses",icon:it,action:()=>e("/academic/departments"),color:"success"},{title:"Trainee Reports",description:"View trainee progress and reports",icon:$s,action:()=>e("/academic/departments"),color:"info"}];return t.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:t.jsx(Ee,{className:"py-4",children:t.jsxs(oe,{children:[t.jsx(F,{lg:8,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:t.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),t.jsx(R.Body,{children:t.jsx(oe,{children:s.map((a,n)=>t.jsx(F,{md:4,className:"mb-3",children:t.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:a.action,children:[t.jsxs("div",{className:"d-flex align-items-center mb-2",children:[t.jsx(a.icon,{size:24,className:`text-${a.color} me-2`}),t.jsx("h6",{className:"mb-0",children:a.title})]}),t.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:a.description}),t.jsx(Gr,{size:16,className:`text-${a.color} ms-auto`})]})},n))})})]})}),t.jsx(F,{lg:4,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:t.jsx("h5",{className:"mb-0 text-white",children:"Recent Activities"})}),t.jsxs(R.Body,{children:[r.map(a=>t.jsxs("div",{className:"d-flex align-items-start mb-3",children:[t.jsx("div",{className:"me-3",children:t.jsx(a.icon,{size:20,className:"text-primary"})}),t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("h6",{className:"mb-1 small",children:a.title}),t.jsx("p",{className:"text-muted mb-1 small",children:a.trainee}),t.jsx("p",{className:"text-muted mb-0 small",children:a.time})]})]},a.id)),t.jsx(se,{variant:"outline-primary",size:"sm",className:"w-100",children:"View All Activities"})]})]})})]})})})},H3=({courses:e,loading:r,actionsComponent:s,onView:a,onDisable:n,onRestore:i})=>{const{sortedData:l,sortConfig:o,handleSort:c}=Ot(e);if(r)return t.jsx(It,{rows:4,columns:6});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No courses found"}),t.jsx("p",{children:"This department doesn't have any courses yet."})]})});const d=({columnKey:m,children:u,className:h=""})=>{const p=o.key===m,x=p?o.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${h} ${p?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>c(m),onMouseEnter:f=>{f.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",f.target.style.transform="translateY(-1px)",f.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:f=>{f.target.style.backgroundColor="transparent",f.target.style.transform="translateY(0)",f.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:p?"700":"600"},children:u}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:x,size:14})})]}),p&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"department-table-container",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[t.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:t.jsxs("tr",{children:[t.jsx(d,{columnKey:"name",className:"show-mobile",children:"Course Name"}),t.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),t.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),t.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),t.jsx(d,{columnKey:"venue",className:"show-mobile",children:"Venue"}),t.jsx(d,{columnKey:"note",className:"show-mobile",children:"Note"}),t.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:l.map((m,u)=>t.jsxs("tr",{children:[t.jsx("td",{className:"show-mobile",children:t.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>a(m.id),style:{cursor:"pointer"},children:m.name})}),t.jsx("td",{className:"show-mobile",children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:m.code})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:14,className:"me-1 text-muted"}),t.jsx("span",{className:"text-dark",children:m.startDate||"N/A"})]})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:14,className:"me-1 text-muted"}),t.jsx("span",{className:"text-dark",children:m.endDate||"N/A"})]})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Vn,{size:14,className:"me-1 text-muted"}),t.jsx("span",{className:"text-dark",children:m.venue||"N/A"})]})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx($s,{size:14,className:"me-1 text-muted"}),t.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.note||"N/A"})]})}),t.jsx("td",{className:"show-mobile",children:t.jsx(Te,{bg:m.status==="ACTIVE"?"success":m.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:m.status||"N/A"})}),t.jsx("td",{className:"text-center show-mobile",children:t.jsx(s,{course:m,onView:a,onDisable:n,onRestore:i})})]},m.id))})]})})},V3=({course:e,onView:r,onDisable:s,onRestore:a})=>{const{hasPermission:n}=Xi(),i=n(be.COURSES.VIEW_DETAIL),l=n(be.COURSES.ARCHIVE),o=n(be.COURSES.UPDATE),c=n(be.COURSES.RESTORE),d=l||o,m=e?.status==="ARCHIVED",u=()=>{r&&i&&r(e.id)},h=()=>{s&&d&&!m&&s(e.id)},p=()=>{a&&c&&m&&a(e.id)},x=[];return x.push({label:"View Details",icon:t.jsx(xt,{}),onClick:u,disabled:!i}),x.push({type:"divider"}),m?x.push({label:"Restore Course",icon:t.jsx(u0,{}),className:"text-success",onClick:p,disabled:!c}):x.push({label:"Archive Course",icon:t.jsx(Ms,{}),className:"text-warning",onClick:h,disabled:!d}),t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:x})},G3=({show:e,onClose:r,onSave:s,loading:a=!1})=>{const[n,i]=b.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[l,o]=b.useState({});b.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}),r()},d=h=>{const{name:p,value:x}=h.target;if(i(f=>({...f,[p]:x})),l[p]&&o(f=>({...f,[p]:""})),p==="startDate"&&x){const f=new Date;f.setHours(0,0,0,0),new Date(x+"T00:00:00")<f&&o(v=>({...v,startDate:"Start date cannot be in the past"}))}if(p==="endDate"&&x){const f=new Date;f.setHours(0,0,0,0),new Date(x+"T00:00:00")<f&&o(v=>({...v,endDate:"End date cannot be in the past"}))}},m=()=>{const h={};if(n.name.trim()||(h.name="Course name is required"),n.code.trim()||(h.code="Course code is required"),n.description.trim()||(h.description="Description is required"),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(h.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(h.venue="Venue is required"),(!n.passScore||isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(h.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)h.startDate="Start date is required";else{const p=new Date;p.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<p&&(h.startDate="Start date cannot be in the past")}if(!n.endDate)h.endDate="End date is required";else{const p=new Date;p.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<p&&(h.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(h.endDate="End date must be after start date"),o(h),Object.keys(h).length===0},u=async h=>{if(h.preventDefault(),!!m())try{await s(n),c()}catch{}};return t.jsxs(le,{show:e,onHide:c,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-2",size:20}),"Add New Course"]}),t.jsx(se,{variant:"link",onClick:c,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(E,{onSubmit:u,children:[t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Course Name *"}),t.jsx(E.Control,{type:"text",name:"name",value:n.name,onChange:d,isInvalid:!!l.name,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.name})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Course Code *"}),t.jsx(E.Control,{type:"text",name:"code",value:n.code,onChange:d,isInvalid:!!l.code,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.code})]})})]}),t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Max Trainees *"}),t.jsx(E.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:d,isInvalid:!!l.maxNumTrainee,disabled:a,min:"1"}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.maxNumTrainee})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Pass Score *"}),t.jsx(E.Control,{type:"number",name:"passScore",value:n.passScore,onChange:d,isInvalid:!!l.passScore,disabled:a,min:"0",max:"100",step:"1"}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Level"}),t.jsxs(E.Select,{name:"level",value:n.level,onChange:d,disabled:a,children:[t.jsx("option",{value:"BEGINNER",children:"Beginner"}),t.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),t.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Venue *"}),t.jsx(E.Control,{type:"text",name:"venue",value:n.venue,onChange:d,isInvalid:!!l.venue,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.venue})]})})]}),t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Start Date *"}),t.jsx(E.Control,{type:"date",name:"startDate",value:n.startDate,onChange:d,isInvalid:!!l.startDate,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.startDate})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"End Date *"}),t.jsx(E.Control,{type:"date",name:"endDate",value:n.endDate,onChange:d,isInvalid:!!l.endDate,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Description *"}),t.jsx(E.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:d,isInvalid:!!l.description,disabled:a}),t.jsx(E.Control.Feedback,{type:"invalid",children:l.description})]})})}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Note"}),t.jsx(E.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:d,disabled:a})]})})})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:c,disabled:a,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary-custom",type:"submit",disabled:a,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},q3=({show:e,onClose:r,onArchive:s,course:a,loading:n=!1})=>{const[i,l]=b.useState(""),[o,c]=b.useState(""),m=i==="ARCHIVE",u=()=>{l(""),c(""),r()},h=async()=>{if(!m){c('Please type "ARCHIVE" to confirm');return}try{await s(a?.id),u()}catch(x){c(x.message||"Failed to archive course. Please try again.")}},p=x=>{l(x.target.value),c("")};return t.jsxs(le,{show:e,onHide:u,centered:!0,children:[t.jsx(le.Header,{className:"bg-warning text-dark border-0",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2",size:20}),"Archive Course"]})}),t.jsxs(le.Body,{className:"p-4",children:[o&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:o}),t.jsxs("div",{className:"mb-3",children:[t.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),t.jsxs("div",{className:"bg-light p-3 rounded",children:[t.jsx("strong",{children:"Course Code:"})," ",a?.code,t.jsx("br",{}),t.jsx("strong",{children:"Course Name:"})," ",a?.name,t.jsx("br",{}),a?.description&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Description:"})," ",a?.description,t.jsx("br",{})]}),a?.venue&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Venue:"})," ",a?.venue,t.jsx("br",{})]}),a?.startDate&&a?.endDate&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Duration:"})," ",a?.startDate," to ",a?.endDate]})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"text-danger mb-2",children:[t.jsx("strong",{children:"Warning:"})," This action will:"]}),t.jsxs("ul",{className:"text-danger mb-3",children:[t.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),t.jsx("li",{children:"Move the course to archived status"}),t.jsx("li",{children:"Preserve all course data and trainee progress"}),t.jsx("li",{children:"Allow course to be restored if needed"})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",t.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),t.jsx("input",{type:"text",className:`form-control ${i&&!m?"is-invalid":""}`,id:"confirmText",value:i,onChange:p,placeholder:"Type ARCHIVE here",disabled:n}),i&&!m&&t.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:u,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"warning",onClick:h,disabled:n||!m,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Archiving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{className:"me-2",size:16}),"Archive Course"]})})]})]})},Y3=({show:e,onClose:r,departmentHead:s,department:a})=>s?t.jsxs(le,{show:e,onHide:r,size:"lg",centered:!0,children:[t.jsx(le.Header,{closeButton:!0,children:t.jsxs(le.Title,{children:[t.jsx(Dt,{className:"me-2"}),"Department Head Details"]})}),t.jsx(le.Body,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:4,children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:t.jsx(Dt,{size:40,className:"text-white"})}),t.jsxs("h5",{className:"mb-1",children:[s.firstName," ",s.lastName]}),t.jsx(Te,{bg:"primary",className:"mb-2",children:"Department Head"}),t.jsx("p",{className:"text-muted small mb-0",children:a?.name})]})}),t.jsx(F,{md:8,children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(ha,{size:16,className:"me-2 text-primary"}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Email"}),t.jsx("div",{className:"fw-semibold",children:s.email})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(w0,{size:16,className:"me-2 text-primary"}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Phone"}),t.jsx("div",{className:"fw-semibold",children:s.phone||"N/A"})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Tr,{size:16,className:"me-2 text-primary"}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Department"}),t.jsxs("div",{className:"fw-semibold",children:[a?.name," (",a?.code,")"]})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-primary"}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Appointed Date"}),t.jsx("div",{className:"fw-semibold",children:s.appointedDate||"N/A"})]})]})}),t.jsx(F,{md:12,children:t.jsxs("div",{className:"d-flex align-items-start",children:[t.jsx(Wn,{size:16,className:"me-2 text-primary mt-1"}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Responsibilities"}),t.jsx("div",{className:"fw-semibold",children:s.responsibilities||"Oversee department operations, manage training programs, and ensure compliance with safety standards."})]})]})})]})})]})}),t.jsx(le.Footer,{children:t.jsx(se,{variant:"secondary",onClick:r,children:"Close"})})]}):null,K3=({courseId:e})=>{const r=qe(),[s,a]=b.useState(null),[n,i]=b.useState([]),[l,o]=b.useState(!0),[c,d]=b.useState(!1),[m,u]=b.useState("add"),[h,p]=b.useState(!1),[x,f]=b.useState(null),[g,v]=b.useState(null),[N,j]=b.useState(!1),[S,C]=b.useState(!1),w={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},y=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];b.useEffect(()=>{e&&(async()=>{o(!0);try{const q=await Ss.getDepartmentById(e);if(!q)throw new Error(`Department with ID ${e} not found in API response`);const Y={id:q.id,name:q.name,code:q.code,description:q.description,duration:"N/A",status:q.isActive,totalSubjects:q.courseCount||0,totalTrainers:q.trainerCount||0};a(Y);const K=q.courses?.map(H=>({id:H.id,name:H.name,code:H.code,startDate:H.startDate?new Date(H.startDate).toISOString().split("T")[0]:"N/A",endDate:H.endDate?new Date(H.endDate).toISOString().split("T")[0]:"N/A",venue:H.venue||"N/A",note:H.note||"N/A",status:H.status,description:H.description,maxNumTrainee:H.maxNumTrainee,passScore:H.passScore,level:H.level,subjectCount:H.subjectCount||0}))||[];i(K),q.headUser&&v(q.headUser),o(!1)}catch{o(!1);const W=w[e];W&&(a(W),i(y))}})()},[e]);const T=()=>{u("add"),d(!0)},k=D=>{const W=n.find(q=>q.id===D);f(W),p(!0)},P=async D=>{try{await Ss.archiveCourse(D),de.success("Course archived successfully"),i(W=>W.map(q=>q.id===D?{...q,status:"ARCHIVED"}:q)),p(!1),f(null)}catch(W){throw de.error("Failed to archive course. Please try again."),W}},A=async D=>{try{await Ss.restoreCourse(D),de.success("Course restored successfully"),i(W=>W.map(q=>q.id===D?{...q,status:"ACTIVE"}:q))}catch(W){de.error(W.response?.data?.message||"Failed to restore course. Please try again.")}},_=D=>{r(`/academic/course-detail/${D}`,{state:{departmentId:s.id,departmentName:s?.name||"Department"}})},U=async D=>{try{C(!0);const W={departmentId:s.id,name:D.name,description:D.description,code:D.code,maxNumTrainee:Number(D.maxNumTrainee),venue:D.venue,note:D.note,passScore:Number(D.passScore),startDate:D.startDate?new Date(D.startDate).toISOString():null,endDate:D.endDate?new Date(D.endDate).toISOString():null,level:D.level},q=await Ss.createCourse(W);de.success("Course created successfully");const Y={id:q.id,name:q.name,code:q.code,startDate:q.startDate?new Date(q.startDate).toISOString().split("T")[0]:"N/A",endDate:q.endDate?new Date(q.endDate).toISOString().split("T")[0]:"N/A",venue:q.venue||"N/A",note:q.note||"N/A",status:q.status||"PLANNED",description:q.description,maxNumTrainee:q.maxNumTrainee,passScore:q.passScore,level:q.level,department:q.department};i(K=>[Y,...K])}catch(W){throw W.response?.status,de.error(W.response?.data?.message||"Failed to create course"),W}finally{C(!1)}};return l?t.jsx(Ee,{className:"py-4",children:t.jsx("div",{className:"text-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):s?t.jsxs(Ee,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[t.jsx(oe,{className:"mb-1 flex-shrink-0",children:t.jsx(F,{children:t.jsx(R,{className:"border-0 shadow-sm",children:t.jsxs(R.Body,{className:"p-2",children:[t.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:t.jsxs("div",{children:[t.jsxs("h4",{className:"mb-1",children:[t.jsx(it,{className:"me-2 text-primary"}),s.name]}),t.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",s.code]})]})}),t.jsx("p",{className:"text-muted mb-1 small",children:s.description}),t.jsxs(oe,{className:"g-2",children:[t.jsx(F,{md:4,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx($s,{className:"me-2 text-primary",size:16}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Total Subjects"}),t.jsx("div",{className:"fw-semibold small",children:s.totalSubjects})]})]})}),t.jsx(F,{md:4,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{className:"me-2 text-primary",size:16}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Total Trainers"}),t.jsx("div",{className:"fw-semibold small",children:s.totalTrainers})]})]})}),t.jsx(F,{md:4,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{className:"me-2 text-primary",size:16}),t.jsxs("div",{children:[t.jsx("small",{className:"text-muted",children:"Department Head"}),t.jsx("div",{className:"fw-semibold small",children:g?t.jsxs(se,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>j(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName," ",g.lastName]}):"Not assigned"})]})]})})]})]})})})}),t.jsx(oe,{className:"mt-3",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("h5",{className:"mb-0 text-white",children:[t.jsx($s,{className:"me-2"}),"Courses (",n.length,")"]}),t.jsx(Ht,{permission:be.COURSES.CREATE,children:t.jsxs(se,{variant:"light",size:"sm",onClick:T,className:"academic-course-add-btn",children:[t.jsx(ks,{size:16,className:"me-1"}),"Add New Course"]})})]})}),t.jsx("div",{className:"p-0",children:t.jsx(H3,{courses:n,loading:!1,actionsComponent:V3,onView:_,onDisable:k,onRestore:A})})]})})}),t.jsx(G3,{show:c&&m==="add",onClose:()=>d(!1),onSave:U,loading:S}),t.jsx(q3,{show:h,onClose:()=>p(!1),onArchive:P,course:x}),t.jsx(Y3,{show:N,onClose:()=>j(!1),departmentHead:g,department:s})]}):t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx(it,{size:48,className:"mb-3"}),t.jsx("h4",{children:"Department not found"}),t.jsx("p",{children:"The requested department could not be found."})]})})},X3=()=>{const{courseId:e}=Jt();return t.jsx(K3,{courseId:e})},J3=({trainer:e,onEdit:r,onDelete:s})=>t.jsx(Ht,{permissions:[be.SUBJECTS.UPDATE,be.SUBJECTS.REMOVE_INSTRUCTOR],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"Edit Trainer",icon:t.jsx(bs,{}),onClick:()=>r(e.id),permission:be.SUBJECTS.UPDATE},{type:"divider"},{label:"Remove Trainer",icon:t.jsx(Zr,{}),className:"text-danger",onClick:()=>s(e.id),permission:be.SUBJECTS.REMOVE_INSTRUCTOR}]})}),bf=({show:e,onClose:r,onDisable:s,subject:a,loading:n=!1})=>{const[i,l]=b.useState(""),[o,c]=b.useState(""),m=i==="ARCHIVE",u=()=>{l(""),c(""),r()},h=async()=>{if(!m){c('Please type "DISABLE" to confirm');return}try{await s(a?.id),u()}catch(x){c(x.message||"Failed to disable subject. Please try again.")}},p=x=>{l(x.target.value),c("")};return t.jsxs(le,{show:e,onHide:u,centered:!0,children:[t.jsx(le.Header,{className:"bg-warning text-dark border-0",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2",size:20}),"Archive Subject"]})}),t.jsxs(le.Body,{className:"p-4",children:[o&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:o}),t.jsxs("div",{className:"mb-3",children:[t.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),t.jsxs("div",{className:"bg-light p-3 rounded",children:[t.jsx("strong",{children:"Subject Code:"})," ",a?.code,t.jsx("br",{}),t.jsx("strong",{children:"Subject Name:"})," ",a?.name,t.jsx("br",{}),a?.description&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Description:"})," ",a?.description]})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"text-danger mb-2",children:[t.jsx("strong",{children:"Warning:"})," This action will:"]}),t.jsxs("ul",{className:"text-danger mb-3",children:[t.jsx("li",{children:"Make the subject unavailable for new enrollments"}),t.jsx("li",{children:"Remove the subject from active course offerings"}),t.jsx("li",{children:"Affect any ongoing training sessions"})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",t.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),t.jsx("input",{type:"text",className:`form-control ${i&&!m?"is-invalid":""}`,id:"confirmText",value:i,onChange:p,placeholder:"Type ARCHIVE here",disabled:n}),i&&!m&&t.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsx(se,{variant:"outline-secondary",onClick:u,disabled:n,children:"Cancel"}),t.jsx(se,{variant:"warning",onClick:h,disabled:n||!m,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Archiving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},Z3=({show:e,onClose:r,onSave:s,subject:a,loading:n=!1})=>{const[i,l]=b.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[o,c]=b.useState([]);b.useEffect(()=>{a&&e&&(l({name:a.name||"",code:a.code||"",description:a.description||"",duration:a.duration||"",level:a.level||"Beginner"}),c([]))},[a,e]);const d=p=>{const{name:x,value:f}=p.target;l(g=>({...g,[x]:f}))},m=()=>{const p=[];return i.name.trim()||p.push("Subject name is required"),i.code.trim()||p.push("Subject code is required"),i.description.trim()||p.push("Description is required"),i.duration.trim()||p.push("Duration is required"),c(p),p.length===0},u=async p=>{if(p.preventDefault(),!!m())try{await s(i),h()}catch{}},h=()=>{l({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),r()};return t.jsxs(le,{show:e,onHide:h,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(bs,{className:"me-2",size:20}),"Edit Subject"]}),t.jsx(se,{variant:"link",onClick:h,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",children:[o.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:o.map((p,x)=>t.jsx("li",{children:p},x))})}),t.jsxs(E,{onSubmit:u,children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Subject Name *"}),t.jsx(E.Control,{type:"text",name:"name",value:i.name,onChange:d,placeholder:"Enter subject name",disabled:n})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Subject Code *"}),t.jsx(E.Control,{type:"text",name:"code",value:i.code,onChange:d,placeholder:"Enter subject code",disabled:n})]})})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Duration *"}),t.jsx(E.Control,{type:"text",name:"duration",value:i.duration,onChange:d,placeholder:"e.g., 2 weeks, 1 month",disabled:n})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Level"}),t.jsxs(E.Select,{name:"level",value:i.level,onChange:d,disabled:n,children:[t.jsx("option",{value:"Beginner",children:"Beginner"}),t.jsx("option",{value:"Intermediate",children:"Intermediate"}),t.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Description *"}),t.jsx(E.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:d,placeholder:"Enter subject description",disabled:n})]})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:h,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary",onClick:u,disabled:n,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(bs,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Q3=({show:e,onClose:r,onSave:s,trainer:a,loading:n=!1})=>{const[i,l]=b.useState({roleInSubject:"ASSISTANT_INSTRUCTOR"}),[o,c]=b.useState([]);b.useEffect(()=>{a&&e&&(l({roleInSubject:a.role||"ASSISTANT_INSTRUCTOR"}),c([]))},[a,e]);const d=p=>{const{name:x,value:f}=p.target;l(g=>({...g,[x]:f}))},m=()=>{const p=[];return i.roleInSubject||p.push("Role in subject is required"),c(p),p.length===0},u=async p=>{if(p.preventDefault(),!!m())try{await s(i),h()}catch{}},h=()=>{l({roleInSubject:"ASSISTANT_INSTRUCTOR"}),c([]),r()};return t.jsxs(le,{show:e,onHide:h,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(bs,{className:"me-2",size:20}),"Edit Trainer"]}),t.jsx(se,{variant:"link",onClick:h,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",children:[o.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:o.map((p,x)=>t.jsx("li",{children:p},x))})}),t.jsxs(E,{onSubmit:u,children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Trainer Name"}),t.jsx(E.Control,{type:"text",value:a?.name||"",disabled:!0,className:"bg-light"})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"EID"}),t.jsx(E.Control,{type:"text",value:a?.eid||"",disabled:!0,className:"bg-light"})]})})]}),t.jsx(oe,{children:t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Role in Subject *"}),t.jsxs(E.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:d,disabled:n,children:[t.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),t.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),t.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),t.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),t.jsx(E.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:h,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary",onClick:u,disabled:n,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(bs,{className:"me-2",size:16}),"Save Changes"]})})]})]})},ek=({show:e,onClose:r,onSave:s,loading:a=!1})=>{const[n,i]=b.useState({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),[l,o]=b.useState([]),[c,d]=b.useState([]),[m,u]=b.useState(!1),h=async()=>{u(!0);try{const v=await Is.getTrainers();v&&v.data?d(v.data):d([])}catch{d([])}finally{u(!1)}};b.useEffect(()=>{e&&(i({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),o([]),h())},[e]);const p=v=>{const{name:N,value:j}=v.target;i(S=>({...S,[N]:j}))},x=()=>{const v=[];return n.trainer_user_id||v.push("Please select a trainer"),n.role_in_subject||v.push("Role in subject is required"),o(v),v.length===0},f=async v=>{if(v.preventDefault(),!!x())try{await s(n),g()}catch{}},g=()=>{i({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),o([]),r()};return t.jsxs(le,{show:e,onHide:g,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-2",size:20}),"Add Trainer"]}),t.jsx(se,{variant:"link",onClick:g,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",children:[l.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:l.map((v,N)=>t.jsx("li",{children:v},N))})}),t.jsx(E,{onSubmit:f,children:t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Select Trainer *"}),t.jsxs(E.Select,{name:"trainer_user_id",value:n.trainer_user_id,onChange:p,disabled:a||m,children:[t.jsx("option",{value:"",children:m?"Loading trainers...":"Choose a trainer..."}),c.map(v=>t.jsxs("option",{value:v.id,children:[v.firstName," ",v.lastName," - ",v.department?.name||"General"]},v.id))]}),m&&t.jsxs("div",{className:"mt-2 text-center",children:[t.jsx(St,{animation:"border",size:"sm",className:"me-2"}),t.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Role in Subject *"}),t.jsxs(E.Select,{name:"role_in_subject",value:n.role_in_subject,onChange:p,disabled:a,children:[t.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),t.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),t.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),t.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),t.jsx(E.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})]})})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:g,disabled:a,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary",onClick:f,disabled:a,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Adding..."]}):t.jsxs(t.Fragment,{children:[t.jsx(ks,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},tk=({subjectId:e,courseId:r})=>{const s=qe(),a=wa(),[n,i]=b.useState(null),[l,o]=b.useState([]),[c,d]=b.useState(!0),[m,u]=b.useState(!1),[h,p]=b.useState(!1),[x,f]=b.useState(!1),[g,v]=b.useState(!1),[N,j]=b.useState(null),[S,C]=b.useState(!1),[w,y]=b.useState(!1),[T,k]=b.useState(!1),[P,A]=b.useState(!1),[_,U]=b.useState("subject-info"),{sortedData:D}=Ot(l),W=V=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[V]||{text:V,variant:"light"},q=b.useCallback(V=>{if(console.log(" NEW CODE: Loading trainers from subject data:",V),V&&V.instructors){console.log(" Raw instructors data:",V.instructors);const z=V.instructors.map(L=>({id:L.id,eid:L.eid,name:`${L.firstName} ${L.lastName}`,role:L.roleInSubject,assignedAt:L.assignedAt}));console.log(" Transformed trainers:",z),o(z)}else console.log(" No instructors data in subject"),o([])},[]);b.useEffect(()=>{e&&(async()=>{if(!e){console.warn(" No subjectId provided to SubjectDetailsView"),i(null),d(!1);return}d(!0);try{console.log(" Fetching subject data for subjectId:",e);const z=await Os.getSubjectById(e);console.log(" Subject data received:",z),z?(i(z),q(z)):(console.warn(" API returned null/undefined response for subjectId:",e),i(null))}catch(z){console.error(" Error loading subject data:",z),console.error(" Error response:",z.response),console.error(" Error status:",z.response?.status),console.error(" Error data:",z.response?.data),console.error(" Error message:",z.response?.data?.message||z.message),z.response?.data?.errors&&Array.isArray(z.response.data.errors)&&(console.error(" Detailed validation errors:",JSON.stringify(z.response.data.errors,null,2)),z.response.data.errors.forEach((te,ne)=>{console.error(` Validation error ${ne+1}:`,{field:te.field,message:te.message,code:te.code,value:te.value})}));let L=z.response?.data?.message||z.message||"Failed to load subject details";if(z.response?.data?.errors&&Array.isArray(z.response.data.errors)&&z.response.data.errors.length>0){const te=z.response.data.errors[0];L=`${L}: ${te.message||te.field}`}de.error(L),i(null)}finally{d(!1)}})()},[e,q]);const Y=async V=>{y(!0);try{await new Promise(z=>setTimeout(z,1e3)),i(z=>({...z,...V})),de.success("Subject updated successfully!"),p(!1)}catch{de.error("Failed to update subject")}finally{y(!1)}},K=async()=>{C(!0);try{await new Promise(V=>setTimeout(V,1e3)),u(!1)}catch{}finally{C(!1)}},H=async V=>{k(!0);try{await Os.addTrainerToSubject(e,V);const z=await Os.getSubjectById(e);z&&(i(z),q(z)),de.success("Trainer added successfully!"),f(!1)}catch(z){console.error("Error adding trainer:",z);const L=z?.message||z?.error||"Failed to add trainer";de.error(L)}finally{k(!1)}},je=async V=>{if(N){A(!0);try{await Os.updateTrainerRole(e,N.id,V);const z=await Os.getSubjectById(e);z&&(i(z),q(z)),de.success("Trainer role updated successfully!"),v(!1)}catch(z){console.error("Error updating trainer role:",z);const L=z?.message||z?.error||"Failed to update trainer role";de.error(L)}finally{A(!1)}}},ie=async V=>{if(V)try{await Os.removeTrainerFromSubject(e,V);const z=await Os.getSubjectById(e);z&&(i(z),q(z)),de.success("Trainer removed successfully!")}catch(z){console.error("Error removing trainer:",z);const L=z?.message||z?.error||"Failed to remove trainer";de.error(L)}},B=()=>{if(r)s(`/academic/course-detail/${r}`);else if(a.state?.courseId)s(`/academic/course-detail/${a.state.courseId}`);else if(document.referrer){const V=document.referrer.match(/\/course-detail\/([^/]+)/);s(V?`/academic/course-detail/${V[1]}`:-1)}else n?.courseId?s(`/academic/course-detail/${n.courseId}`):s(-1)};return c?t.jsx(Ee,{className:"py-4",children:t.jsx(It,{rows:4,columns:3})}):n?t.jsxs(Ee,{className:"py-4 subject-details",children:[t.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsxs(se,{variant:"outline-secondary",onClick:B,className:"me-3",children:[t.jsx(bt,{className:"me-2",size:16}),"Back to Course"]}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:n.name}),t.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",n.code]})]})]})}),t.jsx(R,{className:"border-0 shadow-sm",children:t.jsxs(qt.Container,{activeKey:_,onSelect:U,children:[t.jsx(R.Header,{className:"border-bottom py-2 bg-primary",children:t.jsxs(Et,{variant:"tabs",className:"border-0",children:[t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:_==="subject-info"?"600":"400",opacity:_==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[t.jsx(v0,{className:"me-2",size:16}),"Subject Information"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:_==="trainers"?"600":"400",opacity:_==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[t.jsx(N0,{className:"me-2",size:16}),"Trainers (",l.length,")"]})})]})}),t.jsx(R.Body,{className:"p-4",children:t.jsxs(qt.Content,{children:[t.jsxs(qt.Pane,{eventKey:"subject-info",children:[t.jsxs(oe,{children:[t.jsxs(F,{md:6,children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Name:"})," ",n.name]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Code:"})," ",n.code]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Description:"})," ",n.description]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Method:"})," ",n.method]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Duration:"})," ",n.duration," days"]})]}),t.jsxs(F,{md:6,children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Type:"})," ",n.type]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Pass Score:"})," ",n.passScore,"%"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Room:"})," ",n.roomName]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Time Slot:"})," ",n.timeSlot]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Start Date:"})," ",new Date(n.startDate).toLocaleDateString()]}),t.jsxs("p",{children:[t.jsx("strong",{children:"End Date:"})," ",new Date(n.endDate).toLocaleDateString()]})]})]}),n.remarkNote&&t.jsx(oe,{children:t.jsx(F,{xs:12,children:t.jsxs("p",{children:[t.jsx("strong",{children:"Remark Note:"})," ",n.remarkNote]})})})]}),t.jsxs(qt.Pane,{eventKey:"trainers",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[t.jsxs("h6",{className:"mb-0",children:["Trainers (",l.length,")"]}),t.jsxs(se,{variant:"primary",size:"sm",onClick:()=>f(!0),children:[t.jsx(ks,{size:14,className:"me-1"}),"Add Trainer"]})]}),t.jsxs(gt,{hover:!0,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"EID"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Role"}),t.jsx("th",{children:"Assigned Date"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:D.map(V=>{const z=W(V.role);return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx(Te,{bg:"secondary",className:"text-white",children:V.eid})}),t.jsx("td",{children:V.name}),t.jsx("td",{children:t.jsx(Te,{bg:z.variant,children:z.text})}),t.jsx("td",{children:new Date(V.assignedAt).toLocaleDateString()}),t.jsx("td",{children:t.jsx(J3,{trainer:V,onEdit:()=>{j(V),v(!0)},onDelete:ie})})]},V.id)})})]})]})]})})]})}),t.jsx(bf,{show:m,onClose:()=>u(!1),onConfirm:K,subject:n,loading:S}),t.jsx(Z3,{show:h,onClose:()=>p(!1),onSave:Y,subject:n,loading:w}),t.jsx(ek,{show:x,onClose:()=>f(!1),onSave:H,loading:T}),t.jsx(Q3,{show:g,onClose:()=>v(!1),onSave:je,trainer:N,loading:P})]}):t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{children:"Subject not found"}),t.jsx("p",{children:"The requested subject could not be found."}),t.jsxs(se,{variant:"primary",onClick:B,children:[t.jsx(bt,{className:"me-2",size:16}),"Go Back"]})]})})},t0=()=>{const{subjectId:e,courseId:r}=Jt();return t.jsx(tk,{subjectId:e,courseId:r})},sk=({subject:e,onView:r,onEdit:s,onDelete:a})=>{const n=()=>{r&&r(e.id)},i=()=>{a&&a(e.id)};return t.jsx(Ht,{permissions:[be.SUBJECTS.VIEW_DETAIL,be.SUBJECTS.DELETE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:n,permission:be.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Archive Subject",icon:t.jsx(d0,{}),className:"text-warning",onClick:i,permission:be.SUBJECTS.ARCHIVE}]})})},rk=e=>(console.log(" mapApiSubjectToTable - API subject fields:",Object.keys(e)),console.log(" mapApiSubjectToTable - start_date:",e.start_date,"startDate:",e.startDate),console.log(" mapApiSubjectToTable - end_date:",e.end_date,"endDate:",e.endDate),{id:e.id,name:e.name,code:e.code,method:e.method,duration:nk(e.duration),startDate:s0(e.startDate||e.start_date),endDate:s0(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.deletedAt?"INACTIVE":"ACTIVE",description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),ak=e=>{console.log(" mapApiSubjectsToTable - Input:",e),console.log(" mapApiSubjectsToTable - Input length:",e.length);const r=e.map(rk);return console.log(" mapApiSubjectsToTable - Output:",r),console.log(" mapApiSubjectsToTable - Output length:",r.length),r},nk=e=>e?e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`:"N/A",s0=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch(r){return console.error("Error formatting date:",r),"Invalid Date"}},ik=e=>{switch(e){case"ACTIVE":return"success";case"INACTIVE":return"secondary";default:return"secondary"}},lk=e=>{switch(e){case"CLASSROOM":return"info";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},ok=({subjects:e=[],loading:r=!1,onView:s,onEdit:a,onDelete:n})=>{console.log(" SubjectTable - Received subjects:",e),console.log(" SubjectTable - subjects length:",e.length),console.log(" SubjectTable - loading:",r);const i=ak(e);console.log(" SubjectTable - mappedApiSubjects:",i),console.log(" SubjectTable - mappedApiSubjects length:",i.length);const{sortedData:l,sortConfig:o,handleSort:c}=Ot(i);if(r)return t.jsx(It,{rows:4,columns:5});if(i.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No subjects found"}),t.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const d=({columnKey:m,children:u,className:h=""})=>{const p=o.key===m,x=p?o.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${h} ${p?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>c(m),onMouseEnter:f=>{f.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",f.target.style.transform="translateY(-1px)",f.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:f=>{f.target.style.backgroundColor="transparent",f.target.style.transform="translateY(0)",f.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:p?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:u}),t.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:t.jsx(zt,{direction:x,size:14})})]}),p&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[t.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:t.jsxs("tr",{children:[t.jsx(d,{columnKey:"name",className:"show-mobile",children:"Name"}),t.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),t.jsx(d,{columnKey:"method",className:"show-mobile",children:"Method"}),t.jsx(d,{columnKey:"duration",className:"show-mobile",children:"Duration"}),t.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),t.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),t.jsx(d,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),t.jsx(d,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),t.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:t.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),t.jsx("tbody",{children:l.map(m=>t.jsxs("tr",{children:[t.jsx("td",{className:"show-mobile",children:t.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>s&&s(m.id),style:{cursor:"pointer"},children:m.name})}),t.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:m.code,children:m.code})}),t.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:t.jsx(Te,{bg:lk(m.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:m.method,children:m.method})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",children:m.duration})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",children:m.startDate})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",children:m.endDate})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",children:m.roomName})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{size:14,className:"me-1 text-muted"}),t.jsx("span",{className:"text-dark",children:m.trainees||0})]})}),t.jsx("td",{className:"show-mobile",children:t.jsxs(Te,{bg:ik(m.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:m.status==="ACTIVE"?"":""}),m.status==="ACTIVE"?"Active":"Inactive"]})}),t.jsx("td",{className:"text-center show-mobile",children:t.jsx(sk,{subject:m,onView:s,onEdit:a,onDelete:n})})]},m.id))})]})})},ck=({trainee:e,onView:r,onRemove:s})=>{const a=()=>{r&&r(e)},n=()=>{s&&s(e)};return t.jsx(Ht,{permissions:[be.TRAINEES.VIEW_DETAIL,be.TRAINEES.DELETE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:a,permission:be.TRAINEES.VIEW_DETAIL},{type:"divider"},{label:"Remove from Course",icon:t.jsx(Xa,{}),className:"text-danger",onClick:n,permission:be.TRAINEES.DELETE}]})})},dk=({show:e,onClose:r,onConfirm:s,trainee:a,subject:n,loading:i=!1})=>{if(!a||!n)return null;const l=()=>{s(a.id,n.id)};return t.jsxs(le,{show:e,onHide:r,centered:!0,children:[t.jsx(le.Header,{closeButton:!0,className:"border-bottom",children:t.jsxs(le.Title,{className:"d-flex align-items-center text-danger",children:[t.jsx(Wt,{className:"me-2",size:20}),"Remove Subject"]})}),t.jsxs(le.Body,{className:"p-4",children:[t.jsxs(Ae,{variant:"warning",className:"mb-3",children:[t.jsx(Wt,{className:"me-2",size:16}),t.jsx("strong",{children:"Warning:"})," This action cannot be undone."]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"mb-2",children:["Are you sure you want to remove ",t.jsxs("strong",{children:['"',n.name,'"']})," from trainee ",t.jsxs("strong",{children:['"',a.name,'"']}),"?"]}),t.jsx("div",{className:"bg-light p-3 rounded",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsx("small",{className:"text-muted",children:"Trainee:"}),t.jsx("div",{className:"fw-semibold",children:a.name}),t.jsx("div",{className:"text-muted small",children:a.eid})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("small",{className:"text-muted",children:"Subject:"}),t.jsx("div",{className:"fw-semibold",children:n.name}),t.jsx("div",{className:"text-muted small",children:n.code})]})]})})]}),t.jsx("p",{className:"text-muted small mb-0",children:"The trainee will no longer be enrolled in this subject and will lose access to related materials and assessments."})]}),t.jsxs(le.Footer,{className:"border-top",children:[t.jsx(se,{variant:"secondary",onClick:r,disabled:i,children:"Cancel"}),t.jsx(se,{variant:"danger",onClick:l,disabled:i,className:"d-flex align-items-center",children:i?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Removing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Zr,{className:"me-2",size:16}),"Remove Subject"]})})]})]})},mk=({show:e,onClose:r,trainee:s,onRemoveSubject:a,loading:n=!1})=>{const[i,l]=b.useState(!1),[o,c]=b.useState(null),[d,m]=b.useState(!1);if(!s)return null;const u=(x,f)=>{const g=s.subjects.find(v=>v.id===x);g&&(c(g),l(!0))},h=async(x,f)=>{m(!0);try{await a(x,f),l(!1),c(null)}catch(g){console.error("Error removing subject:",g)}finally{m(!1)}},p=()=>{l(!1),c(null)};return t.jsxs(le,{show:e,onHide:r,size:"lg",centered:!0,children:[t.jsx(le.Header,{closeButton:!0,className:"border-bottom",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Dt,{className:"me-2 text-primary",size:20}),"Trainee Details"]})}),t.jsxs(le.Body,{className:"p-4",children:[t.jsxs(oe,{className:"mb-4",children:[t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Full Name"}),t.jsx("p",{className:"mb-0 fw-semibold",children:s.name})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Employee ID"}),t.jsx(Te,{bg:"secondary",className:"px-2 py-1",children:s.eid})]})]}),t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Email"}),t.jsx("span",{children:s.email})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Phone"}),t.jsx("span",{children:s.phone})]})]})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Enroll Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-primary"}),t.jsx("span",{children:s.enrollDate||"N/A"})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Enroll Batch"}),t.jsx(Te,{bg:"info",className:"px-2 py-1",children:s.enrollBatch||"N/A"})]})})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("h6",{className:"text-muted mb-3 d-flex align-items-center",children:[t.jsx(it,{className:"me-2 text-primary",size:16}),"Enrolled Subjects (",s.subjects?.length||0,")"]}),s.subjects&&s.subjects.length>0?t.jsx("div",{className:"table-responsive",children:t.jsxs(gt,{hover:!0,size:"sm",className:"mb-0",children:[t.jsx("thead",{className:"bg-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-0",children:"Subject Name"}),t.jsx("th",{className:"border-0",children:"Code"}),t.jsx("th",{className:"border-0",children:"Status"}),t.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),t.jsx("tbody",{children:s.subjects.map((x,f)=>t.jsxs("tr",{children:[t.jsxs("td",{className:"border-0",children:[t.jsx("div",{className:"fw-semibold",children:x.name}),x.description&&t.jsx("small",{className:"text-muted",children:x.description})]}),t.jsx("td",{className:"border-0",children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:x.code})}),t.jsx("td",{className:"border-0",children:t.jsx(Te,{bg:x.status==="ACTIVE"?"success":x.status==="COMPLETED"?"primary":"warning",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:x.status})}),t.jsx("td",{className:"border-0 text-center",children:t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>u(x.id||f,x.name),disabled:n,className:"p-1",style:{minWidth:"32px"},children:t.jsx(Zr,{size:14})})})]},f))})]})}):t.jsxs("div",{className:"text-center text-muted py-3",children:[t.jsx(it,{size:32,className:"mb-2"}),t.jsx("p",{className:"mb-0",children:"No subjects enrolled"})]})]})]}),t.jsx(le.Footer,{className:"border-top",children:t.jsx(se,{variant:"secondary",onClick:r,children:"Close"})}),t.jsx(dk,{show:i,onClose:p,onConfirm:h,trainee:s,subject:o,loading:d})]})},uk=({course:e,loading:r=!1,onView:s,onRemove:a})=>{const{courseId:n}=Jt(),[i,l]=b.useState(null),[o,c]=b.useState(!1),[d,m]=b.useState([]),[u,h]=b.useState(!0),[p,x]=b.useState(null),{sortedData:f,sortConfig:g,handleSort:v}=Ot(d),N=b.useCallback(async()=>{if(!n){m([]),h(!1);return}h(!0),x(null);try{const T=await Ss.getCourseTrainees(n);if(T.trainees&&Array.isArray(T.trainees)){const k=T.trainees.map(P=>({id:P.id,eid:P.eid,name:`${P.firstName||""} ${P.lastName||""}`.trim(),email:P.email,subjects:[],userId:P.id,department:P.department,enrollmentCount:P.enrollmentCount||0,enrollDate:"N/A",enrollBatch:P.batches&&P.batches.length>0?P.batches[0]:"N/A",batches:P.batches||[]}));m(k)}else m([])}catch(T){console.error("Error loading enrolled trainees:",T),x("Failed to load trainees"),m([])}finally{h(!1)}},[n]);b.useEffect(()=>{n&&N()},[n,N]);const j=async T=>{try{const k={...T,subjects:T.subjects||[]};l(k),c(!0)}catch(k){console.error("Error loading trainee details:",k),l(T),c(!0)}},S=()=>{c(!1),l(null)},C=async T=>{if(window.confirm(`Are you sure you want to remove ${T.name} from this course?`))try{console.log("Removing trainee:",T),console.warn("handleRemoveTrainee: Need proper API endpoint to remove trainee from course"),await N()}catch(k){console.error("Error removing trainee:",k)}},w=async(T,k)=>{try{const P=d.find(U=>U.id===T);if(!P)return;const A=i?.subjects?.find(U=>U.id===k);if(!A)return;const _=A.enrollment?.batchCode||"TEST0012025";if(A.enrollment?.status!=="ENROLLED")throw new Error("Cannot remove trainee from inactive enrollment");await Os.removeTraineeFromSubject(k,P.userId,_),await N(),c(!1)}catch(P){throw console.error("Error removing subject:",P),P}};if(u)return t.jsx(It,{rows:4,columns:7});if(p)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-danger",children:[t.jsx("h5",{children:"Error loading trainees"}),t.jsx("p",{children:p}),t.jsx("button",{className:"btn btn-outline-primary",onClick:N,children:"Try Again"})]})});if(d.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No trainees found"}),t.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})});const y=({columnKey:T,children:k,className:P=""})=>{const A=g.key===T,_=A?g.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${P} ${A?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>v(T),onMouseEnter:U=>{U.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",U.target.style.transform="translateY(-1px)",U.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:U=>{U.target.style.backgroundColor="transparent",U.target.style.transform="translateY(0)",U.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:A?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k}),t.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:t.jsx(zt,{direction:_,size:14})})]}),A&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"department-table-container trainee-table-scroll",style:{overflowX:"hidden"},children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[t.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:t.jsxs("tr",{children:[t.jsx(y,{columnKey:"eid",className:"show-mobile",children:"EID"}),t.jsx(y,{columnKey:"name",className:"show-mobile",children:"Full Name"}),t.jsx(y,{columnKey:"email",className:"show-mobile",children:"Email"}),t.jsx(y,{columnKey:"subjects",className:"show-mobile",children:"Number of Subjects"}),t.jsx(y,{columnKey:"enrollDate",className:"show-mobile",children:"Enroll Date"}),t.jsx(y,{columnKey:"enrollBatch",className:"show-mobile",children:"Enroll Batch"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:t.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),t.jsx("tbody",{children:f.map(T=>t.jsxs("tr",{children:[t.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:T.eid,children:T.eid})}),t.jsx("td",{className:"show-mobile",children:t.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>j(T),style:{cursor:"pointer"},children:T.name})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",style:{fontSize:"0.85rem"},children:T.email})}),t.jsx("td",{className:"show-mobile",children:t.jsx(Te,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:T.enrollmentCount})}),t.jsx("td",{className:"show-mobile",children:t.jsx("span",{className:"text-dark",children:T.enrollDate})}),t.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:t.jsx(Te,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:T.enrollBatch,children:T.enrollBatch})}),t.jsx("td",{className:"text-center show-mobile",children:t.jsx(ck,{trainee:T,onView:j,onRemove:C})})]},T.id))})]})}),t.jsx(mk,{show:o,onClose:S,trainee:i,onRemoveSubject:w})]})},hk=({show:e,onClose:r,onSave:s,loading:a=!1,courseId:n})=>{const[i,l]=b.useState({courseId:n||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[o,c]=b.useState([]),[d,m]=b.useState(!1),[u,h]=b.useState([]),[p,x]=b.useState(!1);b.useEffect(()=>{e&&f()},[e]);const f=async()=>{x(!0);try{const S=await Ss.getCourses();S&&S.courses?h(S.courses):Array.isArray(S)&&h(S)}catch{de.error("Failed to load courses")}finally{x(!1)}},g=S=>{const{name:C,value:w,type:y,checked:T}=S.target;l(k=>({...k,[C]:y==="checkbox"?T:w}))},v=()=>{const S=[];return i.courseId.trim()||S.push("Course is required"),i.name.trim()||S.push("Subject name is required"),i.code.trim()||S.push("Subject code is required"),i.description.trim()||S.push("Description is required"),i.duration.trim()?(isNaN(i.duration)||parseInt(i.duration)<=0)&&S.push("Duration must be a positive number"):S.push("Duration is required"),i.passScore.trim()?(isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&S.push("Pass score must be between 0 and 100"):S.push("Pass score is required"),i.startDate.trim()||S.push("Start date is required"),i.endDate.trim()||S.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&S.push("End date must be after start date"),c(S),S.length===0},N=async S=>{if(S.preventDefault(),!!v()){m(!0);try{const C={courseId:n,name:i.name.trim(),code:i.code.trim(),description:i.description.trim(),method:i.method,duration:parseInt(i.duration),type:i.type,roomName:i.roomName.trim(),remarkNote:i.remarkNote.trim(),timeSlot:i.timeSlot.trim(),isSIM:i.isSIM,passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString()},w=await De.post("/subjects",C);de.success("Subject created successfully!"),s&&await s(w.data||C),j()}catch(C){const w=C.response?.data?.message||C.message||"Failed to create subject";de.error(`Error: ${w}`),c([w])}finally{m(!1)}}},j=()=>{l({courseId:n||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),m(!1),r()};return t.jsxs(le,{show:e,onHide:j,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-2",size:20}),"Add New Subject"]}),t.jsx(se,{variant:"link",onClick:j,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[o.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:o.map((S,C)=>t.jsx("li",{children:S},C))})}),t.jsxs(E,{onSubmit:N,children:[t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Course *"}),t.jsxs(E.Select,{name:"courseId",value:i.courseId,onChange:g,required:!0,disabled:p,children:[t.jsx("option",{value:"",children:p?"Loading courses...":"Select a course"}),u.map(S=>t.jsxs("option",{value:S.id,children:[S.name," (",S.code,")"]},S.id))]})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Subject Name *"}),t.jsx(E.Control,{type:"text",name:"name",value:i.name,onChange:g,placeholder:"Enter subject name",required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Subject Code *"}),t.jsx(E.Control,{type:"text",name:"code",value:i.code,onChange:g,placeholder:"Enter subject code",required:!0})]})})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Description *"}),t.jsx(E.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:g,placeholder:"Enter subject description",required:!0})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Method *"}),t.jsxs(E.Select,{name:"method",value:i.method,onChange:g,required:!0,children:[t.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),t.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),t.jsx("option",{value:"ERO",children:"ERO"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Duration (days) *"}),t.jsx(E.Control,{type:"number",name:"duration",value:i.duration,onChange:g,placeholder:"Enter duration in days",min:"1",required:!0})]})})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Type *"}),t.jsxs(E.Select,{name:"type",value:i.type,onChange:g,required:!0,children:[t.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),t.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Room Name"}),t.jsx(E.Control,{type:"text",name:"roomName",value:i.roomName,onChange:g,placeholder:"Enter room name"})]})})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Time Slot"}),t.jsx(E.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:g,placeholder:"e.g., 09:00-11:00"})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Pass Score *"}),t.jsx(E.Control,{type:"number",name:"passScore",value:i.passScore,onChange:g,placeholder:"Enter pass score (0-100)",min:"0",max:"100",required:!0})]})})]}),t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Start Date *"}),t.jsx(E.Control,{type:"datetime-local",name:"startDate",value:i.startDate,onChange:g,required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"End Date *"}),t.jsx(E.Control,{type:"datetime-local",name:"endDate",value:i.endDate,onChange:g,required:!0})]})})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Remark Note"}),t.jsx(E.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:g,placeholder:"Enter remark note"})]}),t.jsx(E.Group,{className:"mb-3",children:t.jsx(E.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:g,label:"Is Simulator"})})]})]}),t.jsxs(le.Footer,{className:"border-0",children:[t.jsx(se,{variant:"secondary",onClick:j,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:N,disabled:d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"16px",height:"16px"}}),"Creating..."]}):"Create Subject"})]})]})},fk=({show:e,onClose:r,onImport:s,loading:a=!1,courseId:n})=>{const[i,l]=b.useState(!1),[o,c]=b.useState(null),[d,m]=b.useState([]),[u,h]=b.useState([]),[p,x]=b.useState([]),f=b.useRef(null),g=["code","name","course_id"],v=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],N=A=>{A.preventDefault(),A.stopPropagation(),A.type==="dragenter"||A.type==="dragover"?l(!0):A.type==="dragleave"&&l(!1)},j=A=>{A.preventDefault(),A.stopPropagation(),l(!1),A.dataTransfer.files&&A.dataTransfer.files[0]&&C(A.dataTransfer.files[0])},S=A=>{A.target.files&&A.target.files[0]&&C(A.target.files[0])},C=A=>{if(!A.name.match(/\.(xlsx|xls)$/)){h(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(A.size>100*1024*1024){h(["File size must be less than 100MB"]);return}c(A),h([]),w(A)},w=A=>{const _=new FileReader;_.onload=U=>{try{const D=new Uint8Array(U.target.result),W=$n(D,{type:"array"}),q=W.SheetNames[0],Y=W.Sheets[q],K=lr.sheet_to_json(Y,{header:1});if(K.length<2){h(["Excel file must contain at least a header row and one data row"]);return}const H=K[0].map(z=>z?.toString().toLowerCase().trim()),je=K.slice(1),B=(n?g.filter(z=>z!=="course_id"):g).filter(z=>!H.includes(z));if(B.length>0){h([`Missing required columns: ${B.join(", ")}`]);return}n&&!H.includes("course_id")&&console.log(" course_id column not found in file, will use courseId from props:",n);const V=je.map((z,L)=>{const te=H.includes("course_id")?z[H.indexOf("course_id")]?.toString().trim()||"":n||"",ne={id:`temp_${L}`,rowNumber:L+2,code:z[H.indexOf("code")]?.toString().trim()||"",name:z[H.indexOf("name")]?.toString().trim()||"",course_id:te,description:z[H.indexOf("description")]?.toString().trim()||"",method:z[H.indexOf("method")]?.toString().trim()||"THEORY",duration:z[H.indexOf("duration")]?.toString().trim()||"",type:z[H.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:z[H.indexOf("room_name")]?.toString().trim()||"",remark_note:z[H.indexOf("remark_note")]?.toString().trim()||"",time_slot:z[H.indexOf("time_slot")]?.toString().trim()||"",pass_score:z[H.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const ue=z[H.indexOf("start_date")];return ue?ue instanceof Date?ue.toISOString().split("T")[0]:typeof ue=="number"?ue:String(ue).trim():""})(),end_date:(()=>{const ue=z[H.indexOf("end_date")];return ue?ue instanceof Date?ue.toISOString().split("T")[0]:typeof ue=="number"?ue:String(ue).trim():""})(),is_sim:H.includes("is_sim")||H.includes("issim")?z[H.indexOf(H.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(ne.code||(ne.hasError=!0,ne.errors.push("Subject code is required")),ne.name||(ne.hasError=!0,ne.errors.push("Subject name is required")),!ne.course_id&&!n?(ne.hasError=!0,ne.errors.push("Course ID is required (either in file or must be importing from course detail page)")):ne.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(ne.course_id)||(ne.hasError=!0,ne.errors.push("Course ID must be a valid UUID format"))),ne.duration&&(isNaN(ne.duration)||parseInt(ne.duration)<=0)&&(ne.hasError=!0,ne.errors.push("Duration must be a positive number")),ne.pass_score&&(isNaN(ne.pass_score)||parseFloat(ne.pass_score)<0||parseFloat(ne.pass_score)>100)&&(ne.hasError=!0,ne.errors.push("Pass score must be between 0 and 100")),ne.method){let ue=ne.method.toUpperCase().trim();ue==="E-LEARNING"||ue==="E LEARNING"||ue==="ELEARNING"?ue="E_LEARNING":ue==="CLASSROOM"||ue==="CLASS ROOM"||ue==="CLASS-ROOM"?ue="CLASSROOM":ue==="ERO"&&(ue="ERO"),ne.method=ue,["E_LEARNING","CLASSROOM","ERO"].includes(ue)||(ne.hasError=!0,ne.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}if(ne.type&&!["UNLIMIT","RECURRENT"].includes(ne.type.toUpperCase())&&(ne.hasError=!0,ne.errors.push("Type must be UNLIMIT or RECURRENT")),ne.start_date)try{let ue;if(typeof ne.start_date=="number"&&ne.start_date>1e4){const Ne=parseFloat(ne.start_date);ue=new Date((Ne-25569)*86400*1e3)}else{const Ne=String(ne.start_date).trim();ue=new Date(Ne)}isNaN(ue.getTime())&&(ne.hasError=!0,ne.errors.push("Start date must be a valid date"))}catch{ne.hasError=!0,ne.errors.push("Start date must be a valid date")}if(ne.end_date)try{let ue;if(typeof ne.end_date=="number"&&ne.end_date>1e4){const Ne=parseFloat(ne.end_date);ue=new Date((Ne-25569)*86400*1e3)}else{const Ne=String(ne.end_date).trim();ue=new Date(Ne)}isNaN(ue.getTime())&&(ne.hasError=!0,ne.errors.push("End date must be a valid date"))}catch{ne.hasError=!0,ne.errors.push("End date must be a valid date")}return ne}).filter(z=>z.code||z.name);m(V),x([])}catch{h(["Failed to parse Excel file. Please check the file format."])}},_.readAsArrayBuffer(A)},y=async()=>{const A=d.filter(U=>!U.hasError);if(A.length===0){h(["No valid subjects to import"]);return}if(!n&&A.filter(D=>!D.course_id).length>0){h(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}const _=A.map(U=>{let D=!1;const W=U.is_sim!==void 0?U.is_sim:void 0;if(W!=null&&W!=="")if(typeof W=="string"){const je=W.toLowerCase().trim();D=["true","1","yes","y"].includes(je)}else typeof W=="boolean"?D=W:typeof W=="number"&&(D=W!==0);const q=je=>{if(!je||je===""||je==="N/A")return null;try{let ie;if(typeof je=="string"){const V=je.trim();if(/^\d+$/.test(V)){const z=parseInt(V);if(z>=1&&z<=1e5){const ne=(z-25569)*86400*1e3;ie=new Date(ne);const ue=ie.getFullYear();(ue<1900||ue>2100)&&(console.warn("Excel serial number conversion resulted in unreasonable year:",ue,"for input:",V),ie=new Date(V))}else ie=new Date(z<1e12?z*1e3:z)}else{if(V.includes("T")&&V.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/))return V;V.match(/^\d{4}-\d{2}-\d{2}$/)?ie=new Date(V+"T00:00:00.000Z"):ie=new Date(V)}}else typeof je=="number"?je>=1&&je<=1e5?ie=new Date((je-25569)*86400*1e3):je>1e5&&je<1e12?ie=new Date(je*1e3):ie=new Date(je):ie=new Date(je);if(isNaN(ie.getTime()))return console.warn("Invalid date value:",je,"type:",typeof je),null;const B=ie.getFullYear();return B<1900||B>2100?(console.warn("Date out of reasonable range:",je,"",ie.toISOString(),"year:",B),null):ie.toISOString()}catch(ie){return console.error("Error formatting date:",je,ie),null}},Y=q(U.start_date),K=q(U.end_date),H={code:U.code,name:U.name,courseId:String(n||U.course_id),description:U.description||"",method:U.method?U.method.toUpperCase():"CLASSROOM",duration:U.duration?parseInt(U.duration):1,type:U.type?U.type.toUpperCase():"UNLIMIT",roomName:U.room_name||"",remarkNote:U.remark_note||"",timeSlot:U.time_slot||"",passScore:U.pass_score?parseFloat(U.pass_score):70,isSIM:D};return Y&&(H.startDate=Y),K&&(H.endDate=K),A.indexOf(U)===0&&console.log(" Sample date formatting:",{originalStartDate:U.start_date,formattedStartDate:Y,originalEndDate:U.end_date,formattedEndDate:K,payloadStartDate:H.startDate,payloadEndDate:H.endDate}),H});try{const U=await s(_),D=U?.summary?.created??U?.createdSubjects?.length??0,W=U?.summary?.failed??U?.failedSubjects?.length??0,q=U?.summary?.total??(Array.isArray(_)?_.length:D+W);D>0&&W===0?de.success(`Imported ${D}/${q} subjects successfully.`):D>0&&W>0?de.warn(`Imported ${D}/${q}. ${W} failed. Check errors in the file or API response.`):D===0&&W>0?de.error(`All ${W}/${q} subjects failed to import.`):de.info("No subjects were imported."),T()}catch(U){de.error(U?.response?.data?.message||U.message||"Failed to import subjects."),h([U?.response?.data?.message||U.message||"Failed to import subjects. Please try again."])}},T=()=>{c(null),m([]),h([]),x([]),l(!1),r()},k=A=>A==="valid"?t.jsx(rt,{className:"text-success",size:16}):t.jsx(Ms,{className:"text-danger",size:16}),P=()=>{const A=[v,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],_=lr.aoa_to_sheet(A),U=lr.book_new();lr.book_append_sheet(U,_,"Subjects"),ud(U,"Subject_Upload_Template.xlsx")};return t.jsxs(le,{show:e,onHide:T,size:"xl",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-2",size:20}),"Bulk Import Subjects"]}),t.jsx(se,{variant:"link",onClick:T,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[u.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:u.map((A,_)=>t.jsx("li",{children:A},_))})}),t.jsx(R,{className:"mb-4",children:t.jsxs(R.Body,{children:[t.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:j,onClick:()=>f.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[t.jsx(Ha,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),t.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),t.jsx("input",{ref:f,type:"file",accept:".xlsx,.xls",onChange:S,style:{display:"none"}})]}),t.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[t.jsxs("div",{children:[t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&t.jsx("span",{children:", Course ID (UUID format)"}),n&&t.jsxs("span",{className:"text-success",children:[t.jsx("br",{})," Course ID will be automatically set to current course (",n?.substring(0,8),"...)"]})]}),t.jsx("br",{}),t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:P,className:"d-flex align-items-center",children:[t.jsx(qr,{className:"me-1",size:14}),"Download Template"]}),o&&t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Ha,{className:"text-success me-2",size:16}),t.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})]})}),d.length>0&&t.jsxs(R,{children:[t.jsx(R.Header,{className:"bg-light",children:t.jsxs("h6",{className:"mb-0",children:["Preview Data (",d.length," subjects)",t.jsxs("span",{className:"ms-2",children:[t.jsx(rt,{className:"text-success me-1",size:16}),d.filter(A=>!A.hasError).length," valid",t.jsx(Ms,{className:"text-danger ms-2 me-1",size:16}),d.filter(A=>A.hasError).length," invalid"]})]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:t.jsxs(gt,{hover:!0,className:"mb-0",children:[t.jsx("thead",{className:"bg-light sticky-top",children:t.jsxs("tr",{children:[t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Code"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Course ID"}),t.jsx("th",{children:"Method"}),t.jsx("th",{children:"Duration"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Pass Score"}),t.jsx("th",{children:"Errors"})]})}),t.jsx("tbody",{children:d.map((A,_)=>t.jsxs("tr",{className:A.hasError?"table-danger":"table-success",children:[t.jsx("td",{children:k(A.hasError?"invalid":"valid")}),t.jsx("td",{children:A.code}),t.jsx("td",{children:A.name}),t.jsx("td",{children:A.course_id}),t.jsx("td",{children:A.method}),t.jsx("td",{children:A.duration}),t.jsx("td",{children:A.type}),t.jsx("td",{children:A.pass_score}),t.jsx("td",{children:A.errors.length>0&&t.jsx("small",{className:"text-danger",children:A.errors.join(", ")})})]},A.id))})]})})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:T,disabled:a,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),d.length>0&&t.jsx(se,{variant:"primary",onClick:y,disabled:a||d.filter(A=>!A.hasError).length===0,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"me-2",size:16}),"Import All (",d.filter(A=>!A.hasError).length," subjects)"]})})]})]})},xk=({show:e,onClose:r,onSave:s,course:a,loading:n=!1})=>{const[i,l]=b.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[o,c]=b.useState({});b.useEffect(()=>{a&&l({name:a.name||"",code:a.code||"",description:a.description||"",maxTrainees:a.maxNumTrainee||a.maxTrainees||"",venue:a.venue||"",note:a.note||"",passScore:a.passScore||"",startDate:a.startDate||"",endDate:a.endDate||"",level:a.level||"BEGINNER",status:a.status||"ACTIVE"})},[a]);const d=()=>{l({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}),r()},m=p=>{const{name:x,value:f}=p.target;l(g=>({...g,[x]:f})),o[x]&&c(g=>({...g,[x]:""}))},u=()=>{const p={};if(i.name.trim()||(p.name="Course name is required"),i.code.trim()||(p.code="Course code is required"),i.description.trim()||(p.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(p.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(p.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(p.passScore="Pass score must be between 0 and 100"),!i.startDate)p.startDate="Start date is required";else{const x=new Date;x.setHours(0,0,0,0),new Date(i.startDate)<x&&(p.startDate="Start date cannot be in the past")}return i.endDate||(p.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(p.endDate="End date must be after start date"),c(p),Object.keys(p).length===0},h=async p=>{if(p.preventDefault(),!!u())try{const x={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},f=await De.put(`/courses/${a.id}`,x);de.success("Course updated successfully!"),s&&await s(f.data||x),d()}catch(x){const f=x.response?.data?.message||x.message||"Failed to update course";de.error(`Error: ${f}`)}};return t.jsxs(le,{show:e,onHide:d,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(bs,{className:"me-2",size:20}),"Edit Course"]}),t.jsx(se,{variant:"link",onClick:d,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(E,{onSubmit:h,children:[t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Course Name *"}),t.jsx(E.Control,{type:"text",name:"name",value:i.name,onChange:m,isInvalid:!!o.name,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.name})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Course Code *"}),t.jsx(E.Control,{type:"text",name:"code",value:i.code,onChange:m,isInvalid:!!o.code,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.code})]})})]}),t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Max Trainees *"}),t.jsx(E.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:m,isInvalid:!!o.maxTrainees,disabled:n,min:"1"}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.maxTrainees})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Pass Score (%) *"}),t.jsx(E.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,isInvalid:!!o.passScore,disabled:n,min:"0",max:"100"}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Level"}),t.jsxs(E.Select,{name:"level",value:i.level,onChange:m,disabled:n,children:[t.jsx("option",{value:"BEGINNER",children:"Beginner"}),t.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),t.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),t.jsxs(oe,{className:"mb-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Start Date *"}),t.jsx(E.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,isInvalid:!!o.startDate,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.startDate})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"End Date *"}),t.jsx(E.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,isInvalid:!!o.endDate,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Venue *"}),t.jsx(E.Control,{type:"text",name:"venue",value:i.venue,onChange:m,isInvalid:!!o.venue,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.venue})]})})}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Description *"}),t.jsx(E.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,isInvalid:!!o.description,disabled:n}),t.jsx(E.Control.Feedback,{type:"invalid",children:o.description})]})})}),t.jsx(oe,{className:"mb-3",children:t.jsx(F,{children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Note"}),t.jsx(E.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:m,disabled:n})]})})})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:d,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary",type:"submit",disabled:n,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},pk=({course:e,department:r})=>{const s=qe(),{courseId:a}=Jt();console.log(" InPageCourseDetail - courseId from URL params:",a),console.log(" InPageCourseDetail - course prop:",e),console.log(" InPageCourseDetail - department prop:",r);const[n,i]=b.useState(!1),[l,o]=b.useState(!1),[c,d]=b.useState(!1),[m,u]=b.useState(!1),[h,p]=b.useState(null),[x,f]=b.useState(!1),[g,v]=b.useState(null),[N,j]=b.useState([]),[S,C]=b.useState(!0),[w,y]=b.useState("course-info");b.useEffect(()=>{a&&(async()=>{if(!a){console.log(" No courseId provided, skipping API call");return}console.log(" Starting to load course details for courseId:",a),C(!0);try{console.log(" Calling API: courseAPI.getCourseById(",a,")");const K=await Ss.getCourseById(a);if(console.log(" API Response received:",K),console.log(" Response keys:",Object.keys(K||{})),!K)throw console.error(" API returned null/undefined response"),new Error("Invalid API response");const H={name:K.name,code:K.code,description:K.description,maxTrainees:K.maxNumTrainee,venue:K.venue,note:K.note,passScore:K.passScore,startDate:K.startDate?new Date(K.startDate).toISOString().split("T")[0]:"N/A",endDate:K.endDate?new Date(K.endDate).toISOString().split("T")[0]:"N/A",level:K.level,status:K.status,department:K.department,subjectCount:K.subjectCount||0,traineeCount:K.traineeCount||0,trainerCount:K.trainerCount||0};v(H),console.log(" Checking for subjects in response..."),console.log(" response.subjects:",K.subjects),console.log(" response.subjects type:",typeof K.subjects),console.log(" response.subjects isArray?:",Array.isArray(K.subjects)),console.log(" response.subjectCount:",K.subjectCount),K.subjects&&Array.isArray(K.subjects)?(console.log(" Found subjects array with",K.subjects.length,"subjects"),console.log(" First subject sample:",K.subjects[0]),j(K.subjects)):K.subjectCount>0&&!K.subjects?(console.warn(" subjectCount > 0 but subjects array not found in response. Response structure:",K),j([])):(console.log(" No subjects in course (subjectCount:",K.subjectCount,")"),j([])),C(!1)}catch(K){if(console.error("Error loading course details:",K),e&&e.id&&e.name){console.log(" Using course prop data as fallback (API failed):",e);const H={name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"N/A",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"N/A",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||r,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0};v(H),j([])}else console.warn(" Course not found and no course prop available"),v(null),j([]);C(!1)}})()},[a,e,r]);const T=()=>{r?.id?s(`/academic/course/${r.id}`):s("/academic/departments")};if(S)return t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!g)return t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h5",{className:"text-muted",children:"Course not found"}),t.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),t.jsxs(se,{variant:"primary",onClick:T,children:[t.jsx(bt,{className:"me-2"}),"Back to Department"]})]})});const k=Y=>{s(`/academic/course/${a}/subject/${Y}`)},P=()=>{},A=Y=>{const K=N.find(H=>H.id===Y);K&&(p(K),u(!0))},_=async()=>{if(h){f(!0);try{await Os.archiveSubject(h.id);const Y=await Ss.getCourseById(a);Y.subjects&&Array.isArray(Y.subjects)&&j(Y.subjects),u(!1),p(null)}catch(Y){console.error("Error archiving subject:",Y)}finally{f(!1)}}},U=()=>{s(`/academic/course/${e.id}/enroll-trainees`)},D=async Y=>{try{await Os.createSubject({...Y,courseId:a});const K=await Ss.getCourseById(a);K.subjects&&Array.isArray(K.subjects)&&j(K.subjects),i(!1)}catch(K){console.error("Error adding subject:",K)}},W=async Y=>{try{await Os.bulkImportSubjects(Y);const K=await Ss.getCourseById(a);K.subjects&&Array.isArray(K.subjects)&&j(K.subjects),o(!1)}catch(K){console.error("Error bulk importing subjects:",K)}},q=async Y=>{try{await Ss.updateCourse(a,Y);const K=await Ss.getCourseById(a),H={name:K.name,code:K.code,description:K.description,maxTrainees:K.maxNumTrainee,venue:K.venue,note:K.note,passScore:K.passScore,startDate:K.startDate?new Date(K.startDate).toISOString().split("T")[0]:"N/A",endDate:K.endDate?new Date(K.endDate).toISOString().split("T")[0]:"N/A",level:K.level,status:K.status,department:K.department,subjectCount:K.subjectCount||0,traineeCount:K.traineeCount||0,trainerCount:K.trainerCount||0,subjects:K.subjects||[]};v(H),d(!1)}catch(K){console.error("Error updating course:",K)}};return t.jsxs(Ee,{fluid:!0,className:"py-2 course-detail",children:[t.jsxs("div",{className:"d-flex align-items-center mb-2",children:[t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:T,className:"me-3",children:[t.jsx(bt,{size:16,className:"me-1"}),"Back"]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"mb-0 text-primary",children:[t.jsx("strong",{children:e.name}),"  ",e.code]}),t.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("div",{className:"d-flex",children:t.jsxs(se,{size:"sm",variant:"primary",onClick:U,children:[t.jsx(rs,{size:14,className:"me-1"})," Enroll Trainees"]})}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsxs(se,{size:"sm",variant:"outline-secondary",onClick:()=>d(!0),children:[t.jsx(bs,{size:14,className:"me-1"})," Edit Course"]}),t.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),t.jsxs(se,{size:"sm",variant:"primary",onClick:()=>i(!0),children:[t.jsx(ks,{size:14,className:"me-1"})," Add Subject"]}),t.jsxs(se,{size:"sm",variant:"outline-primary",onClick:()=>o(!0),children:[t.jsx(Hs,{size:14,className:"me-1"})," Import Bulk Subjects"]})]})]}),t.jsx(R,{className:"border-0 shadow-sm mb-2",children:t.jsxs(qt.Container,{activeKey:w,onSelect:y,children:[t.jsx(R.Header,{className:"border-bottom py-2 bg-primary",children:t.jsxs(Et,{variant:"tabs",className:"border-0",children:[t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:w==="course-info"?"600":"400",opacity:w==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[t.jsx(it,{className:"me-2",size:16}),"Course Information"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:w==="subjects"?"600":"400",opacity:w==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[t.jsx($s,{className:"me-2",size:16}),"Subjects"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:w==="trainees"?"600":"400",opacity:w==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[t.jsx(rs,{className:"me-2",size:16}),"Trainees Roster"]})})]})}),t.jsx(R.Body,{className:"p-0",children:t.jsxs(qt.Content,{children:[t.jsx(qt.Pane,{eventKey:"course-info",children:t.jsx("div",{className:"p-4",children:t.jsxs(oe,{className:"g-4",children:[t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Course Name"}),t.jsx("p",{className:"mb-0 fw-semibold",children:g.name})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Course Code"}),t.jsx(Te,{bg:"secondary",className:"px-2 py-1",children:g.code})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Description"}),t.jsx("p",{className:"mb-0 text-muted small",children:g.description})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Level"}),t.jsx(Te,{bg:"info",className:"px-2 py-1",children:g.level})]})]}),t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Max Number of Trainees"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Ls,{size:16,className:"me-2 text-primary"}),t.jsx("span",{className:"fw-semibold",children:g.maxTrainees})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Venue"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Vn,{size:16,className:"me-2 text-primary"}),t.jsx("span",{className:"fw-semibold",children:g.venue})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Pass Score"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Wn,{size:16,className:"me-2 text-primary"}),t.jsxs("span",{className:"fw-semibold",children:[g.passScore,"%"]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Status"}),t.jsx(Te,{bg:g.status==="ACTIVE"?"success":g.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:g.status})]})]}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"Start Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-primary"}),t.jsx("span",{className:"fw-semibold",children:g.startDate})]})]})}),t.jsx(F,{md:6,children:t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-muted mb-2",children:"End Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-primary"}),t.jsx("span",{className:"fw-semibold",children:g.endDate})]})]})})]})})}),t.jsx(qt.Pane,{eventKey:"subjects",children:t.jsx(ok,{subjects:N,loading:!1,onView:k,onEdit:P,onDelete:A})}),t.jsx(qt.Pane,{eventKey:"trainees",style:{height:"100%"},children:t.jsx(uk,{course:e,loading:!1,onView:Y=>{console.log("View trainee:",Y)},onRemove:Y=>{console.log("Remove trainee:",Y)}})})]})})]})}),t.jsx(hk,{show:n,onClose:()=>i(!1),onSave:D,courseId:a}),t.jsx(fk,{show:l,onClose:()=>o(!1),onImport:W,courseId:a}),t.jsx(xk,{show:c,onClose:()=>d(!1),onSave:q,course:e}),t.jsx(bf,{show:m,onClose:()=>{u(!1),p(null)},onDisable:_,subject:h,loading:x})]})},gk=()=>{const{courseId:e}=Jt(),r=wa(),[s,a]=b.useState(null),[n,i]=b.useState(null),[l,o]=b.useState(!0);return b.useEffect(()=>{e&&(async()=>{try{o(!0);try{const d=await Ss.getCourseById(e);a(d),d.department&&i(d.department)}catch{const m={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},u={id:r.state?.departmentId||null,name:r.state?.departmentName||"Default Department"};a(m),i(u)}o(!1)}catch{o(!1)}})()},[e]),l?t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):s?t.jsx(Ee,{className:"py-3",children:t.jsx(pk,{course:s,department:n})}):t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("h4",{children:"Course not found"}),t.jsx("p",{children:"The requested course could not be found."})]})})},vk=({selectedSubjects:e,onSelectionChange:r})=>{const[s,a]=b.useState(""),[n,i]=b.useState([]),[l,o]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{o(!0),d(null);const f=await Os.getSubjects();if(f&&f.subjects){const g=f.subjects.map(v=>({id:v.id,name:v.name,code:v.code}));i(g)}else i([])}catch{d("Failed to load subjects"),i([])}finally{o(!1)}})()},[]);const m=n.filter(x=>x.name.toLowerCase().includes(s.toLowerCase())||x.code.toLowerCase().includes(s.toLowerCase())),u=()=>{e.length===m.length?r([]):r(m.map(x=>x.id))},h=x=>{e.includes(x)?r(e.filter(f=>f!==x)):r([...e,x])},p=m.length>0&&e.length===m.length;return t.jsxs(R,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[t.jsx(R.Header,{className:"bg-gradient-primary-custom text-white border-0",children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),t.jsx(se,{variant:"outline-light",size:"sm",onClick:u,children:p?"Deselect All":"Select All"})]})}),t.jsxs(R.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[t.jsx("div",{className:"p-2 border-bottom",children:t.jsx(E.Control,{type:"text",placeholder:"Search subjects...",value:s,onChange:x=>a(x.target.value),size:"sm"})}),t.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0},children:l?t.jsxs("div",{className:"p-3 text-center",children:[t.jsx(St,{animation:"border",size:"sm",className:"me-2"}),t.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?t.jsx("div",{className:"p-3 text-center text-danger",children:t.jsx("p",{className:"mb-0",children:c})}):m.length===0?t.jsx("div",{className:"p-3 text-center text-muted",children:t.jsx("p",{className:"mb-0",children:"No subjects found"})}):m.map(x=>t.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>h(x.id),children:[t.jsx("div",{className:"me-3",children:e.includes(x.id)?t.jsx(f0,{size:20,className:"text-primary"}):t.jsx(E0,{size:20,className:"text-muted"})}),t.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[t.jsx("div",{className:"fw-semibold text-truncate",title:x.name,children:x.name}),t.jsx("small",{className:"text-muted text-truncate d-block",title:x.code,children:x.code})]})]},x.id))}),t.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:t.jsxs("small",{className:"text-muted",children:[e.length," of ",m.length," subjects selected"]})})]})]})},bk=({selectedTrainees:e,onSelectionChange:r})=>{const[s,a]=b.useState(""),[n,i]=b.useState(!1),[l,o]=b.useState([]),[c,d]=b.useState(!1),[m,u]=b.useState(null),h=b.useRef(null);b.useEffect(()=>{p()},[]),b.useEffect(()=>{const v=N=>{h.current&&!h.current.contains(N.target)&&i(!1)};return n&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[n]);const p=async()=>{d(!0),u(null);try{const v=await En.getTraineesForEnrollment();if(v&&v.data){const N=v.data.map(j=>({id:j.id,eid:j.eid,name:`${j.firstName} ${j.lastName}`.trim(),firstName:j.firstName,lastName:j.lastName,email:j.email,status:j.status}));o(N)}else o([])}catch{u("Failed to load trainees"),o([])}finally{d(!1)}},x=l.filter(v=>v.name.toLowerCase().includes(s.toLowerCase())||v.eid.toLowerCase().includes(s.toLowerCase())),f=v=>{e.find(N=>N.id===v.id)||r([...e,v])},g=v=>{r(e.filter(N=>N.id!==v))};return t.jsxs(R,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[t.jsx(R.Header,{className:"bg-gradient-primary-custom text-white border-0",children:t.jsx("div",{className:"d-flex justify-content-between align-items-center",children:t.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),t.jsxs(R.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[t.jsxs("div",{className:"flex-shrink-0",style:{position:"relative"},ref:h,children:[t.jsx("div",{className:"p-2 border-bottom",children:t.jsx(E.Control,{type:"text",placeholder:"Search by EID or name...",value:s,onChange:v=>a(v.target.value),size:"sm"})}),t.jsx("div",{className:"p-2",children:t.jsxs(se,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!n),disabled:c,children:[t.jsxs("span",{children:[t.jsx(rs,{className:"me-2",size:16}),c?"Loading...":`Show All Available Trainees (${l.length})`]}),t.jsx(Cr,{size:16})]})}),n&&t.jsx("div",{className:"border bg-white shadow-sm",style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1050,maxHeight:"200px",overflowY:"auto",borderRadius:"0 0 8px 8px"},children:c?t.jsxs("div",{className:"p-3 text-center",children:[t.jsx(St,{animation:"border",size:"sm",className:"me-2"}),t.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):m?t.jsxs("div",{className:"p-3 text-center text-danger",children:[t.jsx("p",{className:"mb-0",children:m}),t.jsx(se,{size:"sm",variant:"outline-danger",onClick:p,className:"mt-2",children:"Retry"})]}):x.length===0?t.jsx("div",{className:"p-3 text-center text-muted",children:t.jsx("p",{className:"mb-0",children:"No trainees found"})}):x.map(v=>t.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>f(v),children:[t.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[t.jsx("div",{className:"fw-semibold text-truncate",title:v.name,children:v.name}),t.jsx("small",{className:"text-muted text-truncate d-block",title:v.eid,children:v.eid})]}),t.jsx(ks,{size:14,className:"text-primary flex-shrink-0"})]},v.id))})]}),t.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0},children:[t.jsx("div",{className:"p-2 bg-light border-bottom",children:t.jsxs("small",{className:"text-muted fw-semibold",children:["Selected Trainees (",e.length,")"]})}),t.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?t.jsx("div",{className:"p-3 text-center text-muted",children:t.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(v=>t.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0},children:[t.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[t.jsx("div",{className:"fw-semibold text-truncate",title:v.name,children:v.name}),t.jsx("small",{className:"text-muted text-truncate d-block",title:v.eid,children:v.eid})]}),t.jsx(se,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>g(v.id),children:t.jsx(Ge,{size:14})})]},v.id))})]})]})]})},jk=({trainee:e,onViewSubjects:r,onRemoveTrainee:s})=>t.jsx(Ht,{permissions:[be.SUBJECTS.VIEW_DETAIL,be.SUBJECTS.DELETE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Subject List",icon:t.jsx(xt,{}),onClick:()=>r(e),permission:be.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:t.jsx(Zr,{}),className:"text-danger",onClick:()=>s(e.id),permission:be.SUBJECTS.DELETE}]})}),yk=({show:e,onClose:r,onConfirm:s,trainee:a,subjectName:n=null,loading:i=!1})=>{const l=!n,o=l?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=l?"Remove from All Subjects":"Remove from Subject",d=()=>{s(),r()};return t.jsxs(le,{show:e,onHide:r,centered:!0,children:[t.jsx(le.Header,{className:"bg-danger text-white border-0",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Wt,{className:"me-2",size:20}),o]})}),t.jsxs(le.Body,{className:"p-4",children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",t.jsxs("strong",{children:['"',a?.name,'"']}),l?" from ALL subjects":` from "${n}"`,"?"]}),t.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[t.jsx("strong",{children:"Trainee:"})," ",a?.name,t.jsx("br",{}),t.jsx("strong",{children:"EID:"})," ",a?.eid,!l&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("strong",{children:"Subject:"})," ",n]})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"text-danger mb-2",children:[t.jsx("strong",{children:"Warning:"})," This action will:"]}),t.jsxs("ul",{className:"text-danger mb-3",children:[l?t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),t.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),t.jsx("li",{children:"Remove the trainee from the course completely"})]}):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Remove the trainee from this specific subject only"}),t.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),t.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),t.jsx("li",{children:t.jsx("strong",{children:"Cannot be undone"})})]})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsx(se,{variant:"outline-secondary",onClick:r,disabled:i,children:"Cancel"}),t.jsx(se,{variant:"danger",onClick:d,disabled:i,children:i?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Zr,{className:"me-2",size:16}),c]})})]})]})},Nk=({courseId:e,loading:r=!1})=>{const[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(!1),[c,d]=b.useState(null),[m,u]=b.useState(!1),[h,p]=b.useState(null),[x,f]=b.useState(null),[g,v]=b.useState(!1),{sortedData:N,sortConfig:j,handleSort:S}=Ot(s),C=b.useCallback(async()=>{i(!0);try{const _=await En.getTraineesForEnrollment();if(!_||!_.data){a([]);return}const U=[];for(const D of _.data)try{const W=await Ss.getTraineeEnrollments(D.id);if(W&&W.enrollments&&W.enrollments.length>0){const q=W.enrollments.filter(Y=>Y.enrollment?.status==="ENROLLED");if(q.length>0){const Y=q.map(H=>H.subject.id),K={id:D.id,eid:D.eid,name:`${D.firstName} ${D.lastName}`.trim(),subjects:Y,userId:D.id,email:D.email,department:D.department};U.push(K)}}}catch{}a(U)}catch{a([])}finally{i(!1)}},[]);b.useEffect(()=>{e&&C()},[e,C]);const w=async _=>{try{const U=await Ss.getTraineeEnrollments(_.userId),D=U.enrollments?.filter(q=>q.enrollment?.status==="ENROLLED")||[],W={..._,enrollmentDetails:U,subjects:D.map(q=>({id:q.subject.id,name:q.subject.name,code:q.subject.code,status:q.subject.status,type:q.subject.type,method:q.subject.method,startDate:q.subject.startDate,endDate:q.subject.endDate,course:q.subject.course,enrollment:q.enrollment}))};d(W),o(!0)}catch{d(_),o(!0)}},y=_=>{const U=s.find(D=>D.id===_);U&&(p(U),f(null),u(!0))},T=async()=>{if(h){v(!0);try{const _=await Ss.getTraineeEnrollments(h.userId);if(_&&_.enrollments&&_.enrollments.length>0){const D=_.enrollments.map(async W=>{const q=W.subject.id,Y=W.enrollment?.batchCode||"TEST0012025";return W.enrollment?.status!=="ENROLLED"?null:Os.removeTraineeFromSubject(q,h.userId,Y)}).filter(W=>W!==null);D.length>0&&await Promise.all(D),await C(),u(!1)}else u(!1)}catch{}finally{v(!1)}}},k=(_,U)=>{const D=s.find(Y=>Y.id===_);if(!D)return;const W=c?.subjects?.find(Y=>Y.id===U),q=W?W.name:"Unknown Subject";p(D),f(q),u(!0)},P=async()=>{if(!h||!x)return;const _=c?.subjects?.find(U=>U.name===x);if(_){v(!0);try{const U=_.enrollment?.batchCode||"TEST0012025";if(_.enrollment?.status!=="ENROLLED")return;await Os.removeTraineeFromSubject(_.id,h.userId,U),await C(),u(!1),o(!1)}catch{}finally{v(!1)}}};if(r||n)return t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsx("h6",{className:"mb-0",children:"Enrolled Trainees"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(It,{rows:4,columns:4})})]});if(s.length===0)return t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsx("h6",{className:"mb-0",children:"Enrolled Trainees (0)"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No enrolled trainees"}),t.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})})})]});const A=({columnKey:_,children:U,className:D=""})=>{const W=j.key===_,q=W?j.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${D} ${W?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>S(_),onMouseEnter:Y=>{Y.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",Y.target.style.transform="translateY(-1px)",Y.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:Y=>{Y.target.style.backgroundColor="transparent",Y.target.style.transform="translateY(0)",Y.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:W?"700":"600"},children:U}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:q,size:14})})]}),W&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs(t.Fragment,{children:[t.jsxs(R,{className:"d-flex flex-column mb-5",style:{height:"400px",marginBottom:"2rem",marginTop:"12rem"},children:[t.jsx(R.Header,{className:"bg-white border-bottom",style:{flexShrink:0},children:t.jsxs("h6",{className:"mb-0",children:["Enrolled Trainees (",s.length,")"]})}),t.jsx(R.Body,{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",overflowY:"auto"},children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[t.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:t.jsxs("tr",{children:[t.jsx(A,{columnKey:"name",className:"show-mobile",children:"Trainee"}),t.jsx(A,{columnKey:"eid",className:"show-mobile",children:"EID"}),t.jsx(A,{columnKey:"subjects",className:"show-mobile",children:"Subjects"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:N.map(_=>t.jsxs("tr",{children:[t.jsx("td",{className:"show-mobile",children:t.jsx("div",{className:"fw-semibold text-primary-custom",children:_.name})}),t.jsx("td",{className:"show-mobile",children:t.jsx(Te,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:_.eid})}),t.jsx("td",{className:"show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{size:14,className:"me-1 text-muted"}),t.jsxs(Te,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[_.subjects.length," subjects"]})]})}),t.jsx("td",{className:"text-center show-mobile",children:t.jsx(jk,{trainee:_,onViewSubjects:w,onRemoveTrainee:y})})]},_.id))})]})})})]}),t.jsxs(le,{show:l,onHide:()=>o(!1),size:"lg",children:[t.jsx(le.Header,{closeButton:!0,className:"border-bottom",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(rs,{className:"me-2",size:20}),c?.name," - Enrolled Subjects"]})}),t.jsx(le.Body,{className:"p-4",children:c&&t.jsxs("div",{children:[t.jsx("div",{className:"mb-4 p-3 bg-light rounded",children:t.jsxs("div",{className:"row align-items-center",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsx("h6",{className:"mb-1 text-primary",children:"Trainee Information"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Te,{bg:"secondary",className:"me-2",children:"EID"}),t.jsx("span",{className:"fw-semibold",children:c.eid})]})]}),t.jsx("div",{className:"col-md-6 text-md-end",children:t.jsx("div",{className:"text-muted small",children:t.jsxs("div",{children:["Total Subjects: ",t.jsx(Te,{bg:"info",children:c.subjects.length})]})})})]})}),t.jsx("div",{className:"row g-3",children:c.subjects.map(_=>t.jsx("div",{className:"col-12",children:t.jsx(R,{className:"border-0 shadow-sm",children:t.jsx(R.Body,{className:"p-3",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-8",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 text-dark",children:_.name}),t.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[t.jsx(Te,{bg:"outline-secondary",className:"text-dark border",children:_.code}),t.jsx(Te,{bg:_.status==="ACTIVE"?"success":"secondary",children:_.status})]})]}),t.jsx(se,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{k(c.id,_.id)},children:t.jsx(Ge,{size:14})})]}),t.jsxs("div",{className:"row g-2 mb-3",children:[t.jsx("div",{className:"col-sm-6",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("span",{className:"text-muted small me-2",children:"Type:"}),t.jsx(Te,{bg:"outline-primary",className:"text-primary border",children:_.type})]})}),t.jsx("div",{className:"col-sm-6",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("span",{className:"text-muted small me-2",children:"Method:"}),t.jsx(Te,{bg:"outline-info",className:"text-info border",children:_.method})]})})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("span",{className:"text-muted small me-2",children:"Course:"}),t.jsx("span",{className:"fw-medium",children:_.course?.name})]})]}),_.enrollment&&t.jsx("div",{className:"col-md-4",children:t.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[t.jsx("h6",{className:"text-primary mb-2",children:"Enrollment Details"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"text-muted small",children:"Status:"}),t.jsx(Te,{bg:"info",children:_.enrollment.status})]}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"text-muted small",children:"Batch:"}),t.jsx("span",{className:"fw-medium small",children:_.enrollment.batchCode})]}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"text-muted small",children:"Enrolled:"}),t.jsx("span",{className:"fw-medium small",children:new Date(_.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},_.id))})]})}),t.jsx(le.Footer,{className:"border-top",children:t.jsx(se,{variant:"secondary",onClick:()=>o(!1),children:"Close"})})]}),t.jsx(yk,{show:m,onClose:()=>{u(!1),p(null),f(null),v(!1)},onConfirm:x?P:T,trainee:h,subjectName:x,loading:g})]})},wk=({show:e,onClose:r,onImport:s,loading:a=!1})=>{const[n,i]=b.useState(!1),[l,o]=b.useState(null),[c,d]=b.useState([]),[m,u]=b.useState(null),[h,p]=b.useState([]),[x,f]=b.useState([]),[g,v]=b.useState([]),[N,j]=b.useState(!1),S=b.useRef(null),C=["eid","email"],w=K=>{K.preventDefault(),K.stopPropagation(),K.type==="dragenter"||K.type==="dragover"?i(!0):K.type==="dragleave"&&i(!1)},y=K=>{K.preventDefault(),K.stopPropagation(),i(!1),K.dataTransfer.files&&K.dataTransfer.files[0]&&k(K.dataTransfer.files[0])},T=K=>{K.target.files&&K.target.files[0]&&k(K.target.files[0])},k=K=>{if(!K.name.match(/\.(xlsx|xls)$/)){f(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(K.size>100*1024*1024){f(["File size must be less than 100MB"]);return}o(K),f([]),P(K)},P=K=>{const H=new FileReader;H.onload=je=>{try{const ie=new Uint8Array(je.target.result),B=$n(ie,{type:"array"}),V=B.SheetNames[0],z=B.Sheets[V],L=lr.sheet_to_json(z,{header:1});if(L.length<2){f(["Excel file must contain at least a header row and one data row"]);return}const te=L[0].map(re=>re?.toString().toLowerCase().trim()),ne=L.slice(1),ue=C.filter(re=>!te.includes(re));if(ue.length>0){f([`Missing required columns: ${ue.join(", ")}`]);return}const ae=ne.map((re,M)=>{const _e=re[te.indexOf("eid")]?.toString().trim()||"",ke=re[te.indexOf("email")]?.toString().trim()||"";return{id:`temp_${M}`,rowNumber:M+2,eid:_e,email:ke,hasError:!1,errors:[]}}).filter(re=>re.eid||re.email).map(re=>(re.eid||(re.hasError=!0,re.errors.push("EID is required")),re.email?/\S+@\S+\.\S+/.test(re.email)||(re.hasError=!0,re.errors.push("Email format is invalid")):(re.hasError=!0,re.errors.push("Email is required")),re));d(ae),v([])}catch{f(["Failed to parse Excel file. Please check the file format."])}},H.readAsArrayBuffer(K)},A=async()=>{const K=c.filter(H=>!H.hasError);if(K.length===0){f(["No valid identifiers to lookup"]);return}j(!0),f([]);try{const H=K.map(L=>({eid:L.eid,email:L.email}));console.log("Sending lookup request with identifiers:",H);const je=await En.lookupTrainees(H);console.log("Lookup response:",je),console.log("Found users:",je.foundUsers),console.log("Not found:",je.notFoundIdentifiers),je.foundUsers&&je.foundUsers.length>0&&(console.log(" First found user structure:",je.foundUsers[0]),console.log(" All found user IDs:",je.foundUsers.map(L=>({id:L.id,eid:L.eid,email:L.email}))));const ie=(je.foundUsers||[]).filter(L=>H.some(te=>te.eid===L.eid&&te.email===L.email)),B=H.filter(L=>!ie.some(te=>te.eid===L.eid&&te.email===L.email)),V=ie.map(L=>{if(console.log(" Validating trainee:",{id:L.id,eid:L.eid,email:L.email,firstName:L.firstName,lastName:L.lastName}),!L.id||typeof L.id!="string"||L.id.length<10)throw new Error(`Trainee ${L.eid} has invalid UUID: ${L.id}`);if(!L.firstName||!L.lastName)throw new Error(`Trainee ${L.eid} has missing name fields`);return L}),z={foundUsers:V,notFoundIdentifiers:B,uploadedIdentifiers:H};console.log("Exact matches found:",V),console.log("Not found identifiers:",B),u(z),p(V),console.log("Set selected trainees (exact matches only):",V)}catch(H){console.error("Lookup error:",H),console.error("Error response:",H.response?.data),f([H.response?.data?.message||H.message||"Failed to lookup trainees. Please try again."])}finally{j(!1)}},_=(K,H)=>{p(H?je=>[...je,K]:je=>je.filter(ie=>ie.id!==K.id))},U=K=>{p(K?m?.foundUsers||[]:[])},D=async()=>{if(h.length===0){f(["Please select at least one trainee to import"]);return}try{s&&await s(h),W()}catch(K){f([K.message||"Failed to import selected trainees. Please try again."])}},W=()=>{o(null),d([]),u(null),p([]),f([]),v([]),i(!1),j(!1),r()},q=K=>K==="valid"?t.jsx(rt,{className:"text-success",size:16}):t.jsx(Ms,{className:"text-danger",size:16}),Y=()=>{const K=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","jane.smith@example.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],H=lr.book_new(),je=lr.aoa_to_sheet(K);je["!cols"]=[{wch:15},{wch:30}],lr.book_append_sheet(H,je,"Trainees Lookup Template"),ud(H,"Trainees_Lookup_Template.xlsx")};return t.jsxs(le,{show:e,onHide:W,size:"xl",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-2",size:20}),"Bulk Import Trainees"]}),t.jsx(se,{variant:"link",onClick:W,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[x.length>0&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:t.jsx("ul",{className:"mb-0",children:x.map((K,H)=>t.jsx("li",{children:K},H))})}),t.jsx(R,{className:"mb-4",children:t.jsxs(R.Body,{children:[t.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:y,onClick:()=>S.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[t.jsx(Ha,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),t.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),t.jsx("input",{ref:S,type:"file",accept:".xlsx,.xls",onChange:T,style:{display:"none"}})]}),t.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[t.jsxs("div",{children:[t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Required columns:"})," eid, email"]}),t.jsx("div",{className:"mt-1",children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:Y,className:"d-flex align-items-center",children:[t.jsx(qr,{className:"me-1",size:14}),"Download Template"]})})]}),l&&t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Ha,{className:"text-success me-2",size:16}),t.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})}),c.length>0&&t.jsxs(R,{className:"mb-4",children:[t.jsx(R.Header,{className:"bg-light",children:t.jsxs("h6",{className:"mb-0",children:["Uploaded Identifiers (",c.length," entries)",t.jsxs("span",{className:"ms-2",children:[t.jsx(rt,{className:"text-success me-1",size:16}),c.filter(K=>!K.hasError).length," valid",t.jsx(Ms,{className:"text-danger ms-2 me-1",size:16}),c.filter(K=>K.hasError).length," invalid"]})]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:t.jsxs(gt,{hover:!0,className:"mb-0",children:[t.jsx("thead",{className:"bg-light sticky-top",children:t.jsxs("tr",{children:[t.jsx("th",{children:"Status"}),t.jsx("th",{children:"EID"}),t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Errors"})]})}),t.jsx("tbody",{children:c.map((K,H)=>t.jsxs("tr",{className:K.hasError?"table-danger":"table-success",children:[t.jsx("td",{children:q(K.hasError?"invalid":"valid")}),t.jsx("td",{children:K.eid}),t.jsx("td",{children:K.email}),t.jsx("td",{children:K.errors.length>0&&t.jsx("small",{className:"text-danger",children:K.errors.join(", ")})})]},K.id))})]})})}),t.jsx(R.Footer,{className:"bg-light",children:t.jsx(se,{variant:"primary",onClick:A,disabled:N||c.filter(K=>!K.hasError).length===0,className:"d-flex align-items-center",children:N?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Looking up..."]}):t.jsxs(t.Fragment,{children:[t.jsx(yc,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(K=>!K.hasError).length," valid)"]})})})]}),m&&t.jsxs(R,{children:[t.jsx(R.Header,{className:"bg-light",children:t.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",t.jsxs("span",{className:"ms-2",children:[t.jsx(rt,{className:"text-success me-1",size:16}),m.foundUsers?.length||0," matched",t.jsx(Ms,{className:"text-danger ms-2 me-1",size:16}),m.notFoundIdentifiers?.length||0," not found"]})]})}),t.jsx(R.Body,{className:"p-0",children:m.foundUsers?.length>0?t.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:t.jsxs(gt,{hover:!0,className:"mb-0",children:[t.jsx("thead",{className:"bg-light sticky-top",children:t.jsxs("tr",{children:[t.jsx("th",{children:t.jsx(E.Check,{type:"checkbox",checked:h.length===(m.foundUsers?.length||0)&&(m.foundUsers?.length||0)>0,onChange:K=>U(K.target.checked)})}),t.jsx("th",{children:"EID"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Phone"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Matched From Excel"})]})}),t.jsx("tbody",{children:m.foundUsers?.map(K=>m.uploadedIdentifiers?.find(je=>je.eid===K.eid&&je.email===K.email)?t.jsxs("tr",{className:h.some(je=>je.id===K.id)?"table-success":"",children:[t.jsx("td",{children:t.jsx(E.Check,{type:"checkbox",checked:h.some(je=>je.id===K.id),onChange:je=>_(K,je.target.checked)})}),t.jsx("td",{children:K.eid}),t.jsxs("td",{children:[K.firstName," ",K.lastName]}),t.jsx("td",{children:K.email}),t.jsx("td",{children:K.phoneNumber}),t.jsx("td",{children:t.jsx(Te,{bg:K.status==="ACTIVE"?"success":"secondary",children:K.status})}),t.jsx("td",{children:t.jsx(Te,{bg:"success",children:" Exact Match"})})]},K.id):null).filter(Boolean)})]})}):t.jsxs("div",{className:"p-4 text-center",children:[t.jsx(Ms,{size:48,className:"text-muted mb-3"}),t.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),t.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),m.notFoundIdentifiers?.length>0&&t.jsx(R.Footer,{className:"bg-warning bg-opacity-10",children:t.jsxs(Ae,{variant:"warning",className:"mb-0",children:[t.jsxs("strong",{children:["Identifiers Not Found in System (",m.notFoundIdentifiers.length,"):"]}),t.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),t.jsx("ul",{className:"mb-0",children:m.notFoundIdentifiers.map((K,H)=>t.jsxs("li",{children:[t.jsx("strong",{children:K.eid})," - ",K.email]},H))})]})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:W,disabled:a,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),m&&m.foundUsers?.length>0&&h.length>0&&t.jsx(se,{variant:"primary",onClick:D,disabled:a,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"me-2",size:16}),"Import Selected (",h.length," matched trainees)"]})})]})]})},Sk=({show:e,onClose:r,onConfirm:s,loading:a=!1})=>{const[n,i]=b.useState(""),[l,o]=b.useState("");b.useEffect(()=>{e&&(i(""),o(""))},[e]);const c=h=>!h||h.trim()===""?"Batch code is required":h.length<3?"Batch code must be at least 3 characters long":h.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(h)?"Batch code can only contain letters, numbers, and underscores":null,d=h=>{const p=h.target.value;i(p),l&&o("")},m=()=>{const h=c(n);if(h){o(h);return}s(n.trim())},u=h=>{h.key==="Enter"&&(h.preventDefault(),m())};return t.jsxs(le,{show:e,onHide:r,centered:!0,backdrop:"static",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsxs(le.Title,{children:[t.jsx(Wt,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),t.jsxs(le.Body,{children:[t.jsx(E,{children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsxs(E.Label,{children:["Batch Code ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:d,onKeyPress:u,isInvalid:!!l,disabled:a,autoFocus:!0}),t.jsx(E.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),l&&t.jsx(E.Control.Feedback,{type:"invalid",children:l})]})}),t.jsx(Ae,{variant:"info",className:"mb-0",children:t.jsxs("small",{children:[t.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"secondary",onClick:r,disabled:a,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:m,disabled:a||!n.trim(),children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},Tk=()=>{const e=qe(),{courseId:r}=Jt(),s={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[a,n]=b.useState([]),[i,l]=b.useState([]),[o,c]=b.useState(!1),[d,m]=b.useState(!1),[u,h]=b.useState(!1),[p,x]=b.useState(!1),[f,g]=b.useState(0),v=()=>{e(`/academic/course-detail/${r}`)},N=()=>{c(!0)},j=async w=>{if(u){console.log(" Bulk import already in progress, skipping...");return}h(!0);try{console.log(" Bulk import trainees received:",w);const y=w.map(T=>(console.log(" Processing bulk import trainee:",{id:T.id,eid:T.eid,firstName:T.firstName,lastName:T.lastName}),{id:T.id,eid:T.eid,name:`${T.firstName} ${T.lastName}`.trim(),firstName:T.firstName,lastName:T.lastName,email:T.email,phoneNumber:T.phoneNumber,status:T.status,subjects:[]}));console.log(" New trainees to add:",y),l(T=>{const k=new Set(T.map(A=>A.id)),P=y.filter(A=>!k.has(A.id));return console.log(" Existing trainee IDs:",Array.from(k)),console.log(" New unique trainees to add:",P),console.log(" Duplicates filtered out:",y.length-P.length),P.length===0&&y.length>0?setTimeout(()=>{de.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):P.length<y.length&&P.length>0&&setTimeout(()=>{de.warning(`Added ${P.length} new trainees. ${y.length-P.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100),[...T,...P]}),await new Promise(T=>setTimeout(T,1e3))}catch(y){throw y}finally{h(!1)}},S=()=>{if(a.length===0||i.length===0){de.warning("Please select both subjects and trainees to enroll");return}m(!0)},C=async w=>{x(!0),m(!1);try{console.log(" Selected trainees for enrollment:",i),console.log(" Using batch code:",w);const y={batchCode:w,traineeUserIds:i.map(P=>{if(console.log(" Processing trainee:",{id:P.id,eid:P.eid,name:`${P.firstName} ${P.lastName}`}),!P.id)throw new Error(`Trainee ${P.eid} (${P.firstName} ${P.lastName}) is missing UUID`);return P.id})};console.log(" Final trainee data for API:",y),console.log(" Note: Server will validate for duplicate enrollments");const T=a.map(async P=>{if(!P)throw new Error(`Invalid subject ID: ${P}`);const A=await Os.assignTrainees(P,y);return{subjectId:P,response:A}}),k=await Promise.all(T);console.log(" All enrollments completed successfully:",k),g(P=>P+1),l([]),n([]),de.success(`Successfully enrolled ${i.length} trainees to ${a.length} subject(s) with batch code: ${w}`)}catch(y){let T="Failed to enroll trainees. Please try again.";y.response?.data?.message?T=y.response.data.message:y.response?.data?.errors?T=`Validation errors: ${JSON.stringify(y.response.data.errors)}`:y.message&&(T=y.message),de.error(T)}finally{x(!1)}};return t.jsxs(Ee,{fluid:!0,className:"py-4 px-4 enroll-page",children:[t.jsxs("div",{className:"d-flex flex-column",children:[t.jsxs("div",{className:"flex-shrink-0 mb-3",children:[t.jsxs("div",{className:"d-flex align-items-center mb-2",children:[t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:v,className:"me-3",children:[t.jsx(bt,{size:16,className:"me-1"}),"Back"]}),t.jsx("div",{children:t.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",t.jsx("strong",{children:s.name})," (",s.code,")"]})})]}),t.jsx(R,{className:"mb-2",children:t.jsx(R.Body,{className:"py-2",children:t.jsxs(oe,{children:[t.jsx(F,{md:8,children:t.jsx("p",{className:"mb-0 text-muted",children:s.description})}),t.jsxs(F,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[t.jsx(se,{size:"sm",variant:"primary",onClick:S,disabled:a.length===0||i.length===0||p,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:p?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):t.jsxs(t.Fragment,{children:[t.jsx(ks,{size:12,className:"me-1"})," Enroll"]})}),t.jsxs(se,{size:"sm",variant:"outline-primary",onClick:N,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[t.jsx(Hs,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),t.jsx("div",{className:"mb-4",children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{lg:6,children:t.jsx("div",{style:{height:"500px"},children:t.jsx(vk,{selectedSubjects:a,onSelectionChange:n})})}),t.jsx(F,{lg:6,children:t.jsx("div",{style:{height:"500px"},children:t.jsx(bk,{selectedTrainees:i,onSelectionChange:l})})})]})}),t.jsx("div",{className:"mt-4",children:t.jsx(Nk,{courseId:r,loading:!1},f)})]}),t.jsx(wk,{show:o,onClose:()=>c(!1),onImport:j,loading:u}),t.jsx(Sk,{show:d,onClose:()=>m(!1),onConfirm:C,loading:p})]})},Ek=({traineeId:e,courseId:r})=>{const s=qe(),[a,n]=b.useState([]),[i,l]=b.useState(!0);b.useEffect(()=>{e&&r&&o()},[e,r]);const o=async()=>{try{l(!0);const u=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(h=>setTimeout(h,300)),n(u)}catch(u){console.error("Error loading trainee subjects:",u),de.error("Failed to load subjects")}finally{l(!1)}},c=u=>{const p={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[u]||{variant:"secondary",text:u};return t.jsx(Te,{bg:p.variant,children:p.text})},d=u=>{const p={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[u]||{variant:"secondary",text:u};return t.jsx(Te,{bg:p.variant,children:p.text})},m=u=>{s(`/trainee/${e}/course/${r}/subject/${u}`)};return i?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(St,{animation:"border",variant:"primary",size:"sm"}),t.jsx("p",{className:"mt-2 text-muted small",children:"Loading subjects..."})]}):a.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(it,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No subjects found"})]}):t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Code"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Name"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Level"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Duration"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Method"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Progress"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:a.map((u,h)=>t.jsxs("tr",{className:`${h%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor=h%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx(Te,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:u.code})}),t.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[t.jsx("div",{className:"fw-medium text-dark",children:u.name}),t.jsx("small",{className:"text-muted",children:u.description})]}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(u.level)}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsxs("span",{className:"text-dark",children:[u.duration," hours"]})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx(Te,{bg:"info",className:"fw-normal",children:u.method||"Classroom"})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(u.status)}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${u.progress||0}%`}})}),t.jsxs("small",{className:"text-muted",children:[u.progress||0,"%"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>m(u.id),children:t.jsx(xt,{size:14})})})]},u.id))})]})})},jf=({traineeId:e,courseId:r})=>{const s=qe(),[a,n]=b.useState([]),[i,l]=b.useState(!0);b.useEffect(()=>{e&&o()},[e,r]);const o=async()=>{try{l(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(u){console.error("Error loading upcoming assessments:",u),de.error("Failed to load upcoming assessments")}finally{l(!1)}},c=u=>{const p={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[u]||{variant:"secondary",text:u};return t.jsx(Te,{bg:p.variant,children:p.text})},d=u=>{const p={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[u?.toUpperCase()]||{variant:"secondary",text:u};return t.jsx(Te,{bg:p.variant,children:p.text})},m=async u=>{try{s(`/trainee/${e}/assessment/${u}?action=start`)}catch(h){console.error("Error starting assessment:",h),de.error("Failed to start assessment")}};return i?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(St,{animation:"border",variant:"primary",size:"sm"}),t.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):a.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Lt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:a.map((u,h)=>t.jsxs("tr",{className:`${h%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor=h%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("div",{className:"fw-medium text-dark",children:u.name})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("span",{className:"text-dark",children:u.subject})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(u.type)}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(u.priority)}),t.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-1",size:14}),t.jsx("span",{className:"text-dark",children:new Date(u.dueDate).toLocaleDateString()})]}),t.jsx("small",{className:"text-muted",children:new Date(u.dueDate).toLocaleTimeString()})]}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsxs(se,{variant:"primary",size:"sm",onClick:()=>m(u.id),children:[t.jsx(vt,{className:"me-1",size:14}),"Start"]})})]},u.id))})]})})},Bt=({title:e,sortKey:r,sortConfig:s,onSort:a})=>{const n=()=>{a(r)},i=()=>s.key===r?s.direction==="asc"?t.jsx(p0,{size:12,className:"ms-1"}):t.jsx(Cr,{size:12,className:"ms-1"}):t.jsx(zt,{size:12,className:"ms-1"});return t.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[t.jsx("span",{className:"me-1",children:e}),i()]})},Ck=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Ck,document.head.appendChild(e)}const pd=({traineeId:e,courseId:r,subjectId:s})=>{const a=qe(),[n,i]=b.useState([]),[l,o]=b.useState(!0),{sortedData:c,sortConfig:d,handleSort:m}=Ot(n);b.useEffect(()=>{u()},[e,r,s]);const u=async()=>{try{o(!0);let g=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];r&&(g=g.filter(v=>v.course?.code==="SAF001")),s&&(g=g.filter(v=>v.subject?.code==="BSP")),await new Promise(v=>setTimeout(v,300)),i(g)}catch(f){console.error("Error loading completed assessments:",f),de.error("Failed to load completed assessments")}finally{o(!1)}},h=f=>{const v={COMPLETED:{variant:"success",text:"Completed",icon:rt},PASSED:{variant:"success",text:"Passed",icon:rt},FAILED:{variant:"danger",text:"Failed",icon:Wt}}[f]||{variant:"secondary",text:f,icon:rt},N=v.icon;return t.jsxs(Te,{bg:v.variant,className:"d-flex align-items-center",children:[t.jsx(N,{size:12,className:"me-1"}),v.text]})},p=(f,g)=>{const v=f/g*100;let N="success";return v<60?N="danger":v<80&&(N="warning"),t.jsxs(Te,{bg:N,children:[f,"/",g," (",v.toFixed(0),"%)"]})},x=f=>{a(`/trainee/${e}/assessment/${f.id}`)};return l?t.jsx("div",{className:"text-center py-4",children:t.jsx(It,{count:5})}):n.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(rt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Assessment",sortKey:"name",sortConfig:d,onSort:m})}),!s&&t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Subject",sortKey:"subject",sortConfig:d,onSort:m})}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Type",sortKey:"type",sortConfig:d,onSort:m})}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Score",sortKey:"score",sortConfig:d,onSort:m})}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Completed Date",sortKey:"completedDate",sortConfig:d,onSort:m})}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:t.jsx(Bt,{title:"Status",sortKey:"status",sortConfig:d,onSort:m})}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:c.map((f,g)=>t.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:v=>{v.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:v=>{v.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[t.jsx("div",{className:"fw-medium text-dark",children:f.name}),t.jsx("small",{className:"text-muted",children:f.description})]}),!s&&t.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[t.jsx("div",{className:"fw-medium text-dark",children:f.subject?.name||"N/A"}),t.jsx("small",{className:"text-muted",children:f.subject?.code||""})]}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx(Te,{bg:"primary",className:"fw-normal",children:f.type||"Assessment"})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:p(f.score,f.maxScore)}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx("span",{className:"text-dark",children:f.completedDate?new Date(f.completedDate).toLocaleDateString():"N/A"})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:h(f.status)}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Results",icon:t.jsx(rt,{}),onClick:()=>x(f)}]})})]},f.id))})]})})},_k=({traineeId:e,courseId:r})=>{const s=qe(),[a,n]=b.useState(null),[i,l]=b.useState(null),[o,c]=b.useState(!0),[d,m]=b.useState("");b.useEffect(()=>{e&&r&&u()},[e,r]);const u=async()=>{try{c(!0),m(""),l({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),n({id:r,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(f){console.error("Error loading course details:",f),m("Failed to load course details"),de.error("Failed to load course details")}finally{c(!1)}},h=()=>{s("/trainee/enrolled-courses")},p=f=>{const v={ACTIVE:{variant:"success",text:"Active"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[f]||{variant:"secondary",text:f};return t.jsx(Te,{bg:v.variant,className:"fs-6",children:v.text})},x=f=>{const v={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[f]||{variant:"secondary",text:f};return t.jsx(Te,{bg:v.variant,children:v.text})};return o?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):d||!a?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:d||"Course not found"}),t.jsxs(se,{variant:"outline-danger",onClick:h,children:[t.jsx(bt,{className:"me-2",size:16}),"Back to Trainee"]})]})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:h,className:"me-3",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[t.jsx(it,{className:"me-2",size:28}),a.name]}),t.jsxs("p",{className:"text-muted mb-0",children:[a.code,"  ",i?.firstName," ",i?.lastName]})]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(a.status),x(a.level)]})]})})}),t.jsxs(oe,{children:[t.jsxs(F,{lg:8,className:"mb-4",children:[t.jsx(oe,{children:t.jsx(F,{className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(it,{className:"me-2",size:20}),"Subject List"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(Ek,{traineeId:e,courseId:r})})]})})}),t.jsx(oe,{children:t.jsx(F,{className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(jf,{traineeId:e,courseId:r})})]})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(rt,{className:"me-2",size:20}),"Completed Assessments"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(pd,{traineeId:e,courseId:r})})]})})})]}),t.jsx(F,{lg:4,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(it,{className:"me-2",size:20}),"Enrolled Course Details"]})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Start Date"}),t.jsx("div",{className:"text-muted",children:new Date(a.startDate).toLocaleDateString()})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"End Date"}),t.jsx("div",{className:"text-muted",children:new Date(a.endDate).toLocaleDateString()})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Vn,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Venue"}),t.jsx("div",{className:"text-muted",children:a.venue})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Max Trainees"}),t.jsx("div",{className:"text-muted",children:a.maxNumTrainee})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Pass Score"}),t.jsxs("div",{className:"text-muted",children:[a.passScore,"%"]})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("span",{className:"fw-semibold",children:"Progress"}),t.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),t.jsx("div",{className:"progress",children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${a.progress}%`}})})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("h6",{children:"Description"}),t.jsx("p",{className:"text-muted",children:a.description})]})]})]})})]})]})},kk=()=>{const{traineeId:e,courseId:r}=Jt();return t.jsx(Ee,{className:"py-3",children:t.jsx(_k,{traineeId:e,courseId:r})})},Ak=({traineeId:e,courseId:r,subjectId:s})=>{const a=qe(),[n,i]=b.useState(null),[l,o]=b.useState(null),[c,d]=b.useState(!0),[m,u]=b.useState("");b.useEffect(()=>{e&&r&&s&&h()},[e,r,s]);const h=async()=>{try{d(!0),u("");const g={id:s,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},v={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),o(v)}catch(g){console.error("Error loading subject details:",g),u("Failed to load subject details"),de.error("Failed to load subject details")}finally{d(!1)}},p=()=>{a(`/trainee/${e}/course/${r}`)},x=g=>{const N={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return t.jsx(Te,{bg:N.variant,className:"fs-6",children:N.text})},f=g=>{const N={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return t.jsx(Te,{bg:N.variant,children:N.text})};return c?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):m||!n?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:m||"Subject not found"}),t.jsxs(se,{variant:"outline-danger",onClick:p,children:[t.jsx(bt,{className:"me-2",size:16}),"Back to Course"]})]})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:p,className:"me-3",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[t.jsx(it,{className:"me-2",size:28}),n.name]}),t.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",l?.firstName," ",l?.lastName]})]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[x(n.status),f(n.level)]})]})})}),t.jsxs(oe,{children:[t.jsxs(F,{lg:8,className:"mb-4",children:[t.jsx(oe,{children:t.jsx(F,{className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(jf,{traineeId:e,courseId:r,subjectId:s})})]})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(rt,{className:"me-2",size:20}),"Completed Assessments"]})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(pd,{traineeId:e,courseId:r,subjectId:s})})]})})})]}),t.jsx(F,{lg:4,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(it,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Start Date"}),t.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"End Date"}),t.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Duration"}),t.jsxs("div",{className:"text-muted",children:[n.duration," hours"]})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Vn,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Room"}),t.jsx("div",{className:"text-muted",children:n.roomName})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Trainer"}),t.jsx("div",{className:"text-muted",children:n.trainer?.name})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("span",{className:"fw-semibold",children:"Progress"}),t.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),t.jsx("div",{className:"progress",children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("h6",{children:"Description"}),t.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},Dk=()=>{const{traineeId:e,courseId:r,subjectId:s}=Jt();return t.jsx(Ee,{className:"py-3",children:t.jsx(Ak,{traineeId:e,courseId:r,subjectId:s})})},Ik=({traineeId:e})=>{const r=qe(),[s,a]=b.useState(null),[n,i]=b.useState([]),[l,o]=b.useState([]),[c,d]=b.useState([]),[m,u]=b.useState(!0),[h,p]=b.useState("");b.useEffect(()=>{e&&x()},[e]);const x=async()=>{try{u(!0),p("");const w=await En.getTraineeById(e);a(w);const y=await En.getTraineeAssessments(e);i(y.assessments||y.data||[]);const T=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],k=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];o(T),d(k)}catch(w){console.error("Error loading assessment data:",w),p("Failed to load assessment data"),de.error("Failed to load assessment data")}finally{u(!1)}},f=()=>{r("/trainee/your-assessments")},g=w=>{const T={PENDING:{variant:"warning",text:"Pending",icon:et},IN_PROGRESS:{variant:"info",text:"In Progress",icon:vt},COMPLETED:{variant:"success",text:"Completed",icon:rt},OVERDUE:{variant:"danger",text:"Overdue",icon:Wt}}[w]||{variant:"secondary",text:w,icon:vt},k=T.icon;return t.jsxs(Te,{bg:T.variant,className:"d-flex align-items-center",children:[t.jsx(k,{size:12,className:"me-1"}),T.text]})},v=w=>{const T={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[w]||{variant:"secondary",text:w};return t.jsx(Te,{bg:T.variant,children:T.text})},N=w=>{r(`/trainee/${e}/assessment/${w}`)},j=w=>{r(`/trainee/${e}/assessment/${w}`)},S=w=>{r(`/trainee/${e}/signature-pad/${w}`)},C=w=>{r(`/trainee/${e}/assessment-section/${w}`)};return m?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):h||!s?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:h||"Trainee not found"}),t.jsxs(se,{variant:"outline-danger",onClick:f,children:[t.jsx(bt,{className:"me-2",size:16}),"Back to Trainee"]})]})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsx("div",{className:"d-flex justify-content-between align-items-center",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:f,className:"me-3",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:28}),"Assessment Management"]}),t.jsxs("p",{className:"text-muted mb-0",children:[s.firstName," ",s.lastName,"  ",s.eid]})]})]})})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsx(R,{className:"border-0 shadow-sm",children:t.jsx(R.Body,{className:"p-0",children:t.jsxs(gc,{defaultActiveKey:"pending",className:"border-bottom",children:[t.jsx(qt,{eventKey:"pending",title:"Pending Assessments",children:t.jsx("div",{className:"p-4",children:n.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(vt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):t.jsx("div",{className:"trainee-assessments-table",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:"Assessment"}),t.jsx("th",{className:"text-start",children:"Course"}),t.jsx("th",{className:"text-start",children:"Subject"}),t.jsx("th",{className:"text-start",children:"Type"}),t.jsx("th",{className:"text-start",children:"Priority"}),t.jsx("th",{className:"text-start",children:"Due Date"}),t.jsx("th",{className:"text-start",children:"Status"}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:n.map(w=>t.jsxs("tr",{children:[t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:w.name}),t.jsx("small",{className:"text-muted",children:w.description})]}),t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:w.course?.name||"N/A"}),t.jsx("small",{className:"text-muted",children:w.course?.code||""})]}),t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:w.subject?.name||"N/A"}),t.jsx("small",{className:"text-muted",children:w.subject?.code||""})]}),t.jsx("td",{children:t.jsx(Te,{bg:"info",className:"fw-normal",children:w.type||"Assessment"})}),t.jsx("td",{children:v(w.priority)}),t.jsx("td",{children:w.dueDate?new Date(w.dueDate).toLocaleDateString():"N/A"}),t.jsx("td",{children:g(w.status)}),t.jsx("td",{children:t.jsx("div",{className:"d-flex gap-1",children:w.status==="PENDING"||w.status==="IN_PROGRESS"?t.jsx(se,{variant:"primary",size:"sm",onClick:()=>N(w.id),children:"Start"}):t.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>j(w.id),children:"View"})})})]},w.id))})]})})})}),t.jsx(qt,{eventKey:"signature",title:"Signature Required",children:t.jsx("div",{className:"p-4",children:l.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Fr,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):t.jsx("div",{className:"trainee-assessments-table",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:"Document"}),t.jsx("th",{className:"text-start",children:"Course"}),t.jsx("th",{className:"text-start",children:"Subject"}),t.jsx("th",{className:"text-start",children:"Due Date"}),t.jsx("th",{className:"text-start",children:"Status"}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:l.map(w=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.name})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.course})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.subject})}),t.jsx("td",{children:new Date(w.dueDate).toLocaleDateString()}),t.jsx("td",{children:g(w.status)}),t.jsx("td",{children:t.jsxs(se,{variant:"primary",size:"sm",onClick:()=>S(w.id),children:[t.jsx(Fr,{className:"me-1",size:14}),"Sign"]})})]},w.id))})]})})})}),t.jsx(qt,{eventKey:"completion",title:"Section Completion",children:t.jsx("div",{className:"p-4",children:c.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(rt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):t.jsx("div",{className:"trainee-assessments-table",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:"Section"}),t.jsx("th",{className:"text-start",children:"Course"}),t.jsx("th",{className:"text-start",children:"Subject"}),t.jsx("th",{className:"text-start",children:"Type"}),t.jsx("th",{className:"text-start",children:"Due Date"}),t.jsx("th",{className:"text-start",children:"Progress"}),t.jsx("th",{className:"text-start",children:"Status"}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:c.map(w=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.name})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.course})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:w.subject})}),t.jsx("td",{children:t.jsx(Te,{bg:"info",className:"fw-normal",children:w.section})}),t.jsx("td",{children:new Date(w.dueDate).toLocaleDateString()}),t.jsx("td",{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})}),t.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),t.jsx("td",{children:g(w.status)}),t.jsx("td",{children:t.jsx(se,{variant:"primary",size:"sm",onClick:()=>C(w.id),children:w.status==="COMPLETED"?"View":"Complete"})})]},w.id))})]})})})})]})})})})})]})},Pk=()=>{const{traineeId:e}=Jt();return t.jsx(Ee,{className:"py-3",children:t.jsx(Ik,{traineeId:e})})},Rk=()=>{const{traineeId:e,assessmentId:r}=Jt(),s=qe(),[a,n]=o0(),[i,l]=b.useState(null),[o,c]=b.useState(!0),[d,m]=b.useState("");b.useEffect(()=>{r&&u()},[r]),b.useEffect(()=>{if(i&&a.get("action")==="start"){n({});const S=i.sections?.find(C=>C.status!=="COMPLETED");S&&s(`/trainee/${e}/assessment-section/${S.id}`)}},[i,a,s,e,n]);const u=async()=>{try{c(!0),m(""),l({id:r,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(S){console.error("Error loading assessment details:",S),m("Failed to load assessment details"),de.error("Failed to load assessment details")}finally{c(!1)}},h=()=>{s(-1)},p=()=>{const S=i.sections.find(C=>C.status!=="COMPLETED");S?s(`/trainee/${e}/assessment-section/${S.id}`):de.info("Starting assessment...")},x=()=>{const S=i.sections.find(C=>C.status==="IN_PROGRESS");S?s(`/trainee/${e}/assessment-section/${S.id}`):p()},f=S=>{s(`/trainee/${e}/assessment-section/${S}`)},g=()=>{s(`/trainee/${e}/signature-pad/${r}`)},v=()=>{s("/trainee/create-incident-feedback-report",{state:{assessmentId:r,assessmentName:i.name}})},N=S=>{const w={PENDING:{variant:"warning",text:"Pending",icon:et},IN_PROGRESS:{variant:"info",text:"In Progress",icon:vt},COMPLETED:{variant:"success",text:"Completed",icon:rt},OVERDUE:{variant:"danger",text:"Overdue",icon:Wt}}[S]||{variant:"secondary",text:S,icon:vt},y=w.icon;return t.jsxs(Te,{bg:w.variant,className:"d-flex align-items-center",children:[t.jsx(y,{size:12,className:"me-1"}),w.text]})},j=S=>{const w={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[S]||{variant:"secondary",text:S};return t.jsx(Te,{bg:w.variant,children:w.text})};return o?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):d||!i?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:d||"Assessment not found"}),t.jsxs(se,{variant:"outline-danger",onClick:h,children:[t.jsx(bt,{className:"me-2",size:16}),"Back"]})]})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:h,className:"me-3",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:28}),i.name]}),t.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[N(i.status),j(i.priority)]})]})})}),t.jsxs(oe,{children:[t.jsx(F,{lg:8,className:"mb-4",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsx(R.Body,{className:"p-0",children:t.jsxs(gc,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[t.jsx(qt,{eventKey:"overview",title:"Overview",children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Description"}),t.jsx("p",{className:"text-muted",children:i.description})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Instructions"}),t.jsx("ul",{className:"list-unstyled",children:i.instructions.map((S,C)=>t.jsxs("li",{className:"mb-2",children:[t.jsx("span",{className:"text-primary me-2",children:""}),S]},C))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Assessment Sections"}),t.jsx("div",{className:"row",children:i.sections.map((S,C)=>t.jsx("div",{className:"col-md-6 mb-3",children:t.jsx(R,{className:`${S.status==="COMPLETED"?"bg-light":""}`,children:t.jsxs(R.Body,{children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("span",{className:"fw-semibold",children:["Section ",C+1]}),N(S.status)]}),t.jsx("h6",{className:"mb-2",children:S.name}),t.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})}),t.jsx(se,{variant:S.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>f(S.id),children:S.status==="COMPLETED"?"View":S.status==="IN_PROGRESS"?"Continue":"Start"})]})})},S.id))})]}),t.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?t.jsxs(se,{variant:"primary",size:"lg",onClick:p,children:[t.jsx(vt,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?t.jsxs(se,{variant:"primary",size:"lg",onClick:x,children:[t.jsx(vt,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&t.jsxs(se,{variant:"outline-primary",size:"lg",onClick:g,children:[t.jsx(Fr,{className:"me-2",size:20}),"Sign Document"]})]})]})}),t.jsx(qt,{eventKey:"progress",title:"Progress",children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Overall Progress"}),t.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:t.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),t.jsxs("small",{className:"text-muted",children:[i.sections.filter(S=>S.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),t.jsx("h5",{children:"Section Progress"}),i.sections.map((S,C)=>t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("span",{className:"fw-semibold",children:["Section ",C+1,": ",S.name]}),t.jsxs("span",{className:"text-muted",children:[S.progress,"%"]})]}),t.jsx("div",{className:"progress",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})})]},S.id))]})}),i.status==="COMPLETED"&&t.jsx(qt,{eventKey:"results",title:"Results",children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Assessment Score"}),i.score!==null?t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),t.jsx("div",{children:t.jsxs(Te,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):t.jsx("p",{className:"text-muted",children:"Score pending review"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{children:"Section Results"}),i.sections?.map((S,C)=>t.jsx(R,{className:"mb-2",children:t.jsx(R.Body,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("div",{children:[t.jsxs("span",{className:"fw-semibold",children:["Section ",C+1,": ",S.name]}),t.jsx(Te,{bg:"success",className:"ms-2",children:"Completed"})]}),S.score!==void 0&&t.jsxs("div",{className:"text-end",children:[t.jsxs("div",{className:"fw-bold",children:[S.score," / ",S.maxScore||100]}),t.jsxs("small",{className:"text-muted",children:[Math.round(S.score/(S.maxScore||100)*100),"%"]})]})]})})},S.id))]})]})})]})})})}),t.jsx(F,{lg:4,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx($s,{className:"me-2",size:20}),"Assessment Information"]})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Course"}),t.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Subject"}),t.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Due Date"}),t.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Time Limit"}),t.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Score"}),t.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Completed Date"}),t.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&t.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[t.jsx("h6",{className:"mb-2",children:"Signature Required"}),t.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:g,children:[t.jsx(Fr,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&t.jsx(Te,{bg:"success",children:"Signed"})]}),t.jsx("div",{className:"mt-4",children:t.jsxs(se,{variant:"outline-secondary",className:"w-100",onClick:v,children:[t.jsx(Wt,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},Fk=({show:e,onClose:r,onSave:s,documentName:a,loading:n=!1})=>{const i=b.useRef(null),[l,o]=b.useState(!1),[c,d]=b.useState(!1),[m,u]=b.useState("");b.useEffect(()=>{e&&(d(!1),u(""),h())},[e]);const h=()=>{const N=i.current;N&&(N.getContext("2d").clearRect(0,0,N.width,N.height),d(!1))},p=N=>{o(!0);const j=i.current,S=j.getBoundingClientRect(),C=j.getContext("2d");C.beginPath(),C.moveTo(N.clientX-S.left,N.clientY-S.top)},x=N=>{if(!l)return;const j=i.current,S=j.getBoundingClientRect(),C=j.getContext("2d");C.lineTo(N.clientX-S.left,N.clientY-S.top),C.stroke(),d(!0)},f=()=>{o(!1)},g=async()=>{if(!c){u("Please provide your signature before saving");return}try{const j=i.current.toDataURL("image/png");await s({documentName:a,signature:j,timestamp:new Date().toISOString()}),r()}catch{u("Failed to save signature. Please try again.")}},v=()=>{h(),u(""),r()};return t.jsxs(le,{show:e,onHide:v,size:"lg",centered:!0,children:[t.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Fr,{className:"me-2",size:20}),"Digital Signature"]}),t.jsx(se,{variant:"link",onClick:v,className:"text-white p-0",children:t.jsx(Ge,{size:24})})]}),t.jsxs(le.Body,{className:"p-4",children:[m&&t.jsx(Ae,{variant:"danger",className:"mb-3",children:m}),t.jsxs("div",{className:"text-center mb-4",children:[t.jsxs("h5",{children:["Sign Document: ",a]}),t.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),t.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:t.jsx("canvas",{ref:i,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:p,onMouseMove:x,onMouseUp:f,onMouseLeave:f,onTouchStart:N=>{N.preventDefault();const j=N.touches[0],S=new MouseEvent("mousedown",{clientX:j.clientX,clientY:j.clientY});p(S)},onTouchMove:N=>{N.preventDefault();const j=N.touches[0],S=new MouseEvent("mousemove",{clientX:j.clientX,clientY:j.clientY});x(S)},onTouchEnd:N=>{N.preventDefault(),f()}})}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs(se,{variant:"outline-secondary",onClick:h,disabled:n,children:[t.jsx(m0,{className:"me-2",size:16}),"Clear"]}),t.jsx("div",{className:"text-muted small",children:c?t.jsx("span",{className:"text-success",children:" Signature captured"}):t.jsx("span",{children:"Please sign above"})})]}),t.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[t.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),t.jsxs("ul",{className:"mb-0 small text-muted",children:[t.jsx("li",{children:"Sign within the designated area"}),t.jsx("li",{children:"Use your full legal signature"}),t.jsx("li",{children:"Ensure the signature is clear and readable"}),t.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:v,disabled:n,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),t.jsx(se,{variant:"primary",onClick:g,disabled:n||!c,children:n?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Ok=()=>{const{traineeId:e,documentId:r}=Jt(),s=qe(),a=async i=>{try{console.log("Signature saved:",i),de.success("Signature saved successfully"),s(`/trainee/${e}/assessment/${r}`,{replace:!0})}catch(l){console.error("Error saving signature:",l),de.error("Failed to save signature")}},n=()=>{s(`/trainee/${e}/assessment/${r}`,{replace:!0})};return t.jsx(Ee,{className:"py-3",children:t.jsx(Fk,{show:!0,documentName:`Document ${r}`,onClose:n,onSave:a})})},Lk=({traineeId:e,sectionId:r})=>{const s=qe(),[a,n]=b.useState(null),[i,l]=b.useState(!0),[o,c]=b.useState("");b.useEffect(()=>{r&&d()},[r]);const d=async()=>{try{l(!0),c(""),n({id:r,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(x){console.error("Error loading section details:",x),c("Failed to load assessment section details"),de.error("Failed to load assessment section details")}finally{l(!1)}},m=()=>{s("/trainee/your-assessments")},u=x=>{const g={PENDING:{variant:"warning",text:"Pending",icon:et},IN_PROGRESS:{variant:"info",text:"In Progress",icon:vt},COMPLETED:{variant:"success",text:"Completed",icon:rt},OVERDUE:{variant:"danger",text:"Overdue",icon:Wt}}[x]||{variant:"secondary",text:x,icon:vt},v=g.icon;return t.jsxs(Te,{bg:g.variant,className:"d-flex align-items-center",children:[t.jsx(v,{size:12,className:"me-1"}),g.text]})},h=()=>{de.info("Starting assessment section...")},p=()=>{de.info("Continuing assessment section...")};return i?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):o||!a?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:o||"Assessment section not found"}),t.jsxs(se,{variant:"outline-danger",onClick:m,children:[t.jsx(bt,{className:"me-2",size:16}),"Back to Assessments"]})]})}):t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:m,className:"me-3",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:28}),a.name]}),t.jsxs("p",{className:"text-muted mb-0",children:[a.course,"  ",a.subject]})]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[u(a.status),t.jsx(Te,{bg:"info",className:"fw-normal",children:a.type})]})]})})}),t.jsxs(oe,{children:[t.jsx(F,{lg:8,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2",size:20}),"Assessment Section Details"]})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{children:"Description"}),t.jsx("p",{className:"text-muted",children:a.description})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{children:"Instructions"}),t.jsx("ul",{className:"list-unstyled",children:a.instructions.map((x,f)=>t.jsxs("li",{className:"mb-2",children:[t.jsx("span",{className:"text-primary me-2",children:""}),x]},f))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{children:"Questions Overview"}),t.jsx("div",{className:"row",children:a.questions.map((x,f)=>t.jsx("div",{className:"col-md-6 mb-3",children:t.jsxs("div",{className:`p-3 border rounded ${x.isAnswered||x.isCompleted?"bg-light":""}`,children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("span",{className:"fw-semibold",children:["Question ",f+1]}),x.isAnswered||x.isCompleted?t.jsx(Te,{bg:"success",className:"small",children:"Completed"}):t.jsx(Te,{bg:"warning",className:"small",children:"Pending"})]}),t.jsx("p",{className:"mb-0 small text-muted",children:x.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},x.id))})]}),t.jsx("div",{className:"d-flex justify-content-center",children:a.status==="PENDING"?t.jsxs(se,{variant:"primary",size:"lg",onClick:h,children:[t.jsx(jc,{className:"me-2",size:20}),"Start Assessment"]}):t.jsxs(se,{variant:"primary",size:"lg",onClick:p,children:[t.jsx(vt,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),t.jsx(F,{lg:4,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-white border-bottom",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(et,{className:"me-2",size:20}),"Assessment Information"]})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Time Limit"}),t.jsxs("div",{className:"text-muted",children:[a.timeLimit," minutes"]})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Due Date"}),t.jsx("div",{className:"text-muted",children:new Date(a.dueDate).toLocaleDateString()})]})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(vt,{className:"text-muted me-3",size:18}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:"Total Questions"}),t.jsx("div",{className:"text-muted",children:a.questions.length})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("span",{className:"fw-semibold",children:"Progress"}),t.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),t.jsx(Il,{now:a.progress,variant:"primary",className:"mb-3"}),t.jsx("div",{className:"text-center",children:t.jsxs("small",{className:"text-muted",children:[a.questions.filter(x=>x.isAnswered||x.isCompleted).length," of ",a.questions.length," questions completed"]})})]}),t.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[t.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),t.jsxs("ul",{className:"mb-0 small text-muted",children:[t.jsx("li",{children:"Read questions carefully"}),t.jsx("li",{children:"Manage your time wisely"}),t.jsx("li",{children:"Save progress regularly"}),t.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},Mk=()=>{const{traineeId:e,sectionId:r}=Jt();return t.jsx(Ee,{className:"py-3",children:t.jsx(Lk,{traineeId:e,sectionId:r})})},Bk=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Bk,document.head.appendChild(e)}const r0=()=>{const e=qe(),r=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Dt,path:"/trainee/academic-details",color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:it,path:"/trainee/enrolled-courses",color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:vt,path:"/trainee/your-assessments",color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Wt,path:"/trainee/create-incident-feedback-report",color:"danger"}];return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsx("h3",{className:"mb-3",children:"Quick Actions"})})}),t.jsx(oe,{children:r.map((s,a)=>{const n=s.icon;return t.jsx(F,{lg:6,xl:3,className:"mb-4",children:t.jsx(R,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(s.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:t.jsxs(R.Body,{className:"p-4",children:[t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("div",{className:`bg-${s.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:t.jsx(n,{size:24})}),t.jsx("div",{className:"flex-grow-1",children:t.jsx("h5",{className:"mb-1",children:s.title})}),t.jsx(Gr,{size:20,className:"text-muted"})]}),t.jsx("p",{className:"text-muted mb-0",children:s.description})]})})},a)})}),t.jsxs(oe,{className:"mt-4",children:[t.jsx(F,{lg:6,className:"d-flex",children:t.jsxs(R,{className:"border-0 shadow-sm w-100 training-progress-card",children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Training Progress"})}),t.jsx(R.Body,{className:"d-flex flex-column justify-content-center",children:t.jsxs("div",{className:"text-center py-4",children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),t.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),t.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),t.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),t.jsx(F,{lg:6,className:"d-flex",children:t.jsxs(R,{className:"border-0 shadow-sm w-100 assessments-card",children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),t.jsx(R.Body,{className:"d-flex flex-column justify-content-center",children:t.jsxs("div",{className:"text-center py-4",children:[t.jsx(vt,{size:48,className:"text-muted mb-3"}),t.jsx("h6",{className:"text-muted",children:"No assessments pending"}),t.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/signature-required"),className:"d-flex align-items-center justify-content-center mx-auto",children:[t.jsx(vt,{size:16,className:"me-2"}),"Go to Assessments",t.jsx(Gr,{size:16,className:"ms-2"})]})]})})]})})]})]})},zk=()=>{const e=qe(),{user:r}=Us(),[s,a]=b.useState(!0),[n,i]=b.useState(null);b.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const d={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(m=>setTimeout(m,500)),i(d)}catch(d){console.error("Error loading academic data:",d)}finally{a(!1)}},o=d=>{switch(d){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=d=>{switch(d){case"completed":return t.jsx(rt,{className:"text-success"});case"in-progress":return t.jsx(et,{className:"text-warning"});case"pending":return t.jsx(et,{className:"text-muted"});default:return t.jsx(et,{className:"text-muted"})}};return s?t.jsx(Ee,{className:"py-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?t.jsxs(Ee,{className:"py-4 academic-details",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:"Academic Details"}),t.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{lg:3,md:6,className:"mb-3",children:t.jsx(R,{className:"border-0 shadow-sm h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(it,{size:32,className:"text-primary mb-2"}),t.jsx("h4",{className:"mb-1",children:n.totalCourses}),t.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),t.jsx(F,{lg:3,md:6,className:"mb-3",children:t.jsx(R,{className:"border-0 shadow-sm h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(_0,{size:32,className:"text-success mb-2"}),t.jsx("h4",{className:"mb-1",children:n.completedCourses}),t.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),t.jsx(F,{lg:3,md:6,className:"mb-3",children:t.jsx(R,{className:"border-0 shadow-sm h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(et,{size:32,className:"text-warning mb-2"}),t.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),t.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),t.jsx(F,{lg:3,md:6,className:"mb-3",children:t.jsx(R,{className:"border-0 shadow-sm h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(vt,{size:32,className:"text-info mb-2"}),t.jsx("h4",{className:"mb-1",children:n.completedAssessments}),t.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),t.jsx(oe,{className:"mb-5",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"text-center mb-3",children:[t.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),t.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),t.jsx(Il,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),t.jsx(oe,{className:"text-center",children:t.jsx(F,{children:t.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),t.jsxs(oe,{className:"mt-4",children:[t.jsx(F,{lg:8,className:"mb-4 pe-3",children:t.jsxs(R,{className:"border-0 shadow-sm h-100",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(it,{className:"me-2"}),"Course Progress"]})}),t.jsx(R.Body,{children:n.courses.map(d=>t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1",children:d.name}),t.jsx("small",{className:"text-muted",children:d.code})]}),t.jsx("div",{className:"d-flex align-items-center",children:t.jsx(Te,{variant:o(d.status),children:d.status.replace("-"," ")})})]}),t.jsx(Il,{now:d.progress,variant:d.progress===100?"success":"primary",style:{height:"8px"}}),t.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[t.jsxs("small",{className:"text-muted",children:[d.progress,"% complete"]}),d.status==="completed"&&t.jsxs("small",{className:"text-success",children:["Completed: ",new Date(d.completedDate).toLocaleDateString()]})]})]},d.id))})]})}),t.jsx(F,{lg:4,className:"mb-4 ps-3",children:t.jsxs(R,{className:"border-0 shadow-sm h-100",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx(vt,{className:"me-2"}),"Recent Assessments"]})}),t.jsx(R.Body,{children:n.recentAssessments.map(d=>t.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[t.jsx("h6",{className:"mb-1",children:d.name}),c(d.status)]}),t.jsx("small",{className:"text-muted d-block mb-1",children:d.course}),d.status==="completed"?t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs(Te,{variant:"success",children:["Score: ",d.score]}),t.jsx("small",{className:"text-muted",children:new Date(d.completedDate).toLocaleDateString()})]}):t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsx(Te,{variant:"warning",children:"Pending"}),t.jsxs("small",{className:"text-muted",children:["Due: ",new Date(d.dueDate).toLocaleDateString()]})]})]},d.id))})]})})]})]}):t.jsx(Ee,{className:"py-4",children:t.jsx(Ae,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},$k=()=>{const{user:e}=Us();return e?t.jsx(Ee,{className:"py-3",children:t.jsx(zk,{})}):t.jsx(Ee,{className:"py-3",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{children:"Please log in to view your academic details."})})})},a0=({uniqueLevels:e,uniqueStatuses:r,selectedLevels:s,selectedStatuses:a,onLevelToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=s.length>0||a.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown course-filter-dropdown ${o}`,children:[t.jsx(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",c&&t.jsx("span",{className:"badge bg-primary ms-2",children:s.length+a.length})]})}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),s.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>t.jsx(E.Check,{type:"checkbox",id:`level-${d}`,label:d,checked:s.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),a.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(d=>t.jsx(E.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},yf=document.createElement("style");yf.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(yf);const Uk=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Uk,document.head.appendChild(e)}const Wk=({traineeId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(""),[c,d]=b.useState([]),[m,u]=b.useState([]),[h,p]=b.useState("upcoming"),x=[...new Set(s.map(D=>D.level).filter(Boolean))],f=[...new Set(s.map(D=>D.status).filter(Boolean))],g=D=>s.filter(W=>{switch(D){case"upcoming":return W.status==="PLANNED";case"ongoing":return W.status==="ON-GOING";case"completed":return W.status==="COMPLETED";default:return!0}}),v=g(h),N=b.useMemo(()=>v.filter(D=>{const W=!l||D.name.toLowerCase().includes(l.toLowerCase())||D.code.toLowerCase().includes(l.toLowerCase())||D.description.toLowerCase().includes(l.toLowerCase()),q=c.length===0||c.includes(D.level),Y=m.length===0||m.includes(D.status);return W&&q&&Y}),[v,l,c,m]),{sortedData:j,sortConfig:S,handleSort:C}=Ot(N);b.useEffect(()=>{e&&w()},[e]);const w=async()=>{try{i(!0);const D=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ON-GOING",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}},{id:"5",code:"NAV005",name:"Navigation Systems",description:"Advanced navigation and GPS systems",level:"ADVANCED",status:"COMPLETED",startDate:"2023-09-01T09:00:00.000Z",endDate:"2023-10-15T17:00:00.000Z",progress:100,department:{id:5,name:"Navigation Department",code:"NAV"}},{id:"6",code:"COMM006",name:"Communication Protocols",description:"Radio communication and protocols",level:"BEGINNER",status:"PLANNED",startDate:"2024-04-01T09:00:00.000Z",endDate:"2024-06-01T17:00:00.000Z",progress:0,department:{id:6,name:"Communication Department",code:"COMM"}},{id:"7",code:"MAINT007",name:"Aircraft Maintenance",description:"Routine maintenance procedures",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-01-20T08:00:00.000Z",endDate:"2024-03-20T16:00:00.000Z",progress:60,department:{id:7,name:"Maintenance Department",code:"MAINT"}},{id:"8",code:"ARCH008",name:"Archived Course",description:"This course has been archived",level:"BEGINNER",status:"ARCHIVED",startDate:"2023-06-01T09:00:00.000Z",endDate:"2023-08-01T17:00:00.000Z",progress:100,department:{id:8,name:"Archived Department",code:"ARCH"}}];await new Promise(W=>setTimeout(W,300)),a(D)}catch(D){console.error("Error loading trainee courses:",D),de.error("Failed to load enrolled courses")}finally{i(!1)}},y=D=>{const q={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[D]||{variant:"secondary",text:D};return t.jsx(Te,{bg:q.variant,children:q.text})},T=D=>{const q={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[D]||{variant:"secondary",text:D};return t.jsx(Te,{bg:q.variant,children:q.text})},k=D=>{r(`/trainee/${e}/course/${D.id}`)},P=D=>{d(D==="clear"?[]:W=>W.includes(D)?W.filter(q=>q!==D):[...W,D])},A=D=>{u(D==="clear"?[]:W=>W.includes(D)?W.filter(q=>q!==D):[...W,D])},_=()=>{d([]),u([]),o("")},U=({columnKey:D,children:W,className:q=""})=>{const Y=S.key===D,K=Y?S.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${q} ${Y?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>C(D),onMouseEnter:H=>{H.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",H.target.style.transform="translateY(-1px)",H.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:H=>{H.target.style.backgroundColor="transparent",H.target.style.transform="translateY(0)",H.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:Y?"600":"500"},children:W}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:K,size:14})})]}),Y&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return n?t.jsx(It,{rows:5,columns:8}):s.length===0?t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No enrolled courses"}),t.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):N.length===0&&(l||c.length>0||m.length>0)?t.jsx("div",{children:t.jsxs(qt.Container,{activeKey:h,onSelect:p,children:[t.jsxs(Et,{variant:"tabs",className:"mb-3",children:[t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[t.jsx(et,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[t.jsx(Ro,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[t.jsx(rt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),t.jsx(qt.Content,{children:t.jsxs(qt.Pane,{eventKey:h,children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(a0,{uniqueLevels:x,uniqueStatuses:f,selectedLevels:c,selectedStatuses:m,onLevelToggle:P,onStatusToggle:A,onClearFilters:_,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[N.length," course",N.length!==1?"s":""]})})})]}),t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No courses found"}),t.jsx("p",{children:"Try adjusting your search criteria or filters."}),t.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:_,children:"Clear Filters"})]})})]})})]})}):t.jsx("div",{children:t.jsxs(qt.Container,{activeKey:h,onSelect:p,children:[t.jsxs(Et,{variant:"tabs",className:"mb-3",children:[t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[t.jsx(et,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[t.jsx(Ro,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),t.jsx(Et.Item,{children:t.jsxs(Et.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[t.jsx(rt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),t.jsx(qt.Content,{children:t.jsxs(qt.Pane,{eventKey:h,children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(a0,{uniqueLevels:x,uniqueStatuses:f,selectedLevels:c,selectedStatuses:m,onLevelToggle:P,onStatusToggle:A,onClearFilters:_,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[N.length," course",N.length!==1?"s":""]})})})]}),t.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(U,{columnKey:"code",className:"show-mobile",children:"Course Code"}),t.jsx(U,{columnKey:"name",className:"show-mobile",children:"Course Name"}),t.jsx(U,{columnKey:"level",className:"show-mobile",children:"Level"}),t.jsx(U,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(U,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),t.jsx(U,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),t.jsx(U,{columnKey:"progress",className:"show-mobile",children:"Progress"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:j.map((D,W)=>t.jsxs("tr",{className:`${W%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor=W%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsx(Te,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:D.code})}),t.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[t.jsx("div",{className:"fw-medium text-dark",children:D.name}),t.jsx("small",{className:"text-muted",children:D.description})]}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:T(D.level)}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:y(D.status)}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:D.startDate?new Date(D.startDate).toLocaleDateString():"N/A"})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-dark",children:D.endDate?new Date(D.endDate).toLocaleDateString():"N/A"})}),t.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${D.progress||0}%`}})}),t.jsxs("small",{className:"text-muted",children:[D.progress||0,"%"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.COURSES.VIEW_DETAIL],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Course Details",icon:t.jsx(xt,{}),onClick:()=>k(D),permission:be.COURSES.VIEW_DETAIL}]})})})]},D.id))})]})})]})})]})})},Hk=()=>{const{user:e}=Us();return e?t.jsx(Ee,{className:"py-3",children:t.jsx(Wk,{traineeId:e.id})}):t.jsx(Ee,{className:"py-3",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Vk=({show:e,onHide:r,onImportSuccess:s,onImportError:a})=>{const n=qe(),[i,l]=b.useState("with-fields"),[o,c]=b.useState(null),[d,m]=b.useState(!1),[u,h]=b.useState({name:"",description:"",departmentId:""}),[p,x]=b.useState([]),[f,g]=b.useState(!1),v=b.useRef(null);b.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{g(!0);const y=await Nt.getDepartments(),T=y.departments||y.data||[];x(T)}catch(y){console.error("Error loading departments:",y),de.error("Failed to load departments"),x([])}finally{g(!1)}},j=y=>{const T=y.target.files[0];if(T){const k=[".docx"],P=T.name.toLowerCase().substring(T.name.lastIndexOf("."));if(!k.includes(P)){de.error("Please select a valid Word document file (.docx)");return}if(T.size>10*1024*1024){de.error("File size must be less than 10MB");return}c(T)}},S=async()=>{if(!o){de.error("Please select a file to import");return}m(!0);try{const y=Ai.getDocsType(o.name),T=await Ai.uploadDocument(o,y);let k;if(T.data&&T.data.length>0&&T.data[0].url)k=T.data[0].url,console.log(` Form Template Upload Success! Document URL: ${k}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields")n("/admin/forms/editor",{state:{documentUrl:k,fileName:o.name.replace(".docx",""),importType:"File with fields"}}),C(),s("File with fields",o.name);else{const P={name:u.name,description:u.description,departmentId:u.departmentId,templateContent:k,fileName:o.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(P)),console.log(" Template info saved to localStorage:",P),n("/admin/forms/editor",{state:{documentUrl:k,fileName:P.fileName,importType:"File without fields",templateInfo:P}}),C(),s("File without fields",o.name)}}catch(y){a(y.message||"Import failed")}finally{m(!1)}},C=()=>{c(null),l("with-fields"),h({name:"",description:"",departmentId:""}),v.current&&(v.current.value=""),r()},w=y=>{de.info(`Downloading ${y} template...`)};return t.jsxs(le,{show:e,onHide:C,size:"lg",centered:!0,className:"import-file-modal",children:[t.jsx(le.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:t.jsxs(le.Title,{className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-2",size:20}),"Import Form File"]})}),t.jsxs(le.Body,{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:6,children:t.jsx(R,{className:`h-100 cursor-pointer ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("with-fields"),style:{cursor:"pointer"},children:t.jsx(R.Body,{className:"text-center p-4 d-flex flex-column",children:t.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-between",children:[t.jsxs("div",{children:[t.jsx(Hi,{size:48,className:"text-primary mb-3"}),t.jsx("h6",{className:"text-primary",children:"File with Fields"}),t.jsx("p",{className:"text-muted small mb-3",children:"Import a Word document that already contains predefined form fields and structure. The system will automatically parse and create form templates."})]}),t.jsx("div",{className:"mt-auto",children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:y=>{y.stopPropagation(),w("with-fields")},children:[t.jsx(qr,{className:"me-1",size:14}),"Download Template"]})})]})})})}),t.jsx(F,{md:6,children:t.jsx(R,{className:`h-100 cursor-pointer ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("without-fields"),style:{cursor:"pointer"},children:t.jsx(R.Body,{className:"text-center p-4 d-flex flex-column",children:t.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-between",children:[t.jsxs("div",{children:[t.jsx(Ei,{size:48,className:"text-success mb-3"}),t.jsx("h6",{className:"text-success",children:"File without Fields"}),t.jsx("p",{className:"text-muted small mb-3",children:"Import a raw Word document without predefined structure. You will manually define form fields and mapping after import."})]}),t.jsx("div",{className:"mt-auto",children:t.jsxs(se,{variant:"outline-success",size:"sm",onClick:y=>{y.stopPropagation(),w("without-fields")},children:[t.jsx(qr,{className:"me-1",size:14}),"Download Template"]})})]})})})})]})]}),!i&&t.jsxs(Ae,{variant:"info",className:"mb-4",children:[t.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),t.jsx("p",{className:"mb-0 small",children:'Choose between "File with Fields" or "File without Fields" above to continue with the import process.'})]}),i==="without-fields"&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Template Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:u.name,onChange:y=>h(T=>({...T,name:y.target.value})),required:!0})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Description ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:u.description,onChange:y=>h(T=>({...T,description:y.target.value})),required:!0})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Department ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsxs(E.Select,{value:u.departmentId,onChange:y=>h(T=>({...T,departmentId:y.target.value})),required:!0,disabled:f,children:[t.jsx("option",{value:"",children:"Select Department"}),p.map(y=>t.jsx("option",{value:y.id,children:y.name},y.id))]}),f&&t.jsx(E.Text,{className:"text-muted",children:"Loading departments..."}),u.templateContent&&t.jsxs(E.Text,{className:"text-muted",children:["Template Content: ",u.templateContent]})]})})]})})]}),i&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),t.jsxs(E.Group,{children:[t.jsx(E.Control,{ref:v,type:"file",accept:".docx",onChange:j,className:"mb-2"}),t.jsx(E.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),o&&t.jsx(Ae,{variant:"info",className:"mb-4",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Ei,{className:"me-2",size:20}),t.jsxs("div",{children:[t.jsx("strong",{children:"Selected File:"})," ",o.name,t.jsx("br",{}),t.jsxs("small",{className:"text-muted",children:["Size: ",(o.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),t.jsxs(le.Footer,{className:"border-0 p-4",children:[t.jsxs(se,{variant:"outline-secondary",onClick:C,disabled:d,children:[t.jsx(Ge,{className:"me-2",size:16}),"Cancel"]}),i==="with-fields"&&t.jsx(se,{variant:"primary-custom",onClick:S,disabled:!o||d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"me-2",size:16}),"Import File"]})}),i==="without-fields"&&t.jsx(se,{variant:"primary-custom",onClick:S,disabled:!o||!u.name||!u.description||!u.departmentId||d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"me-2",size:16}),"Import File"]})})]})]})},Gk=()=>{const e=qe(),[r,s]=b.useState(!1),a=()=>{s(!0)},n=()=>{e("/admin/forms/editor",{state:{content:'<h1 style="text-align: center;">New Form</h1><p>Start creating your form here...</p>',fileName:"New Form",importType:"New Form"}})},i=(o,c)=>{de.success(`${o} file "${c}" imported successfully!`),s(!1)},l=o=>{de.error(`Import failed: ${o}`)};return t.jsx(Ee,{fluid:!0,className:"py-4 forms-page form-component",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx($s,{className:"me-2 text-white",size:24}),t.jsx("h4",{className:"mb-0 text-white",children:"Form Templates"})]})})})}),t.jsxs(R.Body,{children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(Ei,{size:64,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No form templates found"}),t.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."}),t.jsxs("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[t.jsx(Ht,{permission:be.TEMPLATES.CREATE,fallback:null,children:t.jsxs(se,{variant:"outline-primary",onClick:n,className:"d-flex align-items-center",children:[t.jsx(ks,{className:"me-2",size:16}),"Create New Template's Version"]})}),t.jsx(Ht,{permission:be.TEMPLATES.CREATE,fallback:null,children:t.jsxs(se,{variant:"primary-custom",onClick:a,className:"d-flex align-items-center",children:[t.jsx(Hs,{className:"me-2",size:16}),"Create New Template"]})})]})]})})}),t.jsx(Vk,{show:r,onHide:()=>s(!1),onImportSuccess:i,onImportError:l})]})]})})};function qk(){try{const e=localStorage.getItem("templateInfo");if(e){const r=JSON.parse(e);return{name:r.name||"",description:r.description||"",departmentId:r.departmentId||"",templateContent:r.templateContent||""}}}catch{}return{name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||""}}function Yk(e,r){const s=(r||[]).map((a,n)=>{const i=a.fields||[],l={};for(const h of i)if(String(h.fieldType||"").toUpperCase()==="PART"){const p=h.fieldName||"",x=h.tempId||(p?`${p}-parent`:void 0);x&&(l[p]=x)}const c=i.map(h=>{const p=h.parentTempId;return p&&l[p]?{...h,parentTempId:l[p]}:h}).map((h,p)=>({...h,__idx:p})),d=c.filter(h=>!h.parentTempId).sort((h,p)=>h.__idx-p.__idx),m=[];for(const h of d){m.push(h);const p=String(h.fieldType||"").toUpperCase()==="PART"?h.tempId||l[h.fieldName]||(h.fieldName?`${h.fieldName}-parent`:void 0):null;if(p){const x=c.filter(f=>f.parentTempId===p).sort((f,g)=>f.__idx-g.__idx);m.push(...x)}}if(m.length!==c.length){const h=new Set(m.map(p=>p.__idx));c.filter(p=>!h.has(p.__idx)).sort((p,x)=>p.__idx-x.__idx).forEach(p=>m.push(p))}const u=m.map((h,p)=>{const x=String(h.fieldType||"").toUpperCase().startsWith("SIGNATURE"),f={label:h.label,fieldName:h.fieldName,fieldType:h.fieldType,displayOrder:p+1,parentTempId:h.parentTempId?h.parentTempId:null};if(x&&(f.roleRequired=h.roleRequired||"TRAINER"),String(h.fieldType||"").toUpperCase()==="PART"){const g=h.fieldName||"";f.tempId=h.tempId||(g?`${g}-parent`:void 0)}return f});return{name:a.name,label:a.label,displayOrder:a.displayOrder??n+1,editBy:a.editBy||"TRAINER",roleInSubject:a.roleInSubject?a.roleInSubject:null,isSubmittable:!!a.isSubmittable,isToggleDependent:!!a.isToggleDependent,fields:u}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:s}}const Kk=({customFields:e=[],onAddField:r,onRemoveField:s,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,readOnly:l=!1,className:o=""})=>{const[c,d]=b.useState([]),[m,u]=b.useState({}),[h,p]=b.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),[x,f]=b.useState(!1),[g,v]=b.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[N,j]=b.useState(["TRAINER","TRAINEE"]),[S,C]=b.useState(!1),[w,y]=b.useState(!1),[T,k]=b.useState(null),[P,A]=b.useState(null),[_,U]=b.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null});b.useEffect(()=>{e&&e.length>0&&c.length===0&&d([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]);const D=()=>{v({name:"",label:"",displayOrder:c.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),f(!0)},W=he=>{u(me=>({...me,[he]:!me[he]}))},q=(he,me,Be)=>{me===null||Be===null||me===Be||d(ht=>{const tt=[...ht],Xe=[...tt[he]?.fields||[]],[Rt]=Xe.splice(me,1);if(Xe.splice(Be,0,Rt),tt[he]={...tt[he],fields:Xe},r){const We=tt.flatMap(at=>at.fields||[]);r(We,{silent:!0})}return tt})},Y=()=>{if(!g.name||!g.label){de.warning("Please fill in section name and label");return}if(c.some(me=>me.name===g.name)){de.warning("Section name must be unique");return}const he={...g,roleInSubject:g.editBy==="TRAINEE"?null:g.roleInSubject||null};d(me=>[...me,he]),f(!1)};b.useEffect(()=>{x&&(async()=>{try{const me=await Ps.getRoles(),ht=(Array.isArray(me?.roles)?me.roles:Array.isArray(me)?me:[]).map(Xe=>typeof Xe=="string"?Xe:Xe.name||Xe.code||Xe.roleName||"").filter(Xe=>typeof Xe=="string").map(Xe=>Xe.toUpperCase()).filter(Xe=>Xe.includes("TRAINER")||Xe.includes("TRAINEE")).map(Xe=>Xe.includes("TRAINER")?"TRAINER":"TRAINEE"),tt=Array.from(new Set(ht));tt.length>0&&j(tt)}catch{}})()},[x]);const K=he=>{const Be=c[he]?.editBy||"TRAINER";U({label:"",fieldName:"",fieldType:"TEXT",roleRequired:Be,displayOrder:1,parentTempId:null}),k(he),C(!0)},H=(he,me)=>{if(!he)return{valid:!1,message:"Field name is required"};const Be=String(me||"").toUpperCase();return Be==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(he)?he.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:Be==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(he)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(he)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},je=()=>{if(!_.label||!_.fieldName){de.warning("Please fill in all required fields");return}const he=H(_.fieldName,_.fieldType);if(!he.valid){de.warning(he.message);return}if(T===null||T<0||T>=c.length){de.warning("Please choose a section");return}const me=c[T].fields||[];if((P!==null?me.filter((tt,Xe)=>Xe!==P):me).some(tt=>tt.fieldName===_.fieldName)){de.warning("Field name must be unique");return}const ht=[...c];if(P!==null?ht[T].fields=[...me.slice(0,P),_,...me.slice(P+1)]:ht[T].fields=[...me,{..._}],d(ht),r){const tt=ht.flatMap(Xe=>Xe.fields||[]);r(tt)}C(!1),y(!1),k(null),A(null)},ie=(he,me)=>{const Be=c[he]?.fields?.[me];Be&&(U({...Be}),k(he),A(me),y(!0))},B=()=>{C(!1),y(!1),f(!1),k(null),A(null)},[V,z]=b.useState(!1),L=async()=>{try{z(!0);const he=qk();let me=null;const Be=he.templateContent;if(console.log(" Original templateContent (file import):",Be),i)try{console.log(" Step 1: Starting export and upload flow..."),console.log(' Step 2: Calling editor.downloadAs("docx")...'),me=await i(),console.log(" Step 3: Export and upload SUCCESS!"),console.log(" templateConfig URL (file  chnh sa):",me),console.log(" Export flow status:  HOT NG")}catch(Rt){console.error(" Export/Upload failed:",Rt),console.log(" Export flow status:  KHNG HOT NG - Using fallback"),de.warning("Could not upload edited document, templateConfig will be null"),me=null}else console.log(" exportAndUploadEditedDoc function not available"),console.log(" Export flow status:  FUNCTION KHNG TN TI"),me=null;const ht={...he,templateContent:Be,templateConfig:me},tt=Yk(ht,c);console.log(" Template payload built:"),console.log("   templateContent (file import):",tt.templateContent),console.log("   templateConfig (file  chnh sa):",tt.templateConfig||"null"),console.log(` Full payload:
`,JSON.stringify(tt,null,2));const Xe=await De.post("/templates",tt);de.success("Template submitted successfully"),console.log(" Backend response:",Xe?.data??Xe)}catch(he){console.error(" Submit template failed:",he),de.error("Failed to submit template: "+(he.message||"Unknown error"))}finally{z(!1)}},te=he=>{const me=he.fieldName;if(!me)return"";switch((he.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${me}}{/`+me+`} {^${me}}{/`+me+"}";case"PART":return`{#${me}} {test_field} {/${me}}`;case"TEXT":default:return`{${me}}`}},[ne,ue]=b.useState(!1),[Ne,ae]=b.useState(null),[re,M]=b.useState(null),[_e,ke]=b.useState(""),[ze,ce]=b.useState("TEXT"),[Se,Me]=b.useState(""),[Ve,Ue]=b.useState("TRAINER"),Tt=(he,me,Be)=>{M(he),ae(Be),ke(""),ce("TEXT"),Me(""),Ue("TRAINER"),ue(!0)},ot=()=>{if(!Se||!_e||!/^[a-z][a-z0-9_]*$/.test(_e)){de.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!Ne?.fieldName){de.error("Invalid PART field");return}if(re===null||re<0||re>=c.length){de.error("Invalid section");return}const Be=c[re].fields||[];if(Be.some(at=>at.fieldName===_e)){de.warning("Field name must be unique within section");return}const ht={label:Se,fieldName:_e,fieldType:ze,roleRequired:Ve,parentTempId:Ne?.tempId||Ne?.fieldName||null},tt=[...c];if(tt[re].fields=[...Be,ht],d(tt),r){const at=tt.flatMap(Ie=>Ie.fields||[]);r(at)}let Xe=`{${_e}}`;const Rt=String(ze).toUpperCase();Rt==="TOGGLE"?Xe=`{#${_e}}{/${_e}} {^${_e}}{/${_e}}`:Rt==="IMAGE"&&(Xe=`{${_e}}`);const We=` ${Xe}`;setTimeout(()=>a(We),0),ue(!1),ae(null),M(null),ke(""),ce("TEXT"),Me(""),Ue("TRAINER")};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
        `}),t.jsxs("div",{className:`p-3 bg-light custom-fields-panel ${o}`,style:{height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[t.jsx("h6",{className:"mb-0 text-muted",children:"Custom Fields"}),t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:D,disabled:l,children:[t.jsx(ks,{className:"me-1",size:14}),"Add Section"]})]}),t.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",minHeight:"0"},children:t.jsx("div",{className:"d-grid gap-2",children:c.length>0?c.sort((he,me)=>he.displayOrder-me.displayOrder).map((he,me)=>t.jsxs(R,{className:"border section-card",children:[t.jsxs(R.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>W(me),"aria-expanded":!m[me],children:[t.jsxs("div",{className:"d-flex flex-column",children:[t.jsxs("div",{className:"section-title fw-bold",children:[m[me]?t.jsx(Hn,{size:16}):t.jsx(Cr,{size:16}),he.label,t.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge",children:he.fields?.length||0})]}),t.jsxs("small",{className:"text-muted",children:["Order: ",he.displayOrder,"  Edit by: ",he.editBy]})]}),t.jsx("div",{onClick:Be=>Be.stopPropagation(),children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>K(me),disabled:l,children:[t.jsx(ks,{className:"me-1",size:14}),"Add Field"]})})]}),!m[me]&&t.jsx(R.Body,{className:"section-body",children:he.fields&&he.fields.length>0?(()=>{const Be=[...he.fields].sort((We,at)=>We.displayOrder-at.displayOrder),ht=We=>We?.tempId||We?.fieldName||null,tt=We=>!!We.parentTempId,Xe=Be.filter(We=>!tt(We)),Rt=(We,at)=>{const Ie=String(We.fieldType).toUpperCase()==="PART";return t.jsxs("div",{className:`p-2 rounded border mb-2 draggable-item ${Ie?"bg-part part-card":"bg-white child-row"} ${h.sectionIndex===me&&h.overIndex===at?"border-primary":""} ${h.sectionIndex===me&&h.overIndex===at&&h.position==="above"?"drop-target-above":""} ${h.sectionIndex===me&&h.overIndex===at&&h.position==="below"?"drop-target-below":""} ${h.sectionIndex===me&&h.fromIndex===at?"dragging":""}`,draggable:!0,onDragStart:Ke=>{p({sectionIndex:me,fromIndex:at,overIndex:at,position:"above"}),Ke.dataTransfer.effectAllowed="move"},onDragOver:Ke=>{Ke.preventDefault();const pt=Ke.currentTarget.getBoundingClientRect(),Ze=pt.top+pt.height/2,ts=Ke.clientY<Ze?"above":"below";let Ks=at;ts==="below"&&(Ks=at+1),h.sectionIndex===me&&(h.overIndex!==Ks||h.position!==ts)&&p(ii=>({...ii,overIndex:Ks,position:ts}))},onDrop:Ke=>{if(Ke.preventDefault(),h.sectionIndex===me){const pt=Math.max(0,Math.min(h.overIndex,c[me]?.fields?.length||0));q(me,h.fromIndex,pt)}p({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>p({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),style:{cursor:"grab"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsxs("div",{className:"fw-bold field-title",children:[We.label," ",Ie&&t.jsx("span",{className:"badge part-badge",children:"PART"})," "]}),t.jsxs("small",{className:"text-muted",children:[We.fieldName," (",We.fieldType,")",We.roleRequired?` - ${We.roleRequired}`:""]})]}),t.jsxs("div",{className:"d-flex gap-1",children:[t.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>ie(me,at),disabled:l,title:"Edit Field",className:"text-primary border-primary",children:t.jsx(bs,{size:14})}),t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const Ke=[...c];if(Ke[me].fields=Ke[me].fields.filter((pt,Ze)=>Ze!==at),d(Ke),s){const pt=Ke.flatMap(Ze=>Ze.fields||[]);s(pt)}},disabled:l,title:"Remove Field",className:"text-danger border-danger",children:t.jsx(Ge,{size:14})})]})]}),t.jsxs("div",{className:"d-grid",children:[t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>a(te(We)),disabled:l,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out"},children:[t.jsx(wn,{className:"me-1",size:14}),"Insert Field"]}),String(We.fieldType).toUpperCase()==="PART"&&t.jsxs(se,{variant:"outline-primary",size:"sm",className:"mt-2 text-primary border-primary",onClick:()=>Tt(me,at,We),disabled:l,children:[t.jsx(wn,{className:"me-1",size:14}),"Add Field to PART"]})]}),String(We.fieldType).toUpperCase()==="PART"&&(()=>{const Ke=ht(We),pt=Be.filter(Ze=>Ze.parentTempId===Ke);return pt.length?t.jsx("div",{className:"mt-2 part-children",children:pt.map(Ze=>{const ts=he.fields.indexOf(Ze);return Rt(Ze,ts)})}):null})()]},`${me}-${at}`)};return t.jsx(t.Fragment,{children:Xe.map(We=>{const at=he.fields.indexOf(We);return Rt(We,at)})})})():t.jsx(Ae,{variant:"light",className:"mb-0",children:t.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},me)):t.jsx(Ae,{variant:"light",className:"mb-0",children:t.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[t.jsxs(Ae,{variant:"info",className:"mb-0",style:{fontSize:"0.8rem"},children:[t.jsx("strong",{children:"Tip:"})," Create sections first, then add fields inside each section."]}),t.jsx(se,{variant:"primary",size:"sm",onClick:L,disabled:V,children:V?"Submitting...":"Submit Template"})]}),t.jsxs(le,{show:x,onHide:B,children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Add New Section"})}),t.jsx(le.Body,{children:t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Basic Information",value:g.name,onChange:he=>v(me=>({...me,name:he.target.value})),required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"Display label",value:g.label,onChange:he=>v(me=>({...me,label:he.target.value})),required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Edit By"}),t.jsx(E.Select,{value:g.editBy,onChange:he=>{const me=he.target.value;v(Be=>({...Be,editBy:me,roleInSubject:me==="TRAINEE"?"":Be.roleInSubject}))},children:N.map(he=>t.jsx("option",{value:he,children:he},he))})]})}),g.editBy==="TRAINER"&&t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Role In Subject"}),t.jsxs(E.Select,{value:g.roleInSubject||"ASSESSMENT_REVIEWER",onChange:he=>v(me=>({...me,roleInSubject:he.target.value})),children:[t.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),t.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"d-flex flex-row align-items-center gap-4",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(E.Check,{type:"checkbox",checked:g.isSubmittable,onChange:he=>v(me=>({...me,isSubmittable:he.target.checked})),id:"section-submittable"}),t.jsx(E.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(E.Check,{type:"checkbox",checked:g.isToggleDependent,onChange:he=>v(me=>({...me,isToggleDependent:he.target.checked})),id:"section-toggle-dependent"}),t.jsx(E.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:B,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:Y,children:"Save Section"})]})]}),t.jsxs(le,{show:S,onHide:B,size:"lg",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Add New Field"})}),t.jsx(le.Body,{children:t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:12,children:t.jsxs(Ae,{variant:"light",className:"py-2",children:["Adding field to section: ",t.jsx("strong",{children:T!==null?c[T]?.label:"N/A"})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Crew Communication",value:_.label,onChange:he=>U(me=>({...me,label:he.target.value})),required:!0}),t.jsx(E.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Field Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., crew_communication",value:_.fieldName,onChange:he=>U(me=>({...me,fieldName:he.target.value})),required:!0}),t.jsxs(E.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Field Type ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsxs(E.Select,{value:_.fieldType,onChange:he=>U(me=>({...me,fieldType:he.target.value})),required:!0,children:[t.jsx("option",{value:"TEXT",children:"TEXT"}),t.jsx("option",{value:"PART",children:"PART"}),t.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),t.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),t.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Role Required ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",value:T!==null&&c[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),t.jsx(E.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Parent Template ID"}),t.jsx(E.Control,{type:"text",placeholder:"Leave empty for root level",value:_.parentTempId||"",onChange:he=>U(me=>({...me,parentTempId:he.target.value||null}))})]})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:B,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:je,children:"Save Field"})]})]}),t.jsxs(le,{show:w,onHide:B,size:"lg",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Edit Field"})}),t.jsx(le.Body,{children:t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Crew Communication",value:_.label,onChange:he=>U(me=>({...me,label:he.target.value})),required:!0}),t.jsx(E.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Field Type ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsxs(E.Select,{value:_.fieldType,onChange:he=>U(me=>({...me,fieldType:he.target.value})),required:!0,children:[t.jsx("option",{value:"TEXT",children:"TEXT"}),t.jsx("option",{value:"PART",children:"PART"}),t.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),t.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),t.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Role Required ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",value:T!==null&&c[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),t.jsx(E.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Field Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:_.fieldType==="PART"?"e.g., Assessment_Items":_.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:_.fieldName,onChange:he=>U(me=>({...me,fieldName:he.target.value})),required:!0}),t.jsx(E.Text,{className:"text-muted",children:_.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':_.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Parent Template ID"}),t.jsx(E.Control,{type:"text",placeholder:"Leave empty for root level",value:_.parentTempId||"",onChange:he=>U(me=>({...me,parentTempId:he.target.value||null}))})]})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:B,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:je,children:"Update Field"})]})]}),t.jsxs(le,{show:ne,onHide:()=>ue(!1),children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Insert Part Field"})}),t.jsx(le.Body,{children:t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:12,children:t.jsxs(Ae,{variant:"light",className:"py-2",children:["Insert field into PART: ",t.jsxs("strong",{children:[Ne?.label," (",Ne?.fieldName,")"]})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Focus Item",value:Se,onChange:he=>Me(he.target.value)})]})}),t.jsx(F,{md:8,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{className:"text-primary-custom",children:["Field Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., focus_item",value:_e,onChange:he=>ke(he.target.value)}),t.jsx(E.Text,{className:"text-muted",children:"snake_case only"})]})}),t.jsx(F,{md:4,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Type"}),t.jsxs(E.Select,{value:ze,onChange:he=>ce(he.target.value),children:[t.jsx("option",{value:"TEXT",children:"TEXT"}),t.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),t.jsx("option",{value:"IMAGE",children:"IMAGE"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{className:"text-primary-custom",children:"Role Required"}),t.jsx(E.Select,{value:Ve,onChange:he=>Ue(he.target.value),children:N.map(he=>t.jsx("option",{value:he,children:he},he))})]})}),t.jsx(F,{md:12,children:t.jsx(E.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:()=>ue(!1),children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:ot,children:"Insert"})]})]})]})]})},Xk=({customFields:e,onAddField:r,onRemoveField:s,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,readOnly:l=!1,className:o=""})=>t.jsx(Kk,{customFields:e,onAddField:r,onRemoveField:s,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,readOnly:l,className:o}),Jk=({onInsertField:e,exportEditedDoc:r,initialUrl:s,readOnly:a=!1,className:n=""})=>{const[i,l]=b.useState([]),[o,c]=b.useState([]),[d,m]=b.useState({}),[u,h]=b.useState(!1),[p,x]=b.useState(!1),[f,g]=b.useState(!1),[v,N]=b.useState(null),[j,S]=b.useState(null),[C,w]=b.useState(null),[y,T]=b.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[k,P]=b.useState(["TRAINER","TRAINEE"]),A=b.useRef(null),[_,U]=b.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),D=ae=>{m(re=>({...re,[ae]:!re[ae]}))},W=(ae,re,M)=>{re===null||M===null||re===M||c(_e=>{const ke=[..._e],ze=[...ke[ae]?.fields||[]],ce=ze[re];if(Y(ce)){const Me=q(ce),Ve=[],Ue=[];ze.forEach((he,me)=>{me===re||he.parentTempId===Me&&(Ve.push(me),Ue.push(he))});const Tt=[re,...Ve].sort((he,me)=>me-he);Tt.forEach(he=>ze.splice(he,1));let ot=M;Tt.forEach(he=>{he<M&&ot--}),ze.splice(ot,0,ce,...Ue)}else{const[Me]=ze.splice(re,1);let Ve=M;re<M&&Ve--,ze.splice(Ve,0,Me)}return ke[ae]={...ke[ae],fields:ze},ke})},q=ae=>ae.tempId||ae.name,Y=ae=>String(ae.fieldType).toUpperCase()==="PART",K=(ae,re)=>{if(Y(re)){const M=q(re),_e=i.filter(ze=>ze.parentTempId===M),ke=[re,..._e];ae.dataTransfer.setData("text/plain",JSON.stringify(ke))}else ae.dataTransfer.setData("text/plain",JSON.stringify(re))},H=(ae,re)=>{ae.preventDefault();try{const M=JSON.parse(ae.dataTransfer.getData("text/plain"));let ke=Array.isArray(M)?M:[M];c(ze=>{const ce=[...ze],Se=ce[re]?.fields||[],Me=ke.filter(Y);if(Me.some(Ue=>Se.some(Tt=>Y(Tt)&&Tt.name===Ue.name))){const Ue=new Set(Me.map(he=>he.name)),Tt=new Set;Me.forEach(he=>{const me=q(he);Tt.add(me)});const ot=Se.filter(he=>!(Y(he)&&Ue.has(he.name)||he.parentTempId&&Tt.has(he.parentTempId)));ce[re]={...ce[re],fields:[...ot,...ke]}}else{for(const me of ke)if(me.parentTempId&&Se.some(ht=>{const tt=q(ht);return Y(ht)&&tt===me.parentTempId}))return de.warning(`Cannot add field "${me.name}": Fields cannot be dragged into existing PART fields.`),ce;const Ue=me=>Y(me)?me.name:me.parentTempId?`${me.name}:${me.parentTempId}`:me.name,Tt=new Set(Se.map(Ue)),ot=new Map,he=ke.filter(me=>{if(Y(me))return!Se.some(tt=>Y(tt)&&tt.name===me.name);const Be=Ue(me);return!Tt.has(Be)}).map(me=>{const Be={...me};if(Y(Be)){console.log(` Adding PART field to section: ${Be.name}`,{before:{parentTempId:Be.parentTempId,tempId:Be.tempId},existingFields:Se.map(Rt=>({name:Rt.name,fieldType:Rt.fieldType,tempId:Rt.tempId,parentTempId:Rt.parentTempId}))});const ht=Be.parentTempId;Be.parentTempId=null;const tt=Be.tempId||Be.name,Xe=Be.tempId;Be.tempId||(Be.tempId=`${Be.name}-parent`),ot.set(tt,Be.tempId),console.log(` PART field normalized: ${Be.name}`,{before:{parentTempId:ht,tempId:Xe},after:{parentTempId:Be.parentTempId,tempId:Be.tempId},oldId:tt,mapping:`${tt} -> ${Be.tempId}`})}return Be});console.log(" PartTempIdMapping:",Array.from(ot.entries())),console.log(" NewFields before update:",he.map(me=>({name:me.name,fieldType:me.fieldType,parentTempId:me.parentTempId,isPart:Y(me)}))),he.forEach(me=>{if(me.parentTempId&&!Y(me)){let Be=null;if(ot.has(me.parentTempId))Be=ot.get(me.parentTempId),console.log(` Updating child ${me.name}: parentTempId ${me.parentTempId} -> ${Be}`),me.parentTempId=Be;else{const ht=he.find(tt=>Y(tt)&&(tt.tempId===me.parentTempId||tt.name===me.parentTempId));ht&&ht.tempId?(Be=ht.tempId,console.log(` Updating child ${me.name} (fallback): parentTempId ${me.parentTempId} -> ${Be}`),me.parentTempId=Be):console.warn(` Could not find parent for child ${me.name} with parentTempId: ${me.parentTempId}`,{partTempIdMapping:Array.from(ot.entries()),availableParts:he.filter(Y).map(tt=>({name:tt.name,tempId:tt.tempId}))})}}}),console.log(" NewFields after update:",he.map(me=>({name:me.name,fieldType:me.fieldType,parentTempId:me.parentTempId,isPart:Y(me)}))),ce[re]={...ce[re],fields:[...Se,...he]}}return ce})}catch{}},je=ae=>{ae.preventDefault()},ie=()=>{const ae=o.length+1;T({name:"",label:"",displayOrder:ae,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),g(!0)},B=()=>{if(!y.name||!y.label){de.warning("Please fill in section name and label");return}if(o.some(re=>re.name===y.name)){de.warning("Section name must be unique");return}const ae={...y,roleInSubject:y.editBy==="TRAINEE"?null:y.roleInSubject||null};c(re=>[...re,ae]),g(!1),de.success("Section added successfully")},V=()=>{g(!1),T({name:"",label:"",displayOrder:o.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]})};b.useEffect(()=>{f&&(async()=>{try{const re=await Ps.getRoles(),_e=(Array.isArray(re?.roles)?re.roles:Array.isArray(re)?re:[]).map(ze=>typeof ze=="string"?ze:ze.name||ze.code||ze.roleName||"").filter(ze=>typeof ze=="string").map(ze=>ze.toUpperCase()).filter(ze=>ze.includes("TRAINER")||ze.includes("TRAINEE")).map(ze=>ze.includes("TRAINER")?"TRAINER":"TRAINEE"),ke=Array.from(new Set(_e));ke.length>0&&P(ke)}catch{}})()},[f]);const z=ae=>{c(re=>re.filter((M,_e)=>_e!==ae))},L=(ae,re)=>{const M=o[ae]?.fields?.[re];M&&(w({...M}),N(ae),S(re),x(!0))},te=(ae,re)=>{if(!ae)return{valid:!1,message:"Field name is required"};const M=String(re||"").toUpperCase();return M==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(ae)?ae.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:M==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(ae)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(ae)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},ne=()=>{if(!C||!C.label||!C.name){de.warning("Please fill in all required fields");return}const ae=te(C.name,C.fieldType);if(!ae.valid){de.warning(ae.message);return}if(v===null||v<0||v>=o.length){de.warning("Invalid section");return}const re=[...o],M=re[v].fields||[];if(M.filter((Se,Me)=>Me!==j).some(Se=>Se.name===C.name)){de.warning("Field name must be unique within the section");return}const ze=re[v]?.editBy||"TRAINER",ce={...C,roleRequired:ze};re[v].fields=[...M.slice(0,j),ce,...M.slice(j+1)],c(re),x(!1),w(null),N(null),S(null),de.success("Field updated successfully")},ue=()=>{x(!1),w(null),N(null),S(null)},Ne=async()=>{try{h(!0);let ae=s;if(r&&!ae)try{const ke=await r();ke&&(ae=ke)}catch{}if(!ae)try{const ke=localStorage.getItem("templateInfo");if(ke){const ze=JSON.parse(ke);ze.templateContent&&(ae=ze.templateContent)}}catch{}if(!ae){de.error("No document URL available"),h(!1);return}const{data:re}=await De.post("/templates/extract-fields-from-url",{url:ae}),_e=(re?.fields||re||[]).map((ke,ze)=>({name:ke.fieldName||ke.name||`field_${ze}`,label:`{${ke.fieldName||ke.name}}`,fieldType:ke.fieldType,displayOrder:ke.displayOrder,parentTempId:ke.parentTempId||null,tempId:ke.tempId}));l(_e),de.success("Extracted fields from document")}catch{de.error("Failed to extract fields")}finally{h(!1)}};return b.useEffect(()=>{s&&s!==A.current&&(A.current=s,Ne())},[s]),t.jsxs("div",{className:`h-100 d-flex flex-column editor-merge-fields-wrapper ${n}`,style:{width:"100%",maxWidth:"100%",overflow:"hidden",boxSizing:"border-box"},children:[t.jsx("div",{className:"p-2 border-bottom bg-white",style:{flexShrink:0},children:t.jsx("div",{className:"d-flex align-items-center gap-2",children:t.jsx(se,{size:"sm",variant:"outline-primary",onClick:ie,disabled:u,children:"+ Add Section"})})}),t.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{overflow:"hidden",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[t.jsx("style",{children:`
          .editor-merge-fields-wrapper {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
          }
          
          .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
          /* Force margin-left = 0 for non-child fields to prevent CSS cascade issues */
          .section-field-non-child {
            margin-left: 0 !important;
          }
          .section-field-child {
            margin-left: 1rem !important;
          }
          
          /* Prevent text overflow in field items */
          .section-field-non-child > div:first-child,
          .section-field-child > div:first-child {
            min-width: 0 !important;
            flex: 1 !important;
            overflow: hidden !important;
          }
          
          .section-field-non-child .fw-bold,
          .section-field-child .fw-bold {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child .text-muted,
          .section-field-child .text-muted {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child > div:last-child,
          .section-field-child > div:last-child {
            flex-shrink: 0 !important;
          }
          
          /* Match CustomFieldsPanel styling */
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: 0.5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-border-color); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight: 600; border: 1px solid rgba(var(--bs-primary-rgb), .25); }
          .field-card-item { padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #dee2e6; margin-bottom: 0.5rem; background: white; }
          .field-card-item.bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .field-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-card-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background: #fff; }
          .field-card-item.drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .field-card-item.drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
        `}),t.jsx("div",{className:"flex-shrink-0",style:{maxHeight:"60%",overflowY:"auto",borderBottom:"1px solid #eee",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:t.jsxs("div",{className:"p-3",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[o.length===0&&t.jsx(Ae,{variant:"light",className:"mb-0",children:t.jsx("small",{children:'No sections yet. Click "+ Add Section" to start.'})}),o.length>0&&t.jsx("div",{className:"d-grid gap-2",children:o.map((ae,re)=>t.jsxs(R,{className:"border section-card",onDragOver:je,onDrop:M=>H(M,re),children:[t.jsxs(R.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>D(re),"aria-expanded":!d[re],children:[t.jsxs("div",{className:"d-flex flex-column",children:[t.jsxs("div",{className:"section-title fw-bold",children:[d[re]?t.jsx(Hn,{size:16}):t.jsx(Cr,{size:16}),ae.label,t.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge",children:ae.fields?.length||0})]}),t.jsxs("small",{className:"text-muted",children:["Order: ",ae.displayOrder||re+1,"  Edit by: ",ae.editBy||"TRAINER"]})]}),t.jsx("div",{onClick:M=>M.stopPropagation(),children:t.jsx(se,{size:"sm",variant:"outline-danger",onClick:()=>z(re),disabled:a,children:"Remove"})})]}),!d[re]&&t.jsx(R.Body,{className:"section-body",children:ae.fields&&ae.fields.length>0?(()=>{const M=[...ae.fields],_e=M.filter(ce=>Y(ce)?(ce.parentTempId&&console.error(` PART field ${ce.name} has parentTempId: ${ce.parentTempId} - This should be null!`),!0):!ce.parentTempId||ce.parentTempId===null||ce.parentTempId==="");console.log(` Section ${re} fields analysis:`,{totalFields:M.length,topLevelCount:_e.length,topLevelFields:_e.map(ce=>({name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId,parentTempId:ce.parentTempId,isPart:Y(ce)})),allFields:M.map(ce=>({name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId,parentTempId:ce.parentTempId,isPart:Y(ce)}))}),_e.forEach(ce=>{Y(ce)&&ce.parentTempId&&console.error(` CRITICAL BUG: PART field ${ce.name} in topLevel has parentTempId: ${ce.parentTempId}`,ce)});const ke=M.filter(Y);ke.forEach((ce,Se)=>{ke.forEach((Me,Ve)=>{Se!==Ve&&ce.parentTempId&&Me.tempId&&ce.parentTempId===Me.tempId&&console.error(` CRITICAL: PART field ${ce.name} has parentTempId "${ce.parentTempId}" matching PART ${Me.name}'s tempId "${Me.tempId}"`,{part1:{name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId,parentTempId:ce.parentTempId},part2:{name:Me.name,fieldType:Me.fieldType,tempId:Me.tempId,parentTempId:Me.parentTempId}})})});const ze=(ce,Se,Me=null)=>{const Ve=Y(ce);console.log(` renderRow: ${ce.name} (${ce.fieldType}), realIndex: ${Se}, topLevelIdx: ${Me}, isPart: ${Ve}, parentTempId: ${ce.parentTempId}, tempId: ${ce.tempId}`),Ve&&ce.parentTempId&&(console.error(` CRITICAL: PART field ${ce.name} has parentTempId ${ce.parentTempId} - resetting to null!`,ce),ce.parentTempId=null);const Ue=ce.tempId,Tt=ce.name;Ve&&console.log(` PART field ${ce.name} searching with tempId: "${Ue}", fieldName: "${Tt}"`);let ot=[];if(Ve){if(console.log(` PART field ${ce.name} (tempId: ${Ue}, realIndex: ${Se}) searching for children in ${M.length} total fields:`,{allFields:M.map(Ie=>({name:Ie.name,fieldType:Ie.fieldType,isPart:Y(Ie),parentTempId:Ie.parentTempId,tempId:Ie.tempId}))}),ot=M.filter(Ie=>{if(Y(Ie))return Ue&&Ie.parentTempId===Ue&&console.error(` CRITICAL: PART field ${Ie.name} has parentTempId "${Ie.parentTempId}" matching PART ${ce.name}'s tempId "${Ue}" - BLOCKED from children!`,{childField:{name:Ie.name,fieldType:Ie.fieldType,tempId:Ie.tempId,parentTempId:Ie.parentTempId},parentField:{name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId}}),!1;if(!Ie.parentTempId||Ie.parentTempId===null||Ie.parentTempId==="")return!1;if(Ue){const pt=Ie.parentTempId===Ue;return pt&&console.log(`   Child match: ${Ie.name} (parentTempId: ${Ie.parentTempId}) matches PART ${ce.name} (tempId: ${Ue})`),pt}const Ke=Ie.parentTempId===Tt&&!Ie.parentTempId?.includes("-parent");return Ke&&console.log(`   Child match by name: ${Ie.name} (parentTempId: ${Ie.parentTempId}) matches PART ${ce.name} (name: ${Tt})`),Ke}),Ve&&ot.length===0&&M.length>0){const Ie=M.filter(Ze=>!Y(Ze)),Ke=Ie.filter(Ze=>Ze.parentTempId),pt=Ke.filter(Ze=>Ze.parentTempId===Ue);console.warn(` PART field ${ce.name} (tempId: ${Ue}) has NO children. Debug info:`,{totalFields:M.length,totalNonPartFields:Ie.length,fieldsWithParent:Ke.length,fieldsMatchingThisPart:pt.length,fieldsWithParentDetails:Ke.map(Ze=>({name:Ze.name,fieldType:Ze.fieldType,parentTempId:Ze.parentTempId,expected:Ue,matches:Ze.parentTempId===Ue,duplicateNames:M.filter(ts=>!Y(ts)&&ts.name===Ze.name&&ts!==Ze).map(ts=>({name:ts.name,parentTempId:ts.parentTempId,belongsTo:M.find(Ks=>Y(Ks)&&(Ks.tempId===ts.parentTempId||Ks.name===ts.parentTempId))?.name||"unknown"}))})),allFieldsInSection:ae.fields.map(Ze=>({name:Ze.name,fieldType:Ze.fieldType,tempId:Ze.tempId,parentTempId:Ze.parentTempId,isPart:Y(Ze)}))}),pt.length>0&&console.error(` CRITICAL: Found ${pt.length} fields with parentTempId="${Ue}" but filter returned 0!`,{matchingFields:pt,fieldTempId:Ue,fieldName:Tt})}ot.length>0?console.log(` PART field ${ce.name} (tempId: ${Ue}, realIndex: ${Se}) has ${ot.length} children:`,ot.map(Ie=>({name:Ie.name,fieldType:Ie.fieldType,parentTempId:Ie.parentTempId,expectedParentTempId:Ue,matches:Ie.parentTempId===Ue}))):Ve&&console.log(` PART field ${ce.name} (tempId: ${Ue}, realIndex: ${Se}) has NO children`)}const he=!Ve&&ce.parentTempId&&ce.parentTempId!==null&&ce.parentTempId!=="";Ve&&he&&console.error(` CRITICAL BUG: PART field ${ce.name} is marked as child! parentTempId: ${ce.parentTempId}`,ce);const me=Ve?!0:!he,Be=Ie=>{if(he){Ie.preventDefault();return}if(U({sectionIndex:re,fromIndex:Se,overIndex:Se,position:"above"}),Ve){const Ke=M.filter(Ze=>Y(Ze)?!1:Ue?Ze.parentTempId===Ue:Ze.parentTempId===Tt&&!Ze.parentTempId?.includes("-parent")),pt=[ce,...Ke];Ie.dataTransfer.setData("text/plain",JSON.stringify(pt)),Ie.dataTransfer.effectAllowed="move"}else Ie.dataTransfer.setData("text/plain",JSON.stringify(ce)),Ie.dataTransfer.effectAllowed="move"},ht=Ie=>{if(_.sectionIndex!==re||_.fromIndex===null)return;Ie.preventDefault(),Ie.stopPropagation();const Ke=Ie.currentTarget.getBoundingClientRect(),pt=Ke.top+Ke.height/2,Ze=Ie.clientY<pt?"above":"below";let ts=Se;Ze==="below"&&(ts=Se+1),(_.overIndex!==ts||_.position!==Ze)&&U(Ks=>({...Ks,overIndex:ts,position:Ze}))},tt=Ie=>{if(_.sectionIndex!==re||_.fromIndex===null)return;Ie.preventDefault(),Ie.stopPropagation();const Ke=Math.max(0,Math.min(_.overIndex,ae.fields.length||0));W(re,_.fromIndex,Ke),U({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},Xe=_.sectionIndex===re&&_.fromIndex===Se,Rt=_.sectionIndex===re&&_.overIndex===Se,We=Rt&&_.position==="above"?"drop-target-above":Rt&&_.position==="below"?"drop-target-below":"",at=`${re}-topLevel-${ce.name}-${ce.tempId||ce.name||Se}`;return Ve&&console.log(` Key for PART field ${ce.name}: ${at}`),t.jsxs("div",{className:`p-2 rounded border mb-2 field-card-item ${Ve?"bg-part part-field-top-level":""} ${he?"field-child":""} ${Xe?"dragging":""} ${We}`,"data-field-name":ce.name,"data-field-type":ce.fieldType,"data-is-part":Ve,"data-is-child":he,"data-parent-temp-id":ce.parentTempId||"","data-render-index":Se,"data-top-level-index":Me!==null?Me:-1,style:{marginLeft:Ve?"0px":he?"1rem":"0px",cursor:me?"grab":"default",opacity:Xe?.5:me?1:.8,transition:"all 0.12s ease"},draggable:me,onDragStart:me?Be:void 0,onDragOver:me?ht:void 0,onDrop:me?tt:void 0,onDragEnd:()=>U({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[t.jsxs("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[ce.label," ",Ve&&t.jsx("span",{className:"badge part-badge",children:"PART"})]}),t.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[ce.name," (",ce.fieldType,")",ce.roleRequired?` - ${ce.roleRequired}`:""]})]}),t.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[t.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>L(re,Se),disabled:a,title:"Edit Field",className:"text-primary border-primary",children:t.jsx(bs,{size:14})}),t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const Ie=[...o];Ie[re].fields=Ie[re].fields.filter((Ke,pt)=>pt!==Se),c(Ie)},disabled:a,title:"Remove Field",className:"text-danger border-danger",children:t.jsx(Ge,{size:14})})]})]}),t.jsx("div",{className:"d-grid",children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e(ce.name),disabled:a,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[t.jsx(wn,{className:"me-1",size:14}),"Insert Field"]})}),Ve&&ot.length>0&&t.jsx("div",{className:"mt-2 part-children",style:{borderLeft:"3px dashed rgba(13, 110, 253, 0.35)",marginLeft:"0.5rem",paddingLeft:"0.75rem"},"data-part-parent":ce.name,"data-part-tempid":ce.tempId,"data-part-render-index":Se,children:(console.log(` Rendering ${ot.length} children for PART ${ce.name} (tempId: ${ce.tempId}, realIndex: ${Se}):`,ot.map(Ie=>({name:Ie.name,fieldType:Ie.fieldType,parentTempId:Ie.parentTempId,isPart:Y(Ie)}))),ot.map(Ie=>{if(Y(Ie))return console.error(` CRITICAL BUG: Attempted to render PART field ${Ie.name} (${Ie.fieldType}) as child of PART field ${ce.name} (${ce.fieldType})!`,{child:{name:Ie.name,fieldType:Ie.fieldType,tempId:Ie.tempId,parentTempId:Ie.parentTempId},parent:{name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId},childrenArray:ot.map(Ze=>({name:Ze.name,fieldType:Ze.fieldType,isPart:Y(Ze)}))}),null;console.log(`   Rendering child: ${Ie.name} (${Ie.fieldType}) inside PART ${ce.name}`);const Ke=ae.fields.indexOf(Ie),pt=`${re}-child-${ce.tempId||ce.name}-${Ie.name}-${Ie.tempId||Ke}`;return console.log(`   Key for child ${Ie.name} of PART ${ce.name}: ${pt}`),t.jsxs("div",{className:"p-2 rounded border mb-2 field-card-item","data-child-parent":ce.name,"data-child-parent-tempid":ce.tempId,"data-child-name":Ie.name,style:{marginLeft:"0",cursor:"default",opacity:.8},draggable:!1,children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[t.jsx("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Ie.label}),t.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[Ie.name," (",Ie.fieldType,")",Ie.roleRequired?` - ${Ie.roleRequired}`:""]})]}),t.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[t.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>L(re,Ke),disabled:a,title:"Edit Field",className:"text-primary border-primary",children:t.jsx(bs,{size:14})}),t.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const Ze=[...o];Ze[re].fields=Ze[re].fields.filter((ts,Ks)=>Ks!==Ke),c(Ze)},disabled:a,title:"Remove Field",className:"text-danger border-danger",children:t.jsx(Ge,{size:14})})]})]}),t.jsx("div",{className:"d-grid",children:t.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e(Ie.name),disabled:a,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[t.jsx(wn,{className:"me-1",size:14}),"Insert Field"]})})]},pt)}))},`${re}-part-children-${ce.tempId||ce.name}-${Se}`)]},at)};return console.log(` Rendering ${_e.length} topLevel fields for section ${re}:`,_e.map(ce=>({name:ce.name,fieldType:ce.fieldType,tempId:ce.tempId,parentTempId:ce.parentTempId}))),t.jsx(t.Fragment,{children:_e.map((ce,Se)=>{const Me=ae.fields.indexOf(ce);return Y(ce)&&ce.parentTempId&&console.error(` CRITICAL BUG: Rendering PART field ${ce.name} with parentTempId ${ce.parentTempId} as topLevel!`,ce),console.log(` Rendering topLevel[${Se}]: ${ce.name} (${ce.fieldType}), tempId: ${ce.tempId}, parentTempId: ${ce.parentTempId}, isPart: ${Y(ce)}`),ze(ce,Me,Se)})})})():t.jsx(Ae,{variant:"light",className:"mb-0",children:t.jsx("small",{children:"No fields in this section. Drag fields here."})})})]},re))})]})}),t.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:t.jsxs("div",{className:"p-2",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[t.jsx("style",{children:`
              .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
              .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
              .part-children { border-left: 3px dashed rgba(13, 110, 253, 0.35); margin-left: 0.5rem; padding-left: 0.75rem; }
              /* CRITICAL: Force PART fields to have no margin - they are always top-level */
              .part-field-top-level { margin-left: 0 !important; padding-left: 0 !important; }
              .part-field-top-level::before { display: none !important; }
              /* Ensure children have proper indentation */
              .field-child { margin-left: 1rem !important; }
            `}),t.jsx("div",{className:"text-muted small mb-2",children:"Fields"}),i?.length?(()=>{const ae=[...i].sort((ke,ze)=>(ke.displayOrder||0)-(ze.displayOrder||0)),re=ke=>!!ke.parentTempId,M=ae.filter(ke=>!re(ke)),_e=ke=>{const ze=Y(ke),ce=q(ke),Se=ae.filter(Ue=>Ue.parentTempId===ce),Ve=!(!ze&&ke.parentTempId&&ke.parentTempId!==null&&ke.parentTempId!=="");return t.jsxs("div",{className:"mb-2",children:[t.jsx(R,{className:`mb-2 ${ze?"bg-part":""}`,draggable:Ve,onDragStart:Ve?Ue=>K(Ue,ke):void 0,style:{cursor:Ve?"grab":"default",opacity:Ve?1:.8},children:t.jsxs(R.Body,{className:"py-2 px-2",children:[t.jsx("div",{className:"d-flex justify-content-between align-items-start mb-2",children:t.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[t.jsxs("div",{className:"fw-bold",style:{fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[ke.label," ",ze&&t.jsx("span",{className:"badge part-badge ms-1",children:"PART"})]}),t.jsxs("div",{className:"text-muted",style:{fontSize:"0.8rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[ke.name," (",ke.fieldType,")"]})]})}),t.jsx("div",{className:"d-grid",children:t.jsx(se,{size:"sm",variant:"outline-primary",onClick:()=>e(ke.name),disabled:a,className:"insert-field-btn",children:"Insert Field"})})]})}),ze&&Se.length>0&&t.jsx("div",{className:"part-children",children:Se.map(Ue=>_e(Ue))})]},ke.name)};return M.map(ke=>_e(ke))})():t.jsx(Ae,{variant:"light",className:"m-0",children:"No extracted fields."})]})})]}),t.jsxs(le,{show:f,onHide:V,children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Add New Section"})}),t.jsx(le.Body,{children:t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{children:["Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Basic Information",value:y.name,onChange:ae=>T(re=>({...re,name:ae.target.value})),required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"Display label",value:y.label,onChange:ae=>T(re=>({...re,label:ae.target.value})),required:!0})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Edit By"}),t.jsx(E.Select,{value:y.editBy,onChange:ae=>{const re=ae.target.value;T(M=>({...M,editBy:re,roleInSubject:re==="TRAINEE"?"":M.roleInSubject}))},children:k.map(ae=>t.jsx("option",{value:ae,children:ae},ae))})]})}),y.editBy==="TRAINER"&&t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Role In Subject"}),t.jsxs(E.Select,{value:y.roleInSubject||"ASSESSMENT_REVIEWER",onChange:ae=>T(re=>({...re,roleInSubject:ae.target.value})),children:[t.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),t.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{className:"d-flex flex-row align-items-center gap-4",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(E.Check,{type:"checkbox",checked:y.isSubmittable,onChange:ae=>T(re=>({...re,isSubmittable:ae.target.checked})),id:"section-submittable"}),t.jsx(E.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(E.Check,{type:"checkbox",checked:y.isToggleDependent,onChange:ae=>T(re=>({...re,isToggleDependent:ae.target.checked})),id:"section-toggle-dependent"}),t.jsx(E.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:V,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:B,children:"Save Section"})]})]}),t.jsxs(le,{show:p,onHide:ue,size:"lg",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Edit Field"})}),t.jsx(le.Body,{style:{maxHeight:"400px",overflowY:"auto"},children:C&&t.jsx(E,{children:t.jsxs(oe,{className:"g-3",children:[t.jsx(F,{md:12,children:t.jsxs(Ae,{variant:"light",className:"py-2",children:["Editing field in section: ",t.jsx("strong",{children:v!==null?o[v]?.label:"N/A"})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{children:["Label ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:"e.g., Crew Communication",value:C.label||"",onChange:ae=>w(re=>({...re,label:ae.target.value})),required:!0}),t.jsx(E.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{children:["Field Name ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(E.Control,{type:"text",placeholder:C.fieldType==="PART"?"e.g., Assessment_Items":C.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:C.name||"",onChange:ae=>w(re=>({...re,name:ae.target.value})),required:!0}),t.jsx(E.Text,{className:"text-muted",children:C.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':C.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsxs(E.Label,{children:["Field Type ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsxs(E.Select,{value:C.fieldType||"TEXT",onChange:ae=>w(re=>({...re,fieldType:ae.target.value})),required:!0,children:[t.jsx("option",{value:"TEXT",children:"TEXT"}),t.jsx("option",{value:"PART",children:"PART"}),t.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),t.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),t.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Role Required"}),t.jsx(E.Control,{type:"text",value:v!==null&&o[v]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"}}),t.jsx(E.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Parent Template ID"}),t.jsx(E.Control,{type:"text",placeholder:"Leave empty for root level",value:C.parentTempId||"",onChange:ae=>w(re=>({...re,parentTempId:ae.target.value||null}))})]})}),C.tempId&&t.jsx(F,{md:12,children:t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Template ID (read-only)"}),t.jsx(E.Control,{type:"text",value:C.tempId,readOnly:!0,disabled:!0}),t.jsx(E.Text,{className:"text-muted",children:"This is the unique identifier for PART fields. It cannot be changed."})]})})]})})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"outline-secondary",onClick:ue,children:"Cancel"}),t.jsx(se,{variant:"primary",onClick:ne,children:"Save Changes"})]})]})]})},Zk=({initialContent:e="",fileName:r="Untitled Document",readOnly:s=!1,showMergeFields:a=!0,showImportInfo:n=!1,importType:i="",className:l=""})=>{const[o,c]=b.useState(!0),[d,m]=b.useState(null),[u,h]=b.useState(!1),[p,x]=b.useState([]),[f,g]=b.useState(!0),v=b.useRef(!1),N=b.useRef(null),j=b.useRef(null),S=b.useCallback(()=>{if(v.current=!1,N.current)try{typeof N.current.destroy=="function"&&N.current.destroy()}catch(_){console.warn("Error destroying editor:",_)}},[]);b.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const C="bd9aaaaddaf94061b51e976a8fd335ce",w=async _=>{try{const D=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),W=btoa(JSON.stringify(_)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),q=`${D}.${W}`,Y=new TextEncoder,K=await crypto.subtle.importKey("raw",Y.encode(C),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),H=await crypto.subtle.sign("HMAC",K,Y.encode(q)),je=btoa(String.fromCharCode(...new Uint8Array(H))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),ie=`${D}.${W}.${je}`;return console.log(" Generated JWT Token (Hardcoded):",ie),ie}catch(U){return console.error("Error generating JWT token:",U),null}};b.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),c(!1);return}if(v.current){console.log(" Editor already initialized, skipping...");return}return v.current=!0,(async()=>{try{let U=0;const D=10;await new Promise((B,V)=>{const z=()=>{typeof window.DocsAPI<"u"?B():U<D?(U++,console.log(` Waiting for OnlyOffice API... (${U}/${D})`),setTimeout(z,500)):V(new Error("OnlyOffice API failed to load after 5 seconds"))};z()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const q=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,K=await w({document:{key:q,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"}}}),H={document:{fileType:"docx",key:q,title:r,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},mode:"edit"},token:K,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),h(!0)},onDocumentReady:()=>{console.log(" Document is loaded")},onError:B=>{console.error(" OnlyOffice Error:",B),de.error("Error loading document: "+(B.data?.errorDescription||"Unknown error"))},onDocumentStateChange:B=>{console.log(" Document state changed:",B)},onInfo:B=>{console.log(" OnlyOffice opened in mode:",B.data?.mode)},onRequestSaveAs:async B=>{try{const V=B?.data||{};console.log(" onRequestSaveAs event received:",V);const z=V.url||V.downloadUrl||V.fileUrl||(Array.isArray(V.files)?V.files[0]?.url:void 0)||V.file&&V.file.url;console.log(" Extracted temporary DOCX URL:",z),z||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(V,null,2))),j.current&&(z?j.current.resolve(z):j.current.reject(new Error("onRequestSaveAs event received but no URL found")),j.current=null)}catch(V){console.error(" Error in onRequestSaveAs handler:",V),j.current&&(j.current.reject(V),j.current=null)}},onRequestSave:B=>{try{const V=B?.data||{};console.log(" onRequestSave event received:",V);const z=V.url||V.downloadUrl||V.fileUrl;z&&j.current&&(console.log(" Using URL from onRequestSave:",z),j.current.resolve(z),j.current=null)}catch(V){console.error(" Error in onRequestSave handler:",V)}}}},je=new window.DocsAPI.DocEditor("onlyoffice-editor",H);m(je),N.current=je,c(!1);const ie=B=>{B.data&&B.data.type==="insertText"&&console.log(" Received insert text message:",B.data)};return window.addEventListener("message",ie,{passive:!0}),()=>{window.removeEventListener("message",ie)}}catch(U){console.error("Error initializing OnlyOffice editor:",U),de.error("Failed to initialize editor"),c(!1)}})(),S},[e,r,S]);const y=_=>{if(d&&u)try{if(typeof d.createConnector=="function")try{const U=d.createConnector();if(typeof d.asc_enableKeyEvents=="function")try{d.asc_enableKeyEvents(!0)}catch{}if(U&&U.isConnected)try{Asc.scope.__templateText=typeof _=="string"&&_.includes("{")?_:`{${_}}`,U.callCommand(function(){try{const D=Api.GetDocument(),W=Api.CreateParagraph();W.AddText(Asc.scope.__templateText),D.InsertContent([W])}catch(D){console.error("Error inside callCommand:",D)}},function(){requestAnimationFrame(()=>{de.success("Inserted template at cursor position")})},function(D){de.error("Failed to insert field: "+D.message)});return}catch{de.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(U){console.error("Error inserting field:",U),de.error("Failed to insert field: "+U.message)}else d?u||de.warning("Editor is still loading, please wait..."):de.warning("Editor not initialized yet")},T=b.useCallback(()=>new Promise((_,U)=>{try{if(!N.current){U(new Error("Editor not initialized"));return}if(j.current={resolve:_,reject:U},typeof N.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{N.current.downloadDocument()}catch(D){console.warn("downloadDocument() failed, trying downloadAs()...",D)}}if(typeof N.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{N.current.downloadAs("docx")}catch(D){console.warn("downloadAs() failed:",D)}}if(typeof N.current.save=="function"){console.log(" Attempting export via save()...");try{N.current.save()}catch(D){console.warn("save() failed:",D)}}setTimeout(()=>{if(j.current){const D=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");j.current.reject(D),j.current=null}},2e4)}catch(D){j.current?(j.current.reject(D),j.current=null):U(D)}}),[]),k=b.useCallback(async()=>{try{if(!N.current||!u)throw new Error("Editor not ready");de.info("Exporting document...");const _=await T();if(!_)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",_),de.info("Downloading file...");const U=await fetch(_);if(!U.ok)throw new Error(`Failed to fetch file: ${U.statusText}`);const D=await U.blob();console.log(" Downloaded blob:",D.size,"bytes");const W=r.endsWith(".docx")?r:`${r}.docx`,q=new File([D],W,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});de.info("Uploading to S3...");const Y=Ai.getDocsType(W)||"tem",K=await Ai.uploadDocument(q,Y);console.log(" Upload API response:",K);let H=null;if(K?.data?.[0]?.url?(H=K.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",H)):K?.data?.url?(H=K.data.url,console.log(" Found S3 URL in uploadResult.data.url:",H)):K?.url?(H=K.url,console.log(" Found S3 URL in uploadResult.url:",H)):K?.fileUrl?(H=K.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",H)):K?.path&&(H=K.path,console.log(" Found S3 URL in uploadResult.path:",H)),!H)throw console.error(" Upload response structure:",JSON.stringify(K,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",H),console.log(" Full S3 URL:",H),de.success(`Document uploaded successfully!
URL: ${H}`),H}catch(_){throw console.error(" Export and upload failed:",_),de.error(`Failed: ${_.message}`),_}},[T,r,u]);if(o)return t.jsx(R,{className:`border-neutral-200 shadow-sm ${l}`,children:t.jsx(R.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:t.jsxs("div",{className:"text-center",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),t.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),t.jsx("br",{}),t.jsxs("small",{className:"text-muted",children:["Content: ",e?"Available":"Not available"]})]})})});if(!e)return t.jsx(R,{className:`border-neutral-200 shadow-sm ${l}`,children:t.jsx(R.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:t.jsx("div",{className:"text-center",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx("strong",{children:"No Document URL"}),t.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const P=(_,U)=>{Array.isArray(_)?(x(_),U?.silent||de.success("Fields updated successfully")):(x(D=>[...D,_]),U?.silent||de.success(`Added field: ${_.label}`))},A=_=>{x(U=>U.filter((D,W)=>W!==_)),de.success("Field removed")};return t.jsx("div",{className:`onlyoffice-form-editor ${l}`,children:t.jsxs("div",{className:"p-0",children:[n&&t.jsxs(Ae,{variant:"info",className:"mb-0 rounded-0",children:["You are editing an imported form: ",t.jsx("strong",{children:i}),i==="File without fields"&&t.jsx("div",{className:"mt-2",children:t.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>g(!f),children:f?"Hide Custom Fields":"Show Custom Fields"})})]}),t.jsxs(oe,{className:"g-0",style:{minHeight:"90vh"},children:[t.jsx(F,{md:a&&(i==="File without fields"&&f||i!=="File without fields")?9:12,children:t.jsxs("div",{className:"p-3",style:{height:"90vh"},children:[t.jsx("div",{className:"d-flex justify-content-end mb-2"}),t.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),a&&i!=="File without fields"&&t.jsx(F,{md:3,className:"border-start",style:{overflow:"hidden"},children:t.jsx("div",{style:{height:"90vh",overflowY:"auto"},children:t.jsx(Jk,{onInsertField:y,exportEditedDoc:T,initialUrl:e,readOnly:s,className:"h-100"})})}),a&&i==="File without fields"&&f&&t.jsx(F,{md:3,className:"border-start",children:t.jsx("div",{style:{height:"90vh",overflowY:"auto"},children:t.jsx(Xk,{customFields:p,onAddField:P,onRemoveField:A,onInsertField:y,exportEditedDoc:T,exportAndUploadEditedDoc:k,readOnly:s,className:"h-100"})})})]})]})})},Qk=()=>{const e=qe(),r=wa(),[s,a]=b.useState(""),[n,i]=b.useState("Untitled Document"),[l,o]=b.useState("");b.useEffect(()=>{if(r.state){const{content:d,documentUrl:m,fileName:u,importType:h}=r.state,p=m||d||"";a(p),i(u||"Untitled Document"),o(h||""),console.log(" FormEditorPage received:",{documentUrl:m,content:d,fileName:u,finalContent:p})}},[r.state]);const c=()=>{e("/admin/forms")};return t.jsx(Ht,{permission:be.TEMPLATES.CREATE,fallback:t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("h4",{children:"Access Denied"}),t.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:t.jsx(Ee,{fluid:!0,className:"py-4 form-editor-page form-component",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,md:8,children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(se,{variant:"outline-secondary",onClick:c,className:"me-3",size:"sm",children:t.jsx(bt,{size:16})}),t.jsxs("div",{children:[t.jsx("h4",{className:"mb-0 text-primary-custom",children:n}),l&&t.jsxs("small",{className:"text-muted",children:["Import Type: ",l]})]})]})})})}),t.jsx(R.Body,{className:"p-0",children:t.jsx(Zk,{initialContent:s,fileName:n,showImportInfo:!!l,importType:l})})]})})})},eA=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=eA,document.head.appendChild(e)}const tA=({traineeId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),{sortedData:l,sortConfig:o,handleSort:c}=Ot(s);b.useEffect(()=>{d()},[e]);const d=async()=>{try{i(!0);const h=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(p=>setTimeout(p,300)),a(h)}catch(h){console.error("Error loading signature required:",h),de.error("Failed to load signature requirements")}finally{i(!1)}},m=h=>{const x={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[h]||{variant:"secondary",text:h};return t.jsx(Te,{bg:x.variant,children:x.text})},u=h=>{e?r(`/trainee/${e}/signature-pad/${h}`):de.error("Unable to open signature pad: Trainee ID not found")};return n?t.jsx("div",{className:"text-center py-4",children:t.jsx(It,{count:5})}):s.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Fr,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):t.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Document",sortKey:"name",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Course",sortKey:"course",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Status",sortKey:"status",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:l.map(h=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.name})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.course})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.subject})}),t.jsx("td",{children:new Date(h.dueDate).toLocaleDateString()}),t.jsx("td",{children:m(h.status)}),t.jsx("td",{children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"Sign Document",icon:t.jsx(Fr,{}),onClick:()=>u(h.id)}]})})]},h.id))})]})})},sA=()=>{const{user:e}=Us();return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(tA,{traineeId:e?.id})})},rA=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=rA,document.head.appendChild(e)}const aA=({traineeId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),{sortedData:l,sortConfig:o,handleSort:c}=Ot(s);b.useEffect(()=>{d()},[e]);const d=async()=>{try{i(!0);const h=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(p=>setTimeout(p,300)),a(h)}catch(h){console.error("Error loading section completion:",h),de.error("Failed to load section completion requirements")}finally{i(!1)}},m=h=>{const x={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[h]||{variant:"secondary",text:h};return t.jsx(Te,{bg:x.variant,children:x.text})},u=h=>{e?r(`/trainee/${e}/assessment-section/${h}`):de.error("Unable to open section: Trainee ID not found")};return n?t.jsx("div",{className:"text-center py-4",children:t.jsx(It,{count:5})}):s.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(rt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):t.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Section",sortKey:"name",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Course",sortKey:"course",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Type",sortKey:"section",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Progress",sortKey:"progress",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Status",sortKey:"status",sortConfig:o,onSort:c})}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:l.map(h=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.name})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.course})}),t.jsx("td",{children:t.jsx("div",{className:"fw-semibold",children:h.subject})}),t.jsx("td",{children:t.jsx(Te,{bg:"primary",className:"fw-normal",children:h.section})}),t.jsx("td",{children:new Date(h.dueDate).toLocaleDateString()}),t.jsx("td",{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-primary",style:{width:`${h.progress}%`}})}),t.jsxs("small",{className:"text-muted",children:[h.progress,"%"]})]})}),t.jsx("td",{children:m(h.status)}),t.jsx("td",{children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:h.status==="COMPLETED"?"View Section":"Complete Section",icon:h.status==="COMPLETED"?t.jsx(xt,{}):t.jsx(rt,{}),onClick:()=>u(h.id)}]})})]},h.id))})]})})},n0=()=>{const{user:e}=Us();return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(aA,{traineeId:e?.id})})},nA=({uniqueTypes:e,uniqueStatuses:r,uniquePriorities:s,selectedTypes:a,selectedStatuses:n,selectedPriorities:i,onTypeToggle:l,onStatusToggle:o,onPriorityToggle:c,onClearFilters:d,className:m=""})=>{const u=a.length>0||n.length>0||i.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown course-filter-dropdown ${m}`,children:[t.jsx(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",u&&t.jsx("span",{className:"badge bg-primary ms-2",children:a.length+n.length+i.length})]})}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),a.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(h=>t.jsx(E.Check,{type:"checkbox",id:`type-${h}`,label:h,checked:a.includes(h),onChange:()=>l(h),className:"mb-1"},h))})]}),t.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(h=>t.jsx(E.Check,{type:"checkbox",id:`status-${h}`,label:h,checked:n.includes(h),onChange:()=>o(h),className:"mb-1"},h))})]}),t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),i.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:s.map(h=>t.jsx(E.Check,{type:"checkbox",id:`priority-${h}`,label:h,checked:i.includes(h),onChange:()=>c(h),className:"mb-1"},h))})]}),u&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:d,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Nf=document.createElement("style");Nf.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(Nf);const iA=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=iA,document.head.appendChild(e)}const lA=({traineeId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(""),[c,d]=b.useState([]),[m,u]=b.useState([]),[h,p]=b.useState([]),{sortedData:x,sortConfig:f,handleSort:g}=Ot(s);b.useEffect(()=>{v()},[e]);const v=async()=>{try{i(!0);const W=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(q=>setTimeout(q,300)),a(W)}catch(W){console.error("Error loading assessments:",W),de.error("Failed to load assessments")}finally{i(!1)}},N=b.useMemo(()=>s.filter(W=>{const q=l===""||W.name.toLowerCase().includes(l.toLowerCase())||W.description.toLowerCase().includes(l.toLowerCase())||W.course?.name.toLowerCase().includes(l.toLowerCase())||W.subject?.name.toLowerCase().includes(l.toLowerCase()),Y=c.length===0||c.includes(W.type),K=m.length===0||m.includes(W.status),H=h.length===0||h.includes(W.priority);return q&&Y&&K&&H}),[s,l,c,m,h]),j=b.useMemo(()=>[...new Set(s.map(q=>q.type))].filter(Boolean),[s]),S=b.useMemo(()=>[...new Set(s.map(q=>q.status))].filter(Boolean),[s]),C=b.useMemo(()=>[...new Set(s.map(q=>q.priority))].filter(Boolean),[s]),w=W=>{o(W.target.value)},y=W=>{d(q=>q.includes(W)?q.filter(Y=>Y!==W):[...q,W])},T=W=>{u(q=>q.includes(W)?q.filter(Y=>Y!==W):[...q,W])},k=W=>{p(q=>q.includes(W)?q.filter(Y=>Y!==W):[...q,W])},P=()=>{d([]),u([]),p([]),o("")},A=W=>{const Y={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[W]||{variant:"secondary",text:W};return t.jsx(Te,{bg:Y.variant,children:Y.text})},_=W=>{const Y={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[W]||{variant:"secondary",text:W};return t.jsx(Te,{bg:Y.variant,children:Y.text})},U=W=>{r(`/trainee/${e}/assessment/${W.id}`)},D=W=>{r(`/trainee/${e}/assessment/${W.id}`)};return n?t.jsx("div",{className:"text-center py-4",children:t.jsx(It,{count:8})}):t.jsx("div",{className:"trainee-your-assessments",children:t.jsx(R,{className:"shadow-sm",children:t.jsx(R.Body,{className:"p-0",children:t.jsxs(gc,{defaultActiveKey:"upcoming",className:"border-bottom",children:[t.jsx(qt,{eventKey:"upcoming",title:"Upcoming Assessments",children:t.jsxs("div",{className:"p-3",children:[t.jsx("div",{style:{marginBottom:"3rem"},children:t.jsxs(oe,{className:"form-mobile-stack",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search assessments by name, description, course, or subject...",value:l,onChange:w,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(nA,{uniqueTypes:j,uniqueStatuses:S,uniquePriorities:C,selectedTypes:c,selectedStatuses:m,selectedPriorities:h,onTypeToggle:y,onStatusToggle:T,onPriorityToggle:k,onClearFilters:P,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[N.length," assessment",N.length!==1?"s":""]})})})]})}),N.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(vt,{size:32,className:"text-muted mb-2"}),t.jsx("p",{className:"text-muted mb-0",children:s.length===0?"No upcoming assessments":"No assessments match your filters"})]}):t.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Assessment",sortKey:"name",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Course",sortKey:"course",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Subject",sortKey:"subject",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Type",sortKey:"type",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Priority",sortKey:"priority",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Due Date",sortKey:"dueDate",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:t.jsx(Bt,{title:"Status",sortKey:"status",sortConfig:f,onSort:g})}),t.jsx("th",{className:"text-start",children:"Actions"})]})}),t.jsx("tbody",{children:x.map(W=>t.jsxs("tr",{children:[t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:W.name}),t.jsx("small",{className:"text-muted",children:W.description})]}),t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:W.course?.name||"N/A"}),t.jsx("small",{className:"text-muted",children:W.course?.code||""})]}),t.jsxs("td",{children:[t.jsx("div",{className:"fw-semibold",children:W.subject?.name||"N/A"}),t.jsx("small",{className:"text-muted",children:W.subject?.code||""})]}),t.jsx("td",{children:t.jsx(Te,{bg:"primary",className:"fw-normal",children:W.type||"Assessment"})}),t.jsx("td",{children:_(W.priority)}),t.jsx("td",{children:W.dueDate?new Date(W.dueDate).toLocaleDateString():"N/A"}),t.jsx("td",{children:A(W.status)}),t.jsx("td",{children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:W.status==="PENDING"||W.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:W.status==="PENDING"||W.status==="IN_PROGRESS"?t.jsx(jc,{}):t.jsx(xt,{}),onClick:()=>W.status==="PENDING"||W.status==="IN_PROGRESS"?U(W):D(W)}]})})]},W.id))})]})})]})}),t.jsx(qt,{eventKey:"completed",title:"Completed Assessments",children:t.jsx("div",{className:"p-3",children:t.jsx(pd,{traineeId:e})})})]})})})})},i0=()=>{const{user:e}=Us();return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(lA,{traineeId:e?.id})})},oA=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=oA,document.head.appendChild(e)}const cA=()=>{const[e,r]=b.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[s,a]=b.useState(!1),n=l=>{const{name:o,value:c,type:d,checked:m}=l.target;r(u=>({...u,[o]:d==="checkbox"?m:c}))},i=async l=>{l.preventDefault(),a(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(o=>setTimeout(o,1e3)),de.success("Incident/Feedback report submitted successfully!"),r({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(o){console.error("Error submitting incident/feedback report:",o),de.error("Failed to submit incident/feedback report. Please try again.")}finally{a(!1)}};return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),t.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})})})}),t.jsxs(oe,{className:"mt-4",children:[t.jsx(F,{lg:8,children:t.jsxs(R,{className:"border-0 shadow-sm create-issue-form",children:[t.jsx(R.Header,{children:t.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[t.jsx($s,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),t.jsx(R.Body,{children:t.jsxs(E,{onSubmit:i,children:[t.jsxs(oe,{children:[t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Title"}),t.jsx(E.Control,{type:"text",name:"title",value:e.title,onChange:n,placeholder:"Brief description of the incident or feedback"})]})}),t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Request Type *"}),t.jsxs(E.Select,{name:"request_type",value:e.request_type,onChange:n,required:!0,children:[t.jsx("option",{value:"",children:"Select request type"}),t.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),t.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),t.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),t.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),t.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),t.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),t.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),t.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),t.jsx(oe,{children:t.jsx(F,{md:6,children:t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Severity"}),t.jsxs(E.Select,{name:"severity",value:e.severity,onChange:n,children:[t.jsx("option",{value:"LOW",children:"Low"}),t.jsx("option",{value:"MEDIUM",children:"Medium"}),t.jsx("option",{value:"HIGH",children:"High"}),t.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Description"}),t.jsx(E.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:n,placeholder:"Please provide detailed information about the incident or feedback..."})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Actions Taken"}),t.jsx(E.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:n,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),t.jsx(E.Group,{className:"mb-4",children:t.jsx(E.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:n,label:"Submit anonymously (your identity will be kept confidential)"})}),t.jsx("div",{className:"d-flex justify-content-end",children:t.jsx(se,{type:"submit",variant:"primary",disabled:s,children:s?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):t.jsxs(t.Fragment,{children:[t.jsx(S0,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),t.jsx(F,{lg:4,children:t.jsxs(R,{className:"border-0 shadow-sm create-issue-guidelines",children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Guidelines"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{children:"Before submitting:"}),t.jsxs("ul",{className:"small text-muted mb-0",children:[t.jsx("li",{children:"Check if the incident has already been reported"}),t.jsx("li",{children:"Provide clear and specific details"}),t.jsx("li",{children:"Include steps to reproduce the incident"}),t.jsx("li",{children:"Attach screenshots if applicable"})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{children:"Response time:"}),t.jsxs("ul",{className:"small text-muted mb-0",children:[t.jsx("li",{children:"High priority: Within 24 hours"}),t.jsx("li",{children:"Medium priority: Within 2-3 days"}),t.jsx("li",{children:"Low priority: Within 1 week"})]})]}),t.jsxs(Ae,{variant:"info",className:"small",children:[t.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},dA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(""),[o,c]=b.useState("all");Ot(),b.useEffect(()=>{const x=[{id:1,title:"Safety Procedure Issue",description:"Reported safety concern in training module",reporter:"John Smith",reporterEmail:"john.smith@company.com",status:"open",priority:"high",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T14:20:00Z"},{id:2,title:"Training Material Error",description:"Incorrect information in assessment template",reporter:"Sarah Johnson",reporterEmail:"sarah.johnson@company.com",status:"in_progress",priority:"medium",createdAt:"2024-01-14T09:15:00Z",updatedAt:"2024-01-15T11:45:00Z"},{id:3,title:"System Performance Issue",description:"Slow loading times during assessment",reporter:"Mike Wilson",reporterEmail:"mike.wilson@company.com",status:"resolved",priority:"low",createdAt:"2024-01-13T16:20:00Z",updatedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{s(x),n(!1)},1e3)},[]);const d=x=>{const f={open:{variant:"danger",icon:Wt},in_progress:{variant:"warning",icon:et},resolved:{variant:"success",icon:rt},closed:{variant:"secondary",icon:Ms}},g=f[x]||f.open,v=g.icon;return t.jsxs(Te,{bg:g.variant,className:"d-flex align-items-center",children:[t.jsx(v,{size:12,className:"me-1"}),x.replace("_"," ").toUpperCase()]})},m=x=>{const f={high:"danger",medium:"warning",low:"info"};return t.jsx(Te,{bg:f[x]||"secondary",children:x.toUpperCase()})},u=r.filter(x=>{const f=x.title.toLowerCase().includes(i.toLowerCase())||x.description.toLowerCase().includes(i.toLowerCase())||x.reporter.toLowerCase().includes(i.toLowerCase()),g=o==="all"||x.status===o;return f&&g}),h=x=>{e(`/sqa/issues/${x}`)},p=x=>[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>h(x.id),permission:be.SQA.VIEW_TEMPLATES}];return a?t.jsx(Ee,{className:"py-4",children:t.jsx(It,{})}):t.jsx(Ee,{fluid:!0,className:"py-4 issue-list-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsx("div",{className:"d-flex justify-content-end gap-2",children:t.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Issues"})})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search issues by title, description, or reporter...",value:i,onChange:l,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:x=>c(x.target.value),children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"open",children:"Open"}),t.jsx("option",{value:"in_progress",children:"In Progress"}),t.jsx("option",{value:"resolved",children:"Resolved"}),t.jsx("option",{value:"closed",children:"Closed"})]})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[u.length," issue",u.length!==1?"s":""]})})})]}),t.jsx(Ga,{data:u,loading:a,columns:[{key:"title",title:"Issue Title",className:"show-mobile",sortable:!0},{key:"reporter",title:"Reporter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"priority",title:"Priority",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(x,f)=>t.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:x.title}),t.jsx("small",{className:"text-muted",children:x.description})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:x.reporter}),t.jsx("small",{className:"text-muted",children:x.reporterEmail})]})}),t.jsx("td",{className:"align-middle show-mobile",children:d(x.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:m(x.priority)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(x.createdAt).toLocaleDateString()})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.SQA.VIEW_TEMPLATES],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:p(x)})})})]},x.id),emptyMessage:"No issues found",emptyDescription:"Try adjusting your search criteria."})]})]})})},mA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(""),[o,c]=b.useState("all");Ot(),b.useEffect(()=>{const f=[{id:1,title:"Training Course Feedback",description:"Positive feedback about the safety training course",submitter:"Sarah Johnson",submitterEmail:"sarah.johnson@company.com",status:"acknowledged",category:"training",rating:5,createdAt:"2024-01-15T10:30:00Z",acknowledgedAt:"2024-01-15T14:20:00Z"},{id:2,title:"System Usability Feedback",description:"Suggestions for improving the assessment interface",submitter:"Mike Wilson",submitterEmail:"mike.wilson@company.com",status:"pending",category:"system",rating:4,createdAt:"2024-01-14T09:15:00Z",acknowledgedAt:null},{id:3,title:"Content Quality Feedback",description:"Feedback about the quality of training materials",submitter:"John Smith",submitterEmail:"john.smith@company.com",status:"acknowledged",category:"content",rating:3,createdAt:"2024-01-13T16:20:00Z",acknowledgedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{s(f),n(!1)},1e3)},[]);const d=f=>{const g={pending:{variant:"warning",icon:et},acknowledged:{variant:"success",icon:rt},reviewed:{variant:"info",icon:g0}},v=g[f]||g.pending,N=v.icon;return t.jsxs(Te,{bg:v.variant,className:"d-flex align-items-center",children:[t.jsx(N,{size:12,className:"me-1"}),f.toUpperCase()]})},m=f=>{const g={training:"primary",system:"info",content:"success",general:"secondary"};return t.jsx(Te,{bg:g[f]||"secondary",children:f.toUpperCase()})},u=r.filter(f=>{const g=f.title.toLowerCase().includes(i.toLowerCase())||f.description.toLowerCase().includes(i.toLowerCase())||f.submitter.toLowerCase().includes(i.toLowerCase()),v=o==="all"||f.status===o;return g&&v}),h=f=>{e(`/sqa/feedback/${f}`)},p=f=>{e(`/sqa/feedback/${f}/acknowledge`)},x=f=>[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>h(f.id),permission:be.SQA.VIEW_TEMPLATES},{label:"Acknowledge",icon:t.jsx(rt,{}),onClick:()=>p(f.id),disabled:f.status==="acknowledged"||f.status==="reviewed",permission:be.SQA.VIEW_TEMPLATES}];return a?t.jsx(Ee,{className:"py-4",children:t.jsx(It,{})}):t.jsx(Ee,{fluid:!0,className:"py-4 feedback-list-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsx("div",{className:"d-flex justify-content-end gap-2",children:t.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Feedback"})})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search feedback by title, description, or submitter...",value:i,onChange:l,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:f=>c(f.target.value),children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"acknowledged",children:"Acknowledged"}),t.jsx("option",{value:"reviewed",children:"Reviewed"})]})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[u.length," feedback",(u.length!==1,"")]})})})]}),t.jsx(Ga,{data:u,loading:a,columns:[{key:"title",title:"Feedback Title",className:"show-mobile",sortable:!0},{key:"submitter",title:"Submitter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"category",title:"Category",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(f,g)=>t.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:v=>{v.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:v=>{v.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:f.title}),t.jsx("small",{className:"text-muted",children:f.description})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:f.submitter}),t.jsx("small",{className:"text-muted",children:f.submitterEmail})]})}),t.jsx("td",{className:"align-middle show-mobile",children:d(f.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:m(f.category)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(f.createdAt).toLocaleDateString()})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.SQA.VIEW_TEMPLATES],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:x(f)})})})]},f.id),emptyMessage:"No feedback found",emptyDescription:"Try adjusting your search criteria."})]})]})})},uA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(""),[o,c]=b.useState(""),{sortConfig:d,handleSort:m}=Ot();b.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const v=[{id:"1",name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses",version:"v2.1",category:"SAFETY",sections:5,fields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z"},{id:"2",name:"Technical Skills Evaluation",description:"Template for evaluating technical skills and competencies",version:"v1.5",category:"TECHNICAL",sections:3,fields:15,status:"DRAFT",createdBy:"Sarah Johnson",createdAt:"2024-01-14T00:00:00.000Z"},{id:"3",name:"Compliance Assessment",description:"Template for compliance and regulatory assessments",version:"v3.0",category:"COMPLIANCE",sections:7,fields:31,status:"ACTIVE",createdBy:"Mike Wilson",createdAt:"2024-01-13T00:00:00.000Z"}];await new Promise(N=>setTimeout(N,1e3)),s(v)}catch(v){console.error("Error loading templates:",v)}finally{n(!1)}},h=v=>{switch(v){case"ACTIVE":return{variant:"success",icon:rt,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:et,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:et,text:"INACTIVE"};default:return{variant:"secondary",icon:et,text:v}}},p=v=>{console.log("View detail for template:",v),e(`/sqa/templates/${v}`)},x=v=>{console.log("Disable template:",v)},f=r.filter(v=>{const N=v.name.toLowerCase().includes(i.toLowerCase())||v.description.toLowerCase().includes(i.toLowerCase())||v.createdBy.toLowerCase().includes(i.toLowerCase()),j=!o||v.status===o;return N&&j});if(a)return t.jsx(Ee,{fluid:!0,className:"p-4",children:t.jsx(It,{})});const g=({columnKey:v,children:N,className:j=""})=>{const S=d.key===v,C=S?d.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${j} ${S?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>m(v),onMouseEnter:w=>{w.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",w.target.style.transform="translateY(-1px)",w.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:w=>{w.target.style.backgroundColor="transparent",w.target.style.transform="translateY(0)",w.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:S?"600":"500"},children:N}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:C,size:14})})]}),S&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsx(Ee,{fluid:!0,className:"py-4 template-list-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsxs(oe,{className:"align-items-center",children:[t.jsx(F,{xs:12,md:6,children:t.jsx("div",{})}),t.jsx(F,{xs:12,md:6,className:"mt-2 mt-md-0",children:t.jsx("div",{className:"d-flex justify-content-end gap-2",children:t.jsxs(se,{variant:"outline-primary",size:"sm",className:"d-flex align-items-center",children:[t.jsx(vc,{className:"me-1",size:16}),"Export Templates"]})})})]})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search templates by name, description, or creator...",value:i,onChange:l,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:t.jsxs(E.Select,{value:o,onChange:v=>c(v.target.value),className:"filter-panel-mobile",children:[t.jsx("option",{value:"",children:"All Status"}),t.jsx("option",{value:"ACTIVE",children:"Active"}),t.jsx("option",{value:"DRAFT",children:"Draft"}),t.jsx("option",{value:"INACTIVE",children:"Inactive"})]})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[f.length," template",f.length!==1?"s":""]})})})]}),t.jsxs("div",{className:"position-relative",children:[t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(g,{columnKey:"name",className:"show-mobile",children:"Template Name"}),t.jsx(g,{columnKey:"version",className:"hide-mobile",children:"Version"}),t.jsx("th",{className:"text-primary-custom fw-semibold hide-mobile",children:"Sections/Fields"}),t.jsx(g,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(g,{columnKey:"createdBy",className:"hide-mobile",children:"Created By"}),t.jsx(g,{columnKey:"createdAt",className:"hide-mobile",children:"Created Date"}),t.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:f.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:"7",className:"text-center py-5",children:[t.jsx($s,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No templates found"}),t.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]})}):f.map((v,N)=>{const j=h(v.status),S=j.icon;return t.jsxs("tr",{className:`${N%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor=N%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium text-dark",children:v.name}),t.jsx("div",{className:"text-muted small",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:v.description})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx(Te,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:v.version})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{className:"text-muted small",children:[t.jsxs("div",{children:[v.sections," sections"]}),t.jsxs("div",{children:[v.fields," fields"]})]})}),t.jsx("td",{className:"align-middle",children:t.jsxs(Te,{bg:j.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx(S,{className:"me-1",size:12}),j.text]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:v.createdBy})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(v.createdAt).toLocaleDateString()})}),t.jsx("td",{className:"align-middle text-center",children:t.jsx(Ht,{permissions:[be.SQA.VIEW_TEMPLATES,be.SQA.VIEW_TEMPLATE_DETAIL],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Detail",icon:t.jsx(xt,{}),onClick:()=>p(v.id),permission:be.SQA.VIEW_TEMPLATE_DETAIL},{label:"Disable Template",icon:t.jsx(Ms,{}),onClick:()=>x(v.id),permission:be.SQA.VIEW_TEMPLATES}]})})})]},v.id)})})]})}),f.length>8&&t.jsxs("div",{className:"scroll-indicator",children:[t.jsx(Cr,{size:12,className:"me-1"}),"Scroll to see more templates"]})]})]})]})})},hA=()=>{const{templateId:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState("overview");b.useEffect(()=>{m()},[e]);const m=async()=>{try{i(!0),o(null);const g={id:e,name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses. This template covers all essential safety protocols and procedures required for workplace safety training.",version:"v2.1",category:"SAFETY",totalSections:5,totalFields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z",lastModified:"2024-01-20T00:00:00.000Z",lastModifiedBy:"Sarah Johnson",sections:[{id:"1",name:"Personal Protective Equipment",fields:8,order:1},{id:"2",name:"Emergency Procedures",fields:6,order:2},{id:"3",name:"Hazard Identification",fields:5,order:3},{id:"4",name:"Safety Training Records",fields:3,order:4},{id:"5",name:"Compliance Verification",fields:1,order:5}],history:[{version:"v2.1",date:"2024-01-20T00:00:00.000Z",modifiedBy:"Sarah Johnson",changes:"Updated emergency procedures section"},{version:"v2.0",date:"2024-01-15T00:00:00.000Z",modifiedBy:"John Smith",changes:"Initial creation of template"}]};await new Promise(v=>setTimeout(v,1e3)),a(g)}catch(g){console.error("Error loading template detail:",g),o("Failed to load template details")}finally{i(!1)}},u=g=>{switch(g){case"ACTIVE":return{variant:"success",icon:rt,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:et,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:et,text:"INACTIVE"};default:return{variant:"secondary",icon:et,text:g}}},h=()=>{console.log("Export PDF for template:",e),alert("PDF export functionality will be implemented")},p=()=>{r("/sqa/templates")};if(n)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})});if(l)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l}),t.jsxs(se,{variant:"outline-danger",onClick:p,children:[t.jsx(bt,{className:"me-2"}),"Back to Template List"]})]})});if(!s)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Template Not Found"}),t.jsx("p",{children:"The requested template could not be found."}),t.jsxs(se,{variant:"outline-warning",onClick:p,children:[t.jsx(bt,{className:"me-2"}),"Back to Template List"]})]})});const x=u(s.status),f=x.icon;return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{xs:12,children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:p,className:"me-3",children:[t.jsx(bt,{className:"me-1",size:16}),"Back to List"]}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1 text-dark",children:s.name}),t.jsx("p",{className:"text-muted mb-0",children:s.description})]})]}),t.jsx(Ht,{permissions:[be.SQA.VIEW_TEMPLATES],fallback:null,children:t.jsxs(se,{variant:"primary",size:"sm",onClick:h,className:"d-flex align-items-center",children:[t.jsx(vc,{className:"me-1",size:16}),"Export PDF"]})})]})})}),t.jsx(oe,{children:t.jsx(F,{xs:12,children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:t.jsxs("div",{className:"custom-tabs",children:[t.jsx("button",{className:`custom-tab ${c==="overview"?"active":""}`,onClick:()=>d("overview"),children:"Template Overview"}),t.jsx("button",{className:`custom-tab ${c==="sections"?"active":""}`,onClick:()=>d("sections"),children:"Sections"}),t.jsx("button",{className:`custom-tab ${c==="history"?"active":""}`,onClick:()=>d("history"),children:"Version History"})]})}),t.jsxs(R.Body,{className:"p-0",children:[c==="overview"&&t.jsx("div",{className:"p-4",children:t.jsxs(oe,{children:[t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Version"}),t.jsx("div",{children:t.jsx(Te,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:s.version})})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Status"}),t.jsx("div",{children:t.jsxs(Te,{bg:x.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[t.jsx(f,{className:"me-1",size:12}),x.text]})})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Total Sections"}),t.jsxs("div",{className:"fw-medium",children:[s.totalSections," sections"]})]})]}),t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Created By"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{className:"me-2",size:16}),t.jsx("span",{children:s.createdBy})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Created Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"me-2",size:16}),t.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-muted small",children:"Last Modified"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{className:"me-2",size:16}),t.jsx("span",{children:new Date(s.lastModified).toLocaleDateString()})]})]})]})]})}),c==="sections"&&t.jsx("div",{className:"p-4",children:t.jsx(Ga,{data:s.sections||[],loading:!1,columns:[{key:"name",title:"Section Name",className:"show-mobile",sortable:!0},{key:"fields",title:"Fields",className:"show-mobile",sortable:!0},{key:"order",title:"Order",className:"show-mobile",sortable:!0}],renderRow:(g,v)=>t.jsxs("tr",{className:`${v%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:N=>{N.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:N=>{N.currentTarget.style.backgroundColor=v%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx($s,{className:"me-2 text-primary",size:16}),t.jsx("span",{className:"fw-medium",children:g.name})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs(Te,{bg:"secondary",className:"px-2 py-1",children:[g.fields," fields"]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-muted",children:g.order})})]},g.id),emptyMessage:"No sections found",emptyDescription:"This template has no sections."})}),c==="history"&&t.jsx("div",{className:"p-4",children:t.jsx(Ga,{data:s.history||[],loading:!1,columns:[{key:"version",title:"Version",className:"show-mobile",sortable:!0},{key:"modifiedBy",title:"Modified By",className:"show-mobile",sortable:!0},{key:"date",title:"Date",className:"show-mobile",sortable:!0},{key:"changes",title:"Changes",className:"show-mobile",sortable:!0}],renderRow:(g,v)=>t.jsxs("tr",{className:`${v%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:N=>{N.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:N=>{N.currentTarget.style.backgroundColor=v%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsx(Te,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:g.version})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{className:"me-2",size:16}),t.jsx("span",{children:g.modifiedBy})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{className:"me-2",size:16}),t.jsx("span",{children:new Date(g.date).toLocaleDateString()})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-muted",children:g.changes})})]},v),emptyMessage:"No version history found",emptyDescription:"This template has no version history."})})]})]})})})]})},fA=()=>{const e=qe(),[r,s]=b.useState("upcoming-assessments"),a=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:Ba,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:rt,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:it,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:Ls,path:"/trainer/configure-signature",color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:vt,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:Hi,path:"/trainer/assessment-details",color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:rt,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(r){case"upcoming-assessments":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),t.jsxs(oe,{children:[t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Ba,{size:48,className:"text-muted mb-3"}),t.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),t.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-success text-white",children:t.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"d-grid gap-2",children:[t.jsxs(se,{variant:"outline-primary",size:"sm",children:[t.jsx(Ba,{size:16,className:"me-2"}),"Schedule Assessment"]}),t.jsxs(se,{variant:"outline-success",size:"sm",children:[t.jsx(vt,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Assessment Results"}),t.jsxs(oe,{children:[t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-success text-white",children:t.jsx("h6",{className:"mb-0",children:"Recent Results"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"text-center py-4",children:[t.jsx(rt,{size:48,className:"text-muted mb-3"}),t.jsx("h6",{className:"text-muted",children:"No recent results"}),t.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-info text-white",children:t.jsx("h6",{className:"mb-0",children:"Statistics"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"row text-center",children:[t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"h4 text-primary",children:"0"}),t.jsx("small",{className:"text-muted",children:"Completed"})]}),t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"h4 text-warning",children:"0"}),t.jsx("small",{className:"text-muted",children:"Pending"})]}),t.jsxs("div",{className:"col-4",children:[t.jsx("div",{className:"h4 text-success",children:"0"}),t.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),t.jsxs(oe,{children:[t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-info text-white",children:t.jsx("h6",{className:"mb-0",children:"My Courses"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"text-center py-4",children:[t.jsx(it,{size:48,className:"text-muted mb-3"}),t.jsx("h6",{className:"text-muted",children:"No courses assigned"}),t.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),t.jsx(F,{md:6,className:"mb-3",children:t.jsxs(R,{className:"h-100",children:[t.jsx(R.Header,{className:"bg-warning text-white",children:t.jsx("h6",{className:"mb-0",children:"Course Management"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"d-grid gap-2",children:[t.jsxs(se,{variant:"outline-primary",size:"sm",children:[t.jsx(it,{size:16,className:"me-2"}),"View All Courses"]}),t.jsxs(se,{variant:"outline-info",size:"sm",children:[t.jsx(et,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsxs(F,{children:[t.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),t.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),t.jsxs(oe,{children:[t.jsx(F,{lg:3,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Navigation"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"list-group list-group-flush",children:a.map(l=>{const o=l.icon;return t.jsx("button",{className:`list-group-item list-group-item-action border-0 ${r===l.id?"active":""}`,onClick:()=>s(l.id),style:{backgroundColor:r===l.id?"#0d6efd":"transparent",color:r===l.id?"white":"inherit",border:"none",borderRadius:0},children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(o,{size:20,className:"me-3",style:{color:r===l.id?"white":`var(--bs-${l.color})`}}),t.jsxs("div",{className:"flex-grow-1 text-start",children:[t.jsx("h6",{className:"mb-1",children:l.title}),t.jsx("small",{className:"text-muted",children:l.description})]}),t.jsx(Gr,{size:16})]})},l.id)})})})]})}),t.jsx(F,{lg:9,children:t.jsx(R,{className:"border-0 shadow-sm",children:t.jsx(R.Body,{className:"p-4",children:i()})})})]}),t.jsx(oe,{className:"mt-4",children:t.jsx(F,{children:t.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),t.jsx(oe,{children:n.map((l,o)=>{const c=l.icon;return t.jsx(F,{lg:6,xl:3,className:"mb-4",children:t.jsx(R,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(l.path),onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:t.jsxs(R.Body,{className:"p-4",children:[t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("div",{className:`bg-${l.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:t.jsx(c,{size:24})}),t.jsx("div",{className:"flex-grow-1",children:t.jsx("h5",{className:"mb-1",children:l.title})}),t.jsx(Gr,{size:20,className:"text-muted"})]}),t.jsx("p",{className:"text-muted mb-0",children:l.description})]})})},o)})})]})},sa=({uniqueStatuses:e,selectedStatuses:r,onStatusToggle:s,onClearFilters:a,className:n=""})=>{const i=r.length>0;return t.jsxs(xs,{className:`filter-panel-dropdown ${n}`,children:[t.jsx(xs.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Sa,{size:14,className:"me-2"}),"Filters",i&&t.jsx("span",{className:"badge bg-primary ms-2",children:r.length})]})}),t.jsxs(xs.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[t.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),r.length>0&&t.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>s("clear"),children:t.jsx(Ge,{size:12})})]}),t.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>t.jsx(E.Check,{type:"checkbox",id:`status-${l}`,label:l,checked:r.includes(l),onChange:()=>s(l),className:"mb-1"},l))})]}),i&&t.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:t.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[t.jsx(Ge,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},xA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(null),[o,c]=b.useState(""),[d,m]=b.useState([]);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(T=>setTimeout(T,1e3)),s([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",scheduledDate:"2024-01-15",scheduledTime:"09:00",status:"scheduled",duration:"120 minutes",location:"Training Room A"},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",scheduledDate:"2024-01-16",scheduledTime:"14:00",status:"scheduled",duration:"90 minutes",location:"Lab B"},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",scheduledDate:"2024-01-17",scheduledTime:"10:30",status:"pending",duration:"150 minutes",location:"Simulator Room"}])}catch{l("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const u=w=>{const T={scheduled:{variant:"primary",text:"Scheduled"},pending:{variant:"warning",text:"Pending"},inProgress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[w]||{variant:"secondary",text:w};return t.jsx(Te,{bg:T.variant,children:T.text})},h=w=>{e(`/trainer/assessments/${w}`)},p=w=>{e(`/trainer/assessments/${w}/edit`)},x=[...new Set(r.map(w=>w.status))],f=r.filter(w=>{const y=d.length===0||d.includes(w.status),T=w.title.toLowerCase().includes(o.toLowerCase())||w.course.toLowerCase().includes(o.toLowerCase())||w.trainee.toLowerCase().includes(o.toLowerCase());return y&&T}),g=w=>{m(w==="clear"?[]:y=>y.includes(w)?y.filter(T=>T!==w):[...y,w])},v=()=>{m([]),c("")},{sortedData:N,sortConfig:j,handleSort:S}=Ot(f);if(a)return t.jsx(It,{rows:5,columns:7});if(i)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:i}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(f.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No upcoming assessments found"}),t.jsx("p",{children:"Try adjusting your search criteria or schedule a new assessment."})]})});const C=({columnKey:w,children:y,className:T=""})=>{const k=j.key===w,P=k?j.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${T} ${k?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>S(w),onMouseEnter:A=>{A.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="transparent",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:k?"600":"500"},children:y}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:P,size:14})})]}),k&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search assessments, courses, or trainees...",value:o,onChange:c,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:x,selectedStatuses:d,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(C,{columnKey:"title",className:"show-mobile",children:"Assessment"}),t.jsx(C,{columnKey:"course",className:"show-mobile",children:"Course"}),t.jsx(C,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),t.jsx(C,{columnKey:"scheduledDate",className:"show-mobile",children:"Date & Time"}),t.jsx(C,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),t.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:N.map(w=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:w.title}),t.jsxs("small",{className:"text-muted",children:[t.jsx(et,{size:12,className:"me-1"}),w.location]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:w.course})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:w.trainee})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:w.scheduledDate}),t.jsx("small",{className:"text-muted",children:w.scheduledTime})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-muted",children:w.duration})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:u(w.status)}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>h(w.id)},{label:"Edit Assessment",icon:t.jsx(bc,{}),onClick:()=>p(w.id)}]})})]},w.id))})]})})]})},pA=()=>{const[e,r]=b.useState([]),[s,a]=b.useState(!0),[n,i]=b.useState(null),[l,o]=b.useState("all"),[c,d]=b.useState(""),[m,u]=b.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=Ot(e);b.useEffect(()=>{(async()=>{try{a(!0),await new Promise(k=>setTimeout(k,1e3)),r([{id:1,title:"Safety Procedures - Module 1",course:"Aviation Safety Management",trainee:"John Doe",dueDate:"2024-01-20",status:"pending",priority:"high",progress:65,instructor:"Dr. Smith",lastActivity:"2024-01-15",estimatedTime:"2 hours"},{id:2,title:"Engine Maintenance - Part A",course:"Aircraft Maintenance",trainee:"Jane Smith",dueDate:"2024-01-18",status:"in_progress",priority:"medium",progress:30,instructor:"Jane Doe",lastActivity:"2024-01-16",estimatedTime:"3 hours"},{id:3,title:"Navigation Systems - Theory",course:"Flight Operations",trainee:"Mike Johnson",dueDate:"2024-01-22",status:"completed",priority:"low",progress:100,instructor:"Mike Johnson",lastActivity:"2024-01-17",estimatedTime:"1.5 hours"},{id:4,title:"Regulatory Compliance - Section 2",course:"Aviation Regulations",trainee:"Sarah Wilson",dueDate:"2024-01-19",status:"overdue",priority:"high",progress:45,instructor:"Sarah Wilson",lastActivity:"2024-01-14",estimatedTime:"2.5 hours"},{id:5,title:"Emergency Response - Practical",course:"Crisis Management",trainee:"David Brown",dueDate:"2024-01-25",status:"pending",priority:"medium",progress:0,instructor:"David Brown",lastActivity:"2024-01-12",estimatedTime:"4 hours"}])}catch(T){i("Failed to fetch section completion data"),console.error("Error fetching sections:",T)}finally{a(!1)}})()},[]);const f=y=>{const k={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},overdue:{variant:"danger",text:"Overdue"}}[y]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:k.variant,children:k.text})},g=y=>{const k={high:{variant:"danger",text:"High"},medium:{variant:"warning",text:"Medium"},low:{variant:"success",text:"Low"}}[y]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:k.variant,className:"me-1",children:k.text})},v=[...new Set(e.map(y=>y.status))],N=h.filter(y=>{const T=m.length===0||m.includes(y.status),k=c===""||y.title.toLowerCase().includes(c.toLowerCase())||y.course.toLowerCase().includes(c.toLowerCase())||y.trainee.toLowerCase().includes(c.toLowerCase());return T&&k}),j=y=>{u(y==="clear"?[]:T=>T.includes(y)?T.filter(k=>k!==y):[...T,y])},S=()=>{u([]),d("")},C=y=>{console.log("View details for section:",y)},w=y=>{console.log("Mark complete for section:",y)};return s?t.jsx(It,{}):n?t.jsxs(Ae,{variant:"danger",className:"m-4",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:n})]}):t.jsxs("div",{className:"p-4",children:[t.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search sections, trainees, or courses...",value:c,onChange:d,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:v,selectedStatuses:m,onStatusToggle:j,onClearFilters:S,className:"filter-panel-mobile"})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsxs("th",{onClick:()=>x("title"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Section ",t.jsx(zt,{sortConfig:p,columnKey:"title"})]}),t.jsxs("th",{onClick:()=>x("course"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Course ",t.jsx(zt,{sortConfig:p,columnKey:"course"})]}),t.jsxs("th",{onClick:()=>x("trainee"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Trainee ",t.jsx(zt,{sortConfig:p,columnKey:"trainee"})]}),t.jsxs("th",{onClick:()=>x("dueDate"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Due Date ",t.jsx(zt,{sortConfig:p,columnKey:"dueDate"})]}),t.jsxs("th",{onClick:()=>x("status"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Status ",t.jsx(zt,{sortConfig:p,columnKey:"status"})]}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),t.jsx("tbody",{children:N.map(y=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-bold",children:y.title}),t.jsxs("small",{className:"text-muted",children:[t.jsx(et,{size:12,className:"me-1"}),"Est. ",y.estimatedTime]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-bold",children:y.course}),t.jsxs("small",{className:"text-muted",children:[t.jsx(Dt,{size:12,className:"me-1"}),y.instructor]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-bold",children:y.trainee}),t.jsxs("small",{className:"text-muted",children:["Last activity: ",y.lastActivity]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-bold",children:y.dueDate}),t.jsx("small",{className:"text-muted",children:g(y.priority)})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[f(y.status),t.jsx("div",{className:"mt-1",children:t.jsxs("small",{className:"text-muted",children:["Progress: ",y.progress,"%"]})})]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>C(y.id)},{label:"Mark Complete",icon:t.jsx(rt,{}),onClick:()=>w(y.id)}]})})]},y.id))})]})})]})},gA=()=>{const[e,r]=b.useState("upcoming-assessments"),s=[{id:"upcoming-assessments",title:"Upcoming Assessments",icon:Ba,component:t.jsx(xA,{})},{id:"section-completion",title:"Section Required Completion",icon:vt,component:t.jsx(pA,{})}],a=s.find(n=>n.id===e);return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0",children:[t.jsx(R.Header,{className:"bg-primary text-white p-0",children:t.jsx("div",{className:"custom-tabs-container",children:s.map(n=>{const i=n.icon,l=e===n.id;return t.jsxs("button",{className:`custom-tab ${l?"active":""}`,onClick:()=>r(n.id),children:[t.jsx(i,{size:16,className:"me-2"}),n.title]},n.id)})})}),t.jsx(R.Body,{className:"p-0",children:a&&a.component})]})})})})},vA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(null),[o,c]=b.useState("all"),[d,m]=b.useState(""),[u,h]=b.useState([]),{sortedData:p,sortConfig:x,handleSort:f}=Ot(r);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(_=>setTimeout(_,1e3)),s([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{l("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=P=>{const _={completed:{variant:"success",text:"Completed",icon:rt},failed:{variant:"danger",text:"Failed",icon:Ms},inProgress:{variant:"warning",text:"In Progress",icon:et},pending:{variant:"info",text:"Pending Review",icon:et}}[P]||{variant:"secondary",text:P,icon:et},U=_.icon;return t.jsxs(Te,{bg:_.variant,className:"d-flex align-items-center",children:[t.jsx(U,{size:12,className:"me-1"}),_.text]})},v=P=>P.startsWith("A")?"success":P.startsWith("B")?"primary":P.startsWith("C")?"warning":P.startsWith("D")?"danger":"secondary",N=(P,A)=>{const _=P/A*100;return _>=90?"success":_>=80?"primary":_>=70?"warning":"danger"},j=[...new Set(r.map(P=>P.status))],S=r.filter(P=>{const A=u.length===0||u.includes(P.status),_=P.title.toLowerCase().includes(d.toLowerCase())||P.trainee.toLowerCase().includes(d.toLowerCase())||P.course.toLowerCase().includes(d.toLowerCase());return A&&_}),C=P=>{h(P==="clear"?[]:A=>A.includes(P)?A.filter(_=>_!==P):[...A,P])},w=()=>{h([]),m("")},y=P=>{e(`/trainer/assessment-details/${P}`)},T=P=>{console.log("Downloading result:",P)};if(a)return t.jsx(It,{rows:5,columns:7});if(i)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:i}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(r.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No assessment results found"}),t.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const k=({columnKey:P,children:A,className:_=""})=>{const U=x.key===P,D=U?x.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${_} ${U?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>f(P),onMouseEnter:W=>{W.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",W.target.style.transform="translateY(-1px)",W.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:W=>{W.target.style.backgroundColor="transparent",W.target.style.transform="translateY(0)",W.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:U?"600":"500"},children:A}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:D,size:14})})]}),U&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search assessments, trainees, or courses...",value:d,onChange:m,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:j,selectedStatuses:u,onStatusToggle:C,onClearFilters:w,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[S.length," result",S.length!==1?"s":""]})})})]}),S.length===0?t.jsx(R,{className:"text-center py-5",children:t.jsxs(R.Body,{children:[t.jsx(rt,{size:64,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No Results Found"}),t.jsx("p",{className:"text-muted",children:d||o!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(d||o!=="all")&&t.jsx(se,{variant:"outline-primary",onClick:()=>{m(""),c("all")},children:"Clear Filters"})]})}):t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(k,{columnKey:"title",className:"show-mobile",children:"Assessment"}),t.jsx(k,{columnKey:"course",className:"show-mobile",children:"Course"}),t.jsx(k,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),t.jsx(k,{columnKey:"score",className:"show-mobile",children:"Score"}),t.jsx(k,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),t.jsx(k,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),t.jsx(k,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:p.map(P=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:P.title}),t.jsxs("small",{className:"text-muted",children:["Attempt ",P.attempts,"  ",P.duration]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:P.course})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:P.trainee})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsxs("span",{className:`fw-bold text-${N(P.score,P.maxScore)}`,children:[P.score,"/",P.maxScore]}),t.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(P.score/P.maxScore*100),"%)"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx(Te,{bg:v(P.grade),className:"fs-6",children:P.grade})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsx("div",{children:t.jsx("div",{className:"fw-medium",children:P.completedDate})})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:g(P.status)}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>y(P.id)},{label:"Download Report",icon:t.jsx(qr,{}),onClick:()=>T(P.id)}]})})]},P.id))})]})})]})},bA=()=>t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(vA,{})}),jA=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(null),[o,c]=b.useState("all"),[d,m]=b.useState(""),[u,h]=b.useState([]),{sortedData:p,sortConfig:x,handleSort:f}=Ot(r);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(A=>setTimeout(A,1e3)),s([{id:1,title:"Aviation Safety Management",code:"ASM-101",department:"Safety & Security",status:"active",startDate:"2024-01-15",endDate:"2024-03-15",enrolledTrainees:25,maxTrainees:30,totalSubjects:8,completedSubjects:3,instructor:"Dr. John Smith",location:"Training Center A",schedule:"Mon, Wed, Fri 9:00-12:00"},{id:2,title:"Aircraft Maintenance Fundamentals",code:"AMF-201",department:"Maintenance",status:"active",startDate:"2024-01-20",endDate:"2024-04-20",enrolledTrainees:18,maxTrainees:20,totalSubjects:12,completedSubjects:5,instructor:"Jane Doe",location:"Lab B",schedule:"Tue, Thu 14:00-17:00"},{id:3,title:"Flight Operations Management",code:"FOM-301",department:"Operations",status:"scheduled",startDate:"2024-02-01",endDate:"2024-05-01",enrolledTrainees:0,maxTrainees:15,totalSubjects:10,completedSubjects:0,instructor:"Mike Johnson",location:"Simulator Room",schedule:"Mon-Fri 8:00-16:00"},{id:4,title:"Aviation Regulations & Compliance",code:"ARC-401",department:"Compliance",status:"completed",startDate:"2023-10-01",endDate:"2023-12-15",enrolledTrainees:22,maxTrainees:25,totalSubjects:6,completedSubjects:6,instructor:"Sarah Wilson",location:"Conference Room C",schedule:"Sat 9:00-17:00"},{id:5,title:"Emergency Response Procedures",code:"ERP-501",department:"Safety & Security",status:"paused",startDate:"2024-01-10",endDate:"2024-02-28",enrolledTrainees:12,maxTrainees:20,totalSubjects:4,completedSubjects:1,instructor:"David Brown",location:"Training Center B",schedule:"Wed, Fri 10:00-14:00"}])}catch{l("Failed to load instructed courses")}finally{n(!1)}})()},[]);const g=k=>{const A={active:{variant:"success",text:"Active"},scheduled:{variant:"primary",text:"Scheduled"},completed:{variant:"secondary",text:"Completed"},paused:{variant:"warning",text:"Paused"},cancelled:{variant:"danger",text:"Cancelled"}}[k]||{variant:"secondary",text:k};return t.jsx(Te,{bg:A.variant,children:A.text})},v=(k,P)=>P>0?Math.round(k/P*100):0,N=(k,P)=>P>0?Math.round(k/P*100):0,j=[...new Set(r.map(k=>k.status))],S=r.filter(k=>{const P=u.length===0||u.includes(k.status),A=k.title.toLowerCase().includes(d.toLowerCase())||k.code.toLowerCase().includes(d.toLowerCase())||k.department.toLowerCase().includes(d.toLowerCase());return P&&A}),C=k=>{h(k==="clear"?[]:P=>P.includes(k)?P.filter(A=>A!==k):[...P,k])},w=()=>{h([]),m("")},y=k=>{e(`/trainer/courses/${k}`)};if(a)return t.jsx(It,{rows:5,columns:7});if(i)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:i}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(r.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No instructed courses found"}),t.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const T=({columnKey:k,children:P,className:A=""})=>{const _=x.key===k,U=_?x.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${A} ${_?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>f(k),onMouseEnter:D=>{D.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",D.target.style.transform="translateY(-1px)",D.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:D=>{D.target.style.backgroundColor="transparent",D.target.style.transform="translateY(0)",D.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:_?"600":"500"},children:P}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:U,size:14})})]}),_&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search courses, codes, or departments...",value:d,onChange:m,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:j,selectedStatuses:u,onStatusToggle:C,onClearFilters:w,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[S.length," course",S.length!==1?"s":""]})})})]}),S.length===0?t.jsx(R,{className:"text-center py-5",children:t.jsxs(R.Body,{children:[t.jsx(it,{size:64,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No Courses Found"}),t.jsx("p",{className:"text-muted",children:d||o!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),d||u.length>0?t.jsx(se,{variant:"outline-primary",onClick:w,children:"Clear Filters"}):null]})}):t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(T,{columnKey:"title",className:"show-mobile",children:"Course"}),t.jsx(T,{columnKey:"department",className:"show-mobile",children:"Department"}),t.jsx(T,{columnKey:"schedule",className:"hide-mobile",children:"Schedule"}),t.jsx(T,{columnKey:"enrollment",className:"show-mobile",children:"Enrollment"}),t.jsx(T,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),t.jsx(T,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:p.map(k=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:k.title}),t.jsxs("small",{className:"text-muted",children:[k.code,"  ",k.location]}),t.jsx("br",{}),t.jsxs("small",{className:"text-muted",children:[t.jsx(Lt,{size:12,className:"me-1"}),k.startDate," - ",k.endDate]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsx("span",{className:"text-muted",children:k.department})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:k.schedule}),t.jsx("small",{className:"text-muted",children:k.instructor})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{size:16,className:"me-2 text-muted"}),t.jsxs("span",{className:"fw-medium",children:[k.enrolledTrainees,"/",k.maxTrainees]})]}),t.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:t.jsx("div",{className:"progress-bar bg-info",style:{width:`${N(k.enrolledTrainees,k.maxTrainees)}%`}})}),t.jsxs("small",{className:"text-muted",children:[N(k.enrolledTrainees,k.maxTrainees),"% full"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsxs("span",{className:"fw-medium",children:[k.completedSubjects,"/",k.totalSubjects]})]}),t.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:t.jsx("div",{className:"progress-bar bg-success",style:{width:`${v(k.completedSubjects,k.totalSubjects)}%`}})}),t.jsxs("small",{className:"text-muted",children:[v(k.completedSubjects,k.totalSubjects),"% complete"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:g(k.status)}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Course Detail",icon:t.jsx(xt,{}),onClick:()=>y(k.id)}]})})]},k.id))})]})})]})},yA=()=>t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(jA,{})}),NA=({courseId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState(""),[m,u]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),a([{id:1,title:"Safety Procedures - Module 1",code:"SP-101",duration:"2 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-20",progress:100,description:"Introduction to aviation safety procedures and protocols"},{id:2,title:"Risk Assessment Fundamentals",code:"RAF-102",duration:"3 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-25",progress:100,description:"Understanding risk assessment methodologies in aviation"},{id:3,title:"Emergency Response Protocols",code:"ERP-103",duration:"2.5 hours",status:"in_progress",instructor:"Dr. Smith",completionDate:null,progress:65,description:"Emergency response procedures and communication protocols"},{id:4,title:"Regulatory Compliance",code:"RC-104",duration:"4 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Understanding aviation regulations and compliance requirements"},{id:5,title:"Safety Management Systems",code:"SMS-105",duration:"3.5 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Implementation and management of safety management systems"}])}catch(y){o("Failed to load subjects"),console.error("Error fetching subjects:",y)}finally{i(!1)}})()},[e]);const h=w=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[w]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:T.variant,children:T.text})},p=w=>{r(`/trainer/subjects/${w}`)},x=[...new Set(s.map(w=>w.status))],f=s.filter(w=>{const y=m.length===0||m.includes(w.status),T=w.title.toLowerCase().includes(c.toLowerCase())||w.code.toLowerCase().includes(c.toLowerCase())||w.description.toLowerCase().includes(c.toLowerCase());return y&&T}),g=w=>{u(w==="clear"?[]:y=>y.includes(w)?y.filter(T=>T!==w):[...y,w])},v=()=>{u([]),d("")},{sortedData:N,sortConfig:j,handleSort:S}=Ot(f);if(n)return t.jsx(It,{rows:5,columns:6});if(l)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(f.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No subjects found"}),t.jsx("p",{children:"Try adjusting your search criteria."})]})});const C=({columnKey:w,children:y,className:T=""})=>{const k=j.key===w,P=k?j.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${T} ${k?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>S(w),onMouseEnter:A=>{A.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="transparent",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:k?"600":"500"},children:y}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:P,size:14})})]}),k&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search subjects...",value:c,onChange:d,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:x,selectedStatuses:m,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(C,{columnKey:"title",className:"show-mobile",children:"Subject"}),t.jsx(C,{columnKey:"code",className:"show-mobile",children:"Code"}),t.jsx(C,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),t.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(C,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:N.map(w=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:w.title}),t.jsx("small",{className:"text-muted",children:w.description})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:w.code})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:w.duration})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:h(w.status)}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${w.progress}%`},"aria-valuenow":w.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),t.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>p(w.id)}]})})]},w.id))})]})})]})},wA=({courseId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState(""),[m,u]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"active",progress:75,lastActivity:"2024-01-20",completedSubjects:6,totalSubjects:8},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"active",progress:60,lastActivity:"2024-01-19",completedSubjects:5,totalSubjects:8},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"completed",progress:100,lastActivity:"2024-01-25",completedSubjects:8,totalSubjects:8},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"inactive",progress:25,lastActivity:"2024-01-22",completedSubjects:2,totalSubjects:8},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"active",progress:40,lastActivity:"2024-01-23",completedSubjects:3,totalSubjects:8}])}catch(y){o("Failed to load trainees"),console.error("Error fetching trainees:",y)}finally{i(!1)}})()},[e]);const h=w=>{const T={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[w]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:T.variant,children:T.text})},p=w=>{r(`/trainer/trainees/${w}`)},x=[...new Set(s.map(w=>w.status))],f=s.filter(w=>{const y=m.length===0||m.includes(w.status),T=w.name.toLowerCase().includes(c.toLowerCase())||w.email.toLowerCase().includes(c.toLowerCase())||w.employeeId.toLowerCase().includes(c.toLowerCase())||w.department.toLowerCase().includes(c.toLowerCase());return y&&T}),g=w=>{u(w==="clear"?[]:y=>y.includes(w)?y.filter(T=>T!==w):[...y,w])},v=()=>{u([]),d("")},{sortedData:N,sortConfig:j,handleSort:S}=Ot(f);if(n)return t.jsx(It,{rows:5,columns:7});if(l)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(f.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No trainees found"}),t.jsx("p",{children:"Try adjusting your search criteria."})]})});const C=({columnKey:w,children:y,className:T=""})=>{const k=j.key===w,P=k?j.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${T} ${k?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>S(w),onMouseEnter:A=>{A.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="transparent",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:k?"600":"500"},children:y}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:P,size:14})})]}),k&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search trainees...",value:c,onChange:d,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:x,selectedStatuses:m,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(C,{columnKey:"name",className:"show-mobile",children:"Trainee"}),t.jsx(C,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),t.jsx(C,{columnKey:"department",className:"hide-mobile",children:"Department"}),t.jsx(C,{columnKey:"enrollmentDate",className:"show-mobile",children:"Enrollment Date"}),t.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(C,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:N.map(w=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:w.name}),t.jsx("small",{className:"text-muted",children:w.email})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:w.employeeId})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-muted",children:w.department})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:w.enrollmentDate}),t.jsxs("small",{className:"text-muted",children:["Last activity: ",w.lastActivity]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:h(w.status)}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${w.progress}%`},"aria-valuenow":w.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),t.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Profile",icon:t.jsx(xt,{}),onClick:()=>p(w.id)}]})})]},w.id))})]})})]})},SA=()=>{const{courseId:e}=Jt(),r=qe(),[s,a]=b.useState("subjects"),[n,i]=b.useState(null),[l,o]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{o(!0),await new Promise(x=>setTimeout(x,1e3)),i({id:e,title:"Aviation Safety Management",code:"ASM-101",department:"Aviation Department",instructor:"Dr. Smith",startDate:"2024-01-15",endDate:"2024-03-15",status:"active",location:"Training Room A",schedule:"Mon, Wed, Fri 09:00-12:00",description:"Comprehensive course covering aviation safety management systems, risk assessment, and regulatory compliance.",maxEnrollment:30,currentEnrollment:25,completedSubjects:8,totalSubjects:12})}catch(p){d("Failed to load course details"),console.error("Error fetching course:",p)}finally{o(!1)}})()},[e]);const m=[{id:"subjects",title:"Subject List",icon:it,component:t.jsx(NA,{courseId:e})},{id:"trainees",title:"Trainee List",icon:rs,component:t.jsx(wA,{courseId:e})}],u=m.find(h=>h.id===s);return l?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):c?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:c})]})}):n?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>r("/trainer/instructed-courses"),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:n.title}),t.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.department]})]})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0",children:[t.jsx(R.Header,{className:"bg-primary text-white p-0",children:t.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const p=h.icon,x=s===h.id;return t.jsxs("button",{className:`custom-tab ${x?"active":""}`,onClick:()=>a(h.id),children:[t.jsx(p,{size:16,className:"me-2"}),h.title]},h.id)})})}),t.jsx(R.Body,{className:"p-0",children:u&&u.component})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Course Not Found"}),t.jsx("p",{children:"The requested course could not be found."})]})})},TA=()=>{const{traineeId:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(u=>setTimeout(u,1e3)),a({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(m){o("Failed to load trainee details"),console.error("Error fetching trainee:",m)}finally{i(!1)}})()},[e]);const c=d=>{const u={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:u.variant,children:u.text})};return n?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l})]})}):s?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>r(-1),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:s.name}),t.jsxs("p",{className:"text-muted mb-0",children:[s.employeeId,"  ",s.department]})]})]})})}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Dt,{size:24,className:"text-primary mb-2"}),t.jsx("h6",{className:"mb-1",children:"Status"}),c(s.status)]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(it,{size:24,className:"text-success mb-2"}),t.jsx("h6",{className:"mb-1",children:"Courses"}),t.jsxs("h4",{className:"mb-0 text-success",children:[s.completedCourses,"/",s.totalCourses]}),t.jsx("small",{className:"text-muted",children:"Completed"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"text-info mb-2",children:t.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),t.jsx("h6",{className:"mb-1",children:"Average Score"}),t.jsxs("h4",{className:"mb-0 text-info",children:[s.averageScore,"%"]}),t.jsx("small",{className:"text-muted",children:"Performance"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Lt,{size:24,className:"text-warning mb-2"}),t.jsx("h6",{className:"mb-1",children:"Enrolled"}),t.jsx("h4",{className:"mb-0 text-warning",children:s.enrollmentDate}),t.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Contact Information"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx(ha,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Email:"})," ",s.email]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Position:"})," ",s.position]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Lt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Last Activity:"})," ",s.lastActivity]})]})]})}),t.jsx(F,{md:6,children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Current Courses"})}),t.jsx(R.Body,{children:s.currentCourses.map(d=>t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[t.jsx("h6",{className:"mb-0",children:d.name}),t.jsxs("small",{className:"text-muted",children:[d.progress,"%"]})]}),t.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${d.progress}%`}})}),t.jsxs("small",{className:"text-muted",children:["Instructor: ",d.instructor]})]},d.id))})]})})]}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Certifications"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Certification"}),t.jsx("th",{children:"Date"}),t.jsx("th",{children:"Status"})]})}),t.jsx("tbody",{children:s.certifications.map((d,m)=>t.jsxs("tr",{children:[t.jsx("td",{children:d.name}),t.jsx("td",{children:d.date}),t.jsx("td",{children:c(d.status)})]},m))})]})})})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Trainee Not Found"}),t.jsx("p",{children:"The requested trainee could not be found."})]})})},EA=({subjectId:e})=>{const r=qe(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState(""),[m,u]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(k=>setTimeout(k,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(T){o("Failed to load trainees in subject"),console.error("Error fetching trainees:",T)}finally{i(!1)}})()},[e]);const h=y=>{const k={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[y]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:k.variant,children:k.text})},p=y=>{r(`/trainer/trainees/${y}`)},x=y=>{console.log("Send message to trainee:",y)},f=[...new Set(s.map(y=>y.status))],g=s.filter(y=>{const T=m.length===0||m.includes(y.status),k=y.name.toLowerCase().includes(c.toLowerCase())||y.email.toLowerCase().includes(c.toLowerCase())||y.employeeId.toLowerCase().includes(c.toLowerCase())||y.department.toLowerCase().includes(c.toLowerCase());return T&&k}),v=y=>{u(y==="clear"?[]:T=>T.includes(y)?T.filter(k=>k!==y):[...T,y])},N=()=>{u([]),d("")},{sortedData:j,sortConfig:S,handleSort:C}=Ot(g);if(n)return t.jsx(It,{rows:5,columns:7});if(l)return t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l}),t.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No trainees found"}),t.jsx("p",{children:"Try adjusting your search criteria."})]})});const w=({columnKey:y,children:T,className:k=""})=>{const P=S.key===y,A=P?S.direction:null;return t.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${k} ${P?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>C(y),onMouseEnter:_=>{_.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",_.target.style.transform="translateY(-1px)",_.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:_=>{_.target.style.backgroundColor="transparent",_.target.style.transform="translateY(0)",_.target.style.boxShadow="none"},children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[t.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:P?"600":"500"},children:T}),t.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:t.jsx(zt,{direction:A,size:14})})]}),P&&t.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return t.jsxs("div",{children:[t.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search trainees in this subject...",value:c,onChange:d,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:f,selectedStatuses:m,onStatusToggle:v,onClearFilters:N,className:"filter-panel-mobile"})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(w,{columnKey:"name",className:"show-mobile",children:"Trainee"}),t.jsx(w,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),t.jsx(w,{columnKey:"department",className:"hide-mobile",children:"Department"}),t.jsx(w,{columnKey:"progress",className:"show-mobile",children:"Progress"}),t.jsx(w,{columnKey:"score",className:"hide-mobile",children:"Score"}),t.jsx(w,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:j.map(y=>t.jsxs("tr",{children:[t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:y.name}),t.jsxs("small",{className:"text-muted",children:[t.jsx(ha,{size:12,className:"me-1"}),y.email]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:y.employeeId})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:t.jsx("span",{className:"text-muted",children:y.department})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${y.progress}%`},"aria-valuenow":y.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),t.jsxs("small",{className:"text-muted",children:[y.progress,"%"]})]})}),t.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:y.score?t.jsxs(Te,{bg:y.score>=80?"success":y.score>=60?"warning":"danger",children:[y.score,"%"]}):t.jsx("span",{className:"text-muted",children:"-"})}),t.jsx("td",{className:"border-neutral-200 align-middle",children:h(y.status)}),t.jsx("td",{className:"border-neutral-200 align-middle text-center",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Trainee Details",icon:t.jsx(xt,{}),onClick:()=>p(y.id)},{label:"Send Message",icon:t.jsx(ha,{}),onClick:()=>x(y.id)}]})})]},y.id))})]})})]})},CA=()=>{const{subjectId:e}=Jt(),r=qe(),[s,a]=b.useState("trainees"),[n,i]=b.useState(null),[l,o]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{o(!0),await new Promise(f=>setTimeout(f,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(x){d("Failed to load subject details"),console.error("Error fetching subject:",x)}finally{o(!1)}})()},[e]);const m=p=>{const f={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[p]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:f.variant,children:f.text})},u=[{id:"trainees",title:"Trainee List",icon:Dt,component:t.jsx(EA,{subjectId:e})}],h=u.find(p=>p.id===s);return l?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:c})]})}):n?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>r(-1),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:n.title}),t.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(et,{size:24,className:"text-primary mb-2"}),t.jsx("h6",{className:"mb-1",children:"Duration"}),t.jsx("h4",{className:"mb-0 text-primary",children:n.duration}),t.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Dt,{size:24,className:"text-success mb-2"}),t.jsx("h6",{className:"mb-1",children:"Trainees"}),t.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),t.jsx("small",{className:"text-muted",children:"Completed"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"text-info mb-2",children:t.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),t.jsx("h6",{className:"mb-1",children:"Average Score"}),t.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),t.jsx("small",{className:"text-muted",children:"Performance"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(rt,{size:24,className:"text-warning mb-2"}),t.jsx("h6",{className:"mb-1",children:"Status"}),m(n.status)]})})})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Subject Information"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Description:"})," ",n.description]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(et,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),t.jsx(F,{md:6,children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Materials"})}),t.jsx(R.Body,{children:n.materials.map((p,x)=>t.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[t.jsxs("div",{children:[t.jsx("span",{className:"fw-medium",children:p.name}),t.jsx("small",{className:"text-muted d-block",children:p.type})]}),t.jsx("small",{className:"text-muted",children:p.size})]},x))})]})})]}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{children:[t.jsx(R.Header,{children:t.jsx("h5",{className:"mb-0",children:"Assessments"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Assessment"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Max Score"}),t.jsx("th",{children:"Average Score"})]})}),t.jsx("tbody",{children:n.assessments.map((p,x)=>t.jsxs("tr",{children:[t.jsx("td",{children:p.name}),t.jsx("td",{children:p.type}),t.jsx("td",{children:p.maxScore}),t.jsx("td",{children:p.averageScore})]},x))})]})})})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0",children:[t.jsx(R.Header,{className:"bg-primary text-white p-0",children:t.jsx("div",{className:"custom-tabs-container",children:u.map(p=>{const x=p.icon,f=s===p.id;return t.jsxs("button",{className:`custom-tab ${f?"active":""}`,onClick:()=>a(p.id),children:[t.jsx(x,{size:16,className:"me-2"}),p.title]},p.id)})})}),t.jsx(R.Body,{className:"p-0",children:h&&h.component})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Subject Not Found"}),t.jsx("p",{children:"The requested subject could not be found."})]})})},_A=()=>{const[e,r]=b.useState(null),[s,a]=b.useState(null),[n,i]=b.useState(!1),[l,o]=b.useState(!1),[c,d]=b.useState({type:"",text:""}),m=p=>{const x=p.target.files[0];if(x)if(x.type.startsWith("image/")){const f=new FileReader;f.onload=g=>{r(x),a(g.target.result)},f.readAsDataURL(x)}else d({type:"danger",text:"Please upload an image file."})},u=async()=>{if(!e){d({type:"warning",text:"Please upload a signature first."});return}o(!0);try{await new Promise(p=>setTimeout(p,2e3)),d({type:"success",text:"Signature saved successfully!"})}catch{d({type:"danger",text:"Failed to save signature. Please try again."})}finally{o(!1)}},h=()=>{r(null),a(null),d({type:"info",text:"Signature removed."})};return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsxs(F,{children:[t.jsx("h2",{className:"mb-2",children:"Configure Signature"}),t.jsx("p",{className:"text-muted",children:"Upload and manage your digital signature for assessments"})]})}),c.text&&t.jsx(Ae,{variant:c.type,className:"mb-4",children:c.text}),t.jsxs(oe,{children:[t.jsx(F,{lg:8,children:t.jsxs(R,{children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0",children:[t.jsx(Ls,{size:20,className:"me-2"}),"Digital Signature"]})}),t.jsx(R.Body,{className:"p-4",children:t.jsxs(E,{children:[t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{children:"Upload Signature Image"}),t.jsx(E.Control,{type:"file",accept:"image/*",onChange:m,className:"mb-3"}),t.jsx(E.Text,{className:"text-muted",children:"Supported formats: JPG, PNG, GIF. Maximum size: 2MB"})]}),s&&t.jsxs(E.Group,{className:"mb-4",children:[t.jsx(E.Label,{children:"Signature Preview"}),t.jsx("div",{className:"border rounded p-3 text-center bg-light",children:t.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"200px"},className:"img-fluid"})})]}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsx(se,{variant:"primary",onClick:u,disabled:!e||l,children:l?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{size:16,className:"me-2"}),"Save Signature"]})}),s&&t.jsxs(t.Fragment,{children:[t.jsxs(se,{variant:"outline-info",onClick:()=>i(!0),children:[t.jsx(xt,{size:16,className:"me-2"}),"Preview"]}),t.jsxs(se,{variant:"outline-danger",onClick:h,children:[t.jsx(Zr,{size:16,className:"me-2"}),"Remove"]})]})]})]})})]})}),t.jsxs(F,{lg:4,children:[t.jsxs(R,{children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h6",{className:"mb-0",children:"Signature Guidelines"})}),t.jsx(R.Body,{children:t.jsxs("ul",{className:"list-unstyled mb-0",children:[t.jsx("li",{className:"mb-2",children:t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Format:"})," Use clear, high-contrast signature"]})}),t.jsx("li",{className:"mb-2",children:t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Size:"})," Recommended 300x100 pixels"]})}),t.jsx("li",{className:"mb-2",children:t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Background:"})," White or transparent background"]})}),t.jsx("li",{className:"mb-2",children:t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Quality:"})," High resolution for clarity"]})}),t.jsx("li",{className:"mb-0",children:t.jsxs("small",{className:"text-muted",children:[t.jsx("strong",{children:"Usage:"})," Will be used on all assessment documents"]})})]})})]}),t.jsxs(R,{className:"mt-3",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h6",{className:"mb-0",children:"Current Status"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"text-center",children:e?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-success mb-2",children:t.jsx(Ls,{size:32})}),t.jsx("h6",{className:"text-success",children:"Signature Configured"}),t.jsx("small",{className:"text-muted",children:"Your signature is ready for use"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-muted mb-2",children:t.jsx(Ls,{size:32})}),t.jsx("h6",{className:"text-muted",children:"No Signature"}),t.jsx("small",{className:"text-muted",children:"Upload a signature to get started"})]})})})]})]})]}),t.jsxs(le,{show:n,onHide:()=>i(!1),size:"lg",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:"Signature Preview"})}),t.jsx(le.Body,{className:"text-center",children:s&&t.jsx("div",{className:"border rounded p-4 bg-light",children:t.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"300px"},className:"img-fluid"})})}),t.jsx(le.Footer,{children:t.jsx(se,{variant:"secondary",onClick:()=>i(!1),children:"Close"})})]})]})},kA=()=>{const{resultId:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState("overview");b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(j=>setTimeout(j,1e3)),a({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(N){o("Failed to fetch assessment details."),console.error(N)}finally{i(!1)}})()},[e]);const m=(v,N)=>{const j=v/N*100;return j>=80?"success":j>=60?"warning":"danger"},u=v=>v.includes("A")?"success":v.includes("B")?"info":v.includes("C")?"warning":"danger",h=v=>{const N={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},j=N[v]||N.pending;return t.jsx(Te,{bg:j.bg,children:j.text})},p=()=>{console.log("Downloading report for result:",e)},x=()=>{r(`/trainer/approval-notes/${e}`)};if(n)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(It,{height:400})})})});if(l)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(Ae,{variant:"danger",children:l})})})});if(!s)return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(Ae,{variant:"info",children:"Assessment result not found"})})})});const f=[{id:"overview",title:"Assessment Overview",icon:$s,component:t.jsx("div",{className:"p-4",children:t.jsxs(oe,{children:[t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),t.jsx("h5",{className:"mb-0",children:s.title})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Course"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.course})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.trainee})]})]})]}),t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Score"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsxs("span",{className:`h4 mb-0 text-${m(s.score,s.maxScore)}`,children:[s.score,"/",s.maxScore]}),t.jsx(Te,{bg:u(s.grade),className:"ms-2 fs-6",children:s.grade})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Status"}),h(s.status)]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:C0,component:t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),t.jsx("tbody",{children:s.sections.map(v=>t.jsxs("tr",{children:[t.jsx("td",{className:"fw-bold",children:v.name}),t.jsx("td",{children:t.jsxs("span",{className:`fw-bold text-${m(v.score,v.maxScore)}`,children:[v.score,"/",v.maxScore]})}),t.jsx("td",{children:h(v.status)}),t.jsx("td",{children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(et,{size:14,className:"me-1 text-muted"}),t.jsx("span",{children:v.timeSpent})]})})]},v.id))})]})})}],g=f.find(v=>v.id===c);return t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>r("/trainer/assessment-results"),children:[t.jsx(bt,{size:16,className:"me-2"}),"Back to Results"]}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsxs(se,{variant:"outline-primary",onClick:p,children:[t.jsx(qr,{size:16,className:"me-2"}),"Download Report"]}),t.jsxs(se,{variant:"outline-secondary",onClick:x,children:[t.jsx(xt,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(R,{className:"border-0",children:[t.jsx(R.Header,{className:"bg-primary text-white p-0",children:t.jsx("div",{className:"custom-tabs-container",children:f.map(v=>{const N=v.icon,j=c===v.id;return t.jsxs("button",{className:`custom-tab ${j?"active":""}`,onClick:()=>d(v.id),children:[t.jsx(N,{size:16,className:"me-2"}),v.title]},v.id)})})}),t.jsx(R.Body,{className:"p-0",children:g&&g.component})]})})})]})},AA=()=>{const{resultId:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState(!1),[m,u]=b.useState(!1),[h,p]=b.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(y=>setTimeout(y,1e3));const w={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};a(w),p({status:w.approvalStatus,notes:w.approvalNotes,approvedBy:"",approvedDate:""})}catch(w){o("Failed to load assessment result data"),console.error("Error fetching result data:",w)}finally{i(!1)}})()},[e]);const x=(C,w)=>{const y=C/w*100;return y>=80?"success":y>=60?"warning":"danger"},f=C=>C.includes("A")?"success":C.includes("B")?"info":C.includes("C")?"warning":"danger",g=C=>{const w={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},y=w[C]||w.pending;return t.jsx(Te,{bg:y.bg,children:y.text})},v=(C,w)=>{p(y=>({...y,[C]:w}))},N=async()=>{try{d(!0),await new Promise(C=>setTimeout(C,1500)),a(C=>({...C,approvalStatus:h.status,approvalNotes:h.notes})),u(!1),console.log("Approval saved successfully")}catch(C){console.error("Error saving approval:",C)}finally{d(!1)}},j=()=>{p(C=>({...C,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),u(!0)},S=()=>{p(C=>({...C,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),u(!0)};return n?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(It,{height:400})})})}):l?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(Ae,{variant:"danger",children:l})})})}):s?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>r(`/trainer/assessment-details/${e}`),className:"me-3",children:[t.jsx(bt,{size:16,className:"me-2"}),"Back to Details"]}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),t.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),t.jsxs(oe,{children:[t.jsxs(F,{lg:8,children:[t.jsxs(R,{className:"mb-4",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0",children:[t.jsx($s,{size:20,className:"me-2"}),"Assessment Summary"]})}),t.jsx(R.Body,{children:t.jsxs(oe,{children:[t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),t.jsx("h5",{className:"mb-0",children:s.title})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Course"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.course})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.trainee})]})]})]}),t.jsxs(F,{md:6,children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Score"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsxs("span",{className:`h4 mb-0 text-${x(s.score,s.maxScore)}`,children:[s.score,"/",s.maxScore]}),t.jsx(Te,{bg:f(s.grade),className:"ms-2 fs-6",children:s.grade})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(s.approvalStatus)]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Lt,{size:16,className:"me-2 text-muted"}),t.jsx("span",{children:s.completedDate})]})]})]})]})})]}),t.jsxs(R,{className:"mb-4",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0",children:[t.jsx(bc,{size:20,className:"me-2"}),"Trainer Notes"]})}),t.jsx(R.Body,{children:t.jsx("p",{className:"mb-0",children:s.trainerNotes})})]}),s.previousApprovals&&s.previousApprovals.length>0&&t.jsxs(R,{className:"mb-4",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsxs("h5",{className:"mb-0",children:[t.jsx(et,{size:20,className:"me-2"}),"Approval History"]})}),t.jsx(R.Body,{children:s.previousApprovals.map(C=>t.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[t.jsxs("div",{children:[t.jsxs("h6",{className:"mb-1",children:[C.type.charAt(0).toUpperCase()+C.type.slice(1)," Approval"]}),t.jsxs("small",{className:"text-muted",children:["Approved by ",C.approvedBy," on ",C.approvedDate]})]}),g(C.status)]}),C.notes&&t.jsx("p",{className:"mb-0 text-muted",children:C.notes})]},C.id))})]})]}),t.jsxs(F,{lg:4,children:[t.jsxs(R,{className:"mb-4",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h6",{className:"mb-0",children:"Current Status"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mb-3",children:g(s.approvalStatus)}),s.approvalNotes&&t.jsxs("div",{children:[t.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),t.jsx("p",{className:"small text-muted",children:s.approvalNotes})]})]})})]}),t.jsxs(R,{children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),t.jsx(R.Body,{children:t.jsxs("div",{className:"d-grid gap-2",children:[t.jsxs(se,{variant:"success",onClick:j,className:"d-flex align-items-center justify-content-center",children:[t.jsx(rt,{size:16,className:"me-2"}),"Approve Result"]}),t.jsxs(se,{variant:"danger",onClick:S,className:"d-flex align-items-center justify-content-center",children:[t.jsx(Ms,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),t.jsxs(le,{show:m,onHide:()=>u(!1),size:"lg",children:[t.jsx(le.Header,{closeButton:!0,children:t.jsx(le.Title,{children:h.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),t.jsx(le.Body,{children:t.jsxs(E,{children:[t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Approval Notes"}),t.jsx(E.Control,{as:"textarea",rows:4,value:h.notes,onChange:C=>v("notes",C.target.value),placeholder:"Enter your approval notes..."})]}),t.jsxs(E.Group,{className:"mb-3",children:[t.jsx(E.Label,{children:"Approved By"}),t.jsx(E.Control,{type:"text",value:h.approvedBy,onChange:C=>v("approvedBy",C.target.value),placeholder:"Enter your name"})]}),t.jsxs(E.Group,{children:[t.jsx(E.Label,{children:"Approval Date"}),t.jsx(E.Control,{type:"date",value:h.approvedDate,onChange:C=>v("approvedDate",C.target.value)})]})]})}),t.jsxs(le.Footer,{children:[t.jsx(se,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),t.jsx(se,{variant:h.status==="approved"?"success":"danger",onClick:N,disabled:c,children:c?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cr,{size:16,className:"me-2"}),h.status==="approved"?"Approve":"Reject"]})})]})]})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsx(oe,{children:t.jsx(F,{children:t.jsx(Ae,{variant:"info",children:"Assessment result not found"})})})})},DA=()=>{const e=qe(),[r,s]=b.useState("department-dashboard"),a=[{id:"department-dashboard",title:"Department Dashboard",icon:Tr,description:"Overview of department activities and statistics",color:"primary"},{id:"my-department-details",title:"My Department Details",icon:it,description:"Manage courses, subjects, and trainees in your department",color:"info"},{id:"assessment-review-requests",title:"List Assessment Review Requests",icon:vt,description:"Review and approve/deny assessment requests",color:"warning"}],n=[{title:"View Course Details",description:"Access detailed course information and management",icon:it,path:"/department-head/my-department-details",color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:vt,path:"/department-head/assessment-review-requests",color:"warning"},{title:"Department Statistics",description:"View department performance metrics",icon:rs,path:"/department-head/statistics",color:"info"},{title:"Trainee Management",description:"Manage trainee enrollments and progress",icon:rs,path:"/department-head/trainee-management",color:"success"}],i=()=>{switch(r){case"department-dashboard":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Department Dashboard"}),t.jsxs(oe,{children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(it,{size:24,className:"text-primary"})}),t.jsx("h5",{className:"mb-1",children:"12"}),t.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(rs,{size:24,className:"text-success"})}),t.jsx("h5",{className:"mb-1",children:"156"}),t.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(vt,{size:24,className:"text-warning"})}),t.jsx("h5",{className:"mb-1",children:"8"}),t.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(Ba,{size:24,className:"text-info"})}),t.jsx("h5",{className:"mb-1",children:"24"}),t.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})]});case"my-department-details":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"My Department Details"}),t.jsx("p",{className:"text-muted",children:"Access course management, subject lists, and trainee information for your department."}),t.jsxs(se,{variant:"primary",onClick:()=>e("/department-head/my-department-details"),className:"me-2",children:[t.jsx(it,{className:"me-2"}),"View Course List"]})]});case"assessment-review-requests":return t.jsxs("div",{children:[t.jsx("h4",{className:"mb-4",children:"Assessment Review Requests"}),t.jsx("p",{className:"text-muted",children:"Review and approve or deny assessment requests from your department."}),t.jsxs(se,{variant:"warning",onClick:()=>e("/department-head/assessment-review-requests"),className:"me-2",children:[t.jsx(vt,{className:"me-2"}),"View Review Requests"]})]});default:return null}};return t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(oe,{children:[t.jsx(F,{lg:3,className:"mb-4",children:t.jsxs(R,{className:"h-100 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Department Head Portal"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"list-group list-group-flush",children:a.map(l=>{const o=l.icon,c=r===l.id;return t.jsx("button",{className:`list-group-item list-group-item-action border-0 ${c?"bg-primary text-white":""}`,onClick:()=>s(l.id),style:{border:"none",borderRadius:0,padding:"1rem"},children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(o,{size:20,className:`me-3 ${c?"text-white":"text-primary"}`}),t.jsxs("div",{className:"flex-grow-1 text-start",children:[t.jsx("h6",{className:`mb-1 ${c?"text-white":"text-dark"}`,children:l.title}),t.jsx("small",{className:`${c?"text-white-50":"text-muted"}`,children:l.description})]}),c&&t.jsx(Gr,{size:16,className:"text-white"})]})},l.id)})})})]})}),t.jsxs(F,{lg:9,children:[t.jsx(R,{className:"border-0 shadow-sm",children:t.jsx(R.Body,{children:i()})}),t.jsxs(R,{className:"mt-4 border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light",children:t.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),t.jsx(R.Body,{children:t.jsx(oe,{children:n.map((l,o)=>{const c=l.icon;return t.jsx(F,{md:6,className:"mb-3",children:t.jsx(se,{variant:"outline-primary",className:"w-100 h-100 p-3 text-start",onClick:()=>e(l.path),style:{minHeight:"80px"},children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:`bg-${l.color} bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px"},children:t.jsx(c,{size:20,className:`text-${l.color}`})}),t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("h6",{className:"mb-1",children:l.title}),t.jsx("small",{className:"text-muted",children:l.description})]})]})})},o)})})})]})]})]})})},IA=({course:e,index:r,onView:s,onEdit:a})=>{const n=l=>{const o={active:{variant:"success",icon:rt},inactive:{variant:"secondary",icon:et},pending:{variant:"warning",icon:et}},c=o[l]||o.pending,d=c.icon;return t.jsxs(Te,{bg:c.variant,className:"d-flex align-items-center",children:[t.jsx(d,{size:12,className:"me-1"}),l.toUpperCase()]})},i=l=>[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(l),permission:be.COURSES.VIEW_DETAIL},{label:"Edit Course",icon:t.jsx(bs,{}),onClick:()=>a(l),permission:be.COURSES.UPDATE}];return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),t.jsx("small",{className:"text-muted",children:e.description})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-dark fw-medium",children:e.code})}),t.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{size:16,className:"me-1 text-muted"}),t.jsx("span",{children:e.enrolledCount})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.COURSES.VIEW_DETAIL,be.COURSES.UPDATE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:i(e)})})})]})},PA=()=>{const e=qe(),{courseId:r}=Jt(),[s,a]=b.useState([]),[n,i]=b.useState(!0),[l,o]=b.useState(""),[c,d]=b.useState("all"),[m,u]=b.useState(null),[h,p]=b.useState("subjects");b.useEffect(()=>{const N=[{id:1,title:"Software Development Fundamentals",code:"SDF-001",description:"Introduction to software development principles and practices",status:"active",enrolledCount:25,startDate:"2024-01-15T09:00:00Z",department:"IT Department"},{id:2,title:"Database Management Systems",code:"DMS-002",description:"Comprehensive course on database design and management",status:"active",enrolledCount:18,startDate:"2024-01-20T10:00:00Z",department:"IT Department"},{id:3,title:"Web Development Advanced",code:"WDA-003",description:"Advanced web development techniques and frameworks",status:"pending",enrolledCount:12,startDate:"2024-02-01T09:00:00Z",department:"IT Department"}];setTimeout(()=>{a(N),i(!1)},1e3)},[]);const x=s.filter(N=>{const j=N.title.toLowerCase().includes(l.toLowerCase())||N.code.toLowerCase().includes(l.toLowerCase())||N.description.toLowerCase().includes(l.toLowerCase()),S=c==="all"||N.status===c;return j&&S}),f=N=>{u(N),e(`/department-head/my-department-details/${N.id}`)},g=N=>{console.log("Edit course:",N)};return[{id:"subjects",title:"Subject List",icon:it,component:t.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:rs,component:t.jsx("div",{children:"Trainee List Component"})}].find(N=>N.id===h),n?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading department details..."})]})}):t.jsx(Ee,{fluid:!0,className:"py-4 my-department-details-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/dashboard"),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:"My Department Details"}),t.jsx("p",{className:"text-muted mb-0",children:"Manage courses, subjects, and trainees in your department"})]})]})})})}),t.jsx(R.Body,{children:t.jsxs(R,{className:"border-0 shadow-sm mb-0",children:[t.jsx(R.Header,{className:"department-head-section-header bg-primary text-white border-0",children:t.jsx("div",{className:"d-flex justify-content-between align-items-center",children:t.jsxs("h5",{className:"mb-0 text-white",children:[t.jsx(it,{className:"me-2"}),"Courses (",x.length,")"]})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search courses by title, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsxs("select",{className:"form-select filter-panel-mobile",value:c,onChange:N=>d(N.target.value),children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"}),t.jsx("option",{value:"pending",children:"Pending"})]})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[x.length," course",x.length!==1?"s":""]})})})]}),t.jsx(Ga,{data:x,loading:n,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(N,j)=>t.jsx(IA,{course:N,index:j,onView:f,onEdit:g},N.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})]})})},RA=({request:e,index:r,onView:s,onApprove:a,onDeny:n})=>{const i=o=>{const c={pending:{variant:"warning",icon:et},approved:{variant:"success",icon:rt},denied:{variant:"danger",icon:Ms}},d=c[o]||c.pending,m=d.icon;return t.jsxs(Te,{bg:d.variant,className:"d-flex align-items-center",children:[t.jsx(m,{size:12,className:"me-1"}),o.toUpperCase()]})},l=o=>{const c=[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(o),permission:be.ASSESSMENTS.VIEW_DETAIL}];return o.status==="pending"&&c.push({type:"divider"},{label:"Approve Results",icon:t.jsx(x0,{}),className:"text-success",onClick:()=>a(o),permission:be.ASSESSMENTS.APPROVE},{label:"Deny Results",icon:t.jsx(Ge,{}),className:"text-danger",onClick:()=>n(o),permission:be.ASSESSMENTS.APPROVE}),c};return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:e.traineeName}),t.jsx("small",{className:"text-muted",children:e.traineeEmail})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:e.courseTitle}),t.jsx("small",{className:"text-muted",children:e.courseCode})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"fw-medium",children:e.assessmentTitle}),t.jsx("small",{className:"text-muted",children:e.assessmentType})]})}),t.jsx("td",{className:"align-middle show-mobile",children:i(e.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(e.submittedDate).toLocaleDateString()})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"fw-medium",children:e.score?`${e.score}%`:"N/A"})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.ASSESSMENTS.VIEW_DETAIL,be.ASSESSMENTS.APPROVE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:l(e)})})})]})},l0=()=>{const e=qe(),[r,s]=b.useState([]),[a,n]=b.useState(!0),[i,l]=b.useState(""),[o,c]=b.useState("all");b.useEffect(()=>{const f=[{id:1,traineeName:"John Smith",traineeEmail:"john.smith@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Final Assessment",assessmentType:"Practical Exam",status:"pending",submittedDate:"2024-01-15T14:30:00Z",score:85,department:"IT Department"},{id:2,traineeName:"Sarah Johnson",traineeEmail:"sarah.johnson@company.com",courseTitle:"Database Management Systems",courseCode:"DMS-002",assessmentTitle:"Database Design Project",assessmentType:"Project",status:"pending",submittedDate:"2024-01-14T16:45:00Z",score:92,department:"IT Department"},{id:3,traineeName:"Mike Wilson",traineeEmail:"mike.wilson@company.com",courseTitle:"Web Development Advanced",courseCode:"WDA-003",assessmentTitle:"Frontend Development Test",assessmentType:"Written Exam",status:"approved",submittedDate:"2024-01-13T10:20:00Z",score:78,department:"IT Department"},{id:4,traineeName:"Emily Davis",traineeEmail:"emily.davis@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Midterm Assessment",assessmentType:"Practical Exam",status:"denied",submittedDate:"2024-01-12T09:15:00Z",score:45,department:"IT Department"}];setTimeout(()=>{s(f),n(!1)},1e3)},[]);const d=r.filter(f=>{const g=f.traineeName.toLowerCase().includes(i.toLowerCase())||f.courseTitle.toLowerCase().includes(i.toLowerCase())||f.assessmentTitle.toLowerCase().includes(i.toLowerCase()),v=o==="all"||f.status===o;return g&&v}),m=f=>{e(`/department-head/assessment-review-requests/${f.id}`)},u=f=>{console.log("Approve request:",f),s(g=>g.map(v=>v.id===f.id?{...v,status:"approved"}:v))},h=f=>{console.log("Deny request:",f),s(g=>g.map(v=>v.id===f.id?{...v,status:"denied"}:v))},x=(()=>{const f=r.reduce((g,v)=>(g[v.status]=(g[v.status]||0)+1,g),{});return{pending:f.pending||0,approved:f.approved||0,denied:f.denied||0,total:r.length}})();return a?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):t.jsx(Ee,{fluid:!0,className:"py-4 assessment-review-requests-page",children:t.jsxs(R,{className:"border-neutral-200 shadow-sm",children:[t.jsx(R.Header,{className:"bg-light-custom border-neutral-200",children:t.jsx(oe,{className:"align-items-center",children:t.jsx(F,{xs:12,className:"mt-2 mt-md-0 mb-3",children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/dashboard"),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),t.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})]})})})}),t.jsxs(R.Body,{children:[t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(et,{size:24,className:"text-warning"})}),t.jsx("h5",{className:"mb-1",children:x.pending}),t.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(rt,{size:24,className:"text-success"})}),t.jsx("h5",{className:"mb-1",children:x.approved}),t.jsx("p",{className:"text-muted mb-0",children:"Approved"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-danger bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(Ms,{size:24,className:"text-danger"})}),t.jsx("h5",{className:"mb-1",children:x.denied}),t.jsx("p",{className:"text-muted mb-0",children:"Denied"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:t.jsx(vt,{size:24,className:"text-primary"})}),t.jsx("h5",{className:"mb-1",children:x.total}),t.jsx("p",{className:"text-muted mb-0",children:"Total Requests"})]})})})]}),t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search requests by trainee name, course, or assessment...",value:i,onChange:l,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:f=>c(f.target.value),children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"approved",children:"Approved"}),t.jsx("option",{value:"denied",children:"Denied"})]})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[d.length," request",d.length!==1?"s":""]})})})]}),t.jsx(Ga,{data:d,loading:a,columns:[{key:"traineeName",title:"Trainee Name",className:"show-mobile",sortable:!0},{key:"courseTitle",title:"Course",className:"show-mobile",sortable:!0},{key:"assessmentTitle",title:"Assessment",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"submittedDate",title:"Submitted Date",className:"hide-mobile",sortable:!0},{key:"score",title:"Score",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(f,g)=>t.jsx(RA,{request:f,index:g,onView:m,onApprove:u,onDeny:h},f.id),emptyMessage:"No assessment requests found",emptyDescription:"Try adjusting your search criteria."})]})]})})},FA=({subjects:e,loading:r,onView:s,onEdit:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=Ot(e);if(r)return t.jsx(It,{rows:5,columns:6});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No subjects found"}),t.jsx("p",{children:"No subjects are available in this course."})]})});const o=({columnKey:c,children:d,className:m=""})=>{const u=i.key===c,h=u?i.direction:null;return t.jsx("th",{className:`text-primary-custom fw-semibold ${m} ${u?"text-primary":"text-muted"}`,onClick:()=>l(c),style:{cursor:"pointer"},children:t.jsxs("div",{className:"d-flex align-items-center",children:[d,t.jsx(zt,{direction:h,className:"ms-1"})]})})};return t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(o,{columnKey:"title",className:"show-mobile",children:"Subject Title"}),t.jsx(o,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),t.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(o,{columnKey:"enrolledCount",className:"hide-mobile",children:"Enrolled"}),t.jsx(o,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),t.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:n.map((c,d)=>t.jsx(OA,{subject:c,index:d,onView:s,onEdit:a},c.id))})]})})},OA=({subject:e,index:r,onView:s,onEdit:a})=>{const n=l=>{const o={active:{variant:"success",icon:rt},inactive:{variant:"secondary",icon:et},pending:{variant:"warning",icon:et}},c=o[l]||o.pending,d=c.icon;return t.jsxs(Te,{bg:c.variant,className:"d-flex align-items-center",children:[t.jsx(d,{size:12,className:"me-1"}),l.toUpperCase()]})},i=l=>[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(l),permission:be.SUBJECTS.VIEW_DETAIL},{label:"Edit Subject",icon:t.jsx(bs,{}),onClick:()=>a(l),permission:be.SUBJECTS.UPDATE}];return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),t.jsx("small",{className:"text-muted",children:e.description})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-dark fw-medium",children:e.code})}),t.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(rs,{size:16,className:"me-1 text-muted"}),t.jsx("span",{children:e.enrolledCount})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{className:"text-muted small",children:[e.duration," hours"]})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.SUBJECTS.VIEW_DETAIL,be.SUBJECTS.UPDATE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:i(e)})})})]})},LA=({trainees:e,loading:r,onView:s,onEdit:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=Ot(e);if(r)return t.jsx(It,{rows:5,columns:6});if(e.length===0)return t.jsx("div",{className:"text-center py-5",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No trainees found"}),t.jsx("p",{children:"No trainees are enrolled in this course."})]})});const o=({columnKey:c,children:d,className:m=""})=>{const u=i.key===c,h=u?i.direction:null;return t.jsx("th",{className:`text-primary-custom fw-semibold ${m} ${u?"text-primary":"text-muted"}`,onClick:()=>l(c),style:{cursor:"pointer"},children:t.jsxs("div",{className:"d-flex align-items-center",children:[d,t.jsx(zt,{direction:h,className:"ms-1"})]})})};return t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(o,{columnKey:"name",className:"show-mobile",children:"Trainee Name"}),t.jsx(o,{columnKey:"email",className:"show-mobile",children:"Email"}),t.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx(o,{columnKey:"enrollmentDate",className:"hide-mobile",children:"Enrollment Date"}),t.jsx(o,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),t.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:n.map((c,d)=>t.jsx(MA,{trainee:c,index:d,onView:s,onEdit:a},c.id))})]})})},MA=({trainee:e,index:r,onView:s,onEdit:a})=>{const n=l=>{const o={active:{variant:"success",icon:rt},inactive:{variant:"secondary",icon:et},pending:{variant:"warning",icon:et}},c=o[l]||o.pending,d=c.icon;return t.jsxs(Te,{bg:c.variant,className:"d-flex align-items-center",children:[t.jsx(d,{size:12,className:"me-1"}),l.toUpperCase()]})},i=l=>[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>s(l),permission:be.TRAINEES.VIEW_DETAIL},{label:"Edit Trainee",icon:t.jsx(bs,{}),onClick:()=>a(l),permission:be.TRAINEES.UPDATE}];return t.jsxs("tr",{className:`${r%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=r%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),t.jsx("small",{className:"text-muted",children:e.department})]})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsx("span",{className:"text-dark",children:e.email})}),t.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("div",{className:"text-muted small",children:new Date(e.enrollmentDate).toLocaleDateString()})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("div",{className:"fw-medium",children:[e.progress,"%"]})}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Ht,{permissions:[be.TRAINEES.VIEW_DETAIL,be.TRAINEES.UPDATE],fallback:null,children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:i(e)})})})]})},BA=()=>{const e=qe(),{courseId:r}=Jt(),[s,a]=b.useState(null),[n,i]=b.useState([]),[l,o]=b.useState([]),[c,d]=b.useState(!0),[m,u]=b.useState("subjects");b.useEffect(()=>{const N={id:r,title:"Software Development Fundamentals",code:"SDF-001",description:"Introduction to software development principles and practices",status:"active",enrolledCount:25,startDate:"2024-01-15T09:00:00Z",department:"IT Department"},j=[{id:1,title:"Programming Basics",code:"PB-001",description:"Introduction to programming concepts",status:"active",enrolledCount:25,duration:40},{id:2,title:"Data Structures",code:"DS-002",description:"Understanding data structures and algorithms",status:"active",enrolledCount:25,duration:60},{id:3,title:"Database Design",code:"DD-003",description:"Database design principles and SQL",status:"pending",enrolledCount:25,duration:50}],S=[{id:1,name:"John Smith",email:"john.smith@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-15T09:00:00Z",progress:75},{id:2,name:"Sarah Johnson",email:"sarah.johnson@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-15T09:00:00Z",progress:60},{id:3,name:"Mike Wilson",email:"mike.wilson@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-16T10:00:00Z",progress:45}];setTimeout(()=>{a(N),i(j),o(S),d(!1)},1e3)},[r]);const h=N=>{e(`/department-head/courses/${r}/subjects/${N.id}`)},p=N=>{console.log("Edit subject:",N)},x=N=>{e(`/department-head/trainees/${N.id}`)},f=N=>{console.log("Edit trainee:",N)},g=[{id:"subjects",title:"Subject List",icon:it,component:t.jsx(FA,{subjects:n,loading:c,onView:h,onEdit:p})},{id:"trainees",title:"Trainee List",icon:rs,component:t.jsx(LA,{trainees:l,loading:c,onView:x,onEdit:f})}],v=g.find(N=>N.id===m);return c?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):s?t.jsxs(Ee,{fluid:!0,className:"py-4 course-details-page",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/my-department-details"),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:s.title}),t.jsxs("p",{className:"text-muted mb-0",children:[s.code,"  ",s.department]})]})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0",children:[t.jsx(R.Header,{className:"department-head-section-header bg-primary text-white border-0 p-0",children:t.jsx("div",{className:"custom-tabs-container",children:g.map(N=>{const j=N.icon,S=m===N.id;return t.jsxs("button",{className:`custom-tab ${S?"active":""}`,onClick:()=>u(N.id),children:[t.jsx(j,{size:16,className:"me-2"}),N.title]},N.id)})})}),t.jsx(R.Body,{className:"p-0",children:v&&v.component})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Course Not Found"}),t.jsx("p",{children:"The requested course could not be found."})]})})},zA=({subjectId:e,courseId:r})=>{const s=qe(),[a,n]=b.useState([]),[i,l]=b.useState(!0),[o,c]=b.useState(null),[d,m]=b.useState(""),[u,h]=b.useState([]);b.useEffect(()=>{(async()=>{try{l(!0),await new Promise(k=>setTimeout(k,1e3)),n([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"TE002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"TE003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"TE004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"TE005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(T){c("Failed to load trainees in subject"),console.error("Error fetching trainees:",T)}finally{l(!1)}})()},[e]);const p=y=>{const k={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[y]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:k.variant,children:k.text})},x=y=>{s(`/department-head/trainees/${y}`)},f=[...new Set(a.map(y=>y.status))],g=a.filter(y=>{const T=u.length===0||u.includes(y.status),k=y.name.toLowerCase().includes(d.toLowerCase())||y.email.toLowerCase().includes(d.toLowerCase())||y.employeeId.toLowerCase().includes(d.toLowerCase())||y.department.toLowerCase().includes(d.toLowerCase());return T&&k}),v=y=>{h(y==="clear"?[]:T=>T.includes(y)?T.filter(k=>k!==y):[...T,y])},N=()=>{h([]),m("")},{sortedData:j,sortConfig:S,handleSort:C}=Ot(g),w=({columnKey:y,children:T,className:k=""})=>{const P=S.key===y,A=P?S.direction:null;return t.jsx("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${k} ${P?"text-primary":"text-muted"}`,onClick:()=>C(y),style:{cursor:"pointer"},children:t.jsxs("div",{className:"d-flex align-items-center",children:[T,t.jsx(zt,{direction:A,className:"ms-1"})]})})};return i?t.jsx(It,{rows:5,columns:7}):o?t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:o})]}):g.length===0?t.jsx("div",{className:"text-center py-5 p-4",children:t.jsxs("div",{className:"text-muted",children:[t.jsx("h5",{children:"No trainees found"}),t.jsx("p",{children:"Try adjusting your search criteria."})]})}):t.jsxs("div",{className:"p-4",children:[t.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[t.jsx(F,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:t.jsx(ds,{placeholder:"Search trainees in this subject...",value:d,onChange:m,className:"search-bar-mobile"})}),t.jsx(F,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:t.jsx(sa,{uniqueStatuses:f,selectedStatuses:u,onStatusToggle:v,onClearFilters:N,className:"filter-panel-mobile"})}),t.jsx(F,{xs:12,lg:3,md:3,children:t.jsx("div",{className:"text-end text-mobile-center",children:t.jsxs("small",{className:"text-muted",children:[g.length," trainee",g.length!==1?"s":""]})})})]}),t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx(w,{columnKey:"name",className:"show-mobile",children:"Trainee"}),t.jsx(w,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),t.jsx(w,{columnKey:"department",className:"hide-mobile",children:"Department"}),t.jsx(w,{columnKey:"progress",className:"show-mobile",children:"Progress"}),t.jsx(w,{columnKey:"score",className:"hide-mobile",children:"Score"}),t.jsx(w,{columnKey:"status",className:"show-mobile",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),t.jsx("tbody",{children:j.map((y,T)=>t.jsxs("tr",{className:`${T%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor=T%2===0?"white":"var(--bs-neutral-50)"},children:[t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx(Dt,{size:18,className:"me-2 text-primary"}),t.jsxs("div",{children:[t.jsx("h6",{className:"mb-0 fw-medium",children:y.name}),t.jsx("small",{className:"text-muted",children:y.email})]})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{className:"text-dark fw-medium",children:y.employeeId})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{children:y.department})}),t.jsx("td",{className:"align-middle show-mobile",children:t.jsxs("div",{children:[t.jsx("div",{className:"d-flex justify-content-between mb-1",children:t.jsxs("span",{className:"fw-medium",children:[y.progress,"%"]})}),t.jsx("div",{className:"progress",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${y.progress}%`}})})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:y.score?t.jsx("span",{className:"fw-bold text-success",children:y.score}):t.jsx("span",{className:"text-muted",children:"-"})}),t.jsx("td",{className:"align-middle show-mobile",children:p(y.status)}),t.jsx("td",{className:"align-middle text-center show-mobile",children:t.jsx(Pt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:t.jsx(Ct,{size:16})},items:[{label:"View Details",icon:t.jsx(xt,{}),onClick:()=>x(y.id)}]})})]},y.id))})]})})]})},$A=()=>{const{courseId:e,subjectId:r}=Jt(),s=qe(),[a,n]=b.useState("trainees"),[i,l]=b.useState(null),[o,c]=b.useState(!0),[d,m]=b.useState(null);b.useEffect(()=>{(async()=>{try{c(!0),await new Promise(g=>setTimeout(g,1e3)),l({id:r,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols. This module covers essential safety protocols, emergency procedures, and compliance requirements for aviation operations.",duration:2,status:"active",instructor:"Dr. Smith",course:"Aviation Safety Management",courseCode:"ASM-101",startDate:"2024-01-15",endDate:"2024-03-15",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,inProgressTrainees:3,pendingTrainees:2,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(f){m("Failed to load subject details"),console.error("Error fetching subject:",f)}finally{c(!1)}})()},[r]);const u=x=>{const g={active:{variant:"success",text:"Active"},pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},archived:{variant:"secondary",text:"Archived"}}[x]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:g.variant,children:g.text})},h=[{id:"trainees",title:"Trainee List",icon:Dt,component:t.jsx(zA,{subjectId:r,courseId:e})}],p=h.find(x=>x.id===a);return o?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):d?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:d})]})}):i?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>s(`/department-head/my-department-details/${e}`),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:i.title}),t.jsxs("p",{className:"text-muted mb-0",children:[i.code,"  ",i.course," (",i.courseCode,")"]})]})]})})}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(et,{size:24,className:"text-primary mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Duration"}),t.jsxs("h4",{className:"mb-0 text-primary",children:[i.duration," hours"]}),t.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Dt,{size:24,className:"text-success mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Trainees"}),t.jsxs("h4",{className:"mb-0 text-success",children:[i.completedTrainees,"/",i.totalTrainees]}),t.jsx("small",{className:"text-muted",children:"Completed"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"text-info mb-2",children:t.jsx($s,{size:24})}),t.jsx("h6",{className:"mb-1 text-muted",children:"Average Score"}),t.jsxs("h4",{className:"mb-0 text-info",children:[i.averageScore,"%"]}),t.jsx("small",{className:"text-muted",children:"Performance"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(rt,{size:24,className:"text-warning mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Status"}),t.jsx("div",{className:"mt-2",children:u(i.status)})]})})})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Subject Information"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx(it,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Description:"}),t.jsx("p",{className:"mt-1 mb-0",children:i.description})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Instructor:"})," ",i.instructor]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Lt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Schedule:"})," ",i.startDate," - ",i.endDate]}),t.jsxs("div",{className:"mb-0",children:[t.jsx(et,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Completion Date:"})," ",i.completionDate||"N/A"]})]})]})}),t.jsx(F,{md:6,children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Enrollment Statistics"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[t.jsx("span",{children:"Completed"}),t.jsx("span",{className:"fw-bold text-success",children:i.completedTrainees})]}),t.jsx("div",{className:"progress",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-success",role:"progressbar",style:{width:`${i.completedTrainees/i.totalTrainees*100}%`}})})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[t.jsx("span",{children:"In Progress"}),t.jsx("span",{className:"fw-bold text-info",children:i.inProgressTrainees})]}),t.jsx("div",{className:"progress",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-info",role:"progressbar",style:{width:`${i.inProgressTrainees/i.totalTrainees*100}%`}})})]}),t.jsxs("div",{className:"mb-0",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[t.jsx("span",{children:"Pending"}),t.jsx("span",{className:"fw-bold text-warning",children:i.pendingTrainees})]}),t.jsx("div",{className:"progress",style:{height:"8px"},children:t.jsx("div",{className:"progress-bar bg-warning",role:"progressbar",style:{width:`${i.pendingTrainees/i.totalTrainees*100}%`}})})]})]})]})})]}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Materials"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Material Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Size"})]})}),t.jsx("tbody",{children:i.materials.map((x,f)=>t.jsxs("tr",{children:[t.jsx("td",{className:"fw-medium",children:x.name}),t.jsx("td",{children:t.jsx(Te,{bg:"secondary",children:x.type})}),t.jsx("td",{className:"text-muted",children:x.size})]},f))})]})})})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Assessments"})}),t.jsx(R.Body,{children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Assessment"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Max Score"}),t.jsx("th",{children:"Average Score"})]})}),t.jsx("tbody",{children:i.assessments.map((x,f)=>t.jsxs("tr",{children:[t.jsx("td",{className:"fw-medium",children:x.name}),t.jsx("td",{children:t.jsx(Te,{bg:"info",children:x.type})}),t.jsx("td",{children:x.maxScore}),t.jsx("td",{children:t.jsx("span",{className:"fw-bold text-success",children:x.averageScore})})]},f))})]})})})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white p-0",children:t.jsx("div",{className:"custom-tabs-container",children:h.map(x=>{const f=x.icon,g=a===x.id;return t.jsxs("button",{className:`custom-tab ${g?"active":""}`,onClick:()=>n(x.id),children:[t.jsx(f,{size:16,className:"me-2"}),x.title]},x.id)})})}),t.jsx(R.Body,{className:"p-0",children:p&&p.component})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Subject Not Found"}),t.jsx("p",{children:"The requested subject could not be found."})]})})},UA=()=>{const{traineeId:e}=Jt(),r=qe(),[s,a]=b.useState(null),[n,i]=b.useState(!0),[l,o]=b.useState(null);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(u=>setTimeout(u,1e3)),a({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,overallProgress:65,enrolledCourses:[{id:1,name:"Aviation Safety Management",code:"ASM-101",progress:75,instructor:"Dr. Smith",enrolledDate:"2024-01-15",status:"in_progress",completedSubjects:6,totalSubjects:8},{id:2,name:"Aircraft Maintenance",code:"AM-201",progress:45,instructor:"Jane Doe",enrolledDate:"2024-01-16",status:"in_progress",completedSubjects:4,totalSubjects:9},{id:3,name:"Emergency Response Training",code:"ERT-301",progress:100,instructor:"Mike Johnson",enrolledDate:"2024-01-10",status:"completed",completedSubjects:10,totalSubjects:10}],assessments:[{id:1,name:"Safety Procedures Quiz",course:"Aviation Safety Management",score:95,maxScore:100,status:"approved",completedDate:"2024-01-20",submittedBy:"Dr. Smith"},{id:2,name:"Maintenance Practical Assessment",course:"Aircraft Maintenance",score:87,maxScore:100,status:"approved",completedDate:"2024-01-19",submittedBy:"Jane Doe"},{id:3,name:"Emergency Procedures Test",course:"Emergency Response Training",score:92,maxScore:100,status:"pending",completedDate:"2024-01-25",submittedBy:"Mike Johnson"}],certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed",issuedBy:"Training Department"},{name:"Risk Assessment",date:"2024-01-25",status:"completed",issuedBy:"Quality Department"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress",issuedBy:"Training Department"}]})}catch(m){o("Failed to load trainee details"),console.error("Error fetching trainee:",m)}finally{i(!1)}})()},[e]);const c=d=>{const u={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},in_progress:{variant:"info",text:"In Progress"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"},approved:{variant:"success",text:"Approved"},pending:{variant:"warning",text:"Pending"},rejected:{variant:"danger",text:"Rejected"}}[d]||{variant:"secondary",text:"Unknown"};return t.jsx(Te,{bg:u.variant,children:u.text})};return n?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs("div",{className:"text-center py-5",children:[t.jsx(St,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"danger",children:[t.jsx(Ae.Heading,{children:"Error"}),t.jsx("p",{children:l})]})}):s?t.jsxs(Ee,{fluid:!0,className:"py-4",children:[t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs("div",{className:"d-flex align-items-center mb-3",children:[t.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>r(-1),children:t.jsx(bt,{size:20})}),t.jsxs("div",{children:[t.jsx("h2",{className:"mb-1",children:s.name}),t.jsxs("p",{className:"text-muted mb-0",children:[s.employeeId,"  ",s.department]})]})]})})}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Dt,{size:24,className:"text-primary mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Status"}),t.jsx("div",{className:"mt-2",children:c(s.status)})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(it,{size:24,className:"text-success mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Courses"}),t.jsxs("h4",{className:"mb-0 text-success",children:[s.completedCourses,"/",s.totalCourses]}),t.jsx("small",{className:"text-muted",children:"Completed"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx("div",{className:"text-info mb-2",children:t.jsx(Wn,{size:24})}),t.jsx("h6",{className:"mb-1 text-muted",children:"Average Score"}),t.jsxs("h4",{className:"mb-0 text-info",children:[s.averageScore,"%"]}),t.jsx("small",{className:"text-muted",children:"Performance"})]})})}),t.jsx(F,{md:3,className:"mb-3",children:t.jsx(R,{className:"h-100 border-0 shadow-sm",children:t.jsxs(R.Body,{className:"text-center",children:[t.jsx(Lt,{size:24,className:"text-warning mb-2"}),t.jsx("h6",{className:"mb-1 text-muted",children:"Enrolled"}),t.jsx("h4",{className:"mb-0 text-warning",children:new Date(s.enrollmentDate).toLocaleDateString()}),t.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),t.jsxs(oe,{className:"mb-4",children:[t.jsx(F,{md:6,children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Contact Information"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx(ha,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Email:"})," ",s.email]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Dt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Position:"})," ",s.position]}),t.jsxs("div",{className:"mb-3",children:[t.jsx(Lt,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Last Activity:"})," ",new Date(s.lastActivity).toLocaleDateString()]}),t.jsxs("div",{className:"mb-0",children:[t.jsx(et,{size:16,className:"me-2 text-muted"}),t.jsx("strong",{children:"Overall Progress:"})," ",s.overallProgress,"%"]})]})]})}),t.jsx(F,{md:6,children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Progress Overview"})}),t.jsxs(R.Body,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[t.jsx("span",{children:"Courses Progress"}),t.jsxs("span",{className:"fw-bold",children:[s.completedCourses,"/",s.totalCourses]})]}),t.jsx("div",{className:"progress",style:{height:"10px"},children:t.jsx("div",{className:"progress-bar bg-success",role:"progressbar",style:{width:`${s.completedCourses/s.totalCourses*100}%`}})})]}),t.jsxs("div",{className:"mb-0",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[t.jsx("span",{children:"Subjects Progress"}),t.jsxs("span",{className:"fw-bold",children:[s.completedSubjects,"/",s.totalSubjects]})]}),t.jsx("div",{className:"progress",style:{height:"10px"},children:t.jsx("div",{className:"progress-bar bg-info",role:"progressbar",style:{width:`${s.completedSubjects/s.totalSubjects*100}%`}})})]})]})]})})]}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Enrolled Courses"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Course"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Code"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Progress"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Subjects"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"})]})}),t.jsx("tbody",{children:s.enrolledCourses.map((d,m)=>t.jsxs("tr",{className:`${m%2===0?"bg-white":"bg-neutral-50"}`,children:[t.jsx("td",{className:"align-middle",children:t.jsxs("div",{children:[t.jsx("h6",{className:"mb-0 fw-medium",children:d.name}),t.jsxs("small",{className:"text-muted",children:["Instructor: ",d.instructor]})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx(Te,{bg:"secondary",children:d.code})}),t.jsx("td",{className:"align-middle",children:t.jsxs("div",{children:[t.jsx("div",{className:"d-flex justify-content-between mb-1",children:t.jsxs("span",{className:"fw-medium",children:[d.progress,"%"]})}),t.jsx("div",{className:"progress",style:{height:"6px"},children:t.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${d.progress}%`}})})]})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsxs("span",{children:[d.completedSubjects,"/",d.totalSubjects]})}),t.jsx("td",{className:"align-middle",children:c(d.status)})]},d.id))})]})})})]})})}),t.jsx(oe,{className:"mb-4",children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Assessment History"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Assessment"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Course"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Submitted By"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Completed Date"})]})}),t.jsx("tbody",{children:s.assessments.map((d,m)=>t.jsxs("tr",{className:`${m%2===0?"bg-white":"bg-neutral-50"}`,children:[t.jsx("td",{className:"align-middle",children:t.jsx("div",{children:t.jsx("h6",{className:"mb-0 fw-medium",children:d.name})})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{children:d.course})}),t.jsx("td",{className:"align-middle",children:d.score?t.jsxs("span",{className:"fw-bold text-success",children:[d.score,"/",d.maxScore]}):t.jsx("span",{className:"text-muted",children:"-"})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{className:"text-muted",children:d.submittedBy})}),t.jsx("td",{className:"align-middle",children:c(d.status)}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{children:new Date(d.completedDate).toLocaleDateString()})})]},d.id))})]})})})]})})}),t.jsx(oe,{children:t.jsx(F,{children:t.jsxs(R,{className:"border-0 shadow-sm",children:[t.jsx(R.Header,{className:"bg-primary text-white",children:t.jsx("h5",{className:"mb-0",children:"Certifications"})}),t.jsx(R.Body,{className:"p-0",children:t.jsx("div",{className:"scrollable-table-container admin-table",children:t.jsxs(gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[t.jsx("thead",{className:"sticky-header",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Certification"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Date"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Issued By"}),t.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"})]})}),t.jsx("tbody",{children:s.certifications.map((d,m)=>t.jsxs("tr",{className:`${m%2===0?"bg-white":"bg-neutral-50"}`,children:[t.jsx("td",{className:"align-middle",children:t.jsx("div",{children:t.jsx("h6",{className:"mb-0 fw-medium",children:d.name})})}),t.jsx("td",{className:"align-middle",children:t.jsx("span",{children:new Date(d.date).toLocaleDateString()})}),t.jsx("td",{className:"align-middle hide-mobile",children:t.jsx("span",{className:"text-muted",children:d.issuedBy})}),t.jsx("td",{className:"align-middle",children:c(d.status)})]},m))})]})})})]})})})]}):t.jsx(Ee,{fluid:!0,className:"py-4",children:t.jsxs(Ae,{variant:"warning",children:[t.jsx(Ae.Heading,{children:"Trainee Not Found"}),t.jsx("p",{children:"The requested trainee could not be found."})]})})},WA=Wf([{path:"/",element:t.jsx(gl,{}),errorElement:t.jsx(yr,{})},{path:"/login",element:t.jsx(gl,{}),errorElement:t.jsx(yr,{})},{path:"/reset-password",element:t.jsx(aj,{}),errorElement:t.jsx(yr,{})},{path:"/admin",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(cn,{})},{path:"users",element:t.jsx(nt,{permission:be.USERS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:t.jsx(h3,{})})},{path:"roles",element:t.jsx(nt,{permission:be.ROLES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:t.jsx(j3,{})})},{path:"departments",element:t.jsx(nt,{permission:be.DEPARTMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:t.jsx(_3,{})})},{path:"departments/:id",element:t.jsx(nt,{permission:be.DEPARTMENTS.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:t.jsx(L3,{})})},{path:"profile",element:t.jsx(nt,{permission:be.PROFILES.VIEW,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:t.jsx($3,{})})},{path:"forms",element:t.jsx(nt,{permission:be.TEMPLATES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:t.jsx(Gk,{})})},{path:"forms/editor",element:t.jsx(nt,{permission:be.TEMPLATES.CREATE,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:t.jsx(Qk,{})})},{path:"system-config",element:t.jsx(nt,{permission:be.GLOBAL_FIELDS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:t.jsx("div",{children:"System Configuration Page"})})}]},{path:"/academic",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(cn,{})},{path:"dashboard",element:t.jsx(W3,{})},{path:"departments",element:t.jsx(U3,{})},{path:"course/:courseId",element:t.jsx(X3,{})},{path:"course-detail/:courseId",element:t.jsx(gk,{})},{path:"course/:courseId/enroll-trainees",element:t.jsx(Tk,{})},{path:"subject/:subjectId",element:t.jsx(t0,{})},{path:"course/:courseId/subject/:subjectId",element:t.jsx(t0,{})}]},{path:"/trainee",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:t.jsx(r0,{})})},{path:"dashboard",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:t.jsx(r0,{})})},{path:":traineeId/course/:courseId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_COURSES,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:t.jsx(kk,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_SUBJECTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:t.jsx(Dk,{})})},{path:":traineeId/assessments",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:t.jsx(Pk,{})})},{path:":traineeId/assessment/:assessmentId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:t.jsx(Rk,{})})},{path:":traineeId/signature-pad/:documentId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:t.jsx(Ok,{})})},{path:":traineeId/assessment-section/:sectionId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:t.jsx(Mk,{})})},{path:"academic-details",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:t.jsx($k,{})})},{path:"enrolled-courses",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_COURSES,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:t.jsx(Hk,{})})},{path:"signature-required",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:t.jsx(sA,{})})},{path:"completion-required",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:t.jsx(n0,{})})},{path:"your-assessments",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:t.jsx(i0,{})})},{path:"create-incident-feedback-report",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:t.jsx(cA,{})})},{path:"assessment-pending",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment pending list."}),children:t.jsx(i0,{})})},{path:"assessment-pending/section-completion",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_ASSESSMENTS,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:t.jsx(n0,{})})}]},{path:"/sqa",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(cn,{})},{path:"issues",element:t.jsx(nt,{permission:be.SQA.VIEW_TEMPLATES,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:t.jsx(dA,{})})},{path:"feedback",element:t.jsx(nt,{permission:be.SQA.VIEW_TEMPLATES,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:t.jsx(mA,{})})},{path:"templates",element:t.jsx(nt,{permission:be.SQA.VIEW_TEMPLATES,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template list."}),children:t.jsx(uA,{})})},{path:"templates/:templateId",element:t.jsx(nt,{permission:be.SQA.VIEW_TEMPLATE_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:t.jsx(hA,{})})}]},{path:"/trainer",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(cn,{})},{path:"dashboard",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainer portal."}),children:t.jsx(fA,{})})},{path:"upcoming-assessments",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view upcoming assessments."}),children:t.jsx(gA,{})})},{path:"assessment-results",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment results."}),children:t.jsx(bA,{})})},{path:"instructed-courses",element:t.jsx(nt,{permission:be.COURSES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:t.jsx(yA,{})})},{path:"configure-signature",element:t.jsx(nt,{permission:be.PROFILES.VIEW,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to configure signature."}),children:t.jsx(_A,{})})},{path:"assessment-details/:resultId",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:t.jsx(kA,{})})},{path:"approval-notes/:resultId",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view approval notes."}),children:t.jsx(AA,{})})},{path:"courses/:courseId",element:t.jsx(nt,{permission:be.COURSES.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:t.jsx(SA,{})})},{path:"trainees/:traineeId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:t.jsx(TA,{})})},{path:"subjects/:subjectId",element:t.jsx(nt,{permission:be.SUBJECTS.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:t.jsx(CA,{})})}]},{path:"/department-head",element:t.jsx(Ia,{children:t.jsx(Da,{})}),errorElement:t.jsx(yr,{}),children:[{path:"",element:t.jsx(cn,{})},{path:"dashboard",element:t.jsx(nt,{permission:be.DASHBOARD.VIEW,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department head dashboard."}),children:t.jsx(DA,{})})},{path:"my-department-details",element:t.jsx(nt,{permission:be.DEPARTMENTS.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:t.jsx(PA,{})})},{path:"my-department-details/:courseId",element:t.jsx(nt,{permission:be.COURSES.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:t.jsx(BA,{})})},{path:"assessment-review-requests",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_ALL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access assessment review requests."}),children:t.jsx(l0,{})})},{path:"assessment-review-requests/:requestId",element:t.jsx(nt,{permission:be.ASSESSMENTS.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment request details."}),children:t.jsx(l0,{})})},{path:"courses/:courseId/subjects/:subjectId",element:t.jsx(nt,{permission:be.SUBJECTS.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:t.jsx($A,{})})},{path:"trainees/:traineeId",element:t.jsx(nt,{permission:be.TRAINEES.VIEW_DETAIL,fallback:t.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:t.jsx(UA,{})})}]},{path:"*",element:t.jsx(gl,{}),errorElement:t.jsx(yr,{})}],{basename:Ec()});function HA(){return b.useEffect(()=>{(()=>{const r=window.location;if(r.hostname.includes("github.io")&&r.search.includes("?/")){const s=r.search,a=r.hash,n=s.match(/\?\/(.+?)(?:&|$)/);if(n){const l=`/${n[1].replace(/~and~/g,"&")}${a}`;window.history.replaceState(null,"",l)}}})()},[]),t.jsxs(sj,{children:[t.jsx(Hf,{router:WA}),t.jsx(Jb,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}qf.createRoot(document.getElementById("root")).render(t.jsx(b.StrictMode,{children:t.jsx(HA,{})}));
