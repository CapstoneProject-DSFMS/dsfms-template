import{P as R,j as s,B as ae,N as Ye,a as Qy,T as dr,C as Be,D as Ct,b as Y,A as Ue,S as ot,I as eb,F as _,M as se,R as ue,c as H,O as z2,d as $2,e as Ae,L as oa,f as G5,g as Tt,h as U2,i as Qd,k as i0}from"./bootstrap-BidIeVrz.js";import{r as v,R as ne,u as na,b as ft,L as dd,O as q5,c as K5,d as qx,N as Y5,e as xi,f as Or,g as X5,h as J5,i as Z5}from"./router-C6Ic_n8-.js";import{a as Q5,g as gi,r as Kx}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var ud={},tb;function eI(){if(tb)return ud;tb=1;var e=Q5();return ud.createRoot=e.createRoot,ud.hydrateRoot=e.hydrateRoot,ud}var tI=eI(),rI=["color","size","title","className"];function l0(){return l0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},l0.apply(null,arguments)}function sI(e,t){if(e==null)return{};var r,a,n=aI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Yx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sI(e,rI);return ne.createElement("svg",l0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-airplane",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});Yx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nI=["color","size","title","className"];function o0(){return o0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},o0.apply(null,arguments)}function iI(e,t){if(e==null)return{};var r,a,n=lI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var W2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iI(e,nI);return ne.createElement("svg",o0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-archive",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});W2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var oI=["color","size","title","className"];function c0(){return c0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},c0.apply(null,arguments)}function cI(e,t){if(e==null)return{};var r,a,n=dI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var H2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cI(e,oI);return ne.createElement("svg",c0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-clockwise",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),ne.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});H2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uI=["color","size","title","className"];function d0(){return d0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d0.apply(null,arguments)}function mI(e,t){if(e==null)return{};var r,a,n=fI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mI(e,uI);return ne.createElement("svg",d0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-down",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});Vd.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hI=["color","size","title","className"];function u0(){return u0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u0.apply(null,arguments)}function pI(e,t){if(e==null)return{};var r,a,n=xI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pI(e,hI);return ne.createElement("svg",u0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-left",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});Bt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gI=["color","size","title","className"];function m0(){return m0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},m0.apply(null,arguments)}function vI(e,t){if(e==null)return{};var r,a,n=yI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var vn=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vI(e,gI);return ne.createElement("svg",m0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-right",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});vn.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var bI=["color","size","title","className"];function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},f0.apply(null,arguments)}function jI(e,t){if(e==null)return{};var r,a,n=wI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var V2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jI(e,bI);return ne.createElement("svg",f0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-award",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),ne.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});V2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var NI=["color","size","title","className"];function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},h0.apply(null,arguments)}function SI(e,t){if(e==null)return{};var r,a,n=EI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eu=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=SI(e,NI);return ne.createElement("svg",h0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-ban",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M15 8a6.97 6.97 0 0 0-1.71-4.584l-9.874 9.875A7 7 0 0 0 15 8M2.71 12.584l9.874-9.875a7 7 0 0 0-9.874 9.874ZM16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0"}))});eu.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var TI=["color","size","title","className"];function p0(){return p0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},p0.apply(null,arguments)}function CI(e,t){if(e==null)return{};var r,a,n=AI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ol=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=CI(e,TI);return ne.createElement("svg",p0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-bar-chart",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M4 11H2v3h2zm5-4H7v7h2zm5-5v12h-2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1z"}))});Ol.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var _I=["color","size","title","className"];function x0(){return x0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},x0.apply(null,arguments)}function kI(e,t){if(e==null)return{};var r,a,n=II(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function II(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $t=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kI(e,_I);return ne.createElement("svg",x0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-book",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});$t.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var DI=["color","size","title","className"];function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g0.apply(null,arguments)}function PI(e,t){if(e==null)return{};var r,a,n=OI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var v0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=PI(e,DI);return ne.createElement("svg",g0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-box-arrow-right",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),ne.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});v0.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var RI=["color","size","title","className"];function y0(){return y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},y0.apply(null,arguments)}function FI(e,t){if(e==null)return{};var r,a,n=LI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ws=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=FI(e,RI);return ne.createElement("svg",y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-building",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),ne.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Ws.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var MI=["color","size","title","className"];function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b0.apply(null,arguments)}function BI(e,t){if(e==null)return{};var r,a,n=zI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var va=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=BI(e,MI);return ne.createElement("svg",b0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar-event",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),ne.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});va.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $I=["color","size","title","className"];function j0(){return j0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},j0.apply(null,arguments)}function UI(e,t){if(e==null)return{};var r,a,n=WI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var or=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=UI(e,$I);return ne.createElement("svg",j0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});or.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var HI=["color","size","title","className"];function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w0.apply(null,arguments)}function VI(e,t){if(e==null)return{};var r,a,n=GI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var G2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=VI(e,HI);return ne.createElement("svg",w0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chat-dots",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),ne.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});G2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var qI=["color","size","title","className"];function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},N0.apply(null,arguments)}function KI(e,t){if(e==null)return{};var r,a,n=YI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=KI(e,qI);return ne.createElement("svg",N0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle-fill",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}))});Xx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var XI=["color","size","title","className"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},S0.apply(null,arguments)}function JI(e,t){if(e==null)return{};var r,a,n=ZI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var it=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=JI(e,XI);return ne.createElement("svg",S0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});it.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var QI=["color","size","title","className"];function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},E0.apply(null,arguments)}function eD(e,t){if(e==null)return{};var r,a,n=tD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eD(e,QI);return ne.createElement("svg",E0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-square",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),ne.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});q2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var rD=["color","size","title","className"];function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},T0.apply(null,arguments)}function sD(e,t){if(e==null)return{};var r,a,n=aD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sn=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sD(e,rD);return ne.createElement("svg",T0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-down",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});sn.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nD=["color","size","title","className"];function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C0.apply(null,arguments)}function iD(e,t){if(e==null)return{};var r,a,n=lD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ac=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iD(e,nD);return ne.createElement("svg",C0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-right",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Ac.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var oD=["color","size","title","className"];function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},A0.apply(null,arguments)}function cD(e,t){if(e==null)return{};var r,a,n=dD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var K2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cD(e,oD);return ne.createElement("svg",A0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-up",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});K2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uD=["color","size","title","className"];function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_0.apply(null,arguments)}function mD(e,t){if(e==null)return{};var r,a,n=fD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mD(e,uD);return ne.createElement("svg",_0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clipboard-check",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),ne.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),ne.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});Zt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hD=["color","size","title","className"];function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k0.apply(null,arguments)}function pD(e,t){if(e==null)return{};var r,a,n=xD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Y2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pD(e,hD);return ne.createElement("svg",k0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock-history",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"}),ne.createElement("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"}),ne.createElement("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"}))});Y2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gD=["color","size","title","className"];function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},I0.apply(null,arguments)}function vD(e,t){if(e==null)return{};var r,a,n=yD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var rt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vD(e,gD);return ne.createElement("svg",I0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),ne.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});rt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var bD=["color","size","title","className"];function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},D0.apply(null,arguments)}function jD(e,t){if(e==null)return{};var r,a,n=wD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var il=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jD(e,bD);return ne.createElement("svg",D0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-download",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),ne.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});il.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var ND=["color","size","title","className"];function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},P0.apply(null,arguments)}function SD(e,t){if(e==null)return{};var r,a,n=ED(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ED(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=SD(e,ND);return ne.createElement("svg",P0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-envelope",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});Vi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var TD=["color","size","title","className"];function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},O0.apply(null,arguments)}function CD(e,t){if(e==null)return{};var r,a,n=AD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=CD(e,TD);return ne.createElement("svg",O0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-triangle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),ne.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Gt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var _D=["color","size","title","className"];function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},R0.apply(null,arguments)}function kD(e,t){if(e==null)return{};var r,a,n=ID(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ID(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Rl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kD(e,_D);return ne.createElement("svg",R0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye-slash",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),ne.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),ne.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});Rl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var DD=["color","size","title","className"];function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},F0.apply(null,arguments)}function PD(e,t){if(e==null)return{};var r,a,n=OD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=PD(e,DD);return ne.createElement("svg",F0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),ne.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});tr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var RD=["color","size","title","className"];function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},L0.apply(null,arguments)}function FD(e,t){if(e==null)return{};var r,a,n=LD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ul=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=FD(e,RD);return ne.createElement("svg",L0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-excel",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),ne.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});Ul.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var MD=["color","size","title","className"];function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},M0.apply(null,arguments)}function BD(e,t){if(e==null)return{};var r,a,n=zD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=BD(e,MD);return ne.createElement("svg",M0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-pdf",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),ne.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});Zs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $D=["color","size","title","className"];function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},B0.apply(null,arguments)}function UD(e,t){if(e==null)return{};var r,a,n=WD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var X2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=UD(e,$D);return ne.createElement("svg",B0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-plus",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 6.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V9.5H6a.5.5 0 0 1 0-1h1.5V7a.5.5 0 0 1 .5-.5"}),ne.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});X2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var HD=["color","size","title","className"];function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},z0.apply(null,arguments)}function VD(e,t){if(e==null)return{};var r,a,n=GD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var _c=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=VD(e,HD);return ne.createElement("svg",z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-text",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),ne.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});_c.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var qD=["color","size","title","className"];function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$0.apply(null,arguments)}function KD(e,t){if(e==null)return{};var r,a,n=YD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=KD(e,qD);return ne.createElement("svg",$0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});oi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var XD=["color","size","title","className"];function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},U0.apply(null,arguments)}function JD(e,t){if(e==null)return{};var r,a,n=ZD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var J2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=JD(e,XD);return ne.createElement("svg",U0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text-fill",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});J2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var QD=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},W0.apply(null,arguments)}function e4(e,t){if(e==null)return{};var r,a,n=t4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function t4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var gt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=e4(e,QD);return ne.createElement("svg",W0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),ne.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});gt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var r4=["color","size","title","className"];function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},H0.apply(null,arguments)}function s4(e,t){if(e==null)return{};var r,a,n=a4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function a4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Z2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=s4(e,r4);return ne.createElement("svg",H0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-folder",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.826a2 2 0 0 1-1.991-1.819l-.637-7a2 2 0 0 1 .342-1.31zM2.19 4a1 1 0 0 0-.996 1.09l.637 7a1 1 0 0 0 .995.91h10.348a1 1 0 0 0 .995-.91l.637-7A1 1 0 0 0 13.81 4zm4.69-1.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139q.323-.119.684-.12h5.396z"}))});Z2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var n4=["color","size","title","className"];function V0(){return V0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},V0.apply(null,arguments)}function i4(e,t){if(e==null)return{};var r,a,n=l4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ll=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=i4(e,n4);return ne.createElement("svg",V0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-funnel",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});ll.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var o4=["color","size","title","className"];function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},G0.apply(null,arguments)}function c4(e,t){if(e==null)return{};var r,a,n=d4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tm=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=c4(e,o4);return ne.createElement("svg",G0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-gear",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),ne.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});tm.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var u4=["color","size","title","className"];function q0(){return q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},q0.apply(null,arguments)}function m4(e,t){if(e==null)return{};var r,a,n=f4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ec=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=m4(e,u4);return ne.createElement("svg",q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-geo-alt",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),ne.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});ec.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var h4=["color","size","title","className"];function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},K0.apply(null,arguments)}function p4(e,t){if(e==null)return{};var r,a,n=x4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=p4(e,h4);return ne.createElement("svg",K0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-house",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});Q2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var g4=["color","size","title","className"];function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Y0.apply(null,arguments)}function v4(e,t){if(e==null)return{};var r,a,n=y4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function y4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=v4(e,g4);return ne.createElement("svg",Y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-info-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});eS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var b4=["color","size","title","className"];function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},X0.apply(null,arguments)}function j4(e,t){if(e==null)return{};var r,a,n=w4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var J0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=j4(e,b4);return ne.createElement("svg",X0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-journal-text",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}),ne.createElement("path",{d:"M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"}),ne.createElement("path",{d:"M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"}))});J0.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var N4=["color","size","title","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Z0.apply(null,arguments)}function S4(e,t){if(e==null)return{};var r,a,n=E4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tc=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=S4(e,N4);return ne.createElement("svg",Z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-key",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),ne.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});tc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var T4=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Q0.apply(null,arguments)}function C4(e,t){if(e==null)return{};var r,a,n=A4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=C4(e,T4);return ne.createElement("svg",Q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-check",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0"}))});tS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var _4=["color","size","title","className"];function ep(){return ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ep.apply(null,arguments)}function k4(e,t){if(e==null)return{};var r,a,n=I4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function I4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var rS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=k4(e,_4);return ne.createElement("svg",ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-ul",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});rS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var D4=["color","size","title","className"];function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tp.apply(null,arguments)}function P4(e,t){if(e==null)return{};var r,a,n=O4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tu=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=P4(e,D4);return ne.createElement("svg",tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});tu.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var R4=["color","size","title","className"];function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rp.apply(null,arguments)}function F4(e,t){if(e==null)return{};var r,a,n=L4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ro=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=F4(e,R4);return ne.createElement("svg",rp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-passport",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6M6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0m-.5 4a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"}),ne.createElement("path",{d:"M3.232 1.776A1.5 1.5 0 0 0 2 3.252v10.95c0 .445.191.838.49 1.11.367.422.908.688 1.51.688h8a2 2 0 0 0 2-2V4a2 2 0 0 0-1-1.732v-.47A1.5 1.5 0 0 0 11.232.321l-8 1.454ZM4 3h8a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"}))});Ro.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var M4=["color","size","title","className"];function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},sp.apply(null,arguments)}function B4(e,t){if(e==null)return{};var r,a,n=z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ci=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=B4(e,M4);return ne.createElement("svg",sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pen",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});ci.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $4=["color","size","title","className"];function ap(){return ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ap.apply(null,arguments)}function U4(e,t){if(e==null)return{};var r,a,n=W4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Jx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=U4(e,$4);return ne.createElement("svg",ap({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil-square",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),ne.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});Jx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var H4=["color","size","title","className"];function np(){return np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},np.apply(null,arguments)}function V4(e,t){if(e==null)return{};var r,a,n=G4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ar=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=V4(e,H4);return ne.createElement("svg",np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});Ar.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var q4=["color","size","title","className"];function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ip.apply(null,arguments)}function K4(e,t){if(e==null)return{};var r,a,n=Y4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=K4(e,q4);return ne.createElement("svg",ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-people",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Vs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var X4=["color","size","title","className"];function lp(){return lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lp.apply(null,arguments)}function J4(e,t){if(e==null)return{};var r,a,n=Z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=J4(e,X4);return ne.createElement("svg",lp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check-fill",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),ne.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});sS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var Q4=["color","size","title","className"];function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},op.apply(null,arguments)}function eP(e,t){if(e==null)return{};var r,a,n=tP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var On=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eP(e,Q4);return ne.createElement("svg",op({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),ne.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});On.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var rP=["color","size","title","className"];function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cp.apply(null,arguments)}function sP(e,t){if(e==null)return{};var r,a,n=aP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Tl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sP(e,rP);return ne.createElement("svg",cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),ne.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});Tl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nP=["color","size","title","className"];function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dp.apply(null,arguments)}function iP(e,t){if(e==null)return{};var r,a,n=lP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var kc=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iP(e,nP);return ne.createElement("svg",dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-x",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),ne.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});kc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var oP=["color","size","title","className"];function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},up.apply(null,arguments)}function cP(e,t){if(e==null)return{};var r,a,n=dP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Lt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cP(e,oP);return ne.createElement("svg",up({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Lt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uP=["color","size","title","className"];function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mp.apply(null,arguments)}function mP(e,t){if(e==null)return{};var r,a,n=fP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var aS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mP(e,uP);return ne.createElement("svg",mp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-phone",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),ne.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});aS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hP=["color","size","title","className"];function fp(){return fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fp.apply(null,arguments)}function pP(e,t){if(e==null)return{};var r,a,n=xP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pP(e,hP);return ne.createElement("svg",fp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pie-chart",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793zm1 0V7.5h6.482A7 7 0 0 0 8.5 1.018M14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8"}))});Zx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gP=["color","size","title","className"];function hp(){return hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hp.apply(null,arguments)}function vP(e,t){if(e==null)return{};var r,a,n=yP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var pp=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vP(e,gP);return ne.createElement("svg",hp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});pp.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var bP=["color","size","title","className"];function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xp.apply(null,arguments)}function jP(e,t){if(e==null)return{};var r,a,n=wP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Qx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jP(e,bP);return ne.createElement("svg",xp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});Qx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var NP=["color","size","title","className"];function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gp.apply(null,arguments)}function SP(e,t){if(e==null)return{};var r,a,n=EP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eg=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=SP(e,NP);return ne.createElement("svg",gp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});eg.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var TP=["color","size","title","className"];function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},vp.apply(null,arguments)}function CP(e,t){if(e==null)return{};var r,a,n=AP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var yr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=CP(e,TP);return ne.createElement("svg",vp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});yr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var _P=["color","size","title","className"];function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},yp.apply(null,arguments)}function kP(e,t){if(e==null)return{};var r,a,n=IP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function IP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var nS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kP(e,_P);return ne.createElement("svg",yp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-question-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"}))});nS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var DP=["color","size","title","className"];function bp(){return bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bp.apply(null,arguments)}function PP(e,t){if(e==null)return{};var r,a,n=OP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=PP(e,DP);return ne.createElement("svg",bp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-save",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});Zr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var RP=["color","size","title","className"];function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jp.apply(null,arguments)}function FP(e,t){if(e==null)return{};var r,a,n=LP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var iS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=FP(e,RP);return ne.createElement("svg",jp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-search",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});iS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var MP=["color","size","title","className"];function wp(){return wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},wp.apply(null,arguments)}function BP(e,t){if(e==null)return{};var r,a,n=zP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var lS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=BP(e,MP);return ne.createElement("svg",wp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-send",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});lS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $P=["color","size","title","className"];function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Np.apply(null,arguments)}function UP(e,t){if(e==null)return{};var r,a,n=WP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=UP(e,$P);return ne.createElement("svg",Np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield-x",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),ne.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});oS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var HP=["color","size","title","className"];function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Sp.apply(null,arguments)}function VP(e,t){if(e==null)return{};var r,a,n=GP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tg=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=VP(e,HP);return ne.createElement("svg",Sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});tg.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var qP=["color","size","title","className"];function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ep.apply(null,arguments)}function KP(e,t){if(e==null)return{};var r,a,n=YP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var cS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=KP(e,qP);return ne.createElement("svg",Ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-square",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});cS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var XP=["color","size","title","className"];function Tp(){return Tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Tp.apply(null,arguments)}function JP(e,t){if(e==null)return{};var r,a,n=ZP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZP(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var dS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=JP(e,XP);return ne.createElement("svg",Tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-star",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});dS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var QP=["color","size","title","className"];function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Cp.apply(null,arguments)}function eO(e,t){if(e==null)return{};var r,a,n=tO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eO(e,QP);return ne.createElement("svg",Cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-three-dots-vertical",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});Gs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var rO=["color","size","title","className"];function Ap(){return Ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ap.apply(null,arguments)}function sO(e,t){if(e==null)return{};var r,a,n=aO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ba=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sO(e,rO);return ne.createElement("svg",Ap({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trash",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),ne.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});ba.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nO=["color","size","title","className"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_p.apply(null,arguments)}function iO(e,t){if(e==null)return{};var r,a,n=lO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var uS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iO(e,nO);return ne.createElement("svg",_p({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trophy",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});uS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var oO=["color","size","title","className"];function kp(){return kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},kp.apply(null,arguments)}function cO(e,t){if(e==null)return{};var r,a,n=dO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var js=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cO(e,oO);return ne.createElement("svg",kp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-upload",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),ne.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});js.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uO=["color","size","title","className"];function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ip.apply(null,arguments)}function mO(e,t){if(e==null)return{};var r,a,n=fO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var mS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mO(e,uO);return ne.createElement("svg",Ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle-fill",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"}))});mS.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hO=["color","size","title","className"];function Dp(){return Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Dp.apply(null,arguments)}function pO(e,t){if(e==null)return{};var r,a,n=xO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var zr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pO(e,hO);return ne.createElement("svg",Dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),ne.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});zr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gO=["color","size","title","className"];function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Pp.apply(null,arguments)}function vO(e,t){if(e==null)return{};var r,a,n=yO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ht=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vO(e,gO);return ne.createElement("svg",Pp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x",u].filter(Boolean).join(" ")},d),o?ne.createElement("title",null,o):null,ne.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});ht.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};const bO="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function fS(e,t){return function(){return e.apply(t,arguments)}}const{toString:jO}=Object.prototype,{getPrototypeOf:rg}=Object,{iterator:rm,toStringTag:hS}=Symbol,sm=(e=>t=>{const r=jO.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),nn=e=>(e=e.toLowerCase(),t=>sm(t)===e),am=e=>t=>typeof t===e,{isArray:no}=Array,Wl=am("undefined");function Ic(e){return e!==null&&!Wl(e)&&e.constructor!==null&&!Wl(e.constructor)&&Qs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const pS=nn("ArrayBuffer");function wO(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&pS(e.buffer),t}const NO=am("string"),Qs=am("function"),xS=am("number"),Dc=e=>e!==null&&typeof e=="object",SO=e=>e===!0||e===!1,Gd=e=>{if(sm(e)!=="object")return!1;const t=rg(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(hS in e)&&!(rm in e)},EO=e=>{if(!Dc(e)||Ic(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},TO=nn("Date"),CO=nn("File"),AO=nn("Blob"),_O=nn("FileList"),kO=e=>Dc(e)&&Qs(e.pipe),IO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Qs(e.append)&&((t=sm(e))==="formdata"||t==="object"&&Qs(e.toString)&&e.toString()==="[object FormData]"))},DO=nn("URLSearchParams"),[PO,OO,RO,FO]=["ReadableStream","Request","Response","Headers"].map(nn),LO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),no(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(Ic(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(a=0;a<l;a++)o=i[a],t.call(null,e[o],o,e)}}function gS(e,t){if(Ic(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,vS=e=>!Wl(e)&&e!==ki;function Op(){const{caseless:e,skipUndefined:t}=vS(this)&&this||{},r={},a=(n,i)=>{const l=e&&gS(r,i)||i;Gd(r[l])&&Gd(n)?r[l]=Op(r[l],n):Gd(n)?r[l]=Op({},n):no(n)?r[l]=n.slice():(!t||!Wl(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Pc(arguments[n],a);return r}const MO=(e,t,r,{allOwnKeys:a}={})=>(Pc(t,(n,i)=>{r&&Qs(n)?e[i]=fS(n,r):e[i]=n},{allOwnKeys:a}),e),BO=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),zO=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},$O=(e,t,r,a)=>{let n,i,l;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!a||a(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&rg(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},UO=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},WO=e=>{if(!e)return null;if(no(e))return e;let t=e.length;if(!xS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},HO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&rg(Uint8Array)),VO=(e,t)=>{const a=(e&&e[rm]).call(e);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},GO=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},qO=nn("HTMLFormElement"),KO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),rb=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),YO=nn("RegExp"),yS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};Pc(r,(n,i)=>{let l;(l=t(n,i,e))!==!1&&(a[i]=l||n)}),Object.defineProperties(e,a)},XO=e=>{yS(e,(t,r)=>{if(Qs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(Qs(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},JO=(e,t)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return no(e)?a(e):a(String(e).split(t)),r},ZO=()=>{},QO=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function e3(e){return!!(e&&Qs(e.append)&&e[hS]==="FormData"&&e[rm])}const t3=e=>{const t=new Array(10),r=(a,n)=>{if(Dc(a)){if(t.indexOf(a)>=0)return;if(Ic(a))return a;if(!("toJSON"in a)){t[n]=a;const i=no(a)?[]:{};return Pc(a,(l,o)=>{const c=r(l,n+1);!Wl(c)&&(i[o]=c)}),t[n]=void 0,i}}return a};return r(e,0)},r3=nn("AsyncFunction"),s3=e=>e&&(Dc(e)||Qs(e))&&Qs(e.then)&&Qs(e.catch),bS=((e,t)=>e?setImmediate:t?((r,a)=>(ki.addEventListener("message",({source:n,data:i})=>{n===ki&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),ki.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Qs(ki.postMessage)),a3=typeof queueMicrotask<"u"?queueMicrotask.bind(ki):typeof process<"u"&&process.nextTick||bS,n3=e=>e!=null&&Qs(e[rm]),Oe={isArray:no,isArrayBuffer:pS,isBuffer:Ic,isFormData:IO,isArrayBufferView:wO,isString:NO,isNumber:xS,isBoolean:SO,isObject:Dc,isPlainObject:Gd,isEmptyObject:EO,isReadableStream:PO,isRequest:OO,isResponse:RO,isHeaders:FO,isUndefined:Wl,isDate:TO,isFile:CO,isBlob:AO,isRegExp:YO,isFunction:Qs,isStream:kO,isURLSearchParams:DO,isTypedArray:HO,isFileList:_O,forEach:Pc,merge:Op,extend:MO,trim:LO,stripBOM:BO,inherits:zO,toFlatObject:$O,kindOf:sm,kindOfTest:nn,endsWith:UO,toArray:WO,forEachEntry:VO,matchAll:GO,isHTMLForm:qO,hasOwnProperty:rb,hasOwnProp:rb,reduceDescriptors:yS,freezeMethods:XO,toObjectSet:JO,toCamelCase:KO,noop:ZO,toFiniteNumber:QO,findKey:gS,global:ki,isContextDefined:vS,isSpecCompliantForm:e3,toJSONObject:t3,isAsyncFn:r3,isThenable:s3,setImmediate:bS,asap:a3,isIterable:n3};function At(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Oe.inherits(At,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Oe.toJSONObject(this.config),code:this.code,status:this.status}}});const jS=At.prototype,wS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{wS[e]={value:e}});Object.defineProperties(At,wS);Object.defineProperty(jS,"isAxiosError",{value:!0});At.from=(e,t,r,a,n,i)=>{const l=Object.create(jS);Oe.toFlatObject(e,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return At.call(l,o,c,r,a,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const i3=null;function Rp(e){return Oe.isPlainObject(e)||Oe.isArray(e)}function NS(e){return Oe.endsWith(e,"[]")?e.slice(0,-2):e}function sb(e,t,r){return e?e.concat(t).map(function(n,i){return n=NS(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function l3(e){return Oe.isArray(e)&&!e.some(Rp)}const o3=Oe.toFlatObject(Oe,{},null,function(t){return/^is[A-Z]/.test(t)});function nm(e,t,r){if(!Oe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Oe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!Oe.isUndefined(g[p])});const a=r.metaTokens,n=r.visitor||d,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Oe.isSpecCompliantForm(t);if(!Oe.isFunction(n))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Oe.isDate(x))return x.toISOString();if(Oe.isBoolean(x))return x.toString();if(!c&&Oe.isBlob(x))throw new At("Blob is not supported. Use a Buffer instead.");return Oe.isArrayBuffer(x)||Oe.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,p,g){let j=x;if(x&&!g&&typeof x=="object"){if(Oe.endsWith(p,"{}"))p=a?p:p.slice(0,-2),x=JSON.stringify(x);else if(Oe.isArray(x)&&l3(x)||(Oe.isFileList(x)||Oe.endsWith(p,"[]"))&&(j=Oe.toArray(x)))return p=NS(p),j.forEach(function(y,b){!(Oe.isUndefined(y)||y===null)&&t.append(l===!0?sb([p],b,i):l===null?p:p+"[]",u(y))}),!1}return Rp(x)?!0:(t.append(sb(g,p,i),u(x)),!1)}const m=[],f=Object.assign(o3,{defaultVisitor:d,convertValue:u,isVisitable:Rp});function h(x,p){if(!Oe.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+p.join("."));m.push(x),Oe.forEach(x,function(j,w){(!(Oe.isUndefined(j)||j===null)&&n.call(t,j,Oe.isString(w)?w.trim():w,p,f))===!0&&h(j,p?p.concat(w):[w])}),m.pop()}}if(!Oe.isObject(e))throw new TypeError("data must be an object");return h(e),t}function ab(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function sg(e,t){this._pairs=[],e&&nm(e,this,t)}const SS=sg.prototype;SS.append=function(t,r){this._pairs.push([t,r])};SS.toString=function(t){const r=t?function(a){return t.call(this,a,ab)}:ab;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function c3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ES(e,t,r){if(!t)return e;const a=r&&r.encode||c3;Oe.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=Oe.isURLSearchParams(t)?t.toString():new sg(t,r).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class nb{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Oe.forEach(this.handlers,function(a){a!==null&&t(a)})}}const TS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},d3=typeof URLSearchParams<"u"?URLSearchParams:sg,u3=typeof FormData<"u"?FormData:null,m3=typeof Blob<"u"?Blob:null,f3={isBrowser:!0,classes:{URLSearchParams:d3,FormData:u3,Blob:m3},protocols:["http","https","file","blob","url","data"]},ag=typeof window<"u"&&typeof document<"u",Fp=typeof navigator=="object"&&navigator||void 0,h3=ag&&(!Fp||["ReactNative","NativeScript","NS"].indexOf(Fp.product)<0),p3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",x3=ag&&window.location.href||"http://localhost",g3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ag,hasStandardBrowserEnv:h3,hasStandardBrowserWebWorkerEnv:p3,navigator:Fp,origin:x3},Symbol.toStringTag,{value:"Module"})),ks={...g3,...f3};function v3(e,t){return nm(e,new ks.classes.URLSearchParams,{visitor:function(r,a,n,i){return ks.isNode&&Oe.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function y3(e){return Oe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function b3(e){const t={},r=Object.keys(e);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],t[i]=e[i];return t}function CS(e){function t(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&Oe.isArray(n)?n.length:l,c?(Oe.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!Oe.isObject(n[l]))&&(n[l]=[]),t(r,a,n[l],i)&&Oe.isArray(n[l])&&(n[l]=b3(n[l])),!o)}if(Oe.isFormData(e)&&Oe.isFunction(e.entries)){const r={};return Oe.forEachEntry(e,(a,n)=>{t(y3(a),n,r,0)}),r}return null}function j3(e,t,r){if(Oe.isString(e))try{return(t||JSON.parse)(e),Oe.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const Oc={transitional:TS,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=Oe.isObject(t);if(i&&Oe.isHTMLForm(t)&&(t=new FormData(t)),Oe.isFormData(t))return n?JSON.stringify(CS(t)):t;if(Oe.isArrayBuffer(t)||Oe.isBuffer(t)||Oe.isStream(t)||Oe.isFile(t)||Oe.isBlob(t)||Oe.isReadableStream(t))return t;if(Oe.isArrayBufferView(t))return t.buffer;if(Oe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return v3(t,this.formSerializer).toString();if((o=Oe.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return nm(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),j3(t)):t}],transformResponse:[function(t){const r=this.transitional||Oc.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Oe.isResponse(t)||Oe.isReadableStream(t))return t;if(t&&Oe.isString(t)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?At.from(o,At.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ks.classes.FormData,Blob:ks.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Oe.forEach(["delete","get","head","post","put","patch"],e=>{Oc.headers[e]={}});const w3=Oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N3=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||t[r]&&w3[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},ib=Symbol("internals");function So(e){return e&&String(e).trim().toLowerCase()}function qd(e){return e===!1||e==null?e:Oe.isArray(e)?e.map(qd):String(e)}function S3(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const E3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function af(e,t,r,a,n){if(Oe.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!Oe.isString(t)){if(Oe.isString(a))return t.indexOf(a)!==-1;if(Oe.isRegExp(a))return a.test(t)}}function T3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function C3(e,t){const r=Oe.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,i,l){return this[a].call(this,t,n,i,l)},configurable:!0})})}let ea=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function i(o,c,u){const d=So(c);if(!d)throw new Error("header name must be a non-empty string");const m=Oe.findKey(n,d);(!m||n[m]===void 0||u===!0||u===void 0&&n[m]!==!1)&&(n[m||c]=qd(o))}const l=(o,c)=>Oe.forEach(o,(u,d)=>i(u,d,c));if(Oe.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(Oe.isString(t)&&(t=t.trim())&&!E3(t))l(N3(t),r);else if(Oe.isObject(t)&&Oe.isIterable(t)){let o={},c,u;for(const d of t){if(!Oe.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?Oe.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=So(t),t){const a=Oe.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return S3(n);if(Oe.isFunction(r))return r.call(this,n,a);if(Oe.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=So(t),t){const a=Oe.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||af(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function i(l){if(l=So(l),l){const o=Oe.findKey(a,l);o&&(!r||af(a,a[o],o,r))&&(delete a[o],n=!0)}}return Oe.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!t||af(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,a={};return Oe.forEach(this,(n,i)=>{const l=Oe.findKey(a,i);if(l){r[l]=qd(n),delete r[i];return}const o=t?T3(i):String(i).trim();o!==i&&delete r[i],r[o]=qd(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Oe.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&Oe.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[ib]=this[ib]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=So(l);a[o]||(C3(n,l),a[o]=!0)}return Oe.isArray(t)?t.forEach(i):i(t),this}};ea.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Oe.reduceDescriptors(ea.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});Oe.freezeMethods(ea);function nf(e,t){const r=this||Oc,a=t||r,n=ea.from(a.headers);let i=a.data;return Oe.forEach(e,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function AS(e){return!!(e&&e.__CANCEL__)}function io(e,t,r){At.call(this,e??"canceled",At.ERR_CANCELED,t,r),this.name="CanceledError"}Oe.inherits(io,At,{__CANCEL__:!0});function _S(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new At("Request failed with status code "+r.status,[At.ERR_BAD_REQUEST,At.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function A3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function _3(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=a[i];l||(l=u),r[n]=c,a[n]=u;let m=i,f=0;for(;m!==n;)f+=r[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),u-l<t)return;const h=d&&u-d;return h?Math.round(f*1e3/h):void 0}}function k3(e,t){let r=0,a=1e3/t,n,i;const l=(u,d=Date.now())=>{r=d,n=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),m=d-r;m>=a?l(u,d):(n=u,i||(i=setTimeout(()=>{i=null,l(n)},a-m)))},()=>n&&l(n)]}const ru=(e,t,r=3)=>{let a=0;const n=_3(50,250);return k3(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-a,u=n(c),d=l<=o;a=l;const m={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(m)},r)},lb=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},ob=e=>(...t)=>Oe.asap(()=>e(...t)),I3=ks.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ks.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ks.origin),ks.navigator&&/(msie|trident)/i.test(ks.navigator.userAgent)):()=>!0,D3=ks.hasStandardBrowserEnv?{write(e,t,r,a,n,i){const l=[e+"="+encodeURIComponent(t)];Oe.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Oe.isString(a)&&l.push("path="+a),Oe.isString(n)&&l.push("domain="+n),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function P3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function O3(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function kS(e,t,r){let a=!P3(t);return e&&(a||r==!1)?O3(e,t):t}const cb=e=>e instanceof ea?{...e}:e;function Gi(e,t){t=t||{};const r={};function a(u,d,m,f){return Oe.isPlainObject(u)&&Oe.isPlainObject(d)?Oe.merge.call({caseless:f},u,d):Oe.isPlainObject(d)?Oe.merge({},d):Oe.isArray(d)?d.slice():d}function n(u,d,m,f){if(Oe.isUndefined(d)){if(!Oe.isUndefined(u))return a(void 0,u,m,f)}else return a(u,d,m,f)}function i(u,d){if(!Oe.isUndefined(d))return a(void 0,d)}function l(u,d){if(Oe.isUndefined(d)){if(!Oe.isUndefined(u))return a(void 0,u)}else return a(void 0,d)}function o(u,d,m){if(m in t)return a(u,d);if(m in e)return a(void 0,u)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,m)=>n(cb(u),cb(d),m,!0)};return Oe.forEach(Object.keys({...e,...t}),function(d){const m=c[d]||n,f=m(e[d],t[d],d);Oe.isUndefined(f)&&m!==o||(r[d]=f)}),r}const IS=e=>{const t=Gi({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=ea.from(l),t.url=ES(kS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Oe.isFormData(r)){if(ks.hasStandardBrowserEnv||ks.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Oe.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,m])=>{u.includes(d.toLowerCase())&&l.set(d,m)})}}if(ks.hasStandardBrowserEnv&&(a&&Oe.isFunction(a)&&(a=a(t)),a||a!==!1&&I3(t.url))){const c=n&&i&&D3.read(i);c&&l.set(n,c)}return t},R3=typeof XMLHttpRequest<"u",F3=R3&&function(e){return new Promise(function(r,a){const n=IS(e);let i=n.data;const l=ea.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=n,d,m,f,h,x;function p(){h&&h(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function j(){if(!g)return;const y=ea.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),S={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};_S(function(N){r(N),p()},function(N){a(N),p()},S),g=null}"onloadend"in g?g.onloadend=j:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(j)},g.onabort=function(){g&&(a(new At("Request aborted",At.ECONNABORTED,e,g)),g=null)},g.onerror=function(b){const S=b&&b.message?b.message:"Network Error",E=new At(S,At.ERR_NETWORK,e,g);E.event=b||null,a(E),g=null},g.ontimeout=function(){let b=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const S=n.transitional||TS;n.timeoutErrorMessage&&(b=n.timeoutErrorMessage),a(new At(b,S.clarifyTimeoutError?At.ETIMEDOUT:At.ECONNABORTED,e,g)),g=null},i===void 0&&l.setContentType(null),"setRequestHeader"in g&&Oe.forEach(l.toJSON(),function(b,S){g.setRequestHeader(S,b)}),Oe.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),o&&o!=="json"&&(g.responseType=n.responseType),u&&([f,x]=ru(u,!0),g.addEventListener("progress",f)),c&&g.upload&&([m,h]=ru(c),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(d=y=>{g&&(a(!y||y.type?new io(null,e,g):y),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const w=A3(n.url);if(w&&ks.protocols.indexOf(w)===-1){a(new At("Unsupported protocol "+w+":",At.ERR_BAD_REQUEST,e));return}g.send(i||null)})},L3=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const i=function(u){if(!n){n=!0,o();const d=u instanceof Error?u:this.reason;a.abort(d instanceof At?d:new io(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,i(new At(`timeout ${t} of ms exceeded`,At.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>Oe.asap(o),c}},M3=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},B3=async function*(e,t){for await(const r of z3(e))yield*M3(r,t)},z3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},db=(e,t,r,a)=>{const n=B3(e,t);let i=0,l,o=c=>{l||(l=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){o(),c.close();return}let m=d.byteLength;if(r){let f=i+=m;r(f)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},ub=64*1024,{isFunction:md}=Oe,$3=(({Request:e,Response:t})=>({Request:e,Response:t}))(Oe.global),{ReadableStream:mb,TextEncoder:fb}=Oe.global,hb=(e,...t)=>{try{return!!e(...t)}catch{return!1}},U3=e=>{e=Oe.merge.call({skipUndefined:!0},$3,e);const{fetch:t,Request:r,Response:a}=e,n=t?md(t):typeof fetch=="function",i=md(r),l=md(a);if(!n)return!1;const o=n&&md(mb),c=n&&(typeof fb=="function"?(x=>p=>x.encode(p))(new fb):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=i&&o&&hb(()=>{let x=!1;const p=new r(ks.origin,{body:new mb,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!p}),d=l&&o&&hb(()=>Oe.isReadableStream(new a("").body)),m={stream:d&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!m[x]&&(m[x]=(p,g)=>{let j=p&&p[x];if(j)return j.call(p);throw new At(`Response type '${x}' is not supported`,At.ERR_NOT_SUPPORT,g)})});const f=async x=>{if(x==null)return 0;if(Oe.isBlob(x))return x.size;if(Oe.isSpecCompliantForm(x))return(await new r(ks.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Oe.isArrayBufferView(x)||Oe.isArrayBuffer(x))return x.byteLength;if(Oe.isURLSearchParams(x)&&(x=x+""),Oe.isString(x))return(await c(x)).byteLength},h=async(x,p)=>{const g=Oe.toFiniteNumber(x.getContentLength());return g??f(p)};return async x=>{let{url:p,method:g,data:j,signal:w,cancelToken:y,timeout:b,onDownloadProgress:S,onUploadProgress:E,responseType:N,headers:T,withCredentials:k="same-origin",fetchOptions:I}=IS(x),D=t||fetch;N=N?(N+"").toLowerCase():"text";let A=L3([w,y&&y.toAbortSignal()],b),M=null;const G=A&&A.unsubscribe&&(()=>{A.unsubscribe()});let q;try{if(E&&u&&g!=="get"&&g!=="head"&&(q=await h(T,j))!==0){let Ee=new r(p,{method:"POST",body:j,duplex:"half"}),F;if(Oe.isFormData(j)&&(F=Ee.headers.get("content-type"))&&T.setContentType(F),Ee.body){const[P,C]=lb(q,ru(ob(E)));j=db(Ee.body,ub,P,C)}}Oe.isString(k)||(k=k?"include":"omit");const z=i&&"credentials"in r.prototype,ee={...I,signal:A,method:g.toUpperCase(),headers:T.normalize().toJSON(),body:j,duplex:"half",credentials:z?k:void 0};M=i&&new r(p,ee);let U=await(i?D(M,I):D(p,ee));const X=d&&(N==="stream"||N==="response");if(d&&(S||X&&G)){const Ee={};["status","statusText","headers"].forEach(W=>{Ee[W]=U[W]});const F=Oe.toFiniteNumber(U.headers.get("content-length")),[P,C]=S&&lb(F,ru(ob(S),!0))||[];U=new a(db(U.body,ub,P,()=>{C&&C(),G&&G()}),Ee)}N=N||"text";let oe=await m[Oe.findKey(m,N)||"text"](U,x);return!X&&G&&G(),await new Promise((Ee,F)=>{_S(Ee,F,{data:oe,headers:ea.from(U.headers),status:U.status,statusText:U.statusText,config:x,request:M})})}catch(z){throw G&&G(),z&&z.name==="TypeError"&&/Load failed|fetch/i.test(z.message)?Object.assign(new At("Network Error",At.ERR_NETWORK,x,M),{cause:z.cause||z}):At.from(z,z&&z.code,x,M)}}},W3=new Map,DS=e=>{let t=e?e.env:{};const{fetch:r,Request:a,Response:n}=t,i=[a,n,r];let l=i.length,o=l,c,u,d=W3;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:U3(t)),d=u;return u};DS();const Lp={http:i3,xhr:F3,fetch:{get:DS}};Oe.forEach(Lp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const pb=e=>`- ${e}`,H3=e=>Oe.isFunction(e)||e===null||e===!1,PS={getAdapter:(e,t)=>{e=Oe.isArray(e)?e:[e];const{length:r}=e;let a,n;const i={};for(let l=0;l<r;l++){a=e[l];let o;if(n=a,!H3(a)&&(n=Lp[(o=String(a)).toLowerCase()],n===void 0))throw new At(`Unknown adapter '${o}'`);if(n&&(Oe.isFunction(n)||(n=n.get(t))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(pb).join(`
`):" "+pb(l[0]):"as no adapter specified";throw new At("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Lp};function lf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new io(null,e)}function xb(e){return lf(e),e.headers=ea.from(e.headers),e.data=nf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),PS.getAdapter(e.adapter||Oc.adapter,e)(e).then(function(a){return lf(e),a.data=nf.call(e,e.transformResponse,a),a.headers=ea.from(a.headers),a},function(a){return AS(a)||(lf(e),a&&a.response&&(a.response.data=nf.call(e,e.transformResponse,a.response),a.response.headers=ea.from(a.response.headers))),Promise.reject(a)})}const OS="1.12.2",im={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{im[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const gb={};im.transitional=function(t,r,a){function n(i,l){return"[Axios v"+OS+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(t===!1)throw new At(n(l," has been removed"+(r?" in "+r:"")),At.ERR_DEPRECATED);return r&&!gb[l]&&(gb[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};im.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function V3(e,t,r){if(typeof e!="object")throw new At("options must be an object",At.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const i=a[n],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new At("option "+i+" must be "+c,At.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new At("Unknown option "+i,At.ERR_BAD_OPTION)}}const Kd={assertOptions:V3,validators:im},cn=Kd.validators;let Fi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new nb,response:new nb}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Gi(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&Kd.assertOptions(a,{silentJSONParsing:cn.transitional(cn.boolean),forcedJSONParsing:cn.transitional(cn.boolean),clarifyTimeoutError:cn.transitional(cn.boolean)},!1),n!=null&&(Oe.isFunction(n)?r.paramsSerializer={serialize:n}:Kd.assertOptions(n,{encode:cn.function,serialize:cn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Kd.assertOptions(r,{baseUrl:cn.spelling("baseURL"),withXsrfToken:cn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&Oe.merge(i.common,i[r.method]);i&&Oe.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=ea.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,m=0,f;if(!c){const x=[xb.bind(this),void 0];for(x.unshift(...o),x.push(...u),f=x.length,d=Promise.resolve(r);m<f;)d=d.then(x[m++],x[m++]);return d}f=o.length;let h=r;for(;m<f;){const x=o[m++],p=o[m++];try{h=x(h)}catch(g){p.call(this,g);break}}try{d=xb.call(this,h)}catch(x){return Promise.reject(x)}for(m=0,f=u.length;m<f;)d=d.then(u[m++],u[m++]);return d}getUri(t){t=Gi(this.defaults,t);const r=kS(t.baseURL,t.url,t.allowAbsoluteUrls);return ES(r,t.params,t.paramsSerializer)}};Oe.forEach(["delete","get","head","options"],function(t){Fi.prototype[t]=function(r,a){return this.request(Gi(a||{},{method:t,url:r,data:(a||{}).data}))}});Oe.forEach(["post","put","patch"],function(t){function r(a){return function(i,l,o){return this.request(Gi(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Fi.prototype[t]=r(),Fi.prototype[t+"Form"]=r(!0)});let G3=class RS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,o){a.reason||(a.reason=new io(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new RS(function(n){t=n}),cancel:t}}};function q3(e){return function(r){return e.apply(null,r)}}function K3(e){return Oe.isObject(e)&&e.isAxiosError===!0}const Mp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Mp).forEach(([e,t])=>{Mp[t]=e});function FS(e){const t=new Fi(e),r=fS(Fi.prototype.request,t);return Oe.extend(r,Fi.prototype,t,{allOwnKeys:!0}),Oe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return FS(Gi(e,n))},r}const jr=FS(Oc);jr.Axios=Fi;jr.CanceledError=io;jr.CancelToken=G3;jr.isCancel=AS;jr.VERSION=OS;jr.toFormData=nm;jr.AxiosError=At;jr.Cancel=jr.CanceledError;jr.all=function(t){return Promise.all(t)};jr.spread=q3;jr.isAxiosError=K3;jr.mergeConfig=Gi;jr.AxiosHeaders=ea;jr.formToJSON=e=>CS(Oe.isHTMLForm(e)?new FormData(e):e);jr.getAdapter=PS.getAdapter;jr.HttpStatusCode=Mp;jr.default=jr;const{Axios:qce,AxiosError:Kce,CanceledError:Yce,isCancel:Xce,CancelToken:Jce,VERSION:Zce,all:Qce,Cancel:ede,isAxiosError:tde,spread:rde,toFormData:sde,AxiosHeaders:ade,HttpStatusCode:nde,formToJSON:ide,getAdapter:lde,mergeConfig:ode}=jr,Hl={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},Pe={LOGIN:"/login",RESET_PASSWORD:"/reset-password",PROFILE:"/profile",DASHBOARD:"/dashboard",USERS:"/users",USERS_DETAIL:e=>`/users/${e}`,ROLES:"/roles",ROLES_DETAIL:e=>`/roles/${e}`,DEPARTMENTS:"/departments",DEPARTMENTS_DETAIL:e=>`/departments/${e}`,COURSES:"/courses",COURSES_INSTRUCTED:"/courses/instructed",COURSES_ENROLLED:"/courses/enrolled",COURSES_DETAIL:e=>`/courses/${e}`,ACADEMIC_COURSE_DETAIL:e=>`/academic/course-detail/${e}`,SUBJECTS:"/subjects",SUBJECTS_DETAIL:e=>`/subjects/${e}`,SUBJECTS_IN_COURSE:(e,t)=>`/courses/${e}/subjects/${t}`,ASSESSMENTS:"/assessments",ASSESSMENTS_UPCOMING:"/assessments/upcoming",ASSESSMENTS_MY_ASSESSMENTS:"/assessments/my-assessments",ASSESSMENTS_RESULTS:"/assessments/results",ASSESSMENTS_DETAIL:e=>`/assessments/${e}`,ASSESSMENTS_SECTIONS:e=>`/assessments/${e}/sections`,ASSESSMENTS_SECTION_FIELDS:e=>`/assessments/sections/${e}/fields`,ASSESSMENTS_ASSIGN:(e,t)=>`/assessments/assign/${e}/${t}`,ASSESSMENTS_SIGNATURE_REQUIRED:"/assessments/signature-required",ASSESSMENTS_PENDING:"/assessments/pending",ASSESSMENT_EVENTS:"/assessment-events",TEMPLATES:"/templates",TEMPLATES_DETAIL:e=>`/templates/${e}`,TEMPLATES_EDITOR:"/templates/editor",TEMPLATES_DRAFTS:"/templates/drafts",TEMPLATES_HISTORY:e=>`/templates/${e}/history`,TEMPLATES_SECTIONS:e=>`/templates/${e}/sections`,TEMPLATES_FIELDS:e=>`/templates/${e}/fields`,REPORTS:"/reports",REPORTS_ISSUES:"/reports/issues",REPORTS_FEEDBACK:"/reports/feedback",REPORTS_CREATE:"/reports/create",REPORTS_DETAIL:e=>`/reports/${e}`,SYSTEM_CONFIG:"/system-config",GLOBAL_FIELDS:"/system-config/global-fields",MAIN_MENU:"/main-menu",TRAINEE_ACADEMIC_DETAILS:"/academic-details",TRAINEE_SIGNATURE_PAD:e=>`/signature-pad/${e}`,TRAINEE_ASSESSMENT_SECTION:e=>`/assessments/sections/${e}`,TRAINER_CONFIGURE_SIGNATURE:"/configure-signature",TRAINER_APPROVAL_NOTES:e=>`/assessments/approval-notes/${e}`,DEPARTMENT_MY_DETAILS:"/my-department-details",DEPARTMENT_REVIEW_REQUESTS:"/assessment-review-requests",DEPARTMENT_REVIEW_REQUEST_DETAIL:e=>`/assessment-review-requests/${e}`,DEPARTMENT_REVIEW_EVENT_DETAIL:e=>`/assessment-review-requests/events/${e}`},vb={"/admin/users":Pe.USERS,"/admin/roles":Pe.ROLES,"/admin/departments":Pe.DEPARTMENTS,"/admin/forms":Pe.TEMPLATES,"/admin/forms/editor":Pe.TEMPLATES_EDITOR,"/admin/forms/drafts":Pe.TEMPLATES_DRAFTS,"/admin/system-config":Pe.SYSTEM_CONFIG,"/admin/main-menu":Pe.MAIN_MENU,"/trainer/instructed-courses":Pe.COURSES_INSTRUCTED,"/trainer/upcoming-assessments":Pe.ASSESSMENTS_UPCOMING,"/trainer/assessment-results":Pe.ASSESSMENTS_RESULTS,"/trainer/configure-signature":Pe.TRAINER_CONFIGURE_SIGNATURE,"/trainer/dashboard":Pe.DASHBOARD,"/trainee/dashboard":Pe.DASHBOARD,"/trainee/enrolled-courses":Pe.COURSES_ENROLLED,"/trainee/all-assessments":Pe.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/your-assessments":Pe.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/signature-required":Pe.ASSESSMENTS_SIGNATURE_REQUIRED,"/trainee/completion-required":Pe.ASSESSMENTS_COMPLETION_REQUIRED,"/trainee/create-incident-feedback-report":Pe.REPORTS_CREATE,"/trainee/academic-details":Pe.TRAINEE_ACADEMIC_DETAILS,"/academic/dashboard":Pe.DASHBOARD,"/academic/departments":Pe.COURSES,"/academic/assessment-events":Pe.ASSESSMENT_EVENTS,"/academic/course-detail/:courseId":e=>`/academic/course-detail/${e}`,"/department-head/dashboard":Pe.DASHBOARD,"/department-head/my-department-details":Pe.DEPARTMENT_MY_DETAILS,"/department-head/assessment-review-requests":Pe.DEPARTMENT_REVIEW_REQUESTS,"/sqa/issues":Pe.REPORTS_ISSUES,"/sqa/feedback":Pe.REPORTS_FEEDBACK,"/sqa/templates":Pe.TEMPLATES},LS=e=>{const t=e.split("?")[0].split("#")[0];return vb[t]?vb[t]:(Object.values(Pe).includes(t),t)},ng=()=>"/dsfms-template/",Y3=(e="/")=>{const r=`${ng()}${e}`;window.location.href=r},of=()=>{Y3("/")},ig="https://dsfms.id.vn",Se=jr.create({baseURL:ig,timeout:2e4,headers:{"Content-Type":"application/json"}}),MS=jr.create({baseURL:ig,timeout:2e4,headers:{"Content-Type":"application/json"}});let cf=!1,Bp=[],fd=0;const yb=2,BS=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},X3=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},bb=(e,t=null)=>{Bp.forEach(r=>{e?r.reject(e):r.resolve(t)}),Bp=[]};Se.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(BS(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):X3(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/assign-trainees")&&e.method==="post"&&console.log(" Assign Trainees Request (Interceptor):",{url:e.url,method:e.method,data:e.data,dataType:typeof e.data,dataIsArray:Array.isArray(e.data),dataStringified:JSON.stringify(e.data),headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/departments/")&&e.method==="put"&&console.log(" Department Update Request (Interceptor):",{url:e.url,method:e.method,baseURL:e.baseURL,fullURL:`${e.baseURL}${e.url}`,data:e.data,headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Se.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&fd<yb){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),cf)return new Promise((n,i)=>{Bp.push({resolve:n,reject:i})}).then(n=>(t.headers.Authorization=`Bearer ${n}`,Se(t))).catch(n=>Promise.reject(n));t._retry=!0,cf=!0,fd++;const a=localStorage.getItem("refreshToken");if(a)try{if(console.log(" Token ht hn (401), ang refresh token..."),BS(a))throw new Error("Refresh token is also expired");const n=await jr.post(`${ig}/auth/refresh`,{refresh_token:a}),{access_token:i,refresh_token:l}=n.data;if(!i||!l)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",l),fd=0,console.log(" Refresh token thnh cng, retry request gc"),bb(null,i),t.headers.Authorization=`Bearer ${i}`,await Se(t)}catch(n){return console.error(" Refresh token tht bi:",n),bb(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),of(),Promise.reject(n)}finally{cf=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),of()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);fd>=yb&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),of())}return Promise.reject(e)});const hd=jr.create({baseURL:"https://dsfms.id.vn",timeout:2e4,headers:{"Content-Type":"application/json"}}),Jn={login:async e=>{try{return(await hd.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await hd.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Se.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await hd.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await hd.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(a){throw a.response?.data||a.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},Ks={getUsers:async(e={})=>{try{const r=(await Se.get("/users",{params:e})).data;if(r&&r.data){if(Array.isArray(r.data))return{data:r.data};if(r.data.users&&Array.isArray(r.data.users))return{data:r.data.users}}return Array.isArray(r)?{data:r}:r&&r.users&&Array.isArray(r.users)?{data:r.users}:r}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{const r=(await Se.get(`/users/${e}`)).data;return r?.data&&typeof r.data=="object"?r.data:r}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Se.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Se.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Se.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Se.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Se.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{const t=(await Se.get("/roles")).data;return t&&t.data&&typeof t.data=="object"?t.data:t}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Se.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Se.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Se.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Se.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Se.get("/users",{params:{roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},Zn=e=>e&&e.data&&typeof e.data=="object"?e.data:e,Es={getRoles:async(e={})=>{try{const t=await Se.get("/roles",{params:e});return Zn(t.data)}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{const t=await Se.get(`/roles/${e}`);return Zn(t.data)}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{const t=await Se.post("/roles",e);return Zn(t.data)}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Se.put(`/roles/${e}`,t),a=Zn(r.data);return console.log(" API updateRole success:",a),a}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{const t=await Se.delete(`/roles/${e}`);return Zn(t.data)}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{const t=await Se.patch(`/roles/${e}/toggle-status`);return Zn(t.data)}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{const t=await Se.patch(`/roles/${e}/enable`);return Zn(t.data)}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{const t=await Se.delete(`/roles/${e}`);return Zn(t.data)}catch(t){throw t.response?.data||t.message}}},Ht={getPublicDepartments:async()=>{try{const e=await MS.get("/public/departments");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public departments:",e),e}},getDepartments:async(e={})=>{try{const t=await Se.get("/departments",{params:{...e}});return t.data?.data?.departments||t.data?.departments||[]}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{const t=await Se.get(`/departments/${e}`);return t.data?.data||t.data||{}}catch(t){throw console.error("Error fetching department:",t),t}},getMyDepartment:async()=>{try{const e=await Se.get("/departments/me");return e.data?.data||e.data||{}}catch(e){throw console.error("Error fetching my department:",e),e}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Se.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{console.log(" API - Updating department:",{id:e,departmentData:t});const r=await Se.put(`/departments/${e}`,t);return console.log(" API - Department updated successfully:",r.data),r.data}catch(r){if(console.error(" API - Error updating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),console.error(" API - Request config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data}),r.code==="ERR_NETWORK"||r.message==="Network Error"){const a=new Error("Network error: Unable to connect to server. Please check your internet connection or contact support.");throw a.code="NETWORK_ERROR",a}else if(r.response?.status===502){const a=new Error("Server error (502): Bad Gateway. The server is temporarily unavailable. Please try again later.");throw a.code="BAD_GATEWAY",a}else if(r.response?.status===403){const a=new Error("Permission denied: You do not have permission to update this department.");throw a.code="PERMISSION_DENIED",a}throw r}},deleteDepartment:async e=>{try{return(await Se.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Se.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Se.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Se.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Se.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Se.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Se.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Se.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Se.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},kr={getPublicCourses:async()=>{try{const e=await MS.get("/public/courses");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public courses:",e),e}},getCourses:async(e={})=>{try{return(await Se.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{const t=await Se.get(`/courses/${e}`);return t.data&&t.data.data?t.data.data:t.data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Se.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Se.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},archiveCourse:async e=>{try{return(await Se.delete(`/courses/${e}/archive`)).data}catch(t){throw console.error("Error archiving course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Se.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Se.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{const t=await Se.get(`/departments/${e}`,{params:{includeDeleted:!0}});return t.data?.data||t.data||{}}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async(e,t)=>{try{return(await Se.get(`/courses/${e}/trainees/${t}/enrollments`)).data}catch(r){throw console.error("Error fetching trainee enrollments:",r),r}},getTraineeEnrollmentsByStatus:async(e,t="ENROLLED")=>{try{return(await Se.get(`/courses/trainees/${e}/enrollments`,{params:{status:t}})).data}catch(r){throw console.error("Error fetching trainee enrollments:",r),r}},getCourseTrainees:async e=>{try{return(await Se.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching course trainees:",t),t}},getCourseEnrollmentBatches:async e=>{try{return(await Se.get(`/courses/${e}/enrollments/batches`)).data}catch(t){throw console.error("Error fetching course enrollment batches:",t),t}},deleteBatchEnrollments:async(e,t)=>{try{return(await Se.delete(`/courses/${e}/enrollments/batches/${t}`)).data}catch(r){throw console.error("Error deleting batch enrollments:",r),r}},getActiveTrainers:async(e=null,t=null)=>{try{let r="/subjects/courses/active-trainers";const a=new URLSearchParams;return e&&a.append("courseId",e),t&&a.append("subjectId",t),a.toString()&&(r+=`?${a.toString()}`),(await Se.get(r)).data}catch(r){throw console.error("Error fetching active trainers:",r),r.response?.data||r.message}},assignTrainerToCourse:async(e,t)=>{try{return(await Se.post(`/courses/${e}/trainers`,t)).data}catch(r){throw console.error("Error assigning trainer to course:",r),r}},removeTrainerFromCourse:async(e,t)=>{try{return(await Se.delete(`/courses/${e}/trainers/${t}`)).data}catch(r){throw console.error("Error removing trainer from course:",r),r}},updateTrainerInCourse:async(e,t,r)=>{try{return(await Se.put(`/courses/${e}/trainers/${t}`,r)).data}catch(a){throw console.error("Error updating trainer in course:",a),a}}},su={getTrainees:async(e={})=>{try{return(await Se.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Se.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Se.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Se.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Se.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Se.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Se.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Se.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Se.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Se.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Se.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Se.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async()=>{try{return(await Se.get("/subjects/active-trainees")).data}catch(e){throw e.response?.data||e.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={traineesList:e};console.log("Sending request with format:",t);const r=await Se.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Se.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},gs={getSubjects:async(e={})=>{try{return(await Se.get("/subjects",{params:e})).data}catch(t){throw t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;try{return(await Se.get(r,{params:t})).data}catch(a){throw a}},getSubjectById:async e=>{try{const t=await Se.get(`/subjects/${e}`,{data:void 0,transformRequest:[(r,a)=>{delete a["Content-Type"]}]});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw t}},createSubject:async e=>{try{return(await Se.post("/subjects",e)).data}catch(t){throw t}},updateSubject:async(e,t)=>{try{return(await Se.put(`/subjects/${e}`,t)).data}catch(r){throw r}},deleteSubject:async e=>{try{return(await Se.delete(`/subjects/${e}`)).data}catch(t){throw t}},archiveSubject:async e=>{try{return(await Se.delete(`/subjects/${e}/archive`)).data}catch(t){throw t}},bulkImportSubjects:async e=>{try{const r={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...l}=n;return l})},a=await Se.post("/subjects/bulk",r);return a.status===304?{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"}:a.data}catch(t){if(t.response?.status===304)return{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"};throw t}},assignTrainees:async(e,t)=>{try{const r={batchCode:t.batchCode||t.batch_code||"",traineeUserIds:t.traineeUserIds||t.trainee_user_ids||[]};if(!r.batchCode||typeof r.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(r.traineeUserIds)||r.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");if(!e)throw new Error("subjectId is required");const a={batchCode:String(r.batchCode).trim(),traineeUserIds:Array.isArray(r.traineeUserIds)?[...r.traineeUserIds]:[]};return(await Se.post(`/subjects/${e}/assign-trainees`,a)).data}catch(r){throw r}},assignTraineesToMultipleSubjects:async e=>{try{const t={batchCode:e.batchCode||e.batch_code||"",traineeUserIds:e.traineeUserIds||e.trainee_user_ids||[],subjectIds:e.subjectIds||e.subject_ids||[]};if(!t.batchCode||typeof t.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(t.traineeUserIds)||t.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");if(!Array.isArray(t.subjectIds)||t.subjectIds.length===0)throw new Error("subjectIds must be a non-empty array");const r={batchCode:String(t.batchCode).trim(),traineeUserIds:Array.isArray(t.traineeUserIds)?[...t.traineeUserIds]:[],subjectIds:Array.isArray(t.subjectIds)?[...t.subjectIds]:[]};return(await Se.post("/subjects/assign-trainees",r)).data}catch(t){throw t}},removeTraineeFromSubject:async(e,t,r)=>{try{const a={batchCode:r};return(await Se.delete(`/subjects/${e}/trainees/${t}`,{data:a})).data}catch(a){throw a}},removeTraineeFromAllSubjects:async(e,t)=>{try{return(await Se.delete(`/subjects/courses/${e}/trainees/${t}`)).data}catch(r){throw r}},addTrainerToSubject:async(e,t)=>{try{if(!t||typeof t!="object")throw new Error("Trainer data is required and must be an object");const r=t.trainer_user_id,a=t.trainerUserId,n=t.role_in_subject,i=t.roleInSubject,l=a||r,o=i||n;if(!l)throw new Error("trainerUserId is required");if(!o)throw new Error("roleInSubject is required");const c=["EXAMINER","ASSESSMENT_REVIEWER"];if(!c.includes(o))throw new Error(`Invalid roleInSubject: ${o}. Must be one of: ${c.join(", ")}`);const u=String(l).trim(),d=String(o).trim();if(!u||u==="")throw new Error("trainerUserId cannot be empty");if(!d||d==="")throw new Error("roleInSubject cannot be empty");const m={trainerUserId:u,roleInSubject:d};return(await Se.post(`/subjects/${e}/trainers`,m,{headers:{"Content-Type":"application/json"}})).data}catch(r){throw r.response?.data?r.response.data:new Error(r.message||"Failed to add trainer to subject")}},getSubjectTrainers:async e=>{try{return(await Se.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const a={roleInSubject:r.roleInSubject};return(await Se.put(`/subjects/${e}/trainers/${t}`,a)).data}catch(a){throw a.response?.data||a.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Se.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}},getTraineeCourseSubjects:async e=>{try{const t=await Se.get(`/subjects/trainees/${e}/course-subjects`);return t.data?.data||t.data}catch(t){throw t}},getSubjectTrainees:async e=>{try{const t=await Se.get(`/subjects/${e}/trainees`);return t.data?.data||t.data}catch(t){throw t}}},Dt={getTemplates:async(e={})=>{try{return(await Se.get("/templates",{params:e})).data}catch(t){throw t}},getTemplateById:async e=>{try{return(await Se.get(`/templates/${e}`)).data}catch(t){throw t}},getTemplatesByDepartment:async(e,t={})=>{try{return(await Se.get(`/templates/department/${e}`,{params:{status:"PUBLISHED",...t}})).data}catch(r){throw r}},getMyTemplates:async()=>{try{return(await Se.get("/templates")).data}catch(e){throw e}},createTemplate:async e=>{try{return(await Se.post("/templates",e)).data}catch(t){throw t}},updateTemplate:async(e,t)=>{try{return(await Se.put(`/templates/${e}`,t)).data}catch(r){throw r}},deleteTemplate:async e=>{try{return(await Se.delete(`/templates/${e}`)).data}catch(t){throw t}},deleteDraft:async e=>{try{return(await Se.delete(`/templates/draft/${e}`)).data}catch(t){throw t}},getTemplatePDF:async e=>{try{return(await Se.get(`/templates/pdf/${e}`,{responseType:"blob"})).data}catch(t){throw t}},getTemplatePdfConfig:async e=>{try{return(await Se.get(`/templates/pdf-config/${e}`,{responseType:"blob"})).data}catch(t){throw t}},reviewTemplate:async(e,t)=>{try{return(await Se.patch(`/templates/${e}/review`,t)).data}catch(r){throw r}},extractFields:async e=>{try{return(await Se.post("/templates/extract-fields-from-url",{url:e})).data}catch(t){throw t}},createVersion:async e=>{try{return(await Se.post("/templates/create-version",e)).data}catch(t){throw t}},disableTemplate:async e=>{try{return(await Se.patch(`/templates/${e}/status`,{status:"DISABLED"})).data}catch(t){throw t}},enableTemplate:async e=>{try{return(await Se.patch(`/templates/${e}/status`,{status:"PENDING"})).data}catch(t){throw t}}},an={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const a of r)try{const n=new FormData;n.append(a,e),console.log(` Testing field name: "${a}"`);const i=await Se.post(`/media/docs/upload/${t}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${a}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${a}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`,uploadFromUrl:async(e,t)=>{try{console.log(" Uploading from URL:",e),console.log(" File name:",t);const r=await Se.post("/media/docs/upload-from-url",{sourceUrl:e,fileName:t});if(r.data&&r.data.data&&r.data.data.length>0){const a=r.data.data[0].url;return console.log(" File uploaded from URL successfully! New URL:",a),a}else throw new Error("Invalid response format from upload-from-url API")}catch(r){throw console.error(" Error uploading from URL:",r),r}},uploadImage:async(e,t)=>{try{const r=new FormData;r.append("files",e);const a=await Se.post(`/media/images/upload/${t}`,r,{headers:{"Content-Type":"multipart/form-data"}});if(a.data&&a.data.data&&a.data.data.length>0)return a.data.data[0].url;if(a.data&&a.data.url)return a.data.url;if(a.data&&a.data.fileUrl)return a.data.fileUrl;if(a.data&&a.data.path)return a.data.path;throw new Error("Invalid response format from upload image API")}catch(r){throw console.error(" Error uploading image:",r),r}}},vr={getAssessmentEvents:async(e={})=>{try{return(await Se.get("/assessments/events",{params:e})).data}catch(t){throw console.error("Error fetching assessment events:",t),t}},updateAssessmentEvent:async(e={},t={})=>{try{return(await Se.put("/assessments/events/update",t,{params:e})).data}catch(r){throw console.error("Error updating assessment event:",r),r}},createAssessmentEvent:async e=>{try{return(await Se.post("/assessments",e)).data}catch(t){throw console.error("Error creating assessment event:",t),t}},createBulkAssessmentEvent:async e=>{try{return(await Se.post("/assessments/bulk",e)).data}catch(t){throw console.error("Error creating bulk assessment event:",t),t}},getUserEvents:async(e={})=>{try{return(await Se.get("/assessments/user-events",{params:e})).data}catch(t){throw console.error("Error fetching user assessment events:",t),t}},getTraineeAssessments:async(e={})=>{try{return(await Se.get("/assessments/trainee",{params:e})).data}catch(t){throw console.error("Error fetching trainee assessments:",t),t}},getCourseAssessments:async(e,t={})=>{try{return(await Se.get("/assessments/course",{params:{courseId:e,...t}})).data}catch(r){throw console.error("Error fetching course assessments:",r),r}},getSubjectAssessments:async(e,t={})=>{try{return(await Se.get("/assessments/subject",{params:{subjectId:e,...t}})).data}catch(r){throw console.error("Error fetching subject assessments:",r),r}},getCourseEvents:async(e={})=>{try{return(await Se.post("/assessments/events/course",e)).data}catch(t){throw console.error("Error fetching course assessment events:",t),t}},getSubjectEvents:async(e={})=>{try{return(await Se.post("/assessments/events/subject",e)).data}catch(t){throw console.error("Error fetching subject assessment events:",t),t}},getAssessmentSections:async e=>{try{return(await Se.get(`/assessments/${e}/sections`)).data}catch(t){throw console.error("Error fetching assessment sections:",t),t}},getAssessmentFormPreview:async e=>{try{return(await Se.get(`/assessments/${e}/preview`)).data}catch(t){throw console.error("Error fetching assessment preview:",t),t}},getAssessmentSectionFields:async e=>{try{return(await Se.get(`/assessments/sections/${e}/fields`)).data}catch(t){throw console.error("Error fetching assessment section fields:",t),t}},confirmParticipation:async(e,t={})=>{try{return(await Se.put(`/assessments/${e}/confirm-participation`,t)).data}catch(r){throw console.error("Error confirming participation:",r),r}},saveSectionValues:async e=>{try{return(await Se.post("/assessments/sections/save-values",e)).data}catch(t){throw console.error("Error saving section values:",t),t}},updateSectionValues:async e=>{try{return(await Se.put("/assessments/sections/update-values",e)).data}catch(t){throw console.error("Error updating section values:",t),t}},updateTraineeLock:async(e,t)=>{try{return(await Se.put(`/assessments/${e}/trainee-lock`,{isTraineeLocked:t})).data}catch(r){throw console.error("Error updating trainee lock:",r),r}},submitAssessment:async e=>{try{return(await Se.post(`/assessments/${e}/submit`)).data}catch(t){throw console.error("Error submitting assessment:",t),t}},getDepartmentAssessments:async(e={})=>{try{return(await Se.get("/assessments/department",{params:e})).data}catch(t){throw console.error("Error fetching department assessments:",t),t}},getDepartmentEvents:async(e={})=>{try{return(await Se.get("/assessments/department-events",{params:e})).data}catch(t){throw console.error("Error fetching department assessment events:",t),t}},approveRejectAssessment:async(e,t,r="")=>{try{const a={action:t};return t==="REJECTED"&&r&&(a.comment=r),(await Se.put(`/assessments/${e}/approve-reject`,a)).data}catch(a){throw console.error("Error approving/rejecting assessment:",a),a}},getAssessmentsByEventId:async(e,t={})=>{try{return(await Se.get(`/assessments/events/${e}/assessments`,{params:t})).data}catch(r){throw console.error("Error fetching assessments by event ID:",r),r}},getCourseEventAssessments:async(e,t,r)=>{try{return(await Se.post("/assessments/events/course",{courseId:e,templateId:t,occuranceDate:r})).data}catch(a){throw console.error("Error fetching course event assessments:",a),a}},getSubjectEventAssessments:async(e,t,r)=>{try{return(await Se.post("/assessments/events/subject",{subjectId:e,templateId:t,occuranceDate:r})).data}catch(a){throw console.error("Error fetching subject event assessments:",a),a}},getTraineeAssessments:async()=>{try{return(await Se.get("/assessments/trainee")).data}catch(e){throw console.error("Error fetching trainee assessments:",e),e}}},si={getGlobalFields:async()=>{try{return(await Se.get("/global-fields")).data}catch(e){throw e}},getGlobalFieldDetail:async e=>{try{return(await Se.get(`/global-fields/${e}/detail`)).data}catch(t){throw t}},getGlobalFieldsDetail:async()=>{try{const e=await Se.get("/global-fields/detail");return e.data?.data||e.data||[]}catch(e){throw e}},getGlobalFieldById:async e=>{try{return(await Se.get(`/global-fields/${e}`)).data}catch(t){throw t}},createGlobalField:async e=>{try{return(await Se.post("/global-fields",e)).data}catch(t){throw t}},updateGlobalField:async(e,t)=>{try{return(await Se.patch(`/global-fields/${e}`,t)).data}catch(r){throw r}},deleteGlobalField:async e=>{try{return(await Se.delete(`/global-fields/${e}`)).data}catch(t){throw t}}},jb={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},Xa=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return jb[e]||e;if(e&&typeof e=="object"){const{message:r,errors:a}=e;let n=r;if(Array.isArray(r))if(r.length>0){const l=r[0];typeof l=="object"&&l!==null?n=l.message||l.field||"Validation failed":n=l}else n="Validation failed";let i=jb[n];return i&&typeof i=="object"&&i.default?i=i.default:(!i||typeof i!="string")&&(i=n),a&&Array.isArray(a)&&a.length>0?a.map(o=>{if(o&&typeof o=="object"&&o.path&&o.message){const c=o.path.match(/users\.(\d+)\.(.*)/);let u="",d="";if(c){const f=parseInt(c[1],10);u=Number.isNaN(f)?"":`Row ${f+1}`;const h=c[2].split("."),x=h[h.length-1];d=x?x.replace(/([A-Z])/g," $1").replace(/_/g," ").trim():""}const m=[u,d].filter(Boolean).join(" - ");return m?`${m}: ${o.message}`:o.message}return typeof o=="string"?o:JSON.stringify(o)}).join(`
`):i}return e?.response?.data?Xa(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},zS=v.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),J3=({children:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(null),[i,l]=v.useState([]),[o,c]=v.useState(!1),[u,d]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const w=localStorage.getItem("authToken"),y=localStorage.getItem("user"),b=localStorage.getItem("refreshToken");if(w&&y&&b)try{const S=JSON.parse(atob(w.split(".")[1])),E=Date.now()/1e3;if(S.exp<E)try{const N=await Jn.refreshToken(b);localStorage.setItem("authToken",N.access_token),localStorage.setItem("refreshToken",N.refresh_token);const T=JSON.parse(y);r(T),c(!0);try{const{role:k,permissions:I}=await f(T.role,T.roleId);if(k&&I)n(k),l(I);else throw new Error("Failed to fetch role and permissions")}catch(k){console.error("Failed to fetch role and permissions on initialization:",k),Jn.logout(),r(null),n(null),l([]),c(!1)}}catch{Jn.logout(),r(null),n(null),l([]),c(!1)}else{const N=JSON.parse(y);r(N),c(!0);try{const{role:T,permissions:k}=await f(N.role,N.roleId);if(T&&k)n(T),l(k);else throw new Error("Failed to fetch role and permissions")}catch(T){console.error("Failed to fetch role and permissions on initialization:",T),Jn.logout(),r(null),n(null),l([]),c(!1)}}}catch(S){console.error(" Error parsing token or user data:",S),Jn.logout(),r(null),n(null),l([]),c(!1)}else r(null),n(null),l([]),c(!1)}catch(w){console.error("Error accessing localStorage:",w),r(null),n(null),l([]),c(!1)}finally{d(!1)}})()},[]),v.useEffect(()=>{if(!o||u)return;const j=async()=>{const y=localStorage.getItem("authToken"),b=localStorage.getItem("refreshToken");if(!y||!b){p();return}try{const S=JSON.parse(atob(y.split(".")[1])),E=Date.now()/1e3;S.exp-E<300&&((await x()).success||(console.error(" Token refresh failed in validation"),p()))}catch(S){console.error(" Token validation failed:",S);try{(await x()).success||(console.error(" Token refresh failed after validation error"),p())}catch(E){console.error(" Token refresh failed:",E),p()}}},w=setTimeout(()=>{j();const y=setInterval(j,120*1e3);return()=>clearInterval(y)},500);return()=>clearTimeout(w)},[o,u]);const m=j=>{const w=j?.data||j;if(!w)return console.warn(" No role data provided to normalizePermissionsFromResponse"),[];if(w.permissionGroups&&Array.isArray(w.permissionGroups)){const y=[];return w.permissionGroups.forEach(b=>{b.permissions&&Array.isArray(b.permissions)&&b.permissions.forEach(S=>{S.code&&S.name?y.push({code:S.code,name:S.name,featureGroup:b.featureGroup||"Unknown"}):console.warn(" Invalid permission format (missing code or name):",S)})}),y}return w.permissions&&Array.isArray(w.permissions)?(console.log(" ========== USING OLD FORMAT (permissions array) =========="),console.log(" This format is deprecated. BE should return permissionGroups."),w.permissions.map(b=>b.code?{code:b.code,name:b.name||b.viewName||b.description||"Unknown",featureGroup:b.module||b.viewModule||"Unknown"}:(console.warn(" Old format permission without code field:",b),{code:b.id||`LEGACY-${b.name||"UNKNOWN"}`,name:b.name||b.viewName||b.description||"Unknown",featureGroup:b.module||b.viewModule||"Unknown"}))):(console.warn(" No permissions found in role data (neither permissionGroups nor permissions array)"),[])},f=async(j,w)=>{try{if(w)try{const y=await Es.getRoleById(w),b=m(y),S={id:y?.data?.id||y?.id,name:y?.data?.name||y?.name||j,description:y?.data?.description||y?.description||`${j} role`,isActive:y?.data?.isActive!==void 0?y.data.isActive:y?.isActive!==void 0?y.isActive:!0,permissionCount:b.length};return n(S),l(b),{role:S,permissions:b}}catch(y){if(console.error("Error fetching role by ID:",y),y.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{console.log(" ========== FALLBACK: Using /users/me API ==========");const S=await Se.get("/users/me");if(console.log(" User Profile Response:",{hasRole:!!S.data?.role,hasPermissions:!!S.data?.role?.permissions,permissionsCount:S.data?.role?.permissions?.length||0}),S.data&&S.data.role){const E=m(S.data.role),N={id:w,name:j,description:`${j} role`,isActive:"ACTIVE",permissionCount:E.length};return console.log(" Permissions from /users/me (normalized):",E.slice(0,5).map(T=>({code:T.code,name:T.name,featureGroup:T.featureGroup}))),n(N),l(E),{role:N,permissions:E}}}catch(S){console.error("Failed to get user profile:",S)}console.warn("Cannot fetch permissions, creating minimal role");const b={id:w,name:j,description:`${j} role`,isActive:"ACTIVE",permissions:[]};return n(b),l([]),{role:b,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const y=await Es.getRoles(),b=y.data||y;let S;if(b&&b.roles&&Array.isArray(b.roles))S=b.roles;else if(Array.isArray(b))S=b;else throw new Error("Invalid roles data structure");const E=S.find(N=>N.name===j);if(E){const N=await Es.getRoleById(E.id),T=m(N),k={id:N?.data?.id||N?.id||E.id,name:N?.data?.name||N?.name||j,description:N?.data?.description||N?.description||`${j} role`,isActive:N?.data?.isActive!==void 0?N.data.isActive:N?.isActive!==void 0?N.isActive:!0,permissionCount:T.length};return n(k),l(T),{role:k,permissions:T}}throw new Error(`Role '${j}' not found`)}catch(y){throw console.error("Fallback method failed:",y),new Error(`Role '${j}' not found. Please contact administrator.`)}}catch(y){return console.error("Error fetching user role and permissions:",y),{role:null,permissions:[]}}},h=async j=>{try{d(!0);const w=await Jn.login(j);localStorage.setItem("authToken",w.access_token),localStorage.setItem("refreshToken",w.refresh_token);let y;try{const E=JSON.parse(atob(w.access_token.split(".")[1]));if(!E.userId||!E.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");y={id:E.userId,email:j.email,fullName:E.fullName||E.name||"User",role:E.roleName,roleId:E.roleId,department:E.department||"IT",lastLogin:new Date().toISOString()},j.email==="depthead@test.com"&&(y.role="DEPARTMENT_HEAD",y.roleId="dept-head-001")}catch(E){throw console.error("Error decoding token:",E),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(y));const{role:b,permissions:S}=await f(y.role,y.roleId);if(!b||!S)throw console.error(" Failed to fetch user role and permissions"),new Error("Failed to fetch user role and permissions");return r(y),n(b),l(S),c(!0),{success:!0,user:y,role:b,permissions:S}}catch(w){return{success:!1,error:Xa(w)||"Login failed"}}finally{d(!1)}},x=async()=>{try{const j=localStorage.getItem("refreshToken");if(!j)throw new Error("No refresh token available");const w=await Jn.refreshToken(j);return localStorage.setItem("authToken",w.access_token),localStorage.setItem("refreshToken",w.refresh_token),{success:!0,tokens:w}}catch(j){return console.error("Manual token refresh failed:",j),p(),{success:!1,error:j.message}}},p=()=>{Jn.logout(),r(null),n(null),l([]),c(!1)},g={user:t,setUser:r,userRole:a,userPermissions:i,isAuthenticated:o,setIsAuthenticated:c,isLoading:u,login:h,logout:p,refreshToken:x,fetchUserRoleAndPermissions:f};try{return s.jsx(zS.Provider,{value:g,children:e})}catch(j){return console.error(" AuthProvider error:",j),s.jsxs("div",{style:{padding:"20px",color:"red"},children:[s.jsx("h3",{children:"Authentication Error"}),s.jsx("p",{children:"There was an error initializing the authentication system."}),s.jsxs("details",{children:[s.jsx("summary",{children:"Error Details"}),s.jsx("pre",{children:j.message})]})]})}},Rr=()=>{const e=v.useContext(zS);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},Z3={getPermissions:async(e={})=>{try{return(await Se.get("/permissions",{params:e})).data}catch(t){throw t.response?.data||t.message}},getPermissionById:async e=>{try{return(await Se.get(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},createPermission:async e=>{try{return(await Se.post("/permissions",e)).data}catch(t){throw t.response?.data||t.message}},updatePermission:async(e,t)=>{try{return(await Se.put(`/permissions/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deletePermission:async e=>{try{return(await Se.delete(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},enablePermission:async e=>{try{return(await Se.patch(`/permissions/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},getPermissionGroups:async()=>{try{return(await Se.get("/permission-groups")).data}catch(e){throw e.response?.data||e.message}}},wb=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],a=t[1],i=a.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",o={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return a.includes("forgot-password")?"Forgot Password":a.includes("reset-password")?"Reset Password":a.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("add-trainers")?"Add Trainers to Department":a.includes("remove-trainers")?"Remove Trainers from Department":a.includes("new-feature")?"Create New Feature":a.includes("bulk-import")?"Bulk Import Data":a.includes("export-report")?"Export Report":Q3(o,i,a)}return e},Q3=(e,t,r)=>{if(r.includes("-")){const a=r.split("/").filter(l=>l&&!l.startsWith(":")),i=a[a.length-1].split("-").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},ln=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),{userPermissions:l,userRole:o}=Rr(),c=v.useCallback(async()=>{a(!0),i(null);try{l&&l.length>0?t(l):(t([]),console.log(" No userPermissions available"))}catch(b){console.error("Error setting permissions:",b),i(b),t([])}finally{a(!1)}},[l]),u=v.useCallback(()=>e.map(b=>({id:b.id,title:b.viewName||b.description||wb(b.name),description:b.description||"",module:b.module,method:b.method,path:b.path,isActive:b.isActive,viewName:b.viewName,viewModule:b.viewModule})),[e]),d=v.useCallback(()=>{const b=u(),S={};return b.forEach(E=>{const N=E.module,T=E.viewModule||`${E.module} Management`;S[N]||(S[N]={id:N,name:T,description:`Manage ${T.toLowerCase()} related permissions`,permissions:[]}),S[N].permissions.push({id:E.id,title:E.title,description:E.description,isActive:E.isActive,method:E.method,path:E.path})}),Object.values(S).sort((E,N)=>E.name.localeCompare(N.name))},[u]),m=v.useCallback(b=>{const S=e.find(E=>E.id===b);return S?S.isActive==="ACTIVE":!0},[e]),f=v.useCallback(b=>e.find(S=>S.id===b),[e]),h=v.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(b=>b.code).filter(Boolean)),[l]),x=v.useCallback(b=>!l||l.length===0||!b||typeof b!="string"?!1:h.has(b),[l,h]),p=v.useCallback(b=>!l||l.length===0||!Array.isArray(b)||b.length===0?!1:b.some(x),[l,x]),g=v.useCallback(b=>!l||l.length===0||!Array.isArray(b)||b.length===0?!1:b.every(x),[l,x]),j=v.useCallback(b=>!l||l.length===0?!1:l.some(S=>S.module===b),[l]),w=v.useCallback(()=>!l||l.length===0?[]:[...new Set(l.map(S=>S.module))],[l]),y=v.useCallback(()=>{if(!l||l.length===0)return[];const b=l.map(E=>({id:E.id,title:E.viewName||E.description||wb(E.name),description:E.description||"",module:E.module,method:E.method,path:E.path,isActive:E.isActive,viewName:E.viewName,viewModule:E.viewModule})),S={};return b.forEach(E=>{const N=E.module,T=E.viewModule||`${E.module} Management`;S[N]||(S[N]={id:N,name:T,description:`Manage ${T.toLowerCase()} related permissions`,permissions:[]}),S[N].permissions.push({id:E.id,title:E.title,description:E.description,isActive:E.isActive,method:E.method,path:E.path})}),Object.values(S).sort((E,N)=>E.name.localeCompare(N.name))},[l]);return v.useEffect(()=>{c()},[c]),{permissions:e,loading:r,error:n,fetchPermissions:c,getUIPermissions:u,getPermissionGroups:d,isPermissionActive:m,getApiPermission:f,hasPermission:x,hasAnyPermission:p,hasAllPermissions:g,hasModuleAccess:j,getAccessibleModules:w,getUserPermissionGroups:y,userPermissions:l,userRole:o}},eR=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),l=v.useCallback(async()=>{a(!0),i(null);try{const o=await Z3.getPermissionGroups();let c=[];o&&o.data&&Array.isArray(o.data)?c=o.data:Array.isArray(o)&&(c=o);const u=[];c.forEach(d=>{d.permissions&&Array.isArray(d.permissions)&&d.permissions.forEach(m=>{u.push({id:m.code,code:m.code,name:m.name,module:d.featureGroup,viewName:m.name,viewModule:d.featureGroup,isActive:!0})})}),t(u)}catch(o){console.error("Error fetching permission groups from API:",o),i(o),t([])}finally{a(!1)}},[]);return{allPermissions:e,loading:r,error:n,fetchAllPermissions:l}};function $S(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=$S(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function zt(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=$S(e))&&(a&&(a+=" "),a+=t);return a}function tR(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}tR(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Rc=e=>typeof e=="number"&&!isNaN(e),qi=e=>typeof e=="string",Rn=e=>typeof e=="function",rR=e=>qi(e)||Rc(e),zp=e=>qi(e)||Rn(e)?e:null,sR=(e,t)=>e===!1||Rc(e)&&e>0?e:t,$p=e=>v.isValidElement(e)||qi(e)||Rn(e)||Rc(e);function aR(e,t,r=300){let{scrollHeight:a,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}function nR({enter:e,exit:t,appendPosition:r=!1,collapse:a=!0,collapseDuration:n=300}){return function({children:i,position:l,preventExitTransition:o,done:c,nodeRef:u,isIn:d,playToast:m}){let f=r?`${e}--${l}`:e,h=r?`${t}--${l}`:t,x=v.useRef(0);return v.useLayoutEffect(()=>{let p=u.current,g=f.split(" "),j=w=>{w.target===u.current&&(m(),p.removeEventListener("animationend",j),p.removeEventListener("animationcancel",j),x.current===0&&w.type!=="animationcancel"&&p.classList.remove(...g))};p.classList.add(...g),p.addEventListener("animationend",j),p.addEventListener("animationcancel",j)},[]),v.useEffect(()=>{let p=u.current,g=()=>{p.removeEventListener("animationend",g),a?aR(p,c,n):c()};d||(o?g():(x.current=1,p.className+=` ${h}`,p.addEventListener("animationend",g)))},[d]),ne.createElement(ne.Fragment,null,i)}}function Nb(e,t){return{content:US(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function US(e,t,r=!1){return v.isValidElement(e)&&!qi(e.type)?v.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):Rn(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function iR({closeToast:e,theme:t,ariaLabel:r="close"}){return ne.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:a=>{a.stopPropagation(),e(!0)},"aria-label":r},ne.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ne.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function lR({delay:e,isRunning:t,closeToast:r,type:a="default",hide:n,className:i,controlledProgress:l,progress:o,rtl:c,isIn:u,theme:d}){let m=n||l&&o===0,f={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};l&&(f.transform=`scaleX(${o})`);let h=zt("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":c}),x=Rn(i)?i({rtl:c,type:a,defaultClassName:h}):zt(h,i),p={[l&&o>=1?"onTransitionEnd":"onAnimationEnd"]:l&&o<1?null:()=>{u&&r()}};return ne.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},ne.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${a}`}),ne.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:x,style:f,...p}))}var oR=1,WS=()=>`${oR++}`;function cR(e,t,r){let a=1,n=0,i=[],l=[],o=t,c=new Map,u=new Set,d=w=>(u.add(w),()=>u.delete(w)),m=()=>{l=Array.from(c.values()),u.forEach(w=>w())},f=({containerId:w,toastId:y,updateId:b})=>{let S=w?w!==e:e!==1,E=c.has(y)&&b==null;return S||E},h=(w,y)=>{c.forEach(b=>{var S;(y==null||y===b.props.toastId)&&((S=b.toggle)==null||S.call(b,w))})},x=w=>{var y,b;(b=(y=w.props)==null?void 0:y.onClose)==null||b.call(y,w.removalReason),w.isActive=!1},p=w=>{if(w==null)c.forEach(x);else{let y=c.get(w);y&&x(y)}m()},g=()=>{n-=i.length,i=[]},j=w=>{var y,b;let{toastId:S,updateId:E}=w.props,N=E==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(S,w),m(),r(Nb(w,N?"added":"updated")),N&&((b=(y=w.props).onOpen)==null||b.call(y))};return{id:e,props:o,observe:d,toggle:h,removeToast:p,toasts:c,clearQueue:g,buildToast:(w,y)=>{if(f(y))return;let{toastId:b,updateId:S,data:E,staleId:N,delay:T}=y,k=S==null;k&&n++;let I={...o,style:o.toastStyle,key:a++,...Object.fromEntries(Object.entries(y).filter(([A,M])=>M!=null)),toastId:b,updateId:S,data:E,isIn:!1,className:zp(y.className||o.toastClassName),progressClassName:zp(y.progressClassName||o.progressClassName),autoClose:y.isLoading?!1:sR(y.autoClose,o.autoClose),closeToast(A){c.get(b).removalReason=A,p(b)},deleteToast(){let A=c.get(b);if(A!=null){if(r(Nb(A,"removed")),c.delete(b),n--,n<0&&(n=0),i.length>0){j(i.shift());return}m()}}};I.closeButton=o.closeButton,y.closeButton===!1||$p(y.closeButton)?I.closeButton=y.closeButton:y.closeButton===!0&&(I.closeButton=$p(o.closeButton)?o.closeButton:!0);let D={content:w,props:I,staleId:N};o.limit&&o.limit>0&&n>o.limit&&k?i.push(D):Rc(T)?setTimeout(()=>{j(D)},T):j(D)},setProps(w){o=w},setToggle:(w,y)=>{let b=c.get(w);b&&(b.toggle=y)},isToastActive:w=>{var y;return(y=c.get(w))==null?void 0:y.isActive},getSnapshot:()=>l}}var $s=new Map,rc=[],Up=new Set,dR=e=>Up.forEach(t=>t(e)),HS=()=>$s.size>0;function uR(){rc.forEach(e=>GS(e.content,e.options)),rc=[]}var mR=(e,{containerId:t})=>{var r;return(r=$s.get(t||1))==null?void 0:r.toasts.get(e)};function VS(e,t){var r;if(t)return!!((r=$s.get(t))!=null&&r.isToastActive(e));let a=!1;return $s.forEach(n=>{n.isToastActive(e)&&(a=!0)}),a}function fR(e){if(!HS()){rc=rc.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||rR(e))$s.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=$s.get(e.containerId);t?t.removeToast(e.id):$s.forEach(r=>{r.removeToast(e.id)})}}var hR=(e={})=>{$s.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function GS(e,t){$p(e)&&(HS()||rc.push({content:e,options:t}),$s.forEach(r=>{r.buildToast(e,t)}))}function pR(e){var t;(t=$s.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function qS(e,t){$s.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function xR(e){let t=e.containerId||1;return{subscribe(r){let a=cR(t,e,dR);$s.set(t,a);let n=a.observe(r);return uR(),()=>{n(),$s.delete(t)}},setProps(r){var a;(a=$s.get(t))==null||a.setProps(r)},getSnapshot(){var r;return(r=$s.get(t))==null?void 0:r.getSnapshot()}}}function gR(e){return Up.add(e),()=>{Up.delete(e)}}function vR(e){return e&&(qi(e.toastId)||Rc(e.toastId))?e.toastId:WS()}function Fc(e,t){return GS(e,t),t.toastId}function lm(e,t){return{...t,type:t&&t.type||e,toastId:vR(t)}}function om(e){return(t,r)=>Fc(t,lm(e,r))}function te(e,t){return Fc(e,lm("default",t))}te.loading=(e,t)=>Fc(e,lm("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function yR(e,{pending:t,error:r,success:a},n){let i;t&&(i=qi(t)?te.loading(t,n):te.loading(t.render,{...n,...t}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},o=(u,d,m)=>{if(d==null){te.dismiss(i);return}let f={type:u,...l,...n,data:m},h=qi(d)?{render:d}:d;return i?te.update(i,{...f,...h}):te(h.render,{...f,...h}),m},c=Rn(e)?e():e;return c.then(u=>o("success",a,u)).catch(u=>o("error",r,u)),c}te.promise=yR;te.success=om("success");te.info=om("info");te.error=om("error");te.warning=om("warning");te.warn=te.warning;te.dark=(e,t)=>Fc(e,lm("default",{theme:"dark",...t}));function bR(e){fR(e)}te.dismiss=bR;te.clearWaitingQueue=hR;te.isActive=VS;te.update=(e,t={})=>{let r=mR(e,t);if(r){let{props:a,content:n}=r,i={delay:100,...a,...t,toastId:t.toastId||e,updateId:WS()};i.toastId!==e&&(i.staleId=e);let l=i.render||n;delete i.render,Fc(l,i)}};te.done=e=>{te.update(e,{progress:1})};te.onChange=gR;te.play=e=>qS(!0,e);te.pause=e=>qS(!1,e);function jR(e){var t;let{subscribe:r,getSnapshot:a,setProps:n}=v.useRef(xR(e)).current;n(e);let i=(t=v.useSyncExternalStore(r,a,a))==null?void 0:t.slice();function l(o){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>o(u[0],u[1]))}return{getToastToRender:l,isToastActive:VS,count:i?.length}}function wR(e){let[t,r]=v.useState(!1),[a,n]=v.useState(!1),i=v.useRef(null),l=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:m}=e;pR({id:e.toastId,containerId:e.containerId,fn:r}),v.useEffect(()=>{if(e.pauseOnFocusLoss)return f(),()=>{h()}},[e.pauseOnFocusLoss]);function f(){document.hasFocus()||j(),window.addEventListener("focus",g),window.addEventListener("blur",j)}function h(){window.removeEventListener("focus",g),window.removeEventListener("blur",j)}function x(N){if(e.draggable===!0||e.draggable===N.pointerType){w();let T=i.current;l.canCloseOnClick=!0,l.canDrag=!0,T.style.transition="none",e.draggableDirection==="x"?(l.start=N.clientX,l.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(l.start=N.clientY,l.removalDistance=T.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function p(N){let{top:T,bottom:k,left:I,right:D}=i.current.getBoundingClientRect();N.nativeEvent.type!=="touchend"&&e.pauseOnHover&&N.clientX>=I&&N.clientX<=D&&N.clientY>=T&&N.clientY<=k?j():g()}function g(){r(!0)}function j(){r(!1)}function w(){l.didMove=!1,document.addEventListener("pointermove",b),document.addEventListener("pointerup",S)}function y(){document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",S)}function b(N){let T=i.current;if(l.canDrag&&T){l.didMove=!0,t&&j(),e.draggableDirection==="x"?l.delta=N.clientX-l.start:l.delta=N.clientY-l.start,l.start!==N.clientX&&(l.canCloseOnClick=!1);let k=e.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;T.style.transform=`translate3d(${k},0)`,T.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function S(){y();let N=i.current;if(l.canDrag&&l.didMove&&N){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}N.style.transition="transform 0.2s, opacity 0.2s",N.style.removeProperty("transform"),N.style.removeProperty("opacity")}}let E={onPointerDown:x,onPointerUp:p};return o&&c&&(E.onMouseEnter=j,e.stacked||(E.onMouseLeave=g)),m&&(E.onClick=N=>{d&&d(N),l.canCloseOnClick&&u(!0)}),{playToast:g,pauseToast:j,isRunning:t,preventExitTransition:a,toastRef:i,eventHandlers:E}}var NR=typeof window<"u"?v.useLayoutEffect:v.useEffect,cm=({theme:e,type:t,isLoading:r,...a})=>ne.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...a});function SR(e){return ne.createElement(cm,{...e},ne.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function ER(e){return ne.createElement(cm,{...e},ne.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function TR(e){return ne.createElement(cm,{...e},ne.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function CR(e){return ne.createElement(cm,{...e},ne.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function AR(){return ne.createElement("div",{className:"Toastify__spinner"})}var Wp={info:ER,warning:SR,success:TR,error:CR,spinner:AR},_R=e=>e in Wp;function kR({theme:e,type:t,isLoading:r,icon:a}){let n=null,i={theme:e,type:t};return a===!1||(Rn(a)?n=a({...i,isLoading:r}):v.isValidElement(a)?n=v.cloneElement(a,i):r?n=Wp.spinner():_R(t)&&(n=Wp[t](i))),n}var IR=e=>{let{isRunning:t,preventExitTransition:r,toastRef:a,eventHandlers:n,playToast:i}=wR(e),{closeButton:l,children:o,autoClose:c,onClick:u,type:d,hideProgressBar:m,closeToast:f,transition:h,position:x,className:p,style:g,progressClassName:j,updateId:w,role:y,progress:b,rtl:S,toastId:E,deleteToast:N,isIn:T,isLoading:k,closeOnClick:I,theme:D,ariaLabel:A}=e,M=zt("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":S},{"Toastify__toast--close-on-click":I}),G=Rn(p)?p({rtl:S,position:x,type:d,defaultClassName:M}):zt(M,p),q=kR(e),z=!!b||!c,ee={closeToast:f,type:d,theme:D},U=null;return l===!1||(Rn(l)?U=l(ee):v.isValidElement(l)?U=v.cloneElement(l,ee):U=iR(ee)),ne.createElement(h,{isIn:T,done:N,position:x,preventExitTransition:r,nodeRef:a,playToast:i},ne.createElement("div",{id:E,tabIndex:0,onClick:u,"data-in":T,className:G,...n,style:g,ref:a,...T&&{role:y,"aria-label":A}},q!=null&&ne.createElement("div",{className:zt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!k})},q),US(o,e,!t),U,!e.customProgressBar&&ne.createElement(lR,{...w&&!z?{key:`p-${w}`}:{},rtl:S,theme:D,delay:c,isRunning:t,isIn:T,closeToast:f,hide:m,type:d,className:j,controlledProgress:z,progress:b||0})))},DR=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),PR=nR(DR("bounce",!0)),OR={position:"top-right",transition:PR,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function RR(e){let t={...OR,...e},r=e.stacked,[a,n]=v.useState(!0),i=v.useRef(null),{getToastToRender:l,isToastActive:o,count:c}=jR(t),{className:u,style:d,rtl:m,containerId:f,hotKeys:h}=t;function x(g){let j=zt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return Rn(u)?u({position:g,rtl:m,defaultClassName:j}):zt(j,zp(u))}function p(){r&&(n(!0),te.play())}return NR(()=>{var g;if(r){let j=i.current.querySelectorAll('[data-in="true"]'),w=12,y=(g=t.position)==null?void 0:g.includes("top"),b=0,S=0;Array.from(j).reverse().forEach((E,N)=>{let T=E;T.classList.add("Toastify__toast--stacked"),N>0&&(T.dataset.collapsed=`${a}`),T.dataset.pos||(T.dataset.pos=y?"top":"bot");let k=b*(a?.2:1)+(a?0:w*N);T.style.setProperty("--y",`${y?k:k*-1}px`),T.style.setProperty("--g",`${w}`),T.style.setProperty("--s",`${1-(a?S:0)}`),b+=T.offsetHeight,S+=.025})}},[a,c,r]),v.useEffect(()=>{function g(j){var w;let y=i.current;h(j)&&((w=y.querySelector('[tabIndex="0"]'))==null||w.focus(),n(!1),te.pause()),j.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(n(!0),te.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[h]),ne.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(n(!1),te.pause())},onMouseLeave:p,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},l((g,j)=>{let w=j.length?{...d}:{...d,pointerEvents:"none"};return ne.createElement("div",{tabIndex:-1,className:x(g),"data-stacked":r,style:w,key:`c-${g}`},j.map(({content:y,props:b})=>ne.createElement(IR,{...b,stacked:r,collapseAll:p,isIn:o(b.toastId,b.containerId),key:`t-${b.key}`},y)))}))}const dn=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role,lastName:t.headUser.lastName,middleName:t.headUser.middleName,firstName:t.headUser.firstName}:null,status:t.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),lg=(e=!0,t="all")=>{const[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState(""),[f,h]=v.useState({type:"",status:""}),[x,p]=v.useState({key:null,direction:"asc"}),[g,j]=v.useState([]);v.useEffect(()=>{if(!e)return;(async()=>{o(!0),u(null);try{let U;if(t==="my"){const oe=await Ht.getMyDepartment();U=oe&&Object.keys(oe).length>0?[oe]:[]}else U=await Ht.getDepartments();Array.isArray(U)||(console.error("Expected array but got:",typeof U,U),U=[]);const X=dn(U);a(X)}catch(U){console.error("Error loading departments:",U);const X=U?.response?.data?.message||U?.message||"Failed to load departments";u(X),a([])}finally{o(!1)}})()},[e,t]),v.useEffect(()=>{let ee=r;d&&(ee=ee.filter(U=>U.name.toLowerCase().includes(d.toLowerCase())||U.code.toLowerCase().includes(d.toLowerCase())||U.description.toLowerCase().includes(d.toLowerCase()))),f.type&&(ee=ee.filter(U=>U.type===f.type)),f.status&&(ee=ee.filter(U=>U.status===f.status)),i(ee)},[r,d,f]);const w=ee=>{let U="asc";x.key===ee&&x.direction==="asc"&&(U="desc"),p({key:ee,direction:U});const X=[...n].sort((oe,Ee)=>oe[ee]<Ee[ee]?U==="asc"?-1:1:oe[ee]>Ee[ee]?U==="asc"?1:-1:0);i(X)},y=async ee=>{o(!0),u(null);try{const U=await Ht.createDepartment(ee),X=await Ht.getDepartments(),oe=dn(X);return a(oe),U}catch(U){throw console.error("Error creating department:",U),u("Failed to create department"),U}finally{o(!1)}},b=async(ee,U)=>{o(!0),u(null);try{const X=await Ht.updateDepartment(ee,U),oe=await Ht.getDepartments(),Ee=dn(oe);return a(Ee),X}catch(X){throw console.error("Error updating department:",X),u("Failed to update department"),X}finally{o(!1)}},S=async ee=>{o(!0),u(null);try{await Ht.deleteDepartment(ee);const U=await Ht.getDepartments(),X=dn(U);a(X)}catch(U){throw console.error("Error deleting department:",U),u("Failed to delete department"),U}finally{o(!1)}},E=async ee=>{o(!0),u(null);try{await Ht.toggleDepartmentStatus(ee);const U=await Ht.getDepartments(),X=dn(U);a(X)}catch(U){throw console.error("Error toggling department status:",U),te.error("Failed to toggle department status"),U}finally{o(!1)}},N=async ee=>{o(!0),u(null);try{await Ht.disableDepartment(ee);const U=await Ht.getDepartments(),X=dn(U);a(X)}catch(U){throw console.error("Error disabling department:",U),te.error("Failed to disable department"),U}finally{o(!1)}},T=async ee=>{o(!0),u(null);try{await Ht.enableDepartment(ee);const U=await Ht.getDepartments(),X=dn(U);a(X)}catch(U){throw console.error("Error enabling department:",U),te.error("Failed to enable department"),U}finally{o(!1)}},k=async ee=>{o(!0),u(null);try{await Ht.bulkDeleteDepartments(ee);const U=await Ht.getDepartments(),X=dn(U);a(X),j([])}catch(U){throw console.error("Error bulk deleting departments:",U),te.error("Failed to delete departments"),U}finally{o(!1)}},I=async(ee,U)=>{o(!0),u(null);try{await Ht.bulkToggleStatus(ee,U);const X=await Ht.getDepartments(),oe=dn(X);a(oe),j([])}catch(X){throw console.error("Error bulk toggling department status:",X),te.error("Failed to update department status"),X}finally{o(!1)}},D=ee=>{j(U=>U.includes(ee)?U.filter(X=>X!==ee):[...U,ee])},A=()=>{g.length===n.length?j([]):j(n.map(ee=>ee.id))},M=(ee,U)=>{h(X=>({...X,[ee]:U}))},G=()=>{h({type:"",status:""}),m("")},q=v.useCallback(async()=>{try{const ee=await Ht.getDepartmentHeads();console.log(" Raw API response:",ee);const U=ee?.data?.users||ee?.users||[];return console.log(" Extracted users:",U),U}catch(ee){return console.error(" Error fetching department heads:",ee),te.error("Failed to load department heads"),[]}},[]);return{departments:n,selectedDepartments:g,loading:l,error:c,searchTerm:d,setSearchTerm:m,filters:f,sortConfig:x,createDepartment:y,updateDepartment:b,deleteDepartment:S,toggleDepartmentStatus:E,disableDepartment:N,enableDepartment:T,bulkDeleteDepartments:k,bulkToggleStatus:I,sortDepartments:w,handleSelectDepartment:D,handleSelectAll:A,handleFilterChange:M,clearFilters:G,getAvailableUsers:q,refreshDepartments:async()=>{o(!0),u(null);try{const ee=await Ht.getDepartments(),U=dn(ee);a(U)}catch(ee){console.error("Error refreshing departments:",ee),u("Failed to refresh departments")}finally{o(!1)}},setError:u}},De={VIEW_ALL_USERS:"PERM-003",VIEW_USER_DETAILS:"PERM-004",UPDATE_USER:"PERM-005",CREATE_ROLE:"PERM-007",VIEW_ALL_ROLES:"PERM-008",UPDATE_ROLE:"PERM-009",CREATE_DEPARTMENT:"PERM-011",VIEW_ALL_DEPARTMENTS:"PERM-012",VIEW_DEPARTMENT_DETAILS:"PERM-013",UPDATE_DEPARTMENT:"PERM-014",CREATE_COURSE:"PERM-016",VIEW_ALL_COURSES:"PERM-017",VIEW_COURSE_DETAILS:"PERM-018",UPDATE_COURSE:"PERM-019",ARCHIVE_COURSE:"PERM-020",ASSIGN_TRAINERS:"PERM-021",REMOVE_TRAINERS:"PERM-022",CREATE_BULK_SUBJECTS:"PERM-023",CREATE_SUBJECT:"PERM-024",VIEW_SUBJECT_DETAILS:"PERM-026",UPDATE_SUBJECT:"PERM-027",ARCHIVE_SUBJECT:"PERM-028",BULK_ENROLL_TRAINEES:"PERM-029",ENROLL_SINGLE_TRAINEE:"PERM-030",VIEW_ALL_ENROLLMENTS:"PERM-031",REMOVE_TRAINEE_FROM_ENROLLMENT:"PERM-032",CREATE_TEMPLATE:"PERM-033",EDIT_DRAFT_TEMPLATE:"PERM-034",DELETE_DRAFT_TEMPLATE:"PERM-036",UPDATE_TEMPLATE_VERSION:"PERM-037",UPDATE_TEMPLATE_STATUS:"PERM-038",APPROVE_DENY_TEMPLATE:"PERM-039",VIEW_ALL_TEMPLATE:"PERM-040",VIEW_TEMPLATE_DETAILS:"PERM-041",DOWNLOAD_TEMPLATE_AS_PDF:"PERM-042",VIEW_ALL_INCIDENT_FEEDBACK_REPORT:"PERM-043",VIEW_INCIDENT_FEEDBACK_REPORT_DETAILS:"PERM-044",VIEW_SUBMITTED_REPORTS:"PERM-045",SUBMIT_INCIDENT_FEEDBACK_REPORT:"PERM-046",ACKNOWLEDGE_INCIDENT_REPORTS:"PERM-048",CREATE_GLOBAL_FIELD:"PERM-050",VIEW_ALL_GLOBAL_FIELDS:"PERM-051",VIEW_GLOBAL_FIELD_DETAILS:"PERM-052",UPDATE_GLOBAL_FIELD:"PERM-053",DISABLE_ENABLE_GLOBAL_FIELD:"PERM-054"},FR={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD"},LR=e=>{if(!e)return null;const t=typeof e=="string"?e:e?.name||"";if(!t)return null;const r=t.toUpperCase().replace(/\s+/g,"_").trim();return FR[r]||r},og=(e,t=[])=>{if(!t||t.length===0)return!0;const r=LR(e?.role);return r?t.some(a=>a===r):!1},MR=[{id:"main-menu",label:"Main Menu",path:Pe.MAIN_MENU,icon:"list",roleOnly:["ADMINISTRATOR"]},{id:"users",label:"Users",path:Pe.USERS,icon:"people",permissions:[De.VIEW_ALL_USERS]},{id:"roles",label:"Roles",path:Pe.ROLES,icon:"shield",permissions:[De.VIEW_ALL_ROLES]},{id:"departments",label:"Departments",path:Pe.DEPARTMENTS,icon:"building",permissions:[De.VIEW_ALL_DEPARTMENTS,De.UPDATE_DEPARTMENT],requireAll:!0},{id:"forms",label:"Templates",path:Pe.TEMPLATES,icon:"fileText",customPermissionLogic:e=>e(De.VIEW_ALL_TEMPLATE)},{id:"system-config",label:"Global Fields",path:Pe.SYSTEM_CONFIG,icon:"gear",permissions:[De.VIEW_ALL_GLOBAL_FIELDS]},{id:"academic-dashboard",label:"Academic Dashboard",path:"/academic/dashboard",icon:"house",roleOnly:["ACADEMIC_DEPARTMENT"]},{id:"trainee-dashboard",label:"Trainee Dashboard",path:"/trainee/dashboard",icon:"house",roleOnly:["TRAINEE"]},{id:"enrolled-courses",label:"Enrolled Courses",path:Pe.COURSES_ENROLLED,icon:"book",roleOnly:["TRAINEE"]},{id:"all-assessments",label:"All Assessment Events",path:Pe.ASSESSMENTS_MY_ASSESSMENTS,icon:"checkCircle",roleOnly:["TRAINEE"],children:[{id:"your-assessments",label:"Your Assessment Events",path:Pe.ASSESSMENTS_MY_ASSESSMENTS,roleOnly:["TRAINEE"]},{id:"signature-required",label:"Signature Required Forms",path:Pe.ASSESSMENTS_SIGNATURE_REQUIRED,roleOnly:["TRAINEE"]}]},{id:"create-issue",label:"Issue Reporting",path:Pe.REPORTS_CREATE,icon:"fileEarmarkText",permissions:[De.VIEW_SUBMITTED_REPORTS]},{id:"assigned-assessments",label:"Assigned Assessment Events",path:Pe.ASSESSMENTS_UPCOMING,icon:"clock",roleOnly:["TRAINER"]},{id:"instructed-courses",label:"Assigned Courses",path:Pe.COURSES_INSTRUCTED,icon:"book",roleOnly:["TRAINER"]},{id:"department-dashboard",label:"Department Dashboard",path:"/department-head/dashboard",icon:"building",roleOnly:["DEPARTMENT_HEAD"]},{id:"assessment-review-requests",label:"Assessment Review Requests",path:Pe.DEPARTMENT_REVIEW_REQUESTS,icon:"clipboardCheck",roleOnly:["DEPARTMENT_HEAD"]},{id:"incidents-feedback",label:"Incidents / Feedback Reports",path:Pe.REPORTS,icon:"exclamationTriangle",permissions:[De.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,De.ACKNOWLEDGE_INCIDENT_REPORTS],requireAll:!0}],BR=(e,t)=>!e.permissions||e.permissions.length===0?!0:e.requireAll?e.permissions.every(r=>t(r)):e.permissions.some(r=>t(r)),zR=(e,t)=>!e.excludePermissions||e.excludePermissions.length===0?!1:e.excludePermissions.some(r=>t(r)),KS=(e,t,r)=>e.reduce((a,n)=>{if(n.roleOnly&&!og(t,n.roleOnly)||zR(n,r))return a;let i;n.customPermissionLogic?i=n.customPermissionLogic(r):i=BR(n,r);let l=[];return n.children&&n.children.length>0&&(l=KS(n.children,t,r)),(i||l.length>0||!n.permissions&&!n.customPermissionLogic&&(!n.children||n.children.length===0))&&a.push({...n,children:l}),a},[]),YS=(e,t)=>KS(MR,e,t),$R=(e,t,r=Pe.DASHBOARD)=>{if(!e)return r;const a=YS(e,t);return a.length===0?r:a[0].path||r},UR=e=>og(e,["ACADEMIC_DEPARTMENT"]),XS=e=>og(e,["DEPARTMENT_HEAD"]),Sb=({collapsed:e,onClose:t})=>{const{hasPermission:r}=ln(),{user:a}=Rr(),n=na(),i=ft(),l=v.useMemo(()=>UR(a),[a]),o=v.useMemo(()=>{const y=r(De.VIEW_ALL_DEPARTMENTS),b=r(De.UPDATE_DEPARTMENT),S=r(De.VIEW_DEPARTMENT_DETAILS);return y&&!b?{show:!0,mode:"all"}:S&&!y?{show:!0,mode:"my"}:{show:!1,mode:null}},[r]),{departments:c,loading:u}=lg(o.show,o.mode),[d,m]=v.useState(!1),[f,h]=v.useState(null),[x,p]=v.useState(!1),g=v.useRef(null);v.useEffect(()=>{if(g.current&&d){const y=g.current,b=y.scrollHeight>y.clientHeight;p(b)}},[d,c]);const j=v.useMemo(()=>YS(a,r),[a,r]),w=v.useMemo(()=>({list:tu,people:Vs,shield:tg,building:Ws,fileText:gt,gear:tm,house:Q2,personCheck:On,clock:rt,book:$t,clipboardCheck:Zt,exclamationTriangle:Gt,checkCircle:it,fileEarmarkText:_c}),[]);return s.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"fixed",top:0,left:0,height:"100vh",overflowY:"hidden",overflowX:"hidden",zIndex:t?1051:1e3,flexShrink:0,pointerEvents:"auto"},onClick:y=>{y.stopPropagation()},children:[s.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",style:{zIndex:1},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&s.jsx(s.Fragment,{children:s.jsx("img",{src:bO,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&s.jsx("div",{children:s.jsx(Yx,{size:24})})]}),t&&s.jsx(ae,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-lg-none",onClick:y=>{y.preventDefault(),y.stopPropagation(),t&&t()},onTouchEnd:y=>{y.preventDefault(),y.stopPropagation(),t&&t()},style:{border:"none",background:"transparent",zIndex:1052,minWidth:"40px",minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",pointerEvents:"auto"},"aria-label":"Close sidebar",children:s.jsx(ht,{size:24})})]}),s.jsxs(Ye,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[j.map(y=>{const b=w[y.icon]||tu,S=y.children?.some(k=>n.pathname===k.path),E=n.pathname===y.path||S,N=y.children&&y.children.length>0,T=f===y.id;return N?s.jsx(Ye.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${E?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:E?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(i(y.path),t&&t()):h(k=>k===y.id?null:y.id)},children:[s.jsx(b,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:y.label}),s.jsx(sn,{size:16,className:`ms-auto transition-transform ${T?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&T&&y.children?.length>0&&s.jsx("div",{className:"mt-2 ms-4",children:y.children.map(k=>s.jsx(dd,{to:k.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:n.pathname===k.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",overflowWrap:"break-word"},onClick:()=>{t&&t()},children:s.jsx("span",{className:"sidebar-nav-label",children:k.label})},k.id))})]})},y.id):s.jsx(Ye.Item,{className:"mb-3",children:s.jsxs(dd,{to:y.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${E?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:E?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t&&t()},children:[s.jsx(b,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:y.label})]})},y.id)}),l&&s.jsx(Ye.Item,{className:"mb-3",children:s.jsxs(dd,{to:Pe.ASSESSMENT_EVENTS,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${n.pathname===Pe.ASSESSMENT_EVENTS?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:n.pathname===Pe.ASSESSMENT_EVENTS?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t&&t()},children:[s.jsx(va,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:"Assessment Event"})]})}),o.show&&s.jsx(Ye.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${n.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:n.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(c.length===1?i(`/academic/course/${c[0].id}`):i("/academic/departments"),t&&t()):c.length===1?i(`/academic/course/${c[0].id}`):(m(!d),i("/academic/departments"))},children:[s.jsx(Ws,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{c.length===1?i(`/academic/course/${c[0].id}`):(m(!d),i("/academic/departments"))},children:c.length===1?"My Department":"Departments"}),c.length>1&&s.jsx(sn,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:d?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{m(!d)}})]})]}),!e&&d&&c.length>1&&s.jsx("div",{ref:g,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${x?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:u?s.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:s.jsx("small",{children:"Loading departments..."})}):c.length>0?c.map(y=>s.jsxs(dd,{to:`/academic/course/${y.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${n.pathname===`/academic/course/${y.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:n.pathname===`/academic/course/${y.id}`?"rgba(255, 255, 255, 0.15)":"transparent",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[s.jsx(Ac,{size:12,className:"me-2 sidebar-department-chevron"}),y.code]},y.id)):s.jsx("div",{className:"px-3 py-2 text-white-50",children:s.jsx("small",{children:"No departments found"})})})]})})]})]})},xn={getProfile:async()=>{try{const e=await Se.get("/profile");return e.data&&e.data.data?e.data.data:e.data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async e=>{try{const t=new FormData;t.append("avatar",e);const r=await Se.put("/profile",t,{headers:{"Content-Type":"multipart/form-data"}});return r.data&&r.data.data?r.data.data:r.data}catch(t){throw console.error("Error updating avatar:",t),t}},updateProfile:async e=>{try{const t=new FormData;e instanceof File?t.append("avatar",e):typeof e=="object"&&e!==null&&Object.keys(e).forEach(a=>{const n=e[a];n!=null&&t.append(a,n)}),console.log("updateProfile - sending FormData with keys:",Array.from(t.keys()));const r=await Se.put("/profile",t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("updateProfile - response:",r.data),r.data&&r.data.data?r.data.data:r.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Se.put("/profile/reset-password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}},updateSignature:async e=>{try{const t=await Se.put("/profile/signature",{signatureImageUrl:e});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw console.error("Error updating signature:",t),t}}},WR=()=>{const[e,t]=v.useState(null),[r,a]=v.useState(!0),[n,i]=v.useState(null),l=async()=>{try{a(!0),i(null);const d=await xn.getProfile();t(d)}catch(d){console.error("Error fetching profile:",d),i(d.message||"Failed to fetch profile")}finally{a(!1)}},o=async d=>{try{a(!0),i(null);const m=await xn.updateProfile(d);return t(m),m}catch(m){throw console.error("Error updating profile:",m),i(m.message||"Failed to update profile"),m}finally{a(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:d,lastName:m,middleName:f}=e,h=[];return m&&h.push(m),f&&h.push(f),d&&h.push(d),h.join(" ")||"User"},u=()=>e?.role?e.role.name:"User";return v.useEffect(()=>{l()},[]),{profile:e,loading:r,error:n,fetchProfile:l,updateProfile:o,getDisplayName:c,getRoleName:u}},HR={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},VR=({onToggleSidebar:e})=>{const t=na(),r=ft(),[a,n]=v.useState(!1),[i,l]=v.useState(!1),o=v.useRef(null),{user:c,isLoading:u}=Rr(),{profile:d,getDisplayName:m,loading:f}=WR(),h=()=>{if(!c||f)return"Loading...";if(d&&m&&m()&&m()!=="Loading..."){const b=m();if(b&&b.trim()!=="")return b}if(d&&d.firstName){const b=[];d.lastName&&b.push(d.lastName),d.middleName&&b.push(d.middleName),d.firstName&&b.push(d.firstName);const S=b.join(" ").trim();if(S)return S}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.lastName}${c.middleName?" "+c.middleName:""} ${c.firstName}`;try{const b=localStorage.getItem("authToken");if(b){const S=JSON.parse(atob(b.split(".")[1]));if(S.fullName&&S.fullName!=="User")return S.fullName;if(S.name&&S.name!=="User")return S.name;if(S.firstName&&S.lastName)return`${S.lastName}${S.middleName?" "+S.middleName:""} ${S.firstName}`}}catch(b){console.error("Error parsing JWT token for display name:",b)}return c.name||"User"},x=()=>c&&c.email||"No email",p=b=>{const S=LS(b),E={"/profile":"Profile","/dashboard":"Dashboard","/users":"Users","/roles":"Roles","/departments":"Departments","/templates":"Templates","/templates/editor":"Template Editor","/templates/drafts":"Draft Templates","/main-menu":"Main Menu","/system-config":"Global Fields","/courses/instructed":"Assigned Courses","/courses/enrolled":"Enrolled Courses","/assessments/upcoming":"Upcoming Assessment Events","/assessments/my-assessments":"Your Assessment Events","/assessments/results":"Assessment Results","/assessments/signature-required":"Signature Required Forms","/assessments/completion-required":"Completion Required Forms","/assessment-events":"Assessment Events","/reports":"Incidents / Feedback Reports","/reports/create":"Incidents / Feedback Reports","/reports/issues":"Incidents / Feedback Reports","/reports/feedback":"Incidents / Feedback Reports","/reports/:reportId":"Report Details","/configure-signature":"Configure Signature","/my-department-details":"My Department Details","/assessment-review-requests":"Assessment Review Requests","/academic-details":"Academic Details","/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"Users","/admin/roles":"Roles","/admin/departments":"Departments","/admin/forms":"Templates","/admin/forms/drafts":"Your Drafts","/admin/main-menu":"Main Menu","/admin/system-config":"Global Fields","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/assessment-events":"Assessment Events","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Courses","/trainee/signature-required":"Signature Required Sections","/trainee/completion-required":"Completion Required Sections","/trainee/your-assessments":"Your Assessment Events","/trainee/create-incident-feedback-report":"Issue Reporting","/trainee/assessment-pending/section-completion":"Completion Required Sections","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessment Events","/trainer/assessment-results":"Assessment Results","/trainer/assess":"Assessment Events","/trainer/assessments":"Assessment Form Sections","/trainer/instructed-courses":"Assigned Courses","/trainer/courses":"Courses","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue Reports","/sqa/issues":"Issue Reports","/sqa/feedback":"Feedback Reports","/sqa/templates":"Templates","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview","/department-head":"Department Dashboard","/department-head/dashboard":"Department Dashboard","/department-head/my-department-details":"My Department Details","/department-head/assessment-review-requests":"Assessment Review Requests"};return b.startsWith("/department-head/my-department-details/")&&b!=="/department-head/my-department-details"&&!b.includes("/subjects/")?"Course Details":b.startsWith("/admin/departments/")&&b!=="/admin/departments"?"Department Details":b.startsWith("/academic/departments/")&&b!=="/academic/departments"?"Department Management":b.includes("/enroll-trainees")?"Trainee Enrollments":b.startsWith("/academic/course/")&&!b.includes("/subject/")?"Department Details":b.startsWith("/academic/course-detail/")?"Course Details":b.includes("/subject/")?"Subject Details":b.includes("/enroll-trainees")?"Enroll Trainees":b.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Enrolled Course Details":b.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Enrolled Subject Details":b.startsWith("/templates/editor")||b.startsWith("/admin/forms/editor")?"Template Editor":b.match(/^\/trainee\/[^/]+\/assessment\/[^/]+$/)||b.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":b.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":b.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":b.match(/^\/courses\/[^/]+$/)&&!b.includes("/enroll-trainees")&&!b.includes("/subjects/")?"My Courses":b.match(/^\/assessments\/assign\/[^/]+\/[^/]+$/)?"Assessment Events":b.match(/^\/assessments\/[^/]+\/sections$/)?"Assessment Sections":b.match(/^\/assessments\/sections\/[^/]+\/fields$/)?"Section Details":b.match(/^\/courses\/[^/]+\/enroll-trainees$/)?"Trainee Enrollments":b.match(/^\/courses\/[^/]+\/subjects\/[^/]+$/)?"Subject Details":b.match(/^\/departments\/[^/]+$/)?"Department Details":b.match(/^\/my-department-details\/[^/]+$/)&&!b.includes("/subjects/")?"Course Details":b.match(/^\/assessment-review-requests\/events\/[^/]+$/)?"Assessment Event Details":b.match(/^\/assessment-review-requests\/[^/]+$/)?"Assessment Review Request Details":b.match(/^\/reports\/[^/]+$/)&&b!=="/reports"&&b!=="/reports/create"?"Report Details":b.match(/^\/templates\/[^/]+$/)&&b!=="/templates"&&!b.startsWith("/templates/editor")&&!b.startsWith("/templates/drafts")||b.startsWith("/sqa/templates/")&&b!=="/sqa/templates"?"Template Detail":b.startsWith("/trainer/trainees/")?"Trainee Details":b.startsWith("/trainer/subjects/")?"Subject Details":b.startsWith("/trainer/courses/")?"Course Details":b.startsWith("/trainer/assessment-details/")?"Assessment Result Details":b.match(/^\/trainer\/assessments\/sections\/[^/]+\/fields$/)?"Section Details":b.startsWith("/trainer/assessments/")?"Assessment Sections":b.startsWith("/trainer/assess/")?"Assessments":b.startsWith("/trainer/approval-notes/")?"Result Approval Note":b.includes("/department-head/courses/")&&b.includes("/subjects/")?"Subject Details":b.startsWith("/department-head/trainees/")||b.startsWith("/trainee/")&&b!=="/trainee"&&!b.startsWith("/trainee/dashboard")&&!b.startsWith("/trainee/academic-details")&&!b.startsWith("/trainee/enrolled-courses")&&!b.startsWith("/trainee/assessment-pending")&&!b.startsWith("/trainee/create-incident-feedback-report")&&!b.startsWith("/trainee/signature-required")&&!b.startsWith("/trainee/completion-required")&&!b.startsWith("/trainee/your-assessments")?"Trainee Details":E[S]||E[b]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const b=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=b()},j=()=>{n(!a)},w=()=>{n(!1)},y=()=>{r("/profile"),n(!1)};return v.useEffect(()=>{const b=S=>{o.current&&!o.current.contains(S.target)&&l(!1)};return i&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[i]),s.jsxs(s.Fragment,{children:[s.jsx(Qy,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:s.jsxs("div",{className:"container-fluid",children:[s.jsx(ae,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:s.jsx(tu,{size:20})}),s.jsx(Qy.Brand,{className:"text-primary-custom fw-bold custom-title",children:p(t.pathname)}),s.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:s.jsxs("div",{ref:o,style:{position:"relative"},children:[s.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>l(!i),children:[s.jsx(Tl,{size:32,className:"me-2"}),s.jsx("span",{children:u||f?"Loading...":h()})]}),s.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:HR,children:[s.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:u||f?"Loading...":h()}),s.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:u?"Loading...":x()})]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),y()},children:[s.jsx(Tl,{className:"me-2",size:16}),"Profile"]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),g()},children:[s.jsx(v0,{className:"me-2",size:16}),"Logout"]})]})]})}),s.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:j,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:s.jsx(Tl,{size:32})})]})}),a&&s.jsx("div",{className:`profile-menu-overlay ${a?"show":""}`,onClick:w}),s.jsxs("div",{className:`profile-menu-slide ${a?"show":""}`,children:[s.jsxs("div",{className:"profile-menu-header",children:[s.jsx("button",{className:"profile-menu-close",onClick:w,"aria-label":"Close profile menu",children:s.jsx(ht,{size:20})}),s.jsx("div",{className:"profile-avatar",children:s.jsx(Tl,{size:40})}),s.jsx("div",{className:"profile-name",children:u||f?"Loading...":h()}),s.jsx("div",{className:"profile-email",children:u?"Loading...":x()})]}),s.jsxs("ul",{className:"profile-menu-items",children:[s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link",onClick:b=>{b.preventDefault(),y()},children:[s.jsx(Tl,{className:"icon"}),"Profile"]})}),s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:b=>{b.preventDefault(),w(),g()},children:[s.jsx(v0,{className:"icon"}),"Logout"]})})]})]})]})},GR=({children:e})=>{const[t,r]=v.useState(()=>{try{const u=localStorage.getItem("sidebarCollapsed");return u?u==="true":!1}catch{return!1}}),[a,n]=v.useState(!1),[i,l]=v.useState(!1);v.useEffect(()=>{a&&console.log(" Sidebar state:",{isMobile:a,sidebarOpen:i})},[a,i]),v.useEffect(()=>{const u=()=>{const d=window.innerWidth<=768;n(d),!d&&i&&l(!1)};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[i]),v.useEffect(()=>{try{localStorage.setItem("sidebarCollapsed",t)}catch{}},[t]);const o=()=>{a?l(!i):r(!t)},c=v.useCallback(()=>{console.log(" closeSidebar called",{isMobile:a,sidebarOpen:i}),a&&(console.log(" Setting sidebarOpen to false"),l(!1))},[a,i]);return s.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[s.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:s.jsx(Sb,{collapsed:t})}),a&&s.jsxs(s.Fragment,{children:[i&&s.jsx("div",{className:"sidebar-mobile-overlay",onClick:u=>{u.preventDefault(),u.stopPropagation(),c()},onTouchEnd:u=>{u.preventDefault(),u.stopPropagation(),c()},style:{cursor:"pointer"}}),s.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,onClick:u=>{u.stopPropagation()},children:i&&s.jsx(Sb,{collapsed:!1,onClose:c})})]}),s.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${a?"main-content-mobile":""} ${!a&&t?"sidebar-collapsed-active":""}`,style:{marginLeft:a?"0":t?"60px":"260px",transition:"margin-left 0.3s ease",width:a?"100%":`calc(100% - ${t?"60px":"260px"})`},children:[s.jsx(VR,{onToggleSidebar:o}),s.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},Ut=()=>s.jsx(GR,{children:s.jsx(q5,{})}),ts=(e,t=null,r="asc")=>{const[a,n]=v.useState({key:t,direction:r});return{sortedData:v.useMemo(()=>e?a.key?[...e].sort((u,d)=>{let m=u[a.key],f=d[a.key];if(a.key.includes(".")){const h=a.key.split(".");m=h.reduce((x,p)=>x?.[p],u),f=h.reduce((x,p)=>x?.[p],d)}if(a.key.includes("length")){const h=a.key.replace(".length","");m=u[h]?.length||0,f=d[h]?.length||0}return typeof m=="string"&&typeof f=="string"&&(m=m.toLowerCase(),f=f.toLowerCase()),m<f?a.direction==="asc"?-1:1:m>f?a.direction==="asc"?1:-1:0}):[...e]:[],[e,a]),sortConfig:a,handleSort:u=>{let d="asc";if(a.key===u&&a.direction==="asc")d="desc";else if(a.key===u&&a.direction==="desc"){n({key:null,direction:"asc"});return}n({key:u,direction:d})},getSortIcon:u=>a.key!==u?"":a.direction==="asc"?"":"",getSortClass:u=>a.key!==u?"text-muted":(a.direction==="asc","text-primary")}},JS=({data:e,loading:t,columns:r,renderRow:a,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:l,sortConfig:o,handleSort:c}=ts(e);if(t)return s.jsx(Fr,{rows:5,columns:r.length});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:n}),s.jsx("p",{children:i})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=o.key===d,x=h?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:x,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsx("tr",{children:r.map((d,m)=>d.sortable?s.jsx(u,{columnKey:d.key,className:d.className||"",children:d.title},m):s.jsx("th",{className:`fw-semibold ${d.className||""}`,style:{textTransform:"uppercase",letterSpacing:"0.5px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:d.title},m))})}),s.jsx("tbody",{children:l.map((d,m)=>a(d,m))})]})})},qR=({children:e})=>s.jsx(J3,{children:e}),Ot=()=>{const e=K5(),t=ft(),a=(l=>l?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:l?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:l?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return s.jsx(Be,{fluid:!0,className:"py-5",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:s.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"display-1 text-muted",children:""}),s.jsx("h2",{className:"text-primary-custom mb-3",children:a.title}),s.jsx("p",{className:"text-muted mb-4",children:a.message}),s.jsx("p",{className:"small text-muted",children:a.suggestion})]}),s.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[s.jsx(ae,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),s.jsx(ae,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},KR=({title:e="Filter",options:t=[],selectedValue:r,onSelect:a,className:n="",variant:i="outline-secondary"})=>{const l=t.find(o=>o.value===r);return s.jsxs(Ct,{className:n,children:[s.jsxs(Ct.Toggle,{variant:i,className:"d-flex align-items-center",style:{borderColor:"var(--bs-neutral)",color:r?"var(--bs-primary)":"var(--bs-secondary)"},children:[s.jsx(ll,{className:"me-2",size:16}),l?l.label:e]}),s.jsxs(Ct.Menu,{className:"border-0 shadow",children:[s.jsxs(Ct.Item,{onClick:()=>a(""),className:r?"":"text-primary-custom bg-light",children:["All ",e]}),s.jsx(Ct.Divider,{}),t.map(o=>s.jsx(Ct.Item,{onClick:()=>a(o.value),className:r===o.value?"text-primary-custom bg-light":"",children:o.label},o.value))]})]})},Fr=({rows:e=5,columns:t=4})=>{const r=()=>s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("td",{children:s.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:s.jsx("span",{className:"placeholder col-12"})})},n))});return s.jsxs(Y,{className:"border-neutral-200",children:[s.jsx(Y.Header,{className:"bg-light-custom border-neutral-200",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})}),s.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"bg-neutral-50",children:s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("th",{className:"border-neutral-200",children:s.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})},n))})}),s.jsx("tbody",{children:Array.from({length:e}).map((a,n)=>s.jsx(r,{},n))})]})})})]})},Qt=({permission:e,permissions:t=[],requireAll:r=!1,children:a,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:l,hasAllPermissions:o}=ln(),{user:c}=Rr();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?o(t):l(t):!1)?a:s.jsxs("div",{className:"p-4 text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to access this page."}),s.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),s.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},Nt=({permission:e,permissions:t=[],requireAll:r=!1,children:a,fallback:n=null,showMessage:i=!1,message:l="You do not have permission to access this feature."})=>{const{hasPermission:o,hasAnyPermission:c,hasAllPermissions:u}=ln();return(()=>{if(!e&&(!t||t.length===0))return!0;if(e)return o(e);if(t&&t.length>0){const m=t.filter(f=>f&&typeof f=="string");return m.length===0?!0:r?u(m):c(m)}return!1})()?a:n||(i?s.jsxs(Ue,{variant:"warning",className:"mt-3",children:[s.jsx(Ue.Heading,{children:"Access Denied"}),s.jsx("p",{children:l})]}):null)},ia=({trigger:e,items:t=[],align:r="end",className:a="",onItemClick:n,placement:i="bottom-end",disabled:l=!1,...o})=>{const[c,u]=v.useState(!1),[d,m]=v.useState({top:0,left:0}),f=v.useRef(null),h=v.useRef(null),x=()=>{if(!f.current)return;const y=f.current.getBoundingClientRect(),b=200,S=150,E=4;let N,T;switch(i){case"bottom-start":N=y.bottom+E,T=y.left;break;case"bottom-end":N=y.bottom+E,T=y.right-b;break;case"top-start":N=y.top-S-E,T=y.left;break;case"top-end":N=y.top-S-E,T=y.right-b;break;default:N=y.bottom+E,T=y.right-b}N+S>window.innerHeight&&(N=y.top-S-E),N<0&&(N=E),T+b>window.innerWidth&&(T=window.innerWidth-b-E),T<0&&(T=E),m({top:N,left:T})},p=y=>{y.preventDefault(),y.stopPropagation(),!l&&(c||x(),u(!c))},g=()=>{u(!1)},j=y=>{y.onClick&&y.onClick(),n&&n(y),g()};v.useEffect(()=>{const y=S=>{c&&f.current&&!f.current.contains(S.target)&&h.current&&!h.current.contains(S.target)&&g()},b=S=>{S.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",y),document.addEventListener("keydown",b),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",y),document.removeEventListener("keydown",b),document.body.style.overflow=""}},[c]),v.useEffect(()=>{if(c){const y=()=>x(),b=()=>x();return window.addEventListener("scroll",y,!0),window.addEventListener("resize",b),()=>{window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",b)}}},[c,i]);const w=c&&qx.createPortal(s.jsx("div",{ref:h,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:d.top,left:d.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((y,b)=>y.type==="header"?s.jsx("div",{className:`dropdown-header ${y.className||""}`,children:y.content},b):y.type==="divider"?s.jsx("div",{className:"dropdown-divider"},b):s.jsxs("button",{onClick:()=>j(y),className:`dropdown-item ${y.className||""}`,disabled:y.disabled,children:[y.icon&&s.jsx("span",{className:"me-2",children:y.icon}),y.label]},b))}),document.body);return s.jsxs("div",{className:`dropdown ${a}`,children:[s.jsx("button",{ref:f,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:p,disabled:l,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),w]})},Wt=({children:e})=>{const{isAuthenticated:t,isLoading:r}=Rr();return na(),r?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})}):t?e:s.jsx(Y5,{to:"/",replace:!0})},ra=({placeholder:e="Search...",value:t,onChange:r,className:a="",size:n="md"})=>s.jsxs(eb,{className:a,size:n,children:[s.jsx(eb.Text,{className:"bg-white border-end-0",children:s.jsx(iS,{className:"text-primary-custom"})}),s.jsx(_.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),Rs=({direction:e,size:t=16,color:r})=>{const a=r||"var(--bs-primary)",n={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"1px",lineHeight:1,verticalAlign:"middle"},className:r?"":"text-muted sort-icon",children:[s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""}),s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""})]})},pd=({name:e,value:t,onChange:r,options:a=[],placeholder:n="Select an option",disabled:i=!1,isInvalid:l=!1,className:o="",style:c={},...u})=>{const d=v.useRef(null),[m,f]=v.useState(!1),h=j=>{if(i)return;const y=j.target.getBoundingClientRect(),S=window.innerHeight*.15,N=y.top-S;N>0&&window.scrollTo({top:window.scrollY+N,behavior:"instant"}),f(!0)},x=j=>{i||setTimeout(()=>{const y=j.target.getBoundingClientRect(),S=window.innerHeight*.15,N=y.top-S;N>0&&window.scrollTo({top:window.scrollY+N,behavior:"instant"})},10)},p=j=>{f(!1),r&&r(j)},g=()=>{f(!1)};return s.jsxs(_.Select,{ref:d,name:e,value:t,onChange:p,onBlur:g,onClick:h,onFocus:x,disabled:i,isInvalid:l,className:o,style:{position:"relative",zIndex:1001,...c},...u,children:[s.jsx("option",{value:"",children:n}),a.map(j=>typeof j=="object"?s.jsx("option",{value:j.value,children:j.label},j.value):s.jsx("option",{value:j,children:j},j))]})},Sr=()=>{const e=ft(),t=na();return v.useEffect(()=>{const r=LS(t.pathname),a=t.search||"",n=t.hash||"",i=r+a+n;r!==t.pathname&&e(i,{replace:!0,state:t.state})},[t.pathname,t.search,t.hash,t.state,e]),null},cg=({show:e,onHide:t,pdfUrl:r,title:a="PDF Viewer",externalLoading:n=!1})=>{const[i,l]=v.useState(!0),[o,c]=v.useState(!1);v.useEffect(()=>{e&&r&&(l(!0),c(!1))},[e,r]);const u=n||i,d=()=>{l(!1)},m=()=>{l(!1),c(!0)},h=(x=>{if(!x)return null;if(x.startsWith("blob:"))return`${x}#toolbar=0`;if(x.startsWith("http://")||x.startsWith("https://")){const p=x.includes("?")?"&":"?";return`${x}${p}#toolbar=0`}return x})(r);return s.jsxs(se,{show:e,onHide:t,size:"xl",centered:!0,fullscreen:"lg-down",onShow:()=>{document.body.style.overflow="hidden"},onExited:()=>{document.body.style.overflow="auto",l(!0),c(!1)},children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary text-white border-0",children:s.jsx(se.Title,{className:"text-white",children:a})}),s.jsxs(se.Body,{style:{padding:0,height:"70vh",minHeight:"500px",position:"relative"},children:[u&&s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",zIndex:10},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading PDF..."})]})}),o?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-danger",children:"Failed to load PDF"}),s.jsx("p",{className:"text-muted small",children:"Please check if the PDF URL is valid"})]})}):h?s.jsx("iframe",{src:h,style:{width:"100%",height:"100%",border:"none",display:u?"none":"block"},title:"PDF Viewer",onLoad:d,onError:m,type:"application/pdf"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No PDF available"})})]})]})},ZS=(e=Pe.DASHBOARD)=>{const{user:t,userPermissions:r,isLoading:a}=Rr(),{hasPermission:n}=ln();return{firstRoute:v.useMemo(()=>a||!t||!r||r.length===0?e:$R(t,n,e),[t,r,n,a,e]),isLoading:a||!t||!r||r.length===0}},yl=()=>{const{user:e,isLoading:t}=Rr(),r=ft(),a=na(),{firstRoute:n,isLoading:i}=ZS(Pe.DASHBOARD),l=v.useRef(!1);return v.useEffect(()=>{if(!(t||i||!e)){if(a.pathname===n){l.current=!0;return}l.current||(l.current=!0,r(n,{replace:!0}))}},[e,t,i,n,r,a.pathname]),t||i||!e?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})}):null},YR=({show:e,onHide:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState(""),c=async d=>{d.preventDefault(),o(""),i(!0);try{const m=await fetch(`${Hl.BASE_URL}${Hl.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${ng()}reset-password/`})});if(!m.ok){m.status===405?o("Forgot password feature is not available on this server. Please contact support."):m.status===404?o("Forgot password endpoint not found. Please contact support."):o(`Server error (${m.status}). Please try again later.`);return}try{await m.json()}catch(f){console.error("JSON parsing error:",f),o("Server returned invalid response. Please try again later.");return}te.success("Password reset link has been sent to your email!"),a(""),t()}catch(m){console.error("Forgot password error:",m),m.name==="TypeError"&&m.message.includes("fetch")?o("Cannot connect to server. Please check your internet connection."):o("An unexpected error occurred. Please try again later.")}finally{i(!1)}},u=()=>{a(""),o(""),t()};return s.jsxs(se,{show:e,onHide:u,centered:!0,children:[s.jsxs(se.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[s.jsxs(se.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(Vi,{className:"me-2",size:20}),"Forgot Password"]}),s.jsx(ae,{variant:"link",onClick:u,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:s.jsx(ht,{})})]}),s.jsxs(se.Body,{className:"pt-0",children:[s.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),l&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:l}),s.jsxs(_,{onSubmit:c,children:[s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),s.jsx(_.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:d=>a(d.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(ae,{type:"submit",variant:"primary",size:"lg",disabled:n||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.transform="translateY(-2px)",d.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:d=>{d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),s.jsx(ae,{type:"button",variant:"outline-secondary",onClick:u,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.background="var(--bs-neutral-100)",d.target.style.borderColor="var(--bs-primary)",d.target.style.transform="translateY(-1px)"},onMouseLeave:d=>{d.target.style.background="rgba(255, 255, 255, 0.8)",d.target.style.borderColor="var(--bs-neutral-300)",d.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function df(){const[e,t]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(!1),d=ft(),{login:m,isAuthenticated:f,isLoading:h}=Rr(),{firstRoute:x,isLoading:p}=ZS();if(v.useEffect(()=>{if(f&&!h&&!p&&x&&x!==Pe.DASHBOARD){const j=window.location.pathname;j!==x&&!j.startsWith("/login")&&d(x,{replace:!0})}},[f,h,p,x,d]),h)return s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(f)return null;const g=async j=>{j.preventDefault(),o(!0);try{const w=await m({email:e,password:r});w.success?setTimeout(()=>{const y=window.location.pathname;if(y==="/login"||y==="/"){const b=w.user?.role||w.role?.name,S=typeof b=="string"?b.toUpperCase().replace(/\s+/g,"_"):null;S==="TRAINEE"?d("/trainee/dashboard",{replace:!0}):S==="ACADEMIC_DEPARTMENT"||S==="ACADEMIC_DEPT"?d("/academic/dashboard",{replace:!0}):S==="ADMINISTRATOR"||S==="ADMIN"?d(Pe.MAIN_MENU,{replace:!0}):S==="TRAINER"?d(Pe.ASSESSMENTS_UPCOMING,{replace:!0}):S==="DEPARTMENT_HEAD"?d("/department-head/dashboard",{replace:!0}):d(Pe.MAIN_MENU,{replace:!0})}},800):te.error(w.error||"Email or password is incorrect. Please try again.")}catch{te.error("Login failed. Please try again.")}finally{o(!1)}};return s.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[s.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),s.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),s.jsx(Be,{fluid:!0,className:"position-relative",style:{zIndex:1},children:s.jsxs(ue,{className:"min-vh-100",children:[s.jsx(H,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:s.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-4",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),s.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),s.jsx(H,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:s.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),s.jsxs("div",{style:{position:"relative",zIndex:2},children:[s.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),s.jsx("div",{className:"dashed-line ms-3"})]}),s.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),s.jsxs(_,{onSubmit:g,children:[s.jsxs(_.Group,{className:"mb-3",controlId:"email",children:[s.jsx(_.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),s.jsx(_.Control,{type:"email",value:e,onChange:j=>t(j.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),s.jsxs(_.Group,{className:"mb-4",controlId:"password",children:[s.jsx(_.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:n?"text":"password",value:r,onChange:j=>a(j.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),s.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(j=>!j),onKeyPress:j=>{(j.key==="Enter"||j.key===" ")&&i(w=>!w)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),s.jsx(ae,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:l,children:l?s.jsxs(s.Fragment,{children:[s.jsx(ot,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),s.jsx("div",{className:"text-center mb-2",children:s.jsx("button",{type:"button",onClick:()=>u(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),s.jsx("div",{className:"text-center mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),s.jsx("div",{className:"text-center",children:s.jsxs("small",{className:"text-white-50 d-block mb-2",children:["Enhance Your Examinations Through DSFMS"," "]})})]})]})]})})]})}),s.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),s.jsx(YR,{show:c,onHide:()=>u(!1)})]})}const XR=()=>{const[e]=xi(),t=ft(),[r,a]=v.useState({newPassword:"",confirmPassword:""}),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(""),[f,h]=v.useState("");v.useEffect(()=>{const g=e.get("token");g&&h(g)},[e]);const x=g=>{const{name:j,value:w}=g.target;a(y=>({...y,[j]:w})),d&&m("")},p=async g=>{if(g.preventDefault(),m(""),!r.newPassword||!r.confirmPassword){m("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){m("Passwords do not match.");return}u(!0);try{const j=await fetch(`${Hl.BASE_URL}${Hl.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!j.ok){j.status===405?m("Reset password feature is not available on this server. Please contact support."):j.status===404?m("Reset password endpoint not found. Please contact support."):j.status===400?m("Invalid token or password. Please request a new reset link."):m(`Server error (${j.status}). Please try again later.`);return}try{await j.json()}catch(w){console.error("JSON parsing error:",w),m("Server returned invalid response. Please try again later.");return}te.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(j){console.error("Reset password error:",j),j.name==="TypeError"&&j.message.includes("fetch")?m("Cannot connect to server. Please check your internet connection."):m("An unexpected error occurred. Please try again later.")}finally{u(!1)}};return s.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:s.jsx(Be,{children:s.jsx(ue,{className:"justify-content-center",children:s.jsx(H,{md:6,lg:5,xl:4,children:s.jsx(Y,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:s.jsxs(Y.Body,{className:"p-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:s.jsx(tc,{size:24,className:"text-white"})}),s.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),s.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),d&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:d}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:n?"text":"password",name:"newPassword",value:r.newPassword,onChange:x,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(ae,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?s.jsx(Rl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:l?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:x,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(ae,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>o(!l),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:l?s.jsx(Rl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(ae,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),s.jsx(ae,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var au={};au.version="0.18.5";var QS=1252,JR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ug=function(e){JR.indexOf(e)!=-1&&(QS=dg[0]=e)};function ZR(){ug(1252)}var Qa=function(e){ug(e)};function mg(){Qa(1200),ZR()}function Eb(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function QR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function eE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Fo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?QR(e.slice(2)):t==254&&r==255?eE(e.slice(2)):t==65279?e.slice(1):e},xd=function(t){return String.fromCharCode(t)},Tb=function(t){return String.fromCharCode(t)},sc,ai="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ac(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,a=e.charCodeAt(u++),l=(r&3)<<4|a>>4,n=e.charCodeAt(u++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),t+=ai.charAt(i)+ai.charAt(l)+ai.charAt(o)+ai.charAt(c);return t}function ja(e){var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=ai.indexOf(e.charAt(u++)),l=ai.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=ai.indexOf(e.charAt(u++)),a=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=ai.indexOf(e.charAt(u++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),$n=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function di(e){return Pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Cb(e){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ha=function(t){return Pt?$n(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function dm(e){if(typeof ArrayBuffer>"u")return ha(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function vi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function e6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function fg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ls=Pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$n(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function t6(e){for(var t=[],r=0,a=e.length+250,n=di(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(t.push(n.slice(0,r)),r=0,n=di(65535),a=65530)}return t.push(n.slice(0,r)),ls(t)}var Hs=/\u0000/g,Lo=/[\u0001-\u0006]/g;function Fl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function en(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}function hg(e,t){var r=""+e;return r.length>=t?r:Ir(" ",t-r.length)+r}function nu(e,t){var r=""+e;return r.length>=t?r:r+Ir(" ",t-r.length)}function r6(e,t){var r=""+Math.round(e);return r.length>=t?r:Ir("0",t-r.length)+r}function s6(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}var Ab=Math.pow(2,32);function bl(e,t){if(e>Ab||e<-Ab)return r6(e,t);var r=Math.round(e);return s6(r,t)}function iu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var _b=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],uf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},n6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function lu(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,l=1,o=0,c=1,u=0,d=0,m=Math.floor(n);u<t&&(m=Math.floor(n),o=m*l+i,d=m*u+c,!(n-m<5e-8));)n=1/(n-m),i=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=l)),!r)return[0,a*o,d];var f=Math.floor(a*o/d);return[f,a*o-f*d,d]}function Ii(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,l=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=u6(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var tE=new Date(1899,11,31,0,0,0),i6=tE.getTime(),l6=new Date(1900,2,1,0,0,0);function rE(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=l6&&(r+=1440*60*1e3),(r-(i6+(e.getTimezoneOffset()-tE.getTimezoneOffset())*6e4))/(1440*60*1e3)}function pg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c6(e){var t=e<0?12:11,r=pg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function d6(e){var t=pg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function nc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=c6(e):t===10?r=e.toFixed(10).substr(0,12):r=d6(e),pg(o6(r.toUpperCase()))}function Ki(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):nc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return $a(14,rE(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function u6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function m6(e,t,r,a){var n="",i=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return uf[r.m-1][1];case 5:return uf[r.m-1][0];default:return uf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return _b[r.q][0];default:return _b[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?en(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(n=en(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?en(c,u):"";return d}function ni(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var sE=/%/g;function f6(e,t,r){var a=t.replace(sE,""),n=t.length-a.length;return _n(e,a,r*Math.pow(10,2*n))+Ir("%",n)}function h6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return _n(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function aE(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+aE(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var nE=/# (\?+)( ?)\/( ?)(\d+)/;function p6(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),l=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?Ir(" ",e[1].length+1+e[4].length):hg(l,e[1].length)+e[2]+"/"+e[3]+en(o,e[4].length))}function x6(e,t,r){return r+(t===0?"":""+t)+Ir(" ",e[1].length+2+e[4].length)}var iE=/^#*0*\.([0#]+)/,lE=/\).*[0#]/,oE=/\(###\) ###\\?-####/;function Ms(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ib(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Db(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function g6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function v6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",a,r):"("+Ia("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return h6(e,t,r);if(t.indexOf("%")!==-1)return f6(e,t,r);if(t.indexOf("E")!==-1)return aE(t,r);if(t.charCodeAt(0)===36)return"$"+Ia(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+bl(c,t.length);if(t.match(/^[#?]+$/))return n=bl(r,0),n==="0"&&(n=""),n.length>t.length?n:Ms(t.substr(0,t.length-n.length))+n;if(i=t.match(nE))return p6(i,c,u);if(t.match(/^#+0+$/))return u+bl(c,t.length-t.indexOf("0"));if(i=t.match(iE))return n=Ib(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Ms(i[1])).replace(/\.$/,"."+Ms(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Ir("0",Ms(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+Ib(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ni(bl(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):ni(""+(Math.floor(r)+g6(r,i[1].length)))+"."+en(Db(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ia(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fl(Ia(e,t.replace(/[\\-]/g,""),r)),l=0,Fl(Fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(t.match(oE))return n=Ia(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=lu(c,Math.pow(10,l)-1,!1),n=""+u,d=_n("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=nu(o[2],l),d.length<i[4].length&&(d=Ms(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=lu(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hg(o[1],l)+i[2]+"/"+i[3]+nu(o[2],l):Ir(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=bl(r,0),t.length<=n.length?n:Ms(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=t.indexOf(".")-l,f=t.length-n.length-m;return Ms(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=Db(r,i[1].length),r<0?"-"+Ia(e,t,-r):ni(v6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?en(0,3-x.length):"")+x})+"."+en(l,i[1].length);switch(t){case"###,##0.00":return Ia(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ni(bl(c,0));return h!=="0"?u+h:"";case"###,###.00":return Ia(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ia(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function y6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return _n(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function b6(e,t,r){var a=t.replace(sE,""),n=t.length-a.length;return _n(e,a,r*Math.pow(10,2*n))+Ir("%",n)}function cE(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cE(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function mn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mn("n",a,r):"("+mn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return y6(e,t,r);if(t.indexOf("%")!==-1)return b6(e,t,r);if(t.indexOf("E")!==-1)return cE(t,r);if(t.charCodeAt(0)===36)return"$"+mn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+en(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Ms(t.substr(0,t.length-n.length))+n;if(i=t.match(nE))return x6(i,c,u);if(t.match(/^#+0+$/))return u+en(c,t.length-t.indexOf("0"));if(i=t.match(iE))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ms(i[1])).replace(/\.$/,"."+Ms(i[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Ir("0",Ms(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ni(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):ni(""+r)+"."+Ir("0",i[1].length);if(i=t.match(/^#,#*,#0/))return mn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fl(mn(e,t.replace(/[\\-]/g,""),r)),l=0,Fl(Fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(t.match(oE))return n=mn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=lu(c,Math.pow(10,l)-1,!1),n=""+u,d=_n("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=nu(o[2],l),d.length<i[4].length&&(d=Ms(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=lu(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hg(o[1],l)+i[2]+"/"+i[3]+nu(o[2],l):Ir(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Ms(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=t.indexOf(".")-l,f=t.length-n.length-m;return Ms(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):ni(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?en(0,3-x.length):"")+x})+"."+en(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ni(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return mn(e,t.slice(0,t.lastIndexOf(".")),r)+Ms(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _n(e,t,r){return(r|0)===r?mn(e,t,r):Ia(e,t,r)}function j6(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var dE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lo(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":iu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(dE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function w6(e,t,r,a){for(var n=[],i="",l=0,o="",c="t",u,d,m,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!iu(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(m=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++l;break;case"\\":var h=e.charAt(++l),x=h==="("||h===")"?h:"t";n[n.length]={t:x,v:h},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=Ii(t,r,e.charAt(l+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ii(t,r),u==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(u==null&&(u=Ii(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",l+=5,f="h"):(p.t="t",++l),u==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(dE)){if(u==null&&(u=Ii(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",lo(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var g=0,j=0,w;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=f,c="h",g<1&&(g=1);break;case"s":(w=n[l].v.match(/\.0+$/))&&(j=Math.max(j,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[l].v.match(/[Hh]/)&&(g=1),g<2&&n[l].v.match(/[Mm]/)&&(g=2),g<3&&n[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=m6(n[l].t.charCodeAt(0),n[l].v,u,j),n[l].t="t";break;case"n":case"?":for(b=l+1;n[b]!=null&&((o=n[b].t)==="?"||o==="D"||(o===" "||o==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[l].v+=n[b].v,n[b]={v:"",t:";"},++b;y+=n[l].v,l=b-1;break;case"G":n[l].t="t",n[l].v=Ki(t,r);break}var S="",E,N;if(y.length>0){y.charCodeAt(0)==40?(E=t<0&&y.charCodeAt(0)===45?-t:t,N=_n("n",y,E)):(E=t<0&&a>1?-t:t,N=_n("n",y,E),E<0&&n[0]&&n[0].t=="t"&&(N=N.substr(1),n[0].v="-"+n[0].v)),b=N.length-1;var T=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){T=l;break}var k=n.length;if(T===n.length&&N.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(b>=n[l].v.length-1?(b-=n[l].v.length,n[l].v=N.substr(b+1,n[l].v.length)):b<0?n[l].v="":(n[l].v=N.substr(0,b+1),b=-1),n[l].t="t",k=l);b>=0&&k<n.length&&(n[k].v=N.substr(0,b+1)+n[k].v)}else if(T!==n.length&&N.indexOf("E")===-1){for(b=N.indexOf(".")-1,l=T;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(d=n[l].v.indexOf(".")>-1&&l===T?n[l].v.indexOf(".")-1:n[l].v.length-1,S=n[l].v.substr(d+1);d>=0;--d)b>=0&&(n[l].v.charAt(d)==="0"||n[l].v.charAt(d)==="#")&&(S=N.charAt(b--)+S);n[l].v=S,n[l].t="t",k=l}for(b>=0&&k<n.length&&(n[k].v=N.substr(0,b+1)+n[k].v),b=N.indexOf(".")+1,l=T;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==T)){for(d=n[l].v.indexOf(".")>-1&&l===T?n[l].v.indexOf(".")+1:0,S=n[l].v.substr(0,d);d<n[l].v.length;++d)b<N.length&&(S+=N.charAt(b++));n[l].v=S,n[l].t="t",k=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(E=a>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=_n(n[l].t,n[l].v,E),n[l].t="t");var I="";for(l=0;l!==n.length;++l)n[l]!=null&&(I+=n[l].v);return I}var Pb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ob(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function N6(e,t){var r=j6(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Pb),o=r[1].match(Pb);return Ob(t,l)?[a,r[0]]:Ob(t,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function $a(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:vt)[e],a==null&&(a=r.table&&r.table[kb[e]]||vt[kb[e]]),a==null&&(a=n6[e]||"General");break}if(iu(a,0))return Ki(t,r);t instanceof Date&&(t=rE(t,r.date1904));var n=N6(a,t);if(iu(n[1]))return Ki(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return w6(n[1],t,r,n[0])}function kn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(vt[r]==null){t<0&&(t=r);continue}if(vt[r]==e){t=r;break}}t<0&&(t=391)}return vt[t]=e,t}function um(e){for(var t=0;t!=392;++t)e[t]!==void 0&&kn(e[t],t)}function oo(){vt=a6()}var S6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},uE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function E6(e){var t=typeof e=="number"?vt[e]:e;return t=t.replace(uE,"(\\d+)"),new RegExp("^"+t+"$")}function T6(e,t,r){var a=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(t.match(uE)||[]).forEach(function(m,f){var h=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":l=h;break;case"s":c=h;break;case"m":l>=0?o=h:n=h;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:a==-1&&n==-1&&i==-1?d:u+"T"+d}var C6=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,T=new Array(256),k=0;k!=256;++k)N=k,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,T[k]=N;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function a(N){var T=0,k=0,I=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)D[I]=N[I];for(I=0;I!=256;++I)for(k=N[I],T=256+I;T<4096;T+=256)k=D[T]=k>>>8^N[k&255];var A=[];for(I=1;I!=16;++I)A[I-1]=typeof Int32Array<"u"?D.subarray(I*256,I*256+256):D.slice(I*256,I*256+256);return A}var n=a(r),i=n[0],l=n[1],o=n[2],c=n[3],u=n[4],d=n[5],m=n[6],f=n[7],h=n[8],x=n[9],p=n[10],g=n[11],j=n[12],w=n[13],y=n[14];function b(N,T){for(var k=T^-1,I=0,D=N.length;I<D;)k=k>>>8^r[(k^N.charCodeAt(I++))&255];return~k}function S(N,T){for(var k=T^-1,I=N.length-15,D=0;D<I;)k=y[N[D++]^k&255]^w[N[D++]^k>>8&255]^j[N[D++]^k>>16&255]^g[N[D++]^k>>>24]^p[N[D++]]^x[N[D++]]^h[N[D++]]^f[N[D++]]^m[N[D++]]^d[N[D++]]^u[N[D++]]^c[N[D++]]^o[N[D++]]^l[N[D++]]^i[N[D++]]^r[N[D++]];for(I+=15;D<I;)k=k>>>8^r[(k^N[D++])&255];return~k}function E(N,T){for(var k=T^-1,I=0,D=N.length,A=0,M=0;I<D;)A=N.charCodeAt(I++),A<128?k=k>>>8^r[(k^A)&255]:A<2048?(k=k>>>8^r[(k^(192|A>>6&31))&255],k=k>>>8^r[(k^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,M=N.charCodeAt(I++)&1023,k=k>>>8^r[(k^(240|A>>8&7))&255],k=k>>>8^r[(k^(128|A>>2&63))&255],k=k>>>8^r[(k^(128|M>>6&15|(A&3)<<4))&255],k=k>>>8^r[(k^(128|M&63))&255]):(k=k>>>8^r[(k^(224|A>>12&15))&255],k=k>>>8^r[(k^(128|A>>6&63))&255],k=k>>>8^r[(k^(128|A&63))&255]);return~k}return e.table=r,e.bstr=b,e.buf=S,e.str=E,e})(),mt=(function(){var t={};t.version="1.2.1";function r(Q,ce){for(var ie=Q.split("/"),B=ce.split("/"),L=0,K=0,fe=Math.min(ie.length,B.length);L<fe;++L){if(K=ie[L].length-B[L].length)return K;if(ie[L]!=B[L])return ie[L]<B[L]?-1:1}return ie.length-B.length}function a(Q){if(Q.charAt(Q.length-1)=="/")return Q.slice(0,-1).indexOf("/")===-1?Q:a(Q.slice(0,-1));var ce=Q.lastIndexOf("/");return ce===-1?Q:Q.slice(0,ce+1)}function n(Q){if(Q.charAt(Q.length-1)=="/")return n(Q.slice(0,-1));var ce=Q.lastIndexOf("/");return ce===-1?Q:Q.slice(ce+1)}function i(Q,ce){typeof ce=="string"&&(ce=new Date(ce));var ie=ce.getHours();ie=ie<<6|ce.getMinutes(),ie=ie<<5|ce.getSeconds()>>>1,Q.write_shift(2,ie);var B=ce.getFullYear()-1980;B=B<<4|ce.getMonth()+1,B=B<<5|ce.getDate(),Q.write_shift(2,B)}function l(Q){var ce=Q.read_shift(2)&65535,ie=Q.read_shift(2)&65535,B=new Date,L=ie&31;ie>>>=5;var K=ie&15;ie>>>=4,B.setMilliseconds(0),B.setFullYear(ie+1980),B.setMonth(K-1),B.setDate(L);var fe=ce&31;ce>>>=5;var ve=ce&63;return ce>>>=6,B.setHours(ce),B.setMinutes(ve),B.setSeconds(fe<<1),B}function o(Q){vs(Q,0);for(var ce={},ie=0;Q.l<=Q.length-4;){var B=Q.read_shift(2),L=Q.read_shift(2),K=Q.l+L,fe={};switch(B){case 21589:ie=Q.read_shift(1),ie&1&&(fe.mtime=Q.read_shift(4)),L>5&&(ie&2&&(fe.atime=Q.read_shift(4)),ie&4&&(fe.ctime=Q.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}Q.l=K,ce[B]=fe}return ce}var c;function u(){return c||(c={})}function d(Q,ce){if(Q[0]==80&&Q[1]==75)return lr(Q,ce);if((Q[0]|32)==109&&(Q[1]|32)==105)return od(Q,ce);if(Q.length<512)throw new Error("CFB file size "+Q.length+" < 512");var ie=3,B=512,L=0,K=0,fe=0,ve=0,pe=0,be=[],we=Q.slice(0,512);vs(we,0);var Ne=m(we);switch(ie=Ne[0],ie){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ne[1]==0)return lr(Q,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+ie)}B!==512&&(we=Q.slice(0,B),vs(we,28));var Ie=Q.slice(0,B);f(we,ie);var Re=we.read_shift(4,"i");if(ie===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);we.l+=4,fe=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),ve=we.read_shift(4,"i"),L=we.read_shift(4,"i"),pe=we.read_shift(4,"i"),K=we.read_shift(4,"i");for(var Fe=-1,Ve=0;Ve<109&&(Fe=we.read_shift(4,"i"),!(Fe<0));++Ve)be[Ve]=Fe;var Je=h(Q,B);g(pe,K,Je,B,be);var pt=w(Je,fe,be,B);pt[fe].name="!Directory",L>0&&ve!==M&&(pt[ve].name="!MiniFAT"),pt[be[0]].name="!FAT",pt.fat_addrs=be,pt.ssz=B;var St={},wt=[],Lr=[],Jt=[];y(fe,pt,Je,wt,L,St,Lr,ve),x(Lr,Jt,wt),wt.shift();var xt={FileIndex:Lr,FullPaths:Jt};return ce&&ce.raw&&(xt.raw={header:Ie,sectors:Je}),xt}function m(Q){if(Q[Q.l]==80&&Q[Q.l+1]==75)return[0,0];Q.chk(G,"Header Signature: "),Q.l+=16;var ce=Q.read_shift(2,"u");return[Q.read_shift(2,"u"),ce]}function f(Q,ce){var ie=9;switch(Q.l+=2,ie=Q.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+ie);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+ie);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ie)}Q.chk("0600","Mini Sector Shift: "),Q.chk("000000000000","Reserved: ")}function h(Q,ce){for(var ie=Math.ceil(Q.length/ce)-1,B=[],L=1;L<ie;++L)B[L-1]=Q.slice(L*ce,(L+1)*ce);return B[ie-1]=Q.slice(ie*ce),B}function x(Q,ce,ie){for(var B=0,L=0,K=0,fe=0,ve=0,pe=ie.length,be=[],we=[];B<pe;++B)be[B]=we[B]=B,ce[B]=ie[B];for(;ve<we.length;++ve)B=we[ve],L=Q[B].L,K=Q[B].R,fe=Q[B].C,be[B]===B&&(L!==-1&&be[L]!==L&&(be[B]=be[L]),K!==-1&&be[K]!==K&&(be[B]=be[K])),fe!==-1&&(be[fe]=B),L!==-1&&B!=be[B]&&(be[L]=be[B],we.lastIndexOf(L)<ve&&we.push(L)),K!==-1&&B!=be[B]&&(be[K]=be[B],we.lastIndexOf(K)<ve&&we.push(K));for(B=1;B<pe;++B)be[B]===B&&(K!==-1&&be[K]!==K?be[B]=be[K]:L!==-1&&be[L]!==L&&(be[B]=be[L]));for(B=1;B<pe;++B)if(Q[B].type!==0){if(ve=B,ve!=be[ve])do ve=be[ve],ce[B]=ce[ve]+"/"+ce[B];while(ve!==0&&be[ve]!==-1&&ve!=be[ve]);be[B]=-1}for(ce[0]+="/",B=1;B<pe;++B)Q[B].type!==2&&(ce[B]+="/")}function p(Q,ce,ie){for(var B=Q.start,L=Q.size,K=[],fe=B;ie&&L>0&&fe>=0;)K.push(ce.slice(fe*A,fe*A+A)),L-=A,fe=_i(ie,fe*4);return K.length===0?Le(0):ls(K).slice(0,Q.size)}function g(Q,ce,ie,B,L){var K=M;if(Q===M){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(Q!==-1){var fe=ie[Q],ve=(B>>>2)-1;if(!fe)return;for(var pe=0;pe<ve&&(K=_i(fe,pe*4))!==M;++pe)L.push(K);g(_i(fe,B-4),ce-1,ie,B,L)}}function j(Q,ce,ie,B,L){var K=[],fe=[];L||(L=[]);var ve=B-1,pe=0,be=0;for(pe=ce;pe>=0;){L[pe]=!0,K[K.length]=pe,fe.push(Q[pe]);var we=ie[Math.floor(pe*4/B)];if(be=pe*4&ve,B<4+be)throw new Error("FAT boundary crossed: "+pe+" 4 "+B);if(!Q[we])break;pe=_i(Q[we],be)}return{nodes:K,data:Gb([fe])}}function w(Q,ce,ie,B){var L=Q.length,K=[],fe=[],ve=[],pe=[],be=B-1,we=0,Ne=0,Ie=0,Re=0;for(we=0;we<L;++we)if(ve=[],Ie=we+ce,Ie>=L&&(Ie-=L),!fe[Ie]){pe=[];var Fe=[];for(Ne=Ie;Ne>=0;){Fe[Ne]=!0,fe[Ne]=!0,ve[ve.length]=Ne,pe.push(Q[Ne]);var Ve=ie[Math.floor(Ne*4/B)];if(Re=Ne*4&be,B<4+Re)throw new Error("FAT boundary crossed: "+Ne+" 4 "+B);if(!Q[Ve]||(Ne=_i(Q[Ve],Re),Fe[Ne]))break}K[Ie]={nodes:ve,data:Gb([pe])}}return K}function y(Q,ce,ie,B,L,K,fe,ve){for(var pe=0,be=B.length?2:0,we=ce[Q].data,Ne=0,Ie=0,Re;Ne<we.length;Ne+=128){var Fe=we.slice(Ne,Ne+128);vs(Fe,64),Ie=Fe.read_shift(2),Re=wg(Fe,0,Ie-be),B.push(Re);var Ve={name:Re,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},Je=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Je!==0&&(Ve.ct=b(Fe,Fe.l-8));var pt=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);pt!==0&&(Ve.mt=b(Fe,Fe.l-8)),Ve.start=Fe.read_shift(4,"i"),Ve.size=Fe.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=M,Ve.name=""),Ve.type===5?(pe=Ve.start,L>0&&pe!==M&&(ce[pe].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",ce[Ve.start]===void 0&&(ce[Ve.start]=j(ie,Ve.start,ce.fat_addrs,ce.ssz)),ce[Ve.start].name=Ve.name,Ve.content=ce[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:pe!==M&&Ve.start!==M&&ce[pe]&&(Ve.content=p(Ve,ce[pe].data,(ce[ve]||{}).data))),Ve.content&&vs(Ve.content,0),K[Re]=Ve,fe.push(Ve)}}function b(Q,ce){return new Date((fa(Q,ce+4)/1e7*Math.pow(2,32)+fa(Q,ce)/1e7-11644473600)*1e3)}function S(Q,ce){return u(),d(c.readFileSync(Q),ce)}function E(Q,ce){var ie=ce&&ce.type;switch(ie||Pt&&Buffer.isBuffer(Q)&&(ie="buffer"),ie||"base64"){case"file":return S(Q,ce);case"base64":return d(ha(ja(Q)),ce);case"binary":return d(ha(Q),ce)}return d(Q,ce)}function N(Q,ce){var ie=ce||{},B=ie.root||"Root Entry";if(Q.FullPaths||(Q.FullPaths=[]),Q.FileIndex||(Q.FileIndex=[]),Q.FullPaths.length!==Q.FileIndex.length)throw new Error("inconsistent CFB structure");Q.FullPaths.length===0&&(Q.FullPaths[0]=B+"/",Q.FileIndex[0]={name:B,type:5}),ie.CLSID&&(Q.FileIndex[0].clsid=ie.CLSID),T(Q)}function T(Q){var ce="Sh33tJ5";if(!mt.find(Q,"/"+ce)){var ie=Le(4);ie[0]=55,ie[1]=ie[3]=50,ie[2]=54,Q.FileIndex.push({name:ce,type:2,content:ie,size:4,L:69,R:69,C:69}),Q.FullPaths.push(Q.FullPaths[0]+ce),k(Q)}}function k(Q,ce){N(Q);for(var ie=!1,B=!1,L=Q.FullPaths.length-1;L>=0;--L){var K=Q.FileIndex[L];switch(K.type){case 0:B?ie=!0:(Q.FileIndex.pop(),Q.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(K.R*K.L*K.C)&&(ie=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(ie=!0);break;default:ie=!0;break}}if(!(!ie&&!ce)){var fe=new Date(1987,1,19),ve=0,pe=Object.create?Object.create(null):{},be=[];for(L=0;L<Q.FullPaths.length;++L)pe[Q.FullPaths[L]]=!0,Q.FileIndex[L].type!==0&&be.push([Q.FullPaths[L],Q.FileIndex[L]]);for(L=0;L<be.length;++L){var we=a(be[L][0]);B=pe[we],B||(be.push([we,{name:n(we).replace("/",""),type:1,clsid:z,ct:fe,mt:fe,content:null}]),pe[we]=!0)}for(be.sort(function(Re,Fe){return r(Re[0],Fe[0])}),Q.FullPaths=[],Q.FileIndex=[],L=0;L<be.length;++L)Q.FullPaths[L]=be[L][0],Q.FileIndex[L]=be[L][1];for(L=0;L<be.length;++L){var Ne=Q.FileIndex[L],Ie=Q.FullPaths[L];if(Ne.name=n(Ie).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||z,L===0)Ne.C=be.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Ie.slice(-1)=="/"){for(ve=L+1;ve<be.length&&a(Q.FullPaths[ve])!=Ie;++ve);for(Ne.C=ve>=be.length?-1:ve,ve=L+1;ve<be.length&&a(Q.FullPaths[ve])!=a(Ie);++ve);Ne.R=ve>=be.length?-1:ve,Ne.type=1}else a(Q.FullPaths[L+1]||"")==a(Ie)&&(Ne.R=L+1),Ne.type=2}}}function I(Q,ce){var ie=ce||{};if(ie.fileType=="mad")return ef(Q,ie);switch(k(Q),ie.fileType){case"zip":return Nr(Q,ie)}var B=(function(Re){for(var Fe=0,Ve=0,Je=0;Je<Re.FileIndex.length;++Je){var pt=Re.FileIndex[Je];if(pt.content){var St=pt.content.length;St>0&&(St<4096?Fe+=St+63>>6:Ve+=St+511>>9)}}for(var wt=Re.FullPaths.length+3>>2,Lr=Fe+7>>3,Jt=Fe+127>>7,xt=Lr+Ve+wt+Jt,Et=xt+127>>7,fs=Et<=109?0:Math.ceil((Et-109)/127);xt+Et+fs+127>>7>Et;)fs=++Et<=109?0:Math.ceil((Et-109)/127);var Ft=[1,fs,Et,Jt,wt,Ve,Fe,0];return Re.FileIndex[0].size=Fe<<6,Ft[7]=(Re.FileIndex[0].start=Ft[0]+Ft[1]+Ft[2]+Ft[3]+Ft[4]+Ft[5])+(Ft[6]+7>>3),Ft})(Q),L=Le(B[7]<<9),K=0,fe=0;{for(K=0;K<8;++K)L.write_shift(1,q[K]);for(K=0;K<8;++K)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),K=0;K<3;++K)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,B[2]),L.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:M),L.write_shift(4,B[3]),L.write_shift(-4,B[1]?B[0]-1:M),L.write_shift(4,B[1]),K=0;K<109;++K)L.write_shift(-4,K<B[2]?B[1]+K:-1)}if(B[1])for(fe=0;fe<B[1];++fe){for(;K<236+fe*127;++K)L.write_shift(-4,K<B[2]?B[1]+K:-1);L.write_shift(-4,fe===B[1]-1?M:fe+1)}var ve=function(Re){for(fe+=Re;K<fe-1;++K)L.write_shift(-4,K+1);Re&&(++K,L.write_shift(-4,M))};for(fe=K=0,fe+=B[1];K<fe;++K)L.write_shift(-4,ee.DIFSECT);for(fe+=B[2];K<fe;++K)L.write_shift(-4,ee.FATSECT);ve(B[3]),ve(B[4]);for(var pe=0,be=0,we=Q.FileIndex[0];pe<Q.FileIndex.length;++pe)we=Q.FileIndex[pe],we.content&&(be=we.content.length,!(be<4096)&&(we.start=fe,ve(be+511>>9)));for(ve(B[6]+7>>3);L.l&511;)L.write_shift(-4,ee.ENDOFCHAIN);for(fe=K=0,pe=0;pe<Q.FileIndex.length;++pe)we=Q.FileIndex[pe],we.content&&(be=we.content.length,!(!be||be>=4096)&&(we.start=fe,ve(be+63>>6)));for(;L.l&511;)L.write_shift(-4,ee.ENDOFCHAIN);for(K=0;K<B[4]<<2;++K){var Ne=Q.FullPaths[K];if(!Ne||Ne.length===0){for(pe=0;pe<17;++pe)L.write_shift(4,0);for(pe=0;pe<3;++pe)L.write_shift(4,-1);for(pe=0;pe<12;++pe)L.write_shift(4,0);continue}we=Q.FileIndex[K],K===0&&(we.start=we.size?we.start-1:M);var Ie=K===0&&ie.root||we.name;if(be=2*(Ie.length+1),L.write_shift(64,Ie,"utf16le"),L.write_shift(2,be),L.write_shift(1,we.type),L.write_shift(1,we.color),L.write_shift(-4,we.L),L.write_shift(-4,we.R),L.write_shift(-4,we.C),we.clsid)L.write_shift(16,we.clsid,"hex");else for(pe=0;pe<4;++pe)L.write_shift(4,0);L.write_shift(4,we.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,we.start),L.write_shift(4,we.size),L.write_shift(4,0)}for(K=1;K<Q.FileIndex.length;++K)if(we=Q.FileIndex[K],we.size>=4096)if(L.l=we.start+1<<9,Pt&&Buffer.isBuffer(we.content))we.content.copy(L,L.l,0,we.size),L.l+=we.size+511&-512;else{for(pe=0;pe<we.size;++pe)L.write_shift(1,we.content[pe]);for(;pe&511;++pe)L.write_shift(1,0)}for(K=1;K<Q.FileIndex.length;++K)if(we=Q.FileIndex[K],we.size>0&&we.size<4096)if(Pt&&Buffer.isBuffer(we.content))we.content.copy(L,L.l,0,we.size),L.l+=we.size+63&-64;else{for(pe=0;pe<we.size;++pe)L.write_shift(1,we.content[pe]);for(;pe&63;++pe)L.write_shift(1,0)}if(Pt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function D(Q,ce){var ie=Q.FullPaths.map(function(pe){return pe.toUpperCase()}),B=ie.map(function(pe){var be=pe.split("/");return be[be.length-(pe.slice(-1)=="/"?2:1)]}),L=!1;ce.charCodeAt(0)===47?(L=!0,ce=ie[0].slice(0,-1)+ce):L=ce.indexOf("/")!==-1;var K=ce.toUpperCase(),fe=L===!0?ie.indexOf(K):B.indexOf(K);if(fe!==-1)return Q.FileIndex[fe];var ve=!K.match(Lo);for(K=K.replace(Hs,""),ve&&(K=K.replace(Lo,"!")),fe=0;fe<ie.length;++fe)if((ve?ie[fe].replace(Lo,"!"):ie[fe]).replace(Hs,"")==K||(ve?B[fe].replace(Lo,"!"):B[fe]).replace(Hs,"")==K)return Q.FileIndex[fe];return null}var A=64,M=-2,G="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function U(Q,ce,ie){u();var B=I(Q,ie);c.writeFileSync(ce,B)}function X(Q){for(var ce=new Array(Q.length),ie=0;ie<Q.length;++ie)ce[ie]=String.fromCharCode(Q[ie]);return ce.join("")}function oe(Q,ce){var ie=I(Q,ce);switch(ce&&ce.type||"buffer"){case"file":return u(),c.writeFileSync(ce.filename,ie),ie;case"binary":return typeof ie=="string"?ie:X(ie);case"base64":return ac(typeof ie=="string"?ie:X(ie));case"buffer":if(Pt)return Buffer.isBuffer(ie)?ie:$n(ie);case"array":return typeof ie=="string"?ha(ie):ie}return ie}var Ee;function F(Q){try{var ce=Q.InflateRaw,ie=new ce;if(ie._processChunk(new Uint8Array([3,0]),ie._finishFlushFlag),ie.bytesRead)Ee=Q;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function P(Q,ce){if(!Ee)return Ta(Q,ce);var ie=Ee.InflateRaw,B=new ie,L=B._processChunk(Q.slice(Q.l),B._finishFlushFlag);return Q.l+=B.bytesRead,L}function C(Q){return Ee?Ee.deflateRawSync(Q):ke(Q)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(Q){var ce=(Q<<1|Q<<11)&139536|(Q<<5|Q<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var V=typeof Uint8Array<"u",re=V?new Uint8Array(256):[],he=0;he<256;++he)re[he]=le(he);function O(Q,ce){var ie=re[Q&255];return ce<=8?ie>>>8-ce:(ie=ie<<8|re[Q>>8&255],ce<=16?ie>>>16-ce:(ie=ie<<8|re[Q>>16&255],ie>>>24-ce))}function ye(Q,ce){var ie=ce&7,B=ce>>>3;return(Q[B]|(ie<=6?0:Q[B+1]<<8))>>>ie&3}function de(Q,ce){var ie=ce&7,B=ce>>>3;return(Q[B]|(ie<=5?0:Q[B+1]<<8))>>>ie&7}function je(Q,ce){var ie=ce&7,B=ce>>>3;return(Q[B]|(ie<=4?0:Q[B+1]<<8))>>>ie&15}function xe(Q,ce){var ie=ce&7,B=ce>>>3;return(Q[B]|(ie<=3?0:Q[B+1]<<8))>>>ie&31}function me(Q,ce){var ie=ce&7,B=ce>>>3;return(Q[B]|(ie<=1?0:Q[B+1]<<8))>>>ie&127}function $e(Q,ce,ie){var B=ce&7,L=ce>>>3,K=(1<<ie)-1,fe=Q[L]>>>B;return ie<8-B||(fe|=Q[L+1]<<8-B,ie<16-B)||(fe|=Q[L+2]<<16-B,ie<24-B)||(fe|=Q[L+3]<<24-B),fe&K}function Xe(Q,ce,ie){var B=ce&7,L=ce>>>3;return B<=5?Q[L]|=(ie&7)<<B:(Q[L]|=ie<<B&255,Q[L+1]=(ie&7)>>8-B),ce+3}function ge(Q,ce,ie){var B=ce&7,L=ce>>>3;return ie=(ie&1)<<B,Q[L]|=ie,ce+1}function qe(Q,ce,ie){var B=ce&7,L=ce>>>3;return ie<<=B,Q[L]|=ie&255,ie>>>=8,Q[L+1]=ie,ce+8}function st(Q,ce,ie){var B=ce&7,L=ce>>>3;return ie<<=B,Q[L]|=ie&255,ie>>>=8,Q[L+1]=ie&255,Q[L+2]=ie>>>8,ce+16}function Te(Q,ce){var ie=Q.length,B=2*ie>ce?2*ie:ce+5,L=0;if(ie>=ce)return Q;if(Pt){var K=Cb(B);if(Q.copy)Q.copy(K);else for(;L<Q.length;++L)K[L]=Q[L];return K}else if(V){var fe=new Uint8Array(B);if(fe.set)fe.set(Q);else for(;L<ie;++L)fe[L]=Q[L];return fe}return Q.length=B,Q}function Ke(Q){for(var ce=new Array(Q),ie=0;ie<Q;++ie)ce[ie]=0;return ce}function ze(Q,ce,ie){var B=1,L=0,K=0,fe=0,ve=0,pe=Q.length,be=V?new Uint16Array(32):Ke(32);for(K=0;K<32;++K)be[K]=0;for(K=pe;K<ie;++K)Q[K]=0;pe=Q.length;var we=V?new Uint16Array(pe):Ke(pe);for(K=0;K<pe;++K)be[L=Q[K]]++,B<L&&(B=L),we[K]=0;for(be[0]=0,K=1;K<=B;++K)be[K+16]=ve=ve+be[K-1]<<1;for(K=0;K<pe;++K)ve=Q[K],ve!=0&&(we[K]=be[ve+16]++);var Ne=0;for(K=0;K<pe;++K)if(Ne=Q[K],Ne!=0)for(ve=O(we[K],B)>>B-Ne,fe=(1<<B+4-Ne)-1;fe>=0;--fe)ce[ve|fe<<Ne]=Ne&15|K<<4;return B}var et=V?new Uint16Array(512):Ke(512),yt=V?new Uint16Array(32):Ke(32);if(!V){for(var lt=0;lt<512;++lt)et[lt]=0;for(lt=0;lt<32;++lt)yt[lt]=0}(function(){for(var Q=[],ce=0;ce<32;ce++)Q.push(5);ze(Q,yt,32);var ie=[];for(ce=0;ce<=143;ce++)ie.push(8);for(;ce<=255;ce++)ie.push(9);for(;ce<=279;ce++)ie.push(7);for(;ce<=287;ce++)ie.push(8);ze(ie,et,288)})();var Me=(function(){for(var ce=V?new Uint8Array(32768):[],ie=0,B=0;ie<J.length-1;++ie)for(;B<J[ie+1];++B)ce[B]=ie;for(;B<32768;++B)ce[B]=29;var L=V?new Uint8Array(259):[];for(ie=0,B=0;ie<Z.length-1;++ie)for(;B<Z[ie+1];++B)L[B]=ie;function K(ve,pe){for(var be=0;be<ve.length;){var we=Math.min(65535,ve.length-be),Ne=be+we==ve.length;for(pe.write_shift(1,+Ne),pe.write_shift(2,we),pe.write_shift(2,~we&65535);we-- >0;)pe[pe.l++]=ve[be++]}return pe.l}function fe(ve,pe){for(var be=0,we=0,Ne=V?new Uint16Array(32768):[];we<ve.length;){var Ie=Math.min(65535,ve.length-we);if(Ie<10){for(be=Xe(pe,be,+(we+Ie==ve.length)),be&7&&(be+=8-(be&7)),pe.l=be/8|0,pe.write_shift(2,Ie),pe.write_shift(2,~Ie&65535);Ie-- >0;)pe[pe.l++]=ve[we++];be=pe.l*8;continue}be=Xe(pe,be,+(we+Ie==ve.length)+2);for(var Re=0;Ie-- >0;){var Fe=ve[we];Re=(Re<<5^Fe)&32767;var Ve=-1,Je=0;if((Ve=Ne[Re])&&(Ve|=we&-32768,Ve>we&&(Ve-=32768),Ve<we))for(;ve[Ve+Je]==ve[we+Je]&&Je<250;)++Je;if(Je>2){Fe=L[Je],Fe<=22?be=qe(pe,be,re[Fe+1]>>1)-1:(qe(pe,be,3),be+=5,qe(pe,be,re[Fe-23]>>5),be+=3);var pt=Fe<8?0:Fe-4>>2;pt>0&&(st(pe,be,Je-Z[Fe]),be+=pt),Fe=ce[we-Ve],be=qe(pe,be,re[Fe]>>3),be-=3;var St=Fe<4?0:Fe-2>>1;St>0&&(st(pe,be,we-Ve-J[Fe]),be+=St);for(var wt=0;wt<Je;++wt)Ne[Re]=we&32767,Re=(Re<<5^ve[we])&32767,++we;Ie-=Je-1}else Fe<=143?Fe=Fe+48:be=ge(pe,be,1),be=qe(pe,be,re[Fe]),Ne[Re]=we&32767,++we}be=qe(pe,be,0)-1}return pe.l=(be+7)/8|0,pe.l}return function(pe,be){return pe.length<8?K(pe,be):fe(pe,be)}})();function ke(Q){var ce=Le(50+Math.floor(Q.length*1.1)),ie=Me(Q,ce);return ce.slice(0,ie)}var nt=V?new Uint16Array(32768):Ke(32768),tt=V?new Uint16Array(32768):Ke(32768),Ge=V?new Uint16Array(128):Ke(128),Ce=1,He=1;function Mt(Q,ce){var ie=xe(Q,ce)+257;ce+=5;var B=xe(Q,ce)+1;ce+=5;var L=je(Q,ce)+4;ce+=4;for(var K=0,fe=V?new Uint8Array(19):Ke(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,be=V?new Uint8Array(8):Ke(8),we=V?new Uint8Array(8):Ke(8),Ne=fe.length,Ie=0;Ie<L;++Ie)fe[W[Ie]]=K=de(Q,ce),pe<K&&(pe=K),be[K]++,ce+=3;var Re=0;for(be[0]=0,Ie=1;Ie<=pe;++Ie)we[Ie]=Re=Re+be[Ie-1]<<1;for(Ie=0;Ie<Ne;++Ie)(Re=fe[Ie])!=0&&(ve[Ie]=we[Re]++);var Fe=0;for(Ie=0;Ie<Ne;++Ie)if(Fe=fe[Ie],Fe!=0){Re=re[ve[Ie]]>>8-Fe;for(var Ve=(1<<7-Fe)-1;Ve>=0;--Ve)Ge[Re|Ve<<Fe]=Fe&7|Ie<<3}var Je=[];for(pe=1;Je.length<ie+B;)switch(Re=Ge[me(Q,ce)],ce+=Re&7,Re>>>=3){case 16:for(K=3+ye(Q,ce),ce+=2,Re=Je[Je.length-1];K-- >0;)Je.push(Re);break;case 17:for(K=3+de(Q,ce),ce+=3;K-- >0;)Je.push(0);break;case 18:for(K=11+me(Q,ce),ce+=7;K-- >0;)Je.push(0);break;default:Je.push(Re),pe<Re&&(pe=Re);break}var pt=Je.slice(0,ie),St=Je.slice(ie);for(Ie=ie;Ie<286;++Ie)pt[Ie]=0;for(Ie=B;Ie<30;++Ie)St[Ie]=0;return Ce=ze(pt,nt,286),He=ze(St,tt,30),ce}function Ls(Q,ce){if(Q[0]==3&&!(Q[1]&3))return[di(ce),2];for(var ie=0,B=0,L=Cb(ce||1<<18),K=0,fe=L.length>>>0,ve=0,pe=0;(B&1)==0;){if(B=de(Q,ie),ie+=3,B>>>1)B>>1==1?(ve=9,pe=5):(ie=Mt(Q,ie),ve=Ce,pe=He);else{ie&7&&(ie+=8-(ie&7));var be=Q[ie>>>3]|Q[(ie>>>3)+1]<<8;if(ie+=32,be>0)for(!ce&&fe<K+be&&(L=Te(L,K+be),fe=L.length);be-- >0;)L[K++]=Q[ie>>>3],ie+=8;continue}for(;;){!ce&&fe<K+32767&&(L=Te(L,K+32767),fe=L.length);var we=$e(Q,ie,ve),Ne=B>>>1==1?et[we]:nt[we];if(ie+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)L[K++]=Ne;else{if(Ne==256)break;Ne-=257;var Ie=Ne<8?0:Ne-4>>2;Ie>5&&(Ie=0);var Re=K+Z[Ne];Ie>0&&(Re+=$e(Q,ie,Ie),ie+=Ie),we=$e(Q,ie,pe),Ne=B>>>1==1?yt[we]:tt[we],ie+=Ne&15,Ne>>>=4;var Fe=Ne<4?0:Ne-2>>1,Ve=J[Ne];for(Fe>0&&(Ve+=$e(Q,ie,Fe),ie+=Fe),!ce&&fe<Re&&(L=Te(L,Re+100),fe=L.length);K<Re;)L[K]=L[K-Ve],++K}}}return ce?[L,ie+7>>>3]:[L.slice(0,K),ie+7>>>3]}function Ta(Q,ce){var ie=Q.slice(Q.l||0),B=Ls(ie,ce);return Q.l+=B[1],B[0]}function ws(Q,ce){if(Q)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function lr(Q,ce){var ie=Q;vs(ie,0);var B=[],L=[],K={FileIndex:B,FullPaths:L};N(K,{root:ce.root});for(var fe=ie.length-4;(ie[fe]!=80||ie[fe+1]!=75||ie[fe+2]!=5||ie[fe+3]!=6)&&fe>=0;)--fe;ie.l=fe+4,ie.l+=4;var ve=ie.read_shift(2);ie.l+=6;var pe=ie.read_shift(4);for(ie.l=pe,fe=0;fe<ve;++fe){ie.l+=20;var be=ie.read_shift(4),we=ie.read_shift(4),Ne=ie.read_shift(2),Ie=ie.read_shift(2),Re=ie.read_shift(2);ie.l+=8;var Fe=ie.read_shift(4),Ve=o(ie.slice(ie.l+Ne,ie.l+Ne+Ie));ie.l+=Ne+Ie+Re;var Je=ie.l;ie.l=Fe+4,qa(ie,be,we,K,Ve),ie.l=Je}return K}function qa(Q,ce,ie,B,L){Q.l+=2;var K=Q.read_shift(2),fe=Q.read_shift(2),ve=l(Q);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var pe=Q.read_shift(4),be=Q.read_shift(4),we=Q.read_shift(4),Ne=Q.read_shift(2),Ie=Q.read_shift(2),Re="",Fe=0;Fe<Ne;++Fe)Re+=String.fromCharCode(Q[Q.l++]);if(Ie){var Ve=o(Q.slice(Q.l,Q.l+Ie));(Ve[21589]||{}).mt&&(ve=Ve[21589].mt),((L||{})[21589]||{}).mt&&(ve=L[21589].mt)}Q.l+=Ie;var Je=Q.slice(Q.l,Q.l+be);switch(fe){case 8:Je=P(Q,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var pt=!1;K&8&&(pe=Q.read_shift(4),pe==134695760&&(pe=Q.read_shift(4),pt=!0),be=Q.read_shift(4),we=Q.read_shift(4)),be!=ce&&ws(pt,"Bad compressed size: "+ce+" != "+be),we!=ie&&ws(pt,"Bad uncompressed size: "+ie+" != "+we),wo(B,Re,Je,{unsafe:!0,mt:ve})}function Nr(Q,ce){var ie=ce||{},B=[],L=[],K=Le(1),fe=ie.compression?8:0,ve=0,pe=0,be=0,we=0,Ne=0,Ie=Q.FullPaths[0],Re=Ie,Fe=Q.FileIndex[0],Ve=[],Je=0;for(pe=1;pe<Q.FullPaths.length;++pe)if(Re=Q.FullPaths[pe].slice(Ie.length),Fe=Q.FileIndex[pe],!(!Fe.size||!Fe.content||Re=="Sh33tJ5")){var pt=we,St=Le(Re.length);for(be=0;be<Re.length;++be)St.write_shift(1,Re.charCodeAt(be)&127);St=St.slice(0,St.l),Ve[Ne]=C6.buf(Fe.content,0);var wt=Fe.content;fe==8&&(wt=C(wt)),K=Le(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,ve),K.write_shift(2,fe),Fe.mt?i(K,Fe.mt):K.write_shift(4,0),K.write_shift(-4,Ve[Ne]),K.write_shift(4,wt.length),K.write_shift(4,Fe.content.length),K.write_shift(2,St.length),K.write_shift(2,0),we+=K.length,B.push(K),we+=St.length,B.push(St),we+=wt.length,B.push(wt),K=Le(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,ve),K.write_shift(2,fe),K.write_shift(4,0),K.write_shift(-4,Ve[Ne]),K.write_shift(4,wt.length),K.write_shift(4,Fe.content.length),K.write_shift(2,St.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,pt),Je+=K.l,L.push(K),Je+=St.length,L.push(St),++Ne}return K=Le(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Ne),K.write_shift(2,Ne),K.write_shift(4,Je),K.write_shift(4,we),K.write_shift(2,0),ls([ls(B),ls(L),K])}var dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kt(Q,ce){if(Q.ctype)return Q.ctype;var ie=Q.name||"",B=ie.match(/\.([^\.]+)$/);return B&&dt[B[1]]||ce&&(B=(ie=ce).match(/[\.\\]([^\.\\])+$/),B&&dt[B[1]])?dt[B[1]]:"application/octet-stream"}function xr(Q){for(var ce=ac(Q),ie=[],B=0;B<ce.length;B+=76)ie.push(ce.slice(B,B+76));return ie.join(`\r
`)+`\r
`}function Yr(Q){var ce=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var we=be.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ie=[],B=ce.split(`\r
`),L=0;L<B.length;++L){var K=B[L];if(K.length==0){ie.push("");continue}for(var fe=0;fe<K.length;){var ve=76,pe=K.slice(fe,fe+ve);pe.charAt(ve-1)=="="?ve--:pe.charAt(ve-2)=="="?ve-=2:pe.charAt(ve-3)=="="&&(ve-=3),pe=K.slice(fe,fe+ve),fe+=ve,fe<K.length&&(pe+="="),ie.push(pe)}}return ie.join(`\r
`)}function Xn(Q){for(var ce=[],ie=0;ie<Q.length;++ie){for(var B=Q[ie];ie<=Q.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+Q[++ie];ce.push(B)}for(var L=0;L<ce.length;++L)ce[L]=ce[L].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return ha(ce.join(`\r
`))}function Jy(Q,ce,ie){for(var B="",L="",K="",fe,ve=0;ve<10;++ve){var pe=ce[ve];if(!pe||pe.match(/^\s*$/))break;var be=pe.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":B=be[2].trim();break;case"content-type":K=be[2].trim();break;case"content-transfer-encoding":L=be[2].trim();break}}switch(++ve,L.toLowerCase()){case"base64":fe=ha(ja(ce.slice(ve).join("")));break;case"quoted-printable":fe=Xn(ce.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var we=wo(Q,B.slice(ie.length),fe,{unsafe:!0});K&&(we.ctype=K)}function od(Q,ce){if(X(Q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ie=ce&&ce.root||"",B=(Pt&&Buffer.isBuffer(Q)?Q.toString("binary"):X(Q)).split(`\r
`),L=0,K="";for(L=0;L<B.length;++L)if(K=B[L],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),ie||(ie=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,ie.length)!=ie))for(;ie.length>0&&(ie=ie.slice(0,ie.length-1),ie=ie.slice(0,ie.lastIndexOf("/")+1),K.slice(0,ie.length)!=ie););var fe=(B[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var ve="--"+(fe[1]||""),pe=[],be=[],we={FileIndex:pe,FullPaths:be};N(we);var Ne,Ie=0;for(L=0;L<B.length;++L){var Re=B[L];Re!==ve&&Re!==ve+"--"||(Ie++&&Jy(we,B.slice(Ne,L),ie),Ne=L)}return we}function ef(Q,ce){var ie=ce||{},B=ie.boundary||"SheetJS";B="------="+B;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],K=Q.FullPaths[0],fe=K,ve=Q.FileIndex[0],pe=1;pe<Q.FullPaths.length;++pe)if(fe=Q.FullPaths[pe].slice(K.length),ve=Q.FileIndex[pe],!(!ve.size||!ve.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var be=ve.content,we=Pt&&Buffer.isBuffer(be)?be.toString("binary"):X(be),Ne=0,Ie=Math.min(1024,we.length),Re=0,Fe=0;Fe<=Ie;++Fe)(Re=we.charCodeAt(Fe))>=32&&Re<128&&++Ne;var Ve=Ne>=Ie*4/5;L.push(B),L.push("Content-Location: "+(ie.root||"file:///C:/SheetJS/")+fe),L.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),L.push("Content-Type: "+kt(ve,fe)),L.push(""),L.push(Ve?Yr(we):xr(we))}return L.push(B+`--\r
`),L.join(`\r
`)}function tf(Q){var ce={};return N(ce,Q),ce}function wo(Q,ce,ie,B){var L=B&&B.unsafe;L||N(Q);var K=!L&&mt.find(Q,ce);if(!K){var fe=Q.FullPaths[0];ce.slice(0,fe.length)==fe?fe=ce:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+ce).replace("//","/")),K={name:n(ce),type:2},Q.FileIndex.push(K),Q.FullPaths.push(fe),L||mt.utils.cfb_gc(Q)}return K.content=ie,K.size=ie?ie.length:0,B&&(B.CLSID&&(K.clsid=B.CLSID),B.mt&&(K.mt=B.mt),B.ct&&(K.ct=B.ct)),K}function rf(Q,ce){N(Q);var ie=mt.find(Q,ce);if(ie){for(var B=0;B<Q.FileIndex.length;++B)if(Q.FileIndex[B]==ie)return Q.FileIndex.splice(B,1),Q.FullPaths.splice(B,1),!0}return!1}function Zy(Q,ce,ie){N(Q);var B=mt.find(Q,ce);if(B){for(var L=0;L<Q.FileIndex.length;++L)if(Q.FileIndex[L]==B)return Q.FileIndex[L].name=n(ie),Q.FullPaths[L]=ie,!0}return!1}function sf(Q){k(Q,!0)}return t.find=D,t.read=E,t.parse=d,t.write=oe,t.writeFile=U,t.utils={cfb_new:tf,cfb_add:wo,cfb_del:rf,cfb_mov:Zy,cfb_gc:sf,ReadShift:$o,CheckField:PE,prep_blob:vs,bconcat:ls,use_zlib:F,_deflateRaw:ke,_inflateRaw:Ta,consts:ee},t})();function A6(e){return typeof e=="string"?dm(e):Array.isArray(e)?e6(e):e}function Lc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=dm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?hn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([A6(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=vi(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function _6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Pr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Rb(e,t){for(var r=[],a=Pr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function mm(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function fm(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function k6(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var ou=new Date(1899,11,30,0,0,0);function Qr(e,t){var r=e.getTime(),a=ou.getTime()+(e.getTimezoneOffset()-ou.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var mE=new Date,I6=ou.getTime()+(mE.getTimezoneOffset()-ou.getTimezoneOffset())*6e4,Fb=mE.getTimezoneOffset();function hm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+I6),t.getTimezoneOffset()!==Fb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Fb)*6e4),t}function D6(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var Lb=new Date("2017-02-19T19:06:09.000Z"),fE=isNaN(Lb.getFullYear())?new Date("2/19/17"):Lb,P6=fE.getFullYear()==2017;function hr(e,t){var r=new Date(e);if(P6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(fE.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Yi(e,t){if(Pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return hn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return hn(eE(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return hn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return hn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function pr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pr(e[r]));return t}function Ir(e,t){for(var r="";r.length<t;)r+=e;return r}function tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var O6=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vl(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&O6.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var R6=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}})();function hE(e){return e?e.content&&e.type?Yi(e.content,!0):e.data?Fo(e.data):e.asNodeBuffer&&Pt?Fo(e.asNodeBuffer().toString("binary")):e.asBinary?Fo(e.asBinary()):e._data&&e._data.getContent?Fo(Yi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function pE(e){if(!e)return null;if(e.data)return Eb(e.data);if(e.asNodeBuffer&&Pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Eb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function F6(e){return e&&e.name.slice(-4)===".bin"?pE(e):hE(e)}function Ra(e,t){for(var r=e.FullPaths||Pr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function xg(e,t){var r=Ra(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Vr(e,t,r){if(!r)return F6(xg(e,t));if(!t)return null;try{return Vr(e,t)}catch{return null}}function pa(e,t,r){if(!r)return hE(xg(e,t));if(!t)return null;try{return pa(e,t)}catch{return null}}function L6(e,t,r){return pE(xg(e,t))}function Mb(e){for(var t=e.FullPaths||Pr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function It(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Pt?a=$n(r):a=t6(r),mt.utils.cfb_add(e,t,a)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function gg(){return mt.utils.cfb_new()}function xE(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Mo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ur=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B6=/<[^>]*>/g,Fs=Ur.match(Bb)?Bb:B6,z6=/<\w*:/,$6=/<(\/?)\w+:/;function jt(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(M6),o=0,c="",u=0,d="",m="",f=1;if(l)for(u=0;u!=l.length;++u){for(m=l[u],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(d=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(f=(n=m.charCodeAt(i+1))==34||n==39?1:0,c=m.slice(i+1+f,m.length-f),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,a[d.toLowerCase()]=c;else{var h=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(a[h]&&d.slice(o-3,o)=="ext")continue;a[h]=c,a[h.toLowerCase()]=c}}return a}function jn(e){return e.replace($6,"<$1")}var gE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vg=mm(gE),Vt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return gE[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}})(),yg=/[&<>'"]/g,U6=/[\u0000-\u0008\u000b-\u001f]/g;function nr(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(U6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zb(e){return nr(e).replace(/ /g,"_x0020_")}var vE=/[\u0000-\u001f]/g;function bg(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(/\n/g,"<br/>").replace(vE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function W6(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(vE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var $b=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function H6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mf(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ub(e){var t=di(2*e.length),r,a,n=1,i=0,l=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Wb(e){return $n(e,"binary").toString("utf8")}var gd="foo bar baz",ir=Pt&&(Wb(gd)==mf(gd)&&Wb||Ub(gd)==mf(gd)&&Ub)||mf,hn=Pt?function(e){return $n(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},ic=(function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),yE=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),V6=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),G6=/<\/?(?:vt:)?variant>/g,q6=/<(?:vt:)([^>]*)>([\s\S]*)</;function Hb(e,t){var r=jt(e),a=e.match(V6(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var l=i.replace(G6,"").match(q6);l&&n.push({v:ir(l[2]),t:l[1]})}),n}var bE=/(^\s|\s$|\n)/;function bs(e,t){return"<"+e+(t.match(bE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function lc(e){return Pr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ze(e,t,r){return"<"+e+(r!=null?lc(r):"")+(t!=null?(t.match(bE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Hp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function K6(e,t){switch(typeof e){case"string":var r=Ze("vt:lpwstr",nr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",nr(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",Hp(e));throw new Error("Unable to serialize "+e)}function jg(e){if(Pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ir(vi(fg(e)));throw new Error("Bad input format: expected Buffer or string")}var oc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Jr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ol=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Y6(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function X6(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,l=a?-t:t;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var Vb=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Gb=Pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$n(t)})):Vb(e)}:Vb,qb=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Tn(e,n)));return a.join("").replace(Hs,"")},wg=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Hs,""):qb(e,t,r)}:qb,Kb=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},jE=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Kb(e,t,r)}:Kb,Yb=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Cl(e,n)));return a.join("")},Mc=Pt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Yb(t,r,a)}:Yb,wE=function(e,t){var r=fa(e,t);return r>0?Mc(e,t+4,t+4+r-1):""},NE=wE,SE=function(e,t){var r=fa(e,t);return r>0?Mc(e,t+4,t+4+r-1):""},EE=SE,TE=function(e,t){var r=2*fa(e,t);return r>0?Mc(e,t+4,t+4+r-1):""},CE=TE,AE=function(t,r){var a=fa(t,r);return a>0?wg(t,r+4,r+4+a):""},_E=AE,kE=function(e,t){var r=fa(e,t);return r>0?Mc(e,t+4,t+4+r):""},IE=kE,DE=function(e,t){return Y6(e,t)},cu=DE,Ng=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pt&&(NE=function(t,r){if(!Buffer.isBuffer(t))return wE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},EE=function(t,r){if(!Buffer.isBuffer(t))return SE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},CE=function(t,r){if(!Buffer.isBuffer(t))return TE(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},_E=function(t,r){if(!Buffer.isBuffer(t))return AE(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},IE=function(t,r){if(!Buffer.isBuffer(t))return kE(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},cu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):DE(t,r)},Ng=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Cl=function(e,t){return e[t]},Tn=function(e,t){return e[t+1]*256+e[t]},J6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_i=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Z6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $o(e,t){var r="",a,n,i=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,Pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Tn(this,u)),u+=2;e*=2;break;case"utf8":r=Mc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=wg(this,this.l,this.l+e);break;case"wstr":return $o.call(this,e,"dbcs");case"lpstr-ansi":r=NE(this,this.l),e=4+fa(this,this.l);break;case"lpstr-cp":r=EE(this,this.l),e=4+fa(this,this.l);break;case"lpwstr":r=CE(this,this.l),e=4+2*fa(this,this.l);break;case"lpp4":e=4+fa(this,this.l),r=_E(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fa(this,this.l),r=IE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Cl(this,this.l+e++))!==0;)i.push(xd(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=Tn(this,this.l+e))!==0;)i.push(xd(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Cl(this,u),this.l=u+1,o=$o.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(xd(Tn(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Cl(this,u),this.l=u+1,o=$o.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(xd(Cl(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return a=Cl(this,this.l),this.l++,a;case 2:return a=(t==="i"?J6:Tn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?_i:Z6)(this,this.l),this.l+=4,a):(n=fa(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=cu(this,this.l):n=cu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=jE(this,this.l,e);break}}return this.l+=e,r}var Q6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},eF=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},tF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function rF(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)tF(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Q6(this,t,this.l);break;case 8:if(a=8,r==="f"){X6(this,t,this.l);break}case 16:break;case-4:a=4,eF(this,t,this.l);break}return this.l+=a,this}function PE(e,t){var r=jE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function vs(e,t){e.l=t,e.read_shift=$o,e.chk=PE,e.write_shift=rF}function Os(e,t){e.l+=t}function Le(e){var t=di(e);return vs(t,0),t}function Un(e,t,r){if(e){var a,n,i;vs(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=hc[o]||hc[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function ta(){var e=[],t=Pt?256:2048,r=function(u){var d=Le(u);return vs(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},l=function(){return n(),ls(e)},o=function(u){n(),a=u,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function We(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=hc[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&Ng(r)&&e.push(r)}}function Uo(e,t,r){var a=pr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Xb(e,t,r){var a=pr(e);return a.s=Uo(a.s,t.s,r),a.e=Uo(a.e,t.s,r),a}function Wo(e,t){if(e.cRel&&e.c<0)for(e=pr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=bt(e);return!e.cRel&&e.cRel!=null&&(r=nF(r)),!e.rRel&&e.rRel!=null&&(r=sF(r)),r}function ff(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Er(e.s.c)+":"+(e.e.cRel?"":"$")+Er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$r(e.s.r)+":"+(e.e.rRel?"":"$")+$r(e.e.r):Wo(e.s,t.biff)+":"+Wo(e.e,t.biff)}function Sg(e){return parseInt(aF(e),10)-1}function $r(e){return""+(e+1)}function sF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aF(e){return e.replace(/\$(\d+)$/,"$1")}function Eg(e){for(var t=iF(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Er(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function nF(e){return e.replace(/^([A-Z])/,"$$$1")}function iF(e){return e.replace(/^\$([A-Z])/,"$1")}function lF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function bt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sa(e){var t=e.indexOf(":");return t==-1?{s:Tr(e),e:Tr(e)}:{s:Tr(e.slice(0,t)),e:Tr(e.slice(t+1))}}function _t(e,t){return typeof t>"u"||typeof t=="number"?_t(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function qt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function Jb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=$a(e.z,r?Qr(t):t)}catch{}try{return e.w=$a((e.XF||{}).numFmtId||(r?14:0),r?Qr(t):t)}catch{return""+t}}function Fn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Wn[e.v]||e.v:t==null?Jb(e,e.v):Jb(e,t))}function yi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function OE(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Tr(a.origin):a.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=qt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var h={v:t[m][f]},x=l+m,p=o+f;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))h=t[m][f];else if(Array.isArray(h.v)&&(h.f=t[m][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||vt[14],a.cellDates?(h.t="d",h.w=$a(h.z,Qr(h.v))):(h.t="n",h.v=Qr(h.v),h.w=$a(h.z,h.v))):h.t="s";if(n)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(h.z=i[x][p].z),i[x][p]=h;else{var g=bt({c:p,r:x});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return u.s.c<1e7&&(i["!ref"]=_t(u)),i}function co(e,t){return OE(null,e,t)}function oF(e){return e.read_shift(4,"i")}function rn(e,t){return t||(t=Le(4)),t.write_shift(4,e),t}function Ds(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function os(e,t){var r=!1;return t==null&&(r=!0,t=Le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dF(e,t){return t||(t=Le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Tg(e,t){var r=e.l,a=e.read_shift(1),n=Ds(e),i=[],l={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(cF(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function uF(e,t){var r=!1;return t==null&&(r=!0,t=Le(15+4*e.t.length)),t.write_shift(1,0),os(e.t,t),r?t.slice(0,t.l):t}var mF=Tg;function fF(e,t){var r=!1;return t==null&&(r=!0,t=Le(23+4*e.t.length)),t.write_shift(1,1),os(e.t,t),t.write_shift(4,1),dF({},t),r?t.slice(0,t.l):t}function Ha(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function cl(e,t){return t==null&&(t=Le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function dl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ul(e,t){return t==null&&(t=Le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var hF=Ds,RE=os;function Cg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function du(e,t){var r=!1;return t==null&&(r=!0,t=Le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var pF=Ds,Vp=Cg,Ag=du;function _g(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?cu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_i(t,0)>>2;return r?n/100:n}function FE(e,t){t==null&&(t=Le(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function LE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function xF(e,t){return t||(t=Le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ml=LE,uo=xF;function Is(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Xi(e,t){return(t||Le(8)).write_shift(8,e,"f")}function gF(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=Li[n];u&&(t.rgb=dc(u));break;case 2:t.rgb=dc([l,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function uu(e,t){if(t||(t=Le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function vF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function yF(e,t){t||(t=Le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ME(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bF(e){return ME(e,1)}function jF(e){return ME(e,2)}var kg=2,Ys=3,vd=11,Zb=12,mu=19,yd=64,wF=65,NF=71,SF=4108,EF=4126,ns=80,BE=81,TF=[ns,BE],Gp={1:{n:"CodePage",t:kg},2:{n:"Category",t:ns},3:{n:"PresentationFormat",t:ns},4:{n:"ByteCount",t:Ys},5:{n:"LineCount",t:Ys},6:{n:"ParagraphCount",t:Ys},7:{n:"SlideCount",t:Ys},8:{n:"NoteCount",t:Ys},9:{n:"HiddenCount",t:Ys},10:{n:"MultimediaClipCount",t:Ys},11:{n:"ScaleCrop",t:vd},12:{n:"HeadingPairs",t:SF},13:{n:"TitlesOfParts",t:EF},14:{n:"Manager",t:ns},15:{n:"Company",t:ns},16:{n:"LinksUpToDate",t:vd},17:{n:"CharacterCount",t:Ys},19:{n:"SharedDoc",t:vd},22:{n:"HyperlinksChanged",t:vd},23:{n:"AppVersion",t:Ys,p:"version"},24:{n:"DigSig",t:wF},26:{n:"ContentType",t:ns},27:{n:"ContentStatus",t:ns},28:{n:"Language",t:ns},29:{n:"Version",t:ns},255:{},2147483648:{n:"Locale",t:mu},2147483651:{n:"Behavior",t:mu},1919054434:{}},qp={1:{n:"CodePage",t:kg},2:{n:"Title",t:ns},3:{n:"Subject",t:ns},4:{n:"Author",t:ns},5:{n:"Keywords",t:ns},6:{n:"Comments",t:ns},7:{n:"Template",t:ns},8:{n:"LastAuthor",t:ns},9:{n:"RevNumber",t:ns},10:{n:"EditTime",t:yd},11:{n:"LastPrinted",t:yd},12:{n:"CreatedDate",t:yd},13:{n:"ModifiedDate",t:yd},14:{n:"PageCount",t:Ys},15:{n:"WordCount",t:Ys},16:{n:"CharCount",t:Ys},17:{n:"Thumbnail",t:NF},18:{n:"Application",t:ns},19:{n:"DocSecurity",t:Ys},255:{},2147483648:{n:"Locale",t:mu},2147483651:{n:"Behavior",t:mu},1919054434:{}},Qb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function AF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _F=AF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=pr(_F),Wn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Kp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ig(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function kF(e){var t=Ig();if(!e||!e.match)return t;var r={};if((e.match(Fs)||[]).forEach(function(a){var n=jt(a);switch(n[0].replace(z6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Kp[n.ContentType]]!==void 0&&t[Kp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Jr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $E(e,t){var r=k6(Kp),a=[],n;a[a.length]=Ur,a[a.length]=Ze("Types",null,{xmlns:Jr.CT,"xmlns:xsd":Jr.xsd,"xmlns:xsi":Jr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ze("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Ze("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:bd[c][t.bookType]||bd[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Ze("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:bd[c][t.bookType]||bd[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Ze("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ho(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Fs)||[]).forEach(function(n){var i=jt(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Mo(i.Target,t);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function Ll(e){var t=[Ur,Ze("Relationships",null,{xmlns:Jr.RELS})];return Pr(e["!id"]).forEach(function(r){t[t.length]=Ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function sr(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[Rt.HLINK,Rt.XPATH,Rt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var IF="application/vnd.oasis.opendocument.spreadsheet";function DF(e,t){for(var r=jg(e),a,n;a=oc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=jt(a[0],!1),n.path=="/"&&n.type!==IF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function PF(e){var t=[Ur];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function e1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function RF(e){var t=[Ur];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(e1(e[r][0],e[r][1])),t.push(OF("",e[r][0]));return t.push(e1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function UE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+au.version+"</meta:generator></office:meta></office:document-meta>"}var za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FF=(function(){for(var e=new Array(za.length),t=0;t<za.length;++t){var r=za[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function WE(e){var t={};e=ir(e);for(var r=0;r<za.length;++r){var a=za[r],n=e.match(FF[r]);n!=null&&n.length>0&&(t[a[1]]=Vt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=hr(t[a[1]]))}return t}function hf(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=nr(t),a[a.length]=r?Ze(e,t,r):bs(e,t))}function HE(e,t){var r=t||{},a=[Ur,Ze("cp:coreProperties",null,{"xmlns:cp":Jr.CORE_PROPS,"xmlns:dc":Jr.dc,"xmlns:dcterms":Jr.dcterms,"xmlns:dcmitype":Jr.dcmitype,"xmlns:xsi":Jr.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&hf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Hp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&hf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Hp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=za.length;++i){var l=za[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&hf(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Mi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],VE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function GE(e,t,r,a){var n=[];if(typeof e=="string")n=Hb(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?Hb(t,a).map(function(d){return d.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function LF(e,t,r){var a={};return t||(t={}),e=ir(e),Mi.forEach(function(n){var i=(e.match(ic(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Vt(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&GE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function qE(e){var t=[],r=Ze;return e||(e={}),e.Application="SheetJS",t[t.length]=Ur,t[t.length]=Ze("Properties",null,{xmlns:Jr.EXT_PROPS,"xmlns:vt":Jr.vt}),Mi.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=nr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+nr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var MF=/<[^>]+>[^<]*/g;function BF(e,t){var r={},a="",n=e.match(MF);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=jt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Vt(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=Vt(d);break;case"bool":r[a]=fr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=hr(d);break;case"cy":case"error":r[a]=Vt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function KE(e){var t=[Ur,Ze("Properties",null,{xmlns:Jr.CUST_PROPS,"xmlns:vt":Jr.vt})];if(!e)return t.join("");var r=1;return Pr(e).forEach(function(n){++r,t[t.length]=Ze("property",K6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Yp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pf;function zF(e,t,r){pf||(pf=mm(Yp)),t=pf[t]||t,e[t]=r}function $F(e,t){var r=[];return Pr(Yp).map(function(a){for(var n=0;n<za.length;++n)if(za[n][1]==a)return za[n];for(n=0;n<Mi.length;++n)if(Mi[n][1]==a)return Mi[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(bs(Yp[a[1]]||a[1],n))}}),Ze("DocumentProperties",r.join(""),{xmlns:ma.o})}function UF(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Pr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<za.length;++l)if(i==za[l][1])return;for(l=0;l<Mi.length;++l)if(i==Mi[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Ze(zb(i),o,{"dt:dt":c}))}}),t&&Pr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Ze(zb(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+ma.o+'">'+n.join("")+"</"+a+">"}function Dg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=Le(8);return l.write_shift(4,a),l.write_shift(4,n),l}function YE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function XE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function JE(e,t,r){return t===31?XE(e):YE(e,t,r)}function Xp(e,t,r){return JE(e,t,r===!1?0:4)}function HF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return JE(e,t,0)}function VF(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Hs,""),e.l-n&2&&(e.l+=2)}return r}function GF(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Hs,"");return r}function qF(e){var t=e.l,r=fu(e,BE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=fu(e,Ys);return[r,a]}function KF(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(qF(e));return r}function t1(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Hs,"").replace(Lo,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function ZE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function YF(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function fu(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==Zb&&a!==t&&TF.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Zb?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return YE(e,a,4).replace(Hs,"");case 31:return XE(e);case 64:return Dg(e);case 65:return ZE(e);case 71:return YF(e);case 80:return Xp(e,a,!i.raw).replace(Hs,"");case 81:return HF(e,a).replace(Hs,"");case 4108:return KF(e);case 4126:case 4127:return a==4127?VF(e):GF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function r1(e,t){var r=Le(4),a=Le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Le(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=WF(t);break;case 31:case 80:for(a=Le(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ls([r,a])}function s1(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,u={};for(l=0;l!=n;++l){var d=e.read_shift(4),m=e.read_shift(4);i[l]=[d,m+r]}i.sort(function(w,y){return w[1]-y[1]});var f={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var h=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(h=!1,e.l=i[l][1]),h)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var x=t[i[l][0]];if(f[x.n]=fu(e,x.t,{raw:!0}),x.p==="version"&&(f[x.n]=String(f[x.n]>>16)+"."+("0000"+String(f[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(f[x.n]){case 0:f[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qa(o=f[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[x.n])}}else if(i[l][0]===1){if(o=f.CodePage=fu(e,kg),Qa(o),c!==-1){var p=e.l;e.l=i[c][1],u=t1(e,o),e.l=p}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}u=t1(e,o)}else{var g=u[i[l][0]],j;switch(e[e.l]){case 65:e.l+=4,j=ZE(e);break;case 30:e.l+=4,j=Xp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=Xp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=Mr(e,4);break;case 64:e.l+=4,j=hr(Dg(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=j}}return e.l=r+a,f}var QE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function XF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function a1(e,t,r){var a=Le(8),n=[],i=[],l=8,o=0,c=Le(8),u=Le(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),n.push(u),l+=8+c.length,!t){u=Le(8),u.write_shift(4,0),n.unshift(u);var d=[Le(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(c=Le(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ls(d),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(QE.indexOf(e[o][0])>-1||VE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],h=0;if(t){h=+t[e[o][0]];var x=r[h];if(x.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=r1(x.t,f)}else{var g=XF(f);g==-1&&(g=31,f=String(f)),c=r1(g,f)}i.push(c),u=Le(8),u.write_shift(4,t?h:2+o),n.push(u),l+=8+c.length}var j=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,j),j+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),ls([a].concat(n).concat(i))}function n1(e,t,r){var a=e.content;if(!a)return{};vs(a,0);var n,i,l,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),d=a.read_shift(16);if(d!==mt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),c=a.read_shift(4));var m=s1(a,t),f={SystemIdentifier:u};for(var h in m)f[h]=m[h];if(f.FMTID=i,n===1)return f;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=s1(a,null)}catch{}for(h in x)f[h]=x[h];return f.FMTID=[i,l],f}function i1(e,t,r,a,n,i){var l=Le(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var c=a1(e,r,a);if(o.push(c),n){var u=a1(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(u)}return ls(o)}function Qn(e,t){return e.read_shift(t),null}function JF(e,t){t||(t=Le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ZF(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Mr(e,t){return e.read_shift(t)===1}function Bs(e,t){return t||(t=Le(2)),t.write_shift(2,+!!e),t}function Gr(e){return e.read_shift(2,"u")}function Fa(e,t){return t||(t=Le(2)),t.write_shift(2,e),t}function eT(e,t){return ZF(e,t,Gr)}function QF(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tT(e,t,r){return r||(r=Le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Bc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function eL(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,i=1+(r&1),l=0,o,c={};n&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*l),a&&(e.l+=o),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function tL(e){var t=e.t||"",r=Le(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Le(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ls(n)}function Ji(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function zc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Ji(e,a,r)}function fl(e,t,r){if(r.biff>5)return zc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rT(e,t,r){return r||(r=Le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function rL(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sL(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Hs,"");return a&&(e.l+=24),n}function aL(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Hs,"");return r+l}function nL(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sL(e);case"0303000000000000c000000000000046":return aL(e);default:throw new Error("Unsupported Moniker "+r)}}function jd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Hs,""):"";return r}function l1(e,t){t||(t=Le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function iL(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,l,o,c,u="",d,m;n&16&&(i=jd(e,r-e.l)),n&128&&(l=jd(e,r-e.l)),(n&257)===257&&(o=jd(e,r-e.l)),(n&257)===1&&(c=nL(e,r-e.l)),n&8&&(u=jd(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(m=Dg(e)),e.l=r;var f=l||o||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return d&&(h.guid=d),m&&(h.time=m),i&&(h.Tooltip=i),h}function lL(e){var t=Le(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),l1(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&l1(n>-1?a.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function sT(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function aT(e,t){var r=sT(e);return r[3]=0,r}function wn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Zi(e,t,r,a){return a||(a=Le(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function oL(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function cL(e,t,r){return t===0?"":fl(e,t,r)}function dL(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,i,l]}function nT(e){var t=e.read_shift(2),r=_g(e);return[t,r]}function uL(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Bc(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function pm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function iT(e,t){return t||(t=Le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function lT(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var mL=lT;function oT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function fL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function hL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ns(e){e.l+=2,e.l+=e.read_shift(2)}var pL={0:Ns,4:Ns,5:Ns,6:Ns,7:hL,8:Ns,9:Ns,10:Ns,11:Ns,12:Ns,13:fL,14:Ns,15:Ns,16:Ns,17:Ns,18:Ns,19:Ns,20:Ns,21:oT};function xL(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(pL[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function wd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Pg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Le(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function gL(e,t){return t===0||e.read_shift(2),1200}function vL(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=fl(e,0,r);return e.read_shift(t+a-e.l),n}function yL(e,t){var r=!t||t.biff==8,a=Le(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function bL(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function jL(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Bc(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function wL(e,t){var r=!t||t.biff>=8?2:1,a=Le(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function NL(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<r;++l)i.push(eL(e));return i.Count=a,i.Unique=n,i}function SL(e,t){var r=Le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=tL(e[n]);var i=ls([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function EL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function TL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function CL(e){var t=oL(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function AL(e){return e.read_shift(2),e.read_shift(4)}function o1(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function _L(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function kL(){var e=Le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function IL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function DL(e){var t=Le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function PL(){}function OL(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Bc(e,0,r),a}function RL(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=Le(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function FL(e){var t=wn(e);return t.isst=e.read_shift(4),t}function LL(e,t,r,a){var n=Le(10);return Zi(e,t,a,n),n.write_shift(4,r),n}function ML(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=wn(e);r.biff==2&&e.l++;var i=zc(e,a-e.l,r);return n.val=i,n}function BL(e,t,r,a,n){var i=!n||n.biff==8,l=Le(8+ +i+(1+i)*r.length);return Zi(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function zL(e,t,r){var a=e.read_shift(2),n=fl(e,0,r);return[a,n]}function $L(e,t,r,a){var n=r&&r.biff==5;a||(a=Le(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var UL=fl;function c1(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:l,c}}}function WL(e,t){var r=t.biff==8||!t.biff?4:2,a=Le(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function HL(e){var t=e.read_shift(2),r=e.read_shift(2),a=nT(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function VL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(nT(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function GL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function qL(e,t,r,a){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=CF[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function KL(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=qL(e,t,a.fStyle,r),a}function d1(e,t,r,a){var n=r&&r.biff==5;a||(a=Le(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function YL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function XL(e){var t=Le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function u1(e,t,r){var a=wn(e);(r.biff==2||t==9)&&++e.l;var n=QF(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function JL(e,t,r,a,n,i){var l=Le(8);return Zi(e,t,a,l),tT(r,i,l),l}function ZL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=wn(e),n=Is(e);return a.val=n,a}function QL(e,t,r,a){var n=Le(14);return Zi(e,t,a,n),Xi(r,n),n}var m1=cL;function e8(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Ji(e,i),o=[];a>e.l;)o.push(zc(e));return[i,n,l,o]}function f1(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=uL(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var t8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h1(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Ji(e,l,r);n&32&&(u=t8[u.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var m=a==e.l||o===0||!(d>0)?[]:xz(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:m}}function cT(e,t,r){if(r.biff<8)return r8(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(dL(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function r8(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Bc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function s8(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=Ji(e,a,r),l=Ji(e,n,r);return[i,l]}function a8(e,t,r){var a=lT(e);e.l++;var n=e.read_shift(1);return t-=8,[gz(e,t,r),n,a]}function p1(e,t,r){var a=mL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,hz(e,t,r)]}function n8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function i8(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=fl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,l,i]}}function l8(e,t,r){return i8(e,t,r)}function o8(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(pm(e));return r}function c8(e){var t=Le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)iT(e[r],t);return t}function d8(e,t,r){if(r&&r.biff<8)return m8(e,t,r);var a=oT(e),n=xL(e,t-22,a[1]);return{cmo:a,ft:n}}var u8={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function m8(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((u8[a]||Os)(e,t,r)),{cmo:[n,a,i],ft:l}}function f8(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=rL(e,6,r);var o=e.read_shift(2);e.read_shift(2),Gr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],m=Ji(e,e.lens[u+1]-e.lens[u]-1);if(n+=m,n.length>=(d?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function h8(e,t){var r=pm(e);e.l+=16;var a=iL(e,t-24);return[r,a]}function p8(e){var t=Le(24),r=Tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ls([t,lL(e[1])])}function x8(e,t){e.read_shift(2);var r=pm(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Hs,""),[r,a]}function g8(e){var t=e[1].Tooltip,r=Le(10+2*(t.length+1));r.write_shift(2,2048);var a=Tr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function v8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Qb[r]||r,r=e.read_shift(2),t[1]=Qb[r]||r,t}function y8(e){return e||(e=Le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function b8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aT(e));return r}function j8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aT(e));return r}function w8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function dT(e,t,r){if(!r.cellStyles)return Os(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function N8(e,t){var r=Le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function S8(e,t){var r={};return t<32||(e.l+=16,r.header=Is(e),r.footer=Is(e),e.l+=2),r}function E8(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function T8(e){for(var t=Le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var C8=wn,A8=eT,_8=zc;function k8(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function I8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=wn(e);++e.l;var n=fl(e,t-7,r);return a.t="str",a.val=n,a}function D8(e){var t=wn(e);++e.l;var r=Is(e);return t.t="n",t.val=r,t}function P8(e,t,r){var a=Le(15);return Hc(a,e,t),a.write_shift(8,r,"f"),a}function O8(e){var t=wn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function R8(e,t,r){var a=Le(9);return Hc(a,e,t),a.write_shift(2,r),a}function F8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function L8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function M8(e,t,r){var a=e.l+t,n=wn(e),i=e.read_shift(2),l=Ji(e,i,r);return e.l=a,n.t="str",n.val=l,n}var B8=[2,3,48,49,131,139,140,245],Jp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=mm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=di(1);switch(c.type){case"base64":d=ha(ja(o));break;case"binary":d=ha(o);break;case"buffer":case"array":d=o;break}vs(d,0);var m=d.read_shift(1),f=!!(m&136),h=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var p=0,g=521;m==2&&(p=d.read_shift(2)),d.l+=3,m!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),m!=2&&(g=d.read_shift(2));var j=d.read_shift(2),w=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],b={},S=Math.min(d.length,m==2?521:g-10-(h?264:0)),E=x?32:11;d.l<S&&d[d.l]!=13;)switch(b={},b.name=sc.utils.decode(w,d.slice(d.l,d.l+E)).replace(/[\u0000\r\n].*$/g,""),d.l+=E,b.type=String.fromCharCode(d.read_shift(1)),m!=2&&!x&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),m==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),m!=2&&(d.l+=x?13:14),b.type){case"B":(!h||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var N=0,T=0;for(u[0]=[],T=0;T!=y.length;++T)u[0][T]=y[T].name;for(;p-- >0;){if(d[d.l]===42){d.l+=j;continue}for(++d.l,u[++N]=[],T=0,T=0;T!=y.length;++T){var k=d.slice(d.l,d.l+y[T].len);d.l+=y[T].len,vs(k,0);var I=sc.utils.decode(w,k);switch(y[T].type){case"C":I.trim().length&&(u[N][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[N][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[N][T]=I;break;case"F":u[N][T]=parseFloat(I.trim());break;case"+":case"I":u[N][T]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[N][T]=!0;break;case"N":case"F":u[N][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[N][T]="##MEMO##"+(x?parseInt(I.trim(),10):k.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[N][T]=+I||0);break;case"@":u[N][T]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[N][T]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[N][T]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][T]=-k.read_shift(-8,"f");break;case"B":if(h&&y[T].len==8){u[N][T]=k.read_shift(8,"f");break}case"G":case"P":k.l+=y[T].len;break;case"0":if(y[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[T].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function a(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=co(r(o,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function n(o,c){try{return yi(a(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&Qa(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ta(),m=xu(o,{header:1,raw:!0,cellDates:!0}),f=m[0],h=m.slice(1),x=o["!cols"]||[],p=0,g=0,j=0,w=1;for(p=0;p<f.length;++p){if(((x[p]||{}).DBF||{}).name){f[p]=x[p].DBF.name,++j;continue}if(f[p]!=null){if(++j,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(g=0;g<1024;++g)if(f.indexOf(f[p]+"_"+g)==-1){f[p]+="_"+g;break}}}}var y=qt(o["!ref"]),b=[],S=[],E=[];for(p=0;p<=y.e.c-y.s.c;++p){var N="",T="",k=0,I=[];for(g=0;g<h.length;++g)h[g][p]!=null&&I.push(h[g][p]);if(I.length==0||f[p]==null){b[p]="?";continue}for(g=0;g<I.length;++g){switch(typeof I[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[g]instanceof Date?"D":"C";break;default:T="C"}k=Math.max(k,String(I[g]).length),N=N&&N!=T?"C":T}k>250&&(k=250),T=((x[p]||{}).DBF||{}).type,T=="C"&&x[p].DBF.len>k&&(k=x[p].DBF.len),N=="B"&&T=="N"&&(N="N",E[p]=x[p].DBF.dec,k=x[p].DBF.len),S[p]=N=="C"||T=="N"?k:i[N]||0,w+=S[p],b[p]=N}var D=d.next(32);for(D.write_shift(4,318902576),D.write_shift(4,h.length),D.write_shift(2,296+32*j),D.write_shift(2,w),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+t[QS]||3)<<8),p=0,g=0;p<f.length;++p)if(f[p]!=null){var A=d.next(32),M=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,M,"sbcs"),A.write_shift(1,b[p]=="?"?"C":b[p],"sbcs"),A.write_shift(4,g),A.write_shift(1,S[p]||i[b[p]]||0),A.write_shift(1,E[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=S[p]||i[b[p]]||0}var G=d.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<h.length;++p){var q=d.next(w);for(q.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(b[g]){case"L":q.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":q.write_shift(8,h[p][g]||0,"f");break;case"N":var z="0";for(typeof h[p][g]=="number"&&(z=h[p][g].toFixed(E[g]||0)),j=0;j<S[g]-z.length;++j)q.write_shift(1,32);q.write_shift(1,z,"sbcs");break;case"D":h[p][g]?(q.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(h[p][g]!=null?h[p][g]:"").slice(0,S[g]);for(q.write_shift(1,ee,"sbcs"),j=0;j<S[g]-ee.length;++j)q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),uT=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var x=e[h];return typeof x=="number"?Tb(x):x},a=function(f,h,x){var p=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?f:Tb(p)};e["|"]=254;function n(f,h){switch(h.type){case"base64":return i(ja(f),h);case"binary":return i(f,h);case"buffer":return i(Pt&&Buffer.isBuffer(f)?f.toString("binary"):vi(f),h);case"array":return i(Yi(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var x=f.split(/[\n\r]+/),p=-1,g=-1,j=0,w=0,y=[],b=[],S=null,E={},N=[],T=[],k=[],I=0,D;for(+h.codepage>=0&&Qa(+h.codepage);j!==x.length;++j){I=0;var A=x[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),M=A.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),G=M[0],q;if(A.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&b.push(A.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,ee=!1,U=!1,X=!1,oe=-1,Ee=-1;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"A":break;case"X":g=parseInt(M[w].slice(1))-1,ee=!0;break;case"Y":for(p=parseInt(M[w].slice(1))-1,ee||(g=0),D=y.length;D<=p;++D)y[D]=[];break;case"K":q=M[w].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(tn(q))?isNaN(Vl(q).getDate())||(q=hr(q)):(q=tn(q),S!==null&&lo(S)&&(q=hm(q))),z=!0;break;case"E":X=!0;var F=Ml(M[w].slice(1),{r:p,c:g});y[p][g]=[y[p][g],F];break;case"S":U=!0,y[p][g]=[y[p][g],"S5S"];break;case"G":break;case"R":oe=parseInt(M[w].slice(1))-1;break;case"C":Ee=parseInt(M[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(z&&(y[p][g]&&y[p][g].length==2?y[p][g][0]=q:y[p][g]=q,S=null),U){if(X)throw new Error("SYLK shared formula cannot have own formula");var P=oe>-1&&y[oe][Ee];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");y[p][g][1]=_T(P[1],{r:p-oe,c:g-Ee})}break;case"F":var C=0;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"X":g=parseInt(M[w].slice(1))-1,++C;break;case"Y":for(p=parseInt(M[w].slice(1))-1,D=y.length;D<=p;++D)y[D]=[];break;case"M":I=parseInt(M[w].slice(1))/20;break;case"F":break;case"G":break;case"P":S=b[parseInt(M[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=M[w].slice(1).split(" "),D=parseInt(k[0],10);D<=parseInt(k[1],10);++D)I=parseInt(k[2],10),T[D-1]=I===0?{hidden:!0}:{wch:I},ui(T[D-1]);break;case"C":g=parseInt(M[w].slice(1))-1,T[g]||(T[g]={});break;case"R":p=parseInt(M[w].slice(1))-1,N[p]||(N[p]={}),I>0?(N[p].hpt=I,N[p].hpx=ql(I)):I===0&&(N[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}C<1&&(S=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return N.length>0&&(E["!rows"]=N),T.length>0&&(E["!cols"]=T),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,E]}function l(f,h){var x=n(f,h),p=x[0],g=x[1],j=co(p,h);return Pr(g).forEach(function(w){j[w]=g[w]}),j}function o(f,h){return yi(l(f,h),h)}function c(f,h,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+Bg(f.f,{r:x,c:p}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,h){h.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=uc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=mc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,h){h.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*fc(x.hpx)+";"),g.length>2&&f.push(g+"R"+(p+1))})}function m(f,h){var x=["ID;PWXL;N;E"],p=[],g=qt(f["!ref"]),j,w=Array.isArray(f),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),f["!cols"]&&u(x,f["!cols"]),f["!rows"]&&d(x,f["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var S=g.s.c;S<=g.e.c;++S){var E=bt({r:b,c:S});j=w?(f[b]||[])[S]:f[E],!(!j||j.v==null&&(!j.f||j.F))&&p.push(c(j,f,b,S))}return x.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:m}})(),mT=(function(){function e(i,l){switch(l.type){case"base64":return t(ja(i),l);case"binary":return t(i,l);case"buffer":return t(Pt&&Buffer.isBuffer(i)?i.toString("binary"):vi(i),l);case"array":return t(Yi(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,u=-1,d=0,m=[];d!==o.length;++d){if(o[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var f=o[d].trim().split(","),h=f[0],x=f[1];++d;for(var p=o[d]||"";(p.match(/["]/g)||[]).length&1&&d<o.length-1;)p+=`
`+o[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){m[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?m[c][u]=!0:p==="FALSE"?m[c][u]=!1:isNaN(tn(x))?isNaN(Vl(x).getDate())?m[c][u]=x:m[c][u]=hr(x):m[c][u]=tn(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),m[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function r(i,l){return co(e(i,l),l)}function a(i,l){return yi(r(i,l),l)}var n=(function(){var i=function(c,u,d,m,f){c.push(u),c.push(d+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},l=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=qt(c["!ref"]),m,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){l(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=bt({r:h,c:x});if(m=f?(c[h]||[])[x]:c[p],!m){l(u,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?l(u,1,0,"="+m.f):l(u,1,0,""):l(u,0,g,"V");break;case"b":l(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=$a(m.z||vt[14],Qr(hr(m.v)))),l(u,0,m.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var j=`\r
`,w=u.join(j);return w}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),fT=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var h=m.split(`
`),x=-1,p=-1,g=0,j=[];g!==h.length;++g){var w=h[g].trim().split(":");if(w[0]==="cell"){var y=Tr(w[1]);if(j.length<=y.r)for(x=j.length;x<=y.r;++x)j[x]||(j[x]=[]);switch(x=y.r,p=y.c,w[2]){case"t":j[x][p]=e(w[3]);break;case"v":j[x][p]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":j[x][p]=!!+w[4];break;default:j[x][p]=+w[4];break}w[2]=="vtf"&&(j[x][p]=[j[x][p],b])}}}return f&&f.sheetRows&&(j=j.slice(0,f.sheetRows)),j}function a(m,f){return co(r(m,f),f)}function n(m,f){return yi(a(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var f=[],h=[],x,p="",g=sa(m["!ref"]),j=Array.isArray(m),w=g.s.r;w<=g.e.r;++w)for(var y=g.s.c;y<=g.e.c;++y)if(p=bt({r:w,c:y}),x=j?(m[w]||[])[y]:m[p],!(!x||x.v==null||x.t==="z")){switch(h=["cell",p,"t"],x.t){case"s":case"str":h.push(t(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=t(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=Qr(hr(x.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=x.w||$a(x.z||vt[14],b);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(m){return[i,l,o,l,u(m),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}})(),Gl=(function(){function e(d,m,f,h,x){x.raw?m[f][h]=d:d===""||(d==="TRUE"?m[f][h]=!0:d==="FALSE"?m[f][h]=!1:isNaN(tn(d))?isNaN(Vl(d).getDate())?m[f][h]=d:m[f][h]=hr(d):m[f][h]=tn(d))}function t(d,m){var f=m||{},h=[];if(!d||d.length===0)return h;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,j=0,w=0;w<=p;++w)j=x[w].indexOf(" "),j==-1?j=x[w].length:j++,g=Math.max(g,j);for(w=0;w<=p;++w){h[w]=[];var y=0;for(e(x[w].slice(0,g).trim(),h,w,y,f),y=1;y<=(x[w].length-g)/10+1;++y)e(x[w].slice(g+(y-1)*10,g+y*10).trim(),h,w,y,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var m={},f=!1,h=0,x=0;h<d.length;++h)(x=d.charCodeAt(h))==34?f=!f:!f&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h]);if(!x.length){m=a;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h])}return x.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),r[x.pop()[1]]||44}function i(d,m){var f=m||{},h="",x=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=n(d.slice(0,1024)):f&&f.FS?h=f.FS:h=n(d.slice(0,1024));var g=0,j=0,w=0,y=0,b=0,S=h.charCodeAt(0),E=!1,N=0,T=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var k=f.dateNF!=null?E6(f.dateNF):null;function I(){var D=d.slice(y,b),A={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)A.t="z";else if(f.raw)A.t="s",A.v=D;else if(D.trim().length===0)A.t="s",A.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(A.t="s",A.v=D.slice(2,-1).replace(/""/g,'"')):e7(D)?(A.t="n",A.f=D.slice(1)):(A.t="s",A.v=D);else if(D=="TRUE")A.t="b",A.v=!0;else if(D=="FALSE")A.t="b",A.v=!1;else if(!isNaN(w=tn(D)))A.t="n",f.cellText!==!1&&(A.w=D),A.v=w;else if(!isNaN(Vl(D).getDate())||k&&D.match(k)){A.z=f.dateNF||vt[14];var M=0;k&&D.match(k)&&(D=T6(D,f.dateNF,D.match(k)||[]),M=1),f.cellDates?(A.t="d",A.v=hr(D,M)):(A.t="n",A.v=Qr(hr(D,M))),f.cellText!==!1&&(A.w=$a(A.z,A.v instanceof Date?Qr(A.v):A.v)),f.cellNF||delete A.z}else A.t="s",A.v=D;if(A.t=="z"||(f.dense?(x[g]||(x[g]=[]),x[g][j]=A):x[bt({c:j,r:g})]=A),y=b+1,T=d.charCodeAt(y),p.e.c<j&&(p.e.c=j),p.e.r<g&&(p.e.r=g),N==S)++j;else if(j=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;b<d.length;++b)switch(N=d.charCodeAt(b)){case 34:T===34&&(E=!E);break;case S:case 10:case 13:if(!E&&I())break e;break}return b-y>0&&I(),x["!ref"]=_t(p),x}function l(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):co(t(d,m),m)}function o(d,m){var f="",h=m.type=="string"?[0,0,0,0]:qg(d,m);switch(m.type){case"base64":f=ja(d);break;case"binary":f=d;break;case"buffer":m.codepage==65001?f=d.toString("utf8"):m.codepage&&typeof sc<"u"||(f=Pt&&Buffer.isBuffer(d)?d.toString("binary"):vi(d));break;case"array":f=Yi(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=ir(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=ir(f):m.type=="binary"&&typeof sc<"u",f.slice(0,19)=="socialcalc:version:"?fT.to_sheet(m.type=="string"?f:ir(f),m):l(f,m)}function c(d,m){return yi(o(d,m),m)}function u(d){for(var m=[],f=qt(d["!ref"]),h,x=Array.isArray(d),p=f.s.r;p<=f.e.r;++p){for(var g=[],j=f.s.c;j<=f.e.c;++j){var w=bt({r:p,c:j});if(h=x?(d[p]||[])[j]:d[w],!h||h.v==null){g.push("          ");continue}for(var y=(h.w||(Fn(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(j===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function z8(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=uT.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Gl.to_workbook(e,t)}}var Bi=(function(){function e(F,P,C){if(F){vs(F,F.l||0);for(var W=C.Enum||oe;F.l<F.length;){var Z=F.read_shift(2),J=W[Z]||W[65535],le=F.read_shift(2),V=F.l+le,re=J.f&&J.f(F,le,C);if(F.l=V,P(re,J,Z))return}}}function t(F,P){switch(P.type){case"base64":return r(ha(ja(F)),P);case"binary":return r(ha(F),P);case"buffer":case"array":return r(F,P)}throw"Unsupported type "+P.type}function r(F,P){if(!F)return F;var C=P||{},W=C.dense?[]:{},Z="Sheet1",J="",le=0,V={},re=[],he=[],O={s:{r:0,c:0},e:{r:0,c:0}},ye=C.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)C.Enum=oe,e(F,function(me,$e,Xe){switch(Xe){case 0:C.vers=me,me>=4096&&(C.qpro=!0);break;case 6:O=me;break;case 204:me&&(J=me);break;case 222:J=me;break;case 15:case 51:C.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=C.dateNF||vt[14],C.cellDates&&(me[1].t="d",me[1].v=hm(me[1].v))),C.qpro&&me[3]>le&&(W["!ref"]=_t(O),V[Z]=W,re.push(Z),W=C.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},le=me[3],Z=J||"Sheet"+(le+1),J="");var ge=C.dense?(W[me[0].r]||[])[me[0].c]:W[bt(me[0])];if(ge){ge.t=me[1].t,ge.v=me[1].v,me[1].z!=null&&(ge.z=me[1].z),me[1].f!=null&&(ge.f=me[1].f);break}C.dense?(W[me[0].r]||(W[me[0].r]=[]),W[me[0].r][me[0].c]=me[1]):W[bt(me[0])]=me[1];break}},C);else if(F[2]==26||F[2]==14)C.Enum=Ee,F[2]==14&&(C.qpro=!0,F.l=0),e(F,function(me,$e,Xe){switch(Xe){case 204:Z=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>le&&(W["!ref"]=_t(O),V[Z]=W,re.push(Z),W=C.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},le=me[3],Z="Sheet"+(le+1)),ye>0&&me[0].r>=ye)break;C.dense?(W[me[0].r]||(W[me[0].r]=[]),W[me[0].r][me[0].c]=me[1]):W[bt(me[0])]=me[1],O.e.c<me[0].c&&(O.e.c=me[0].c),O.e.r<me[0].r&&(O.e.r=me[0].r);break;case 27:me[14e3]&&(he[me[14e3][0]]=me[14e3][1]);break;case 1537:he[me[0]]=me[1],me[0]==le&&(Z=me[1]);break}},C);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(W["!ref"]=_t(O),V[J||Z]=W,re.push(J||Z),!he.length)return{SheetNames:re,Sheets:V};for(var de={},je=[],xe=0;xe<he.length;++xe)V[re[xe]]?(je.push(he[xe]||re[xe]),de[he[xe]]=V[he[xe]]||V[re[xe]]):(je.push(he[xe]),de[he[xe]]={"!ref":"A1"});return{SheetNames:je,Sheets:de}}function a(F,P){var C=P||{};if(+C.codepage>=0&&Qa(+C.codepage),C.type=="string")throw new Error("Cannot write WK1 to JS string");var W=ta(),Z=qt(F["!ref"]),J=Array.isArray(F),le=[];Qe(W,0,i(1030)),Qe(W,6,c(Z));for(var V=Math.min(Z.e.r,8191),re=Z.s.r;re<=V;++re)for(var he=$r(re),O=Z.s.c;O<=Z.e.c;++O){re===Z.s.r&&(le[O]=Er(O));var ye=le[O]+he,de=J?(F[re]||[])[O]:F[ye];if(!(!de||de.t=="z"))if(de.t=="n")(de.v|0)==de.v&&de.v>=-32768&&de.v<=32767?Qe(W,13,h(re,O,de.v)):Qe(W,14,p(re,O,de.v));else{var je=Fn(de);Qe(W,15,m(re,O,je.slice(0,239)))}}return Qe(W,1),W.end()}function n(F,P){var C=P||{};if(+C.codepage>=0&&Qa(+C.codepage),C.type=="string")throw new Error("Cannot write WK3 to JS string");var W=ta();Qe(W,0,l(F));for(var Z=0,J=0;Z<F.SheetNames.length;++Z)(F.Sheets[F.SheetNames[Z]]||{})["!ref"]&&Qe(W,27,X(F.SheetNames[Z],J++));var le=0;for(Z=0;Z<F.SheetNames.length;++Z){var V=F.Sheets[F.SheetNames[Z]];if(!(!V||!V["!ref"])){for(var re=qt(V["!ref"]),he=Array.isArray(V),O=[],ye=Math.min(re.e.r,8191),de=re.s.r;de<=ye;++de)for(var je=$r(de),xe=re.s.c;xe<=re.e.c;++xe){de===re.s.r&&(O[xe]=Er(xe));var me=O[xe]+je,$e=he?(V[de]||[])[xe]:V[me];if(!(!$e||$e.t=="z"))if($e.t=="n")Qe(W,23,I(de,xe,le,$e.v));else{var Xe=Fn($e);Qe(W,22,N(de,xe,le,Xe.slice(0,239)))}}++le}}return Qe(W,1),W.end()}function i(F){var P=Le(2);return P.write_shift(2,F),P}function l(F){var P=Le(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var C=0,W=0,Z=0,J=0;J<F.SheetNames.length;++J){var le=F.SheetNames[J],V=F.Sheets[le];if(!(!V||!V["!ref"])){++Z;var re=sa(V["!ref"]);C<re.e.r&&(C=re.e.r),W<re.e.c&&(W=re.e.c)}}return C>8191&&(C=8191),P.write_shift(2,C),P.write_shift(1,Z),P.write_shift(1,W),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function o(F,P,C){var W={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&C.qpro?(W.s.c=F.read_shift(1),F.l++,W.s.r=F.read_shift(2),W.e.c=F.read_shift(1),F.l++,W.e.r=F.read_shift(2),W):(W.s.c=F.read_shift(2),W.s.r=F.read_shift(2),P==12&&C.qpro&&(F.l+=2),W.e.c=F.read_shift(2),W.e.r=F.read_shift(2),P==12&&C.qpro&&(F.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(F){var P=Le(8);return P.write_shift(2,F.s.c),P.write_shift(2,F.s.r),P.write_shift(2,F.e.c),P.write_shift(2,F.e.r),P}function u(F,P,C){var W=[{c:0,r:0},{t:"n",v:0},0,0];return C.qpro&&C.vers!=20768?(W[0].c=F.read_shift(1),W[3]=F.read_shift(1),W[0].r=F.read_shift(2),F.l+=2):(W[2]=F.read_shift(1),W[0].c=F.read_shift(2),W[0].r=F.read_shift(2)),W}function d(F,P,C){var W=F.l+P,Z=u(F,P,C);if(Z[1].t="s",C.vers==20768){F.l++;var J=F.read_shift(1);return Z[1].v=F.read_shift(J,"utf8"),Z}return C.qpro&&F.l++,Z[1].v=F.read_shift(W-F.l,"cstr"),Z}function m(F,P,C){var W=Le(7+C.length);W.write_shift(1,255),W.write_shift(2,P),W.write_shift(2,F),W.write_shift(1,39);for(var Z=0;Z<W.length;++Z){var J=C.charCodeAt(Z);W.write_shift(1,J>=128?95:J)}return W.write_shift(1,0),W}function f(F,P,C){var W=u(F,P,C);return W[1].v=F.read_shift(2,"i"),W}function h(F,P,C){var W=Le(7);return W.write_shift(1,255),W.write_shift(2,P),W.write_shift(2,F),W.write_shift(2,C,"i"),W}function x(F,P,C){var W=u(F,P,C);return W[1].v=F.read_shift(8,"f"),W}function p(F,P,C){var W=Le(13);return W.write_shift(1,255),W.write_shift(2,P),W.write_shift(2,F),W.write_shift(8,C,"f"),W}function g(F,P,C){var W=F.l+P,Z=u(F,P,C);if(Z[1].v=F.read_shift(8,"f"),C.qpro)F.l=W;else{var J=F.read_shift(2);b(F.slice(F.l,F.l+J),Z),F.l+=J}return Z}function j(F,P,C){var W=P&32768;return P&=-32769,P=(W?F:0)+(P>=8192?P-16384:P),(W?"":"$")+(C?Er(P):$r(P))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(F,P){vs(F,0);for(var C=[],W=0,Z="",J="",le="",V="";F.l<F.length;){var re=F[F.l++];switch(re){case 0:C.push(F.read_shift(8,"f"));break;case 1:J=j(P[0].c,F.read_shift(2),!0),Z=j(P[0].r,F.read_shift(2),!1),C.push(J+Z);break;case 2:{var he=j(P[0].c,F.read_shift(2),!0),O=j(P[0].r,F.read_shift(2),!1);J=j(P[0].c,F.read_shift(2),!0),Z=j(P[0].r,F.read_shift(2),!1),C.push(he+O+":"+J+Z)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:C.push("("+C.pop()+")");break;case 5:C.push(F.read_shift(2));break;case 6:{for(var ye="";re=F[F.l++];)ye+=String.fromCharCode(re);C.push('"'+ye.replace(/"/g,'""')+'"')}break;case 8:C.push("-"+C.pop());break;case 23:C.push("+"+C.pop());break;case 22:C.push("NOT("+C.pop()+")");break;case 20:case 21:V=C.pop(),le=C.pop(),C.push(["AND","OR"][re-20]+"("+le+","+V+")");break;default:if(re<32&&y[re])V=C.pop(),le=C.pop(),C.push(le+y[re]+V);else if(w[re]){if(W=w[re][1],W==69&&(W=F[F.l++]),W>C.length){console.error("WK1 bad formula parse 0x"+re.toString(16)+":|"+C.join("|")+"|");return}var de=C.slice(-W);C.length-=W,C.push(w[re][0]+"("+de.join(",")+")")}else return re<=7?console.error("WK1 invalid opcode "+re.toString(16)):re<=24?console.error("WK1 unsupported op "+re.toString(16)):re<=30?console.error("WK1 invalid opcode "+re.toString(16)):re<=115?console.error("WK1 unsupported function opcode "+re.toString(16)):console.error("WK1 unrecognized opcode "+re.toString(16))}}C.length==1?P[1].f=""+C[0]:console.error("WK1 bad formula parse |"+C.join("|")+"|")}function S(F){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=F.read_shift(2),P[3]=F[F.l++],P[0].c=F[F.l++],P}function E(F,P){var C=S(F);return C[1].t="s",C[1].v=F.read_shift(P-4,"cstr"),C}function N(F,P,C,W){var Z=Le(6+W.length);Z.write_shift(2,F),Z.write_shift(1,C),Z.write_shift(1,P),Z.write_shift(1,39);for(var J=0;J<W.length;++J){var le=W.charCodeAt(J);Z.write_shift(1,le>=128?95:le)}return Z.write_shift(1,0),Z}function T(F,P){var C=S(F);C[1].v=F.read_shift(2);var W=C[1].v>>1;if(C[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return C[1].v=W,C}function k(F,P){var C=S(F),W=F.read_shift(4),Z=F.read_shift(4),J=F.read_shift(2);if(J==65535)return W===0&&Z===3221225472?(C[1].t="e",C[1].v=15):W===0&&Z===3489660928?(C[1].t="e",C[1].v=42):C[1].v=0,C;var le=J&32768;return J=(J&32767)-16446,C[1].v=(1-le*2)*(Z*Math.pow(2,J+32)+W*Math.pow(2,J)),C}function I(F,P,C,W){var Z=Le(14);if(Z.write_shift(2,F),Z.write_shift(1,C),Z.write_shift(1,P),W==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var J=0,le=0,V=0,re=0;return W<0&&(J=1,W=-W),le=Math.log2(W)|0,W/=Math.pow(2,le-31),re=W>>>0,(re&2147483648)==0&&(W/=2,++le,re=W>>>0),W-=re,re|=2147483648,re>>>=0,W*=Math.pow(2,32),V=W>>>0,Z.write_shift(4,V),Z.write_shift(4,re),le+=16383+(J?32768:0),Z.write_shift(2,le),Z}function D(F,P){var C=k(F);return F.l+=P-14,C}function A(F,P){var C=S(F),W=F.read_shift(4);return C[1].v=W>>6,C}function M(F,P){var C=S(F),W=F.read_shift(8,"f");return C[1].v=W,C}function G(F,P){var C=M(F);return F.l+=P-10,C}function q(F,P){return F[F.l+P-1]==0?F.read_shift(P,"cstr"):""}function z(F,P){var C=F[F.l++];C>P-1&&(C=P-1);for(var W="";W.length<C;)W+=String.fromCharCode(F[F.l++]);return W}function ee(F,P,C){if(!(!C.qpro||P<21)){var W=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Z=F.read_shift(P-21,"cstr");return[W,Z]}}function U(F,P){for(var C={},W=F.l+P;F.l<W;){var Z=F.read_shift(2);if(Z==14e3){for(C[Z]=[0,""],C[Z][0]=F.read_shift(2);F[F.l];)C[Z][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return C}function X(F,P){var C=Le(5+F.length);C.write_shift(2,14e3),C.write_shift(2,P);for(var W=0;W<F.length;++W){var Z=F.charCodeAt(W);C[C.l++]=Z>127?95:Z}return C[C.l++]=0,C}var oe={0:{n:"BOF",f:Gr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();function $8(e){var t={},r=e.match(Fs),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=jt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=dg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var U8=(function(){var e=ic("t"),t=ic("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Vt(l[1])},c=i.match(t);return c&&(o.s=$8(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(o){return o.v})}})(),W8=(function(){var t=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),H8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,V8=/<(?:\w+:)?r>/,G8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Og(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Vt(ir(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ir(e),r&&(a.h=bg(a.t))):e.match(V8)&&(a.r=ir(e),a.t=Vt(ir((e.replace(G8,"").match(H8)||[]).join("").replace(Fs,""))),r&&(a.h=W8(U8(a.r)))),a):{t:""}}var q8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,K8=/<(?:\w+:)?(?:si|sstItem)>/g,Y8=/<\/(?:\w+:)?(?:si|sstItem)>/;function X8(e,t){var r=[],a="";if(!e)return r;var n=e.match(q8);if(n){a=n[2].replace(K8,"").split(Y8);for(var i=0;i!=a.length;++i){var l=Og(a[i].trim(),t);l!=null&&(r[r.length]=l)}n=jt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var J8=/^\s|\s$|[\t\n\r]/;function hT(e,t){if(!t.bookSST)return"";var r=[Ur];r[r.length]=Ze("sst",null,{xmlns:ol[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(J8)&&(i+=' xml:space="preserve"'),i+=">"+nr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Z8(e){return[e.read_shift(4),e.read_shift(4)]}function Q8(e,t){var r=[],a=!1;return Un(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function eM(e,t){return t||(t=Le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tM=uF;function rM(e){var t=ta();We(t,159,eM(e));for(var r=0;r<e.length;++r)We(t,19,tM(e[r]));return We(t,160),t.end()}function pT(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function In(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function sM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=In(e,4),t.U=In(e,4),t.W=In(e,4),t}function aM(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function nM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(aM(e));return t}function iM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function lM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=In(e,4),t.U=In(e,4),t.W=In(e,4),t}function oM(e){var t=lM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xT(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function gT(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function cM(e){var t=In(e);switch(t.Minor){case 2:return[t.Minor,dM(e)];case 3:return[t.Minor,uM()];case 4:return[t.Minor,mM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function dM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=xT(e,r),n=gT(e,e.length-e.l);return{t:"Std",h:a,v:n}}function uM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Fs,function(i){var l=jt(i);switch(jn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function fM(e,t){var r={},a=r.EncryptionVersionInfo=In(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=xT(e,n),t-=n,r.EncryptionVerifier=gT(e,t),r}function hM(e){var t={},r=t.EncryptionVersionInfo=In(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Rg(e){var t=0,r,a=pT(e),n=a.length+1,i,l,o,c,u;for(r=di(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)l=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var vT=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var d=l[u],m=0;m!=7;++m)d&64&&(o^=r[c]),d*=2,--c;return o};return function(l){for(var o=pT(l),c=i(o),u=o.length,d=di(16),m=0;m!=16;++m)d[m]=0;var f,h,x;for((u&1)===1&&(f=c>>8,d[u]=n(e[0],f),--u,f=c&255,h=o[o.length-1],d[u]=n(h,f));u>0;)--u,f=c>>8,d[u]=n(o[u],f),--u,f=c&255,d[u]=n(o[u],f);for(u=15,x=15-o.length;x>0;)f=c>>8,d[u]=n(e[x],f),--u,--x,f=c&255,d[u]=n(o[u],f),--u,--x;return d}})(),pM=function(e,t,r,a,n){n||(n=t),a||(a=vT(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,a]},xM=function(e){var t=0,r=vT(e);return function(a){var n=pM("",a,t,r);return t=n[1],n[0]}};function gM(e,t,r,a){var n={key:Gr(e),verificationBytes:Gr(e)};return r.password&&(n.verifier=Rg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=xM(r.password)),n}function vM(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=hM(e):a.Data=fM(e,t),a}function yM(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?vM(e,t-2,a):gM(e,r.biff>=8?t:t-2,r,a),a}var yT=(function(){function e(n,i){switch(i.type){case"base64":return t(ja(n),i);case"binary":return t(n,i);case"buffer":return t(Pt&&Buffer.isBuffer(n)?n.toString("binary"):vi(n),i);case"array":return t(Yi(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(o)&&(o[m]=[]);for(var f=/\\\w+\b/g,h=0,x,p=-1;x=f.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(h,f.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var j={v:g,t:"s"};Array.isArray(o)?o[m][p]=j:o[bt({r:m,c:p})]=j}break}h=f.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=_t(u),o}function r(n,i){return yi(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=qt(n["!ref"]),o,c=Array.isArray(n),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var m=bt({r:u,c:d});o=c?(n[u]||[])[d]:n[m],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Fn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function bM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function dc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function jM(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),l=n-i;if(l===0)return[0,0,t];var o=0,c=0,u=n+i;switch(c=l/(u>1?2-u:u),n){case t:o=((r-a)/l+6)%6;break;case r:o=(a-t)/l+2;break;case a:o=(t-r)/l+4;break}return[o/6,c,u/2]}function wM(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function hu(e,t){if(t===0)return e;var r=jM(bM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),dc(wM(r))}var bT=6,NM=15,SM=1,As=bT;function uc(e){return Math.floor((e+Math.round(128/As)/256)*As)}function mc(e){return Math.floor((e-5)/As*100+.5)/100}function pu(e){return Math.round((e*As+5)/As*256)/256}function xf(e){return pu(mc(uc(e)))}function Fg(e){var t=Math.abs(e-xf(e)),r=As;if(t>.005)for(As=SM;As<NM;++As)Math.abs(e-xf(e))<=t&&(t=Math.abs(e-xf(e)),r=As);As=r}function ui(e){e.width?(e.wpx=uc(e.width),e.wch=mc(e.wpx),e.MDW=As):e.wpx?(e.wch=mc(e.wpx),e.width=pu(e.wch),e.MDW=As):typeof e.wch=="number"&&(e.width=pu(e.wch),e.wpx=uc(e.width),e.MDW=As),e.customWidth&&delete e.customWidth}var EM=96,jT=EM;function fc(e){return e*96/jT}function ql(e){return e*jT/96}var TM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function CM(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(Fs)||[]).forEach(function(l){var o=jt(l);switch(jn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=fr(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=fr(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function AM(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(Fs)||[]).forEach(function(l){var o=jt(l);switch(jn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function _M(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(Fs)||[]).forEach(function(l){var o=jt(l);switch(jn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ir(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?fr(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?fr(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?fr(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?fr(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?fr(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?fr(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?fr(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=dg[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=fr(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=Li[n.color.index];n.color.index==81&&(c=Li[1]),c||(c=Li[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=hu(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kM(e,t,r){t.NumberFmt=[];for(var a=Pr(vt),n=0;n<a.length;++n)t.NumberFmt[a[n]]=vt[a[n]];var i=e[0].match(Fs);if(i)for(n=0;n<i.length;++n){var l=jt(i[n]);switch(jn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Vt(ir(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}kn(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function IM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ze("numFmt",null,{numFmtId:a,formatCode:nr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Nd=["numFmtId","fillId","fontId","borderId","xfId"],Sd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function DM(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Fs)||[]).forEach(function(i){var l=jt(i),o=0;switch(jn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<Nd.length;++o)a[Nd[o]]&&(a[Nd[o]]=parseInt(a[Nd[o]],10));for(o=0;o<Sd.length;++o)a[Sd[o]]&&(a[Sd[o]]=fr(a[Sd[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=fr(l.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function PM(e){var t=[];return t[t.length]=Ze("cellXfs",null),e.forEach(function(r){t[t.length]=Ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var OM=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=o.match(t))&&kM(m,d,u),(m=o.match(n))&&_M(m,d,c,u),(m=o.match(a))&&AM(m,d,c,u),(m=o.match(i))&&CM(m,d,c,u),(m=o.match(r))&&DM(m,d,u),d}})();function wT(e,t){var r=[Ur,Ze("styleSheet",null,{xmlns:ol[0],"xmlns:vt":Jr.vt})],a;return e.SSF&&(a=IM(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=PM(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function RM(e,t){var r=e.read_shift(2),a=Ds(e);return[r,a]}function FM(e,t,r){r||(r=Le(6+4*t.length)),r.write_shift(2,e),os(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function LM(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=vF(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=gF(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ds(e),a}function MM(e,t){t||(t=Le(153)),t.write_shift(2,e.sz*20),yF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),uu(e.color,t);var a=0;return a=2,t.write_shift(1,a),os(e.name,t),t.length>t.l?t.slice(0,t.l):t}var BM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gf,zM=Os;function x1(e,t){t||(t=Le(84)),gf||(gf=mm(BM));var r=gf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(uu({auto:1},t),uu({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $M(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function NT(e,t,r){r||(r=Le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Eo(e,t){return t||(t=Le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var UM=Os;function WM(e,t){return t||(t=Le(51)),t.write_shift(1,0),Eo(null,t),Eo(null,t),Eo(null,t),Eo(null,t),Eo(null,t),t.length>t.l?t.slice(0,t.l):t}function HM(e,t){return t||(t=Le(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),du(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function VM(e,t,r){var a=Le(2052);return a.write_shift(4,e),du(t,a),du(r,a),a.length>a.l?a.slice(0,a.l):a}function GM(e,t,r){var a={};a.NumberFmt=[];for(var n in vt)a.NumberFmt[n]=vt[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return Un(e,function(c,u,d){switch(d){case 44:a.NumberFmt[c[0]]=c[1],kn(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=hu(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function qM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(We(e,615,rn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&We(e,44,FM(n,t[n]))}),We(e,616))}}function KM(e){var t=1;We(e,611,rn(t)),We(e,43,MM({sz:12,color:{theme:1},name:"Calibri",family:2})),We(e,612)}function YM(e){var t=2;We(e,603,rn(t)),We(e,45,x1({patternType:"none"})),We(e,45,x1({patternType:"gray125"})),We(e,604)}function XM(e){var t=1;We(e,613,rn(t)),We(e,46,WM()),We(e,614)}function JM(e){var t=1;We(e,626,rn(t)),We(e,47,NT({numFmtId:0},65535)),We(e,627)}function ZM(e,t){We(e,617,rn(t.length)),t.forEach(function(r){We(e,47,NT(r,0))}),We(e,618)}function QM(e){var t=1;We(e,619,rn(t)),We(e,48,HM({xfId:0,name:"Normal"})),We(e,620)}function eB(e){var t=0;We(e,505,rn(t)),We(e,506)}function tB(e){var t=0;We(e,508,VM(t,"TableStyleMedium9","PivotStyleMedium4")),We(e,509)}function rB(e,t){var r=ta();return We(r,278),qM(r,e.SSF),KM(r),YM(r),XM(r),JM(r),ZM(r,t.cellXfs),QM(r),eB(r),tB(r),We(r,279),r.end()}var sB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aB(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Fs)||[]).forEach(function(n){var i=jt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sB.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function nB(){}function iB(){}var lB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dB(e,t,r){t.themeElements={};var a;[["clrScheme",lB,aB],["fontScheme",oB,nB],["fmtScheme",cB,iB]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var uB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ST(e,t){(!e||e.length===0)&&(e=Lg());var r,a={};if(!(r=e.match(uB)))throw new Error("themeElements not found in theme");return dB(r[0],a,t),a.raw=e,a}function Lg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ur];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mB(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=xE(i,{type:"array"})}catch{return}var o=pa(l,"theme/theme/theme1.xml",!0);if(o)return ST(o,r)}}function fB(e){return e.read_shift(4)}function hB(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=pB(e,4);break;case 2:t.xclrValue=sT(e);break;case 3:t.xclrValue=fB(e);break;case 4:e.l+=4;break}return e.l+=8,t}function pB(e,t){return Os(e,t)}function xB(e,t){return Os(e,t)}function gB(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=hB(e);break;case 6:a[1]=xB(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function vB(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(gB(e,r-e.l));return{ixfe:a,ext:i}}function yB(e,t){t.forEach(function(r){r[0]})}function bB(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ds(e)}}function jB(e){var t=Le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),os(e.name,t),t.slice(0,t.l)}function wB(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function NB(e){var t=Le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function SB(e,t){var r=Le(8+2*t.length);return r.write_shift(4,e),os(t,r),r.slice(0,r.l)}function EB(e){return e.l+=4,e.read_shift(4)!=0}function TB(e,t){var r=Le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function CB(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return Un(e,function(c,u,d){switch(d){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(m){o==1?a.Cell.push({type:a.Types[m[0]-1].name,index:m[1]}):o==0&&a.Value.push({type:a.Types[m[0]-1].name,index:m[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function AB(){var e=ta();return We(e,332),We(e,334,rn(1)),We(e,335,jB({name:"XLDAPR",version:12e4,flags:3496657072})),We(e,336),We(e,339,SB(1,"XLDAPR")),We(e,52),We(e,35,rn(514)),We(e,4096,rn(0)),We(e,4097,Fa(1)),We(e,36),We(e,53),We(e,340),We(e,337,TB(1)),We(e,51,NB([[1,0]])),We(e,338),We(e,333),e.end()}function _B(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,l;return e.replace(Fs,function(o){var c=jt(o);switch(jn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==c.name&&(l=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function ET(){var e=[Ur];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function kB(e){var t=[];if(!e)return t;var r=1;return(e.match(Fs)||[]).forEach(function(a){var n=jt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function IB(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=bt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function DB(e,t,r){var a=[];return Un(e,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function PB(e,t,r,a){if(!e)return e;var n=a||{},i=!1;Un(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function OB(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var _l=1024;function TT(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ze("xml",null,{"xmlns:v":ma.v,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:mv":ma.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];_l<e*1e3;)_l+=1e3;return t.forEach(function(i){var l=Tr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ze("v:fill",c,o),d={on:"t",obscured:"t"};++_l,n=n.concat(["<v:shape"+lc({id:"_x0000_s"+_l,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ze("v:shadow",null,d),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bs("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),bs("x:AutoFill","False"),bs("x:Row",String(l.r)),bs("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function g1(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(l){var o=Tr(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=qt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=_t(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&a){for(m=0;m<a.length;++m)if(d.a==a[m].id){d.a=a[m].name||d.a;break}}i.c.push(d)})}function RB(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=jt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Tr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!m&&!!m[1]&&Og(m[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),a.push(u)}}}}),a}function CT(e){var t=[Ur,Ze("comments",null,{xmlns:ol[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=nr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(nr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(bs("t",nr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(bs("t",nr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function FB(e,t){var r=[],a=!1,n={},i=0;return e.replace(Fs,function(o,c){var u=jt(o);switch(jn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function LB(e,t,r){var a=[Ur,Ze("ThreadedComments",null,{xmlns:Jr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Ze("threadedComment",bs("text",l.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function MB(e,t){var r=[],a=!1;return e.replace(Fs,function(i){var l=jt(i);switch(jn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function BB(e){var t=[Ur,Ze("personList",null,{xmlns:Jr.TCMNT,"xmlns:x":ol[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function zB(e){var t={};t.iauthor=e.read_shift(4);var r=ml(e);return t.rfx=r.s,t.ref=bt(r.s),e.l+=16,t}function $B(e,t){return t==null&&(t=Le(36)),t.write_shift(4,e[1].iauthor),uo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var UB=Ds;function WB(e){return os(e.slice(0,54))}function HB(e,t){var r=[],a=[],n={},i=!1;return Un(e,function(o,c,u){switch(u){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function VB(e){var t=ta(),r=[];return We(t,628),We(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),We(t,632,WB(n.a)))})}),We(t,631),We(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Tr(a[0]),e:Tr(a[0])};We(t,635,$B([i,n])),n.t&&n.t.length>0&&We(t,637,fF(n)),We(t,636),delete n.iauthor})}),We(t,634),We(t,629),t.end()}var GB="application/vnd.ms-office.vbaProject";function qB(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,n,e.FileIndex[a].content)}}),mt.write(t)}function KB(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&mt.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var AT=["xlsb","xlsm","xlam","biff8","xla"];function YB(){return{"!type":"dialog"}}function XB(){return{"!type":"dialog"}}function JB(){return{"!type":"macro"}}function ZB(){return{"!type":"macro"}}var Ml=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,n+(o?"":"$")+Er(d)+(c?"":"$")+$r(u)}return function(n,i){return t=i,n.replace(e,r)}})(),Mg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Bg=(function(){return function(t,r){return t.replace(Mg,function(a,n,i,l,o,c){var u=Eg(l)-(i?0:r.c),d=Sg(c)-(o?0:r.r),m=d==0?"":o?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return n+"R"+m+"C"+f})}})();function _T(e,t){return e.replace(Mg,function(r,a,n,i,l,o){return a+(n=="$"?n+i:Er(Eg(i)+t.c))+(l=="$"?l+o:$r(Sg(o)+t.r))})}function QB(e,t,r){var a=sa(t),n=a.s,i=Tr(r),l={r:i.r-n.r,c:i.c-n.c};return _T(e,l)}function e7(e){return e.length!=1}function v1(e){return e.replace(/_xlfn\./g,"")}function Hr(e){e.l+=1}function mi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function kT(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return IT(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),l=mi(e),o=mi(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function IT(e){var t=mi(e),r=mi(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function t7(e,t,r){if(r.biff<8)return IT(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=mi(e),l=mi(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function DT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return r7(e);var a=e.read_shift(r&&r.biff==12?4:2),n=mi(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function r7(e){var t=mi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function s7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function a7(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return n7(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function n7(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function i7(e,t,r){var a=(e[e.l++]&96)>>5,n=kT(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function l7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=kT(e,i,r);return[a,n,l]}function o7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function c7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function d7(e,t,r){var a=(e[e.l++]&96)>>5,n=t7(e,t-1,r);return[a,n]}function u7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function y1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function m7(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function f7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function h7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function p7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function x7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function PT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function g7(e){return e.read_shift(2),PT(e)}function v7(e){return e.read_shift(2),PT(e)}function y7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=DT(e,0,r);return[a,n]}function b7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=a7(e,0,r);return[a,n]}function j7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=DT(e,0,r);return[a,n,i]}function w7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Ez[n],FT[n],a]}function N7(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:S7(e);return[n,(i[0]===0?FT:Sz)[i[1]]]}function S7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function E7(e,t,r){e.l+=r&&r.biff==2?3:4}function T7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function C7(e){return e.l++,Wn[e.read_shift(1)]}function A7(e){return e.l++,e.read_shift(2)}function _7(e){return e.l++,e.read_shift(1)!==0}function k7(e){return e.l++,Is(e)}function I7(e,t,r){return e.l++,Bc(e,t-1,r)}function D7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Wn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Is(e);break;case 2:r[1]=fl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function P7(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?ml:pm)(e));return n}function O7(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=D7(e,r.biff);return l}function R7(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function F7(e,t,r){if(r.biff==5)return L7(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function L7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function M7(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function B7(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function z7(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function $7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var U7=Os,W7=Os,H7=Os;function $c(e,t,r){return e.l+=2,[s7(e)]}function zg(e){return e.l+=6,[]}var V7=$c,G7=zg,q7=zg,K7=$c;function OT(e){return e.l+=2,[Gr(e),e.read_shift(2)&1]}var Y7=$c,X7=OT,J7=zg,Z7=$c,Q7=$c,ez=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tz(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=ez[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:n,C:i}}function rz(e){return e.l+=2,[e.read_shift(4)]}function sz(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function az(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lz(e){return e.l+=4,[0,0]}var b1={1:{n:"PtgExp",f:T7},2:{n:"PtgTbl",f:H7},3:{n:"PtgAdd",f:Hr},4:{n:"PtgSub",f:Hr},5:{n:"PtgMul",f:Hr},6:{n:"PtgDiv",f:Hr},7:{n:"PtgPower",f:Hr},8:{n:"PtgConcat",f:Hr},9:{n:"PtgLt",f:Hr},10:{n:"PtgLe",f:Hr},11:{n:"PtgEq",f:Hr},12:{n:"PtgGe",f:Hr},13:{n:"PtgGt",f:Hr},14:{n:"PtgNe",f:Hr},15:{n:"PtgIsect",f:Hr},16:{n:"PtgUnion",f:Hr},17:{n:"PtgRange",f:Hr},18:{n:"PtgUplus",f:Hr},19:{n:"PtgUminus",f:Hr},20:{n:"PtgPercent",f:Hr},21:{n:"PtgParen",f:Hr},22:{n:"PtgMissArg",f:Hr},23:{n:"PtgStr",f:I7},26:{n:"PtgSheet",f:sz},27:{n:"PtgEndSheet",f:az},28:{n:"PtgErr",f:C7},29:{n:"PtgBool",f:_7},30:{n:"PtgInt",f:A7},31:{n:"PtgNum",f:k7},32:{n:"PtgArray",f:u7},33:{n:"PtgFunc",f:w7},34:{n:"PtgFuncVar",f:N7},35:{n:"PtgName",f:R7},36:{n:"PtgRef",f:y7},37:{n:"PtgArea",f:i7},38:{n:"PtgMemArea",f:M7},39:{n:"PtgMemErr",f:U7},40:{n:"PtgMemNoMem",f:W7},41:{n:"PtgMemFunc",f:B7},42:{n:"PtgRefErr",f:z7},43:{n:"PtgAreaErr",f:o7},44:{n:"PtgRefN",f:b7},45:{n:"PtgAreaN",f:d7},46:{n:"PtgMemAreaN",f:nz},47:{n:"PtgMemNoMemN",f:iz},57:{n:"PtgNameX",f:F7},58:{n:"PtgRef3d",f:j7},59:{n:"PtgArea3d",f:l7},60:{n:"PtgRefErr3d",f:$7},61:{n:"PtgAreaErr3d",f:c7},255:{}},oz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cz={1:{n:"PtgElfLel",f:OT},2:{n:"PtgElfRw",f:Z7},3:{n:"PtgElfCol",f:V7},6:{n:"PtgElfRwV",f:Q7},7:{n:"PtgElfColV",f:K7},10:{n:"PtgElfRadical",f:Y7},11:{n:"PtgElfRadicalS",f:J7},13:{n:"PtgElfColS",f:G7},15:{n:"PtgElfColSV",f:q7},16:{n:"PtgElfRadicalLel",f:X7},25:{n:"PtgList",f:tz},29:{n:"PtgSxName",f:rz},255:{}},dz={0:{n:"PtgAttrNoop",f:lz},1:{n:"PtgAttrSemi",f:x7},2:{n:"PtgAttrIf",f:h7},4:{n:"PtgAttrChoose",f:m7},8:{n:"PtgAttrGoto",f:f7},16:{n:"PtgAttrSum",f:E7},32:{n:"PtgAttrBaxcel",f:y1},33:{n:"PtgAttrBaxcel",f:y1},64:{n:"PtgAttrSpace",f:g7},65:{n:"PtgAttrSpaceSemi",f:v7},128:{n:"PtgAttrIfError",f:p7},255:{}};function Uc(e,t,r,a){if(a.biff<8)return Os(e,t);for(var n=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=O7(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=P7(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&i.push(Os(e,t)),i}function Wc(e,t,r){for(var a=e.l+t,n,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],n=b1[i]||b1[oz[i]],(i===24||i===25)&&(n=(i===24?cz:dz)[e[e.l+1]]),!n||!n.f?Os(e,t):l.push([n.n,n.f(e,t,r)]);return l}function uz(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var mz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fz(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function RT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function j1(e,t,r){var a=RT(e,t,r);return a=="#REF"?a:fz(a,r)}function Cs(e,t,r,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,u,d,m=0,f=0,h,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",j=0,w=e[0].length;j<w;++j){var y=e[0][j];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Ir(" ",e[0][p][1][1]);break;case 1:g=Ir("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}o.push(u+mz[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Uo(y[1][1],l,n),o.push(Wo(d,i));break;case"PtgRefN":d=r?Uo(y[1][1],r,n):y[1][1],o.push(Wo(d,i));break;case"PtgRef3d":m=y[1][1],d=Uo(y[1][2],l,n),x=j1(a,m,n),o.push(x+"!"+Wo(d,i));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],S=y[1][1];b||(b=0),b&=127;var E=b==0?[]:o.slice(-b);o.length-=b,S==="User"&&(S=E.shift()),o.push(S+"("+E.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":h=Xb(y[1][1],r?{s:r}:l,n),o.push(ff(h,n));break;case"PtgArea":h=Xb(y[1][1],l,n),o.push(ff(h,n));break;case"PtgArea3d":m=y[1][1],h=y[1][2],x=j1(a,m,n),o.push(x+"!"+ff(h,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var N=(a.names||[])[f-1]||(a[0]||[])[f],T=N?N.Name:"SH33TJSNAME"+String(f);T&&T.slice(0,6)=="_xlfn."&&!n.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var k=y[1][1];f=y[1][2];var I;if(n.biff<=5)k<0&&(k=-k),a[k]&&(I=a[k][f]);else{var D="";if(((a[k]||[])[0]||[])[0]==14849||(((a[k]||[])[0]||[])[0]==1025?a[k][f]&&a[k][f].itab>0&&(D=a.SheetNames[a[k][f].itab-1]+"!"):D=a.SheetNames[f-1]+"!"),a[k]&&a[k][f])D+=a[k][f].Name;else if(a[0]&&a[0][f])D+=a[0][f].Name;else{var A=(RT(a,k,n)||"").split(";;");A[f-1]?D=A[f-1]:D+="SH33TJSERRX"}o.push(D);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var M="(",G=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:M=Ir(" ",e[0][p][1][1])+M;break;case 3:M=Ir("\r",e[0][p][1][1])+M;break;case 4:G=Ir(" ",e[0][p][1][1])+G;break;case 5:G=Ir("\r",e[0][p][1][1])+G;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(M+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var q={c:r.c,r:r.r};if(a.sharedf[bt(d)]){var z=a.sharedf[bt(d)];o.push(Cs(z,l,q,a,n))}else{var ee=!1;for(c=0;c!=a.arrayf.length;++c)if(u=a.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Cs(u[1],l,q,a,n)),ee=!0;break}ee||o.push(y[1])}break;case"PtgArray":o.push("{"+uz(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var U=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&U.indexOf(e[0][j][0])==-1){y=e[0][p];var X=!0;switch(y[1][0]){case 4:X=!1;case 0:g=Ir(" ",y[1][1]);break;case 5:X=!1;case 1:g=Ir("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((X?g:"")+o.pop()+(X?"":g)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function hz(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Os(e,t-2)];var o=Wc(e,l,r);return t!==l+n&&(i=Uc(e,t-l-n,o,r)),e.l=a,[o,i]}function pz(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Os(e,t-2)];var o=Wc(e,l,r);return t!==l+n&&(i=Uc(e,t-l-n,o,r)),e.l=a,[o,i]}function xz(e,t,r,a){var n=e.l+t,i=Wc(e,a,r),l;return n!==e.l&&(l=Uc(e,n-e.l,i,r)),[i,l]}function gz(e,t,r){var a=e.l+t,n,i=e.read_shift(2),l=Wc(e,i,r);return i==65535?[[],Os(e,t-2)]:(t!==i+2&&(n=Uc(e,a-i-2,l,r)),[l,n])}function vz(e){var t;if(Tn(e,e.l+6)!==65535)return[Is(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function yz(e){if(e==null){var t=Le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Xi(e);return Xi(0)}function vf(e,t,r){var a=e.l+t,n=wn(e);r.biff==2&&++e.l;var i=vz(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=pz(e,a-e.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function bz(e,t,r,a,n){var i=Zi(t,r,n),l=yz(e.v),o=Le(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=Le(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=ls([i,l,o,u]);return m}function xm(e,t,r){var a=e.read_shift(4),n=Wc(e,a,r),i=e.read_shift(4),l=i>0?Uc(e,i,n,r):null;return[n,l]}var jz=xm,gm=xm,wz=xm,Nz=xm,Sz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},FT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ez={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function w1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Tz(e){var t="of:="+e.replace(Mg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Cz(e){return e.replace(/\./,"!")}var Vo={},Bl={},Go=typeof Map<"u";function $g(e,t,r){var a=0,n=e.length;if(r){if(Go?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Go?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Go?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function vm(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(As=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=mc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=pu(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function zi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function bi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){kn(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function LT(e,t,r,a,n,i){try{a.cellNF&&(e.z=vt[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=hr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(vt[t]==null&&kn(S6[t]||"General",t),e.t==="e")e.w=e.w||Wn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nc(e.v);else if(e.t==="d"){var l=Qr(e.v);(l|0)===l?e.w=l.toString(10):e.w=nc(l)}else{if(e.v===void 0)return"";e.w=Ki(e.v,Bl)}else e.t==="d"?e.w=$a(t,Qr(e.v),Bl):e.w=$a(t,e.v,Bl)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hu(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hu(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function Az(e,t,r){if(e&&e["!ref"]){var a=qt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function _z(e,t){var r=qt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=_t(r))}var kz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Iz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Dz=/<(?:\w:)?hyperlink [^>]*>/mg,Pz=/"(\w*:\w*)"/,Oz=/<(?:\w:)?col\b[^>]*[\/]?>/g,Rz=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Fz=/<(?:\w:)?pageMargins[^>]*\/>/g,MT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Lz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Mz=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bz(e,t,r,a,n,i,l){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",m=e.match(Iz);m?(u=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):u=d=e;var f=u.match(MT);f?Ug(f[0],o,n,r):(f=u.match(Lz))&&$z(f[0],f[1]||"",o,n,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=u.slice(h,h+50).match(Pz);x&&_z(o,x[1])}var p=u.match(Mz);p&&p[1]&&e$(p[1],n);var g=[];if(t.cellStyles){var j=u.match(Oz);j&&Yz(g,j)}m&&s$(m[1],o,t,c,i,l);var w=d.match(Rz);w&&(o["!autofilter"]=Jz(w[0]));var y=[],b=d.match(kz);if(b)for(h=0;h!=b.length;++h)y[h]=qt(b[h].slice(b[h].indexOf('"')+1));var S=d.match(Dz);S&&Gz(o,S,a);var E=d.match(Fz);if(E&&(o["!margins"]=qz(jt(E[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=_t(c)),t.sheetRows>0&&o["!ref"]){var N=qt(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=_t(N))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function zz(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+_t(e[r])+'"/>';return t+"</mergeCells>"}function Ug(e,t,r,a){var n=jt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Vt(ir(n.codeName)))}function $z(e,t,r,a,n){Ug(e.slice(0,e.indexOf(">")),r,a,n)}function Uz(e,t,r,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=hn(nr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ze("outlinePr",null,u)}!i&&!o||(n[n.length]=Ze("sheetPr",o,l))}var Wz=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Hz=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Vz(e){var t={sheet:1};return Wz.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Hz.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Rg(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,t)}function Gz(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=jt(ir(t[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Vt(i.location))):(i.Target="#"+Vt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=qt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=bt({c:u,r:c});a?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function qz(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Kz(e){return zi(e),Ze("pageMargins",null,e)}function Yz(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=jt(t[a],!0);n.hidden&&(n.hidden=fr(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Fg(n.width)),ui(n);i<=l;)e[i++]=pr(n)}}function Xz(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Ze("col",null,vm(n,a)));return r[r.length]="</cols>",r.join("")}function Jz(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Zz(e,t,r,a){var n=typeof e.ref=="string"?e.ref:_t(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=sa(n);l.s.r==l.e.r&&(l.e.r=sa(t["!ref"]).e.r,n=_t(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Ze("autoFilter",null,{ref:n})}var Qz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function e$(e,t){t.Views||(t.Views=[{}]),(e.match(Qz)||[]).forEach(function(r,a){var n=jt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),fr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function t$(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,n),{})}function r$(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Wn[e.v];break;case"d":a&&a.cellDates?n=hr(e.v,-1).toISOString():(e=pr(e),e.t="n",n=""+(e.v=Qr(hr(e.v)))),typeof e.z>"u"&&(e.z=vt[14]);break;default:n=e.v;break}var o=bs("v",nr(n)),c={r:t},u=bi(a.cellXfs,e,a);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=bs("v",""+$g(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ze("f",nr(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ze("c",o,c)}var s$=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=ic("v"),l=ic("f");return function(c,u,d,m,f,h){for(var x=0,p="",g=[],j=[],w=0,y=0,b=0,S="",E,N,T=0,k=0,I,D,A=0,M=0,G=Array.isArray(h.CellXf),q,z=[],ee=[],U=Array.isArray(u),X=[],oe={},Ee=!1,F=!!d.sheetStubs,P=c.split(t),C=0,W=P.length;C!=W;++C){p=P[C].trim();var Z=p.length;if(Z!==0){var J=0;e:for(x=0;x<Z;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(N=jt(p.slice(J,x),!0),T=N.r!=null?parseInt(N.r,10):T+1,k=-1,d.sheetRows&&d.sheetRows<T)continue;oe={},Ee=!1,N.ht&&(Ee=!0,oe.hpt=parseFloat(N.ht),oe.hpx=ql(oe.hpt)),N.hidden=="1"&&(Ee=!0,oe.hidden=!0),N.outlineLevel!=null&&(Ee=!0,oe.level=+N.outlineLevel),Ee&&(X[T-1]=oe)}break;case"<":J=x;break}if(J>=x)break;if(N=jt(p.slice(J,x),!0),T=N.r!=null?parseInt(N.r,10):T+1,k=-1,!(d.sheetRows&&d.sheetRows<T)){m.s.r>T-1&&(m.s.r=T-1),m.e.r<T-1&&(m.e.r=T-1),d&&d.cellStyles&&(oe={},Ee=!1,N.ht&&(Ee=!0,oe.hpt=parseFloat(N.ht),oe.hpx=ql(oe.hpt)),N.hidden=="1"&&(Ee=!0,oe.hidden=!0),N.outlineLevel!=null&&(Ee=!0,oe.level=+N.outlineLevel),Ee&&(X[T-1]=oe)),g=p.slice(x).split(e);for(var le=0;le!=g.length&&g[le].trim().charAt(0)=="<";++le);for(g=g.slice(le),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(j=p.match(r),w=x,y=0,b=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,j!=null&&j.length===2){for(w=0,S=j[1],y=0;y!=S.length&&!((b=S.charCodeAt(y)-64)<1||b>26);++y)w=26*w+b;--w,k=w}else++k;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,N=jt(p.slice(0,y),!0),N.r||(N.r=bt({r:T-1,c:k})),S=p.slice(y),E={t:""},(j=S.match(i))!=null&&j[1]!==""&&(E.v=Vt(j[1])),d.cellFormula){if((j=S.match(l))!=null&&j[1]!==""){if(E.f=Vt(ir(j[1])).replace(/\r\n/g,`
`),d.xlfn||(E.f=v1(E.f)),j[0].indexOf('t="array"')>-1)E.F=(S.match(n)||[])[1],E.F.indexOf(":")>-1&&z.push([qt(E.F),E.F]);else if(j[0].indexOf('t="shared"')>-1){D=jt(j[0]);var V=Vt(ir(j[1]));d.xlfn||(V=v1(V)),ee[parseInt(D.si,10)]=[D,V,N.r]}}else(j=S.match(/<f[^>]*\/>/))&&(D=jt(j[0]),ee[D.si]&&(E.f=QB(ee[D.si][1],ee[D.si][2],N.r)));var re=Tr(N.r);for(y=0;y<z.length;++y)re.r>=z[y][0].s.r&&re.r<=z[y][0].e.r&&re.c>=z[y][0].s.c&&re.c<=z[y][0].e.c&&(E.F=z[y][1])}if(N.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(F)E.t="z";else continue;else E.t=N.t||"n";switch(m.s.c>k&&(m.s.c=k),m.e.c<k&&(m.e.c=k),E.t){case"n":if(E.v==""||E.v==null){if(!F)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!F)continue;E.t="z"}else I=Vo[parseInt(E.v,10)],E.v=I.t,E.r=I.r,d.cellHTML&&(E.h=I.h);break;case"str":E.t="s",E.v=E.v!=null?ir(E.v):"",d.cellHTML&&(E.h=bg(E.v));break;case"inlineStr":j=S.match(a),E.t="s",j!=null&&(I=Og(j[1]))?(E.v=I.t,d.cellHTML&&(E.h=I.h)):E.v="";break;case"b":E.v=fr(E.v);break;case"d":d.cellDates?E.v=hr(E.v,1):(E.v=Qr(hr(E.v,1)),E.t="n");break;case"e":(!d||d.cellText!==!1)&&(E.w=E.v),E.v=zE[E.v];break}if(A=M=0,q=null,G&&N.s!==void 0&&(q=h.CellXf[N.s],q!=null&&(q.numFmtId!=null&&(A=q.numFmtId),d.cellStyles&&q.fillId!=null&&(M=q.fillId))),LT(E,A,M,d,f,h),d.cellDates&&G&&E.t=="n"&&lo(vt[A])&&(E.t="d",E.v=hm(E.v)),N.cm&&d.xlmeta){var he=(d.xlmeta.Cell||[])[+N.cm-1];he&&he.type=="XLDAPR"&&(E.D=!0)}if(U){var O=Tr(N.r);u[O.r]||(u[O.r]=[]),u[O.r][O.c]=E}else u[N.r]=E}}}}X.length>0&&(u["!rows"]=X)}})();function a$(e,t,r,a){var n=[],i=[],l=qt(e["!ref"]),o="",c,u="",d=[],m=0,f=0,h=e["!rows"],x=Array.isArray(e),p={r:u},g,j=-1;for(f=l.s.c;f<=l.e.c;++f)d[f]=Er(f);for(m=l.s.r;m<=l.e.r;++m){for(i=[],u=$r(m),f=l.s.c;f<=l.e.c;++f){c=d[f]+u;var w=x?(e[m]||[])[f]:e[c];w!==void 0&&(o=r$(w,c,e,t))!=null&&i.push(o)}(i.length>0||h&&h[m])&&(p={r:u},h&&h[m]&&(g=h[m],g.hidden&&(p.hidden=1),j=-1,g.hpx?j=fc(g.hpx):g.hpt&&(j=g.hpt),j>-1&&(p.ht=j,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=Ze("row",i.join(""),p))}if(h)for(;m<h.length;++m)h&&h[m]&&(p={r:m+1},g=h[m],g.hidden&&(p.hidden=1),j=-1,g.hpx?j=fc(g.hpx):g.hpt&&(j=g.hpt),j>-1&&(p.ht=j,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=Ze("row","",p));return n.join("")}function BT(e,t,r,a){var n=[Ur,Ze("worksheet",null,{xmlns:ol[0],"xmlns:r":Jr.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=qt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=_t(d)}a||(a={}),c["!comments"]=[];var m=[];Uz(c,r,e,t,n),n[n.length]=Ze("dimension",null,{ref:u}),n[n.length]=t$(c,t,e,r),t.sheetFormat&&(n[n.length]=Ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Xz(c,c["!cols"])),n[l=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=a$(c,t),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),c["!protect"]&&(n[n.length]=Vz(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Zz(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=zz(c["!merges"]));var f=-1,h,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=sr(a,-1,nr(p[1].Target).replace(/#.*$/,""),Rt.HLINK),h["r:id"]="rId"+x),(f=p[1].Target.indexOf("#"))>-1&&(h.location=nr(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=nr(p[1].Tooltip)),n[n.length]=Ze("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Kz(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=bs("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(x=sr(a,-1,"../drawings/drawing"+(e+1)+".xml",Rt.DRAW),n[n.length]=Ze("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=m),c["!comments"].length>0&&(x=sr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Rt.VML),n[n.length]=Ze("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function n$(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function i$(e,t,r){var a=Le(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=fc(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,f=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[bt(u)];x&&(m<0&&(m=h),f=h)}m<0||(++o,a.write_shift(4,m),a.write_shift(4,f))}var p=a.l;return a.l=c,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}function l$(e,t,r,a){var n=i$(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&We(e,0,n)}var o$=ml,c$=uo;function d$(){}function u$(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=hF(e),r}function m$(e,t,r){r==null&&(r=Le(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return uu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),RE(e,r),r.slice(0,r.l)}function f$(e){var t=Ha(e);return[t]}function h$(e,t,r){return r==null&&(r=Le(8)),cl(t,r)}function p$(e){var t=dl(e);return[t]}function x$(e,t,r){return r==null&&(r=Le(4)),ul(t,r)}function g$(e){var t=Ha(e),r=e.read_shift(1);return[t,r,"b"]}function v$(e,t,r){return r==null&&(r=Le(9)),cl(t,r),r.write_shift(1,e.v?1:0),r}function y$(e){var t=dl(e),r=e.read_shift(1);return[t,r,"b"]}function b$(e,t,r){return r==null&&(r=Le(5)),ul(t,r),r.write_shift(1,e.v?1:0),r}function j$(e){var t=Ha(e),r=e.read_shift(1);return[t,r,"e"]}function w$(e,t,r){return r==null&&(r=Le(9)),cl(t,r),r.write_shift(1,e.v),r}function N$(e){var t=dl(e),r=e.read_shift(1);return[t,r,"e"]}function S$(e,t,r){return r==null&&(r=Le(8)),ul(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function E$(e){var t=Ha(e),r=e.read_shift(4);return[t,r,"s"]}function T$(e,t,r){return r==null&&(r=Le(12)),cl(t,r),r.write_shift(4,t.v),r}function C$(e){var t=dl(e),r=e.read_shift(4);return[t,r,"s"]}function A$(e,t,r){return r==null&&(r=Le(8)),ul(t,r),r.write_shift(4,t.v),r}function _$(e){var t=Ha(e),r=Is(e);return[t,r,"n"]}function k$(e,t,r){return r==null&&(r=Le(16)),cl(t,r),Xi(e.v,r),r}function zT(e){var t=dl(e),r=Is(e);return[t,r,"n"]}function I$(e,t,r){return r==null&&(r=Le(12)),ul(t,r),Xi(e.v,r),r}function D$(e){var t=Ha(e),r=_g(e);return[t,r,"n"]}function P$(e,t,r){return r==null&&(r=Le(12)),cl(t,r),FE(e.v,r),r}function O$(e){var t=dl(e),r=_g(e);return[t,r,"n"]}function R$(e,t,r){return r==null&&(r=Le(8)),ul(t,r),FE(e.v,r),r}function F$(e){var t=Ha(e),r=Tg(e);return[t,r,"is"]}function L$(e){var t=Ha(e),r=Ds(e);return[t,r,"str"]}function M$(e,t,r){return r==null&&(r=Le(12+4*e.v.length)),cl(t,r),os(e.v,r),r.length>r.l?r.slice(0,r.l):r}function B$(e){var t=dl(e),r=Ds(e);return[t,r,"str"]}function z$(e,t,r){return r==null&&(r=Le(8+4*e.v.length)),ul(t,r),os(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $$(e,t,r){var a=e.l+t,n=Ha(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=gm(e,a-e.l,r);l[3]=Cs(o,null,n,r.supbooks,r)}else e.l=a;return l}function U$(e,t,r){var a=e.l+t,n=Ha(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=gm(e,a-e.l,r);l[3]=Cs(o,null,n,r.supbooks,r)}else e.l=a;return l}function W$(e,t,r){var a=e.l+t,n=Ha(e);n.r=r["!row"];var i=Is(e),l=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=gm(e,a-e.l,r);l[3]=Cs(o,null,n,r.supbooks,r)}else e.l=a;return l}function H$(e,t,r){var a=e.l+t,n=Ha(e);n.r=r["!row"];var i=Ds(e),l=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=gm(e,a-e.l,r);l[3]=Cs(o,null,n,r.supbooks,r)}else e.l=a;return l}var V$=ml,G$=uo;function q$(e,t){return t==null&&(t=Le(4)),t.write_shift(4,e),t}function K$(e,t){var r=e.l+t,a=ml(e),n=Cg(e),i=Ds(e),l=Ds(e),o=Ds(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function Y$(e,t){var r=Le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));uo({s:Tr(e[0]),e:Tr(e[0])},r),Ag("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return os(n||"",r),os(e[1].Tooltip||"",r),os("",r),r.slice(0,r.l)}function X$(){}function J$(e,t,r){var a=e.l+t,n=LE(e),i=e.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=jz(e,a-e.l,r);l[1]=o}else e.l=a;return l}function Z$(e,t,r){var a=e.l+t,n=ml(e),i=[n];if(r.cellFormula){var l=Nz(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function Q$(e,t,r){r==null&&(r=Le(18));var a=vm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var $T=["left","right","top","bottom","header","footer"];function eU(e){var t={};return $T.forEach(function(r){t[r]=Is(e)}),t}function tU(e,t){return t==null&&(t=Le(48)),zi(e),$T.forEach(function(r){Xi(e[r],t)}),t}function rU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sU(e,t,r){r==null&&(r=Le(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aU(e){var t=Le(24);return t.write_shift(4,4),t.write_shift(4,1),uo(e,t),t}function nU(e,t){return t==null&&(t=Le(66)),t.write_shift(2,e.password?Rg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function iU(){}function lU(){}function oU(e,t,r,a,n,i,l){if(!e)return e;var o=t||{};a||(a={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,f=!1,h,x,p,g,j,w,y,b,S,E=[];o.biff=12,o["!row"]=0;var N=0,T=!1,k=[],I={},D=o.supbooks||n.supbooks||[[]];if(D.sharedf=I,D.arrayf=k,D.SheetNames=n.SheetNames||n.Sheets.map(function(U){return U.name}),!o.supbooks&&(o.supbooks=D,n.Names))for(var A=0;A<n.Names.length;++A)D[0][A+1]=n.Names[A];var M=[],G=[],q=!1;hc[16]={n:"BrtShortReal",f:zT};var z;if(Un(e,function(X,oe,Ee){if(!f)switch(Ee){case 148:u=X;break;case 0:h=X,o.sheetRows&&o.sheetRows<=h.r&&(f=!0),b=$r(g=h.r),o["!row"]=h.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=ql(X.hpt)),G[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:X[2]},X[2]){case"n":x.v=X[1];break;case"s":y=Vo[X[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!X[1];break;case"e":x.v=X[1],o.cellText!==!1&&(x.w=Wn[x.v]);break;case"str":x.t="s",x.v=X[1];break;case"is":x.t="s",x.v=X[1].t;break}if((p=l.CellXf[X[0].iStyleRef])&&LT(x,p.numFmtId,null,o,i,l),j=X[0].c==-1?j+1:X[0].c,o.dense?(c[g]||(c[g]=[]),c[g][j]=x):c[Er(j)+b]=x,o.cellFormula){for(T=!1,N=0;N<k.length;++N){var F=k[N];h.r>=F[0].s.r&&h.r<=F[0].e.r&&j>=F[0].s.c&&j<=F[0].e.c&&(x.F=_t(F[0]),T=!0)}!T&&X.length>3&&(x.f=X[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>j&&(d.s.c=j),d.e.r<h.r&&(d.e.r=h.r),d.e.c<j&&(d.e.c=j),o.cellDates&&p&&x.t=="n"&&lo(vt[p.numFmtId])){var P=Ii(x.v);P&&(x.t="d",x.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;x={t:"z",v:void 0},j=X[0].c==-1?j+1:X[0].c,o.dense?(c[g]||(c[g]=[]),c[g][j]=x):c[Er(j)+b]=x,d.s.r>h.r&&(d.s.r=h.r),d.s.c>j&&(d.s.c=j),d.e.r<h.r&&(d.e.r=h.r),d.e.c<j&&(d.e.c=j),z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 176:E.push(X);break;case 49:z=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var C=a["!id"][X.relId];for(C?(X.Target=C.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=C):X.relId==""&&(X.Target="#"+X.loc),g=X.rfx.s.r;g<=X.rfx.e.r;++g)for(j=X.rfx.s.c;j<=X.rfx.e.c;++j)o.dense?(c[g]||(c[g]=[]),c[g][j]||(c[g][j]={t:"z",v:void 0}),c[g][j].l=X):(w=bt({c:j,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=X);break;case 426:if(!o.cellFormula)break;k.push(X),S=o.dense?c[g][j]:c[Er(j)+b],S.f=Cs(X[1],d,{r:h.r,c:j},D,o),S.F=_t(X[0]);break;case 427:if(!o.cellFormula)break;I[bt(X[0].s)]=X[1],S=o.dense?c[g][j]:c[Er(j)+b],S.f=Cs(X[1],d,{r:h.r,c:j},D,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)M[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},q||(q=!0,Fg(X.w/256)),ui(M[X.e+1]);break;case 161:c["!autofilter"]={ref:_t(X)};break;case 476:c["!margins"]=X;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),X.name&&(n.Sheets[r].CodeName=X.name),(X.above||X.left)&&(c["!outline"]={above:X.above,left:X.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),X.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!oe.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=_t(u||d)),o.sheetRows&&c["!ref"]){var ee=qt(c["!ref"]);o.sheetRows<=+ee.e.r&&(ee.e.r=o.sheetRows-1,ee.e.r>d.e.r&&(ee.e.r=d.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>d.e.c&&(ee.e.c=d.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_t(ee))}return E.length>0&&(c["!merges"]=E),M.length>0&&(c["!cols"]=M),G.length>0&&(c["!rows"]=G),c}function cU(e,t,r,a,n,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=pr(t),t.z=t.z||vt[14],t.v=Qr(hr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:a};switch(c.s=bi(n.cellXfs,t,n),t.l&&i["!links"].push([bt(c),t.l]),t.c&&i["!comments"].push([bt(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=$g(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,l?We(e,18,A$(t,c)):We(e,7,T$(t,c))):(c.t="str",l?We(e,17,z$(t,c)):We(e,6,M$(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?We(e,13,R$(t,c)):We(e,2,P$(t,c)):l?We(e,16,I$(t,c)):We(e,5,k$(t,c)),!0;case"b":return c.t="b",l?We(e,15,b$(t,c)):We(e,4,v$(t,c)),!0;case"e":return c.t="e",l?We(e,14,S$(t,c)):We(e,3,w$(t,c)),!0}return l?We(e,12,x$(t,c)):We(e,1,h$(t,c)),!0}function dU(e,t,r,a){var n=qt(t["!ref"]||"A1"),i,l="",o=[];We(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){l=$r(d),l$(e,t,n,d);var m=!1;if(d<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){d===n.s.r&&(o[f]=Er(f)),i=o[f]+l;var h=c?(t[d]||[])[f]:t[i];if(!h){m=!1;continue}m=cU(e,h,d,f,a,t,m)}}We(e,146)}function uU(e,t){!t||!t["!merges"]||(We(e,177,q$(t["!merges"].length)),t["!merges"].forEach(function(r){We(e,176,G$(r))}),We(e,178))}function mU(e,t){!t||!t["!cols"]||(We(e,390),t["!cols"].forEach(function(r,a){r&&We(e,60,Q$(a,r))}),We(e,391))}function fU(e,t){!t||!t["!ref"]||(We(e,648),We(e,649,aU(qt(t["!ref"]))),We(e,650))}function hU(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=sr(r,-1,a[1].Target.replace(/#.*$/,""),Rt.HLINK);We(e,494,Y$(a,n))}}),delete t["!links"]}function pU(e,t,r,a){if(t["!comments"].length>0){var n=sr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Rt.VML);We(e,551,Ag("rId"+n)),t["!legacy"]=n}}function xU(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:_t(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=sa(i);o.s.r==o.e.r&&(o.e.r=sa(t["!ref"]).e.r,i=_t(o));for(var c=0;c<l.length;++c){var u=l[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),We(e,161,uo(qt(i))),We(e,162)}}function gU(e,t,r){We(e,133),We(e,137,sU(t,r)),We(e,138),We(e,134)}function vU(e,t){t["!protect"]&&We(e,535,nU(t["!protect"]))}function yU(e,t,r,a){var n=ta(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=qt(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],We(n,129),(r.vbaraw||l["!outline"])&&We(n,147,m$(o,l["!outline"])),We(n,148,c$(c)),gU(n,l,r.Workbook),mU(n,l),dU(n,l,e,t),vU(n,l),xU(n,l,r,e),uU(n,l),hU(n,l,a),l["!margins"]&&We(n,476,tU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&fU(n,l),pU(n,l,e,a),We(n,130),n.end()}function bU(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=Vt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function jU(e,t,r,a,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var f=bU(m);d.s.r=d.s.c=0,d.e.c=o,u=Er(o),f[0].forEach(function(h,x){l[u+$r(x)]={t:"n",v:h,z:f[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(l["!ref"]=_t(d)),l}function wU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(MT);return o&&Ug(o[0],i,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function NU(e,t){e.l+=10;var r=Ds(e);return{name:r}}function SU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Un(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Wg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TU=[],CU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function N1(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=fr(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function S1(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=fr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function UT(e){S1(e.WBProps,Wg),S1(e.CalcPr,CU),N1(e.WBView,EU),N1(e.Sheets,TU),Bl.date1904=fr(e.WBProps.date1904)}function AU(e){return!e.Workbook||!e.Workbook.WBProps?"false":fr(e.Workbook.WBProps.date1904)?"true":"false"}var _U="][*?/\\".split("");function WT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return _U.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function kU(e,t,r){e.forEach(function(a,n){WT(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[n]&&t[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function IU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];kU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Az(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var DU=/<\w+:workbook/;function PU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(e.replace(Fs,function(c,u){var d=jt(c);switch(jn(d[0])){case"<?xml":break;case"<workbook":c.match(DU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Wg.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=fr(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=ir(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Vt(ir(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ir(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),fr(d.hidden||"0")&&(i.Hidden=!0),l=u+c.length;break;case"</definedName>":i.Ref=Vt(ir(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),ol.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return UT(r),r}function HT(e){var t=[Ur];t[t.length]=Ze("workbook",null,{xmlns:ol[0],"xmlns:r":Jr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Wg.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ze("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:nr(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ze("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Ze("definedName",nr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function OU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vp(e),r.name=Ds(e),r}function RU(e,t){return t||(t=Le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ag(e.strRelID,t),os(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function FU(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ds(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function LU(e,t){t||(t=Le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),RE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function MU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function BU(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=pF(e),l=wz(e,0,r),o=Cg(e);e.l=a;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function zU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],hc[16]={n:"BrtFRTArchID$",f:MU},Un(e,function(c,u,d){switch(d){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Cs(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,c]):l[0]=[d,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),UT(r),r.Names=i,r.supbooks=l,r}function $U(e,t){We(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};We(e,156,RU(n))}We(e,144)}function UU(e,t){t||(t=Le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return os("SheetJS",t),os(au.version,t),os(au.version,t),os("7262",t),t.length>t.l?t.slice(0,t.l):t}function WU(e,t){t||(t=Le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function HU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(We(e,135),We(e,158,WU(n)),We(e,136))}}function VU(e,t){var r=ta();return We(r,131),We(r,128,UU()),We(r,153,LU(e.Workbook&&e.Workbook.WBProps||null)),HU(r,e),$U(r,e),We(r,132),r.end()}function GU(e,t,r){return t.slice(-4)===".bin"?zU(e,r):PU(e,r)}function qU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?oU(e,a,r,n,i,l,o):Bz(e,a,r,n,i,l,o)}function KU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?SU(e,a,r,n,i):wU(e,a,r,n,i)}function YU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?JB():ZB()}function XU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?YB():XB()}function JU(e,t,r,a){return t.slice(-4)===".bin"?GM(e,r,a):OM(e,r,a)}function ZU(e,t,r){return ST(e,r)}function QU(e,t,r){return t.slice(-4)===".bin"?Q8(e,r):X8(e,r)}function e9(e,t,r){return t.slice(-4)===".bin"?HB(e,r):RB(e,r)}function t9(e,t,r){return t.slice(-4)===".bin"?DB(e):kB(e)}function r9(e,t,r,a){return r.slice(-4)===".bin"?PB(e,t,r,a):void 0}function s9(e,t,r){return t.slice(-4)===".bin"?CB(e,t,r):_B(e,t,r)}function a9(e,t,r){return(t.slice(-4)===".bin"?VU:HT)(e)}function n9(e,t,r,a,n){return(t.slice(-4)===".bin"?yU:BT)(e,r,a,n)}function i9(e,t,r){return(t.slice(-4)===".bin"?rB:wT)(e,r)}function l9(e,t,r){return(t.slice(-4)===".bin"?rM:hT)(e,r)}function o9(e,t,r){return(t.slice(-4)===".bin"?VB:CT)(e)}function c9(e){return(e.slice(-4)===".bin"?AB:ET)()}var VT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ka(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(VT),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(GT),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function d9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(VT),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(GT),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var qo;function u9(e,t){var r=qo[e]||Vt(e);return r==="General"?Ki(t):$a(r,t)}function m9(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=fr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=hr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Vt(t)]=n}function f9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Wn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nc(e.v):e.w=Ki(e.v):e.w=u9(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=qo[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&lo(a)){var n=Ii(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function h9(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=TM[a.Pattern]||a.Pattern)}e[t.ID]=t}function p9(e,t,r,a,n,i,l,o,c,u){var d="General",m=a.StyleID,f={};u=u||{};var h=[],x=0;for(m===void 0&&o&&(m=o.StyleID),m===void 0&&l&&(m=l.StyleID);i[m]!==void 0&&(i[m].nf&&(d=i[m].nf),i[m].Interior&&h.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=fr(e);break;case"String":a.t="s",a.r=$b(Vt(e)),a.v=e.indexOf("<")>-1?Vt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(hr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Vt(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=zE[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=$b(t||e));break}if(f9(a,d,u),u.cellFormula!==!1)if(a.Formula){var p=Vt(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=Ml(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Ml("RC:RC",n):a.ArrayRange&&(a.F=Ml(a.ArrayRange,n),c.push([qt(a.F),a.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(a.F=c[x][1]);u.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),a.s=f),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function x9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function bf(e,t){var r=t||{};oo();var a=Fo(jg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ir(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=pr(r);return l.type="string",Gl.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){n.indexOf("<"+$e)>=0&&(i=!0)}),i)return tW(a,r);qo={"General Number":"General","General Date":vt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":vt[15],"Short Date":vt[14],"Long Time":vt[19],"Medium Time":vt[18],"Short Time":vt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:vt[2],Standard:vt[4],Percent:vt[10],Scientific:vt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},m=[],f=r.dense?[]:{},h="",x={},p={},g=Ka('<Data ss:Type="String">'),j=0,w=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},N="",T=0,k=[],I={},D={},A=0,M=[],G=[],q={},z=[],ee,U=!1,X=[],oe=[],Ee={},F=0,P=0,C={Sheets:[],WBProps:{date1904:!1}},W={};oc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=oc.exec(a);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?p9(a.slice(j,o.index),N,g,c[c.length-1][0]=="comment"?q:x,{c:w,r:y},S,z[w],p,X,r):(N="",g=Ka(o[0]),j=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(x.c=G),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][w]=x):f[Er(w)+$r(y)]=x),x.HRef&&(x.l={Target:Vt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(F=w+(parseInt(x.MergeAcross,10)|0),P=y+(parseInt(x.MergeDown,10)|0),k.push({s:{c:w,r:y},e:{c:F,r:P}})),!r.sheetStubs)x.MergeAcross?w=F+1:++w;else if(x.MergeAcross||x.MergeDown){for(var J=w;J<=F;++J)for(var le=y;le<=P;++le)(J>w||le>y)&&(r.dense?(f[le]||(f[le]=[]),f[le][J]={t:"z"}):f[Er(J)+$r(le)]={t:"z"});w=F+1}else++w;else x=d9(o[0]),x.Index&&(w=+x.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),o[0].slice(-2)==="/>"&&++w,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),o[0].slice(-2)==="/>"&&(p=Ka(o[0]),p.Index&&(y=+p.Index-1)),w=0,++y):(p=Ka(o[0]),p.Index&&(y=+p.Index-1),Ee={},(p.AutoFitHeight=="0"||p.Height)&&(Ee.hpx=parseInt(p.Height,10),Ee.hpt=fc(Ee.hpx),oe[y]=Ee),p.Hidden=="1"&&(Ee.hidden=!0,oe[y]=Ee));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));m.push(h),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=_t(b),r.sheetRows&&r.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=r.sheetRows-1,f["!ref"]=_t(b))),k.length&&(f["!merges"]=k),z.length>0&&(f["!cols"]=z),oe.length>0&&(f["!rows"]=oe),d[h]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,c.push([o[3],!1]),u=Ka(o[0]),h=Vt(u.Name),f=r.dense?[]:{},k=[],X=[],oe=[],W={name:h,Hidden:0},C.Sheets.push(W);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),z=[],U=!1}break;case"style":o[1]==="/"?h9(S,E,r):E=Ka(o[0]);break;case"numberformat":E.nf=Vt(Ka(o[0]).Format||"General"),qo[E.nf]&&(E.nf=qo[E.nf]);for(var V=0;V!=392&&vt[V]!=E.nf;++V);if(V==392){for(V=57;V!=392;++V)if(vt[V]==null){kn(E.nf,V);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ee=Ka(o[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!U&&ee.wpx>10){U=!0,As=bT;for(var re=0;re<z.length;++re)z[re]&&ui(z[re])}U&&ui(ee),z[ee.Index-1||z.length]=ee;for(var he=0;he<+ee.Span;++he)z[z.length]=pr(ee);break;case"namedrange":if(o[1]==="/")break;C.Names||(C.Names=[]);var O=jt(o[0]),ye={Name:O.Name,Ref:Ml(O.RefersTo.slice(1),{r:0,c:0})};C.Sheets.length>0&&(ye.Sheet=C.Sheets.length-1),C.Names.push(ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N+=a.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Ka(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?zF(I,Z,a.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));x9(q),G.push(q)}else c.push([o[3],!1]),u=Ka(o[0]),q={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var de=Ka(o[0]);f["!autofilter"]={ref:Ml(de.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return _1(a,r);var je=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":C.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(A,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else A=o.index+o[0].length;break;case"header":f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+jt(o[0]).Margin)||(f["!margins"].header=+jt(o[0]).Margin);break;case"footer":f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+jt(o[0]).Margin)||(f["!margins"].footer=+jt(o[0]).Margin);break;case"pagemargins":var xe=jt(o[0]);f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+xe.Top)||(f["!margins"].top=+xe.Top),isNaN(+xe.Left)||(f["!margins"].left=+xe.Left),isNaN(+xe.Right)||(f["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(f["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":C.Views||(C.Views=[]),C.Views[0]||(C.Views[0]={}),C.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:je=!1}break;case"smarttags":break;default:je=!1;break}if(je||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?m9(D,Z,M,a.slice(A,o.index)):(M=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=m,me.Workbook=C,me.SSF=pr(vt),me.Props=I,me.Custprops=D,me}function Zp(e,t){switch(Vg(t=t||{}),t.type||"base64"){case"base64":return bf(ja(e),t);case"binary":case"buffer":case"file":return bf(e,t);case"array":return bf(vi(e),t)}}function g9(e,t){var r=[];return e.Props&&r.push($F(e.Props,t)),e.Custprops&&r.push(UF(e.Props,e.Custprops)),r.join("")}function v9(){return""}function y9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Ze("NumberFormat",null,{"ss:Format":nr(vt[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Ze("Style",i.join(""),l))}),Ze("Styles",r.join(""))}function qT(e){return Ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Bg(e.Ref,{r:0,c:0})})}function b9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(qT(n)))}return Ze("Names",r.join(""))}function j9(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(qT(o)))}return i.join("")}function w9(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Ze("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(bs("ProtectContents","True")),e["!protect"].objects&&n.push(bs("ProtectObjects","True")),e["!protect"].scenarios&&n.push(bs("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(bs("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(bs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Ze("WorksheetOptions",n.join(""),{xmlns:ma.x})}function N9(e){return e.map(function(t){var r=H6(t.t||""),a=Ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",a,{"ss:Author":t.a})}).join("")}function S9(e,t,r,a,n,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+nr(Bg(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=Tr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=nr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=nr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",f="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=Wn[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||vt[14]);break;case"s":m="String",f=W6(e.v||"");break}var h=bi(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=l.c+1;var x=e.v!=null?f:"",p=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=N9(e.c)),Ze("Cell",p,o)}function E9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ql(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function T9(e,t,r,a){if(!e["!ref"])return"";var n=qt(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,j){ui(g);var w=!!g.width,y=vm(j,g),b={"ss:Index":j+1};w&&(b["ss:Width"]=uc(y.width)),g.hidden&&(b["ss:Hidden"]="1"),o.push(Ze("Column",null,b))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[E9(u,(e["!rows"]||[])[u])],m=n.s.c;m<=n.e.c;++m){var f=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>m)&&!(i[l].s.r>u)&&!(i[l].e.c<m)&&!(i[l].e.r<u)){(i[l].s.c!=m||i[l].s.r!=u)&&(f=!0);break}if(!f){var h={r:u,c:m},x=bt(h),p=c?(e[u]||[])[m]:e[x];d.push(S9(p,x,e,t,r,a,h))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function C9(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],l=i?j9(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?T9(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(w9(i,t,e,r)),a.join("")}function A9(e,t){t||(t={}),e.SSF||(e.SSF=pr(vt)),e.SSF&&(oo(),um(e.SSF),t.revssf=fm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],bi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(g9(e,t)),r.push(v9()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ze("Worksheet",C9(a,t,e),{"ss:Name":nr(e.SheetNames[a])}));return r[2]=y9(e,t),r[3]=b9(e),Ur+Ze("Workbook",r.join(""),{xmlns:ma.ss,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:ss":ma.ss,"xmlns:dt":ma.dt,"xmlns:html":ma.html})}function _9(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bF(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=jF(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var k9=[60,1084,2066,2165,2175];function I9(e,t,r,a,n){var i=a,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var c=Tn(r,r.l),u=Qp[c],d=0;u!=null&&k9.indexOf(c)>-1;)i=Tn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),l.push(o),r.l+=4+i,u=Qp[c=Tn(r,r.l)];var m=ls(l);vs(m,0);var f=0;m.lens=[];for(var h=0;h<l.length;++h)m.lens.push(f),f+=l[h].length;if(m.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+a;return t.f(m,m.length,n)}function un(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=vt[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Wn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nc(e.v):e.w=Ki(e.v):e.w=$a(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&lo(vt[a]||String(a))){var n=Ii(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Ed(e,t,r){return{v:e,ixfe:t,t:r}}function D9(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},l={},o=null,c=[],u="",d={},m,f="",h,x,p,g,j={},w=[],y,b,S=[],E=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=function(ke){return ke<8?Li[ke]:ke<64&&E[ke-8]||Li[ke]},I=function(ke,nt,tt){var Ge=nt.XF.data;if(!(!Ge||!Ge.patternType||!tt||!tt.cellStyles)){nt.s={},nt.s.patternType=Ge.patternType;var Ce;(Ce=dc(k(Ge.icvFore)))&&(nt.s.fgColor={rgb:Ce}),(Ce=dc(k(Ge.icvBack)))&&(nt.s.bgColor={rgb:Ce})}},D=function(ke,nt,tt){if(!(Ee>1)&&!(tt.sheetRows&&ke.r>=tt.sheetRows)){if(tt.cellStyles&&nt.XF&&nt.XF.data&&I(ke,nt,tt),delete nt.ixfe,delete nt.XF,m=ke,f=bt(ke),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ke.r<l.s.r&&(l.s.r=ke.r),ke.c<l.s.c&&(l.s.c=ke.c),ke.r+1>l.e.r&&(l.e.r=ke.r+1),ke.c+1>l.e.c&&(l.e.c=ke.c+1),tt.cellFormula&&nt.f){for(var Ge=0;Ge<w.length;++Ge)if(!(w[Ge][0].s.c>ke.c||w[Ge][0].s.r>ke.r)&&!(w[Ge][0].e.c<ke.c||w[Ge][0].e.r<ke.r)){nt.F=_t(w[Ge][0]),(w[Ge][0].s.c!=ke.c||w[Ge][0].s.r!=ke.r)&&delete nt.f,nt.f&&(nt.f=""+Cs(w[Ge][1],l,ke,X,A));break}}tt.dense?(n[ke.r]||(n[ke.r]=[]),n[ke.r][ke.c]=nt):n[f]=nt}},A={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var M,G=[],q=[],z=[],ee=[],U=!1,X=[];X.SheetNames=A.snames,X.sharedf=A.sharedf,X.arrayf=A.arrayf,X.names=[],X.XTI=[];var oe=0,Ee=0,F=0,P=[],C=[],W;A.codepage=1200,Qa(1200);for(var Z=!1;e.l<e.length-1;){var J=e.l,le=e.read_shift(2);if(le===0&&oe===10)break;var V=e.l===e.length?0:e.read_shift(2),re=Qp[le];if(re&&re.f){if(t.bookSheets&&oe===133&&le!==133)break;if(oe=le,re.r===2||re.r==12){var he=e.read_shift(2);if(V-=2,!A.enc&&he!==le&&((he&255)<<8|he>>8)!==le)throw new Error("rt mismatch: "+he+"!="+le);re.r==12&&(e.l+=10,V-=10)}var O={};if(le===10?O=re.f(e,V,A):O=I9(le,re,e,V,A),Ee==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(le){case 34:r.opts.Date1904=N.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=O;break;case 66:var ye=Number(O);switch(ye){case 21010:ye=1200;break;case 32768:ye=1e4;break;case 32769:ye=1252;break}Qa(A.codepage=ye),Z=!0;break;case 317:A.rrtabid=O;break;case 25:A.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:A.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(n["!type"]="dialog"),O.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),O.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(O);break;case 430:X.push([O]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(O);break;case 24:case 536:W={Name:O.Name,Ref:Cs(O.rgce,l,null,X,A)},O.itab>0&&(W.Sheet=O.itab-1),X.names.push(W),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(C[O.itab-1]={ref:_t(O.rgce[0][0][1][2])});break;case 22:A.ExternCount=O;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(O),X.XTI=X.XTI.concat(O);break;case 2196:if(A.biff<8)break;W!=null&&(W.Comment=O[1]);break;case 18:n["!protect"]=O;break;case 19:O!==0&&A.WTF&&console.error("Password verifier: "+O);break;case 133:i[O.pos]=O,A.snames.push(O.name);break;case 10:{if(--Ee)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=_t(l),t.sheetRows&&t.sheetRows<=l.e.r){var de=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=_t(l),l.e.r=de}l.e.r++,l.e.c++}G.length>0&&(n["!merges"]=G),q.length>0&&(n["!objects"]=q),z.length>0&&(n["!cols"]=z),ee.length>0&&(n["!rows"]=ee),N.Sheets.push(T)}u===""?d=n:a[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),A.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(A.biff=5,Z=!0,Qa(A.codepage=28591)),A.biff==8&&O.BIFFVer==0&&O.dt==16&&(A.biff=2),Ee++)break;if(n=t.dense?[]:{},A.biff<8&&!Z&&(Z=!0,Qa(A.codepage=t.codepage||1252)),A.biff<5||O.BIFFVer==0&&O.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var je={pos:e.l-V,name:u};i[je.pos]=je,A.snames.push(u)}else u=(i[J]||{name:""}).name;O.dt==32&&(n["!type"]="chart"),O.dt==64&&(n["!type"]="macro"),G=[],q=[],A.arrayf=w=[],z=[],ee=[],U=!1,T={Hidden:(i[J]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[O.r]||[])[O.c]:n[bt({c:O.c,r:O.r})])&&++O.c,y={ixfe:O.ixfe,XF:S[O.ixfe]||{},v:O.val,t:"n"},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t);break;case 5:case 517:y={ixfe:O.ixfe,XF:S[O.ixfe],v:O.val,t:O.t},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t);break;case 638:y={ixfe:O.ixfe,XF:S[O.ixfe],v:O.rknum,t:"n"},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t);break;case 189:for(var xe=O.c;xe<=O.C;++xe){var me=O.rkrec[xe-O.c][0];y={ixfe:me,XF:S[me],v:O.rkrec[xe-O.c][1],t:"n"},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:xe,r:O.r},y,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(y=Ed(O.val,O.cell.ixfe,O.tt),y.XF=S[y.ixfe],t.cellFormula){var $e=O.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var Xe=$e[0][0][1][0],ge=$e[0][0][1][1],qe=bt({r:Xe,c:ge});j[qe]?y.f=""+Cs(O.formula,l,O.cell,X,A):y.F=((t.dense?(n[Xe]||[])[ge]:n[qe])||{}).F}else y.f=""+Cs(O.formula,l,O.cell,X,A)}F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D(O.cell,y,t),o=O}break;case 7:case 519:if(o)o.val=O,y=Ed(O,o.cell.ixfe,"s"),y.XF=S[y.ixfe],t.cellFormula&&(y.f=""+Cs(o.formula,l,o.cell,X,A)),F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(O);var st=bt(O[0].s);if(h=t.dense?(n[O[0].s.r]||[])[O[0].s.c]:n[st],t.cellFormula&&h){if(!o||!st||!h)break;h.f=""+Cs(O[1],l,O[0],X,A),h.F=_t(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;j[bt(o.cell)]=O[0],h=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[bt(o.cell)],(h||{}).f=""+Cs(O[0],l,m,X,A)}}break;case 253:y=Ed(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(y.h=c[O.isst].h),y.XF=S[y.ixfe],F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:O.ixfe,XF:S[O.ixfe],t:"z"},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t));break;case 190:if(t.sheetStubs)for(var Te=O.c;Te<=O.C;++Te){var Ke=O.ixfe[Te-O.c];y={ixfe:Ke,XF:S[Ke],t:"z"},F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:Te,r:O.r},y,t)}break;case 214:case 516:case 4:y=Ed(O.val,O.ixfe,"s"),y.XF=S[y.ixfe],F>0&&(y.z=P[y.ixfe>>8&63]),un(y,t,r.opts.Date1904),D({c:O.c,r:O.r},y,t);break;case 0:case 512:Ee===1&&(l=O);break;case 252:c=O;break;case 1054:if(A.biff==4){P[F++]=O[1];for(var ze=0;ze<F+163&&vt[ze]!=O[1];++ze);ze>=163&&kn(O[1],F+163)}else kn(O[1],O[0]);break;case 30:{P[F++]=O;for(var et=0;et<F+163&&vt[et]!=O;++et);et>=163&&kn(O,F+163)}break;case 229:G=G.concat(O);break;case 93:q[O.cmo[0]]=A.lastobj=O;break;case 438:A.lastobj.TxO=O;break;case 127:A.lastobj.ImData=O;break;case 440:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)h=t.dense?(n[g]||[])[p]:n[bt({c:p,r:g})],h&&(h.l=O[1]);break;case 2048:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)h=t.dense?(n[g]||[])[p]:n[bt({c:p,r:g})],h&&h.l&&(h.l.Tooltip=O[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;h=t.dense?(n[O[0].r]||[])[O[0].c]:n[bt(O[0])];var yt=q[O[2]];h||(t.dense?(n[O[0].r]||(n[O[0].r]=[]),h=n[O[0].r][O[0].c]={t:"z"}):h=n[bt(O[0])]={t:"z"},l.e.r=Math.max(l.e.r,O[0].r),l.s.r=Math.min(l.s.r,O[0].r),l.e.c=Math.max(l.e.c,O[0].c),l.s.c=Math.min(l.s.c,O[0].c)),h.c||(h.c=[]),x={a:O[1],t:yt.TxO.t},h.c.push(x)}break;case 2173:yB(S[O.ixfe],O.ext);break;case 125:{if(!A.cellStyles)break;for(;O.e>=O.s;)z[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},U||(U=!0,Fg(O.w/256)),ui(z[O.e+1])}break;case 520:{var lt={};O.level!=null&&(ee[O.r]=lt,lt.level=O.level),O.hidden&&(ee[O.r]=lt,lt.hidden=!0),O.hpt&&(ee[O.r]=lt,lt.hpt=O.hpt,lt.hpx=ql(O.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||zi(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=O;break;case 161:n["!margins"]||zi(n["!margins"]={}),n["!margins"].header=O.header,n["!margins"].footer=O.footer;break;case 574:O.RTL&&(N.Views[0].RTL=!0);break;case 146:E=O;break;case 2198:M=O;break;case 140:b=O;break;case 442:u?T.CodeName=O||T.name:N.WBProps.CodeName=O||"ThisWorkbook";break}}else re||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=V}return r.SheetNames=Pr(i).sort(function(Me,ke){return Number(Me)-Number(ke)}).map(function(Me){return i[Me].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&C.forEach(function(Me,ke){r.Sheets[r.SheetNames[ke]]["!autofilter"]=Me}),r.Strings=c,r.SSF=pr(vt),A.enc&&(r.Encryption=A.enc),M&&(r.Themes=M),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),X.names.length>0&&(N.Names=X.names),r.Workbook=N,r}var Ko={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P9(e,t,r){var a=mt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=n1(a,Gp,Ko.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var l=mt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=n1(l,qp,Ko.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(GE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function O9(e,t){var r=[],a=[],n=[],i=0,l,o=Rb(Gp,"n"),c=Rb(qp,"n");if(e.Props)for(l=Pr(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Pr(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Custprops[l[i]]]);var u=[];for(i=0;i<n.length;++i)QE.indexOf(n[i][0])>-1||VE.indexOf(n[i][0])>-1||n[i][1]!=null&&u.push(n[i]);a.length&&mt.utils.cfb_add(t,"/SummaryInformation",i1(a,Ko.SI,c,qp)),(r.length||u.length)&&mt.utils.cfb_add(t,"/DocumentSummaryInformation",i1(r,Ko.DSI,o,Gp,u.length?u:null,Ko.UDI))}function KT(e,t){t||(t={}),Vg(t),mg(),t.codepage&&ug(t.codepage);var r,a;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),a=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=ha(ja(e));break;case"binary":e=ha(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}vs(e,0),a={content:e}}var n,i;if(r&&_9(r),t.bookProps&&!t.bookSheets)n={};else{var l=Pt?"buffer":"array";if(a&&a.content)n=D9(a.content,t);else if((i=mt.find(e,"PerfectOffice_MAIN"))&&i.content)n=Bi.to_workbook(i.content,(t.type=l,t));else if((i=mt.find(e,"NativeContent_MAIN"))&&i.content)n=Bi.to_workbook(i.content,(t.type=l,t));else throw(i=mt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=qB(e))}var o={};return e.FullPaths&&P9(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function R9(e,t){var r=t||{},a=mt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mt.utils.cfb_add(a,n,YT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&O9(e,a),r.biff==8&&e.vbaraw&&KB(a,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var hc={0:{f:n$},1:{f:f$},2:{f:D$},3:{f:j$},4:{f:g$},5:{f:_$},6:{f:L$},7:{f:E$},8:{f:H$},9:{f:W$},10:{f:$$},11:{f:U$},12:{f:p$},13:{f:O$},14:{f:N$},15:{f:y$},16:{f:zT},17:{f:B$},18:{f:C$},19:{f:Tg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BU},40:{},42:{},43:{f:LM},44:{f:RM},45:{f:zM},46:{f:UM},47:{f:$M},48:{},49:{f:oF},50:{},51:{f:wB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dT},62:{f:F$},63:{f:IB},64:{f:iU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Os,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:u$},148:{f:o$,p:16},151:{f:X$},152:{},153:{f:FU},154:{},155:{},156:{f:OU},157:{},158:{},159:{T:1,f:Z8},160:{T:-1},161:{T:1,f:ml},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:V$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bB},336:{T:-1},337:{f:EB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:J$},427:{f:Z$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:d$},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:K$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UB},633:{T:1},634:{T:-1},635:{T:1,f:zB},636:{T:-1},637:{f:mF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:NU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qp={6:{f:vf},10:{f:Qn},12:{f:Gr},13:{f:Gr},14:{f:Mr},15:{f:Mr},16:{f:Is},17:{f:Mr},18:{f:Mr},19:{f:Gr},20:{f:m1},21:{f:m1},23:{f:cT},24:{f:h1},25:{f:Mr},26:{},27:{},28:{f:l8},29:{},34:{f:Mr},35:{f:f1},38:{f:Is},39:{f:Is},40:{f:Is},41:{f:Is},42:{f:Mr},43:{f:Mr},47:{f:yM},49:{f:OL},51:{f:Gr},60:{},61:{f:_L},64:{f:Mr},65:{f:PL},66:{f:Gr},77:{},80:{},81:{},82:{},85:{f:Gr},89:{},90:{},91:{},92:{f:vL},93:{f:d8},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:dT},128:{f:YL},129:{f:bL},130:{f:Gr},131:{f:Mr},132:{f:Mr},133:{f:jL},134:{},140:{f:v8},141:{f:Gr},144:{},146:{f:j8},151:{},152:{},153:{},154:{},155:{},156:{f:Gr},157:{},158:{},160:{f:A8},161:{f:S8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:VL},190:{f:GL},193:{f:Qn},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gr},220:{},221:{f:Mr},222:{},224:{f:KL},225:{f:gL},226:{f:Qn},227:{},229:{f:o8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:NL},253:{f:FL},255:{f:EL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:eT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:Qn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:e8},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:f8},439:{f:Mr},440:{f:h8},441:{},442:{f:zc},443:{},444:{f:Gr},445:{},446:{},448:{f:Qn},449:{f:AL,r:2},450:{f:Qn},512:{f:c1},513:{f:C8},515:{f:ZL},516:{f:ML},517:{f:u1},519:{f:_8},520:{f:TL},523:{},545:{f:p1},549:{f:o1},566:{},574:{f:IL},638:{f:HL},659:{},1048:{},1054:{f:zL},1084:{},1212:{f:a8},2048:{f:x8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w8,r:12},2173:{f:vB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:s8,r:12},2197:{},2198:{f:mB,r:12},2199:{},2200:{},2201:{},2202:{f:n8,r:12},2203:{f:Qn},2204:{},2205:{},2206:{},2207:{},2211:{f:CL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:E8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:b8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:c1},1:{},2:{f:O8},3:{f:D8},4:{f:I8},5:{f:u1},7:{f:F8},8:{},9:{f:wd},11:{},22:{f:Gr},30:{f:UL},31:{},32:{},33:{f:p1},36:{},37:{f:o1},50:{f:L8},62:{},52:{},67:{},68:{f:Gr},69:{},86:{},126:{},127:{f:k8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:M8},223:{},234:{},354:{},421:{},518:{f:vf},521:{f:wd},536:{f:h1},547:{f:f1},561:{},579:{},1030:{f:vf},1033:{f:wd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qe(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&Ng(r)&&e.push(r)}}function F9(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Qe(e,t,r,n);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Hc(e,t,r){return e||(e=Le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function L9(e,t,r,a){var n=Le(9);return Hc(n,e,t),tT(r,a||"b",n),n}function M9(e,t,r){var a=Le(8+2*r.length);return Hc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function B9(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Qr(hr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Qe(e,2,R8(r,a,n)):Qe(e,3,P8(r,a,n));return;case"b":case"e":Qe(e,5,L9(r,a,t.v,t.t));return;case"s":case"str":Qe(e,4,M9(r,a,(t.v||"").slice(0,255)));return}Qe(e,1,Hc(null,r,a))}function z9(e,t,r,a){var n=Array.isArray(t),i=qt(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=_t(i)}for(var u=i.s.r;u<=i.e.r;++u){o=$r(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=Er(d)),l=c[d]+o;var m=n?(t[u]||[])[d]:t[l];m&&B9(e,m,u,d)}}}function $9(e,t){for(var r=t||{},a=ta(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Qe(a,r.biff==4?1033:r.biff==3?521:9,Pg(e,16,r)),z9(a,e.Sheets[e.SheetNames[n]],n,r),Qe(a,10),a.end()}function U9(e,t,r){Qe(e,49,RL({sz:12,name:"Arial"},r))}function W9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Qe(e,1054,$L(n,t[n],r))})}function H9(e,t){var r=Le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Qe(e,2151,r),r=Le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),iT(qt(t["!ref"]||"A1"),r),r.write_shift(4,4),Qe(e,2152,r)}function V9(e,t){for(var r=0;r<16;++r)Qe(e,224,d1({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Qe(e,224,d1(a,0,t))})}function G9(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Qe(e,440,p8(a)),a[1].Tooltip&&Qe(e,2048,g8(a))}delete t["!links"]}function q9(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Qe(e,125,N8(vm(n,a),n))})}}function K9(e,t,r,a,n){var i=16+bi(n.cellXfs,t,n);if(t.v==null&&!t.bf){Qe(e,513,Zi(r,a,i));return}if(t.bf)Qe(e,6,bz(t,r,a,n,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?Qr(hr(t.v)):t.v;Qe(e,515,QL(r,a,l,i));break;case"b":case"e":Qe(e,517,JL(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var o=$g(n.Strings,t.v,n.revStrings);Qe(e,253,LL(r,a,o,i))}else Qe(e,516,BL(r,a,(t.v||"").slice(0,255),i,n));break;default:Qe(e,513,Zi(r,a,i))}}function Y9(e,t,r){var a=ta(),n=r.SheetNames[e],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,m="",f=[],h=qt(i["!ref"]||"A1"),x=u?65536:16384;if(h.e.c>255||h.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,x-1)}Qe(a,2057,Pg(r,16,t)),Qe(a,13,Fa(1)),Qe(a,12,Fa(100)),Qe(a,15,Bs(!0)),Qe(a,17,Bs(!1)),Qe(a,16,Xi(.001)),Qe(a,95,Bs(!0)),Qe(a,42,Bs(!1)),Qe(a,43,Bs(!1)),Qe(a,130,Fa(1)),Qe(a,128,XL()),Qe(a,131,Bs(!1)),Qe(a,132,Bs(!1)),u&&q9(a,i["!cols"]),Qe(a,512,WL(h,t)),u&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){m=$r(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(f[g]=Er(g)),d=f[g]+m;var j=c?(i[p]||[])[g]:i[d];j&&(K9(a,j,p,g,t),u&&j.l&&i["!links"].push([d,j.l]))}}var w=o.CodeName||o.name||n;return u&&Qe(a,574,DL((l.Views||[])[0])),u&&(i["!merges"]||[]).length&&Qe(a,229,c8(i["!merges"])),u&&G9(a,i),Qe(a,442,rT(w)),u&&H9(a,i),Qe(a,10),a.end()}function X9(e,t,r){var a=ta(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(Qe(a,2057,Pg(e,5,r)),r.bookType=="xla"&&Qe(a,135),Qe(a,225,o?Fa(1200):null),Qe(a,193,JF(2)),c&&Qe(a,191),c&&Qe(a,192),Qe(a,226),Qe(a,92,yL("SheetJS",r)),Qe(a,66,Fa(o?1200:1252)),o&&Qe(a,353,Fa(0)),o&&Qe(a,448),Qe(a,317,T8(e.SheetNames.length)),o&&e.vbaraw&&Qe(a,211),o&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";Qe(a,442,rT(u))}Qe(a,156,Fa(17)),Qe(a,25,Bs(!1)),Qe(a,18,Bs(!1)),Qe(a,19,Fa(0)),o&&Qe(a,431,Bs(!1)),o&&Qe(a,444,Fa(0)),Qe(a,61,kL()),Qe(a,64,Bs(!1)),Qe(a,141,Fa(0)),Qe(a,34,Bs(AU(e)=="true")),Qe(a,14,Bs(!0)),o&&Qe(a,439,Bs(!1)),Qe(a,218,Fa(0)),U9(a,e,r),W9(a,e.SSF,r),V9(a,r),o&&Qe(a,352,Bs(!1));var d=a.end(),m=ta();o&&Qe(m,140,y8()),o&&r.Strings&&F9(m,252,SL(r.Strings)),Qe(m,10);var f=m.end(),h=ta(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=d.length+x+f.length;for(p=0;p<e.SheetNames.length;++p){var j=i[p]||{};Qe(h,133,wL({pos:g,hs:j.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var w=h.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var y=[];return d.length&&y.push(d),w.length&&y.push(w),f.length&&y.push(f),ls(y)}function J9(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=pr(vt)),e&&e.SSF&&(oo(),um(e.SSF),r.revssf=fm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gg(r),r.cellXfs=[],bi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=Y9(n,r,e);return a.unshift(X9(e,a,r)),ls(a)}function YT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=sa(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return J9(e,t);case 4:case 3:case 2:return $9(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function E1(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=R6(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,m=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(l=0;l<c.length;++l){var p=c[l].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var j=p.split(/<\/t[dh]>/i);for(o=0;o<j.length;++o){var w=j[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var S=0;S<x.length;++S){var E=x[S];E.s.c==d&&E.s.r<u&&u<=E.e.r&&(d=E.e.c+1,S=-1)}var N=jt(w.slice(0,w.indexOf(">")));f=N.colspan?+N.colspan:1,((m=+N.rowspan)>1||f>1)&&x.push({s:{r:u,c:d},e:{r:u+(m||1)-1,c:d+f-1}});var T=N.t||N["data-t"]||"";if(!y.length){d+=f;continue}if(y=yE(y),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!y.length){d+=f;continue}var k={t:"s",v:y};r.raw||!y.trim().length||T=="s"||(y==="TRUE"?k={t:"b",v:!0}:y==="FALSE"?k={t:"b",v:!1}:isNaN(tn(y))?isNaN(Vl(y).getDate())||(k={t:"d",v:hr(y)},r.cellDates||(k={t:"n",v:Qr(k.v)}),k.z=r.dateNF||vt[14]):k={t:"n",v:tn(y)}),r.dense?(a[u]||(a[u]=[]),a[u][d]=k):a[bt({r:u,c:d})]=k,d+=f}}}}return a["!ref"]=_t(h),x.length&&(a["!merges"]=x),a}function Z9(e,t,r,a){for(var n=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>l)&&!(n[u].e.r<r||n[u].e.c<l)){if(n[u].s.r<r||n[u].s.c<l){o=-1;break}o=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(o<0)){var d=bt({r,c:l}),m=a.dense?(e[r]||[])[l]:e[d],f=m&&m.v!=null&&(m.h||bg(m.w||(Fn(m),m.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),a.editable?f='<span contenteditable="true">'+f+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),h.id=(a.id||"sjs")+"-"+d,i.push(Ze("td",f,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var Q9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',eW="</body></html>";function tW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return yi(E1(r[0],t),t);var a=Xg();return r.forEach(function(n,i){Jg(a,E1(n,t),"Sheet"+(i+1))}),a}function rW(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function XT(e,t){var r=t||{},a=r.header!=null?r.header:Q9,n=r.footer!=null?r.footer:eW,i=[a],l=sa(e["!ref"]);r.dense=Array.isArray(e),i.push(rW(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(Z9(e,l,o,r));return i.push("</table>"+n),i.join("")}function JT(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Tr(a.origin):a.origin;n=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=sa(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var m=[],f=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,j=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var b=o[x];if(T1(b)){if(a.display)continue;h[p]={hidden:!0}}var S=b.children;for(g=j=0;g<S.length;++g){var E=S[g];if(!(a.display&&T1(E))){var N=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):yE(E.innerHTML),T=E.getAttribute("data-z")||E.getAttribute("z");for(f=0;f<m.length;++f){var k=m[f];k.s.c==j+i&&k.s.r<p+n&&p+n<=k.e.r&&(j=k.e.c+1-i,f=-1)}y=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:p+n,c:j+i},e:{r:p+n+(w||1)-1,c:j+i+(y||1)-1}});var I={t:"s",v:N},D=E.getAttribute("data-t")||E.getAttribute("t")||"";N!=null&&(N.length==0?I.t=D||"z":a.raw||N.trim().length==0||D=="s"||(N==="TRUE"?I={t:"b",v:!0}:N==="FALSE"?I={t:"b",v:!1}:isNaN(tn(N))?isNaN(Vl(N).getDate())||(I={t:"d",v:hr(N)},a.cellDates||(I={t:"n",v:Qr(I.v)}),I.z=a.dateNF||vt[14]):I={t:"n",v:tn(N)})),I.z===void 0&&T!=null&&(I.z=T);var A="",M=E.getElementsByTagName("A");if(M&&M.length)for(var G=0;G<M.length&&!(M[G].hasAttribute("href")&&(A=M[G].getAttribute("href"),A.charAt(0)!="#"));++G);A&&A.charAt(0)!="#"&&(I.l={Target:A}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][j+i]=I):e[bt({c:j+i,r:p+n})]=I,u.e.c<j+i&&(u.e.c=j+i),j+=y}}++p}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=_t(u),p>=c&&(e["!fullref"]=_t((u.e.r=o.length-x+p-1+n,u))),e}function ZT(e,t){var r=t||{},a=r.dense?[]:{};return JT(a,e,t)}function sW(e,t){return yi(ZT(e,t),t)}function T1(e){var t="",r=aW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function aW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(t.replace(/<[^>]*>/g,""));return[r]}var C1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function QT(e,t){var r=t||{},a=jg(e),n=[],i,l,o={name:""},c="",u=0,d,m,f={},h=[],x=r.dense?[]:{},p,g,j={value:""},w="",y=0,b=[],S=-1,E=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,k={},I=[],D={},A=0,M=0,G=[],q=1,z=1,ee=[],U={Names:[]},X={},oe=["",""],Ee=[],F={},P="",C=0,W=!1,Z=!1,J=0;for(oc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=oc.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?x["!ref"]=_t(N):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=_t(N)),I.length&&(x["!merges"]=I),G.length&&(x["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),f[d.name]=x,Z=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=jt(p[0],!1),S=E=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,x=r.dense?[]:{},I=[],G=[],Z=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"":if(p[1]==="/"){S+=q,q=1;break}if(m=jt(p[0],!1),m.?S=m.-1:S==-1&&(S=0),q=+m["number-rows-repeated"]||1,q<10)for(J=0;J<q;++J)T>0&&(G[S+J]={level:T});E=-1;break;case"covered-table-cell":p[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][E]={t:"z"}):x[bt({r:S,c:E})]={t:"z"}),w="",b=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++E,j=jt(p[0],!1),z=parseInt(j["number-columns-repeated"]||"1",10),g={t:"z",v:null},j.formula&&r.cellFormula!=!1&&(g.f=w1(Vt(j.formula))),(j.||j["value-type"])=="string"&&(g.t="s",g.v=Vt(j["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][E]=g):x[bt({r:S,c:E})]=g),E+=z-1;else if(p[1]!=="/"){++E,w="",y=0,b=[],z=1;var le=q?S+q-1:S;if(E>N.e.c&&(N.e.c=E),E<N.s.c&&(N.s.c=E),S<N.s.r&&(N.s.r=S),le>N.e.r&&(N.e.r=le),j=jt(p[0],!1),Ee=[],F={},g={t:j.||j["value-type"],v:null},r.cellFormula)if(j.formula&&(j.formula=Vt(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(A=parseInt(j["number-matrix-rows-spanned"],10)||0,M=parseInt(j["number-matrix-columns-spanned"],10)||0,D={s:{r:S,c:E},e:{r:S+A-1,c:E+M-1}},g.F=_t(D),ee.push([D,g.F])),j.formula)g.f=w1(j.formula);else for(J=0;J<ee.length;++J)S>=ee[J][0].s.r&&S<=ee[J][0].e.r&&E>=ee[J][0].s.c&&E<=ee[J][0].e.c&&(g.F=ee[J][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(A=parseInt(j["number-rows-spanned"],10)||0,M=parseInt(j["number-columns-spanned"],10)||0,D={s:{r:S,c:E},e:{r:S+A-1,c:E+M-1}},I.push(D)),j["number-columns-repeated"]&&(z=parseInt(j["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=fr(j["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(j.value);break;case"percentage":g.t="n",g.v=parseFloat(j.value);break;case"currency":g.t="n",g.v=parseFloat(j.value);break;case"date":g.t="d",g.v=hr(j["date-value"]),r.cellDates||(g.t="n",g.v=Qr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=D6(j["time-value"])/86400,r.cellDates&&(g.t="d",g.v=hm(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(j.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",j["string-value"]!=null&&(w=Vt(j["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(W=!1,g.t==="s"&&(g.v=w||"",b.length&&(g.R=b),W=y==0),X.Target&&(g.l=X),Ee.length>0&&(g.c=Ee,Ee=[]),w&&r.cellText!==!1&&(g.w=w),W&&(g.t="z",delete g.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var V=0;V<q;++V){if(z=parseInt(j["number-columns-repeated"]||"1",10),r.dense)for(x[S+V]||(x[S+V]=[]),x[S+V][E]=V==0?g:pr(g);--z>0;)x[S+V][E+z]=pr(g);else for(x[bt({r:S+V,c:E})]=g;--z>0;)x[bt({r:S+V,c:E+z})]=pr(g);N.e.c<=E&&(N.e.c=E)}z=parseInt(j["number-columns-repeated"]||"1",10),E+=z-1,z=0,g={},w="",b=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;F.t=w,b.length&&(F.R=b),F.a=P,Ee.push(F)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);P="",C=0,w="",y=0,b=[];break;case"creator":p[1]==="/"?P=a.slice(C,p.index):C=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);w="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(k[o.name]=c,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=jt(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=jt(p[0],!1),c+=C1[p[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=jt(p[0],!1),c+=C1[p[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":l=jt(p[0],!1),oe=yf(l["cell-range-address"]);var re={Name:l.name,Ref:oe[0]+"!"+oe[1]};Z&&(re.Sheet=h.length),U.Names.push(re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!j||!j["string-value"])){var he=nW(a.slice(y,p.index));w=(w.length>0?w+`
`:"")+he[0]}else jt(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{oe=yf(jt(p[0])["target-range-address"]),f[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(X=jt(p[0],!1),!X.href)break;X.Target=Vt(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(oe=yf(X.Target.slice(1)),X.Target="#"+oe[0]+"!"+oe[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var O={Sheets:f,SheetNames:h,Workbook:U};return r.bookSheets&&delete O.Sheets,O}function A1(e,t){t=t||{},Ra(e,"META-INF/manifest.xml")&&DF(Vr(e,"META-INF/manifest.xml"),t);var r=pa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=QT(ir(r),t);return Ra(e,"meta.xml")&&(a.Props=WE(Vr(e,"meta.xml"))),a}function _1(e,t){return QT(e,t)}var iW=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+lc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ur+t}})(),k1=(function(){var e=function(i){return nr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var c=[];c.push('      <table:table table:name="'+nr(l.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,m=sa(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(u=0;u<m.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=m.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var j=!1,w={},y="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>d)&&!(f[h].s.r>u)&&!(f[h].e.c<d)&&!(f[h].e.r<u)){(f[h].s.c!=d||f[h].s.r!=u)&&(j=!0),w["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,w["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(j){c.push(r);continue}var b=bt({r:u,c:d}),S=x?(i[u]||[])[d]:i[b];if(S&&S.f&&(w["table:formula"]=nr(Tz(S.f)),S.F&&S.F.slice(0,b.length)==b)){var E=sa(S.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":y=S.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=S.v?"true":"false";break;case"n":y=S.w||String(S.v||0),w["office:value-type"]="float",w["office:value"]=S.v||0;break;case"s":case"str":y=S.v==null?"":S.v,w["office:value-type"]="string";break;case"d":y=S.w||hr(S.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=hr(S.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(y);if(S.l&&S.l.Target){var T=S.l.Target;T=T.charAt(0)=="#"?"#"+Cz(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),N=Ze("text:a",N,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+Ze("table:table-cell",Ze("text:p",N,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;ui(m),m.ods=o;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[Ur],u=lc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=lc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(UE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)c.push(a(l.Sheets[l.SheetNames[m]],l,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function eC(e,t){if(t.bookType=="fods")return k1(e,t);var r=gg(),a="",n=[],i=[];return a="mimetype",It(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",It(r,a,k1(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",It(r,a,iW(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",It(r,a,Ur+UE()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",It(r,a,RF(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",It(r,a,PF(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Qi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ex(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ir(vi(e))}function lW(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ha(hn(e))}function oW(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function fi(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function I1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function cW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function dW(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function pc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function rr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Kt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=pc(e,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=pc(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var u={data:o,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function hs(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(rr(a*8+n.type)),n.type==2&&t.push(rr(n.data.length)),t.push(n.data))})}),fi(t)}function Hg(e,t){return e?.map(function(r){return t(r.data)})||[]}function Da(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=pc(e,a),i=Kt(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:Dr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Kt(o.data),u=Dr(c[3][0].data);l.messages.push({meta:c,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=Dr(i[3][0].data)>>>0>0),r.push(l)}return r}function jl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:rr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:rr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:rr(l.data.length)}],a[2].push({data:hs(l.meta),type:2})});var i=hs(a);t.push(rr(i.length)),t.push(i),n.forEach(function(l){return t.push(l)})}),fi(t)}function uW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=pc(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[fi(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=fi(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function Pa(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uW(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return fi(t)}function wl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=rr(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return fi(t)}function mW(e,t,r,a){var n=Qi(e),i=n.getUint32(4,!0),l=(a>1?12:8)+I1(i&(a>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=I1(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(u=n.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else if(c>-1)m={t:"s",v:t[c]};else if(!isNaN(u))m={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function fW(e,t,r){var a=Qi(e),n=a.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=cW(e,i),i+=16),n&2&&(u=a.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:c};break;case 3:m={t:"s",v:t[o]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return m}function jf(e,t){var r=new Uint8Array(32),a=Qi(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,dW(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function wf(e,t){var r=new Uint8Array(32),a=Qi(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function hW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mW(e,t,r,e[0]);case 5:return fW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ts(e){var t=Kt(e);return pc(t[1][0].data)}function D1(e,t){var r=Kt(t.data),a=Dr(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=Kt(l.data),c=Dr(o[1][0].data)>>>0;switch(a){case 1:i[c]=ex(o[3][0].data);break;case 8:{var u=e[Ts(o[9][0].data)][0],d=Kt(u.data),m=e[Ts(d[1][0].data)][0],f=Dr(m.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Kt(m.data);i[c]=h[3].map(function(x){return ex(x.data)}).join("")}break}}),i}function pW(e,t){var r,a,n,i,l,o,c,u,d,m,f,h,x,p,g=Kt(e),j=Dr(g[1][0].data)>>>0,w=Dr(g[2][0].data)>>>0,y=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Dr(g[8][0].data)>0||!1,b,S;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&t!=0)b=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,S=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((m=(d=g[4])==null?void 0:d[0])!=null&&m.data&&t!=1)b=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,S=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=y?4:1,N=Qi(b),T=[],k=0;k<b.length/2;++k){var I=N.getUint16(k*2,!0);I<65535&&T.push([k,I])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var D=[];for(k=0;k<T.length-1;++k)D[T[k][0]]=S.subarray(T[k][1]*E,T[k+1][1]*E);return T.length>=1&&(D[T[T.length-1][0]]=S.subarray(T[T.length-1][1]*E)),{R:j,cells:D}}function xW(e,t){var r,a=Kt(t.data),n=(r=a?.[7])!=null&&r[0]?Dr(a[7][0].data)>>>0>0?1:0:-1,i=Hg(a[5],function(l){return pW(l,n)});return{nrows:Dr(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function gW(e,t,r){var a,n=Kt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Dr(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Dr(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=_t(i);var l=Kt(n[4][0].data),o=D1(e,e[Ts(l[4][0].data)][0]),c=(a=l[17])!=null&&a[0]?D1(e,e[Ts(l[17][0].data)][0]):[],u=Kt(l[3][0].data),d=0;u[1].forEach(function(m){var f=Kt(m.data),h=e[Ts(f[2][0].data)][0],x=Dr(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=xW(e,h);p.data.forEach(function(g,j){g.forEach(function(w,y){var b=bt({r:d+j,c:y}),S=hW(w,o,c);S&&(r[b]=S)})}),d+=p.nrows})}function vW(e,t){var r=Kt(t.data),a={"!ref":"A1"},n=e[Ts(r[2][0].data)],i=Dr(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return gW(e,n[0],a),a}function yW(e,t){var r,a=Kt(t.data),n={name:(r=a[1])!=null&&r[0]?ex(a[1][0].data):"",sheets:[]},i=Hg(a[2],Ts);return i.forEach(function(l){e[l].forEach(function(o){var c=Dr(o.meta[1][0].data);c==6e3&&n.sheets.push(vW(e,o))})}),n}function bW(e,t){var r=Xg(),a=Kt(t.data),n=Hg(a[1],Ts);if(n.forEach(function(i){e[i].forEach(function(l){var o=Dr(l.meta[1][0].data);if(o==2){var c=yW(e,l);c.sheets.forEach(function(u,d){Jg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Nf(e){var t,r,a,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Pa(c.content)}catch(m){return console.log("?? "+c.content.length+" "+(m.message||m))}var d;try{d=Da(u)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){i[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(u){var d=Dr(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return bW(i,o)}function jW(e,t,r){var a,n,i,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Dr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Qi(e[7][0].data),d=0,m=[],f=Qi(e[4][0].data),h=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),f.setUint16(p*2,h,!0);var g,j;switch(typeof t[p]){case"string":g=jf({t:"s",v:t[p]},r),j=wf({t:"s",v:t[p]},r);break;case"number":g=jf({t:"n",v:t[p]},r),j=wf({t:"n",v:t[p]},r);break;case"boolean":g=jf({t:"b",v:t[p]},r),j=wf({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}m.push(g),d+=g.length,x.push(j),h+=j.length,++c}for(e[2][0].data=rr(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return e[6][0].data=fi(m),e[3][0].data=fi(x),c}function wW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=sa(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(_t(a)));var i=xu(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(P){return P.forEach(function(C){typeof C=="string"&&l.push(C)})});var o={},c=[],u=mt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(P,C){return[P,u.FullPaths[C]]}).forEach(function(P){var C=P[0],W=P[1];if(C.type==2&&C.name.match(/\.iwa/)){var Z=C.content,J=Pa(Z),le=Da(J);le.forEach(function(V){c.push(V.id),o[V.id]={deps:[],location:W,type:Dr(V.messages[0].meta[1][0].data)}})}}),c.sort(function(P,C){return P-C});var d=c.filter(function(P){return P>1}).map(function(P){return[P,rr(P)]});u.FileIndex.map(function(P,C){return[P,u.FullPaths[C]]}).forEach(function(P){var C=P[0];if(P[1],!!C.name.match(/\.iwa/)){var W=Da(Pa(C.content));W.forEach(function(Z){Z.messages.forEach(function(J){d.forEach(function(le){Z.messages.some(function(V){return Dr(V.meta[1][0].data)!=11006&&oW(V.data,le[1])})&&o[le[0]].deps.push(Z.id)})})})}});for(var m=mt.find(u,o[1].location),f=Da(Pa(m.content)),h,x=0;x<f.length;++x){var p=f[x];p.id==1&&(h=p)}var g=Ts(Kt(h.messages[0].data)[1][0].data);for(m=mt.find(u,o[g].location),f=Da(Pa(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);for(g=Ts(Kt(h.messages[0].data)[2][0].data),m=mt.find(u,o[g].location),f=Da(Pa(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);for(g=Ts(Kt(h.messages[0].data)[2][0].data),m=mt.find(u,o[g].location),f=Da(Pa(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);var j=Kt(h.messages[0].data);{j[6][0].data=rr(a.e.r+1),j[7][0].data=rr(a.e.c+1);var w=Ts(j[46][0].data),y=mt.find(u,o[w].location),b=Da(Pa(y.content));{for(var S=0;S<b.length&&b[S].id!=w;++S);if(b[S].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=Kt(b[S].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var N=0;N<=a.e.c;++N){var T=[];T[1]=T[2]=[{type:0,data:rr(N+420690)}],E[1].push({type:2,data:hs(T)}),E[2].push({type:0,data:rr(N)}),E[3].push({type:0,data:rr(N)})}E[4]=[],E[5]=[],E[6]=[];for(var k=0;k<=a.e.r;++k)T=[],T[1]=T[2]=[{type:0,data:rr(k+726270)}],E[4].push({type:2,data:hs(T)}),E[5].push({type:0,data:rr(k)}),E[6].push({type:0,data:rr(k)});b[S].messages[0].data=hs(E)}y.content=wl(jl(b)),y.size=y.content.length,delete j[46];var I=Kt(j[4][0].data);{I[7][0].data=rr(a.e.r+1);var D=Kt(I[1][0].data),A=Ts(D[2][0].data);y=mt.find(u,o[A].location),b=Da(Pa(y.content));{if(b[0].id!=A)throw"Bad HeaderStorageBucket";var M=Kt(b[0].messages[0].data);for(k=0;k<i.length;++k){var G=Kt(M[2][0].data);G[1][0].data=rr(k),G[4][0].data=rr(i[k].length),M[2][k]={type:M[2][0].type,data:hs(G)}}b[0].messages[0].data=hs(M)}y.content=wl(jl(b)),y.size=y.content.length;var q=Ts(I[2][0].data);y=mt.find(u,o[q].location),b=Da(Pa(y.content));{if(b[0].id!=q)throw"Bad HeaderStorageBucket";for(M=Kt(b[0].messages[0].data),N=0;N<=a.e.c;++N)G=Kt(M[2][0].data),G[1][0].data=rr(N),G[4][0].data=rr(a.e.r+1),M[2][N]={type:M[2][0].type,data:hs(G)};b[0].messages[0].data=hs(M)}y.content=wl(jl(b)),y.size=y.content.length;var z=Ts(I[4][0].data);(function(){for(var P=mt.find(u,o[z].location),C=Da(Pa(P.content)),W,Z=0;Z<C.length;++Z){var J=C[Z];J.id==z&&(W=J)}var le=Kt(W.messages[0].data);{le[3]=[];var V=[];l.forEach(function(O,ye){V[1]=[{type:0,data:rr(ye)}],V[2]=[{type:0,data:rr(1)}],V[3]=[{type:2,data:lW(O)}],le[3].push({type:2,data:hs(V)})})}W.messages[0].data=hs(le);var re=jl(C),he=wl(re);P.content=he,P.size=P.content.length})();var ee=Kt(I[3][0].data);{var U=ee[1][0];delete ee[2];var X=Kt(U.data);{var oe=Ts(X[2][0].data);(function(){for(var P=mt.find(u,o[oe].location),C=Da(Pa(P.content)),W,Z=0;Z<C.length;++Z){var J=C[Z];J.id==oe&&(W=J)}var le=Kt(W.messages[0].data);{delete le[6],delete ee[7];var V=new Uint8Array(le[5][0].data);le[5]=[];for(var re=0,he=0;he<=a.e.r;++he){var O=Kt(V);re+=jW(O,i[he],l),O[1][0].data=rr(he),le[5].push({data:hs(O),type:2})}le[1]=[{type:0,data:rr(a.e.c+1)}],le[2]=[{type:0,data:rr(a.e.r+1)}],le[3]=[{type:0,data:rr(re)}],le[4]=[{type:0,data:rr(a.e.r+1)}]}W.messages[0].data=hs(le);var ye=jl(C),de=wl(ye);P.content=de,P.size=P.content.length})()}U.data=hs(X)}I[3][0].data=hs(ee)}j[4][0].data=hs(I)}h.messages[0].data=hs(j);var Ee=jl(f),F=wl(Ee);return m.content=F,m.size=m.content.length,u}function tC(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Vg(e){tC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Gg(e){tC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function NW(e){return Rt.WS.indexOf(e)>-1?"sheet":e==Rt.CS?"chart":e==Rt.DS?"dialog":e==Rt.MS?"macro":e&&e.length?e:"sheet"}function SW(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,NW(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function EW(e,t,r,a,n,i,l,o,c,u,d,m){try{i[a]=Ho(pa(e,r,!0),t);var f=Vr(e,t),h;switch(o){case"sheet":h=qU(f,t,n,c,i[a],u,d,m);break;case"chart":if(h=KU(f,t,n,c,i[a],u,d,m),!h||!h["!drawel"])break;var x=Mo(h["!drawel"].Target,t),p=cc(x),g=OB(pa(e,x,!0),Ho(pa(e,p,!0),x)),j=Mo(g,x),w=cc(j);h=jU(pa(e,j,!0),j,c,Ho(pa(e,w,!0),j),u,h);break;case"macro":h=YU(f,t,n,c,i[a],u,d,m);break;case"dialog":h=XU(f,t,n,c,i[a],u,d,m);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=h;var y=[];i&&i[a]&&Pr(i[a]).forEach(function(b){var S="";if(i[a][b].Type==Rt.CMNT){S=Mo(i[a][b].Target,t);var E=e9(Vr(e,S,!0),S,c);if(!E||!E.length)return;g1(h,E,!1)}i[a][b].Type==Rt.TCMNT&&(S=Mo(i[a][b].Target,t),y=y.concat(FB(Vr(e,S,!0),c)))}),y&&y.length&&g1(h,y,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function Ca(e){return e.charAt(0)=="/"?e.slice(1):e}function TW(e,t){if(oo(),t=t||{},Vg(t),Ra(e,"META-INF/manifest.xml")||Ra(e,"objectdata.xml"))return A1(e,t);if(Ra(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Nf<"u"){if(e.FileIndex)return Nf(e);var r=mt.utils.cfb_new();return Mb(e).forEach(function(G){It(r,G,L6(e,G))}),Nf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ra(e,"[Content_Types].xml"))throw Ra(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ra(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Mb(e),n=kF(pa(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Vr(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Vr(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Vo=[],n.sst)try{Vo=QU(Vr(e,Ca(n.sst)),n.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&n.themes.length&&(c=ZU(pa(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=JU(Vr(e,Ca(n.style)),n.style,c,t))}n.links.map(function(G){try{var q=Ho(pa(e,cc(Ca(G))),G);return r9(Vr(e,Ca(G)),q,G,t)}catch{}});var d=GU(Vr(e,Ca(n.workbooks[0])),n.workbooks[0],t),m={},f="";n.coreprops.length&&(f=Vr(e,Ca(n.coreprops[0]),!0),f&&(m=WE(f)),n.extprops.length!==0&&(f=Vr(e,Ca(n.extprops[0]),!0),f&&LF(f,m,t)));var h={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=pa(e,Ca(n.custprops[0]),!0),f&&(h=BF(f,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(q){return q.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),t.bookProps&&(x.Props=m,x.Custprops=h),t.bookSheets&&typeof l<"u"&&(x.SheetNames=l),t.bookSheets?x.SheetNames:t.bookProps))return x;l={};var p={};t.bookDeps&&n.calcchain&&(p=t9(Vr(e,Ca(n.calcchain)),n.calcchain));var g=0,j={},w,y;{var b=d.Sheets;m.Worksheets=b.length,m.SheetNames=[];for(var S=0;S!=b.length;++S)m.SheetNames[S]=b[S].name}var E=i?"bin":"xml",N=n.workbooks[0].lastIndexOf("/"),T=(n.workbooks[0].slice(0,N+1)+"_rels/"+n.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Ra(e,T)||(T="xl/_rels/workbook."+E+".rels");var k=Ho(pa(e,T,!0),T.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=s9(Vr(e,Ca(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=MB(Vr(e,Ca(n.people[0])),t)),k&&(k=SW(k,d.Sheets));var I=Vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=m.Worksheets;++g){var D="sheet";if(k&&k[g]?(w="xl/"+k[g][1].replace(/[\/]?xl\//,""),Ra(e,w)||(w=k[g][1]),Ra(e,w)||(w=T.replace(/_rels\/.*$/,"")+k[g][1]),D=k[g][2]):(w="xl/worksheets/sheet"+(g+1-I)+"."+E,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(m.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==g&&(A=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==m.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}EW(e,w,y,m.SheetNames[g],g,j,l,D,t,d,c,u)}return x={Directory:n,Workbook:d,Props:m,Custprops:h,Deps:p,Sheets:l,SheetNames:m.SheetNames,Strings:Vo,Styles:u,Themes:c,SSF:pr(vt)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(G,q){G=G.replace(/^Root Entry[\/]/,""),x.keys.push(G),x.files[G]=e.FileIndex[q]}))),t&&t.bookVBA&&(n.vba.length>0?x.vbaraw=Vr(e,Ca(n.vba[0]),!0):n.defaults&&n.defaults.bin===GB&&(x.vbaraw=Vr(e,"xl/vbaProject.bin",!0))),x}function CW(e,t){var r=t||{},a="Workbook",n=mt.find(e,a);try{if(a="/!DataSpaces/Version",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(sM(n.content),a="/!DataSpaces/DataSpaceMap",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=nM(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=iM(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);oM(n.content)}catch{}if(a="/EncryptionInfo",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=cM(n.content);if(a="/EncryptedPackage",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function AW(e,t){return t.bookType=="ods"?eC(e,t):t.bookType=="numbers"?wW(e,t):t.bookType=="xlsb"?_W(e,t):kW(e,t)}function _W(e,t){_l=1024,e&&!e.SSF&&(e.SSF=pr(vt)),e&&e.SSF&&(oo(),um(e.SSF),t.revssf=fm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Go?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=AT.indexOf(t.bookType)>-1,n=Ig();Gg(t=t||{});var i=gg(),l="",o=0;if(t.cellXfs=[],bi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",It(i,l,HE(e.Props,t)),n.coreprops.push(l),sr(t.rels,2,l,Rt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,It(i,l,qE(e.Props)),n.extprops.push(l),sr(t.rels,3,l,Rt.EXT_PROPS),e.Custprops!==e.Props&&Pr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",It(i,l,KE(e.Custprops)),n.custprops.push(l),sr(t.rels,4,l,Rt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,It(i,l,n9(o-1,l,t,e,d)),n.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(m){var h=m["!comments"],x=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,It(i,p,o9(h,p)),n.comments.push(p),sr(d,-1,"../comments"+o+"."+r,Rt.CMNT),x=!0),m["!legacy"]&&x&&It(i,"xl/drawings/vmlDrawing"+o+".vml",TT(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&It(i,cc(l),Ll(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,It(i,l,l9(t.Strings,l,t)),n.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Rt.SST)),l="xl/workbook."+r,It(i,l,a9(e,l)),n.workbooks.push(l),sr(t.rels,1,l,Rt.WB),l="xl/theme/theme1.xml",It(i,l,Lg(e.Themes,t)),n.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Rt.THEME),l="xl/styles."+r,It(i,l,i9(e,l,t)),n.styles.push(l),sr(t.wbrels,-1,"styles."+r,Rt.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",It(i,l,e.vbaraw),n.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Rt.VBA)),l="xl/metadata."+r,It(i,l,c9(l)),n.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Rt.XLMETA),It(i,"[Content_Types].xml",$E(n,t)),It(i,"_rels/.rels",Ll(t.rels)),It(i,"xl/_rels/workbook."+r+".rels",Ll(t.wbrels)),delete t.revssf,delete t.ssf,i}function kW(e,t){_l=1024,e&&!e.SSF&&(e.SSF=pr(vt)),e&&e.SSF&&(oo(),um(e.SSF),t.revssf=fm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Go?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=AT.indexOf(t.bookType)>-1,n=Ig();Gg(t=t||{});var i=gg(),l="",o=0;if(t.cellXfs=[],bi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",It(i,l,HE(e.Props,t)),n.coreprops.push(l),sr(t.rels,2,l,Rt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,It(i,l,qE(e.Props)),n.extprops.push(l),sr(t.rels,3,l,Rt.EXT_PROPS),e.Custprops!==e.Props&&Pr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",It(i,l,KE(e.Custprops)),n.custprops.push(l),sr(t.rels,4,l,Rt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,It(i,l,BT(o-1,t,e,m)),n.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(f){var x=f["!comments"],p=!1,g="";if(x&&x.length>0){var j=!1;x.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(j=!0)})}),j&&(g="xl/threadedComments/threadedComment"+o+"."+r,It(i,g,LB(x,d,t)),n.threadedcomments.push(g),sr(m,-1,"../threadedComments/threadedComment"+o+"."+r,Rt.TCMNT)),g="xl/comments"+o+"."+r,It(i,g,CT(x)),n.comments.push(g),sr(m,-1,"../comments"+o+"."+r,Rt.CMNT),p=!0}f["!legacy"]&&p&&It(i,"xl/drawings/vmlDrawing"+o+".vml",TT(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&It(i,cc(l),Ll(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,It(i,l,hT(t.Strings,t)),n.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Rt.SST)),l="xl/workbook."+r,It(i,l,HT(e)),n.workbooks.push(l),sr(t.rels,1,l,Rt.WB),l="xl/theme/theme1.xml",It(i,l,Lg(e.Themes,t)),n.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Rt.THEME),l="xl/styles."+r,It(i,l,wT(e,t)),n.styles.push(l),sr(t.wbrels,-1,"styles."+r,Rt.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",It(i,l,e.vbaraw),n.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Rt.VBA)),l="xl/metadata."+r,It(i,l,ET()),n.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Rt.XLMETA),d.length>1&&(l="xl/persons/person.xml",It(i,l,BB(d)),n.people.push(l),sr(t.wbrels,-1,"persons/person.xml",Rt.PEOPLE)),It(i,"[Content_Types].xml",$E(n,t)),It(i,"_rels/.rels",Ll(t.rels)),It(i,"xl/_rels/workbook."+r+".rels",Ll(t.wbrels)),delete t.revssf,delete t.ssf,i}function qg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ja(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function IW(e,t){return mt.find(e,"EncryptedPackage")?CW(e,t):KT(e,t)}function DW(e,t){var r,a=e,n=t||{};return n.type||(n.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=xE(a,n),TW(r,n)}function rC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Zp(e.slice(r),t);default:break e}return Gl.to_workbook(e,t)}function PW(e,t){var r="",a=qg(e,t);switch(t.type){case"base64":r=ja(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Yi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ir(r)),t.type="binary",rC(r,t)}function OW(e,t){var r=e;return t.type=="base64"&&(r=ja(r)),r=sc.utils.decode(1200,r.slice(2),"str"),t.type="binary",rC(r,t)}function RW(e){return e.match(/[^\x00-\x7F]/)?hn(e):e}function Sf(e,t,r,a){return a?(r.type="string",Gl.to_workbook(e,r)):Gl.to_workbook(t,r)}function xc(e,t){mg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xc(new Uint8Array(e),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bl={},r.dateNF&&(Bl.dateNF=r.dateNF),r.type||(r.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Pt?"buffer":"binary",a=_6(e),typeof Uint8Array<"u"&&!Pt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=RW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=pr(r),r.type="array",xc(fg(a),r)}switch((n=qg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return IW(mt.read(a,r),r);break;case 9:if(n[1]<=8)return KT(a,r);break;case 60:return Zp(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return z8(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return mT.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?DW(a,r):Sf(e,a,r,i);case 239:return n[3]===60?Zp(a,r):Sf(e,a,r,i);case 255:if(n[1]===254)return OW(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Bi.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Bi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Jp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return yT.to_workbook(a,r);break;case 10:case 13:case 32:return PW(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return B8.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Jp.to_workbook(a,r):Sf(e,a,r,i)}function sC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Lc(t.file,mt.write(e,{type:Pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mt.write(e,t)}function FW(e,t){var r=pr(t||{}),a=AW(e,r);return LW(a,r)}function LW(e,t){var r={},a=Pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(dm(n))}return t.password&&typeof encrypt_agile<"u"?sC(encrypt_agile(n,t.password),t):t.type==="file"?Lc(t.file,n):t.type=="string"?ir(n):n}function MW(e,t){var r=t||{},a=R9(e,r);return sC(a,r)}function fn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return ac(hn(a));case"binary":return hn(a);case"string":return e;case"file":return Lc(t.file,a,"utf8");case"buffer":return Pt?$n(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):fn(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function BW(e,t){switch(t.type){case"base64":return ac(e);case"binary":return e;case"string":return e;case"file":return Lc(t.file,e,"binary");case"buffer":return Pt?$n(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Td(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?ac(r):t.type=="string"?ir(r):r;case"file":return Lc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function aC(e,t){mg(),IU(e);var r=pr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=aC(e,r);return r.type="array",dm(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fn(A9(e,r),r);case"slk":case"sylk":return fn(uT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return fn(XT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return BW(nC(e.Sheets[e.SheetNames[n]],r),r);case"csv":return fn(Yg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return fn(mT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Td(Jp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return fn(Gl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return fn(yT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return fn(fT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return fn(eC(e,r),r);case"wk1":return Td(Bi.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Td(Bi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Td(YT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),MW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function zW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Kg(e,t,r){var a=r||{};return a.type="file",a.file=t,zW(a),aC(e,a)}function $W(e,t,r,a,n,i,l,o){var c=$r(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!l||e[r])for(var h=t.s.c;h<=t.e.c;++h){var x=l?e[r][h]:e[a[h]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[h]!=null&&(f[i[h]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(p==null)if(x.t=="e"&&p===null)f[i[h]]=null;else if(u!==void 0)f[i[h]]=u;else if(d&&p===null)f[i[h]]=null;else continue;else f[i[h]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:Fn(x,p,o);p!=null&&(m=!1)}}return{row:f,isempty:m}}function xu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":c=qt(d);break;case"number":c=qt(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var m=$r(c.s.r),f=[],h=[],x=0,p=0,g=Array.isArray(e),j=c.s.r,w=0,y={};g&&!e[j]&&(e[j]=[]);var b=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(b[w]||{}).hidden)switch(f[w]=Er(w),r=g?e[j][w]:e[f[w]+m],a){case 1:i[w]=w-c.s.c;break;case 2:i[w]=f[w];break;case 3:i[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Fn(r,null,u),p=y[l]||0,!p)y[l]=1;else{do o=l+"_"+p++;while(y[o]);y[l]=p,y[o]=1}i[w]=o}for(j=c.s.r+n;j<=c.e.r;++j)if(!(S[j]||{}).hidden){var E=$W(e,c,j,f,a,i,g,u);(E.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(h[x++]=E.row)}return h.length=x,h}var P1=/"/g;function UW(e,t,r,a,n,i,l,o){for(var c=!0,u=[],d="",m=$r(r),f=t.s.c;f<=t.e.c;++f)if(a[f]){var h=o.dense?(e[r]||[])[f]:e[a[f]+m];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(o.rawNumbers&&h.t=="n"?h.v:Fn(h,null,o));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===n||p===i||p===34||o.forceQuotes){d='"'+d.replace(P1,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(P1,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function Yg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=qt(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];a.dense=Array.isArray(e);for(var f=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(f[x]||{}).hidden||(m[x]=Er(x));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(d=UW(e,n,g,m,l,c,i,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((p++?o:"")+d)));return delete a.dense,r.join("")}function nC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yg(e,t);return r}function WW(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=qt(e["!ref"]),i="",l=[],o,c=[],u=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=Er(o);for(var d=n.s.r;d<=n.e.r;++d)for(i=$r(d),o=n.s.c;o<=n.e.c;++o)if(t=l[o]+i,r=u?(e[d]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function iC(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Tr(a.origin):a.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var m=qt(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+n)}else l==-1&&(l=0,d.e.r=t.length-1+n);var f=a.header||[],h=0;t.forEach(function(p,g){Pr(p).forEach(function(j){(h=f.indexOf(j))==-1&&(f[h=f.length]=j);var w=p[j],y="z",b="",S=bt({c:o+h,r:l+g+n});u=gc(i,S),w&&typeof w=="object"&&!(w instanceof Date)?i[S]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",a.cellDates||(y="n",w=Qr(w)),b=a.dateNF||vt[14]):w===null&&a.nullError&&(y="e",w=0),u?(u.t=y,u.v=w,delete u.w,delete u.R,b&&(u.z=b)):i[S]=u={t:y,v:w},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var x=$r(l);if(n)for(h=0;h<f.length;++h)i[Er(h+o)+x]={t:"s",v:f[h]};return i["!ref"]=_t(d),i}function HW(e,t){return iC(null,e,t)}function gc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Tr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gc(e,bt(t)):gc(e,bt({r:t,c:r||0}))}function VW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Xg(){return{SheetNames:[],Sheets:{}}}function Jg(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(WT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function GW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=VW(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function qW(e,t){return e.z=t,e}function lC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function KW(e,t,r){return lC(e,"#"+t,r)}function YW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function XW(e,t,r,a){for(var n=typeof t!="string"?t:qt(t),i=typeof t=="string"?t:_t(t),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=gc(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Ma={encode_col:Er,encode_row:$r,encode_cell:bt,encode_range:_t,decode_col:Eg,decode_row:Sg,split_cell:lF,decode_cell:Tr,decode_range:sa,format_cell:Fn,sheet_add_aoa:OE,sheet_add_json:iC,sheet_add_dom:JT,aoa_to_sheet:co,json_to_sheet:HW,table_to_sheet:ZT,table_to_book:sW,sheet_to_csv:Yg,sheet_to_txt:nC,sheet_to_json:xu,sheet_to_html:XT,sheet_to_formulae:WW,sheet_to_row_object_array:xu,sheet_get_cell:gc,book_new:Xg,book_append_sheet:Jg,book_set_sheet_visibility:GW,cell_set_number_format:qW,cell_set_hyperlink:lC,cell_set_internal_link:KW,cell_add_comment:YW,sheet_set_array_formula:XW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const JW=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState([]),[x,p]=v.useState([]),[g,j]=v.useState(!1),w=v.useRef(null),y=["first_name","last_name","email","role"],b=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];v.useEffect(()=>{e&&S()},[e]);const S=async()=>{try{j(!0);const P=await Es.getRoles(),C=P?.roles||P||[];p(C)}catch{m(["Failed to load roles. Please refresh the page."]),p([])}finally{j(!1)}},E=P=>{if(!P)return"";try{return decodeURIComponent(escape(P)).trim()}catch{return P.toString().trim()}},N=P=>{const C=P?.response?.data;return C?C.errors&&Array.isArray(C.errors)?C.errors.map(Z=>{const J=Z.path?.match(/users\.(\d+)\..*?\.(\w+)$/);let le="Unknown",V="";return J&&(le=parseInt(J[1])+1,V=J[2],V=V.replace(/([A-Z])/g," $1").toUpperCase().trim()),`Row ${le} - ${V||Z.path}: ${Z.message}`}):[C.message||"Failed to import users. Please try again."]:[P.message||"Failed to import users. Please try again."]},T=P=>{if(!P)return"";try{let C,W,Z;if(P instanceof Date)C=P.getUTCFullYear(),W=P.getUTCMonth()+1,Z=P.getUTCDate(),console.log(" [formatDateToISO] Date object detected (using UTC):",{date:P.toString(),extracted:{year:C,month:W,day:Z}});else{const V=P.toString().trim();if(!V||V===""||V==="null"||V==="undefined")return"";if(V.includes("/")){const re=V.split("/");if(re.length===3){if(C=parseInt(re[2],10),W=parseInt(re[0],10),Z=parseInt(re[1],10),C<100){const he=new Date().getFullYear(),O=Math.floor(he/100)*100,ye=he%100;C<=ye?C=O+C:C=O-100+C}console.log(" [formatDateToISO] Parsed MM/DD/YYYY format:",{year:C,month:W,day:Z})}}else if(V.includes("-")){const re=V.split("-");if(re.length===3)if(re[0].length===4)C=parseInt(re[0],10),W=parseInt(re[1],10),Z=parseInt(re[2],10),console.log(" [formatDateToISO] Parsed YYYY-MM-DD format:",{year:C,month:W,day:Z});else{if(C=parseInt(re[2],10),W=parseInt(re[1],10),Z=parseInt(re[0],10),C<100){const he=new Date().getFullYear(),O=Math.floor(he/100)*100,ye=he%100;C<=ye?C=O+C:C=O-100+C}console.log(" [formatDateToISO] Parsed DD-MM-YYYY format:",{year:C,month:W,day:Z})}}else{const re=new Date(V);console.log(" [formatDateToISO] Direct parsing:",{input:V}),C=re.getFullYear(),W=re.getMonth()+1,Z=re.getDate()}}if(!C||!W||!Z)return console.warn(" [formatDateToISO] Invalid date components detected"),"";if(C<1900||C>2100)return console.warn(" [formatDateToISO] Date out of valid range:",{year:C}),"";const J=new Date(Date.UTC(C,W-1,Z));return isNaN(J.getTime())?(console.warn(" [formatDateToISO] Invalid date after UTC conversion"),""):J.toISOString()}catch{return""}},k=P=>{if(!P)return"MALE";const C=P.toString().toUpperCase().trim();return C==="MALE"||C==="FEMALE"?C:{M:"MALE",F:"FEMALE"}[C]||"MALE"},I=P=>{if(!P)return null;const C=P.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(C)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},D=P=>P?P.toString().toUpperCase().trim().replace(/\s+/g,"_"):"",A=P=>{if(!P||!x.length)return null;const C=D(P),W=x.find(V=>D(V.name)===C);if(W)return W.id;const J={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE"}[C];if(J){const V=x.find(re=>D(re.name)===J);if(V)return V.id}const le=x.find(V=>{const re=D(V.name);return re.includes(C)||C.includes(re)});return le?le.id:null},M=P=>{if(!P||!x.length)return null;const C=D(P),W=x.find(V=>D(V.name)===C);if(W)return W.name;const J={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT"}[C];if(J){const V=x.find(re=>D(re.name)===J);if(V)return V.name}const le=x.find(V=>{const re=D(V.name);return re.includes(C)||C.includes(re)});return le?le.name:null},G=()=>{const P=[b,["Ha","Th","Trn","456 L Vn S, Qun 3, TP.HCM","tranthihoa.trainer@example.com","0912345679","","FEMALE","TRAINER","CERT555","Cabin Safety","7","Hun luyn vin Cabin Safety vi 7 nm kinh nghim quc t","","","","",""],["Hng","Th","Trn","456 L Vn S, Qun 3, TP.HCM","tranthihong.trainee@example.com","0912345680","","FEMALE","TRAINEE","","","","","","","","B987654322","Vietnam"]],C=Ma.aoa_to_sheet(P),W=Ma.book_new();Ma.book_append_sheet(W,C,"Users"),Kg(W,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},q=P=>{P.preventDefault(),P.stopPropagation(),P.type==="dragenter"||P.type==="dragover"?i(!0):P.type==="dragleave"&&i(!1)},z=P=>{P.preventDefault(),P.stopPropagation(),i(!1),P.dataTransfer.files&&P.dataTransfer.files[0]&&U(P.dataTransfer.files[0])},ee=P=>{P.target.files&&P.target.files[0]&&U(P.target.files[0])},U=P=>{if(!P.name.match(/\.(xlsx|xls)$/)){m(["Please upload an Excel file (.xlsx or .xls)"]);return}if(P.size>100*1024*1024){m(["File size must be less than 100MB"]);return}if(o(P),m([]),h([]),u([]),g){h(["Roles are still loading. Please wait a moment and try again."]);return}if(x.length===0){h(["Roles are not loaded yet. Please refresh the page and try again."]);return}const C=new FileReader;C.onload=W=>{try{const Z=new Uint8Array(W.target.result),J=xc(Z,{type:"array",cellText:!1,cellDates:!0,raw:!1}),le=J.SheetNames[0],V=J.Sheets[le],he=Ma.sheet_to_json(V,{header:1,defval:"",raw:!1}).filter(Xe=>!Xe||Xe.length===0?!1:Xe.some(ge=>ge!=null&&ge!==""&&String(ge).trim()!==""));if(he.length<2){m(["File must contain at least a header row and one data row. Please check if your file has empty rows or formatting issues."]);return}const O=he[0].map(Xe=>Xe?Xe.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),ye=he.slice(1).filter(Xe=>Xe.some(ge=>ge!=null&&ge!==""&&String(ge).trim()!==""));if(ye.length===0){m(["File must contain at least one data row with content. Please check if your data rows are empty or have formatting issues."]);return}const de={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},xe=O.map(Xe=>de[Xe]||Xe).filter(Xe=>b.includes(Xe)),me=y.filter(Xe=>!xe.includes(Xe));if(me.length>0){h([`Your file is missing these essential data to create a user: ${me.join(", ")}`]);return}x.length===0&&h([" Roles are still loading. Role validation may fail. Please wait and try again if you see role errors."]);const $e=ye.map((Xe,ge)=>{const qe={};let st=!1;const Te=[];O.forEach((ze,et)=>{const yt=de[ze]||ze;if(b.includes(yt)){let lt="";if(Xe[et]!==null&&Xe[et]!==void 0)if(typeof Xe[et]=="string")lt=E(Xe[et]);else if(Xe[et]instanceof Date){const Me=Xe[et],ke=String(Me.getMonth()+1).padStart(2,"0"),nt=String(Me.getDate()).padStart(2,"0"),tt=Me.getFullYear();lt=`${ke}/${nt}/${tt}`}else typeof Xe[et]=="number"?lt=Xe[et].toString():lt=E(Xe[et].toString());yt==="gender"&&(lt=k(lt)),qe[yt]=lt}}),xe.forEach(ze=>{const et=qe[ze]||"";if(y.includes(ze)&&!et&&(st=!0,Te.push("Required field missing")),ze==="email"&&et&&!/\S+@\S+\.\S+/.test(et)&&(st=!0,Te.push("Invalid email")),ze==="role"&&et&&x.length>0&&(A(et)||(st=!0,Te.push(`Invalid role: "${et}". Available roles: ${x.map(lt=>lt.name).join(", ")}`))),ze==="phone_number"&&et&&et.length>15&&(st=!0,Te.push("Phone number too long (max 15 characters)")),ze==="years_of_experience"&&et&&isNaN(et)&&(st=!0,Te.push("Invalid experience value")),ze==="gender"&&et){const yt=I(et);yt&&(st=!0,Te.push(yt))}});const Ke=M(qe.role);return Ke==="TRAINER"?((!qe.specialization||qe.specialization.trim()==="")&&(st=!0,Te.push("Trainer requires specialization")),(!qe.years_of_experience||qe.years_of_experience.trim()==="")&&(st=!0,Te.push("Trainer requires years of experience"))):Ke==="TRAINEE"&&(!qe.date_of_birth||qe.date_of_birth.trim()===""?(st=!0,Te.push("Trainee requires date of birth")):T(qe.date_of_birth)||(st=!0,Te.push(`Invalid date format for date of birth: "${qe.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!qe.training_batch||qe.training_batch.trim()==="")&&(st=!0,Te.push("Trainee requires training batch")),(!qe.passport_no||qe.passport_no.trim()==="")&&(st=!0,Te.push("Trainee requires passport number")),(!qe.nation||qe.nation.trim()==="")&&(st=!0,Te.push("Trainee requires nation")),qe.enrollment_date&&qe.enrollment_date.trim()!==""&&(T(qe.enrollment_date)||(st=!0,Te.push(`Invalid date format for enrollment date: "${qe.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:ge+1,...qe,hasError:st,errors:Te,status:st?"error":"valid"}});u($e)}catch{m(["Error reading file. Please make sure it's a valid Excel file."])}},C.readAsArrayBuffer(P)},X=async()=>{const P=c.filter(W=>!W.hasError);if(P.length===0){m(["No valid users to import"]);return}if(!x.length){m(["Roles not loaded. Please wait and try again."]);return}const C=P.map(W=>{const Z=W.phone_number?W.phone_number.substring(0,15):"",J=A(W.role),le=M(W.role);if(!J||!le)throw new Error(`Role "${W.role}" not found in system`);const V={firstName:W.first_name||"",middleName:W.middle_name||"",lastName:W.last_name||"",address:W.address||"",email:W.email||"",phoneNumber:Z,avatarUrl:W.avatar_url||"",gender:k(W.gender),role:{id:J,name:le}};if(le==="TRAINER")V.trainerProfile={specialization:W.specialization||"",yearsOfExp:W.years_of_experience?parseInt(W.years_of_experience):0,certificationNumber:W.certification_number||"",bio:W.bio||""};else if(le==="TRAINEE"){const re={trainingBatch:W.training_batch||"",passportNo:W.passport_no||"",nation:W.nation||""},he=T(W.date_of_birth);he&&(re.dob=he);const O=T(W.enrollment_date);O?re.enrollmentDate=O:re.enrollmentDate=new Date().toISOString(),V.traineeProfile=re}return V});try{await r(C),oe()}catch(W){const Z=N(W);m(Z)}},oe=()=>{o(null),u([]),m([]),h([]),i(!1),t()},Ee=P=>{u(C=>C.filter(W=>W.id!==P))},F=P=>P==="valid"?s.jsx(it,{className:"text-success",size:16}):s.jsx(zr,{className:"text-danger",size:16});return s.jsxs(se,{show:e,onHide:oe,size:"xl",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Users"]}),s.jsx(ae,{variant:"link",onClick:oe,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:s.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),s.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),s.jsx(Y,{className:"mb-4",children:s.jsxs(Y.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:q,onDragLeave:q,onDragOver:q,onDrop:z,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Ul,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:ee,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[l&&s.jsxs("p",{className:"text-success mb-1",children:[s.jsx("strong",{children:"Uploaded file:"})," ",l.name]}),s.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),s.jsxs("small",{className:"text-info d-block mt-1",children:[s.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:G,className:"d-flex align-items-center",children:[s.jsx(il,{className:"me-1",size:14}),"Download Template"]})]})]})}),d.length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",style:{borderRadius:"8px",borderLeft:"4px solid #dc3545",padding:"1rem",backgroundColor:"#f8d7da"},children:[s.jsx("h6",{className:"text-danger mb-3",style:{fontWeight:"bold"},children:" Import Failed - Please fix the following errors:"}),s.jsx("ul",{className:"mb-0",children:d.map((P,C)=>s.jsx("li",{style:{marginBottom:"0.5rem",color:"#721c24"},children:s.jsx("strong",{children:P})},C))})]}),f.length>0&&s.jsxs(Ue,{variant:"warning",className:"mb-3",style:{borderRadius:"8px",borderLeft:"4px solid #856404",padding:"1rem"},children:[s.jsx("h6",{className:"text-warning mb-3",style:{fontWeight:"bold"},children:" Validation Issues - Please review:"}),s.jsx("ul",{className:"mb-0",children:f.map((P,C)=>s.jsx("li",{style:{marginBottom:"0.5rem",color:"#856404"},children:s.jsx("strong",{children:P})},C))})]}),c.length>0&&s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(dr,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"2000px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"ADDRESS"}),s.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),s.jsx("th",{style:{minWidth:"150px"},children:"AVATAR URL"}),s.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),s.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),s.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),s.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),s.jsx("th",{style:{minWidth:"120px"},children:"EXPERIENCE (YEARS)"}),s.jsx("th",{style:{minWidth:"150px"},children:"BIO"}),s.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),s.jsx("th",{style:{minWidth:"120px"},children:"ENROLLMENT DATE"}),s.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),s.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),s.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:c.map(P=>s.jsxs("tr",{className:P.hasError?"table-danger":"",children:[s.jsx("td",{children:P.id}),s.jsx("td",{children:P.first_name||P.full_name||"-"}),s.jsx("td",{children:P.middle_name||"-"}),s.jsx("td",{children:P.last_name||"-"}),s.jsx("td",{children:P.address||"-"}),s.jsx("td",{children:P.email||"-"}),s.jsx("td",{children:P.phone_number||"-"}),s.jsx("td",{children:P.avatar_url||"-"}),s.jsx("td",{children:P.gender?s.jsx("span",{title:`Original: ${P.gender}`,children:k(P.gender)}):"-"}),s.jsx("td",{children:P.role||"-"}),s.jsx("td",{children:P.certification_number||"-"}),s.jsx("td",{children:P.specialization||"-"}),s.jsx("td",{children:P.years_of_experience||"-"}),s.jsx("td",{children:P.bio||"-"}),s.jsx("td",{children:P.date_of_birth?(()=>{const C=T(P.date_of_birth);return C?new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"Invalid"})():"-"}),s.jsx("td",{children:P.enrollment_date?(()=>{const C=T(P.enrollment_date);return C?new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"Invalid"})():"-"}),s.jsx("td",{children:P.training_batch||"-"}),s.jsx("td",{children:P.passport_no||"-"}),s.jsx("td",{children:P.nation||"-"}),s.jsx("td",{className:"text-center",children:F(P.status)}),s.jsx("td",{children:P.errors.length>0&&s.jsx("small",{className:"text-danger",children:P.errors.length>1?`${P.errors[0]} (+${P.errors.length-1} more)`:P.errors[0]})}),s.jsx("td",{children:s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>Ee(P.id),children:s.jsx(ba,{size:14})})})]},P.id))})]})})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:oe,disabled:a,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&s.jsx(z2,{placement:"top",overlay:s.jsxs($2,{id:"import-tooltip",children:["Only ",c.filter(P=>!P.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:s.jsx(ae,{variant:"primary",onClick:X,disabled:a||c.filter(P=>!P.hasError).length===0,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import All (",c.filter(P=>!P.hasError).length," users)"]})})})]})]})},ZW=({show:e,user:t,onConfirm:r,onCancel:a,loading:n=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",l=i?"Disable":"Enable",c=i?kc:it;return s.jsxs(se,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,dialogClassName:"modal-scrollable-content",children:[s.jsx(se.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),l," User"]})}),s.jsxs(se.Body,{className:"py-4",style:{maxHeight:"calc(100vh - 200px)",overflowY:"auto"},children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:s.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),s.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),s.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"EID"}),s.jsx("div",{className:"fw-medium",children:t.eid})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),t.role==="DEPARTMENT_HEAD"&&s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Department"}),s.jsx("div",{className:"fw-medium",children:t.department||"N/A"})]}),t.role!=="DEPARTMENT_HEAD"&&s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:""}),s.jsx("div",{className:"fw-medium",children:""})]})]})]}),i?s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User cannot log into the system"}),s.jsx("li",{children:"All active sessions will be terminated"}),s.jsx("li",{children:"User data will be preserved but access restricted"}),s.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):s.jsxs(Ue,{variant:"success",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User can log into the system normally"}),s.jsx("li",{children:"All permissions and access will be restored"}),s.jsx("li",{children:"User will receive notification of account activation"}),s.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),s.jsxs(se.Footer,{className:"border-0 bg-light",children:[s.jsx(ae,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:i?"warning":"success",onClick:r,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"me-2",size:16}),l," User"]})})]})]})},QW=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:a,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0,u=d=>d?d.split("_").map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join(" "):"";return s.jsxs(Ct,{className:`filter-panel-dropdown ${o}`,children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ll,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(Ct.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(_.Check,{type:"checkbox",id:`role-${d}`,label:u(d),checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(_.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]})]})]})},eH=({show:e,user:t,newRole:r,onConfirm:a,onCancel:n,loading:i=!1})=>{if(!t)return null;const l=u=>{switch(u){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},o=l(t.role),c=l(r);return s.jsxs(se,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(se.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),s.jsxs(se.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:s.jsx(Gt,{size:32,className:"text-warning"})}),s.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),s.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"Current Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"New Role"}),s.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",o,")"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),s.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),s.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),s.jsxs(se.Footer,{className:"border-0 bg-light",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:n,disabled:i,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"warning",onClick:()=>{a()},disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},tH=({show:e,user:t,mode:r,onSave:a,onClose:n})=>{const[i,l]=v.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""});console.log(" DEBUG UserModal: user prop received:",t),t?.traineeProfile&&(console.log("   traineeProfile:",t.traineeProfile),console.log("   traineeProfile.dob:",t.traineeProfile.dob),console.log("   traineeProfile.nation:",t.traineeProfile.nation),console.log("   traineeProfile.trainingBatch:",t.traineeProfile.trainingBatch));const[o,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState([]),[h,x]=v.useState(!1),p=T=>!T||T==="N/A"||T==="null"||T==="undefined"?"":String(T).trim(),g=T=>T?T.split("_").map(k=>k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()).join(" "):"",j=async()=>{x(!0);try{const T=await Es.getRoles(),I=(T?.roles||T||[]).map(D=>D.name);f(I)}catch(T){console.error("Error fetching roles:",T),te.error("Failed to load roles"),f([])}finally{x(!1)}},w=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"];v.useEffect(()=>{e&&j()},[e]),v.useEffect(()=>{if(t&&r!=="add"){const T=typeof t.role=="string"?t.role:t.role?.name||"";let k={firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:T,roleId:t.roleId||"",department:p(t.department),certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:""};T==="TRAINEE"&&t.traineeProfile&&(console.log(" traineeProfile found:",t.traineeProfile),k.dateOfBirth=t.traineeProfile.dob?t.traineeProfile.dob.split("T")[0]:"",k.passportNo=p(t.traineeProfile.passportNo),k.nation=p(t.traineeProfile.nation),k.trainingBatch=p(t.traineeProfile.trainingBatch),console.log(" DEBUG: Loaded TRAINEE profile data:"),console.log("   dob raw:",t.traineeProfile.dob),console.log("   dateOfBirth after split:",k.dateOfBirth),console.log("   nation raw:",t.traineeProfile.nation),console.log("   nation after normalize:",k.nation),console.log("   trainingBatch raw:",t.traineeProfile.trainingBatch),console.log("   trainingBatch after normalize:",k.trainingBatch),console.log("   passportNo:",k.passportNo)),T==="TRAINER"&&t.trainerProfile&&(k.specialization=p(t.trainerProfile.specialization),k.certificationNumber=p(t.trainerProfile.certificationNumber),k.yearsOfExperience=t.trainerProfile.yearsOfExperience||"",k.bio=p(t.trainerProfile.bio),console.log(" DEBUG: Loaded TRAINER profile data:"),console.log("   specialization:",k.specialization),console.log("   certificationNumber:",k.certificationNumber),console.log("   bio:",k.bio)),!k.specialization&&t.specialization&&(k.specialization=p(t.specialization)),!k.certificationNumber&&t.certificationNumber&&(k.certificationNumber=p(t.certificationNumber)),!k.bio&&t.bio&&(k.bio=p(t.bio)),!k.passportNo&&t.passportNo&&(k.passportNo=p(t.passportNo)),l(k),console.log(" DEBUG: Final formData loaded:"),console.log("   Role:",k.role),console.log("   Department:",k.department,"(should be empty string if was N/A)"),console.log("   DateOfBirth:",k.dateOfBirth,"(ISO format YYYY-MM-DD)"),console.log("   Nation:",k.nation),console.log("   PassportNo:",k.passportNo),console.log("   TrainingBatch:",k.trainingBatch),console.log("   All fields:",k)}else r==="add"&&l({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""});c({})},[t,r,e]);const y=()=>{const T={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(T.firstName="First name can only contain letters and spaces"):T.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(T.lastName="Last name can only contain letters and spaces"):T.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(T.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(T.email="Email is invalid"):T.email="Email is required",i.phoneNumber.trim()&&!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))T.phoneNumber="Phone number cannot contain letters";else if(i.phoneNumber.trim()){const k=i.phoneNumber.replace(/[^\d+]/g,"");(k.length<7||k.length>16)&&(T.phoneNumber="Phone number must be 7-16 digits")}return i.role||(T.role="Role is required"),i.role==="TRAINER"&&(i.specialization.trim()||(T.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(T.certificationNumber="Certification number is required for trainers"),!i.bio||!i.bio.trim()||(i.bio.trim().length<1?T.bio="Bio must be at least 1 character":/^[a-zA-Z0-9\s.,!?();:'"-]+$/.test(i.bio.trim())||(T.bio="Bio can only contain letters, numbers, spaces, and common punctuation")),i.department&&i.department.trim()!==""&&(T.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(T.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()||(T.passportNo="Passport number is required for trainees"),i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?T.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(T.dateOfBirth="Date of birth must be in the past"):T.dateOfBirth="Date of birth is required for trainees"),c(T),Object.keys(T).length===0},b=async T=>{if(T.preventDefault(),!!y()&&!u){d(!0);try{await a(i)}catch(k){console.error("Error in handleSubmit:",k)}finally{d(!1)}}},S=(T,k)=>{l(I=>({...I,[T]:k})),c(I=>{const D={...I};return D[T]&&delete D[T],T==="role"&&(delete D.specialization,delete D.certificationNumber,delete D.bio,delete D.trainingBatch,delete D.passportNo,delete D.dateOfBirth,delete D.department),T==="department"&&(delete D.department,i.role==="TRAINER"&&k&&k.trim()!==""&&(D.department="Department is not allowed for Trainer role")),T==="role"&&k==="TRAINER"&&l(A=>({...A,department:""})),D})},E=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},N=r==="view";return s.jsxs(se,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(se.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(Zr,{className:"me-2",size:20}),E()]})}),s.jsxs(_,{onSubmit:b,children:[s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(o).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([T,k])=>s.jsx("li",{children:k},T))})]}),s.jsxs(ue,{children:[s.jsx(H,{md:4,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),s.jsx(_.Control,{type:"text",value:i.firstName,onChange:T=>S("firstName",T.target.value),isInvalid:!!o.firstName,readOnly:N,style:{borderColor:o.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.firstName})]})}),s.jsx(H,{md:4,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),s.jsx(_.Control,{type:"text",value:i.middleName,onChange:T=>S("middleName",T.target.value),isInvalid:!!o.middleName,readOnly:N,style:{borderColor:o.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.middleName})]})}),s.jsx(H,{md:4,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),s.jsx(_.Control,{type:"text",value:i.lastName,onChange:T=>S("lastName",T.target.value),isInvalid:!!o.lastName,readOnly:N,style:{borderColor:o.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.lastName})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),s.jsx(_.Control,{type:"email",value:i.email,onChange:T=>S("email",T.target.value),isInvalid:!!o.email,readOnly:N,style:{borderColor:o.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.email})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number"}),s.jsx(_.Control,{type:"tel",value:i.phoneNumber,onChange:T=>S("phoneNumber",T.target.value),isInvalid:!!o.phoneNumber,readOnly:N,placeholder:"Enter phone number",style:{borderColor:o.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.phoneNumber})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),s.jsx(_.Control,{as:"textarea",rows:3,value:i.address,onChange:T=>S("address",T.target.value),readOnly:N,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsxs(ue,{children:[s.jsx(H,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),s.jsxs(_.Select,{value:i.role,onChange:T=>S("role",T.target.value),isInvalid:!!o.role,disabled:N||h,style:{borderColor:o.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:h?"Loading roles...":"Select a role"}),m.map(T=>s.jsx("option",{value:T,children:g(T)},T))]}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.role})]})}),i.role==="DEPARTMENT_HEAD"&&s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),s.jsx(_.Control,{type:"text",value:i.department,onChange:T=>S("department",T.target.value),isInvalid:!!o.department,readOnly:N,placeholder:"Enter department name (optional)",style:{borderColor:o.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.department})]})})]}),i.role==="TRAINER"&&s.jsxs(s.Fragment,{children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),s.jsx(_.Control,{type:"text",value:i.specialization,onChange:T=>S("specialization",T.target.value),isInvalid:!!o.specialization,readOnly:N,placeholder:"Enter specialization",style:{borderColor:o.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.specialization})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),s.jsx(_.Control,{type:"text",value:i.certificationNumber,onChange:T=>S("certificationNumber",T.target.value),isInvalid:!!o.certificationNumber,readOnly:N,placeholder:"Enter certification number",style:{borderColor:o.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.certificationNumber})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),s.jsx(_.Control,{type:"number",value:i.yearsOfExperience,onChange:T=>S("yearsOfExperience",T.target.value),readOnly:N,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Bio"}),s.jsx(_.Control,{as:"textarea",rows:4,value:i.bio,onChange:T=>S("bio",T.target.value),isInvalid:!!o.bio,readOnly:N,placeholder:"Enter trainer bio (at least 1 character, no unsupported characters)",style:{borderColor:o.bio?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.bio}),s.jsx(_.Text,{className:"text-muted",children:"Bio is optional. If provided, must contain at least 1 character. Only letters, numbers, spaces, and common punctuation are allowed."})]})})})]}),i.role==="TRAINEE"&&s.jsxs(s.Fragment,{children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),s.jsx(_.Control,{type:"date",value:i.dateOfBirth,onChange:T=>{const k=T.target.value;(k===""||k.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(k))&&S("dateOfBirth",k)},isInvalid:!!o.dateOfBirth,readOnly:N,max:"2024-12-31",min:"1900-01-01",style:{borderColor:o.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.dateOfBirth})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),s.jsx(_.Control,{type:"text",value:i.trainingBatch,onChange:T=>S("trainingBatch",T.target.value),isInvalid:!!o.trainingBatch,readOnly:N,placeholder:"Enter training batch",style:{borderColor:o.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.trainingBatch})]})})]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),s.jsx(_.Control,{type:"text",value:i.passportNo,onChange:T=>S("passportNo",T.target.value),isInvalid:!!o.passportNo,readOnly:N,placeholder:"Enter passport number",style:{borderColor:o.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.passportNo})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),s.jsxs(_.Select,{value:i.nation,onChange:T=>S("nation",T.target.value),disabled:N,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select a nation"}),w.map(T=>s.jsx("option",{value:T,children:T},T))]})]})})]})]}),r==="view"&&t&&s.jsx(ue,{children:s.jsx(H,{children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),s.jsx(_.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:n,disabled:u,children:[s.jsx(ht,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(ae,{variant:"primary-custom",type:"submit",disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},rH=({user:e,index:t,onView:r,onEdit:a,onDisable:n})=>{const i=u=>u==="ACTIVE"?"success":"secondary",l=u=>u==="ACTIVE"?"":"",o=u=>u?u.split("_").map(d=>d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()).join(" "):"",c=e.role==="ADMINISTRATOR";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} user-management-row`,style:{transition:"background-color 0.2s ease",willChange:"background-color"},onMouseEnter:u=>{u.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:u=>{u.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),s.jsx("td",{className:"align-middle show-mobile",style:{maxWidth:"200px",overflow:"hidden"},children:s.jsx("span",{className:"text-dark",style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.email})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:o(e.role)})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs(Ae,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:l(e.status)}),e.status?.replace(/_/g," ")]})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Nt,{permissions:[De.VIEW_USER_IN_DETAIL,De.UPDATE_USER],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r(e),permission:De.VIEW_USER_IN_DETAIL},...c?[]:[{label:"Edit User",icon:s.jsx(Ar,{}),onClick:()=>a(e),permission:De.UPDATE_USER,disabled:e.status==="DISABLED"}],...c?[]:[{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:s.jsx(kc,{}),className:"text-danger",onClick:()=>n(e),permission:De.UPDATE_USER}]]})})})]})},sH=({users:e,loading:t,onView:r,onEdit:a,onDisable:n})=>{const{sortedData:i,sortConfig:l,handleSort:o}=ts(e);if(t)return s.jsx(Fr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No users found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:u,children:d,className:m=""})=>{const f=l.key===u,h=f?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500",color:"white"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:h,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive user-management-table",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),s.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((u,d)=>s.jsx(rH,{user:u,index:d,onView:r,onEdit:a,onDisable:n},u.id))})]})})},aH=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState([]),[c,u]=v.useState(!1),[d,m]=v.useState(null),[f,h]=v.useState("view"),[x,p]=v.useState(!1),[g,j]=v.useState(null),[w,y]=v.useState(!1),[b,S]=v.useState(null);v.useEffect(()=>{(async()=>{p(!0);try{const C=await Ks.getUsers();let W=[];Array.isArray(C)?W=C:Array.isArray(C?.data)?W=C.data:C?.users&&Array.isArray(C.users)?W=C.users:(console.warn(" Unexpected users response format:",C),W=[]);const Z=W.map(J=>({id:J.id,eid:J.eid,fullName:[J.lastName,J.middleName,J.firstName].filter(Boolean).join(" "),firstName:J.firstName,middleName:J.middleName,lastName:J.lastName,role:J.role?.name||"N/A",roleId:J.role?.id||"",department:J.department?.name||"N/A",status:J.status,email:J.email,phoneNumber:J.phoneNumber||"",address:J.address||"",certificationNumber:J.certificationNumber||"",specialization:J.specialization||"",yearsOfExperience:J.yearsOfExperience||"",bio:J.bio||"",dateOfBirth:J.dateOfBirth||"",trainingBatch:J.trainingBatch||"",passportNo:J.passportNo||"",nation:J.nation||"",createdAt:J.createdAt,lastLogin:J.lastLogin||""}));t(Z),j(null)}catch(C){const W=Xa(C,{});j(W)}finally{p(!1)}})()},[]);const E=[...new Set(e.map(P=>P.role).filter(Boolean))],N=[...new Set(e.map(P=>P.department).filter(Boolean))].filter((P,C,W)=>P&&P!=="N/A"&&W.indexOf(P)===C),T=e.filter(P=>{const C=!r||P.fullName.toLowerCase().includes(r.toLowerCase())||P.eid.toLowerCase().includes(r.toLowerCase())||P.email.toLowerCase().includes(r.toLowerCase()),W=n.length===0||n.includes(P.role),Z=l.length===0||l.includes(P.department);return C&&W&&Z}),k=P=>a(P),I=P=>{i(C=>C.includes(P)?C.filter(W=>W!==P):[...C,P])},D=P=>{o(C=>C.includes(P)?C.filter(W=>W!==P):[...C,P])},A=()=>{i([]),o([]),a("")},M=async P=>{try{p(!0);const C=await Ks.getUserById(P.id),W={id:C.id,eid:C.eid,fullName:[C.lastName,C.middleName,C.firstName].filter(Boolean).join(" "),firstName:C.firstName,middleName:C.middleName,lastName:C.lastName,role:C.role?.name||"N/A",roleId:C.role?.id||"",department:C.department?.name||"N/A",status:C.status,email:C.email,phoneNumber:C.phoneNumber||"",address:C.address||"",certificationNumber:C.trainerProfile?.certificationNumber||"",specialization:C.trainerProfile?.specialization||"",yearsOfExperience:C.trainerProfile?.yearsOfExp||"",bio:C.trainerProfile?.bio||"",dateOfBirth:C.traineeProfile?.dob?C.traineeProfile.dob.split("T")[0]:"",trainingBatch:C.traineeProfile?.trainingBatch||"",passportNo:C.traineeProfile?.passportNo||"",nation:C.traineeProfile?.nation||"",createdAt:C.createdAt,lastLogin:C.lastLogin||"",traineeProfile:C.traineeProfile||null,trainerProfile:C.trainerProfile||null};m(W),h("view"),u(!0)}catch{j("Unable to load user details")}finally{p(!1)}},G=async P=>{try{p(!0);const C=await Ks.getUserById(P.id),W={id:C.id,eid:C.eid,fullName:[C.lastName,C.middleName,C.firstName].filter(Boolean).join(" "),firstName:C.firstName,middleName:C.middleName,lastName:C.lastName,role:C.role?.name||"N/A",roleId:C.role?.id||"",department:C.department?.name||"N/A",status:C.status,email:C.email,phoneNumber:C.phoneNumber||"",address:C.address||"",certificationNumber:C.trainerProfile?.certificationNumber||"",specialization:C.trainerProfile?.specialization||"",yearsOfExperience:C.trainerProfile?.yearsOfExp||"",bio:C.trainerProfile?.bio||"",dateOfBirth:C.traineeProfile?.dob?C.traineeProfile.dob.split("T")[0]:"",trainingBatch:C.traineeProfile?.trainingBatch||"",passportNo:C.traineeProfile?.passportNo||"",nation:C.traineeProfile?.nation||"",createdAt:C.createdAt,lastLogin:C.lastLogin||"",traineeProfile:C.traineeProfile||null,trainerProfile:C.trainerProfile||null};m(W),h("edit"),u(!0)}catch{j("Unable to load user details")}finally{p(!1)}},q=()=>{m(null),h("add"),u(!0)},z=async P=>{try{p(!0);let C,W;P.status==="ACTIVE"?(C=await Ks.disableUser(P.id),W="disabled"):(C=await Ks.enableUser(P.id),W="enabled");const Z=await Ks.getUsers();let J=[];Array.isArray(Z)?J=Z:Array.isArray(Z?.data)?J=Z.data:Z?.users&&Array.isArray(Z.users)?J=Z.users:(console.warn(" Unexpected users response format:",Z),J=[]);const le=J.map(re=>({id:re.id,eid:re.eid,fullName:[re.lastName,re.middleName,re.firstName].filter(Boolean).join(" "),firstName:re.firstName,middleName:re.middleName,lastName:re.lastName,role:re.role?.name||"N/A",roleId:re.role?.id||"",department:re.department?.name||"N/A",status:re.status,email:re.email,phoneNumber:re.phoneNumber||"",address:re.address||"",certificationNumber:re.trainerProfile?.certificationNumber||"",specialization:re.trainerProfile?.specialization||"",yearsOfExperience:re.trainerProfile?.yearsOfExp||"",bio:re.trainerProfile?.bio||"",dateOfBirth:re.traineeProfile?.dob?re.traineeProfile.dob.split("T")[0]:"",trainingBatch:re.traineeProfile?.trainingBatch||"",passportNo:re.traineeProfile?.passportNo||"",nation:re.traineeProfile?.nation||"",createdAt:re.createdAt,lastLogin:re.lastLogin||""}));t(le);const V=C?.message||`User has been ${W} successfully!`;te.success(V)}catch(C){const W=Xa(C,{});j(W),te.error(W)}finally{p(!1)}},ee=async P=>{try{if(p(!0),f==="edit"&&d&&d.role!==P.role){S(P),y(!0),p(!1);return}await U(P)}catch{p(!1)}},U=async P=>{try{p(!0);let C=null;try{const V=await Es.getRoles();let re=[];if(Array.isArray(V)?re=V:V?.roles&&Array.isArray(V.roles)?re=V.roles:V?.data&&Array.isArray(V.data)&&(re=V.data),!re||re.length===0)throw new Error("No roles found in API response");const he=re.find(O=>O.name===P.role);if(he)C=he.id;else throw new Error(`Role '${P.role}' not found in backend`)}catch(V){throw new Error(`Failed to get role ID for '${P.role}': ${V.message}`)}const W={firstName:P.firstName,middleName:P.middleName||"",lastName:P.lastName,address:P.address||"",email:P.email,gender:"MALE",avatarUrl:"",phoneNumber:P.phoneNumber||"",role:{id:C,name:P.role}};P.role==="TRAINER"?W.trainerProfile={specialization:P.specialization||"",certificationNumber:P.certificationNumber||"",yearsOfExp:P.yearsOfExperience?parseInt(P.yearsOfExperience):0,bio:P.bio||""}:P.role==="TRAINEE"&&(P.dateOfBirth||P.trainingBatch||P.passportNo||P.nation)&&(W.traineeProfile={dob:P.dateOfBirth?new Date(P.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:P.trainingBatch||"",passportNo:P.passportNo||"",nation:P.nation||""}),f==="add"?(await Ks.createUser(W),te.success("User created successfully!")):f==="edit"&&(await Ks.updateUser(d.id,W),te.success("User updated successfully!")),u(!1);const Z=await Ks.getUsers();let J=[];if(Array.isArray(Z)?J=Z:Array.isArray(Z?.data)?J=Z.data:Z?.users&&Array.isArray(Z.users)?J=Z.users:(console.warn(" Unexpected users response format:",Z),J=[]),f==="edit"&&d?.id){const V=J.find(re=>re.id===d.id)}const le=J.map(V=>({id:V.id,eid:V.eid,fullName:[V.lastName,V.middleName,V.firstName].filter(Boolean).join(" "),firstName:V.firstName,middleName:V.middleName,lastName:V.lastName,role:V.role?.name||"N/A",roleId:V.role?.id||"",department:V.department?.name||"N/A",status:V.status,email:V.email,phoneNumber:V.phoneNumber||"",address:V.address||"",certificationNumber:V.trainerProfile?.certificationNumber||"",specialization:V.trainerProfile?.specialization||"",yearsOfExperience:V.trainerProfile?.yearsOfExp||"",bio:V.trainerProfile?.bio||"",dateOfBirth:V.traineeProfile?.dob?V.traineeProfile.dob.split("T")[0]:"",trainingBatch:V.traineeProfile?.trainingBatch||"",passportNo:V.traineeProfile?.passportNo||"",nation:V.traineeProfile?.nation||"",createdAt:V.createdAt,lastLogin:V.lastLogin||""}));t(le)}catch(C){const W=Xa(C,{});throw j(W),new Error(W)}finally{p(!1)}};return{users:T,searchTerm:r,selectedRoles:n,selectedDepartments:l,uniqueRoles:E,uniqueDepartments:N,modalShow:c,selectedUser:d,modalMode:f,loading:x,error:g,confirmRoleChange:w,pendingUserData:b,handleSearch:k,handleRoleToggle:I,handleDepartmentToggle:D,handleClearFilters:A,handleView:M,handleEdit:G,handleAdd:q,handleDisable:z,handleSave:ee,handleBulkImport:async P=>{try{p(!0);const C=await Ks.bulkImportUsers(P),W=C?.success??C?.data?.success??[],Z=C?.failed??C?.data?.failed??[],J=C?.summary??C?.data?.summary,le=C?.message||C?.data?.message;if(J){const{total:O,successful:ye,failed:de}=J;let je=le||"Bulk user creation completed";(ye>0||de>0)&&(je+=` (${ye} successful, ${de} failed out of ${O} total)`),de>0?(te.warning(je,{toastId:"bulk-import-summary",autoClose:6e3}),Z.forEach((xe,me)=>{const $e=xe?.error;$e&&setTimeout(()=>{te.error($e,{autoClose:6e3,toastId:`bulk-import-failed-${me}`})},me*200)})):ye>0&&te.success(je,{toastId:"bulk-import-success",autoClose:5e3})}else{if(W.length>0){const O=le||`Successfully imported ${W.length} users!`;te.success(O,{toastId:"bulk-import-success"})}Z.length>0&&Z.forEach((O,ye)=>{const de=O?.error;de&&setTimeout(()=>{te.error(de,{autoClose:6e3,toastId:`bulk-import-failed-${ye}`})},ye*200)})}const V=await Ks.getUsers({_t:new Date().getTime()});let re=[];Array.isArray(V)?re=V:Array.isArray(V?.data)?re=V.data:V?.users&&Array.isArray(V.users)?re=V.users:(console.warn(" Unexpected users response format:",V),re=[]),console.log(" [handleBulkImport] Users after import from backend:",{totalUsers:re.length,trainees:re.filter(O=>O.role?.name==="TRAINEE").map((O,ye)=>({index:ye,name:`${O.firstName} ${O.middleName||""} ${O.lastName}`.trim(),dob:O.traineeProfile?.dob,enrollmentDate:O.traineeProfile?.enrollmentDate,raw:O.traineeProfile}))});const he=re.map(O=>({id:O.id,eid:O.eid,fullName:[O.lastName,O.middleName,O.firstName].filter(Boolean).join(" "),firstName:O.firstName,middleName:O.middleName,lastName:O.lastName,role:O.role?.name||"N/A",roleId:O.role?.id||"",department:O.department?.name||"N/A",status:O.status,email:O.email,phoneNumber:O.phoneNumber||"",address:O.address||"",certificationNumber:O.trainerProfile?.certificationNumber||"",specialization:O.trainerProfile?.specialization||"",yearsOfExperience:O.trainerProfile?.yearsOfExp||"",bio:O.trainerProfile?.bio||"",dateOfBirth:O.traineeProfile?.dob?O.traineeProfile.dob.split("T")[0]:"",enrollmentDate:O.traineeProfile?.enrollmentDate?O.traineeProfile.enrollmentDate.split("T")[0]:"",trainingBatch:O.traineeProfile?.trainingBatch||"",passportNo:O.traineeProfile?.passportNo||"",nation:O.traineeProfile?.nation||"",createdAt:O.createdAt,lastLogin:O.lastLogin||""}));t(he)}catch(C){const W=Xa(C,{});j(W),te.error(W)}finally{p(!1)}},handleModalClose:()=>{u(!1),m(null)},handleConfirmRoleChange:async()=>{y(!1),b&&(await U(b),S(null))},handleCancelRoleChange:()=>{y(!1),S(null)},setError:j}},nH=()=>{const[e,t]=xi();ft();const[r,a]=v.useState(!1),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1);v.useEffect(()=>{if(e.get("action")==="bulk-import"){u(!0);const C=new URLSearchParams(e);C.delete("action"),t(C,{replace:!0})}},[e,t]);const{users:d,loading:m,error:f,searchTerm:h,selectedRoles:x,selectedDepartments:p,uniqueRoles:g,uniqueDepartments:j,modalShow:w,selectedUser:y,modalMode:b,confirmRoleChange:S,pendingUserData:E,handleSearch:N,handleRoleToggle:T,handleDepartmentToggle:k,handleClearFilters:I,handleView:D,handleEdit:A,handleAdd:M,handleDisable:G,handleSave:q,handleBulkImport:z,handleModalClose:ee,handleConfirmRoleChange:U,handleCancelRoleChange:X}=aH(),oe=P=>{i(P),a(!0)},Ee=async()=>{if(n){o(!0);try{await G(n),a(!1),i(null)}catch(P){console.error("Error disabling user:",P)}finally{o(!1)}}},F=()=>{a(!1),i(null)};return ne.useEffect(()=>{if(f){const P=C=>s.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:C});if(Array.isArray(f)){const C=f.join(`
`);te.error(P(C),{autoClose:6e3})}else typeof f=="string"&&f.includes(`
`)?te.error(P(f),{autoClose:6e3}):te.error(f)}},[f]),s.jsx(Be,{fluid:!0,className:"py-4 user-management-page",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ue,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(Nt,{permission:De.BULK_CREATE_USERS,fallback:null,children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>u(!0),className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-1",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),s.jsx("span",{className:"d-sm-none",children:"Import"})]})}),s.jsx(Nt,{permission:De.CREATE_USER,fallback:null,children:s.jsxs(ae,{variant:"primary-custom",size:"sm",onClick:M,className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-1",size:16}),"Add User"]})})]})})})}),s.jsxs(Y.Body,{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search users by name, EID, or email...",value:h,onChange:N,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(QW,{uniqueRoles:g,uniqueDepartments:j,selectedRoles:x,selectedDepartments:p,onRoleToggle:T,onDepartmentToggle:k,onClearFilters:I,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[d.length," user",d.length!==1?"s":""]})})})]}),s.jsxs("div",{className:"position-relative user-management-table-wrapper",children:[s.jsx(sH,{users:d,loading:m,onView:D,onEdit:A,onDisable:oe}),d.length>8&&s.jsxs("div",{className:"scroll-indicator",children:[s.jsx(sn,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),s.jsx(tH,{show:w,user:y,mode:b,onSave:q,onClose:ee}),s.jsx(JW,{show:c,onClose:()=>{if(u(!1),e.get("action")==="bulk-import"){const P=new URLSearchParams(e);P.delete("action"),t(P,{replace:!0})}},onImport:z,loading:m}),s.jsx(ZW,{show:r,user:n,onConfirm:Ee,onCancel:F,loading:l}),s.jsx(eH,{show:S,user:y,newRole:E?.role,onConfirm:U,onCancel:X,loading:m})]})]})})},iH=({show:e,role:t,onConfirm:r,onCancel:a,loading:n})=>{if(!t)return null;const i=t.status==="Active",l=i?"Disable":"Enable",c=i?oS:it;return s.jsxs(se,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(se.Header,{closeButton:!0,className:"text-white border-0",style:{backgroundColor:i?"var(--bs-secondary)":"#28a745",borderBottom:"none"},children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(c,{size:24,className:"me-2"}),l," Role: ",t.name]})}),s.jsxs(se.Body,{className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-secondary)":"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),s.jsx("div",{children:s.jsx("h6",{className:"mb-0",children:t.name})})]}),i?s.jsxs(Ue,{variant:"warning",className:"mb-3",style:{backgroundColor:"#f0e8e0",borderColor:"var(--bs-secondary)",color:"var(--bs-dark)"},children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",style:{color:"var(--bs-secondary)"}})," Warning: Disabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will disable the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will lose access to associated permissions."}),s.jsx("li",{children:"Role data will be preserved but access will be restricted."}),s.jsx("li",{children:"Role can be re-enabled later by an administrator."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):s.jsxs(Ue,{variant:"success",className:"mb-3",children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(it,{className:"me-2"})," Confirm: Enabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will restore the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will regain access to associated permissions."}),s.jsx("li",{children:"All role permissions and access will be restored."}),s.jsx("li",{children:"Role will be available for assignment to new users."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(ae,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:i?"secondary":"success",onClick:r,disabled:n,className:"d-flex align-items-center",style:i?{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#fff"}:{},children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{size:16,className:"me-2"}),l," Role"]})})]})]})]})},lH=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(Ct,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ll,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsx(Ct.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>s.jsx(_.Check,{type:"checkbox",id:`status-${l}`,label:l,checked:t.includes(l),onChange:()=>r(l),className:"mb-1"},l))})]})})]})},oH=["ADMINISTRATOR"],O1=e=>oH.includes(e?.toUpperCase()),cH=({show:e,role:t,mode:r,onSave:a,onClose:n})=>{const[i,l]=v.useState({name:"",description:"",permissionGroupCodes:[]}),[o,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState({}),{allPermissions:h,loading:x,error:p,fetchAllPermissions:g}=eR(),j=v.useMemo(()=>{if(!h||h.length===0)return[];const I={};return h.forEach(D=>{const A=D.module||D.viewModule,M=D.viewModule||D.module||"Other";I[A]||(I[A]={id:A,name:M,description:`Manage ${M.toLowerCase()} related permissions`,permissions:[]});const G=D.code||D.id;G&&I[A].permissions.push({id:G,code:D.code,title:D.viewName||D.name,description:D.description||"",isActive:D.isActive!==!1})}),Object.values(I).sort((D,A)=>D.name.localeCompare(A.name))},[h]),w=v.useMemo(()=>{const I=j;if(r==="view"&&t?.permissions){const D=t.permissions.map(A=>typeof A=="string"?A:A.id?A.id:A.code?A.code:A);return console.log(" View Mode - Assigned IDs:",D),I.map(A=>({...A,permissions:A.permissions.filter(M=>D.includes(M.id)||D.includes(M.code))})).filter(A=>A.permissions.length>0)}return I},[j,r,t?.permissions]);v.useEffect(()=>{if(t&&r!=="add"){const I=t.permissions?t.permissions.map(D=>typeof D=="string"?D:D.code||D.id||D):[];l({name:t.name||"",description:t.description||"",permissionGroupCodes:I})}else r==="add"&&l({name:"",description:"",permissionGroupCodes:[]});c({})},[t,r,e,h]),v.useEffect(()=>{e&&g()},[e,g]),v.useEffect(()=>{if(r==="view"){const I={};w.map(A=>A.id).forEach(A=>{I[A]=!0}),f(I)}else if(r==="edit"){const I={};w.map(A=>A.id).forEach(A=>{I[A]=!0}),f(I)}else f({})},[r,w]);const y=()=>{const I={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(I.name="Role name cannot contain special characters"):I.name="Role name is required",i.permissionGroupCodes.length===0&&(I.permissionGroupCodes="At least one permission is required"),c(I),Object.keys(I).length===0},b=async I=>{if(I.preventDefault(),!!y()){d(!0);try{await a(i)}catch(D){console.error("Error saving role:",D)}finally{d(!1)}}},S=(I,D)=>{l(A=>({...A,[I]:D})),o[I]&&c(A=>({...A,[I]:""}))},E=I=>{!I||I===null||I===void 0||(l(D=>{const A=D.permissionGroupCodes||[],M=A.some(G=>String(G)===String(I));return{...D,permissionGroupCodes:M?A.filter(G=>String(G)!==String(I)):[...A,I]}}),o.permissionGroupCodes&&c(D=>({...D,permissionGroupCodes:""})))},N=I=>{f(D=>({...D,[I]:!D[I]}))},T=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},k=r==="view";return s.jsxs(se,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(tg,{className:"me-2",size:20}),T()]})}),s.jsxs(_,{onSubmit:b,children:[s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&O1(t.name)&&r==="edit"&&s.jsxs(Ue,{variant:"warning",className:"mb-3",children:[s.jsx(Gt,{className:"me-2"}),s.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(o).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([I,D])=>s.jsx("li",{children:D},I))})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsx(_.Group,{className:"mb-3",children:s.jsxs(ue,{className:"align-items-center",children:[s.jsx(H,{md:2,children:s.jsx(_.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),s.jsxs(H,{md:4,children:[s.jsx(_.Control,{type:"text",size:"sm",value:i.name,onChange:I=>{const D=I.target.value;/^[a-zA-Z0-9\s_]*$/.test(D)&&S("name",D)},isInvalid:!!o.name,readOnly:k,style:{borderColor:o.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.name})]})]})})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsx(_.Group,{className:"mb-3",children:s.jsxs(ue,{className:"align-items-start",children:[s.jsx(H,{md:2,children:s.jsx(_.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),s.jsx(H,{md:4,children:s.jsx(_.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:I=>S("description",I.target.value),readOnly:k,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),s.jsx(ue,{children:s.jsx(H,{children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),o.permissionGroupCodes&&s.jsx("div",{className:"text-danger small mb-2",children:o.permissionGroupCodes}),p&&s.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",p.message||"Unknown error"]}),s.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"450px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:x?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):w.length>0?s.jsx(s.Fragment,{children:w.map(I=>{const D=m[I.id];return s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${k?"":"cursor-pointer"}`,onClick:()=>!k&&N(I.id),role:k?void 0:"button",tabIndex:k?void 0:0,onKeyDown:k?void 0:A=>{(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),N(I.id))},"aria-expanded":k?void 0:D,children:s.jsxs("div",{className:"d-flex align-items-center",children:[!k&&(D?s.jsx(sn,{className:"me-2",size:16}):s.jsx(Ac,{className:"me-2",size:16})),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:I.name}),s.jsx("small",{className:"text-muted",children:I.description})]})]})}),D&&I.permissions.length>0&&s.jsx("div",{className:"ms-3 mt-2",children:s.jsx(oa,{variant:"flush",children:I.permissions.map(A=>{const M=A.id;return M?s.jsx(oa.Item,{className:"border-0 px-0 py-2 permission-item",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"form-check me-3",children:s.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${M}`,checked:i.permissionGroupCodes.some(G=>String(G)===String(M)),onChange:G=>{G.stopPropagation(),!k&&M&&E(M)},onClick:G=>{G.stopPropagation()},disabled:k,style:{cursor:k?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-medium text-dark",children:A.title}),s.jsx("small",{className:"text-muted",children:A.description})]}),!k&&i.permissionGroupCodes.some(G=>String(G)===String(M))&&s.jsx(Ae,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${I.id}-${M}`):null})})})]},I.id)})}):s.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),s.jsx("div",{className:"mt-2",children:s.jsxs("small",{className:"text-muted",children:[i.permissionGroupCodes.length," of ",w.reduce((I,D)=>I+D.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&s.jsx(ue,{children:s.jsx(H,{children:s.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Assigned Users:"}),s.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Total Permissions:"}),s.jsx("div",{className:"fw-medium",children:i.permissionGroupCodes.length})]})]})]})})})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:n,disabled:u,children:[s.jsx(ht,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(ae,{variant:"primary-custom",type:"submit",disabled:u||t&&O1(t.name),children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},dH=({roles:e,loading:t,actionsComponent:r,onView:a,onEdit:n,onDisable:i})=>{const{sortedData:l,sortConfig:o,handleSort:c}=ts(e);if(t)return s.jsx(Fr,{rows:4,columns:4});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No roles found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=o.key===d,x=h?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:x,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(u,{columnKey:"name",className:"show-mobile",children:"Role Name"}),s.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(u,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),s.jsx(u,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:l.map((d,m)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:d.name}),s.jsx("td",{className:"show-mobile",children:s.jsxs(Ae,{bg:d.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:d.status==="Active"?"":""}),d.status?.replace(/_/g," ")]})}),s.jsx("td",{className:"show-mobile",children:d.assignedUsers}),s.jsx("td",{className:"show-mobile",children:d.lastModified}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{role:d})})]},d.id))})]})})},R1=e=>{if(!e||!Array.isArray(e))return[];const t=[];return e.forEach(r=>{r.permissions&&Array.isArray(r.permissions)&&r.permissions.forEach(a=>{t.push({code:a.code,name:a.name,id:a.code})})}),t},To=e=>e===!0||e==="ACTIVE",uH=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("view"),[f,h]=v.useState(!1),[x,p]=v.useState(null);v.useEffect(()=>{(async()=>{h(!0);try{const A=await Es.getRoles({includeDeleted:!0}),G=(Array.isArray(A)?A:A?.roles||[]).map(q=>({id:q.id,name:q.name,description:q.description||"",assignedUsers:q.userCount||0,status:To(q.isActive)?"Active":"Inactive",createdAt:q.createdAt?q.createdAt.split("T")[0]:"",lastModified:q.updatedAt?q.updatedAt.split("T")[0]:"",isActive:q.isActive,permissions:q.permissions||[],originalData:q}));t(G),p(null)}catch(A){const M=Xa(A,{});p(M),console.error("Error fetching roles:",A)}finally{h(!1)}})()},[]);const g=D=>a(D),j=D=>{i(D==="clear"?[]:A=>A.includes(D)?A.filter(M=>M!==D):[...A,D])},w=()=>{i([])},y=async D=>{try{h(!0);const A=await Es.getRoleById(D.id),M=R1(A.permissionGroups),G={...A,permissions:M};u(G),m("view"),o(!0)}catch(A){const M=Xa(A,{});p(M),console.error("Error fetching role details:",A)}finally{h(!1)}},b=async D=>{try{h(!0);const A=await Es.getRoleById(D.id),M=R1(A.permissionGroups),G={id:A.id,name:A.name,description:A.description||"",assignedUsers:A.userCount||0,status:To(A.isActive)?"Active":"Inactive",createdAt:A.createdAt?A.createdAt.split("T")[0]:"",lastModified:A.updatedAt?A.updatedAt.split("T")[0]:"",isActive:A.isActive,permissions:M,originalData:A};u(G),m("edit"),o(!0),p(null)}catch(A){const M=Xa(A,{});p(M)}finally{h(!1)}},S=()=>{u(null),m("add"),o(!0)},E=async D=>{if(window.confirm("Are you sure you want to delete this role?")){h(!0);try{await new Promise(A=>setTimeout(A,1e3)),t(A=>A.filter(M=>M.id!==D)),p(null)}catch{p("Failed to delete role")}finally{h(!1)}}},N=async D=>{h(!0);try{d==="add"?(await Es.createRole(D),te.success("Role created successfully!")):(await Es.updateRole(c.id,D),te.success("Role updated successfully!"));const A=await Es.getRoles({includeDeleted:!0}),G=(Array.isArray(A)?A:A?.roles||[]).map(q=>({id:q.id,name:q.name,description:q.description||"",assignedUsers:q.userCount||0,status:To(q.isActive)?"Active":"Inactive",createdAt:q.createdAt?q.createdAt.split("T")[0]:"",lastModified:q.updatedAt?q.updatedAt.split("T")[0]:"",isActive:q.isActive,originalData:q}));t(G),o(!1),u(null),p(null)}catch(A){const M=Xa(A,{});p(M),te.error(M)}finally{h(!1)}},T=async D=>{h(!0);try{const A=e.find(oe=>oe.id===D);if(!A)throw new Error("Role not found");let M,G;To(A.isActive)?(M=await Es.disableRole(D),G="disabled"):(M=await Es.enableRole(D),G="enabled");const z=await Es.getRoles({includeDeleted:!0}),U=(Array.isArray(z)?z:z?.roles||[]).map(oe=>({id:oe.id,name:oe.name,description:oe.description||"",assignedUsers:oe.userCount||0,status:To(oe.isActive)?"Active":"Inactive",createdAt:oe.createdAt?oe.createdAt.split("T")[0]:"",lastModified:oe.updatedAt?oe.updatedAt.split("T")[0]:"",isActive:oe.isActive,originalData:oe}));t(U);const X=M?.message||`Role has been ${G} successfully!`;te.success(X),p(null)}catch(A){const M=Xa(A,{});p(M)}finally{h(!1)}},k=[...new Set(e.map(D=>D.status))];return{roles:e.filter(D=>{const A=D.name.toLowerCase().includes(r.toLowerCase()),M=n.length===0||n.includes(D.status);return A&&M}),loading:f,error:x,searchTerm:r,selectedStatuses:n,uniqueStatuses:k,modalShow:l,selectedRole:c,modalMode:d,handleSearch:g,handleStatusToggle:j,handleClearFilters:w,handleView:y,handleEdit:b,handleAdd:S,handleDelete:E,handleSave:N,handleDisable:T,handleModalClose:()=>o(!1),setError:p}},mH=()=>{const[e,t]=v.useState(!1),[r,a]=v.useState(null),[n,i]=v.useState(!1),{roles:l,loading:o,error:c,searchTerm:u,selectedStatuses:d,uniqueStatuses:m,modalShow:f,selectedRole:h,modalMode:x,handleSearch:p,handleStatusToggle:g,handleClearFilters:j,handleView:w,handleEdit:y,handleAdd:b,handleSave:S,handleDisable:E,handleModalClose:N}=uH(),T=A=>{a(A),t(!0)},k=async()=>{if(r){i(!0);try{await E(r.id),t(!1),a(null)}catch(A){console.error("Error disabling role:",A)}finally{i(!1)}}},I=()=>{t(!1),a(null)},D=({role:A})=>s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>w(A),permission:De.VIEW_ROLE_IN_DETAIL},{label:"Edit Role",icon:s.jsx(Ar,{}),onClick:()=>y(A),permission:De.UPDATE_ROLE},...A.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:A.status==="Active"?"Disable Role":"Enable Role",icon:s.jsx(kc,{}),className:A.status==="Active"?"text-warning":"text-success",onClick:()=>T(A),permission:De.DISABLE_ROLE}]:[]]});return ne.useEffect(()=>{c&&te.error(c)},[c]),s.jsx(Be,{fluid:!0,className:"py-4 role-management-page",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ue,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Nt,{permission:De.CREATE_ROLE,fallback:null,children:s.jsxs(ae,{variant:"primary-custom",size:"sm",onClick:b,className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-1",size:16}),"Add Role"]})})})})})}),s.jsxs(Y.Body,{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search roles by name...",value:u,onChange:p,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(lH,{uniqueStatuses:m,selectedStatuses:d,onStatusToggle:g,onClearFilters:j,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[l.length," role",l.length!==1?"s":""]})})})]}),s.jsx(dH,{roles:l,loading:o,actionsComponent:D,onView:w,onEdit:y,onDisable:E}),s.jsx(cH,{show:f,role:h,mode:x,onSave:S,onClose:N}),s.jsx(iH,{show:e,role:r,onConfirm:k,onCancel:I,loading:n})]})]})})},fH=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const a=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return s.jsxs(se,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[s.jsx(se.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ws,{className:"me-2",size:20}),"Department Details"]})}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ue,{className:"mb-4",children:[s.jsxs(H,{md:8,children:[s.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),s.jsx("p",{className:"text-muted mb-3",children:t.description})]}),s.jsx(H,{md:4,className:"text-end",children:s.jsx(Ae,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status?.replace(/_/g," ")})})]}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ae,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ae,{bg:a(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),s.jsx(ue,{className:"mb-4",children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),s.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(On,{className:"me-3 text-primary",size:24}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),s.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):s.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),s.jsx(ue,{className:"mb-4",children:s.jsxs(H,{md:12,children:[s.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),s.jsxs(ue,{children:[s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[s.jsx($t,{className:"text-primary mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),s.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[s.jsx(Vs,{className:"text-success mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),s.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[s.jsx(On,{className:"text-info mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),s.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),s.jsx(se.Footer,{className:"border-0 p-4",children:s.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[s.jsx(ht,{className:"me-2",size:16}),"Close"]})})]})},hH=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:a,onTypeToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0;return s.jsxs(Ct,{className:`filter-panel-dropdown ${o}`,children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ll,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(Ct.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Code"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>s.jsx(_.Check,{type:"checkbox",id:`type-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>s.jsx(_.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:a.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]})]})]})},pH=({show:e,department:t,mode:r,onSave:a,onClose:n,availableUsers:i,loadingUsers:l,usersError:o})=>{const[c,u]=v.useState({name:"",code:"",description:"",departmentHeadId:""}),[d,m]=v.useState({}),[f,h]=v.useState(!1);v.useEffect(()=>{t&&r!=="add"?u({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&u({name:"",code:"",description:"",departmentHeadId:""}),m({})},[t,r,e]);const x=()=>{const y={};return c.name.trim()?c.name.trim().length<3?y.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(c.name.trim())||(y.name="Department name cannot contain special characters"):y.name="Department name is required",c.code.trim()||(y.code="Department code is required"),c.departmentHeadId||(y.departmentHeadId="Department head is required"),m(y),Object.keys(y).length===0},p=async y=>{if(y.preventDefault(),!!x()){h(!0);try{const b={name:c.name.trim(),code:c.code.trim(),description:c.description.trim(),headUserId:c.departmentHeadId};console.log(" Department data being sent:",b),await a(b)}catch(b){console.error("Error saving department:",b)}finally{h(!1)}}},g=(y,b)=>{u(S=>({...S,[y]:b})),d[y]&&m(S=>({...S,[y]:""}))},j=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},w=r==="view";return s.jsxs(se,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(se.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(Zr,{className:"me-2",size:20}),j()]})}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(d).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(d).map(([y,b])=>s.jsx("li",{children:b},y))})]}),s.jsxs(ue,{children:[s.jsx(H,{md:8,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),s.jsx(_.Control,{type:"text",value:c.name,onChange:y=>g("name",y.target.value),isInvalid:!!d.name,readOnly:w,placeholder:"Enter department name",style:{borderColor:d.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:d.name})]})}),s.jsx(H,{md:4,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),s.jsx(_.Control,{type:"text",value:c.code,onChange:y=>g("code",y.target.value.toUpperCase()),isInvalid:!!d.code,readOnly:w,placeholder:"e.g., CCT",style:{borderColor:d.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(_.Control.Feedback,{type:"invalid",children:d.code})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),o&&s.jsx(Ue,{variant:"warning",className:"mb-2",children:s.jsxs("small",{children:[" ",o]})}),s.jsxs(_.Select,{value:c.departmentHeadId,onChange:y=>g("departmentHeadId",y.target.value),isInvalid:!!d.departmentHeadId,disabled:w||l||i.length===0,style:{borderColor:d.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[l?s.jsx("option",{value:"",children:"Loading department heads..."}):i.length===0?s.jsx("option",{value:"",children:"No department heads available"}):c.departmentHeadId&&i.find(y=>y.id===c.departmentHeadId)?s.jsx("option",{value:c.departmentHeadId,children:(()=>{const y=i.find(b=>b.id===c.departmentHeadId);return`${y.lastName}${y.middleName?" "+y.middleName:""} ${y.firstName}`})()}):s.jsx("option",{value:"",children:"Select department head"}),!l&&i.map(y=>s.jsxs("option",{value:y.id,children:[y.lastName,y.middleName?" "+y.middleName:""," ",y.firstName," (",y.eid,")"]},y.id))]}),s.jsx(_.Control.Feedback,{type:"invalid",children:d.departmentHeadId})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),s.jsx(_.Control,{as:"textarea",rows:4,value:c.description,onChange:y=>g("description",y.target.value),readOnly:w,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),s.jsx(_.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),s.jsx(_.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),s.jsx(_.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),s.jsx(_.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:n,disabled:f,children:[s.jsx(ht,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(ae,{variant:"primary-custom",type:"submit",disabled:f,children:f?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},xH=({department:e,index:t,onView:r,onToggleStatus:a})=>{const n=l=>l==="ACTIVE"?"success":"secondary",i=l=>l==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.departmentHead?(()=>{const{lastName:l,middleName:o,firstName:c}=e.departmentHead;return[l,o,c].filter(Boolean).join(" ")||e.departmentHead.name||"Not assigned"})():"Not assigned"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.coursesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.traineesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.trainersCount})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(Ae,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status?.replace(/_/g," ")]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Nt,{permissions:[De.VIEW_DEPARTMENT_IN_DETAIL,De.UPDATE_DEPARTMENT],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r(e),permission:De.VIEW_DEPARTMENT_IN_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:s.jsx(kc,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>a(e),permission:De.UPDATE_DEPARTMENT}]})})})]})},gH=({departments:e,loading:t,onView:r,onToggleStatus:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=ts(e);if(t)return s.jsx(Fr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No departments found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const o=({columnKey:c,children:u,className:d=""})=>{const m=i.key===c,f=m?i.direction:null;return s.jsxs("th",{className:`fw-semibold ${d}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(c),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500",color:"white"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:f,size:14,color:"white"})})]}),m&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"name",className:"show-mobile",children:"Department Name"}),s.jsx(o,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(o,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),s.jsx(o,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),s.jsx(o,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),s.jsx(o,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),s.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((c,u)=>s.jsx(xH,{department:c,index:u,onView:r,onToggleStatus:a},c.id))})]})})},vH=({show:e,department:t,onConfirm:r,onCancel:a,isProcessing:n})=>{const[i,l]=v.useState({courseCount:0,traineeCount:0,trainerCount:0}),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(null);v.useEffect(()=>{e&&t?.id&&h()},[e,t?.id]);const h=async()=>{if(t?.id){c(!0);try{const w=await Ht.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Full API response:",w),console.log(" DisableDepartmentModal - Department Head data:",w.departmentHead||w.headUser),d(w);const y=w.departmentHead||w.headUser;if(y&&y.id&&!y.eid)try{const b=await Ks.getUserById(y.id);console.log(" DisableDepartmentModal - Head User detail from API:",b),f(b)}catch(b){console.warn(" Could not fetch headUser detail:",b)}l({courseCount:w.courseCount||w.coursesCount||0,traineeCount:w.traineeCount||w.traineesCount||0,trainerCount:w.trainerCount||w.trainersCount||0})}catch(w){console.error("Error fetching department statistics:",w),d(null),f(null),l({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const x=t.status==="ACTIVE",p=x?"deactivate":"activate",g=x?"Deactivate":"Activate",j=!x||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return s.jsxs(se,{show:e,onHide:a,centered:!0,children:[s.jsx(se.Header,{className:"border-0 pb-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2 text-warning",size:20}),g," Department"]})}),s.jsxs(se.Body,{className:"pt-0",children:[s.jsx(Ue,{variant:x?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:s.jsx("div",{className:"d-flex align-items-start",children:s.jsxs("div",{children:[s.jsxs("strong",{children:["Are you sure you want to ",p," this department?"]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),x&&s.jsx("div",{className:"mt-2",children:j?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Warning:"})," Deactivating this department will:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"Make it unavailable for new course assignments"}),s.jsx("li",{children:"Hide it from department selection dropdowns"}),s.jsx("li",{children:"Not affect existing courses and users"})]})]}):s.jsxs("div",{className:"text-danger",children:[s.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!x&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"New course assignments"}),s.jsx("li",{children:"Department selection in forms"}),s.jsx("li",{children:"User management operations"})]})]})]})})}),s.jsxs("div",{className:"bg-light p-4 rounded",children:[s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Department Head:"}),s.jsx("span",{className:"text-muted text-break",children:(()=>{const w=u||t;let y=w.departmentHead||w.headUser;if(y&&m&&(y={...y,...m}),y){console.log(" Department Head object:",y);let b="";if(y.name)b=y.name;else if(y.firstName||y.lastName){const E=[];y.firstName&&E.push(y.firstName),y.middleName&&E.push(y.middleName),y.lastName&&E.push(y.lastName),b=E.join(" ").trim()}else y.fullName&&(b=y.fullName);const S=m?.eid||m?.employeeId||y.eid||y.employeeId||"";if(console.log(" Name:",b,"EID:",S||"NOT FOUND"),b&&S)return`${b} [${S}]`;if(b)return b;if(S)return`[${S}]`;if(y.email)return console.warn(" No name or EID found in headUser object, showing email as fallback"),console.warn(" headUser object keys:",Object.keys(y)),y.email}return"N/A"})()})]})}),s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Current Status:"}),s.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status?.replace(/_/g," ")})]})})]}),s.jsx("hr",{className:"my-3"}),s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(ot,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),s.jsx("small",{className:"text-muted",children:"Courses"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(ot,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),s.jsx("small",{className:"text-muted",children:"Trainees"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(ot,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),s.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:a,disabled:n,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:x?"warning":"success",onClick:r,disabled:n||x&&!j,style:{backgroundColor:x?"#ffc107":"#28a745",borderColor:x?"#ffc107":"#28a745",opacity:x&&!j?.5:1},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gt,{className:"me-2",size:16}),x&&!j?"Cannot Deactivate":`${g} Department`]})})]})]})},yH=()=>{const e=ft(),{hasPermission:t}=ln(),r=t(De.VIEW_ALL_DEPARTMENTS),{loading:a,searchTerm:n,setSearchTerm:i,createDepartment:l,updateDepartment:o,disableDepartment:c,enableDepartment:u,getAvailableUsers:d}=lg(r),[m,f]=v.useState(!1),[h,x]=v.useState(!1),[p,g]=v.useState(!1),[j,w]=v.useState("add"),[y,b]=v.useState(null),[S,E]=v.useState([]),[N,T]=v.useState(!0),[k,I]=v.useState([]),[D,A]=v.useState([]),[M,G]=v.useState([]),[q,z]=v.useState(!1),[ee,U]=v.useState(null),X=v.useCallback(async()=>{try{T(!0);let je;if(r)je=await Ht.getDepartments();else{const me=await Ht.getMyDepartment();je=me?[me]:[]}const xe=je.map(me=>({id:me.id,name:me.name,code:me.code,type:me.code,description:me.description,departmentHeadId:me.headUserId,departmentHead:me.headUser?{id:me.headUser.id,name:me.headUser.name||me.headUser.email,email:me.headUser.email,role:me.headUser.role,lastName:me.headUser.lastName,middleName:me.headUser.middleName,firstName:me.headUser.firstName}:null,status:me.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:me.courseCount||me.coursesCount||0,traineesCount:me.traineeCount||me.traineesCount||0,trainersCount:me.trainerCount||me.trainersCount||0,createdAt:me.createdAt,updatedAt:me.updatedAt,deletedAt:me.deletedAt,courses:me.courses||[]}));E(xe)}catch(je){console.error("Error loading departments:",je),te.error("Failed to load departments"),E([])}finally{T(!1)}},[r]);v.useEffect(()=>{X()},[X]),v.useEffect(()=>{(async()=>{try{z(!0),U(null),console.log(" Loading available department heads...");const xe=await d();console.log(" Department heads loaded:",xe),console.log(" Users type:",typeof xe,"Is array:",Array.isArray(xe),"Length:",xe?.length),Array.isArray(xe)&&xe.length>0?G(xe):(console.warn(" No department heads available or empty array"),U("No department heads available"),G([]))}catch(xe){console.error(" Error loading available users:",xe),U(xe?.message||"Failed to load department heads"),G([])}finally{z(!1)}})()},[d]);const oe=()=>{b(null),w("add"),f(!0),(async()=>{try{console.log(" Reloading department heads for modal...");const xe=await d();Array.isArray(xe)&&xe.length>0?(G(xe),U(null)):U("No department heads available")}catch(xe){console.error("Error reloading department heads:",xe),U(xe?.message||"Failed to reload department heads")}})()},Ee=je=>{e(Pe.DEPARTMENTS_DETAIL(je.id))},F=je=>{b(je),x(!0)},P=()=>{f(!1),b(null),w("add")},C=()=>{x(!1),b(null)},W=()=>{g(!1),b(null)},Z=async je=>{try{j==="add"?(await l(je),te.success("Department created successfully")):j==="edit"&&(await o(y.id,je),te.success("Department updated successfully")),P(),await X()}catch(xe){console.error("Error saving department:",xe);const me=xe?.response?.data;let $e=xe?.message||"Failed to save department";if(me?.message&&(Array.isArray(me.message)?$e=me.message.map(Xe=>Xe.message||Xe).join(", "):$e=me.message),me?.errors&&Array.isArray(me.errors)){const Xe=me.errors.map(ge=>ge.message||JSON.stringify(ge)).filter(Boolean).join(", ");Xe&&($e=Xe)}te.error($e)}},J=async()=>{try{y&&(y.status==="ACTIVE"?(await c(y.id),te.success("Department disabled successfully")):(await u(y.id),te.success("Department enabled successfully")),C(),await X())}catch(je){console.error("Error toggling department status:",je),te.error("Failed to toggle department status")}},le=je=>{i(je)},V=je=>{I(je==="clear"?[]:xe=>xe.includes(je)?xe.filter(me=>me!==je):[...xe,je])},re=je=>{A(je==="clear"?[]:xe=>xe.includes(je)?xe.filter(me=>me!==je):[...xe,je])},he=()=>{I([]),A([])},O=[...new Set(S.map(je=>je.type).filter(Boolean))],ye=["ACTIVE","INACTIVE"],de=S.filter(je=>{const xe=k.length===0||k.includes(je.type),me=D.length===0||D.includes(je.status),$e=!n||je.name.toLowerCase().includes(n.toLowerCase())||je.code.toLowerCase().includes(n.toLowerCase())||je.description.toLowerCase().includes(n.toLowerCase());return xe&&me&&$e});return s.jsxs(Be,{fluid:!0,className:"py-4 department-management-page",children:[s.jsxs(Y,{className:"shadow-sm",children:[s.jsx(Y.Header,{className:"bg-white border-0 pb-0",children:s.jsx(ue,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Nt,{permission:De.CREATE_DEPARTMENT,fallback:null,children:s.jsxs(ae,{variant:"primary-custom",size:"sm",onClick:oe,className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-1",size:16}),"Add Department"]})})})})})}),s.jsxs(Y.Body,{children:[s.jsxs(ue,{className:"mb-4 form-mobile-stack",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search departments by name, code, or description...",value:n,onChange:le,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(hH,{uniqueTypes:O,uniqueStatuses:ye,selectedTypes:k,selectedStatuses:D,onTypeToggle:V,onStatusToggle:re,onClearFilters:he,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[de.length," department",de.length!==1?"s":""]})})})]}),s.jsx("div",{className:"position-relative mt-3",children:s.jsx(gH,{departments:de,loading:N||a,onView:Ee,onToggleStatus:F})})]})]}),m&&s.jsx(pH,{show:m,department:y,mode:j,onSave:Z,onClose:P,availableUsers:M,loadingUsers:q,usersError:ee}),h&&y&&s.jsx(vH,{show:h,department:y,onConfirm:J,onCancel:C,isProcessing:a}),p&&y&&s.jsx(fH,{show:p,department:y,onClose:W})]})},bH=({department:e,onBack:t})=>s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx(ae,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:s.jsx(Bt,{})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:e.name}),s.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),jH=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:eS,description:"View department overview"},{id:"edit",label:"Edit Details",icon:Ar,description:"Modify department information"}];return s.jsxs("div",{className:"department-tabs",children:[s.jsx("div",{className:"tab-navigation",children:r.map(a=>{const n=a.icon,i=e===a.id;return s.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(a.id),children:[s.jsx("div",{className:"tab-icon",children:s.jsx(n,{size:20})}),s.jsxs("div",{className:"tab-content",children:[s.jsx("div",{className:"tab-label",children:a.label}),s.jsx("div",{className:"tab-description",children:a.description})]}),i&&s.jsx("div",{className:"tab-indicator"})]},a.id)})}),s.jsx("div",{className:"tab-separator"})]})},wH=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),NH=({department:e,onUpdate:t})=>{const[r,a]=v.useState({name:e.name||"",code:e.code||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=v.useState({name:e.name||"",code:e.code||"",description:e.description||"",headUserId:e.headUserId||""}),[l,o]=v.useState(!1),[c,u]=v.useState([]),[d,m]=v.useState(!1),f=JSON.stringify(r)!==JSON.stringify(n),h=async()=>{try{m(!0);const g=await Ht.getDepartmentHeads(),j=g?.users||g?.data?.users||[];u(j)}catch(g){console.error("Error loading department heads:",g),te.error("Failed to load department heads"),u([])}finally{m(!1)}};v.useEffect(()=>{h()},[]),v.useEffect(()=>{const g={name:e.name||"",code:e.code||"",description:e.description||"",headUserId:e.headUserId||""};a(g),i(g)},[e]);const x=g=>{const{name:j,value:w}=g.target;a(y=>({...y,[j]:w}))},p=async g=>{g.preventDefault(),o(!0);try{if(!r.name||r.name.trim()===""){te.error("Department name is required"),o(!1);return}if(!r.code||r.code.trim()===""){te.error("Department code is required"),o(!1);return}console.log(" Submitting department update:",{departmentId:e.id,formData:r});const j=await Ht.updateDepartment(e.id,r),w=await Ht.getDepartmentById(e.id),y=wH(w);t(y),te.success("Department updated successfully!")}catch(j){console.error(" Error updating department:",j);let w="Failed to update department";j.code==="NETWORK_ERROR"?w="Network error: Unable to connect to server. Please check your connection.":j.code==="BAD_GATEWAY"?w="Server error (502): The server is temporarily unavailable. Please try again later.":j.code==="PERMISSION_DENIED"?w="Permission denied: You do not have permission to update this department.":j.response?.data?.message?w=j.response.data.message:j.message&&(w=j.message),te.error(w)}finally{o(!1)}};return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),s.jsxs("form",{onSubmit:p,children:[s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),s.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:x,required:!0})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"code",className:"form-label",children:"Department Code"}),s.jsx("input",{type:"text",className:"form-control",id:"code",name:"code",value:r.code,onChange:x,placeholder:"e.g., CCT",required:!0})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),s.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:x,onFocus:h,children:[!r.headUserId&&s.jsx("option",{value:"",children:"Select Department Head"}),r.headUserId&&e?.headUser&&s.jsxs("option",{value:r.headUserId,selected:!0,children:["[",e.headUser.eid,"] - ",e.headUser.lastName,e.headUser.middleName?" "+e.headUser.middleName:""," ",e.headUser.firstName]}),Array.isArray(c)&&c.map(g=>{const j=`[${g.eid}] - ${g.lastName}${g.middleName?" "+g.middleName:""} ${g.firstName}`;return s.jsx("option",{value:g.id,children:j},g.id)})]})]})})}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),s.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:x})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(ae,{type:"submit",variant:"primary",disabled:l||!f,children:l?"Updating...":"Update Department"})})]})]})},F1=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return s.jsxs("div",{className:"department-info",children:[s.jsx("h4",{className:"mb-4",children:"Department Overview"}),s.jsxs(ue,{className:"g-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-basic",children:[s.jsxs("div",{className:"info-header",children:[s.jsx($t,{className:"info-icon"}),s.jsx("h6",{children:"Basic Information"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Name:"}),s.jsx("span",{className:"info-value",children:e.name})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Code:"}),s.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Description:"}),s.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-statistics",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(Vs,{className:"info-icon"}),s.jsx("h6",{children:"Department Statistics"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Courses:"}),s.jsx("span",{className:"info-value",children:e.courseCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainees:"}),s.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainers:"}),s.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Head of Department:"}),s.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.lastName}${e.headUser.middleName?" "+e.headUser.middleName:""} ${e.headUser.firstName}`.trim():"Not assigned"})]})]})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-timeline",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(or,{className:"info-icon"}),s.jsx("h6",{children:"Timeline"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Created:"}),s.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Last Updated:"}),s.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Deleted:"}),s.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},SH=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),EH=()=>{const{id:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("info"),d=v.useCallback(async()=>{if(!e){te.error("Department ID is required"),i(!1);return}i(!0),o(null);try{const x=await Ht.getDepartmentById(e),p=SH(x);a(p)}catch(x){console.error("Error loading department:",x),te.error("Failed to load department details"),o("Failed to load department details")}finally{i(!1)}},[e]);v.useEffect(()=>{d()},[d]);const m=()=>{t(Pe.DEPARTMENTS)},f=x=>{u(x)};if(n)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:s.jsx(ot,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(l)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-danger mb-3",children:[s.jsx("h5",{children:"Unable to load department"}),s.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),s.jsxs(ae,{variant:"outline-primary",onClick:m,children:[s.jsx(Bt,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-warning mb-3",children:[s.jsx("h5",{children:"Department not found"}),s.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),s.jsxs(ae,{variant:"outline-primary",onClick:m,children:[s.jsx(Bt,{className:"me-2"}),"Back to Departments"]})]})});const h=()=>{switch(c){case"info":return s.jsx(F1,{department:r});case"edit":return s.jsx(NH,{department:r,onUpdate:a});default:return s.jsx(F1,{department:r})}};return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(bH,{department:r,onBack:m}),s.jsx(jH,{activeTab:c,onTabChange:f}),s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Y,{className:"shadow-sm",children:s.jsx(Y.Body,{className:"p-4",children:h()})})})})]})},TH=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState(""),x=j=>{const{name:w,value:y}=j.target;i(b=>({...b,[w]:y})),f&&h("")},p=async j=>{if(j.preventDefault(),h(""),n.newPassword!==n.confirmPassword){h("New password and confirm password do not match.");return}if(n.newPassword.length<6){h("New password must be at least 6 characters long.");return}try{await r(n),i({oldPassword:"",newPassword:"",confirmPassword:""}),t()}catch(w){throw w}},g=()=>{i({oldPassword:"",newPassword:"",confirmPassword:""}),h(""),t()};return s.jsxs(se,{show:e,onHide:g,size:"md",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary text-white",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(tc,{className:"me-2",size:20}),"Change Password"]}),s.jsx(ae,{variant:"link",className:"text-white p-0",onClick:g,style:{textDecoration:"none"},children:s.jsx(ht,{size:20})})]}),s.jsxs(se.Body,{className:"p-4",children:[f&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:f}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"fw-semibold",children:"Current Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:l?"text":"password",name:"oldPassword",value:n.oldPassword,onChange:x,required:!0,placeholder:"Enter current password"}),s.jsx(ae,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>o(!l),type:"button",children:l?s.jsx(Rl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"fw-semibold",children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:c?"text":"password",name:"newPassword",value:n.newPassword,onChange:x,required:!0,minLength:6,placeholder:"Enter new password"}),s.jsx(ae,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>u(!c),type:"button",children:c?s.jsx(Rl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs(_.Group,{className:"mb-4",children:[s.jsx(_.Label,{className:"fw-semibold",children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(_.Control,{type:d?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:x,required:!0,minLength:6,placeholder:"Confirm new password"}),s.jsx(ae,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>m(!d),type:"button",children:d?s.jsx(Rl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(ae,{variant:"outline-secondary",onClick:g,disabled:a,children:"Cancel"}),s.jsx(ae,{type:"submit",variant:"secondary",disabled:a,children:a?"Updating...":s.jsxs(s.Fragment,{children:[s.jsx(tc,{size:16,className:"me-1"}),"Change Password"]})})]})]})]})]})},CH=({profileData:e,user:t,onResetPassword:r,onAvatarSelected:a,onConfigureSignature:n,onSaveChanges:i,loading:l,hasAvatarSelected:o=!1})=>{const c=v.useRef(null),[u,d]=v.useState(!1),[m,f]=v.useState(null),h=S=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",ACADEMIC_DEPARTMENT:"warning",SQA_AUDITOR:"secondary"})[S]||"secondary",x=()=>e&&[e.lastName,e.middleName,e.firstName].filter(Boolean).join(" ")||"User Name",p=()=>e?.email||t?.email||"user@example.com",g=()=>{const S=e?.role?.name||t?.role||"USER";return S==="ACADEMIC_DEPARTMENT"||S==="ACADEMIC_DEPT"?"ACADEMIC_DEPT":S},j=m||e?.avatarUrl||"",w=()=>{c.current&&c.current.click()},y=(S,E=200,N=200,T=.8)=>new Promise(k=>{const I=document.createElement("canvas"),D=I.getContext("2d"),A=new window.Image;A.onload=()=>{let{width:M,height:G}=A;M>G?M>E&&(G=G*E/M,M=E):G>N&&(M=M*N/G,G=N),I.width=M,I.height=G,D.drawImage(A,0,0,M,G);const q=I.toDataURL("image/jpeg",T);k(q)},A.src=URL.createObjectURL(S)}),b=async S=>{const E=S.target.files&&S.target.files[0];if(E){if(E.size>5*1024*1024){te.error("File size too large. Please choose an image smaller than 5MB.");return}try{const N=await y(E,200,200,.7);f(N),a&&a(E)}catch(N){console.error("Preview avatar failed:",N),f(null)}}};return s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[j?s.jsx(G5,{roundedCircle:!0,src:j,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:s.jsx(Lt,{size:48,className:"text-white"})}),s.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:w,disabled:u,children:""}),s.jsx("input",{ref:c,type:"file",accept:"image/*",className:"d-none",onChange:b})]}),s.jsx("h4",{className:"mb-1",children:x()}),s.jsx("p",{className:"text-muted mb-2",children:p()}),s.jsx(Ae,{bg:h(g()),className:"mb-3",children:g()}),s.jsx("div",{className:"text-start",children:s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(tc,{size:14,className:"me-2"}),"Reset Password"]}),g()==="TRAINER"&&s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(ci,{size:14,className:"me-2"}),"Configure Signature"]}),s.jsx(ae,{variant:"primary",size:"sm",onClick:i,disabled:l||!o,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500",opacity:o?1:.5,cursor:o?"pointer":"not-allowed"},children:l?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(Zr,{size:14,className:"me-2"}),"Save Changes"]})})]})})]})})},AH=({profileData:e,user:t,onUpdate:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[l,o]=v.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:"",dob:"",enrollmentDate:"",trainingBatch:"",passportNo:"",nation:"",specialization:"",certificationNumber:"",yearsOfExp:"",bio:""}),[c,u]=v.useState(!1);v.useEffect(()=>{if(e&&e.firstName){const x={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||"",dob:e.traineeProfile?.dob?new Date(e.traineeProfile.dob).toISOString().split("T")[0]:"",enrollmentDate:e.traineeProfile?.enrollmentDate?new Date(e.traineeProfile.enrollmentDate).toISOString().split("T")[0]:"",trainingBatch:e.traineeProfile?.trainingBatch||"",passportNo:e.traineeProfile?.passportNo||"",nation:e.traineeProfile?.nation||"",specialization:e.trainerProfile?.specialization||"",certificationNumber:e.trainerProfile?.certificationNumber||"",yearsOfExp:e.trainerProfile?.yearsOfExp||"",bio:e.trainerProfile?.bio||""};o(x),u(!0)}},[e,c]);const d=x=>{const{name:p,value:g}=x.target;o(j=>({...j,[p]:g}))},m=async x=>{x.preventDefault(),i(!0);try{r?await r(l):(await xn.updateProfile(l),te.success("Personal information updated successfully!"))}catch(p){console.error("Error updating personal info:",p),r||te.error("Failed to update personal information. Please try again.")}finally{i(!1)}},f=e?.role?.name==="TRAINEE",h=e?.role?.name==="TRAINER";return s.jsxs(Y,{children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:20,className:"me-2 text-white"}),s.jsx("h5",{className:"mb-0 text-white",children:"Personal Information"})]})}),s.jsx(Y.Body,{children:s.jsxs(_,{onSubmit:m,children:[s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{className:"fw-bold",children:"EID"}),s.jsx(_.Control,{type:"text",value:e?.eid||"",disabled:!0,className:"bg-light"})]})})}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"First Name"}),s.jsx(_.Control,{type:"text",name:"firstName",value:l.firstName,onChange:d,disabled:!0,required:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Middle Name"}),s.jsx(_.Control,{type:"text",name:"middleName",value:l.middleName,onChange:d,disabled:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Last Name"}),s.jsx(_.Control,{type:"text",name:"lastName",value:l.lastName,onChange:d,disabled:!0,required:!0})]})})]}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Email"}),s.jsx(_.Control,{type:"email",name:"email",value:l.email,onChange:d,disabled:!0,required:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Phone Number"}),s.jsx(_.Control,{type:"tel",name:"phoneNumber",value:l.phoneNumber,onChange:d,disabled:!0})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Gender"}),s.jsxs(_.Select,{name:"gender",value:l.gender,onChange:d,disabled:!0,children:[s.jsx("option",{value:"",children:"Select Gender"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-12 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Address"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"address",value:l.address,onChange:d,placeholder:"Enter your address",disabled:!0})]})})}),f&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-4"}),s.jsx("h6",{className:"mb-3 text-primary fw-bold",children:"Trainee Information"}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Date of Birth"}),s.jsx(_.Control,{type:"date",name:"dob",value:l.dob,onChange:d,disabled:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Enrollment Date"}),s.jsx(_.Control,{type:"date",name:"enrollmentDate",value:l.enrollmentDate,onChange:d,disabled:!0})]})})]}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Training Batch"}),s.jsx(_.Control,{type:"text",name:"trainingBatch",value:l.trainingBatch,onChange:d,placeholder:"e.g., BATCH-001",disabled:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Passport Number"}),s.jsx(_.Control,{type:"text",name:"passportNo",value:l.passportNo,onChange:d,placeholder:"e.g., P10000001",disabled:!0})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Nation"}),s.jsx(_.Control,{type:"text",name:"nation",value:l.nation,onChange:d,placeholder:"e.g., Vietnam",disabled:!0})]})})})]}),h&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-4"}),s.jsx("h6",{className:"mb-3 text-primary fw-bold",children:"Trainer Information"}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Specialization"}),s.jsx(_.Control,{type:"text",name:"specialization",value:l.specialization,onChange:d,placeholder:"e.g., Cabin Safety & Emergency Procedures",disabled:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Certification Number"}),s.jsx(_.Control,{type:"text",name:"certificationNumber",value:l.certificationNumber,onChange:d,placeholder:"e.g., CAA-CABIN-SEP-2019-014",disabled:!0})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Years of Experience"}),s.jsx(_.Control,{type:"number",name:"yearsOfExp",value:l.yearsOfExp,onChange:d,min:"0",disabled:!0})]})})}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-12 mb-3",children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Bio"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"bio",value:l.bio,onChange:d,placeholder:"Enter your professional biography",disabled:!0})]})})})]})]})})]})},_H=()=>{const{user:e}=Rr(),t=ft(),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState(!0),[d,m]=v.useState(null),f=async()=>{try{u(!0);const j=await xn.getProfile();o(j)}catch(j){console.error("Failed to refresh profile:",j)}finally{u(!1)}};v.useEffect(()=>{f()},[]);const h=async j=>{if(!d){te.info("Nothing to update");return}a(!0);try{if(d){const w=await xn.updateProfile(d);o(w),m(null)}te.success("Profile updated successfully!")}catch(w){throw console.error("Error updating profile:",w),te.error("Failed to update profile. Please try again."),w}finally{a(!1)}},x=j=>{m(j)},p=async j=>{a(!0);try{const w={oldPassword:j.oldPassword||"",newPassword:j.newPassword||"",confirmNewPassword:j.confirmPassword||""},y=await xn.resetPassword(w);te.success(y.message||"Password updated successfully!")}catch(w){const y=w.message||w.response?.data?.message||"Failed to update password. Please check your current password.";throw te.error(y),w}finally{a(!1)}},g=()=>{e?.role,t(Pe.TRAINER_CONFIGURE_SIGNATURE)};return c?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsxs(ue,{children:[s.jsx(H,{lg:4,className:"mb-4",children:s.jsx(CH,{profileData:l,user:e,onResetPassword:()=>i(!0),onAvatarSelected:x,onConfigureSignature:g,onSaveChanges:h,loading:r,hasAvatarSelected:!!d})}),s.jsx(H,{lg:8,className:"mb-4",children:s.jsx(AH,{profileData:l,user:e,onUpdate:null})})]}),s.jsx(TH,{show:n,onClose:()=>i(!1),onSave:p,loading:r})]})},kH=()=>{const{user:e}=Rr(),{hasPermission:t}=ln(),r=ft(),a=v.useMemo(()=>{const u=t(De.VIEW_ALL_DEPARTMENTS),d=t(De.UPDATE_DEPARTMENT),m=t(De.VIEW_DEPARTMENT_DETAILS);return u&&!d?"all":m&&!u?"my":u?"all":null},[t]),{departments:n,loading:i,error:l}=lg(a!==null,a||"all"),o=n.filter(u=>u.status==="ACTIVE"),c=u=>{r(`/academic/course/${u}`)};return s.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:s.jsxs(Be,{className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ws,{size:48,className:"text-primary mb-3"}),s.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),s.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),s.jsxs("p",{className:"text-muted small",children:["Total Departments: ",s.jsx("strong",{children:o.length})]})]})})}),s.jsx(ue,{className:"mb-5",children:i?s.jsxs(H,{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):l?s.jsx(H,{className:"text-center py-5",children:s.jsxs("p",{className:"text-danger",children:["Error loading departments: ",typeof l=="string"?l:l?.message||"Unknown error"]})}):o.map(u=>s.jsx(H,{md:6,lg:4,className:"mb-4",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:s.jsxs(Y.Body,{className:"p-4 d-flex flex-column h-100",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"course-icon me-3",children:s.jsx($t,{size:24,className:"text-primary"})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h5",{className:"mb-1",children:u.name}),s.jsx(Ae,{bg:"secondary",className:"text-white",children:u.code})]})]}),s.jsx("div",{className:"text-muted description-container",children:u.description||s.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),s.jsx(Nt,{permission:De.VIEW_COURSE_DETAILS,fallback:null,children:s.jsxs(ae,{variant:"outline-primary",className:"w-100",onClick:()=>c(u.id),children:["View Details",s.jsx(vn,{size:16,className:"ms-2"})]})}),"                  "]})})},u.id))})]})})};var Ef={},Tf={},L1;function IH(){return L1||(L1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Tf)),Tf}var Cf={},M1;function oC(){return M1||(M1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Cf)),Cf}var Af={},B1;function Zg(){return B1||(B1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Af)),Af}var _f={},kf={},z1;function DH(){return z1||(z1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const a=String(r);return a==="0"&&Object.is(Number(r),-0)?"-0":a}e.toString=t})(kf)),kf}var $1;function Qg(){return $1||($1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DH(),r=Zg();function a(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],l=n.length;if(l===0)return i;let o=0,c="",u="",d=!1;for(n.charCodeAt(0)===46&&(i.push(""),o++);o<l;){const m=n[o];u?m==="\\"&&o+1<l?(o++,c+=n[o]):m===u?u="":c+=m:d?m==='"'||m==="'"?u=m:m==="]"?(d=!1,i.push(c),c=""):c+=m:m==="["?(d=!0,c&&(i.push(c),c="")):m==="."?c&&(i.push(c),c=""):c+=m,o++}return c&&i.push(c),i}e.toPath=a})(_f)),_f}var U1;function ev(){return U1||(U1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IH(),r=oC(),a=Zg(),n=Qg();function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?i(o,n.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=a.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return l(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function l(o,c,u){if(c.length===0)return u;let d=o;for(let m=0;m<c.length;m++){if(d==null||t.isUnsafeProperty(c[m]))return u;d=d[c[m]]}return d===void 0?u:d}e.get=i})(Ef)),Ef}var If,W1;function PH(){return W1||(W1=1,If=ev().get),If}var OH=PH();const el=gi(OH);var Df={exports:{}},er={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H1;function RH(){if(H1)return er;H1=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,p=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,j=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function y(S){if(typeof S=="object"&&S!==null){var E=S.$$typeof;switch(E){case t:switch(S=S.type,S){case c:case u:case a:case i:case n:case m:return S;default:switch(S=S&&S.$$typeof,S){case o:case d:case x:case h:case l:return S;default:return E}}case r:return E}}}function b(S){return y(S)===u}return er.AsyncMode=c,er.ConcurrentMode=u,er.ContextConsumer=o,er.ContextProvider=l,er.Element=t,er.ForwardRef=d,er.Fragment=a,er.Lazy=x,er.Memo=h,er.Portal=r,er.Profiler=i,er.StrictMode=n,er.Suspense=m,er.isAsyncMode=function(S){return b(S)||y(S)===c},er.isConcurrentMode=b,er.isContextConsumer=function(S){return y(S)===o},er.isContextProvider=function(S){return y(S)===l},er.isElement=function(S){return typeof S=="object"&&S!==null&&S.$$typeof===t},er.isForwardRef=function(S){return y(S)===d},er.isFragment=function(S){return y(S)===a},er.isLazy=function(S){return y(S)===x},er.isMemo=function(S){return y(S)===h},er.isPortal=function(S){return y(S)===r},er.isProfiler=function(S){return y(S)===i},er.isStrictMode=function(S){return y(S)===n},er.isSuspense=function(S){return y(S)===m},er.isValidElementType=function(S){return typeof S=="string"||typeof S=="function"||S===a||S===u||S===i||S===n||S===m||S===f||typeof S=="object"&&S!==null&&(S.$$typeof===x||S.$$typeof===h||S.$$typeof===l||S.$$typeof===o||S.$$typeof===d||S.$$typeof===g||S.$$typeof===j||S.$$typeof===w||S.$$typeof===p)},er.typeOf=y,er}var V1;function FH(){return V1||(V1=1,Df.exports=RH()),Df.exports}var LH=FH(),cs=e=>e===0?0:e>0?1:-1,wa=e=>typeof e=="number"&&e!=+e,Di=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,ut=e=>(typeof e=="number"||e instanceof Number)&&!wa(e),yn=e=>ut(e)||typeof e=="string",MH=0,vc=e=>{var t=++MH;return"".concat(e||"").concat(t)},Ps=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ut(t)&&typeof t!="string")return a;var i;if(Di(t)){if(r==null)return a;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return wa(i)&&(i=a),n&&r!=null&&i>r&&(i=r),i},cC=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1};function ys(e,t,r){return ut(e)&&ut(t)?e+r*(t-e):t}function BH(e,t,r){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):el(a,t))===r)}var ds=e=>e===null||typeof e>"u",Vc=e=>ds(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),zH=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function tv(e){if(typeof e!="string")return!1;var t=zH;return t.includes(e)}var $H=["viewBox","children"],G1=["points","pathLength"],Pf={svg:$H,polygon:G1,polyline:G1},UH=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(n=>{tv(n)&&(a[n]=(i=>r[n](r,i)))}),a},WH=(e,t,r)=>a=>(e(t,r,a),null),Gc=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(n=>{var i=e[n];tv(n)&&typeof i=="function"&&(a||(a={}),a[n]=WH(i,t,r))}),a},HH=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function dC(e){if(typeof e!="string")return!1;var t=HH;return t.includes(e)}function ji(e){var t=Object.entries(e).filter(r=>{var[a]=r;return dC(a)});return Object.fromEntries(t)}var q1=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",K1=null,Of=null,uC=e=>{if(e===K1&&Array.isArray(Of))return Of;var t=[];return v.Children.forEach(e,r=>{ds(r)||(LH.isFragment(r)?t=t.concat(uC(r.props.children)):t.push(r))}),Of=t,K1=e,t};function rv(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(n=>q1(n)):a=[q1(t)],uC(e).forEach(n=>{var i=el(n,"type.displayName")||el(n,"type.name");a.indexOf(i)!==-1&&r.push(n)}),r}var VH=(e,t,r,a)=>{var n;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(n=a&&Pf?.[a])!==null&&n!==void 0?n:[],l=t.startsWith("data-"),o=typeof e!="function"&&(!!a&&i.includes(t)||dC(t)),c=!!r&&tv(t);return l||o||c},es=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(v.isValidElement(e)&&(a=e.props),typeof a!="object"&&typeof a!="function")return null;var n={};return Object.keys(a).forEach(i=>{var l;VH((l=a)===null||l===void 0?void 0:l[i],i,t,r)&&(n[i]=a[i])}),n},GH=["children","width","height","viewBox","className","style","title","desc"];function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tx.apply(null,arguments)}function qH(e,t){if(e==null)return{};var r,a,n=KH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KH(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sv=v.forwardRef((e,t)=>{var{children:r,width:a,height:n,viewBox:i,className:l,style:o,title:c,desc:u}=e,d=qH(e,GH),m=i||{width:a,height:n,x:0,y:0},f=zt("recharts-surface",l);return v.createElement("svg",tx({},es(d,!0,"svg"),{className:f,width:a,height:n,style:o,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,c),v.createElement("desc",null,u),r)}),YH=["children","className"];function rx(){return rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rx.apply(null,arguments)}function XH(e,t){if(e==null)return{};var r,a,n=JH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JH(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var aa=v.forwardRef((e,t)=>{var{children:r,className:a}=e,n=XH(e,YH),i=zt("recharts-layer",a);return v.createElement("g",rx({className:i},es(n,!0),{ref:t}),r)}),mC=v.createContext(null),ZH=()=>v.useContext(mC);function ur(e){return function(){return e}}const fC=Math.cos,gu=Math.sin,on=Math.sqrt,vu=Math.PI,ym=2*vu,sx=Math.PI,ax=2*sx,Ti=1e-6,QH=ax-Ti;function hC(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function eV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hC;const r=10**t;return function(a){this._+=a[0];for(let n=1,i=a.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+a[n]}}class tV{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hC:eV(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,n){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+n}`}bezierCurveTo(t,r,a,n,i,l){this._append`C${+t},${+r},${+a},${+n},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,a,n,i){if(t=+t,r=+r,a=+a,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,o=this._y1,c=a-t,u=n-r,d=l-t,m=o-r,f=d*d+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Ti)if(!(Math.abs(m*c-u*d)>Ti)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=a-l,x=n-o,p=c*c+u*u,g=h*h+x*x,j=Math.sqrt(p),w=Math.sqrt(f),y=i*Math.tan((sx-Math.acos((p+f-g)/(2*j*w)))/2),b=y/w,S=y/j;Math.abs(b-1)>Ti&&this._append`L${t+b*d},${r+b*m}`,this._append`A${i},${i},0,0,${+(m*h>d*x)},${this._x1=t+S*c},${this._y1=r+S*u}`}}arc(t,r,a,n,i,l){if(t=+t,r=+r,a=+a,l=!!l,a<0)throw new Error(`negative radius: ${a}`);let o=a*Math.cos(n),c=a*Math.sin(n),u=t+o,d=r+c,m=1^l,f=l?n-i:i-n;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Ti||Math.abs(this._y1-d)>Ti)&&this._append`L${u},${d}`,a&&(f<0&&(f=f%ax+ax),f>QH?this._append`A${a},${a},0,1,${m},${t-o},${r-c}A${a},${a},0,1,${m},${this._x1=u},${this._y1=d}`:f>Ti&&this._append`A${a},${a},0,${+(f>=sx)},${m},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+n}h${-a}Z`}toString(){return this._}}function av(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new tV(t)}function nv(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pC(e){this._context=e}pC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bm(e){return new pC(e)}function xC(e){return e[0]}function gC(e){return e[1]}function vC(e,t){var r=ur(!0),a=null,n=bm,i=null,l=av(o);e=typeof e=="function"?e:e===void 0?xC:ur(e),t=typeof t=="function"?t:t===void 0?gC:ur(t);function o(c){var u,d=(c=nv(c)).length,m,f=!1,h;for(a==null&&(i=n(h=l())),u=0;u<=d;++u)!(u<d&&r(m=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(m,u,c),+t(m,u,c));if(h)return i=null,h+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:ur(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:ur(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:ur(!!c),o):r},o.curve=function(c){return arguments.length?(n=c,a!=null&&(i=n(a)),o):n},o.context=function(c){return arguments.length?(c==null?a=i=null:i=n(a=c),o):a},o}function Cd(e,t,r){var a=null,n=ur(!0),i=null,l=bm,o=null,c=av(u);e=typeof e=="function"?e:e===void 0?xC:ur(+e),t=typeof t=="function"?t:ur(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?gC:ur(+r);function u(m){var f,h,x,p=(m=nv(m)).length,g,j=!1,w,y=new Array(p),b=new Array(p);for(i==null&&(o=l(w=c())),f=0;f<=p;++f){if(!(f<p&&n(g=m[f],f,m))===j)if(j=!j)h=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=f-1;x>=h;--x)o.point(y[x],b[x]);o.lineEnd(),o.areaEnd()}j&&(y[f]=+e(g,f,m),b[f]=+t(g,f,m),o.point(a?+a(g,f,m):y[f],r?+r(g,f,m):b[f]))}if(w)return o=null,w+""||null}function d(){return vC().defined(n).curve(l).context(i)}return u.x=function(m){return arguments.length?(e=typeof m=="function"?m:ur(+m),a=null,u):e},u.x0=function(m){return arguments.length?(e=typeof m=="function"?m:ur(+m),u):e},u.x1=function(m){return arguments.length?(a=m==null?null:typeof m=="function"?m:ur(+m),u):a},u.y=function(m){return arguments.length?(t=typeof m=="function"?m:ur(+m),r=null,u):t},u.y0=function(m){return arguments.length?(t=typeof m=="function"?m:ur(+m),u):t},u.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:ur(+m),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(a).y(t)},u.defined=function(m){return arguments.length?(n=typeof m=="function"?m:ur(!!m),u):n},u.curve=function(m){return arguments.length?(l=m,i!=null&&(o=l(i)),u):l},u.context=function(m){return arguments.length?(m==null?i=o=null:o=l(i=m),u):i},u}class yC{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function rV(e){return new yC(e,!0)}function sV(e){return new yC(e,!1)}const iv={draw(e,t){const r=on(t/vu);e.moveTo(r,0),e.arc(0,0,r,0,ym)}},aV={draw(e,t){const r=on(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},bC=on(1/3),nV=bC*2,iV={draw(e,t){const r=on(t/nV),a=r*bC;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},lV={draw(e,t){const r=on(t),a=-r/2;e.rect(a,a,r,r)}},oV=.8908130915292852,jC=gu(vu/10)/gu(7*vu/10),cV=gu(ym/10)*jC,dV=-fC(ym/10)*jC,uV={draw(e,t){const r=on(t*oV),a=cV*r,n=dV*r;e.moveTo(0,-r),e.lineTo(a,n);for(let i=1;i<5;++i){const l=ym*i/5,o=fC(l),c=gu(l);e.lineTo(c*r,-o*r),e.lineTo(o*a-c*n,c*a+o*n)}e.closePath()}},Rf=on(3),mV={draw(e,t){const r=-on(t/(Rf*3));e.moveTo(0,r*2),e.lineTo(-Rf*r,-r),e.lineTo(Rf*r,-r),e.closePath()}},Aa=-.5,_a=on(3)/2,nx=1/on(12),fV=(nx/2+1)*3,hV={draw(e,t){const r=on(t/fV),a=r/2,n=r*nx,i=a,l=r*nx+r,o=-i,c=l;e.moveTo(a,n),e.lineTo(i,l),e.lineTo(o,c),e.lineTo(Aa*a-_a*n,_a*a+Aa*n),e.lineTo(Aa*i-_a*l,_a*i+Aa*l),e.lineTo(Aa*o-_a*c,_a*o+Aa*c),e.lineTo(Aa*a+_a*n,Aa*n-_a*a),e.lineTo(Aa*i+_a*l,Aa*l-_a*i),e.lineTo(Aa*o+_a*c,Aa*c-_a*o),e.closePath()}};function pV(e,t){let r=null,a=av(n);e=typeof e=="function"?e:ur(e||iv),t=typeof t=="function"?t:ur(t===void 0?64:+t);function n(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:ur(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:ur(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function yu(){}function bu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function wC(e){this._context=e}wC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xV(e){return new wC(e)}function NC(e){this._context=e}NC.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gV(e){return new NC(e)}function SC(e){this._context=e}SC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vV(e){return new SC(e)}function EC(e){this._context=e}EC.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function yV(e){return new EC(e)}function Y1(e){return e<0?-1:1}function X1(e,t,r){var a=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(a||n<0&&-0),l=(r-e._y1)/(n||a<0&&-0),o=(i*n+l*a)/(a+n);return(Y1(i)+Y1(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(o))||0}function J1(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ff(e,t,r){var a=e._x0,n=e._y0,i=e._x1,l=e._y1,o=(i-a)/3;e._context.bezierCurveTo(a+o,n+o*t,i-o,l-o*r,i,l)}function ju(e){this._context=e}ju.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ff(this,this._t0,J1(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ff(this,J1(this,r=X1(this,e,t)),r);break;default:Ff(this,this._t0,r=X1(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function TC(e){this._context=new CC(e)}(TC.prototype=Object.create(ju.prototype)).point=function(e,t){ju.prototype.point.call(this,t,e)};function CC(e){this._context=e}CC.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,n,i){this._context.bezierCurveTo(t,e,a,r,i,n)}};function bV(e){return new ju(e)}function jV(e){return new TC(e)}function AC(e){this._context=e}AC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=Z1(e),n=Z1(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(a[0][i],n[0][i],a[1][i],n[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Z1(e){var t,r=e.length-1,a,n=new Array(r),i=new Array(r),l=new Array(r);for(n[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=n[t]/i[t-1],i[t]-=a,l[t]-=a*l[t-1];for(n[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(l[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function wV(e){return new AC(e)}function jm(e,t){this._context=e,this._t=t}jm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function NV(e){return new jm(e,.5)}function SV(e){return new jm(e,0)}function EV(e){return new jm(e,1)}function Kl(e,t){if((l=e.length)>1)for(var r=1,a,n,i=e[t[0]],l,o=i.length;r<l;++r)for(n=i,i=e[t[r]],a=0;a<o;++a)i[a][1]+=i[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}function ix(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function TV(e,t){return e[t]}function CV(e){const t=[];return t.key=e,t}function AV(){var e=ur([]),t=ix,r=Kl,a=TV;function n(i){var l=Array.from(e.apply(this,arguments),CV),o,c=l.length,u=-1,d;for(const m of i)for(o=0,++u;o<c;++o)(l[o][u]=[0,+a(m,l[o].key,u,i)]).data=m;for(o=0,d=nv(t(l));o<c;++o)l[d[o]].index=o;return r(l,d),l}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:ur(Array.from(i)),n):e},n.value=function(i){return arguments.length?(a=typeof i=="function"?i:ur(+i),n):a},n.order=function(i){return arguments.length?(t=i==null?ix:typeof i=="function"?i:ur(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??Kl,n):r},n}function _V(e,t){if((a=e.length)>0){for(var r,a,n=0,i=e[0].length,l;n<i;++n){for(l=r=0;r<a;++r)l+=e[r][n][1]||0;if(l)for(r=0;r<a;++r)e[r][n][1]/=l}Kl(e,t)}}function kV(e,t){if((n=e.length)>0){for(var r=0,a=e[t[0]],n,i=a.length;r<i;++r){for(var l=0,o=0;l<n;++l)o+=e[l][r][1]||0;a[r][1]+=a[r][0]=-o/2}Kl(e,t)}}function IV(e,t){if(!(!((l=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,a=1,n,i,l;a<i;++a){for(var o=0,c=0,u=0;o<l;++o){for(var d=e[t[o]],m=d[a][1]||0,f=d[a-1][1]||0,h=(m-f)/2,x=0;x<o;++x){var p=e[t[x]],g=p[a][1]||0,j=p[a-1][1]||0;h+=g-j}c+=m,u+=h*m}n[a-1][1]+=n[a-1][0]=r,c&&(r-=u/c)}n[a-1][1]+=n[a-1][0]=r,Kl(e,t)}}var DV=["type","size","sizeType"];function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lx.apply(null,arguments)}function Q1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q1(Object(r),!0).forEach(function(a){PV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function PV(e,t,r){return(t=OV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OV(e){var t=RV(e,"string");return typeof t=="symbol"?t:t+""}function RV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FV(e,t){if(e==null)return{};var r,a,n=LV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LV(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var _C={symbolCircle:iv,symbolCross:aV,symbolDiamond:iV,symbolSquare:lV,symbolStar:uV,symbolTriangle:mV,symbolWye:hV},MV=Math.PI/180,BV=e=>{var t="symbol".concat(Vc(e));return _C[t]||iv},zV=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*MV;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},$V=(e,t)=>{_C["symbol".concat(Vc(e))]=t},lv=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,n=FV(e,DV),i=ej(ej({},n),{},{type:t,size:r,sizeType:a}),l="circle";typeof t=="string"&&(l=t);var o=()=>{var f=BV(l),h=pV().type(f).size(zV(r,a,l));return h()},{className:c,cx:u,cy:d}=i,m=es(i,!0);return u===+u&&d===+d&&r===+r?v.createElement("path",lx({},m,{className:zt("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};lv.registerSymbol=$V;function ox(){return ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ox.apply(null,arguments)}function tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function UV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tj(Object(r),!0).forEach(function(a){ov(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ov(e,t,r){return(t=WV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WV(e){var t=HV(e,"string");return typeof t=="symbol"?t:t+""}function HV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ka=32;class cv extends v.PureComponent{renderIcon(t,r){var{inactiveColor:a}=this.props,n=ka/2,i=ka/6,l=ka/3,o=t.inactive?a:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:n,x2:ka,y2:n,className:"recharts-legend-icon"});if(c==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(n,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(n,`
            H`).concat(ka,"M").concat(2*l,",").concat(n,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(n),className:"recharts-legend-icon"});if(c==="rect")return v.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(ka/8,"h").concat(ka,"v").concat(ka*3/4,"h").concat(-ka,"z"),className:"recharts-legend-icon"});if(v.isValidElement(t.legendIcon)){var u=UV({},t);return delete u.legendIcon,v.cloneElement(t.legendIcon,u)}return v.createElement(lv,{fill:o,cx:n,cy:n,size:ka,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:a,formatter:n,inactiveColor:i,iconType:l}=this.props,o={x:0,y:0,width:ka,height:ka},c={display:a==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,m)=>{var f=d.formatter||n,h=zt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?i:d.color,p=f?f(d.value,d,m):d.value;return v.createElement("li",ox({className:h,style:c,key:"legend-item-".concat(m)},Gc(this.props,d,m)),v.createElement(sv,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(p," legend icon")},this.renderIcon(d,l)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},p))})}render(){var{payload:t,layout:r,align:a}=this.props;if(!t||!t.length)return null;var n={padding:0,margin:0,textAlign:r==="horizontal"?a:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:n},this.renderItems())}}ov(cv,"displayName","Legend");ov(cv,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Lf={},Mf={},rj;function VV(){return rj||(rj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){const n=new Map;for(let i=0;i<r.length;i++){const l=r[i],o=a(l);n.has(o)||n.set(o,l)}return Array.from(n.values())}e.uniqBy=t})(Mf)),Mf}var Bf={},sj;function kC(){return sj||(sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Bf)),Bf}var zf={},$f={},Uf={},aj;function GV(){return aj||(aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Uf)),Uf}var nj;function dv(){return nj||(nj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GV();function r(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=r})($f)),$f}var Wf={},ij;function qV(){return ij||(ij=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Wf)),Wf}var lj;function KV(){return lj||(lj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dv(),r=qV();function a(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=a})(zf)),zf}var Hf={},Vf={},oj;function YV(){return oj||(oj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ev();function r(a){return function(n){return t.get(n,a)}}e.property=r})(Vf)),Vf}var Gf={},qf={},Kf={},Yf={},cj;function IC(){return cj||(cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Yf)),Yf}var Xf={},dj;function DC(){return dj||(dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Xf)),Xf}var Jf={},uj;function PC(){return uj||(uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){return r===a||Number.isNaN(r)&&Number.isNaN(a)}e.eq=t})(Jf)),Jf}var mj;function XV(){return mj||(mj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uv(),r=IC(),a=DC(),n=PC();function i(m,f,h){return typeof h!="function"?t.isMatch(m,f):l(m,f,function x(p,g,j,w,y,b){const S=h(p,g,j,w,y,b);return S!==void 0?!!S:l(p,g,x,b)},new Map)}function l(m,f,h,x){if(f===m)return!0;switch(typeof f){case"object":return o(m,f,h,x);case"function":return Object.keys(f).length>0?l(m,{...f},h,x):n.eq(m,f);default:return r.isObject(m)?typeof f=="string"?f==="":!0:n.eq(m,f)}}function o(m,f,h,x){if(f==null)return!0;if(Array.isArray(f))return u(m,f,h,x);if(f instanceof Map)return c(m,f,h,x);if(f instanceof Set)return d(m,f,h,x);const p=Object.keys(f);if(m==null)return p.length===0;if(p.length===0)return!0;if(x&&x.has(f))return x.get(f)===m;x&&x.set(f,m);try{for(let g=0;g<p.length;g++){const j=p[g];if(!a.isPrimitive(m)&&!(j in m)||f[j]===void 0&&m[j]!==void 0||f[j]===null&&m[j]!==null||!h(m[j],f[j],j,m,f,x))return!1}return!0}finally{x&&x.delete(f)}}function c(m,f,h,x){if(f.size===0)return!0;if(!(m instanceof Map))return!1;for(const[p,g]of f.entries()){const j=m.get(p);if(h(j,g,p,m,f,x)===!1)return!1}return!0}function u(m,f,h,x){if(f.length===0)return!0;if(!Array.isArray(m))return!1;const p=new Set;for(let g=0;g<f.length;g++){const j=f[g];let w=!1;for(let y=0;y<m.length;y++){if(p.has(y))continue;const b=m[y];let S=!1;if(h(b,j,g,m,f,x)&&(S=!0),S){p.add(y),w=!0;break}}if(!w)return!1}return!0}function d(m,f,h,x){return f.size===0?!0:m instanceof Set?u([...m],[...f],h,x):!1}e.isMatchWith=i,e.isSetMatch=d})(Kf)),Kf}var fj;function uv(){return fj||(fj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XV();function r(a,n){return t.isMatchWith(a,n,()=>{})}e.isMatch=r})(qf)),qf}var Zf={},Qf={},eh={},hj;function JV(){return hj||(hj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(a=>Object.prototype.propertyIsEnumerable.call(r,a))}e.getSymbols=t})(eh)),eh}var th={},pj;function OC(){return pj||(pj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(th)),th}var rh={},xj;function RC(){return xj||(xj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",a="[object Number]",n="[object Boolean]",i="[object Arguments]",l="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",m="[object Function]",f="[object ArrayBuffer]",h="[object Object]",x="[object Error]",p="[object DataView]",g="[object Uint8Array]",j="[object Uint8ClampedArray]",w="[object Uint16Array]",y="[object Uint32Array]",b="[object BigUint64Array]",S="[object Int8Array]",E="[object Int16Array]",N="[object Int32Array]",T="[object BigInt64Array]",k="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=d,e.bigInt64ArrayTag=T,e.bigUint64ArrayTag=b,e.booleanTag=n,e.dataViewTag=p,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=k,e.float64ArrayTag=I,e.functionTag=m,e.int16ArrayTag=E,e.int32ArrayTag=N,e.int8ArrayTag=S,e.mapTag=c,e.numberTag=a,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=w,e.uint32ArrayTag=y,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=j})(rh)),rh}var sh={},gj;function ZV(){return gj||(gj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(sh)),sh}var vj;function FC(){return vj||(vj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JV(),r=OC(),a=RC(),n=DC(),i=ZV();function l(d,m){return o(d,void 0,d,new Map,m)}function o(d,m,f,h=new Map,x=void 0){const p=x?.(d,m,f,h);if(p!==void 0)return p;if(n.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const g=new Array(d.length);h.set(d,g);for(let j=0;j<d.length;j++)g[j]=o(d[j],j,f,h,x);return Object.hasOwn(d,"index")&&(g.index=d.index),Object.hasOwn(d,"input")&&(g.input=d.input),g}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const g=new RegExp(d.source,d.flags);return g.lastIndex=d.lastIndex,g}if(d instanceof Map){const g=new Map;h.set(d,g);for(const[j,w]of d)g.set(j,o(w,j,f,h,x));return g}if(d instanceof Set){const g=new Set;h.set(d,g);for(const j of d)g.add(o(j,void 0,f,h,x));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const g=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,g);for(let j=0;j<d.length;j++)g[j]=o(d[j],j,f,h,x);return g}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const g=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,g),c(g,d,f,h,x),g}if(typeof File<"u"&&d instanceof File){const g=new File([d],d.name,{type:d.type});return h.set(d,g),c(g,d,f,h,x),g}if(typeof Blob<"u"&&d instanceof Blob){const g=new Blob([d],{type:d.type});return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof Error){const g=new d.constructor;return h.set(d,g),g.message=d.message,g.name=d.name,g.stack=d.stack,g.cause=d.cause,c(g,d,f,h,x),g}if(d instanceof Boolean){const g=new Boolean(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof Number){const g=new Number(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof String){const g=new String(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(typeof d=="object"&&u(d)){const g=Object.create(Object.getPrototypeOf(d));return h.set(d,g),c(g,d,f,h,x),g}return d}function c(d,m,f=d,h,x){const p=[...Object.keys(m),...t.getSymbols(m)];for(let g=0;g<p.length;g++){const j=p[g],w=Object.getOwnPropertyDescriptor(d,j);(w==null||w.writable)&&(d[j]=o(m[j],j,f,h,x))}}function u(d){switch(r.getTag(d)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=o,e.copyProperties=c})(Qf)),Qf}var yj;function QV(){return yj||(yj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC();function r(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=r})(Zf)),Zf}var bj;function eG(){return bj||(bj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uv(),r=QV();function a(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=a})(Gf)),Gf}var ah={},nh={},ih={},jj;function tG(){return jj||(jj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC(),r=RC();function a(n,i){return t.cloneDeepWith(n,(l,o,c,u)=>{const d=i?.(l,o,c,u);if(d!==void 0)return d;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new n.constructor(n?.valueOf());return t.copyProperties(m,n),m}case r.argumentsTag:{const m={};return t.copyProperties(m,n),m.length=n.length,m[Symbol.iterator]=n[Symbol.iterator],m}default:return}})}e.cloneDeepWith=a})(ih)),ih}var wj;function rG(){return wj||(wj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tG();function r(a){return t.cloneDeepWith(a)}e.cloneDeep=r})(nh)),nh}var lh={},oh={},Nj;function LC(){return Nj||(Nj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(a,n=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<n;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=r})(oh)),oh}var ch={},Sj;function sG(){return Sj||(Sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC();function r(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=r})(ch)),ch}var Ej;function aG(){return Ej||(Ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oC(),r=LC(),a=sG(),n=Qg();function i(l,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&l?.[o]==null?c=n.toPath(o):c=[o],c.length===0)return!1;let u=l;for(let d=0;d<c.length;d++){const m=c[d];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||a.isArguments(u))&&r.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}e.has=i})(lh)),lh}var Tj;function nG(){return Tj||(Tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uv(),r=Zg(),a=rG(),n=ev(),i=aG();function l(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=a.cloneDeep(c),function(u){const d=n.get(u,o);return d===void 0?i.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=l})(ah)),ah}var Cj;function iG(){return Cj||(Cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kC(),r=YV(),a=eG(),n=nG();function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?n.matchesProperty(l[0],l[1]):a.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i})(Hf)),Hf}var Aj;function lG(){return Aj||(Aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VV(),r=kC(),a=KV(),n=iG();function i(l,o=r.identity){return a.isArrayLikeObject(l)?t.uniqBy(Array.from(l),n.iteratee(o)):[]}e.uniqBy=i})(Lf)),Lf}var dh,_j;function oG(){return _j||(_j=1,dh=lG().uniqBy),dh}var cG=oG();const kj=gi(cG);function MC(e,t,r){return t===!0?kj(e,r):typeof t=="function"?kj(e,t):e}var uh={exports:{}},mh={},fh={exports:{}},hh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ij;function dG(){if(Ij)return hh;Ij=1;var e=Kx();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,a=e.useState,n=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function o(m,f){var h=f(),x=a({inst:{value:h,getSnapshot:f}}),p=x[0].inst,g=x[1];return i(function(){p.value=h,p.getSnapshot=f,c(p)&&g({inst:p})},[m,h,f]),n(function(){return c(p)&&g({inst:p}),m(function(){c(p)&&g({inst:p})})},[m]),l(h),h}function c(m){var f=m.getSnapshot;m=m.value;try{var h=f();return!r(m,h)}catch{return!0}}function u(m,f){return f()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return hh.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,hh}var Dj;function uG(){return Dj||(Dj=1,fh.exports=dG()),fh.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj;function mG(){if(Pj)return mh;Pj=1;var e=Kx(),t=uG();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var a=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,o=e.useMemo,c=e.useDebugValue;return mh.useSyncExternalStoreWithSelector=function(u,d,m,f,h){var x=i(null);if(x.current===null){var p={hasValue:!1,value:null};x.current=p}else p=x.current;x=o(function(){function j(E){if(!w){if(w=!0,y=E,E=f(E),h!==void 0&&p.hasValue){var N=p.value;if(h(N,E))return b=N}return b=E}if(N=b,a(y,E))return N;var T=f(E);return h!==void 0&&h(N,T)?(y=E,N):(y=E,b=T)}var w=!1,y,b,S=m===void 0?null:m;return[function(){return j(d())},S===null?void 0:function(){return j(S())}]},[d,m,f,h]);var g=n(u,x[0],x[1]);return l(function(){p.hasValue=!0,p.value=g},[g]),c(g),g},mh}var Oj;function fG(){return Oj||(Oj=1,uh.exports=mG()),uh.exports}var hG=fG(),mv=v.createContext(null),pG=e=>e,_r=()=>{var e=v.useContext(mv);return e?e.store.dispatch:pG},Yd=()=>{},xG=()=>Yd,gG=(e,t)=>e===t;function ct(e){var t=v.useContext(mv);return hG.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:xG,t?t.store.getState:Yd,t?t.store.getState:Yd,t?e:Yd,gG)}function vG(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function yG(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function bG(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${r}]`)}}var Rj=e=>Array.isArray(e)?e:[e];function jG(e){const t=Array.isArray(e[0])?e[0]:e;return bG(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function wG(e,t){const r=[],{length:a}=e;for(let n=0;n<a;n++)r.push(e[n].apply(null,t));return r}var NG=class{constructor(e){this.value=e}deref(){return this.value}},SG=typeof WeakRef<"u"?WeakRef:NG,EG=0,Fj=1;function Ad(){return{s:EG,v:void 0,o:null,p:null}}function BC(e,t={}){let r=Ad();const{resultEqualityCheck:a}=t;let n,i=0;function l(){let o=r;const{length:c}=arguments;for(let m=0,f=c;m<f;m++){const h=arguments[m];if(typeof h=="function"||typeof h=="object"&&h!==null){let x=o.o;x===null&&(o.o=x=new WeakMap);const p=x.get(h);p===void 0?(o=Ad(),x.set(h,o)):o=p}else{let x=o.p;x===null&&(o.p=x=new Map);const p=x.get(h);p===void 0?(o=Ad(),x.set(h,o)):o=p}}const u=o;let d;if(o.s===Fj)d=o.v;else if(d=e.apply(null,arguments),i++,a){const m=n?.deref?.()??n;m!=null&&a(m,d)&&(d=m,i!==0&&i--),n=typeof d=="object"&&d!==null||typeof d=="function"?new SG(d):d}return u.s=Fj,u.v=d,d}return l.clearCache=()=>{r=Ad(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function TG(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...n)=>{let i=0,l=0,o,c={},u=n.pop();typeof u=="object"&&(c=u,u=n.pop()),vG(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:m,memoizeOptions:f=[],argsMemoize:h=BC,argsMemoizeOptions:x=[]}=d,p=Rj(f),g=Rj(x),j=jG(n),w=m(function(){return i++,u.apply(null,arguments)},...p),y=h(function(){l++;const S=wG(j,arguments);return o=w.apply(null,S),o},...g);return Object.assign(y,{resultFunc:u,memoizedResultFunc:w,dependencies:j,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:h})};return Object.assign(a,{withTypes:()=>a}),a}var _e=TG(BC),CG=Object.assign((e,t=_e)=>{yG(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),a=r.map(i=>e[i]);return t(a,(...i)=>i.reduce((l,o,c)=>(l[r[c]]=o,l),{}))},{withTypes:()=>CG}),ph={},xh={},gh={},Lj;function AG(){return Lj||(Lj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const r=(a,n,i)=>{if(a!==n){const l=t(a),o=t(n);if(l===o&&l===0){if(a<n)return i==="desc"?1:-1;if(a>n)return i==="desc"?-1:1}return i==="desc"?o-l:l-o}return 0};e.compareValues=r})(gh)),gh}var vh={},yh={},Mj;function zC(){return Mj||(Mj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(yh)),yh}var Bj;function _G(){return Bj||(Bj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zC(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function n(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(a.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=n})(vh)),vh}var zj;function kG(){return zj||(zj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AG(),r=_G(),a=Qg();function n(i,l,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(h=>String(h));const u=(h,x)=>{let p=h;for(let g=0;g<x.length&&p!=null;++g)p=p[x[g]];return p},d=(h,x)=>x==null||h==null?x:typeof h=="object"&&"key"in h?Object.hasOwn(x,h.key)?x[h.key]:u(x,h.path):typeof h=="function"?h(x):Array.isArray(h)?u(x,h):typeof x=="object"?x[h]:x,m=l.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:a.toPath(h)}));return i.map(h=>({original:h,criteria:m.map(x=>d(x,h))})).slice().sort((h,x)=>{for(let p=0;p<m.length;p++){const g=t.compareValues(h.criteria[p],x.criteria[p],o[p]);if(g!==0)return g}return 0}).map(h=>h.original)}e.orderBy=n})(xh)),xh}var bh={},$j;function IG(){return $j||($j=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a=1){const n=[],i=Math.floor(a),l=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<i?l(d,c+1):n.push(d)}};return l(r,0),n}e.flatten=t})(bh)),bh}var jh={},Uj;function $C(){return Uj||(Uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LC(),r=dv(),a=IC(),n=PC();function i(l,o,c){return a.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?n.eq(c[o],l):!1}e.isIterateeCall=i})(jh)),jh}var Wj;function DG(){return Wj||(Wj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kG(),r=IG(),a=$C();function n(i,...l){const o=l.length;return o>1&&a.isIterateeCall(i,l[0],l[1])?l=[]:o>2&&a.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=n})(ph)),ph}var wh,Hj;function PG(){return Hj||(Hj=1,wh=DG().sortBy),wh}var OG=PG();const wm=gi(OG);var UC=e=>e.legend.settings,RG=e=>e.legend.size,FG=e=>e.legend.payload,LG=_e([FG,UC],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?wm(a,r):a});function MG(){return ct(LG)}var _d=1;function WC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),a=v.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>_d||Math.abs(l.left-t.left)>_d||Math.abs(l.top-t.top)>_d||Math.abs(l.width-t.width)>_d)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function ps(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var BG=typeof Symbol=="function"&&Symbol.observable||"@@observable",Vj=BG,Nh=()=>Math.random().toString(36).substring(7).split("").join("."),zG={INIT:`@@redux/INIT${Nh()}`,REPLACE:`@@redux/REPLACE${Nh()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Nh()}`},wu=zG;function fv(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function HC(e,t,r){if(typeof e!="function")throw new Error(ps(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ps(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ps(1));return r(HC)(e,t)}let a=e,n=t,i=new Map,l=i,o=0,c=!1;function u(){l===i&&(l=new Map,i.forEach((g,j)=>{l.set(j,g)}))}function d(){if(c)throw new Error(ps(3));return n}function m(g){if(typeof g!="function")throw new Error(ps(4));if(c)throw new Error(ps(5));let j=!0;u();const w=o++;return l.set(w,g),function(){if(j){if(c)throw new Error(ps(6));j=!1,u(),l.delete(w),i=null}}}function f(g){if(!fv(g))throw new Error(ps(7));if(typeof g.type>"u")throw new Error(ps(8));if(typeof g.type!="string")throw new Error(ps(17));if(c)throw new Error(ps(9));try{c=!0,n=a(n,g)}finally{c=!1}return(i=l).forEach(w=>{w()}),g}function h(g){if(typeof g!="function")throw new Error(ps(10));a=g,f({type:wu.REPLACE})}function x(){const g=m;return{subscribe(j){if(typeof j!="object"||j===null)throw new Error(ps(11));function w(){const b=j;b.next&&b.next(d())}return w(),{unsubscribe:g(w)}},[Vj](){return this}}}return f({type:wu.INIT}),{dispatch:f,subscribe:m,getState:d,replaceReducer:h,[Vj]:x}}function $G(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:wu.INIT})>"u")throw new Error(ps(12));if(typeof r(void 0,{type:wu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ps(13))})}function VC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const a=Object.keys(r);let n;try{$G(r)}catch(i){n=i}return function(l={},o){if(n)throw n;let c=!1;const u={};for(let d=0;d<a.length;d++){const m=a[d],f=r[m],h=l[m],x=f(h,o);if(typeof x>"u")throw o&&o.type,new Error(ps(14));u[m]=x,c=c||x!==h}return c=c||a.length!==Object.keys(l).length,c?u:l}}function Nu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function UG(...e){return t=>(r,a)=>{const n=t(r,a);let i=()=>{throw new Error(ps(15))};const l={getState:n.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(l));return i=Nu(...o)(n.dispatch),{...n,dispatch:i}}}function GC(e){return fv(e)&&"type"in e&&typeof e.type=="string"}var qC=Symbol.for("immer-nothing"),Gj=Symbol.for("immer-draftable"),Na=Symbol.for("immer-state");function Ja(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Yl=Object.getPrototypeOf;function tl(e){return!!e&&!!e[Na]}function Ln(e){return e?KC(e)||Array.isArray(e)||!!e[Gj]||!!e.constructor?.[Gj]||qc(e)||Sm(e):!1}var WG=Object.prototype.constructor.toString();function KC(e){if(!e||typeof e!="object")return!1;const t=Yl(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===WG}function Su(e,t){Nm(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function Nm(e){const t=e[Na];return t?t.type_:Array.isArray(e)?1:qc(e)?2:Sm(e)?3:0}function cx(e,t){return Nm(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function YC(e,t,r){const a=Nm(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function HG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function qc(e){return e instanceof Map}function Sm(e){return e instanceof Set}function Ci(e){return e.copy_||e.base_}function dx(e,t){if(qc(e))return new Map(e);if(Sm(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=KC(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[Na];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const l=n[i],o=a[l];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(a[l]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[l]})}return Object.create(Yl(e),a)}else{const a=Yl(e);if(a!==null&&r)return{...e};const n=Object.create(a);return Object.assign(n,e)}}function hv(e,t=!1){return Em(e)||tl(e)||!Ln(e)||(Nm(e)>1&&Object.defineProperties(e,{set:{value:kd},add:{value:kd},clear:{value:kd},delete:{value:kd}}),Object.freeze(e),t&&Object.values(e).forEach(r=>hv(r,!0))),e}function kd(){Ja(2)}function Em(e){return Object.isFrozen(e)}var VG={};function rl(e){const t=VG[e];return t||Ja(0,e),t}var yc;function XC(){return yc}function GG(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function qj(e,t){t&&(rl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ux(e){mx(e),e.drafts_.forEach(qG),e.drafts_=null}function mx(e){e===yc&&(yc=e.parent_)}function Kj(e){return yc=GG(yc,e)}function qG(e){const t=e[Na];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Yj(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Na].modified_&&(ux(t),Ja(4)),Ln(e)&&(e=Eu(t,e),t.parent_||Tu(t,e)),t.patches_&&rl("Patches").generateReplacementPatches_(r[Na].base_,e,t.patches_,t.inversePatches_)):e=Eu(t,r,[]),ux(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==qC?e:void 0}function Eu(e,t,r){if(Em(t))return t;const a=t[Na];if(!a)return Su(t,(n,i)=>Xj(e,a,t,n,i,r)),t;if(a.scope_!==e)return t;if(!a.modified_)return Tu(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const n=a.copy_;let i=n,l=!1;a.type_===3&&(i=new Set(n),n.clear(),l=!0),Su(i,(o,c)=>Xj(e,a,n,o,c,r,l)),Tu(e,n,!1),r&&e.patches_&&rl("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function Xj(e,t,r,a,n,i,l){if(tl(n)){const o=i&&t&&t.type_!==3&&!cx(t.assigned_,a)?i.concat(a):void 0,c=Eu(e,n,o);if(YC(r,a,c),tl(c))e.canAutoFreeze_=!1;else return}else l&&r.add(n);if(Ln(n)&&!Em(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Eu(e,n),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(qc(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&Tu(e,n)}}function Tu(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&hv(t,r)}function KG(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:XC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,i=pv;r&&(n=[a],i=bc);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return a.draft_=o,a.revoke_=l,o}var pv={get(e,t){if(t===Na)return e;const r=Ci(e);if(!cx(r,t))return YG(e,r,t);const a=r[t];return e.finalized_||!Ln(a)?a:a===Sh(e.base_,t)?(Eh(e),e.copy_[t]=hx(a,e)):a},has(e,t){return t in Ci(e)},ownKeys(e){return Reflect.ownKeys(Ci(e))},set(e,t,r){const a=JC(Ci(e),t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const n=Sh(Ci(e),t),i=n?.[Na];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(HG(r,n)&&(r!==void 0||cx(e.base_,t)))return!0;Eh(e),fx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Sh(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Eh(e),fx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ci(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){Ja(11)},getPrototypeOf(e){return Yl(e.base_)},setPrototypeOf(){Ja(12)}},bc={};Su(pv,(e,t)=>{bc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});bc.deleteProperty=function(e,t){return bc.set.call(this,e,t,void 0)};bc.set=function(e,t,r){return pv.set.call(this,e[0],t,r,e[0])};function Sh(e,t){const r=e[Na];return(r?Ci(r):e)[t]}function YG(e,t,r){const a=JC(t,r);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function JC(e,t){if(!(t in e))return;let r=Yl(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=Yl(r)}}function fx(e){e.modified_||(e.modified_=!0,e.parent_&&fx(e.parent_))}function Eh(e){e.copy_||(e.copy_=dx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var XG=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(c=i,...u){return l.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Ja(6),a!==void 0&&typeof a!="function"&&Ja(7);let n;if(Ln(t)){const i=Kj(this),l=hx(t,void 0);let o=!0;try{n=r(l),o=!1}finally{o?ux(i):mx(i)}return qj(i,a),Yj(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===qC&&(n=void 0),this.autoFreeze_&&hv(n,!0),a){const i=[],l=[];rl("Patches").generateReplacementPatches_(t,n,i,l),a(i,l)}return n}else Ja(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...o)=>this.produceWithPatches(l,c=>t(c,...o));let a,n;return[this.produce(t,r,(l,o)=>{a=l,n=o}),a,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ln(e)||Ja(8),tl(e)&&(e=Dn(e));const t=Kj(this),r=hx(e,void 0);return r[Na].isManual_=!0,mx(t),r}finishDraft(e,t){const r=e&&e[Na];(!r||!r.isManual_)&&Ja(9);const{scope_:a}=r;return qj(a,t),Yj(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const a=rl("Patches").applyPatches_;return tl(e)?a(e,t):this.produce(e,n=>a(n,t))}};function hx(e,t){const r=qc(e)?rl("MapSet").proxyMap_(e,t):Sm(e)?rl("MapSet").proxySet_(e,t):KG(e,t);return(t?t.scope_:XC()).drafts_.push(r),r}function Dn(e){return tl(e)||Ja(10,e),ZC(e)}function ZC(e){if(!Ln(e)||Em(e))return e;const t=e[Na];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=dx(e,t.scope_.immer_.useStrictShallowCopy_)}else r=dx(e,!0);return Su(r,(a,n)=>{YC(r,a,ZC(n))}),t&&(t.finalized_=!1),r}var JG=new XG,QC=JG.produce;function eA(e){return({dispatch:r,getState:a})=>n=>i=>typeof i=="function"?i(r,a,e):n(i)}var ZG=eA(),QG=eA,eq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Nu:Nu.apply(null,arguments)};function Ua(e,t){function r(...a){if(t){let n=t(...a);if(!n)throw new Error(ya(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>GC(a)&&a.type===e,r}var tA=class Bo extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Bo.prototype)}static get[Symbol.species](){return Bo}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Bo(...t[0].concat(this)):new Bo(...t.concat(this))}};function Jj(e){return Ln(e)?QC(e,()=>{}):e}function Id(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function tq(e){return typeof e=="boolean"}var rq=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let l=new tA;return r&&(tq(r)?l.push(ZG):l.push(QG(r.extraArgument))),l},sq="RTK_autoBatch",Zj=e=>t=>{setTimeout(t,e)},aq=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let n=!0,i=!1,l=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Zj(10):e.type==="callback"?e.queueNotification:Zj(e.timeout),u=()=>{l=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},a,{subscribe(d){const m=()=>n&&d(),f=a.subscribe(m);return o.add(d),()=>{f(),o.delete(d)}},dispatch(d){try{return n=!d?.meta?.[sq],i=!n,i&&(l||(l=!0,c(u))),a.dispatch(d)}finally{n=!0}}})},nq=e=>function(r){const{autoBatch:a=!0}=r??{};let n=new tA(e);return a&&n.push(aq(typeof a=="object"?a:void 0)),n};function iq(e){const t=rq(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(fv(r))o=VC(r);else throw new Error(ya(1));let c;typeof a=="function"?c=a(t):c=t();let u=Nu;n&&(u=eq({trace:!1,...typeof n=="object"&&n}));const d=UG(...c),m=nq(d);let f=typeof l=="function"?l(m):m();const h=u(...f);return HC(o,i,h)}function rA(e){const t={},r=[];let a;const n={addCase(i,l){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(ya(28));if(o in t)throw new Error(ya(29));return t[o]=l,n},addAsyncThunk(i,l){return l.pending&&(t[i.pending.type]=l.pending),l.rejected&&(t[i.rejected.type]=l.rejected),l.fulfilled&&(t[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),n},addMatcher(i,l){return r.push({matcher:i,reducer:l}),n},addDefaultCase(i){return a=i,n}};return e(n),[t,r,a]}function lq(e){return typeof e=="function"}function oq(e,t){let[r,a,n]=rA(t),i;if(lq(e))i=()=>Jj(e());else{const o=Jj(e);i=()=>o}function l(o=i(),c){let u=[r[c.type],...a.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[n]),u.reduce((d,m)=>{if(m)if(tl(d)){const h=m(d,c);return h===void 0?d:h}else{if(Ln(d))return QC(d,f=>m(f,c));{const f=m(d,c);if(f===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return d},o)}return l.getInitialState=i,l}var cq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",dq=(e=21)=>{let t="",r=e;for(;r--;)t+=cq[Math.random()*64|0];return t},uq=Symbol.for("rtk-slice-createasyncthunk");function mq(e,t){return`${e}/${t}`}function fq({creators:e}={}){const t=e?.asyncThunk?.[uq];return function(a){const{name:n,reducerPath:i=n}=a;if(!n)throw new Error(ya(11));const l=(typeof a.reducers=="function"?a.reducers(pq()):a.reducers)||{},o=Object.keys(l),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(y,b){const S=typeof y=="string"?y:y.type;if(!S)throw new Error(ya(12));if(S in c.sliceCaseReducersByType)throw new Error(ya(13));return c.sliceCaseReducersByType[S]=b,u},addMatcher(y,b){return c.sliceMatchers.push({matcher:y,reducer:b}),u},exposeAction(y,b){return c.actionCreators[y]=b,u},exposeCaseReducer(y,b){return c.sliceCaseReducersByName[y]=b,u}};o.forEach(y=>{const b=l[y],S={reducerName:y,type:mq(n,y),createNotation:typeof a.reducers=="function"};gq(b)?yq(S,b,u,t):xq(S,b,u)});function d(){const[y={},b=[],S=void 0]=typeof a.extraReducers=="function"?rA(a.extraReducers):[a.extraReducers],E={...y,...c.sliceCaseReducersByType};return oq(a.initialState,N=>{for(let T in E)N.addCase(T,E[T]);for(let T of c.sliceMatchers)N.addMatcher(T.matcher,T.reducer);for(let T of b)N.addMatcher(T.matcher,T.reducer);S&&N.addDefaultCase(S)})}const m=y=>y,f=new Map,h=new WeakMap;let x;function p(y,b){return x||(x=d()),x(y,b)}function g(){return x||(x=d()),x.getInitialState()}function j(y,b=!1){function S(N){let T=N[y];return typeof T>"u"&&b&&(T=Id(h,S,g)),T}function E(N=m){const T=Id(f,b,()=>new WeakMap);return Id(T,N,()=>{const k={};for(const[I,D]of Object.entries(a.selectors??{}))k[I]=hq(D,N,()=>Id(h,N,g),b);return k})}return{reducerPath:y,getSelectors:E,get selectors(){return E(S)},selectSlice:S}}const w={name:n,reducer:p,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...j(i),injectInto(y,{reducerPath:b,...S}={}){const E=b??i;return y.inject({reducerPath:E,reducer:p},S),{...w,...j(E,!0)}}};return w}}function hq(e,t,r,a){function n(i,...l){let o=t(i);return typeof o>"u"&&a&&(o=r()),e(o,...l)}return n.unwrapped=e,n}var Ea=fq();function pq(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function xq({type:e,reducerName:t,createNotation:r},a,n){let i,l;if("reducer"in a){if(r&&!vq(a))throw new Error(ya(17));i=a.reducer,l=a.prepare}else i=a;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?Ua(e,l):Ua(e))}function gq(e){return e._reducerDefinitionType==="asyncThunk"}function vq(e){return e._reducerDefinitionType==="reducerWithPrepare"}function yq({type:e,reducerName:t},r,a,n){if(!n)throw new Error(ya(18));const{payloadCreator:i,fulfilled:l,pending:o,rejected:c,settled:u,options:d}=r,m=n(e,i,d);a.exposeAction(t,m),l&&a.addCase(m.fulfilled,l),o&&a.addCase(m.pending,o),c&&a.addCase(m.rejected,c),u&&a.addMatcher(m.settled,u),a.exposeCaseReducer(t,{fulfilled:l||Dd,pending:o||Dd,rejected:c||Dd,settled:u||Dd})}function Dd(){}var bq="task",sA="listener",aA="completed",xv="cancelled",jq=`task-${xv}`,wq=`task-${aA}`,px=`${sA}-${xv}`,Nq=`${sA}-${aA}`,Tm=class{constructor(e){this.code=e,this.message=`${bq} ${xv} (reason: ${e})`}name="TaskAbortError";message},gv=(e,t)=>{if(typeof e!="function")throw new TypeError(ya(32))},Cu=()=>{},nA=(e,t=Cu)=>(e.catch(t),e),iA=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),$i=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ui=e=>{if(e.aborted){const{reason:t}=e;throw new Tm(t)}};function lA(e,t){let r=Cu;return new Promise((a,n)=>{const i=()=>n(new Tm(e.reason));if(e.aborted){i();return}r=iA(e,i),t.finally(()=>r()).then(a,n)}).finally(()=>{r=Cu})}var Sq=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Tm?"cancelled":"rejected",error:r}}finally{t?.()}},Au=e=>t=>nA(lA(e,t).then(r=>(Ui(e),r))),oA=e=>{const t=Au(e);return r=>t(new Promise(a=>setTimeout(a,r)))},{assign:zl}=Object,Qj={},Cm="listenerMiddleware",Eq=(e,t)=>{const r=a=>iA(e,()=>$i(a,e.reason));return(a,n)=>{gv(a);const i=new AbortController;r(i);const l=Sq(async()=>{Ui(e),Ui(i.signal);const o=await a({pause:Au(i.signal),delay:oA(i.signal),signal:i.signal});return Ui(i.signal),o},()=>$i(i,wq));return n?.autoJoin&&t.push(l.catch(Cu)),{result:Au(e)(l),cancel(){$i(i,jq)}}}},Tq=(e,t)=>{const r=async(a,n)=>{Ui(t);let i=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:a,effect:(m,f)=>{f.unsubscribe(),c([m,f.getState(),f.getOriginalState()])}});i=()=>{d(),u()}})];n!=null&&o.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await lA(t,Promise.race(o));return Ui(t),c}finally{i()}};return(a,n)=>nA(r(a,n))},cA=e=>{let{type:t,actionCreator:r,matcher:a,predicate:n,effect:i}=e;if(t)n=Ua(t).match;else if(r)t=r.type,n=r.match;else if(a)n=a;else if(!n)throw new Error(ya(21));return gv(i),{predicate:n,type:t,effect:i}},dA=zl(e=>{const{type:t,predicate:r,effect:a}=cA(e);return{id:dq(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ya(22))}}},{withTypes:()=>dA}),ew=(e,t)=>{const{type:r,effect:a,predicate:n}=cA(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===a)},xx=e=>{e.pending.forEach(t=>{$i(t,px)})},Cq=e=>()=>{e.forEach(xx),e.clear()},tw=(e,t,r)=>{try{e(t,r)}catch(a){setTimeout(()=>{throw a},0)}},uA=zl(Ua(`${Cm}/add`),{withTypes:()=>uA}),Aq=Ua(`${Cm}/removeAll`),mA=zl(Ua(`${Cm}/remove`),{withTypes:()=>mA}),_q=(...e)=>{console.error(`${Cm}/error`,...e)},Kc=(e={})=>{const t=new Map,{extra:r,onError:a=_q}=e;gv(a);const n=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),m=>{d.unsubscribe(),m?.cancelActive&&xx(d)}),i=d=>{const m=ew(t,d)??dA(d);return n(m)};zl(i,{withTypes:()=>i});const l=d=>{const m=ew(t,d);return m&&(m.unsubscribe(),d.cancelActive&&xx(m)),!!m};zl(l,{withTypes:()=>l});const o=async(d,m,f,h)=>{const x=new AbortController,p=Tq(i,x.signal),g=[];try{d.pending.add(x),await Promise.resolve(d.effect(m,zl({},f,{getOriginalState:h,condition:(j,w)=>p(j,w).then(Boolean),take:p,delay:oA(x.signal),pause:Au(x.signal),extra:r,signal:x.signal,fork:Eq(x.signal,g),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((j,w,y)=>{j!==x&&($i(j,px),y.delete(j))})},cancel:()=>{$i(x,px),d.pending.delete(x)},throwIfCancelled:()=>{Ui(x.signal)}})))}catch(j){j instanceof Tm||tw(a,j,{raisedBy:"effect"})}finally{await Promise.all(g),$i(x,Nq),d.pending.delete(x)}},c=Cq(t);return{middleware:d=>m=>f=>{if(!GC(f))return m(f);if(uA.match(f))return i(f.payload);if(Aq.match(f)){c();return}if(mA.match(f))return l(f.payload);let h=d.getState();const x=()=>{if(h===Qj)throw new Error(ya(23));return h};let p;try{if(p=m(f),t.size>0){const g=d.getState(),j=Array.from(t.values());for(const w of j){let y=!1;try{y=w.predicate(f,g,h)}catch(b){y=!1,tw(a,b,{raisedBy:"predicate"})}y&&o(w,f,d,x)}}}finally{h=Qj}return p},startListening:i,stopListening:l,clearListeners:c}};function ya(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var kq={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},fA=Ea({name:"chartLayout",initialState:kq,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Iq,setLayout:Dq,setChartSize:Pq,setScale:Oq}=fA.actions,Rq=fA.reducer;function rw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function sw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rw(Object(r),!0).forEach(function(a){Fq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Fq(e,t,r){return(t=Lq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lq(e){var t=Mq(e,"string");return typeof t=="symbol"?t:t+""}function Mq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _u=Math.PI/180,Bq=e=>e*180/Math.PI,qr=(e,t,r,a)=>({x:e+Math.cos(-_u*a)*r,y:t+Math.sin(-_u*a)*r}),hA=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},zq=(e,t)=>{var{x:r,y:a}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(a-i)**2)},$q=(e,t)=>{var{x:r,y:a}=e,{cx:n,cy:i}=t,l=zq({x:r,y:a},{x:n,y:i});if(l<=0)return{radius:l,angle:0};var o=(r-n)/l,c=Math.acos(o);return a>i&&(c=2*Math.PI-c),{radius:l,angle:Bq(c),angleInRadian:c}},Uq=e=>{var{startAngle:t,endAngle:r}=e,a=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(a,n);return{startAngle:t-i*360,endAngle:r-i*360}},Wq=(e,t)=>{var{startAngle:r,endAngle:a}=t,n=Math.floor(r/360),i=Math.floor(a/360),l=Math.min(n,i);return e+l*360},Hq=(e,t)=>{var{x:r,y:a}=e,{radius:n,angle:i}=$q({x:r,y:a},t),{innerRadius:l,outerRadius:o}=t;if(n<l||n>o||n===0)return null;var{startAngle:c,endAngle:u}=Uq(t),d=i,m;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;m=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;m=d>=u&&d<=c}return m?sw(sw({},t),{},{radius:n,angle:Wq(d,t)}):null};function pA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function La(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(a){Vq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vq(e,t,r){return(t=Gq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gq(e){var t=qq(e,"string");return typeof t=="symbol"?t:t+""}function qq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cr(e,t,r){return ds(e)||ds(t)?r:yn(t)?el(e,t,r):typeof t=="function"?t(e):r}var Kq=(e,t,r,a,n)=>{var i,l=-1,o=(i=t?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(a==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,m=c>=o-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(cs(d-u)!==cs(m-d)){var h=[];if(cs(m-d)===cs(n[1]-n[0])){f=m;var x=d+n[1]-n[0];h[0]=Math.min(x,(x+u)/2),h[1]=Math.max(x,(x+u)/2)}else{f=u;var p=m+n[1]-n[0];h[0]=Math.min(d,(p+d)/2),h[1]=Math.max(d,(p+d)/2)}var g=[Math.min(d,(f+d)/2),Math.max(d,(f+d)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){({index:l}=r[c]);break}}else{var j=Math.min(u,m),w=Math.max(u,m);if(e>(j+d)/2&&e<=(w+d)/2){({index:l}=r[c]);break}}}else if(t){for(var y=0;y<o;y++)if(y===0&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:l}=t[y]);break}}return l},Yq=(e,t,r)=>{if(t&&r){var{width:a,height:n}=r,{align:i,verticalAlign:l,layout:o}=t;if((o==="vertical"||o==="horizontal"&&l==="middle")&&i!=="center"&&ut(e[i]))return La(La({},e),{},{[i]:e[i]+(a||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&l!=="middle"&&ut(e[l]))return La(La({},e),{},{[l]:e[l]+(n||0)})}return e},hl=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",xA=(e,t,r,a)=>{if(a)return e.map(o=>o.coordinate);var n,i,l=e.map(o=>(o.coordinate===t&&(n=!0),o.coordinate===r&&(i=!0),o.coordinate));return n||l.push(t),i||l.push(r),l},gA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:a,type:n,range:i,scale:l,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:m,niceTicks:f,axisType:h}=e;if(!l)return null;var x=o==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,p=n==="category"&&l.bandwidth?l.bandwidth()/x:0;if(p=h==="angleAxis"&&i&&i.length>=2?cs(i[0]-i[1])*2*p:p,m||f){var g=(m||f||[]).map((j,w)=>{var y=a?a.indexOf(j):j;return{coordinate:l(y)+p,value:j,offset:p,index:w}});return g.filter(j=>!wa(j.coordinate))}return c&&u?u.map((j,w)=>({coordinate:l(j)+p,value:j,index:w,offset:p})):l.ticks&&d!=null?l.ticks(d).map((j,w)=>({coordinate:l(j)+p,value:j,offset:p,index:w})):l.domain().map((j,w)=>({coordinate:l(j)+p,value:a?a[j]:j,index:w,offset:p}))},nw=1e-4,Xq=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,a=e.range(),n=Math.min(a[0],a[1])-nw,i=Math.max(a[0],a[1])+nw,l=e(t[0]),o=e(t[r-1]);(l<n||l>i||o<n||o>i)&&e.domain([t[0],t[r-1]])}},Jq=(e,t)=>{if(!t||t.length!==2||!ut(t[0])||!ut(t[1]))return e;var r=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!ut(e[0])||e[0]<r)&&(n[0]=r),(!ut(e[1])||e[1]>a)&&(n[1]=a),n[0]>a&&(n[0]=a),n[1]<r&&(n[1]=r),n},Zq=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0,l=0;l<t;++l){var o=wa(e[l][r][1])?e[l][r][0]:e[l][r][1];o>=0?(e[l][r][0]=n,e[l][r][1]=n+o,n=e[l][r][1]):(e[l][r][0]=i,e[l][r][1]=i+o,i=e[l][r][1])}},Qq=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0;i<t;++i){var l=wa(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=n,e[i][r][1]=n+l,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},eK={sign:Zq,expand:_V,none:Kl,silhouette:kV,wiggle:IV,positive:Qq},tK=(e,t,r)=>{var a=eK[r],n=AV().keys(t).value((i,l)=>+Cr(i,l,0)).order(ix).offset(a);return n(e)};function rK(e){return e==null?void 0:String(e)}var iw=e=>{var{axis:t,ticks:r,offset:a,bandSize:n,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+a:null;var o=Cr(i,t.dataKey,t.scale.domain()[l]);return ds(o)?null:t.scale(o)-n/2+a},sK=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var a=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return a<=0&&n>=0?0:n<0?n:a}return r[0]},aK=e=>{var t=e.flat(2).filter(ut);return[Math.min(...t),Math.max(...t)]},nK=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],iK=(e,t,r)=>{if(e!=null)return nK(Object.keys(e).reduce((a,n)=>{var i=e[n],{stackedData:l}=i,o=l.reduce((c,u)=>{var d=pA(u,t,r),m=aK(d);return[Math.min(c[0],m[0]),Math.max(c[1],m[1])]},[1/0,-1/0]);return[Math.min(o[0],a[0]),Math.max(o[1],a[1])]},[1/0,-1/0]))},lw=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ow=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vv=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var n=wm(t,d=>d.coordinate),i=1/0,l=1,o=n.length;l<o;l++){var c=n[l],u=n[l-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function cw(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:n,name:i}=e;return La(La({},t),{},{dataKey:r,payload:a,value:n,name:i})}function Am(e,t){if(e)return String(e);if(typeof t=="string")return t}function lK(e,t,r,a,n){if(r==="horizontal"||r==="vertical"){var i=e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height;return i?{x:e,y:t}:null}return a?Hq({x:e,y:t},a):null}var oK=(e,t,r,a)=>{var n=t.find(u=>u&&u.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:n.coordinate};if(e==="centric"){var i=n.coordinate,{radius:l}=a;return La(La(La({},a),qr(a.cx,a.cy,l,i)),{},{angle:i,radius:l})}var o=n.coordinate,{angle:c}=a;return La(La(La({},a),qr(a.cx,a.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},cK=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Hn=e=>e.layout.width,Vn=e=>e.layout.height,dK=e=>e.layout.scale,vA=e=>e.layout.margin,_m=_e(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),km=_e(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),yA="data-recharts-item-index",bA="data-recharts-item-data-key",Yc=60;function dw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Pd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dw(Object(r),!0).forEach(function(a){uK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uK(e,t,r){return(t=mK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mK(e){var t=fK(e,"string");return typeof t=="symbol"?t:t+""}function fK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hK=e=>e.brush.height;function pK(e){var t=km(e);return t.reduce((r,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Yc;return r+n}return r},0)}function xK(e){var t=km(e);return t.reduce((r,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Yc;return r+n}return r},0)}function gK(e){var t=_m(e);return t.reduce((r,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?r+a.height:r,0)}function vK(e){var t=_m(e);return t.reduce((r,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?r+a.height:r,0)}var rs=_e([Hn,Vn,vA,hK,pK,xK,gK,vK,UC,RG],(e,t,r,a,n,i,l,o,c,u)=>{var d={left:(r.left||0)+n,right:(r.right||0)+i},m={top:(r.top||0)+l,bottom:(r.bottom||0)+o},f=Pd(Pd({},m),d),h=f.bottom;f.bottom+=a,f=Yq(f,c,u);var x=e-f.left-f.right,p=t-f.top-f.bottom;return Pd(Pd({brushBottom:h},f),{},{width:Math.max(x,0),height:Math.max(p,0)})}),yK=_e(rs,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),yv=_e(Hn,Vn,(e,t)=>({x:0,y:0,width:e,height:t})),bK=v.createContext(null),Va=()=>v.useContext(bK)!=null,Im=e=>e.brush,Dm=_e([Im,rs,vA],(e,t,r)=>({height:e.height,x:ut(e.x)?e.x:t.left,y:ut(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:ut(e.width)?e.width:t.width})),bv=()=>{var e,t=Va(),r=ct(yK),a=ct(Dm),n=(e=ct(Im))===null||e===void 0?void 0:e.padding;return!t||!a||!n?r:{width:a.width-n.left-n.right,height:a.height-n.top-n.bottom,x:n.left,y:n.top}},jK={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},jA=()=>{var e;return(e=ct(rs))!==null&&e!==void 0?e:jK},jv=()=>ct(Hn),wv=()=>ct(Vn),wK=()=>ct(e=>e.layout.margin),Xt=e=>e.layout.layoutType,Nv=()=>ct(Xt),NK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},wA=Ea({name:"legend",initialState:NK,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Dn(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:uw,setLegendSettings:SK,addLegendPayload:NA,removeLegendPayload:SA}=wA.actions,EK=wA.reducer,TK=["contextPayload"];function gx(){return gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gx.apply(null,arguments)}function mw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Xl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mw(Object(r),!0).forEach(function(a){Sv(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Sv(e,t,r){return(t=CK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CK(e){var t=AK(e,"string");return typeof t=="symbol"?t:t+""}function AK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _K(e,t){if(e==null)return{};var r,a,n=kK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kK(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function IK(e){return e.value}function DK(e){var{contextPayload:t}=e,r=_K(e,TK),a=MC(t,e.payloadUniqBy,IK),n=Xl(Xl({},r),{},{payload:a});return v.isValidElement(e.content)?v.cloneElement(e.content,n):typeof e.content=="function"?v.createElement(e.content,n):v.createElement(cv,n)}function PK(e,t,r,a,n,i){var{layout:l,align:o,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&l==="vertical"?u={left:((a||0)-i.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((n||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Xl(Xl({},u),d)}function OK(e){var t=_r();return v.useEffect(()=>{t(SK(e))},[t,e]),null}function RK(e){var t=_r();return v.useEffect(()=>(t(uw(e)),()=>{t(uw({width:0,height:0}))}),[t,e]),null}function FK(e){var t=MG(),r=ZH(),a=wK(),{width:n,height:i,wrapperStyle:l,portal:o}=e,[c,u]=WC([t]),d=jv(),m=wv();if(d==null||m==null)return null;var f=d-(a.left||0)-(a.right||0),h=ii.getWidthOrHeight(e.layout,i,n,f),x=o?l:Xl(Xl({position:"absolute",width:h?.width||n||"auto",height:h?.height||i||"auto"},PK(l,e,a,d,m,c)),l),p=o??r;if(p==null)return null;var g=v.createElement("div",{className:"recharts-legend-wrapper",style:x,ref:u},v.createElement(OK,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),v.createElement(RK,{width:c.width,height:c.height}),v.createElement(DK,gx({},e,h,{margin:a,chartWidth:d,chartHeight:m,contextPayload:t})));return qx.createPortal(g,p)}class ii extends v.PureComponent{static getWidthOrHeight(t,r,a,n){return t==="vertical"&&ut(r)?{height:r}:t==="horizontal"?{width:a||n}:null}render(){return v.createElement(FK,this.props)}}Sv(ii,"displayName","Legend");Sv(ii,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function vx(){return vx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},vx.apply(null,arguments)}function fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Th(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fw(Object(r),!0).forEach(function(a){LK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function LK(e,t,r){return(t=MK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MK(e){var t=BK(e,"string");return typeof t=="symbol"?t:t+""}function BK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zK(e){return Array.isArray(e)&&yn(e[0])&&yn(e[1])?e.join(" ~ "):e}var $K=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:n={},payload:i,formatter:l,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:m,accessibilityLayer:f=!1}=e,h=()=>{if(i&&i.length){var S={padding:0,margin:0},E=(o?wm(i,o):i).map((N,T)=>{if(N.type==="none")return null;var k=N.formatter||l||zK,{value:I,name:D}=N,A=I,M=D;if(k){var G=k(I,D,N,T,i);if(Array.isArray(G))[A,M]=G;else if(G!=null)A=G;else return null}var q=Th({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},a);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:q},yn(M)?v.createElement("span",{className:"recharts-tooltip-item-name"},M):null,yn(M)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},A),v.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:S},E)}return null},x=Th({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=Th({margin:0},n),g=!ds(d),j=g?d:"",w=zt("recharts-default-tooltip",c),y=zt("recharts-tooltip-label",u);g&&m&&i!==void 0&&i!==null&&(j=m(d,i));var b=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",vx({className:w,style:x},b),v.createElement("p",{className:y,style:p},v.isValidElement(j)?j:"".concat(j)),h())},Co="recharts-tooltip-wrapper",UK={visibility:"hidden"};function WK(e){var{coordinate:t,translateX:r,translateY:a}=e;return zt(Co,{["".concat(Co,"-right")]:ut(r)&&t&&ut(t.x)&&r>=t.x,["".concat(Co,"-left")]:ut(r)&&t&&ut(t.x)&&r<t.x,["".concat(Co,"-bottom")]:ut(a)&&t&&ut(t.y)&&a>=t.y,["".concat(Co,"-top")]:ut(a)&&t&&ut(t.y)&&a<t.y})}function hw(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:n,position:i,reverseDirection:l,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&ut(i[a]))return i[a];var d=r[a]-o-(n>0?n:0),m=r[a]+n;if(t[a])return l[a]?d:m;var f=c[a];if(f==null)return 0;if(l[a]){var h=d,x=f;return h<x?Math.max(m,f):Math.max(d,f)}if(u==null)return 0;var p=m+o,g=f+u;return p>g?Math.max(d,f):Math.max(m,f)}function HK(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function VK(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:a,position:n,reverseDirection:i,tooltipBox:l,useTranslate3d:o,viewBox:c}=e,u,d,m;return l.height>0&&l.width>0&&r?(d=hw({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:l.width,viewBox:c,viewBoxDimension:c.width}),m=hw({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:l.height,viewBox:c,viewBoxDimension:c.height}),u=HK({translateX:d,translateY:m,useTranslate3d:o})):u=UK,{cssProperties:u,cssClasses:WK({translateX:d,translateY:m,coordinate:r})}}function pw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Od(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pw(Object(r),!0).forEach(function(a){yx(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yx(e,t,r){return(t=GK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GK(e){var t=qK(e,"string");return typeof t=="symbol"?t:t+""}function qK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class KK extends v.PureComponent{constructor(){super(...arguments),yx(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),yx(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,a,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:a,animationEasing:n,children:i,coordinate:l,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:m,useTranslate3d:f,viewBox:h,wrapperStyle:x,lastBoundingBox:p,innerRef:g,hasPortalFromProps:j}=this.props,{cssClasses:w,cssProperties:y}=VK({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:u,position:d,reverseDirection:m,tooltipBox:{height:p.height,width:p.width},useTranslate3d:f,viewBox:h}),b=j?{}:Od(Od({transition:c&&t?"transform ".concat(a,"ms ").concat(n):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),S=Od(Od({},b),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:S,ref:g},i)}}var YK=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),pl={devToolsEnabled:!1,isSsr:YK()},EA=()=>ct(e=>e.rootProps.accessibilityLayer);function Sa(e){return Number.isFinite(e)}function Jl(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function bx(){return bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bx.apply(null,arguments)}function xw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function gw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xw(Object(r),!0).forEach(function(a){XK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function XK(e,t,r){return(t=JK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JK(e){var t=ZK(e,"string");return typeof t=="symbol"?t:t+""}function ZK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vw={curveBasisClosed:gV,curveBasisOpen:vV,curveBasis:xV,curveBumpX:rV,curveBumpY:sV,curveLinearClosed:yV,curveLinear:bm,curveMonotoneX:bV,curveMonotoneY:jV,curveNatural:wV,curveStep:NV,curveStepAfter:EV,curveStepBefore:SV},Rd=e=>Sa(e.x)&&Sa(e.y),Ao=e=>e.x,_o=e=>e.y,QK=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Vc(e));return(r==="curveMonotone"||r==="curveBump")&&t?vw["".concat(r).concat(t==="vertical"?"Y":"X")]:vw[r]||bm},eY=e=>{var{type:t="linear",points:r=[],baseLine:a,layout:n,connectNulls:i=!1}=e,l=QK(t,n),o=i?r.filter(Rd):r,c;if(Array.isArray(a)){var u=i?a.filter(m=>Rd(m)):a,d=o.map((m,f)=>gw(gw({},m),{},{base:u[f]}));return n==="vertical"?c=Cd().y(_o).x1(Ao).x0(m=>m.base.x):c=Cd().x(Ao).y1(_o).y0(m=>m.base.y),c.defined(Rd).curve(l),c(d)}return n==="vertical"&&ut(a)?c=Cd().y(_o).x1(Ao).x0(a):ut(a)?c=Cd().x(Ao).y1(_o).y0(a):c=vC().x(Ao).y(_o),c.defined(Rd).curve(l),c(o)},TA=e=>{var{className:t,points:r,path:a,pathRef:n}=e;if((!r||!r.length)&&!a)return null;var i=r&&r.length?eY(e):a;return v.createElement("path",bx({},ji(e),UH(e),{className:zt("recharts-curve",t),d:i===null?void 0:i,ref:n}))},tY=["x","y","top","left","width","height","className"];function jx(){return jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jx.apply(null,arguments)}function yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function rY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yw(Object(r),!0).forEach(function(a){sY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function sY(e,t,r){return(t=aY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aY(e){var t=nY(e,"string");return typeof t=="symbol"?t:t+""}function nY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iY(e,t){if(e==null)return{};var r,a,n=lY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lY(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oY=(e,t,r,a,n,i)=>"M".concat(e,",").concat(n,"v").concat(a,"M").concat(i,",").concat(t,"h").concat(r),cY=e=>{var{x:t=0,y:r=0,top:a=0,left:n=0,width:i=0,height:l=0,className:o}=e,c=iY(e,tY),u=rY({x:t,y:r,top:a,left:n,width:i,height:l},c);return!ut(t)||!ut(r)||!ut(i)||!ut(l)||!ut(a)||!ut(n)?null:v.createElement("path",jx({},es(u,!0),{className:zt("recharts-cross",o),d:oY(t,r,i,l,a,n)}))};function dY(e,t,r,a){var n=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function bw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function uY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bw(Object(r),!0).forEach(function(a){mY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mY(e,t,r){return(t=fY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fY(e){var t=hY(e,"string");return typeof t=="symbol"?t:t+""}function hY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qs(e,t){var r=uY({},e),a=t,n=Object.keys(t),i=n.reduce((l,o)=>(l[o]===void 0&&a[o]!==void 0&&(l[o]=a[o]),l),r);return i}function pY(){}function jw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function ww(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jw(Object(r),!0).forEach(function(a){xY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xY(e,t,r){return(t=gY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gY(e){var t=vY(e,"string");return typeof t=="symbol"?t:t+""}function vY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yY=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),CA=(e,t,r)=>e.map(a=>"".concat(yY(a)," ").concat(t,"ms ").concat(r)).join(","),bY=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,a)=>r.filter(n=>a.includes(n))),jc=(e,t)=>Object.keys(t).reduce((r,a)=>ww(ww({},r),{},{[a]:e(a,t[a])}),{});function Nw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nw(Object(r),!0).forEach(function(a){jY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jY(e,t,r){return(t=wY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=NY(e,"string");return typeof t=="symbol"?t:t+""}function NY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ku=(e,t,r)=>e+(t-e)*r,wx=e=>{var{from:t,to:r}=e;return t!==r},AA=(e,t,r)=>{var a=jc((n,i)=>{if(wx(i)){var[l,o]=e(i.from,i.to,i.velocity);return xs(xs({},i),{},{from:l,velocity:o})}return i},t);return r<1?jc((n,i)=>wx(i)?xs(xs({},i),{},{velocity:ku(i.velocity,a[n].velocity,r),from:ku(i.from,a[n].from,r)}):i,t):AA(e,a,r-1)};function SY(e,t,r,a,n,i){var l,o=a.reduce((f,h)=>xs(xs({},f),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>jc((f,h)=>h.from,o),u=()=>!Object.values(o).filter(wx).length,d=null,m=f=>{l||(l=f);var h=f-l,x=h/r.dt;o=AA(r,o,x),n(xs(xs(xs({},e),t),c())),l=f,u()||(d=i.setTimeout(m))};return()=>(d=i.setTimeout(m),()=>{d()})}function EY(e,t,r,a,n,i,l){var o=null,c=n.reduce((m,f)=>xs(xs({},m),{},{[f]:[e[f],t[f]]}),{}),u,d=m=>{u||(u=m);var f=(m-u)/a,h=jc((p,g)=>ku(...g,r(f)),c);if(i(xs(xs(xs({},e),t),h)),f<1)o=l.setTimeout(d);else{var x=jc((p,g)=>ku(...g,r(1)),c);i(xs(xs(xs({},e),t),x))}};return()=>(o=l.setTimeout(d),()=>{o()})}const TY=(e,t,r,a,n,i)=>{var l=bY(e,t);return r.isStepper===!0?SY(e,t,r,l,n,i):EY(e,t,r,a,l,n,i)};var Iu=1e-4,_A=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],kA=(e,t)=>e.map((r,a)=>r*t**a).reduce((r,a)=>r+a),Sw=(e,t)=>r=>{var a=_A(e,t);return kA(a,r)},CY=(e,t)=>r=>{var a=_A(e,t),n=[...a.map((i,l)=>i*l).slice(1),0];return kA(n,r)},Ew=function(){for(var t,r,a,n,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];if(l.length===1)switch(l[0]){case"linear":[t,a,r,n]=[0,0,1,1];break;case"ease":[t,a,r,n]=[.25,.1,.25,1];break;case"ease-in":[t,a,r,n]=[.42,0,1,1];break;case"ease-out":[t,a,r,n]=[.42,0,.58,1];break;case"ease-in-out":[t,a,r,n]=[0,0,.58,1];break;default:{var c=l[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,a,r,n]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else l.length===4&&([t,a,r,n]=l);var u=Sw(t,r),d=Sw(a,n),m=CY(t,r),f=x=>x>1?1:x<0?0:x,h=x=>{for(var p=x>1?1:x,g=p,j=0;j<8;++j){var w=u(g)-p,y=m(g);if(Math.abs(w-p)<Iu||y<Iu)return d(g);g=f(g-w/y)}return d(g)};return h.isStepper=!1,h},AY=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:a=8,dt:n=17}=t,i=(l,o,c)=>{var u=-(l-o)*r,d=c*a,m=c+(u-d)*n/1e3,f=c*n/1e3+l;return Math.abs(f-o)<Iu&&Math.abs(m)<Iu?[o,0]:[f,m]};return i.isStepper=!0,i.dt=n,i},_Y=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Ew(e);case"spring":return AY();default:if(e.split("(")[0]==="cubic-bezier")return Ew(e)}return typeof e=="function"?e:null};function kY(e){var t,r=()=>null,a=!1,n=null,i=l=>{if(!a){if(Array.isArray(l)){if(!l.length)return;var o=l,[c,...u]=o;if(typeof c=="number"){n=e.setTimeout(i.bind(null,u),c);return}i(c),n=e.setTimeout(i.bind(null,u));return}typeof l=="string"&&(t=l,r(t)),typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{a=!0},start:l=>{a=!1,n&&(n(),n=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}class IY{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),n=null,i=l=>{l-a>=r?t(l):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{cancelAnimationFrame(n)}}}function DY(){return kY(new IY)}var PY=v.createContext(DY);function OY(e,t){var r=v.useContext(PY);return v.useMemo(()=>t??r(e),[e,t,r])}var RY={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Tw={t:0},Ch={t:1};function Pm(e){var t=qs(e,RY),{isActive:r,canBegin:a,duration:n,easing:i,begin:l,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=OY(t.animationId,t.animationManager),[m,f]=v.useState(r?Tw:Ch),h=v.useRef(null);return v.useEffect(()=>{r||f(Ch)},[r]),v.useEffect(()=>{if(!r||!a)return pY;var x=TY(Tw,Ch,_Y(i),n,f,d.getTimeoutController()),p=()=>{h.current=x()};return d.start([c,l,p,n,o]),()=>{d.stop(),h.current&&h.current(),o()}},[r,a,n,i,l,c,o,d]),u(m.t)}function Om(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(vc(t)),a=v.useRef(e);return a.current!==e&&(r.current=vc(t),a.current=e),r.current}function Cw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Aw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cw(Object(r),!0).forEach(function(a){FY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function FY(e,t,r){return(t=LY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LY(e){var t=MY(e,"string");return typeof t=="symbol"?t:t+""}function MY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Du(){return Du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Du.apply(null,arguments)}var _w=(e,t,r,a,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(a)/2),l=a>=0?1:-1,o=r>=0?1:-1,c=a>=0&&r>=0||a<0&&r<0?1:0,u;if(i>0&&n instanceof Array){for(var d=[0,0,0,0],m=0,f=4;m<f;m++)d[m]=n[m]>i?i:n[m];u="M".concat(e,",").concat(t+l*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+l*d[1])),u+="L ".concat(e+r,",").concat(t+a-l*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+a)),u+="L ".concat(e+o*d[3],",").concat(t+a),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+a-l*d[3])),u+="Z"}else if(i>0&&n===+n&&n>0){var h=Math.min(i,n);u="M ".concat(e,",").concat(t+l*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+o*h,",").concat(t,`
            L `).concat(e+r-o*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+l*h,`
            L `).concat(e+r,",").concat(t+a-l*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-o*h,",").concat(t+a,`
            L `).concat(e+o*h,",").concat(t+a,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+a-l*h," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return u},BY={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},IA=e=>{var t=qs(e,BY),r=v.useRef(null),[a,n]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var G=r.current.getTotalLength();G&&n(G)}catch{}},[]);var{x:i,y:l,width:o,height:c,radius:u,className:d}=t,{animationEasing:m,animationDuration:f,animationBegin:h,isAnimationActive:x,isUpdateAnimationActive:p}=t,g=v.useRef(o),j=v.useRef(c),w=v.useRef(i),y=v.useRef(l),b=v.useMemo(()=>({x:i,y:l,width:o,height:c,radius:u}),[i,l,o,c,u]),S=Om(b,"rectangle-");if(i!==+i||l!==+l||o!==+o||c!==+c||o===0||c===0)return null;var E=zt("recharts-rectangle",d);if(!p)return v.createElement("path",Du({},es(t,!0),{className:E,d:_w(i,l,o,c,u)}));var N=g.current,T=j.current,k=w.current,I=y.current,D="0px ".concat(a===-1?1:a,"px"),A="".concat(a,"px 0px"),M=CA(["strokeDasharray"],f,typeof m=="string"?m:void 0);return v.createElement(Pm,{animationId:S,key:S,canBegin:a>0,duration:f,easing:m,isActive:p,begin:h},G=>{var q=ys(N,o,G),z=ys(T,c,G),ee=ys(k,i,G),U=ys(I,l,G);r.current&&(g.current=q,j.current=z,w.current=ee,y.current=U);var X;return x?G>0?X={transition:M,strokeDasharray:A}:X={strokeDasharray:D}:X={strokeDasharray:A},v.createElement("path",Du({},es(t,!0),{className:E,d:_w(ee,U,q,z,u),ref:r,style:Aw(Aw({},X),t.style)}))})};function DA(e){var{cx:t,cy:r,radius:a,startAngle:n,endAngle:i}=e,l=qr(t,r,a,n),o=qr(t,r,a,i);return{points:[l,o],cx:t,cy:r,radius:a,startAngle:n,endAngle:i}}function Nx(){return Nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Nx.apply(null,arguments)}var zY=(e,t)=>{var r=cs(t-e),a=Math.min(Math.abs(t-e),359.999);return r*a},Fd=e=>{var{cx:t,cy:r,radius:a,angle:n,sign:i,isExternal:l,cornerRadius:o,cornerIsExternal:c}=e,u=o*(l?1:-1)+a,d=Math.asin(o/u)/_u,m=c?n:n+i*d,f=qr(t,r,u,m),h=qr(t,r,a,m),x=c?n-i*d:n,p=qr(t,r,u*Math.cos(d*_u),x);return{center:f,circleTangency:h,lineTangency:p,theta:d}},PA=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:i,endAngle:l}=e,o=zY(i,l),c=i+o,u=qr(t,r,n,i),d=qr(t,r,n,c),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var f=qr(t,r,a,i),h=qr(t,r,a,c);m+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},$Y=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=cs(u-c),{circleTangency:m,lineTangency:f,theta:h}=Fd({cx:t,cy:r,radius:n,angle:c,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:x,lineTangency:p,theta:g}=Fd({cx:t,cy:r,radius:n,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:o}),j=o?Math.abs(c-u):Math.abs(c-u)-h-g;if(j<0)return l?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):PA({cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:c,endAngle:u});var w="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
  `);if(a>0){var{circleTangency:y,lineTangency:b,theta:S}=Fd({cx:t,cy:r,radius:a,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:E,lineTangency:N,theta:T}=Fd({cx:t,cy:r,radius:a,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),k=o?Math.abs(c-u):Math.abs(c-u)-S-T;if(k<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+="L".concat(N.x,",").concat(N.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(k>180),",").concat(+(d>0),",").concat(y.x,",").concat(y.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,"Z")}else w+="L".concat(t,",").concat(r,"Z");return w},UY={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},OA=e=>{var t=qs(e,UY),{cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:m}=t;if(i<n||u===d)return null;var f=zt("recharts-sector",m),h=i-n,x=Ps(l,h,0,!0),p;return x>0&&Math.abs(u-d)<360?p=$Y({cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:Math.min(x,h/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):p=PA({cx:r,cy:a,innerRadius:n,outerRadius:i,startAngle:u,endAngle:d}),v.createElement("path",Nx({},es(t,!0),{className:f,d:p}))};function WY(e,t,r){var a,n,i,l;if(e==="horizontal")a=t.x,i=a,n=r.top,l=r.top+r.height;else if(e==="vertical")n=t.y,l=n,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:m}=t,f=qr(o,c,u,m),h=qr(o,c,d,m);a=f.x,n=f.y,i=h.x,l=h.y}else return DA(t);return[{x:a,y:n},{x:i,y:l}]}var Ah={},_h={},kh={},kw;function HY(){return kw||(kw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zC();function r(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=r})(kh)),kh}var Iw;function VY(){return Iw||(Iw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HY();function r(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=r})(_h)),_h}var Dw;function GY(){return Dw||(Dw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$C(),r=VY();function a(n,i,l){l&&typeof l!="number"&&t.isIterateeCall(n,i,l)&&(i=l=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),l=l===void 0?n<i?1:-1:r.toFinite(l);const o=Math.max(Math.ceil((i-n)/(l||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=n,n+=l;return c}e.range=a})(Ah)),Ah}var Ih,Pw;function qY(){return Pw||(Pw=1,Ih=GY().range),Ih}var KY=qY();const RA=gi(KY);function li(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function YY(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ev(e){let t,r,a;e.length!==2?(t=li,r=(o,c)=>li(e(o),c),a=(o,c)=>e(o)-c):(t=e===li||e===YY?e:XY,r=e,a=e);function n(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(o[m],c)<0?u=m+1:d=m}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(o[m],c)<=0?u=m+1:d=m}while(u<d)}return u}function l(o,c,u=0,d=o.length){const m=n(o,c,u,d-1);return m>u&&a(o[m-1],c)>-a(o[m],c)?m-1:m}return{left:n,center:l,right:i}}function XY(){return 0}function FA(e){return e===null?NaN:+e}function*JY(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const ZY=Ev(li),Xc=ZY.right;Ev(FA).center;class Ow extends Map{constructor(t,r=tX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,n]of t)this.set(a,n)}get(t){return super.get(Rw(this,t))}has(t){return super.has(Rw(this,t))}set(t,r){return super.set(QY(this,t),r)}delete(t){return super.delete(eX(this,t))}}function Rw({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function QY({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function eX({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function tX(e){return e!==null&&typeof e=="object"?e.valueOf():e}function rX(e=li){if(e===li)return LA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function LA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const sX=Math.sqrt(50),aX=Math.sqrt(10),nX=Math.sqrt(2);function Pu(e,t,r){const a=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(a)),i=a/Math.pow(10,n),l=i>=sX?10:i>=aX?5:i>=nX?2:1;let o,c,u;return n<0?(u=Math.pow(10,-n)/l,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,n)*l,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Pu(e,t,r*2):[o,c,u]}function Sx(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[n,i,l]=a?Pu(t,e,r):Pu(e,t,r);if(!(i>=n))return[];const o=i-n+1,c=new Array(o);if(a)if(l<0)for(let u=0;u<o;++u)c[u]=(i-u)/-l;else for(let u=0;u<o;++u)c[u]=(i-u)*l;else if(l<0)for(let u=0;u<o;++u)c[u]=(n+u)/-l;else for(let u=0;u<o;++u)c[u]=(n+u)*l;return c}function Ex(e,t,r){return t=+t,e=+e,r=+r,Pu(e,t,r)[2]}function Tx(e,t,r){t=+t,e=+e,r=+r;const a=t<e,n=a?Ex(t,e,r):Ex(e,t,r);return(a?-1:1)*(n<0?1/-n:n)}function Fw(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function Lw(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function MA(e,t,r=0,a=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(n=n===void 0?LA:rX(n);a>r;){if(a-r>600){const c=a-r+1,u=t-r+1,d=Math.log(c),m=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*m*(c-m)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*m/c+f)),x=Math.min(a,Math.floor(t+(c-u)*m/c+f));MA(e,t,h,x,n)}const i=e[t];let l=r,o=a;for(ko(e,r,t),n(e[a],i)>0&&ko(e,r,a);l<o;){for(ko(e,l,o),++l,--o;n(e[l],i)<0;)++l;for(;n(e[o],i)>0;)--o}n(e[r],i)===0?ko(e,r,o):(++o,ko(e,o,a)),o<=t&&(r=o+1),t<=o&&(a=o-1)}return e}function ko(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function iX(e,t,r){if(e=Float64Array.from(JY(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return Lw(e);if(t>=1)return Fw(e);var a,n=(a-1)*t,i=Math.floor(n),l=Fw(MA(e,i).subarray(0,i+1)),o=Lw(e.subarray(i+1));return l+(o-l)*(n-i)}}function lX(e,t,r=FA){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,n=(a-1)*t,i=Math.floor(n),l=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return l+(o-l)*(n-i)}}function oX(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var a=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++a<n;)i[a]=e+a*r;return i}function Ga(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gn(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Cx=Symbol("implicit");function Tv(){var e=new Ow,t=[],r=[],a=Cx;function n(i){let l=e.get(i);if(l===void 0){if(a!==Cx)return a;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Ow;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return Tv(t,r).unknown(a)},Ga.apply(n,arguments),n}function Cv(){var e=Tv().unknown(void 0),t=e.domain,r=e.range,a=0,n=1,i,l,o=!1,c=0,u=0,d=.5;delete e.unknown;function m(){var f=t().length,h=n<a,x=h?n:a,p=h?a:n;i=(p-x)/Math.max(1,f-c+u*2),o&&(i=Math.floor(i)),x+=(p-x-i*(f-c))*d,l=i*(1-c),o&&(x=Math.round(x),l=Math.round(l));var g=oX(f).map(function(j){return x+i*j});return r(h?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),m()):t()},e.range=function(f){return arguments.length?([a,n]=f,a=+a,n=+n,m()):[a,n]},e.rangeRound=function(f){return[a,n]=f,a=+a,n=+n,o=!0,m()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,m()):o},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),m()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),m()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,m()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),m()):d},e.copy=function(){return Cv(t(),[a,n]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ga.apply(m(),arguments)}function BA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return BA(t())},e}function cX(){return BA(Cv.apply(null,arguments).paddingInner(1))}function Av(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function zA(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function Jc(){}var wc=.7,Ou=1/wc,$l="\\s*([+-]?\\d+)\\s*",Nc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dX=/^#([0-9a-f]{3,8})$/,uX=new RegExp(`^rgb\\(${$l},${$l},${$l}\\)$`),mX=new RegExp(`^rgb\\(${gn},${gn},${gn}\\)$`),fX=new RegExp(`^rgba\\(${$l},${$l},${$l},${Nc}\\)$`),hX=new RegExp(`^rgba\\(${gn},${gn},${gn},${Nc}\\)$`),pX=new RegExp(`^hsl\\(${Nc},${gn},${gn}\\)$`),xX=new RegExp(`^hsla\\(${Nc},${gn},${gn},${Nc}\\)$`),Mw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Av(Jc,Sc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Bw,formatHex:Bw,formatHex8:gX,formatHsl:vX,formatRgb:zw,toString:zw});function Bw(){return this.rgb().formatHex()}function gX(){return this.rgb().formatHex8()}function vX(){return $A(this).formatHsl()}function zw(){return this.rgb().formatRgb()}function Sc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=dX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?$w(t):r===3?new Js(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ld(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ld(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uX.exec(e))?new Js(t[1],t[2],t[3],1):(t=mX.exec(e))?new Js(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fX.exec(e))?Ld(t[1],t[2],t[3],t[4]):(t=hX.exec(e))?Ld(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=pX.exec(e))?Hw(t[1],t[2]/100,t[3]/100,1):(t=xX.exec(e))?Hw(t[1],t[2]/100,t[3]/100,t[4]):Mw.hasOwnProperty(e)?$w(Mw[e]):e==="transparent"?new Js(NaN,NaN,NaN,0):null}function $w(e){return new Js(e>>16&255,e>>8&255,e&255,1)}function Ld(e,t,r,a){return a<=0&&(e=t=r=NaN),new Js(e,t,r,a)}function yX(e){return e instanceof Jc||(e=Sc(e)),e?(e=e.rgb(),new Js(e.r,e.g,e.b,e.opacity)):new Js}function Ax(e,t,r,a){return arguments.length===1?yX(e):new Js(e,t,r,a??1)}function Js(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}Av(Js,Ax,zA(Jc,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new Js(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?wc:Math.pow(wc,e),new Js(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Js(Wi(this.r),Wi(this.g),Wi(this.b),Ru(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Uw,formatHex:Uw,formatHex8:bX,formatRgb:Ww,toString:Ww}));function Uw(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}`}function bX(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}${Pi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ww(){const e=Ru(this.opacity);return`${e===1?"rgb(":"rgba("}${Wi(this.r)}, ${Wi(this.g)}, ${Wi(this.b)}${e===1?")":`, ${e})`}`}function Ru(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pi(e){return e=Wi(e),(e<16?"0":"")+e.toString(16)}function Hw(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Za(e,t,r,a)}function $A(e){if(e instanceof Za)return new Za(e.h,e.s,e.l,e.opacity);if(e instanceof Jc||(e=Sc(e)),!e)return new Za;if(e instanceof Za)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,n=Math.min(t,r,a),i=Math.max(t,r,a),l=NaN,o=i-n,c=(i+n)/2;return o?(t===i?l=(r-a)/o+(r<a)*6:r===i?l=(a-t)/o+2:l=(t-r)/o+4,o/=c<.5?i+n:2-i-n,l*=60):o=c>0&&c<1?0:l,new Za(l,o,c,e.opacity)}function jX(e,t,r,a){return arguments.length===1?$A(e):new Za(e,t,r,a??1)}function Za(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}Av(Za,jX,zA(Jc,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new Za(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?wc:Math.pow(wc,e),new Za(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,n=2*r-a;return new Js(Dh(e>=240?e-240:e+120,n,a),Dh(e,n,a),Dh(e<120?e+240:e-120,n,a),this.opacity)},clamp(){return new Za(Vw(this.h),Md(this.s),Md(this.l),Ru(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ru(this.opacity);return`${e===1?"hsl(":"hsla("}${Vw(this.h)}, ${Md(this.s)*100}%, ${Md(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Vw(e){return e=(e||0)%360,e<0?e+360:e}function Md(e){return Math.max(0,Math.min(1,e||0))}function Dh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _v=e=>()=>e;function wX(e,t){return function(r){return e+r*t}}function NX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function SX(e){return(e=+e)==1?UA:function(t,r){return r-t?NX(t,r,e):_v(isNaN(t)?r:t)}}function UA(e,t){var r=t-e;return r?wX(e,r):_v(isNaN(e)?t:e)}const Gw=(function e(t){var r=SX(t);function a(n,i){var l=r((n=Ax(n)).r,(i=Ax(i)).r),o=r(n.g,i.g),c=r(n.b,i.b),u=UA(n.opacity,i.opacity);return function(d){return n.r=l(d),n.g=o(d),n.b=c(d),n.opacity=u(d),n+""}}return a.gamma=e,a})(1);function EX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),n;return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function TX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function CX(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,n=new Array(a),i=new Array(r),l;for(l=0;l<a;++l)n[l]=mo(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(o){for(l=0;l<a;++l)i[l]=n[l](o);return i}}function AX(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function Fu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _X(e,t){var r={},a={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=mo(e[n],t[n]):a[n]=t[n];return function(i){for(n in r)a[n]=r[n](i);return a}}var _x=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ph=new RegExp(_x.source,"g");function kX(e){return function(){return e}}function IX(e){return function(t){return e(t)+""}}function DX(e,t){var r=_x.lastIndex=Ph.lastIndex=0,a,n,i,l=-1,o=[],c=[];for(e=e+"",t=t+"";(a=_x.exec(e))&&(n=Ph.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),o[l]?o[l]+=i:o[++l]=i),(a=a[0])===(n=n[0])?o[l]?o[l]+=n:o[++l]=n:(o[++l]=null,c.push({i:l,x:Fu(a,n)})),r=Ph.lastIndex;return r<t.length&&(i=t.slice(r),o[l]?o[l]+=i:o[++l]=i),o.length<2?c[0]?IX(c[0].x):kX(t):(t=c.length,function(u){for(var d=0,m;d<t;++d)o[(m=c[d]).i]=m.x(u);return o.join("")})}function mo(e,t){var r=typeof t,a;return t==null||r==="boolean"?_v(t):(r==="number"?Fu:r==="string"?(a=Sc(t))?(t=a,Gw):DX:t instanceof Sc?Gw:t instanceof Date?AX:TX(t)?EX:Array.isArray(t)?CX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_X:Fu)(e,t)}function kv(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function PX(e,t){t===void 0&&(t=e,e=mo);for(var r=0,a=t.length-1,n=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(n,n=t[++r]);return function(l){var o=Math.max(0,Math.min(a-1,Math.floor(l*=a)));return i[o](l-o)}}function OX(e){return function(){return e}}function Lu(e){return+e}var qw=[0,1];function Us(e){return e}function kx(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:OX(isNaN(t)?NaN:.5)}function RX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function FX(e,t,r){var a=e[0],n=e[1],i=t[0],l=t[1];return n<a?(a=kx(n,a),i=r(l,i)):(a=kx(a,n),i=r(i,l)),function(o){return i(a(o))}}function LX(e,t,r){var a=Math.min(e.length,t.length)-1,n=new Array(a),i=new Array(a),l=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<a;)n[l]=kx(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(o){var c=Xc(e,o,1,a)-1;return i[c](n[c](o))}}function Zc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Rm(){var e=qw,t=qw,r=mo,a,n,i,l=Us,o,c,u;function d(){var f=Math.min(e.length,t.length);return l!==Us&&(l=RX(e[0],e[f-1])),o=f>2?LX:FX,c=u=null,m}function m(f){return f==null||isNaN(f=+f)?i:(c||(c=o(e.map(a),t,r)))(a(l(f)))}return m.invert=function(f){return l(n((u||(u=o(t,e.map(a),Fu)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,Lu),d()):e.slice()},m.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},m.rangeRound=function(f){return t=Array.from(f),r=kv,d()},m.clamp=function(f){return arguments.length?(l=f?!0:Us,d()):l!==Us},m.interpolate=function(f){return arguments.length?(r=f,d()):r},m.unknown=function(f){return arguments.length?(i=f,m):i},function(f,h){return a=f,n=h,d()}}function Iv(){return Rm()(Us,Us)}function MX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Mu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function Zl(e){return e=Mu(Math.abs(e)),e?e[1]:NaN}function BX(e,t){return function(r,a){for(var n=r.length,i=[],l=0,o=e[0],c=0;n>0&&o>0&&(c+o+1>a&&(o=Math.max(1,a-c)),i.push(r.substring(n-=o,n+o)),!((c+=o+1)>a));)o=e[l=(l+1)%e.length];return i.reverse().join(t)}}function zX(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var $X=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ec(e){if(!(t=$X.exec(e)))throw new Error("invalid format: "+e);var t;return new Dv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ec.prototype=Dv.prototype;function Dv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function UX(e){e:for(var t=e.length,r=1,a=-1,n;r<t;++r)switch(e[r]){case".":a=n=r;break;case"0":a===0&&(a=r),n=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(n+1):e}var WA;function WX(e,t){var r=Mu(e,t);if(!r)return e+"";var a=r[0],n=r[1],i=n-(WA=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,l=a.length;return i===l?a:i>l?a+new Array(i-l+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Mu(e,Math.max(0,t+i-1))[0]}function Kw(e,t){var r=Mu(e,t);if(!r)return e+"";var a=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+a:a.length>n+1?a.slice(0,n+1)+"."+a.slice(n+1):a+new Array(n-a.length+2).join("0")}const Yw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:MX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Kw(e*100,t),r:Kw,s:WX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Xw(e){return e}var Jw=Array.prototype.map,Zw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function HX(e){var t=e.grouping===void 0||e.thousands===void 0?Xw:BX(Jw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Xw:zX(Jw.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(m){m=Ec(m);var f=m.fill,h=m.align,x=m.sign,p=m.symbol,g=m.zero,j=m.width,w=m.comma,y=m.precision,b=m.trim,S=m.type;S==="n"?(w=!0,S="g"):Yw[S]||(y===void 0&&(y=12),b=!0,S="g"),(g||f==="0"&&h==="=")&&(g=!0,f="0",h="=");var E=p==="$"?r:p==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",N=p==="$"?a:/[%p]/.test(S)?l:"",T=Yw[S],k=/[defgprs%]/.test(S);y=y===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function I(D){var A=E,M=N,G,q,z;if(S==="c")M=T(D)+M,D="";else{D=+D;var ee=D<0||1/D<0;if(D=isNaN(D)?c:T(Math.abs(D),y),b&&(D=UX(D)),ee&&+D==0&&x!=="+"&&(ee=!1),A=(ee?x==="("?x:o:x==="-"||x==="("?"":x)+A,M=(S==="s"?Zw[8+WA/3]:"")+M+(ee&&x==="("?")":""),k){for(G=-1,q=D.length;++G<q;)if(z=D.charCodeAt(G),48>z||z>57){M=(z===46?n+D.slice(G+1):D.slice(G))+M,D=D.slice(0,G);break}}}w&&!g&&(D=t(D,1/0));var U=A.length+D.length+M.length,X=U<j?new Array(j-U+1).join(f):"";switch(w&&g&&(D=t(X+D,X.length?j-M.length:1/0),X=""),h){case"<":D=A+D+M+X;break;case"=":D=A+X+D+M;break;case"^":D=X.slice(0,U=X.length>>1)+A+D+M+X.slice(U);break;default:D=X+A+D+M;break}return i(D)}return I.toString=function(){return m+""},I}function d(m,f){var h=u((m=Ec(m),m.type="f",m)),x=Math.max(-8,Math.min(8,Math.floor(Zl(f)/3)))*3,p=Math.pow(10,-x),g=Zw[8+x/3];return function(j){return h(p*j)+g}}return{format:u,formatPrefix:d}}var Bd,Pv,HA;VX({thousands:",",grouping:[3],currency:["$",""]});function VX(e){return Bd=HX(e),Pv=Bd.format,HA=Bd.formatPrefix,Bd}function GX(e){return Math.max(0,-Zl(Math.abs(e)))}function qX(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zl(t)/3)))*3-Zl(Math.abs(e)))}function KX(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zl(t)-Zl(e))+1}function VA(e,t,r,a){var n=Tx(e,t,r),i;switch(a=Ec(a??",f"),a.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=qX(n,l))&&(a.precision=i),HA(a,l)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=KX(n,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=GX(n))&&(a.precision=i-(a.type==="%")*2);break}}return Pv(a)}function wi(e){var t=e.domain;return e.ticks=function(r){var a=t();return Sx(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var n=t();return VA(n[0],n[n.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),n=0,i=a.length-1,l=a[n],o=a[i],c,u,d=10;for(o<l&&(u=l,l=o,o=u,u=n,n=i,i=u);d-- >0;){if(u=Ex(l,o,r),u===c)return a[n]=l,a[i]=o,t(a);if(u>0)l=Math.floor(l/u)*u,o=Math.ceil(o/u)*u;else if(u<0)l=Math.ceil(l*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function GA(){var e=Iv();return e.copy=function(){return Zc(e,GA())},Ga.apply(e,arguments),wi(e)}function qA(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Lu),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return qA(e).unknown(t)},e=arguments.length?Array.from(e,Lu):[0,1],wi(r)}function KA(e,t){e=e.slice();var r=0,a=e.length-1,n=e[r],i=e[a],l;return i<n&&(l=r,r=a,a=l,l=n,n=i,i=l),e[r]=t.floor(n),e[a]=t.ceil(i),e}function Qw(e){return Math.log(e)}function eN(e){return Math.exp(e)}function YX(e){return-Math.log(-e)}function XX(e){return-Math.exp(-e)}function JX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ZX(e){return e===10?JX:e===Math.E?Math.exp:t=>Math.pow(e,t)}function QX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function tN(e){return(t,r)=>-e(-t,r)}function Ov(e){const t=e(Qw,eN),r=t.domain;let a=10,n,i;function l(){return n=QX(a),i=ZX(a),r()[0]<0?(n=tN(n),i=tN(i),e(YX,XX)):e(Qw,eN),t}return t.base=function(o){return arguments.length?(a=+o,l()):a},t.domain=function(o){return arguments.length?(r(o),l()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const m=d<u;m&&([u,d]=[d,u]);let f=n(u),h=n(d),x,p;const g=o==null?10:+o;let j=[];if(!(a%1)&&h-f<g){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(x=1;x<a;++x)if(p=f<0?x/i(-f):x*i(f),!(p<u)){if(p>d)break;j.push(p)}}else for(;f<=h;++f)for(x=a-1;x>=1;--x)if(p=f>0?x/i(-f):x*i(f),!(p<u)){if(p>d)break;j.push(p)}j.length*2<g&&(j=Sx(u,d,g))}else j=Sx(f,h,Math.min(h-f,g)).map(i);return m?j.reverse():j},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=Ec(c)).precision==null&&(c.trim=!0),c=Pv(c)),o===1/0)return c;const u=Math.max(1,a*o/t.ticks().length);return d=>{let m=d/i(Math.round(n(d)));return m*a<a-.5&&(m*=a),m<=u?c(d):""}},t.nice=()=>r(KA(r(),{floor:o=>i(Math.floor(n(o))),ceil:o=>i(Math.ceil(n(o)))})),t}function YA(){const e=Ov(Rm()).domain([1,10]);return e.copy=()=>Zc(e,YA()).base(e.base()),Ga.apply(e,arguments),e}function rN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function sN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Rv(e){var t=1,r=e(rN(t),sN(t));return r.constant=function(a){return arguments.length?e(rN(t=+a),sN(t)):t},wi(r)}function XA(){var e=Rv(Rm());return e.copy=function(){return Zc(e,XA()).constant(e.constant())},Ga.apply(e,arguments)}function aN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function eJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function tJ(e){return e<0?-e*e:e*e}function Fv(e){var t=e(Us,Us),r=1;function a(){return r===1?e(Us,Us):r===.5?e(eJ,tJ):e(aN(r),aN(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,a()):r},wi(t)}function Lv(){var e=Fv(Rm());return e.copy=function(){return Zc(e,Lv()).exponent(e.exponent())},Ga.apply(e,arguments),e}function rJ(){return Lv.apply(null,arguments).exponent(.5)}function nN(e){return Math.sign(e)*e*e}function sJ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function JA(){var e=Iv(),t=[0,1],r=!1,a;function n(i){var l=sJ(e(i));return isNaN(l)?a:r?Math.round(l):l}return n.invert=function(i){return e.invert(nN(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,Lu)).map(nN)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return JA(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Ga.apply(n,arguments),wi(n)}function ZA(){var e=[],t=[],r=[],a;function n(){var l=0,o=Math.max(1,t.length);for(r=new Array(o-1);++l<o;)r[l-1]=lX(e,l/o);return i}function i(l){return l==null||isNaN(l=+l)?a:t[Xc(r,l)]}return i.invertExtent=function(l){var o=t.indexOf(l);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let o of l)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(li),n()},i.range=function(l){return arguments.length?(t=Array.from(l),n()):t.slice()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return ZA().domain(e).range(t).unknown(a)},Ga.apply(i,arguments)}function QA(){var e=0,t=1,r=1,a=[.5],n=[0,1],i;function l(c){return c!=null&&c<=c?n[Xc(a,c,0,r)]:i}function o(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return l}return l.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},l.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,o()):n.slice()},l.invertExtent=function(c){var u=n.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,a[0]]:u>=r?[a[r-1],t]:[a[u-1],a[u]]},l.unknown=function(c){return arguments.length&&(i=c),l},l.thresholds=function(){return a.slice()},l.copy=function(){return QA().domain([e,t]).range(n).unknown(i)},Ga.apply(wi(l),arguments)}function e_(){var e=[.5],t=[0,1],r,a=1;function n(i){return i!=null&&i<=i?t[Xc(e,i,0,a)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return e_().domain(e).range(t).unknown(r)},Ga.apply(n,arguments)}const Oh=new Date,Rh=new Date;function ss(e,t,r,a){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const l=n(i),o=n.ceil(i);return i-l<o-i?l:o},n.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),n.range=(i,l,o)=>{const c=[];if(i=n.ceil(i),o=o==null?1:Math.floor(o),!(i<l)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<l);return c},n.filter=i=>ss(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;t(l,-1),!i(l););else for(;--o>=0;)for(;t(l,1),!i(l););}),r&&(n.count=(i,l)=>(Oh.setTime(+i),Rh.setTime(+l),e(Oh),e(Rh),Math.floor(r(Oh,Rh))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(a?l=>a(l)%i===0:l=>n.count(0,l)%i===0):n)),n}const Bu=ss(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Bu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ss(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Bu);Bu.range;const Cn=1e3,Ba=Cn*60,An=Ba*60,Mn=An*24,Mv=Mn*7,iN=Mn*30,Fh=Mn*365,Oi=ss(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Cn)},(e,t)=>(t-e)/Cn,e=>e.getUTCSeconds());Oi.range;const Bv=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cn)},(e,t)=>{e.setTime(+e+t*Ba)},(e,t)=>(t-e)/Ba,e=>e.getMinutes());Bv.range;const zv=ss(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ba)},(e,t)=>(t-e)/Ba,e=>e.getUTCMinutes());zv.range;const $v=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cn-e.getMinutes()*Ba)},(e,t)=>{e.setTime(+e+t*An)},(e,t)=>(t-e)/An,e=>e.getHours());$v.range;const Uv=ss(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*An)},(e,t)=>(t-e)/An,e=>e.getUTCHours());Uv.range;const Qc=ss(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ba)/Mn,e=>e.getDate()-1);Qc.range;const Fm=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mn,e=>e.getUTCDate()-1);Fm.range;const t_=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mn,e=>Math.floor(e/Mn));t_.range;function xl(e){return ss(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ba)/Mv)}const Lm=xl(0),zu=xl(1),aJ=xl(2),nJ=xl(3),Ql=xl(4),iJ=xl(5),lJ=xl(6);Lm.range;zu.range;aJ.range;nJ.range;Ql.range;iJ.range;lJ.range;function gl(e){return ss(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Mv)}const Mm=gl(0),$u=gl(1),oJ=gl(2),cJ=gl(3),eo=gl(4),dJ=gl(5),uJ=gl(6);Mm.range;$u.range;oJ.range;cJ.range;eo.range;dJ.range;uJ.range;const Wv=ss(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Wv.range;const Hv=ss(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Hv.range;const Bn=ss(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Bn.range;const zn=ss(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});zn.range;function r_(e,t,r,a,n,i){const l=[[Oi,1,Cn],[Oi,5,5*Cn],[Oi,15,15*Cn],[Oi,30,30*Cn],[i,1,Ba],[i,5,5*Ba],[i,15,15*Ba],[i,30,30*Ba],[n,1,An],[n,3,3*An],[n,6,6*An],[n,12,12*An],[a,1,Mn],[a,2,2*Mn],[r,1,Mv],[t,1,iN],[t,3,3*iN],[e,1,Fh]];function o(u,d,m){const f=d<u;f&&([u,d]=[d,u]);const h=m&&typeof m.range=="function"?m:c(u,d,m),x=h?h.range(u,+d+1):[];return f?x.reverse():x}function c(u,d,m){const f=Math.abs(d-u)/m,h=Ev(([,,g])=>g).right(l,f);if(h===l.length)return e.every(Tx(u/Fh,d/Fh,m));if(h===0)return Bu.every(Math.max(Tx(u,d,m),1));const[x,p]=l[f/l[h-1][2]<l[h][2]/f?h-1:h];return x.every(p)}return[o,c]}const[mJ,fJ]=r_(zn,Hv,Mm,t_,Uv,zv),[hJ,pJ]=r_(Bn,Wv,Lm,Qc,$v,Bv);function Lh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Mh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Io(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function xJ(e){var t=e.dateTime,r=e.date,a=e.time,n=e.periods,i=e.days,l=e.shortDays,o=e.months,c=e.shortMonths,u=Do(n),d=Po(n),m=Do(i),f=Po(i),h=Do(l),x=Po(l),p=Do(o),g=Po(o),j=Do(c),w=Po(c),y={a:ee,A:U,b:X,B:oe,c:null,d:mN,e:mN,f:BJ,g:YJ,G:JJ,H:FJ,I:LJ,j:MJ,L:s_,m:zJ,M:$J,p:Ee,q:F,Q:pN,s:xN,S:UJ,u:WJ,U:HJ,V:VJ,w:GJ,W:qJ,x:null,X:null,y:KJ,Y:XJ,Z:ZJ,"%":hN},b={a:P,A:C,b:W,B:Z,c:null,d:fN,e:fN,f:rZ,g:mZ,G:hZ,H:QJ,I:eZ,j:tZ,L:n_,m:sZ,M:aZ,p:J,q:le,Q:pN,s:xN,S:nZ,u:iZ,U:lZ,V:oZ,w:cZ,W:dZ,x:null,X:null,y:uZ,Y:fZ,Z:pZ,"%":hN},S={a:I,A:D,b:A,B:M,c:G,d:dN,e:dN,f:DJ,g:cN,G:oN,H:uN,I:uN,j:AJ,L:IJ,m:CJ,M:_J,p:k,q:TJ,Q:OJ,s:RJ,S:kJ,u:jJ,U:wJ,V:NJ,w:bJ,W:SJ,x:q,X:z,y:cN,Y:oN,Z:EJ,"%":PJ};y.x=E(r,y),y.X=E(a,y),y.c=E(t,y),b.x=E(r,b),b.X=E(a,b),b.c=E(t,b);function E(V,re){return function(he){var O=[],ye=-1,de=0,je=V.length,xe,me,$e;for(he instanceof Date||(he=new Date(+he));++ye<je;)V.charCodeAt(ye)===37&&(O.push(V.slice(de,ye)),(me=lN[xe=V.charAt(++ye)])!=null?xe=V.charAt(++ye):me=xe==="e"?" ":"0",($e=re[xe])&&(xe=$e(he,me)),O.push(xe),de=ye+1);return O.push(V.slice(de,ye)),O.join("")}}function N(V,re){return function(he){var O=Io(1900,void 0,1),ye=T(O,V,he+="",0),de,je;if(ye!=he.length)return null;if("Q"in O)return new Date(O.Q);if("s"in O)return new Date(O.s*1e3+("L"in O?O.L:0));if(re&&!("Z"in O)&&(O.Z=0),"p"in O&&(O.H=O.H%12+O.p*12),O.m===void 0&&(O.m="q"in O?O.q:0),"V"in O){if(O.V<1||O.V>53)return null;"w"in O||(O.w=1),"Z"in O?(de=Mh(Io(O.y,0,1)),je=de.getUTCDay(),de=je>4||je===0?$u.ceil(de):$u(de),de=Fm.offset(de,(O.V-1)*7),O.y=de.getUTCFullYear(),O.m=de.getUTCMonth(),O.d=de.getUTCDate()+(O.w+6)%7):(de=Lh(Io(O.y,0,1)),je=de.getDay(),de=je>4||je===0?zu.ceil(de):zu(de),de=Qc.offset(de,(O.V-1)*7),O.y=de.getFullYear(),O.m=de.getMonth(),O.d=de.getDate()+(O.w+6)%7)}else("W"in O||"U"in O)&&("w"in O||(O.w="u"in O?O.u%7:"W"in O?1:0),je="Z"in O?Mh(Io(O.y,0,1)).getUTCDay():Lh(Io(O.y,0,1)).getDay(),O.m=0,O.d="W"in O?(O.w+6)%7+O.W*7-(je+5)%7:O.w+O.U*7-(je+6)%7);return"Z"in O?(O.H+=O.Z/100|0,O.M+=O.Z%100,Mh(O)):Lh(O)}}function T(V,re,he,O){for(var ye=0,de=re.length,je=he.length,xe,me;ye<de;){if(O>=je)return-1;if(xe=re.charCodeAt(ye++),xe===37){if(xe=re.charAt(ye++),me=S[xe in lN?re.charAt(ye++):xe],!me||(O=me(V,he,O))<0)return-1}else if(xe!=he.charCodeAt(O++))return-1}return O}function k(V,re,he){var O=u.exec(re.slice(he));return O?(V.p=d.get(O[0].toLowerCase()),he+O[0].length):-1}function I(V,re,he){var O=h.exec(re.slice(he));return O?(V.w=x.get(O[0].toLowerCase()),he+O[0].length):-1}function D(V,re,he){var O=m.exec(re.slice(he));return O?(V.w=f.get(O[0].toLowerCase()),he+O[0].length):-1}function A(V,re,he){var O=j.exec(re.slice(he));return O?(V.m=w.get(O[0].toLowerCase()),he+O[0].length):-1}function M(V,re,he){var O=p.exec(re.slice(he));return O?(V.m=g.get(O[0].toLowerCase()),he+O[0].length):-1}function G(V,re,he){return T(V,t,re,he)}function q(V,re,he){return T(V,r,re,he)}function z(V,re,he){return T(V,a,re,he)}function ee(V){return l[V.getDay()]}function U(V){return i[V.getDay()]}function X(V){return c[V.getMonth()]}function oe(V){return o[V.getMonth()]}function Ee(V){return n[+(V.getHours()>=12)]}function F(V){return 1+~~(V.getMonth()/3)}function P(V){return l[V.getUTCDay()]}function C(V){return i[V.getUTCDay()]}function W(V){return c[V.getUTCMonth()]}function Z(V){return o[V.getUTCMonth()]}function J(V){return n[+(V.getUTCHours()>=12)]}function le(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var re=E(V+="",y);return re.toString=function(){return V},re},parse:function(V){var re=N(V+="",!1);return re.toString=function(){return V},re},utcFormat:function(V){var re=E(V+="",b);return re.toString=function(){return V},re},utcParse:function(V){var re=N(V+="",!0);return re.toString=function(){return V},re}}}var lN={"-":"",_:" ",0:"0"},us=/^\s*\d+/,gJ=/^%/,vJ=/[\\^$*+?|[\]().{}]/g;function Yt(e,t,r){var a=e<0?"-":"",n=(a?-e:e)+"",i=n.length;return a+(i<r?new Array(r-i+1).join(t)+n:n)}function yJ(e){return e.replace(vJ,"\\$&")}function Do(e){return new RegExp("^(?:"+e.map(yJ).join("|")+")","i")}function Po(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function bJ(e,t,r){var a=us.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function jJ(e,t,r){var a=us.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function wJ(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function NJ(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function SJ(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function oN(e,t,r){var a=us.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function cN(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function EJ(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function TJ(e,t,r){var a=us.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function CJ(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function dN(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function AJ(e,t,r){var a=us.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function uN(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function _J(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function kJ(e,t,r){var a=us.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function IJ(e,t,r){var a=us.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function DJ(e,t,r){var a=us.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function PJ(e,t,r){var a=gJ.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function OJ(e,t,r){var a=us.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function RJ(e,t,r){var a=us.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function mN(e,t){return Yt(e.getDate(),t,2)}function FJ(e,t){return Yt(e.getHours(),t,2)}function LJ(e,t){return Yt(e.getHours()%12||12,t,2)}function MJ(e,t){return Yt(1+Qc.count(Bn(e),e),t,3)}function s_(e,t){return Yt(e.getMilliseconds(),t,3)}function BJ(e,t){return s_(e,t)+"000"}function zJ(e,t){return Yt(e.getMonth()+1,t,2)}function $J(e,t){return Yt(e.getMinutes(),t,2)}function UJ(e,t){return Yt(e.getSeconds(),t,2)}function WJ(e){var t=e.getDay();return t===0?7:t}function HJ(e,t){return Yt(Lm.count(Bn(e)-1,e),t,2)}function a_(e){var t=e.getDay();return t>=4||t===0?Ql(e):Ql.ceil(e)}function VJ(e,t){return e=a_(e),Yt(Ql.count(Bn(e),e)+(Bn(e).getDay()===4),t,2)}function GJ(e){return e.getDay()}function qJ(e,t){return Yt(zu.count(Bn(e)-1,e),t,2)}function KJ(e,t){return Yt(e.getFullYear()%100,t,2)}function YJ(e,t){return e=a_(e),Yt(e.getFullYear()%100,t,2)}function XJ(e,t){return Yt(e.getFullYear()%1e4,t,4)}function JJ(e,t){var r=e.getDay();return e=r>=4||r===0?Ql(e):Ql.ceil(e),Yt(e.getFullYear()%1e4,t,4)}function ZJ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Yt(t/60|0,"0",2)+Yt(t%60,"0",2)}function fN(e,t){return Yt(e.getUTCDate(),t,2)}function QJ(e,t){return Yt(e.getUTCHours(),t,2)}function eZ(e,t){return Yt(e.getUTCHours()%12||12,t,2)}function tZ(e,t){return Yt(1+Fm.count(zn(e),e),t,3)}function n_(e,t){return Yt(e.getUTCMilliseconds(),t,3)}function rZ(e,t){return n_(e,t)+"000"}function sZ(e,t){return Yt(e.getUTCMonth()+1,t,2)}function aZ(e,t){return Yt(e.getUTCMinutes(),t,2)}function nZ(e,t){return Yt(e.getUTCSeconds(),t,2)}function iZ(e){var t=e.getUTCDay();return t===0?7:t}function lZ(e,t){return Yt(Mm.count(zn(e)-1,e),t,2)}function i_(e){var t=e.getUTCDay();return t>=4||t===0?eo(e):eo.ceil(e)}function oZ(e,t){return e=i_(e),Yt(eo.count(zn(e),e)+(zn(e).getUTCDay()===4),t,2)}function cZ(e){return e.getUTCDay()}function dZ(e,t){return Yt($u.count(zn(e)-1,e),t,2)}function uZ(e,t){return Yt(e.getUTCFullYear()%100,t,2)}function mZ(e,t){return e=i_(e),Yt(e.getUTCFullYear()%100,t,2)}function fZ(e,t){return Yt(e.getUTCFullYear()%1e4,t,4)}function hZ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?eo(e):eo.ceil(e),Yt(e.getUTCFullYear()%1e4,t,4)}function pZ(){return"+0000"}function hN(){return"%"}function pN(e){return+e}function xN(e){return Math.floor(+e/1e3)}var Nl,l_,o_;xZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function xZ(e){return Nl=xJ(e),l_=Nl.format,Nl.parse,o_=Nl.utcFormat,Nl.utcParse,Nl}function gZ(e){return new Date(e)}function vZ(e){return e instanceof Date?+e:+new Date(+e)}function Vv(e,t,r,a,n,i,l,o,c,u){var d=Iv(),m=d.invert,f=d.domain,h=u(".%L"),x=u(":%S"),p=u("%I:%M"),g=u("%I %p"),j=u("%a %d"),w=u("%b %d"),y=u("%B"),b=u("%Y");function S(E){return(c(E)<E?h:o(E)<E?x:l(E)<E?p:i(E)<E?g:a(E)<E?n(E)<E?j:w:r(E)<E?y:b)(E)}return d.invert=function(E){return new Date(m(E))},d.domain=function(E){return arguments.length?f(Array.from(E,vZ)):f().map(gZ)},d.ticks=function(E){var N=f();return e(N[0],N[N.length-1],E??10)},d.tickFormat=function(E,N){return N==null?S:u(N)},d.nice=function(E){var N=f();return(!E||typeof E.range!="function")&&(E=t(N[0],N[N.length-1],E??10)),E?f(KA(N,E)):d},d.copy=function(){return Zc(d,Vv(e,t,r,a,n,i,l,o,c,u))},d}function yZ(){return Ga.apply(Vv(hJ,pJ,Bn,Wv,Lm,Qc,$v,Bv,Oi,l_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function bZ(){return Ga.apply(Vv(mJ,fJ,zn,Hv,Mm,Fm,Uv,zv,Oi,o_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Bm(){var e=0,t=1,r,a,n,i,l=Us,o=!1,c;function u(m){return m==null||isNaN(m=+m)?c:l(n===0?.5:(m=(i(m)-r)*n,o?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),a=i(t=+t),n=r===a?0:1/(a-r),u):[e,t]},u.clamp=function(m){return arguments.length?(o=!!m,u):o},u.interpolator=function(m){return arguments.length?(l=m,u):l};function d(m){return function(f){var h,x;return arguments.length?([h,x]=f,l=m(h,x),u):[l(0),l(1)]}}return u.range=d(mo),u.rangeRound=d(kv),u.unknown=function(m){return arguments.length?(c=m,u):c},function(m){return i=m,r=m(e),a=m(t),n=r===a?0:1/(a-r),u}}function Ni(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function c_(){var e=wi(Bm()(Us));return e.copy=function(){return Ni(e,c_())},Gn.apply(e,arguments)}function d_(){var e=Ov(Bm()).domain([1,10]);return e.copy=function(){return Ni(e,d_()).base(e.base())},Gn.apply(e,arguments)}function u_(){var e=Rv(Bm());return e.copy=function(){return Ni(e,u_()).constant(e.constant())},Gn.apply(e,arguments)}function Gv(){var e=Fv(Bm());return e.copy=function(){return Ni(e,Gv()).exponent(e.exponent())},Gn.apply(e,arguments)}function jZ(){return Gv.apply(null,arguments).exponent(.5)}function m_(){var e=[],t=Us;function r(a){if(a!=null&&!isNaN(a=+a))return t((Xc(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let n of a)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(li),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,n)=>t(n/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(n,i)=>iX(e,i/a))},r.copy=function(){return m_(t).domain(e)},Gn.apply(r,arguments)}function zm(){var e=0,t=.5,r=1,a=1,n,i,l,o,c,u=Us,d,m=!1,f;function h(p){return isNaN(p=+p)?f:(p=.5+((p=+d(p))-i)*(a*p<a*i?o:c),u(m?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,r]=p,n=d(e=+e),i=d(t=+t),l=d(r=+r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),a=i<n?-1:1,h):[e,t,r]},h.clamp=function(p){return arguments.length?(m=!!p,h):m},h.interpolator=function(p){return arguments.length?(u=p,h):u};function x(p){return function(g){var j,w,y;return arguments.length?([j,w,y]=g,u=PX(p,[j,w,y]),h):[u(0),u(.5),u(1)]}}return h.range=x(mo),h.rangeRound=x(kv),h.unknown=function(p){return arguments.length?(f=p,h):f},function(p){return d=p,n=p(e),i=p(t),l=p(r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),a=i<n?-1:1,h}}function f_(){var e=wi(zm()(Us));return e.copy=function(){return Ni(e,f_())},Gn.apply(e,arguments)}function h_(){var e=Ov(zm()).domain([.1,1,10]);return e.copy=function(){return Ni(e,h_()).base(e.base())},Gn.apply(e,arguments)}function p_(){var e=Rv(zm());return e.copy=function(){return Ni(e,p_()).constant(e.constant())},Gn.apply(e,arguments)}function qv(){var e=Fv(zm());return e.copy=function(){return Ni(e,qv()).exponent(e.exponent())},Gn.apply(e,arguments)}function wZ(){return qv.apply(null,arguments).exponent(.5)}const zo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Cv,scaleDiverging:f_,scaleDivergingLog:h_,scaleDivergingPow:qv,scaleDivergingSqrt:wZ,scaleDivergingSymlog:p_,scaleIdentity:qA,scaleImplicit:Cx,scaleLinear:GA,scaleLog:YA,scaleOrdinal:Tv,scalePoint:cX,scalePow:Lv,scaleQuantile:ZA,scaleQuantize:QA,scaleRadial:JA,scaleSequential:c_,scaleSequentialLog:d_,scaleSequentialPow:Gv,scaleSequentialQuantile:m_,scaleSequentialSqrt:jZ,scaleSequentialSymlog:u_,scaleSqrt:rJ,scaleSymlog:XA,scaleThreshold:e_,scaleTime:yZ,scaleUtc:bZ,tickFormat:VA},Symbol.toStringTag,{value:"Module"}));var Si=e=>e.chartData,Kv=_e([Si],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Yv=(e,t,r,a)=>a?Kv(e):Si(e);function to(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Sa(t)&&Sa(r))return!0}return!1}function gN(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function NZ(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,a]=e,n,i;if(Sa(r))n=r;else if(typeof r=="function")return;if(Sa(a))i=a;else if(typeof a=="function")return;var l=[n,i];if(to(l))return l}}function SZ(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,r);if(to(a))return gN(a,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,l,o;if(n==="auto")t!=null&&(l=Math.min(...t));else if(ut(n))l=n;else if(typeof n=="function")try{t!=null&&(l=n(t?.[0]))}catch{}else if(typeof n=="string"&&lw.test(n)){var c=lw.exec(n);if(c==null||t==null)l=void 0;else{var u=+c[1];l=t[0]-u}}else l=t?.[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(ut(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t?.[1]))}catch{}else if(typeof i=="string"&&ow.test(i)){var d=ow.exec(i);if(d==null||t==null)o=void 0;else{var m=+d[1];o=t[1]+m}}else o=t?.[1];var f=[l,o];if(to(f))return t==null?f:gN(f,t,r)}}}var fo=1e9,EZ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Jv,br=!0,Wa="[DecimalError] ",Hi=Wa+"Invalid argument: ",Xv=Wa+"Exponent out of range: ",ho=Math.floor,Ai=Math.pow,TZ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,xa,is=1e7,mr=7,x_=9007199254740991,Uu=ho(x_/mr),at={};at.absoluteValue=at.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};at.comparedTo=at.cmp=function(e){var t,r,a,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,n=e.d.length,t=0,r=a<n?a:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===n?0:a>n^i.s<0?1:-1};at.decimalPlaces=at.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*mr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};at.dividedBy=at.div=function(e){return Pn(this,new this.constructor(e))};at.dividedToIntegerBy=at.idiv=function(e){var t=this,r=t.constructor;return cr(Pn(t,new r(e),0,1),r.precision)};at.equals=at.eq=function(e){return!this.cmp(e)};at.exponent=function(){return Kr(this)};at.greaterThan=at.gt=function(e){return this.cmp(e)>0};at.greaterThanOrEqualTo=at.gte=function(e){return this.cmp(e)>=0};at.isInteger=at.isint=function(){return this.e>this.d.length-2};at.isNegative=at.isneg=function(){return this.s<0};at.isPositive=at.ispos=function(){return this.s>0};at.isZero=function(){return this.s===0};at.lessThan=at.lt=function(e){return this.cmp(e)<0};at.lessThanOrEqualTo=at.lte=function(e){return this.cmp(e)<1};at.logarithm=at.log=function(e){var t,r=this,a=r.constructor,n=a.precision,i=n+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(xa))throw Error(Wa+"NaN");if(r.s<1)throw Error(Wa+(r.s?"NaN":"-Infinity"));return r.eq(xa)?new a(0):(br=!1,t=Pn(Tc(r,i),Tc(e,i),i),br=!0,cr(t,n))};at.minus=at.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?y_(t,e):g_(t,(e.s=-e.s,e))};at.modulo=at.mod=function(e){var t,r=this,a=r.constructor,n=a.precision;if(e=new a(e),!e.s)throw Error(Wa+"NaN");return r.s?(br=!1,t=Pn(r,e,0,1).times(e),br=!0,r.minus(t)):cr(new a(r),n)};at.naturalExponential=at.exp=function(){return v_(this)};at.naturalLogarithm=at.ln=function(){return Tc(this)};at.negated=at.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};at.plus=at.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?g_(t,e):y_(t,(e.s=-e.s,e))};at.precision=at.sd=function(e){var t,r,a,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Hi+e);if(t=Kr(n)+1,a=n.d.length-1,r=a*mr+1,a=n.d[a],a){for(;a%10==0;a/=10)r--;for(a=n.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};at.squareRoot=at.sqrt=function(){var e,t,r,a,n,i,l,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Wa+"NaN")}for(e=Kr(o),br=!1,n=Math.sqrt(+o),n==0||n==1/0?(t=pn(o.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=ho((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(n.toString()),r=c.precision,n=l=r+3;;)if(i=a,a=i.plus(Pn(o,i,l+2)).times(.5),pn(i.d).slice(0,l)===(t=pn(a.d)).slice(0,l)){if(t=t.slice(l-3,l+1),n==l&&t=="4999"){if(cr(i,r+1,0),i.times(i).eq(o)){a=i;break}}else if(t!="9999")break;l+=4}return br=!0,cr(a,r)};at.times=at.mul=function(e){var t,r,a,n,i,l,o,c,u,d=this,m=d.constructor,f=d.d,h=(e=new m(e)).d;if(!d.s||!e.s)return new m(0);for(e.s*=d.s,r=d.e+e.e,c=f.length,u=h.length,c<u&&(i=f,f=h,h=i,l=c,c=u,u=l),i=[],l=c+u,a=l;a--;)i.push(0);for(a=u;--a>=0;){for(t=0,n=c+a;n>a;)o=i[n]+h[a]*f[n-a-1]+t,i[n--]=o%is|0,t=o/is|0;i[n]=(i[n]+t)%is|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,br?cr(e,m.precision):e};at.toDecimalPlaces=at.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(bn(e,0,fo),t===void 0?t=a.rounding:bn(t,0,8),cr(r,e+Kr(r)+1,t))};at.toExponential=function(e,t){var r,a=this,n=a.constructor;return e===void 0?r=sl(a,!0):(bn(e,0,fo),t===void 0?t=n.rounding:bn(t,0,8),a=cr(new n(a),e+1,t),r=sl(a,!0,e+1)),r};at.toFixed=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?sl(n):(bn(e,0,fo),t===void 0?t=i.rounding:bn(t,0,8),a=cr(new i(n),e+Kr(n)+1,t),r=sl(a.abs(),!1,e+Kr(a)+1),n.isneg()&&!n.isZero()?"-"+r:r)};at.toInteger=at.toint=function(){var e=this,t=e.constructor;return cr(new t(e),Kr(e)+1,t.rounding)};at.toNumber=function(){return+this};at.toPower=at.pow=function(e){var t,r,a,n,i,l,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(xa);if(o=new c(o),!o.s){if(e.s<1)throw Error(Wa+"Infinity");return o}if(o.eq(xa))return o;if(a=c.precision,e.eq(xa))return cr(o,a);if(t=e.e,r=e.d.length-1,l=t>=r,i=o.s,l){if((r=d<0?-d:d)<=x_){for(n=new c(xa),t=Math.ceil(a/mr+4),br=!1;r%2&&(n=n.times(o),yN(n.d,t)),r=ho(r/2),r!==0;)o=o.times(o),yN(o.d,t);return br=!0,e.s<0?new c(xa).div(n):cr(n,a)}}else if(i<0)throw Error(Wa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,br=!1,n=e.times(Tc(o,a+u)),br=!0,n=v_(n),n.s=i,n};at.toPrecision=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?(r=Kr(n),a=sl(n,r<=i.toExpNeg||r>=i.toExpPos)):(bn(e,1,fo),t===void 0?t=i.rounding:bn(t,0,8),n=cr(new i(n),e,t),r=Kr(n),a=sl(n,e<=r||r<=i.toExpNeg,e)),a};at.toSignificantDigits=at.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(bn(e,1,fo),t===void 0?t=a.rounding:bn(t,0,8)),cr(new a(r),e,t)};at.toString=at.valueOf=at.val=at.toJSON=at[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Kr(e),r=e.constructor;return sl(e,t<=r.toExpNeg||t>=r.toExpPos)};function g_(e,t){var r,a,n,i,l,o,c,u,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),br?cr(t,m):t;if(c=e.d,u=t.d,l=e.e,n=t.e,c=c.slice(),i=l-n,i){for(i<0?(a=c,i=-i,o=u.length):(a=u,n=l,o=c.length),l=Math.ceil(m/mr),o=l>o?l+1:o+1,i>o&&(i=o,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,a=u,u=c,c=a),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/is|0,c[i]%=is;for(r&&(c.unshift(r),++n),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=n,br?cr(t,m):t}function bn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Hi+e)}function pn(e){var t,r,a,n=e.length-1,i="",l=e[0];if(n>0){for(i+=l,t=1;t<n;t++)a=e[t]+"",r=mr-a.length,r&&(i+=ei(r)),i+=a;l=e[t],a=l+"",r=mr-a.length,r&&(i+=ei(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var Pn=(function(){function e(a,n){var i,l=0,o=a.length;for(a=a.slice();o--;)i=a[o]*n+l,a[o]=i%is|0,l=i/is|0;return l&&a.unshift(l),a}function t(a,n,i,l){var o,c;if(i!=l)c=i>l?1:-1;else for(o=c=0;o<i;o++)if(a[o]!=n[o]){c=a[o]>n[o]?1:-1;break}return c}function r(a,n,i){for(var l=0;i--;)a[i]-=l,l=a[i]<n[i]?1:0,a[i]=l*is+a[i]-n[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,n,i,l){var o,c,u,d,m,f,h,x,p,g,j,w,y,b,S,E,N,T,k=a.constructor,I=a.s==n.s?1:-1,D=a.d,A=n.d;if(!a.s)return new k(a);if(!n.s)throw Error(Wa+"Division by zero");for(c=a.e-n.e,N=A.length,S=D.length,h=new k(I),x=h.d=[],u=0;A[u]==(D[u]||0);)++u;if(A[u]>(D[u]||0)&&--c,i==null?w=i=k.precision:l?w=i+(Kr(a)-Kr(n))+1:w=i,w<0)return new k(0);if(w=w/mr+2|0,u=0,N==1)for(d=0,A=A[0],w++;(u<S||d)&&w--;u++)y=d*is+(D[u]||0),x[u]=y/A|0,d=y%A|0;else{for(d=is/(A[0]+1)|0,d>1&&(A=e(A,d),D=e(D,d),N=A.length,S=D.length),b=N,p=D.slice(0,N),g=p.length;g<N;)p[g++]=0;T=A.slice(),T.unshift(0),E=A[0],A[1]>=is/2&&++E;do d=0,o=t(A,p,N,g),o<0?(j=p[0],N!=g&&(j=j*is+(p[1]||0)),d=j/E|0,d>1?(d>=is&&(d=is-1),m=e(A,d),f=m.length,g=p.length,o=t(m,p,f,g),o==1&&(d--,r(m,N<f?T:A,f))):(d==0&&(o=d=1),m=A.slice()),f=m.length,f<g&&m.unshift(0),r(p,m,g),o==-1&&(g=p.length,o=t(A,p,N,g),o<1&&(d++,r(p,N<g?T:A,g))),g=p.length):o===0&&(d++,p=[0]),x[u++]=d,o&&p[0]?p[g++]=D[b]||0:(p=[D[b]],g=1);while((b++<S||p[0]!==void 0)&&w--)}return x[0]||x.shift(),h.e=c,cr(h,l?i+Kr(h)+1:i)}})();function v_(e,t){var r,a,n,i,l,o,c=0,u=0,d=e.constructor,m=d.precision;if(Kr(e)>16)throw Error(Xv+Kr(e));if(!e.s)return new d(xa);for(br=!1,o=m,l=new d(.03125);e.abs().gte(.1);)e=e.times(l),u+=5;for(a=Math.log(Ai(2,u))/Math.LN10*2+5|0,o+=a,r=n=i=new d(xa),d.precision=o;;){if(n=cr(n.times(e),o),r=r.times(++c),l=i.plus(Pn(n,r,o)),pn(l.d).slice(0,o)===pn(i.d).slice(0,o)){for(;u--;)i=cr(i.times(i),o);return d.precision=m,t==null?(br=!0,cr(i,m)):i}i=l}}function Kr(e){for(var t=e.e*mr,r=e.d[0];r>=10;r/=10)t++;return t}function Bh(e,t,r){if(t>e.LN10.sd())throw br=!0,r&&(e.precision=r),Error(Wa+"LN10 precision limit exceeded");return cr(new e(e.LN10),t)}function ei(e){for(var t="";e--;)t+="0";return t}function Tc(e,t){var r,a,n,i,l,o,c,u,d,m=1,f=10,h=e,x=h.d,p=h.constructor,g=p.precision;if(h.s<1)throw Error(Wa+(h.s?"NaN":"-Infinity"));if(h.eq(xa))return new p(0);if(t==null?(br=!1,u=g):u=t,h.eq(10))return t==null&&(br=!0),Bh(p,u);if(u+=f,p.precision=u,r=pn(x),a=r.charAt(0),i=Kr(h),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)h=h.times(e),r=pn(h.d),a=r.charAt(0),m++;i=Kr(h),a>1?(h=new p("0."+r),i++):h=new p(a+"."+r.slice(1))}else return c=Bh(p,u+2,g).times(i+""),h=Tc(new p(a+"."+r.slice(1)),u-f).plus(c),p.precision=g,t==null?(br=!0,cr(h,g)):h;for(o=l=h=Pn(h.minus(xa),h.plus(xa),u),d=cr(h.times(h),u),n=3;;){if(l=cr(l.times(d),u),c=o.plus(Pn(l,new p(n),u)),pn(c.d).slice(0,u)===pn(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Bh(p,u+2,g).times(i+""))),o=Pn(o,new p(m),u),p.precision=g,t==null?(br=!0,cr(o,g)):o;o=c,n+=2}}function vN(e,t){var r,a,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(a,n),t){if(n-=a,r=r-a-1,e.e=ho(r/mr),e.d=[],a=(r+1)%mr,r<0&&(a+=mr),a<n){for(a&&e.d.push(+t.slice(0,a)),n-=mr;a<n;)e.d.push(+t.slice(a,a+=mr));t=t.slice(a),a=mr-t.length}else a-=n;for(;a--;)t+="0";if(e.d.push(+t),br&&(e.e>Uu||e.e<-Uu))throw Error(Xv+r)}else e.s=0,e.e=0,e.d=[0];return e}function cr(e,t,r){var a,n,i,l,o,c,u,d,m=e.d;for(l=1,i=m[0];i>=10;i/=10)l++;if(a=t-l,a<0)a+=mr,n=t,u=m[d=0];else{if(d=Math.ceil((a+1)/mr),i=m.length,d>=i)return e;for(u=i=m[d],l=1;i>=10;i/=10)l++;a%=mr,n=a-mr+l}if(r!==void 0&&(i=Ai(10,l-n-1),o=u/i%10|0,c=t<0||m[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(a>0?n>0?u/Ai(10,l-n):0:m[d-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return c?(i=Kr(e),m.length=1,t=t-i-1,m[0]=Ai(10,(mr-t%mr)%mr),e.e=ho(-t/mr)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(a==0?(m.length=d,i=1,d--):(m.length=d+1,i=Ai(10,mr-a),m[d]=n>0?(u/Ai(10,l-n)%Ai(10,n)|0)*i:0),c)for(;;)if(d==0){(m[0]+=i)==is&&(m[0]=1,++e.e);break}else{if(m[d]+=i,m[d]!=is)break;m[d--]=0,i=1}for(a=m.length;m[--a]===0;)m.pop();if(br&&(e.e>Uu||e.e<-Uu))throw Error(Xv+Kr(e));return e}function y_(e,t){var r,a,n,i,l,o,c,u,d,m,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),br?cr(t,h):t;if(c=e.d,m=t.d,a=t.e,u=e.e,c=c.slice(),l=u-a,l){for(d=l<0,d?(r=c,l=-l,o=m.length):(r=m,a=u,o=c.length),n=Math.max(Math.ceil(h/mr),o)+2,l>n&&(l=n,r.length=1),r.reverse(),n=l;n--;)r.push(0);r.reverse()}else{for(n=c.length,o=m.length,d=n<o,d&&(o=n),n=0;n<o;n++)if(c[n]!=m[n]){d=c[n]<m[n];break}l=0}for(d&&(r=c,c=m,m=r,t.s=-t.s),o=c.length,n=m.length-o;n>0;--n)c[o++]=0;for(n=m.length;n>l;){if(c[--n]<m[n]){for(i=n;i&&c[--i]===0;)c[i]=is-1;--c[i],c[n]+=is}c[n]-=m[n]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,br?cr(t,h):t):new f(0)}function sl(e,t,r){var a,n=Kr(e),i=pn(e.d),l=i.length;return t?(r&&(a=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+ei(a):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+ei(-n-1)+i,r&&(a=r-l)>0&&(i+=ei(a))):n>=l?(i+=ei(n+1-l),r&&(a=r-n-1)>0&&(i=i+"."+ei(a))):((a=n+1)<l&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-l)>0&&(n+1===l&&(i+="."),i+=ei(a))),e.s<0?"-"+i:i}function yN(e,t){if(e.length>t)return e.length=t,!0}function b_(e){var t,r,a;function n(i){var l=this;if(!(l instanceof n))return new n(i);if(l.constructor=n,i instanceof n){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Hi+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return vN(l,i.toString())}else if(typeof i!="string")throw Error(Hi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,TZ.test(i))vN(l,i);else throw Error(Hi+i)}if(n.prototype=at,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=b_,n.config=n.set=CZ,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return n.config(e),n}function CZ(e){if(!e||typeof e!="object")throw Error(Wa+"Object expected");var t,r,a,n=["precision",1,fo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((a=e[r=n[t]])!==void 0)if(ho(a)===a&&a>=n[t+1]&&a<=n[t+2])this[r]=a;else throw Error(Hi+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(Hi+r+": "+a);return this}var Jv=b_(EZ);xa=new Jv(1);const ar=Jv;var AZ=e=>e,j_={},w_=e=>e===j_,bN=e=>function t(){return arguments.length===0||arguments.length===1&&w_(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},N_=(e,t)=>e===1?t:bN(function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];var i=a.filter(l=>l!==j_).length;return i>=e?t(...a):N_(e-i,bN(function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];var u=a.map(d=>w_(d)?o.shift():d);return t(...u,...o)}))}),$m=e=>N_(e.length,e),Ix=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},_Z=$m((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),kZ=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return AZ;var n=r.reverse(),i=n[0],l=n.slice(1);return function(){return l.reduce((o,c)=>c(o),i(...arguments))}},Dx=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),S_=e=>{var t=null,r=null;return function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return t&&n.every((l,o)=>{var c;return l===((c=t)===null||c===void 0?void 0:c[o])})||(t=n,r=e(...n)),r}};function E_(e){var t;return e===0?t=1:t=Math.floor(new ar(e).abs().log(10).toNumber())+1,t}function T_(e,t,r){for(var a=new ar(e),n=0,i=[];a.lt(t)&&n<1e5;)i.push(a.toNumber()),a=a.add(r),n++;return i}$m((e,t,r)=>{var a=+e,n=+t;return a+r*(n-a)});$m((e,t,r)=>{var a=t-+e;return a=a||1/0,(r-e)/a});$m((e,t,r)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});var C_=e=>{var[t,r]=e,[a,n]=[t,r];return t>r&&([a,n]=[r,t]),[a,n]},A_=(e,t,r)=>{if(e.lte(0))return new ar(0);var a=E_(e.toNumber()),n=new ar(10).pow(a),i=e.div(n),l=a!==1?.05:.1,o=new ar(Math.ceil(i.div(l).toNumber())).add(r).mul(l),c=o.mul(n);return t?new ar(c.toNumber()):new ar(Math.ceil(c.toNumber()))},IZ=(e,t,r)=>{var a=new ar(1),n=new ar(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(a=new ar(10).pow(E_(e)-1),n=new ar(Math.floor(n.div(a).toNumber())).mul(a)):i>1&&(n=new ar(Math.floor(e)))}else e===0?n=new ar(Math.floor((t-1)/2)):r||(n=new ar(Math.floor(e)));var l=Math.floor((t-1)/2),o=kZ(_Z(c=>n.add(new ar(c-l).mul(a)).toNumber()),Ix);return o(0,t)},__=function(t,r,a,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(a-1)))return{step:new ar(0),tickMin:new ar(0),tickMax:new ar(0)};var l=A_(new ar(r).sub(t).div(a-1),n,i),o;t<=0&&r>=0?o=new ar(0):(o=new ar(t).add(r).div(2),o=o.sub(new ar(o).mod(l)));var c=Math.ceil(o.sub(t).div(l).toNumber()),u=Math.ceil(new ar(r).sub(o).div(l).toNumber()),d=c+u+1;return d>a?__(t,r,a,n,i+1):(d<a&&(u=r>0?u+(a-d):u,c=r>0?c:c+(a-d)),{step:l,tickMin:o.sub(new ar(c).mul(l)),tickMax:o.add(new ar(u).mul(l))})};function DZ(e){var[t,r]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),[l,o]=C_([t,r]);if(l===-1/0||o===1/0){var c=o===1/0?[l,...Ix(0,a-1).map(()=>1/0)]:[...Ix(0,a-1).map(()=>-1/0),o];return t>r?Dx(c):c}if(l===o)return IZ(l,a,n);var{step:u,tickMin:d,tickMax:m}=__(l,o,i,n,0),f=T_(d,m.add(new ar(.1).mul(u)),u);return t>r?Dx(f):f}function PZ(e,t){var[r,a]=e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,l]=C_([r,a]);if(i===-1/0||l===1/0)return[r,a];if(i===l)return[i];var o=Math.max(t,2),c=A_(new ar(l).sub(i).div(o-1),n,0),u=[...T_(new ar(i),new ar(l),c),l];return n===!1&&(u=u.map(d=>Math.round(d))),r>a?Dx(u):u}var OZ=S_(DZ),RZ=S_(PZ),k_=e=>e.rootProps.maxBarSize,FZ=e=>e.rootProps.barGap,I_=e=>e.rootProps.barCategoryGap,LZ=e=>e.rootProps.barSize,ed=e=>e.rootProps.stackOffset,Zv=e=>e.options.chartName,Qv=e=>e.rootProps.syncId,D_=e=>e.rootProps.syncMethod,ey=e=>e.options.eventEmitter,Sn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ua={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Um=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},MZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Sn.angleAxisId,includeHidden:!1,name:void 0,reversed:Sn.reversed,scale:Sn.scale,tick:Sn.tick,tickCount:void 0,ticks:void 0,type:Sn.type,unit:void 0},BZ={allowDataOverflow:ua.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ua.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ua.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ua.scale,tick:ua.tick,tickCount:ua.tickCount,ticks:void 0,type:ua.type,unit:void 0},zZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Sn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Sn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Sn.scale,tick:Sn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},$Z={allowDataOverflow:ua.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ua.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ua.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ua.scale,tick:ua.tick,tickCount:ua.tickCount,ticks:void 0,type:"category",unit:void 0},ty=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?zZ:MZ,ry=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?$Z:BZ,Wm=e=>e.polarOptions,sy=_e([Hn,Vn,rs],hA),P_=_e([Wm,sy],(e,t)=>{if(e!=null)return Ps(e.innerRadius,t,0)}),O_=_e([Wm,sy],(e,t)=>{if(e!=null)return Ps(e.outerRadius,t,t*.8)}),UZ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},R_=_e([Wm],UZ);_e([ty,R_],Um);var F_=_e([sy,P_,O_],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});_e([ry,F_],Um);var L_=_e([Xt,Wm,P_,O_,Hn,Vn],(e,t,r,a,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||a==null)){var{cx:l,cy:o,startAngle:c,endAngle:u}=t;return{cx:Ps(l,n,n/2),cy:Ps(o,i,i/2),innerRadius:r,outerRadius:a,startAngle:c,endAngle:u,clockWise:!1}}}),wr=(e,t)=>t,td=(e,t,r)=>r;function ay(e){return e?.id}var as=e=>{var t=Xt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},po=e=>e.tooltip.settings.axisId,ms=e=>{var t=as(e),r=po(e);return rd(e,t,r)},M_=_e([ms],e=>e?.dataKey);function B_(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,l=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:a;if(!(u==null||u.length===0)){var d=ay(o);u.forEach((m,f)=>{var h=i==null||n?f:String(Cr(m,i,null)),x=Cr(m,o.dataKey,0),p;l.has(h)?p=l.get(h):p={},Object.assign(p,{[d]:x}),l.set(h,p)})}}),Array.from(l.values())}function Hm(e){return e.stackId!=null&&e.dataKey!=null}function jN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Wu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jN(Object(r),!0).forEach(function(a){WZ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function WZ(e,t,r){return(t=HZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HZ(e){var t=VZ(e,"string");return typeof t=="symbol"?t:t+""}function VZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Px=[0,"auto"],ca={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},z_=(e,t)=>e.cartesianAxis.xAxis[t],qn=(e,t)=>{var r=z_(e,t);return r??ca},da={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Px,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Yc},$_=(e,t)=>e.cartesianAxis.yAxis[t],Kn=(e,t)=>{var r=$_(e,t);return r??da},GZ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ny=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??GZ},Wr=(e,t,r)=>{switch(t){case"xAxis":return qn(e,r);case"yAxis":return Kn(e,r);case"zAxis":return ny(e,r);case"angleAxis":return ty(e,r);case"radiusAxis":return ry(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qZ=(e,t,r)=>{switch(t){case"xAxis":return qn(e,r);case"yAxis":return Kn(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rd=(e,t,r)=>{switch(t){case"xAxis":return qn(e,r);case"yAxis":return Kn(e,r);case"angleAxis":return ty(e,r);case"radiusAxis":return ry(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},U_=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function iy(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var ly=e=>e.graphicalItems.cartesianItems,KZ=_e([wr,td],iy),oy=(e,t,r)=>e.filter(r).filter(a=>t?.includeHidden===!0?!0:!a.hide),sd=_e([ly,Wr,KZ],oy),W_=_e([sd],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Hm)),H_=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),V_=_e([sd],H_),cy=e=>e.map(t=>t.data).filter(Boolean).flat(1),YZ=_e([sd],cy),dy=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:n}=t;return e.length>0?e:r.slice(a,n+1)},uy=_e([YZ,Yv],dy),my=(e,t,r)=>t?.dataKey!=null?e.map(a=>({value:Cr(a,t.dataKey)})):r.length>0?r.map(a=>a.dataKey).flatMap(a=>e.map(n=>({value:Cr(n,a)}))):e.map(a=>({value:a})),Vm=_e([uy,Wr,sd],my);function G_(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function vl(e){return e.filter(t=>yn(t)||t instanceof Date).map(Number).filter(t=>wa(t)===!1)}function XZ(e,t,r){return!r||typeof t!="number"||wa(t)?[]:r.length?vl(r.flatMap(a=>{var n=Cr(e,a.dataKey),i,l;if(Array.isArray(n)?[i,l]=n:i=l=n,!(!Sa(i)||!Sa(l)))return[t-i,t+l]})):[]}var JZ=_e([W_,Yv,ms],B_),q_=(e,t,r)=>{var a={},n=t.reduce((i,l)=>(l.stackId==null||(i[l.stackId]==null&&(i[l.stackId]=[]),i[l.stackId].push(l)),i),a);return Object.fromEntries(Object.entries(n).map(i=>{var[l,o]=i,c=o.map(ay);return[l,{stackedData:tK(e,c,r),graphicalItems:o}]}))},Ox=_e([JZ,W_,ed],q_),K_=(e,t,r)=>{var{dataStartIndex:a,dataEndIndex:n}=t;if(r!=="zAxis"){var i=iK(e,a,n);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},ZZ=_e([Ox,Si,wr],K_),Y_=(e,t,r,a,n)=>r.length>0?e.flatMap(i=>r.flatMap(l=>{var o,c,u=(o=a[l.id])===null||o===void 0?void 0:o.filter(m=>G_(n,m)),d=Cr(i,(c=t.dataKey)!==null&&c!==void 0?c:l.dataKey);return{value:d,errorDomain:XZ(i,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:Cr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),Gm=e=>e.errorBars,X_=(e,t,r)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>G_(r,a));_e([V_,Gm,wr],X_);var QZ=_e([uy,Wr,V_,Gm,wr],Y_);function eQ(e){var{value:t}=e;if(yn(t)||t instanceof Date)return t}var wN=e=>{var t=e.flatMap(a=>[a.value,a.errorDomain]).flat(1),r=vl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},tQ=(e,t,r)=>{var a=e.map(eQ).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&cC(a))?RA(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},fy=e=>{var t;if(e==null||!("domain"in e))return Px;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=vl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Px},Hu=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),l=Math.min(...i),o=Math.max(...i);return[l,o]}},J_=e=>e.referenceElements.dots,xo=(e,t,r)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===r:a.yAxisId===r),rQ=_e([J_,wr,td],xo),Z_=e=>e.referenceElements.areas,sQ=_e([Z_,wr,td],xo),Q_=e=>e.referenceElements.lines,aQ=_e([Q_,wr,td],xo),ek=(e,t)=>{var r=vl(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},nQ=_e(rQ,wr,ek),tk=(e,t)=>{var r=vl(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},iQ=_e([sQ,wr],tk),rk=(e,t)=>{var r=vl(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},lQ=_e(aQ,wr,rk),oQ=_e(nQ,lQ,iQ,(e,t,r)=>Hu(e,r,t)),sk=_e([Wr],fy),hy=(e,t,r,a,n,i,l)=>{var o=NZ(t,e.allowDataOverflow);if(o!=null)return o;var c=i==="vertical"&&l==="xAxis"||i==="horizontal"&&l==="yAxis",u=c?Hu(r,n,wN(a)):Hu(n,wN(a));return SZ(t,u,e.allowDataOverflow)},cQ=_e([Wr,sk,ZZ,QZ,oQ,Xt,wr],hy),dQ=[0,1],py=(e,t,r,a,n,i,l)=>{if(!((e==null||r==null||r.length===0)&&l===void 0)){var{dataKey:o,type:c}=e,u=hl(t,i);return u&&o==null?RA(0,r.length):c==="category"?tQ(a,e,u):n==="expand"?dQ:l}},xy=_e([Wr,Xt,uy,Vm,ed,wr,cQ],py),ak=(e,t,r,a,n)=>{if(e!=null){var{scale:i,type:l}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":l==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(Vc(i));return o in zo?o:"point"}}},go=_e([Wr,Xt,U_,Zv,wr],ak);function uQ(e){if(e!=null){if(e in zo)return zo[e]();var t="scale".concat(Vc(e));if(t in zo)return zo[t]()}}function gy(e,t,r,a){if(!(r==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(a);var n=uQ(t);if(n!=null){var i=n.domain(r).range(a);return Xq(i),i}}}var vy=(e,t,r)=>{var a=fy(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&to(e))return OZ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&to(e))return RZ(e,t.tickCount,t.allowDecimals)}},yy=_e([xy,rd,go],vy),by=(e,t,r,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&to(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],l=t[1],o=r[r.length-1];return[Math.min(n,i),Math.max(l,o)]}return t},mQ=_e([Wr,xy,yy,wr],by),fQ=_e(Vm,Wr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,a=Array.from(vl(e.map(o=>o.value))).sort((o,c)=>o-c);if(a.length<2)return 1/0;var n=a[a.length-1]-a[0];if(n===0)return 1/0;for(var i=0;i<a.length-1;i++){var l=a[i+1]-a[i];r=Math.min(r,l)}return r/n}}),nk=_e(fQ,Xt,I_,rs,(e,t,r,a)=>a,(e,t,r,a,n)=>{if(!Sa(e))return 0;var i=t==="vertical"?a.height:a.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var l=Ps(r,e*i),o=e*i/2;return o-l-(o-l)/i*l}return 0}),hQ=(e,t)=>{var r=qn(e,t);return r==null||typeof r.padding!="string"?0:nk(e,"xAxis",t,r.padding)},pQ=(e,t)=>{var r=Kn(e,t);return r==null||typeof r.padding!="string"?0:nk(e,"yAxis",t,r.padding)},xQ=_e(qn,hQ,(e,t)=>{var r,a;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((a=n.right)!==null&&a!==void 0?a:0)+t}}),gQ=_e(Kn,pQ,(e,t)=>{var r,a;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((a=n.bottom)!==null&&a!==void 0?a:0)+t}}),vQ=_e([rs,xQ,Dm,Im,(e,t,r)=>r],(e,t,r,a,n)=>{var{padding:i}=a;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),yQ=_e([rs,Xt,gQ,Dm,Im,(e,t,r)=>r],(e,t,r,a,n,i)=>{var{padding:l}=n;return i?[a.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),ad=(e,t,r,a)=>{var n;switch(t){case"xAxis":return vQ(e,r,a);case"yAxis":return yQ(e,r,a);case"zAxis":return(n=ny(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return R_(e);case"radiusAxis":return F_(e,r);default:return}},ik=_e([Wr,ad],Um),vo=_e([Wr,go,mQ,ik],gy);_e([sd,Gm,wr],X_);function lk(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var qm=(e,t)=>t,Km=(e,t,r)=>r,bQ=_e(_m,qm,Km,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(lk)),jQ=_e(km,qm,Km,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(lk)),ok=(e,t)=>({width:e.width,height:t.height}),wQ=(e,t)=>{var r=typeof t.width=="number"?t.width:Yc;return{width:r,height:e.height}},ck=_e(rs,qn,ok),NQ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},SQ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},EQ=_e(Vn,rs,bQ,qm,Km,(e,t,r,a,n)=>{var i={},l;return r.forEach(o=>{var c=ok(t,o);l==null&&(l=NQ(t,a,e));var u=a==="top"&&!n||a==="bottom"&&n;i[o.id]=l-Number(u)*c.height,l+=(u?-1:1)*c.height}),i}),TQ=_e(Hn,rs,jQ,qm,Km,(e,t,r,a,n)=>{var i={},l;return r.forEach(o=>{var c=wQ(t,o);l==null&&(l=SQ(t,a,e));var u=a==="left"&&!n||a==="right"&&n;i[o.id]=l-Number(u)*c.width,l+=(u?-1:1)*c.width}),i}),CQ=(e,t)=>{var r=qn(e,t);if(r!=null)return EQ(e,r.orientation,r.mirror)},AQ=_e([rs,qn,CQ,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),_Q=(e,t)=>{var r=Kn(e,t);if(r!=null)return TQ(e,r.orientation,r.mirror)},kQ=_e([rs,Kn,_Q,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),dk=_e(rs,Kn,(e,t)=>{var r=typeof t.width=="number"?t.width:Yc;return{width:r,height:e.height}}),NN=(e,t,r)=>{switch(t){case"xAxis":return ck(e,r).width;case"yAxis":return dk(e,r).height;default:return}},uk=(e,t,r,a)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:l}=r,o=hl(e,a),c=t.map(u=>u.value);if(l&&o&&i==="category"&&n&&cC(c))return c}},jy=_e([Xt,Vm,Wr,wr],uk),mk=(e,t,r,a)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,l=hl(e,a);if(l&&(n==="number"||i!=="auto"))return t.map(o=>o.value)}},wy=_e([Xt,Vm,rd,wr],mk),SN=_e([Xt,qZ,go,vo,jy,wy,ad,yy,wr],(e,t,r,a,n,i,l,o,c)=>{if(t==null)return null;var u=hl(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:u,niceTicks:o,range:l,realScaleType:r,scale:a}}),IQ=(e,t,r,a,n,i,l,o,c)=>{if(!(t==null||a==null)){var u=hl(e,c),{type:d,ticks:m,tickCount:f}=t,h=r==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,x=d==="category"&&a.bandwidth?a.bandwidth()/h:0;x=c==="angleAxis"&&i!=null&&i.length>=2?cs(i[0]-i[1])*2*x:x;var p=m||n;if(p){var g=p.map((j,w)=>{var y=l?l.indexOf(j):j;return{index:w,coordinate:a(y)+x,value:j,offset:x}});return g.filter(j=>!wa(j.coordinate))}return u&&o?o.map((j,w)=>({coordinate:a(j)+x,value:j,index:w,offset:x})):a.ticks?a.ticks(f).map(j=>({coordinate:a(j)+x,value:j,offset:x})):a.domain().map((j,w)=>({coordinate:a(j)+x,value:l?l[j]:j,index:w,offset:x}))}},fk=_e([Xt,rd,go,vo,yy,ad,jy,wy,wr],IQ),DQ=(e,t,r,a,n,i,l)=>{if(!(t==null||r==null||a==null||a[0]===a[1])){var o=hl(e,l),{tickCount:c}=t,u=0;return u=l==="angleAxis"&&a?.length>=2?cs(a[0]-a[1])*2*u:u,o&&i?i.map((d,m)=>({coordinate:r(d)+u,value:d,index:m,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,m)=>({coordinate:r(d)+u,value:n?n[d]:d,index:m,offset:u}))}},ro=_e([Xt,rd,vo,ad,jy,wy,wr],DQ),so=_e(Wr,vo,(e,t)=>{if(!(e==null||t==null))return Wu(Wu({},e),{},{scale:t})}),PQ=_e([Wr,go,xy,ik],gy);_e((e,t,r)=>ny(e,r),PQ,(e,t)=>{if(!(e==null||t==null))return Wu(Wu({},e),{},{scale:t})});var OQ=_e([Xt,_m,km],(e,t,r)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),hk=e=>e.options.defaultTooltipEventType,pk=e=>e.options.validateTooltipEventTypes;function xk(e,t,r){if(e==null)return t;var a=e?"axis":"item";return r==null?t:r.includes(a)?a:t}function Ny(e,t){var r=hk(e),a=pk(e);return xk(t,r,a)}function RQ(e){return ct(t=>Ny(t,e))}var gk=(e,t)=>{var r,a=Number(t);if(!(wa(a)||t==null))return a>=0?e==null||(r=e[a])===null||r===void 0?void 0:r.value:void 0},FQ=e=>e.tooltip.settings,ri={active:!1,index:null,dataKey:void 0,coordinate:void 0},LQ={itemInteraction:{click:ri,hover:ri},axisInteraction:{click:ri,hover:ri},keyboardInteraction:ri,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},vk=Ea({name:"tooltip",initialState:LQ,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Dn(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:MQ,removeTooltipEntrySettings:BQ,setTooltipSettingsState:zQ,setActiveMouseOverItemIndex:yk,mouseLeaveItem:$Q,mouseLeaveChart:bk,setActiveClickItemIndex:UQ,setMouseOverAxisIndex:jk,setMouseClickAxisIndex:WQ,setSyncInteraction:Rx,setKeyboardInteraction:Fx}=vk.actions,HQ=vk.reducer;function EN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function zd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EN(Object(r),!0).forEach(function(a){VQ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function VQ(e,t,r){return(t=GQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GQ(e){var t=qQ(e,"string");return typeof t=="symbol"?t:t+""}function qQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KQ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function YQ(e){return e.index!=null}var wk=(e,t,r,a)=>{if(t==null)return ri;var n=KQ(e,t,r);if(n==null)return ri;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(YQ(n)){if(i)return zd(zd({},n),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return zd(zd({},ri),{},{coordinate:n.coordinate})},Sy=(e,t)=>{var r=e?.index;if(r==null)return null;var a=Number(r);if(!Sa(a))return r;var n=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(n,Math.min(a,i)))},Nk=(e,t,r,a,n,i,l,o)=>{if(!(i==null||o==null)){var c=l[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var d=n?.[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:d.coordinate}}}},Sk=(e,t,r,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var l;return((l=i.settings)===null||l===void 0?void 0:l.dataKey)===n})},nd=e=>e.options.tooltipPayloadSearcher,yo=e=>e.tooltip;function TN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function CN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TN(Object(r),!0).forEach(function(a){XQ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function XQ(e,t,r){return(t=JQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JQ(e){var t=ZQ(e,"string");return typeof t=="symbol"?t:t+""}function ZQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QQ(e,t){return e??t}var Ek=(e,t,r,a,n,i,l)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,m=[];return e.reduce((f,h)=>{var x,{dataDefinedOnItem:p,settings:g}=h,j=QQ(p,o),w=Array.isArray(j)?pA(j,u,d):j,y=(x=g?.dataKey)!==null&&x!==void 0?x:a,b=g?.nameKey,S;if(a&&Array.isArray(w)&&!Array.isArray(w[0])&&l==="axis"?S=BH(w,a,n):S=i(w,t,c,b),Array.isArray(S))S.forEach(N=>{var T=CN(CN({},g),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});f.push(cw({tooltipEntrySettings:T,dataKey:N.dataKey,payload:N.payload,value:Cr(N.payload,N.dataKey),name:N.name}))});else{var E;f.push(cw({tooltipEntrySettings:g,dataKey:y,payload:S,value:Cr(S,y),name:(E=Cr(S,b))!==null&&E!==void 0?E:g?.name}))}return f},m)}},Ey=_e([ms,Xt,U_,Zv,as],ak),eee=_e([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),tee=_e([as,po],iy),id=_e([eee,ms,tee],oy),ree=_e([id],e=>e.filter(Hm)),see=_e([id],cy),bo=_e([see,Si],dy),aee=_e([ree,Si,ms],B_),Ty=_e([bo,ms,id],my),nee=_e([ms],fy),iee=_e([id],e=>e.filter(Hm)),lee=_e([aee,iee,ed],q_),oee=_e([lee,Si,as],K_),cee=_e([id],H_),dee=_e([bo,ms,cee,Gm,as],Y_),uee=_e([J_,as,po],xo),mee=_e([uee,as],ek),fee=_e([Z_,as,po],xo),hee=_e([fee,as],tk),pee=_e([Q_,as,po],xo),xee=_e([pee,as],rk),gee=_e([mee,xee,hee],Hu),vee=_e([ms,nee,oee,dee,gee,Xt,as],hy),Tk=_e([ms,Xt,bo,Ty,ed,as,vee],py),yee=_e([Tk,ms,Ey],vy),bee=_e([ms,Tk,yee,as],by),Ck=e=>{var t=as(e),r=po(e),a=!1;return ad(e,t,r,a)},Ak=_e([ms,Ck],Um),_k=_e([ms,Ey,bee,Ak],gy),jee=_e([Xt,Ty,ms,as],uk),wee=_e([Xt,Ty,ms,as],mk),Nee=(e,t,r,a,n,i,l,o)=>{if(t){var{type:c}=t,u=hl(e,o);if(a){var d=r==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,m=c==="category"&&a.bandwidth?a.bandwidth()/d:0;return m=o==="angleAxis"&&n!=null&&n?.length>=2?cs(n[0]-n[1])*2*m:m,u&&l?l.map((f,h)=>({coordinate:a(f)+m,value:f,index:h,offset:m})):a.domain().map((f,h)=>({coordinate:a(f)+m,value:i?i[f]:f,index:h,offset:m}))}}},Yn=_e([Xt,ms,Ey,_k,Ck,jee,wee,as],Nee),Cy=_e([hk,pk,FQ],(e,t,r)=>xk(r.shared,e,t)),kk=e=>e.tooltip.settings.trigger,Ay=e=>e.tooltip.settings.defaultIndex,Ym=_e([yo,Cy,kk,Ay],wk),al=_e([Ym,bo],Sy),Ik=_e([Yn,al],gk),Dk=_e([Ym],e=>{if(e)return e.dataKey}),Pk=_e([yo,Cy,kk,Ay],Sk),See=_e([Hn,Vn,Xt,rs,Yn,Ay,Pk,nd],Nk),Eee=_e([Ym,See],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Tee=_e([Ym],e=>e.active),Cee=_e([Pk,al,Si,M_,Ik,nd,Cy],Ek);_e([Cee],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function _N(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(a){Aee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Aee(e,t,r){return(t=_ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ee(e){var t=kee(e,"string");return typeof t=="symbol"?t:t+""}function kee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iee=()=>ct(ms),Dee=()=>{var e=Iee(),t=ct(Yn),r=ct(_k);return vv(_N(_N({},e),{},{scale:r}),t)},Pee=()=>ct(Zv),_y=(e,t)=>t,Ok=(e,t,r)=>r,ky=(e,t,r,a)=>a,Oee=_e(Yn,e=>wm(e,t=>t.coordinate)),Iy=_e([yo,_y,Ok,ky],wk),Rk=_e([Iy,bo],Sy),Ree=(e,t,r)=>{if(t!=null){var a=yo(e);return t==="axis"?r==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:r==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},Fk=_e([yo,_y,Ok,ky],Sk),Vu=_e([Hn,Vn,Xt,rs,Yn,ky,Fk,nd],Nk),Fee=_e([Iy,Vu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),Lk=_e(Yn,Rk,gk),Lee=_e([Fk,Rk,Si,M_,Lk,nd,_y],Ek),Mee=_e([Iy],e=>({isActive:e.active,activeIndex:e.index})),Bee=(e,t,r,a,n,i,l,o)=>{if(!(!e||!t||!a||!n||!i)){var c=lK(e.chartX,e.chartY,t,r,o);if(c){var u=cK(c,t),d=Kq(u,l,i,a,n),m=oK(t,i,d,c);return{activeIndex:String(d),activeCoordinate:m}}}};function Lx(){return Lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Lx.apply(null,arguments)}function kN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kN(Object(r),!0).forEach(function(a){zee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function zee(e,t,r){return(t=$ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ee(e){var t=Uee(e,"string");return typeof t=="symbol"?t:t+""}function Uee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wee(e){var{coordinate:t,payload:r,index:a,offset:n,tooltipAxisBandSize:i,layout:l,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,m=r,f=a;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var h,x;if(u==="ScatterChart")h=d,x=cY;else if(u==="BarChart")h=dY(l,d,n,i),x=IA;else if(l==="radial"){var{cx:p,cy:g,radius:j,startAngle:w,endAngle:y}=DA(d);h={cx:p,cy:g,startAngle:w,endAngle:y,innerRadius:j,outerRadius:j},x=OA}else h={points:WY(l,d,n)},x=TA;var b=typeof o=="object"&&"className"in o?o.className:void 0,S=$d($d($d($d({stroke:"#ccc",pointerEvents:"none"},n),h),es(o,!1)),{},{payload:m,payloadIndex:f,className:zt("recharts-tooltip-cursor",b)});return v.isValidElement(o)?v.cloneElement(o,S):v.createElement(x,S)}function Hee(e){var t=Dee(),r=jA(),a=Nv(),n=Pee();return v.createElement(Wee,Lx({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:a,tooltipAxisBandSize:t,chartName:n}))}var Mk=v.createContext(null),Vee=()=>v.useContext(Mk),zh={exports:{}},IN;function Gee(){return IN||(IN=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function n(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,m,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new n(d,m||c,f),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],h]:c._events[x].push(h):(c._events[x]=h,c._eventsCount++),c}function l(c,u){--c._eventsCount===0?c._events=new a:delete c._events[u]}function o(){this._events=new a,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,m;if(this._eventsCount===0)return u;for(m in d=this._events)t.call(d,m)&&u.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var f=0,h=m.length,x=new Array(h);f<h;f++)x[f]=m[f].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,m=this._events[d];return m?m.fn?1:m.length:0},o.prototype.emit=function(u,d,m,f,h,x){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],j=arguments.length,w,y;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),j){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,m),!0;case 4:return g.fn.call(g.context,d,m,f),!0;case 5:return g.fn.call(g.context,d,m,f,h),!0;case 6:return g.fn.call(g.context,d,m,f,h,x),!0}for(y=1,w=new Array(j-1);y<j;y++)w[y-1]=arguments[y];g.fn.apply(g.context,w)}else{var b=g.length,S;for(y=0;y<b;y++)switch(g[y].once&&this.removeListener(u,g[y].fn,void 0,!0),j){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,d);break;case 3:g[y].fn.call(g[y].context,d,m);break;case 4:g[y].fn.call(g[y].context,d,m,f);break;default:if(!w)for(S=1,w=new Array(j-1);S<j;S++)w[S-1]=arguments[S];g[y].fn.apply(g[y].context,w)}}return!0},o.prototype.on=function(u,d,m){return i(this,u,d,m,!1)},o.prototype.once=function(u,d,m){return i(this,u,d,m,!0)},o.prototype.removeListener=function(u,d,m,f){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return l(this,h),this;var x=this._events[h];if(x.fn)x.fn===d&&(!f||x.once)&&(!m||x.context===m)&&l(this,h);else{for(var p=0,g=[],j=x.length;p<j;p++)(x[p].fn!==d||f&&!x[p].once||m&&x[p].context!==m)&&g.push(x[p]);g.length?this._events[h]=g.length===1?g[0]:g:l(this,h)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&l(this,d)):(this._events=new a,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(zh)),zh.exports}var qee=Gee();const Kee=gi(qee);var Cc=new Kee,Mx="recharts.syncEvent.tooltip",DN="recharts.syncEvent.brush";function Bk(e,t){if(t){var r=Number.parseInt(t,10);if(!wa(r))return e?.[r]}}var Yee={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},zk=Ea({name:"options",initialState:Yee,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Xee=zk.reducer,{createEventEmitter:Jee}=zk.actions;function Zee(e){return e.tooltip.syncInteraction}var Qee={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},$k=Ea({name:"chartData",initialState:Qee,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;r!=null&&(e.dataStartIndex=r),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:PN,setDataStartEndIndexes:ete,setComputedData:cde}=$k.actions,tte=$k.reducer,rte=["x","y"];function ON(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ON(Object(r),!0).forEach(function(a){ste(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ON(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ste(e,t,r){return(t=ate(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ate(e){var t=nte(e,"string");return typeof t=="symbol"?t:t+""}function nte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ite(e,t){if(e==null)return{};var r,a,n=lte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Uk=()=>{};function ote(){var e=ct(Qv),t=ct(ey),r=_r(),a=ct(D_),n=ct(Yn),i=Nv(),l=bv(),o=ct(c=>c.rootProps.className);v.useEffect(()=>{if(e==null)return Uk;var c=(u,d,m)=>{if(t!==m&&e===u){if(a==="index"){var f;if(l&&d!==null&&d!==void 0&&(f=d.payload)!==null&&f!==void 0&&f.coordinate){var h=d.payload.coordinate,{x,y:p}=h,g=ite(h,rte),j=Ei(Ei(Ei({},g),typeof x=="number"&&{x:Math.max(l.x,Math.min(x,l.x+l.width))}),typeof p=="number"&&{y:Math.max(l.y,Math.min(p,l.y+l.height))}),w=Ei(Ei({},d),{},{payload:Ei(Ei({},d.payload),{},{coordinate:j})});r(w)}else r(d);return}if(n!=null){var y;if(typeof a=="function"){var b={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=a(n,b);y=n[S]}else a==="value"&&(y=n.find(M=>String(M.value)===d.payload.label));var{coordinate:E}=d.payload;if(y==null||d.payload.active===!1||E==null||l==null){r(Rx({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:N,y:T}=E,k=Math.min(N,l.x+l.width),I=Math.min(T,l.y+l.height),D={x:i==="horizontal"?y.coordinate:k,y:i==="horizontal"?I:y.coordinate},A=Rx({active:d.payload.active,coordinate:D,dataKey:d.payload.dataKey,index:String(y.index),label:d.payload.label});r(A)}}};return Cc.on(Mx,c),()=>{Cc.off(Mx,c)}},[o,r,t,e,a,n,i,l])}function cte(){var e=ct(Qv),t=ct(ey),r=_r();v.useEffect(()=>{if(e==null)return Uk;var a=(n,i,l)=>{t!==l&&e===n&&r(ete(i))};return Cc.on(DN,a),()=>{Cc.off(DN,a)}},[r,t,e])}function dte(){var e=_r();v.useEffect(()=>{e(Jee())},[e]),ote(),cte()}function ute(e,t,r,a,n,i){var l=ct(f=>Ree(f,e,t)),o=ct(ey),c=ct(Qv),u=ct(D_),d=ct(Zee),m=d?.active;v.useEffect(()=>{if(!m&&c!=null&&o!=null){var f=Rx({active:i,coordinate:r,dataKey:l,index:n,label:typeof a=="number"?String(a):a});Cc.emit(Mx,c,f,o)}},[m,r,l,n,a,o,c,u,i])}function RN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function FN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RN(Object(r),!0).forEach(function(a){mte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mte(e,t,r){return(t=fte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fte(e){var t=hte(e,"string");return typeof t=="symbol"?t:t+""}function hte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pte(e){return e.dataKey}function xte(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement($K,t)}var LN=[],gte={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!pl.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function kl(e){var t=qs(e,gte),{active:r,allowEscapeViewBox:a,animationDuration:n,animationEasing:i,content:l,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:m,reverseDirection:f,useTranslate3d:h,wrapperStyle:x,cursor:p,shared:g,trigger:j,defaultIndex:w,portal:y,axisId:b}=t,S=_r(),E=typeof w=="number"?String(w):w;v.useEffect(()=>{S(zQ({shared:g,trigger:j,axisId:b,active:r,defaultIndex:E}))},[S,g,j,b,r,E]);var N=bv(),T=EA(),k=RQ(g),{activeIndex:I,isActive:D}=ct(W=>Mee(W,k,j,E)),A=ct(W=>Lee(W,k,j,E)),M=ct(W=>Lk(W,k,j,E)),G=ct(W=>Fee(W,k,j,E)),q=A,z=Vee(),ee=r??D,[U,X]=WC([q,ee]),oe=k==="axis"?M:void 0;ute(k,j,G,oe,I,ee);var Ee=y??z;if(Ee==null)return null;var F=q??LN;ee||(F=LN),o&&F.length&&(F=MC(q.filter(W=>W.value!=null&&(W.hide!==!0||t.includeHidden)),d,pte));var P=F.length>0,C=v.createElement(KK,{allowEscapeViewBox:a,animationDuration:n,animationEasing:i,isAnimationActive:c,active:ee,coordinate:G,hasPayload:P,offset:u,position:m,reverseDirection:f,useTranslate3d:h,viewBox:N,wrapperStyle:x,lastBoundingBox:U,innerRef:X,hasPortalFromProps:!!y},xte(l,FN(FN({},t),{},{payload:F,label:oe,active:ee,coordinate:G,accessibilityLayer:T})));return v.createElement(v.Fragment,null,qx.createPortal(C,Ee),ee&&v.createElement(Hee,{cursor:p,tooltipEventType:k,coordinate:G,payload:q,index:I}))}var $h={},Uh={},Wh={},MN;function vte(){return MN||(MN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a,{signal:n,edges:i}={}){let l,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{o!==null&&(r.apply(l,o),l=void 0,o=null)},m=()=>{u&&d(),p()};let f=null;const h=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,m()},a)},x=()=>{f!==null&&(clearTimeout(f),f=null)},p=()=>{x(),l=void 0,o=null},g=()=>{d()},j=function(...w){if(n?.aborted)return;l=this,o=w;const y=f==null;h(),c&&y&&d()};return j.schedule=h,j.cancel=p,j.flush=g,n?.addEventListener("abort",p,{once:!0}),j}e.debounce=t})(Wh)),Wh}var BN;function yte(){return BN||(BN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vte();function r(a,n=0,i={}){typeof i!="object"&&(i={});const{leading:l=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);l&&(u[0]="leading"),o&&(u[1]="trailing");let d,m=null;const f=t.debounce(function(...p){d=a.apply(this,p),m=null},n,{edges:u}),h=function(...p){return c!=null&&(m===null&&(m=Date.now()),Date.now()-m>=c)?(d=a.apply(this,p),m=Date.now(),f.cancel(),f.schedule(),d):(f.apply(this,p),d)},x=()=>(f.flush(),d);return h.cancel=f.cancel,h.flush=x,h}e.debounce=r})(Uh)),Uh}var zN;function bte(){return zN||(zN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yte();function r(a,n=0,i={}){const{leading:l=!0,trailing:o=!0}=i;return t.debounce(a,n,{leading:l,maxWait:n,trailing:o})}e.throttle=r})($h)),$h}var Hh,$N;function jte(){return $N||($N=1,Hh=bte().throttle),Hh}var wte=jte();const Nte=gi(wte);var Yo=function(t,r){for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i]};function UN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UN(Object(r),!0).forEach(function(a){Ste(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ste(e,t,r){return(t=Ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ete(e){var t=Tte(e,"string");return typeof t=="symbol"?t:t+""}function Tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Il=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:n="100%",height:i="100%",minWidth:l=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:m,className:f,onResize:h,style:x={}}=e,p=v.useRef(null),g=v.useRef();g.current=h,v.useImperativeHandle(t,()=>p.current);var[j,w]=v.useState({containerWidth:a.width,containerHeight:a.height}),y=v.useCallback((S,E)=>{w(N=>{var T=Math.round(S),k=Math.round(E);return N.containerWidth===T&&N.containerHeight===k?N:{containerWidth:T,containerHeight:k}})},[]);v.useEffect(()=>{var S=k=>{var I,{width:D,height:A}=k[0].contentRect;y(D,A),(I=g.current)===null||I===void 0||I.call(g,D,A)};d>0&&(S=Nte(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:N,height:T}=p.current.getBoundingClientRect();return y(N,T),E.observe(p.current),()=>{E.disconnect()}},[y,d]);var b=v.useMemo(()=>{var{containerWidth:S,containerHeight:E}=j;if(S<0||E<0)return null;Yo(Di(n)||Di(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,n,i),Yo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var N=Di(n)?S:n,T=Di(i)?E:i;return r&&r>0&&(N?T=N/r:T&&(N=T*r),c&&T>c&&(T=c)),Yo(N>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,T,n,i,l,o,r),v.Children.map(u,k=>v.cloneElement(k,{width:N,height:T,style:Vh({width:N,height:T},k.props.style)}))},[r,u,i,c,o,l,j,n]);return v.createElement("div",{id:m?"".concat(m):void 0,className:zt("recharts-responsive-container",f),style:Vh(Vh({},x),{},{width:n,height:i,minWidth:l,minHeight:o,maxHeight:c}),ref:p},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},b))}),jo=e=>null;jo.displayName="Cell";function Cte(e,t,r){return(t=Ate(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ate(e){var t=_te(e,"string");return typeof t=="symbol"?t:t+""}function _te(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class kte{constructor(t){Cte(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function WN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ite(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WN(Object(r),!0).forEach(function(a){Dte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Dte(e,t,r){return(t=Pte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pte(e){var t=Ote(e,"string");return typeof t=="symbol"?t:t+""}function Ote(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rte={cacheSize:2e3,enableCache:!0},Wk=Ite({},Rte),HN=new kte(Wk.cacheSize),Fte={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},VN="recharts_measurement_span";function Lte(e,t){var r=t.fontSize||"",a=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",l=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(a,"|").concat(n,"|").concat(i,"|").concat(l,"|").concat(o)}var GN=(e,t)=>{try{var r=document.getElementById(VN);r||(r=document.createElement("span"),r.setAttribute("id",VN),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Fte,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Xo=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||pl.isSsr)return{width:0,height:0};if(!Wk.enableCache)return GN(t,r);var a=Lte(t,r),n=HN.get(a);if(n)return n;var i=GN(t,r);return HN.set(a,i),i},qN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,KN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Mte=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Bte=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Hk={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},zte=Object.keys(Hk),Dl="NaN";function $te(e,t){return e*Hk[t]}class Xs{static parse(t){var r,[,a,n]=(r=Bte.exec(t))!==null&&r!==void 0?r:[];return new Xs(parseFloat(a),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,wa(t)&&(this.unit=""),r!==""&&!Mte.test(r)&&(this.num=NaN,this.unit=""),zte.includes(r)&&(this.num=$te(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Xs(NaN,""):new Xs(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Xs(NaN,""):new Xs(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Xs(NaN,""):new Xs(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Xs(NaN,""):new Xs(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return wa(this.num)}}function Vk(e){if(e.includes(Dl))return Dl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,n,i]=(r=qN.exec(t))!==null&&r!==void 0?r:[],l=Xs.parse(a??""),o=Xs.parse(i??""),c=n==="*"?l.multiply(o):l.divide(o);if(c.isNaN())return Dl;t=t.replace(qN,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,m,f]=(u=KN.exec(t))!==null&&u!==void 0?u:[],h=Xs.parse(d??""),x=Xs.parse(f??""),p=m==="+"?h.add(x):h.subtract(x);if(p.isNaN())return Dl;t=t.replace(KN,p.toString())}return t}var YN=/\(([^()]*)\)/;function Ute(e){for(var t=e,r;(r=YN.exec(t))!=null;){var[,a]=r;t=t.replace(YN,Vk(a))}return t}function Wte(e){var t=e.replace(/\s+/g,"");return t=Ute(t),t=Vk(t),t}function Hte(e){try{return Wte(e)}catch{return Dl}}function Gh(e){var t=Hte(e.slice(5,-1));return t===Dl?"":t}var Vte=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Gte=["dx","dy","angle","className","breakAll"];function Bx(){return Bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bx.apply(null,arguments)}function XN(e,t){if(e==null)return{};var r,a,n=qte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gk=/[ \f\n\r\t\v\u2028\u2029]+/,qk=e=>{var{children:t,breakAll:r,style:a}=e;try{var n=[];ds(t)||(r?n=t.toString().split(""):n=t.toString().split(Gk));var i=n.map(o=>({word:o,width:Xo(o,a).width})),l=r?0:Xo("",a).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},Kte=(e,t,r,a,n)=>{var{maxLines:i,children:l,style:o,breakAll:c}=e,u=ut(i),d=l,m=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D.reduce((A,M)=>{var{word:G,width:q}=M,z=A[A.length-1];if(z&&(a==null||n||z.width+q+r<Number(a)))z.words.push(G),z.width+=q+r;else{var ee={words:[G],width:q};A.push(ee)}return A},[])},f=m(t),h=I=>I.reduce((D,A)=>D.width>A.width?D:A);if(!u||n)return f;var x=f.length>i||h(f).width>Number(a);if(!x)return f;for(var p="",g=I=>{var D=d.slice(0,I),A=qk({breakAll:c,style:o,children:D+p}).wordsWithComputedWidth,M=m(A),G=M.length>i||h(M).width>Number(a);return[G,M]},j=0,w=d.length-1,y=0,b;j<=w&&y<=d.length-1;){var S=Math.floor((j+w)/2),E=S-1,[N,T]=g(E),[k]=g(S);if(!N&&!k&&(j=S+1),N&&k&&(w=S-1),!N&&k){b=T;break}y++}return b||f},JN=e=>{var t=ds(e)?[]:e.toString().split(Gk);return[{words:t}]},Yte=e=>{var{width:t,scaleToFit:r,children:a,style:n,breakAll:i,maxLines:l}=e;if((t||r)&&!pl.isSsr){var o,c,u=qk({breakAll:i,children:a,style:n});if(u){var{wordsWithComputedWidth:d,spaceWidth:m}=u;o=d,c=m}else return JN(a);return Kte({breakAll:i,children:a,maxLines:l,style:n},o,c,t,r)}return JN(a)},ZN="#808080",Xm=v.forwardRef((e,t)=>{var{x:r=0,y:a=0,lineHeight:n="1em",capHeight:i="0.71em",scaleToFit:l=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=ZN}=e,d=XN(e,Vte),m=v.useMemo(()=>Yte({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:l,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,l,d.style,d.width]),{dx:f,dy:h,angle:x,className:p,breakAll:g}=d,j=XN(d,Gte);if(!yn(r)||!yn(a)||m.length===0)return null;var w=r+(ut(f)?f:0),y=a+(ut(h)?h:0),b;switch(c){case"start":b=Gh("calc(".concat(i,")"));break;case"middle":b=Gh("calc(".concat((m.length-1)/2," * -").concat(n," + (").concat(i," / 2))"));break;default:b=Gh("calc(".concat(m.length-1," * -").concat(n,")"));break}var S=[];if(l){var E=m[0].width,{width:N}=d;S.push("scale(".concat(ut(N)?N/E:1,")"))}return x&&S.push("rotate(".concat(x,", ").concat(w,", ").concat(y,")")),S.length&&(j.transform=S.join(" ")),v.createElement("text",Bx({},es(j,!0),{ref:t,x:w,y,className:zt("recharts-text",p),textAnchor:o,fill:u.includes("url")?ZN:u}),m.map((T,k)=>{var I=T.words.join(g?"":" ");return v.createElement("tspan",{x:w,dy:k===0?b:n,key:"".concat(I,"-").concat(k)},I)}))});Xm.displayName="Text";var Xte=["labelRef"];function Jte(e,t){if(e==null)return{};var r,a,n=Zte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Zte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function QN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QN(Object(r),!0).forEach(function(a){Qte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Qte(e,t,r){return(t=ere(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ere(e){var t=tre(e,"string");return typeof t=="symbol"?t:t+""}function tre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function En(){return En=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},En.apply(null,arguments)}var Kk=v.createContext(null),rre=e=>{var{x:t,y:r,width:a,height:n,children:i}=e,l=v.useMemo(()=>({x:t,y:r,width:a,height:n}),[t,r,a,n]);return v.createElement(Kk.Provider,{value:l},i)},Yk=()=>{var e=v.useContext(Kk),t=bv();return e||t},sre=v.createContext(null),are=()=>{var e=v.useContext(sre),t=ct(L_);return e||t},nre=e=>{var{value:t,formatter:r}=e,a=ds(e.children)?t:e.children;return typeof r=="function"?r(a):a},Dy=e=>e!=null&&typeof e=="function",ire=(e,t)=>{var r=cs(t-e),a=Math.min(Math.abs(t-e),360);return r*a},lre=(e,t,r,a,n)=>{var{offset:i,className:l}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:m,endAngle:f,clockWise:h}=n,x=(u+d)/2,p=ire(m,f),g=p>=0?1:-1,j,w;switch(t){case"insideStart":j=m+g*i,w=h;break;case"insideEnd":j=f-g*i,w=!h;break;case"end":j=f+g*i,w=h;break;default:throw new Error("Unsupported position ".concat(t))}w=p<=0?w:!w;var y=qr(o,c,x,j),b=qr(o,c,x,j+(w?1:-1)*359),S="M".concat(y.x,",").concat(y.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(w?0:1,`,
    `).concat(b.x,",").concat(b.y),E=ds(e.id)?vc("recharts-radial-line-"):e.id;return v.createElement("text",En({},a,{dominantBaseline:"central",className:zt("recharts-radial-bar-label",l)}),v.createElement("defs",null,v.createElement("path",{id:E,d:S})),v.createElement("textPath",{xlinkHref:"#".concat(E)},r))},ore=(e,t,r)=>{var{cx:a,cy:n,innerRadius:i,outerRadius:l,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:m}=qr(a,n,l+t,u);return{x:d,y:m,textAnchor:d>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+l)/2,{x:h,y:x}=qr(a,n,f,u);return{x:h,y:x,textAnchor:"middle",verticalAnchor:"middle"}},Xk=e=>"cx"in e&&ut(e.cx),cre=(e,t)=>{var{parentViewBox:r,offset:a,position:n}=e,i;r!=null&&!Xk(r)&&(i=r);var{x:l,y:o,width:c,height:u}=t,d=u>=0?1:-1,m=d*a,f=d>0?"end":"start",h=d>0?"start":"end",x=c>=0?1:-1,p=x*a,g=x>0?"end":"start",j=x>0?"start":"end";if(n==="top"){var w={x:l+c/2,y:o-d*a,textAnchor:"middle",verticalAnchor:f};return Br(Br({},w),i?{height:Math.max(o-i.y,0),width:c}:{})}if(n==="bottom"){var y={x:l+c/2,y:o+u+m,textAnchor:"middle",verticalAnchor:h};return Br(Br({},y),i?{height:Math.max(i.y+i.height-(o+u),0),width:c}:{})}if(n==="left"){var b={x:l-p,y:o+u/2,textAnchor:g,verticalAnchor:"middle"};return Br(Br({},b),i?{width:Math.max(b.x-i.x,0),height:u}:{})}if(n==="right"){var S={x:l+c+p,y:o+u/2,textAnchor:j,verticalAnchor:"middle"};return Br(Br({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:u}:{})}var E=i?{width:c,height:u}:{};return n==="insideLeft"?Br({x:l+p,y:o+u/2,textAnchor:j,verticalAnchor:"middle"},E):n==="insideRight"?Br({x:l+c-p,y:o+u/2,textAnchor:g,verticalAnchor:"middle"},E):n==="insideTop"?Br({x:l+c/2,y:o+m,textAnchor:"middle",verticalAnchor:h},E):n==="insideBottom"?Br({x:l+c/2,y:o+u-m,textAnchor:"middle",verticalAnchor:f},E):n==="insideTopLeft"?Br({x:l+p,y:o+m,textAnchor:j,verticalAnchor:h},E):n==="insideTopRight"?Br({x:l+c-p,y:o+m,textAnchor:g,verticalAnchor:h},E):n==="insideBottomLeft"?Br({x:l+p,y:o+u-m,textAnchor:j,verticalAnchor:f},E):n==="insideBottomRight"?Br({x:l+c-p,y:o+u-m,textAnchor:g,verticalAnchor:f},E):n&&typeof n=="object"&&(ut(n.x)||Di(n.x))&&(ut(n.y)||Di(n.y))?Br({x:l+Ps(n.x,c),y:o+Ps(n.y,u),textAnchor:"end",verticalAnchor:"end"},E):Br({x:l+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},E)},dre={offset:5};function ti(e){var t=qs(e,dre),{viewBox:r,position:a,value:n,children:i,content:l,className:o="",textBreakAll:c,labelRef:u}=t,d=are(),m=Yk(),f=a==="center"?m:d??m,h=r||f;if(!h||ds(n)&&ds(i)&&!v.isValidElement(l)&&typeof l!="function")return null;var x=Br(Br({},t),{},{viewBox:h});if(v.isValidElement(l)){var{labelRef:p}=x,g=Jte(x,Xte);return v.cloneElement(l,g)}var j;if(typeof l=="function"){if(j=v.createElement(l,x),v.isValidElement(j))return j}else j=nre(t);var w=Xk(h),y=es(t,!0);if(w&&(a==="insideStart"||a==="insideEnd"||a==="end"))return lre(t,a,j,y,h);var b=w?ore(h,t.offset,t.position):cre(t,h);return v.createElement(Xm,En({ref:u,className:zt("recharts-label",o)},y,b,{breakAll:c}),j)}ti.displayName="Label";var ure=(e,t,r)=>{if(!e)return null;var a={viewBox:t,labelRef:r};return e===!0?v.createElement(ti,En({key:"label-implicit"},a)):yn(e)?v.createElement(ti,En({key:"label-implicit",value:e},a)):v.isValidElement(e)?e.type===ti?v.cloneElement(e,Br({key:"label-implicit"},a)):v.createElement(ti,En({key:"label-implicit",content:e},a)):Dy(e)?v.createElement(ti,En({key:"label-implicit",content:e},a)):e&&typeof e=="object"?v.createElement(ti,En({},e,{key:"label-implicit"},a)):null};function mre(e){var{label:t}=e,r=Yk();return ure(t,r)||null}var qh={},Kh={},e2;function fre(){return e2||(e2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Kh)),Kh}var Yh={},t2;function hre(){return t2||(t2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Yh)),Yh}var r2;function pre(){return r2||(r2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fre(),r=hre(),a=dv();function n(i){if(a.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})(qh)),qh}var Xh,s2;function xre(){return s2||(s2=1,Xh=pre().last),Xh}var gre=xre();const vre=gi(gre);var yre=["valueAccessor"],bre=["dataKey","clockWise","id","textBreakAll"];function Gu(){return Gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gu.apply(null,arguments)}function a2(e,t){if(e==null)return{};var r,a,n=jre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jre(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var wre=e=>Array.isArray(e.value)?vre(e.value):e.value,Jk=v.createContext(void 0),Nre=Jk.Provider,Zk=v.createContext(void 0),Sre=Zk.Provider;function Ere(){return v.useContext(Jk)}function Tre(){return v.useContext(Zk)}function Xd(e){var{valueAccessor:t=wre}=e,r=a2(e,yre),{dataKey:a,clockWise:n,id:i,textBreakAll:l}=r,o=a2(r,bre),c=Ere(),u=Tre(),d=c||u;return!d||!d.length?null:v.createElement(aa,{className:"recharts-label-list"},d.map((m,f)=>{var h,x=ds(a)?t(m,f):Cr(m&&m.payload,a),p=ds(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(ti,Gu({},es(m,!0),o,p,{fill:(h=r.fill)!==null&&h!==void 0?h:m.fill,parentViewBox:m.parentViewBox,value:x,textBreakAll:l,viewBox:m.viewBox,key:"label-".concat(f),index:f}))}))}Xd.displayName="LabelList";function Qk(e){var{label:t}=e;return t?t===!0?v.createElement(Xd,{key:"labelList-implicit"}):v.isValidElement(t)||Dy(t)?v.createElement(Xd,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(Xd,Gu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var e5=e=>e.graphicalItems.polarItems,Cre=_e([wr,td],iy),Py=_e([e5,Wr,Cre],oy),Are=_e([Py],cy),Oy=_e([Are,Kv],dy),_re=_e([Oy,Wr,Py],my),kre=_e([Oy,Wr,Py],(e,t,r)=>r.length>0?e.flatMap(a=>r.flatMap(n=>{var i,l=Cr(a,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Cr(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]}))),n2=()=>{},Ire=_e([Wr,sk,n2,kre,n2,Xt,wr],hy),t5=_e([Wr,Xt,Oy,_re,ed,wr,Ire],py),Dre=_e([t5,Wr,go],vy);_e([Wr,t5,Dre,wr],by);var Pre={radiusAxis:{},angleAxis:{}},r5=Ea({name:"polarAxis",initialState:Pre,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:dde,removeRadiusAxis:ude,addAngleAxis:mde,removeAngleAxis:fde}=r5.actions,Ore=r5.reducer;function i2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function l2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i2(Object(r),!0).forEach(function(a){Rre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Rre(e,t,r){return(t=Fre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fre(e){var t=Lre(e,"string");return typeof t=="symbol"?t:t+""}function Lre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mre=(e,t)=>t,Ry=_e([e5,Mre],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),Bre=[],Fy=(e,t,r)=>r?.length===0?Bre:r,s5=_e([Kv,Ry,Fy],(e,t,r)=>{var{chartData:a}=e;if(t!=null){var n;if(t?.data!=null&&t.data.length>0?n=t.data:n=a,(!n||!n.length)&&r!=null&&(n=r.map(i=>l2(l2({},t.presentationProps),i.props))),n!=null)return n}}),zre=_e([s5,Ry,Fy],(e,t,r)=>{if(!(e==null||t==null))return e.map((a,n)=>{var i,l=Cr(a,t.nameKey,t.name),o;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[n].props.fill:typeof a=="object"&&a!=null&&"fill"in a?o=a.fill:o=t.fill,{value:Am(l,t.dataKey),color:o,payload:a,type:t.legendType}})}),$re=_e([s5,Ry,Fy,rs],(e,t,r,a)=>{if(!(t==null||e==null))return zse({offset:a,pieSettings:t,displayedData:e,cells:r})}),Jh={},o2;function Ure(){return o2||(o2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${n}]`}let a=r;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(r)===a}e.isPlainObject=t})(Jh)),Jh}var Zh,c2;function Wre(){return c2||(c2=1,Zh=Ure().isPlainObject),Zh}var Hre=Wre();const Vre=gi(Hre);function d2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function u2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d2(Object(r),!0).forEach(function(a){Gre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Gre(e,t,r){return(t=qre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qre(e){var t=Kre(e,"string");return typeof t=="symbol"?t:t+""}function Kre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qu(){return qu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},qu.apply(null,arguments)}var m2=(e,t,r,a,n)=>{var i=r-a,l;return l="M ".concat(e,",").concat(t),l+="L ".concat(e+r,",").concat(t),l+="L ".concat(e+r-i/2,",").concat(t+n),l+="L ".concat(e+r-i/2-a,",").concat(t+n),l+="L ".concat(e,",").concat(t," Z"),l},Yre={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Xre=e=>{var t=qs(e,Yre),{x:r,y:a,upperWidth:n,lowerWidth:i,height:l,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:m}=t,f=v.useRef(),[h,x]=v.useState(-1),p=v.useRef(n),g=v.useRef(i),j=v.useRef(l),w=v.useRef(r),y=v.useRef(a),b=Om(e,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var G=f.current.getTotalLength();G&&x(G)}catch{}},[]),r!==+r||a!==+a||n!==+n||i!==+i||l!==+l||n===0&&i===0||l===0)return null;var S=zt("recharts-trapezoid",o);if(!m)return v.createElement("g",null,v.createElement("path",qu({},es(t,!0),{className:S,d:m2(r,a,n,i,l)})));var E=p.current,N=g.current,T=j.current,k=w.current,I=y.current,D="0px ".concat(h===-1?1:h,"px"),A="".concat(h,"px 0px"),M=CA(["strokeDasharray"],u,c);return v.createElement(Pm,{animationId:b,key:b,canBegin:h>0,duration:u,easing:c,isActive:m,begin:d},G=>{var q=ys(E,n,G),z=ys(N,i,G),ee=ys(T,l,G),U=ys(k,r,G),X=ys(I,a,G);f.current&&(p.current=q,g.current=z,j.current=ee,w.current=U,y.current=X);var oe=G>0?{transition:M,strokeDasharray:A}:{strokeDasharray:D};return v.createElement("path",qu({},es(t,!0),{className:S,d:m2(U,X,q,z,ee),ref:f,style:u2(u2({},oe),t.style)}))})},Jre=["option","shapeType","propTransformer","activeClassName","isActive"];function Zre(e,t){if(e==null)return{};var r,a,n=Qre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qre(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function f2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ku(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f2(Object(r),!0).forEach(function(a){ese(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ese(e,t,r){return(t=tse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tse(e){var t=rse(e,"string");return typeof t=="symbol"?t:t+""}function rse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sse(e,t){return Ku(Ku({},t),e)}function ase(e,t){return e==="symbols"}function h2(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(IA,r);case"trapezoid":return v.createElement(Xre,r);case"sector":return v.createElement(OA,r);case"symbols":if(ase(t))return v.createElement(lv,r);break;default:return null}}function nse(e){return v.isValidElement(e)?e.props:e}function a5(e){var{option:t,shapeType:r,propTransformer:a=sse,activeClassName:n="recharts-active-shape",isActive:i}=e,l=Zre(e,Jre),o;if(v.isValidElement(t))o=v.cloneElement(t,Ku(Ku({},l),nse(t)));else if(typeof t=="function")o=t(l);else if(Vre(t)&&typeof t!="boolean"){var c=a(t,l);o=v.createElement(h2,{shapeType:r,elementProps:c})}else{var u=l;o=v.createElement(h2,{shapeType:r,elementProps:u})}return i?v.createElement(aa,{className:n},o):o}var Ly=(e,t)=>{var r=_r();return(a,n)=>i=>{e?.(a,n,i),r(yk({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}},My=e=>{var t=_r();return(r,a)=>n=>{e?.(r,a,n),t($Q())}},By=(e,t)=>{var r=_r();return(a,n)=>i=>{e?.(a,n,i),r(UQ({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}};function n5(e){var{fn:t,args:r}=e,a=_r(),n=Va();return v.useEffect(()=>{if(!n){var i=t(r);return a(MQ(i)),()=>{a(BQ(i))}}},[t,r,a,n]),null}var i5=()=>{};function ise(e){var{legendPayload:t}=e,r=_r(),a=Va();return v.useEffect(()=>a?i5:(r(NA(t)),()=>{r(SA(t))}),[r,a,t]),null}function lse(e){var{legendPayload:t}=e,r=_r(),a=ct(Xt);return v.useEffect(()=>a!=="centric"&&a!=="radial"?i5:(r(NA(t)),()=>{r(SA(t))}),[r,a,t]),null}var Qh,ose=()=>{var[e]=v.useState(()=>vc("uid-"));return e},cse=(Qh=X5.useId)!==null&&Qh!==void 0?Qh:ose;function dse(e,t){var r=cse();return t||(e?"".concat(e,"-").concat(r):r)}var use=v.createContext(void 0),l5=e=>{var{id:t,type:r,children:a}=e,n=dse("recharts-".concat(r),t);return v.createElement(use.Provider,{value:n},a(n))},mse={cartesianItems:[],polarItems:[]},o5=Ea({name:"graphicalItems",initialState:mse,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:a}=t.payload,n=Dn(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=a)},removeCartesianGraphicalItem(e,t){var r=Dn(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Dn(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:fse,replaceCartesianGraphicalItem:hse,removeCartesianGraphicalItem:pse,addPolarGraphicalItem:xse,removePolarGraphicalItem:gse}=o5.actions,vse=o5.reducer;function yse(e){var t=_r(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?t(fse(e)):r.current!==e&&t(hse({prev:r.current,next:e})),r.current=e},[t,e]),v.useEffect(()=>()=>{r.current&&(t(pse(r.current)),r.current=null)},[t]),null}function bse(e){var t=_r();return v.useEffect(()=>(t(xse(e)),()=>{t(gse(e))}),[t,e]),null}var jse=["onMouseEnter","onClick","onMouseLeave"],wse=["id"],Nse=["id"];function zy(e,t){if(e==null)return{};var r,a,n=Sse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Sse(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function p2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p2(Object(r),!0).forEach(function(a){Ese(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ese(e,t,r){return(t=Tse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tse(e){var t=Cse(e,"string");return typeof t=="symbol"?t:t+""}function Cse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hi(){return hi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hi.apply(null,arguments)}function Ase(e){var t=v.useMemo(()=>rv(e.children,jo),[e.children]),r=ct(a=>zre(a,e.id,t));return r==null?null:v.createElement(lse,{legendPayload:r})}function _se(e){var{dataKey:t,nameKey:r,sectors:a,stroke:n,strokeWidth:i,fill:l,name:o,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:a.map(d=>d.tooltipPayload),positions:a.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:Am(o,t),hide:c,type:u,color:l,unit:""}}}var kse=(e,t)=>e>t?"start":e<t?"end":"middle",Ise=(e,t,r)=>Ps(typeof t=="function"?t(e):t,r,r*.8),Dse=(e,t,r)=>{var{top:a,left:n,width:i,height:l}=t,o=hA(i,l),c=n+Ps(e.cx,i,i/2),u=a+Ps(e.cy,l,l/2),d=Ps(e.innerRadius,o,0),m=Ise(r,e.outerRadius,o),f=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:m,maxRadius:f}},Pse=(e,t)=>{var r=cs(t-e),a=Math.min(Math.abs(t-e),360);return r*a};function Ose(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Rse=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=zt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(TA,hi({},t,{type:"linear",className:r}))},Fse=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var a=r;if(typeof e=="function"&&(a=e(t),v.isValidElement(a)))return a;var n=zt("recharts-pie-label-text",Ose(e));return v.createElement(Xm,hi({},t,{alignmentBaseline:"middle",className:n}),a)};function Lse(e){var{sectors:t,props:r,showLabels:a}=e,{label:n,labelLine:i,dataKey:l}=r;if(!a||!n||!t)return null;var o=ji(r),c=es(n,!1),u=es(i,!1),d=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,m=t.map((f,h)=>{var x=(f.startAngle+f.endAngle)/2,p=qr(f.cx,f.cy,f.outerRadius+d,x),g=gr(gr(gr(gr({},o),f),{},{stroke:"none"},c),{},{index:h,textAnchor:kse(p.x,f.cx)},p),j=gr(gr(gr(gr({},o),f),{},{fill:"none",stroke:f.fill},u),{},{index:h,points:[qr(f.cx,f.cy,f.outerRadius,x),p],key:"line"});return v.createElement(aa,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(h)},i&&Rse(i,j),Fse(n,g,Cr(f,l)))});return v.createElement(aa,{className:"recharts-pie-labels"},m)}function Mse(e){var{sectors:t,props:r,showLabels:a}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?v.createElement(Qk,{label:n}):v.createElement(Lse,{sectors:t,props:r,showLabels:a})}function Bse(e){var{sectors:t,activeShape:r,inactiveShape:a,allOtherPieProps:n}=e,i=ct(al),{onMouseEnter:l,onClick:o,onMouseLeave:c}=n,u=zy(n,jse),d=Ly(l,n.dataKey),m=My(c),f=By(o,n.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((h,x)=>{if(h?.startAngle===0&&h?.endAngle===0&&t.length!==1)return null;var p=r&&String(x)===i,g=i?a:null,j=p?r:g,w=gr(gr({},h),{},{stroke:h.stroke,tabIndex:-1,[yA]:x,[bA]:n.dataKey});return v.createElement(aa,hi({tabIndex:-1,className:"recharts-pie-sector"},Gc(u,h,x),{onMouseEnter:d(h,x),onMouseLeave:m(h,x),onClick:f(h,x),key:"sector-".concat(h?.startAngle,"-").concat(h?.endAngle,"-").concat(h.midAngle,"-").concat(x)}),v.createElement(a5,hi({option:j,isActive:p,shapeType:"sector"},w)))}))}function zse(e){var t,{pieSettings:r,displayedData:a,cells:n,offset:i}=e,{cornerRadius:l,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:m}=r,f=Math.abs(r.minAngle),h=Pse(o,c),x=Math.abs(h),p=a.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=a.filter(E=>Cr(E,u,0)!==0).length,j=(x>=360?g:g-1)*p,w=x-g*f-j,y=a.reduce((E,N)=>{var T=Cr(N,u,0);return E+(ut(T)?T:0)},0),b;if(y>0){var S;b=a.map((E,N)=>{var T=Cr(E,u,0),k=Cr(E,d,N),I=Dse(r,i,E),D=(ut(T)?T:0)/y,A,M=gr(gr({},E),n&&n[N]&&n[N].props);N?A=S.endAngle+cs(h)*p*(T!==0?1:0):A=o;var G=A+cs(h)*((T!==0?f:0)+D*w),q=(A+G)/2,z=(I.innerRadius+I.outerRadius)/2,ee=[{name:k,value:T,payload:M,dataKey:u,type:m}],U=qr(I.cx,I.cy,z,q);return S=gr(gr(gr(gr({},r.presentationProps),{},{percent:D,cornerRadius:l,name:k,tooltipPayload:ee,midAngle:q,middleRadius:z,tooltipPosition:U},M),I),{},{value:T,startAngle:A,endAngle:G,payload:M,paddingAngle:cs(h)*p}),S})}return b}function $se(e){var{showLabels:t,sectors:r,children:a}=e,n=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(Sre,{value:t?n:void 0},a)}function Use(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:n,animationBegin:i,animationDuration:l,animationEasing:o,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:m}=t,f=Om(t,"recharts-pie-"),h=r.current,[x,p]=v.useState(!1),g=v.useCallback(()=>{typeof m=="function"&&m(),p(!1)},[m]),j=v.useCallback(()=>{typeof d=="function"&&d(),p(!0)},[d]);return v.createElement($se,{showLabels:!x,sectors:a},v.createElement(Pm,{animationId:f,begin:i,duration:l,isActive:n,easing:o,onAnimationStart:j,onAnimationEnd:g,key:f},w=>{var y=[],b=a&&a[0],S=b?.startAngle;return a?.forEach((E,N)=>{var T=h&&h[N],k=N>0?el(E,"paddingAngle",0):0;if(T){var I=ys(T.endAngle-T.startAngle,E.endAngle-E.startAngle,w),D=gr(gr({},E),{},{startAngle:S+k,endAngle:S+I+k});y.push(D),S=D.endAngle}else{var{endAngle:A,startAngle:M}=E,G=ys(0,A-M,w),q=gr(gr({},E),{},{startAngle:S+k,endAngle:S+G+k});y.push(q),S=q.endAngle}}),r.current=y,v.createElement(aa,null,v.createElement(Bse,{sectors:y,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),v.createElement(Mse,{showLabels:!x,sectors:a,props:t}),t.children)}var Wse={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!pl.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Hse(e){var{id:t}=e,r=zy(e,wse),{hide:a,className:n,rootTabIndex:i}=e,l=v.useMemo(()=>rv(e.children,jo),[e.children]),o=ct(d=>$re(d,t,l)),c=v.useRef(null),u=zt("recharts-pie",n);return a||o==null?(c.current=null,v.createElement(aa,{tabIndex:i,className:u})):v.createElement(v.Fragment,null,v.createElement(n5,{fn:_se,args:gr(gr({},e),{},{sectors:o})}),v.createElement(aa,{tabIndex:i,className:u},v.createElement(Use,{props:gr(gr({},r),{},{sectors:o}),previousSectorsRef:c})))}function $y(e){var t=qs(e,Wse),{id:r}=t,a=zy(t,Nse),n=ji(a);return v.createElement(l5,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(bse,{type:"pie",id:i,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),v.createElement(Ase,hi({},a,{id:i})),v.createElement(Hse,hi({},a,{id:i}))))}$y.displayName="Pie";function x2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function g2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(r),!0).forEach(function(a){Vse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vse(e,t,r){return(t=Gse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gse(e){var t=qse(e,"string");return typeof t=="symbol"?t:t+""}function qse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kse={xAxis:{},yAxis:{},zAxis:{}},c5=Ea({name:"cartesianAxis",initialState:Kse,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload;e.yAxis[r]&&(e.yAxis[r]=g2(g2({},e.yAxis[r]),{},{width:a}))}}}),{addXAxis:Yse,removeXAxis:Xse,addYAxis:Jse,removeYAxis:Zse,addZAxis:hde,removeZAxis:pde,updateYAxisWidth:Qse}=c5.actions,eae=c5.reducer,tae=_e([rs],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),rae=_e([tae,Hn,Vn],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),d5=()=>ct(rae),sae="Invariant failed";function aae(e,t){throw new Error(sae)}var nae=["x","y"];function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zx.apply(null,arguments)}function v2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v2(Object(r),!0).forEach(function(a){iae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function iae(e,t,r){return(t=lae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lae(e){var t=oae(e,"string");return typeof t=="symbol"?t:t+""}function oae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cae(e,t){if(e==null)return{};var r,a,n=dae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function uae(e,t){var{x:r,y:a}=e,n=cae(e,nae),i="".concat(r),l=parseInt(i,10),o="".concat(a),c=parseInt(o,10),u="".concat(t.height||n.height),d=parseInt(u,10),m="".concat(t.width||n.width),f=parseInt(m,10);return Oo(Oo(Oo(Oo(Oo({},t),n),l?{x:l}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function Uy(e){return v.createElement(a5,zx({shapeType:"rectangle",propTransformer:uae,activeClassName:"recharts-active-bar"},e))}var mae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,n)=>{if(ut(t))return t;var i=ut(a)||ds(a);return i?t(a,n):(i||aae(),r)}},fae={},u5=Ea({name:"errorBars",initialState:fae,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===a.dataKey&&i.direction===a.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==a.dataKey||n.direction!==a.direction))}}}),{addErrorBar:xde,replaceErrorBar:gde,removeErrorBar:vde}=u5.actions,hae=u5.reducer,pae=["children"];function xae(e,t){if(e==null)return{};var r,a,n=gae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var vae={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},yae=v.createContext(vae);function bae(e){var{children:t}=e,r=xae(e,pae);return v.createElement(yae.Provider,{value:r},t)}function m5(e,t){var r,a,n=ct(u=>qn(u,e)),i=ct(u=>Kn(u,t)),l=(r=n?.allowDataOverflow)!==null&&r!==void 0?r:ca.allowDataOverflow,o=(a=i?.allowDataOverflow)!==null&&a!==void 0?a:da.allowDataOverflow,c=l||o;return{needClip:c,needClipX:l,needClipY:o}}function jae(e){var{xAxisId:t,yAxisId:r,clipPathId:a}=e,n=d5(),{needClipX:i,needClipY:l,needClip:o}=m5(t,r);if(!o)return null;var{x:c,y:u,width:d,height:m}=n;return v.createElement("clipPath",{id:"clipPath-".concat(a)},v.createElement("rect",{x:i?c:c-d/2,y:l?u:u-m/2,width:i?d:d*2,height:l?m:m*2}))}var wae=["onMouseEnter","onMouseLeave","onClick"],Nae=["value","background","tooltipPosition"],Sae=["id"],Eae=["onMouseEnter","onClick","onMouseLeave"];function pi(){return pi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pi.apply(null,arguments)}function y2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y2(Object(r),!0).forEach(function(a){Tae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Tae(e,t,r){return(t=Cae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cae(e){var t=Aae(e,"string");return typeof t=="symbol"?t:t+""}function Aae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yu(e,t){if(e==null)return{};var r,a,n=_ae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _ae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var kae=e=>{var{dataKey:t,name:r,fill:a,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:a,value:Am(r,t),payload:e}]};function Iae(e){var{dataKey:t,stroke:r,strokeWidth:a,fill:n,name:i,hide:l,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:n,dataKey:t,nameKey:void 0,name:Am(i,t),hide:l,type:e.tooltipType,color:e.fill,unit:o}}}function Dae(e){var t=ct(al),{data:r,dataKey:a,background:n,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:o,onClick:c}=i,u=Yu(i,wae),d=Ly(l,a),m=My(o),f=By(c,a);if(!n||r==null)return null;var h=es(n,!1);return v.createElement(v.Fragment,null,r.map((x,p)=>{var{value:g,background:j,tooltipPosition:w}=x,y=Yu(x,Nae);if(!j)return null;var b=d(x,p),S=m(x,p),E=f(x,p),N=zs(zs(zs(zs(zs({option:n,isActive:String(p)===t},y),{},{fill:"#eee"},j),h),Gc(u,x,p)),{},{onMouseEnter:b,onMouseLeave:S,onClick:E,dataKey:a,index:p,className:"recharts-bar-background-rectangle"});return v.createElement(Uy,pi({key:"background-bar-".concat(N.index)},N))}))}function Pae(e){var{showLabels:t,children:r,rects:a}=e,n=a?.map(i=>{var l={x:i.x,y:i.y,width:i.width,height:i.height};return zs(zs({},l),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:l,fill:i.fill})});return v.createElement(Nre,{value:t?n:void 0},r)}function Oae(e){var{shape:t,activeBar:r,baseProps:a,entry:n,index:i,dataKey:l}=e,o=ct(al),c=ct(Dk),u=r&&String(i)===o&&(c==null||l===c),d=u?r:t;return v.createElement(Uy,pi({},a,n,{isActive:u,option:d,index:i,dataKey:l}))}function Rae(e){var{shape:t,baseProps:r,entry:a,index:n,dataKey:i}=e;return v.createElement(Uy,pi({},r,a,{isActive:!1,option:t,index:n,dataKey:i}))}function Fae(e){var{data:t,props:r}=e,a=ji(r),{id:n}=a,i=Yu(a,Sae),{shape:l,dataKey:o,activeBar:c}=r,{onMouseEnter:u,onClick:d,onMouseLeave:m}=r,f=Yu(r,Eae),h=Ly(u,o),x=My(m),p=By(d,o);return t?v.createElement(v.Fragment,null,t.map((g,j)=>v.createElement(aa,pi({className:"recharts-bar-rectangle"},Gc(f,g,j),{onMouseEnter:h(g,j),onMouseLeave:x(g,j),onClick:p(g,j),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(j)}),c?v.createElement(Oae,{shape:l,activeBar:c,baseProps:i,entry:g,index:j,dataKey:o}):v.createElement(Rae,{shape:l,baseProps:i,entry:g,index:j,dataKey:o})))):null}function Lae(e){var{props:t,previousRectanglesRef:r}=e,{data:a,layout:n,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,m=r.current,f=Om(t,"recharts-bar-"),[h,x]=v.useState(!1),p=!h,g=v.useCallback(()=>{typeof u=="function"&&u(),x(!1)},[u]),j=v.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return v.createElement(Pae,{showLabels:p,rects:a},v.createElement(Pm,{animationId:f,begin:l,duration:o,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:j,key:f},w=>{var y=w===1?a:a?.map((b,S)=>{var E=m&&m[S];if(E)return zs(zs({},b),{},{x:ys(E.x,b.x,w),y:ys(E.y,b.y,w),width:ys(E.width,b.width,w),height:ys(E.height,b.height,w)});if(n==="horizontal"){var N=ys(0,b.height,w);return zs(zs({},b),{},{y:b.y+b.height-N,height:N})}var T=ys(0,b.width,w);return zs(zs({},b),{},{width:T})});return w>0&&(r.current=y??null),y==null?null:v.createElement(aa,null,v.createElement(Fae,{props:t,data:y}))}),v.createElement(Qk,{label:t.label}),t.children)}function Mae(e){var t=v.useRef(null);return v.createElement(Lae,{previousRectanglesRef:t,props:e})}var f5=0,Bae=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Cr(e,t)}};class zae extends v.PureComponent{render(){var{hide:t,data:r,dataKey:a,className:n,xAxisId:i,yAxisId:l,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=zt("recharts-bar",n),m=u;return v.createElement(aa,{className:d,id:u},o&&v.createElement("defs",null,v.createElement(jae,{clipPathId:m,xAxisId:i,yAxisId:l})),v.createElement(aa,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(m,")"):void 0},v.createElement(Dae,{data:r,dataKey:a,background:c,allOtherBarProps:this.props}),v.createElement(Mae,this.props)))}}var $ae={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!pl.isSsr,legendType:"rect",minPointSize:f5,xAxisId:0,yAxisId:0};function Uae(e){var{xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:m}=m5(t,r),f=Nv(),h=Va(),x=rv(e.children,jo),p=ct(w=>xne(w,t,r,h,e.id,x));if(f!=="vertical"&&f!=="horizontal")return null;var g,j=p?.[0];return j==null||j.height==null||j.width==null?g=0:g=f==="vertical"?j.height/2:j.width/2,v.createElement(bae,{xAxisId:t,yAxisId:r,data:p,dataPointFormatter:Bae,errorBarOffset:g},v.createElement(zae,pi({},e,{layout:f,needClip:m,data:p,xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function Wae(e){var{layout:t,barSettings:{dataKey:r,minPointSize:a},pos:n,bandSize:i,xAxis:l,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:m,offset:f,cells:h,parentViewBox:x}=e,p=t==="horizontal"?o:l,g=d?p.scale.domain():null,j=sK({numericAxis:p});return m.map((w,y)=>{var b,S,E,N,T,k;d?b=Jq(d[y],g):(b=Cr(w,r),Array.isArray(b)||(b=[j,b]));var I=mae(a,f5)(b[1],y);if(t==="horizontal"){var D,[A,M]=[o.scale(b[0]),o.scale(b[1])];S=iw({axis:l,ticks:c,bandSize:i,offset:n.offset,entry:w,index:y}),E=(D=M??A)!==null&&D!==void 0?D:void 0,N=n.size;var G=A-M;if(T=wa(G)?0:G,k={x:S,y:f.top,width:N,height:f.height},Math.abs(I)>0&&Math.abs(T)<Math.abs(I)){var q=cs(T||I)*(Math.abs(I)-Math.abs(T));E-=q,T+=q}}else{var[z,ee]=[l.scale(b[0]),l.scale(b[1])];if(S=z,E=iw({axis:o,ticks:u,bandSize:i,offset:n.offset,entry:w,index:y}),N=ee-z,T=n.size,k={x:f.left,y:E,width:f.width,height:T},Math.abs(I)>0&&Math.abs(N)<Math.abs(I)){var U=cs(N||I)*(Math.abs(I)-Math.abs(N));N+=U}}if(S==null||E==null||N==null||T==null)return null;var X=zs(zs({},w),{},{x:S,y:E,width:N,height:T,value:d?b:b[1],payload:w,background:k,tooltipPosition:{x:S+N/2,y:E+T/2},parentViewBox:x},h&&h[y]&&h[y].props);return X}).filter(Boolean)}function Hae(e){var t=qs(e,$ae),r=Va();return v.createElement(l5,{id:t.id,type:"bar"},a=>v.createElement(v.Fragment,null,v.createElement(ise,{legendPayload:kae(t)}),v.createElement(n5,{fn:Iae,args:t}),v.createElement(yse,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:rK(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(Uae,pi({},t,{id:a}))))}var Pl=v.memo(Hae);Pl.displayName="Bar";function b2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ud(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b2(Object(r),!0).forEach(function(a){Vae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vae(e,t,r){return(t=Gae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gae(e){var t=qae(e,"string");return typeof t=="symbol"?t:t+""}function qae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kae=(e,t)=>t,Yae=(e,t,r)=>r,Xae=(e,t,r,a)=>a,Jae=(e,t,r,a,n)=>n,ld=_e([ly,Jae],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Zae=_e([ld],e=>e?.maxBarSize),Qae=(e,t,r,a,n,i)=>i,j2=(e,t,r)=>{var a=r??e;if(!ds(a))return Ps(a,t,0)},ene=_e([Xt,ly,Kae,Yae,Xae],(e,t,r,a,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===a).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),tne=(e,t,r,a)=>{var n=Xt(e);return n==="horizontal"?Ox(e,"yAxis",r,a):Ox(e,"xAxis",t,a)},rne=(e,t,r)=>{var a=Xt(e);return a==="horizontal"?NN(e,"xAxis",t):NN(e,"yAxis",r)},sne=(e,t,r)=>{var a={},n=e.filter(Hm),i=e.filter(u=>u.stackId==null),l=n.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),a),o=Object.entries(l).map(u=>{var[d,m]=u,f=m.map(x=>x.dataKey),h=j2(t,r,m[0].barSize);return{stackId:d,dataKeys:f,barSize:h}}),c=i.map(u=>{var d=[u.dataKey].filter(f=>f!=null),m=j2(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:m}});return[...o,...c]},ane=_e([ene,LZ,rne],sne),nne=(e,t,r,a,n)=>{var i,l,o=ld(e,t,r,a,n);if(o!=null){var c=Xt(e),u=k_(e),{maxBarSize:d}=o,m=ds(d)?u:d,f,h;return c==="horizontal"?(f=so(e,"xAxis",t,a),h=ro(e,"xAxis",t,a)):(f=so(e,"yAxis",r,a),h=ro(e,"yAxis",r,a)),(i=(l=vv(f,h,!0))!==null&&l!==void 0?l:m)!==null&&i!==void 0?i:0}},h5=(e,t,r,a)=>{var n=Xt(e),i,l;return n==="horizontal"?(i=so(e,"xAxis",t,a),l=ro(e,"xAxis",t,a)):(i=so(e,"yAxis",r,a),l=ro(e,"yAxis",r,a)),vv(i,l)};function ine(e,t,r,a,n){var i=a.length;if(!(i<1)){var l=Ps(e,r,0,!0),o,c=[];if(Sa(a[0].barSize)){var u=!1,d=r/i,m=a.reduce((j,w)=>j+(w.barSize||0),0);m+=(i-1)*l,m>=r&&(m-=(i-1)*l,l=0),m>=r&&d>0&&(u=!0,d*=.9,m=i*d);var f=(r-m)/2>>0,h={offset:f-l,size:0};o=a.reduce((j,w)=>{var y,b={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:h.offset+h.size+l,size:u?d:(y=w.barSize)!==null&&y!==void 0?y:0}},S=[...j,b];return h=S[S.length-1].position,S},c)}else{var x=Ps(t,r,0,!0);r-2*x-(i-1)*l<=0&&(l=0);var p=(r-2*x-(i-1)*l)/i;p>1&&(p>>=0);var g=Sa(n)?Math.min(p,n):p;o=a.reduce((j,w,y)=>[...j,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x+(p+l)*y+(p-g)/2,size:g}}],c)}return o}}var lne=(e,t,r,a,n,i,l)=>{var o=ds(l)?t:l,c=ine(r,a,n!==i?n:i,e,o);return n!==i&&c!=null&&(c=c.map(u=>Ud(Ud({},u),{},{position:Ud(Ud({},u.position),{},{offset:u.position.offset-n/2})}))),c},one=_e([ane,k_,FZ,I_,nne,h5,Zae],lne),cne=(e,t,r,a)=>so(e,"xAxis",t,a),dne=(e,t,r,a)=>so(e,"yAxis",r,a),une=(e,t,r,a)=>ro(e,"xAxis",t,a),mne=(e,t,r,a)=>ro(e,"yAxis",r,a),fne=_e([one,ld],(e,t)=>{if(!(e==null||t==null)){var r=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),hne=(e,t)=>{var r=ay(t);if(!(!e||r==null||t==null)){var{stackId:a}=t;if(a!=null){var n=e[a];if(n){var{stackedData:i}=n;if(i)return i.find(l=>l.key===r)}}}},pne=_e([tne,ld],hne),xne=_e([rs,yv,cne,dne,une,mne,fne,Xt,Yv,h5,pne,ld,Qae],(e,t,r,a,n,i,l,o,c,u,d,m,f)=>{var{chartData:h,dataStartIndex:x,dataEndIndex:p}=c;if(!(m==null||l==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||a==null||n==null||i==null||u==null)){var{data:g}=m,j;if(g!=null&&g.length>0?j=g:j=h?.slice(x,p+1),j!=null)return Wae({layout:o,barSettings:m,pos:l,parentViewBox:t,bandSize:u,xAxis:r,yAxis:a,xAxisTicks:n,yAxisTicks:i,stackedData:d,displayedData:j,offset:e,cells:f})}}),p5=e=>{var{chartData:t}=e,r=_r(),a=Va();return v.useEffect(()=>a?()=>{}:(r(PN(t)),()=>{r(PN(void 0))}),[t,r,a]),null},w2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},x5=Ea({name:"brush",initialState:w2,reducers:{setBrushSettings(e,t){return t.payload==null?w2:t.payload}}}),{setBrushSettings:yde}=x5.actions,gne=x5.reducer;function vne(e,t,r){return(t=yne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yne(e){var t=bne(e,"string");return typeof t=="symbol"?t:t+""}function bne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Wy{static create(t){return new Wy(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}return this.scale(t)}}isInRange(t){var r=this.range(),a=r[0],n=r[r.length-1];return a<=n?t>=a&&t<=n:t>=n&&t<=a}}vne(Wy,"EPS",1e-4);function jne(e){return(e%180+180)%180}var wne=function(t){var{width:r,height:a}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=jne(n),l=i*Math.PI/180,o=Math.atan(a/r),c=l>o&&l<Math.PI-o?a/Math.sin(l):r/Math.cos(l);return Math.abs(c)},Nne={dots:[],areas:[],lines:[]},g5=Ea({name:"referenceElements",initialState:Nne,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Dn(e).dots.findIndex(a=>a===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Dn(e).areas.findIndex(a=>a===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Dn(e).lines.findIndex(a=>a===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:bde,removeDot:jde,addArea:wde,removeArea:Nde,addLine:Sde,removeLine:Ede}=g5.actions,Sne=g5.reducer,Ene=v.createContext(void 0),Tne=e=>{var{children:t}=e,[r]=v.useState("".concat(vc("recharts"),"-clip")),a=d5();if(a==null)return null;var{x:n,y:i,width:l,height:o}=a;return v.createElement(Ene.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:n,y:i,height:o,width:l}))),t)};function ao(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function v5(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],n=0;n<e.length;n+=t)a.push(e[n]);return a}function Cne(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return wne(a,r)}function Ane(e,t,r){var a=r==="width",{x:n,y:i,width:l,height:o}=e;return t===1?{start:a?n:i,end:a?n+l:i+o}:{start:a?n+l:i+o,end:a?n:i}}function Xu(e,t,r,a,n){if(e*t<e*a||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-n)<=0}function _ne(e,t){return v5(e,t+1)}function kne(e,t,r,a,n){for(var i=(a||[]).slice(),{start:l,end:o}=t,c=0,u=1,d=l,m=function(){var x=a?.[c];if(x===void 0)return{v:v5(a,u)};var p=c,g,j=()=>(g===void 0&&(g=r(x,p)),g),w=x.coordinate,y=c===0||Xu(e,w,j,d,o);y||(c=0,d=l,u+=1),y&&(d=w+e*(j()/2+n),c+=u)},f;u<=i.length;)if(f=m(),f)return f.v;return[]}function N2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ss(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N2(Object(r),!0).forEach(function(a){Ine(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ine(e,t,r){return(t=Dne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dne(e){var t=Pne(e,"string");return typeof t=="symbol"?t:t+""}function Pne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function One(e,t,r,a,n){for(var i=(a||[]).slice(),l=i.length,{start:o}=t,{end:c}=t,u=function(f){var h=i[f],x,p=()=>(x===void 0&&(x=r(h,f)),x);if(f===l-1){var g=e*(h.coordinate+e*p()/2-c);i[f]=h=Ss(Ss({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[f]=h=Ss(Ss({},h),{},{tickCoord:h.coordinate});var j=Xu(e,h.tickCoord,p,o,c);j&&(c=h.tickCoord-e*(p()/2+n),i[f]=Ss(Ss({},h),{},{isShow:!0}))},d=l-1;d>=0;d--)u(d);return i}function Rne(e,t,r,a,n,i){var l=(a||[]).slice(),o=l.length,{start:c,end:u}=t;if(i){var d=a[o-1],m=r(d,o-1),f=e*(d.coordinate+e*m/2-u);l[o-1]=d=Ss(Ss({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate});var h=Xu(e,d.tickCoord,()=>m,c,u);h&&(u=d.tickCoord-e*(m/2+n),l[o-1]=Ss(Ss({},d),{},{isShow:!0}))}for(var x=i?o-1:o,p=function(w){var y=l[w],b,S=()=>(b===void 0&&(b=r(y,w)),b);if(w===0){var E=e*(y.coordinate-e*S()/2-c);l[w]=y=Ss(Ss({},y),{},{tickCoord:E<0?y.coordinate-E*e:y.coordinate})}else l[w]=y=Ss(Ss({},y),{},{tickCoord:y.coordinate});var N=Xu(e,y.tickCoord,S,c,u);N&&(c=y.tickCoord+e*(S()/2+n),l[w]=Ss(Ss({},y),{},{isShow:!0}))},g=0;g<x;g++)p(g);return l}function Hy(e,t,r){var{tick:a,ticks:n,viewBox:i,minTickGap:l,orientation:o,interval:c,tickFormatter:u,unit:d,angle:m}=e;if(!n||!n.length||!a)return[];if(ut(c)||pl.isSsr){var f;return(f=_ne(n,ut(c)?c:0))!==null&&f!==void 0?f:[]}var h=[],x=o==="top"||o==="bottom"?"width":"height",p=d&&x==="width"?Xo(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(y,b)=>{var S=typeof u=="function"?u(y.value,b):y.value;return x==="width"?Cne(Xo(S,{fontSize:t,letterSpacing:r}),p,m):Xo(S,{fontSize:t,letterSpacing:r})[x]},j=n.length>=2?cs(n[1].coordinate-n[0].coordinate):1,w=Ane(i,j,x);return c==="equidistantPreserveStart"?kne(j,w,g,n,l):(c==="preserveStart"||c==="preserveStartEnd"?h=Rne(j,w,g,n,l,c==="preserveStartEnd"):h=One(j,w,g,n,l),h.filter(y=>y.isShow))}var Fne=e=>{var{ticks:t,label:r,labelGapWithTick:a=5,tickSize:n=0,tickMargin:i=0}=e,l=0;if(t){t.forEach(d=>{if(d){var m=d.getBoundingClientRect();m.width>l&&(l=m.width)}});var o=r?r.getBoundingClientRect().width:0,c=n+i,u=l+c+o+(r?a:0);return Math.round(u)}return 0},Lne=["axisLine","width","height","className","hide","ticks"],Mne=["viewBox"],Bne=["viewBox"];function $x(e,t){if(e==null)return{};var r,a,n=zne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zne(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function nl(){return nl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},nl.apply(null,arguments)}function S2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Xr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S2(Object(r),!0).forEach(function(a){$ne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $ne(e,t,r){return(t=Une(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Une(e){var t=Wne(e,"string");return typeof t=="symbol"?t:t+""}function Wne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vy={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function Hne(e){var{x:t,y:r,width:a,height:n,orientation:i,mirror:l,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=Xr(Xr(Xr({},c),es(o,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!l||i==="bottom"&&l);u=Xr(Xr({},u),{},{x1:t,y1:r+d*n,x2:t+a,y2:r+d*n})}else{var m=+(i==="left"&&!l||i==="right"&&l);u=Xr(Xr({},u),{},{x1:t+m*a,y1:r,x2:t+m*a,y2:r+n})}return v.createElement("line",nl({},u,{className:zt("recharts-cartesian-axis-line",el(o,"className"))}))}function Vne(e,t,r,a,n,i,l,o,c){var u,d,m,f,h,x,p=o?-1:1,g=e.tickSize||l,j=ut(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,f=r+ +!o*n,m=f-p*g,x=m-p*c,h=j;break;case"left":m=f=e.coordinate,d=t+ +!o*a,u=d-p*g,h=u-p*c,x=j;break;case"right":m=f=e.coordinate,d=t+ +o*a,u=d+p*g,h=u+p*c,x=j;break;default:u=d=e.coordinate,f=r+ +o*n,m=f+p*g,x=m+p*c,h=j;break}return{line:{x1:u,y1:m,x2:d,y2:f},tick:{x:h,y:x}}}function Gne(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function qne(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Kne(e){var{option:t,tickProps:r,value:a}=e,n,i=zt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))n=v.cloneElement(t,Xr(Xr({},r),{},{className:i}));else if(typeof t=="function")n=t(Xr(Xr({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=zt(l,t?.className)),n=v.createElement(Xm,nl({},r,{className:l}),a)}return n}function Yne(e){var{ticks:t=[],tick:r,tickLine:a,stroke:n,tickFormatter:i,unit:l,padding:o,tickTextProps:c,orientation:u,mirror:d,x:m,y:f,width:h,height:x,tickSize:p,tickMargin:g,fontSize:j,letterSpacing:w,getTicksConfig:y,events:b}=e,S=Hy(Xr(Xr({},y),{},{ticks:t}),j,w),E=Gne(u,d),N=qne(u,d),T=ji(y),k=es(r,!1),I=Xr(Xr({},T),{},{fill:"none"},es(a,!1)),D=S.map((A,M)=>{var{line:G,tick:q}=Vne(A,m,f,h,x,u,p,d,g),z=Xr(Xr(Xr(Xr({textAnchor:E,verticalAnchor:N},T),{},{stroke:"none",fill:n},k),q),{},{index:M,payload:A,visibleTicksCount:S.length,tickFormatter:i,padding:o},c);return v.createElement(aa,nl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(A.value,"-").concat(A.coordinate,"-").concat(A.tickCoord)},Gc(b,A,M)),a&&v.createElement("line",nl({},I,G,{className:zt("recharts-cartesian-axis-tick-line",el(a,"className"))})),r&&v.createElement(Kne,{option:r,tickProps:z,value:"".concat(typeof i=="function"?i(A.value,M):A.value).concat(l||"")}))});return D.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},D):null}var Xne=v.forwardRef((e,t)=>{var{axisLine:r,width:a,height:n,className:i,hide:l,ticks:o}=e,c=$x(e,Lne),[u,d]=v.useState(""),[m,f]=v.useState(""),h=v.useRef([]);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var p;return Fne({ticks:h.current,label:(p=e.labelRef)===null||p===void 0?void 0:p.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=v.useCallback(p=>{if(p){var g=p.getElementsByClassName("recharts-cartesian-axis-tick-value");h.current=Array.from(g);var j=g[0];if(j){var w=window.getComputedStyle(j),y=w.fontSize,b=w.letterSpacing;(y!==u||b!==m)&&(d(y),f(b))}}},[u,m]);return l||a!=null&&a<=0||n!=null&&n<=0?null:v.createElement(aa,{className:zt("recharts-cartesian-axis",i),ref:x},v.createElement(Hne,{x:e.x,y:e.y,width:a,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:ji(e)}),v.createElement(Yne,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:m,getTicksConfig:e,events:c}),v.createElement(rre,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(mre,{label:e.label}),e.children))}),Jne=v.memo(Xne,(e,t)=>{var{viewBox:r}=e,a=$x(e,Mne),{viewBox:n}=t,i=$x(t,Bne);return ao(r,n)&&ao(a,i)}),Gy=v.forwardRef((e,t)=>{var r=qs(e,Vy);return v.createElement(Jne,nl({},r,{ref:t}))});Gy.displayName="CartesianAxis";var Zne=["x1","y1","x2","y2","key"],Qne=["offset"],eie=["xAxisId","yAxisId"],tie=["xAxisId","yAxisId"];function E2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E2(Object(r),!0).forEach(function(a){rie(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rie(e,t,r){return(t=sie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sie(e){var t=aie(e,"string");return typeof t=="symbol"?t:t+""}function aie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ri(){return Ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ri.apply(null,arguments)}function Ju(e,t){if(e==null)return{};var r,a,n=nie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var iie=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:a,y:n,width:i,height:l,ry:o}=e;return v.createElement("rect",{x:a,y:n,ry:o,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function y5(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:a,y1:n,x2:i,y2:l,key:o}=t,c=Ju(t,Zne),u=ji(c),{offset:d}=u,m=Ju(u,Qne);r=v.createElement("line",Ri({},m,{x1:a,y1:n,x2:i,y2:l,fill:"none",key:o}))}return r}function lie(e){var{x:t,width:r,horizontal:a=!0,horizontalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Ju(e,eie),c=n.map((u,d)=>{var m=_s(_s({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return y5(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function oie(e){var{y:t,height:r,vertical:a=!0,verticalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Ju(e,tie),c=n.map((u,d)=>{var m=_s(_s({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return y5(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function cie(e){var{horizontalFill:t,fillOpacity:r,x:a,y:n,width:i,height:l,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var h=!u[f+1],x=h?n+l-m:u[f+1]-m;if(x<=0)return null;var p=f%t.length;return v.createElement("rect",{key:"react-".concat(f),y:m,x:a,height:x,width:i,stroke:"none",fill:t[p],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function die(e){var{vertical:t=!0,verticalFill:r,fillOpacity:a,x:n,y:i,width:l,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var h=!u[f+1],x=h?n+l-m:u[f+1]-m;if(x<=0)return null;var p=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:m,y:i,width:x,height:o,stroke:"none",fill:r[p],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var uie=(e,t)=>{var{xAxis:r,width:a,height:n,offset:i}=e;return xA(Hy(_s(_s(_s({},Vy),r),{},{ticks:gA(r),viewBox:{x:0,y:0,width:a,height:n}})),i.left,i.left+i.width,t)},mie=(e,t)=>{var{yAxis:r,width:a,height:n,offset:i}=e;return xA(Hy(_s(_s(_s({},Vy),r),{},{ticks:gA(r),viewBox:{x:0,y:0,width:a,height:n}})),i.top,i.top+i.height,t)},fie={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Jo(e){var t=jv(),r=wv(),a=jA(),n=_s(_s({},qs(e,fie)),{},{x:ut(e.x)?e.x:a.left,y:ut(e.y)?e.y:a.top,width:ut(e.width)?e.width:a.width,height:ut(e.height)?e.height:a.height}),{xAxisId:i,yAxisId:l,x:o,y:c,width:u,height:d,syncWithTicks:m,horizontalValues:f,verticalValues:h}=n,x=Va(),p=ct(k=>SN(k,"xAxis",i,x)),g=ct(k=>SN(k,"yAxis",l,x));if(!ut(u)||u<=0||!ut(d)||d<=0||!ut(o)||o!==+o||!ut(c)||c!==+c)return null;var j=n.verticalCoordinatesGenerator||uie,w=n.horizontalCoordinatesGenerator||mie,{horizontalPoints:y,verticalPoints:b}=n;if((!y||!y.length)&&typeof w=="function"){var S=f&&f.length,E=w({yAxis:g?_s(_s({},g),{},{ticks:S?f:g.ticks}):void 0,width:t,height:r,offset:a},S?!0:m);Yo(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(y=E)}if((!b||!b.length)&&typeof j=="function"){var N=h&&h.length,T=j({xAxis:p?_s(_s({},p),{},{ticks:N?h:p.ticks}):void 0,width:t,height:r,offset:a},N?!0:m);Yo(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(b=T)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(iie,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),v.createElement(cie,Ri({},n,{horizontalPoints:y})),v.createElement(die,Ri({},n,{verticalPoints:b})),v.createElement(lie,Ri({},n,{offset:a,horizontalPoints:y,xAxis:p,yAxis:g})),v.createElement(oie,Ri({},n,{offset:a,verticalPoints:b,xAxis:p,yAxis:g})))}Jo.displayName="CartesianGrid";var hie=["dangerouslySetInnerHTML","ticks"],pie=["id"],xie=["domain"],gie=["domain"];function Ux(){return Ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ux.apply(null,arguments)}function Zu(e,t){if(e==null)return{};var r,a,n=vie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function yie(e){var t=_r();return v.useEffect(()=>(t(Yse(e)),()=>{t(Xse(e))}),[e,t]),null}var bie=e=>{var{xAxisId:t,className:r}=e,a=ct(yv),n=Va(),i="xAxis",l=ct(g=>vo(g,i,t,n)),o=ct(g=>fk(g,i,t,n)),c=ct(g=>ck(g,t)),u=ct(g=>AQ(g,t)),d=ct(g=>z_(g,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:f}=e,h=Zu(e,hie),{id:x}=d,p=Zu(d,pie);return v.createElement(Gy,Ux({},h,p,{scale:l,x:u.x,y:u.y,width:c.width,height:c.height,className:zt("recharts-".concat(i," ").concat(i),r),viewBox:a,ticks:o}))},jie={allowDataOverflow:ca.allowDataOverflow,allowDecimals:ca.allowDecimals,allowDuplicatedCategory:ca.allowDuplicatedCategory,height:ca.height,hide:!1,mirror:ca.mirror,orientation:ca.orientation,padding:ca.padding,reversed:ca.reversed,scale:ca.scale,tickCount:ca.tickCount,type:ca.type,xAxisId:0},wie=e=>{var t,r,a,n,i,l=qs(e,jie);return v.createElement(v.Fragment,null,v.createElement(yie,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.xAxisId,scale:l.scale,type:l.type,padding:l.padding,allowDataOverflow:l.allowDataOverflow,domain:l.domain,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,height:l.height,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(a=l.angle)!==null&&a!==void 0?a:0,minTickGap:(n=l.minTickGap)!==null&&n!==void 0?n:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),v.createElement(bie,l))},Nie=(e,t)=>{var{domain:r}=e,a=Zu(e,xie),{domain:n}=t,i=Zu(t,gie);return ao(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:ao({domain:r},{domain:n}):!1},Zo=v.memo(wie,Nie);Zo.displayName="XAxis";var Sie=["dangerouslySetInnerHTML","ticks"],Eie=["id"],Tie=["domain"],Cie=["domain"];function Wx(){return Wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wx.apply(null,arguments)}function Qu(e,t){if(e==null)return{};var r,a,n=Aie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Aie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function _ie(e){var t=_r();return v.useEffect(()=>(t(Jse(e)),()=>{t(Zse(e))}),[e,t]),null}var kie=e=>{var{yAxisId:t,className:r,width:a,label:n}=e,i=v.useRef(null),l=v.useRef(null),o=ct(yv),c=Va(),u=_r(),d="yAxis",m=ct(S=>vo(S,d,t,c)),f=ct(S=>dk(S,t)),h=ct(S=>kQ(S,t)),x=ct(S=>fk(S,d,t,c)),p=ct(S=>$_(S,t));if(v.useLayoutEffect(()=>{if(!(a!=="auto"||!f||Dy(n)||v.isValidElement(n)||p==null)){var S=i.current;if(S){var E=S.getCalculatedWidth();Math.round(f.width)!==Math.round(E)&&u(Qse({id:t,width:E}))}}},[x,f,u,n,t,a,p]),f==null||h==null||p==null)return null;var{dangerouslySetInnerHTML:g,ticks:j}=e,w=Qu(e,Sie),{id:y}=p,b=Qu(p,Eie);return v.createElement(Gy,Wx({},w,b,{ref:i,labelRef:l,scale:m,x:h.x,y:h.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:f.width,height:f.height,className:zt("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},Iie={allowDataOverflow:da.allowDataOverflow,allowDecimals:da.allowDecimals,allowDuplicatedCategory:da.allowDuplicatedCategory,hide:!1,mirror:da.mirror,orientation:da.orientation,padding:da.padding,reversed:da.reversed,scale:da.scale,tickCount:da.tickCount,type:da.type,width:da.width,yAxisId:0},Die=e=>{var t,r,a,n,i,l=qs(e,Iie);return v.createElement(v.Fragment,null,v.createElement(_ie,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.yAxisId,scale:l.scale,type:l.type,domain:l.domain,allowDataOverflow:l.allowDataOverflow,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,padding:l.padding,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,width:l.width,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(a=l.angle)!==null&&a!==void 0?a:0,minTickGap:(n=l.minTickGap)!==null&&n!==void 0?n:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),v.createElement(kie,l))},Pie=(e,t)=>{var{domain:r}=e,a=Qu(e,Tie),{domain:n}=t,i=Qu(t,Cie);return ao(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:ao({domain:r},{domain:n}):!1},Qo=v.memo(Die,Pie);Qo.displayName="YAxis";var e0={exports:{}},t0={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2;function Oie(){if(T2)return t0;T2=1;var e=Kx();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,n=e.useRef,i=e.useEffect,l=e.useMemo,o=e.useDebugValue;return t0.useSyncExternalStoreWithSelector=function(c,u,d,m,f){var h=n(null);if(h.current===null){var x={hasValue:!1,value:null};h.current=x}else x=h.current;h=l(function(){function g(S){if(!j){if(j=!0,w=S,S=m(S),f!==void 0&&x.hasValue){var E=x.value;if(f(E,S))return y=E}return y=S}if(E=y,r(w,S))return E;var N=m(S);return f!==void 0&&f(E,N)?(w=S,E):(w=S,y=N)}var j=!1,w,y,b=d===void 0?null:d;return[function(){return g(u())},b===null?void 0:function(){return g(b())}]},[u,d,m,f]);var p=a(c,h[0],h[1]);return i(function(){x.hasValue=!0,x.value=p},[p]),o(p),p},t0}var C2;function Rie(){return C2||(C2=1,e0.exports=Oie()),e0.exports}Rie();function Fie(e){e()}function Lie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Fie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!a||e===null||(a=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var A2={notify(){},get:()=>[]};function Mie(e,t){let r,a=A2,n=0,i=!1;function l(p){d();const g=a.subscribe(p);let j=!1;return()=>{j||(j=!0,g(),m())}}function o(){a.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){n++,r||(r=e.subscribe(c),a=Lie())}function m(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=A2)}function f(){i||(i=!0,d())}function h(){i&&(i=!1,m())}const x={addNestedSub:l,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>a};return x}var Bie=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zie=Bie(),$ie=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Uie=$ie(),Wie=()=>zie||Uie?v.useLayoutEffect:v.useEffect,Hie=Wie(),Vie=Symbol.for("react-redux-context"),Gie=typeof globalThis<"u"?globalThis:{};function qie(){if(!v.createContext)return{};const e=Gie[Vie]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var Kie=qie();function Yie(e){const{children:t,context:r,serverState:a,store:n}=e,i=v.useMemo(()=>{const c=Mie(n);return{store:n,subscription:c,getServerState:a?()=>a:void 0}},[n,a]),l=v.useMemo(()=>n.getState(),[n]);Hie(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),l!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,l]);const o=r||Kie;return v.createElement(o.Provider,{value:i},t)}var Xie=Yie,Jie=(e,t)=>t,qy=_e([Jie,Xt,L_,as,Ak,Yn,Oee,rs],Bee),Ky=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},b5=Ua("mouseClick"),j5=Kc();j5.startListening({actionCreator:b5,effect:(e,t)=>{var r=e.payload,a=qy(t.getState(),Ky(r));a?.activeIndex!=null&&t.dispatch(WQ({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Hx=Ua("mouseMove"),w5=Kc();w5.startListening({actionCreator:Hx,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=Ny(a,a.tooltip.settings.shared),i=qy(a,Ky(r));n==="axis"&&(i?.activeIndex!=null?t.dispatch(jk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(bk()))}});var _2={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},N5=Ea({name:"rootProps",initialState:_2,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:_2.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Zie=N5.reducer,{updateOptions:Qie}=N5.actions,S5=Ea({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:ele}=S5.actions,tle=S5.reducer,E5=Ua("keyDown"),T5=Ua("focus"),Yy=Kc();Yy.startListening({actionCreator:E5,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=Number(Sy(n,bo(r))),o=Yn(r);if(i==="Enter"){var c=Vu(r,"axis","hover",String(n.index));t.dispatch(Fx({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:c}));return}var u=OQ(r),d=u==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,f=l+m*d;if(!(o==null||f>=o.length||f<0)){var h=Vu(r,"axis","hover",String(f));t.dispatch(Fx({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});Yy.startListening({actionCreator:T5,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",l=Vu(r,"axis","hover",String(i));t.dispatch(Fx({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:l}))}}}});var Oa=Ua("externalEvent"),C5=Kc();C5.startListening({actionCreator:Oa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),a={activeCoordinate:Eee(r),activeDataKey:Dk(r),activeIndex:al(r),activeLabel:Ik(r),activeTooltipIndex:al(r),isTooltipActive:Tee(r)};e.payload.handler(a,e.payload.reactEvent)}}});var rle=_e([yo],e=>e.tooltipItemPayloads),sle=_e([rle,nd,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var n=e.find(o=>o.settings.dataKey===a);if(n!=null){var{positions:i}=n;if(i!=null){var l=t(i,r);return l}}}),A5=Ua("touchMove"),_5=Kc();_5.startListening({actionCreator:A5,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=Ny(a,a.tooltip.settings.shared);if(n==="axis"){var i=qy(a,Ky({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(jk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var l,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(yA),d=(l=c.getAttribute(bA))!==null&&l!==void 0?l:void 0,m=sle(t.getState(),u,d);t.dispatch(yk({activeDataKey:d,activeIndex:u,activeCoordinate:m}))}}});var ale=VC({brush:gne,cartesianAxis:eae,chartData:tte,errorBars:hae,graphicalItems:vse,layout:Rq,legend:EK,options:Xee,polarAxis:Ore,polarOptions:tle,referenceElements:Sne,rootProps:Zie,tooltip:HQ}),nle=function(t){return iq({reducer:ale,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([j5.middleware,w5.middleware,Yy.middleware,C5.middleware,_5.middleware]),devTools:pl.devToolsEnabled})};function k5(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,n=Va(),i=v.useRef(null);if(n)return r;i.current==null&&(i.current=nle(t));var l=mv;return v.createElement(Xie,{context:l,store:i.current},r)}function I5(e){var{layout:t,width:r,height:a,margin:n}=e,i=_r(),l=Va();return v.useEffect(()=>{l||(i(Dq(t)),i(Pq({width:r,height:a})),i(Iq(n)))},[i,l,t,r,a,n]),null}function D5(e){var t=_r();return v.useEffect(()=>{t(Qie(e))},[t,e]),null}var ile=["children"];function lle(e,t){if(e==null)return{};var r,a,n=ole(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ole(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function em(){return em=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},em.apply(null,arguments)}var cle={width:"100%",height:"100%"},dle=v.forwardRef((e,t)=>{var r=jv(),a=wv(),n=EA();if(!Jl(r)||!Jl(a))return null;var{children:i,otherAttributes:l,title:o,desc:c}=e,u,d;return typeof l.tabIndex=="number"?u=l.tabIndex:u=n?0:void 0,typeof l.role=="string"?d=l.role:d=n?"application":void 0,v.createElement(sv,em({},l,{title:o,desc:c,role:d,tabIndex:u,width:r,height:a,style:cle,ref:t}),i)}),ule=e=>{var{children:t}=e,r=ct(Dm);if(!r)return null;var{width:a,height:n,y:i,x:l}=r;return v.createElement(sv,{width:a,height:n,x:l,y:i},t)},k2=v.forwardRef((e,t)=>{var{children:r}=e,a=lle(e,ile),n=Va();return n?v.createElement(ule,null,r):v.createElement(dle,em({ref:t},a),r)});function mle(){var e=_r(),[t,r]=v.useState(null),a=ct(dK);return v.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;Sa(i)&&i!==a&&e(Oq(i))}},[t,e,a]),r}function I2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function fle(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I2(Object(r),!0).forEach(function(a){hle(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hle(e,t,r){return(t=ple(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ple(e){var t=xle(e,"string");return typeof t=="symbol"?t:t+""}function xle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gle=v.forwardRef((e,t)=>{var{children:r,className:a,height:n,onClick:i,onContextMenu:l,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:m,onMouseUp:f,onTouchEnd:h,onTouchMove:x,onTouchStart:p,style:g,width:j}=e,w=_r(),[y,b]=v.useState(null),[S,E]=v.useState(null);dte();var N=mle(),T=v.useCallback(F=>{N(F),typeof t=="function"&&t(F),b(F),E(F)},[N,t,b,E]),k=v.useCallback(F=>{w(b5(F)),w(Oa({handler:i,reactEvent:F}))},[w,i]),I=v.useCallback(F=>{w(Hx(F)),w(Oa({handler:u,reactEvent:F}))},[w,u]),D=v.useCallback(F=>{w(bk()),w(Oa({handler:d,reactEvent:F}))},[w,d]),A=v.useCallback(F=>{w(Hx(F)),w(Oa({handler:m,reactEvent:F}))},[w,m]),M=v.useCallback(()=>{w(T5())},[w]),G=v.useCallback(F=>{w(E5(F.key))},[w]),q=v.useCallback(F=>{w(Oa({handler:l,reactEvent:F}))},[w,l]),z=v.useCallback(F=>{w(Oa({handler:o,reactEvent:F}))},[w,o]),ee=v.useCallback(F=>{w(Oa({handler:c,reactEvent:F}))},[w,c]),U=v.useCallback(F=>{w(Oa({handler:f,reactEvent:F}))},[w,f]),X=v.useCallback(F=>{w(Oa({handler:p,reactEvent:F}))},[w,p]),oe=v.useCallback(F=>{w(A5(F)),w(Oa({handler:x,reactEvent:F}))},[w,x]),Ee=v.useCallback(F=>{w(Oa({handler:h,reactEvent:F}))},[w,h]);return v.createElement(Mk.Provider,{value:y},v.createElement(mC.Provider,{value:S},v.createElement("div",{className:zt("recharts-wrapper",a),style:fle({position:"relative",cursor:"default",width:j,height:n},g),onClick:k,onContextMenu:q,onDoubleClick:z,onFocus:M,onKeyDown:G,onMouseDown:ee,onMouseEnter:I,onMouseLeave:D,onMouseMove:A,onMouseUp:U,onTouchEnd:Ee,onTouchMove:oe,onTouchStart:X,ref:T},r)))}),vle=["children","className","width","height","style","compact","title","desc"];function yle(e,t){if(e==null)return{};var r,a,n=ble(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ble(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var P5=v.forwardRef((e,t)=>{var{children:r,className:a,width:n,height:i,style:l,compact:o,title:c,desc:u}=e,d=yle(e,vle),m=ji(d);return o?v.createElement(k2,{otherAttributes:m,title:c,desc:u},r):v.createElement(gle,{className:a,style:l,width:n,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(k2,{otherAttributes:m,title:c,desc:u,ref:t},v.createElement(Tne,null,r)))}),jle=["width","height"];function Vx(){return Vx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vx.apply(null,arguments)}function wle(e,t){if(e==null)return{};var r,a,n=Nle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Nle(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Sle={top:5,right:5,bottom:5,left:5},Ele={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Sle,reverseStackOrder:!1,syncMethod:"index"},Tle=v.forwardRef(function(t,r){var a,n=qs(t.categoricalChartProps,Ele),{width:i,height:l}=n,o=wle(n,jle);if(!Jl(i)||!Jl(l))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,categoricalChartProps:f}=t,h={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,eventEmitter:void 0};return v.createElement(k5,{preloadedState:{options:h},reduxStoreName:(a=f.id)!==null&&a!==void 0?a:c},v.createElement(p5,{chartData:f.data}),v.createElement(I5,{width:i,height:l,layout:n.layout,margin:n.margin}),v.createElement(D5,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(P5,Vx({},o,{width:i,height:l,ref:r})))}),Cle=["axis","item"],Jd=v.forwardRef((e,t)=>v.createElement(Tle,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Cle,tooltipPayloadSearcher:Bk,categoricalChartProps:e,ref:t}));function Ale(e){var t=_r();return v.useEffect(()=>{t(ele(e))},[t,e]),null}var _le=["width","height","layout"];function Gx(){return Gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gx.apply(null,arguments)}function kle(e,t){if(e==null)return{};var r,a,n=Ile(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ile(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Dle={top:5,right:5,bottom:5,left:5},Ple={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Dle,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Ole=v.forwardRef(function(t,r){var a,n=qs(t.categoricalChartProps,Ple),{width:i,height:l,layout:o}=n,c=kle(n,_le);if(!Jl(i)||!Jl(l))return null;var{chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f}=t,h={chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(k5,{preloadedState:{options:h},reduxStoreName:(a=n.id)!==null&&a!==void 0?a:u},v.createElement(p5,{chartData:n.data}),v.createElement(I5,{width:i,height:l,layout:o,margin:n.margin}),v.createElement(D5,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(Ale,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),v.createElement(P5,Gx({width:i,height:l},c,{ref:r})))}),Rle=["item"],Fle={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},O5=v.forwardRef((e,t)=>{var r=qs(e,Fle);return v.createElement(Ole,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Rle,tooltipPayloadSearcher:Bk,categoricalChartProps:r,ref:t})});const R5={getAcademicOverview:async()=>{try{return(await Se.get("/dashboard/academic/overview")).data}catch(e){throw console.error("Error fetching academic dashboard overview:",e),e}},getTraineeOverview:async()=>{try{return(await Se.get("/dashboard/trainee/overview")).data}catch(e){throw console.error("Error fetching trainee dashboard overview:",e),e}}},Lle=()=>{const e=ft(),[t,r]=v.useState(!1),a=[{title:"Create New Assessment Event",description:"Create a new assessment event for trainees",icon:va,action:()=>{e(Pe.ASSESSMENT_EVENTS)},color:"primary"},{title:"View All Departments",description:"View and manage all academic departments",icon:Ws,action:()=>{e("/academic/departments")},color:"primary"}],[n,i]=v.useState({ongoingCourses:[],ongoingEnrollments:[],assessmentStatuses:[],passFailRate:[]});v.useEffect(()=>{(async()=>{r(!0);try{const d=await R5.getAcademicOverview(),m=(d.ongoingCourseByDepartment||[]).map(p=>({department:p.departmentCode,count:p.ongoingCourseCount})),f=(d.ongoingEnrollmentByDepartment||[]).map(p=>({department:p.departmentCode,count:p.ongoingEnrollmentCount})),h=(d.assessmentStatusDistribution||[]).map(p=>({status:p.status,count:p.count})),x=(d.trainingEffectivenessByDepartment||[]).map(p=>({department:p.departmentCode,pass:p.passCount,fail:p.failCount}));i({ongoingCourses:m,ongoingEnrollments:f,assessmentStatuses:h,passFailRate:x})}catch(d){console.error("Error fetching analytics data:",d),te.error(d.response?.data?.message||"Failed to load dashboard data")}finally{r(!1)}})()},[]);const l=["#1b3c53","#456882","#6a9fb8","#8fb6ce","#b4d3e4","#d9e9f2"],o={NOT_STARTED:"#4f81acff",ON_GOING:"#17a2b8",SUBMITTED:"#4c3a98ff",APPROVED:"#386268ff",REJECTED:"#ae529cff",CANCELLED:"#b84646ff"},c=u=>({NOT_STARTED:"Not Started",ON_GOING:"Ongoing",SUBMITTED:"Submitted",APPROVED:"Approved",REJECTED:"Rejected",CANCELLED:"Cancelled"})[u]||u;return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(Be,{className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{lg:12,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(Y.Body,{children:s.jsx(ue,{children:a.map((u,d)=>s.jsx(H,{md:6,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:u.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(u.icon,{size:24,className:`text-${u.color} me-2`}),s.jsx("h6",{className:"mb-0",children:u.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:u.description}),s.jsx(vn,{size:16,className:`text-${u.color} ms-auto`})]})},d))})})]})})}),t?s.jsx(ue,{children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading analytics data..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Ol,{className:"me-2",size:20}),"Ongoing Courses"]})}),s.jsx(Y.Body,{style:{padding:"20px"},children:s.jsx(Il,{width:"100%",height:450,children:s.jsxs(Jd,{data:n.ongoingCourses,margin:{top:20,right:30,left:20,bottom:50},children:[s.jsx(Jo,{strokeDasharray:"3 3"}),s.jsx(Zo,{dataKey:"department",angle:-45,textAnchor:"end",tick:{fontSize:13},interval:0,height:50}),s.jsx(Qo,{width:60,allowDecimals:!1}),s.jsx(kl,{formatter:u=>[u,"Count"],labelFormatter:u=>`Department: ${u}`}),s.jsx(ii,{verticalAlign:"bottom",wrapperStyle:{paddingTop:"10px"}}),s.jsx(Pl,{dataKey:"count",fill:"#1b3c53",name:"Number of Courses"})]})})})]})}),s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Ol,{className:"me-2",size:20}),"Ongoing Trainees"]})}),s.jsx(Y.Body,{style:{padding:"20px"},children:s.jsx(Il,{width:"100%",height:450,children:s.jsxs(Jd,{data:n.ongoingEnrollments,margin:{top:20,right:30,left:20,bottom:50},children:[s.jsx(Jo,{strokeDasharray:"3 3"}),s.jsx(Zo,{dataKey:"department",angle:-45,textAnchor:"end",tick:{fontSize:13},interval:0,height:50}),s.jsx(Qo,{width:60}),s.jsx(kl,{formatter:u=>[u,"Count"],labelFormatter:u=>`Department: ${u}`}),s.jsx(ii,{verticalAlign:"bottom",wrapperStyle:{paddingTop:"10px"}}),s.jsx(Pl,{dataKey:"count",fill:"#456882",name:"Number of Trainees"})]})})})]})})]}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Zx,{className:"me-2",size:20}),"Assessment Results"]})}),s.jsx(Y.Body,{style:{padding:"20px"},children:s.jsx(Il,{width:"100%",height:450,children:s.jsxs(O5,{margin:{top:50,right:30,left:20},children:[s.jsx($y,{data:n.assessmentStatuses,cx:"50%",cy:"45%",labelLine:!1,label:({status:u,percent:d})=>d<.03?"":`${(d*100).toFixed(0)}%`,outerRadius:180,fill:"#8884d8",dataKey:"count",nameKey:"status",children:n.assessmentStatuses.map((u,d)=>s.jsx(jo,{fill:o[u.status]||l[d%l.length]},`cell-${d}`))}),s.jsx(kl,{formatter:(u,d)=>[u,c(d)]}),s.jsx(ii,{formatter:u=>c(u),verticalAlign:"bottom",wrapperStyle:{paddingTop:"20px"}})]})})})]})}),s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Ol,{className:"me-2",size:20}),"Training Effectiveness (Pass/Fail Rate)"]})}),s.jsx(Y.Body,{style:{padding:"20px"},children:s.jsx(Il,{width:"100%",height:450,children:s.jsxs(Jd,{data:n.passFailRate,margin:{top:20,right:30,left:20,bottom:50},children:[s.jsx(Jo,{strokeDasharray:"3 3"}),s.jsx(Zo,{dataKey:"department",angle:-45,textAnchor:"end",tick:{fontSize:13},interval:0,height:50}),s.jsx(Qo,{width:60}),s.jsx(kl,{formatter:(u,d)=>d==="pass"?[u,"Pass"]:d==="fail"?[u,"Fail"]:[u,d],labelFormatter:u=>`Department: ${u}`}),s.jsx(ii,{verticalAlign:"bottom",wrapperStyle:{paddingTop:"10px"}}),s.jsx(Pl,{dataKey:"pass",stackId:"a",fill:"#28a745",name:"Pass"}),s.jsx(Pl,{dataKey:"fail",stackId:"a",fill:"#dc3545",name:"Fail"})]})})})]})})]})]})]})})},Mle=({courses:e,loading:t,actionsComponent:r,onView:a,onDisable:n})=>{const{sortedData:i,sortConfig:l,handleSort:o}=ts(e);if(t)return s.jsx(Fr,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"This department doesn't have any courses yet."})]})});const c=({columnKey:u,children:d,className:m=""})=>{const f=l.key===u,h=f?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:h,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container course-table-responsive",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(c,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(c,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(c,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(c,{columnKey:"venue",className:"show-mobile",children:"Venue"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((u,d)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>a(u.id),style:{cursor:"pointer"},children:u.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:u.code})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.startDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.endDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ec,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.venue||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ae,{bg:u.status==="ACTIVE"||u.status==="ON_GOING"?"success":u.status==="ARCHIVED"?"warning":u.status==="PLANNED"?"info":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content",textTransform:"uppercase"},children:u.status?.replace(/_/g," ")||"N/A"})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{course:u,onView:a,onDisable:n})})]},u.id))})]})})},Ble=({course:e,onView:t,onDisable:r})=>{const a=()=>{t&&t(e.id)},n=()=>{r&&r(e.id)};return s.jsx(Nt,{permissions:[De.VIEW_COURSE_DETAILS,De.ARCHIVE_COURSE,De.UPDATE_COURSE],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:a,permission:De.VIEW_COURSE_DETAILS},{type:"divider"},{label:"Archive Course",icon:s.jsx(zr,{}),className:"text-danger",onClick:n,permission:De.ARCHIVE_COURSE}]})})},zle=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[l,o]=v.useState({});v.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}),t()},u=f=>{const{name:h,value:x}=f.target;if(i(p=>({...p,[h]:x})),l[h]&&o(p=>({...p,[h]:""})),h==="startDate"&&x){const p=new Date;p.setHours(0,0,0,0),new Date(x+"T00:00:00")<p&&o(j=>({...j,startDate:"Start date cannot be in the past"}))}if(h==="endDate"&&x){const p=new Date;p.setHours(0,0,0,0),new Date(x+"T00:00:00")<p&&o(j=>({...j,endDate:"End date cannot be in the past"}))}},d=()=>{const f={};if(n.name.trim()||(f.name="Course name is required"),n.code.trim()||(f.code="Course code is required"),n.description.trim(),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(f.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(f.venue="Venue is required"),n.passScore&&(isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(f.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)f.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<h&&(f.startDate="Start date cannot be in the past")}if(!n.endDate)f.endDate="End date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<h&&(f.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(f.endDate="End date must be after start date"),o(f),Object.keys(f).length===0},m=async f=>{if(f.preventDefault(),!!d())try{await r(n),c()}catch{}};return s.jsxs(se,{show:e,onHide:c,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-2",size:20}),"Add New Course"]}),s.jsx(ae,{variant:"link",onClick:c,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(_,{onSubmit:m,children:[s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto",paddingTop:"1.5rem"},children:[s.jsxs(ue,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Name *"}),s.jsx(_.Control,{type:"text",name:"name",value:n.name,onChange:u,isInvalid:!!l.name,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.name})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Code *"}),s.jsx(_.Control,{type:"text",name:"code",value:n.code,onChange:u,isInvalid:!!l.code,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.code})]})})]}),s.jsxs(ue,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Max Trainees *"}),s.jsx(_.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:u,isInvalid:!!l.maxNumTrainee,disabled:a,min:"1"}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.maxNumTrainee})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Pass Score"}),s.jsx(_.Control,{type:"number",name:"passScore",value:n.passScore,onChange:u,onKeyPress:f=>f.key==="."&&f.preventDefault(),isInvalid:!!l.passScore,disabled:a,min:"0",max:"100",step:"1"}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),s.jsxs(ue,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Level"}),s.jsxs(_.Select,{name:"level",value:n.level,onChange:u,disabled:a,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Venue *"}),s.jsx(_.Control,{type:"text",name:"venue",value:n.venue,onChange:u,isInvalid:!!l.venue,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.venue})]})})]}),s.jsxs(ue,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Start Date *"}),s.jsx(_.Control,{type:"date",name:"startDate",value:n.startDate,onChange:u,isInvalid:!!l.startDate,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.startDate})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"End Date *"}),s.jsx(_.Control,{type:"date",name:"endDate",value:n.endDate,onChange:u,isInvalid:!!l.endDate,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),s.jsx(ue,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Description"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:u,isInvalid:!!l.description,disabled:a}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.description})]})})}),s.jsx(ue,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(_.Group,{className:"mb-0",children:[s.jsx(_.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Note"}),s.jsx(_.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:u,disabled:a})]})})})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:c,disabled:a,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary-custom",type:"submit",disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},$le=({show:e,onClose:t,onArchive:r,course:a,loading:n=!1})=>{const[i,l]=v.useState(""),[o,c]=v.useState(""),d=i==="ARCHIVE",m=()=>{l(""),c(""),t()},f=async()=>{if(!d){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),m()}catch(x){c(x.message||"Failed to archive course. Please try again.")}},h=x=>{l(x.target.value),c("")};return s.jsxs(se,{show:e,onHide:m,centered:!0,children:[s.jsxs(se.Header,{className:"bg-warning text-dark border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",size:20}),"Archive Course"]}),s.jsx(ae,{variant:"link",onClick:m,className:"text-dark p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",children:[o&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:o}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Course Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Course Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description,s.jsx("br",{})]}),a?.venue&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Venue:"})," ",a?.venue,s.jsx("br",{})]}),a?.startDate&&a?.endDate&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Duration:"})," ",a?.startDate," to ",a?.endDate]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),s.jsx("li",{children:"Remove the course from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),s.jsx("li",{children:"Course data will be archived but can be restored if needed"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!d?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type ARCHIVE here",disabled:n}),i&&!d&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:m,disabled:n,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"warning",onClick:f,disabled:n||!d,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gt,{className:"me-2",size:16}),"Archive Course"]})})]})]})},Ule=({show:e,onClose:t,departmentHead:r,department:a})=>{if(!r)return null;const n=l=>l?l.split("_").map(o=>o.charAt(0)+o.slice(1).toLowerCase()).join(" "):"Department Head",i=[r.lastName,r.middleName,r.firstName].filter(Boolean).join(" ");return s.jsxs(se,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsxs(se.Title,{children:[s.jsx(Lt,{className:"me-2"}),"Department Head Details"]})}),s.jsx(se.Body,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:s.jsx(Lt,{size:40,className:"text-white"})}),s.jsx("h5",{className:"mb-1",children:i}),s.jsx(Ae,{bg:"primary",className:"mb-2",children:n(r.role?.name)}),s.jsx("p",{className:"text-muted small mb-0",children:a?.name})]})}),s.jsx(H,{md:8,children:s.jsx(ue,{className:"g-4",children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vi,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Email"}),s.jsx("div",{className:"fw-semibold",children:r.email||"N/A"})]})]})})})})]})}),s.jsx(se.Footer,{children:s.jsx(ae,{variant:"secondary",onClick:t,children:"Close"})})]})},Wle=({courseId:e})=>{const t=ft(),[r,a]=v.useState(null),[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(!1),[d,m]=v.useState("add"),[f,h]=v.useState(!1),[x,p]=v.useState(null),[g,j]=v.useState(null),[w,y]=v.useState(!1),[b,S]=v.useState(!1),E={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},N=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];v.useEffect(()=>{e&&(async()=>{o(!0);try{const q=await kr.getDepartmentById(e);if(!q)throw new Error(`Department with ID ${e} not found in API response`);const z={id:q.id,name:q.name,code:q.code,description:q.description,duration:"N/A",status:q.isActive,totalSubjects:q.courseCount||0,totalTrainers:q.trainerCount||0};a(z);const U=(q.courses||[]).filter(X=>X.status!=="ARCHIVED").map(X=>({id:X.id,name:X.name,code:X.code,startDate:X.startDate?new Date(X.startDate).toISOString().split("T")[0]:"N/A",endDate:X.endDate?new Date(X.endDate).toISOString().split("T")[0]:"N/A",venue:X.venue||"N/A",note:X.note||"N/A",status:X.status,description:X.description,maxNumTrainee:X.maxNumTrainee,passScore:X.passScore,level:X.level,subjectCount:X.subjectCount||0}))||[];i(U),q.headUser&&j(q.headUser),o(!1)}catch{o(!1);const G=E[e];G&&(a(G),i(N.filter(q=>q.status!=="ARCHIVED")))}})()},[e]);const T=()=>{m("add"),u(!0)},k=M=>{const G=n.find(q=>q.id===M);p(G),h(!0)},I=async M=>{try{await kr.archiveCourse(M),te.success("Course archived successfully"),i(G=>G.filter(q=>q.id!==M)),h(!1),p(null)}catch(G){throw te.error("Failed to archive course. Please try again."),G}},D=M=>{t(Pe.ACADEMIC_COURSE_DETAIL(M),{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},A=async M=>{try{S(!0);const G={departmentId:r.id,name:M.name,description:M.description,code:M.code,maxNumTrainee:Number(M.maxNumTrainee),venue:M.venue,note:M.note,passScore:Number(M.passScore),startDate:M.startDate?new Date(M.startDate).toISOString():null,endDate:M.endDate?new Date(M.endDate).toISOString():null,level:M.level},q=await kr.createCourse(G);te.success("Course created successfully");try{const ee=await kr.getDepartmentById(r.id);if(ee&&ee.courses){const X=(ee.courses||[]).filter(oe=>oe.status!=="ARCHIVED").map(oe=>({id:oe.id,name:oe.name,code:oe.code,startDate:oe.startDate?new Date(oe.startDate).toISOString().split("T")[0]:"N/A",endDate:oe.endDate?new Date(oe.endDate).toISOString().split("T")[0]:"N/A",venue:oe.venue||"N/A",note:oe.note||"N/A",status:oe.status,description:oe.description,maxNumTrainee:oe.maxNumTrainee,passScore:oe.passScore,level:oe.level,subjectCount:oe.subjectCount||0}));i(X)}}catch(z){console.error("Error refetching courses after creation:",z);const ee={id:q.id||q.data?.id,name:q.name||q.data?.name,code:q.code||q.data?.code,startDate:q.startDate||q.data?.startDate?new Date(q.startDate||q.data?.startDate).toISOString().split("T")[0]:"N/A",endDate:q.endDate||q.data?.endDate?new Date(q.endDate||q.data?.endDate).toISOString().split("T")[0]:"N/A",venue:q.venue||q.data?.venue||"N/A",note:q.note||q.data?.note||"N/A",status:q.status||q.data?.status||"PLANNED",description:q.description||q.data?.description,maxNumTrainee:q.maxNumTrainee||q.data?.maxNumTrainee,passScore:q.passScore||q.data?.passScore,level:q.level||q.data?.level,subjectCount:q.subjectCount||q.data?.subjectCount||0};i(U=>[ee,...U])}}catch(G){throw G.response?.status,te.error(G.response?.data?.message||"Failed to create course"),G}finally{S(!1)}};return l?s.jsx(Be,{className:"py-4",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?s.jsxs(Be,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[s.jsx(ue,{className:"mb-1 flex-shrink-0",children:s.jsx(H,{children:s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsxs(Y.Body,{className:"p-2",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-1",children:[s.jsx($t,{className:"me-2 text-primary"}),r.name]}),s.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),s.jsx("p",{className:"text-muted mb-1 small",children:r.description}),s.jsxs(ue,{className:"g-2",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Courses"}),s.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Department Head"}),s.jsx("div",{className:"fw-semibold small",children:g?s.jsx(ae,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>y(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.lastName,g.middleName,g.firstName].filter(Boolean).join(" ")}):"Not assigned"})]})]})})]})]})})})}),s.jsx(ue,{className:"mt-3",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("h5",{className:"mb-0 text-white",children:[s.jsx(gt,{className:"me-2"}),"Courses (",n.length,")"]}),s.jsx(Nt,{permission:De.CREATE_COURSE,children:s.jsxs(ae,{variant:"light",size:"sm",onClick:T,className:"academic-course-add-btn",children:[s.jsx(yr,{size:16,className:"me-1"}),"Add New Course"]})})]})}),s.jsx("div",{className:"p-0",children:s.jsx(Mle,{courses:n,loading:!1,actionsComponent:Ble,onView:D,onDisable:k})})]})})}),s.jsx(zle,{show:c&&d==="add",onClose:()=>u(!1),onSave:A,loading:b}),s.jsx($le,{show:f,onClose:()=>h(!1),onArchive:I,course:x}),s.jsx(Ule,{show:w,onClose:()=>y(!1),departmentHead:g,department:r})]}):s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx($t,{size:48,className:"mb-3"}),s.jsx("h4",{children:"Department not found"}),s.jsx("p",{children:"The requested department could not be found."})]})})},Hle=()=>{const{courseId:e}=Or();return s.jsx(Wle,{courseId:e})},Vle=({trainer:e,onEdit:t,onDelete:r,editPermission:a})=>{const n=[];t&&(n.push({label:"Edit Trainer",icon:s.jsx(Ar,{}),onClick:()=>t(e.id),permission:a||De.UPDATE_SUBJECT}),n.push({type:"divider"})),n.push({label:"Remove Trainer",icon:s.jsx(ba,{}),className:"text-danger",onClick:()=>r(e.id),permission:De.REMOVE_TRAINERS});const i=t?[a||De.UPDATE_SUBJECT,De.REMOVE_TRAINERS]:[De.REMOVE_TRAINERS];return s.jsx(Nt,{permissions:i,fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:n})})},F5=({trainers:e=[],variant:t="course",onEdit:r,onDelete:a,hasActionPermission:n=!0,editPermission:i=De.ASSIGN_TRAINERS,formatRole:l,emptyMessage:o="No trainers assigned yet."})=>{const u=l||(b=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[b]||{text:b,variant:"light"}),d=b=>{r&&r(t==="subject"?b:b.id)},m=b=>{a&&a(b.id)},f=b=>t==="subject"?b.name||"":b.name?b.name:[b.lastName,b.middleName,b.firstName].filter(Boolean).join(" ")||"",h=b=>t==="subject"?b.role:b.role||b.roleInCourse,x=b=>b?b.split("_").map(S=>S.charAt(0)+S.slice(1).toLowerCase()).join(" "):"-",p=b=>{if(t==="subject"){const S=h(b),E=u(S);return s.jsx(Ae,{bg:E.variant||"success",children:E.text})}else{const S=h(b);return typeof S=="string"?s.jsx(Ae,{bg:"success",children:x(S)}):Array.isArray(S)&&S.length>0?S.map((E,N)=>s.jsx(Ae,{bg:"success",className:"me-1",children:x(E)},N)):s.jsx("span",{className:"text-muted",children:"-"})}};if(!e||e.length===0)return s.jsx("div",{className:"alert alert-info",children:o});const g=t==="subject",j=!g,w=!g,y=!g;return s.jsx("div",{className:"scrollable-table-container admin-table trainer-table-scroll",children:s.jsxs(dr,{hover:!0,className:"mb-0",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[j&&s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"#"}),s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"EID"}),s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Name"}),w&&s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Email"}),y&&s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Phone"}),s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Role"}),n&&s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Actions"})]})}),s.jsx("tbody",{children:e.map((b,S)=>s.jsxs("tr",{className:`${S%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:E=>{E.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:E=>{E.currentTarget.style.backgroundColor=S%2===0?"white":"var(--bs-neutral-50)"},children:[j&&s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:S+1}),s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx(Ae,{bg:"secondary",className:"text-white",children:b.eid})}),s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx("span",{className:"fw-medium text-dark",children:f(b)})}),w&&s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx("span",{className:"text-dark",children:b.email||"-"})}),y&&s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx("span",{className:"text-dark",children:b.phoneNumber||"-"})}),s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:p(b)}),n&&s.jsx("td",{className:"align-middle text-center",style:{borderLeft:"none",borderRight:"none"},children:s.jsx(Vle,{trainer:b,onEdit:r?()=>d(b):void 0,onDelete:a?()=>m(b):void 0,editPermission:i})})]},b.id))})]})})},L5=({show:e,onClose:t,onDisable:r,subject:a,loading:n=!1})=>{const[i,l]=v.useState(""),[o,c]=v.useState(""),[u,d]=v.useState(0),[m,f]=v.useState(!1),x=i==="ARCHIVE";v.useEffect(()=>{e&&a?.id?p():(d(0),l(""),c(""))},[e,a?.id]);const p=async()=>{if(a?.id){f(!0);try{const y=await gs.getSubjectById(a.id);y?.enrollmentCount!==void 0?d(y.enrollmentCount):y?.enrollments&&Array.isArray(y.enrollments)?d(y.enrollments.length):d(0)}catch{d(0)}finally{f(!1)}}},g=()=>{l(""),c(""),d(0),t()},j=async()=>{if(!x){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),g()}catch(y){c(y.message||"Failed to disable subject. Please try again.")}},w=y=>{l(y.target.value),c("")};return s.jsxs(se,{show:e,onHide:g,centered:!0,children:[s.jsx(se.Header,{className:"bg-warning text-dark border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",size:20}),"Archive Subject"]})}),s.jsxs(se.Body,{className:"p-4",children:[o&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:o}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Subject Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Subject Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Make the subject unavailable for new enrollments"}),s.jsx("li",{children:"Remove the subject from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),u>0&&s.jsxs("li",{className:"fw-bold",children:[s.jsxs("strong",{children:["Cascade cancel all ",u," enrollment",u>1?"s":""]})," associated with this subject"]})]}),u>0&&s.jsxs("div",{className:"alert alert-warning mb-0",children:[s.jsx("strong",{children:"Total Enrollments:"})," ",s.jsx(Ae,{bg:"warning",className:"text-dark ms-2",children:u}),u>0&&s.jsxs("p",{className:"mb-0 mt-2 small",children:["All ",u," enrollment",u>1?"s":""," will be automatically cancelled when this subject is archived."]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!x?"is-invalid":""}`,id:"confirmText",value:i,onChange:w,placeholder:"Type ARCHIVE here",disabled:n}),i&&!x&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsx(ae,{variant:"outline-secondary",onClick:g,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:"warning",onClick:j,disabled:n||!x||m,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gt,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},Gle=({show:e,onClose:t,onSave:r,subject:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[o,c]=v.useState([]),u=x=>{if(!x)return"";try{return new Date(x).toISOString().split("T")[0]}catch{return x}};v.useEffect(()=>{a&&e&&(l({name:a.name||"",code:a.code||"",description:a.description||"",method:a.method||"CLASSROOM",type:a.type||"UNLIMIT",roomName:a.roomName||"",remarkNote:a.remarkNote||"",timeSlot:a.timeSlot||"",isSIM:a.isSIM||!1,passScore:a.passScore||"",startDate:u(a.startDate),endDate:u(a.endDate)}),c([]))},[a,e]);const d=x=>{const{name:p,value:g,type:j,checked:w}=x.target;l(y=>({...y,[p]:j==="checkbox"?w:g}))},m=()=>{const x=[];i.name.trim()||x.push("Subject name is required"),i.code.trim()||x.push("Subject code is required");const p=String(i.passScore||"").trim();if(p&&(isNaN(p)||!Number.isInteger(parseFloat(p))||parseFloat(p)<0||parseFloat(p)>100)&&x.push("Pass score must be an integer between 0 and 100"),i.timeSlot.trim()){const g=i.timeSlot.split(/[;,]/).map(j=>j.trim()).filter(j=>j);if(g.length===0)x.push("Time slot cannot be empty");else{const j=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/;for(let w=0;w<g.length;w++){const b=g[w].split("-");if(b.length!==2){x.push(`Time slot ${w+1} must contain exactly one dash (-)`);continue}const[S,E]=b;if(!j.test(S)||!j.test(E)){x.push(`Time slot ${w+1} must be in format H:mm or HH:mm (e.g., 9:00-13:00 or 09:00-13:00)`);continue}const[N,T]=S.split(":").map(Number),[k,I]=E.split(":").map(Number);N*60+T>=k*60+I&&x.push(`Time slot ${w+1}: End time must be after start time`)}}}return i.startDate.trim()||x.push("Start date is required"),i.endDate.trim()||x.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate+"T00:00:00")>=new Date(i.endDate+"T00:00:00")&&x.push("End date must be after start date"),c(x),x.length===0},f=async x=>{if(x.preventDefault(),!!m())try{const p={name:i.name.trim(),code:i.code.trim(),description:i.description?.trim()||null,method:i.method,type:i.type,roomName:i.roomName?.trim()||null,remarkNote:i.remarkNote?.trim()||null,timeSlot:i.timeSlot?.trim()||null,isSIM:i.isSIM,passScore:i.passScore?parseFloat(i.passScore):null,startDate:i.startDate,endDate:i.endDate};await r(p),h()}catch{}},h=()=>{l({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),t()};return s.jsxs(se,{show:e,onHide:h,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ar,{className:"me-2",size:20}),"Edit Subject"]}),s.jsx(ae,{variant:"link",onClick:h,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[o.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((x,p)=>s.jsx("li",{children:x},p))})}),s.jsxs(_,{onSubmit:f,children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Subject Name *"}),s.jsx(_.Control,{type:"text",name:"name",value:i.name,onChange:d,placeholder:"Enter subject name",disabled:n,required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Subject Code *"}),s.jsx(_.Control,{type:"text",name:"code",value:i.code,onChange:d,placeholder:"Enter subject code",disabled:n,required:!0})]})})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Description"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:d,placeholder:"Enter subject description",disabled:n})]}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Method *"}),s.jsxs(_.Select,{name:"method",value:i.method,onChange:d,disabled:n,required:!0,children:[s.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),s.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),s.jsx("option",{value:"ERO",children:"ERO"})]})]})})}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Type *"}),s.jsxs(_.Select,{name:"type",value:i.type,onChange:d,disabled:n,required:!0,children:[s.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),s.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Venue"}),s.jsx(_.Control,{type:"text",name:"roomName",value:i.roomName,onChange:d,placeholder:"Enter venue",disabled:n})]})})]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Time Slot"}),s.jsx(_.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:d,placeholder:"e.g., 09:00-11:00",disabled:n})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Pass Score"}),s.jsx(_.Control,{type:"number",name:"passScore",value:i.passScore,onChange:d,onKeyPress:x=>x.key==="."&&x.preventDefault(),placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"1",disabled:n})]})})]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Start Date *"}),s.jsx(_.Control,{type:"date",name:"startDate",value:i.startDate,onChange:d,disabled:n,required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"End Date *"}),s.jsx(_.Control,{type:"date",name:"endDate",value:i.endDate,onChange:d,disabled:n,required:!0})]})})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Remark Note"}),s.jsx(_.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:d,placeholder:"Enter remark note",disabled:n})]}),s.jsx(_.Group,{className:"mb-3",children:s.jsx(_.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:d,label:"Is Simulator",disabled:n})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:h,disabled:n,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",onClick:f,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"me-2",size:16}),"Save Changes"]})})]})]})},qle=({show:e,onClose:t,onSave:r,trainer:a,loading:n=!1})=>{const[i,l]=v.useState({roleInSubject:"EXAMINER"}),[o,c]=v.useState([]);v.useEffect(()=>{if(a&&e){const h=a.role==="EXAMINER"||a.role==="ASSESSMENT_REVIEWER"?a.role:"EXAMINER";l({roleInSubject:h}),c([])}},[a,e]);const u=h=>{const{name:x,value:p}=h.target;l(g=>({...g,[x]:p}))},d=()=>{const h=[];return i.roleInSubject||h.push("Role in assessment is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!d())try{await r(i),f()}catch{}},f=()=>{l({roleInSubject:"EXAMINER"}),c([]),t()};return s.jsxs(se,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ar,{className:"me-2",size:20}),"Edit Trainer"]}),s.jsx(ae,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",children:[o.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((h,x)=>s.jsx("li",{children:h},x))})}),s.jsxs(_,{onSubmit:m,children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Trainer Name"}),s.jsx(_.Control,{type:"text",value:a?.name||"",disabled:!0,className:"bg-light"})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"EID"}),s.jsx(_.Control,{type:"text",value:a?.eid||"",disabled:!0,className:"bg-light"})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Role in Assessment *"}),s.jsxs(_.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:u,disabled:n,children:[s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),s.jsx(_.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"me-2",size:16}),"Save Changes"]})})]})]})},M5=({show:e,onClose:t,onSave:r,loading:a=!1,courseId:n=null,subjectId:i=null})=>{const[l,o]=v.useState({trainer_user_id:"",role_in_subject:"EXAMINER"}),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState(!1),x=v.useCallback(async()=>{h(!0);try{let w=[];try{const y=await kr.getActiveTrainers(n,i);y&&(y.data&&Array.isArray(y.data)?w=y.data:y.trainers&&Array.isArray(y.trainers)?w=y.trainers:y.data&&y.data.trainers&&Array.isArray(y.data.trainers)?w=y.data.trainers:Array.isArray(y)&&(w=y))}catch(y){console.error("Error loading active trainers:",y),w=[]}m(Array.isArray(w)?w:[])}catch(w){console.error("Error loading trainers:",w),m([])}finally{h(!1)}},[n,i]);v.useEffect(()=>{e&&(o({trainer_user_id:"",role_in_subject:"EXAMINER"}),u([]),x())},[e,n,i,x]);const p=()=>{const w=[];return l.trainer_user_id||w.push("Please select a trainer"),l.role_in_subject||w.push("Role in assessment is required"),u(w),w.length===0},g=async w=>{if(w.preventDefault(),!!p())try{const y={trainerUserId:l.trainer_user_id,roleInSubject:l.role_in_subject};await r(y),j()}catch(y){console.error("Error saving trainer:",y)}},j=()=>{o({trainer_user_id:"",role_in_subject:"EXAMINER"}),u([]),t()};return s.jsxs(se,{show:e,onHide:j,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-2",size:20}),"Add Trainer"]}),s.jsx(ae,{variant:"link",onClick:j,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",children:[c.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:c.map((w,y)=>s.jsx("li",{children:w},y))})}),s.jsx(_,{onSubmit:g,children:s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Select Trainer *"}),s.jsxs(Ct,{onSelect:w=>{o(y=>({...y,trainer_user_id:w||""}))},children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a||f,style:{border:"1px solid #ced4da",backgroundColor:a||f?"#e9ecef":"#fff",minWidth:0},children:s.jsx("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:l.trainer_user_id?d.find(w=>w.id===l.trainer_user_id)?d.find(w=>w.id===l.trainer_user_id).department?.name?`${d.find(w=>w.id===l.trainer_user_id).eid} - ${d.find(w=>w.id===l.trainer_user_id).lastName}${d.find(w=>w.id===l.trainer_user_id).middleName?" "+d.find(w=>w.id===l.trainer_user_id).middleName:""} ${d.find(w=>w.id===l.trainer_user_id).firstName} - ${d.find(w=>w.id===l.trainer_user_id).department.name}`:`${d.find(w=>w.id===l.trainer_user_id).eid} - ${d.find(w=>w.id===l.trainer_user_id).lastName}${d.find(w=>w.id===l.trainer_user_id).middleName?" "+d.find(w=>w.id===l.trainer_user_id).middleName:""} ${d.find(w=>w.id===l.trainer_user_id).firstName}`:"Choose a trainer...":f?"Loading trainers...":"Choose a trainer..."})}),s.jsx(Ct.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:f?s.jsxs(Ct.Item,{disabled:!0,children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Loading trainers..."]}):!Array.isArray(d)||d.length===0?s.jsx(Ct.Item,{disabled:!0,children:"No trainers available"}):d.map(w=>s.jsxs(Ct.Item,{eventKey:w.id,children:[w.eid," - ",w.lastName,w.middleName?" "+w.middleName:""," ",w.firstName,w.department?.name?` - ${w.department.name}`:""]},w.id))})]}),f&&s.jsxs("div",{className:"mt-2 text-center",children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),s.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Role in Assessment *"}),s.jsxs(Ct,{onSelect:w=>{o(y=>({...y,role_in_subject:w||"EXAMINER"}))},children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a,style:{border:"1px solid #ced4da",backgroundColor:a?"#e9ecef":"#fff",minWidth:0},children:s.jsxs("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:[l.role_in_subject==="EXAMINER"&&"Examiner - Conducts exams and assessments",l.role_in_subject==="ASSESSMENT_REVIEWER"&&"Assessment Reviewer - Reviews and grades assessments"]})}),s.jsxs(Ct.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:[s.jsx(Ct.Item,{eventKey:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx(Ct.Item,{eventKey:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]})]}),s.jsx(_.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})]})})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:j,disabled:a,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",onClick:g,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(yr,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},B5=({courseId:e,subjectId:t,onView:r})=>{const[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,c]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e&&!t){n([]),l(!1);return}try{l(!0),c(null);const p=((await vr.getAssessmentEvents())?.data?.events||[]).filter(g=>t?g.subjectId===t:e?g.courseId===e:!1).map((g,j)=>{let w="",y="";return g.entityInfo&&(g.entityInfo.type==="subject"?w=g.entityInfo.name||"":g.entityInfo.type==="course"&&(y=g.entityInfo.name||"")),{id:g.id||`event-${j}`,name:g.name||"N/A",subject:w,course:y,occurrenceDate:g.occuranceDate||g.occurrenceDate,status:g.status||"N/A",totalTrainees:g.totalTrainees||0,templateInfo:g.templateInfo,originalEvent:g}});n(p)}catch(f){console.error("Error loading assessment events:",f),c(f.response?.data?.message||f.message||"Failed to load assessment events"),te.error("Failed to load assessment events"),n([])}finally{l(!1)}})()},[e,t]);const u=m=>{switch(String(m||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"primary";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"ON_GOING":return"success";default:return"secondary"}},d=m=>{if(!m)return"-";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return i?s.jsx("div",{children:s.jsx(Fr,{rows:4,columns:6})}):o?s.jsx("div",{children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:o})]})}):a.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx(va,{size:48,className:"mb-3",style:{opacity:.5}}),s.jsx("h5",{children:"No assessment events found"}),s.jsxs("p",{children:["There are no assessment events available for this ",t?"subject":"course","."]})]})}):s.jsx("div",{children:s.jsx("div",{className:"table-responsive",children:s.jsxs(dr,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Template Name"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Occurrence Date"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Total Trainees"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Status"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((m,f)=>s.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:m.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:m.templateInfo?.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:d(m.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:s.jsx(Ae,{bg:"info",className:"px-2 py-1",children:m.totalTrainees||0})}),s.jsx("td",{className:"align-middle",children:s.jsx(Ae,{bg:u(m.status),className:"px-3 py-2",children:m.status?.replace(/_/g," ")||"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r&&r(m.originalEvent||m)}]})})]},m.id||f))})]})})})},Sl=({columnKey:e,children:t,className:r="",sortConfig:a,onSort:n})=>{const i=a?.key===e,l=i?a?.direction:null;return s.jsxs("th",{className:`fw-semibold ${r}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>n(e),onMouseEnter:o=>{o.target.style.backgroundColor="#214760",o.target.style.transform="translateY(-1px)",o.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:o=>{o.target.style.backgroundColor="var(--bs-primary)",o.target.style.transform="translateY(0)",o.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:i?"700":"600",color:"white",textTransform:"uppercase"},children:t}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:l,size:14,color:"white"})})]}),i&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},Xy=({show:e,onClose:t,event:r})=>{const[a,n]=v.useState("overview"),[i,l]=v.useState([]),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(!1),[h,x]=v.useState(!1),[p,g]=v.useState(null),[j,w]=v.useState(null),y=v.useCallback(async()=>{if(r?.id)try{c(!0);const C=await vr.getAssessmentsByEventId(r.id),W=C?.data?.assessments||C?.assessments||C?.data||[];l(Array.isArray(W)?W:[])}catch{r?.traineeRoster&&Array.isArray(r.traineeRoster)?l(r.traineeRoster):l([])}finally{c(!1)}},[r?.id,r?.traineeRoster]);v.useEffect(()=>{e&&r?.id&&(n("overview"),d(null),r?.traineeRoster&&Array.isArray(r.traineeRoster)?(l(r.traineeRoster),c(!1)):y())},[e,r?.id,r?.traineeRoster,y]),v.useEffect(()=>{a==="trainees"&&r?.traineeRoster&&Array.isArray(r.traineeRoster)&&i.length===0&&l(r.traineeRoster)},[a,r?.traineeRoster,i.length]),v.useEffect(()=>()=>{u&&URL.revokeObjectURL(u),j&&URL.revokeObjectURL(j)},[u,j]);const b=C=>{n(C),C==="trainees"&&i.length===0&&!o&&y()},S=async()=>{const C=r.templateInfo?.formId||r.templateInfo?.id;if(!C){te.error("Template information is not available");return}try{f(!0),x(!0);const W=await Dt.getTemplatePDF(C),Z=URL.createObjectURL(W);d(Z)}catch(W){console.error("Error loading template PDF:",W),te.error("Failed to load template PDF preview"),x(!1)}finally{f(!1)}},E=()=>{x(!1),u&&(URL.revokeObjectURL(u),d(null))},N=v.useMemo(()=>{if(!r)return[];const C=r?.traineeRoster&&Array.isArray(r.traineeRoster)?r.traineeRoster:i;return Array.isArray(C)?C.map((W,Z)=>{const J=W.traineeFullName||W.trainee?.fullName||`${W.trainee?.firstName||""} ${W.trainee?.lastName||""}`.trim()||`Trainee ${Z+1}`,le=W.traineeEid||W.eid||"",V=W.assessmentFormName||W.assessmentForm||W.name||"-",re=W.status||"NOT_STARTED",he=W.resultScore||W.score||null,O=W.resultText||W.result||null,ye=W.occuranceDate||W.occurrenceDate||r?.occuranceDate||r?.occurrenceDate||null,de=W.pdfUrl||null;return{assessmentFormId:W.assessmentFormId||Z,id:W.assessmentFormId||Z,assessmentForm:V,assessmentFormName:V,trainee:J,traineeEid:le,traineeEmail:le,traineeFullName:J,occurrenceDate:ye,occuranceDate:ye,status:re,score:he,resultScore:he,result:O,resultText:O,pdfUrl:de,percentage:he>0?he:null}}):[]},[r,i]),{sortedData:T,sortConfig:k,handleSort:I}=ts(Array.isArray(N)?N:[]);if(!r)return null;const D=C=>{if(!C)return"-";try{return new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return C}},A=C=>{switch(String(C||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"primary";case"COMPLETED":case"FINISHED":case"APPROVED":return"info";case"CANCELLED":case"CANCELED":case"REJECTED":return"danger";case"ONGOING":case"ON_GOING":return"success";default:return"secondary"}},M=C=>{const W=String(C).toUpperCase();let Z,J,le;switch(W){case"COMPLETED":case"APPROVED":Z="success",J=it,le="Completed";break;case"REJECTED":case"FAILED":Z="danger",J=zr,le="Failed";break;case"ONGOING":Z="warning",J=rt,le="In Progress";break;case"PENDING":Z="info",J=rt,le="Pending";break;case"NOT_STARTED":Z="secondary",J=Zt,le="Not Started";break;default:Z="secondary",J=Zt,le=C}const V=J;return s.jsxs(Ae,{bg:Z,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(V,{size:12}),le]})},G=()=>({total:r.totalTrainees||0,passed:r.totalPassed||0,failed:r.totalFailed||0,cancelled:r.totalCancelled||0,inProgress:0,pending:0,notStarted:0}),q=r.entityInfo?.type||"-",z=r.entityInfo?.name||"-",ee=r.entityInfo?.code||"-",U=r.templateInfo?.name||"-",X=r.templateInfo?.formId||r.templateInfo?.id,oe=q==="subject",Ee=oe?r.entityInfo:null,F=oe?r.entityInfo?.course||null:q==="course"?r.entityInfo:null,P=G();return s.jsxs(se,{show:e,onHide:t,size:"xl",centered:!0,dialogClassName:"assessment-event-detail-modal",onShow:()=>{document.body.style.overflow="hidden"},onExited:()=>{document.body.style.overflow="auto"},children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(se.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(va,{className:"me-2",size:20}),"Assessment Event Details"]}),s.jsx(ae,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},children:s.jsx(ht,{size:24,color:"#ffffff"})})]}),s.jsx(se.Body,{className:"p-0 assessment-event-modal-body",style:{maxHeight:"70vh",height:"70vh",overflow:"hidden",display:"flex",flexDirection:"column",backgroundColor:"#f8f9fa"},children:s.jsxs(Tt.Container,{activeKey:a,onSelect:b,children:[s.jsxs(Ye,{variant:"tabs",className:"border-bottom bg-white px-3",style:{margin:0,flexShrink:0},children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"overview",className:a==="overview"?"active":"",style:{color:a==="overview"?"var(--bs-primary)":"#6c757d",borderBottom:a==="overview"?"2px solid var(--bs-primary)":"none",fontWeight:a==="overview"?600:400},children:[s.jsx(gt,{className:"me-2",size:16}),"Overview"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"trainees",className:a==="trainees"?"active":"",style:{color:a==="trainees"?"var(--bs-primary)":"#6c757d",borderBottom:a==="trainees"?"2px solid var(--bs-primary)":"none",fontWeight:a==="trainees"?600:400},children:[s.jsx(Vs,{className:"me-2",size:16}),"Trainee Roster"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"instructors",className:a==="instructors"?"active":"",style:{color:a==="instructors"?"var(--bs-primary)":"#6c757d",borderBottom:a==="instructors"?"2px solid var(--bs-primary)":"none",fontWeight:a==="instructors"?600:400},children:[s.jsx(Lt,{className:"me-2",size:16}),"Instructed Trainers"]})})]}),s.jsxs(Tt.Content,{style:{flex:1,overflow:"hidden",padding:0,minHeight:0,height:"100%",display:"flex",flexDirection:"column",margin:0,position:"relative"},children:[s.jsx(Tt.Pane,{eventKey:"overview",style:{height:a==="overview"?"100%":"0",minHeight:a==="overview"?"100%":"0",display:a==="overview"?"flex":"none",flexDirection:"column",margin:0,padding:0,overflow:"hidden",position:"relative",flex:a==="overview"?1:0},children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem",flex:1,padding:"1.5rem",overflowY:"auto",minHeight:0,margin:0,width:"100%"},children:[s.jsxs(Y,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:0},children:[s.jsxs(Y.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(gt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"General Information"})]}),s.jsx(Y.Body,{className:"p-4",style:{backgroundColor:"#ffffff"},children:s.jsxs(ue,{className:"g-4",children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-3 fw-bold",style:{fontSize:"1rem",color:"#153a4a",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Event Information"}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Event Name:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:r.name||"-"})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Occurrence Date:"}),s.jsx("span",{className:"ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:D(r.occuranceDate||r.occurrenceDate)})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-center assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Event Status:"}),s.jsx(Ae,{bg:A(r.status),className:"ms-2 px-3 py-1 assessment-value",children:r.status||"-"})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Total Trainees In Assessments:"}),s.jsxs("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:[r.totalTrainees||0," Trainees"]})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Venue:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:r.entityInfo?.venue||"-"})]})]}),q==="course"&&F&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-3 fw-bold",style:{fontSize:"1rem",color:"#153a4a",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Course Information"}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Course Name:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:F.name||z})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-center assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Course Code:"}),s.jsx(Ae,{bg:"secondary",className:"ms-2 px-2 py-1 assessment-value",children:F.code||ee})]})]})]}),s.jsxs(H,{md:6,children:[oe&&Ee&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-3 fw-bold",style:{fontSize:"1rem",color:"#153a4a",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Subject Information"}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Subject Name:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:Ee.name||z})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-center assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Subject Code:"}),s.jsx(Ae,{bg:"info",className:"ms-2 px-2 py-1 assessment-value",children:Ee.code||ee})]}),Ee.course&&s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{className:"mb-3 fw-bold",style:{fontSize:"1rem",color:"#153a4a",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Course Information"}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Course Name:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)"},children:Ee.course.name||"-"})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-center assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Course Code:"}),s.jsx(Ae,{bg:"secondary",className:"ms-2 px-2 py-1 assessment-value",children:Ee.course.code||"-"})]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-3 fw-bold",style:{fontSize:"1rem",color:"#153a4a",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Assessment Instrument (Template) Information"}),s.jsxs("div",{className:"mb-2 d-flex align-items-start assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Template Name:"}),s.jsx("span",{className:"fw-semibold ms-2 assessment-value",style:{color:"var(--bs-dark)",wordBreak:"break-word"},children:U})]}),s.jsxs("div",{className:"mb-2 d-flex align-items-center assessment-info-row",children:[s.jsx("small",{className:"text-muted assessment-label",style:{minWidth:"200px",fontWeight:500},children:"Template Preview:"}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:S,className:"ms-2 d-inline-flex align-items-center assessment-value",disabled:!X,children:[s.jsx(Zs,{className:"me-1",size:14}),"Show PDF"]})]})]})]})]})})]}),s.jsxs(Y,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:0},children:[s.jsxs(Y.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(Ol,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"Statistics"})]}),s.jsx(Y.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:o?s.jsxs("div",{className:"d-flex justify-content-center align-items-center py-3",children:[s.jsx(ot,{animation:"border",variant:"primary",size:"sm"}),s.jsx("span",{className:"ms-2 text-muted",children:"Loading statistics..."})]}):s.jsx(s.Fragment,{children:s.jsxs(ue,{className:"g-3 mb-4",children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-success shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#d4edda",border:"2px solid var(--bs-success)",position:"relative",overflow:"hidden"},onMouseEnter:C=>{C.currentTarget.style.transform="translateY(-8px) scale(1.05)",C.currentTarget.style.boxShadow="0 12px 30px rgba(40, 167, 69, 0.4)",C.currentTarget.style.borderColor="#28a745"},onMouseLeave:C=>{C.currentTarget.style.transform="translateY(0) scale(1)",C.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",C.currentTarget.style.borderColor="var(--bs-success)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#155724",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.passed}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Passed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-danger shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#f8d7da",border:"2px solid var(--bs-danger)",position:"relative",overflow:"hidden"},onMouseEnter:C=>{C.currentTarget.style.transform="translateY(-8px) scale(1.05)",C.currentTarget.style.boxShadow="0 12px 30px rgba(220, 53, 69, 0.4)",C.currentTarget.style.borderColor="#dc3545"},onMouseLeave:C=>{C.currentTarget.style.transform="translateY(0) scale(1)",C.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",C.currentTarget.style.borderColor="var(--bs-danger)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#721c24",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.failed}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Failed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-secondary shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#e2e3e5",border:"2px solid var(--bs-secondary)",position:"relative",overflow:"hidden"},onMouseEnter:C=>{C.currentTarget.style.transform="translateY(-8px) scale(1.05)",C.currentTarget.style.boxShadow="0 12px 30px rgba(108, 117, 125, 0.4)",C.currentTarget.style.borderColor="#6c757d"},onMouseLeave:C=>{C.currentTarget.style.transform="translateY(0) scale(1)",C.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",C.currentTarget.style.borderColor="var(--bs-secondary)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#383d41",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.cancelled}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Cancelled"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-primary shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#ccedffff",border:"2px solid var(--bs-primary)",position:"relative",overflow:"hidden"},onMouseEnter:C=>{C.currentTarget.style.transform="translateY(-8px) scale(1.05)",C.currentTarget.style.boxShadow="0 12px 30px rgba(0, 123, 255, 0.4)",C.currentTarget.style.borderColor="#007bff"},onMouseLeave:C=>{C.currentTarget.style.transform="translateY(0) scale(1)",C.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",C.currentTarget.style.borderColor="var(--bs-primary)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#04234fff",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.total}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Total Forms"})]})})})]})})})]})]})}),s.jsx(Tt.Pane,{eventKey:"trainees",style:{height:a==="trainees"?"100%":"0",minHeight:a==="trainees"?"100%":"0",display:a==="trainees"?"flex":"none",flexDirection:"column",margin:0,padding:0,overflow:"hidden",position:"relative",flex:a==="trainees"?1:0,alignItems:"flex-start",justifyContent:"flex-start"},children:s.jsx("div",{style:{width:"100%",height:"100%",flex:"1 1 auto",overflowY:"auto",overflowX:"auto",minHeight:0,padding:"1.5rem",margin:0,maxHeight:"none",border:"none",borderRadius:0,position:"relative",WebkitOverflowScrolling:"touch",alignSelf:"stretch"},children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem",marginTop:0},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(Sl,{columnKey:"assessmentForm",sortConfig:k,onSort:I,children:"Assessment Form"}),s.jsx(Sl,{columnKey:"trainee",sortConfig:k,onSort:I,children:"Trainee"}),s.jsx(Sl,{columnKey:"occurrenceDate",sortConfig:k,onSort:I,children:"Occurrence Date"}),s.jsx(Sl,{columnKey:"status",sortConfig:k,onSort:I,children:"Status"}),s.jsx(Sl,{columnKey:"score",sortConfig:k,onSort:I,children:"Score"}),s.jsx(Sl,{columnKey:"result",sortConfig:k,onSort:I,children:"Result"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Preview"})]})}),s.jsx("tbody",{children:T.map((C,W)=>{const Z=C.pdfUrl!==null&&C.pdfUrl!==void 0,J=C.assessmentFormName||C.assessmentForm||"-",le=C.traineeFullName||C.trainee||"-",V=C.traineeEid||C.traineeEmail||"",re=C.occuranceDate||C.occurrenceDate,he=C.status||"-",O=C.resultScore||C.score,ye=C.resultText||C.result;return s.jsxs("tr",{className:`${W%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:de=>{de.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:de=>{de.currentTarget.style.backgroundColor=W%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:J})}),s.jsx("td",{className:"align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2 text-primary",size:18}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-0 fw-medium",children:le}),V&&s.jsx("small",{className:"text-muted",children:V})]})]})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:D(re)})}),s.jsx("td",{className:"align-middle",children:M(he)}),s.jsx("td",{className:"align-middle",children:O!=null?s.jsx("span",{className:"fw-bold text-primary",children:O}):s.jsx("span",{className:"text-muted",children:"N/A"})}),s.jsx("td",{className:"align-middle",children:ye?s.jsx(Ae,{bg:ye.toUpperCase()==="PASSED"||ye.toUpperCase()==="PASS"?"success":ye.toUpperCase()==="FAILED"||ye.toUpperCase()==="FAIL"?"danger":"secondary",children:ye}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"align-middle text-center",children:Z&&s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>{g(C),w(C.pdfUrl)},className:"d-inline-flex align-items-center",children:[s.jsx(Zs,{className:"me-1",size:14}),"Preview"]})})]},C.id||C.assessmentFormId||W)})})]})})}),s.jsx(Tt.Pane,{eventKey:"instructors",style:{height:a==="instructors"?"100%":"0",minHeight:a==="instructors"?"100%":"0",display:a==="instructors"?"flex":"none",flexDirection:"column",margin:0,padding:0,overflow:"hidden",position:"relative",flex:a==="instructors"?1:0,alignItems:"flex-start",justifyContent:"flex-start"},children:s.jsx("div",{style:{width:"100%",height:"100%",flex:"1 1 auto",overflowY:"auto",overflowX:"auto",minHeight:0,padding:"1.5rem",margin:0,maxHeight:"none",border:"none",borderRadius:0,position:"relative",WebkitOverflowScrolling:"touch",alignSelf:"stretch"},children:r?.availableTrainers&&r.availableTrainers.length>0?s.jsxs(dr,{hover:!0,className:"mb-0",style:{fontSize:"0.875rem",marginTop:0},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",fontWeight:600,textTransform:"uppercase",borderColor:"var(--bs-primary)"},children:"EID"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",fontWeight:600,textTransform:"uppercase",borderColor:"var(--bs-primary)"},children:"Name"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",fontWeight:600,textTransform:"uppercase",borderColor:"var(--bs-primary)"},children:"Email"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",fontWeight:600,textTransform:"uppercase",borderColor:"var(--bs-primary)"},children:"Role"})]})}),s.jsx("tbody",{children:r.availableTrainers.map((C,W)=>s.jsxs("tr",{children:[s.jsx("td",{className:"align-middle fw-semibold",children:C.eid||"-"}),s.jsx("td",{className:"align-middle",children:C.fullName||"-"}),s.jsx("td",{className:"align-middle",children:C.email||"-"}),s.jsx("td",{className:"align-middle",children:s.jsx(Ae,{bg:C.roleInAssessment==="EXAMINER"?"primary":C.roleInAssessment==="ASSESSMENT_REVIEWER"?"info":"secondary",children:C.roleInAssessment==="EXAMINER"?"Examiner":C.roleInAssessment==="ASSESSMENT_REVIEWER"?"Reviewer":C.roleInAssessment})})]},W))})]}):s.jsxs("div",{className:"text-center text-muted py-5",children:[s.jsx(Lt,{size:48,className:"mb-3 opacity-50"}),s.jsx("p",{children:"No trainers assigned to this event"})]})})})]})]})}),s.jsx(se.Footer,{className:"border-top",children:s.jsx(ae,{variant:"secondary",onClick:t,children:"Close"})}),s.jsxs(se,{show:h,onHide:E,size:"xl",centered:!0,onShow:()=>{document.body.style.overflow="hidden"},onExited:()=>{document.body.style.overflow="auto"},children:[s.jsx(se.Header,{closeButton:!0,style:{flexShrink:0,backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)"},children:s.jsxs(se.Title,{style:{color:"white"},children:["Template Preview - ",U]})}),s.jsx(se.Body,{style:{padding:0,height:"70vh",maxHeight:"600px",overflow:"hidden",display:"flex",flexDirection:"column"},children:m?s.jsxs("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("span",{className:"ms-3",children:"Loading PDF preview..."})]}):u?s.jsx("div",{style:{border:"1px solid #dee2e6",borderRadius:"0.375rem",overflow:"auto",height:"100%",width:"100%",flex:1},children:s.jsx("iframe",{src:u+"#toolbar=0",width:"100%",height:"100%",style:{border:"none",minHeight:"100%",display:"block"},title:"Template PDF Preview"})}):s.jsxs(Ue,{variant:"danger",className:"m-3 mb-0",children:[s.jsx(Zs,{className:"me-2"}),"Failed to load PDF preview. Please try again."]})}),s.jsx(se.Footer,{style:{flexShrink:0},children:s.jsx(ae,{variant:"secondary",onClick:E,children:"Close"})})]}),s.jsxs(se,{show:!!p,onHide:()=>{g(null),w(null)},size:"xl",centered:!0,dialogClassName:"trainee-pdf-modal",style:{overflow:"hidden"},contentClassName:"trainee-pdf-modal-content",onShow:()=>{document.body.style.overflow="hidden"},onExited:()=>{document.body.style.overflow="auto"},children:[s.jsx(se.Header,{closeButton:!0,style:{flexShrink:0},children:s.jsxs(se.Title,{children:["Assessment PDF -"," ",p?.trainee?.fullName||"Trainee"]})}),s.jsx(se.Body,{style:{padding:0,height:"70vh",maxHeight:"600px",overflow:"hidden",display:"flex",flexDirection:"column"},children:j&&s.jsx("div",{style:{border:"1px solid #dee2e6",borderRadius:"0.375rem",overflow:"auto",height:"100%",width:"100%",flex:1},children:s.jsx("iframe",{src:j,width:"100%",height:"100%",style:{border:"none",minHeight:"100%",display:"block"},title:"Trainee Assessment PDF"})})}),s.jsx(se.Footer,{style:{flexShrink:0},children:s.jsx(ae,{variant:"secondary",onClick:()=>{g(null),w(null)},children:"Close"})})]})]})},Kle=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>s.jsx(Nt,{permissions:[De.VIEW_SUBJECT_DETAILS,De.REMOVE_TRAINEE_FROM_ENROLLMENT],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Subject List",icon:s.jsx(tr,{}),onClick:()=>t(e),permission:De.VIEW_SUBJECT_DETAILS},{type:"divider"},{label:"Remove Trainee",icon:s.jsx(ba,{}),className:"text-danger",onClick:()=>r(e.id),permission:De.REMOVE_TRAINEE_FROM_ENROLLMENT}]})}),Yle=({show:e,onClose:t,onConfirm:r,trainee:a,subjectName:n=null,loading:i=!1})=>{const l=!n,o=l?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=l?"Remove from All Subjects":"Remove from Subject",u=()=>{r(),t()};return s.jsxs(se,{show:e,onHide:t,centered:!0,children:[s.jsx(se.Header,{className:"bg-danger text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",size:20}),o]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",s.jsxs("strong",{children:['"',a?.name,'"']}),l?" from ALL subjects":` from "${n}"`,"?"]}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsx("strong",{children:"Trainee:"})," ",a?.name,s.jsx("br",{}),s.jsx("strong",{children:"EID:"})," ",a?.eid,!l&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("strong",{children:"Subject:"})," ",n]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[l?s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),s.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),s.jsx("li",{children:"Remove the trainee from the course completely"})]}):s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from this specific subject only"}),s.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),s.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),s.jsx("li",{children:s.jsx("strong",{children:"Cannot be undone"})})]})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsx(ae,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),s.jsx(ae,{variant:"danger",onClick:u,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"me-2",size:16}),c]})})]})]})},z5=({courseId:e,subjectId:t,loading:r=!1,refreshTrigger:a})=>{const[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(!1),[d,m]=v.useState(null),[f,h]=v.useState(!1),[x,p]=v.useState(null),[g,j]=v.useState(null),[w,y]=v.useState(null),[b,S]=v.useState(!1),{sortedData:E,sortConfig:N,handleSort:T}=ts(n),k=v.useCallback(async()=>{if(!e&&!t){i([]),o(!1);return}o(!0);try{let z=[];if(t){const U=await gs.getSubjectTrainees(t);z=(U?.trainees||U?.data?.trainees||[]).map(oe=>({id:oe.id,eid:oe.eid||"",name:`${oe.lastName||""}${oe.middleName?" "+oe.middleName:""} ${oe.firstName||""}`.trim()||"Unknown",firstName:oe.firstName||"",middleName:oe.middleName||null,lastName:oe.lastName||"",email:oe.email||"",batchCode:oe.batchCode||"",subjectCount:1,userId:oe.id}))}else if(e){const U=await kr.getCourseTrainees(e);z=U?.data?.trainees||U?.trainees||[]}if(!Array.isArray(z)||z.length===0){i([]),o(!1);return}const ee=z.map(U=>{const oe=[U.lastName,U.middleName,U.firstName].filter(Boolean).join(" ")||U.name||"Unknown";return{id:U.id,eid:U.eid||"",name:oe,email:U.email||"",batchCode:U.batchCode||"",subjectCount:U.subjectCount||(t?1:0),userId:U.id||U.userId}});i(ee)}catch(z){console.error("Error loading enrolled trainees:",z),i([])}finally{o(!1)}},[e,t]);v.useEffect(()=>{(e||t)&&k()},[e,t,k,a]);const I=async z=>{if(!t)try{const ee=await kr.getTraineeEnrollments(e,z.userId),U=ee?.data||ee,X=(U.subjects||[]).filter(Ee=>Ee.enrollment?.status!=="CANCELLED"),oe={id:z.id,eid:U.trainee?.eid||z.eid,name:U.trainee?.fullName||z.name,email:U.trainee?.email||z.email,department:U.trainee?.department||null,userId:U.trainee?.userId||z.userId,subjectCount:X.length,subjects:X.map(Ee=>({id:Ee.subject?.id,code:Ee.subject?.code,name:Ee.subject?.name,status:Ee.subject?.status,type:Ee.subject?.type,method:Ee.subject?.method,startDate:Ee.subject?.startDate,endDate:Ee.subject?.endDate,course:Ee.subject?.course,enrollment:Ee.enrollment}))};m(oe),u(!0)}catch(ee){console.error("Error loading trainee enrollments:",ee),te.error("Failed to load trainee subjects",{autoClose:3e3,position:"top-right",icon:!1})}},D=z=>{const ee=n.find(U=>U.id===z);ee&&(p(ee),j(null),h(!0))},A=async()=>{if(x){S(!0);try{await gs.removeTraineeFromAllSubjects(e,x.userId),await k(),te.success(`Successfully removed ${x.name} from all subjects`,{autoClose:3e3,position:"top-right",icon:!1}),h(!1)}catch(z){const ee=z?.response?.data?.message||z?.message||"Failed to remove trainee from subjects";te.error(`Error: ${ee}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{S(!1)}}},M=(z,ee)=>{const U=n.find(F=>F.id===z);if(!U)return;const X=d?.subjects?.find(F=>(F.subject||F).id===ee);if(!X){te.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}const Ee=(X.subject||X).name||"Unknown Subject";p(U),j(ee),y(Ee),h(!0)},G=async()=>{if(!x||!g)return;const z=d?.subjects?.find(oe=>(oe.subject||oe).id===g);if(!z){te.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}const ee=z.subject||z,U=z.enrollment,X=ee.name||"Unknown Subject";S(!0);try{const oe=U?.batchCode;if(!oe){te.error("Batch code not found",{autoClose:3e3,position:"top-right",icon:!1}),S(!1);return}await gs.removeTraineeFromSubject(ee.id,x.userId,oe),await k(),te.success(`Successfully removed ${x.name} from ${X}`,{autoClose:3e3,position:"top-right",icon:!1}),h(!1),u(!1)}catch(oe){const Ee=oe?.response?.data?.message||oe?.message||"Failed to remove trainee from subject";te.error(`Error: ${Ee}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{S(!1)}};if(r||l)return s.jsx("div",{children:s.jsx(Fr,{rows:4,columns:4})});if(n.length===0)return s.jsx("div",{children:s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled trainees"}),s.jsx("p",{children:"No trainees have been enrolled in any subjects yet."})]})})});const q=({columnKey:z,children:ee,className:U=""})=>{const X=N.key===z,oe=X?N.direction:null;return s.jsxs("th",{className:`fw-semibold ${U}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>T(z),onMouseEnter:Ee=>{Ee.target.style.backgroundColor="#214760",Ee.target.style.transform="translateY(-1px)",Ee.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:Ee=>{Ee.target.style.backgroundColor="var(--bs-primary)",Ee.target.style.transform="translateY(0)",Ee.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:X?"700":"600",color:"white"},children:ee}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:oe,size:14,color:"white"})})]}),X&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"d-flex flex-column",style:{height:"400px",width:"100%"},children:s.jsx("div",{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",overflowY:"auto"},children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(q,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(q,{columnKey:"eid",className:"show-mobile",children:"EID"}),t?s.jsxs(s.Fragment,{children:[s.jsx(q,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(q,{columnKey:"batchCode",className:"show-mobile",children:"Batch Code"})]}):s.jsx(q,{columnKey:"subjects",className:"show-mobile",children:"Total Subject"}),!t&&s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:E.map(z=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom",children:z.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:z.eid})}),t?s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("small",{children:z.email||"-"})}),s.jsx("td",{className:"show-mobile",children:s.jsx("small",{children:z.batchCode||"-"})})]}):s.jsx("td",{className:"show-mobile",children:s.jsxs(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[z.subjectCount||0," subjects"]})}),!t&&s.jsx("td",{className:"text-center show-mobile",children:s.jsx(Kle,{trainee:z,onViewSubjects:t?void 0:I,onRemoveTrainee:D})})]},z.id))})]})})})}),s.jsxs(se,{show:c,onHide:()=>u(!1),size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"text-white",children:[d?.name," - Enrolled Subjects"]}),s.jsx(ae,{variant:"link",onClick:()=>u(!1),className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsx(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:d&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:s.jsxs("div",{className:"row align-items-center",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:"Trainee Information"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ae,{bg:"primary-custom",className:"me-2 text-white",children:"EID"}),s.jsx("span",{className:"fw-semibold text-primary-custom",children:d.eid})]})]}),s.jsx("div",{className:"col-md-6 text-md-end",children:s.jsx("div",{className:"text-primary-custom small",children:s.jsxs("div",{children:["Total Subjects: ",s.jsx(Ae,{bg:"primary-custom",className:"text-white",children:d.subjectCount||0})]})})})]})}),d.subjects&&d.subjects.length>0?s.jsx("div",{className:"row g-3",children:d.subjects.map((z,ee)=>{const U=z.subject||z,X=z.enrollment;return s.jsx("div",{className:"col-12",children:s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsx(Y.Body,{className:"p-3",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-8",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:U.name}),s.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[s.jsx(Ae,{bg:"primary-custom",className:"text-white",children:U.code}),s.jsx(Ae,{bg:U.status==="ON_GOING"?"success":"primary-custom",className:U.status==="ON_GOING"?"":"text-white",children:U.status?.replace(/_/g," ")})]})]}),s.jsx(Nt,{permission:De.REMOVE_TRAINEE_FROM_ENROLLMENT,fallback:null,children:s.jsx(ae,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{M(d.id,U.id)},children:s.jsx(ht,{size:14})})})]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Type:"}),s.jsx(Ae,{bg:"primary-custom",className:"text-white",children:U.type})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Method:"}),s.jsx(Ae,{bg:"primary-custom",className:"text-white",children:U.method})]})})]}),U.course&&s.jsxs("div",{className:"mb-3",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Course:"}),s.jsx("span",{className:"fw-medium text-primary-custom",children:U.course.name})]}),U.startDate&&U.endDate&&s.jsxs("div",{className:"mb-3",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Duration:"}),s.jsxs("span",{className:"fw-medium text-primary-custom",children:[new Date(U.startDate).toLocaleDateString()," - ",new Date(U.endDate).toLocaleDateString()]})]})]}),X&&s.jsx("div",{className:"col-md-4",children:s.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[s.jsx("h6",{className:"text-primary-custom mb-2 fw-bold",children:"Enrollment Details"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Status:"}),s.jsx(Ae,{bg:"primary-custom",className:"text-white",children:X.status?.replace(/_/g," ")})]}),X.batchCode&&s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Batch:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:X.batchCode})]}),X.enrollmentDate&&s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Enrolled:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:new Date(X.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},U.id||ee)})}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-muted",children:"No subjects found"})})]})}),s.jsx(se.Footer,{className:"border-top",children:s.jsx(ae,{variant:"primary-custom",className:"text-white",onClick:()=>u(!1),children:"Close"})})]}),s.jsx(Yle,{show:f,onClose:()=>{h(!1),p(null),j(null),y(null),S(!1)},onConfirm:g?G:A,trainee:x,subjectName:w,loading:b})]})},Xle=({subjectId:e,courseId:t})=>{const r=ft();na();const{user:a}=Rr(),{hasPermission:n}=ln();XS(a);const i=n(De.ASSIGN_TRAINERS)||n(De.REMOVE_TRAINERS),[l,o]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState(!0),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,j]=v.useState(!1),[w,y]=v.useState(!1),[b,S]=v.useState(null),[E,N]=v.useState(!1),[T,k]=v.useState(!1),[I,D]=v.useState(!1),[A,M]=v.useState(!1),[G,q]=v.useState(!1),[z,ee]=v.useState(null),[U,X]=v.useState("subject-info"),{sortedData:oe}=ts(c),Ee=V=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"success"},EXAMINER:{text:"Examiner",variant:"success"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"success"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"success"}})[V]||{text:V,variant:"success"},F=v.useCallback(V=>{if(V&&V.instructors){const re=V.instructors.map(he=>({id:he.id,eid:he.eid,name:`${he.lastName}${he.middleName?" "+he.middleName:""} ${he.firstName}`,role:he.roleInSubject,assignedAt:he.assignedAt}));u(re)}else u([])},[]);v.useEffect(()=>{e&&(async()=>{if(!e){o(null),m(!1);return}m(!0);try{const re=await gs.getSubjectById(e);re?(o(re),F(re)):o(null)}catch(re){let he=re.response?.data?.message||re.message||"Failed to load subject details";if(re.response?.data?.errors&&Array.isArray(re.response.data.errors)&&re.response.data.errors.length>0){const O=re.response.data.errors[0];he=`${he}: ${O.message||O.field}`}te.error(he),o(null)}finally{m(!1)}})()},[e,F]);const P=async V=>{k(!0);try{await new Promise(re=>setTimeout(re,1e3)),o(re=>({...re,...V})),te.success("Subject updated successfully!"),p(!1)}catch{te.error("Failed to update subject")}finally{k(!1)}},C=async()=>{N(!0);try{await new Promise(V=>setTimeout(V,1e3)),h(!1)}catch{}finally{N(!1)}},W=async V=>{D(!0);try{await gs.addTrainerToSubject(e,V);const re=await gs.getSubjectById(e);re&&(o(re),F(re)),te.success("Trainer added successfully!"),j(!1)}catch(re){const he=re?.message||re?.error||"Failed to add trainer";te.error(he)}finally{D(!1)}},Z=async V=>{if(b){M(!0);try{await gs.updateTrainerRole(e,b.id,V);const re=await gs.getSubjectById(e);re&&(o(re),F(re)),te.success("Trainer role updated successfully!"),y(!1)}catch(re){console.error("Error updating trainer role:",re);const he=re?.message||re?.error||"Failed to update trainer role";te.error(he)}finally{M(!1)}}},J=async V=>{if(V)try{await gs.removeTrainerFromSubject(e,V);const re=await gs.getSubjectById(e);re&&(o(re),F(re)),te.success("Trainer removed successfully!")}catch(re){console.error("Error removing trainer:",re);const he=re?.message||re?.error||"Failed to remove trainer";te.error(he)}},le=()=>{r(-1)};return d?s.jsx(Be,{className:"py-4",children:s.jsx(Fr,{rows:4,columns:3})}):l?s.jsxs(Be,{className:"py-4 subject-details",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-4",children:[s.jsx("div",{className:"d-flex align-items-center",children:s.jsxs(ae,{variant:"outline-secondary",onClick:le,className:"me-3",children:[s.jsx(Bt,{className:"me-2",size:16}),"Back"]})}),s.jsxs("div",{className:"d-flex gap-2",children:[" ",l?.status==="PLANNED"&&s.jsx(Nt,{permission:De.UPDATE_SUBJECT,fallback:null,children:s.jsxs(ae,{variant:"primary",onClick:()=>p(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(Ar,{size:16,className:"me-1"}),"Edit Subject"]})})]})]}),s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsxs(Tt.Container,{activeKey:U,onSelect:X,children:[s.jsxs(Y.Header,{className:"border-bottom py-2 bg-primary d-flex justify-content-between align-items-center",children:[s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:U==="subject-info"?"600":"400",opacity:U==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(J2,{className:"me-2",size:16}),"Subject Information"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:U==="trainers"?"600":"400",opacity:U==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(sS,{className:"me-2",size:16}),"Trainers In Assessment"]})}),n(De.ENROLL_SINGLE_TRAINEE)&&s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:U==="trainees"?"600":"400",opacity:U==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Vs,{className:"me-2",size:16}),"Trainee Roster"]})}),a&&a.role!=="TRAINEE"&&s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:U==="assessment-events"?"600":"400",opacity:U==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(va,{className:"me-2",size:16}),"Assessment Events"]})})]}),U==="trainers"&&s.jsx(Nt,{permission:De.ASSIGN_TRAINERS,fallback:null,children:s.jsxs(ae,{variant:"light",size:"sm",onClick:()=>j(!0),className:"d-flex align-items-center",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#f8f9fa",V.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#ffffff",V.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(yr,{size:14,className:"me-1"}),"Add Trainer"]})})]}),s.jsx(Y.Body,{className:"p-0",children:s.jsxs(Tt.Content,{children:[s.jsx(Tt.Pane,{eventKey:"subject-info",children:s.jsxs("div",{className:"p-4",children:[s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Name"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:l.name})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Code"}),s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",children:l.code})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Description"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:l.description||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Method"}),s.jsx(Ae,{bg:"info",className:"px-2 py-1",children:l.method||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Duration"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{size:16,className:"me-2 text-primary"}),s.jsxs("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:[l.duration," day(s)"]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Is Simulator"}),s.jsx("div",{className:"d-flex align-items-center",children:l.isSIM||l.is_sim?s.jsxs("div",{className:"d-flex align-items-center",style:{padding:"0.5rem 1rem",backgroundColor:"#d1ecf1",border:"2px solid #0dcaf0",borderRadius:"8px",color:"#055160",fontWeight:"600",width:"fit-content"},children:[s.jsx(Yx,{size:18,className:"me-2"}),s.jsx("span",{children:"Yes"})]}):s.jsx("div",{className:"d-flex align-items-center",style:{padding:"0.5rem 1rem",backgroundColor:"#f8f9fa",border:"2px solid #dee2e6",borderRadius:"8px",color:"#6c757d",fontWeight:"600",width:"fit-content"},children:s.jsx("span",{children:"No"})})})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Type"}),s.jsx(Ae,{bg:"info",className:"px-2 py-1",children:l.type||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:l.passScore||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:l.roomName||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Time Slot"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:l.timeSlot||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:new Date(l.startDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"End Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:new Date(l.endDate).toLocaleDateString()})]})]})]})]}),s.jsx(ue,{children:s.jsx(H,{xs:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"mb-2 d-flex align-items-center",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:[s.jsx(_c,{className:"me-2",size:18}),"Remark Note"]}),s.jsx("div",{style:{padding:"1rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"8px",minHeight:"60px"},children:s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:l.remarkNote||"No remark note available"})})]})})})]})}),s.jsx(Tt.Pane,{eventKey:"trainers",children:s.jsx(F5,{trainers:oe,variant:"subject",onEdit:V=>{S(V),y(!0)},onDelete:J,hasActionPermission:i,editPermission:De.ASSIGN_TRAINERS,formatRole:Ee,emptyMessage:"No trainers assigned yet."})}),n(De.ENROLL_SINGLE_TRAINEE)&&s.jsx(Tt.Pane,{eventKey:"trainees",style:{height:"100%"},children:s.jsx(z5,{subjectId:e,courseId:t})}),a&&a.role!=="TRAINEE"&&s.jsx(Tt.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(B5,{subjectId:e,courseId:t,onView:V=>{ee(V),q(!0)}})})]})})]})}),s.jsx(L5,{show:f,onClose:()=>h(!1),onConfirm:C,subject:l,loading:E}),s.jsx(Gle,{show:x,onClose:()=>p(!1),onSave:P,subject:l,loading:T}),s.jsx(M5,{show:g,onClose:()=>j(!1),onSave:W,loading:I,courseId:null,subjectId:e}),s.jsx(qle,{show:w,onClose:()=>y(!1),onSave:Z,trainer:b,loading:A}),s.jsx(Xy,{show:G,onClose:()=>{q(!1),ee(null)},event:z})]}):s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{children:"Subject not found"}),s.jsx("p",{children:"The requested subject could not be found."}),s.jsxs(ae,{variant:"primary",onClick:le,children:[s.jsx(Bt,{className:"me-2",size:16}),"Go Back"]})]})})},Wd=()=>{const{subjectId:e,courseId:t}=Or();return s.jsx(Xle,{subjectId:e,courseId:t})},Jle=({subject:e,onView:t,onEdit:r,onDelete:a})=>{const{hasPermission:n}=ln(),i=()=>{t&&t(e.id)},l=()=>{a&&a(e.id)},o=v.useMemo(()=>{const u=[{label:"View Details",icon:s.jsx(tr,{}),onClick:i,permission:De.VIEW_SUBJECT_DETAILS},{type:"divider"},{label:"Archive Subject",icon:s.jsx(W2,{}),className:"text-warning",onClick:l,permission:De.ARCHIVE_SUBJECT}].filter(m=>m.type==="divider"||!m.permission?!0:n(m.permission)),d=[];for(let m=0;m<u.length;m++){const f=u[m],h=u[m-1],x=u[m+1];m===0&&f.type==="divider"||m===u.length-1&&f.type==="divider"||f.type==="divider"&&(!x||x.type==="divider")||f.type==="divider"&&h?.type==="divider"||d.push(f)}return d},[n,i,l]);return s.jsx(Nt,{permissions:[De.VIEW_SUBJECT_DETAILS,De.ARCHIVE_SUBJECT],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:o})})},Zle=e=>({id:e.id,name:e.name,code:e.code,method:e.method,duration:eoe(e.duration),startDate:D2(e.startDate||e.start_date),endDate:D2(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.status||(e.deletedAt?"ARCHIVED":"PLANNED"),description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),Qle=e=>e.map(Zle),eoe=e=>e??"N/A",D2=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch{return"Invalid Date"}},toe=e=>{switch(e?.toUpperCase()){case"ACTIVE":case"ON-GOING":case"ONGOING":return"success";case"PLANNED":return"info";case"COMPLETED":return"primary";case"ARCHIVED":case"INACTIVE":return"secondary";default:return"secondary"}},roe=e=>{switch(e?.toUpperCase()){case"CLASSROOM":return"info";case"E_LEARNING":case"E-LEARNING":case"ELEARNING":return"primary";case"ERO":return"warning";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},soe=({subjects:e=[],loading:t=!1,onView:r,onEdit:a,onDelete:n})=>{const i=Qle(e),{sortedData:l,sortConfig:o,handleSort:c}=ts(i);if(t)return s.jsx(Fr,{rows:4,columns:5});if(i.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=o.key===d,x=h?o.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:s.jsx(Rs,{direction:x,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden",height:"1000px !important",overflowY:"auto"},children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(u,{columnKey:"name",className:"show-mobile",children:"Name"}),s.jsx(u,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(u,{columnKey:"method",className:"show-mobile",children:"Method"}),s.jsx(u,{columnKey:"startDate",className:"show-mobile",children:"Start Date / End Date"}),s.jsx(u,{columnKey:"roomName",className:"show-mobile",children:"Venue"}),s.jsx(u,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),s.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px",textTransform:"uppercase",letterSpacing:"0.5px"},children:s.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),s.jsx("tbody",{children:l.map(d=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(d.id),style:{cursor:"pointer"},children:d.name})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.code,children:d.code})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ae,{bg:roe(d.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.method,children:d.method})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[s.jsxs("div",{className:"d-flex align-items-center me-2",children:[s.jsx(or,{size:14,className:"me-1 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.875rem"},children:d.startDate||"N/A"})]}),s.jsx("span",{className:"text-muted me-2",children:"/"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:14,className:"me-1 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.875rem"},children:d.endDate||"N/A"})]})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:d.roomName})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vs,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.trainees||0})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ae,{bg:toe(d.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.status?.replace(/_/g," ")||"N/A"})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(Jle,{subject:d,onView:r,onEdit:a,onDelete:n})})]},d.id))})]})})},aoe=({show:e,onClose:t,onSave:r,loading:a=!1,courseId:n,courseStartDate:i,courseEndDate:l})=>{const[o,c]=v.useState({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[u,d]=v.useState([]),[m,f]=v.useState(!1);v.useEffect(()=>{e&&n&&(c({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),d([]))},[e,n]);const h=j=>{const{name:w,value:y,type:b,checked:S}=j.target;c(E=>({...E,[w]:b==="checkbox"?S:y}))},x=()=>{const j=[];if(n||j.push("Course ID is required"),o.name.trim()||j.push("Subject name is required"),o.code.trim()||j.push("Subject code is required"),o.passScore.trim()&&(isNaN(o.passScore)||!Number.isInteger(parseFloat(o.passScore))||parseFloat(o.passScore)<0||parseFloat(o.passScore)>100)&&j.push("Pass score must be an integer between 0 and 100"),o.timeSlot.trim()){const w=o.timeSlot.split(/[;,]/).map(y=>y.trim()).filter(y=>y);if(w.length===0)j.push("Time slot cannot be empty");else{const y=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/;for(let b=0;b<w.length;b++){const E=w[b].split("-");if(E.length!==2){j.push(`Time slot ${b+1} must contain exactly one dash (-)`);continue}const[N,T]=E;if(!y.test(N)||!y.test(T)){j.push(`Time slot ${b+1} must be in format H:mm or HH:mm (e.g., 9:00-13:00 or 09:00-13:00)`);continue}const[k,I]=N.split(":").map(Number),[D,A]=T.split(":").map(Number);k*60+I>=D*60+A&&j.push(`Time slot ${b+1}: End time must be after start time`)}}}if(!o.startDate.trim())j.push("Start date is required");else{const w=new Date;w.setHours(0,0,0,0),new Date(o.startDate+"T00:00:00")<w&&j.push("Start date cannot be in the past")}if(!o.endDate.trim())j.push("End date is required");else{const w=new Date;w.setHours(0,0,0,0),new Date(o.endDate+"T00:00:00")<w&&j.push("End date cannot be in the past")}if(o.startDate&&o.endDate&&new Date(o.startDate+"T00:00:00")>=new Date(o.endDate+"T00:00:00")&&j.push("End date must be after start date"),i&&l&&o.startDate&&o.endDate){const w=new Date(i),y=new Date(l),b=new Date(w.getFullYear(),w.getMonth(),w.getDate()),S=new Date(y.getFullYear(),y.getMonth(),y.getDate()),E=new Date(o.startDate+"T00:00:00"),N=new Date(o.endDate+"T00:00:00"),T=new Date(E.getFullYear(),E.getMonth(),E.getDate()),k=new Date(N.getFullYear(),N.getMonth(),N.getDate()),I=M=>{if(!M)return"";const G=new Date(M),q=G.getFullYear(),z=String(G.getMonth()+1).padStart(2,"0"),ee=String(G.getDate()).padStart(2,"0");return`${q}-${z}-${ee}`},D=I(i),A=I(l);T<b&&j.push(`Subject start date must be on or after course start date (Course start: ${D})`),k>S&&j.push(`Subject end date must be on or before course end date (Course end: ${A})`)}return d(j),j.length===0},p=async j=>{if(j.preventDefault(),!!x()){f(!0);try{const w={courseId:n,name:o.name.trim(),code:o.code.trim(),description:o.description.trim()||null,method:o.method,type:o.type,roomName:o.roomName.trim()||null,remarkNote:o.remarkNote.trim()||null,timeSlot:o.timeSlot.trim()||null,isSIM:o.isSIM,passScore:o.passScore.trim()?parseFloat(o.passScore):null,startDate:o.startDate,endDate:o.endDate},y=await Se.post("/subjects",w);te.success("Subject created successfully!"),r&&await r(y.data||w),g()}catch(w){const y=w.response?.data?.message||w.message||"Failed to create subject";te.error(`Error: ${y}`),d([y])}finally{f(!1)}}},g=()=>{c({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),d([]),f(!1),t()};return s.jsxs(se,{show:e,onHide:g,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-2",size:20}),"Add New Subject"]}),s.jsx(ae,{variant:"link",onClick:g,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[u.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:u.map((j,w)=>s.jsx("li",{children:j},w))})}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Subject Name *"}),s.jsx(_.Control,{type:"text",name:"name",value:o.name,onChange:h,placeholder:"Enter subject name",required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Subject Code *"}),s.jsx(_.Control,{type:"text",name:"code",value:o.code,onChange:h,placeholder:"Enter subject code",required:!0})]})})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Description"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"description",value:o.description,onChange:h,placeholder:"Enter subject description"})]}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Method *"}),s.jsxs(_.Select,{name:"method",value:o.method,onChange:h,required:!0,children:[s.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),s.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),s.jsx("option",{value:"ERO",children:"ERO"})]})]})})}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Type *"}),s.jsxs(_.Select,{name:"type",value:o.type,onChange:h,required:!0,children:[s.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),s.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Venue"}),s.jsx(_.Control,{type:"text",name:"roomName",value:o.roomName,onChange:h,placeholder:"Enter venue"})]})})]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Time Slot"}),s.jsx(_.Control,{type:"text",name:"timeSlot",value:o.timeSlot,onChange:h,placeholder:"e.g., 09:00-11:00"})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Pass Score"}),s.jsx(_.Control,{type:"number",name:"passScore",value:o.passScore,onChange:h,onKeyPress:j=>j.key==="."&&j.preventDefault(),placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"1"})]})})]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Start Date *"}),s.jsx(_.Control,{type:"date",name:"startDate",value:o.startDate,onChange:h,required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"End Date *"}),s.jsx(_.Control,{type:"date",name:"endDate",value:o.endDate,onChange:h,required:!0})]})})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Remark Note"}),s.jsx(_.Control,{as:"textarea",rows:2,name:"remarkNote",value:o.remarkNote,onChange:h,placeholder:"Enter remark note"})]}),s.jsx(_.Group,{className:"mb-3",children:s.jsx(_.Check,{type:"checkbox",name:"isSIM",checked:o.isSIM,onChange:h,label:"Is Simulator"})})]})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"secondary",onClick:g,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:p,disabled:m,children:m?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):"Create Subject"})]})]})},noe=({show:e,onClose:t,onImport:r,loading:a=!1,courseId:n,courseStartDate:i,courseEndDate:l})=>{const[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState([]),[h,x]=v.useState([]),[p,g]=v.useState([]),[j,w]=v.useState(!1),y=v.useRef(null),b=a||j,S=["code","name","course_id"],E=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],N=z=>{z.preventDefault(),z.stopPropagation(),z.type==="dragenter"||z.type==="dragover"?c(!0):z.type==="dragleave"&&c(!1)},T=z=>{z.preventDefault(),z.stopPropagation(),c(!1),z.dataTransfer.files&&z.dataTransfer.files[0]&&I(z.dataTransfer.files[0])},k=z=>{z.target.files&&z.target.files[0]&&I(z.target.files[0])},I=z=>{if(!z.name.match(/\.(xlsx|xls)$/)){x(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(z.size>100*1024*1024){x(["File size must be less than 100MB"]);return}d(z),x([]),D(z)},D=z=>{const ee=new FileReader;ee.onload=U=>{try{const X=new Uint8Array(U.target.result),oe=xc(X,{type:"array"}),Ee=oe.SheetNames[0],F=oe.Sheets[Ee],P=Ma.sheet_to_json(F,{header:1});if(P.length<2){x(["Excel file must contain at least a header row and one data row"]);return}const C=P[0].map(V=>V?.toString().toLowerCase().trim()),W=P.slice(1),J=(n?S.filter(V=>V!=="course_id"):S).filter(V=>!C.includes(V));if(J.length>0){x([`Missing required columns: ${J.join(", ")}`]);return}const le=W.map((V,re)=>{const he=C.includes("course_id")?V[C.indexOf("course_id")]?.toString().trim()||"":n||"",O={id:`temp_${re}`,rowNumber:re+2,code:V[C.indexOf("code")]?.toString().trim()||"",name:V[C.indexOf("name")]?.toString().trim()||"",course_id:he,description:V[C.indexOf("description")]?.toString().trim()||"",method:V[C.indexOf("method")]?.toString().trim()||"THEORY",duration:V[C.indexOf("duration")]?.toString().trim()||"",type:V[C.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:V[C.indexOf("room_name")]?.toString().trim()||"",remark_note:V[C.indexOf("remark_note")]?.toString().trim()||"",time_slot:V[C.indexOf("time_slot")]?.toString().trim()||"",pass_score:V[C.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const xe=V[C.indexOf("start_date")];return!xe&&xe!==0?"":($e=>{try{if($e instanceof Date){const Xe=$e.getFullYear(),ge=String($e.getMonth()+1).padStart(2,"0"),qe=String($e.getDate()).padStart(2,"0");return`${Xe}-${ge}-${qe}`}else if(typeof $e=="number"&&$e>0&&$e<1e5){const ge=$e-25569,qe=new Date(ge*86400*1e3),st=qe.getUTCFullYear(),Te=String(qe.getUTCMonth()+1).padStart(2,"0"),Ke=String(qe.getUTCDate()).padStart(2,"0");return`${st}-${Te}-${Ke}`}else return String($e).trim()}catch{return String($e).trim()}})(xe)})(),end_date:(()=>{const xe=V[C.indexOf("end_date")];return!xe&&xe!==0?"":($e=>{try{if($e instanceof Date){const Xe=$e.getFullYear(),ge=String($e.getMonth()+1).padStart(2,"0"),qe=String($e.getDate()).padStart(2,"0");return`${Xe}-${ge}-${qe}`}else if(typeof $e=="number"&&$e>0&&$e<1e5){const ge=$e-25569,qe=new Date(ge*86400*1e3),st=qe.getUTCFullYear(),Te=String(qe.getUTCMonth()+1).padStart(2,"0"),Ke=String(qe.getUTCDate()).padStart(2,"0");return`${st}-${Te}-${Ke}`}else return String($e).trim()}catch{return String($e).trim()}})(xe)})(),is_sim:C.includes("is_sim")||C.includes("issim")?V[C.indexOf(C.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(O.code||(O.hasError=!0,O.errors.push("Subject code is required")),O.name||(O.hasError=!0,O.errors.push("Subject name is required")),!O.course_id&&!n?(O.hasError=!0,O.errors.push("Course ID is required (either in file or must be importing from course detail page)")):O.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(O.course_id)||(O.hasError=!0,O.errors.push("Course ID must be a valid UUID format"))),O.duration&&(isNaN(O.duration)||parseInt(O.duration)<=0)&&(O.hasError=!0,O.errors.push("Duration must be a positive number")),O.pass_score&&(isNaN(O.pass_score)||parseFloat(O.pass_score)<0||parseFloat(O.pass_score)>100)&&(O.hasError=!0,O.errors.push("Pass score must be between 0 and 100")),O.method){let xe=O.method.toUpperCase().trim();xe==="E-LEARNING"||xe==="E LEARNING"||xe==="ELEARNING"?xe="E_LEARNING":xe==="CLASSROOM"||xe==="CLASS ROOM"||xe==="CLASS-ROOM"?xe="CLASSROOM":xe==="ERO"&&(xe="ERO"),O.method=xe,["E_LEARNING","CLASSROOM","ERO"].includes(xe)||(O.hasError=!0,O.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}O.type&&!["UNLIMIT","RECURRENT"].includes(O.type.toUpperCase())&&(O.hasError=!0,O.errors.push("Type must be UNLIMIT or RECURRENT"));const ye=xe=>{if(!xe||xe===""||xe==="N/A")return null;try{let me;if(xe instanceof Date)me=xe;else if(typeof xe=="string"){const $e=xe.trim();$e.match(/^\d{4}-\d{2}-\d{2}$/)?me=new Date($e+"T00:00:00.000Z"):me=new Date($e)}else me=new Date(xe);return isNaN(me.getTime())?null:me}catch{return null}};let de=null;!O.start_date||O.start_date===""||O.start_date==="N/A"?(O.hasError=!0,O.errors.push("Start date is required")):(de=ye(O.start_date),de||(O.hasError=!0,O.errors.push("Start date must be a valid date")));let je=null;if(!O.end_date||O.end_date===""||O.end_date==="N/A"?(O.hasError=!0,O.errors.push("End date is required")):(je=ye(O.end_date),je||(O.hasError=!0,O.errors.push("End date must be a valid date"))),de&&je&&(de>je&&(O.hasError=!0,O.errors.push("Start date must be before or equal to end date")),i&&l)){const xe=new Date(i),me=new Date(l),$e=new Date(xe.getFullYear(),xe.getMonth(),xe.getDate()),Xe=new Date(me.getFullYear(),me.getMonth(),me.getDate()),ge=new Date(de.getFullYear(),de.getMonth(),de.getDate()),qe=new Date(je.getFullYear(),je.getMonth(),je.getDate()),st=ze=>{if(!ze)return"";const et=new Date(ze),yt=et.getFullYear(),lt=String(et.getMonth()+1).padStart(2,"0"),Me=String(et.getDate()).padStart(2,"0");return`${yt}-${lt}-${Me}`},Te=st(i),Ke=st(l);(ge<$e||qe>Xe)&&(O.hasError=!0,O.errors.push(`Subject dates must stay within the course date range (Course: ${Te} to ${Ke})`))}return O}).filter(V=>V.code||V.name);f(le),g([])}catch{x(["Failed to parse Excel file. Please check the file format."])}},ee.readAsArrayBuffer(z)},A=async()=>{const z=m.filter(U=>!U.hasError);if(z.length===0){x(["No valid subjects to import"]);return}if(!n&&z.filter(X=>!X.course_id).length>0){x(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}w(!0),x([]);const ee=z.map(U=>{let X=!1;const oe=U.is_sim!==void 0?U.is_sim:void 0;if(oe!=null&&oe!=="")if(typeof oe=="string"){const W=oe.toLowerCase().trim();X=["true","1","yes","y"].includes(W)}else typeof oe=="boolean"?X=oe:typeof oe=="number"&&(X=oe!==0);const Ee=W=>{if(!W||W===""||W==="N/A")return null;try{let Z;if(typeof W=="string"){const he=W.trim();he.match(/^\d{4}-\d{2}-\d{2}$/)?Z=new Date(he+"T00:00:00.000Z"):Z=new Date(he)}else typeof W=="number"?Z=new Date(W):W instanceof Date?Z=W:Z=new Date(W);if(isNaN(Z.getTime()))return null;const J=Z.getFullYear();if(J<1900||J>2100)return null;const le=Z.getFullYear(),V=String(Z.getMonth()+1).padStart(2,"0"),re=String(Z.getDate()).padStart(2,"0");return`${le}-${V}-${re}T00:00:00.000Z`}catch{return null}},F=Ee(U.start_date),P=Ee(U.end_date),C={code:U.code,name:U.name,courseId:String(n||U.course_id),description:U.description||"",method:U.method?U.method.toUpperCase():"CLASSROOM",duration:U.duration?parseInt(U.duration):1,type:U.type?U.type.toUpperCase():"UNLIMIT",roomName:U.room_name||"",remarkNote:U.remark_note||"",timeSlot:U.time_slot||"",passScore:U.pass_score?parseFloat(U.pass_score):70,isSIM:X};return F&&(C.startDate=F),P&&(C.endDate=P),C});try{const U=await r(ee);let X=U;U&&U.data&&typeof U.data=="object"&&(X=U.data);const oe=X?.summary?.created??X?.createdSubjects?.length??X?.summary?.createdCount??X?.subjects?.length??0,Ee=X?.summary?.failed??X?.failedSubjects?.length??X?.summary?.failedCount??0,F=X?.summary?.skipped??X?.skippedSubjects?.length??X?.summary?.skippedCount??0,P=X?.summary?.total??ee.length;if(!(X?.summary||X?.createdSubjects!==void 0||X?.failedSubjects!==void 0)&&U!==null&&U!==void 0&&!U?.error&&!U?.message?.toLowerCase().includes("fail")){te.success(`Imported ${P}/${P} subjects successfully.`,{icon:!1}),M();return}const Z=(!X||oe===0&&Ee===0&&F===0&&P===0)&&!U?.error&&X?.message?.toLowerCase().includes("exist");X?.failedSubjects&&Array.isArray(X.failedSubjects)&&X.failedSubjects.length>0&&X.failedSubjects.forEach(J=>{const le=J.subject?.name||"Unknown Subject",V=J.subject?.code||"N/A",re=J.error||"Unknown error";te.error(`${le} (${V}): ${re}`,{autoClose:6e3,position:"top-right",icon:!1})}),Z||F>0?F>0?te.info(`${F} subject(s) already exist and were skipped. ${oe>0?`${oe} new subject(s) were imported.`:""}`,{icon:!1}):te.info("All subjects already exist. No new subjects were imported.",{icon:!1}):oe>0&&Ee===0?te.success(`Imported ${oe}/${P} subjects successfully.`,{icon:!1}):oe>0&&Ee>0?te.warn(`Imported ${oe}/${P}. ${Ee} failed.`,{icon:!1}):oe===0&&Ee>0?te.error(`All ${Ee}/${P} subjects failed to import.`,{icon:!1}):te.success(`Imported ${P}/${P} subjects successfully.`,{icon:!1}),w(!1),M()}catch(U){U?.response?.status===304?te.info("All subjects already exist. No new subjects were imported.",{icon:!1}):(te.error(U?.response?.data?.message||U.message||"Failed to import subjects.",{icon:!1}),x([U?.response?.data?.message||U.message||"Failed to import subjects. Please try again."]))}finally{w(!1)}},M=()=>{d(null),f([]),x([]),g([]),c(!1),t()},G=z=>z==="valid"?s.jsx(it,{className:"text-success",size:16}):s.jsx(zr,{className:"text-danger",size:16}),q=()=>{const z=[E,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15","2025-01-29"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01","2025-02-08"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01","2025-03-06"]],ee=Ma.aoa_to_sheet(z),U=Ma.book_new();Ma.book_append_sheet(U,ee,"Subjects"),Kg(U,"Subject_Upload_Template.xlsx")};return s.jsxs(se,{show:e,onHide:M,size:"xl",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Subjects"]}),s.jsx(ae,{variant:"link",onClick:M,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[h.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:h.map((z,ee)=>s.jsx("li",{children:z},ee))})}),s.jsx(Y,{className:"mb-4",children:s.jsxs(Y.Body,{children:[s.jsxs("div",{className:`upload-area ${o?"drag-active":""}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:T,onClick:()=>y.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:o?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Ul,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:y,type:"file",accept:".xlsx,.xls",onChange:k,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&s.jsx("span",{children:", Course ID (UUID format)"})]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:q,className:"d-flex align-items-center",children:[s.jsx(il,{className:"me-1",size:14}),"Download Template"]}),u&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ul,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:u.name})]})]})]})]})}),m.length>0&&s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",m.length," records)"]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(dr,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"CODE"}),s.jsx("th",{style:{minWidth:"200px"},children:"NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"COURSE ID"}),s.jsx("th",{style:{minWidth:"150px"},children:"METHOD"}),s.jsx("th",{style:{minWidth:"100px"},children:"DURATION"}),s.jsx("th",{style:{minWidth:"120px"},children:"TYPE"}),s.jsx("th",{style:{minWidth:"100px"},children:"PASS SCORE"}),s.jsx("th",{style:{minWidth:"150px"},children:"DESCRIPTION"}),s.jsx("th",{style:{minWidth:"150px"},children:"ROOM NAME"}),s.jsx("th",{style:{minWidth:"150px"},children:"TIME SLOT"}),s.jsx("th",{style:{minWidth:"150px"},children:"START DATE"}),s.jsx("th",{style:{minWidth:"150px"},children:"END DATE"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:m.map((z,ee)=>s.jsxs("tr",{className:z.hasError?"table-danger":"",children:[s.jsx("td",{children:z.rowNumber||ee+1}),s.jsx("td",{children:z.code||"-"}),s.jsx("td",{children:z.name||"-"}),s.jsx("td",{children:z.course_id||"-"}),s.jsx("td",{children:z.method||"-"}),s.jsx("td",{children:z.duration||"-"}),s.jsx("td",{children:z.type||"-"}),s.jsx("td",{children:z.pass_score||"-"}),s.jsx("td",{children:z.description||"-"}),s.jsx("td",{children:z.room_name||"-"}),s.jsx("td",{children:z.time_slot||"-"}),s.jsx("td",{children:z.start_date||"-"}),s.jsx("td",{children:z.end_date||"-"}),s.jsx("td",{className:"text-center",children:G(z.hasError?"invalid":"valid")}),s.jsx("td",{children:z.errors.length>0&&s.jsx("small",{className:"text-danger",children:z.errors.length>1?`${z.errors[0]} (+${z.errors.length-1} more)`:z.errors[0]})}),s.jsx("td",{children:s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{f(U=>U.filter(X=>X.id!==z.id))},children:s.jsx(ba,{size:14})})})]},z.id))})]})})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:M,disabled:b,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),m.length>0&&s.jsx(z2,{placement:"top",overlay:s.jsxs($2,{id:"import-tooltip",children:["Only ",m.filter(z=>!z.hasError).length,"/",m.length," subjects will be imported into DSFMS"]}),children:s.jsx(ae,{variant:"primary",onClick:A,disabled:b||m.filter(z=>!z.hasError).length===0,children:b?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import All (",m.filter(z=>!z.hasError).length," subjects)"]})})})]})]})},ioe=({show:e,onClose:t,onSave:r,course:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[o,c]=v.useState({}),[u,d]=v.useState(!1),m=g=>{if(!g)return"";if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g))return g;try{const j=new Date(g);return isNaN(j.getTime())?"":j.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?l({name:a.name||"",code:a.code||"",description:a.description||"",maxTrainees:a.maxNumTrainee||a.maxTrainees||"",venue:a.venue||"",note:a.note||"",passScore:a.passScore||"",startDate:m(a.startDate),endDate:m(a.endDate),level:a.level||"BEGINNER",status:a.status||"ACTIVE"}):e||(l({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}))},[e,a]);const f=()=>{c({}),t()},h=g=>{const{name:j,value:w}=g.target;l(y=>({...y,[j]:w})),o[j]&&c(y=>({...y,[j]:""}))},x=()=>{const g={};if(i.name.trim()||(g.name="Course name is required"),i.code.trim()||(g.code="Course code is required"),i.description.trim()||(g.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(g.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(g.venue="Venue is required"),i.passScore&&(isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(g.passScore="Pass score must be between 0 and 100"),!i.startDate)g.startDate="Start date is required";else{const j=new Date;j.setHours(0,0,0,0),new Date(i.startDate)<j&&(g.startDate="Start date cannot be in the past")}return i.endDate||(g.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(g.endDate="End date must be after start date"),c(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!x()){d(!0);try{const j={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:i.passScore?parseInt(i.passScore):null,startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},w=await Se.put(`/courses/${a.id}`,j);te.success("Course updated successfully!"),r&&await r(w.data||j),f()}catch(j){const w=j.response?.data?.message||j.message||"Failed to update course";te.error(`Error: ${w}`)}finally{d(!1)}}};return s.jsxs(se,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ar,{className:"me-2",size:20}),"Edit Course"]}),s.jsx(ae,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ue,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Course Name *"}),s.jsx(_.Control,{type:"text",name:"name",value:i.name,onChange:h,isInvalid:!!o.name,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.name})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Course Code *"}),s.jsx(_.Control,{type:"text",name:"code",value:i.code,onChange:h,isInvalid:!!o.code,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.code})]})})]}),s.jsxs(ue,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Max Trainees *"}),s.jsx(_.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:h,isInvalid:!!o.maxTrainees,disabled:n,min:"1"}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.maxTrainees})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Pass Score"}),s.jsx(_.Control,{type:"number",name:"passScore",value:i.passScore,onChange:h,onKeyPress:g=>g.key==="."&&g.preventDefault(),isInvalid:!!o.passScore,disabled:n,min:"0",max:"100",step:"1",placeholder:"Optional"}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),s.jsx(ue,{className:"mb-3",children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Level"}),s.jsxs(_.Select,{name:"level",value:i.level,onChange:h,disabled:n,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),s.jsxs(ue,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Start Date *"}),s.jsx(_.Control,{type:"date",name:"startDate",value:i.startDate,onChange:h,isInvalid:!!o.startDate,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.startDate})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"End Date *"}),s.jsx(_.Control,{type:"date",name:"endDate",value:i.endDate,onChange:h,isInvalid:!!o.endDate,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),s.jsx(ue,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Venue *"}),s.jsx(_.Control,{type:"text",name:"venue",value:i.venue,onChange:h,isInvalid:!!o.venue,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.venue})]})})}),s.jsx(ue,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Description"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:h,isInvalid:!!o.description,disabled:n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.description})]})})}),s.jsx(ue,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Note"}),s.jsx(_.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:h,disabled:n})]})})})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:f,disabled:n||u,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",type:"submit",disabled:n||u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},loe=({show:e,onClose:t,courseId:r,onSuccess:a})=>{const[n,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState([]),[f,h]=v.useState(null),x=v.useCallback(async()=>{o(!0),h(null);try{const b=await kr.getCourseEnrollmentBatches(r);let S=b?.batches||b?.data?.batches||[];S=S.filter(E=>{const N=E.statusCounts||{};return(N.ENROLLED||0)+(N.ON_GOING||0)>0}),i(S)}catch(b){const S=b?.response?.data?.message||b?.message||"Failed to load batches";h(S),te.error(S)}finally{o(!1)}},[r]);v.useEffect(()=>{e&&r?x():(i([]),m([]),h(null))},[e,r,x]);const p=b=>{m(S=>S.includes(b)?S.filter(E=>E!==b):[...S,b])},g=()=>{d.length===n.length?m([]):m(n.map(b=>b.batchCode))},j=async()=>{if(d.length===0){te.error("Please select at least one batch to delete");return}u(!0);try{const b=d.map(E=>kr.deleteBatchEnrollments(r,E));await Promise.all(b);const S=d.length;te.success(`Successfully deleted all enrollments for ${S} batch(es)`),a&&a(),t()}catch(b){const S=b?.response?.data?.message||b?.message||"Failed to delete batch enrollments";te.error(S)}finally{u(!1)}},w=b=>{if(Object.values(b).reduce((N,T)=>N+T,0)===0)return s.jsx(Ae,{bg:"secondary",children:"No enrollments"});const E=(b.ENROLLED||0)+(b.ON_GOING||0);return E>0?s.jsxs(Ae,{bg:"success",children:[E," Active"]}):s.jsx(Ae,{bg:"secondary",children:"All Cancelled"})},y=n.filter(b=>d.includes(b.batchCode));return s.jsxs(se,{show:e,onHide:t,size:"xl",centered:!0,children:[s.jsx(se.Header,{className:"bg-danger text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(ba,{className:"me-2",size:20}),"Delete All Subject Enrollments by Batch Code"]})}),s.jsx(se.Body,{className:"p-4",style:{height:"450px",overflowY:"auto",display:"flex",flexDirection:"column"},children:l?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading batches..."})]}):f?s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:f}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:x,children:"Try Again"})]}):n.length===0?s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-muted",children:"No batches with active enrollments found for this course."})}):s.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[s.jsxs(Ue,{variant:"warning",className:"mb-3",style:{flexShrink:0},children:[s.jsx("strong",{children:"Warning:"})," This action will permanently delete all subject enrollments for the selected batch(es). This cannot be undone."]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",style:{flexShrink:0},children:[s.jsx("h6",{className:"mb-0",children:"Select batch(es) to delete:"}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:g,children:d.length===n.length?"Deselect All":"Select All"})]}),s.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:s.jsxs(dr,{hover:!0,responsive:!0,children:[s.jsx("thead",{className:"table-light",style:{position:"sticky",top:0,zIndex:10},children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"50px"},children:s.jsx("input",{type:"checkbox",checked:d.length===n.length&&n.length>0,onChange:g})}),s.jsx("th",{children:"Batch Code"}),s.jsx("th",{children:"Trainees"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Subjects"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:n.map(b=>{const S=d.includes(b.batchCode);return s.jsxs("tr",{onClick:()=>p(b.batchCode),style:{cursor:"pointer",backgroundColor:S?"#e7f3ff":"transparent"},children:[s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:S,onChange:()=>p(b.batchCode),onClick:E=>E.stopPropagation()})}),s.jsx("td",{children:s.jsx("strong",{children:b.batchCode})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vs,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.totalTrainees})]})}),s.jsx("td",{children:s.jsx(Ae,{bg:"success",children:b.activeTrainees})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.subjects?.length||0})]})}),s.jsx("td",{children:w(b.statusCounts)})]},b.batchCode)})})]})})]}),s.jsx("div",{className:"mt-3 p-3 bg-light rounded",style:{minHeight:"120px",maxHeight:"150px",overflowY:"auto",flexShrink:0},children:d.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("h6",{className:"mb-2",children:["Selected Batch Details (",d.length,"):"]}),s.jsx("div",{children:y.map(b=>s.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[s.jsxs("p",{className:"mb-1",children:[s.jsx("strong",{children:"Batch Code:"})," ",b.batchCode]}),s.jsxs("p",{className:"mb-1",children:[s.jsx("strong",{children:"Total Trainees:"})," ",b.totalTrainees," ","(",s.jsxs(Ae,{bg:"success",className:"ms-1",children:[b.activeTrainees," Active"]}),")"]}),s.jsxs("p",{className:"mb-1",children:[s.jsx("strong",{children:"Subjects:"})," ",b.subjects?.length||0]}),b.subjects&&b.subjects.length>0&&s.jsxs("div",{className:"mt-1",children:[s.jsx("strong",{children:"Subject Details:"}),s.jsx("ul",{className:"mt-1 mb-0",style:{fontSize:"0.875rem"},children:b.subjects.map(S=>s.jsxs("li",{children:[S.subjectCode," - ",S.subjectName," ","(",S.activeTrainees,"/",S.totalTrainees," active)"]},S.subjectId))})]})]},b.batchCode))})]}):s.jsx("div",{className:"text-muted",style:{minHeight:"60px",display:"flex",alignItems:"center"},children:s.jsx("span",{children:"No batches selected"})})})]})}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:t,disabled:c,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"danger",onClick:j,disabled:d.length===0||c||l||n.length===0,children:c?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Deleting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"me-2",size:16}),"Delete Enrollments (",d.length,")"]})})]})]})},ooe=({show:e,onClose:t,onConfirm:r,trainer:a,loading:n=!1})=>{const i=async()=>{await r(a?.id)};return s.jsxs(se,{show:e,onHide:t,centered:!0,children:[s.jsx(se.Header,{className:"bg-danger text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",size:20}),"Remove Trainer from Course"]})}),s.jsx(se.Body,{className:"p-4",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-3",children:"You are about to remove the following trainer from the course:"}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Name:"})," ",a?.lastName,a?.middleName?" "+a?.middleName:""," ",a?.firstName]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"EID:"})," ",a?.eid]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Email:"})," ",a?.email]}),a?.roleInCourse&&a.roleInCourse.length>0&&s.jsxs("div",{children:[s.jsx("strong",{children:"Role:"})," ",a.roleInCourse.join(", ")]})]}),s.jsxs("div",{className:"alert alert-warning mb-0",role:"alert",children:[s.jsx("strong",{children:"Warning:"})," This action cannot be undone. The trainer will no longer have access to this course."]})]})}),s.jsxs(se.Footer,{className:"border-top p-3",children:[s.jsx(ae,{variant:"outline-secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:"danger",onClick:i,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"me-2",size:16}),"Remove Trainer"]})})]})]})},coe=({show:e,onClose:t,onSave:r,trainer:a,loading:n=!1})=>{const[i,l]=v.useState({roleInCourse:[]}),[o,c]=v.useState([]);v.useEffect(()=>{if(a&&e){const p=a.roleInCourse&&Array.isArray(a.roleInCourse)?a.roleInCourse:a.roleInCourse?[a.roleInCourse]:["EXAMINER"],g=p[0]==="EXAMINER"||p[0]==="ASSESSMENT_REVIEWER"?p[0]:"EXAMINER";l({roleInCourse:p.length>0?[g]:["EXAMINER"]}),c([])}},[a,e]);const u=p=>{const{name:g,value:j}=p.target;l(w=>({...w,[g]:[j]}))},d=()=>{const p=[];return(!i.roleInCourse||i.roleInCourse.length===0)&&p.push("Role in course is required"),c(p),p.length===0},m=async p=>{if(p.preventDefault(),!!d())try{const g={roleInCourse:i.roleInCourse[0]||i.roleInCourse};await r(g),f()}catch{}},f=()=>{l({roleInCourse:["EXAMINER"]}),c([]),t()},h=p=>p?p.name?p.name:`${p.lastName||""}${p.middleName?" "+p.middleName:""} ${p.firstName||""}`.trim():"",x=()=>i.roleInCourse&&i.roleInCourse.length>0?i.roleInCourse[0]:"EXAMINER";return s.jsxs(se,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ar,{className:"me-2",size:20}),"Edit Trainer"]}),s.jsx(ae,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",children:[o.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((p,g)=>s.jsx("li",{children:p},g))})}),s.jsxs(_,{onSubmit:m,children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Trainer Name"}),s.jsx(_.Control,{type:"text",value:h(a),disabled:!0,className:"bg-light"})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"EID"}),s.jsx(_.Control,{type:"text",value:a?.eid||"",disabled:!0,className:"bg-light"})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Role in Course *"}),s.jsxs(_.Select,{name:"roleInCourse",value:x(),onChange:u,disabled:n,children:[s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),s.jsx(_.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the course (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Al=({course:e,department:t}={})=>{const r=ft(),{courseId:a,traineeId:n}=Or(),i=na(),{user:l}=Rr(),{hasPermission:o}=ln(),c=n!==void 0,u=XS(l),d=o(De.ASSIGN_TRAINERS)||o(De.REMOVE_TRAINERS),[m,f]=v.useState(!1),[h,x]=v.useState(!1),[p,g]=v.useState(!1),[j,w]=v.useState(!1),[y,b]=v.useState(null),[S,E]=v.useState(!1),[N,T]=v.useState(!1),[k,I]=v.useState(null),[D,A]=v.useState(!1),[M,G]=v.useState(!1),[q,z]=v.useState(!1),[ee,U]=v.useState(!1),[X,oe]=v.useState(null),[Ee,F]=v.useState(null),[P,C]=v.useState(!1),[W,Z]=v.useState(0),[J,le]=v.useState(null),[V,re]=v.useState([]),[he,O]=v.useState([]),[ye,de]=v.useState(!0),je=Ge=>Array.isArray(Ge)?Ge.filter(Ce=>Ce?.status?.toUpperCase()!=="ARCHIVED"&&!Ce?.deletedAt):[],xe=Ge=>{if(Ge&&Ge.instructors&&Array.isArray(Ge.instructors)){const Ce=Ge.instructors.map(He=>({id:He.id,eid:He.eid,name:`${He.lastName}${He.middleName?" "+He.middleName:""} ${He.firstName}`,email:He.email,phoneNumber:He.phoneNumber,role:He.roleInCourse?.[0]||"TRAINER",assignedAt:He.assignedAt||new Date}));O(Ce)}else O([])},[me,$e]=v.useState(()=>i.state?.activeTab?i.state.activeTab:"course-info");v.useEffect(()=>{i.state?.activeTab&&($e(i.state.activeTab),window.history.replaceState({},document.title))},[i.state]),v.useEffect(()=>{a&&(async()=>{if(a){de(!0);try{const Ce=await kr.getCourseById(a);if(!Ce)throw new Error("Invalid API response");const He={id:Ce.id||a,name:Ce.name,code:Ce.code,description:Ce.description,maxTrainees:Ce.maxNumTrainee,maxNumTrainee:Ce.maxNumTrainee,venue:Ce.venue,note:Ce.note,passScore:Ce.passScore,startDate:Ce.startDate?new Date(Ce.startDate).toISOString().split("T")[0]:"",endDate:Ce.endDate?new Date(Ce.endDate).toISOString().split("T")[0]:"",level:Ce.level,status:Ce.status,department:Ce.department,subjectCount:Ce.subjectCount||0,traineeCount:Ce.traineeCount||0,trainerCount:Ce.trainerCount||0,instructors:Ce.courseInstructors||[]};le(He),xe(He),Ce.subjects&&Array.isArray(Ce.subjects)?re(je(Ce.subjects)):Ce.subjectCount>0&&!Ce.subjects?re([]):re([]),de(!1)}catch{if(e&&e.id&&e.name){const Ce={id:e.id,name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,maxNumTrainee:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||t,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,instructors:e.instructors||[]};le(Ce),re([])}else le(null),re([]);de(!1)}}})()},[a]);const Xe=()=>{r(c?Pe.COURSES_ENROLLED:-1)};if(ye)return s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!J)return s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h5",{className:"text-muted",children:"Course not found"}),s.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),s.jsxs(ae,{variant:"primary",onClick:Xe,children:[s.jsx(Bt,{className:"me-2"}),c?"Back to Enrolled Courses":"Back to Department"]})]})});const ge=Ge=>{r(u?Pe.SUBJECTS_IN_COURSE(a,Ge):`/courses/${a}/subjects/${Ge}`)},qe=()=>{},st=Ge=>{const Ce=V.find(He=>He.id===Ge);Ce&&(b(Ce),w(!0))},Te=async()=>{if(y){E(!0);try{await gs.archiveSubject(y.id),te.success(`Successfully archived subject "${y.name}"`,{autoClose:3e3,position:"top-right",icon:!1}),re(Ge=>Ge.filter(Ce=>Ce.id!==y.id)),w(!1),b(null)}catch(Ge){const Ce=Ge?.response?.data?.message||Ge?.message||"Failed to archive subject";te.error(`Error: ${Ce}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{E(!1)}}},Ke=()=>{r(`/academic/course/${J?.id}/enroll-trainees`)},ze=async()=>{try{const Ge=await kr.getCourseById(a);Ge.subjects&&Array.isArray(Ge.subjects)&&re(je(Ge.subjects))}catch(Ge){const Ce=Ge?.response?.data?.message||Ge?.message||"Failed to refresh subjects after creation";te.error(`Error: ${Ce}`,{autoClose:4e3,position:"top-right",icon:!1})}},et=async Ge=>{const Ce=await gs.bulkImportSubjects(Ge),He=await kr.getCourseById(a);return He.subjects&&Array.isArray(He.subjects)&&re(je(He.subjects)),x(!1),Ce},yt=async Ge=>{try{await kr.updateCourse(a,Ge);const Ce=await kr.getCourseById(a);Ce&&(le(Ce),Ce.subjects&&Array.isArray(Ce.subjects)&&re(je(Ce.subjects)),xe(Ce)),g(!1)}catch(Ce){console.error("Error updating course:",Ce)}},lt=async Ge=>{try{C(!0),await kr.assignTrainerToCourse(a,Ge),te.success("Trainer assigned successfully!",{autoClose:3e3,position:"top-right"}),G(!1);const Ce=await kr.getCourseById(a);Ce&&(le(He=>({...He,instructors:Ce.courseInstructors||[]})),xe({...Ce,instructors:Ce.courseInstructors||[]}))}catch(Ce){const He=Ce?.response?.data?.message||Ce?.message||"Failed to assign trainer";te.error(`Error: ${He}`,{autoClose:4e3,position:"top-right",icon:!1}),console.error("Error assigning trainer:",Ce)}finally{C(!1)}},Me=async Ge=>{if(!Ge)return;const Ce=J?.instructors?.find(He=>He.id===Ge);F(Ce),U(!0)},ke=async Ge=>{if(Ee){C(!0);try{await kr.updateTrainerInCourse(a,Ee.id,Ge),te.success("Trainer role updated successfully!",{autoClose:3e3,position:"top-right"}),U(!1);const Ce=await kr.getCourseById(a);Ce&&(le(He=>({...He,instructors:Ce.courseInstructors||[]})),xe({...Ce,instructors:Ce.courseInstructors||[]}))}catch(Ce){const He=Ce?.response?.data?.message||Ce?.message||"Failed to update trainer role";te.error(`Error: ${He}`,{autoClose:4e3,position:"top-right",icon:!1}),console.error("Error updating trainer role:",Ce)}finally{C(!1)}}},nt=async Ge=>{if(!Ge)return;const Ce=J?.instructors?.find(He=>He.id===Ge);oe(Ce),z(!0)},tt=async Ge=>{try{C(!0),await kr.removeTrainerFromCourse(a,Ge),te.success("Trainer removed successfully!",{autoClose:3e3,position:"top-right"}),le(Ce=>({...Ce,instructors:(Ce.instructors||[]).filter(He=>He.id!==Ge),trainerCount:Math.max(0,(Ce.trainerCount||0)-1)})),O(Ce=>Ce.filter(He=>He.id!==Ge)),z(!1),oe(null)}catch(Ce){const He=Ce?.response?.data?.message||Ce?.message||"Failed to remove trainer";te.error(`Error: ${He}`,{autoClose:4e3,position:"top-right",icon:!1}),console.error("Error removing trainer:",Ce)}finally{C(!1)}};return s.jsxs(Be,{fluid:!0,className:"py-2 course-detail",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:Xe,className:"me-3",children:[s.jsx(Bt,{size:16,className:"me-1"}),"Back"]}),s.jsx("div",{children:s.jsxs("h4",{className:"mb-0 text-primary",children:[s.jsx("strong",{children:J?.name||"Loading..."}),"  ",J?.code||""]})})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("div",{className:"d-flex",children:J?.status==="PLANNED"&&s.jsx(Nt,{permission:De.ENROLL_SINGLE_TRAINEE,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"primary",onClick:Ke,children:[s.jsx(Vs,{size:14,className:"me-1"})," Enroll Trainees"]})})}),s.jsxs("div",{className:"d-flex gap-2",children:[J?.status==="PLANNED"&&s.jsx(Nt,{permission:De.UPDATE_COURSE,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"outline-secondary",onClick:()=>g(!0),children:[s.jsx(Ar,{size:14,className:"me-1"})," Edit Course"]})}),s.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),J?.status==="PLANNED"&&s.jsx(Nt,{permission:De.CREATE_SUBJECT,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"primary",onClick:()=>f(!0),children:[s.jsx(yr,{size:14,className:"me-1"})," Add Subject"]})}),J?.status==="PLANNED"&&s.jsx(Nt,{permission:De.CREATE_BULK_SUBJECTS,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"outline-primary",onClick:()=>x(!0),children:[s.jsx(js,{size:14,className:"me-1"})," Import Bulk Subjects"]})}),J?.status==="PLANNED"&&s.jsx(Nt,{permission:De.REMOVE_TRAINEE_FROM_ENROLLMENT,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"outline-danger",onClick:()=>A(!0),children:[s.jsx(ba,{size:14,className:"me-1"})," Delete Enrollment Batch"]})})]})]}),s.jsx(Y,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Tt.Container,{activeKey:me,onSelect:$e,children:[s.jsxs(Y.Header,{className:"border-bottom py-2 bg-primary d-flex justify-content-between align-items-center",children:[s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:me==="course-info"?"600":"400",opacity:me==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($t,{className:"me-2",size:16}),"Course Information"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:me==="subjects"?"600":"400",opacity:me==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(gt,{className:"me-2",size:16}),"Subjects"]})}),o(De.ENROLL_SINGLE_TRAINEE)&&s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:me==="trainees"?"600":"400",opacity:me==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Vs,{className:"me-2",size:16}),"Trainees Roster"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"assign-trainer",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:me==="assign-trainer"?"600":"400",opacity:me==="assign-trainer"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(On,{className:"me-2",size:16}),"Trainers In Assessment"]})}),!c&&s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:me==="assessment-events"?"600":"400",opacity:me==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(va,{className:"me-2",size:16}),"Assessment Events"]})})]}),me==="assign-trainer"&&s.jsx(Nt,{permission:De.ASSIGN_TRAINERS,fallback:null,children:s.jsxs(ae,{variant:"light",size:"sm",onClick:()=>G(!0),className:"d-flex align-items-center",style:{backgroundColor:"#ffffff",color:"#000000",border:"1px solid #dee2e6"},children:[s.jsx(yr,{size:16,className:"me-2"}),"Add Trainer"]})})]}),s.jsx(Y.Body,{className:"p-0",children:s.jsxs(Tt.Content,{children:[s.jsx(Tt.Pane,{eventKey:"course-info",children:s.jsxs("div",{className:"p-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-3",style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem"},children:"Description"}),s.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.95rem"},children:J.description})]})})}),s.jsxs(ue,{className:"g-4",children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Name"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:J.name})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Code"}),s.jsx(Ae,{bg:"secondary",className:"px-2 py-1",children:J.code})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Level"}),s.jsx(Ae,{bg:"info",className:"px-2 py-1",children:J.level})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date / End Date"}),s.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[s.jsxs("div",{className:"d-flex align-items-center me-4",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:J.startDate||"N/A"})]}),s.jsx("span",{className:"text-muted me-2",children:"/"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:J.endDate||"N/A"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Note"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:J.note||"N/A"})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Max Number of Trainees"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(On,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:J.maxTrainees})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ec,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:J.venue})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(V2,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:J.passScore})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Status"}),s.jsx(Ae,{bg:J.status==="ACTIVE"?"success":J.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:J.status?.replace(/_/g," ")})]})]})]})]})}),s.jsx(Tt.Pane,{eventKey:"subjects",children:s.jsx(soe,{subjects:V,loading:!1,onView:ge,onEdit:qe,onDelete:st})}),o(De.ENROLL_SINGLE_TRAINEE)&&s.jsx(Tt.Pane,{eventKey:"trainees",style:{height:"100%"},children:s.jsx(z5,{courseId:a,loading:!1,title:"Trainees Roster",refreshTrigger:W})}),s.jsx(Tt.Pane,{eventKey:"assign-trainer",style:{height:"100%"},children:s.jsx(F5,{trainers:he,variant:"course",onEdit:Ge=>Me(Ge),onDelete:Ge=>nt(Ge),hasActionPermission:d,editPermission:De.ASSIGN_TRAINERS,emptyMessage:"No trainers assigned yet."})}),!c&&s.jsx(Tt.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(B5,{courseId:a,onView:Ge=>{I(Ge),T(!0)}})})]})})]})}),s.jsx(aoe,{show:m,onClose:()=>f(!1),onSave:ze,courseId:a,courseStartDate:J?.startDate,courseEndDate:J?.endDate}),s.jsx(noe,{show:h,onClose:()=>x(!1),onImport:et,courseId:a,courseStartDate:J?.startDate,courseEndDate:J?.endDate}),s.jsx(ioe,{show:p,onClose:()=>g(!1),onSave:yt,course:J||e}),s.jsx(M5,{show:M,onClose:()=>G(!1),onSave:lt,loading:P,courseId:a,subjectId:null}),s.jsx(coe,{show:ee,onClose:()=>{U(!1),F(null)},onSave:ke,trainer:Ee,loading:P}),s.jsx(ooe,{show:q,onClose:()=>{z(!1),oe(null)},onConfirm:tt,trainer:X,loading:P}),s.jsx(L5,{show:j,onClose:()=>{w(!1),b(null)},onDisable:Te,subject:y,loading:S}),s.jsx(Xy,{show:N,onClose:()=>{T(!1),I(null)},event:k}),s.jsx(loe,{show:D,onClose:()=>A(!1),courseId:a,onSuccess:()=>{Z(Ge=>Ge+1)}})]})},doe=()=>{const{courseId:e}=Or(),t=na(),[r,a]=v.useState(null),[n,i]=v.useState(null),[l,o]=v.useState(!0);return v.useEffect(()=>{e&&(async()=>{try{o(!0);try{const u=await kr.getCourseById(e);a(u),u&&u.department&&i(u.department)}catch{const d={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},m={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};a(d),i(m)}o(!1)}catch{o(!1)}})()},[e]),l?s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?s.jsx(Be,{className:"py-3",children:s.jsx(Al,{course:r,department:n})}):s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},uoe=({selectedSubjects:e,onSelectionChange:t,subjects:r=null})=>{const[a,n]=v.useState(""),[i,l]=v.useState([]),[o,c]=v.useState(!r),[u,d]=v.useState(null),m=g=>Array.isArray(g)?g.filter(j=>j?.status?.toUpperCase()!=="ARCHIVED"&&!j?.deletedAt):[];v.useEffect(()=>{if(r&&Array.isArray(r)){const w=m(r).map(y=>({id:y.id,name:y.name,code:y.code}));l(w),c(!1);return}(async()=>{try{c(!0),d(null);const j=await gs.getSubjects();if(j&&j.subjects){const y=m(j.subjects).map(b=>({id:b.id,name:b.name,code:b.code}));l(y)}else l([])}catch{d("Failed to load subjects"),l([])}finally{c(!1)}})()},[r]);const f=i.filter(g=>g.name.toLowerCase().includes(a.toLowerCase())||g.code.toLowerCase().includes(a.toLowerCase())),h=()=>{e.length===f.length?t([]):t(f.map(g=>g.id))},x=g=>{e.includes(g)?t(e.filter(j=>j!==g)):t([...e,g])},p=f.length>0&&e.length===f.length;return s.jsxs(Y,{className:"d-flex flex-column h-100 subject-selection-panel-card",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",overflow:"visible",marginBottom:"2rem"},children:[s.jsx(Y.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),s.jsx(ae,{variant:"outline-light",size:"sm",onClick:h,children:p?"Deselect All":"Select All"})]})}),s.jsxs(Y.Body,{className:"p-0 d-flex flex-column subject-selection-panel-body",style:{height:"500px",minHeight:0,display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"p-2 border-bottom flex-shrink-0",children:s.jsx(_.Control,{type:"text",placeholder:"Search subjects...",value:a,onChange:g=>n(g.target.value),size:"sm"})}),s.jsx("div",{className:"subject-list-scroll-container",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%"},children:o?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):u?s.jsx("div",{className:"p-3 text-center text-danger",children:s.jsx("p",{className:"mb-0",children:u})}):f.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No subjects found"})}):f.map(g=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>x(g.id),children:[s.jsx("div",{className:"me-3 flex-shrink-0",children:e.includes(g.id)?s.jsx(q2,{size:20,className:"text-primary"}):s.jsx(cS,{size:20,className:"text-muted"})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:g.name,children:g.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:g.code,children:g.code})]})]},g.id))}),s.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:s.jsxs("small",{className:"text-muted",children:[e.length," of ",f.length," subjects selected"]})})]})]})},moe=({selectedTrainees:e,onSelectionChange:t,subjects:r=[],availableTrainees:a=[],loadingTrainees:n=!1})=>{const[i,l]=v.useState(""),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(null),h=v.useRef(null);v.useEffect(()=>{const y=b=>{h.current&&!h.current.contains(b.target)&&c(!1)};return o&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[o]);const x=Array.isArray(a)?a.map(y=>{const b=[y.lastName,y.middleName,y.firstName].filter(Boolean),S=b.length>0?b.join(" ").trim():y.eid;return{id:y.id,eid:y.eid,name:S,firstName:y.firstName||"",lastName:y.lastName||"",email:y.email,status:y.status||"ACTIVE",departmentId:y.departmentId,departmentName:y.department?.name||""}}):[],p=async()=>{console.warn("loadTrainees called but should not be - parent handles API calls")},g=x.filter(y=>y.name.toLowerCase().includes(i.toLowerCase())||y.eid.toLowerCase().includes(i.toLowerCase()));v.useEffect(()=>{i.trim().length>0&&c(!0)},[i]);const j=y=>{e.find(b=>b.id===y.id)||(t([...e,y]),f(y.id),setTimeout(()=>{f(null)},2e3))},w=y=>{t(e.filter(b=>b.id!==y))};return s.jsxs(Y,{className:"trainee-selection-card",children:[s.jsx(Y.Header,{className:"bg-gradient-primary-custom text-white border-0 trainee-card-header",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),s.jsxs(Y.Body,{className:"trainee-card-body p-0",children:[s.jsxs("div",{className:"trainee-available-section",ref:h,children:[s.jsx("div",{className:"p-2 border-bottom",children:s.jsx(_.Control,{type:"text",placeholder:"Search by EID or name...",value:i,onChange:y=>l(y.target.value),size:"sm"})}),s.jsx("div",{className:"p-2",children:s.jsxs(ae,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>c(!o),disabled:n,children:[s.jsxs("span",{children:[s.jsx(Vs,{className:"me-2",size:16}),n?"Loading...":i.trim().length>0?`Available Trainees (${g.length})`:`Show All Available Trainees (${x.length})`]}),s.jsx(sn,{size:16})]})}),o&&s.jsx("div",{className:"border bg-white",style:{position:"absolute",top:"calc(100% + 8px)",left:0,right:0,zIndex:1050,maxHeight:"350px",overflowY:"auto",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1)"},children:n?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):u?s.jsxs("div",{className:"p-3 text-center text-danger",children:[s.jsx("p",{className:"mb-0",children:u}),s.jsx(ae,{size:"sm",variant:"outline-danger",onClick:p,className:"mt-2",children:"Retry"})]}):g.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees found"})}):g.map(y=>{const b=e.find(S=>S.id===y.id);return s.jsxs("div",{className:`p-2 border-bottom d-flex align-items-center justify-content-between ${b?"bg-success bg-opacity-10":"hover-bg-light"}`,style:{cursor:b?"not-allowed":"pointer",minWidth:0,transition:"all 0.3s ease",opacity:b?.6:1},onClick:()=>{b||j(y)},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),b?s.jsx(it,{size:16,className:"text-success flex-shrink-0"}):s.jsx(yr,{size:14,className:"text-primary flex-shrink-0"})]},y.id)})})]}),s.jsxs("div",{className:"trainee-selected-section",children:[s.jsx("div",{className:"trainee-selected-header",children:s.jsxs("small",{className:"text-white fw-semibold",children:["Selected Trainees (",e.length,")"]})}),s.jsx("div",{className:"trainee-selected-list",children:e.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees selected"})}):s.jsx("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:e.map(y=>{const b=m===y.id;return s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0,backgroundColor:b?"rgba(40, 167, 69, 0.1)":"transparent",animation:b?"slideInRight 0.5s ease-out, highlightPulse 0.5s ease-out":"none",transition:"background-color 0.3s ease",flexShrink:0},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),s.jsx(ae,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>w(y.id),children:s.jsx(ht,{size:14})})]},y.id)})})})]})]})]})},foe=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState(null),[f,h]=v.useState([]),[x,p]=v.useState([]),[g,j]=v.useState([]),[w,y]=v.useState(!1),b=v.useRef(null),S=["eid","email"],E=z=>{z.preventDefault(),z.stopPropagation(),z.type==="dragenter"||z.type==="dragover"?i(!0):z.type==="dragleave"&&i(!1)},N=z=>{z.preventDefault(),z.stopPropagation(),i(!1),z.dataTransfer.files&&z.dataTransfer.files[0]&&k(z.dataTransfer.files[0])},T=z=>{z.target.files&&z.target.files[0]&&k(z.target.files[0])},k=z=>{if(!z.name.match(/\.(xlsx|xls)$/)){p(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(z.size>100*1024*1024){p(["File size must be less than 100MB"]);return}o(z),p([]),I(z)},I=z=>{const ee=new FileReader;ee.onload=U=>{try{const X=new Uint8Array(U.target.result),oe=xc(X,{type:"array"}),Ee=oe.SheetNames[0],F=oe.Sheets[Ee],P=Ma.sheet_to_json(F,{header:1});if(P.length<2){p(["Excel file must contain at least a header row and one data row"]);return}const C=P[0].map(V=>V?.toString().toLowerCase().trim()),W=P.slice(1),Z=S.filter(V=>!C.includes(V));if(Z.length>0){p([`Missing required columns: ${Z.join(", ")}`]);return}const le=W.map((V,re)=>{const he=V[C.indexOf("eid")]?.toString().trim()||"",O=V[C.indexOf("email")]?.toString().trim()||"";return{id:`temp_${re}`,rowNumber:re+2,eid:he,email:O,hasError:!1,errors:[]}}).filter(V=>V.eid||V.email).map(V=>(V.eid||(V.hasError=!0,V.errors.push("EID is required")),V.email?/\S+@\S+\.\S+/.test(V.email)||(V.hasError=!0,V.errors.push("Email format is invalid")):(V.hasError=!0,V.errors.push("Email is required")),V));u(le),j([]),D(le)}catch{p(["Failed to parse Excel file. Please check the file format."])}},ee.readAsArrayBuffer(z)},D=async z=>{const ee=z.filter(U=>!U.hasError);if(ee.length!==0){y(!0),p([]);try{const U=ee.map(J=>({eid:J.eid,email:J.email})),X=await su.lookupTrainees(U);console.log("Lookup API response:",X);const oe=X.data||X;console.log("Response data extracted:",oe);const Ee=oe.foundUsers||[],F=oe.notFoundIdentifiers||[];console.log("Found users:",Ee),console.log("Not found identifiers:",F);const P={};Ee.forEach(J=>{const le=`${J.eid}:${J.email}`;P[le]=J,console.log(`Mapped trainee: ${le}`,J)}),console.log("Found users map:",P);const C=z.map(J=>{const le=`${J.eid}:${J.email}`,V=P[le];return console.log(`Checking item ${le}:`,{item:J,foundUser:V,key:le}),J.hasError?J:V?(console.log(` Matched: ${le}`),{...J,matchedUser:V,isMatched:!0,errors:[]}):(console.log(` Not found: ${le}`),{...J,isMatched:!1,errors:["Trainee not found in system"]})});console.log("Updated preview data:",C),u(C);const W=C.filter(J=>J.matchedUser).map(J=>J.matchedUser);h(W);const Z=C.filter(J=>!J.isMatched&&!J.hasError).length;m({foundUsers:W,notFoundIdentifiers:C.filter(J=>!J.isMatched&&!J.hasError).map(J=>({eid:J.eid,email:J.email})),uploadedIdentifiers:U,hasErrors:Z>0})}catch(U){console.error("Lookup error:",U),p([U.response?.data?.message||U.message||"Failed to lookup trainees. Please try again."])}finally{y(!1)}}},A=async()=>{if(f.length===0){p(["Please select at least one trainee to import"]);return}try{r&&await r(f),M()}catch(z){p([z.message||"Failed to import selected trainees. Please try again."])}},M=()=>{o(null),u([]),m(null),h([]),p([]),j([]),i(!1),y(!1),t()},G=z=>z==="valid"?s.jsx(it,{className:"text-success",size:16}):s.jsx(zr,{className:"text-danger",size:16}),q=()=>{const z=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","trollergamehuydk+7@gmail.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],ee=Ma.book_new(),U=Ma.aoa_to_sheet(z);U["!cols"]=[{wch:15},{wch:30}],Ma.book_append_sheet(ee,U,"Trainees Lookup Template"),Kg(ee,"Trainees_Lookup_Template.xlsx")};return s.jsxs(se,{show:e,onHide:M,size:"xl",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Trainees"]}),s.jsx(ae,{variant:"link",onClick:M,className:"text-white p-0",children:s.jsx(ht,{size:24})})]}),s.jsxs(se.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[x.length>0&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:x.map((z,ee)=>s.jsx("li",{children:z},ee))})}),s.jsx(Y,{className:"mb-4",children:s.jsxs(Y.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:N,onClick:()=>b.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Ul,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:b,type:"file",accept:".xlsx,.xls",onChange:T,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," eid, email"]}),s.jsx("div",{className:"mt-1",children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:q,className:"d-flex align-items-center",children:[s.jsx(il,{className:"me-1",size:14}),"Download Template"]})})]}),l&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ul,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})}),c.length>0&&s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(dr,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"800px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"150px"},children:"EID"}),s.jsx("th",{style:{minWidth:"250px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"300px"},children:"ERROR ENCOUNTERED"})]})}),s.jsx("tbody",{children:c.map(z=>{const ee=z.isMatched===!0&&!z.hasError,U=z.hasError||z.errors&&z.errors.length>0;return s.jsxs("tr",{className:U?"table-danger":ee?"table-success":"",children:[s.jsx("td",{children:z.rowNumber||z.id}),s.jsx("td",{children:z.eid||"-"}),s.jsx("td",{children:z.email||"-"}),s.jsx("td",{className:"text-center",children:G(ee?"valid":"invalid")}),s.jsx("td",{children:z.errors&&z.errors.length>0&&s.jsx("small",{className:"text-danger",children:z.errors.length>1?`${z.errors[0]} (+${z.errors.length-1} more)`:z.errors[0]})})]},z.id)})})]})})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:M,disabled:a,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),d&&d.foundUsers?.length>0&&f.length>0&&s.jsx(Nt,{permission:De.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsx(ae,{variant:"primary",onClick:A,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import Selected (",f.length," matched trainees)"]})})})]})]})},hoe=({show:e,onClose:t,onConfirm:r,loading:a=!1})=>{const[n,i]=v.useState(""),[l,o]=v.useState("");v.useEffect(()=>{e&&(i(""),o(""))},[e]);const c=f=>!f||f.trim()===""?"Batch code is required":f.length<3?"Batch code must be at least 3 characters long":f.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(f)?"Batch code can only contain letters, numbers, and underscores":null,u=f=>{const h=f.target.value;i(h),l&&o("")},d=()=>{const f=c(n);if(f){o(f);return}r(n.trim())},m=f=>{f.key==="Enter"&&(f.preventDefault(),d())};return s.jsxs(se,{show:e,onHide:t,centered:!0,backdrop:"static",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsxs(se.Title,{children:[s.jsx(Gt,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),s.jsxs(se.Body,{children:[s.jsx(_,{children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{children:["Batch Code ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:u,onKeyPress:m,isInvalid:!!l,disabled:a,autoFocus:!0}),s.jsx(_.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),l&&s.jsx(_.Control.Feedback,{type:"invalid",children:l})]})}),s.jsx(Ue,{variant:"info",className:"mb-0",children:s.jsxs("small",{children:[s.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:t,disabled:a,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:d,disabled:a||!n.trim(),children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},poe=()=>{const e=ft(),{courseId:t}=Or(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,j]=v.useState(!1),[w,y]=v.useState(!1),[b,S]=v.useState({}),[E,N]=v.useState([]),[T,k]=v.useState(!1);v.useEffect(()=>{t&&(async()=>{try{i(!0);const ee=await kr.getCourseById(t);if(a(ee),ee.subjects&&Array.isArray(ee.subjects)){const U=ee.subjects.filter(oe=>oe?.status?.toUpperCase()!=="ARCHIVED"&&!oe?.deletedAt);o(U);const X={};U.forEach(oe=>{X[oe.id]={name:oe.name,code:oe.code}}),S(X)}}catch(ee){console.error("Error loading course data:",ee),te.error("Failed to load course data",{autoClose:3e3,position:"top-right"})}finally{i(!1)}})()},[t]),v.useEffect(()=>{},[]),v.useEffect(()=>{t&&(async()=>{try{k(!0);const ee=await su.getTraineesForEnrollment();N(ee.data?.trainees||[])}catch(ee){console.error("Error fetching trainees:",ee),te.error("Failed to load available trainees"),N([])}finally{k(!1)}})()},[t]);const I=z=>{u(z)};if(n)return s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!r)return s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."}),s.jsxs(ae,{variant:"primary",onClick:()=>e("/academic/departments"),children:[s.jsx(Bt,{className:"me-2"}),"Back to Departments"]})]})});const D=()=>{e(-1)},A=()=>{h(!0)},M=async z=>{if(!g){j(!0);try{const ee=z.map(U=>({id:U.id,eid:U.eid,name:`${U.lastName}${U.middleName?" "+U.middleName:""} ${U.firstName}`.trim(),firstName:U.firstName,lastName:U.lastName,email:U.email,phoneNumber:U.phoneNumber,status:U.status,subjects:[]}));m(U=>{const X=new Set(U.map(Ee=>Ee.id)),oe=ee.filter(Ee=>!X.has(Ee.id));return oe.length===0&&ee.length>0?setTimeout(()=>{te.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):oe.length<ee.length&&oe.length>0?setTimeout(()=>{te.warning(`Added ${oe.length} new trainees. ${ee.length-oe.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100):oe.length===ee.length&&oe.length>0&&setTimeout(()=>{te.success(`Successfully added ${oe.length} trainee${oe.length>1?"s":""} to the selection!`,{autoClose:3e3,position:"top-right",toastId:"bulk-import-success",closeButton:!1})},100),[...U,...oe]}),await new Promise(U=>setTimeout(U,1e3))}catch(ee){throw ee}finally{j(!1)}}},G=()=>{if(c.length===0||d.length===0){te.warning("Please select both subjects and trainees to enroll");return}p(!0)},q=async z=>{y(!0),p(!1);try{const ee=d.map(J=>{if(!J.id)throw new Error(`Trainee ${J.eid} (${J.firstName} ${J.lastName}) is missing UUID`);return J.id}),U={batchCode:String(z).trim(),traineeUserIds:ee,subjectIds:c},X=await gs.assignTraineesToMultipleSubjects(U);console.log("Full response:",X);const oe=X?.data||{},Ee=oe.summaryMessage||X?.message||"Enrollment completed",F=oe.enrolledCount||0,P=oe.duplicateCount||0,C=oe.invalidCount||0,W=oe.totalRequested||0;console.log("Enrollment summary:",{enrolledCount:F,duplicateCount:P,invalidCount:C,totalRequested:W,summaryMessage:Ee});let Z=Ee;F===0&&(Z=`No trainees were enrolled. ${P+C}/${W} trainees failed as they have already been enrolled into this course.`),F>0?te.success(Z,{autoClose:5e3,position:"top-right"}):(P>0||C>0)&&F===0?te.warning(Z,{autoClose:5e3,position:"top-right"}):te.info(Z,{autoClose:5e3,position:"top-right"}),F>0&&(m([]),u([]),setTimeout(()=>{e(Pe.ACADEMIC_COURSE_DETAIL(t),{state:{activeTab:"trainees"},replace:!0})},1500))}catch(ee){console.error("Catch block error:",ee),console.error("Error response:",ee.response?.data);const U=ee.response?.data?.data?.errorMessages||ee.response?.data?.errorMessages||[],X=ee.response?.data?.message||ee.message||"Failed to enroll trainees";te.error(X,{autoClose:5e3,position:"top-right"}),U&&U.length>0&&U.forEach((oe,Ee)=>{setTimeout(()=>{te.error(oe,{autoClose:5e3,position:"top-right"})},(Ee+1)*100)})}finally{y(!1)}};return s.jsxs(Be,{fluid:!0,className:"py-4 px-4 enroll-page",style:{minHeight:"100%",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{className:"mb-4 flex-shrink-0",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:D,className:"me-3",children:[s.jsx(Bt,{size:16,className:"me-1"}),"Back"]}),s.jsx("div",{children:s.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",s.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),s.jsx(Y,{className:"mb-4",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:s.jsx(Y.Body,{className:"py-4 px-4",children:s.jsxs(ue,{children:[s.jsx(H,{md:8,children:s.jsx("p",{className:"mb-0 text-muted",children:r.description})}),s.jsxs(H,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[s.jsx(Nt,{permission:De.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsx(ae,{size:"sm",variant:"primary",onClick:G,disabled:c.length===0||d.length===0||w,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:w?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(yr,{size:12,className:"me-1"})," Enroll"]})})}),s.jsx(Nt,{permission:De.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsxs(ae,{size:"sm",variant:"outline-primary",onClick:A,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(js,{size:12,className:"me-1"})," Bulk Import Trainees"]})}),"                "]})]})})})]}),s.jsx("div",{className:"mb-4 flex-shrink-0 main-content-section",style:{position:"relative",zIndex:1,marginBottom:"3rem"},children:s.jsxs(ue,{className:"g-4",children:[s.jsx(H,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible",marginBottom:"2rem"},children:s.jsx(uoe,{selectedSubjects:c,onSelectionChange:I,subjects:l})})}),s.jsx(H,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"hidden",marginBottom:"2rem"},children:s.jsx(moe,{selectedTrainees:d,onSelectionChange:m,subjects:l,availableTrainees:E,loadingTrainees:T})})})]})}),s.jsx(foe,{show:f,onClose:()=>h(!1),onImport:M,loading:g}),s.jsx(hoe,{show:x,onClose:()=>p(!1),onConfirm:q,loading:w})]})},xoe=({assessmentEvents:e=[],loading:t=!1,onView:r,onUpdate:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=ts(e);if(t)return s.jsx(Fr,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment events found"}),s.jsx("p",{children:"There are no assessment events available."})]})});const o=({columnKey:d,children:m,className:f=""})=>{const h=i.key===d,x=h?i.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:x,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},c=d=>{switch(String(d||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"primary";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"ON_GOING":return"success";default:return"secondary"}},u=d=>{if(!d)return"-";try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return s.jsx("div",{className:"scrollable-table-container",children:s.jsx("div",{className:"scrollable-table-container",children:s.jsxs(dr,{hover:!0,bordered:!0,className:"mb-0",style:{borderColor:"white","--bs-table-border-color":"white"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"name",children:"Name"}),s.jsx(o,{columnKey:"course",children:"Course"}),s.jsx(o,{columnKey:"subject",children:"Subject"}),s.jsx(o,{columnKey:"occurrenceDate",children:"Occurrence Date"}),s.jsx(o,{columnKey:"status",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center sticky-header",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"white"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((d,m)=>s.jsxs("tr",{style:{transition:"all 0.2s ease",borderColor:"white"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:f=>{f.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",style:{borderColor:"white"},children:s.jsx("span",{className:"fw-medium",children:d.name||"-"})}),s.jsx("td",{className:"align-middle",style:{borderColor:"white"},children:s.jsx("span",{children:d.course||"-"})}),s.jsx("td",{className:"align-middle",style:{borderColor:"white"},children:s.jsx("span",{children:d.subject||"-"})}),s.jsx("td",{className:"align-middle",style:{borderColor:"white"},children:s.jsx("span",{children:u(d.occurrenceDate)})}),s.jsx("td",{className:"align-middle",style:{borderColor:"white"},children:s.jsx(Ae,{bg:c(d.status),className:"px-3 py-2",children:d.status?.replace(/_/g," ")||"-"})}),s.jsx("td",{className:"align-middle text-center",style:{borderColor:"white"},children:s.jsx(Nt,{permissions:[De.VIEW_ASSESSMENT_DETAILS,De.UPDATE_ASSESSMENT_EVENT],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r&&r(d.originalEvent||d),permission:De.VIEW_ASSESSMENT_DETAILS},...d.status==="NOT_STARTED"?[{label:"Update",icon:s.jsx(Ar,{}),onClick:()=>a&&a(d.originalEvent||d),permission:De.UPDATE_ASSESSMENT_EVENT}]:[]]})})})]},d.id||m))})]})})})},goe=({show:e,onClose:t,onSave:r,event:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",occuranceDate:""}),[o,c]=v.useState({}),[u,d]=v.useState(!1),m=g=>{if(!g)return"";if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g))return g;try{const j=new Date(g);return isNaN(j.getTime())?"":j.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?l({name:a.name||"",occuranceDate:m(a.occuranceDate||a.occurrenceDate)}):e||(l({name:"",occuranceDate:""}),c({}))},[e,a]);const f=()=>{c({}),d(!1),t()},h=g=>{const{name:j,value:w}=g.target;l(y=>({...y,[j]:w})),o[j]&&c(y=>({...y,[j]:""}))},x=()=>{const g={};if((!i.name||i.name.trim()==="")&&(g.name="Event name is required"),!i.occuranceDate)g.occuranceDate="Occurrence date is required";else{const j=new Date(i.occuranceDate),w=new Date;w.setHours(0,0,0,0),j<w&&(g.occuranceDate="Occurrence date cannot be in the past")}return c(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!x()){if(!a){te.error("Event data is missing");return}d(!0);try{const j=a.occuranceDate||a.occurrenceDate,y={occuranceDate:m(j),templateId:a.templateInfo?.id||""};a.subjectId===null&&a.courseId?y.courseId=a.courseId:a.subjectId&&(y.subjectId=a.subjectId);const b={name:i.name,occuranceDate:i.occuranceDate};console.log("Update Assessment Event - Request:",{params:y,body:b}),await vr.updateAssessmentEvent(y,b),te.success("Assessment event updated successfully"),r&&r(),f()}catch(j){console.error("Error updating assessment event:",j);const w=j.response?.data?.message||j.message||"Failed to update assessment event";te.error(w)}finally{d(!1)}}};return a?s.jsxs(se,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(se.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(Ar,{className:"me-2",size:20}),"Update Assessment Event"]}),s.jsx(ae,{variant:"link",onClick:f,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},disabled:u,children:s.jsx(ht,{size:24,color:"#ffffff"})})]}),s.jsxs(_,{onSubmit:p,children:[s.jsxs(se.Body,{className:"p-4",children:[s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",name:"name",value:i.name,onChange:h,isInvalid:!!o.name,placeholder:"Enter event name",disabled:u||n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.name})]})})}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"date",name:"occuranceDate",value:i.occuranceDate,onChange:h,isInvalid:!!o.occuranceDate,disabled:u||n}),s.jsx(_.Control.Feedback,{type:"invalid",children:o.occuranceDate})]})})}),s.jsxs(ue,{className:"mt-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:a.subjectId===null&&a.courseId?"Course":"Subject"}),s.jsx("strong",{children:a.entityInfo?.name||"-"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Template"}),s.jsx("strong",{children:a.templateInfo?.name||"-"})]})})]})]}),s.jsxs(se.Footer,{className:"border-top",children:[s.jsx(ae,{variant:"secondary",onClick:f,disabled:u||n,children:"Cancel"}),s.jsx(ae,{variant:"primary",type:"submit",disabled:u||n,className:"d-flex align-items-center",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Update Event"]})})]})]})]}):null},voe=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),[a,n]=v.useState({}),[i,l]=v.useState(!1),[o,c]=v.useState([]),[u,d]=v.useState([]),[m,f]=v.useState([]),[h,x]=v.useState([]),[p,g]=v.useState([]),[j,w]=v.useState(!1),[y,b]=v.useState(null),[S,E]=v.useState(!1),[N,T]=v.useState(!0),[k,I]=v.useState(!1),[D,A]=v.useState(!0),[M,G]=v.useState(!0),[q,z]=v.useState(!1),[ee,U]=v.useState(!1),[X,oe]=v.useState(null);v.useEffect(()=>{(async()=>{try{T(!0);const je=(await Ht.getDepartments()).filter(xe=>xe.isActive===!0);c(je)}catch(de){console.error("Error loading departments:",de),te.error("Failed to load departments"),c([])}finally{T(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){d([]),r(de=>({...de,templateId:""}));return}try{I(!0);const de=await Dt.getTemplatesByDepartment(t.departmentId),je=de?.data?.templates||de?.templates||de?.data||de||[];d(je),r(xe=>({...xe,templateId:""}))}catch(de){console.error("Error loading templates:",de),te.error("Failed to load templates"),d([])}finally{I(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),x([]),A(!1),G(!1),r(de=>({...de,courseId:"",subjectId:"",excludeTraineeIds:[]}));return}try{A(!0),G(!0);const de=await Ht.getDepartmentById(t.departmentId);let je=[];de?.courses&&Array.isArray(de.courses)?je=de.courses:de?.data?.courses&&Array.isArray(de.data.courses)&&(je=de.data.courses);const xe=je.filter(ge=>ge.status==="PLANNED"||ge.status==="ON_GOING"||ge.status==="COMPLETED");f(xe);let me=[];xe.forEach(ge=>{ge.subjects&&Array.isArray(ge.subjects)&&(me=me.concat(ge.subjects))}),de?.subjects&&Array.isArray(de.subjects)?me=me.concat(de.subjects):de?.data?.subjects&&Array.isArray(de.data.subjects)&&(me=me.concat(de.data.subjects));const Xe=me.filter((ge,qe,st)=>qe===st.findIndex(Te=>Te.id===ge.id)).filter(ge=>ge.status==="PLANNED"||ge.status==="ON_GOING"||ge.status==="COMPLETED");x(Xe)}catch(de){console.error("Error loading courses and subjects:",de),te.error("Failed to load courses and subjects"),f([]),x([])}finally{A(!1),G(!1)}})()},[t.departmentId]),v.useEffect(()=>{const ye=setTimeout(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(je=>({...je,excludeTraineeIds:[]}));return}try{z(!0);let je=[];if(t.courseId&&!t.subjectId){const xe=await kr.getCourseTrainees(t.courseId);je=xe?.trainees||xe?.data?.trainees||[]}else if(t.subjectId){const xe=await gs.getSubjectById(t.subjectId),me=[];xe?.enrollmentsByBatch&&xe.enrollmentsByBatch.forEach($e=>{$e.trainees&&Array.isArray($e.trainees)&&$e.trainees.forEach(Xe=>{me.push({id:Xe.id,eid:Xe.eid,firstName:Xe.firstName,lastName:Xe.lastName,email:Xe.email})})}),je=me}g(je)}catch(je){console.error("Error loading trainees:",je),te.error("Failed to load trainees"),g([])}finally{z(!1)}})()},300);return()=>clearTimeout(ye)},[t.courseId,t.subjectId]);const Ee=ye=>{const de=ye.firstName||"",je=ye.lastName||"",xe=ye.middleName||"";return`${je}${xe?" "+xe:""} ${de}`.trim()||ye.eid||"Unknown"},F=v.useMemo(()=>t.courseId?h.filter(ye=>ye.courseId===t.courseId):[],[h,t.courseId]),P=v.useMemo(()=>F.map(ye=>({value:ye.id,label:`${ye.name} (${ye.code})`})),[F]),C=ne.memo(({trainee:ye,isExcluded:de,onToggle:je})=>s.jsx("div",{className:`border rounded cursor-pointer ${de?"bg-primary":"bg-light"}`,onClick:()=>je(ye.id),style:{padding:"0.5rem",cursor:"pointer",transition:"all 0.2s ease",backgroundColor:de?"var(--bs-primary)":"var(--bs-light)",color:de?"#ffffff":"var(--bs-dark)",minHeight:"48px",display:"flex",alignItems:"center",userSelect:"none"},onMouseEnter:xe=>{de||(xe.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:xe=>{de||(xe.currentTarget.style.backgroundColor="var(--bs-light)")},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between w-100 gap-2",style:{flexWrap:"wrap"},children:[s.jsxs("div",{style:{flex:"1 1 auto",minWidth:"0px"},children:[s.jsx("strong",{style:{color:de?"#ffffff":"inherit",wordBreak:"break-word",fontSize:"0.95rem"},children:Ee(ye)}),ye.eid&&s.jsx(Ae,{bg:de?"light":"secondary",style:{marginLeft:"0.5rem",color:de?"var(--bs-primary)":"#ffffff",fontSize:"0.7rem",padding:"0.35rem 0.6rem"},children:ye.eid})]}),de&&s.jsx(Ae,{bg:"light",style:{color:"var(--bs-primary)",fontSize:"0.7rem",whiteSpace:"nowrap",flex:"0 0 auto",padding:"0.35rem 0.6rem"},children:"Excluded"})]})},ye.id)),W=ye=>{const{name:de,value:je}=ye.target;r(de==="courseId"?xe=>({...xe,courseId:je,excludeTraineeIds:[]}):de==="subjectId"?xe=>({...xe,subjectId:je,excludeTraineeIds:[]}):xe=>({...xe,[de]:je})),a[de]&&n(xe=>({...xe,[de]:""}))},Z=ye=>{r(de=>{const je=de.excludeTraineeIds||[],xe=je.includes(ye)?je.filter(me=>me!==ye):[...je,ye];return{...de,excludeTraineeIds:xe}}),a.excludeTraineeIds&&n(de=>({...de,excludeTraineeIds:""}))},J=ye=>{r(de=>({...de,templateId:ye}))},le=async ye=>{if(!ye||!ye.id){te.error("Template not found");return}try{E(!0),w(!0);const de=await Dt.getTemplatePDF(ye.id),je=URL.createObjectURL(de);b(je)}catch(de){console.error("Error loading PDF:",de),te.error("Failed to load PDF preview"),w(!1)}finally{E(!1)}},V=()=>{w(!1),y&&(URL.revokeObjectURL(y),b(null))},re=()=>{const ye={};if(t.departmentId||(ye.departmentId="Department is required"),t.templateId||(ye.templateId="Template is required"),t.courseId||(ye.courseSubject="Course is required"),!t.occuranceDate)ye.occuranceDate="Occurrence date is required";else{const de=new Date(t.occuranceDate);if(t.subjectId){const je=h.find(xe=>xe.id===t.subjectId);if(je){const xe=new Date(je.startDate);de<xe&&(ye.occuranceDate=`Occurrence date must be on or after subject start date (${xe.toLocaleDateString()})`)}}else if(t.courseId){const je=m.find(xe=>xe.id===t.courseId);if(je){const xe=new Date(je.startDate);de<xe&&(ye.occuranceDate=`Occurrence date must be on or after course start date (${xe.toLocaleDateString()})`)}}}return(!t.name||t.name.trim()==="")&&(ye.name="Event name is required"),n(ye),Object.keys(ye).length===0},he=async ye=>{if(ye.preventDefault(),!re())return;const de={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,excludeTraineeIds:t.excludeTraineeIds||[]};t.subjectId?de.subjectId=t.subjectId:t.courseId&&(de.courseId=t.courseId);const je=p.length-(t.excludeTraineeIds?.length||0);let xe="";t.subjectId?xe=h.find($e=>$e.id===t.subjectId)?.name||"Subject":t.courseId&&(xe=m.find($e=>$e.id===t.courseId)?.name||"Course"),oe({requestData:de,numTraineesToCreate:je,entityName:xe}),U(!0)},O=async()=>{if(X){l(!0),U(!1);try{const de=(await vr.createBulkAssessmentEvent(X.requestData))?.message||"Bulk assessment event created successfully";te.success(de),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),oe(null),e&&e()}catch(ye){console.error("Error creating bulk assessment event:",ye);const de=ye.response?.data?.message||ye.message||"Failed to create bulk assessment event";te.error(de)}finally{l(!1)}}};return s.jsxs(_,{onSubmit:he,className:"create-assessment-event-form",children:[s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(pd,{name:"departmentId",value:t.departmentId,onChange:W,isInvalid:!!a.departmentId,disabled:i||N,placeholder:"Select a department",options:o.map(ye=>({value:ye.id,label:ye.name}))}),s.jsx(_.Control.Feedback,{type:"invalid",children:a.departmentId})]})})}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Template ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(pd,{name:"templateId",value:t.templateId,onChange:ye=>J(ye.target.value),isInvalid:!!a.templateId,disabled:i||k||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:u.map(ye=>({value:ye.id,label:ye.name}))}),t.templateId&&s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>{const ye=u.find(de=>de.id===t.templateId);ye&&le(ye)},disabled:i,className:"d-flex align-items-center",children:[s.jsx(tr,{size:16,className:"me-1"}),"Preview"]})]}),s.jsx(_.Control.Feedback,{type:"invalid",children:a.templateId}),!t.departmentId&&s.jsx(_.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3 course-select-group",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Course ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(pd,{name:"courseId",value:t.courseId,onChange:W,isInvalid:!!a.courseSubject,disabled:i||D,placeholder:"Select a course",options:m.map(ye=>({value:ye.id,label:`${ye.name} (${ye.code})`}))}),s.jsx(_.Control.Feedback,{type:"invalid",children:a.courseSubject})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3 subject-select-group",children:[s.jsx(_.Label,{className:"fw-semibold",children:"Subject (Optional)"}),s.jsx(pd,{name:"subjectId",value:t.subjectId,onChange:W,disabled:i||M||!t.courseId,placeholder:t.courseId?"Select a subject (optional)":"Select a course first",options:P}),!t.courseId&&s.jsx(_.Text,{className:"text-muted",children:"Please select a course first to load subjects."})]})})]}),a.courseSubject&&s.jsx(Ue,{variant:"danger",className:"mb-3",children:a.courseSubject}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",name:"name",value:t.name,onChange:W,isInvalid:!!a.name,placeholder:"Enter event name",disabled:i}),s.jsx(_.Control.Feedback,{type:"invalid",children:a.name})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:W,isInvalid:!!a.occuranceDate,disabled:i}),s.jsx(_.Control.Feedback,{type:"invalid",children:a.occuranceDate})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{className:"fw-semibold",children:"Exclude Trainees (Optional)"}),!t.courseId&&!t.subjectId?s.jsx(Ue,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):q?s.jsxs("div",{className:"text-center py-3",children:[s.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):p.length===0?s.jsxs(Ue,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):s.jsx("div",{style:{maxHeight:"clamp(200px, 40vh, 400px)",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",border:"1px solid #dee2e6",borderRadius:"0.375rem",backgroundColor:"#fff"},children:s.jsx("div",{style:{padding:"0.75rem"},children:s.jsx("div",{className:"d-flex flex-column gap-2",children:p.map(ye=>s.jsx(C,{trainee:ye,isExcluded:t.excludeTraineeIds?.includes(ye.id),onToggle:Z},ye.id))})})}),t.excludeTraineeIds&&t.excludeTraineeIds.length>0&&s.jsxs(_.Text,{className:"text-muted",children:[t.excludeTraineeIds.length," trainee(s) excluded"]})]})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[s.jsx(ae,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),d([])},disabled:i,children:"Reset"}),s.jsx(ae,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]}),s.jsxs(se,{show:ee,onHide:()=>{U(!1),oe(null)},centered:!0,size:"lg",children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary text-white",style:{borderBottom:"none"},children:s.jsx(se.Title,{className:"fw-bold",children:"Confirm Bulk Assessment Event Creation"})}),s.jsx(se.Body,{style:{padding:"2rem"},children:s.jsxs("div",{style:{lineHeight:"1.8"},children:[s.jsxs("p",{style:{fontSize:"1rem",color:"var(--bs-dark)",marginBottom:"1.5rem"},children:["Assessment Forms will be generated for"," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-primary)"},children:X?.numTraineesToCreate||0})," ","Trainees of"," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-secondary)"},children:t.subjectId?"Subject":"Course"})," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-primary)"},children:X?.entityName||"N/A"}),"."]}),s.jsxs("div",{style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral)",borderRadius:"0.375rem",padding:"1rem",marginBottom:"1.5rem"},children:[s.jsx("p",{style:{marginBottom:"0.5rem",fontSize:"0.9rem",color:"var(--bs-dark)"},children:s.jsx("strong",{children:"Summary:"})}),s.jsxs("ul",{style:{marginBottom:"0",paddingLeft:"1.5rem",color:"var(--bs-dark)",fontSize:"0.95rem"},children:[s.jsxs("li",{children:["Type: ",s.jsx("strong",{children:t.subjectId?"Subject":"Course"})]}),s.jsxs("li",{children:["Name: ",s.jsx("strong",{children:X?.entityName||"N/A"})]}),s.jsxs("li",{children:["Total Trainees: ",s.jsx("strong",{children:p.length})]}),s.jsxs("li",{children:["Excluded Trainees: ",s.jsx("strong",{children:t.excludeTraineeIds?.length||0})]}),s.jsxs("li",{children:["Trainees to Include: ",s.jsx("strong",{style:{color:"var(--bs-primary)"},children:X?.numTraineesToCreate||0})]})]})]}),s.jsx("p",{style:{fontSize:"0.95rem",color:"var(--bs-dark)",marginBottom:"0"},children:"Please review the information above before confirming."})]})}),s.jsxs(se.Footer,{style:{borderTop:"1px solid var(--bs-neutral)",padding:"1.5rem"},children:[s.jsx(ae,{variant:"light",onClick:()=>{U(!1),oe(null)},disabled:i,style:{color:"var(--bs-dark)",borderColor:"var(--bs-neutral)",transition:"all 0.2s ease"},children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:O,disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Confirm & Create"]})})]})]}),s.jsxs(se,{show:j,onHide:V,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary text-white border-0",children:s.jsx(se.Title,{className:"text-white",children:"Template Preview"})}),s.jsx(se.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:S?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):y?s.jsx("iframe",{src:`${y}#toolbar=0`,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},P2=()=>{const[e,t]=xi(),r=e.get("tab"),[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,c]=v.useState(!1),[u,d]=v.useState(!1),[m,f]=v.useState(null),[h,x]=v.useState(r||"list"),p=async()=>{try{l(!0);const k=((await vr.getAssessmentEvents())?.data?.events||[]).map((I,D)=>{let A="",M="";return I.subjectId===null?I.entityInfo&&I.entityInfo.type==="course"&&(M=I.entityInfo.name||"",A=""):I.entityInfo&&I.entityInfo.type==="subject"&&(A=I.entityInfo.name||"",M=I.entityInfo.belongToCourseName||""),{id:I.id||`event-${D}`,name:I.name||"N/A",subject:A,course:M,occurrenceDate:I.occuranceDate||I.occurrenceDate,status:I.status||"N/A",createdAt:I.createdAt,originalEvent:I}});k.sort((I,D)=>{const A=new Date(I.createdAt||0);return new Date(D.createdAt||0)-A}),n(k)}catch(N){console.error("Error loading assessment events:",N),n([])}finally{l(!1)}};v.useEffect(()=>{p()},[]),v.useEffect(()=>{const N=e.get("tab");N&&["list","create-bulk"].includes(N)&&x(N)},[e]);const g=N=>{x(N),t(N==="list"?{}:{tab:N})},j=N=>{const T=N.originalEvent||N;f(T),c(!0)},w=()=>{c(!1),f(null)},y=N=>{const T=N.originalEvent||N;f(T),d(!0)},b=()=>{d(!1),f(null)},S=()=>{p()},E=()=>{p(),x("list"),t({})};return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Y,{className:"shadow-sm",children:s.jsx(Tt.Container,{activeKey:h,onSelect:g,children:s.jsxs(Y.Body,{className:"p-0",style:{overflow:"visible",minHeight:"800px"},children:[s.jsx(Y.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"list",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:h==="list"?"600":"400",opacity:h==="list"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(rS,{className:"me-2",size:16}),"Assessment Events"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"create-bulk",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:h==="create-bulk"?"600":"400",opacity:h==="create-bulk"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(eg,{className:"me-2",size:16}),"Create Assessment Events"]})})]})}),s.jsxs(Tt.Content,{children:[s.jsx(Tt.Pane,{eventKey:"list",className:"p-4",children:s.jsx(xoe,{assessmentEvents:a,loading:i,onView:j,onUpdate:y})}),s.jsx(Tt.Pane,{eventKey:"create-bulk",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:s.jsx(voe,{onSuccess:E})})]})]})})})})}),s.jsx(Xy,{show:o,onClose:w,event:m}),s.jsx(goe,{show:u,onClose:b,onSave:S,event:m,loading:i})]})},yoe=({traineeId:e})=>{const t=ft(),[r,a]=v.useState(null),[n,i]=v.useState([]),[l,o]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!0),[f,h]=v.useState("");v.useEffect(()=>{e&&x()},[e]);const x=async()=>{try{m(!0),h("");const E=await su.getTraineeById(e);a(E);const N=await su.getTraineeAssessments(e);i(N.assessments||N.data||[]);const T=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],k=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];o(T),u(k)}catch(E){console.error("Error loading assessment data:",E),h("Failed to load assessment data"),te.error("Failed to load assessment data")}finally{m(!1)}},p=()=>{t(Pe.ASSESSMENTS_MY_ASSESSMENTS)},g=E=>{const T={PENDING:{variant:"warning",text:"Pending",icon:rt},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Zt},COMPLETED:{variant:"success",text:"Completed",icon:it},OVERDUE:{variant:"danger",text:"Overdue",icon:Gt}}[E]||{variant:"secondary",text:E,icon:Zt},k=T.icon;return s.jsxs(Ae,{bg:T.variant,className:"d-flex align-items-center",children:[s.jsx(k,{size:12,className:"me-1"}),T.text]})},j=E=>{const T={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[E]||{variant:"secondary",text:E};return s.jsx(Ae,{bg:T.variant,children:T.text})},w=E=>{t(`/trainee/${e}/assessment/${E}`)},y=E=>{t(`/trainee/${e}/assessment/${E}`)},b=E=>{t(`/trainee/${e}/signature-pad/${E}`)},S=E=>{t(`/trainee/${e}/assessment-section/${E}`)};return d?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):f||!r?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:f||"Trainee not found"}),s.jsxs(ae,{variant:"outline-danger",onClick:p,children:[s.jsx(Bt,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ae,{variant:"outline-secondary",onClick:p,className:"me-3",children:s.jsx(Bt,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Zt,{className:"me-2",size:28}),"Assessment Management"]}),s.jsxs("p",{className:"text-muted mb-0",children:[r.lastName,r.middleName?" "+r.middleName:""," ",r.firstName,"  ",r.eid]})]})]})})})}),s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsx(Y.Body,{className:"p-0",children:s.jsxs(U2,{defaultActiveKey:"pending",className:"border-bottom",children:[s.jsx(Tt,{eventKey:"pending",title:"Pending Assessments",children:s.jsx("div",{className:"p-4",children:n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Zt,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Assessment"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Priority"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:n.map(E=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.name}),s.jsx("small",{className:"text-muted",children:E.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:E.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:E.subject?.code||""})]}),s.jsx("td",{children:s.jsx(Ae,{bg:"info",className:"fw-normal",children:E.type||"Assessment"})}),s.jsx("td",{children:j(E.priority)}),s.jsx("td",{children:E.dueDate?new Date(E.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsx("div",{className:"d-flex gap-1",children:E.status==="PENDING"||E.status==="IN_PROGRESS"?s.jsx(ae,{variant:"primary",size:"sm",onClick:()=>w(E.id),children:"Start"}):s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>y(E.id),children:"View"})})})]},E.id))})]})})})}),s.jsx(Tt,{eventKey:"signature",title:"Signature Required",children:s.jsx("div",{className:"p-4",children:l.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ci,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Document"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:l.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.subject})}),s.jsx("td",{children:new Date(E.dueDate).toLocaleDateString()}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsxs(ae,{variant:"primary",size:"sm",onClick:()=>b(E.id),children:[s.jsx(ci,{className:"me-1",size:14}),"Sign"]})})]},E.id))})]})})})}),s.jsx(Tt,{eventKey:"completion",title:"Section Completion",children:s.jsx("div",{className:"p-4",children:c.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(it,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Section"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Progress"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:c.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.subject})}),s.jsx("td",{children:s.jsx(Ae,{bg:"info",className:"fw-normal",children:E.section})}),s.jsx("td",{children:new Date(E.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${E.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[E.progress,"%"]})]})}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsx(ae,{variant:"primary",size:"sm",onClick:()=>S(E.id),children:E.status==="COMPLETED"?"View":"Complete"})})]},E.id))})]})})})})]})})})})})]})},boe=()=>{const{traineeId:e}=Or();return s.jsx(Be,{className:"py-3",children:s.jsx(yoe,{traineeId:e})})},joe=()=>{const{traineeId:e,assessmentId:t}=Or(),r=ft(),[a,n]=xi(),[i,l]=v.useState(null),[o,c]=v.useState(!0),[u,d]=v.useState("");v.useEffect(()=>{t&&m()},[t]),v.useEffect(()=>{if(i&&a.get("action")==="start"){n({});const b=i.sections?.find(S=>S.status!=="COMPLETED");b&&r(Pe.TRAINEE_ASSESSMENT_SECTION(b.id))}},[i,a,r,e,n]);const m=async()=>{try{c(!0),d(""),l({id:t,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(b){console.error("Error loading assessment details:",b),d("Failed to load assessment details"),te.error("Failed to load assessment details")}finally{c(!1)}},f=()=>{r(-1)},h=()=>{const b=i.sections.find(S=>S.status!=="COMPLETED");b?r(`/trainee/${e}/assessment-section/${b.id}`):te.info("Starting assessment...")},x=()=>{const b=i.sections.find(S=>S.status==="IN_PROGRESS");b?r(`/trainee/${e}/assessment-section/${b.id}`):h()},p=b=>{r(`/trainee/${e}/assessment-section/${b}`)},g=()=>{r(Pe.TRAINEE_SIGNATURE_PAD(t))},j=()=>{r(Pe.REPORTS_CREATE,{state:{assessmentId:t,assessmentName:i.name}})},w=b=>{const E={PENDING:{variant:"warning",text:"Pending",icon:rt},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Zt},COMPLETED:{variant:"success",text:"Completed",icon:it},OVERDUE:{variant:"danger",text:"Overdue",icon:Gt}}[b]||{variant:"secondary",text:b,icon:Zt},N=E.icon;return s.jsxs(Ae,{bg:E.variant,className:"d-flex align-items-center",children:[s.jsx(N,{size:12,className:"me-1"}),E.text]})},y=b=>{const E={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[b]||{variant:"secondary",text:b};return s.jsx(Ae,{bg:E.variant,children:E.text})};return o?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):u||!i?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:u||"Assessment not found"}),s.jsxs(ae,{variant:"outline-danger",onClick:f,children:[s.jsx(Bt,{className:"me-2",size:16}),"Back"]})]})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ae,{variant:"outline-secondary",onClick:f,className:"me-3",children:s.jsx(Bt,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Zt,{className:"me-2",size:28}),i.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[w(i.status),y(i.priority)]})]})})}),s.jsxs(ue,{children:[s.jsx(H,{lg:8,className:"mb-4",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm",children:s.jsx(Y.Body,{className:"p-0",children:s.jsxs(U2,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[s.jsx(Tt,{eventKey:"overview",title:"Overview",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Description"}),s.jsx("p",{className:"text-muted",children:i.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:i.instructions.map((b,S)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),b]},S))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Sections"}),s.jsx("div",{className:"row",children:i.sections.map((b,S)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx(Y,{className:`${b.status==="COMPLETED"?"bg-light":""}`,children:s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1]}),w(b.status)]}),s.jsx("h6",{className:"mb-2",children:b.name}),s.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${b.progress}%`}})}),s.jsx(ae,{variant:b.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>p(b.id),children:b.status==="COMPLETED"?"View":b.status==="IN_PROGRESS"?"Continue":"Start"})]})})},b.id))})]}),s.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?s.jsxs(ae,{variant:"primary",size:"lg",onClick:h,children:[s.jsx(Zt,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?s.jsxs(ae,{variant:"primary",size:"lg",onClick:x,children:[s.jsx(Zt,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&s.jsxs(ae,{variant:"outline-primary",size:"lg",onClick:g,children:[s.jsx(ci,{className:"me-2",size:20}),"Sign Document"]})]})]})}),s.jsx(Tt,{eventKey:"progress",title:"Progress",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Overall Progress"}),s.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:s.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),s.jsxs("small",{className:"text-muted",children:[i.sections.filter(b=>b.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),s.jsx("h5",{children:"Section Progress"}),i.sections.map((b,S)=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1,": ",b.name]}),s.jsxs("span",{className:"text-muted",children:[b.progress,"%"]})]}),s.jsx("div",{className:"progress",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${b.progress}%`}})})]},b.id))]})}),i.status==="COMPLETED"&&s.jsx(Tt,{eventKey:"results",title:"Results",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Score"}),i.score!==null?s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),s.jsx("div",{children:s.jsxs(Ae,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):s.jsx("p",{className:"text-muted",children:"Score pending review"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Section Results"}),i.sections?.map((b,S)=>s.jsx(Y,{className:"mb-2",children:s.jsx(Y.Body,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1,": ",b.name]}),s.jsx(Ae,{bg:"success",className:"ms-2",children:"Completed"})]}),b.score!==void 0&&s.jsxs("div",{className:"text-end",children:[s.jsxs("div",{className:"fw-bold",children:[b.score," / ",b.maxScore||100]}),s.jsxs("small",{className:"text-muted",children:[Math.round(b.score/(b.maxScore||100)*100),"%"]})]})]})})},b.id))]})]})})]})})})}),s.jsx(H,{lg:4,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(gt,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Course"}),s.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Subject"}),s.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(it,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Score"}),s.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Completed Date"}),s.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&s.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Signature Required"}),s.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:g,children:[s.jsx(ci,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&s.jsx(Ae,{bg:"success",children:"Signed"})]}),s.jsx("div",{className:"mt-4",children:s.jsxs(ae,{variant:"outline-secondary",className:"w-100",onClick:j,children:[s.jsx(Gt,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},Jm=({onSignatureChange:e,width:t=250,height:r=150})=>{const a=v.useRef(null),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(null);v.useEffect(()=>{const p=a.current;if(!p)return;const g=p.getContext("2d"),j=window.devicePixelRatio||1;p.width=t*j,p.height=r*j,p.style.width=`${t}px`,p.style.height=`${r}px`,g.scale(j,j),g.strokeStyle="#000000",g.lineWidth=2,g.lineCap="round",g.lineJoin="round",g.fillStyle="#ffffff",g.fillRect(0,0,t,r)},[t,r]);const d=p=>{const g=a.current;if(!g)return null;const j=g.getBoundingClientRect();let w,y;p.touches&&p.touches.length>0?(w=p.touches[0].clientX,y=p.touches[0].clientY):(w=p.clientX,y=p.clientY);const b=w-j.left,S=y-j.top;return{x:b,y:S}},m=p=>{p.preventDefault();const g=d(p);if(!g)return;const w=a.current.getContext("2d");i(!0),u(g),w.beginPath(),w.moveTo(g.x,g.y)},f=p=>{if(!n)return;p.preventDefault();const g=d(p);if(!g)return;const j=a.current,w=j.getContext("2d");if(c&&(w.beginPath(),w.moveTo(c.x,c.y),w.lineTo(g.x,g.y),w.stroke()),u(g),o(!0),e){const y=j.toDataURL("image/png");e(y)}},h=p=>{p.preventDefault(),i(!1),u(null)},x=()=>{const p=a.current;if(!p)return;const g=p.getContext("2d"),j=window.devicePixelRatio||1;g.fillStyle="#ffffff",g.fillRect(0,0,p.width/j,p.height/j),o(!1),e&&e(null)};return s.jsxs("div",{className:"signature-pad-container",children:[s.jsx("div",{className:"border rounded p-2 bg-white",style:{display:"inline-block",touchAction:"none"},children:s.jsx("canvas",{ref:a,className:"signature-canvas",style:{cursor:"crosshair",display:"block",touchAction:"none",userSelect:"none"},onMouseDown:m,onMouseMove:f,onMouseUp:h,onMouseLeave:h,onTouchStart:m,onTouchMove:f,onTouchEnd:h,onTouchCancel:h})}),s.jsx("div",{className:"mt-2 d-flex justify-content-between align-items-center",children:s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:x,children:[s.jsx(H2,{className:"me-1",size:14}),"Clear"]})})]})},woe=()=>{const{traineeId:e,documentId:t}=Or(),r=ft(),[a,n]=v.useState(null),[i,l]=v.useState(!1),o=d=>{n(d)},c=async()=>{if(!a){te.error("Please provide your signature");return}try{l(!0),console.log("Signature saved:",{documentId:t,traineeId:e,signature:a,timestamp:new Date().toISOString()}),te.success("Signature saved successfully"),r(Pe.ASSESSMENTS_DETAIL(t),{replace:!0})}catch(d){console.error("Error saving signature:",d),te.error("Failed to save signature")}finally{l(!1)}},u=()=>{r(`/trainee/${e}/assessment/${t}`,{replace:!0})};return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx("div",{className:"mb-4",children:s.jsxs(ae,{variant:"outline-secondary",onClick:u,className:"mb-3",children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back"]})}),s.jsxs(Y,{children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0",children:"Digital Signature"})}),s.jsxs(Y.Body,{className:"p-4",children:[s.jsx(Ue,{variant:"info",className:"mb-4",children:s.jsx("p",{className:"mb-0",children:"Please sign in the box below using your mouse or touch device"})}),s.jsx("div",{className:"mb-4",children:s.jsx(Jm,{onSignatureChange:o,width:250,height:150})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:u,disabled:i,children:[s.jsx(ht,{className:"me-2",size:16}),"Cancel"]}),s.jsx(ae,{variant:"primary",onClick:c,disabled:i||!a,children:i?"Saving...":"Save Signature"})]})]})]})]})},Noe=({traineeId:e,sectionId:t})=>{const r=ft(),[a,n]=v.useState(null),[i,l]=v.useState(!0),[o,c]=v.useState("");v.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{l(!0),c(""),n({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(x){console.error("Error loading section details:",x),c("Failed to load assessment section details"),te.error("Failed to load assessment section details")}finally{l(!1)}},d=()=>{r(Pe.ASSESSMENTS_MY_ASSESSMENTS)},m=x=>{const g={PENDING:{variant:"warning",text:"Pending",icon:rt},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Zt},COMPLETED:{variant:"success",text:"Completed",icon:it},OVERDUE:{variant:"danger",text:"Overdue",icon:Gt}}[x]||{variant:"secondary",text:x,icon:Zt},j=g.icon;return s.jsxs(Ae,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(j,{size:12,className:"me-1"}),g.text]})},f=()=>{te.info("Starting assessment section...")},h=()=>{te.info("Continuing assessment section...")};return i?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):o||!a?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:o||"Assessment section not found"}),s.jsxs(ae,{variant:"outline-danger",onClick:d,children:[s.jsx(Bt,{className:"me-2",size:16}),"Back to Assessments"]})]})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ae,{variant:"outline-secondary",onClick:d,className:"me-3",children:s.jsx(Bt,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Zt,{className:"me-2",size:28}),a.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[a.course,"  ",a.subject]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(a.status),s.jsx(Ae,{bg:"info",className:"fw-normal",children:a.type})]})]})})}),s.jsxs(ue,{children:[s.jsx(H,{lg:8,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Zt,{className:"me-2",size:20}),"Assessment Section Details"]})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:a.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:a.instructions.map((x,p)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),x]},p))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Questions Overview"}),s.jsx("div",{className:"row",children:a.questions.map((x,p)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs("div",{className:`p-3 border rounded ${x.isAnswered||x.isCompleted?"bg-light":""}`,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Question ",p+1]}),x.isAnswered||x.isCompleted?s.jsx(Ae,{bg:"success",className:"small",children:"Completed"}):s.jsx(Ae,{bg:"warning",className:"small",children:"Pending"})]}),s.jsx("p",{className:"mb-0 small text-muted",children:x.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},x.id))})]}),s.jsx("div",{className:"d-flex justify-content-center",children:a.status==="PENDING"?s.jsxs(ae,{variant:"primary",size:"lg",onClick:f,children:[s.jsx(Qx,{className:"me-2",size:20}),"Start Assessment"]}):s.jsxs(ae,{variant:"primary",size:"lg",onClick:h,children:[s.jsx(Zt,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),s.jsx(H,{lg:4,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(rt,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[a.timeLimit," minutes"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:new Date(a.dueDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Zt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Total Questions"}),s.jsx("div",{className:"text-muted",children:a.questions.length})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),s.jsx(Qd,{now:a.progress,variant:"primary",className:"mb-3"}),s.jsx("div",{className:"text-center",children:s.jsxs("small",{className:"text-muted",children:[a.questions.filter(x=>x.isAnswered||x.isCompleted).length," of ",a.questions.length," questions completed"]})})]}),s.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Read questions carefully"}),s.jsx("li",{children:"Manage your time wisely"}),s.jsx("li",{children:"Save progress regularly"}),s.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},Soe=()=>{const{traineeId:e,sectionId:t}=Or();return s.jsx(Be,{className:"py-3",children:s.jsx(Noe,{traineeId:e,sectionId:t})})},Eoe=()=>{const e=ft(),[t,r]=v.useState(!1),[a,n]=v.useState({assessmentProgress:null,ongoingTraining:null,assessmentRatios:null});v.useEffect(()=>{(async()=>{r(!0);try{const m=await R5.getTraineeOverview();n({assessmentProgress:m.assessmentProgress||null,ongoingTraining:m.ongoingTraining||null,assessmentRatios:m.assessmentRatios||null})}catch(m){console.error("Error fetching trainee dashboard data:",m),te.error(m.response?.data?.message||"Failed to load dashboard data")}finally{r(!1)}})()},[]);const i=[{title:"Your Courses",description:"Check your enrolled courses and progress",icon:$t,path:Pe.COURSES_ENROLLED,color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:Zt,path:Pe.ASSESSMENTS_MY_ASSESSMENTS,color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Gt,path:Pe.REPORTS_CREATE,color:"danger"}],l=a.assessmentProgress?Math.round(a.assessmentProgress.completionRate*100):0,o=a.ongoingTraining?[{name:"Courses",value:a.ongoingTraining.ongoingCourses},{name:"Subjects",value:a.ongoingTraining.ongoingSubjects}]:[],c=a.assessmentRatios?[{name:"Pass",value:a.assessmentRatios.passCount,ratio:a.assessmentRatios.passRatio},{name:"Fail",value:a.assessmentRatios.failCount,ratio:a.assessmentRatios.failRatio}]:[],u=["#28a745","#dc3545"];return s.jsxs(Be,{fluid:!0,className:"py-3 py-md-4 px-3 px-md-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(Y.Body,{children:s.jsx(ue,{className:"align-items-stretch",children:i.map((d,m)=>{const f=d.icon;return s.jsx(H,{xs:12,sm:6,lg:4,xl:4,className:"mb-3 mb-xl-0 d-flex",children:s.jsx(Y,{className:"h-100 w-100 border-0 shadow-sm d-flex flex-column",style:{cursor:"pointer",transition:"all 0.3s ease",minHeight:"150px"},onClick:()=>e(d.path),onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-5px)",h.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 p-md-4 d-flex flex-column h-100",children:[s.jsxs("div",{className:"d-flex align-items-start mb-2 mb-md-3",children:[s.jsx("div",{className:`bg-${d.color} text-white rounded-circle d-flex align-items-center justify-content-center me-2 me-md-3 flex-shrink-0`,style:{width:"40px",height:"40px"},children:s.jsx(f,{size:20})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",style:{fontSize:"0.95rem",lineHeight:"1.3"},children:d.title})}),s.jsx(vn,{size:18,className:"text-muted flex-shrink-0 d-none d-sm-block"})]}),s.jsx("p",{className:"text-muted mb-0 mt-auto",style:{fontSize:"0.8125rem",lineHeight:"1.4"},children:d.description})]})})},m)})})})]})})}),t?s.jsx(ue,{children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading dashboard data..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsx(ue,{className:"mt-3",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Overall Training Progress"})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"text-center mb-3",children:[s.jsxs("h2",{className:"text-primary mb-1",children:[l,"%"]}),s.jsx("p",{className:"text-muted mb-0",children:"Complete your assessment events to improve progress"})]}),s.jsx(Qd,{now:l,variant:"primary",style:{height:"12px"},className:"mb-3"}),s.jsx(ue,{className:"text-center",children:s.jsx(H,{children:s.jsx("small",{className:"text-muted",children:a.assessmentProgress&&s.jsxs("p",{className:"text-muted small mb-0",children:[a.assessmentProgress.approvedCount," of"," ",a.assessmentProgress.totalAssigned," ","assessments completed"]})})})})]})]})})}),s.jsxs(ue,{className:"mt-3",children:[s.jsx(H,{xs:12,md:6,lg:6,className:"mb-3 mb-md-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",style:{fontSize:"1rem"},children:[s.jsx(Ol,{className:"me-2",size:18}),"Ongoing Training"]})}),s.jsx(Y.Body,{style:{padding:"15px"},children:s.jsx(Il,{width:"100%",height:280,children:s.jsxs(Jd,{data:o,children:[s.jsx(Jo,{strokeDasharray:"3 3"}),s.jsx(Zo,{dataKey:"name"}),s.jsx(Qo,{allowDecimals:!1}),s.jsx(kl,{content:({active:d,payload:m})=>d&&m&&m.length?s.jsxs("div",{style:{backgroundColor:"#fff",padding:"10px 15px",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[s.jsx("p",{style:{margin:"0 0 5px 0",fontWeight:"bold"},children:m[0].payload.name}),s.jsxs("p",{style:{margin:"0",color:"#1b3c53"},children:["Count: ",m[0].value]})]}):null}),s.jsx(Pl,{dataKey:"value",fill:"#1b3c53"})]})})})]})}),s.jsx(H,{xs:12,md:6,lg:6,className:"mb-3 mb-md-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",style:{fontSize:"1rem"},children:[s.jsx(Zx,{className:"me-2",size:18}),"Assessment Results"]})}),s.jsx(Y.Body,{style:{padding:"15px"},children:s.jsx(Il,{width:"100%",height:280,children:s.jsxs(O5,{children:[s.jsx($y,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,ratio:m})=>`${d}: ${(m*100).toFixed(1)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",children:c.map((d,m)=>s.jsx(jo,{fill:u[m%u.length]},`cell-${m}`))}),s.jsx(kl,{}),s.jsx(ii,{verticalAlign:"bottom",wrapperStyle:{paddingTop:"20px"}})]})})})]})})]}),s.jsx(ue,{className:"mt-3",children:s.jsx(H,{xs:12,md:12,lg:12,className:"mb-3 mb-md-4",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",style:{fontSize:"1rem"},children:"Assessments Required Confirmations"})}),s.jsx(Y.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-3 py-md-4",children:[a.assessmentProgress&&a.assessmentProgress.totalAssigned>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-2 mb-md-3",children:[s.jsx("div",{className:"display-4 text-primary fw-bold",style:{fontSize:"clamp(2rem, 5vw, 3.5rem)"},children:a.assessmentProgress.approvedCount}),s.jsxs("p",{className:"text-muted mb-0",style:{fontSize:"0.875rem"},children:["of ",a.assessmentProgress.totalAssigned," ","assessments completed"]})]}),s.jsxs("p",{className:"text-muted small mb-3",children:[a.assessmentProgress.totalAssigned-a.assessmentProgress.approvedCount," ","assessments pending"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Zt,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No assessments pending"}),s.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."})]}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>e(Pe.ASSESSMENTS_MY_ASSESSMENTS),className:"d-flex align-items-center justify-content-center mx-auto",children:[s.jsx(Zt,{size:16,className:"me-2"}),"Go to Assessments",s.jsx(vn,{size:16,className:"ms-2"})]})]})})]})})})]})]})},Toe=()=>{const e=ft(),{user:t}=Rr(),[r,a]=v.useState(!0),[n,i]=v.useState(null);v.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const u={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(d=>setTimeout(d,500)),i(u)}catch(u){console.error("Error loading academic data:",u)}finally{a(!1)}},o=u=>{switch(u){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=u=>{switch(u){case"completed":return s.jsx(it,{className:"text-success"});case"in-progress":return s.jsx(rt,{className:"text-warning"});case"pending":return s.jsx(rt,{className:"text-muted"});default:return s.jsx(rt,{className:"text-muted"})}};return r?s.jsx(Be,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?s.jsxs(Be,{className:"py-4 academic-details",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ae,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:s.jsx(Bt,{size:16})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Academic Details"}),s.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(Y,{className:"border-0 shadow-sm h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx($t,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:n.totalCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(Y,{className:"border-0 shadow-sm h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(uS,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(Y,{className:"border-0 shadow-sm h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(rt,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),s.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(Y,{className:"border-0 shadow-sm h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(Zt,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedAssessments}),s.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),s.jsx(ue,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"text-center mb-3",children:[s.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),s.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),s.jsx(Qd,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),s.jsx(ue,{className:"text-center",children:s.jsx(H,{children:s.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),s.jsxs(ue,{className:"mt-4",children:[s.jsx(H,{lg:8,className:"mb-4 pe-3",children:s.jsxs(Y,{className:"border-0 shadow-sm h-100",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx($t,{className:"me-2"}),"Course Progress"]})}),s.jsx(Y.Body,{children:n.courses.map(u=>s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:u.name}),s.jsx("small",{className:"text-muted",children:u.code})]}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx(Ae,{variant:o(u.status),children:u.status.replace("-"," ")})})]}),s.jsx(Qd,{now:u.progress,variant:u.progress===100?"success":"primary",style:{height:"8px"}}),s.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[s.jsxs("small",{className:"text-muted",children:[u.progress,"% complete"]}),u.status==="completed"&&s.jsxs("small",{className:"text-success",children:["Completed: ",new Date(u.completedDate).toLocaleDateString()]})]})]},u.id))})]})}),s.jsx(H,{lg:4,className:"mb-4 ps-3",children:s.jsxs(Y,{className:"border-0 shadow-sm h-100",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Zt,{className:"me-2"}),"Recent Assessments"]})}),s.jsx(Y.Body,{children:n.recentAssessments.map(u=>s.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[s.jsx("h6",{className:"mb-1",children:u.name}),c(u.status)]}),s.jsx("small",{className:"text-muted d-block mb-1",children:u.course}),u.status==="completed"?s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs(Ae,{variant:"success",children:["Score: ",u.score]}),s.jsx("small",{className:"text-muted",children:new Date(u.completedDate).toLocaleDateString()})]}):s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx(Ae,{variant:"warning",children:"Pending"}),s.jsxs("small",{className:"text-muted",children:["Due: ",new Date(u.dueDate).toLocaleDateString()]})]})]},u.id))})]})})]})]}):s.jsx(Be,{className:"py-4",children:s.jsx(Ue,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},Coe=()=>{const{user:e}=Rr();return e?s.jsx(Be,{className:"py-3",children:s.jsx(Toe,{})}):s.jsx(Be,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your academic details."})})})},O2=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:a,onLevelToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0;return s.jsxs(Ct,{className:`filter-panel-dropdown course-filter-dropdown ${o}`,children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ll,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(Ct.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>s.jsx(_.Check,{type:"checkbox",id:`level-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>s.jsx(_.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:a.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]})]})]})},$5=document.createElement("style");$5.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild($5);const Aoe=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
    margin: 0 20px 0 20px !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
  .course-list-table-no-borders .table th {
    background-color: var(--bs-primary) !important;
    color: white !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Aoe,document.head.appendChild(e)}const _oe=({traineeId:e})=>{const t=ft(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState("upcoming"),x=[...new Set(r.map(G=>G.level).filter(Boolean))],p=[...new Set(r.map(G=>G.status).filter(Boolean))],g=G=>r.filter(q=>{switch(G){case"upcoming":return q.status==="PLANNED"||q.status==="PLAN";case"ongoing":return q.status==="ON-GOING"||q.status==="ONGOING"||q.status==="ON_GOING";case"completed":return q.status==="COMPLETED"||q.status==="COMPLETE";default:return!0}}),j=g(f),w=v.useMemo(()=>j.filter(G=>{const q=!l||G.name.toLowerCase().includes(l.toLowerCase())||G.code.toLowerCase().includes(l.toLowerCase())||G.description.toLowerCase().includes(l.toLowerCase()),z=c.length===0||c.includes(G.level),ee=d.length===0||d.includes(G.status);return q&&z&&ee}),[j,l,c,d]),{sortedData:y,sortConfig:b,handleSort:S}=ts(w);v.useEffect(()=>{e&&E()},[e]);const E=async()=>{try{i(!0);const q=(await gs.getTraineeCourseSubjects(e))?.courses||[];if(!Array.isArray(q)||q.length===0){a([]),i(!1);return}const z=q.map(ee=>{const U=ee.course,X=ee.subjects||[];if(!U||!U.id)return null;const oe=X.length,Ee=X.filter(le=>le.status==="COMPLETED"||le.status==="COMPLETE").length,F=oe>0?Math.round(Ee/oe*100):0;let P=U.status||"PLANNED";const C=X.some(le=>le.status==="ON-GOING"||le.status==="ONGOING"||le.status==="ON_GOING");X.every(le=>le.status==="COMPLETED"||le.status==="COMPLETE")&&oe>0?P="COMPLETED":C&&(P="ON-GOING");let Z=null,J=null;return X.forEach(le=>{if(le.startDate){const V=new Date(le.startDate);(!Z||V<new Date(Z))&&(Z=le.startDate)}if(le.endDate){const V=new Date(le.endDate);(!J||V>new Date(J))&&(J=le.endDate)}}),{id:U.id,code:U.code||`COURSE-${U.id.substring(0,8).toUpperCase()}`,name:U.name||"Unnamed Course",description:U.description||"",level:U.level||"BEGINNER",status:P,startDate:Z,endDate:J,progress:F,department:null}}).filter(ee=>ee!==null);a(z)}catch(G){console.error("Error loading trainee courses:",G),te.error(G.response?.data?.message||"Failed to load enrolled courses"),a([])}finally{i(!1)}},N=G=>{const z={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[G]||{variant:"secondary",text:G};return s.jsx(Ae,{bg:z.variant,children:z.text})},T=G=>{const z={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[G]||{variant:"secondary",text:G};return s.jsx(Ae,{bg:z.variant,children:z.text})},k=G=>{t(`/trainee/${e}/course/${G.id}`)},I=G=>{u(G==="clear"?[]:q=>q.includes(G)?q.filter(z=>z!==G):[...q,G])},D=G=>{m(G==="clear"?[]:q=>q.includes(G)?q.filter(z=>z!==G):[...q,G])},A=()=>{u([]),m([]),o("")},M=({columnKey:G,children:q,className:z=""})=>{const ee=b.key===G,U=ee?b.direction:null;return s.jsxs("th",{className:`fw-semibold ${z}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(G),onMouseEnter:X=>{X.target.style.backgroundColor="#214760",X.target.style.transform="translateY(-1px)",X.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:X=>{X.target.style.backgroundColor="var(--bs-primary)",X.target.style.transform="translateY(0)",X.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:ee?"600":"500",color:"white"},children:q}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:U,size:14,color:"white"})})]}),ee&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return n?s.jsx(Fr,{rows:5,columns:8}):r.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled courses"}),s.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):w.length===0&&(l||c.length>0||d.length>0)?s.jsx("div",{children:s.jsx(Y,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Tt.Container,{activeKey:f,onSelect:h,children:[s.jsx(Y.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(rt,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(pp,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(it,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx(Tt.Content,{children:s.jsxs(Tt.Pane,{eventKey:f,children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(O2,{uniqueLevels:x,uniqueStatuses:p,selectedLevels:c,selectedStatuses:d,onLevelToggle:I,onStatusToggle:D,onClearFilters:A,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or filters."}),s.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:A,children:"Clear Filters"})]})})]})})})]})})}):s.jsx("div",{children:s.jsx(Y,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Tt.Container,{activeKey:f,onSelect:h,children:[s.jsx(Y.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(rt,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(pp,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(it,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx(Tt.Content,{children:s.jsxs(Tt.Pane,{eventKey:f,children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(O2,{uniqueLevels:x,uniqueStatuses:p,selectedLevels:c,selectedStatuses:d,onLevelToggle:I,onStatusToggle:D,onClearFilters:A,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),s.jsx("div",{className:"course-list-container",style:{},children:s.jsxs(dr,{hover:!0,className:"mb-0",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(M,{columnKey:"code",className:"show-mobile",children:"Course Code"}),s.jsx(M,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(M,{columnKey:"level",className:"show-mobile",children:"Level"}),s.jsx(M,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(M,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),s.jsx(M,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"text-center py-5",style:{border:"none"},children:s.jsxs("div",{className:"text-muted",children:[s.jsx($t,{size:48,className:"mb-3",style:{opacity:.5}}),s.jsx("h5",{className:"mb-2",children:"No courses found"}),s.jsx("p",{className:"mb-0",children:l||c.length>0||d.length>0?"Try adjusting your search criteria or filters.":f==="upcoming"?"You have no upcoming courses.":f==="ongoing"?"You have no on-going courses.":"You have no completed courses."}),(l||c.length>0||d.length>0)&&s.jsx("button",{className:"btn btn-outline-primary btn-sm mt-3",onClick:A,children:"Clear Filters"})]})})}):y.map((G,q)=>s.jsxs("tr",{className:`${q%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:z=>{z.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:z=>{z.currentTarget.style.backgroundColor=q%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ae,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:G.code})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:G.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:T(G.level)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:N(G.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:G.startDate?new Date(G.startDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:G.endDate?new Date(G.endDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Course Details",icon:s.jsx(tr,{}),onClick:()=>k(G)}]})})]},G.id))})]})})]})})})]})})})},koe=()=>{const{user:e}=Rr();return e?s.jsxs(Be,{className:"py-3",children:[s.jsx("div",{className:"mb-4",children:s.jsx("h3",{className:"text-primary fw-bold",children:"Enrolled Courses"})}),s.jsx(_oe,{traineeId:e.id})]}):s.jsx(Be,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Ioe=()=>{const{hasPermission:e}=ln(),t=v.useMemo(()=>e(De.VIEW_ALL_TEMPLATE),[e]),r=v.useMemo(()=>e(De.APPROVE_DENY_TEMPLATE),[e]),a=v.useMemo(()=>t&&r,[t,r]),n=v.useMemo(()=>t&&!r,[t,r]);return{isSQAMode:a,isAdminMode:n,hasViewAll:t,hasApproveReject:r}};function Doe(e){const t=String(e||"").toUpperCase();return t==="SIGNATURE_IMAGE"?"SIGNATURE_IMG":(["TEXT","TOGGLE","PART","CHECK_BOX","SECTION_CONTROL_TOGGLE","SIGNATURE_DRAW","SIGNATURE_IMG","FINAL_SCORE_TEXT","FINAL_SCORE_NUM","VALUE_LIST"].includes(t),e)}function Ya(){try{const r=localStorage.getItem("templateInfo");if(r){const a=JSON.parse(r);return{id:a.id||null,currentTemplateId:a.currentTemplateId||null,originalTemplateId:a.originalTemplateId||null,name:a.name||"",description:a.description||"",departmentId:a.departmentId||"",templateContent:a.templateContent||"",templateConfig:a.templateConfig||null,templateContentMediaId:a.templateContentMediaId||null,editorDocumentUrl:a.editorDocumentUrl||""}}}catch{}const e=localStorage.getItem("currentTemplateId"),t=localStorage.getItem("originalTemplateId");return{id:null,currentTemplateId:e||null,originalTemplateId:t||null,name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||"",templateConfig:null,templateContentMediaId:null,editorDocumentUrl:""}}function R2(e,t,r=null){const a={};if(r&&Array.isArray(r)){console.log(` Existing fields count: ${r.length}`),r.forEach(l=>{const o=String(l.fieldType||"").toUpperCase();if((o==="PART"||o==="CHECK_BOX")&&l.id&&l.fieldName){const c=`${l.fieldName}-parent`;a[c]=l.id,console.log(` Mapped ${o} field: tempId="${c}"  id="${l.id}"`)}});const i=r.filter(l=>l.parentId);console.log(" Child fields with parentId:",i.map(l=>({fieldName:l.fieldName,fieldType:l.fieldType,parentId:l.parentId,id:l.id})))}const n=(t||[]).map((i,l)=>{const o=i.fields||[],c={};for(const x of o){const p=String(x.fieldType||"").toUpperCase();if(p==="PART"||p==="CHECK_BOX"){const g=x.fieldName||x.name||"",j=x.tempId||(g?`${g}-parent`:void 0);j&&(c[g]=j)}}const d=o.map(x=>{const p=x.parentTempId;return p&&c[p]?{...x,parentTempId:c[p]}:x}).map((x,p)=>({...x,__idx:p})),m=d.filter(x=>!x.parentTempId).sort((x,p)=>x.__idx-p.__idx),f=[];for(const x of m){f.push(x);const p=String(x.fieldType||"").toUpperCase(),g=p==="PART"||p==="CHECK_BOX"?x.tempId||c[x.fieldName||x.name||""]||(x.fieldName||x.name?`${x.fieldName||x.name}-parent`:void 0):null;if(g){const j=d.filter(w=>w.parentTempId===g).sort((w,y)=>w.__idx-y.__idx);f.push(...j)}}if(f.length!==d.length){const x=new Set(f.map(p=>p.__idx));d.filter(p=>!x.has(p.__idx)).sort((p,g)=>p.__idx-g.__idx).forEach(p=>f.push(p))}const h=f.map((x,p)=>{const g=String(x.fieldType||"").toUpperCase().startsWith("SIGNATURE"),j=String(x.fieldType||"").toUpperCase(),w=Doe(x.fieldType),y=x.fieldName||x.name||"";y||console.warn(" Field missing fieldName/name:",x);const b={label:x.label,fieldName:y,fieldType:w,displayOrder:p+1};if(r)if(b.parentTempId=x.parentTempId?x.parentTempId:null,x.parentTempId&&a[x.parentTempId]){let S=r.find(E=>E.fieldName===y&&E.fieldType===w&&E.id);S&&S.id?(b.id=S.id,console.log(` Added id="${b.id}" for child field "${y}" (parentTempId="${x.parentTempId}") (for update)`)):console.warn(` Could not find existing child field: fieldName="${y}", fieldType="${w}"`)}else{const S=r.find(E=>E.fieldName===y&&E.fieldType===w&&!E.parentId&&E.id);S&&S.id&&(b.id=S.id,console.log(` Added id="${b.id}" for top-level field "${y}" (for update)`))}else b.parentTempId=x.parentTempId?x.parentTempId:null;if(g&&(b.roleRequired=x.roleRequired||"TRAINER"),j==="PART"||j==="CHECK_BOX"){const S=y||"";if(b.tempId=x.tempId||(S?`${S}-parent`:void 0),r){const E=r.find(N=>(N.fieldType==="PART"||N.fieldType==="CHECK_BOX")&&(N.fieldName===y||N.fieldName===x.name)&&N.id);E&&E.id&&(b.id=E.id,console.log(` Added id="${b.id}" for ${j} field "${y}" (for update)`))}}if(j==="VALUE_LIST")if(console.log(" VALUE_LIST field found:",{fieldName:y,label:x.label,hasOption:!!x.option,option:x.option,optionType:typeof x.option}),x.option)try{const S=JSON.parse(x.option);S.items&&Array.isArray(S.items)?(b.options={items:S.items},console.log(" VALUE_LIST options parsed successfully:",b.options)):console.warn(" VALUE_LIST option missing items array:",S)}catch(S){console.warn(" Failed to parse VALUE_LIST option:",S,"Raw option:",x.option)}else console.warn(" VALUE_LIST field missing option field:",{fieldName:y,label:x.label,field:x});return b});return{label:i.label,displayOrder:l+1,editBy:i.editBy||"TRAINER",roleInSubject:i.roleInSubject?i.roleInSubject:null,isSubmittable:!!i.isSubmittable,isToggleDependent:!!i.isToggleDependent,fields:h}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:n}}function Zm(e){return Array.isArray(e)?e.map(t=>{const r=(t.fields||[]).filter(i=>i.fieldType==="PART"||i.fieldType==="CHECK_BOX"),a={};r.forEach(i=>{const l=`${i.fieldName}-parent`;a[i.id]=l});const n=(t.fields||[]).map(i=>{let l=i.fieldType||"TEXT";l==="SIGNATURE_IMG"&&(l="SIGNATURE_IMAGE");const o={label:i.label||"",fieldName:i.fieldName||"",fieldType:l,roleRequired:i.roleRequired||null,parentTempId:null,option:null};if(i.parentId){const u=t.fields.find(m=>m.id===i.parentId),d=String(u?.fieldType||"").toUpperCase();u&&(d==="PART"||d==="CHECK_BOX")&&(o.parentTempId=`${u.fieldName}-parent`)}const c=String(i.fieldType||"").toUpperCase();if((c==="PART"||c==="CHECK_BOX")&&(o.tempId=`${i.fieldName}-parent`),i.fieldType==="VALUE_LIST"&&i.options)try{o.option=JSON.stringify(i.options)}catch(u){console.warn("Failed to stringify VALUE_LIST options:",u)}return o});return{name:t.label||t.name||"",label:t.label||t.name||"",displayOrder:t.displayOrder||1,editBy:t.editBy||"TRAINER",roleInSubject:t.roleInSubject||"",isSubmittable:!!t.isSubmittable,isToggleDependent:!!t.isToggleDependent,fields:n}}):[]}function Poe(e){let t=[],r=[];if(e?.sections&&Array.isArray(e.sections)?r=e.sections:e?.fields&&Array.isArray(e.fields)?t=e.fields:Array.isArray(e)?t=e:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data?.sections&&Array.isArray(e.data.sections)&&(r=e.data.sections),r.length>0)return Zm(r);if(t.length>0){const a=t.map(u=>{let d=u.fieldType||"TEXT";d==="SIGNATURE_IMG"&&(d="SIGNATURE_IMAGE");const m={label:u.label||u.fieldName||"",fieldName:u.fieldName||u.name||"",fieldType:d,roleRequired:u.roleRequired||null,parentTempId:u.parentTempId||null,tempId:u.tempId||null,option:null};if((d==="PART"||d==="CHECK_BOX")&&(m.tempId=u.tempId||(m.fieldName?`${m.fieldName}-parent`:null)),d==="VALUE_LIST"&&u.options)try{m.option=JSON.stringify(u.options)}catch(f){console.warn("Failed to stringify VALUE_LIST options:",f)}return m}),n=a.filter(u=>u.fieldType==="PART"||u.fieldType==="CHECK_BOX"),i=a.filter(u=>u.parentTempId),l=a.filter(u=>!u.parentTempId&&u.fieldType!=="PART"&&u.fieldType!=="CHECK_BOX"),o=[];return n.forEach(u=>{o.push(u);const d=i.filter(m=>m.parentTempId===u.tempId);o.push(...d)}),o.push(...l),[{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:o.length>0?o:a}]}return[]}const Ooe=({show:e,onHide:t,onImportSuccess:r,onImportError:a})=>{const n=ft(),[i,l]=v.useState("with-fields"),[o,c]=v.useState(null),[u,d]=v.useState(!1),[m,f]=v.useState({name:"",description:"",departmentId:""}),[h,x]=v.useState([]),[p,g]=v.useState(!1),j=v.useRef(null);v.useEffect(()=>{e&&w()},[e]);const w=async()=>{try{g(!0);const N=(await Ht.getDepartments()).map(T=>({id:T.id,name:T.name}));x(N)}catch(E){console.error("Error loading departments:",E),te.error("Failed to load departments"),x([])}finally{g(!1)}},y=E=>{const N=E.target.files[0];if(N){const T=[".docx"],k=N.name.toLowerCase().substring(N.name.lastIndexOf("."));if(!T.includes(k)){te.error("Please select a valid Word document file (.docx)");return}if(N.size>10*1024*1024){te.error("File size must be less than 10MB");return}c(N)}},b=async()=>{if(!o){te.error("Please select a file to import");return}d(!0);try{const E=an.getDocsType(o.name),N=await an.uploadDocument(o,E);let T;if(N.data&&N.data.length>0&&N.data[0].url)T=N.data[0].url,console.log(` Form Template Upload Success! Document URL: ${T}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields"){console.log(" Extracting fields from file (File with Fields flow)...");try{const k=await Dt.extractFields(T);console.log(" Extract fields response:",k);const I=Poe(k);console.log(" Converted to frontend sections:",I),localStorage.removeItem("currentTemplateId"),localStorage.removeItem("originalTemplateId"),console.log(" Cleared currentTemplateId and originalTemplateId before creating new template");const D={id:null,name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:o.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:T,currentTemplateId:null,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(D)),console.log(" Template info saved to localStorage:",D),n(Pe.TEMPLATES_EDITOR,{state:{documentUrl:T,fileName:D.fileName,importType:"File with fields",templateInfo:D,initialSections:I}}),S(),r("File with fields",o.name)}catch(k){console.error(" Failed to extract fields:",k);const I=k?.response?.data?.message||k?.message||"Failed to extract fields from file. You can still add fields manually.";te.warning(I),localStorage.removeItem("currentTemplateId"),localStorage.removeItem("originalTemplateId"),console.log(" Cleared currentTemplateId and originalTemplateId before creating new template");const D={id:null,name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:o.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:T,currentTemplateId:null,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(D)),console.log(" Template info saved to localStorage (without extracted fields):",D),n("/templates/editor",{state:{documentUrl:T,fileName:D.fileName,importType:"File with fields",templateInfo:D,initialSections:[]}}),S(),r("File with fields",o.name)}}else{console.log(" Checking if file contains fields (File without Fields flow)...");try{const k=await Dt.extractFields(T);if(k?.fields&&Array.isArray(k.fields)&&k.fields.length>0||k?.totalFields&&k.totalFields>0){te.error('Your template already have field. Please use "File with Fields" import type instead.'),d(!1);return}console.log(" File does not contain fields, proceeding with import..."),localStorage.removeItem("currentTemplateId"),localStorage.removeItem("originalTemplateId"),console.log(" Cleared currentTemplateId and originalTemplateId before creating new template");const D={id:null,name:m.name,description:m.description,departmentId:m.departmentId,templateContent:T,fileName:o.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString(),currentTemplateId:null,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(D)),console.log(" Template info saved to localStorage:",D),n("/templates/editor",{state:{documentUrl:T,fileName:D.fileName,importType:"File without fields",templateInfo:D}}),S(),r("File without fields",o.name)}catch(k){console.error(" Failed to extract fields:",k);const I=k?.response?.data?.message||k?.message||"Failed to validate file. Please try again.";te.error(I),d(!1);return}}}catch(E){a(E.message||"Import failed")}finally{d(!1)}},S=()=>{c(null),l("with-fields"),f({name:"",description:"",departmentId:""}),j.current&&(j.current.value=""),t()};return s.jsxs(se,{show:e,onHide:S,size:"lg",centered:!0,className:"import-file-modal",dialogClassName:"import-file-modal-dialog",children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Import Form File"]})}),s.jsxs(se.Body,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),s.jsxs(ue,{className:"g-3 import-type-row",children:[s.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(Y,{className:`import-type-card ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("with-fields"),style:{cursor:"pointer"},children:s.jsx(Y.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(_c,{size:48,className:"text-primary mb-3"}),s.jsx("h6",{className:"text-primary mb-2",children:"Upload Pre-configured File"})]})})})}),s.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(Y,{className:`import-type-card ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("without-fields"),style:{cursor:"pointer"},children:s.jsx(Y.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(oi,{size:48,className:"text-success mb-3"}),s.jsx("h6",{className:"text-success mb-2",children:"Start From Blank"})]})})})})]})]}),!i&&s.jsxs(Ue,{variant:"info",className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),s.jsx("p",{className:"mb-0 small",children:'Choose between "Upload Pre-configured File" or "Start From Blank" above to continue with the import process.'})]}),(i==="without-fields"||i==="with-fields")&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:m.name,onChange:E=>f(N=>({...N,name:E.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:m.description,onChange:E=>f(N=>({...N,description:E.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(_.Select,{value:m.departmentId,onChange:E=>f(N=>({...N,departmentId:E.target.value})),required:!0,disabled:p,children:[s.jsx("option",{value:"",children:"Select Department"}),h.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]}),p&&s.jsx(_.Text,{className:"text-muted",children:"Loading departments..."}),m.templateContent&&s.jsxs(_.Text,{className:"text-muted",children:["Template Content: ",m.templateContent]})]})})]})})]}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),s.jsxs(_.Group,{children:[s.jsx(_.Control,{ref:j,type:"file",accept:".docx",onChange:y,className:"mb-2"}),s.jsx(_.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),o&&s.jsx(Ue,{variant:"info",className:"mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oi,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",o.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(o.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(se.Footer,{className:"border-0 p-3 p-md-3 d-flex flex-column flex-md-row gap-2 gap-md-2 justify-content-end",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:S,disabled:u,className:"w-100 w-md-auto order-2 order-md-1",children:[s.jsx(ht,{className:"me-2",size:14}),"Cancel"]}),i==="with-fields"&&s.jsx(ae,{variant:"primary-custom",size:"sm",onClick:b,disabled:!o||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),"Import File"]})}),i==="without-fields"&&s.jsx(ae,{variant:"primary-custom",size:"sm",onClick:b,disabled:!o||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),"Import File"]})})]})]})},U5=({show:e,onHide:t,template:r,onCreateVersion:a,onTemplateStatusChange:n})=>{const i=ft(),[l,o]=v.useState("details"),[c,u]=v.useState(null),[d,m]=v.useState(!1),[f,h]=v.useState(null),[x,p]=v.useState(!1),[g,j]=v.useState(null),[w,y]=v.useState(!1),[b,S]=v.useState(null),[E,N]=v.useState(!1),[T,k]=v.useState({}),[I,D]=v.useState(!1),[A,M]=v.useState(!1),[G,q]=v.useState([]),[z,ee]=v.useState(!1),[U,X]=v.useState(null),[oe,Ee]=v.useState(null),[F,P]=v.useState(!1),[C,W]=v.useState(null),[Z,J]=v.useState(!1),[le,V]=v.useState("pdf"),[re,he]=v.useState(null),[O,ye]=v.useState(null),[de,je]=v.useState(!1),[xe,me]=v.useState(!1);if(v.useEffect(()=>{(async()=>{if(r?.reviewedByUserId&&e)try{m(!0);const ke=await Ks.getUserById(r.reviewedByUserId),nt=ke.data||ke;u(nt)}catch(ke){console.error("Error fetching reviewed by user:",ke),u(null)}finally{m(!1)}else u(null)})()},[r?.reviewedByUserId,e]),v.useEffect(()=>{(async()=>{if(r?.id&&e&&!r.sections)try{p(!0);const ke=await Dt.getTemplateById(r.id),nt=ke.data||ke;h(nt)}catch(ke){console.error("Error fetching full template data:",ke),h(null)}finally{p(!1)}else r?.sections?h(r):h(null)})()},[r?.id,e,r?.sections]),v.useEffect(()=>((async()=>{if(r?.id&&e&&!g)try{y(!0);const ke=await Dt.getTemplatePDF(r.id),nt=URL.createObjectURL(ke);j(nt)}catch(ke){console.error("Error loading PDF:",ke),j(null)}finally{y(!1)}})(),()=>{e||j(ke=>(ke&&URL.revokeObjectURL(ke),null))}),[r?.id,e,g]),v.useEffect(()=>((async()=>{if(r?.id&&e&&!b)try{N(!0);const ke=await Dt.getTemplatePdfConfig(r.id),nt=URL.createObjectURL(ke);S(nt)}catch(ke){console.error("Error loading PDF config:",ke),S(null)}finally{N(!1)}})(),()=>{e||S(ke=>(ke&&URL.revokeObjectURL(ke),null))}),[r?.id,e,b]),v.useEffect(()=>{(async()=>{if(!r?.referFirstVersionId||!e){W(null),ye(null);return}try{J(!0);const ke=await Dt.getTemplateById(r.referFirstVersionId),nt=ke?.data?.templateForm||ke?.data||ke;W(nt)}catch(ke){console.error("Error loading original version:",ke),W(null)}finally{J(!1)}})()},[r?.referFirstVersionId,e]),v.useEffect(()=>((async()=>{if(l!=="history"||!r?.id||!e||!r.referFirstVersionId){l!=="history"&&(re&&(URL.revokeObjectURL(re),he(null)),O&&(URL.revokeObjectURL(O),ye(null)));return}re&&(URL.revokeObjectURL(re),he(null)),O&&(URL.revokeObjectURL(O),ye(null));try{je(!0),me(!0);try{const ke=le==="pdf"?await Dt.getTemplatePDF(r.id):await Dt.getTemplatePdfConfig(r.id),nt=URL.createObjectURL(ke);he(nt)}catch(ke){console.error("Error loading current version PDF:",ke),he(null)}finally{je(!1)}try{const ke=le==="pdf"?await Dt.getTemplatePDF(r.referFirstVersionId):await Dt.getTemplatePdfConfig(r.referFirstVersionId),nt=URL.createObjectURL(ke);ye(nt)}catch(ke){console.error("Error loading original version PDF:",ke),ye(null)}finally{me(!1)}}catch(ke){console.error("Error loading PDFs:",ke)}})(),()=>{e||(re&&URL.revokeObjectURL(re),O&&URL.revokeObjectURL(O))}),[l,r?.id,r?.referFirstVersionId,le,e]),v.useEffect(()=>{(async()=>{if(!r?.id||!e){q([]);return}try{ee(!0);const ke=await Dt.getMyTemplates();let nt=[];if(ke.success&&ke.data?nt=ke.data:Array.isArray(ke)?nt=ke:ke.data&&Array.isArray(ke.data)&&(nt=ke.data),!r.referFirstVersionId){q([]);return}const tt=r.referFirstVersionId,Ge=nt.filter(Ce=>Ce.referFirstVersionId===tt&&Ce.id!==tt);Ge.sort((Ce,He)=>{if(Ce.version&&He.version)return(He.version||0)-(Ce.version||0);const Mt=new Date(Ce.createdAt||Ce.updatedAt||0);return new Date(He.createdAt||He.updatedAt||0)-Mt}),q(Ge)}catch(ke){console.error("Error loading version history:",ke),q([])}finally{ee(!1)}})()},[r?.id,r?.referFirstVersionId,e]),!r)return null;const $e=Me=>{if(!Me)return"N/A";try{return new Date(Me).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return Me}},Xe=Me=>{const ke={PENDING:{variant:"warning",icon:rt,text:"PENDING"},PUBLISHED:{variant:"success",icon:it,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:gt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:gt,text:"ARCHIVED"},DENIED:{variant:"danger",icon:rt,text:"REJECTED"},REJECTED:{variant:"danger",icon:rt,text:"REJECTED"},DISABLED:{variant:"dark",icon:eu,text:"DISABLED"}},nt=ke[Me]||ke.DRAFT,tt=nt.icon;return s.jsxs(Ae,{bg:nt.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(tt,{size:12}),nt.text]})},ge=()=>{a?a(r):(console.log("Create new version for template:",r.id),t())},qe=()=>{const Me=f||r;i(Pe.TEMPLATES_EDITOR,{state:{isUpdateRejected:!0,templateId:Me.id,templateInfo:Me,fileName:Me.name||"Untitled Document",importType:"Update Rejected Template",documentUrl:Me.templateContent?.startsWith("http")?Me.templateContent:null,content:Me.templateContent?.startsWith("http")?null:Me.templateContent,initialSections:Me.sections||[]}}),t()},st=async()=>{try{D(!0),await Dt.disableTemplate(r.id),te.success("Template disabled successfully"),t(),n&&n()}catch(Me){console.error("Error disabling template:",Me),te.error(Me?.response?.data?.message||"Failed to disable template")}finally{D(!1)}},Te=async()=>{try{M(!0),await Dt.enableTemplate(r.id),te.success("Template enabled successfully"),t(),n&&n()}catch(Me){console.error("Error enabling template:",Me),te.error(Me?.response?.data?.message||"Failed to enable template")}finally{M(!1)}},Ke=r?.status==="REJECTED"||r?.status==="DENIED",ze=()=>s.jsx("div",{className:"template-details",style:{flex:1,display:"flex",flexDirection:"column"},children:s.jsxs("div",{className:"list-group list-group-flush",style:{flex:1},children:[s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Template Name"}),s.jsx("span",{className:"text-dark",children:r?.name||"N/A"})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ws,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Department"}),s.jsx("span",{className:"text-dark",children:r.department?.name||"N/A"}),r.department?.code&&s.jsx("small",{className:"text-muted d-block",children:r.department.code})]})]})}),r.description&&s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Description"}),s.jsx("span",{className:"text-dark",children:r.description})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(it,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Status"}),s.jsx("div",{children:Xe(r.status)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Version"}),s.jsxs("span",{className:"text-dark",children:["Version ",r.version]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Sections"}),s.jsxs("span",{className:"text-dark",children:[r._count?.sections||0," ",r._count?.sections===1?"section":"sections"]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdByUser?.lastName||"",r.createdByUser?.middleName?" "+r.createdByUser?.middleName:""," ",r.createdByUser?.firstName||""]}),s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(or,{className:"me-1",size:12}),$e(r.createdAt)]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Last Updated"}),s.jsx("span",{className:"text-dark",children:$e(r.updatedAt)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(it,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Reviewed By"}),r.reviewedByUserId?s.jsx(s.Fragment,{children:d?s.jsx("span",{className:"text-muted",children:"Loading..."}):c?s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-dark",children:[c.lastName||"",c.middleName?" "+c.middleName:""," ",c.firstName||""]}),r.reviewedAt&&s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(or,{className:"me-1",size:12}),$e(r.reviewedAt)]})]}):s.jsxs("span",{className:"text-muted",children:["User ID: ",r.reviewedByUserId]})}):s.jsx("span",{className:"text-muted",children:"Not reviewed"})]})]})})]})}),et=()=>{const ke=(f?.sections||r?.sections||[]).map((tt,Ge)=>{if(!tt.fields||!Array.isArray(tt.fields)||tt.fields.length===0)return{type:"section",id:tt.id||`section-${Ge}`,name:tt.label||tt.name,fieldCount:0,data:tt,fields:[],isSubmittable:!!tt.isSubmittable,isToggleDependent:!!tt.isToggleDependent};const Ce={},He={},Mt={};tt.fields.forEach(dt=>{dt.id&&(Ce[dt.id]=dt),dt.tempId&&(He[dt.tempId]=dt);const kt=dt.fieldName||dt.name;kt&&(Mt[kt]=dt)});const Ls=dt=>{if(dt.parentId){const kt=Ce[dt.parentId];if(kt)return kt}if(dt.parentTempId){const kt=He[dt.parentTempId];if(kt)return kt;const xr=dt.parentTempId.replace("-parent",""),Yr=Mt[xr];if(Yr&&(Yr.fieldType==="PART"||Yr.fieldType==="CHECK_BOX"))return Yr}return null},Ta=(dt,kt=new Set)=>{if(!dt.parentId&&!dt.parentTempId)return 1;const xr=dt.id||dt.fieldName||dt.tempId;if(xr&&kt.has(xr))return 1;xr&&kt.add(xr);const Yr=Ls(dt);return Yr?1+Ta(Yr,kt):1},ws=[],lr={};tt.fields.forEach(dt=>{const kt=Ls(dt);if(!kt)ws.push(dt);else{const xr=kt.id||kt.tempId||(kt.fieldName?`${kt.fieldName}-parent`:null);xr?(lr[xr]||(lr[xr]=[]),lr[xr].push(dt)):ws.push(dt)}});const qa=[],Nr=dt=>{dt.id||dt.fieldName;const kt=dt.id||dt.tempId||(dt.fieldName?`${dt.fieldName}-parent`:null);qa.push({...dt,_level:Ta(dt)}),kt&&lr[kt]&&lr[kt].length>0&&lr[kt].forEach(xr=>{Nr(xr)})};return ws.forEach(dt=>{Nr(dt)}),{type:"section",id:tt.id||`section-${Ge}`,name:tt.label||tt.name,fieldCount:tt.fields.length,data:tt,fields:qa.length>0?qa:tt.fields,isSubmittable:!!tt.isSubmittable,isToggleDependent:!!tt.isToggleDependent}}),nt=tt=>{k(Ge=>({...Ge,[tt]:!Ge[tt]}))};return s.jsxs(ue,{style:{height:"100%",margin:0,gap:0},children:[s.jsxs(H,{xs:12,lg:6,style:{display:"flex",flexDirection:"column",padding:"0 8px",height:"100%",minHeight:0},children:[s.jsx("h6",{className:"mb-2",style:{color:"#333",fontWeight:500,flexShrink:0},children:"Template Preview"}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,border:"1px solid #dee2e6",borderRadius:"4px",overflow:"hidden",backgroundColor:"#f8f9fa"},children:E?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(ot,{animation:"border",variant:"primary"})}):b?s.jsx("iframe",{src:`${b}#toolbar=0`,style:{flex:1,border:"none",width:"100%",minHeight:0},title:"Template PDF Preview"}):s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx("strong",{children:"No PDF Preview"}),s.jsx("p",{className:"mb-0 text-muted",children:"PDF preview not available"})]})})})]}),s.jsxs(H,{xs:12,lg:6,style:{display:"flex",flexDirection:"column",padding:"0 8px",height:"100%",minHeight:0},children:[s.jsx("h6",{className:"mb-2",style:{color:"#333",fontWeight:500,flexShrink:0},children:"Template fields & sections"}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,overflow:"hidden"},children:x?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(ot,{animation:"border",variant:"primary"})}):ke.length===0?s.jsx(Ue,{variant:"info",className:"mb-0",children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})}):s.jsx("div",{className:"list-group",style:{border:"1px solid #dee2e6",borderRadius:"4px",flex:1,overflowY:"auto",minHeight:0,maxHeight:"100%"},children:ke.map(tt=>{const Ge=T[tt.id];return s.jsxs("div",{children:[s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"#f8f9fa",cursor:"pointer",userSelect:"none",flexShrink:0,transition:"background-color 0.2s ease"},onMouseEnter:Ce=>Ce.currentTarget.style.backgroundColor="#e9ecef",onMouseLeave:Ce=>Ce.currentTarget.style.backgroundColor="#f8f9fa",onClick:()=>nt(tt.id),children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0,gap:"8px"},children:[s.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"transform 0.3s ease",transform:Ge?"rotate(-90deg)":"rotate(0deg)",flexShrink:0},children:s.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M6 5L11 10L6 15",stroke:"#666",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:600,wordBreak:"break-word",overflowWrap:"break-word"},children:tt.name}),tt.fieldCount>0&&s.jsx(Ae,{bg:"info",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000",flexShrink:0},children:tt.fieldCount})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",style:{flexWrap:"wrap",justifyContent:"flex-end",flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center gap-1",style:{flexWrap:"wrap"},children:[tt.isSubmittable&&s.jsx(Ae,{bg:"success",style:{fontSize:"10px",padding:"3px 8px",borderRadius:"4px",backgroundColor:"#28a745",color:"#fff",fontWeight:500,whiteSpace:"nowrap"},children:"Submittable"}),tt.isToggleDependent&&s.jsx(Ae,{bg:"info",style:{fontSize:"10px",padding:"3px 8px",borderRadius:"4px",backgroundColor:"#17a2b8",color:"#fff",fontWeight:500,whiteSpace:"nowrap"},children:"Toggle Dependent"})]}),s.jsx(Ae,{bg:"warning",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:"#ffc107",color:"#000",fontWeight:500},children:"SECTION"})]})]})}),!Ge&&tt.fields.map((Ce,He)=>{const Mt=Ce._level||1,Ta=(lr=>`${48+(lr-1)*32}px`)(Mt),ws=Mt>1;return s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",paddingLeft:Ta,backgroundColor:"white",flexShrink:0,animation:"slideDown 0.2s ease",transition:"background-color 0.2s ease"},onMouseEnter:lr=>lr.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:lr=>lr.currentTarget.style.backgroundColor="white",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:[ws&&s.jsx("span",{style:{color:"#6c757d",marginRight:"8px",fontSize:"12px",userSelect:"none",flexShrink:0},children:" "}),s.jsx("span",{style:{fontSize:"14px",color:"#555",fontWeight:400,wordBreak:"break-word",overflowWrap:"break-word"},children:Ce.label||Ce.fieldName}),(Ce.fieldName||Ce.name)&&s.jsx("span",{style:{fontSize:"12px",color:"#666",fontFamily:"Fira Mono, monospace",marginLeft:"8px",padding:"2px 6px",backgroundColor:"#f5f5f5",borderRadius:"3px",wordBreak:"break-word",overflowWrap:"break-word"},children:Ce.fieldName||Ce.name})]}),s.jsx(Ae,{bg:"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:"var(--bs-secondary)",color:"#fff",fontWeight:500,marginLeft:"12px",flexShrink:0},children:Ce.fieldType||Ce.type||"FIELD"})]})},Ce.id||Ce.fieldName||`field-${He}`)})]},tt.id)})})}),s.jsx("style",{children:`
            @keyframes slideDown {
              from {
                opacity: 0;
                transform: translateY(-5px);
              }
              to {
                opacity: 1;
                transform: translateY(0);
              }
            }
          `})]})]})},yt=()=>{if(!r?.referFirstVersionId)return s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsx(Ue,{variant:"info",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:s.jsxs("div",{children:[s.jsx("strong",{children:"No version history found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no previous versions to compare."})]})})});const ke=f||r;return s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[s.jsx(Y,{className:"mb-3",style:{flexShrink:0},children:s.jsx(Y.Body,{children:s.jsxs(ue,{children:[s.jsxs(H,{xs:12,md:6,className:"mb-3 mb-md-0",children:[s.jsx("h6",{className:"mb-2 text-primary-custom",children:"Current Version"}),s.jsx("div",{className:"mb-2",children:s.jsx("strong",{children:ke.name||"Template"})}),s.jsxs("div",{className:"d-flex flex-column gap-2 text-muted",style:{fontSize:"0.875rem"},children:[s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Version:"})," ",ke.version||"N/A"]}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Created:"})," ",$e(ke.createdAt)]}),ke.createdByUser&&s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Created By:"})," ",ke.createdByUser.firstName&&ke.createdByUser.lastName?`${ke.createdByUser.lastName}${ke.createdByUser.middleName?" "+ke.createdByUser.middleName:""} ${ke.createdByUser.firstName}`:ke.createdByUser.fullName||"N/A"]}),s.jsx("div",{children:Xe(ke.status)})]})]}),s.jsx(H,{xs:12,md:6,children:Z?s.jsxs("div",{className:"text-center py-3",children:[s.jsx(ot,{animation:"border",size:"sm",variant:"primary"}),s.jsx("p",{className:"text-muted mt-2 mb-0",style:{fontSize:"0.875rem"},children:"Loading original version..."})]}):C?s.jsxs(s.Fragment,{children:[s.jsx("h6",{className:"mb-2 text-primary-custom",children:"Original Version"}),s.jsx("div",{className:"mb-2",children:s.jsx("strong",{children:C.name||"Template"})}),s.jsxs("div",{className:"d-flex flex-column gap-2 text-muted",style:{fontSize:"0.875rem"},children:[s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Version:"})," ",C.version||"N/A"]}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Created:"})," ",$e(C.createdAt)]}),C.createdByUser&&s.jsxs("div",{children:[s.jsx("strong",{className:"text-dark",children:"Created By:"})," ",C.createdByUser.firstName&&C.createdByUser.lastName?`${C.createdByUser.lastName}${C.createdByUser.middleName?" "+C.createdByUser.middleName:""} ${C.createdByUser.firstName}`:C.createdByUser.fullName||"N/A"]}),s.jsx("div",{children:Xe(C.status)})]})]}):s.jsxs("div",{className:"text-muted",children:[s.jsx("h6",{className:"mb-2 text-muted",children:"Original Version"}),s.jsx("p",{className:"mb-0",style:{fontSize:"0.875rem"},children:"No original version found"})]})})]})})}),s.jsxs("div",{className:"mb-3 d-flex gap-2",style:{flexShrink:0},children:[s.jsxs(ae,{variant:le==="pdf"?"primary":"outline-primary",size:"sm",onClick:()=>{V("pdf"),re&&(URL.revokeObjectURL(re),he(null)),O&&(URL.revokeObjectURL(O),ye(null))},className:"d-flex align-items-center",children:[s.jsx(Zs,{className:"me-2",size:16}),"Assessment Instrument"]}),s.jsxs(ae,{variant:le==="pdf-config"?"primary":"outline-primary",size:"sm",onClick:()=>{V("pdf-config"),re&&(URL.revokeObjectURL(re),he(null)),O&&(URL.revokeObjectURL(O),ye(null))},className:"d-flex align-items-center",children:[s.jsx(gt,{className:"me-2",size:16}),"Template Config"]})]}),s.jsxs(ue,{className:"flex-grow-1",style:{minHeight:"450px",margin:0},children:[s.jsxs(H,{xs:12,md:6,className:"d-flex flex-column",style:{padding:"0 8px",minHeight:"450px"},children:[s.jsx("div",{className:"mb-2",children:s.jsxs("h6",{className:"mb-0",children:["Current Version (v",ke.version||"N/A",")"]})}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"450px",border:"1px solid #dee2e6",borderRadius:"0.375rem",overflow:"hidden",backgroundColor:"#f8f9fa"},children:de?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"450px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted mb-0",style:{fontSize:"0.875rem"},children:"Loading PDF..."})]})}):re?s.jsx("iframe",{src:`${re}#toolbar=0`,style:{width:"100%",height:"100%",border:"none",flex:1,minHeight:"450px"},title:"Current Version PDF"}):s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",minHeight:"450px"},children:s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx("strong",{children:"No PDF available"}),s.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.875rem"},children:"PDF preview is not available for this version."})]})})})]}),s.jsxs(H,{xs:12,md:6,className:"d-flex flex-column",style:{padding:"0 8px",minHeight:"450px"},children:[s.jsx("div",{className:"mb-2",children:s.jsxs("h6",{className:"mb-0",children:["Original Version ",C?`(v${C.version||"N/A"})`:""]})}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"450px",border:"1px solid #dee2e6",borderRadius:"0.375rem",overflow:"hidden",backgroundColor:"#f8f9fa"},children:Z||xe?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"450px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted mb-0",style:{fontSize:"0.875rem"},children:"Loading original version..."})]})}):O?s.jsx("iframe",{src:`${O}#toolbar=0`,style:{width:"100%",height:"100%",border:"none",flex:1,minHeight:"450px"},title:"Original Version PDF"}):s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",minHeight:"450px"},children:s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx("strong",{children:"No PDF available"}),s.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.875rem"},children:"PDF preview is not available for the original version."})]})})})]})]})]})},lt=()=>w?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):g?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minHeight:0},children:s.jsx("iframe",{src:`${g}#toolbar=0`,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block",flex:1,minHeight:0},title:"Template PDF Preview"})}):s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs(Ue,{variant:"warning",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:[s.jsx(Zs,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})});return s.jsxs(se,{show:e,onHide:t,size:"xl",centered:!0,className:"template-detail-modal",dialogClassName:"template-detail-modal-dialog",contentClassName:"template-detail-modal-content",children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0 template-detail-header d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsxs(se.Title,{className:"d-flex align-items-center text-white mb-0 template-detail-title flex-grow-1",style:{minWidth:0},children:[s.jsx(gt,{className:"me-2 flex-shrink-0",size:20}),s.jsxs("span",{className:"template-detail-title-text text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:`Template Detail: ${r?.name||"Template"}`,children:[s.jsx("span",{className:"d-none d-md-inline",children:"Template Detail: "}),r?.name||"Template"]})]})}),s.jsxs(se.Body,{className:"p-0 template-detail-body",style:{height:"75vh",maxHeight:"75vh",overflowY:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:[s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l==="details"?"border-bottom border-white border-3":""}`,onClick:()=>o("details"),style:{fontWeight:l==="details"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(gt,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Details"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l==="overview"?"border-bottom border-white border-3":""}`,onClick:()=>o("overview"),style:{fontWeight:l==="overview"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(tS,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Template Config Overview"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Overview"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l==="history"?"border-bottom border-white border-3":""}`,onClick:()=>o("history"),style:{fontWeight:l==="history"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(Y2,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-lg-inline",children:"List History Version"}),s.jsx("span",{className:"d-inline d-lg-none d-sm-inline",children:"History"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l==="content"?"border-bottom border-white border-3":""}`,onClick:()=>o("content"),style:{fontWeight:l==="content"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(tr,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Content Preview"})]})]})}),s.jsx("div",{className:"p-3 p-md-4 template-detail-content",style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,overflow:"auto",height:"100%"},children:s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:[l==="details"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:ze()}),l==="overview"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:et()}),l==="history"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:yt()}),l==="content"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:lt()})]})})]}),s.jsxs(se.Footer,{className:"bg-light border-0 template-detail-footer d-flex flex-wrap gap-2",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)",justifyContent:"flex-end"},children:[s.jsx(ae,{variant:"secondary",onClick:t,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:Me=>{Me.currentTarget.style.backgroundColor="#3a5a6f",Me.currentTarget.style.borderColor="#3a5a6f",Me.currentTarget.style.color="#ffffff"},onMouseLeave:Me=>{Me.currentTarget.style.backgroundColor="var(--bs-secondary)",Me.currentTarget.style.borderColor="var(--bs-secondary)",Me.currentTarget.style.color="#ffffff"},children:"Close"}),Ke&&s.jsx(Nt,{permission:De.UPDATE_TEMPLATE_VERSION,fallback:null,children:s.jsxs(ae,{variant:"warning",onClick:qe,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#000",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:Me=>{Me.currentTarget.style.backgroundColor="#ffb300",Me.currentTarget.style.borderColor="#ffb300",Me.currentTarget.style.transform="translateY(-1px)",Me.currentTarget.style.boxShadow="0 4px 8px rgba(255, 193, 7, 0.3)"},onMouseLeave:Me=>{Me.currentTarget.style.backgroundColor="#ffc107",Me.currentTarget.style.borderColor="#ffc107",Me.currentTarget.style.transform="translateY(0)",Me.currentTarget.style.boxShadow="none"},children:[s.jsx(Jx,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Update Rejected Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Update"})]})}),r?.status==="PUBLISHED"&&s.jsx(Nt,{permission:De.UPDATE_TEMPLATE_STATUS,fallback:null,children:s.jsx(ae,{variant:"danger",onClick:st,disabled:I,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease",opacity:I?.6:1},onMouseEnter:Me=>{I||(Me.currentTarget.style.backgroundColor="#c82333",Me.currentTarget.style.borderColor="#c82333",Me.currentTarget.style.transform="translateY(-1px)",Me.currentTarget.style.boxShadow="0 4px 8px rgba(220, 53, 69, 0.3)")},onMouseLeave:Me=>{I||(Me.currentTarget.style.backgroundColor="#dc3545",Me.currentTarget.style.borderColor="#dc3545",Me.currentTarget.style.transform="translateY(0)",Me.currentTarget.style.boxShadow="none")},children:I?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Disabling..."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Disabling..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(eu,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Disable Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Disable"})]})})}),r?.status==="DISABLED"&&s.jsx(Nt,{permission:De.UPDATE_TEMPLATE_STATUS,fallback:null,children:s.jsx(ae,{variant:"success",onClick:Te,disabled:A,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"#28a745",borderColor:"#28a745",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease",opacity:A?.6:1},onMouseEnter:Me=>{A||(Me.currentTarget.style.backgroundColor="#218838",Me.currentTarget.style.borderColor="#218838",Me.currentTarget.style.transform="translateY(-1px)",Me.currentTarget.style.boxShadow="0 4px 8px rgba(40, 167, 69, 0.3)")},onMouseLeave:Me=>{A||(Me.currentTarget.style.backgroundColor="#28a745",Me.currentTarget.style.borderColor="#28a745",Me.currentTarget.style.transform="translateY(0)",Me.currentTarget.style.boxShadow="none")},children:A?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Enabling..."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Enabling..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Enable Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Enable"})]})})}),a&&s.jsxs(ae,{variant:"primary",onClick:ge,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:Me=>{Me.currentTarget.style.backgroundColor="#153a4a",Me.currentTarget.style.borderColor="#153a4a",Me.currentTarget.style.transform="translateY(-1px)",Me.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:Me=>{Me.currentTarget.style.backgroundColor="var(--bs-primary)",Me.currentTarget.style.borderColor="var(--bs-primary)",Me.currentTarget.style.transform="translateY(0)",Me.currentTarget.style.boxShadow="none"},children:[s.jsx(X2,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create New Version"}),s.jsx("span",{className:"d-inline d-sm-none",children:"New Version"})]})]}),s.jsx(cg,{show:U!==null&&oe!==null,onHide:()=>{X(null),oe&&URL.revokeObjectURL(oe),Ee(null)},pdfUrl:oe||"",title:U?`Version ${U.version||"N/A"} - ${U.name||"Template"}`:"Template PDF"})]})},Roe=({show:e,onHide:t})=>{const r=ft(),[a,n]=v.useState([]),[i,l]=v.useState(!1),[o,c]=v.useState(null),[u,d]=v.useState(!1);v.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{l(!0);const p=await Dt.getTemplates({status:"PUBLISHED"});let g=[];p.success&&p.data?g=p.data:Array.isArray(p)?g=p:p.data&&Array.isArray(p.data)&&(g=p.data),n(g)}catch(p){console.error("Error loading published templates:",p),te.error("Failed to load published templates"),n([])}finally{l(!1)}},f=p=>{c(p),d(!0)},h=async p=>{try{const g=await Dt.getTemplateById(p.id);if(!g||!g.data){te.error("Failed to load template details");return}const j=g.data,w=j.templateForm||j,y=j.sections||[],b=Zm(y);localStorage.removeItem("currentTemplateId"),console.log(" Cleared currentTemplateId before creating new version");const S={id:null,currentTemplateId:null,originalTemplateId:p.id,name:w.name||p.name,description:w.description||p.description,departmentId:w.departmentId||p.departmentId,templateContent:w.templateContent||"",templateConfig:w.templateConfig||"",importType:"Create Version",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(S)),console.log(" Template info saved for version creation:",S),console.log(" Frontend sections:",b),r(Pe.TEMPLATES_EDITOR,{state:{documentUrl:w.templateConfig||w.templateContent||"",fileName:w.name||"Untitled Document",importType:"Create Version",templateInfo:S,initialSections:b}}),t(),te.success("Template loaded. You can now create a new version.")}catch(g){console.error("Error creating version:",g),te.error("Failed to load template for version creation")}},x=p=>{if(!p)return"N/A";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return p}};return s.jsxs(s.Fragment,{children:[s.jsxs(se,{show:e,onHide:t,size:"xl",centered:!0,className:"published-templates-modal",fullscreen:"md-down",children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"me-2",size:20}),"Create New Template's Version"]}),s.jsx(ae,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(ht,{size:24})})]}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto",overflowX:"hidden"},className:"published-templates-modal-body",children:i?s.jsx(Fr,{}):a.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(gt,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No published templates found"}),s.jsx("p",{className:"text-muted",children:"There are no published templates available to create a new version."})]}):s.jsx(ue,{className:"g-3",children:a.map(p=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,children:s.jsx(Y,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onMouseEnter:g=>{g.currentTarget.style.transform="translateY(-5px)",g.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:g=>{g.currentTarget.style.transform="translateY(0)",g.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(gt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:p.name,children:p.name}),s.jsxs("small",{className:"text-muted",children:["v",p.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4"},title:p.description||"No description",children:p.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ws,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:p.department?.code||"N/A",children:p.department?.code||"N/A"})]}),s.jsxs(Ae,{bg:"success",className:"d-flex align-items-center gap-1",children:[s.jsx(it,{size:12}),"PUBLISHED"]})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${p.createdByUser?.lastName||""}${p.createdByUser?.middleName?" "+p.createdByUser?.middleName:""} ${p.createdByUser?.firstName||""}`.trim(),children:[p.createdByUser?.lastName,p.createdByUser?.middleName?" "+p.createdByUser?.middleName:""," ",p.createdByUser?.firstName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:x(p.createdAt)})]}),s.jsxs("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center",children:[s.jsx(gt,{size:12,className:"me-1"}),p._count?.sections||0," sections"]}),s.jsxs(ae,{variant:"link",size:"sm",className:"p-0 text-primary-custom",onClick:g=>{g.stopPropagation(),f(p)},style:{whiteSpace:"nowrap"},children:[s.jsx(tr,{size:14,className:"me-1"}),"View Detail"]})]}),s.jsxs(ae,{variant:"primary-custom",size:"sm",className:"w-100 d-flex align-items-center justify-content-center",onClick:g=>{g.stopPropagation(),h(p)},children:[s.jsx(vn,{size:14,className:"me-2"}),"Create New Version"]})]})]})})},p.id))})}),s.jsx(se.Footer,{className:"border-0",children:s.jsx(ae,{variant:"outline-secondary",onClick:t,children:"Close"})})]}),s.jsx(U5,{show:u,onHide:()=>{d(!1),c(null)},template:o,onCreateVersion:p=>{d(!1),h(p)},onTemplateStatusChange:m})]})},Foe=({activeTab:e,onTabChange:t,counts:r={}})=>{const a=[{id:"pending",label:"Pending",icon:rt,status:"PENDING"},{id:"approved",label:"Approved (Published)",icon:it,status:"PUBLISHED"},{id:"denied",label:"Rejected",icon:zr,status:"DENIED"}];return s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",children:s.jsx("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:a.map(n=>{const i=n.icon,l=e===n.id,o=r[n.id]||0;return s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l?"border-bottom border-white border-3":""}`,onClick:()=>t(n.id),style:{fontWeight:l?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(i,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:n.label}),s.jsx("span",{className:"d-inline d-sm-none",children:n.label.split(" ")[0]}),o>0&&s.jsx(Ae,{bg:"light",text:"dark",className:"ms-2",style:{fontSize:"0.7rem",padding:"2px 6px",borderRadius:"10px",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white"},children:o})]},n.id)})})})},Loe=({templates:e,onViewDetail:t})=>{const r=n=>{const i={PENDING:{variant:"warning",icon:rt,text:"PENDING"},PUBLISHED:{variant:"success",icon:it,text:"PUBLISHED"},DENIED:{variant:"danger",icon:zr,text:"REJECTED"},REJECTED:{variant:"danger",icon:zr,text:"REJECTED"},DRAFT:{variant:"secondary",icon:rt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:gt,text:"ARCHIVED"}},l=i[n]||i.DRAFT,o=l.icon;return s.jsxs(Ae,{bg:l.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(o,{size:12}),l.text]})},a=n=>{if(!n)return"N/A";try{return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return n}};return e.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(gt,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No templates found"}),s.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]}):s.jsx(ue,{className:"g-3 g-md-4",children:e.map(n=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(Y,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>t(n.id),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(gt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:n.name,children:n.name}),s.jsxs("small",{className:"text-muted",children:["v",n.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:n.description||"No description",children:n.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ws,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:n.department?.code||"N/A",children:n.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:r(n.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.lastName}${n.createdByUser.middleName?" "+n.createdByUser.middleName:""} ${n.createdByUser.firstName}`:n.createdBy||"N/A",children:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.lastName}${n.createdByUser.middleName?" "+n.createdByUser.middleName:""} ${n.createdByUser.firstName}`:n.createdBy||"N/A"})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:a(n.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(gt,{size:12,className:"me-1"}),n._count?.sections||n.sections||0," sections"]}),s.jsx(Nt,{permissions:[De.VIEW_TEMPLATE_DETAILS],fallback:null,children:s.jsxs(ae,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:i=>{i.stopPropagation(),t(n.id)},style:{whiteSpace:"nowrap"},children:[s.jsx(tr,{size:14,className:"me-1"}),"View Detail"]})})]})})]})})},n.id))})},Moe=({templates:e,searchTerm:t,onSearchChange:r,onViewDetail:a})=>s.jsxs(s.Fragment,{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search templates by name, description, or creator...",value:t,onChange:r,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:6,md:7,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[e.length," template",e.length!==1?"s":""]})})})]}),s.jsx("div",{className:"template-card-scroll-container",children:s.jsx(Loe,{templates:e,onViewDetail:a})})]}),Boe=()=>{const e=ft(),[t]=xi(),{isSQAMode:r,isAdminMode:a}=Ioe(),[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState(""),[x,p]=v.useState(""),[g,j]=v.useState("pending"),[w,y]=v.useState(""),[b,S]=v.useState([]),[E,N]=v.useState(!0),T=v.useCallback(async()=>{try{if(N(!0),r){const F=await Dt.getTemplates();let P=[];F.success&&F.data?P=F.data:Array.isArray(F)?P=F:F.data&&Array.isArray(F.data)&&(P=F.data),S(P)}else if(a){const F=await Dt.getMyTemplates();let P=[];F.success&&F.data?P=F.data:Array.isArray(F)?P=F:F.data&&Array.isArray(F.data)&&(P=F.data),S(P)}else S([])}catch(F){console.error("Error loading templates:",F),te.error("Failed to load templates"),S([])}finally{N(!1)}},[r,a]);v.useEffect(()=>{T()},[T]),v.useEffect(()=>{if(a&&t.get("action")==="create"){i(!0);const P=new URLSearchParams(t);P.delete("action");const C=P.toString();e({search:C?`?${C}`:""},{replace:!0})}},[a]);const k=F=>{switch(F){case"pending":return"PENDING";case"approved":return"PUBLISHED";case"denied":return["DENIED","REJECTED"];default:return null}},I=v.useMemo(()=>{if(!r)return[];const F=k(g);return F?Array.isArray(F)?b.filter(P=>F.includes(P.status)):b.filter(P=>P.status===F):[]},[b,g,r]),D=v.useMemo(()=>r?I.filter(F=>{const P=F.name?.toLowerCase()||"",C=F.description?.toLowerCase()||"",W=F.createdBy?.toLowerCase()||(F.createdByUser?.firstName&&F.createdByUser?.lastName?`${F.createdByUser.lastName}${F.createdByUser.middleName?" "+F.createdByUser.middleName:""} ${F.createdByUser.firstName}`.toLowerCase():"");return P.includes(w.toLowerCase())||C.includes(w.toLowerCase())||W.includes(w.toLowerCase())}):[],[I,w,r]),A=v.useMemo(()=>r?{pending:b.filter(F=>F.status==="PENDING").length,approved:b.filter(F=>F.status==="PUBLISHED").length,denied:b.filter(F=>F.status==="DENIED"||F.status==="REJECTED").length}:{pending:0,approved:0,denied:0},[b,r]),M=()=>{i(!0)},G=()=>{i(!1),T()},q=F=>{te.error(`Import failed: ${F}`,{icon:!1})},z=F=>{o(F),u(!0)},ee=F=>{console.log("View detail for template:",F),e(Pe.TEMPLATES_DETAIL(F))},U=F=>{const P={PENDING:{variant:"warning",icon:rt,text:"PENDING"},PUBLISHED:{variant:"success",icon:it,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:gt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:gt,text:"ARCHIVED"},DENIED:{variant:"danger",icon:rt,text:"REJECTED"},REJECTED:{variant:"danger",icon:rt,text:"REJECTED"},DISABLED:{variant:"dark",icon:eu,text:"DISABLED"}},C=P[F]||P.DRAFT,W=C.icon;return s.jsxs(Ae,{bg:C.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(W,{size:12}),C.text]})},X=F=>{if(!F)return"N/A";try{return new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return F}},oe=v.useMemo(()=>a?b.filter(F=>{const P=!f||(()=>{const W=F.name?.toLowerCase()||"",Z=F.description?.toLowerCase()||"",J=F.createdByUser?.firstName&&F.createdByUser?.lastName?`${F.createdByUser.lastName}${F.createdByUser.middleName?" "+F.createdByUser.middleName:""} ${F.createdByUser.firstName}`.toLowerCase():"",le=f.toLowerCase();return W.includes(le)||Z.includes(le)||J.includes(le)})(),C=!x||F.status===x;return P&&C}):[],[b,f,x,a]),Ee=[{value:"DRAFT",label:"Draft"},{value:"PENDING",label:"Pending"},{value:"PUBLISHED",label:"Published"},{value:"REJECTED",label:"Rejected"},{value:"DISABLED",label:"Disabled"}];return E?s.jsx(Be,{fluid:!0,className:"p-4",children:s.jsx(Fr,{})}):r?s.jsx(Be,{fluid:!0,className:"py-4 template-list-page",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-light-custom border-neutral-200"}),s.jsx(Foe,{activeTab:g,onTabChange:j,counts:A}),s.jsx(Y.Body,{className:"template-list-body",children:s.jsx(Moe,{templates:D,searchTerm:w,onSearchChange:y,onViewDetail:ee})})]})}):a?s.jsx(Be,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:s.jsxs(ue,{className:"align-items-center",children:[s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(gt,{className:"me-2 text-white",size:24}),s.jsx("h4",{className:"mb-0 text-white",children:"Template List"})]})}),s.jsx(H,{xs:"auto",children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(Nt,{permission:De.EDIT_DRAFT_TEMPLATE,fallback:null,children:s.jsxs(ae,{variant:"outline-light",onClick:()=>e(Pe.TEMPLATES_DRAFTS),className:"d-flex align-items-center",size:"sm",children:[s.jsx(gt,{className:"me-2",size:16}),"Your Drafts"]})}),s.jsx(Nt,{permission:De.UPDATE_TEMPLATE_VERSION,fallback:null,children:s.jsxs(ae,{variant:"outline-light",onClick:()=>m(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(gt,{className:"me-2",size:16}),"Create New Template's Version"]})}),s.jsx(Nt,{permission:De.CREATE_TEMPLATE,fallback:null,children:s.jsxs(ae,{variant:"primary-custom",onClick:M,className:"d-flex align-items-center",size:"sm",children:[s.jsx(js,{className:"me-2",size:16}),"Create New Template"]})}),"                "]})})]})}),s.jsxs(Y.Body,{className:"template-list-body",style:{display:"flex",flexDirection:"column",maxHeight:"calc(100vh - 220px)",overflow:"hidden",paddingBottom:0},children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",style:{flexShrink:0},children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search templates by name, description, or creator...",value:f,onChange:h,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsx(KR,{title:"Status",options:Ee,selectedValue:x,onSelect:p,variant:"outline-secondary"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[oe.length," template",oe.length!==1?"s":""]})})})]}),s.jsx("div",{className:"template-list-scroll",style:{flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%",paddingRight:"0.75rem",marginRight:"-0.25rem"},children:oe.length===0?s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(oi,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:b.length===0?"No form templates found":"No templates match your search or filter criteria"}),s.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."})]})})}):s.jsx(ue,{className:"g-3 g-md-4",children:oe.map(F=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(Y,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:P=>{P.currentTarget.style.transform="translateY(-5px)",P.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:P=>{P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(gt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:F.name,children:F.name}),s.jsxs("small",{className:"text-muted",children:["v",F.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:F.description||"No description",children:F.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ws,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:F.department?.code||"N/A",children:F.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:U(F.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${F.createdByUser?.lastName||""}${F.createdByUser?.middleName?" "+F.createdByUser?.middleName:""} ${F.createdByUser?.firstName||""}`.trim(),children:[F.createdByUser?.lastName,F.createdByUser?.middleName?" "+F.createdByUser?.middleName:""," ",F.createdByUser?.firstName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:X(F.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(gt,{size:12,className:"me-1"}),F._count?.sections||0," sections"]}),s.jsx(Nt,{permission:De.VIEW_TEMPLATE_DETAILS,fallback:null,children:s.jsxs(ae,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:P=>{P.stopPropagation(),z(F)},style:{whiteSpace:"nowrap"},children:[s.jsx(tr,{size:14,className:"me-1"}),"Preview"]})})]})})]})})},F.id))})}),s.jsx(Ooe,{show:n,onHide:()=>i(!1),onImportSuccess:G,onImportError:q}),s.jsx(U5,{show:c,onHide:()=>{u(!1),setTimeout(()=>o(null),300)},template:l,onTemplateStatusChange:T}),s.jsx(Roe,{show:d,onHide:()=>m(!1)})]})]})}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Y,{children:s.jsx(Y.Body,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(oi,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Access Denied"}),s.jsx("p",{className:"text-muted",children:"You don't have permission to view templates."})]})})})})};function Hd(e){const t=(e.fieldName||"").trim(),r=e.parentTempId||null;return`${t}|${r||"null"}`}function zoe(e){return Array.isArray(e)?e.flatMap(t=>(t.fields||[]).map(a=>{const n=(a.fieldName||a.name||"").trim(),i=(a.fieldType||"").trim(),l=a.parentTempId||null;return{fieldName:n,fieldType:i,parentTempId:l}})):[]}function $oe(e){let t=[];return Array.isArray(e)?t=e:e?.fields&&Array.isArray(e.fields)?t=e.fields:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data&&Array.isArray(e.data)&&(t=e.data),t.map(r=>({fieldName:(r.fieldName||"").trim(),fieldType:(r.fieldType||"").trim(),parentTempId:r.parentTempId||null}))}function Uoe(e,t){const r=$oe(e),a=zoe(t);console.log(" [Field Validator] Debug Info:"),console.log("   Normalized Extract Fields:",r),console.log("   Flattened Payload Fields:",a);const n=new Set(a.map(Hd)),i=new Set(r.map(Hd));console.log("   Payload Keys:",Array.from(n)),console.log("   Extract Keys:",Array.from(i));const l=r.filter(h=>{const x=Hd(h),p=n.has(x);return p||console.log(`   Missing in Schema: ${x} (fieldName: ${h.fieldName}, fieldType: ${h.fieldType}, parentTempId: ${h.parentTempId})`),!p}),o=a.filter(h=>{const x=Hd(h),p=i.has(x);return p||console.log(`   Missing in Document: ${x} (fieldName: ${h.fieldName}, fieldType: ${h.fieldType}, parentTempId: ${h.parentTempId})`),!p}),c=[...new Set(l.map(h=>h.fieldName))],u=[...new Set(o.map(h=>h.fieldName))],d=l.length===0&&o.length===0;let m="",f="";return l.length>0&&(c.length===1?m=`Field "${c[0]}" is not in the Available Custom Fields. Please remove it from the editor or add it through the side panel.`:m=`The following fields are not in the Available Custom Fields: ${c.join(", ")}. Please remove them from the editor or add them through the side panel.`),o.length>0&&(u.length===1?f=`Field "${u[0]}" is in the Available Custom Fields but not found in the editor. Please insert it into the editor using the "Insert Field" button.`:f=`The following fields are in the Available Custom Fields but not found in the editor: ${u.join(", ")}. Please insert them into the editor using the "Insert Field" button.`),{isValid:d,missingInSchema:c,missingInDocument:u,errorMessage:m,warningMessage:f,totalExtractFields:r.length,totalPayloadFields:a.length}}const Woe=({customFields:e=[],onAddField:t,onRemoveField:r,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:l,getDocumentKey:o,addSystemFieldToSectionRef:c,initialSections:u=null,readOnly:d=!1,className:m="",onSubmittingChange:f,isUpdateRejected:h=!1})=>{const x=ft(),[p,g]=v.useState([]);v.useEffect(()=>{u&&Array.isArray(u)&&u.length>0&&p.length===0&&(console.log(" Restoring sections from draft:",u),g(u))},[u]);const[j,w]=v.useState({}),[y,b]=v.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),[S,E]=v.useState({fromIndex:null,overIndex:null,position:"above"}),N=v.useRef(new Set),[T,k]=v.useState(!1),[I,D]=v.useState(null),[A,M]=v.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"ASSESSMENT_REVIEWER",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[G,q]=v.useState(["TRAINER","TRAINEE"]),[z,ee]=v.useState(!1),[U,X]=v.useState(!1),[oe,Ee]=v.useState(null),[F,P]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null,option:null}),[C,W]=v.useState([]),[Z,J]=v.useState("");v.useEffect(()=>{e&&e.length>0&&p.length===0&&g([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"ASSESSMENT_REVIEWER",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]),v.useEffect(()=>(c&&(c.current={getSections:()=>p,addSystemField:(B,L)=>(g(K=>{if(B===null||B<0||B>=K.length)return te.error("Invalid section index"),K;const fe=K[B],ve=fe.fields||[],be=K.flatMap(Re=>Re.fields||[]).filter(Re=>!Re.parentTempId&&!Re.parentId);if(!(L.parentTempId||L.parentId)&&be.some(Re=>Re.fieldName===L.fieldName))return te.warning(`Field "${L.fieldName}" already exists in the template`),K;const Ne={...L,roleRequired:L.roleRequired||fe.editBy||"TRAINER"},Ie=[...K];if(Ie[B]={...fe,fields:[...ve,Ne]},t){const Re=Ie.flatMap(Fe=>Fe.fields||[]);setTimeout(()=>{t(Re)},0)}return Ie}),!0),buildAndSubmitDraftTemplate:async B=>{try{console.log(" Building and submitting draft template..."),console.log(" Draft URL (OnlyOffice):",B);let L=null;const K=Ya();try{console.log(" Uploading from OnlyOffice URL to S3...");const Ve=`${(K.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}_draft.docx`;if(console.log(" File name for upload:",Ve),L=await an.uploadFromUrl(B,Ve),L)console.log(" Upload from URL success! S3 URL:",L);else throw console.warn(" No S3 URL received from upload-from-url"),new Error("Failed to upload to S3")}catch(Re){throw console.error(" Upload from URL failed:",Re),te.error("Could not upload draft document to S3"),Re}const fe=Ya(),ve=fe.originalTemplateId,pe=fe.currentTemplateId||fe.id||localStorage.getItem("currentTemplateId");let be=null;if(pe&&!ve)try{console.log(" Loading existing draft fields for parentId conversion...");const Re=await Dt.getTemplateById(pe);be=(Re?.data?.sections||Re?.data?.data?.sections||[]).flatMap(Ve=>Ve.fields||[]),console.log(` Loaded ${be.length} existing fields for conversion`)}catch(Re){console.warn(" Failed to load existing draft fields, will use parentTempId:",Re)}const we={...K,templateContent:K.templateContent,templateConfig:L},Ne=R2(we,p,be),Ie={name:Ne.name,description:Ne.description,departmentId:Ne.departmentId,templateContent:Ne.templateContent,templateConfig:Ne.templateConfig||null,status:"DRAFT",sections:Ne.sections};if(console.log(" Draft template payload built:"),console.log("   templateContent (file import):",Ie.templateContent),console.log("   templateConfig (file  chnh sa):",Ie.templateConfig||"null"),console.log("   Status:",Ie.status),console.log("   Using existingFields for conversion:",be?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(Ie,null,2)),console.log(" Checking flow type:"),console.log("   freshMeta.originalTemplateId:",ve),console.log("   freshMeta.currentTemplateId:",fe.currentTemplateId),console.log("   freshMeta.id:",fe.id),console.log('   localStorage.getItem("currentTemplateId"):',localStorage.getItem("currentTemplateId")),console.log("   Final originalTemplateId:",ve),console.log("   Final currentTemplateId:",pe),ve){console.log(" Creating new draft for version (with originalTemplateId):",ve);const Re={originalTemplateId:ve,...Ie};try{const Fe=await Dt.createVersion(Re),Je=(Fe?.data?.templateForm||Fe?.data?.data?.templateForm||Fe?.data?.data?.template||Fe?.data?.template)?.id||Fe?.data?.id||Fe?.data?.data?.id||Fe?.data?.data?.templateForm?.id||Fe?.data?.data?.template?.id||Fe?.data?.template?.id||(Fe?.data?.data?.template?Fe.data.data.template.id:null);if(Je){const St={...Ya(),currentTemplateId:Je};localStorage.setItem("templateInfo",JSON.stringify(St)),localStorage.setItem("currentTemplateId",Je),console.log(" Saved currentTemplateId:",Je)}return te.success("Draft template saved successfully!"),console.log(" Draft version created successfully:",Fe?.data??Fe),Fe?.data??Fe}catch(Fe){const Ve=Fe?.response?.data?.message||Fe?.message||"";if((Fe?.response?.statusCode||Fe?.response?.status)===400&&(Ve.includes("already exists")||Ve.includes("Template name")||Ve.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),te.warning("Template name already exists. System will auto-generate a new name...");const St={originalTemplateId:ve,description:Ie.description,departmentId:Ie.departmentId,templateContent:Ie.templateContent,templateConfig:Ie.templateConfig||null,status:"DRAFT",sections:Ie.sections};try{const wt=await Dt.createVersion(St),Jt=(wt?.data?.templateForm||wt?.data?.data?.templateForm||wt?.data?.data?.template||wt?.data?.template)?.id||wt?.data?.id||wt?.data?.data?.id||wt?.data?.data?.templateForm?.id||wt?.data?.data?.template?.id||wt?.data?.template?.id||(wt?.data?.data?.template?wt.data.data.template.id:null);if(Jt){const Et={...Ya(),currentTemplateId:Jt};localStorage.setItem("templateInfo",JSON.stringify(Et)),localStorage.setItem("currentTemplateId",Jt),console.log(" Saved currentTemplateId (retry):",Jt)}return te.success("Draft template saved successfully with auto-generated name!"),console.log(" Draft version created successfully (retry):",wt?.data??wt),wt?.data??wt}catch(wt){throw console.error(" Retry failed:",wt),wt}}else throw Fe}}else if(pe){console.log(" Updating existing draft:",pe);const Re=await Se.put(`/templates/update-draft/${pe}`,{...Ie,id:pe,status:"DRAFT"});return te.success("Draft template saved successfully!"),console.log(" Draft updated successfully:",Re?.data??Re),Re?.data??Re}else{console.log(" Creating new draft");const Re=await Se.post("/templates",Ie);console.log(" Response structure check:"),console.log("   Full res?.data:",JSON.stringify(Re?.data,null,2)),console.log("   res?.data?.id:",Re?.data?.id),console.log("   res?.data?.data:",Re?.data?.data),console.log("   res?.data?.data?.id:",Re?.data?.data?.id),console.log("   res?.data?.data?.templateForm?.id:",Re?.data?.data?.templateForm?.id),console.log("   res?.data?.data?.template?.id:",Re?.data?.data?.template?.id),console.log("   res?.data?.template?.id:",Re?.data?.template?.id);const Fe=Re?.data?.id||Re?.data?.data?.id||Re?.data?.data?.templateForm?.id||Re?.data?.data?.template?.id||Re?.data?.template?.id||(Re?.data?.data?.template?Re.data.data.template.id:null);if(console.log("   Extracted newTemplateId:",Fe),Fe){const Je={...Ya(),currentTemplateId:Fe};localStorage.setItem("templateInfo",JSON.stringify(Je)),localStorage.setItem("currentTemplateId",Fe),console.log(" Saved currentTemplateId:",Fe),console.log(" Updated templateInfo:",Je)}else console.warn(" No template ID found in response! Response structure:",Re?.data);return te.success("Draft template saved successfully!"),console.log(" Draft created successfully:",Re?.data??Re),Re?.data??Re}}catch(L){console.error(" Error building/submitting draft template:",L);const K=L.response?.data?.message||L.message||"Unknown error";throw te.error(K),L}}}),()=>{c&&(c.current=null)}),[p,c,t]);const le=()=>{D(null),M({name:"",label:"",displayOrder:p.length+1,editBy:"TRAINER",roleInSubject:"ASSESSMENT_REVIEWER",isSubmittable:!0,isToggleDependent:!1,fields:[]}),k(!0)},V=B=>{if(d)return;const L=p[B];L&&(D(B),M({name:L.name||L.label||"",label:L.label||"",displayOrder:L.displayOrder||B+1,editBy:L.editBy||"TRAINER",roleInSubject:L.editBy==="TRAINER"?L.roleInSubject||"ASSESSMENT_REVIEWER":L.roleInSubject||"",isSubmittable:L.isSubmittable!==void 0?L.isSubmittable:!0,isToggleDependent:L.isToggleDependent!==void 0?L.isToggleDependent:!1,fields:L.fields||[]}),k(!0))},re=B=>{w(L=>({...L,[B]:!L[B]}))},he=(B,L,K)=>{L===null||K===null||L===K||g(fe=>{const ve=[...fe],pe=[...ve[B]?.fields||[]],[be]=pe.splice(L,1);if(pe.splice(K,0,be),ve[B]={...ve[B],fields:pe},t){const we=ve.flatMap(Ne=>Ne.fields||[]);setTimeout(()=>{t(we,{silent:!0})},0)}return ve})},O=(B,L)=>{B===null||L===null||B===L||g(K=>{const fe=[...K],[ve]=fe.splice(B,1);return fe.splice(L,0,ve),fe})},ye=(B,L,K,fe)=>{if(d||B===null||L===null||K===null)return;if(B===K){he(B,L,fe);return}const ve=`${B}-${L}-${K}`,pe=N.current.size;N.current.add(ve);const be=N.current.size;if(pe===be){console.warn(" Move operation already in progress, skipping...",ve);return}g(we=>{const Ne=[...we],Ie=Ne[B],Re=Ne[K];if(!Ie||!Re)return setTimeout(()=>{N.current.delete(ve)},0),we;const Fe=[...Ie.fields||[]],Ve=[...Re.fields||[]];if(L<0||L>=Fe.length)return console.warn(" Invalid fromFieldIndex:",L,"Fields length:",Fe.length),setTimeout(()=>{N.current.delete(ve)},0),we;const Je=Fe[L];if(!Je)return console.warn(" Field not found at index:",L),setTimeout(()=>{N.current.delete(ve)},0),we;console.log(" moveFieldBetweenSections:",{fromFieldIndex:L,fieldToMove:Je.label||Je.fieldName,fieldType:Je.fieldType,parentTempId:Je.parentTempId,allFields:Fe.map((Ft,la)=>({idx:la,label:Ft.label||Ft.fieldName,type:Ft.fieldType,parent:Ft.parentTempId}))});const pt=String(Je.fieldType||"").toUpperCase()==="PART",St=String(Je.fieldType||"").toUpperCase()==="CHECK_BOX",wt=pt||St,Lr=wt?Je.tempId||`${Je.fieldName}-parent`:null,Jt=[Je],xt=new Set([L]);wt&&Lr&&Fe.forEach((Ft,la)=>{Ft.parentTempId===Lr&&la!==L&&(console.log("   Adding child:",{idx:la,label:Ft.label||Ft.fieldName,parentTempId:Ft.parentTempId}),Jt.push(Ft),xt.add(la))}),console.log("   Fields to move:",Jt.map(Ft=>Ft.label||Ft.fieldName)),console.log("   Indices to remove:",Array.from(xt));const Et=Fe.filter((Ft,la)=>{const cd=xt.has(la);return cd&&console.log(`   Removing field at index ${la}:`,Ft.label||Ft.fieldName),!cd});console.log("   Remaining fields:",Et.map((Ft,la)=>({idx:la,label:Ft.label||Ft.fieldName})));const fs=fe!==null?Math.max(0,Math.min(fe,Ve.length)):Ve.length;if(Ve.splice(fs,0,...Jt),Ne[B]={...Ie,fields:Et},Ne[K]={...Re,fields:Ve},t){const Ft=Ne.flatMap(la=>la.fields||[]);setTimeout(()=>{t(Ft,{silent:!0})},0)}return setTimeout(()=>{N.current.delete(ve)},0),Ne})},de=B=>{if(!(d||!p[B])&&(g(K=>K.filter((fe,ve)=>ve!==B)),t)){const fe=p.filter((ve,pe)=>pe!==B).flatMap(ve=>ve.fields||[]);setTimeout(()=>{t(fe,{silent:!0})},0)}},je=()=>{if(!A.label){te.warning("Please fill in section label");return}const B=A.label.trim();if(p.some((fe,ve)=>I!==null&&ve===I?!1:fe.label&&fe.label.trim().toLowerCase()===B.toLowerCase())){te.warning(`Section with label "${B}" already exists. Please use a different label.`);return}const K={...A,name:B,label:B,roleInSubject:A.editBy==="TRAINEE"?null:A.roleInSubject||null,fields:[...A.fields||[]]};if(I!==null)g(fe=>{const ve=[...fe],pe=ve[I],be=pe.fields||[];let we=[...be];const Ne=be.some(Re=>Re.fieldType==="SECTION_CONTROL_TOGGLE"),Ie=K.isToggleDependent;if(Ie&&!Ne){const Re=`${K.name.toLowerCase().replace(/\s+/g,"_")}_toggle`;we=[{label:`${K.label} Toggle`,fieldName:Re,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:K.editBy||"TRAINER",parentTempId:null},...we]}else!Ie&&Ne&&(we=we.filter(Re=>Re.fieldType!=="SECTION_CONTROL_TOGGLE"));return K.editBy!==pe.editBy&&(we=we.map(Re=>Re.fieldType==="SIGNATURE_DRAW"||Re.fieldType==="SIGNATURE_TYPE"?{...Re,roleRequired:K.editBy}:Re)),ve[I]={...pe,label:K.label,name:K.name,editBy:K.editBy,roleInSubject:K.roleInSubject,isSubmittable:K.isSubmittable,isToggleDependent:K.isToggleDependent,displayOrder:K.displayOrder,fields:we},ve}),te.success("Section updated successfully");else{if(K.isToggleDependent){const fe=`${K.name.toLowerCase().replace(/\s+/g,"_")}_toggle`,ve={label:`${K.label} Toggle`,fieldName:fe,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:K.editBy||"TRAINER",parentTempId:null};K.fields=[ve]}g(fe=>[...fe,K]),te.success("Section added successfully")}k(!1),D(null)},xe=()=>{if(I===null)return;const B=p[I];B&&(de(I),k(!1),D(null),te.success(`Section "${B.label}" removed successfully`))};v.useEffect(()=>{T&&(async()=>{try{const L=await Es.getRoles(),fe=(Array.isArray(L)?L:[]).map(pe=>typeof pe=="string"?pe:pe.name||pe.code||pe.roleName||"").filter(pe=>typeof pe=="string").map(pe=>pe.toUpperCase()).filter(pe=>pe.includes("TRAINER")||pe.includes("TRAINEE")).map(pe=>pe.includes("TRAINER")?"TRAINER":"TRAINEE"),ve=Array.from(new Set(fe));ve.length>0&&q(ve)}catch{}})()},[T]);const me=B=>{const K=p[B]?.editBy||"TRAINER";P({label:"",fieldName:"",fieldType:"TEXT",roleRequired:K,displayOrder:1,parentTempId:null,option:null}),W([]),J(""),D(B),ee(!0)},$e=(B,L)=>{if(!B)return{valid:!1,message:"Field name is required"};const K=String(L||"").toUpperCase();return K==="PART"||K==="CHECK_BOX"?/^[A-Z][A-Za-z0-9_]*$/.test(B)?B.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:K==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(B)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(B)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},Xe=()=>{if(!F.label||!F.fieldName){te.warning("Please fill in all required fields");return}let B={...F};if(F.fieldType==="VALUE_LIST"){if(!C||C.length===0){te.warning("Please add at least one option for VALUE_LIST field");return}const Ne=JSON.stringify({items:C});B.option=Ne,P(Ie=>({...Ie,option:Ne}))}const L=$e(B.fieldName,B.fieldType);if(!L.valid){te.warning(L.message);return}if(I===null||I<0||I>=p.length){te.warning("Please choose a section");return}const fe=p.flatMap((Ne,Ie)=>(Ne.fields||[]).map((Re,Fe)=>({...Re,sectionIndex:Ie,fieldIndex:Fe}))).filter(Ne=>!(oe!==null&&Ne.sectionIndex===I&&Ne.fieldIndex===oe||Ne.parentTempId||Ne.parentId)),ve=B.parentTempId||B.parentId;if(!ve&&fe.some(Ne=>Ne.fieldName===B.fieldName)){te.warning(`Field name "${B.fieldName}" already exists in the template`);return}if(ve){const Ne=p[I];B.roleRequired=Ne?.editBy||"TRAINER"}const pe=p[I],be=pe?.fields||[],we=[...p];if(oe!==null?we[I]={...pe,fields:[...be.slice(0,oe),B,...be.slice(oe+1)]}:we[I]={...pe,fields:[...be,B]},g(we),t){const Ne=we.flatMap(Ie=>Ie.fields||[]);setTimeout(()=>{t(Ne)},0)}ee(!1),X(!1),D(null),Ee(null),W([]),J("")},ge=(B,L)=>{const K=p[B]?.fields?.[L];if(K){if(P({...K}),K.fieldType==="VALUE_LIST"&&K.option)try{const fe=JSON.parse(K.option);fe.items&&Array.isArray(fe.items)?W(fe.items):W([])}catch{W([])}else W([]);J(""),D(B),Ee(L),X(!0)}},qe=()=>{ee(!1),X(!1),k(!1),D(null),Ee(null),W([]),J("")},[st,Te]=v.useState(!1);v.useEffect(()=>{f&&f(st)},[st,f]);const Ke=async()=>{try{Te(!0);const B=o?o():null;console.log(" DocumentKey:",B);const L=Ya();let K=null;const fe=L.templateContent;if(l)try{console.log(" Triggering callback flow...");const xt=await l();if(xt){console.log(" Callback flow success! OnlyOffice URL:",xt);try{console.log(" Uploading from OnlyOffice URL to S3...");const Ft=`${(L.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}.docx`;console.log(" File name for upload:",Ft),K=await an.uploadFromUrl(xt,Ft),K?console.log(" Upload from URL success! S3 URL:",K):(console.warn(" No S3 URL received from upload-from-url"),K=null)}catch(Et){console.error(" Upload from URL failed:",Et),te.warning("Could not upload document to S3"),K=null}}else console.warn(" No OnlyOffice URL received"),K=null}catch(xt){console.error(" Callback flow failed:",xt),te.warning("Could not get edited document from backend"),K=null}else console.warn(" forceSaveAndPoll function not available"),K=null;console.log(" Submitting template to backend...");const ve=p.flatMap(xt=>xt.fields||[]),pe=ve.filter(xt=>xt.fieldType==="FINAL_SCORE_TEXT"),be=ve.filter(xt=>xt.fieldType==="FINAL_SCORE_NUM");if(pe.length===0&&be.length===0){te.error("Template must have at least 1 FINAL_SCORE_TEXT or FINAL_SCORE_NUM field (or both)"),Te(!1);return}if(pe.length>1){te.error(`Template must have at most 1 FINAL_SCORE_TEXT field. Found: ${pe.length}`),Te(!1);return}if(be.length>1){te.error(`Template must have at most 1 FINAL_SCORE_NUM field. Found: ${be.length}`),Te(!1);return}console.log(" ===== SIGNATURE VALIDATION DEBUG ====="),console.log(" All sections:",p),console.log(" All fields:",ve);const we=ve.filter(xt=>(xt.fieldType==="SIGNATURE_IMAGE"||xt.fieldType==="SIGNATURE_DRAW")&&xt.roleRequired==="TRAINER");if(console.log(" TRAINER signature fields:",we),console.log(" TRAINER signature fields count:",we.length),we.length===0){te.error("Template must have at least one signature field (IMAGE or DRAW) for the TRAINER role."),Te(!1);return}const Ne=ve.filter(xt=>xt.fieldType==="SIGNATURE_DRAW"&&xt.roleRequired==="TRAINEE");if(console.log(" TRAINEE signature fields:",Ne),console.log(" TRAINEE signature fields count:",Ne.length),Ne.length!==1){te.error(`Template must have exactly one SIGNATURE_DRAW field for the TRAINEE role. Found: ${Ne.length}`),Te(!1);return}console.log(" Signature validation passed!"),console.log(" ===== END SIGNATURE VALIDATION DEBUG =====");const Ie=ve.filter(xt=>xt.fieldType==="FINAL_SCORE_TEST"),Re=be.length>0,Fe=pe.length>0,Ve=Ya(),Je=Ve.originalTemplateId,pt=Ve.currentTemplateId||Ve.id||localStorage.getItem("currentTemplateId");console.log(" Option B: Checking flow type (read FRESH):"),console.log("   isUpdateRejected:",h),console.log("   freshMeta.originalTemplateId:",Je),console.log("   freshMeta.currentTemplateId:",Ve.currentTemplateId),console.log("   freshMeta.id:",Ve.id),console.log('   localStorage.getItem("currentTemplateId"):',localStorage.getItem("currentTemplateId")),console.log("   Final originalTemplateId:",Je),console.log("   Final currentTemplateId:",pt);let St=null;if(pt&&!Je&&!h)try{console.log(" Loading existing draft fields for parentId conversion (Submit)...");const xt=await Dt.getTemplateById(pt);St=(xt?.data?.sections||xt?.data?.data?.sections||[]).flatMap(fs=>fs.fields||[]),console.log(` Loaded ${St.length} existing fields for conversion (Submit)`)}catch(xt){console.warn(" Failed to load existing draft fields, will use parentTempId:",xt)}const wt={...L,templateContent:fe,templateConfig:K},Lr=R2(wt,p,St),Jt={name:Lr.name,description:Lr.description,departmentId:Lr.departmentId,templateContent:Lr.templateContent,templateConfig:Lr.templateConfig||null,status:"PENDING",sections:Lr.sections};if(console.log(" Template payload built:"),console.log("   templateContent (file import):",Jt.templateContent),console.log("   templateConfig (file  chnh sa):",Jt.templateConfig||"null"),console.log("   Status:",Jt.status),console.log("   documentKey:",B),console.log("   Using existingFields for conversion:",St?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(Jt,null,2)),K)try{console.log(" Validating fields from editor against Available Custom Fields..."),console.log("   Document URL:",K);const xt=await Dt.extractFields(K);console.log(" Extract fields response:",xt);const Et=Uoe(xt,Jt.sections);if(console.log(" Validation result:",{isValid:Et.isValid,missingInSchema:Et.missingInSchema,missingInDocument:Et.missingInDocument,totalExtractFields:Et.totalExtractFields,totalPayloadFields:Et.totalPayloadFields}),!Et.isValid){if(Et.missingInSchema.length>0){console.error(" Field validation failed - fields in editor but not in Available Custom Fields:",Et.missingInSchema),te.error(Et.errorMessage),Te(!1);return}if(Et.missingInDocument.length>0){console.error(" Field validation failed - fields in Available Custom Fields but not in editor:",Et.missingInDocument),te.error(Et.warningMessage),Te(!1);return}}Et.isValid&&console.log(" Field validation passed - all fields match between editor and Available Custom Fields")}catch(xt){console.warn(" Failed to validate fields (extract-fields API error):",xt),console.warn(" Continuing with submit without field validation")}else console.warn(" No templateConfigUrl available - skipping field validation");if(h&&pt){console.log(" [OPTION B] Updating existing rejected template:",pt);const{status:xt,...Et}=Jt,fs=await Se.put(`/templates/update-rejected/${pt}`,{...Et,id:pt});te.success("Template submitted successfully"),console.log(" Rejected template updated and submitted:",fs?.data??fs);const Ft={...Ve,currentTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(Ft)),localStorage.removeItem("currentTemplateId"),console.log(" Cleared currentTemplateId after submit"),setTimeout(()=>{x(Pe.TEMPLATES)},1500)}else if(Je){console.log(" [OPTION B] Creating new version from published template:",Je);const xt={originalTemplateId:Je,...Jt};try{const Et=await Dt.createVersion(xt);te.success("Template version created successfully"),console.log(" Template version created:",Et?.data??Et);const fs={...Ve,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(fs)),console.log(" Cleared originalTemplateId after version creation"),setTimeout(()=>{x(Pe.TEMPLATES)},1500)}catch(Et){const fs=Et?.response?.data?.message||Et?.message||"";if((Et?.response?.statusCode||Et?.response?.status)===400&&(fs.includes("already exists")||fs.includes("Template name")||fs.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),te.warning("Template name already exists. System will auto-generate a new name...");const cd={originalTemplateId:Je,description:Jt.description,departmentId:Jt.departmentId,templateContent:Jt.templateContent,templateConfig:Jt.templateConfig||null,status:Jt.status,sections:Jt.sections};try{const No=await Dt.createVersion(cd);te.success("Template version created successfully with auto-generated name"),console.log(" Template version created (retry):",No?.data??No);const V5={...Ve,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(V5)),console.log(" Cleared originalTemplateId after version creation (retry)"),setTimeout(()=>{x("/templates")},1500)}catch(No){throw console.error(" Retry failed:",No),No}}else throw Et}}else if(pt){console.log(" [OPTION B] Updating existing draft:",pt);const xt=await Se.put(`/templates/update-draft/${pt}`,Jt);te.success("Template submitted successfully"),console.log(" Draft updated and submitted:",xt?.data??xt);const Et={...Ve,currentTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(Et)),localStorage.removeItem("currentTemplateId"),console.log(" Cleared currentTemplateId after submit"),setTimeout(()=>{x(Pe.TEMPLATES)},1500)}else{console.log(" [OPTION B] Creating new template");const xt=await Se.post("/templates",Jt);te.success("Template submitted successfully"),console.log(" Backend response:",xt?.data??xt),setTimeout(()=>{x(Pe.TEMPLATES)},1500)}}catch(B){console.error(" Submit template failed:",B);const L=B.response?.data?.message||B.message||"Unknown error";te.error(L)}finally{Te(!1)}},ze=B=>{const L=B.fieldName;if(!L)return"";switch((B.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${L}}{/`+L+`} {^${L}}{/`+L+"}";case"PART":return`{#${L}} {/${L}}`;case"CHECK_BOX":return`{#${L}} {/${L}}`;case"SIGNATURE_DRAW":case"SIGNATURE_IMAGE":return`{%${L}}`;case"FINAL_SCORE_TEXT":case"FINAL_SCORE_NUM":case"VALUE_LIST":case"TEXT":default:return`{${L}}`}},[et,yt]=v.useState(!1),[lt,Me]=v.useState(null),[ke,nt]=v.useState(null),[tt,Ge]=v.useState(""),[Ce,He]=v.useState(""),[Mt,Ls]=v.useState("TRAINER"),[Ta,ws]=v.useState(!1),[lr,qa]=v.useState(null),[Nr,dt]=v.useState(null),[kt,xr]=v.useState(""),[Yr,Xn]=v.useState(""),[Jy,od]=v.useState("TRAINER"),ef=(B,L,K)=>{nt(B),Me(K),Ge(""),He(""),Ls("TRAINER"),yt(!0)},tf=()=>{if(!Ce||!tt||!/^[a-z][a-z0-9_]*$/.test(tt)){te.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!lt?.fieldName){te.error("Invalid PART field");return}if(ke===null||ke<0||ke>=p.length){te.error("Invalid section");return}const K=p[ke].fields||[],fe=lt?.tempId||lt?.fieldName||null;if(K.filter(Ie=>(Ie.parentTempId||Ie.parentId)===fe).some(Ie=>Ie.fieldName===tt)){te.warning(`Field name "${tt}" already exists in this PART`);return}const be=p[ke]?.editBy||"TRAINER",we={label:Ce,fieldName:tt,fieldType:"TEXT",roleRequired:be,parentTempId:lt?.tempId||lt?.fieldName||null},Ne=[...p];if(Ne[ke].fields=[...K,we],g(Ne),t){const Ie=Ne.flatMap(Re=>Re.fields||[]);setTimeout(()=>{t(Ie)},0)}yt(!1),Me(null),nt(null),Ge(""),He(""),Ls("TRAINER")},wo=(B,L,K)=>{dt(B),qa(K),xr(""),Xn(""),od("TRAINER"),ws(!0)},rf=()=>{if(!Yr||!kt||!/^[a-z][a-z0-9_]*$/.test(kt)){te.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!lr?.fieldName){te.error("Invalid CHECK_BOX field");return}if(Nr===null||Nr<0||Nr>=p.length){te.error("Invalid section");return}const K=p[Nr].fields||[],fe=lr?.tempId||lr?.fieldName||null;if(K.filter(Ie=>(Ie.parentTempId||Ie.parentId)===fe).some(Ie=>Ie.fieldName===kt)){te.warning(`Field name "${kt}" already exists in this CHECK_BOX`);return}const be=p[Nr]?.editBy||"TRAINER",we={label:Yr,fieldName:kt,fieldType:"TEXT",roleRequired:be,parentTempId:lr?.tempId||lr?.fieldName||null},Ne=[...p];if(Ne[Nr].fields=[...K,we],g(Ne),t){const Ie=Ne.flatMap(Re=>Re.fields||[]);setTimeout(()=>{t(Ie)},0)}ws(!1),qa(null),dt(null),xr(""),Xn(""),od("TRAINER")},sf=(I!==null&&I<p.length?p[I]:null)?.editBy==="TRAINEE",Q=[{value:"TEXT",label:"TEXT"},{value:"TOGGLE",label:"TOGGLE"},{value:"PART",label:"PART"},{value:"CHECK_BOX",label:"CHECK_BOX"},{value:"SIGNATURE_DRAW",label:"SIGNATURE_DRAW"},{value:"SIGNATURE_IMAGE",label:"SIGNATURE_IMAGE"},{value:"FINAL_SCORE_TEXT",label:"FINAL_SCORE_TEXT"},{value:"FINAL_SCORE_NUM",label:"FINAL_SCORE_NUM"},{value:"VALUE_LIST",label:"VALUE_LIST"}],ce=["SIGNATURE_IMAGE","FINAL_SCORE_NUM","FINAL_SCORE_TEXT"],ie=sf?Q.filter(B=>!ce.includes(B.value)):Q;return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
          .section-body.section-drop-target { 
            background-color: rgba(0, 123, 255, 0.05) !important; 
            border: 2px dashed var(--bs-primary) !important; 
            border-radius: 0.375rem;
          }
          .section-header.section-header-drop-target {
            background-color: rgba(0, 123, 255, 0.1) !important;
            border: 2px dashed var(--bs-primary) !important;
            border-radius: 0.375rem;
          }
        `}),s.jsxs("div",{className:`p-2 p-md-3 bg-light custom-fields-panel ${m}`,style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 mb-md-3 flex-wrap gap-2 flex-shrink-0",children:[s.jsx("h6",{className:"mb-0 text-muted custom-fields-title",style:{fontSize:"0.95rem"},children:"Available Custom Fields"}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:le,disabled:d,className:"custom-fields-add-section-btn",style:{whiteSpace:"nowrap",flexShrink:0},children:[s.jsx(yr,{className:"me-1",size:14}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Section"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Section"})]})]}),s.jsx("div",{className:"flex-grow-1 custom-fields-content",style:{overflowY:"auto",overflowX:"hidden",minHeight:"0",flex:"1 1 auto"},children:s.jsx("div",{className:"d-grid gap-2 custom-fields-grid",children:p.length>0?p.map((B,L)=>s.jsxs(Y,{className:`border section-card ${S.fromIndex===L?"section-dragging":""} ${S.overIndex===L?S.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!d,onDragStart:K=>{if(d){K.preventDefault();return}E({fromIndex:L,overIndex:L,position:"above"}),K.dataTransfer.effectAllowed="move"},onDragOver:K=>{if(d||S.fromIndex===null||y.sectionIndex!==null)return;K.preventDefault();const fe=K.currentTarget.getBoundingClientRect(),ve=fe.top+fe.height/2,pe=K.clientY<ve?"above":"below";let be=L;pe==="below"&&S.fromIndex<L?be=L+1:pe==="above"&&S.fromIndex>L?be=L:pe==="below"&&S.fromIndex>L?be=L+1:pe==="above"&&S.fromIndex<L&&(be=L),(S.overIndex!==be||S.position!==pe)&&E(we=>({...we,overIndex:be,position:pe}))},onDrop:K=>{if(d||S.fromIndex===null||y.sectionIndex!==null)return;K.preventDefault();const fe=Math.max(0,Math.min(S.overIndex,p.length));O(S.fromIndex,fe),E({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{E({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:d?"default":"grab"},children:[s.jsxs(Y.Header,{className:`d-flex justify-content-between align-items-center section-header ${j[L]&&y.sectionIndex!==null&&y.sectionIndex!==L&&y.targetSectionIndex===L?"section-header-drop-target":""}`,onClick:()=>re(L),"aria-expanded":!j[L],onDragStart:K=>K.stopPropagation(),onDragOver:K=>{if(d||y.sectionIndex===null||y.sectionIndex===L||!j[L])return;const fe=p[y.sectionIndex],ve=p[L];fe.editBy===ve.editBy&&(K.preventDefault(),K.stopPropagation(),y.targetSectionIndex!==L&&b(pe=>({...pe,targetSectionIndex:L,overIndex:B.fields?.length||0,position:"below"})))},onDrop:K=>{if(d||y.sectionIndex===null||y.fromIndex===null||y.sectionIndex===L||!j[L])return;const fe=p[y.sectionIndex],ve=p[L];if(fe.editBy!==ve.editBy){te.warning('Cannot move fields between sections with different "Edit By" roles.'),b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null});return}K.preventDefault(),K.stopPropagation(),w(be=>({...be,[L]:!1}));const pe=B.fields?.length||0;ye(y.sectionIndex,y.fromIndex,L,pe),b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{padding:"0.75rem"},children:[s.jsxs("div",{className:"d-flex flex-column flex-grow-1",style:{minWidth:0,marginRight:"0.5rem"},children:[s.jsxs("div",{className:"section-title fw-bold d-flex align-items-center",style:{fontSize:"0.9rem"},children:[j[L]?s.jsx(Ac,{size:16,className:"flex-shrink-0"}):s.jsx(sn,{size:16,className:"flex-shrink-0"}),s.jsx("span",{className:"text-truncate ms-1",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:B.label,children:B.label}),s.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge flex-shrink-0",children:B.fields?.length||0})]}),s.jsxs("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:["Edit by: ",B.editBy]})]}),s.jsxs("div",{onClick:K=>K.stopPropagation(),className:"flex-shrink-0 d-flex gap-1",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>me(L),disabled:d,className:"custom-fields-add-field-btn",style:{whiteSpace:"nowrap",fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(yr,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Field"})]}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>V(L),disabled:d,title:"Edit Section",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(Ar,{size:12})})]})]}),!j[L]&&s.jsx(Y.Body,{className:`section-body ${y.sectionIndex!==null&&y.sectionIndex!==L&&y.targetSectionIndex===L?"section-drop-target":""}`,onDragOver:K=>{if(d||y.sectionIndex===null||y.sectionIndex===L)return;const fe=p[y.sectionIndex],ve=p[L];fe.editBy===ve.editBy&&(K.preventDefault(),K.stopPropagation(),y.targetSectionIndex!==L&&b(pe=>({...pe,targetSectionIndex:L,overIndex:B.fields?.length||0,position:"below"})))},onDrop:K=>{if(d||y.sectionIndex===null||y.fromIndex===null||y.sectionIndex===L)return;const fe=p[y.sectionIndex],ve=p[L];if(fe.editBy!==ve.editBy){te.warning('Cannot move fields between sections with different "Edit By" roles.'),b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null});return}K.preventDefault(),K.stopPropagation();const pe=B.fields?.length||0;ye(y.sectionIndex,y.fromIndex,L,pe),b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{minHeight:y.sectionIndex!==null&&y.sectionIndex!==L&&y.targetSectionIndex===L?"60px":"auto",transition:"all 0.2s ease"},children:B.fields&&B.fields.length>0?(()=>{const K=new Map;B.fields.forEach((Ne,Ie)=>{K.set(Ne,Ie)});const fe=[...B.fields].sort((Ne,Ie)=>Ne.displayOrder-Ie.displayOrder),ve=Ne=>Ne?.tempId||Ne?.fieldName||null,pe=Ne=>!!Ne.parentTempId,be=fe.filter(Ne=>!pe(Ne)),we=(Ne,Ie)=>{const Re=String(Ne.fieldType).toUpperCase()==="PART",Fe=String(Ne.fieldType).toUpperCase()==="CHECK_BOX",Ve=Re||Fe;return s.jsxs("div",{className:`p-2 p-md-2 rounded border mb-2 mb-md-2 draggable-item custom-field-item ${Ve?"bg-part part-card":"bg-white child-row"} ${y.sectionIndex!==null&&y.targetSectionIndex===L&&y.overIndex===Ie?"border-primary":""} ${y.sectionIndex!==null&&y.targetSectionIndex===L&&y.overIndex===Ie&&y.position==="above"?"drop-target-above":""} ${y.sectionIndex!==null&&y.targetSectionIndex===L&&y.overIndex===Ie&&y.position==="below"?"drop-target-below":""} ${y.sectionIndex===L&&y.fromIndex===Ie?"dragging":""}`,draggable:!0,style:{display:"block",visibility:"visible",opacity:1,cursor:"grab"},onDragStart:Je=>{b({sectionIndex:L,fromIndex:Ie,overIndex:Ie,position:"above",targetSectionIndex:L}),Je.dataTransfer.effectAllowed="move"},onDragOver:Je=>{Je.preventDefault();const pt=Je.currentTarget.getBoundingClientRect(),St=pt.top+pt.height/2,wt=Je.clientY<St?"above":"below";let Lr=Ie;wt==="below"&&(Lr=Ie+1),y.sectionIndex!==null&&(y.sectionIndex===L?y.overIndex!==Lr||y.position!==wt:y.targetSectionIndex!==L||y.overIndex!==Lr||y.position!==wt)&&b(Et=>({...Et,overIndex:Lr,position:wt,targetSectionIndex:L}))},onDrop:Je=>{if(Je.preventDefault(),!(y.sectionIndex===null||y.fromIndex===null)){if(y.sectionIndex===L){const pt=Math.max(0,Math.min(y.overIndex,p[L]?.fields?.length||0));he(L,y.fromIndex,pt)}else{const pt=Math.max(0,Math.min(y.overIndex,p[L]?.fields?.length||0));ye(y.sectionIndex,y.fromIndex,L,pt)}b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})}},onDragEnd:()=>b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2 gap-2",children:[s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsxs("div",{className:"fw-bold field-title d-flex align-items-center flex-wrap gap-1",style:{fontSize:"0.85rem",wordBreak:"break-word"},children:[s.jsx("span",{className:"text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:Ne.label,children:Ne.label}),Re&&s.jsx("span",{className:"badge part-badge flex-shrink-0",children:"PART"}),Fe&&s.jsx("span",{className:"badge part-badge flex-shrink-0",children:"CHECK_BOX"})]}),s.jsxs("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis"},title:`${Ne.fieldName} (${Ne.fieldType})`,children:[Ne.fieldName," (",Ne.fieldType,")"]})]}),s.jsxs("div",{className:"d-flex gap-1 flex-shrink-0",children:[s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>ge(L,Ie),disabled:d,title:"Edit Field",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(Ar,{size:12})}),String(Ne.fieldType).toUpperCase()!=="SECTION_CONTROL_TOGGLE"&&s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{const Je=[...p];if(Je[L].fields=Je[L].fields.filter((pt,St)=>St!==Ie),g(Je),r){const pt=Je.flatMap(St=>St.fields||[]);r(pt)}},disabled:d,title:"Remove Field",className:"text-danger border-danger",style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]})]}),s.jsxs("div",{className:"d-grid gap-1",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>a(ze(Ne)),disabled:d,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out",fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(Vd,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Insert Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Insert"})]}),String(Ne.fieldType).toUpperCase()==="PART"&&s.jsxs(ae,{variant:"outline-primary",size:"sm",className:"mt-0 text-primary border-primary",onClick:()=>ef(L,Ie,Ne),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(Vd,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field to PART"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Add to PART"})]}),String(Ne.fieldType).toUpperCase()==="CHECK_BOX"&&s.jsxs(ae,{variant:"outline-primary",size:"sm",className:"mt-0 text-primary border-primary",onClick:()=>wo(L,Ie,Ne),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(Vd,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field to CHECK_BOX"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Add to CHECK_BOX"})]})]}),(String(Ne.fieldType).toUpperCase()==="PART"||String(Ne.fieldType).toUpperCase()==="CHECK_BOX")&&(()=>{const Je=ve(Ne),pt=fe.filter(St=>St.parentTempId===Je);return pt.length?s.jsx("div",{className:"mt-2 part-children",children:pt.map(St=>{const wt=K.get(St)??B.fields.indexOf(St);return we(St,wt)})}):null})()]},`${L}-${Ie}`)};return s.jsx(s.Fragment,{children:be.map(Ne=>{const Ie=K.get(Ne)??B.fields.indexOf(Ne);return we(Ne,Ie)})})})():s.jsx(Ue,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},L)):s.jsx(Ue,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),s.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-2 mt-md-3 gap-2 flex-shrink-0",style:{borderTop:"1px solid #dee2e6",paddingTop:"0.75rem"},children:[s.jsxs(Ue,{variant:"info",className:"mb-0 custom-fields-tip",style:{fontSize:"0.75rem",padding:"0.5rem",flex:"1 1 auto",marginRight:"0.5rem"},children:[s.jsx("strong",{children:"Tip:"})," ",s.jsx("span",{className:"d-none d-sm-inline",children:"Create sections first, then add fields inside each section."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Create sections, then add fields."})]}),s.jsx(ae,{variant:"primary",size:"sm",onClick:Ke,disabled:st,className:"custom-fields-submit-btn flex-shrink-0",style:{whiteSpace:"nowrap",fontSize:"0.8rem",padding:"0.375rem 0.75rem"},children:st?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Submitting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"d-none d-sm-inline",children:"Submit Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Submit"})]})})]}),s.jsxs(se,{show:T,onHide:qe,centered:!0,size:"lg",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:I!==null?"Edit Section":"Add New Section"})}),s.jsx(se.Body,{children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"Display label",value:A.label,onChange:B=>M(L=>({...L,label:B.target.value})),required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{className:"text-primary-custom",children:"Edit By"}),s.jsx(_.Select,{value:A.editBy,onChange:B=>{const L=B.target.value;M(K=>({...K,editBy:L,roleInSubject:L==="TRAINEE"?"":K.roleInSubject}))},children:G.map(B=>s.jsx("option",{value:B,children:B},B))})]})}),A.editBy==="TRAINER"&&s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{className:"text-primary-custom",children:"Role In Subject"}),s.jsxs(_.Select,{value:A.roleInSubject||"ASSESSMENT_REVIEWER",onChange:B=>M(L=>({...L,roleInSubject:B.target.value})),style:{minWidth:"200px"},children:[s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT REVIEWER"}),s.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),A.editBy==="TRAINER"&&s.jsx(H,{md:12,children:s.jsxs(_.Group,{className:"d-flex flex-row align-items-center gap-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(_.Check,{type:"checkbox",checked:A.isSubmittable,onChange:B=>M(L=>({...L,isSubmittable:B.target.checked})),id:"section-submittable"}),s.jsx(_.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(_.Check,{type:"checkbox",checked:A.isToggleDependent,onChange:B=>M(L=>({...L,isToggleDependent:B.target.checked})),id:"section-toggle-dependent"}),s.jsx(_.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),s.jsxs(se.Footer,{children:[I!==null&&s.jsx(ae,{variant:"outline-danger",onClick:xe,className:"me-auto",children:"Remove Section"}),s.jsx(ae,{variant:"outline-secondary",onClick:qe,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:je,children:I!==null?"Update Section":"Save Section"})]})]}),s.jsxs(se,{show:z,onHide:qe,size:"lg",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Add New Field"})}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(Ue,{variant:"light",className:"py-2",children:["Adding field to section: ",s.jsx("strong",{children:I!==null?p[I]?.label:"N/A"})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Crew Communication",value:F.label,onChange:B=>P(L=>({...L,label:B.target.value})),required:!0}),s.jsx(_.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., crew_communication",value:F.fieldName,onChange:B=>P(L=>({...L,fieldName:B.target.value})),required:!0}),s.jsxs(_.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Select,{value:F.fieldType,onChange:B=>{const L=B.target.value;P(K=>({...K,fieldType:L,option:L==="VALUE_LIST"?K.option:null})),L!=="VALUE_LIST"&&(W([]),J(""))},required:!0,children:ie.map(B=>s.jsx("option",{value:B.value,children:B.label},B.value))})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",value:I!==null&&p[I]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(_.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),F.fieldType==="VALUE_LIST"&&s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(_.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:Z,onChange:B=>J(B.target.value),onKeyPress:B=>{if(B.key==="Enter"){B.preventDefault();const L=Z.trim();if(L){if(C.includes(L)){te.warning("This option already exists. Please enter a different value.");return}W(K=>[...K,L]),J("")}}}}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{const B=Z.trim();if(B){if(C.includes(B)){te.warning("This option already exists. Please enter a different value.");return}W(L=>[...L,B]),J("")}},disabled:!Z.trim(),children:s.jsx(yr,{size:14})})]}),C.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:C.map((B,L)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:B}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{W(K=>K.filter((fe,ve)=>ve!==L))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]},L))}),s.jsx(_.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:qe,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:Xe,children:"Save Field"})]})]}),s.jsxs(se,{show:U,onHide:qe,size:"lg",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Edit Field"})}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(Ue,{variant:"light",className:"py-2",children:["Editing field in section: ",s.jsx("strong",{children:I!==null?p[I]?.label:"N/A"})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Crew Communication",value:F.label,onChange:B=>P(L=>({...L,label:B.target.value})),required:!0}),s.jsx(_.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:F.fieldType==="PART"||F.fieldType==="CHECK_BOX"?"e.g., Assessment_Items":F.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:F.fieldName,onChange:B=>P(L=>({...L,fieldName:B.target.value})),required:!0}),s.jsx(_.Text,{className:"text-muted",children:F.fieldType==="PART"||F.fieldType==="CHECK_BOX"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':F.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),String(F.fieldType).toUpperCase()!=="SECTION_CONTROL_TOGGLE"&&s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Select,{value:F.fieldType,onChange:B=>{const L=B.target.value;P(K=>({...K,fieldType:L,option:L==="VALUE_LIST"?K.option:null})),L!=="VALUE_LIST"&&(W([]),J(""))},required:!0,children:ie.map(B=>s.jsx("option",{value:B.value,children:B.label},B.value))})]})}),!(F.parentTempId||F.parentId)&&s.jsx(H,{md:6,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",value:I!==null&&p[I]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(_.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),F.fieldType==="VALUE_LIST"&&s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(_.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:Z,onChange:B=>J(B.target.value),onKeyPress:B=>{if(B.key==="Enter"){B.preventDefault();const L=Z.trim();if(L){if(C.includes(L)){te.warning("This option already exists. Please enter a different value.");return}W(K=>[...K,L]),J("")}}}}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{const B=Z.trim();if(B){if(C.includes(B)){te.warning("This option already exists. Please enter a different value.");return}W(L=>[...L,B]),J("")}},disabled:!Z.trim(),children:s.jsx(yr,{size:14})})]}),C.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:C.map((B,L)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:B}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{W(K=>K.filter((fe,ve)=>ve!==L))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]},L))}),s.jsx(_.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:qe,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:Xe,children:"Update Field"})]})]}),s.jsxs(se,{show:et,onHide:()=>yt(!1),children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Insert Part Field"})}),s.jsx(se.Body,{children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(Ue,{variant:"light",className:"py-2",children:["Insert field into PART: ",s.jsxs("strong",{children:[lt?.label," (",lt?.fieldName,")"]})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Focus Item",value:Ce,onChange:B=>He(B.target.value)})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., focus_item",value:tt,onChange:B=>Ge(B.target.value)}),s.jsx(_.Text,{className:"text-muted",children:"snake_case only (Type is always TEXT for PART sub-fields)"})]})}),s.jsx(H,{md:12,children:s.jsx(_.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:()=>yt(!1),children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:tf,children:"Insert"})]})]}),s.jsxs(se,{show:Ta,onHide:()=>ws(!1),children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Insert CheckBox Field"})}),s.jsx(se.Body,{children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(Ue,{variant:"light",className:"py-2",children:["Insert field into CHECK_BOX: ",s.jsxs("strong",{children:[lr?.label," (",lr?.fieldName,")"]})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Focus Item",value:Yr,onChange:B=>Xn(B.target.value)})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., focus_item",value:kt,onChange:B=>xr(B.target.value)}),s.jsx(_.Text,{className:"text-muted",children:"snake_case only (Type is always TEXT for CHECK_BOX sub-fields)"})]})}),s.jsx(H,{md:12,children:s.jsx(_.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:()=>ws(!1),children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:rf,children:"Insert"})]})]})]})]})},r0=`${Hl.BASE_URL}/media/docs/onlyoffice/callback`,Hoe=v.forwardRef(({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,showMergeFields:a=!0,importType:n="",className:i="",initialSections:l=null,isUpdateRejected:o=!1,onHasUnsavedChangesChange:c,onDraftSaved:u},d)=>{const[m,f]=v.useState(!0),[h,x]=v.useState(null),[p,g]=v.useState(!1),[j,w]=v.useState([]),[y]=v.useState(!0),[b,S]=v.useState(!1),[E,N]=v.useState(!1),T=v.useRef(!1),k=v.useRef(!1),I=v.useRef(null),D=v.useRef(null),A=v.useRef(null);v.useImperativeHandle(d,()=>({downloadAs:(Te="docx")=>{if(I.current&&typeof I.current.downloadAs=="function")I.current.downloadAs(Te);else throw new Error("Editor is not ready or downloadAs method is not available")},save:()=>{if(I.current&&typeof I.current.save=="function")I.current.save();else throw new Error("Editor is not ready or save method is not available")},saveAndDownload:async(Te="docx")=>{if(!I.current)throw new Error("Editor is not ready");if(typeof I.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),I.current.save(),await new Promise(Ke=>setTimeout(Ke,1e3)),console.log(" save() completed")),typeof I.current.downloadAs=="function")console.log(" Step 2: Calling downloadAs() to get document URL..."),I.current.downloadAs(Te);else throw new Error("downloadAs method is not available")},buildAndSubmitDraftTemplate:async Te=>{if(C.current&&typeof C.current.buildAndSubmitDraftTemplate=="function")return await C.current.buildAndSubmitDraftTemplate(Te);throw new Error("buildAndSubmitDraftTemplate function is not available")}}),[]);const M=v.useRef(c),G=v.useRef(u);v.useEffect(()=>{M.current=c},[c]),v.useEffect(()=>{G.current=u},[u]),v.useEffect(()=>{T.current=b},[b]);const q=v.useRef(!1),z=v.useRef(null),ee=v.useRef(new Map);v.useEffect(()=>{const Te=setTimeout(()=>{M.current&&M.current(b)},0);return()=>clearTimeout(Te)},[b]);const[U,X]=v.useState(!1),[oe,Ee]=v.useState(null),[F,P]=v.useState([]),C=v.useRef(null),[W,Z]=v.useState([]),[J,le]=v.useState(!1),V=[{label:"Trainee's Full Name",variable:"{trainee_name}",fieldType:"TEXT"},{label:"Trainee's Eid",variable:"{trainee_eid}",fieldType:"TEXT"},{label:"Trainee's Nation",variable:"{trainee_nationality}",fieldType:"TEXT"},{label:"Trainee Passport Number",variable:"{trainee_passport_no}",fieldType:"TEXT"},{label:"Trainee's Batch Name",variable:"{training_batch}",fieldType:"TEXT"},{label:"Course's Name",variable:"{course_name}",fieldType:"TEXT"},{label:"Course's Code",variable:"{course_code}",fieldType:"TEXT"},{label:"Subject's Name",variable:"{subject_name}",fieldType:"TEXT"},{label:"Subject's Code",variable:"{subject_code}",fieldType:"TEXT"},{label:"Assessing date",variable:"{assessment_date}",fieldType:"TEXT"},{label:"Assessment Location",variable:"{assessment_venue}",fieldType:"TEXT"},{label:"Instructor's Full Name",variable:"{trainer_name}",fieldType:"TEXT"},{label:"Trainer's Eid",variable:"{trainer_eid}",fieldType:"TEXT"},{label:"Template Name",variable:"{template_name}",fieldType:"TEXT"}];v.useEffect(()=>{let Te=!0;return(async()=>{try{le(!0);const ze=await si.getGlobalFieldsDetail();Te&&Z(Array.isArray(ze)?ze:[])}catch(ze){console.error("Error loading global mapped fields:",ze),te.error("Failed to load global mapped fields"),Te&&Z([])}finally{Te&&le(!1)}})(),()=>{Te=!1}},[]);const re=v.useCallback(()=>{if(k.current=!1,I.current)try{typeof I.current.destroy=="function"&&I.current.destroy()}catch(Te){console.warn("Error destroying editor:",Te)}},[]);v.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const he="06afd75229ef45e496e4107659a4db9e",O=async Te=>{try{const ze=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),et=btoa(JSON.stringify(Te)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),yt=`${ze}.${et}`,lt=new TextEncoder,Me=await crypto.subtle.importKey("raw",lt.encode(he),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),ke=await crypto.subtle.sign("HMAC",Me,lt.encode(yt)),nt=btoa(String.fromCharCode(...new Uint8Array(ke))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),tt=`${ze}.${et}.${nt}`;return console.log(" Generated JWT Token (Hardcoded):",tt),tt}catch(Ke){return console.error("Error generating JWT token:",Ke),null}};v.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),f(!1);return}if(k.current){console.log(" Editor already initialized, skipping...");return}return k.current=!0,(async()=>{try{let Ke=0;const ze=10;await new Promise((Ce,He)=>{const Mt=()=>{typeof window.DocsAPI<"u"?Ce():Ke<ze?(Ke++,console.log(` Waiting for OnlyOffice API... (${Ke}/${ze})`),setTimeout(Mt,500)):He(new Error("OnlyOffice API failed to load after 5 seconds"))};Mt()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const yt=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;A.current=yt,console.log(" Generated documentKey for callback:",yt);const Me=await O({document:{key:yt,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"},callbackUrl:r0}}),ke=!0;ke&&console.log(" Adding callbackUrl:",r0);const nt={document:{fileType:"docx",key:yt,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},callbackUrl:ke?r0:void 0,mode:"edit"},token:Me,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),g(!0)},onDocumentReady:()=>{console.log(" Document is loaded"),S(!0),console.log(" Set hasUnsavedChanges = true (document ready, user can edit)")},onError:Ce=>{console.error(" OnlyOffice Error:",Ce),console.error(" Error details:",{errorCode:Ce.data?.errorCode,errorDescription:Ce.data?.errorDescription,error:Ce.data?.error,fullEvent:Ce}),te.error("Error loading document: "+(Ce.data?.errorDescription||Ce.data?.error||"Unknown error"))},onDocumentStateChange:Ce=>{if(console.log(" Document state changed:",Ce),console.log(" Event data:",Ce.data),Ce.data!==void 0&&Ce.data!==null){const He=Ce.data;console.log(" Document state value:",He),He===1?(console.log(" Marking document as having unsaved changes"),S(!0)):(He===0||He===3)&&console.log(" Document state: ready/saved (state:",He,")")}},onInfo:Ce=>{console.log(" OnlyOffice opened in mode:",Ce.data?.mode)},onDownloadAs:async Ce=>{try{const He=Ce?.data||{};console.log(""),console.log(" OnlyOffice Event: onDownloadAs"),console.log(""),console.log(" Event data received:",JSON.stringify(He,null,2));const Mt=He.url||He.downloadUrl||He.fileUrl||(Array.isArray(He.files)?He.files[0]?.url:void 0)||He.file&&He.file.url;if(Mt){if(z.current){console.log(" This is a Submit flow - resolving Promise with URL");const Nr=A.current,dt=Mt.match(/doc-([^_/]+)/),kt=dt?dt[1]:null;if(Nr&&kt){const Yr=Nr,Xn=`doc-${kt}`;Yr!==Xn&&(console.log(" Warning: URL documentKey does not match current, but resolving anyway (resolver exists)"),console.log(`   Current: ${Yr}, URL: ${Xn}`),console.log("   This can happen during hot reload - resolving anyway because resolver exists"))}const xr=z.current;z.current=null,xr.resolve(Mt),S(!1);return}if(q.current){console.log(" onDownloadAs event during Submit but no resolver - ignoring (likely from old instance)");return}try{const Nr=sessionStorage.getItem("onlyoffice_submitting")==="true",dt=sessionStorage.getItem("onlyoffice_submit_docKey");if(Nr&&dt){let kt=null;const xr=Mt.match(/[?&]shardkey=([^&]+)/);if(xr)kt=xr[1];else{const Yr=Mt.match(/doc-([^_/]+)/);Yr&&(kt=`doc-${Yr[1]}`)}if(kt&&dt===kt){console.log(" onDownloadAs: Ignoring Draft save - Submit in progress (sessionStorage check)"),console.log(`   Submit docKey: ${dt}, URL docKey: ${kt}`);return}}}catch(Nr){console.warn(" Error checking sessionStorage in onDownloadAs:",Nr)}const Ls=A.current,Ta=Mt.match(/doc-([^_/]+)/),ws=Ta?Ta[1]:null;if(Ls&&ws){const Nr=Ls,dt=`doc-${ws}`;if(Nr!==dt){console.log(" onDownloadAs event ignored - URL from old documentKey instance (Draft flow)"),console.log(`   Current: ${Nr}, URL: ${dt}`);return}}const lr=Date.now(),qa=ee.current.get(Mt);if(qa&&lr-qa<2e3){console.log(" Duplicate onDownloadAs event ignored (debounced):",Mt.substring(0,50)+"...");return}ee.current.set(Mt,lr);for(const[Nr,dt]of ee.current.entries())lr-dt>5e3&&ee.current.delete(Nr);console.log(" Download URL received:",Mt),console.log(" This is a Draft save - calling onDraftSaved callback"),G.current&&typeof G.current=="function"&&G.current(Mt),S(!1)}else if(console.warn(" onDownloadAs received but no URL found in payload"),q.current&&z.current){const Ls=z.current;z.current=null,Ls.reject(new Error("No URL found in onDownloadAs event"))}else q.current||te.warning("Draft saved but URL not found")}catch(He){console.error(" Error in onDownloadAs handler:",He),te.error("Error processing draft save")}},onRequestSaveAs:async Ce=>{try{const He=Ce?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSaveAs"),console.log(""),console.log(" Event data received:",JSON.stringify(He,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server"),S(!1);const Mt=He.url||He.downloadUrl||He.fileUrl||(Array.isArray(He.files)?He.files[0]?.url:void 0)||He.file&&He.file.url;console.log(" Extracted temporary DOCX URL:",Mt),Mt||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(He,null,2))),D.current&&(Mt?D.current.resolve(Mt):D.current.reject(new Error("onRequestSaveAs event received but no URL found")),D.current=null),console.log("")}catch(He){console.error(" Error in onRequestSaveAs handler:",He),D.current&&(D.current.reject(He),D.current=null)}},onRequestSave:Ce=>{try{const He=Ce?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSave"),console.log(""),console.log(" Event data received:",JSON.stringify(He,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const Mt=He.url||He.downloadUrl||He.fileUrl;Mt&&D.current&&(console.log(" Using URL from onRequestSave:",Mt),D.current.resolve(Mt),D.current=null),console.log("")}catch(He){console.error(" Error in onRequestSave handler:",He)}}}},tt=new window.DocsAPI.DocEditor("onlyoffice-editor",nt);x(tt),I.current=tt,f(!1);const Ge=Ce=>{Ce.data&&Ce.data.type==="insertText"&&console.log(" Received insert text message:",Ce.data)};return window.addEventListener("message",Ge,{passive:!0}),()=>{window.removeEventListener("message",Ge)}}catch(Ke){console.error("Error initializing OnlyOffice editor:",Ke),te.error("Failed to initialize editor"),f(!1)}})(),re},[e,t,re]);const ye=Te=>{if(h&&p)try{if(typeof h.createConnector=="function")try{const Ke=h.createConnector();if(typeof h.asc_enableKeyEvents=="function")try{h.asc_enableKeyEvents(!0)}catch{}if(Ke&&Ke.isConnected)try{Asc.scope.__templateText=typeof Te=="string"&&Te.includes("{")?Te:`{${Te}}`,Ke.callCommand(function(){try{const ze=Api.GetDocument();let et=null;try{const lt=ze.GetCurrentSentence(),Me=lt&&typeof lt=="string"?lt.trim():"";if(Me&&Me.length>0)try{const ke=ze.Search(Me);if(ke&&ke.length>0&&ke.length<10){const nt=ke[0];try{const tt=nt.GetParagraph(0);try{et=nt.GetTextPr()}catch{try{const Ge=tt.GetElementsCount();if(Ge>0){const Ce=tt.GetElement(Ge-1);Ce&&Ce.GetTextPr&&(et=Ce.GetTextPr())}}catch{}}}catch{}}}catch{}}catch{}const yt=Api.CreateParagraph();if(et){const lt=Api.CreateRun();lt.AddText(Asc.scope.__templateText),lt.SetTextPr(et),yt.AddElement(lt)}else{const lt=Api.CreateTextPr();lt.SetBold(!1);const Me=Api.CreateRun();Me.AddText(Asc.scope.__templateText),Me.SetTextPr(lt),yt.AddElement(Me)}ze.InsertContent([yt],!0)}catch{const ze=Api.GetDocument(),et=Api.CreateParagraph();et.AddText(Asc.scope.__templateText),ze.InsertContent([et],!0)}},function(){},function(ze){console.error(" Insert field error:",ze),te.error("Failed to insert field: "+(ze?.message||"Unknown error"))});return}catch{te.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(Ke){console.error("Error inserting field:",Ke),te.error("Failed to insert field: "+Ke.message)}else h?p||te.warning("Editor is still loading, please wait..."):te.warning("Editor not initialized yet")},de=v.useCallback(()=>A.current,[]),je=Te=>{if(!Te||!Te.variable)return;const Ke={...Te,fieldType:Te.fieldType||"TEXT",roleRequired:Te.roleRequired||"TRAINER",options:Te.options||null};if(Ee(Ke),C.current&&typeof C.current.getSections=="function"){const ze=C.current.getSections();ze&&ze.length>0?(P(ze),X(!0)):te.warning("Please create a section first before adding system fields")}else te.warning("Custom Fields Panel is not ready. Please wait...")},xe=Te=>{if(!Te)return;const Ke=Te.fieldName||Te.name;if(!Ke){te.warning("Global field is missing a field name");return}const ze=Ke.startsWith("{")&&Ke.endsWith("}")?Ke:`{${Ke}}`,et={label:Te.label||Ke,variable:ze,fieldType:Te.fieldType||"TEXT",roleRequired:Te.roleRequired||"TRAINER",options:Te.options||null,originalField:Te,children:Te.children||null};je(et)},me=Te=>{if(!(!oe||Te===null||Te<0))if(C.current&&typeof C.current.addSystemField=="function"){const Ke=oe.variable.replace(/[{}]/g,""),ze=oe.fieldType||"TEXT",et=String(ze).toUpperCase(),yt=oe.children&&Array.isArray(oe.children)&&oe.children.length>0&&(et==="PART"||et==="CHECK_BOX"),lt=et==="PART"||et==="CHECK_BOX"?`${Ke}-parent`:null,Me={label:oe.label,fieldName:Ke,fieldType:ze,roleRequired:oe.roleRequired||"TRAINER",displayOrder:1,...oe.options?{options:oe.options}:{},...lt?{tempId:lt}:{}};if(!C.current.addSystemField(Te,Me))return;if(yt){const nt=oe.children;let tt=!0;nt.forEach((Ge,Ce)=>{const He=Ge.fieldName||Ge.name;if(!He){console.warn(`Child field at index ${Ce} is missing fieldName, skipping`);return}const Mt={label:Ge.label||He,fieldName:He,fieldType:"TEXT",roleRequired:oe.roleRequired||"TRAINER",displayOrder:1,parentTempId:lt};C.current.addSystemField(Te,Mt)||(tt=!1,console.warn(`Failed to add child field: ${He}`))}),tt||te.warning("Parent field added, but some children failed to add")}X(!1),Ee(null)}else console.error(" [Add Field] addSystemField function not available"),te.error("Failed to add field to section")},$e=v.useCallback(async()=>{try{if(!I.current||!p)throw new Error("Editor not ready");const Te=A.current;if(!Te)throw new Error("Document key not found");q.current=!0;try{sessionStorage.setItem("onlyoffice_submitting","true"),sessionStorage.setItem("onlyoffice_submit_docKey",Te),console.log(" Submit state saved to sessionStorage")}catch(ze){console.warn(" Failed to set sessionStorage:",ze)}if(console.log(" Starting callback flow (Submit)..."),console.log(` DocumentKey: ${Te}`),console.log(` Callback URL: ${Hl.BASE_URL}/media/docs/onlyoffice/callback`),console.log(" Step 1: Saving all changes first (auto Ctrl+S)..."),typeof I.current.save=="function")try{I.current.save(),await new Promise(ze=>setTimeout(ze,2e3)),console.log(" All changes saved successfully")}catch(ze){console.warn(" save() failed:",ze)}console.log(" Step 2: Triggering downloadAs() and waiting for URL from event..."),z.current=null;const Ke=new Promise((ze,et)=>{z.current={resolve:ze,reject:et},setTimeout(()=>{z.current&&(z.current.reject(new Error("Timeout waiting for download URL")),z.current=null)},15e3)});if(typeof I.current.downloadAs=="function")try{I.current.downloadAs("docx"),console.log(" downloadAs() triggered - waiting for URL from onDownloadAs event...")}catch(ze){console.warn(" downloadAs() failed:",ze),z.current&&(z.current.reject(new Error("Failed to trigger downloadAs()")),z.current=null),q.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(et){console.warn(" Failed to clear sessionStorage:",et)}throw new Error("Failed to trigger downloadAs()")}else{z.current&&(z.current.reject(new Error("downloadAs method is not available")),z.current=null),q.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(ze){console.warn(" Failed to clear sessionStorage:",ze)}throw new Error("downloadAs method is not available")}console.log(" Waiting for URL from onDownloadAs event...");try{const ze=await Ke;if(ze){console.log(" URL received from onDownloadAs event:",ze),S(!1),q.current=!1,z.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage")}catch(et){console.warn(" Failed to clear sessionStorage:",et)}return ze}else{console.warn(" No URL received from onDownloadAs event"),te.warning("Could not get document URL"),q.current=!1,z.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(et){console.warn(" Failed to clear sessionStorage:",et)}return null}}catch(ze){console.error(" Error waiting for URL from onDownloadAs:",ze),te.error(`Failed to get document URL: ${ze.message}`),q.current=!1,z.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (error)")}catch(et){console.warn(" Failed to clear sessionStorage:",et)}throw ze}}catch(Te){console.error(" Force save and poll failed:",Te),te.error(`Failed: ${Te.message}`),q.current=!1,z.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (outer catch)")}catch(Ke){console.warn(" Failed to clear sessionStorage:",Ke)}throw Te}},[p]),Xe=v.useCallback(()=>new Promise((Te,Ke)=>{try{if(!I.current){Ke(new Error("Editor not initialized"));return}if(D.current={resolve:Te,reject:Ke},typeof I.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{I.current.downloadDocument()}catch(ze){console.warn("downloadDocument() failed, trying downloadAs()...",ze)}}if(typeof I.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{I.current.downloadAs("docx")}catch(ze){console.warn("downloadAs() failed:",ze)}}if(typeof I.current.save=="function"){console.log(" Attempting export via save()...");try{I.current.save()}catch(ze){console.warn("save() failed:",ze)}}setTimeout(()=>{if(D.current){const ze=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");D.current.reject(ze),D.current=null}},2e4)}catch(ze){D.current?(D.current.reject(ze),D.current=null):Ke(ze)}}),[]),ge=v.useCallback(async()=>{try{if(!I.current||!p)throw new Error("Editor not ready");const Te=await Xe();if(!Te)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",Te);const Ke=await fetch(Te);if(!Ke.ok)throw new Error(`Failed to fetch file: ${Ke.statusText}`);const ze=await Ke.blob();console.log(" Downloaded blob:",ze.size,"bytes");const et=t.endsWith(".docx")?t:`${t}.docx`,yt=new File([ze],et,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),lt=an.getDocsType(et)||"tem",Me=await an.uploadDocument(yt,lt);console.log(" Upload API response:",Me);let ke=null;if(Me?.data?.[0]?.url?(ke=Me.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",ke)):Me?.data?.url?(ke=Me.data.url,console.log(" Found S3 URL in uploadResult.data.url:",ke)):Me?.url?(ke=Me.url,console.log(" Found S3 URL in uploadResult.url:",ke)):Me?.fileUrl?(ke=Me.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",ke)):Me?.path&&(ke=Me.path,console.log(" Found S3 URL in uploadResult.path:",ke)),!ke)throw console.error(" Upload response structure:",JSON.stringify(Me,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",ke),console.log(" Full S3 URL:",ke),ke}catch(Te){throw console.error(" Export and upload failed:",Te),te.error(`Failed: ${Te.message}`),Te}},[Xe,t,p]);if(m)return s.jsx(Y,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(Y.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),s.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Content:"," ",e?"Available":"Not available"]})]})})});if(!e)return s.jsx(Y,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(Y.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsx("div",{className:"text-center",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx("strong",{children:"No Document URL"}),s.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const qe=Te=>{Array.isArray(Te)?w(Te):w(Ke=>[...Ke,Te])},st=Te=>{w(Ke=>Ke.filter((ze,et)=>et!==Te))};return s.jsxs(s.Fragment,{children:[E&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Submitting template..."})]})}),s.jsxs("div",{className:`onlyoffice-form-editor ${i}`,style:{position:"relative"},children:[s.jsx("div",{className:"p-0",children:s.jsxs(ue,{className:"g-0",style:{minHeight:"90vh"},children:[s.jsx(H,{xs:12,md:a&&y?9:12,className:"editor-col",style:{order:1},children:s.jsxs("div",{className:"p-3 editor-wrapper",style:{height:"90vh",position:"relative"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2 flex-wrap mb-2",children:[s.jsxs(Ct,{children:[s.jsx(Ct.Toggle,{variant:"outline-primary",size:"sm",id:"global-mapped-field-dropdown",disabled:J,children:J?"Loading Global Fields...":"Global Field"}),s.jsx(Ct.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:J?s.jsx(Ct.ItemText,{className:"text-muted",children:"Loading..."}):W.length===0?s.jsx(Ct.ItemText,{className:"text-muted",children:"No global fields available"}):W.map(Te=>s.jsx(Ct.Item,{onClick:()=>xe(Te),children:Te.label||Te.fieldName},Te.id||Te.fieldName))})]}),s.jsxs(Ct,{children:[s.jsx(Ct.Toggle,{variant:"outline-primary",size:"sm",id:"system-mapped-field-dropdown",children:"System Mapped Field"}),s.jsx(Ct.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:V.map((Te,Ke)=>s.jsx(Ct.Item,{onClick:()=>je(Te),children:Te.label},`system-field-${Ke}`))})]})]}),s.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),a&&y&&s.jsx(H,{xs:12,md:3,className:"border-start border-md-start custom-fields-col",style:{order:2},children:s.jsx("div",{className:"custom-fields-wrapper",style:{height:"90vh",overflowY:"auto",overflowX:"hidden"},children:s.jsx(Woe,{customFields:j,onAddField:qe,onRemoveField:st,onInsertField:ye,initialSections:l,exportEditedDoc:Xe,exportAndUploadEditedDoc:ge,forceSaveAndPoll:$e,getDocumentKey:de,addSystemFieldToSectionRef:C,readOnly:r,className:"h-100",onSubmittingChange:N,isUpdateRejected:o})})})]})}),s.jsxs(se,{show:U,onShow:()=>{if(C.current&&typeof C.current.getSections=="function"){const Te=C.current.getSections();P(Te||[])}},onHide:()=>{X(!1),Ee(null)},centered:!0,className:"system-field-modal",children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(se.Title,{className:"text-white mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Select Section"})}),s.jsxs(se.Body,{style:{padding:"1.5rem"},children:[oe&&s.jsxs("div",{className:"mb-4 p-3 rounded",style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral-200)"},children:[s.jsx("p",{className:"mb-2 text-primary-custom",style:{fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Field to add:"}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{style:{fontSize:"0.875rem",color:"var(--bs-secondary)",fontWeight:500},children:"Label: "}),s.jsx("span",{style:{fontSize:"1rem",fontWeight:600,color:"var(--bs-dark)"},children:oe.label})]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{style:{fontSize:"0.875rem",color:"var(--bs-secondary)",fontWeight:500},children:"Field Name: "}),s.jsx("code",{className:"d-inline-block px-2 py-1 rounded",style:{fontSize:"0.875rem",backgroundColor:"var(--bs-neutral-100)",color:"var(--bs-primary)",border:"1px solid var(--bs-neutral-300)",fontWeight:500},children:oe.variable.replace(/[{}]/g,"")})]}),s.jsxs("div",{className:"mb-0",children:[s.jsx("span",{style:{fontSize:"0.875rem",color:"var(--bs-secondary)",fontWeight:500},children:"Field Type: "}),s.jsx("span",{className:"badge",style:{fontSize:"0.875rem",backgroundColor:"var(--bs-info)",color:"white",fontWeight:500,padding:"0.375rem 0.75rem"},children:oe.fieldType||"TEXT"})]})]}),s.jsx("p",{className:"mb-3",style:{fontSize:"0.95rem",color:"var(--bs-dark)",fontWeight:500},children:"Choose a section to add this field:"}),F.length>0?s.jsx("div",{className:"d-grid gap-2",style:{maxHeight:"400px",overflowY:"auto"},children:F.map((Te,Ke)=>s.jsx("button",{type:"button",className:"section-select-btn",onClick:()=>me(Ke),style:{padding:"1rem 1.25rem",border:"2px solid var(--bs-neutral-200)",borderRadius:"0.5rem",backgroundColor:"var(--bs-light)",textAlign:"left",transition:"all 0.3s ease",cursor:"pointer",width:"100%"},onMouseEnter:ze=>{ze.currentTarget.style.borderColor="var(--bs-primary)",ze.currentTarget.style.backgroundColor="rgba(27, 60, 83, 0.05)",ze.currentTarget.style.transform="translateY(-2px)",ze.currentTarget.style.boxShadow="0 4px 12px rgba(27, 60, 83, 0.15)"},onMouseLeave:ze=>{ze.currentTarget.style.borderColor="var(--bs-neutral-200)",ze.currentTarget.style.backgroundColor="var(--bs-light)",ze.currentTarget.style.transform="translateY(0)",ze.currentTarget.style.boxShadow="none"},children:s.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{className:"mb-1",style:{fontSize:"1rem",fontWeight:600,color:"var(--bs-primary)"},children:Te.label||Te.name}),s.jsx("div",{className:"d-flex align-items-center gap-2 mt-2",style:{fontSize:"0.875rem"},children:s.jsx("span",{className:"badge rounded-pill px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",color:"white",fontSize:"0.75rem",fontWeight:500},children:Te.editBy||"TRAINER"})})]}),s.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minWidth:"60px",height:"60px",borderRadius:"0.375rem",backgroundColor:"var(--bs-primary)",color:"white",fontSize:"1.25rem",fontWeight:700},children:Te.fields?.length||0})]})},Ke))}):s.jsxs(Ue,{variant:"warning",className:"mb-0",style:{backgroundColor:"#fff3cd",borderColor:"#ffc107",color:"#856404",borderRadius:"0.5rem",padding:"1rem"},children:[s.jsx("strong",{children:"No sections available."})," Please create a section first."]})]}),s.jsx(se.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:s.jsx(ae,{variant:"secondary",onClick:()=>{X(!1),Ee(null)},style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:Te=>{Te.currentTarget.style.backgroundColor="#3a5a6f",Te.currentTarget.style.borderColor="#3a5a6f",Te.currentTarget.style.transform="translateY(-1px)",Te.currentTarget.style.boxShadow="0 4px 8px rgba(69, 104, 130, 0.3)"},onMouseLeave:Te=>{Te.currentTarget.style.backgroundColor="var(--bs-secondary)",Te.currentTarget.style.borderColor="var(--bs-secondary)",Te.currentTarget.style.transform="translateY(0)",Te.currentTarget.style.boxShadow="none"},children:"Cancel"})})]})]})]})}),Voe=({onSuccess:e,className:t=""})=>{const[r,a]=v.useState(!1),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1),d=v.useRef(null),m=()=>{a(!0),i(null),d.current&&(d.current.value="")},f=()=>{a(!1),i(null),d.current&&(d.current.value="")},h=y=>{const b=y.target.files[0];if(b){const S=[".docx"],E=b.name.toLowerCase().substring(b.name.lastIndexOf("."));if(!S.includes(E)){te.error("Please select a valid Word document file (.docx)");return}if(b.size>10*1024*1024){te.error("File size must be less than 10MB");return}i(b)}},x=async y=>{try{u(!0),console.log(" Validating file has no fields:",y);const{data:b}=await Se.post("/templates/extract-fields-from-url",{url:y}),S=b?.fields||b||[],E=Array.isArray(S)&&S.length>0;return console.log(" Validation result:",{hasFields:E,fieldCount:S.length}),!E}catch(b){return console.error(" Error validating file:",b),!1}finally{u(!1)}},p=async y=>{if(!y){console.log(" No mediaId provided, skipping delete");return}try{console.log(" Deleting old file with mediaId:",y),console.log(" Calling DELETE /media/objects with body:",{key:y});const b=await Se.delete("/media/objects",{data:{key:y}});return console.log(" Old file deleted successfully!",b.data),!0}catch(b){return console.error(" Error deleting old file:",b),console.error(" Error response:",b.response?.data),!1}},g=async()=>{if(!n){te.error("Please select a file");return}o(!0);let y=null,b=null;try{const S=Ya(),E=S.templateContentMediaId;if(E){console.log(" Replacing existing template content, deleting old file...");const D=await p(E);console.log(D?" Old file deleted successfully before upload":" Failed to delete old file, but continuing with upload")}else console.log(" Adding new template content (no old file to delete)");console.log(" Uploading file to S3 for validation...");const N=an.getDocsType(n.name),T=await an.uploadDocument(n,N);if(T.data&&T.data.length>0)y=T.data[0].url,b=T.data[0].id||T.data[0].mediaId||null,console.log(" File uploaded successfully! URL:",y),b?console.log(" MediaId from response:",b):console.log(" No mediaId in response, will try to extract from URL if needed");else throw new Error("Invalid response format from upload API");if(console.log(" Validating file has no fields..."),!await x(y)){if(console.log(" File contains fields, deleting uploaded file..."),b){const D=await p(b);console.log(D?" Invalid file deleted successfully":" Failed to delete invalid file")}else console.log(" No mediaId to delete invalid file");te.error("File contains fields. Please upload a file without fields."),o(!1);return}console.log(" File validation passed! Saving to localStorage...");const I={...S,templateContent:y,templateContentMediaId:b};localStorage.setItem("templateInfo",JSON.stringify(I)),console.log(" templateContent saved:",y),b&&console.log(" templateContentMediaId saved:",b),te.success("Template content uploaded and validated successfully!"),e&&e(y),f()}catch(S){if(console.error(" Error uploading/validating file:",S),b){console.log(" Attempting to clean up uploaded file due to error...");try{await p(b),console.log(" Cleaned up uploaded file")}catch(E){console.error(" Failed to clean up uploaded file:",E)}}te.error("Failed to upload file: "+(S.message||"Unknown error"))}finally{o(!1)}},w=!!Ya().templateContent;return s.jsxs(s.Fragment,{children:[s.jsxs(ae,{variant:"outline-light",size:"sm",onClick:m,className:`d-flex align-items-center gap-2 ${t}`,style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",y.currentTarget.style.borderColor="#fff"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",y.currentTarget.style.borderColor="#fff"},title:w?"Original template already uploaded. Click to replace.":"Upload original template (file without fields)",children:[s.jsx(js,{size:16}),w?"Replace Original Template":"Original Template"]}),s.jsxs(se,{show:r,onHide:f,centered:!0,size:"lg",children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(oi,{className:"me-2",size:20}),w?"Replace Original Template":"Original Template"]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs(Ue,{variant:"info",className:"mb-4",children:[s.jsx("strong",{children:"Important:"})," Please upload a Word document (.docx) that does ",s.jsx("strong",{children:"not"})," contain any form fields. The system will automatically validate this before saving."]}),s.jsxs(_,{children:[s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Select File ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{ref:d,type:"file",accept:".docx",onChange:h,className:"mb-2"}),s.jsx(_.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]}),n&&s.jsx(Ue,{variant:"info",className:"mt-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oi,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",n.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(n.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"outline-secondary",onClick:f,disabled:l||c,children:"Cancel"}),s.jsx(ae,{variant:"primary-custom",onClick:g,disabled:!n||l||c,children:l||c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c?"Validating...":"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),w?"Replace":"Upload"]})})]})]})]})},Goe=()=>{const e=ft(),t=na(),[r,a]=v.useState(""),[n,i]=v.useState("Untitled Document"),[l,o]=v.useState(""),[c,u]=v.useState(null),[d,m]=v.useState(!1),[f,h]=v.useState({name:"",description:"",departmentId:""}),[x,p]=v.useState([]),[g,j]=v.useState(!1),[w,y]=v.useState(!1),[b,S]=v.useState(!1),[E,N]=v.useState(!1),[T,k]=v.useState(!1),I=v.useRef(null);v.useEffect(()=>{console.log(" hasUnsavedChanges changed:",w)},[w]);const[D,A]=v.useState(null),[M,G]=v.useState(!1),[q,z]=v.useState(!1),ee=()=>{try{localStorage.removeItem("currentTemplateId");const Z=Ya();if(Z.currentTemplateId){const J={...Z,currentTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(J)),console.log(" Cleared currentTemplateId from localStorage")}}catch(Z){console.error("Error clearing currentTemplateId:",Z)}};v.useEffect(()=>()=>{q?console.log(" FormEditorPage unmounting - preserving currentTemplateId (Edit Draft flow)"):(console.log(" FormEditorPage unmounting - clearing currentTemplateId"),ee())},[q]),v.useEffect(()=>{(async()=>{if(t.state){const{content:J,documentUrl:le,fileName:V,importType:re,templateInfo:he,initialSections:O,isUpdateRejected:ye,isEditDraft:de,templateId:je}=t.state;if(ye&&je){G(!0);try{console.log(` Update Rejected Template flow - Fetching data for templateId: ${je}`);const xe=await Dt.getTemplateById(je),me=xe?.data?.template||xe?.data?.data?.template||xe?.data;if(!me){te.error("Failed to load rejected template data."),e(Pe.TEMPLATES);return}const $e=me.templateConfig||me.templateContent||"",Xe={currentTemplateId:me.id,originalTemplateId:null,name:me.name,description:me.description,departmentId:me.departmentId,templateContent:me.templateContent,templateConfig:me.templateConfig,editorDocumentUrl:$e};if(localStorage.setItem("templateInfo",JSON.stringify(Xe)),localStorage.setItem("currentTemplateId",me.id),console.log(" Fresh metadata for rejected template saved to localStorage:",Xe),a($e),i(Xe.name),o("Update Rejected Template"),u(Xe),h({name:Xe.name,description:Xe.description,departmentId:Xe.departmentId}),me.sections&&Array.isArray(me.sections)){const ge=Zm(me.sections);A(ge)}}catch(xe){console.error("Error handling update rejected flow:",xe),te.error("An error occurred while loading the rejected template."),e(Pe.TEMPLATES)}}else{let xe=le||J||"";if(he?.editorDocumentUrl&&(xe=he.editorDocumentUrl),re==="Create Version"&&!xe&&(xe=he?.templateConfig||he?.templateContent||""),de&&he?.id){console.log(" Edit Draft flow - Syncing currentTemplateId from navigation state:",he.id),z(!0);const me=Ya(),$e={...me,id:he.id,currentTemplateId:he.currentTemplateId||he.id,name:he.name||me.name,description:he.description||me.description,departmentId:he.departmentId||me.departmentId};localStorage.setItem("templateInfo",JSON.stringify($e)),localStorage.setItem("currentTemplateId",he.currentTemplateId||he.id),console.log(" Synced currentTemplateId for Edit Draft flow:",$e.currentTemplateId),u($e)}else z(!1);G(!1),a(xe),i(V||"Untitled Document"),o(re||""),(!de||!he?.id)&&u(he||null),O&&Array.isArray(O)&&A(O),he&&h({name:he.name||"",description:he.description||"",departmentId:he.departmentId||""})}console.log(" FormEditorPage received:",{documentUrl:le,content:J,fileName:V,templateInfo:he,initialSections:O,isUpdateRejected:ye,templateId:je})}})()},[t.state,e]),v.useEffect(()=>{d&&U()},[d]);const U=async()=>{try{j(!0);const Z=await Ht.getDepartments();p(Z)}catch(Z){console.error("Error loading departments:",Z),te.error("Failed to load departments"),p([])}finally{j(!1)}},X=()=>{c&&h({name:c.name||"",description:c.description||"",departmentId:c.departmentId||""}),m(!0)},oe=()=>{m(!1)},Ee=()=>{if(!f.name||!f.description||!f.departmentId){te.error("Please fill in all required fields");return}const Z={...c,name:f.name,description:f.description,departmentId:f.departmentId};u(Z);try{const J=localStorage.getItem("templateInfo");if(J){const V={...JSON.parse(J),name:f.name,description:f.description,departmentId:f.departmentId};localStorage.setItem("templateInfo",JSON.stringify(V))}}catch(J){console.error("Error updating localStorage:",J)}te.success("Template information updated successfully"),m(!1)},F=()=>{console.log(" Back button clicked, hasUnsavedChanges:",w),w?(console.log(" Showing discard modal"),S(!0)):(console.log(" No unsaved changes, navigating back"),ee(),e(Pe.TEMPLATES))},P=()=>{S(!1),y(!1),ee(),e(Pe.TEMPLATES)},C=()=>{S(!1)},W=async()=>{if(!I.current){te.warning("Editor is not ready yet. Please wait...");return}N(!0);try{typeof I.current.saveAndDownload=="function"?await I.current.saveAndDownload("docx"):(typeof I.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),I.current.save(),await new Promise(Z=>setTimeout(Z,1e3))),typeof I.current.downloadAs=="function"&&(console.log(" Step 2: Calling downloadAs() to get document URL..."),I.current.downloadAs("docx")))}catch(Z){console.error(" Error saving draft:",Z),te.error("Failed to save draft: "+(Z.message||"Unknown error")),N(!1)}};return s.jsx(Nt,{permission:De.CREATE_TEMPLATE,fallback:s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:s.jsxs(Be,{fluid:!0,className:"py-4 form-editor-page form-component",style:{position:"relative"},children:[E&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Saving draft..."})]})}),s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"border-neutral-200 form-editor-header bg-primary",children:s.jsxs(ue,{className:"align-items-center",children:[s.jsx(H,{xs:12,md:8,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ae,{variant:"outline-light",onClick:F,className:"me-3",size:"sm",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",Z.currentTarget.style.borderColor="#fff"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",Z.currentTarget.style.borderColor="#fff"},children:s.jsx(Bt,{size:16})}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0 text-white",children:c?.name||n}),l&&s.jsxs("small",{className:"text-white",style:{opacity:.9},children:["Import Type: ",l]})]}),c&&s.jsx(ae,{variant:"outline-light",size:"sm",onClick:X,className:"ms-2",title:"Edit Template Information",children:s.jsx(Ar,{size:14})})]})]})}),s.jsxs(H,{xs:12,md:4,className:"d-flex justify-content-end align-items-center gap-2 mt-2 mt-md-0",children:[l==="File with fields"&&s.jsx(Voe,{onSuccess:Z=>{console.log(" Template content uploaded:",Z)}}),!M&&s.jsx(ae,{variant:"outline-light",size:"sm",onClick:W,disabled:E,className:"d-flex align-items-center gap-2",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:Z=>{E||(Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",Z.currentTarget.style.borderColor="#fff")},onMouseLeave:Z=>{E||(Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",Z.currentTarget.style.borderColor="#fff")},children:E?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{size:16}),s.jsx("span",{children:"Save Draft"})]})}),s.jsx(ae,{variant:"outline-light",size:"sm",onClick:()=>k(!0),className:"d-flex align-items-center justify-content-center text-white",style:{borderWidth:"2px",fontWeight:"700",fontSize:"18px",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",width:"36px",height:"36px",padding:0,color:"#ffffff !important",lineHeight:"1"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",Z.currentTarget.style.borderColor="#fff",Z.currentTarget.style.color="#ffffff"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",Z.currentTarget.style.borderColor="#fff",Z.currentTarget.style.color="#ffffff"},title:"System Syntax Guidance",children:"?"})]})]})}),s.jsx(Y.Body,{className:"p-0",style:{position:"relative"},children:s.jsx(Hoe,{ref:I,initialContent:r,fileName:n,showImportInfo:!!l,importType:l,initialSections:D,isUpdateRejected:M,onHasUnsavedChangesChange:y,onDraftSaved:async Z=>{try{console.log(" onDraftSaved called - checking sessionStorage...");const J=sessionStorage.getItem("onlyoffice_submitting")==="true",le=sessionStorage.getItem("onlyoffice_submit_docKey");if(console.log(" SessionStorage check:",{isSubmitting:J,submitDocKey:le,draftUrl:Z.substring(0,100)+"..."}),J&&le){let V=null;const re=Z.match(/[?&]shardkey=([^&]+)/);if(re)V=re[1],console.log(" Extracted docKey from shardkey:",V);else{const he=Z.match(/doc-([^_/]+)/);he&&(V=`doc-${he[1]}`,console.log(" Extracted docKey from path:",V))}if(console.log(" Comparing:",{submitDocKey:le,urlDocKey:V,match:V&&le===V}),V&&le===V){console.log(" Draft save ignored - Submit in progress"),console.log(`   Submit docKey: ${le}, URL docKey: ${V}`),N(!1);return}else console.log(" Submit in progress but documentKey mismatch - treating as Draft anyway"),console.log(`   Submit docKey: ${le}, URL docKey: ${V}`)}try{console.log(" Processing draft save - uploading to S3 and building template..."),I.current&&typeof I.current.buildAndSubmitDraftTemplate=="function"?(await I.current.buildAndSubmitDraftTemplate(Z),console.log(" Draft template saved successfully!")):(console.warn(" buildAndSubmitDraftTemplate function not available"),te.warning("Draft URL saved but template not created"))}catch(V){console.error(" Error building/submitting draft template:",V),te.error("Failed to save draft template: "+(V.message||"Unknown error"))}finally{N(!1)}}catch(J){console.error(" Error in onDraftSaved callback:",J),N(!1),te.error("Error processing draft save")}}})})]}),s.jsxs(se,{show:b,onHide:C,centered:!0,children:[s.jsx(se.Header,{className:"bg-warning text-dark border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(se.Title,{className:"text-dark mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Discard Changes?"})}),s.jsxs(se.Body,{style:{padding:"1.5rem"},children:[s.jsx("p",{className:"mb-0",style:{fontSize:"1rem",color:"var(--bs-dark)"},children:"You have unsaved changes in the document. Are you sure you want to leave without saving?"}),s.jsx("p",{className:"mt-2 mb-0 text-muted",style:{fontSize:"0.875rem"},children:"All unsaved changes will be lost."})]}),s.jsxs(se.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:[s.jsx(ae,{variant:"secondary",onClick:C,style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Cancel"}),s.jsx(ae,{variant:"warning",onClick:P,style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#212529",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Discard Changes"})]})]}),s.jsxs(se,{show:d,onHide:oe,size:"lg",centered:!0,children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Ar,{className:"me-2",size:20}),"Edit Template Information"]}),s.jsx(ae,{variant:"link",onClick:oe,className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:""})]}),s.jsx(se.Body,{className:"p-4",children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:f.name,onChange:Z=>h(J=>({...J,name:Z.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:f.description,onChange:Z=>h(J=>({...J,description:Z.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(_.Select,{value:f.departmentId,onChange:Z=>h(J=>({...J,departmentId:Z.target.value})),required:!0,disabled:g,children:[s.jsx("option",{value:"",children:"Select Department"}),x.map(Z=>s.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),g&&s.jsx(_.Text,{className:"text-muted",children:"Loading departments..."})]})})]})})}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"outline-secondary",onClick:oe,children:"Cancel"}),s.jsx(ae,{variant:"primary-custom",onClick:Ee,disabled:!f.name||!f.description||!f.departmentId,children:"Save Changes"})]})]}),s.jsxs(se,{show:T,onHide:()=>k(!1),size:"lg",centered:!0,className:"syntax-guide-modal",children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(nS,{className:"me-2",size:20}),"System Syntax Guidance"]}),s.jsx(ae,{variant:"link",onClick:()=>k(!1),className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(ht,{size:24})})]}),s.jsx(se.Body,{style:{padding:"1.5rem",maxHeight:"70vh",overflowY:"auto"},children:s.jsxs("div",{className:"syntax-guide-content",children:[s.jsxs("div",{className:"syntax-list mb-4",children:[s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Field:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{variable_name}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TEXT, VALUE_LIST, FINAL_SCORE_TEXT, FINAL_SCORE_NUM"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Signature (image):"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{%signature}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: SIGNATURE_DRAW, SIGNATURE_IMG"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Part:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#Part_Name} {field1} {field2} {/Part_Name}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: PART"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Check box:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#Checkbox_Name} {check1} {check2} {/Checkbox_Name}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: CHECK_BOX"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#isCondition} {true} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Inverted Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{^isCondition} {false} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Advanced Syntax:"}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("code",{className:"syntax-pill",children:"Operators: + - * % /"})})]})})]}),s.jsx("hr",{className:"my-4",style:{borderColor:"#dfe1e6"}}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Sections-Fields Rule"}),s.jsxs("ul",{className:"rule-list mb-4",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Create a Section first, then you can create Fields belonging to that Section."}),s.jsx("li",{children:"You can drag the Section card to change the position of Sections."}),s.jsx("li",{children:"You can drag the Field card to change the position of Fields within the same or between Sections."})]}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Template Rule"}),s.jsxs("ul",{className:"rule-list",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Placeholders in the Template must match the Available Fields (e.g., no Field in the Template that is not in Available Fields when submitting, and vice versa)."}),s.jsx("li",{children:'For the "Submittable" field of a Section for a TRAINER, it means only the person Assessing that Section later will be allowed to Submit the Assessment Form and there must be one or more Section that is "Submittable".'}),s.jsxs("li",{children:['For the "Toggle Dependent" field of a Section for a TRAINER:',s.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[s.jsx("li",{children:"It means the person Assessing this Section is allowed to skip Fields without filling them in."}),s.jsx("li",{children:"There must be exactly one Field with the Field Type SECTION_CONTROL_TOGGLE."})]})]}),s.jsx("li",{children:"A Field with the type FINAL_SCORE_TEXT or FINAL_SCORE_NUM must exist (serving the purpose of Assessing TRAINEE), and no more than two Fields with this same Field Type can exist."}),s.jsx("li",{children:"There must exist one Section for Trainee that have the SIGNATURE_DRAW field (Trainee must sign confirmation for the Assessment)."})]})]})}),s.jsx(se.Footer,{className:"border-0",children:s.jsx(ae,{variant:"primary-custom",onClick:()=>k(!1),style:{fontWeight:500,padding:"0.5rem 1.5rem"},children:"Got it"})})]})]})})},qoe=()=>{const e=ft(),{user:t}=Rr(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(null);v.useEffect(()=>{t?.id&&f()},[t?.id]);const f=async()=>{try{i(!0);const w=t?.id;if(!w){te.error("User ID not found"),a([]);return}const y=await Dt.getTemplates({status:"DRAFT",createdByUserId:w});y.success&&y.data?a(y.data):Array.isArray(y)?a(y):y.data&&Array.isArray(y.data)?a(y.data):a([])}catch(w){console.error("Error loading drafts:",w),te.error("Failed to load drafts"),a([])}finally{i(!1)}},h=async w=>{try{console.log(" Opening draft:",w);const y=await Dt.getTemplateById(w),b=y.data?.templateForm||y.data,S=y.data?.sections||[];if(!b){te.error("Template not found");return}console.log(" Template loaded:",b),console.log(" Sections loaded:",S);const E=Zm(S);console.log(" Converted sections:",E);const N=b.templateConfig||b.templateContent;if(!N){te.error("Document URL not found");return}localStorage.setItem("templateInfo",JSON.stringify({id:b.id,currentTemplateId:b.id,name:b.name,description:b.description,departmentId:b.departmentId,templateContent:b.templateContent,templateConfig:b.templateConfig})),localStorage.setItem("currentTemplateId",b.id),console.log(" Restored templateInfo with currentTemplateId:",b.id),e(Pe.TEMPLATES_EDITOR,{state:{documentUrl:N,fileName:b.name,importType:"File without fields",isEditDraft:!0,templateInfo:{id:b.id,currentTemplateId:b.id,name:b.name,description:b.description,departmentId:b.departmentId,status:b.status},initialSections:E}}),te.success("Draft loaded successfully")}catch(y){console.error("Error opening draft:",y),te.error("Failed to load draft: "+(y.message||"Unknown error"))}},x=w=>{m(w),u(!0)},p=()=>{u(!1),m(null)},g=async()=>{if(d)try{o(d.id);const y=(await Dt.deleteDraft(d.id))?.message||`Draft "${d.name}" deleted successfully`;te.success(y),a(b=>b.filter(S=>S.id!==d.id)),p()}catch(w){const y=w?.response?.data?.message||w.message||"Failed to delete draft";te.error(y),console.error("Error deleting draft:",w)}finally{o(null)}},j=w=>{if(!w)return"N/A";try{return new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return w}};return s.jsxs(Be,{fluid:!0,className:"py-4 forms-page form-component",children:[s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53",padding:"12px 16px"},children:s.jsx(ue,{className:"align-items-center g-0",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",style:{gap:"8px"},children:[s.jsx(ae,{variant:"link",className:"text-white p-0",onClick:()=>e(Pe.TEMPLATES),style:{textDecoration:"none",margin:0,padding:"4px",minWidth:"auto"},children:s.jsx(Bt,{size:20})}),s.jsx(gt,{className:"text-white",size:24,style:{marginLeft:"4px"}}),s.jsx("h4",{className:"mb-0 text-white",style:{marginLeft:"8px"},children:"Your Drafts"})]})})})}),s.jsx(Y.Body,{style:{padding:0},children:n?s.jsx("div",{style:{padding:"1.5rem"},children:s.jsx(Fr,{})}):r.length===0?s.jsx("div",{style:{padding:"1.5rem"},children:s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(oi,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No drafts found"}),s.jsx("p",{className:"text-muted mb-4",children:"You haven't saved any drafts yet. Start creating a template to save drafts."}),s.jsx(ae,{variant:"primary-custom",onClick:()=>e(Pe.TEMPLATES),children:"Go to Templates"})]})})})}):s.jsx("div",{className:"draft-card-scroll-container",style:{padding:"1.5rem"},children:s.jsx(ue,{className:"g-3 g-md-4",children:r.map(w=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(Y,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:y=>{y.currentTarget.style.transform="translateY(-5px)",y.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:y=>{y.currentTarget.style.transform="translateY(0)",y.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(gt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:w.name,children:w.name}),s.jsxs("small",{className:"text-muted",children:["v",w.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:w.description||"No description",children:w.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ws,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:w.department?.code||"N/A",children:w.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:s.jsxs(Ae,{bg:"secondary",className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(rt,{size:12}),"DRAFT"]})})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},children:[w.createdByUser?.lastName,w.createdByUser?.middleName?" "+w.createdByUser?.middleName:""," ",w.createdByUser?.firstName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:j(w.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(Nt,{permission:De.EDIT_DRAFT_TEMPLATE,fallback:null,children:s.jsxs(ae,{variant:"primary",size:"sm",className:"flex-grow-1 d-flex align-items-center justify-content-center",onClick:()=>h(w.id),style:{backgroundColor:"#1b3c53",borderColor:"#1b3c53",color:"#fff",fontWeight:500},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="#153a4a",y.currentTarget.style.borderColor="#153a4a"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="#1b3c53",y.currentTarget.style.borderColor="#1b3c53"},children:[s.jsx(Ar,{size:14,className:"me-2"}),"Edit"]})}),s.jsx(Nt,{permission:De.DELETE_DRAFT_TEMPLATE,fallback:null,children:s.jsx(ae,{variant:"secondary",size:"sm",className:"d-flex align-items-center justify-content-center",onClick:()=>x(w),disabled:l===w.id,style:{minWidth:"44px",padding:"0.375rem 0.75rem",backgroundColor:"transparent",borderColor:"#6c757d",color:"#6c757d",border:"1px solid #6c757d !important",fontWeight:500,cursor:l===w.id?"not-allowed":"pointer",opacity:l===w.id?.6:1,transition:"all 0.25s ease"},onMouseEnter:y=>{l!==w.id&&(y.currentTarget.style.backgroundColor="#6c757d",y.currentTarget.style.color="#fff",y.currentTarget.style.borderColor="#6c757d",y.currentTarget.style.boxShadow="0 2px 8px rgba(108, 117, 125, 0.3)",y.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="transparent",y.currentTarget.style.color="#6c757d",y.currentTarget.style.borderColor="#6c757d",y.currentTarget.style.boxShadow="none",y.currentTarget.style.transform="translateY(0)"},title:"Delete this draft",children:l===w.id?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm",style:{width:"14px",height:"14px",marginRight:"4px"}}),"Deleting"]}):" Delete"})})]})})]})})},w.id))})})})]}),s.jsxs(se,{show:c,onHide:p,centered:!0,children:[s.jsx(se.Header,{closeButton:!0,className:"border-bottom",children:s.jsxs(se.Title,{className:"d-flex align-items-center text-danger",children:[s.jsx(Gt,{className:"me-2",size:20}),"Delete Draft"]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs(Ue,{variant:"warning",className:"mb-3",children:[s.jsx(Gt,{className:"me-2",size:16}),s.jsx("strong",{children:"Warning:"})," This action cannot be undone."]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete the draft ",s.jsxs("strong",{children:['"',d?.name,'"']}),"?"]}),d&&s.jsx("div",{className:"bg-light p-3 rounded",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Draft Name:"}),s.jsx("div",{className:"fw-semibold",children:d.name})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Version:"}),s.jsxs("div",{className:"fw-semibold",children:["v",d.version]})]}),d.description&&s.jsxs("div",{className:"col-12 mt-2",children:[s.jsx("small",{className:"text-muted",children:"Description:"}),s.jsx("div",{className:"text-muted small",children:d.description})]})]})})]}),s.jsx("p",{className:"text-muted small mb-0",children:"Once deleted, this draft cannot be recovered. All associated data will be permanently removed."})]}),s.jsxs(se.Footer,{className:"border-0 p-4",children:[s.jsx(ae,{variant:"outline-secondary",onClick:p,disabled:l===d?.id,children:"Cancel"}),s.jsx(ae,{variant:"danger",onClick:g,disabled:l===d?.id,children:l===d?.id?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Deleting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"me-2",size:16}),"Delete Draft"]})})]})]})]})},Koe=()=>{const e=ft(),t=[{id:"add-template",title:"Add New Template",description:"Create a new form template",icon:eg,path:`${Pe.TEMPLATES}?action=create`,permission:De.CREATE_TEMPLATE,color:"primary",action:()=>{e(`${Pe.TEMPLATES}?action=create`)}},{id:"add-department",title:"Add New Department",description:"Create a new department",icon:Ws,path:Pe.DEPARTMENTS,permission:De.CREATE_DEPARTMENT,color:"primary",action:()=>{e(Pe.DEPARTMENTS)}},{id:"bulk-import-user",title:"Bulk Import User",description:"Import multiple users from Excel file",icon:js,path:`${Pe.USERS}?action=bulk-import`,permission:De.BULK_CREATE_USERS,color:"primary",action:()=>{e(`${Pe.USERS}?action=bulk-import`)}}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsx(Be,{className:"py-4",children:s.jsx(ue,{className:"mb-4",children:s.jsx(H,{lg:12,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(Y.Body,{children:s.jsx(ue,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(Nt,{permission:r.permission,fallback:null,children:s.jsx(H,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:r.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(vn,{size:16,className:`text-${r.color} ms-auto`})]})},a)},r.id)})})})]})})})})})},Yoe=({field:e,onViewDetail:t,onEdit:r,onDelete:a})=>{const{hasPermission:n}=ln(),i=[{label:"View Detail",icon:s.jsx(gt,{size:16}),onClick:()=>t(e),permission:De.VIEW_GLOBAL_FIELD_DETAILS},{label:"Edit Global Field",icon:s.jsx(Ar,{size:16}),onClick:()=>r(e),permission:De.UPDATE_GLOBAL_FIELD},{label:"Delete Global Field",icon:s.jsx(ba,{size:16}),onClick:()=>a&&a(e),permission:De.DISABLE_ENABLE_GLOBAL_FIELD,variant:"danger"}].filter(l=>!l.permission||n(l.permission));return s.jsx(Y,{className:"h-100 border-0 shadow-sm",style:{transition:"all 0.3s ease",height:"100%",display:"flex",flexDirection:"column"},onMouseEnter:l=>{l.currentTarget.style.transform="translateY(-5px)",l.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-3 d-flex flex-column position-relative",style:{flex:"1 1 auto",minHeight:"0"},children:[s.jsx("div",{className:"position-absolute",style:{top:"0.5rem",right:"0.5rem",zIndex:10},children:s.jsx(Nt,{permissions:[De.VIEW_GLOBAL_FIELD_DETAILS,De.UPDATE_GLOBAL_FIELD,De.DISABLE_ENABLE_GLOBAL_FIELD],fallback:null,children:s.jsx(ia,{align:"end",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:i})})}),s.jsxs("div",{className:"d-flex align-items-start mb-3",style:{minHeight:"60px",flexShrink:0,paddingRight:"2rem"},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px",flexShrink:0},children:s.jsx(gt,{size:20})}),s.jsx("div",{className:"flex-grow-1",style:{minWidth:0},children:s.jsx("h6",{className:"mb-0 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3",minHeight:"2.6em"},title:e.label,children:e.label})})]}),s.jsxs("div",{style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-1",children:[s.jsx("small",{className:"text-muted",children:"Field Name:"}),e.children&&Array.isArray(e.children)&&e.children.length>0&&s.jsxs(Ae,{bg:"info",className:"d-flex align-items-center",children:[s.jsx(Z2,{size:10,className:"me-1"}),e.children.length," child",e.children.length!==1?"ren":""]})]}),s.jsx("code",{className:"text-dark d-block",style:{fontSize:"0.85rem",wordBreak:"break-word",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem",overflowWrap:"break-word"},children:e.fieldName})]})]})})},Xoe=({show:e,onHide:t,field:r})=>{const[a,n]=v.useState(!1);if(!r)return null;const i=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return o}},l=o=>{const u={TEXT:{variant:"primary",text:"TEXT"},NUMBER:{variant:"info",text:"NUMBER"},DATE:{variant:"success",text:"DATE"},SELECT:{variant:"warning",text:"SELECT"},CHECKBOX:{variant:"secondary",text:"CHECKBOX"}}[o]||{variant:"secondary",text:o||"N/A"};return s.jsx(Ae,{bg:u.variant,className:"px-2 py-1",children:u.text})};return s.jsxs(se,{show:e,onHide:t,size:"md",centered:!0,fullscreen:"md-down",children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsxs(se.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(gt,{className:"me-2",size:20}),s.jsx("span",{children:"Global Field Detail"})]})}),s.jsx(se.Body,{style:{padding:"1.5rem",maxHeight:"60vh",overflowY:"auto"},children:s.jsxs(oa,{variant:"flush",children:[s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Label"}),s.jsx("span",{className:"text-dark fw-medium",children:r.label||"N/A"})]})]})}),s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Name"}),s.jsx("code",{className:"text-dark",style:{fontSize:"0.9rem",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:r.fieldName||"N/A"})]})]})}),s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Type"}),s.jsx("div",{children:l(r.fieldType)})]})]})}),r.roleRequired&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Role Required"}),s.jsx(Ae,{bg:"secondary",children:r.roleRequired})]})]})}),r.options&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-start mb-2",children:[s.jsx(gt,{className:"text-primary-custom me-3 mt-1",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-2",children:"Options"}),r.options?.items&&Array.isArray(r.options.items)&&r.options.items.length>0?s.jsx("div",{className:"border rounded p-2",style:{backgroundColor:"#f8f9fa"},children:r.options.items.map((o,c)=>{const u=typeof o=="object"&&o!==null,d=u?o.label||"N/A":o||"N/A",m=u?o.value||"N/A":o||"N/A";return s.jsx("div",{className:"mb-2 pb-2",style:{paddingLeft:"0.5rem",borderBottom:c!==r.options.items.length-1?"1px solid #dee2e6":"none"},children:s.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-2",children:[s.jsxs("div",{className:"flex-grow-1",children:[u&&s.jsx("div",{className:"mb-1",children:s.jsx("small",{className:"text-muted d-block",children:"Label"})}),s.jsx("span",{className:"text-dark fw-medium",children:d})]}),u&&s.jsxs("div",{children:[s.jsx("small",{className:"text-muted d-block",children:"Value"}),s.jsx("code",{className:"text-dark",style:{fontSize:"0.9rem",backgroundColor:"#e9ecef",padding:"0.35rem 0.5rem",borderRadius:"0.25rem",display:"inline-block"},children:m})]})]})},c)})}):s.jsx("span",{className:"text-muted",children:"No options available"})]})]})}),r.createdBy&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Lt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdBy.lastName,r.createdBy.middleName?" "+r.createdBy.middleName:""," ",r.createdBy.firstName]})]})]})}),r.createdAt&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(or,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created At"}),s.jsx("span",{className:"text-dark",children:i(r.createdAt)})]})]})}),r.updatedBy&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Lt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated By"}),s.jsxs("span",{className:"text-dark",children:[r.updatedBy.lastName,r.updatedBy.middleName?" "+r.updatedBy.middleName:""," ",r.updatedBy.firstName]})]})]})}),r.updatedAt&&s.jsx(oa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(rt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated At"}),s.jsx("span",{className:"text-dark",children:i(r.updatedAt)})]})]})}),r.children&&Array.isArray(r.children)&&r.children.length>0&&s.jsxs(oa.Item,{className:"px-0 py-3",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2 cursor-pointer",onClick:()=>n(!a),style:{cursor:"pointer"},children:[s.jsx(gt,{className:"text-primary-custom me-3",size:20}),s.jsx("div",{className:"flex-grow-1",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Children Fields"}),s.jsxs("span",{className:"text-dark",children:[r.children.length," child",r.children.length!==1?"ren":""]})]}),s.jsx("div",{className:"ms-2",children:a?s.jsx(sn,{size:16}):s.jsx(Ac,{size:16})})]})})]}),s.jsx(i0,{in:a,children:s.jsx("div",{className:"mt-3",children:s.jsx("div",{className:"border rounded p-3",style:{backgroundColor:"#f8f9fa"},children:r.children.map((o,c)=>s.jsx("div",{className:"mb-3 pb-3 border-bottom",style:{paddingLeft:"1rem"},children:s.jsx("div",{className:"d-flex align-items-start",children:s.jsxs("div",{className:"flex-grow-1",children:[s.jsxs("div",{className:"d-flex align-items-center mb-1",children:[s.jsx("strong",{className:"me-2",children:o.label||"N/A"}),s.jsx(Ae,{bg:"secondary",className:"me-2",children:o.fieldType||"TEXT"})]}),s.jsx("code",{className:"text-muted",style:{fontSize:"0.85rem"},children:o.fieldName||"N/A"})]})})},o.id||c))})})})]})]})}),s.jsx(se.Footer,{className:"bg-light border-0",children:s.jsx("button",{onClick:t,className:"btn btn-secondary",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff"},children:"Close"})})]})},Joe=({show:e,onHide:t,field:r,onSuccess:a})=>{const[n,i]=v.useState({label:"",fieldName:"",fieldType:"TEXT",options:null}),[l,o]=v.useState({}),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState([]),[x,p]=v.useState(""),[g,j]=v.useState(""),[w,y]=v.useState(null),[b,S]=v.useState([]),[E,N]=v.useState("");v.useEffect(()=>{(async()=>{if(r&&e&&r.id)try{m(!0);const M=await si.getGlobalFieldDetail(r.id),G=M?.data||M||r,q=G?.fieldType||G?.type||r?.fieldType||r?.type,z=q?String(q).toUpperCase().trim():"TEXT";console.log("EditGlobalFieldModal - Field detail loaded:",{fieldFromProp:r,responseData:M,fieldDetail:G,rawFieldType:q,normalizedFieldType:z}),i({label:G.label||r.label||"",fieldName:G.fieldName||r.fieldName||"",fieldType:z,options:G.options||r.options||null}),G.children&&Array.isArray(G.children)?h(G.children.map(ee=>({id:ee.id,label:ee.label||"",fieldName:ee.fieldName||""}))):h([]),z==="VALUE_LIST"&&G.options?.items?S(G.options.items):S([]),o({})}catch(M){console.error("Error loading field detail:",M);const G=r.fieldType||"TEXT";i({label:r.label||"",fieldName:r.fieldName||"",fieldType:G,options:r.options||null}),r.children&&Array.isArray(r.children)?h(r.children.map(q=>({id:q.id,label:q.label||"",fieldName:q.fieldName||""}))):h([]),G==="VALUE_LIST"&&r.options?.items?S(r.options.items):S([]),o({})}finally{m(!1)}})()},[r,e]);const T=A=>{const{name:M,value:G}=A.target;i(q=>({...q,[M]:G})),l[M]&&o(q=>({...q,[M]:""}))},k=()=>{const A={};return n.label.trim()||(A.label="Label is required"),n.fieldName.trim()||(A.fieldName="Field Name is required"),n.fieldType||(A.fieldType="Field Type is required"),o(A),Object.keys(A).length===0},I=async A=>{if(A.preventDefault(),!!k())try{u(!0);let M=n.options||null;if(n.fieldType==="VALUE_LIST"){if(!b||b.length===0){te.warning("Please add at least one option for VALUE_LIST field"),u(!1);return}M={items:b}}const G={label:n.label.trim(),fieldName:n.fieldName.trim(),fieldType:n.fieldType,roleRequired:null,options:M};(n.fieldType==="PART"||n.fieldType==="CHECK_BOX")&&(G.children=f.map(q=>q.id?{id:q.id,label:q.label.trim(),...q.fieldName&&{fieldName:q.fieldName.trim()}}:{label:q.label.trim(),fieldName:q.fieldName.trim()})),await si.updateGlobalField(r.id,G),te.success("Global field updated successfully"),a&&a(),t()}catch(M){console.error("Error updating global field:",M);const G=M.response?.data?.message||M.message||"Failed to update global field";te.error(G)}finally{u(!1)}},D=()=>{i({label:"",fieldName:"",fieldType:"TEXT",options:null}),o({}),h([]),p(""),j(""),y(null),S([]),N(""),t()};return s.jsxs(se,{show:e,onHide:D,size:"lg",centered:!0,fullscreen:"md-down",children:[s.jsxs(se.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(se.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(Zr,{className:"me-2",size:20}),s.jsx("span",{children:"Edit Global Field"})]}),s.jsx("button",{onClick:D,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:s.jsx(ht,{size:24})})]}),s.jsxs(_,{onSubmit:I,children:[s.jsxs(se.Body,{style:{maxHeight:"70vh",overflowY:"auto",overflowX:"hidden",padding:"1.5rem"},children:[d&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ot,{animation:"border",variant:"primary",className:"me-2"}),s.jsx("span",{children:"Loading field details..."})]}),!d&&s.jsxs(s.Fragment,{children:[s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-medium",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",name:"label",value:n.label,onChange:T,isInvalid:!!l.label,placeholder:"Enter field label"}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.label})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-medium",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",name:"fieldName",value:n.fieldName,onChange:T,isInvalid:!!l.fieldName,placeholder:"Enter field name (e.g., template_name)"}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.fieldName})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-medium",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(_.Select,{name:"fieldType",value:n.fieldType,onChange:T,isInvalid:!!l.fieldType,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"CHECK_BOX",children:"CHECK_BOX"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]}),s.jsx(_.Control.Feedback,{type:"invalid",children:l.fieldType})]}),n.fieldType==="VALUE_LIST"&&s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{className:"fw-medium",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(_.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:E,onChange:A=>N(A.target.value),onKeyPress:A=>{if(A.key==="Enter"){A.preventDefault();const M=E.trim();if(M){if(b.includes(M)){te.warning("This option already exists. Please enter a different value.");return}S(G=>[...G,M]),N("")}}}}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{const A=E.trim();if(A){if(b.includes(A)){te.warning("This option already exists. Please enter a different value.");return}S(M=>[...M,A]),N("")}},disabled:!E.trim(),children:s.jsx(yr,{size:14})})]}),b.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:b.map((A,M)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:A}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{S(G=>G.filter((q,z)=>z!==M))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]},M))}),s.jsx(_.Text,{className:"text-muted",children:"Add options one by one."})]}),(n.fieldType==="PART"||n.fieldType==="CHECK_BOX")&&s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx(_.Label,{className:"fw-medium mb-0",children:"Children Fields"}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>{if(!x.trim()||!g.trim()){te.warning("Please enter both label and field name for the child field");return}if(!/^[a-z][a-z0-9_]*$/.test(g.trim())){te.warning("Child field name must be in snake_case format (e.g., first_name)");return}if(f.some(M=>M.fieldName===g.trim())){te.warning("This field name already exists in children");return}h(M=>[...M,{label:x.trim(),fieldName:g.trim()}]),p(""),j("")},disabled:!x.trim()||!g.trim(),children:[s.jsx(yr,{size:14,className:"me-1"}),"Add Child"]})]}),s.jsxs(_.Text,{className:"text-muted d-block mb-3",children:["Manage child fields nested under this ",n.fieldType," field. Children not included will be deleted. Children are automatically TEXT type."]}),s.jsx("div",{className:"border rounded p-3 mb-3",style:{backgroundColor:"#f8f9fa"},children:s.jsxs(ue,{className:"g-2",children:[s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",placeholder:"Child Label (e.g., First Name)",value:x,onChange:A=>p(A.target.value),size:"sm"})}),s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",placeholder:"Field Name (e.g., first_name)",value:g,onChange:A=>j(A.target.value),size:"sm"})})]})}),f.length>0&&s.jsx("div",{className:"border rounded p-2",style:{maxHeight:"300px",overflowY:"auto"},children:f.map((A,M)=>s.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 mb-2 border-bottom",children:[s.jsx("div",{className:"flex-grow-1",children:w===M?s.jsxs(ue,{className:"g-2",children:[s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",size:"sm",value:A.label,onChange:G=>{const q=[...f];q[M]={...q[M],label:G.target.value},h(q)}})}),s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",size:"sm",value:A.fieldName,onChange:G=>{const q=[...f];q[M]={...q[M],fieldName:G.target.value},h(q)},disabled:!!A.id})}),s.jsx(H,{md:2,children:s.jsx(ae,{variant:"outline-success",size:"sm",onClick:()=>y(null),style:{padding:"0.25rem 0.4rem"},children:s.jsx(Zr,{size:12})})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fw-medium",children:A.label}),s.jsx("code",{className:"text-muted",style:{fontSize:"0.85rem"},children:A.fieldName}),A.id&&s.jsx("small",{className:"text-muted d-block",children:"(Existing)"})]})}),w!==M&&s.jsxs("div",{className:"d-flex gap-1",children:[s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>y(M),style:{padding:"0.25rem 0.4rem"},children:s.jsx(Ar,{size:12})}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{h(G=>G.filter((q,z)=>z!==M)),y(null)},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]})]},A.id||M))}),f.length===0&&s.jsx(Ue,{variant:"info",className:"mb-0",children:"No children fields. Add children using the form above."})]})]})]}),s.jsxs(se.Footer,{className:"bg-light border-0 d-flex flex-wrap gap-2",style:{justifyContent:"flex-end"},children:[s.jsx(ae,{variant:"secondary",onClick:D,disabled:c||d,children:"Cancel"}),s.jsx(ae,{variant:"primary",type:"submit",disabled:c||d,className:"d-flex align-items-center",children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"me-2",size:16}),"Update Global Field"]})})]})]})]})},Zoe=({show:e,onHide:t,onSuccess:r})=>{const[a,n]=v.useState({label:"",fieldName:"",fieldType:"TEXT",options:null}),[i,l]=v.useState(!1),[o,c]=v.useState([]),[u,d]=v.useState(""),[m,f]=v.useState([]),[h,x]=v.useState(""),[p,g]=v.useState(""),j=(b,S)=>{if(!b)return{valid:!1,message:"Field name is required"};const E=String(S||"").toUpperCase();return E==="PART"||E==="CHECK_BOX"?/^[A-Z][A-Za-z0-9_]*$/.test(b)?b.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:E==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(b)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(b)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},w=async()=>{if(!a.label||!a.fieldName){te.warning("Please fill in all required fields");return}if(a.fieldType==="VALUE_LIST"&&(!o||o.length===0)){te.warning("Please add at least one option for VALUE_LIST field");return}const b=j(a.fieldName,a.fieldType);if(!b.valid){te.warning(b.message);return}try{l(!0);let S=null;a.fieldType==="VALUE_LIST"&&o.length>0&&(S={items:o});const E={label:a.label.trim(),fieldName:a.fieldName.trim(),fieldType:a.fieldType,roleRequired:null,options:S};if((a.fieldType==="PART"||a.fieldType==="CHECK_BOX")&&m.length>0){const N=`parent_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;E.tempId=N,E.children=m.map(T=>({label:T.label,fieldName:T.fieldName,parentTempId:N}))}await si.createGlobalField(E),te.success("Global field created successfully"),r&&r(),y()}catch(S){console.error("Error creating global field:",S);const E=S.response?.data?.message||S.message||"Failed to create global field";te.error(E)}finally{l(!1)}},y=()=>{n({label:"",fieldName:"",fieldType:"TEXT",options:null}),c([]),d(""),f([]),x(""),g(""),t()};return s.jsxs(se,{show:e,onHide:y,size:"lg",centered:!0,fullscreen:"md-down",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Create Global Field"})}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto",overflowX:"hidden",padding:"1.5rem"},className:"modal-body-scrollable",children:s.jsx(_,{children:s.jsxs(ue,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:"e.g., Crew Communication",value:a.label,onChange:b=>n(S=>({...S,label:b.target.value})),required:!0}),s.jsx(_.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{type:"text",placeholder:a.fieldType==="PART"||a.fieldType==="CHECK_BOX"?"e.g., Assessment_Items":a.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:a.fieldName,onChange:b=>n(S=>({...S,fieldName:b.target.value})),required:!0}),s.jsx(_.Text,{className:"text-muted",children:a.fieldType==="PART"||a.fieldType==="CHECK_BOX"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':a.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(_.Select,{value:a.fieldType,onChange:b=>{const S=b.target.value;n(E=>({...E,fieldType:S,options:null})),S!=="VALUE_LIST"&&(c([]),d("")),S!=="PART"&&S!=="CHECK_BOX"&&(f([]),x(""),g(""))},required:!0,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"CHECK_BOX",children:"CHECK_BOX"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.fieldType==="VALUE_LIST"&&s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs(_.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(_.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:u,onChange:b=>d(b.target.value),onKeyPress:b=>{if(b.key==="Enter"){b.preventDefault();const S=u.trim();if(S){if(o.includes(S)){te.warning("This option already exists. Please enter a different value.");return}c(E=>[...E,S]),d("")}}}}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{const b=u.trim();if(b){if(o.includes(b)){te.warning("This option already exists. Please enter a different value.");return}c(S=>[...S,b]),d("")}},disabled:!u.trim(),children:s.jsx(yr,{size:14})})]}),o.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:o.map((b,S)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:b}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{c(E=>E.filter((N,T)=>T!==S))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]},S))}),s.jsx(_.Text,{className:"text-muted",children:"Add options one by one."})]})}),(a.fieldType==="PART"||a.fieldType==="CHECK_BOX")&&s.jsx(H,{md:12,children:s.jsxs(_.Group,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx(_.Label,{className:"text-primary-custom mb-0",children:"Children Fields (Optional)"}),s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>{if(!h.trim()||!p.trim()){te.warning("Please enter both label and field name for the child field");return}if(!/^[a-z][a-z0-9_]*$/.test(p.trim())){te.warning("Child field name must be in snake_case format (e.g., first_name)");return}if(m.some(S=>S.fieldName===p.trim())){te.warning("This field name already exists in children");return}f(S=>[...S,{label:h.trim(),fieldName:p.trim()}]),x(""),g("")},disabled:!h.trim()||!p.trim(),children:[s.jsx(yr,{size:14,className:"me-1"}),"Add Child"]})]}),s.jsxs(_.Text,{className:"text-muted d-block mb-3",children:["Add child fields that will be nested under this ",a.fieldType," field. Children are automatically created as TEXT type."]}),s.jsx("div",{className:"border rounded p-3 mb-3",style:{backgroundColor:"#f8f9fa"},children:s.jsxs(ue,{className:"g-2",children:[s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",placeholder:"Child Label (e.g., First Name)",value:h,onChange:b=>x(b.target.value),size:"sm"})}),s.jsx(H,{md:5,children:s.jsx(_.Control,{type:"text",placeholder:"Field Name (e.g., first_name)",value:p,onChange:b=>g(b.target.value),size:"sm"})})]})}),m.length>0&&s.jsx("div",{className:"border rounded p-2",style:{maxHeight:"300px",overflowY:"auto"},children:m.map((b,S)=>s.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 mb-2 border-bottom",children:[s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-medium",children:b.label}),s.jsx("code",{className:"text-muted",style:{fontSize:"0.85rem"},children:b.fieldName})]}),s.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>{f(E=>E.filter((N,T)=>T!==S))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(ht,{size:12})})]},S))})]})})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:y,disabled:i,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:w,disabled:i,children:"Save Field"})]})]})},Qoe=({show:e,onClose:t,onConfirm:r,field:a,loading:n=!1})=>{if(!a)return null;const i=()=>{r(a.id)};return s.jsxs(se,{show:e,onHide:t,centered:!0,children:[s.jsx(se.Header,{className:"bg-danger text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(Gt,{className:"me-2",size:20}),"Delete Global Field"]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs(Ue,{variant:"warning",className:"mb-3",children:[s.jsx(Gt,{className:"me-2",size:16}),s.jsx("strong",{children:"Warning:"})," This action cannot be undone. This will permanently delete the global field."]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete ",s.jsxs("strong",{children:['"',a.label,'"']}),"?"]}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Label:"}),s.jsx("div",{className:"fw-semibold",children:a.label})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Field Name:"}),s.jsx("div",{className:"fw-semibold",children:s.jsx("code",{children:a.fieldName})})]})]}),a.roleRequired&&s.jsx("div",{className:"row mt-2",children:s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Role Required:"}),s.jsx("div",{children:s.jsx("span",{className:"badge bg-secondary",children:a.roleRequired})})]})})]})]}),s.jsx("p",{className:"text-muted small mb-0",children:"This global field will be permanently removed from the system and cannot be recovered."})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:"danger",onClick:i,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Deleting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ba,{className:"me-2",size:16}),"Delete Global Field"]})})]})]})},ece=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState(!1),[x,p]=v.useState(null),[g,j]=v.useState(null),[w,y]=v.useState(!1),b=v.useCallback(async()=>{try{a(!0),i(null);const z=await si.getGlobalFields(),ee=z?.data||z||[],U=Array.isArray(ee)?ee:[];t(U)}catch(z){console.error("Error loading global fields:",z),i(z.response?.data?.message||z.message||"Failed to load global fields"),te.error("Failed to load global fields"),t([])}finally{a(!1)}},[]);v.useEffect(()=>{b()},[b]);const S=async z=>{try{p(z);const ee=await si.getGlobalFieldDetail(z.id),U=ee?.data||ee||z;j(U),o(!0)}catch(ee){console.error("Error loading field detail:",ee),te.error("Failed to load field details"),j(z),o(!0)}},E=async z=>{try{p(z);const ee=await si.getGlobalFieldDetail(z.id),U=ee?.data||ee||z;p(U),u(!0)}catch(ee){console.error("Error loading field detail for edit:",ee),te.error("Failed to load field details"),p(z),u(!0)}},N=()=>{o(!1),j(null),p(null)},T=()=>{u(!1),p(null)},k=()=>{b()},I=()=>{b()},D=()=>{m(!0)},A=()=>{m(!1)},M=z=>{p(z),h(!0)},G=()=>{h(!1),p(null),y(!1)},q=async z=>{try{y(!0),await si.deleteGlobalField(z),te.success("Global field deleted successfully!"),G(),b()}catch(ee){console.error("Error deleting global field:",ee);const U=ee.response?.data?.message||ee.message||"Failed to delete global field";te.error(`Error: ${U}`),y(!1)}};return r?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(Y.Body,{children:s.jsx(Fr,{})})]})}):n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"alert alert-danger",children:[s.jsx("strong",{children:"Error:"})," ",n]})})]})}):s.jsxs(Be,{fluid:!0,className:"py-4 global-field-list-page",children:[s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary-custom text-white",style:{backgroundColor:"#1b3c53",borderBottom:"none"},children:s.jsxs(ue,{className:"align-items-center",children:[s.jsx(H,{children:s.jsx("h4",{className:"mb-0 text-white",children:"Global Field List"})}),s.jsx(H,{xs:"auto",className:"ms-auto",children:s.jsx(Nt,{permission:De.CREATE_GLOBAL_FIELD,fallback:null,children:s.jsxs(ae,{variant:"light",onClick:D,className:"d-flex align-items-center",size:"sm",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:z=>{z.currentTarget.style.backgroundColor="#f8f9fa",z.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:z=>{z.currentTarget.style.backgroundColor="#ffffff",z.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(yr,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create Global Field"}),s.jsx("span",{className:"d-sm-none",children:"Create"})]})})})]})}),s.jsx(Y.Body,{children:e.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsx("p",{className:"text-muted",children:"No global fields found"})}):s.jsx(ue,{className:"g-3 g-md-4",children:e.map(z=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,className:"d-flex",style:{minHeight:"200px"},children:s.jsx(Yoe,{field:z,onViewDetail:S,onEdit:E,onDelete:M})},z.id))})})]}),s.jsx(Xoe,{show:l,onHide:N,field:g}),s.jsx(Joe,{show:c,onHide:T,field:x,onSuccess:k}),s.jsx(Zoe,{show:d,onHide:A,onSuccess:I}),s.jsx(Qoe,{show:f,onClose:G,onConfirm:q,field:x,loading:w})]})},Nn=({title:e,sortKey:t,sortConfig:r,onSort:a})=>{const n=()=>{a(t)},i=()=>r.key===t?r.direction==="asc"?s.jsx(K2,{size:12,className:"ms-1"}):s.jsx(sn,{size:12,className:"ms-1"}):s.jsx(Rs,{size:12,className:"ms-1"});return s.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[s.jsx("span",{className:"me-1",children:e}),i()]})},tce=({traineeId:e})=>{const{user:t}=Rr(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("course"),[d,m]=v.useState(null),[f,h]=v.useState(!1),[x,p]=v.useState(null),[g,j]=v.useState(!1),w=v.useMemo(()=>c==="course"?r.filter(M=>M.subjectId===null):r.filter(M=>M.subjectId!==null),[r,c]),{sortedData:y,sortConfig:b,handleSort:S}=ts(w),E=v.useCallback(async()=>{try{i(!0),o(null);const q=((await vr.getTraineeAssessments())?.assessments||[]).filter(z=>z.status==="SIGNATURE_PENDING");a(q)}catch(M){console.error("Error loading assessments:",M),o(M.message||"Failed to load assessments"),te.error("Failed to load signature required assessments"),a([])}finally{i(!1)}},[]);v.useEffect(()=>{(t?.id||e)&&E()},[t?.id,e,E]);const N=M=>{u(M)},T=M=>{m(M),h(!0),p(null)},k=M=>{p(M)},I=M=>new Promise(G=>{const q=new Image;q.onload=()=>{const z=document.createElement("canvas");z.width=400,z.height=200;const ee=z.getContext("2d");ee.clearRect(0,0,400,200),ee.drawImage(q,0,0,400,200),G(z.toDataURL("image/png"))},q.src=M}),D=async()=>{if(!x||!d){te.error("Please draw your signature first");return}j(!0);try{const M=await I(x),q=await(await fetch(M)).blob(),z=new File([q],`signature-${Date.now()}.png`,{type:"image/png"}),ee=await an.uploadImage(z,"signature");let U="";if(typeof ee=="string"?U=ee:ee?.url?U=ee.url:ee?.data?.[0]?.url&&(U=ee.data[0].url),!U)throw new Error("Failed to get signature URL from upload response");console.log(" Signature uploaded to S3:",U);const oe=(await vr.confirmParticipation(d,{traineeSignatureUrl:U}))?.message||"Signature submitted successfully";te.success(oe),h(!1),m(null),p(null),setTimeout(()=>{E()},500)}catch(M){console.error("Error submitting signature:",M);const G=M.response?.data?.message||M.message||"Failed to submit signature";te.error(G)}finally{j(!1)}},A=()=>{h(!1),m(null),p(null)};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Y,{className:"shadow-sm",children:s.jsxs(Y.Body,{className:"text-center py-4",children:[s.jsx(ot,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Loading signature required assessments..."})]})})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Y,{className:"shadow-sm border-danger",children:s.jsx(Y.Body,{children:s.jsxs(Ue,{variant:"danger",className:"mb-0",children:[s.jsx(Gt,{size:16,className:"me-2"}),l]})})})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsxs(Tt.Container,{activeKey:c,onSelect:N,children:[s.jsx(Y.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"course",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="course"?"600":"400",opacity:c==="course"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($t,{className:"me-2",size:16}),"Course Assessments"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"subject",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="subject"?"600":"400",opacity:c==="subject"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(gt,{className:"me-2",size:16}),"Subject Assessments"]})})]})}),s.jsx(Y.Body,{className:"p-4",children:w.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ci,{size:48,className:"text-muted mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"No Signature Confirmation Required Assessment Forms."})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Assessment Name",sortKey:"name",sortConfig:b,onSort:S})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:c==="course"?"Course Name":"Subject Name",sortKey:c==="course"?"courseName":"subjectName",sortConfig:b,onSort:S})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Date",sortKey:"occuranceDate",sortConfig:b,onSort:S})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Sign"})]})}),s.jsx("tbody",{children:y.map((M,G)=>s.jsxs("tr",{className:`${G%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor=G%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium text-dark",children:M.name})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium text-dark",children:c==="course"?M.courseName:M.subjectName})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"text-dark",children:M.occuranceDate?new Date(M.occuranceDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx("div",{className:"d-flex justify-content-center",children:s.jsxs(ae,{variant:M.status==="READY_TO_SUBMIT"?"success":"primary",size:"sm",disabled:M.status==="READY_TO_SUBMIT"||d===M.id,onClick:()=>{M.status==="SIGNATURE_PENDING"&&T(M.id)},className:"d-flex align-items-center",style:{gap:"0.5rem"},children:[s.jsx(ci,{size:14}),M.status==="READY_TO_SUBMIT"?"Signed":"Sign"]})})})]},M.id))})]})})})]})}),s.jsxs(se,{show:f,onHide:A,size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Draw Your Signature"})}),s.jsxs(se.Body,{className:"text-center py-4",children:[s.jsx("p",{className:"text-muted mb-3",children:"Please draw your signature in the box below using your mouse or touch device."}),s.jsx("div",{className:"d-flex justify-content-center mb-3",children:s.jsx(Jm,{onSignatureChange:k,width:400,height:200})})]}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"outline-secondary",onClick:A,disabled:g,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:D,disabled:!x||g,children:g?s.jsxs(s.Fragment,{children:[s.jsx(ot,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{size:16,className:"me-2"}),"Submit Signature"]})})]})]})]})},rce=()=>{const{user:e}=Rr();return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(tce,{traineeId:e?.id})})},sce=()=>{const{user:e}=Rr(),t=ft(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("course"),[d,m]=v.useState(!1),[f,h]=v.useState(null),{sortedData:x,sortConfig:p,handleSort:g}=ts(r),j=v.useCallback(async()=>{try{i(!0),o(null);const T=(await vr.getTraineeAssessments())?.assessments||[];if(!Array.isArray(T)||T.length===0){a([]),i(!1);return}const k=["APPROVED","ON_GOING","DRAFT","SIGNATURE_PENDING","SUBMITTED"],I=T.filter(A=>k.includes(A.status));let D=I;c==="course"?D=I.filter(A=>A.courseId&&!A.subjectId):D=I.filter(A=>A.subjectId),a(D)}catch(N){console.error("Error loading assessments:",N),o(N.message||"Failed to load assessments"),te.error("Failed to load assessments"),a([])}finally{i(!1)}},[e?.id,c]);v.useEffect(()=>{e?.id&&j()},[e?.id,c,j]);const w=N=>{u(N)},y=N=>{const k={ON_GOING:{variant:"info",text:"On Going",icon:rt},PENDING:{variant:"warning",text:"Pending",icon:rt},NOT_STARTED:{variant:"warning",text:"Not Started",icon:rt},APPROVED:{variant:"success",text:"Approved",icon:it},COMPLETED:{variant:"success",text:"Completed",icon:it},REJECTED:{variant:"danger",text:"Rejected",icon:Gt},CANCELLED:{variant:"secondary",text:"Cancelled",icon:Gt},DRAFT:{variant:"primary",text:"Draft",icon:rt},SIGNATURE_PENDING:{variant:"warning",text:"Signature Pending",icon:rt}}[N]||{variant:"secondary",text:N,icon:Gt},I=k.icon;return s.jsxs(Ae,{bg:k.variant,className:"d-flex align-items-center",children:[s.jsx(I,{size:12,className:"me-1"}),k.text]})},b=N=>N?N==="NOT_APPLICABLE"?s.jsx(Ae,{bg:"secondary",children:"N/A"}):N==="PASS"?s.jsx(Ae,{bg:"success",children:"PASS"}):N==="FAIL"?s.jsx(Ae,{bg:"danger",children:"FAIL"}):s.jsx(Ae,{bg:"secondary",children:N}):s.jsx("span",{className:"text-muted",children:"-"}),S=N=>{t(Pe.ASSESSMENTS_SECTIONS(N.id))},E=N=>{N&&(h(N),m(!0))};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Y,{className:"shadow-sm",children:s.jsxs(Y.Body,{className:"text-center py-4",children:[s.jsx(ot,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Loading your assessments..."})]})})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Y,{className:"shadow-sm border-danger",children:s.jsx(Y.Body,{children:s.jsxs(Ue,{variant:"danger",className:"mb-0",children:[s.jsx(Gt,{size:16,className:"me-2"}),l]})})})}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsxs(Tt.Container,{activeKey:c,onSelect:w,children:[s.jsx(Y.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"course",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="course"?"600":"400",opacity:c==="course"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($t,{className:"me-2",size:16}),"Course Assessments"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"subject",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="subject"?"600":"400",opacity:c==="subject"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(gt,{className:"me-2",size:16}),"Subject Assessments"]})})]})}),s.jsx(Y.Body,{className:"p-4",children:r.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(it,{size:48,className:"text-muted mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"No assessments available"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Assessment Name",sortKey:"name",sortConfig:p,onSort:g})}),c==="course"&&s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Course",sortKey:"courseInfo",sortConfig:p,onSort:g})}),c==="subject"&&s.jsxs(s.Fragment,{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Subject",sortKey:"subjectInfo",sortConfig:p,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Course",sortKey:"courseInfo",sortConfig:p,onSort:g})})]}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Date",sortKey:"entityInfo",sortConfig:p,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(Nn,{title:"Status",sortKey:"status",sortConfig:p,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Result"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"PDF"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),s.jsx("tbody",{children:x.map((N,T)=>s.jsxs("tr",{className:`${T%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor=T%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"border-neutral-200 align-middle",children:[s.jsx("div",{className:"fw-medium text-dark",children:N.name}),N.comment&&s.jsx("small",{className:"text-muted d-block mt-1",children:N.comment})]}),c==="course"&&s.jsx("td",{className:"border-neutral-200 align-middle",children:N.entityInfo&&N.entityInfo.type==="course"?s.jsx(s.Fragment,{children:s.jsx("div",{className:"fw-medium text-dark",children:N.entityInfo.name})}):s.jsx("span",{className:"text-muted",children:"-"})}),c==="subject"&&s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:N.entityInfo&&N.entityInfo.type==="subject"?s.jsx(s.Fragment,{children:s.jsx("div",{className:"fw-medium text-dark",children:N.entityInfo.name})}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:N.entityInfo&&N.entityInfo.type==="course"?s.jsx(s.Fragment,{children:s.jsx("div",{className:"fw-medium text-dark",children:N.entityInfo.name})}):s.jsx("span",{className:"text-muted",children:"-"})})]}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("span",{className:"text-dark",children:N.occuranceDate?new Date(N.occuranceDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:y(N.status)}),s.jsx("td",{className:"border-neutral-200 align-middle",children:N.resultScore?s.jsx(Ae,{bg:N.resultText==="FAIL"?"danger":"success",children:N.resultScore}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:b(N.resultText)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:N.pdfUrl?s.jsx(ae,{variant:"link",className:"p-0 text-primary-custom",onClick:()=>E(N.pdfUrl),style:{border:"none",background:"transparent"},children:s.jsx(Zs,{size:18})}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsxs("td",{className:"border-neutral-200 align-middle text-center",children:[(N.status==="ON_GOING"||N.status==="DRAFT")&&N.isTraineeLocked===!1&&s.jsxs(ae,{size:"sm",variant:"primary",onClick:()=>S(N),className:"d-flex align-items-center gap-1",children:[s.jsx(Qx,{size:14}),"Participate"]}),!((N.status==="ON_GOING"||N.status==="DRAFT")&&N.isTraineeLocked===!1)&&s.jsx("span",{className:"text-muted",children:""})]})]},N.id))})]})})})]})}),s.jsx(cg,{show:d,onHide:()=>{m(!1),h(null)},pdfUrl:f,title:"Assessment PDF"})]})},F2=()=>s.jsx(sce,{}),ga={getReportsByType:async(e,t={})=>{try{return(await Se.get("/reports",{params:{requestType:e,...t}})).data}catch(r){throw console.error("Error fetching reports:",r),r}},getMyReports:async(e,t={})=>{try{return(await Se.get("/reports/my-reports",{params:{requestType:e,...t}})).data}catch(r){throw console.error("Error fetching my reports:",r),r}},getIncidents:async(e={})=>ga.getReportsByType("INCIDENT",e),getFeedback:async(e={})=>ga.getReportsByType("FEEDBACK",e),getMyIncidents:async(e={})=>ga.getMyReports("INCIDENT",e),getMyFeedback:async(e={})=>ga.getMyReports("FEEDBACK",e),getAllReports:async(e={})=>{try{return(await Se.get("/reports",{params:e})).data}catch(t){throw console.error("Error fetching all reports:",t),t}},getReportById:async e=>{try{return(await Se.get(`/reports/${e}`)).data}catch(t){throw console.error("Error fetching report:",t),t}},acknowledgeReport:async e=>{try{return(await Se.put(`/reports/${e}/acknowledge`)).data}catch(t){throw console.error("Error acknowledging report:",t),t}},resolveReport:async(e,t)=>{try{return(await Se.put(`/reports/${e}/resolve`,{response:t})).data}catch(r){throw console.error("Error resolving report:",r),r}},submitResponse:async(e,t)=>{try{return(await Se.put(`/reports/${e}/respond`,{response:t})).data}catch(r){throw console.error("Error submitting response:",r),r}},respondToReport:async(e,t)=>{try{return(await Se.put(`/reports/${e}/respond`,{response:t})).data}catch(r){throw console.error("Error responding to report:",r),r}},cancelReport:async e=>{try{return(await Se.put(`/reports/${e}/cancel`)).data}catch(t){throw console.error("Error cancelling report:",t),t}},createReport:async e=>{try{return(await Se.post("/reports",e)).data}catch(t){throw console.error("Error creating report:",t),t}}},ace=[{id:"incidents",label:"Incidents",icon:Gt},{id:"feedback",label:"Feedback",icon:G2}],nce=[{id:"pending",label:"Pending"},{id:"acknowledge",label:"Acknowledged"},{id:"resolved",label:"Resolved"},{id:"cancel",label:"Cancelled"}],ice=[{value:"all",label:"All Status"},{value:"SUBMITTED",label:"Submitted"},{value:"ACKNOWLEDGED",label:"Acknowledged"},{value:"RESOLVED",label:"Resolved"},{value:"CANCELLED",label:"Cancelled"}],lce=[{value:"all",label:"All Status"},{value:"SUBMITTED",label:"Submitted"},{value:"ACKNOWLEDGED",label:"Acknowledged"},{value:"RESOLVED",label:"Resolved"},{value:"CANCELLED",label:"Cancelled"}],Zd=({defaultTab:e,source:t="/reports",onShowForm:r})=>{const a=ft(),n=na(),[i,l]=xi(),o=v.useMemo(()=>n.pathname.includes("/feedback")?"feedback":(n.pathname.includes("/issues"),"incidents"),[n.pathname]),u=i.get("tab")||e||o,[d,m]=v.useState(u),[f,h]=v.useState("pending"),[x,p]=v.useState(""),[g,j]=v.useState([]),[w,y]=v.useState([]),[b,S]=v.useState(!0);v.useEffect(()=>{m(u),p(""),h("pending")},[u]),v.useEffect(()=>{(async()=>{try{S(!0);const q=t==="/reports/create",[z,ee]=await Promise.all([q?ga.getMyIncidents():ga.getIncidents(),q?ga.getMyFeedback():ga.getFeedback()]);j(z.reports||[]),y(ee.reports||[])}catch(q){console.error("Error fetching reports:",q),te.error("Failed to load reports. Please try again."),j([]),y([])}finally{S(!1)}})()},[t]);const E=G=>G?new Date(G).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",N=G=>{const q={SUBMITTED:{variant:"warning",icon:rt,display:"Pending"},ACKNOWLEDGED:{variant:"primary",icon:it,display:"Acknowledged"},RESOLVED:{variant:"success",icon:it,display:"Resolved"},CANCELLED:{variant:"secondary",icon:zr,display:"Cancelled"},open:{variant:"danger",icon:Gt,display:"Open"},in_progress:{variant:"warning",icon:rt,display:"In Progress"},resolved:{variant:"success",icon:it,display:"Resolved"},closed:{variant:"secondary",icon:zr,display:"Closed"}},z=q[G]||q.in_progress,ee=z.icon;return s.jsxs(Ae,{bg:z.variant,className:"d-flex align-items-center",children:[s.jsx(ee,{size:12,className:"me-1"}),z.display]})},T=G=>{const q={LOW:"info",MEDIUM:"secondary",HIGH:"danger",CRITICAL:"dark"};return s.jsx(Ae,{bg:q[G]||"secondary",children:G})},k=G=>({pending:"SUBMITTED",acknowledge:"ACKNOWLEDGED",resolved:"RESOLVED",cancel:"CANCELLED"})[G]||"all",D=d==="feedback"?{data:w,statusOptions:lce,columns:[{key:"title",title:"FEEDBACK TITLE",className:"show-mobile",sortable:!0},{key:"createdBy",title:"SUBMITTER",className:"hide-mobile",sortable:!0},{key:"status",title:"STATUS",className:"show-mobile",sortable:!0},{key:"createdAt",title:"SUBMITTED DATE",className:"hide-mobile",sortable:!0},{title:"ACTIONS",className:"text-center show-mobile",sortable:!1}]}:{data:g,statusOptions:ice,columns:[{key:"title",title:"INCIDENT TITLE",className:"show-mobile",sortable:!0},{key:"createdBy",title:"REPORTER",className:"hide-mobile",sortable:!0},{key:"status",title:"STATUS",className:"show-mobile",sortable:!0},{key:"severity",title:"SEVERITY",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"CREATED DATE",className:"hide-mobile",sortable:!0},{title:"ACTIONS",className:"text-center show-mobile",sortable:!1}]},A=v.useMemo(()=>D.data.filter(q=>{const z=[q.title,q.description,q.createdBy?.firstName,q.createdBy?.lastName,q.createdBy?.email],ee=[q.createdBy?.lastName,q.createdBy?.middleName,q.createdBy?.firstName].filter(Boolean).join(" "),X=z.concat(ee).filter(Boolean).some(F=>F.toLowerCase().includes(x.toLowerCase())),oe=k(f),Ee=oe==="all"||q.status===oe;return X&&Ee}),[D,x,f]),M=G=>{a(Pe.REPORTS_DETAIL(G),{state:{from:t,tab:d}})};return b?s.jsx(Be,{fluid:!0,className:"py-2",children:s.jsx(Fr,{})}):s.jsx(Be,{fluid:!0,className:"py-2 reports-page",children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsxs(Y.Header,{className:"border-bottom py-2 bg-primary",children:[s.jsx(ue,{className:"align-items-center mb-2",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsx("div",{className:"d-flex align-items-center gap-2",children:s.jsx("div",{children:s.jsx("h4",{className:"mb-0 text-white",children:"Incident / Feedback Reports"})})}),t==="/reports/create"&&r&&s.jsx(Nt,{permission:De.SUBMIT_INCIDENT_FEEDBACK_REPORT,fallback:null,children:s.jsxs(ae,{variant:"light",size:"sm",onClick:r,className:"d-flex align-items-center",children:[s.jsx(yr,{className:"me-2",size:16}),"Create Incident/Feedback Report"]})})]})})}),s.jsx(Ye,{variant:"tabs",className:"border-0",children:ace.map(G=>{const q=G.icon;return s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{as:"button",onClick:()=>{m(G.id),h("pending"),l({tab:G.id})},active:d===G.id,className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d===G.id?"600":"400",opacity:d===G.id?"1":"0.7",borderRadius:"4px 4px 0 0",cursor:"pointer"},children:[s.jsx(q,{className:"me-2",size:16}),G.label,s.jsx(Ae,{bg:"light",text:"dark",className:"ms-2",children:G.id==="feedback"?w.length:g.length})]})},G.id)})}),s.jsx(Ye,{className:"border-0 mt-3 sub-tabs-nav",style:{display:"flex",gap:"0"},children:nce.map(G=>s.jsx(Ye.Item,{style:{marginBottom:"0"},children:s.jsx(Ye.Link,{as:"button",onClick:()=>h(G.id),className:`d-flex align-items-center sub-tab-link ${f===G.id?"active-sub-tab":""}`,style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f===G.id?"600":"400",opacity:f===G.id?"1":"0.7",cursor:"pointer",borderBottom:f===G.id?"3px solid #ffffff":"none",padding:"12px",paddingBottom:"9px",margin:"0",transition:"all 0.2s ease"},children:G.label})},G.id))})]}),s.jsxs(Y.Body,{className:"p-3",children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:9,md:9,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:d==="feedback"?"Search feedback by title, description, or submitter...":"Search incidents by title, description, or reporter...",value:x,onChange:p,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[A.length," ",d==="feedback"?"feedback":`incident${A.length!==1?"s":""}`]})})})]}),A.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("p",{className:"text-muted mb-0",children:["No ",d==="feedback"?"feedback":"incidents"," found"]})}):s.jsx(JS,{data:A,loading:b,columns:D.columns,renderRow:(G,q)=>s.jsxs("tr",{className:`${q%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:z=>{z.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:z=>{z.currentTarget.style.backgroundColor=q%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:G.title}),s.jsx("small",{className:"text-muted",children:G.description})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsxs("div",{className:"fw-medium",children:[G.createdBy?.lastName,G.createdBy?.middleName?" "+G.createdBy?.middleName:""," ",G.createdBy?.firstName]}),s.jsx("small",{className:"text-muted",children:G.createdBy?.email})]})}),s.jsx("td",{className:"align-middle show-mobile",children:N(G.status)}),d==="incidents"&&s.jsx("td",{className:"align-middle hide-mobile",children:G.severity?T(G.severity):"N/A"}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:E(G.createdAt)})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Nt,{permission:De.VIEW_INCIDENT_FEEDBACK_REPORT_DETAILS,fallback:null,children:s.jsx(ae,{style:{backgroundColor:"#2c3e50",borderColor:"#2c3e50",color:"#fff",borderRadius:"8px",padding:"10px 20px",fontWeight:"500",fontSize:"14px",cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>M(G.id),onMouseOver:z=>{z.currentTarget.style.backgroundColor="#1a252f",z.currentTarget.style.borderColor="#1a252f"},onMouseOut:z=>{z.currentTarget.style.backgroundColor="#2c3e50",z.currentTarget.style.borderColor="#2c3e50"},children:"View details"})})})]},G.id)})]})]})})},oce=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=oce,document.head.appendChild(e)}const cce=()=>{const[e,t]=xi(),r=e.get("form")==="true",[a,n]=v.useState({requestType:"",severity:"MEDIUM",title:"",description:"",actionsTaken:"",isAnonymous:!1}),[i,l]=v.useState(!1),o=m=>{const{name:f,value:h,type:x,checked:p}=m.target;n(g=>({...g,[f]:x==="checkbox"?p:h}))},c=async m=>{if(m.preventDefault(),!a.requestType||!a.title||!a.description){te.error("Please fill in all required fields");return}l(!0);try{const f={requestType:a.requestType,title:a.title,description:a.description,actionsTaken:a.actionsTaken||"",severity:a.severity,isAnonymous:a.isAnonymous};await ga.createReport(f),te.success("Report submitted successfully!"),n({requestType:"",severity:"MEDIUM",title:"",description:"",actionsTaken:"",isAnonymous:!1}),t({})}catch(f){console.error("Error submitting report:",f);const h=f.response?.data?.message||"Failed to submit report. Please try again.";te.error(h)}finally{l(!1)}},u=()=>{t({form:"true"})},d=()=>{t({})};return r?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex align-items-center justify-content-start",children:s.jsx(ae,{variant:"outline-secondary",onClick:d,className:"me-3",children:"Back to List"})})})}),s.jsxs(ue,{className:"mt-4",children:[s.jsx(H,{lg:8,children:s.jsxs(Y,{className:"border-0 shadow-sm create-issue-form",children:[s.jsx(Y.Header,{children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(gt,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),s.jsx(Y.Body,{children:s.jsxs(_,{onSubmit:c,children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Title *"}),s.jsx(_.Control,{type:"text",name:"title",value:a.title,onChange:o,placeholder:"Brief description of the incident or feedback"})]})}),s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Request Type *"}),s.jsxs(_.Select,{name:"requestType",value:a.requestType,onChange:o,required:!0,children:[s.jsx("option",{value:"",children:"Select request type"}),s.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),s.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),s.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),s.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),s.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),s.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),s.jsx("option",{value:"FEEDBACK",children:"Feedback"})]})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Severity"}),s.jsxs(_.Select,{name:"severity",value:a.severity,onChange:o,children:[s.jsx("option",{value:"LOW",children:"Low"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Description *"}),s.jsx(_.Control,{as:"textarea",rows:4,name:"description",value:a.description,onChange:o,placeholder:"Please provide detailed information about the incident or feedback..."})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Actions Taken"}),s.jsx(_.Control,{as:"textarea",rows:3,name:"actionsTaken",value:a.actionsTaken,onChange:o,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),s.jsx(_.Group,{className:"mb-4",children:s.jsx(_.Check,{type:"checkbox",name:"isAnonymous",checked:a.isAnonymous,onChange:o,label:"Submit anonymously (your identity will be kept confidential)"})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(ae,{type:"submit",variant:"primary",disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(lS,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),s.jsx(H,{lg:4,children:s.jsxs(Y,{className:"border-0 shadow-sm create-issue-guidelines",children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Guidelines"})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Before submitting:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"Check if the incident has already been reported"}),s.jsx("li",{children:"Provide clear and specific details"}),s.jsx("li",{children:"Include steps to reproduce the incident"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Response time:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"High priority: Within 24 hours"}),s.jsx("li",{children:"Medium priority: Within 2-3 days"}),s.jsx("li",{children:"Low priority: Within 1 week"})]})]}),s.jsxs(Ue,{variant:"info",className:"small",children:[s.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]}):s.jsx(Zd,{source:"/reports/create",onShowForm:u})},dce=()=>{const{reportId:e}=Or(),t=ft(),r=na(),a=r.state?.from||"/reports",n=r.state?.tab||"incidents",i=a==="/reports/create",[l,o]=v.useState(null),[c,u]=v.useState(!0),[d,m]=v.useState(!1),[f,h]=v.useState(!1),[x,p]=v.useState(""),[g,j]=v.useState(!1),[w,y]=v.useState(!1);v.useEffect(()=>{(async()=>{try{u(!0);const G=await ga.getReportById(e);o(G)}catch(G){console.error("Error fetching report:",G),te.error("Failed to load report details")}finally{u(!1)}})()},[e]);const b=()=>{h(!0)},S=async()=>{try{y(!0),await ga.cancelReport(e),te.success("Report cancelled successfully"),h(!1),t(a)}catch(M){console.error("Error cancelling report:",M),te.error("Failed to cancel report")}finally{y(!1)}},E=async()=>{try{y(!0),await ga.acknowledgeReport(e),te.success("Report acknowledged successfully"),o(M=>({...M,status:"ACKNOWLEDGED"}))}catch(M){console.error("Error acknowledging report:",M),te.error("Failed to acknowledge report")}finally{y(!1)}},N=async()=>{if(!x.trim()){te.error("Please enter resolution notes");return}try{j(!0),await ga.respondToReport(e,x),te.success("Report resolved successfully"),m(!1),p(""),o(M=>({...M,status:"RESOLVED",response:x}))}catch(M){console.error("Error resolving report:",M),te.error("Failed to resolve report")}finally{j(!1)}},T=M=>M?new Date(M).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",k=()=>{t(i?"/reports/create":`/reports?tab=${n}`)},I=()=>i?l?.status!=="SUBMITTED"?null:s.jsx(ae,{variant:"danger",size:"sm",onClick:b,disabled:w,children:"Cancel"}):s.jsxs(s.Fragment,{children:[l?.status==="SUBMITTED"&&s.jsx(ae,{variant:"success",size:"sm",onClick:E,disabled:w,children:"Acknowledge"}),l?.status==="ACKNOWLEDGED"&&s.jsx(ae,{variant:"primary",size:"sm",onClick:()=>m(!0),disabled:w,children:"Resolve"})]}),D=M=>{const G={SUBMITTED:{variant:"warning",icon:rt,label:"Pending"},ACKNOWLEDGED:{variant:"primary",icon:it,label:"Acknowledged"},RESOLVED:{variant:"success",icon:it,label:"Resolved"},CANCELLED:{variant:"secondary",icon:zr,label:"Cancelled"},open:{variant:"danger",icon:Gt,label:"Open"},in_progress:{variant:"warning",icon:rt,label:"In Progress"},pending:{variant:"warning",icon:rt,label:"Pending"},acknowledged:{variant:"success",icon:it,label:"Acknowledged"},reviewed:{variant:"info",icon:it,label:"Reviewed"}},q=G[M]||G.open,z=q.icon;return s.jsxs(Ae,{bg:q.variant,className:"d-flex align-items-center",children:[s.jsx(z,{size:12,className:"me-1"}),q.label]})},A=M=>{const G={LOW:"info",MEDIUM:"secondary",HIGH:"danger",CRITICAL:"dark"};return s.jsx(Ae,{bg:G[M]||"secondary",children:M})};return c?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading report details..."})]})}):l?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:k,children:[s.jsx(Bt,{size:16,className:"me-2"}),i?"Back to Issue List":"Back to Reports"]}),s.jsx("div",{className:"d-flex gap-2",children:I()})]})})}),s.jsxs(ue,{children:[s.jsx(H,{lg:8,children:s.jsxs(Y,{className:"border-0 shadow-sm mb-4",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(gt,{className:"me-2",size:20}),"Report Details"]}),D(l.status)]})}),s.jsxs(Y.Body,{children:[s.jsxs(ue,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Title"}),s.jsx("h6",{className:"mb-0",children:l.title})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Request Type"}),s.jsx(Ae,{bg:"primary",children:l.requestType?.replace(/_/g," ")})]})})]}),s.jsx(ue,{className:"mb-3",children:s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Severity"}),A(l.severity)]})})}),s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Description"}),s.jsx("p",{className:"mb-0",style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},children:l.description})]}),l.actionsTaken&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Actions Taken"}),s.jsx("p",{className:"mb-0",style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},children:l.actionsTaken})]}),l.response&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Resolution Notes"}),s.jsx(Ue,{variant:"success",children:s.jsx("p",{className:"mb-0",style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},children:l.response})})]}),s.jsx("hr",{}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-2",children:[s.jsxs("small",{className:"text-muted d-block mb-1",children:[s.jsx(Lt,{size:12,className:"me-1"}),"Created By"]}),s.jsx("div",{children:l?.isAnonymous?s.jsx("span",{className:"text-muted",children:"Anonymous"}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"fw-medium",children:[l?.createdBy?.lastName,l?.createdBy?.middleName?" "+l?.createdBy?.middleName:""," ",l?.createdBy?.firstName]}),s.jsx("small",{className:"text-muted",children:l?.createdBy?.email})]})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-2",children:[s.jsxs("small",{className:"text-muted d-block mb-1",children:[s.jsx(or,{size:12,className:"me-1"}),"Created Date"]}),s.jsx("div",{children:T(l.createdAt)})]})})]})]})]})}),s.jsx(H,{lg:4,children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Report Information"})}),s.jsx(Y.Body,{children:l?.isAnonymous?s.jsx(Ue,{variant:"info",className:"mb-0",children:"This report was submitted anonymously."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Created By"}),s.jsxs("div",{children:[l?.createdBy?.lastName,l?.createdBy?.middleName?" "+l?.createdBy?.middleName:""," ",l?.createdBy?.firstName,s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:l?.createdBy?.email})]})]}),l?.managedBy&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Managed By"}),s.jsxs("div",{children:[l?.managedBy?.lastName,l?.managedBy?.middleName?" "+l?.managedBy?.middleName:""," ",l?.managedBy?.firstName,s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:l?.managedBy?.email})]})]})]})})]})})]}),s.jsxs(se,{show:f,onHide:()=>h(!1),centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Cancel Report"})}),s.jsx(se.Body,{children:s.jsx("p",{children:"Are you sure you want to cancel this report? This action cannot be undone."})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:()=>h(!1),disabled:w,children:"Keep Report"}),s.jsx(ae,{variant:"danger",onClick:S,disabled:w,children:w?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Cancelling..."]}):"Cancel Report"})]})]}),s.jsxs(se,{show:d,onHide:()=>{m(!1),p("")},children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Resolve Report - Add Resolution Notes"})}),s.jsx(se.Body,{children:s.jsx(_,{children:s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Resolution Notes *"}),s.jsx(_.Control,{as:"textarea",rows:6,value:x,onChange:M=>p(M.target.value),placeholder:"Enter details about how this issue was resolved...",required:!0}),s.jsx(_.Text,{className:"text-muted",children:"Please provide detailed information about the resolution of this issue."})]})})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:()=>{m(!1),p("")},disabled:g,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:N,disabled:!x.trim()||g,children:g?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resolving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"me-2",size:16}),"Resolve"]})})]})]})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx(Ue.Heading,{children:"Report Not Found"}),s.jsx("p",{children:"The requested report could not be found."}),s.jsx(ae,{variant:"outline-primary",onClick:()=>t(Pe.REPORTS),children:"Back to Reports"})]})})},uce=({template:e})=>{const r=(n=>{switch(n){case"ACTIVE":return{variant:"success",icon:it,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:rt,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:rt,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:rt,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:it,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:rt,text:"REJECTED"};default:return{variant:"secondary",icon:rt,text:n}}})(e?.status),a=r.icon;return s.jsx("div",{className:"p-4",children:s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:e?.version})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(Ae,{bg:r.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(a,{className:"me-1",size:12}),r.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[e?.totalSections||0," sections"]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"me-2",size:16}),s.jsx("span",{children:e?.lastModified?new Date(e.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})},mce=({sections:e=[]})=>{const t=v.useMemo(()=>{if(e.length===0)return[];console.log("TemplateConfigSchema - Sections from API:",e),e[0]?.fields&&console.log("First field structure:",e[0].fields[0]);const a=[];return e.forEach((n,i)=>{if(a.push({type:"section",id:n.id||`section-${i}`,name:n.label||n.name,fieldCount:n.fields?.length||0,data:n,isSubmittable:!!n.isSubmittable,isToggleDependent:!!n.isToggleDependent,level:0}),!n.fields||!Array.isArray(n.fields)||n.fields.length===0)return;const l={},o={},c={};n.fields.forEach(h=>{h.id&&(l[h.id]=h),h.tempId&&(o[h.tempId]=h);const x=h.fieldName||h.name;x&&(c[x]=h)});const u=h=>{if(h.parentId){const x=l[h.parentId];if(x)return x}if(h.parentTempId){const x=o[h.parentTempId];if(x)return x;const p=h.parentTempId.replace("-parent",""),g=c[p];if(g&&(g.fieldType==="PART"||g.fieldType==="CHECK_BOX"))return g}return null},d=[],m={};n.fields.forEach(h=>{const x=u(h);if(!x)d.push(h);else{const p=x.id||x.tempId||(x.fieldName?`${x.fieldName}-parent`:null);p?(m[p]||(m[p]=[]),m[p].push(h)):d.push(h)}});const f=(h,x=1)=>{const p=h.id||h.fieldName,g=h.id||h.tempId||(h.fieldName?`${h.fieldName}-parent`:null);a.push({type:"field",id:p||`field-${i}-${Date.now()}`,name:h.label||h.fieldName,parentSectionId:n.id||`section-${i}`,data:h,level:x}),g&&m[g]&&m[g].length>0&&m[g].forEach(j=>{f(j,x+1)})};d.forEach(h=>{f(h,1)})}),a},[e]);if(e.length===0)return s.jsx(Ue,{variant:"info",className:"mb-0",children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})});const r=a=>a===0?"16px":`${16+(a-1)*32}px`;return s.jsx("div",{children:s.jsx("div",{className:"list-group",style:{border:"none"},children:t.map(a=>{const n=a.type==="section",i=a.type==="field",l=a.level||0;return s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"white",paddingLeft:r(l)},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:[i&&l>1&&s.jsx("span",{style:{color:"#6c757d",marginRight:"8px",fontSize:"12px",userSelect:"none"},children:" "}),s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:n?500:400,wordBreak:"break-word",overflowWrap:"break-word"},children:a.name}),i&&(a.data?.fieldName||a.data?.name)&&s.jsx("span",{style:{fontSize:"12px",color:"#666",fontFamily:"Fira Mono, monospace",marginLeft:"8px",padding:"2px 6px",backgroundColor:"#f5f5f5",borderRadius:"3px",wordBreak:"break-word",overflowWrap:"break-word"},children:a.data.fieldName||a.data.name}),n&&a.fieldCount>0&&s.jsx(Ae,{bg:"info",className:"ms-2",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000"},children:a.fieldCount})]}),s.jsxs("div",{className:"d-flex align-items-center gap-1",style:{flexWrap:"wrap",justifyContent:"flex-end",flexShrink:0},children:[n&&s.jsxs("div",{className:"d-flex align-items-center gap-1",style:{flexWrap:"wrap"},children:[a.isSubmittable&&s.jsx(Ae,{bg:"success",style:{fontSize:"10px",padding:"3px 8px",borderRadius:"4px",backgroundColor:"#28a745",color:"#fff",fontWeight:500,whiteSpace:"nowrap"},children:"Submittable"}),a.isToggleDependent&&s.jsx(Ae,{bg:"info",style:{fontSize:"10px",padding:"3px 8px",borderRadius:"4px",backgroundColor:"#17a2b8",color:"#fff",fontWeight:500,whiteSpace:"nowrap"},children:"Toggle Dependent"})]}),s.jsx(Ae,{bg:n?"warning":"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:n?"#ffc107":"var(--bs-secondary)",color:n?"#000":"#fff",fontWeight:500,marginLeft:"12px"},children:n?"SECTION":a.data?.fieldType||a.data?.type||"FIELD"})]})]})},a.id)})})})},fce=({template:e,pdfUrl:t,loadingPDF:r})=>s.jsx("div",{className:"p-4",children:s.jsxs(ue,{children:[s.jsxs(H,{xs:12,lg:7,className:"mb-4",children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"PDF Preview"})}),r?s.jsx("div",{className:"border rounded p-4 bg-light text-center",style:{minHeight:"500px",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{children:[s.jsx(ot,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):t?s.jsx("div",{style:{height:"60vh",overflow:"hidden"},children:s.jsx("iframe",{src:`${t}#toolbar=0`,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block"},title:"Template PDF Preview"})}):s.jsxs(Ue,{variant:"warning",className:"mb-0",children:[s.jsx(Zs,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})]}),s.jsxs(H,{xs:12,lg:5,children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"Template fields & sections"})}),s.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:s.jsx(mce,{sections:e?.sections||[]})})]})]})}),hce=({template:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(!1),[i,l]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e?.referFirstVersionId){l("No previous version found");return}try{n(!0),l(null);const f=await Dt.getTemplateById(e.referFirstVersionId),h=f?.data?.templateForm||f?.data||f,x=f?.data?.sections||h?.sections||[];if(!h){l("Old version template not found");return}const p=h.createdByUser||h.createdBy,g=h.updatedByUser||h.updatedBy,j=y=>y?.firstName&&y?.lastName?`${y.lastName} ${y.firstName}`:y?.fullName||y?.name||"N/A",w={id:h.id,name:h.name||"N/A",description:h.description||"",version:h.version||"v1.0",totalSections:x.length||0,totalFields:x.reduce((y,b)=>y+(b.fields?.length||0),0)||0,status:h.status||"DRAFT",createdBy:j(p),createdAt:h.createdAt||h.createdDate,lastModified:h.updatedAt||h.updatedDate||h.createdAt,lastModifiedBy:j(g),sections:x,templateContent:h.templateContent||null,templateConfig:h.templateConfig||null,formId:h.formId||h.id};r(w)}catch(f){console.error("Error loading old version:",f),l(f.response?.data?.message||f.message||"Failed to load old version details")}finally{n(!1)}})()},[e?.referFirstVersionId]);const o=m=>{switch(m){case"ACTIVE":return{variant:"success",icon:it,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:rt,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:rt,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:rt,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:it,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:rt,text:"REJECTED"};default:return{variant:"secondary",icon:rt,text:m}}},c=()=>{t?.templateConfig?window.open(t.templateConfig,"_blank","noopener,noreferrer"):te.warning("Template config is not available")};if(a)return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading old version details..."})]})});if(i||!t)return s.jsx("div",{className:"p-4",children:s.jsxs(Ue,{variant:"info",children:[s.jsx(Ue.Heading,{children:"No Previous Version"}),s.jsx("p",{className:"mb-0",children:i||"This template does not have a previous version."})]})});const u=o(t.status),d=u.icon;return s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"d-flex justify-content-end gap-2 mb-4",children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:c,className:"d-flex align-items-center",disabled:!t?.templateConfig,children:[s.jsx(il,{className:"me-2",size:16}),"View Template Config"]})}),s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Template Information"})}),s.jsx(Y.Body,{children:s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Template Name"}),s.jsx("div",{className:"fw-medium",children:t.name})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Description"}),s.jsx("div",{children:t.description||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:t.version})})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(Ae,{bg:u.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(d,{className:"me-1",size:12}),u.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[t.totalSections," sections"]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Fields"}),s.jsxs("div",{className:"fw-medium",children:[t.totalFields," fields"]})]})]})]})})]}),s.jsxs(Y,{children:[s.jsx(Y.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Metadata"})}),s.jsx(Y.Body,{children:s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2",size:16}),s.jsx("span",{children:t.createdBy})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"me-2",size:16}),s.jsx("span",{children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModifiedBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModified?new Date(t.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})]})]})},pce=({show:e,onHide:t,template:r,onApprove:a,reviewing:n})=>s.jsxs(se,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(se.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(it,{className:"me-2",size:20}),"Approve Template"]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-0",children:["Are you sure you want to approve the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Once approved, the template will be published and available for use."})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"outline-secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:a,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"me-2",size:16}),"Approve"]})})]})]}),xce=({show:e,onHide:t,template:r,rejectComment:a,onRejectCommentChange:n,onReject:i,reviewing:l})=>s.jsxs(se,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(se.Header,{className:"bg-secondary text-white border-0",children:s.jsxs(se.Title,{className:"d-flex align-items-center",children:[s.jsx(zr,{className:"me-2",size:20}),"Reject Template"]})}),s.jsxs(se.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to reject the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:s.jsxs("strong",{children:["Reason for Rejection ",s.jsx("span",{className:"text-danger",children:"*"})]})}),s.jsx(_.Control,{as:"textarea",rows:4,value:a,onChange:o=>n(o.target.value),placeholder:"Please provide a reason for rejecting this template...",disabled:l}),s.jsx(_.Text,{className:"text-muted",children:"This comment will be visible to the template creator."})]})]}),s.jsxs(se.Footer,{className:"border-0",children:[s.jsx(ae,{variant:"outline-secondary",onClick:t,disabled:l,children:"Cancel"}),s.jsx(ae,{variant:"secondary",onClick:i,disabled:l||!a.trim(),className:"d-flex align-items-center",children:l?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(zr,{className:"me-2",size:16}),"Reject"]})})]})]}),L2=()=>{const{templateId:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("basic-info"),[d,m]=v.useState(null),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,j]=v.useState(!1),[w,y]=v.useState(""),[b,S]=v.useState(!1),[E,N]=v.useState(!1),T=v.useCallback(async()=>{if(!e){o("Template ID is required"),i(!1);return}try{i(!0),o(null);const ee=await Dt.getTemplateById(e),U=ee?.data?.templateForm||ee?.data||ee,X=ee?.data?.sections||U?.sections||[];if(!U){o("Template not found");return}const oe=U.createdByUser||U.createdBy,Ee=U.updatedByUser||U.updatedBy,F=C=>C?.firstName&&C?.lastName?`${C.lastName}${C.middleName?" "+C.middleName:""} ${C.firstName}`:C?.fullName||C?.name||"N/A",P={id:U.id,name:U.name||"N/A",description:U.description||"",version:U.version||"v1.0",category:U.category||"",totalSections:X.length||0,totalFields:X.reduce((C,W)=>C+(W.fields?.length||0),0)||0,status:U.status||"DRAFT",createdBy:F(oe),createdAt:U.createdAt||U.createdDate,lastModified:U.updatedAt||U.updatedDate||U.createdAt,lastModifiedBy:F(Ee),sections:X,history:U.history||U.versions||[],templateContent:U.templateContent||null,templateConfig:U.templateConfig||null,formId:U.formId||U.id,referFirstVersionId:U.referFirstVersionId||null};a(P)}catch(ee){console.error("Error loading template detail:",ee),o(ee.response?.data?.message||ee.message||"Failed to load template details")}finally{i(!1)}},[e]);v.useEffect(()=>{T()},[T]),v.useEffect(()=>{c==="preview"&&r?.id&&!d&&(async()=>{if(!r?.id){te.warning("Template ID is not available");return}try{h(!0);const U=r.id;console.log("Loading PDF config with ID:",U);const X=await Dt.getTemplatePdfConfig(U);console.log("PDF Blob received:",X),console.log("PDF Blob type:",X.type),console.log("PDF Blob size:",X.size);const oe=URL.createObjectURL(X);console.log("Created object URL:",oe),m(oe)}catch(U){console.error("Error loading PDF preview:",U),te.error("Failed to load PDF preview")}finally{h(!1)}})()},[c,r?.id,d]),v.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]);const k=async()=>{if(!r?.formId){te.warning("Template form ID is not available");return}try{N(!0);const ee=await Dt.getTemplatePDF(r.formId),U=URL.createObjectURL(ee),X=document.createElement("a");X.href=U,X.download=`${r.name||"template"}.pdf`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(U)}catch(ee){console.error("Error downloading PDF:",ee),te.error(ee.response?.data?.message||"Failed to download PDF")}finally{N(!1)}},I=()=>{t(Pe.TEMPLATES)},D=async()=>{if(r?.id)try{S(!0),await Dt.reviewTemplate(r.id,{action:"PUBLISHED"}),te.success("Template approved successfully"),p(!1),t(Pe.TEMPLATES)}catch(ee){console.error("Error approving template:",ee),te.error(ee.response?.data?.message||"Failed to approve template")}finally{S(!1)}},A=async()=>{if(r?.id){if(!w.trim()){te.warning("Please provide a reason for rejection");return}try{S(!0),await Dt.reviewTemplate(r.id,{action:"REJECTED",comment:w.trim()}),te.success("Template rejected successfully"),j(!1),y(""),t(Pe.TEMPLATES)}catch(ee){console.error("Error rejecting template:",ee),te.error(ee.response?.data?.message||"Failed to reject template")}finally{S(!1)}}},M=()=>{p(!0)},G=()=>{p(!1)},q=()=>{j(!0)},z=()=>{j(!1),y("")};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsxs(ae,{variant:"outline-danger",onClick:I,children:[s.jsx(Bt,{className:"me-2"}),"Back to Template List"]})]})}):r?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{xs:12,children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:I,className:"me-3",children:[s.jsx(Bt,{className:"me-1",size:16}),"Back to List"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1 text-dark",children:r.name}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsx(Nt,{permission:De.APPROVE_DENY_TEMPLATE,fallback:null,children:s.jsxs(ae,{variant:"success",size:"sm",onClick:M,className:"d-flex align-items-center",disabled:r?.status!=="PENDING"||b,children:[s.jsx(it,{className:"me-2",size:16}),"Approve"]})}),s.jsx(Nt,{permission:De.APPROVE_DENY_TEMPLATE,fallback:null,children:s.jsxs(ae,{variant:"danger",size:"sm",onClick:q,className:"d-flex align-items-center",disabled:r?.status!=="PENDING"||b,children:[s.jsx(zr,{className:"me-2",size:16}),"Reject"]})}),s.jsx(Nt,{permission:De.DOWNLOAD_TEMPLATE_AS_PDF,fallback:null,children:s.jsx(ae,{variant:"primary",size:"sm",onClick:k,className:"d-flex align-items-center",disabled:!r?.formId||E,style:{fontSize:"0.875rem",padding:"0.25rem 0.5rem",whiteSpace:"nowrap",minWidth:"auto"},children:E?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zs,{className:"me-2",size:16}),"Download PDF"]})})})]})]})})}),s.jsx(ue,{children:s.jsx(H,{xs:12,children:s.jsxs(Y,{className:"border-neutral-200 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:s.jsxs("div",{className:"custom-tabs",children:[s.jsx("button",{className:`custom-tab ${c==="basic-info"?"active":""}`,onClick:()=>u("basic-info"),children:"Basic Info"}),s.jsx("button",{className:`custom-tab ${c==="preview"?"active":""}`,onClick:()=>u("preview"),children:"Preview"}),s.jsx("button",{className:`custom-tab ${c==="old-version"?"active":""}`,onClick:()=>u("old-version"),children:"Old Template Version Details"})]})}),s.jsxs(Y.Body,{className:"p-0",children:[c==="basic-info"&&s.jsx(uce,{template:r}),c==="preview"&&s.jsx(fce,{template:r,pdfUrl:d,loadingPDF:f}),c==="old-version"&&s.jsx(hce,{template:r})]})]})})}),s.jsx(pce,{show:x,onHide:G,template:r,onApprove:D,reviewing:b}),s.jsx(xce,{show:g,onHide:z,template:r,rejectComment:w,onRejectCommentChange:y,onReject:A,reviewing:b})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx(Ue.Heading,{children:"Template Not Found"}),s.jsx("p",{children:"The requested template could not be found."}),s.jsxs(ae,{variant:"outline-warning",onClick:I,children:[s.jsx(Bt,{className:"me-2"}),"Back to Template List"]})]})})},gce=()=>{const e=ft(),[t,r]=v.useState("upcoming-assessments"),a=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:va,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:it,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:$t,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:On,path:Pe.TRAINER_CONFIGURE_SIGNATURE,color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:Zt,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:_c,path:Pe.ASSESSMENTS_RESULTS,color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:it,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(t){case"upcoming-assessments":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),s.jsxs(ue,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(va,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),s.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",children:[s.jsx(va,{size:16,className:"me-2"}),"Schedule Assessment"]}),s.jsxs(ae,{variant:"outline-success",size:"sm",children:[s.jsx(Zt,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Assessment Results"}),s.jsxs(ue,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Recent Results"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(it,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No recent results"}),s.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"Statistics"})}),s.jsx(Y.Body,{children:s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-primary",children:"0"}),s.jsx("small",{className:"text-muted",children:"Completed"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-warning",children:"0"}),s.jsx("small",{className:"text-muted",children:"Pending"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-success",children:"0"}),s.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),s.jsxs(ue,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"My Courses"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx($t,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No courses assigned"}),s.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(Y,{className:"h-100",children:[s.jsx(Y.Header,{className:"bg-warning text-white",children:s.jsx("h6",{className:"mb-0",children:"Course Management"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(ae,{variant:"outline-primary",size:"sm",children:[s.jsx($t,{size:16,className:"me-2"}),"View All Courses"]}),s.jsxs(ae,{variant:"outline-info",size:"sm",children:[s.jsx(rt,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsxs(H,{children:[s.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),s.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),s.jsxs(ue,{children:[s.jsx(H,{lg:3,className:"mb-4",children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Navigation"})}),s.jsx(Y.Body,{className:"p-0",children:s.jsx("div",{className:"list-group list-group-flush",children:a.map(l=>{const o=l.icon;return s.jsx("button",{className:`list-group-item list-group-item-action border-0 ${t===l.id?"active":""}`,onClick:()=>r(l.id),style:{backgroundColor:t===l.id?"#0d6efd":"transparent",color:t===l.id?"white":"inherit",border:"none",borderRadius:0},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(o,{size:20,className:"me-3",style:{color:t===l.id?"white":`var(--bs-${l.color})`}}),s.jsxs("div",{className:"flex-grow-1 text-start",children:[s.jsx("h6",{className:"mb-1",children:l.title}),s.jsx("small",{className:"text-muted",children:l.description})]}),s.jsx(vn,{size:16})]})},l.id)})})})]})}),s.jsx(H,{lg:9,children:s.jsx(Y,{className:"border-0 shadow-sm",children:s.jsx(Y.Body,{className:"p-4",children:i()})})})]}),s.jsx(ue,{className:"mt-4",children:s.jsx(H,{children:s.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),s.jsx(ue,{children:n.map((l,o)=>{const c=l.icon;return s.jsx(H,{lg:6,xl:3,className:"mb-4",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(l.path),onMouseEnter:u=>{u.currentTarget.style.transform="translateY(-5px)",u.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:u=>{u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(Y.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${l.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(c,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:l.title})}),s.jsx(vn,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:l.description})]})})},o)})})]})},Qm=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(Ct,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(Ct.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ll,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsx(Ct.Menu,{className:"course-filter-menu",style:{width:"100%",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"-1px",top:"100%",left:0,transform:"none",position:"absolute",borderTopLeftRadius:0,borderTopRightRadius:0},align:"start",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-start","bottom-start","top-end"]}}]},children:s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"})}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>s.jsx(_.Check,{type:"checkbox",id:`status-${l}`,label:l?.replace(/_/g," ")||l,checked:t.includes(l),onChange:()=>r(l),className:"mb-1"},l))})]})})]})},vce=()=>{const e=ft(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState(""),[u,d]=v.useState([]),[m,f]=v.useState("course");v.useEffect(()=>{(async()=>{try{n(!0),l(null);const I=await vr.getUserEvents();if(I?.success&&I?.data?.events){const D=I.data.events.map((A,M)=>{const G=new Date(A.occuranceDate),q=G.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),z=G.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),ee=A.entityInfo?.type||(A.subjectId?"subject":"course"),U=[A.courseId||"course",A.subjectId||"subject",A.templateInfo?.id||"template",A.name||"unnamed",A.occuranceDate||new Date().toISOString(),M].join("-");return{id:A.id||U,title:A.name,entityInfo:A.entityInfo,entityType:ee,entityId:ee==="course"?A.entityInfo?.id||A.courseId:A.entityInfo?.id||A.subjectId,entityName:A.entityInfo?.name||"N/A",entityCode:A.entityInfo?.code||"",courseName:ee==="course"?A.entityInfo?.name:null,courseCode:ee==="course"?A.entityInfo?.code:null,subjectName:ee==="subject"?A.entityInfo?.name:null,subjectCode:ee==="subject"?A.entityInfo?.code:null,traineeCount:A.totalTrainees||0,scheduledDate:q,scheduledTime:z,occurrenceDate:A.occuranceDate,status:A.status||"NOT_STARTED",templateInfo:A.templateInfo,resultScore:A.resultScore||null,resultText:A.resultText||null}});r(D)}else r([])}catch(I){console.error("Error fetching assessments:",I),l("Failed to load upcoming assessments"),te.error("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const h={NOT_STARTED:{variant:"secondary",text:"Not Started"},ON_GOING:{variant:"info",text:"On Going"},APPROVED:{variant:"success",text:"Approved"},COMPLETED:{variant:"success",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},DRAFT:{variant:"primary",text:"Draft"},SUBMITTED:{variant:"dark",text:"Submitted"},CANCELLED:{variant:"danger",text:"Cancelled"}},x=k=>{const I=h[k]||{variant:"secondary",text:k||"Unknown"};return s.jsx(Ae,{bg:I.variant,children:String(I.text).toUpperCase()})},p=async k=>{try{n(!0);const I=new Date(k.occurrenceDate).toISOString().split("T")[0];let D;const A={courseId:m==="course"?k.entityId:void 0,subjectId:m==="subject"?k.entityId:void 0,templateId:k.templateInfo?.id,occuranceDate:I};if(Object.keys(A).forEach(M=>A[M]===void 0&&delete A[M]),m==="course"?D=await vr.getCourseEvents(A):D=await vr.getSubjectEvents(A),D?.assessments&&D?.eventInfo){const M=new Date(k.occurrenceDate).toISOString().split("T")[0],G=new URLSearchParams({templateId:k.templateInfo?.id||"",occuranceDate:M});e(`${Pe.ASSESSMENTS_ASSIGN(m,k.entityId)}?${G.toString()}`,{state:{name:D.eventInfo?.name||k.entityName,code:D.eventInfo?.entityInfo?.code||k.entityCode,template:D.eventInfo?.name||k.templateInfo?.name,assessments:D.assessments,eventInfo:D.eventInfo,numberOfTrainees:D.numberOfTrainees||D.assessments?.length||0,numberOfParticipatedTrainers:D.numberOfParticipatedTrainers||0}})}else te.error("Failed to access assessment")}catch(I){console.error("Error accessing assessment:",I),te.error("Error accessing assessment")}finally{n(!1)}},g=[...new Set(t.map(k=>k.status))],j=t.filter(k=>{const I=u.length===0||u.includes(k.status),D=k.entityType===m,A=k.title.toLowerCase().includes(o.toLowerCase())||k.entityName.toLowerCase().includes(o.toLowerCase())||k.entityCode&&k.entityCode.toLowerCase().includes(o.toLowerCase());return I&&D&&A}),w=k=>{d(k==="clear"?[]:I=>I.includes(k)?I.filter(D=>D!==k):[...I,k])},y=()=>{d([]),c("")},{sortedData:b,sortConfig:S,handleSort:E}=ts(j);if(a)return s.jsx(Fr,{rows:5,columns:7});if(i)return s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(Button,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});const N=({columnKey:k,children:I,className:D=""})=>{const A=S.key===k,M=A?S.direction:null;return s.jsxs("th",{className:`fw-semibold ${D}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(k),onMouseEnter:G=>{G.target.style.backgroundColor="#214760",G.target.style.transform="translateY(-1px)",G.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:G=>{G.target.style.backgroundColor="var(--bs-primary)",G.target.style.transform="translateY(0)",G.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:A?"600":"500",color:"white"},children:I}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:M,size:14,color:"white"})})]}),A&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},T=new Set(["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"]);return s.jsxs("div",{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:5,md:4,className:"mb-2 mb-lg-0 ps-2 ps-lg-3",children:s.jsx(ra,{placeholder:"Search assessments, courses, or trainees...",value:o,onChange:c,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("label",{className:"text-muted small mb-0 me-2",children:"View:"}),s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-course",checked:m==="course",onChange:()=>f("course")}),s.jsxs("label",{className:`btn btn-sm ${m==="course"?"btn-primary-custom text-white":"btn-outline-primary"}`,htmlFor:"filter-course",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx($t,{size:14}),"Course"]}),s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-subject",checked:m==="subject",onChange:()=>f("subject")}),s.jsxs("label",{className:`btn btn-sm ${m==="subject"?"btn-secondary-custom text-white":"btn-outline-secondary"}`,htmlFor:"filter-subject",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx(J0,{size:14}),"Subject"]})]})]})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Qm,{uniqueStatuses:g,selectedStatuses:u,onStatusToggle:w,onClearFilters:y,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(N,{columnKey:"title",className:"show-mobile",children:"Assessment Events"}),s.jsx(N,{columnKey:"traineeCount",className:"show-mobile",children:"Trainees"}),s.jsx(N,{columnKey:"scheduledDate",className:"show-mobile",children:"Occurrence Date"}),s.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:b.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:"No upcoming assessments found"}),s.jsx("small",{children:"Try adjusting your search criteria or schedule a new assessment."})]})})}):b.map(k=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:k.title}),k.templateInfo&&s.jsxs("small",{className:"text-muted",children:[s.jsx(J0,{size:12,className:"me-1"}),k.templateInfo.name]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{children:[k.traineeCount," ",k.traineeCount===1?"trainee":"trainees"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium",children:k.scheduledDate})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:x(k.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:!T.has(k.status)&&s.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>p(k),disabled:a,children:a?"Processing...":"View details"})})]},k.id))})]})})]})},yce=()=>{const t=[{id:"upcoming-assessments",title:"Upcoming Assessment Events",icon:va,component:s.jsx(vce,{})}][0];return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0",children:[s.jsx(Y.Header,{className:"bg-primary text-white p-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(va,{size:20,className:"me-2"}),s.jsx("h5",{className:"mb-0",children:"Upcoming Assessment Events"})]})}),s.jsx(Y.Body,{className:"p-4",children:t&&t.component})]})})})})},bce=()=>{const e=ft(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:x,handleSort:p}=ts(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(A=>setTimeout(A,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{l("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=I=>{const A={completed:{variant:"success",text:"Completed",icon:it},failed:{variant:"danger",text:"Failed",icon:zr},inProgress:{variant:"warning",text:"In Progress",icon:rt},pending:{variant:"info",text:"Pending Review",icon:rt}}[I]||{variant:"secondary",text:I,icon:rt},M=A.icon;return s.jsxs(Ae,{bg:A.variant,className:"d-flex align-items-center",children:[s.jsx(M,{size:12,className:"me-1"}),A.text]})},j=I=>I.startsWith("A")?"success":I.startsWith("B")?"primary":I.startsWith("C")?"warning":I.startsWith("D")?"danger":"secondary",w=(I,D)=>{const A=I/D*100;return A>=90?"success":A>=80?"primary":A>=70?"warning":"danger"},y=[...new Set(t.map(I=>I.status))],b=t.filter(I=>{const D=m.length===0||m.includes(I.status),A=I.title.toLowerCase().includes(u.toLowerCase())||I.trainee.toLowerCase().includes(u.toLowerCase())||I.course.toLowerCase().includes(u.toLowerCase());return D&&A}),S=I=>{f(I==="clear"?[]:D=>D.includes(I)?D.filter(A=>A!==I):[...D,I])},E=()=>{f([]),d("")},N=I=>{e(`/trainer/assessment-details/${I}`)},T=I=>{console.log("Downloading result:",I)};if(a)return s.jsx(Fr,{rows:5,columns:7});if(i)return s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(ae,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment results found"}),s.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const k=({columnKey:I,children:D,className:A=""})=>{const M=x.key===I,G=M?x.direction:null;return s.jsxs("th",{className:`fw-semibold ${A}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>p(I),onMouseEnter:q=>{q.target.style.backgroundColor="#214760",q.target.style.transform="translateY(-1px)",q.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:q=>{q.target.style.backgroundColor="var(--bs-primary)",q.target.style.transform="translateY(0)",q.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:M?"600":"500",color:"white"},children:D}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:G,size:14,color:"white"})})]}),M&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search assessments, trainees, or courses...",value:u,onChange:d,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Qm,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:S,onClearFilters:E,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[b.length," result",b.length!==1?"s":""]})})})]}),b.length===0?s.jsx(Y,{className:"text-center py-5",children:s.jsxs(Y.Body,{children:[s.jsx(it,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No Results Found"}),s.jsx("p",{className:"text-muted",children:u||o!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(u||o!=="all")&&s.jsx(ae,{variant:"outline-primary",onClick:()=>{d(""),c("all")},children:"Clear Filters"})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(k,{columnKey:"title",className:"show-mobile",children:"Assessment"}),s.jsx(k,{columnKey:"course",className:"show-mobile",children:"Course"}),s.jsx(k,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),s.jsx(k,{columnKey:"score",className:"show-mobile",children:"Score"}),s.jsx(k,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),s.jsx(k,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),s.jsx(k,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:h.map(I=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:I.title}),s.jsxs("small",{className:"text-muted",children:["Attempt ",I.attempts,"  ",I.duration]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:I.course})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:I.trainee})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`fw-bold text-${w(I.score,I.maxScore)}`,children:[I.score,"/",I.maxScore]}),s.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(I.score/I.maxScore*100),"%)"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx(Ae,{bg:j(I.grade),className:"fs-6",children:I.grade})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{children:s.jsx("div",{className:"fw-medium",children:I.completedDate})})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(I.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>N(I.id)},{label:"Download Report",icon:s.jsx(il,{}),onClick:()=>T(I.id)}]})})]},I.id))})]})})]})},jce=()=>s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(bce,{})}),wce=()=>{const e=ft(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:x,handleSort:p}=ts(t);v.useEffect(()=>{(async()=>{try{n(!0),l(null);const T=await xn.getProfile();if(!T||!T.teachingCourses||!Array.isArray(T.teachingCourses)){r([]),n(!1);return}const k=A=>A,I=A=>A?new Date(A).toISOString().split("T")[0]:"N/A",D=T.teachingCourses.map(A=>({id:A.id,title:A.name||"Unnamed Course",code:A.code||"N/A",status:k(A.status),startDate:I(A.startDate),endDate:I(A.endDate)}));r(D)}catch(T){console.error("Error fetching instructed courses:",T),l(T?.response?.data?.message||T?.message||"Failed to load instructed courses"),r([])}finally{n(!1)}})()},[]);const g=N=>{const k={ON_GOING:{variant:"success",text:"ON GOING"},PLANNED:{variant:"primary",text:"PLANNED"},COMPLETED:{variant:"secondary",text:"COMPLETED"},PAUSED:{variant:"warning",text:"PAUSED"},CANCELLED:{variant:"danger",text:"CANCELLED"},ARCHIVED:{variant:"secondary",text:"ARCHIVED"}}[N]||{variant:"secondary",text:N?.replace(/_/g," ")||N};return s.jsx(Ae,{bg:k.variant,children:k.text})},j=[...new Set(t.map(N=>N.status))],w=t.filter(N=>{const T=m.length===0||m.includes(N.status),k=N.title.toLowerCase().includes(u.toLowerCase())||N.code.toLowerCase().includes(u.toLowerCase());return T&&k}),y=N=>{f(N==="clear"?[]:T=>T.includes(N)?T.filter(k=>k!==N):[...T,N])},b=()=>{f([]),d("")},S=N=>{e(Pe.COURSES_DETAIL(N))};if(a)return s.jsx(Fr,{rows:5,columns:7});if(i)return s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(ae,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No instructed courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const E=({columnKey:N,children:T,className:k=""})=>{const I=x.key===N,D=I?x.direction:null;return s.jsxs("th",{className:`fw-semibold ${k}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>p(N),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:I?"600":"500",color:"white"},children:T}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:D,size:14,color:"white"})})]}),I&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search courses, codes, or departments...",value:u,onChange:d,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Qm,{uniqueStatuses:j,selectedStatuses:m,onStatusToggle:y,onClearFilters:b,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),w.length===0?s.jsx(Y,{className:"text-center py-5",children:s.jsxs(Y.Body,{children:[s.jsx("h5",{className:"text-muted",children:"No Courses Found"}),s.jsx("p",{className:"text-muted",children:u||o!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),u||m.length>0?s.jsx(ae,{variant:"outline-primary",onClick:b,children:"Clear Filters"}):null]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(E,{columnKey:"title",className:"show-mobile",children:"Course"}),s.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:h.map(N=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:N.title}),s.jsx("small",{className:"text-muted",children:N.code}),N.startDate!=="N/A"&&N.endDate!=="N/A"&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[N.startDate," - ",N.endDate]})]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(N.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx("div",{className:"d-flex justify-content-center",children:s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>S(N.id),children:"View Course Detail"})})})]},N.id))})]})})]})},Nce=()=>s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(wce,{})}),Sce=()=>{const{traineeId:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),a({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(d){o("Failed to load trainee details"),console.error("Error fetching trainee:",d)}finally{i(!1)}})()},[e]);const c=u=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[u]||{variant:"secondary",text:"Unknown"};return s.jsx(Ae,{bg:m.variant,children:m.text})};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):r?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(Bt,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:r.name}),s.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(Lt,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),c(r.status)]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx($t,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Courses"}),s.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(or,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Enrolled"}),s.jsx("h4",{className:"mb-0 text-warning",children:r.enrollmentDate}),s.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Contact Information"})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(Vi,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Email:"})," ",r.email]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Position:"})," ",r.position]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Last Activity:"})," ",r.lastActivity]})]})]})}),s.jsx(H,{md:6,children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Current Courses"})}),s.jsx(Y.Body,{children:r.currentCourses.map(u=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[s.jsx("h6",{className:"mb-0",children:u.name}),s.jsxs("small",{className:"text-muted",children:[u.progress,"%"]})]}),s.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${u.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:["Instructor: ",u.instructor]})]},u.id))})]})})]}),s.jsx(ue,{children:s.jsx(H,{children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Certifications"})}),s.jsx(Y.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Certification"}),s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:r.certifications.map((u,d)=>s.jsxs("tr",{children:[s.jsx("td",{children:u.name}),s.jsx("td",{children:u.date}),s.jsx("td",{children:c(u.status)})]},d))})]})})})]})})})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx(Ue.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},Ece=({subjectId:e})=>{const t=ft(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(k=>setTimeout(k,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(T){o("Failed to load trainees in subject"),console.error("Error fetching trainees:",T)}finally{i(!1)}})()},[e]);const f=N=>{const k={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[N]||{variant:"secondary",text:"Unknown"};return s.jsx(Ae,{bg:k.variant,children:k.text})},h=N=>{t(Pe.USERS_DETAIL(N))},x=N=>{console.log("Send message to trainee:",N)},p=[...new Set(r.map(N=>N.status))],g=r.filter(N=>{const T=d.length===0||d.includes(N.status),k=N.name.toLowerCase().includes(c.toLowerCase())||N.email.toLowerCase().includes(c.toLowerCase())||N.employeeId.toLowerCase().includes(c.toLowerCase())||N.department.toLowerCase().includes(c.toLowerCase());return T&&k}),j=N=>{m(N==="clear"?[]:T=>T.includes(N)?T.filter(k=>k!==N):[...T,N])},w=()=>{m([]),u("")},{sortedData:y,sortConfig:b,handleSort:S}=ts(g);if(n)return s.jsx(Fr,{rows:5,columns:7});if(l)return s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsx(ae,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const E=({columnKey:N,children:T,className:k=""})=>{const I=b.key===N,D=I?b.direction:null;return s.jsxs("th",{className:`fw-semibold ${k}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(N),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:I?"600":"500",color:"white"},children:T}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:D,size:14,color:"white"})})]}),I&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(ue,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search trainees in this subject...",value:c,onChange:u,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Qm,{uniqueStatuses:p,selectedStatuses:d,onStatusToggle:j,onClearFilters:w,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(E,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(E,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(E,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(E,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx(E,{columnKey:"score",className:"hide-mobile",children:"Score"}),s.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.map(N=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:N.name}),s.jsxs("small",{className:"text-muted",children:[s.jsx(Vi,{size:12,className:"me-1"}),N.email]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:N.employeeId})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-muted",children:N.department})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:N.score?s.jsxs(Ae,{bg:N.score>=80?"success":N.score>=60?"warning":"danger",children:[N.score,"%"]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:[{label:"View Trainee Details",icon:s.jsx(tr,{}),onClick:()=>h(N.id)},{label:"Send Message",icon:s.jsx(Vi,{}),onClick:()=>x(N.id)}]})})]},N.id))})]})})]})},Tce=()=>{const{subjectId:e}=Or(),t=ft(),[r,a]=v.useState("trainees"),[n,i]=v.useState(null),[l,o]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{o(!0),await new Promise(p=>setTimeout(p,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(x){u("Failed to load subject details"),console.error("Error fetching subject:",x)}finally{o(!1)}})()},[e]);const d=h=>{const p={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[h]||{variant:"secondary",text:"Unknown"};return s.jsx(Ae,{bg:p.variant,children:p.text})},m=[{id:"trainees",title:"Trainee List",icon:Lt,component:s.jsx(Ece,{subjectId:e})}],f=m.find(h=>h.id===r);return l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):n?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(Bt,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.title}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(rt,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Duration"}),s.jsxs("h4",{className:"mb-0 text-primary",children:[n.duration," day(s)"]}),s.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(Lt,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Trainees"}),s.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx(it,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),d(n.status)]})})})]}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Subject Information"})}),s.jsxs(Y.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx($t,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(rt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),s.jsx(H,{md:6,children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Materials"})}),s.jsx(Y.Body,{children:n.materials.map((h,x)=>s.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"fw-medium",children:h.name}),s.jsx("small",{className:"text-muted d-block",children:h.type})]}),s.jsx("small",{className:"text-muted",children:h.size})]},x))})]})})]}),s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(Y,{children:[s.jsx(Y.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments"})}),s.jsx(Y.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Max Score"}),s.jsx("th",{children:"Average Score"})]})}),s.jsx("tbody",{children:n.assessments.map((h,x)=>s.jsxs("tr",{children:[s.jsx("td",{children:h.name}),s.jsx("td",{children:h.type}),s.jsx("td",{children:h.maxScore}),s.jsx("td",{children:h.averageScore})]},x))})]})})})]})})}),s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0",children:[s.jsx(Y.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const x=h.icon,p=r===h.id;return s.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>a(h.id),children:[s.jsx(x,{size:16,className:"me-2"}),h.title]},h.id)})})}),s.jsx(Y.Body,{className:"p-0",children:f&&f.component})]})})})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx(Ue.Heading,{children:"Subject Not Found"}),s.jsx("p",{children:"The requested subject could not be found."})]})})},Cce=`
  .signature-card .card-body {
    height: 400px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
  }

  @media (max-width: 991px) {
    .signature-card .card-body {
      height: 380px !important;
    }
  }

  @media (max-width: 767px) {
    .signature-card .card-body {
      height: 360px !important;
    }
  }

  @media (max-width: 575px) {
    .signature-card .card-body {
      height: 340px !important;
    }
  }

  .signature-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
  }

  .signature-buttons {
    width: 100%;
    margin-top: auto;
    padding-top: 1rem;
  }
`,Ace=()=>{const e=ft(),[t,r]=v.useState(null),[a,n]=v.useState(null),[i,l]=v.useState(!0),[o,c]=v.useState(!1);v.useEffect(()=>{(async()=>{try{l(!0);const x=await xn.getProfile();x?.signatureImageUrl&&n(x.signatureImageUrl)}catch(x){console.error("Failed to fetch profile:",x)}finally{l(!1)}})()},[]);const u=h=>{r(h)},d=h=>new Promise(x=>{const p=new Image;p.onload=()=>{const g=document.createElement("canvas");g.width=350,g.height=200;const j=g.getContext("2d");j.clearRect(0,0,350,200),j.drawImage(p,0,0,350,200),x(g.toDataURL("image/png"))},p.src=h}),m=async()=>{if(!t){te.warning("Please draw your signature first.");return}c(!0);try{const h=await d(t),p=await(await fetch(h)).blob(),g=new File([p],`signature-${Date.now()}.png`,{type:"image/png"}),j=await an.uploadImage(g,"signature");let w="";if(typeof j=="string"?w=j:j?.url?w=j.url:j?.data?.[0]?.url&&(w=j.data[0].url),!w)throw new Error("Failed to get signature URL from upload response");console.log(" Signature uploaded to S3:",w),await xn.updateSignature(w);const y=await xn.getProfile();y?.signatureImageUrl&&n(y.signatureImageUrl),te.success("Signature saved successfully!"),r(null)}catch(h){console.error("Error saving signature:",h);const x=h.response?.data?.message||h.message||"Failed to save signature. Please try again.";te.error(x)}finally{c(!1)}},f=()=>{e(Pe.PROFILE)};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:Cce}),s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex align-items-center mb-3",children:s.jsxs(ae,{variant:"outline-secondary",onClick:f,className:"me-3",children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back to Profile"]})})})}),s.jsxs(ue,{children:[s.jsx(H,{lg:6,md:12,sm:12,xs:12,className:"mb-4",children:s.jsxs(Y,{className:"signature-card",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(On,{size:20,className:"me-2"}),"Your Signature"]})}),s.jsx(Y.Body,{className:"p-4",children:s.jsx("div",{className:"signature-content",children:i?s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",role:"status",className:"mb-3",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"text-muted",children:"Loading your current signature..."})]}):a?s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{width:"350px",height:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("img",{src:a,alt:"Current Signature",style:{width:"100%",height:"100%",objectFit:"contain"}})}),s.jsx("p",{className:"text-muted mt-3 text-center",children:s.jsx("small",{children:"Your current digital signature"})})]}):s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("p",{children:"No signature configured yet"}),s.jsx("p",{className:"small",children:"Draw your signature on the right to get started"})]})})})]})}),s.jsx(H,{lg:6,md:12,sm:12,xs:12,className:"mb-4",children:s.jsxs(Y,{className:"signature-card",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(On,{size:20,className:"me-2"}),"Config Signature"]})}),s.jsxs(Y.Body,{className:"p-4",children:[s.jsxs("div",{className:"signature-content",children:[s.jsx("p",{className:"text-muted mb-4 w-100 text-center",children:"Draw your signature in the box below using your mouse or touch device."}),s.jsx("div",{children:s.jsx(Jm,{onSignatureChange:u,width:350,height:200})})]}),s.jsxs("div",{className:"signature-buttons d-flex justify-content-end gap-2",children:[s.jsx(ae,{variant:"outline-secondary",onClick:f,disabled:o,children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:m,disabled:!t||o,children:o?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{size:16,className:"me-2"}),"Save Signature"]})})]})]})]})})]})]})]})},_ce=()=>{const{resultId:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("overview");v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(y=>setTimeout(y,1e3)),a({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(w){o("Failed to fetch assessment details."),console.error(w)}finally{i(!1)}})()},[e]);const d=(j,w)=>{const y=j/w*100;return y>=80?"success":y>=60?"warning":"danger"},m=j=>j.includes("A")?"success":j.includes("B")?"info":j.includes("C")?"warning":"danger",f=j=>{const w={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},y=w[j]||w.pending;return s.jsx(Ae,{bg:y.bg,children:y.text})},h=()=>{console.log("Downloading report for result:",e)},x=()=>{t(Pe.TRAINER_APPROVAL_NOTES(e))};if(n)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Fr,{height:400})})})});if(l)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Ue,{variant:"danger",children:l})})})});if(!r)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Ue,{variant:"info",children:"Assessment result not found"})})})});const p=[{id:"overview",title:"Assessment Overview",icon:gt,component:s.jsx("div",{className:"p-4",children:s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${d(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(Ae,{bg:m(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Status"}),f(r.status)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:dS,component:s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),s.jsx("tbody",{children:r.sections.map(j=>s.jsxs("tr",{children:[s.jsx("td",{className:"fw-bold",children:j.name}),s.jsx("td",{children:s.jsxs("span",{className:`fw-bold text-${d(j.score,j.maxScore)}`,children:[j.score,"/",j.maxScore]})}),s.jsx("td",{children:f(j.status)}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rt,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:j.timeSpent})]})})]},j.id))})]})})}],g=p.find(j=>j.id===c);return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:()=>t(Pe.ASSESSMENTS_RESULTS),children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back to Results"]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(ae,{variant:"outline-primary",onClick:h,children:[s.jsx(il,{size:16,className:"me-2"}),"Download Report"]}),s.jsxs(ae,{variant:"outline-secondary",onClick:x,children:[s.jsx(tr,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),s.jsx(ue,{children:s.jsx(H,{children:s.jsxs(Y,{className:"border-0",children:[s.jsx(Y.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:p.map(j=>{const w=j.icon,y=c===j.id;return s.jsxs("button",{className:`custom-tab ${y?"active":""}`,onClick:()=>u(j.id),children:[s.jsx(w,{size:16,className:"me-2"}),j.title]},j.id)})})}),s.jsx(Y.Body,{className:"p-0",children:g&&g.component})]})})})]})},kce={NOT_STARTED:{variant:"secondary",text:"NOT STARTED"},ON_GOING:{variant:"info",text:"ON GOING"},APPROVED:{variant:"success",text:"APPROVED"},COMPLETED:{variant:"success",text:"COMPLETED"},PENDING:{variant:"warning",text:"PENDING"},DRAFT:{variant:"primary",text:"DRAFT"},SUBMITTED:{variant:"dark",text:"SUBMITTED"},CANCELLED:{variant:"danger",text:"CANCELLED"}},Ice=e=>{const t=kce[e]||{variant:"secondary",text:e||"Unknown"};return s.jsx("span",{className:`badge bg-${t.variant}`,children:t.text})},s0=e=>e?e.replace(/_/g," "):"",El=e=>{if(!e)return{date:"",time:""};const t=new Date(e);return{date:t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),time:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}},a0=()=>{const{entityType:e,entityId:t}=Or(),r=na(),a=ft(),[n]=xi(),[i,l]=v.useState({loading:!0,error:null,info:r.state||null,assessments:[],eventInfo:null,numberOfTrainees:0,numberOfParticipatedTrainers:0}),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(!1),[h,x]=v.useState(!0),[p,g]=v.useState(!0),j=e==="course"||e==="subject";if(v.useEffect(()=>{(async()=>{if(!t||!j){l(A=>({...A,loading:!1,error:"Invalid assessment context"}));return}const k=r.state?.shouldRefresh;if(!k&&r.state?.assessments&&r.state?.eventInfo){l({loading:!1,error:null,assessments:r.state.assessments||[],info:{name:r.state.eventInfo?.entityInfo?.name||r.state.name,code:r.state.eventInfo?.entityInfo?.code||r.state.code},eventInfo:r.state.eventInfo||null,numberOfTrainees:r.state.numberOfTrainees||r.state.assessments?.length||0,numberOfParticipatedTrainers:r.state.numberOfParticipatedTrainers||0});return}const I=r.state?.templateId||n.get("templateId"),D=r.state?.occuranceDate||n.get("occuranceDate");if(!I||!D){l({loading:!1,error:'Please access this page through the "Access" button from the assessment list.',assessments:[],info:r.state||null});return}try{l(G=>({...G,loading:!0,error:null}));let A;const M={courseId:e==="course"?t:void 0,subjectId:e==="subject"?t:void 0,templateId:I,occuranceDate:D};Object.keys(M).forEach(G=>M[G]===void 0&&delete M[G]),e==="course"?A=await vr.getCourseEvents(M):A=await vr.getSubjectEvents(M),A?.assessments&&A?.eventInfo?l({loading:!1,error:null,assessments:A.assessments||[],info:{name:A.eventInfo?.entityInfo?.name||A.eventInfo?.name,code:A.eventInfo?.entityInfo?.code||""},eventInfo:A.eventInfo||null,numberOfTrainees:A.numberOfTrainees||A.assessments?.length||0,numberOfParticipatedTrainers:A.numberOfParticipatedTrainers||0}):l({loading:!1,error:null,assessments:[],info:r.state||null,numberOfTrainees:0,numberOfParticipatedTrainers:0}),k&&window.history.replaceState({},document.title)}catch(A){console.error("Error loading assessments:",A),te.error("Failed to load assessments"),l(M=>({...M,loading:!1,error:A.response?.data?.message||A.message||"Failed to load assessments"}))}})()},[e,t,j,r.key,n]),v.useEffect(()=>()=>{u&&u.startsWith("blob:")&&URL.revokeObjectURL(u)},[u]),!j)return s.jsx(Be,{className:"py-4",children:s.jsx(Ue,{variant:"danger",children:"Invalid assessment type."})});const w=T=>{if(["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"].includes(T.status))return;const I=r.state?.templateId||n.get("templateId"),D=r.state?.occuranceDate||n.get("occuranceDate");a(Pe.ASSESSMENTS_SECTIONS(T.id),{state:{returnPath:r.pathname+r.search,entityType:e,entityId:t,templateId:I,occuranceDate:D,info:i.info}})},y=async(T,k=null)=>{try{f(!0),c(!0);let I=null;if(k)try{const D=await Dt.getTemplatePDF(k);I=URL.createObjectURL(D),d(I)}catch(D){if(console.error("Error loading PDF from template API:",D),T)try{const M=await(await fetch(T)).blob();I=URL.createObjectURL(M),d(I)}catch(A){console.error("Error fetching PDF as blob:",A),d(T)}else te.error("Failed to load PDF"),c(!1)}else if(T)try{const D=await fetch(T,{method:"GET",headers:{Accept:"application/pdf"}});if(D.ok){const A=await D.blob();I=URL.createObjectURL(A),d(I)}else d(T)}catch(D){console.error("Error fetching PDF as blob:",D),d(T)}else te.error("No PDF URL available"),c(!1)}catch(I){console.error("Error in handleViewPDF:",I),te.error("Failed to load PDF"),c(!1)}finally{f(!1)}},b=()=>{c(!1),u&&u.startsWith("blob:")&&URL.revokeObjectURL(u),d(null),f(!1)},E=(()=>{const T=i.assessments.length;let k=0,I=0;return i.assessments.forEach(D=>{const A=String(D.resultText||"").toUpperCase().trim();A==="PASSED"||A==="PASS"?k++:(A==="FAILED"||A==="FAIL")&&I++}),{total:T,passed:k,failed:I}})(),N=i.eventInfo||r.state?.eventInfo;return s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3 flex-wrap gap-3",children:[s.jsxs(ae,{variant:"outline-secondary",className:"d-flex align-items-center justify-content-center",onClick:()=>a(-1),children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back"]}),s.jsx("div",{children:s.jsx("h4",{className:"mb-1",children:"Assessment Event Details"})})]}),!i.loading&&!i.error&&s.jsxs(Y,{className:"shadow-sm mb-4",children:[s.jsxs(Y.Header,{className:"bg-primary text-white p-3 d-flex justify-content-between align-items-center",style:{cursor:"pointer"},onClick:()=>x(!h),children:[s.jsx("h5",{className:"mb-0",children:"General Information"}),s.jsx(sn,{size:20,style:{transition:"transform 0.3s ease",transform:h?"rotate(0deg)":"rotate(-90deg)"}})]}),s.jsx(i0,{in:h,style:{transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",maxHeight:h?"2000px":"0px",overflow:"hidden"},children:s.jsxs(Y.Body,{children:[s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2 fw-bold",style:{color:"#064681ff",backgroundColor:"#daefffff",padding:"8px 12px",borderRadius:"6px",display:"inline-block"},children:"Event Details"}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.95rem"},children:"Event Name:"})," ",s.jsx("span",{className:"fw-semibold",children:N?.name||i.assessments[0]?.name||""})]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.95rem"},children:"Occurrence Date:"})," ",s.jsx("span",{className:"fw-semibold",children:N?.occuranceDate||N?.occurrenceDate||i.assessments[0]?.occuranceDate?El(N?.occuranceDate||N?.occurrenceDate||i.assessments[0]?.occuranceDate).date:""})]}),s.jsxs("div",{className:"mb-3 mt-3",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.95rem"},children:"Total Participated Trainers:"})," ",s.jsxs(Ae,{bg:"dark",className:"px-3 py-2",children:[i.numberOfParticipatedTrainers," Trainer",i.numberOfParticipatedTrainers!==1?"s":""]})]})]})}),s.jsx(H,{md:6,children:N?.templateInfo&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2 fw-bold",style:{color:"#064681ff",backgroundColor:"#daefffff",padding:"8px 12px",borderRadius:"6px",display:"inline-block"},children:"Template Information"}),s.jsxs("div",{className:"small",children:[s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Template Name:"})," ",s.jsx("span",{className:"fw-medium",children:N.templateInfo.name||""})]}),N.templateInfo.version!==null&&N.templateInfo.version!==void 0&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Version:"})," ",s.jsxs("span",{className:"fw-medium",children:["v",N.templateInfo.version.toFixed(1)]})]}),N.templateInfo.status&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Status:"})," ",s.jsx(Ae,{bg:N.templateInfo.status==="PUBLISHED"?"success":"secondary",className:"ms-1",children:s0(N.templateInfo.status)})]}),N.templateInfo.description&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Description:"})," ",s.jsx("span",{className:"fw-medium",children:N.templateInfo.description})]}),N.templateInfo.templateContent&&s.jsx("div",{className:"mb-1 mt-2",children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>y(N.templateInfo.templateContent,N.templateInfo.id),disabled:m,className:"d-inline-flex align-items-center",children:[s.jsx(Zs,{className:"me-1",size:14}),m?"Loading...":"View Template PDF"]})})]})]})})]}),(N?.courseInfo||N?.subjectInfo?.course)&&s.jsxs(ue,{className:"mt-3",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2 fw-bold",style:{color:"#064681ff",backgroundColor:"#daefffff",padding:"8px 12px",borderRadius:"6px",display:"inline-block"},children:N?.subjectInfo?"Parent Course Information":"Course Information"}),s.jsxs("div",{className:"small",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"fw-semibold d-block mb-1",children:(N.subjectInfo?.course||N.courseInfo).name||""}),(N.subjectInfo?.course||N.courseInfo).code&&s.jsx(Ae,{bg:"secondary",className:"me-1 mb-1",children:(N.subjectInfo?.course||N.courseInfo).code})]}),(N.subjectInfo?.course||N.courseInfo).description&&s.jsx("div",{className:"mb-2 text-muted",style:{fontSize:"0.875rem"},children:(N.subjectInfo?.course||N.courseInfo).description}),s.jsxs("div",{className:"mb-2",children:[(N.subjectInfo?.course||N.courseInfo).status&&s.jsx(Ae,{bg:(N.subjectInfo?.course||N.courseInfo).status==="ON_GOING"||(N.subjectInfo?.course||N.courseInfo).status==="PUBLISHED"?"success":"secondary",className:"me-1",children:s0((N.subjectInfo?.course||N.courseInfo).status)}),(N.subjectInfo?.course||N.courseInfo).level&&s.jsx(Ae,{bg:"info",className:"text-dark me-1",children:(N.subjectInfo?.course||N.courseInfo).level})]}),(N.subjectInfo?.course||N.courseInfo).maxNumTrainee&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Max Trainees:"})," ",s.jsx("span",{className:"fw-medium",children:(N.subjectInfo?.course||N.courseInfo).maxNumTrainee})]}),(N.subjectInfo?.course||N.courseInfo).venue&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Venue:"})," ",s.jsx("span",{className:"fw-medium",children:(N.subjectInfo?.course||N.courseInfo).venue})]}),(N.subjectInfo?.course||N.courseInfo).note&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Note:"})," ",s.jsx("span",{className:"fw-medium",children:(N.subjectInfo?.course||N.courseInfo).note})]}),(N.subjectInfo?.course||N.courseInfo).passScore!==null&&(N.subjectInfo?.course||N.courseInfo).passScore!==void 0&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Pass Score:"})," ",s.jsx("span",{className:"fw-medium",children:(N.subjectInfo?.course||N.courseInfo).passScore})]}),(N.subjectInfo?.course||N.courseInfo).startDate&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Start Date:"})," ",s.jsx("span",{className:"fw-medium",children:El((N.subjectInfo?.course||N.courseInfo).startDate).date})]}),(N.subjectInfo?.course||N.courseInfo).endDate&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"End Date:"})," ",s.jsx("span",{className:"fw-medium",children:El((N.subjectInfo?.course||N.courseInfo).endDate).date})]}),(N.subjectInfo?.course||N.courseInfo).department&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Department:"})," ",s.jsxs("span",{className:"fw-medium",children:[(N.subjectInfo?.course||N.courseInfo).department.name||"",(N.subjectInfo?.course||N.courseInfo).department.code&&s.jsxs("span",{className:"text-muted ms-1",children:["(",(N.subjectInfo?.course||N.courseInfo).department.code,")"]})]})]})]})]})}),s.jsx(H,{md:6,children:N?.subjectInfo&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2 fw-bold",style:{color:"#064681ff",backgroundColor:"#daefffff",padding:"8px 12px",borderRadius:"6px",display:"inline-block"},children:"Subject Information"}),s.jsxs("div",{className:"small",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"fw-semibold d-block mb-1",children:N.subjectInfo.name||""}),N.subjectInfo.code&&s.jsx(Ae,{bg:"secondary",className:"me-1 mb-1",children:N.subjectInfo.code})]}),N.subjectInfo.description&&s.jsx("div",{className:"mb-2 text-muted",style:{fontSize:"0.875rem"},children:N.subjectInfo.description}),s.jsxs("div",{className:"mb-2",children:[N.subjectInfo.status&&s.jsx(Ae,{bg:N.subjectInfo.status==="ON_GOING"||N.subjectInfo.status==="PUBLISHED"?"success":"secondary",className:"me-1",children:s0(N.subjectInfo.status)}),N.subjectInfo.method&&s.jsx(Ae,{bg:"info",className:"me-1",children:N.subjectInfo.method}),N.subjectInfo.type&&s.jsx(Ae,{bg:"primary",className:"me-1",children:N.subjectInfo.type})]}),N.subjectInfo.duration&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Duration:"})," ",s.jsxs("span",{className:"fw-medium",children:[N.subjectInfo.duration," day(s)"]})]}),N.subjectInfo.passScore!==null&&N.subjectInfo.passScore!==void 0&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Pass Score:"})," ",s.jsx("span",{className:"fw-medium",children:N.subjectInfo.passScore})]}),N.subjectInfo.startDate&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"Start Date:"})," ",s.jsx("span",{className:"fw-medium",children:El(N.subjectInfo.startDate).date})]}),N.subjectInfo.endDate&&s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"fw-bold",style:{color:"#456882",fontSize:"0.9rem"},children:"End Date:"})," ",s.jsx("span",{className:"fw-medium",children:El(N.subjectInfo.endDate).date})]})]})]})})]}),s.jsx(ue,{children:s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"mb-2 fw-bold",style:{fontSize:"1rem",color:"#333"},children:"Total Pass/Fail"}),s.jsxs("div",{className:"d-flex gap-3 flex-wrap",children:[s.jsx("div",{children:s.jsxs(Ae,{bg:"success",className:"px-3 py-2 fs-6",children:["Passed: ",E.passed]})}),s.jsx("div",{children:s.jsxs(Ae,{bg:"danger",className:"px-3 py-2 fs-6",children:["Failed: ",E.failed]})}),s.jsx("div",{children:s.jsxs(Ae,{bg:"info",className:"px-3 py-2 fs-6",children:["Total: ",E.total]})}),i.numberOfTrainees>0&&s.jsx("div",{children:s.jsxs(Ae,{bg:"primary",className:"px-3 py-2 fs-6",children:["Trainees: ",i.numberOfTrainees]})})]})]})})})]})})]}),s.jsxs(Y,{className:"shadow-sm mt-4",children:[s.jsxs(Y.Header,{className:"bg-primary text-white p-3 d-flex justify-content-between align-items-center",style:{cursor:"pointer"},onClick:()=>g(!p),children:[s.jsx("h5",{className:"mb-0",children:"Assessment Form Roster"}),s.jsx(sn,{size:20,style:{transition:"transform 0.3s ease",transform:p?"rotate(0deg)":"rotate(-90deg)"}})]}),s.jsx(i0,{in:p,style:{transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",maxHeight:p?"2000px":"0px",overflow:"hidden"},children:s.jsx(Y.Body,{children:i.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ot,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):i.error?s.jsx(Ue,{variant:"danger",className:"mb-0",children:i.error}):i.assessments.length===0?s.jsx("div",{className:"text-center py-4 text-muted",children:"No Assessments Found."}):s.jsx("div",{className:"scrollable-table-container",style:{maxHeight:"70vh"},children:s.jsxs(dr,{hover:!0,responsive:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment Form"}),s.jsx("th",{children:"Trainee"}),s.jsx("th",{children:"Occurrence date"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Score"}),s.jsx("th",{children:"Result"}),s.jsx("th",{children:"Preview"}),s.jsx("th",{className:"text-center",children:"Action"})]})}),s.jsx("tbody",{children:i.assessments.map(T=>{const k=El(T.occuranceDate);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:T.name})}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:T.trainee?.fullName||""}),s.jsx("small",{className:"text-muted",children:T.trainee?.eid||T.trainee?.email||""})]}),s.jsx("td",{children:s.jsx("div",{children:k.date})}),s.jsx("td",{children:Ice(T.status)}),s.jsx("td",{children:T.resultScore!==null&&T.resultScore!==void 0?T.resultScore:""}),s.jsx("td",{children:T.resultText?s.jsx(Ae,{bg:T.resultText.toUpperCase()==="PASSED"||T.resultText.toUpperCase()==="PASS"?"success":T.resultText.toUpperCase()==="FAILED"||T.resultText.toUpperCase()==="FAIL"?"danger":"secondary",children:T.resultText}):s.jsx("span",{className:"text-muted",children:""})}),s.jsx("td",{children:T.pdfUrl?s.jsxs(ae,{variant:"primary",size:"sm",onClick:()=>y(T.pdfUrl),disabled:m,className:"d-flex align-items-center",children:[s.jsx(Zs,{className:"me-1",size:14}),m?"Loading...":"Preview"]}):s.jsx("span",{className:"text-muted",children:""})}),s.jsx("td",{className:"text-center",children:!["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"].includes(T.status)?s.jsx(ae,{size:"sm",variant:"primary",onClick:()=>w(T),children:"View Form"}):s.jsx("span",{className:"text-muted",children:""})})]},T.id)})})]})})})})]}),s.jsx(cg,{show:o,onHide:b,pdfUrl:u,title:"Assessment PDF",externalLoading:m})]})},W5=({assessmentInfo:e,roleInSubject:t,formatDate:r})=>{if(!e)return null;const a=d=>d?d.split("_").map(m=>m.charAt(0)+m.slice(1).toLowerCase()).join(" "):"",n=d=>d?d.split("_").map(m=>m.charAt(0)+m.slice(1).toLowerCase()).join(" "):"",i=e.trainee?.fullName||`${e.trainee?.lastName||""}${e.trainee?.middleName?" "+e.trainee.middleName:""} ${e.trainee?.firstName||""}`.trim()||"",l=e.trainee?.eid||"",o=e.trainee?.traineeProfile;let c=l;if(o){const d=[];o.trainingBatch&&d.push(o.trainingBatch),o.nation&&d.push(o.nation),o.passportNo&&d.push(`Passport: ${o.passportNo}`),d.length>0?c=`${l?`${l}  `:""}${d.join("  ")}`:l&&(c=l)}const u=[{label:"Trainee",value:i,subValue:c},{label:"Assessment Date",value:r(e.occuranceDate),subValue:""},{label:"Status",value:n(e.status),subValue:""},{label:"Your Role In Assessment",value:a(t),subValue:""}];return s.jsxs("div",{className:"assessment-info-banner",children:[s.jsxs("div",{className:"title-block",children:[s.jsx("h2",{className:"assessment-title",children:e.name||"Assessment"}),s.jsxs("p",{className:"text-muted mb-0 assessment-course-subtitle",children:[e.course?.name||e.subject?.name||"",e.course?.code?`  ${e.course.code}`:""]})]}),s.jsx("div",{className:"assessment-summary-inline",children:u.map(d=>s.jsxs("div",{className:"summary-item",children:[s.jsxs("span",{className:"summary-label",children:[d.label,":"]}),s.jsx("span",{className:"summary-value",children:d.value}),d.subValue&&s.jsx("span",{className:"summary-sub-value",children:d.subValue})]},d.label))})]})};W5.propTypes={assessmentInfo:R.object,roleInSubject:R.string,formatDate:R.func.isRequired};const H5=({section:e})=>{const t=ft(),{user:r}=Rr();if(!e)return null;const a=h=>h?s.jsx("span",{className:"text-success d-inline-flex align-items-center",children:s.jsx(Xx,{size:16})}):s.jsx("span",{className:"text-danger d-inline-flex align-items-center",children:s.jsx(mS,{size:16})}),n=!!e.assessedBy,i=e.canAssessed&&!n,l=!e.canAssessed&&e.assessedBy?.id===r?.id,o=!e.canAssessed&&e.assessedBy?.id!==r?.id,c=n&&e.assessedBy?.id===r?.id,u=()=>n?s.jsx(Ae,{bg:"success",children:"ASSESSED"}):i?s.jsx(Ae,{bg:"primary",children:"ASSESSMENT REQUIRED"}):s.jsx(Ae,{bg:"secondary",children:"COMPLETED"}),d=()=>n&&e.canAssessed?c?"Update Assessments":"Fill Assessments":i?"Fill Assessments":l?"Update Assessments":"View Assessments",m=!e.canAssessed,f=()=>{e.id&&t(Pe.ASSESSMENTS_SECTION_FIELDS(e.id))};return s.jsxs("div",{className:"assessment-section-wrapper",style:{position:"relative"},children:[s.jsx(Y,{className:`assessment-section-card ${m?"disabled":""}`,children:s.jsx(Y.Body,{children:s.jsxs("div",{className:`section-card-header ${m?"section-disabled-content":""}`,children:[s.jsxs("div",{className:"section-header-grid",children:[s.jsx("div",{className:"section-heading",children:s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"section-order-pill",children:["#",e.templateSection?.displayOrder??"-"]}),s.jsx("h5",{className:"mb-0",children:e.templateSection?.label||"Unnamed Section"})]})}),s.jsxs("div",{className:"section-inline-flags",children:[s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Edit By"}),s.jsx("span",{className:"fw-semibold",children:e.templateSection?.editBy||""})]}),e.templateSection?.editBy!=="TRAINEE"&&e.templateSection?.isSubmittable&&s.jsxs("div",{className:"flag-item",style:{marginLeft:"8rem"},children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Submittable"}),a(e.templateSection?.isSubmittable)]})]}),s.jsx("div",{className:"section-actions-placeholder"})]}),s.jsx("div",{className:"section-subtext",children:e.assessedBy&&s.jsxs("span",{className:"text-muted",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Assessed By"})," ",s.jsx("span",{className:"fw-semibold",children:e.assessedBy?.fullName||(e.assessedBy?.firstName&&e.assessedBy?.lastName?`${e.assessedBy.lastName}${e.assessedBy.middleName?" "+e.assessedBy.middleName:""} ${e.assessedBy.firstName}`:e.assessedBy?.id||"")})]})})]})})}),s.jsxs("div",{className:"section-actions-absolute",children:[u(),s.jsxs(ae,{variant:o?"secondary":"primary",size:"sm",onClick:f,className:"d-flex align-items-center",style:{gap:"0.5rem"},children:[o?s.jsx(tr,{size:14}):s.jsx(Zt,{size:14}),d()]})]})]})};H5.propTypes={section:R.object.isRequired};const M2=()=>{const{assessmentId:e}=Or(),t=ft(),r=na(),{user:a,userRole:n}=Rr(),i=a?.role==="TRAINEE",l=n?.name==="TRAINER"||a?.role==="TRAINER",o=n?.name==="DEPARTMENT_HEAD"||n?.name==="DEPARTMENT HEAD",[c,u]=v.useState({loading:!0,error:null,assessmentInfo:null,sections:[],userRole:null,isTraineeLocked:!1}),[d,m]=v.useState(!1),[f,h]=v.useState(""),[x,p]=v.useState(""),[g,j]=v.useState(!1),[w,y]=v.useState(!1),[b,S]=v.useState(!1),[E,N]=v.useState(!1),[T,k]=v.useState(null);v.useEffect(()=>{e&&I()},[e]),v.useEffect(()=>()=>{T&&URL.revokeObjectURL(T)},[T]);const I=async()=>{try{u(C=>({...C,loading:!0,error:null}));const P=await vr.getAssessmentSections(e);u({loading:!1,error:null,assessmentInfo:P?.assessmentInfo||null,sections:P?.sections||[],userRole:P?.userRole||null,isTraineeLocked:P?.isTraineeLocked??!1})}catch(P){console.error("Error loading assessment sections:",P),te.error("Failed to load assessment sections"),u(C=>({...C,loading:!1,error:P.response?.data?.message||P.message||"Failed to load assessment sections"}))}},D=v.useMemo(()=>[...c.sections].sort((P,C)=>{const W=P.templateSection?.displayOrder??0,Z=C.templateSection?.displayOrder??0;return W-Z}),[c.sections]),A=c.userRole,M=P=>P?new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"",G=()=>t(-1),q=async()=>{const P=c.assessmentInfo?.template?.id;if(!P){te.error("Template information is not available");return}try{N(!0),S(!0);const C=await Dt.getTemplatePDF(P),W=URL.createObjectURL(C);k(W)}catch(C){console.error("Error loading PDF:",C),te.error("Failed to load PDF preview"),S(!1)}finally{N(!1)}},z=()=>{S(!1),T&&(URL.revokeObjectURL(T),k(null))},ee=async()=>{if(!e){te.error("Assessment ID is missing");return}try{j(!0);const P=await vr.approveRejectAssessment(e,"APPROVED"),C=P?.data?.message||P?.message||"Assessment approved successfully";te.success(C),setTimeout(()=>{j(!1),t(Pe.DEPARTMENT_REVIEW_REQUESTS)},1500)}catch(P){console.error("Error approving assessment:",P);const C=P.response?.data?.message||P.message||"Failed to approve assessment. Please try again.";te.error(C),j(!1)}},U=()=>{m(!0),h(""),p("")},X=async()=>{if(!e){te.error("Assessment ID is missing");return}if(!f.trim()){p("Comment is required for rejection");return}if(f.length>1e3){p("Comment must be less than 1000 characters");return}try{y(!0),p("");const P=await vr.approveRejectAssessment(e,"REJECTED",f),C=P?.data?.message||P?.message||"Assessment rejected successfully";te.success(C),m(!1),h(""),setTimeout(()=>{y(!1),t(Pe.DEPARTMENT_REVIEW_REQUESTS)},1500)}catch(P){console.error("Error rejecting assessment:",P);const C=P.response?.data?.message||P.message||"Failed to reject assessment. Please try again.";p(C),y(!1)}},oe=async()=>{if(!e){te.error("Assessment ID is missing");return}const C=!c.isTraineeLocked;try{await vr.updateTraineeLock(e,C),te.success(C?"Trainee locked":"Assessment opened for trainee"),I()}catch(W){console.error("Error updating trainee lock:",W),te.error(W.response?.data?.message||"Failed to update trainee lock status")}},Ee=async()=>{if(!e){te.error("Assessment ID is missing");return}try{const P=await vr.submitAssessment(e),C=P?.data?.message||P?.message||"Assessment submitted successfully";te.success(C);const W=r.state?.returnPath;W?t(W,{state:{shouldRefresh:!0,templateId:r.state?.templateId,occuranceDate:r.state?.occuranceDate,entityType:r.state?.entityType,entityId:r.state?.entityId,info:r.state?.info}}):setTimeout(()=>{t(-1)},1e3)}catch(P){console.error("Error submitting assessment:",P);const C=P.response?.data?.message||P.message||"Failed to submit assessment";te.error(C)}},F=()=>c.assessmentInfo?.status!=="READY_TO_SUBMIT"?!1:c.sections.some(C=>C.templateSection?.isSubmittable===!0&&C.assessedBy?.id===a?.id);return s.jsx("div",{className:"assessment-sections-shell",children:s.jsxs(Be,{fluid:!0,className:"py-4 assessment-sections-page",children:[s.jsxs("div",{className:"assessment-header d-flex flex-wrap align-items-center justify-content-between gap-3 mb-4",children:[s.jsxs(ae,{variant:"outline-secondary",onClick:G,className:"assess-back-btn",children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back"]}),l&&c.assessmentInfo?.template?.id&&s.jsxs(ae,{variant:"primary",className:"d-flex align-items-center",onClick:q,children:[s.jsx(Zs,{className:"me-2",size:16}),"Assessment Form Preview"]})]}),s.jsx(Y,{className:"assessment-details-card shadow-sm",children:s.jsx(Y.Body,{children:c.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ot,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):c.error?s.jsx(Ue,{variant:"danger",className:"mb-0",children:c.error}):s.jsxs(s.Fragment,{children:[s.jsx(W5,{assessmentInfo:c.assessmentInfo,roleInSubject:A,formatDate:M}),D.length===0?s.jsx("div",{className:"text-center text-muted py-4",children:"No sections available."}):s.jsx("div",{className:"assessment-section-column",children:D.map(P=>s.jsx(H5,{section:P},P.id))})]})})}),!i&&s.jsxs("div",{className:"assessment-footer-actions mt-4",children:[l&&s.jsx(ae,{variant:c.isTraineeLocked?"outline-primary":"outline-danger",className:"footer-btn",onClick:oe,children:c.isTraineeLocked?"Unlock Form For Trainee":"Lock Trainee"}),o&&c.assessmentInfo?.status==="SUBMITTED"&&s.jsxs(s.Fragment,{children:[s.jsx(Nt,{permissions:[De.APPROVE_OR_REJECT_ASSESSMENT],fallback:null,children:s.jsx(ae,{variant:"success",className:"footer-btn",onClick:ee,disabled:g||w,children:g?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"me-2",size:16}),"Approve"]})})}),s.jsx(Nt,{permissions:[De.APPROVE_OR_REJECT_ASSESSMENT],fallback:null,children:s.jsx(ae,{variant:"danger",className:"footer-btn",onClick:U,disabled:g||w,children:w?s.jsxs(s.Fragment,{children:[s.jsx(ot,{animation:"border",size:"sm",className:"me-2"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(zr,{className:"me-2",size:16}),"Reject"]})})})]}),F()&&s.jsx(ae,{variant:"primary",className:"footer-btn submit-btn",onClick:Ee,children:"Submit Assessment"})]}),s.jsxs(se,{show:d,onHide:()=>{m(!1),h(""),p("")},centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Reject Assessment"})}),s.jsxs(se.Body,{children:[s.jsxs(Ue,{variant:"info",className:"mb-3",children:[s.jsx("strong",{children:"Note:"})," Leave a comment to let the Trainers know what is wrong with the Assessment! An Email will be sent to them shortly after rejection."]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsxs(_.Label,{children:["Comment ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(_.Control,{as:"textarea",rows:4,value:f,onChange:P=>{h(P.target.value),p("")},placeholder:"Enter your comment here...",maxLength:1e3,isInvalid:!!x}),s.jsxs(_.Text,{className:"text-muted",children:[f.length,"/1000 characters"]}),x&&s.jsx(_.Control.Feedback,{type:"invalid",children:x})]})]}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:()=>{m(!1),h(""),p("")},disabled:w,children:"Cancel"}),s.jsx(ae,{variant:"danger",onClick:X,disabled:w,children:w?s.jsxs(s.Fragment,{children:[s.jsx(ot,{size:"sm",className:"me-2"}),"Rejecting..."]}):"Reject Assessment"})]})]}),s.jsxs(se,{show:b,onHide:z,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary text-white border-0",children:s.jsxs(se.Title,{className:"text-white d-flex align-items-center",children:[s.jsx(Zs,{className:"me-2",size:20}),"Assessment Form Preview"]})}),s.jsx(se.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:E?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ot,{animation:"border",variant:"primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):T?s.jsx("iframe",{src:`${T}#toolbar=0`,style:{width:"100%",height:"100%",border:"none"},title:"Assessment Form PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})})},B2=()=>{const{sectionId:e}=Or(),t=ft(),[r,a]=v.useState({loading:!0,error:null,sectionInfo:null,fields:[],fieldValues:{},sectionControlToggleValue:!1,isSectionDisabled:!1,canUpdate:!1,canSave:!1}),[n,i]=v.useState({}),[l,o]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("X"),[f,h]=v.useState(!1),[x,p]=v.useState({}),g=v.useCallback(async()=>{if(e)try{a(J=>({...J,loading:!0,error:null}));const Z=await vr.getAssessmentSectionFields(e);if(console.log(" API Response:",Z),console.log(" Fields from API:",Z?.fields),console.log(" Total fields count:",Z?.fields?.length),Z?.success){const J=Z.fields||[],le={};let V=!0;console.log(" Processing",J.length,"fields");const re={};J.forEach(de=>{const je=de.templateField?.id;if(je){const xe=de.templateField?.fieldType,me=de.assessmentValue?.answerValue;xe==="SECTION_CONTROL_TOGGLE"?V=me!=null?me==="true"||me===!0||me==="TRUE":!0:le[je]=me??null,xe==="CHECK_BOX"&&(re[je]="X")}}),Object.keys(re).length>0&&i(de=>{const je={...de};let xe=!1;return Object.keys(re).forEach(me=>{je[me]||(je[me]=re[me],xe=!0)}),xe?je:de});const he=Z.assessmentSectionInfo||null,O=he?.canUpdated||!1,ye=he?.canSave||!1;console.log(" Section Info:",he),console.log(" canUpdate:",O,"canSave:",ye),a({loading:!1,error:null,sectionInfo:he,fields:J,fieldValues:le,sectionControlToggleValue:V,isSectionDisabled:!V||!O&&!ye,canUpdate:O,canSave:ye})}else a(J=>({...J,loading:!1,error:"Failed to load section fields"}))}catch(Z){console.error("Error loading section fields:",Z),te.error("Failed to load section fields"),a(J=>({...J,loading:!1,error:Z.response?.data?.message||Z.message||"Failed to load section fields"}))}},[e]);v.useEffect(()=>{g()},[g]);const j=(Z,J)=>{a(le=>({...le,fieldValues:{...le.fieldValues,[Z]:J}}))},w=Z=>{a(J=>({...J,sectionControlToggleValue:Z,isSectionDisabled:!Z||!J.canUpdate&&!J.canSave}))},y=(Z,J,le)=>{const V=n[le]||"X";j(Z,J?V:null)},b=Z=>new Promise(J=>{const le=new Image;le.onload=()=>{const V=document.createElement("canvas");V.width=350,V.height=200;const re=V.getContext("2d");re.clearRect(0,0,350,200),re.drawImage(le,0,0,350,200),J(V.toDataURL("image/png"))},le.src=Z}),S=(Z,J)=>{if(!J){p(le=>{const V={...le};return delete V[Z],V});return}p(le=>({...le,[Z]:J}))},E=async()=>{const Z={},J=Object.entries(x).map(async([le,V])=>{try{const re=await b(V),O=await(await fetch(re)).blob(),ye=new File([O],`signature-${Date.now()}-${le}.png`,{type:"image/png"}),de=await an.uploadImage(ye,"signature");let je="";if(typeof de=="string"?je=de:de?.url?je=de.url:de?.data?.[0]?.url&&(je=de.data[0].url),!je)throw new Error("Failed to get signature URL from upload response");return Z[le]=je,{fieldId:le,url:je}}catch(re){throw console.error(`Error uploading signature for field ${le}:`,re),re}});try{return await Promise.all(J),a(le=>{const V={...le.fieldValues};return Object.entries(Z).forEach(([re,he])=>{V[re]=he}),{...le,fieldValues:V}}),p({}),Z}catch(le){throw console.error("Error uploading signatures:",le),le}},N=Z=>{const J=Z.templateField?.id,le=n[J]||"X";u(Z),m(le),o(!0)},T=()=>{if(c){const Z=c.templateField?.id;i(J=>({...J,[Z]:d})),o(!1),te.success("Checkbox default value updated")}},k=()=>{const Z=[],J={};let le=null;return r.fields.forEach(V=>{const re=V.templateField;if(re){if(re.fieldType==="SECTION_CONTROL_TOGGLE"){le=V;return}re.parentId?(J[re.parentId]||(J[re.parentId]=[]),J[re.parentId].push(V)):Z.push(V)}}),Z.sort((V,re)=>(V.templateField?.displayOrder||0)-(re.templateField?.displayOrder||0)),Object.keys(J).forEach(V=>{J[V].sort((re,he)=>(re.templateField?.displayOrder||0)-(he.templateField?.displayOrder||0))}),console.log(" organizeFields() result:"),console.log("   Total fields in state.fields:",r.fields.length),console.log("   Parent fields (no parentId):",Z.length),console.log("   Children by parent:",Object.keys(J).map(V=>`${V}: ${J[V].length} children`)),console.log("   SectionControlToggle:",le?"YES":"NO"),{parentFields:Z,childrenMap:J,sectionControlToggleField:le}},I=Z=>{const J=Z.templateField;if(!J)return null;const le=J.id,V=J.fieldType,re=J.label||J.fieldName||"Unnamed Field",he=r.fieldValues[le]??"",O=J.options?.items||null,ye=r.isSectionDisabled||!r.canUpdate&&!r.canSave;if(O&&Array.isArray(O)&&O.length>0)return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:re}),s.jsxs(_.Select,{value:he,onChange:de=>j(le,de.target.value),disabled:ye,className:"field-input",children:[s.jsxs("option",{value:"",children:["Select ",re.toLowerCase()]}),O.map((de,je)=>s.jsx("option",{value:de,children:de},je))]})]},le);if(V==="FINAL_SCORE_NUM")return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:re}),s.jsx(_.Control,{type:"number",value:he,onChange:de=>{const je=de.target.value;(je===""||/^-?\d*\.?\d*$/.test(je))&&j(le,je)},placeholder:`Enter ${re.toLowerCase()}`,disabled:ye,className:"field-input"})]},le);if(V==="TOGGLE")return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:re}),s.jsx(_.Check,{type:"switch",checked:he==="true"||he===!0||he==="TRUE",onChange:de=>j(le,de.target.checked?"true":"false"),disabled:ye,className:"custom-toggle-switch"})]},le);if(V==="SIGNATURE_DRAW"){const je=he&&typeof he=="string"&&(he.startsWith("http://")||he.startsWith("https://"))?he:null;return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:re}),je?s.jsxs("div",{children:[s.jsx(_.Label,{className:"text-muted small mb-2",children:"Current Signature"}),s.jsx("div",{style:{width:"350px",height:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("img",{src:je,alt:"Saved Signature",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):s.jsx("div",{style:{opacity:ye?.6:1,pointerEvents:ye?"none":"auto"},children:s.jsx(Jm,{onSignatureChange:xe=>{ye||S(le,xe)},width:350,height:200})})]},le)}return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:re}),s.jsx(_.Control,{type:"text",value:he,onChange:de=>j(le,de.target.value),placeholder:`Enter ${re.toLowerCase()}`,disabled:ye,className:"field-input"})]},le)},D=Z=>{const J=Z.templateField;if(!J||J.fieldType!=="CHECK_BOX")return null;const le=J.id,V=J.label||J.fieldName||"Unnamed Group",{childrenMap:re}=k(),he=re[le]||[],O=he.length;return s.jsxs("div",{className:"field-group",children:[s.jsxs("div",{className:"field-group-header",children:[s.jsx("h6",{className:"field-group-title",children:V}),O>0&&s.jsxs("span",{className:"field-item-count",children:[O," ITEMS"]}),s.jsx(ae,{variant:"link",size:"sm",className:"p-0 ms-2",onClick:()=>N(Z),style:{color:"#6c757d"},title:"Configure checkbox value",children:s.jsx(tm,{size:14})})]}),s.jsx("div",{className:"field-group-content",children:he.length>0&&s.jsx(ue,{className:"g-3",children:he.map((ye,de)=>{if(de%2===0){const je=ye,xe=he[de+1];return s.jsxs(ne.Fragment,{children:[s.jsx(H,{md:6,children:A(je)}),xe&&s.jsx(H,{md:6,children:A(xe)})]},`row-${de}`)}return null})})})]},le)},A=Z=>{const J=Z.templateField;if(!J)return null;const le=J.id,V=J.label||J.fieldName||"Unnamed Field",re=r.fieldValues[le],he=re!=null&&re!=="",O=r.isSectionDisabled||!r.canUpdate&&!r.canSave;return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(_.Label,{className:"field-label",children:V}),s.jsx(_.Check,{type:"checkbox",checked:he,onChange:ye=>y(le,ye.target.checked,J.parentId),disabled:O,className:"field-checkbox"})]},le)},M=Z=>{const J=Z.templateField;if(!J||J.fieldType!=="PART")return null;const le=J.id,V=J.label||J.fieldName||"Unnamed Group",{childrenMap:re}=k(),he=re[le]||[],O=he.length;return console.log(` renderFieldGroup: "${V}" has ${he.length} children`),s.jsxs("div",{className:"field-group",children:[s.jsxs("div",{className:"field-group-header",children:[s.jsx("h6",{className:"field-group-title",children:V}),O>0&&s.jsxs("span",{className:"field-item-count",children:[O," ITEMS"]})]}),s.jsx("div",{className:"field-group-content",children:he.length>0&&s.jsx(ue,{className:"g-3",children:he.map((ye,de)=>{if(de%2===0){const je=ye,xe=he[de+1];return s.jsxs(ne.Fragment,{children:[s.jsx(H,{md:6,children:I(je)}),xe&&s.jsx(H,{md:6,children:I(xe)})]},`row-${de}`)}return null})})})]},le)},G=()=>{t(-1)},q=(Z=null,J={})=>{const le=Z||r,{sectionControlToggleField:V}=k(),re=[...le.fields],he=[],O=new Set;if(re.forEach(ye=>{const de=ye.templateField;if(!de)return;const je=de.id,xe=de.fieldType,me=ye.assessmentValue?.id;if(xe==="SECTION_CONTROL_TOGGLE"||!me||O.has(me))return;O.add(me);let $e;xe==="SIGNATURE_DRAW"&&J[je]?$e=J[je]:$e=le.fieldValues[je],($e==null||typeof $e=="string"&&$e.trim()==="")&&($e=null),xe==="FINAL_SCORE_NUM"&&$e!==null&&($e=String($e)),xe==="TOGGLE"?le.sectionControlToggleValue?$e=$e||"false":$e="false":le.sectionControlToggleValue||($e=null),he.push({assessmentValueId:me,answerValue:$e})}),V){const ye=V.assessmentValue?.id;ye&&he.push({assessmentValueId:ye,answerValue:le.sectionControlToggleValue?"true":"false"})}return{assessmentSectionId:e,values:he}},z=async()=>{if(!(!e||!r.canSave))try{h(!0);let Z={};Object.keys(x).length>0&&(Z=await E());const J=q(null,Z);await vr.saveSectionValues(J),te.success("Section saved successfully"),setTimeout(()=>{t(-1)},1e3)}catch(Z){console.error("Error saving section:",Z),te.error(Z.response?.data?.message||"Failed to save section")}finally{h(!1)}},ee=async()=>{if(!(!e||!r.canUpdate))try{h(!0);let Z={};Object.keys(x).length>0&&(Z=await E());const J=q(null,Z);await vr.updateSectionValues(J),te.success("Section updated successfully"),setTimeout(()=>{t(-1)},1e3)}catch(Z){console.error("Error updating section:",Z),te.error(Z.response?.data?.message||"Failed to update section")}finally{h(!1)}};if(r.loading)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ot,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(r.error)return s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(Ue,{variant:"danger",className:"mb-0",children:r.error})});const{parentFields:U,sectionControlToggleField:X}=k(),oe=r.sectionInfo?.templateSection?.label||"Section",Ee=r.sectionInfo?.templateSection?r.sectionInfo.templateSection.roleInSubject?`${r.sectionInfo.templateSection.editBy}  ${r.sectionInfo.templateSection.roleInSubject}`:r.sectionInfo.templateSection.editBy:"",{childrenMap:F}=k();let P=0;const C=[];let W=0;return U.forEach(Z=>{const J=Z.templateField;if(J?.fieldType==="PART"){const le=(F[J.id]||[]).length;P+=le,C.push(`${J.label}(${le})`),W++}else J?.fieldType,P+=1}),console.log(" SUMMARY:"),console.log("   API returned:",r.fields.length,"fields"),console.log("   Parent fields:",U.length),console.log("   PART groups found:",W,"",C.join(" | ")),console.log("   ChildrenMap keys:",Object.keys(F).length,"groups"),console.log("   Total rendering:",P,"fields"),s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(ae,{variant:"outline-secondary",className:"me-3 d-flex align-items-center justify-content-center",onClick:G,style:{borderRadius:"999px",padding:"0.45rem 1.5rem"},children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:oe}),Ee&&s.jsx("p",{className:"text-muted mb-0",children:Ee})]})]}),X&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(_.Label,{className:"me-2 mb-0",children:X.templateField?.label||"Section Control"}),s.jsx(_.Check,{type:"switch",checked:r.sectionControlToggleValue,onChange:Z=>w(Z.target.checked),disabled:!r.canUpdate&&!r.canSave,className:"custom-toggle-switch"})]})]}),s.jsx(Y,{className:"shadow-sm",children:s.jsx(Y.Body,{children:s.jsx("div",{className:"assessment-section-fields",children:s.jsx("div",{className:"fields-container",children:s.jsx(ue,{className:"g-3",children:(()=>{const Z=[];return U.forEach(J=>{const le=J.templateField;if(le){if(le.fieldType==="PART"){Z.push(s.jsx(H,{xs:12,children:M(J)},le.id));return}if(le.fieldType==="CHECK_BOX"){Z.push(s.jsx(H,{xs:12,children:D(J)},le.id));return}Z.push(s.jsx(H,{xs:12,children:I(J)},le.id))}}),console.log(" Rendered fields:",Z.length),Z})()})})})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-3 mt-4",children:[r.canUpdate&&s.jsx(ae,{variant:"warning",onClick:ee,disabled:f,children:f?"Updating...":"Update"}),r.canSave&&s.jsx(ae,{variant:"outline-primary",onClick:z,disabled:f,children:f?"Saving...":"Save"})]}),s.jsxs(se,{show:l,onHide:()=>o(!1),children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Configure Checkbox Value"})}),s.jsx(se.Body,{children:s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Default Value (when checked)"}),s.jsx(_.Control,{type:"text",value:d,onChange:Z=>m(Z.target.value),placeholder:"Enter default value (e.g., X, Y, PASS)"}),s.jsx(_.Text,{className:"text-muted",children:'This value will be sent to backend when checkbox is checked. Default: "X"'})]})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),s.jsx(ae,{variant:"primary",onClick:T,children:"Save"})]})]})]})},Dce=()=>{const{resultId:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(N=>setTimeout(N,1e3));const E={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};a(E),h({status:E.approvalStatus,notes:E.approvalNotes,approvedBy:"",approvedDate:""})}catch(E){o("Failed to load assessment result data"),console.error("Error fetching result data:",E)}finally{i(!1)}})()},[e]);const x=(S,E)=>{const N=S/E*100;return N>=80?"success":N>=60?"warning":"danger"},p=S=>S.includes("A")?"success":S.includes("B")?"info":S.includes("C")?"warning":"danger",g=S=>{const E={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},N=E[S]||E.pending;return s.jsx(Ae,{bg:N.bg,children:N.text})},j=(S,E)=>{h(N=>({...N,[S]:E}))},w=async()=>{try{u(!0),await new Promise(S=>setTimeout(S,1500)),a(S=>({...S,approvalStatus:f.status,approvalNotes:f.notes})),m(!1),console.log("Approval saved successfully")}catch(S){console.error("Error saving approval:",S)}finally{u(!1)}},y=()=>{h(S=>({...S,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)},b=()=>{h(S=>({...S,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Fr,{height:400})})})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Ue,{variant:"danger",children:l})})})}):r?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(ae,{variant:"outline-secondary",size:"sm",onClick:()=>t(`/trainer/assessment-details/${e}`),className:"me-3",children:[s.jsx(Bt,{size:16,className:"me-2"}),"Back to Details"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),s.jsxs(ue,{children:[s.jsxs(H,{lg:8,children:[s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(gt,{size:20,className:"me-2"}),"Assessment Summary"]})}),s.jsx(Y.Body,{children:s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($t,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${x(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(Ae,{bg:p(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(r.approvalStatus)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})]}),s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(Jx,{size:20,className:"me-2"}),"Trainer Notes"]})}),s.jsx(Y.Body,{children:s.jsx("p",{className:"mb-0",children:r.trainerNotes})})]}),r.previousApprovals&&r.previousApprovals.length>0&&s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(rt,{size:20,className:"me-2"}),"Approval History"]})}),s.jsx(Y.Body,{children:r.previousApprovals.map(S=>s.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("h6",{className:"mb-1",children:[S.type.charAt(0).toUpperCase()+S.type.slice(1)," Approval"]}),s.jsxs("small",{className:"text-muted",children:["Approved by ",S.approvedBy," on ",S.approvedDate]})]}),g(S.status)]}),S.notes&&s.jsx("p",{className:"mb-0 text-muted",children:S.notes})]},S.id))})]})]}),s.jsxs(H,{lg:4,children:[s.jsxs(Y,{className:"mb-4",children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Current Status"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mb-3",children:g(r.approvalStatus)}),r.approvalNotes&&s.jsxs("div",{children:[s.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),s.jsx("p",{className:"small text-muted",children:r.approvalNotes})]})]})})]}),s.jsxs(Y,{children:[s.jsx(Y.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),s.jsx(Y.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(ae,{variant:"success",onClick:y,className:"d-flex align-items-center justify-content-center",children:[s.jsx(it,{size:16,className:"me-2"}),"Approve Result"]}),s.jsxs(ae,{variant:"danger",onClick:b,className:"d-flex align-items-center justify-content-center",children:[s.jsx(zr,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),s.jsxs(se,{show:d,onHide:()=>m(!1),size:"lg",children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:f.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),s.jsx(se.Body,{children:s.jsxs(_,{children:[s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Approval Notes"}),s.jsx(_.Control,{as:"textarea",rows:4,value:f.notes,onChange:S=>j("notes",S.target.value),placeholder:"Enter your approval notes..."})]}),s.jsxs(_.Group,{className:"mb-3",children:[s.jsx(_.Label,{children:"Approved By"}),s.jsx(_.Control,{type:"text",value:f.approvedBy,onChange:S=>j("approvedBy",S.target.value),placeholder:"Enter your name"})]}),s.jsxs(_.Group,{children:[s.jsx(_.Label,{children:"Approval Date"}),s.jsx(_.Control,{type:"date",value:f.approvedDate,onChange:S=>j("approvedDate",S.target.value)})]})]})}),s.jsxs(se.Footer,{children:[s.jsx(ae,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),s.jsx(ae,{variant:f.status==="approved"?"success":"danger",onClick:w,disabled:c,children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{size:16,className:"me-2"}),f.status==="approved"?"Approve":"Reject"]})})]})]})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsx(ue,{children:s.jsx(H,{children:s.jsx(Ue,{variant:"info",children:"Assessment result not found"})})})})},Pce=()=>{const e=ft(),t=[{title:"View Course Details",description:"Access detailed course information and management",icon:$t,path:Pe.DEPARTMENT_MY_DETAILS,color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:Zt,path:Pe.DEPARTMENT_REVIEW_REQUESTS,color:"warning"}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(Be,{className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{lg:12,children:s.jsxs(Y,{className:"border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Department Dashboard"})}),s.jsx(Y.Body,{children:s.jsxs(ue,{children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx($t,{size:24,className:"text-primary"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"12"}),s.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Vs,{size:24,className:"text-success"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"156"}),s.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Zt,{size:24,className:"text-warning"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"8"}),s.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm",children:s.jsxs(Y.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(va,{size:24,className:"text-info"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"24"}),s.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})})]})})}),s.jsx(ue,{className:"mb-4",children:s.jsx(H,{lg:12,children:s.jsxs(Y,{className:"h-100 border-0 shadow-sm",children:[s.jsx(Y.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(Y.Body,{children:s.jsx(ue,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(H,{md:6,lg:6,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(vn,{size:16,className:`text-${r.color} ms-auto`})]})},a)})})})]})})})]})})},Oce=({course:e,index:t,onView:r})=>{const a=i=>{const l={PLANNED:{variant:"info",icon:rt},ONGOING:{variant:"primary",icon:it},ON_GOING:{variant:"primary",icon:it},COMPLETED:{variant:"success",icon:it},CANCELLED:{variant:"secondary",icon:rt},active:{variant:"success",icon:it},inactive:{variant:"secondary",icon:rt},pending:{variant:"warning",icon:rt}},o=l[i]||l.pending,c=o.icon;return s.jsxs(Ae,{bg:o.variant,className:"d-flex align-items-center",children:[s.jsx(c,{size:12,className:"me-1"}),i?.replace(/_/g," ").toUpperCase()]})},n=i=>[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r(i),permission:De.VIEW_COURSE_IN_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),s.jsx("small",{className:"text-muted",children:e.description})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.code})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vs,{size:16,className:"me-1 text-muted"}),s.jsx("span",{children:e.enrolledCount})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Nt,{permissions:[De.VIEW_COURSE_IN_DETAIL],fallback:null,children:s.jsx(ia,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Gs,{size:16})},items:n(e)})})})]})},Rce=()=>{const e=ft(),{courseId:t,departmentId:r}=Or(),{user:a}=Rr(),[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(null),[d,m]=v.useState(""),[f,h]=v.useState("all"),[x,p]=v.useState(null),[g,j]=v.useState("subjects"),w=a?.role?.name==="DEPARTMENT_HEAD"||a?.role?.name==="DEPARTMENT HEAD";v.useEffect(()=>{(async()=>{if(!a||!a.id){o(!1);return}try{o(!0),u(null);let N;if(w)N=await Ht.getMyDepartment();else{if(!r){u("Department ID is required"),o(!1);return}N=await Ht.getDepartmentById(r)}if(!N){i([]),o(!1);return}const I=(N.courses||[]).filter(D=>D.status!=="ARCHIVED").map(D=>({id:D.id,title:D.name,code:D.code,description:D.description||"",status:D.status||"PLANNED",enrolledCount:D.maxNumTrainee||0,startDate:D.startDate,endDate:D.endDate,level:D.level,venue:D.venue,passScore:D.passScore,subjectCount:D.subjectCount||0}));i(I)}catch(N){console.error("Error fetching courses:",N),u("Failed to load courses. Please try again later.")}finally{o(!1)}})()},[a,w,r]);const y=n.filter(E=>{const N=E.title.toLowerCase().includes(d.toLowerCase())||E.code.toLowerCase().includes(d.toLowerCase())||E.description&&E.description.toLowerCase().includes(d.toLowerCase()),T=f==="all"||E.status===f;return N&&T}),b=E=>{p(E),e(`/academic/course/${E.id}`)};return[{id:"subjects",title:"Subject List",icon:$t,component:s.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:Vs,component:s.jsx("div",{children:"Trainee List Component"})}].find(E=>E.id===g),l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading courses..."})]})}):c?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):s.jsx(Be,{fluid:!0,className:"py-4 my-department-details-page",children:s.jsxs(Y,{className:"border-0 shadow-sm mb-0",children:[s.jsx(Y.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("h4",{className:"mb-0 text-white",children:[s.jsx($t,{className:"me-2"}),"Courses (",y.length,")"]})})}),s.jsxs(Y.Body,{children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search courses by title, code, or description...",value:d,onChange:m,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:f,onChange:E=>h(E.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"PLANNED",children:"Planned"}),s.jsx("option",{value:"ONGOING",children:"Ongoing"}),s.jsx("option",{value:"COMPLETED",children:"Completed"}),s.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[y.length," course",y.length!==1?"s":""]})})})]}),s.jsx(JS,{data:y,loading:l,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(E,N)=>s.jsx(Oce,{course:E,index:N,onView:b},E.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Fce=({event:e,index:t,onView:r})=>{const a=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return o}},{totalAssessments:n,submittedCount:i,reviewedCount:l}=e;return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.eventName}),s.jsx("small",{className:"text-muted",children:e.entityDisplay})]})}),s.jsx("td",{className:"align-middle",children:s.jsxs(Ae,{bg:"info",className:"fs-6",children:[i,"/",n]})}),s.jsx("td",{className:"align-middle",children:s.jsxs(Ae,{bg:"secondary",className:"fs-6",children:[l,"/",n]})}),s.jsx("td",{className:"align-middle",children:s.jsx("div",{className:"text-muted",children:a(e.occurrenceDate)})}),s.jsx("td",{className:"align-middle text-center",children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>r(e),className:"d-flex align-items-center mx-auto",style:{width:"fit-content"},children:[s.jsx(tr,{className:"me-1",size:14}),"View Detail"]})})]})},Lce=({event:e,index:t,onView:r})=>{const a=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return o}},{totalAssessments:n,reviewedCount:i,cancelledCount:l}=e;return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.eventName}),s.jsx("small",{className:"text-muted",children:e.entityDisplay})]})}),s.jsx("td",{className:"align-middle",children:s.jsxs(Ae,{bg:"secondary",className:"fs-6",children:[i,"/",n]})}),s.jsx("td",{className:"align-middle",children:s.jsxs(Ae,{bg:"warning",className:"fs-6",children:[l,"/",n]})}),s.jsx("td",{className:"align-middle",children:s.jsx("div",{className:"text-muted",children:a(e.occurrenceDate)})}),s.jsx("td",{className:"align-middle text-center",children:s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:()=>r(e),className:"d-flex align-items-center mx-auto",style:{width:"fit-content"},children:[s.jsx(tr,{className:"me-1",size:14}),"View Detail"]})})]})},n0=()=>{const e=ft(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,c]=v.useState("processing");v.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const S=await vr.getDepartmentEvents(),N=(S?.data?.events||S?.events||[]).filter(T=>T.status!=="NOT_STARTED").map(T=>{const k=`${T.templateInfo?.id||""}|${T.occuranceDate||""}`;return{eventId:encodeURIComponent(k),eventKey:k,eventName:T.name,entityDisplay:T.entityInfo?`${T.entityInfo.type.charAt(0).toUpperCase()+T.entityInfo.type.slice(1)}: ${T.entityInfo.name}`:"Unknown Entity",templateId:T.templateInfo?.id,occurrenceDate:T.occuranceDate||T.occurrenceDate,status:T.status,totalAssessments:T.totalAssessments,totalTrainees:T.totalTrainees,totalTrainers:T.totalTrainers,submittedCount:T.totalSubmittedForm||0,reviewedCount:T.totalReviewedForm||0,cancelledCount:T.totalCancelledForm||0,entityInfo:T.entityInfo,templateInfo:T.templateInfo,courseId:T.courseId,subjectId:T.subjectId}});r(N)}catch(S){console.error("Error fetching events:",S),r([])}finally{n(!1)}},{processingEvents:d,completedEvents:m}=v.useMemo(()=>{const S=[],E=[];return t.forEach(N=>{N.status==="ON_GOING"?S.push(N):N.status==="FINISHED"&&E.push(N)}),{processingEvents:S,completedEvents:E}},[t]),f=S=>{if(!i)return S;const E=i.toLowerCase();return S.filter(N=>N.eventName?.toLowerCase().includes(E)||N.templateName?.toLowerCase().includes(E))},p=f(o==="processing"?d:m),{sortedData:g,sortConfig:j,handleSort:w}=ts(p);v.useEffect(()=>{},[o]);const y=S=>{const N=S.submittedCount>0?"processing":"completed";e(Pe.DEPARTMENT_REVIEW_EVENT_DETAIL(S.eventId),{state:{eventType:N,eventData:S}})},b=({columnKey:S,children:E,className:N="",nestedKey:T=null})=>{const k=T?`${S}.${T}`:S,D=j?.key===k?j.direction:null;return s.jsx("th",{className:`fw-semibold ${N}`,onClick:()=>w&&w(k),style:{cursor:w?"pointer":"default",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:E}),D&&s.jsx("span",{className:"ms-1",style:{color:"white"},children:D==="asc"?"":""})]})})};return a?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):s.jsxs(Be,{fluid:!0,className:"py-4 assessment-review-requests-page",style:{backgroundColor:"transparent",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[s.jsx(ue,{className:"align-items-center mb-3",children:s.jsx(H,{xs:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})})}),s.jsxs(Tt.Container,{activeKey:o,onSelect:c,children:[s.jsx("div",{className:"bg-primary rounded-top",children:s.jsx("div",{className:"border-bottom py-2 px-3",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"processing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:o==="processing"?"600":"400",opacity:o==="processing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(tm,{className:"me-2",size:16}),"Processing (",d.length,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:o==="completed"?"600":"400",opacity:o==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Xx,{className:"me-2",size:16}),"Completed (",m.length,")"]})})]})})}),s.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:s.jsx(Tt.Content,{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:s.jsxs(Tt.Pane,{eventKey:o,style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",padding:0},children:[s.jsxs(ue,{className:"mb-3 form-mobile-stack search-filter-section p-3",style:{flexShrink:0},children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ra,{placeholder:"Search by assessment event name or template name...",value:i,onChange:l,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:6,md:7,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[p.length," event",p.length!==1?"s":""]})})})]}),p.length===0?s.jsx("div",{className:"text-center py-5",style:{flex:1},children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No events found"}),s.jsxs("p",{children:["No assessment events found in ",o," tab."]})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",style:{flex:1,overflowY:"auto",overflowX:"auto"},children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(b,{columnKey:"eventName",children:"Assessment Event Name"}),o==="processing"?s.jsxs(s.Fragment,{children:[s.jsx(b,{columnKey:"submittedCount",children:"Total Submitted Form"}),s.jsx(b,{columnKey:"reviewedCount",children:"Total Reviewed Form"})]}):s.jsxs(s.Fragment,{children:[s.jsx(b,{columnKey:"reviewedCount",children:"Total Reviewed Form"}),s.jsx(b,{columnKey:"cancelledCount",children:"Total Cancelled Form"})]}),s.jsx(b,{columnKey:"occurrenceDate",nestedKey:"occurrenceDate",children:"Occurrence Date"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Details"})]})}),s.jsx("tbody",{children:g.map((S,E)=>o==="processing"?s.jsx(Fce,{event:S,index:E,onView:y},`${o}-${E}`):s.jsx(Lce,{event:S,index:E,onView:y},`${o}-${E}`))})]})})]},o)})})]})]})},Mce=()=>{const{eventId:e}=Or(),t=ft(),r=na(),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState([]),[u,d]=v.useState(null),[m,f]=v.useState("overview"),[h,x]=v.useState(!1),[p,g]=v.useState(null),[j,w]=v.useState(!1),[y,b]=v.useState(null),[S,E]=v.useState(!1),[N,T]=v.useState(!1),[k,I]=v.useState(null),[D,A]=v.useState(!1),[M,G]=v.useState(null),[q,z]=v.useState(()=>r.state?.eventType||null),ee=r.state?.eventType,[U,X]=v.useState(()=>{const ge=r.state?.eventType;return ge==="processing"?"submitted":ge==="completed"?"approved":"submitted"});v.useEffect(()=>{e&&oe()},[e]);const oe=async()=>{try{n(!0),d(null);const ge=r.state?.eventData;if(!ge){d("Event data not found. Please navigate from the Assessment Review Requests page.");return}let qe=null;if(ge.occurrenceDate){const Ke=new Date(ge.occurrenceDate);isNaN(Ke.getTime())||(qe=Ke.toISOString().split("T")[0])}if(!qe){d("Invalid occurrence date");return}let st;if(ge.subjectId){if(!ge.templateId){d("Template ID is missing");return}st=await vr.getSubjectEventAssessments(ge.subjectId,ge.templateId,qe)}else if(ge.courseId){if(!ge.templateId){d("Template ID is missing");return}st=await vr.getCourseEventAssessments(ge.courseId,ge.templateId,qe)}else{d("Invalid event data: missing courseId or subjectId");return}c(st?.assessments||[]);const Te=st?.eventInfo||{};if(l({eventName:Te.name||ge.eventName,occurrenceDate:Te.occuranceDate||ge.occurrenceDate,templateName:Te.templateInfo?.name||ge.templateName,templateId:Te.templateId||ge.templateId,totalTrainees:st?.numberOfTrainees||ge.totalTrainees,totalTrainers:st?.numberOfParticipatedTrainers||ge.totalTrainers,courseInfo:Te.courseInfo,subjectInfo:Te.subjectInfo,templateInfo:Te.templateInfo,totalAssessments:st?.assessments?.length||ge.totalAssessments}),!q){const Ke=(st?.assessments||[]).some(ze=>ze.status==="SUBMITTED");z(Ke?"processing":"completed"),X(Ke?"submitted":"approved")}}catch(ge){console.error("Error fetching event data:",ge);const qe=ge.response?.data?.message||ge.message||"Failed to load assessment event data";d(qe)}finally{n(!1)}},Ee=()=>{if(!o||o.length===0)return{total:0,submitted:0,passed:0,failed:0,pending:0};const ge={total:o.length,submitted:0,passed:0,failed:0,pending:0};return o.forEach(qe=>{const st=String(qe.status||"").toUpperCase();if(st==="SUBMITTED")ge.submitted++;else if(st==="APPROVED"){ge.submitted++;const Te=String(qe.resultText||"").toUpperCase().trim();Te==="PASSED"||Te==="PASS"?ge.passed++:(Te==="FAILED"||Te==="FAIL")&&ge.failed++}else ge.pending++}),ge},F=ge=>{if(!ge)return"N/A";try{return new Date(ge).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return ge}},P=Ee();let C={},W=0;ee==="processing"?(C={submitted:o?.filter(ge=>String(ge.status||"").toUpperCase()==="SUBMITTED").length||0,reviewed:o?.filter(ge=>String(ge.status||"").toUpperCase()==="REVIEWED").length||0,cancelled:o?.filter(ge=>String(ge.status||"").toUpperCase()==="CANCELLED").length||0},W=C.submitted+C.reviewed+C.cancelled):(C={approved:o?.filter(ge=>String(ge.status||"").toUpperCase()==="APPROVED").length||0,rejected:o?.filter(ge=>String(ge.status||"").toUpperCase()==="REJECTED").length||0,cancelled:o?.filter(ge=>String(ge.status||"").toUpperCase()==="CANCELLED").length||0},W=C.approved+C.rejected+C.cancelled);const Z=ge=>{const qe={SUBMITTED:{variant:"warning",icon:rt,label:"SUBMITTED"},APPROVED:{variant:"success",icon:it,label:"APPROVED"},REJECTED:{variant:"danger",icon:zr,label:"REJECTED"},CANCELLED:{variant:"secondary",icon:ht,label:"CANCELLED"},IN_PROGRESS:{variant:"info",icon:rt,label:"IN_PROGRESS"},ONGOING:{variant:"info",icon:rt,label:"ONGOING"},COMPLETED:{variant:"success",icon:it,label:"COMPLETED"},PENDING:{variant:"info",icon:rt,label:"PENDING"},FAILED:{variant:"danger",icon:zr,label:"FAILED"},NOT_STARTED:{variant:"secondary",icon:Zt,label:"NOT_STARTED"}},st=String(ge||"").toUpperCase(),Te=qe[st]||{variant:"secondary",icon:Zt,label:ge||"UNKNOWN"},Ke=Te.icon;return s.jsxs(Ae,{bg:Te.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(Ke,{size:12}),Te.label]})},J=({columnKey:ge,children:qe,className:st="",sortConfig:Te,onSort:Ke})=>{const ze=Te?.key===ge,et=ze?Te?.direction:null;return s.jsxs("th",{className:`fw-semibold ${st}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase"},onClick:()=>Ke(ge),onMouseEnter:yt=>{yt.target.style.backgroundColor="#214760",yt.target.style.transform="translateY(-1px)",yt.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:yt=>{yt.target.style.backgroundColor="var(--bs-primary)",yt.target.style.transform="translateY(0)",yt.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:ze?"700":"600",color:"white"},children:qe}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Rs,{direction:et,size:14,color:"white"})})]}),ze&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},le=v.useMemo(()=>!o||o.length===0?[]:m!=="forms"?o:o.filter(ge=>{const qe=String(ge.status||"").toUpperCase();if(q==="processing"){if(U==="submitted")return qe==="SUBMITTED";if(U==="reviewed")return qe==="APPROVED"||qe==="REJECTED";if(U==="cancelled")return qe==="CANCELLED"}else if(q==="completed"){if(U==="approved")return qe==="APPROVED";if(U==="rejected")return qe==="REJECTED";if(U==="cancelled")return qe==="CANCELLED"}return!0}),[o,m,U,q]),V=v.useMemo(()=>!le||le.length===0?[]:le.map((ge,qe)=>{const st=ge.trainee?.fullName||`${ge.trainee?.firstName||""} ${ge.trainee?.lastName||""}`.trim()||`Trainee ${qe+1}`,Te=ge.trainee?.email||"-",Ke=ge.resultScore!==void 0&&ge.resultScore!==null?ge.resultScore:"N/A",ze=100,et=Ke!=="N/A"&&ze>0?Math.round(Ke/ze*100):"N/A";let yt=ge.resultText||null;return{id:ge.id,assessmentForm:ge.name||`Assessment Form ${qe+1}`,trainee:st,traineeEmail:Te,occurrenceDate:i?.occurrenceDate||ge.occurrenceDate||ge.createdAt,status:ge.status,score:Ke,maxScore:ze,percentage:et,result:yt,pdfUrl:ge.pdfUrl||null,rawAssessment:ge}}),[le,i]),{sortedData:re,sortConfig:he,handleSort:O}=ts(V),de=i?{course:i.courseInfo?{name:i.courseInfo.name,code:i.courseInfo.code}:null,subject:i.subjectInfo?{name:i.subjectInfo.name,code:i.subjectInfo.code,course:i.subjectInfo.course?{name:i.subjectInfo.course.name,code:i.subjectInfo.course.code}:null}:null}:null,je=()=>{if(i?.templateInfo?.id)return i.templateInfo.id;if(i?.templateId)return i.templateId;if(o&&o.length>0){const ge=o[0];return ge?.templateFormId||ge?.template?.formId||ge?.template?.id||null}return null},xe=async()=>{const ge=je();if(!ge){te.error("Template information is not available");return}try{E(!0),x(!0);const qe=await Dt.getTemplatePDF(ge),st=URL.createObjectURL(qe);g(st)}catch(qe){console.error("Error loading template PDF:",qe),te.error("Failed to load template PDF preview"),x(!1)}finally{E(!1)}},me=()=>{x(!1),p&&(URL.revokeObjectURL(p),g(null))},$e=ge=>{b(ge),w(!0)},Xe=()=>{w(!1),b(null)};return a?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment event details..."})]})}):u||!i?s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(Ue,{variant:"danger",children:u||"Assessment event not found"}),s.jsxs(ae,{variant:"outline-primary",onClick:()=>t(Pe.DEPARTMENT_REVIEW_REQUESTS),children:[s.jsx(Bt,{className:"me-2",size:16}),"Back to Review Requests"]})]}):s.jsxs(Be,{fluid:!0,className:"py-4",children:[s.jsx(ue,{className:"mb-4",children:s.jsx(H,{xs:12,children:s.jsxs("button",{className:"btn btn-link p-0 mb-3 text-decoration-none",onClick:()=>t(Pe.DEPARTMENT_REVIEW_REQUESTS),style:{color:"var(--bs-primary)"},children:[s.jsx(Bt,{className:"me-2",size:20}),"Back"]})})}),s.jsx(Tt.Container,{activeKey:m,onSelect:f,children:s.jsxs(Y,{className:"shadow-sm",children:[s.jsx(Y.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"border-bottom py-2 px-3",children:s.jsxs(Ye,{variant:"tabs",className:"border-0",children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"overview",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="overview"?"600":"400",opacity:m==="overview"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(gt,{className:"me-2",size:16}),"Event Overview"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"forms",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="forms"?"600":"400",opacity:m==="forms"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($t,{className:"me-2",size:16}),"Assessment Forms (",W,")"]})})]})})}),s.jsxs(Tt.Content,{children:[s.jsx(Tt.Pane,{eventKey:"overview",children:s.jsxs(Y.Body,{children:[s.jsxs(ue,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:"Event Name"}),s.jsx("p",{className:"m-1 fw-semibold",children:i.eventName})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx(or,{className:"me-2",size:16}),"Occurrence Date"]}),s.jsx("span",{children:F(i.occurrenceDate)})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:"Assessment Instrument (Template) Name"}),s.jsx("p",{className:"m-1 fw-semibold",children:i.templateName}),je()&&s.jsxs(ae,{variant:"outline-primary",size:"sm",onClick:xe,className:"mt-2 d-inline-flex align-items-center",children:[s.jsx(Zs,{className:"me-1",size:14}),"Template Preview"]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx(Vs,{className:"me-2",size:16}),"Total Trainees"]}),s.jsxs(Ae,{children:[i.totalTrainees," trainees"]})]}),i.totalTrainers!==void 0&&s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx(Lt,{className:"me-2",size:16}),"Total Trainers"]}),s.jsxs(Ae,{children:[i.totalTrainers," trainers"]})]}),de?.course&&s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx($t,{className:"me-2",size:16}),"Course Information"]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[s.jsxs("div",{children:[s.jsx("span",{className:"fw-semibold",children:de.course.name}),de.course.code&&s.jsxs("span",{className:"text-muted ms-2",children:["(",de.course.code,")"]})]}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{I(i?.courseInfo||de.course),T(!0)},children:"View Details"})]})]}),de?.subject&&s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx($t,{className:"me-2",size:16}),"Subject Information"]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-start gap-3",children:[s.jsxs("div",{style:{flex:1},children:[s.jsx(Ae,{className:"mb-2",bg:"dark",children:de.subject.name}),de.subject.code&&s.jsxs("div",{className:"text-muted small mt-2",children:[s.jsx("strong",{children:"Code:"})," ",de.subject.code]}),de.subject.course&&s.jsxs("div",{className:"mt-3",children:[s.jsx("div",{className:"fw-bold text-primary small mb-2",style:{backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff",display:"inline-block"},children:"Parent Course"}),s.jsxs("div",{className:"text-muted small mt-1",children:[de.subject.course.name,de.subject.course.code&&s.jsxs("div",{className:"text-muted small",children:["(",de.subject.course.code,")"]})]})]})]}),s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>{G(i?.subjectInfo||de.subject),A(!0)},style:{whiteSpace:"nowrap"},children:"View Details"})]})]})]})]}),s.jsx("hr",{className:"my-4"}),s.jsxs(ue,{children:[s.jsx(H,{xs:12,children:s.jsx("h6",{className:"mb-3 fw-bold",style:{color:"#456882",fontSize:"1.1rem"},children:"Assessment Results Overview"})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-success shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#d4edda",border:"2px solid var(--bs-success)",position:"relative",overflow:"hidden"},onMouseEnter:ge=>{ge.currentTarget.style.transform="translateY(-8px) scale(1.05)",ge.currentTarget.style.boxShadow="0 12px 30px rgba(40, 167, 69, 0.4)",ge.currentTarget.style.borderColor="#28a745"},onMouseLeave:ge=>{ge.currentTarget.style.transform="translateY(0) scale(1)",ge.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",ge.currentTarget.style.borderColor="var(--bs-success)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#155724",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.passed}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Passed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-danger shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#f8d7da",border:"2px solid var(--bs-danger)",position:"relative",overflow:"hidden"},onMouseEnter:ge=>{ge.currentTarget.style.transform="translateY(-8px) scale(1.05)",ge.currentTarget.style.boxShadow="0 12px 30px rgba(220, 53, 69, 0.4)",ge.currentTarget.style.borderColor="#dc3545"},onMouseLeave:ge=>{ge.currentTarget.style.transform="translateY(0) scale(1)",ge.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",ge.currentTarget.style.borderColor="var(--bs-danger)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#721c24",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.failed}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Failed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-secondary shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#e2e3e5",border:"2px solid var(--bs-secondary)",position:"relative",overflow:"hidden"},onMouseEnter:ge=>{ge.currentTarget.style.transform="translateY(-8px) scale(1.05)",ge.currentTarget.style.boxShadow="0 12px 30px rgba(108, 117, 125, 0.4)",ge.currentTarget.style.borderColor="#6c757d"},onMouseLeave:ge=>{ge.currentTarget.style.transform="translateY(0) scale(1)",ge.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",ge.currentTarget.style.borderColor="var(--bs-secondary)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#383d41",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:C.cancelled}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Cancelled"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(Y,{className:"h-100 border-primary shadow-sm",style:{transition:"all 0.3s ease",cursor:"pointer",backgroundColor:"#ccedffff",border:"2px solid var(--bs-primary)",position:"relative",overflow:"hidden"},onMouseEnter:ge=>{ge.currentTarget.style.transform="translateY(-8px) scale(1.05)",ge.currentTarget.style.boxShadow="0 12px 30px rgba(0, 123, 255, 0.4)",ge.currentTarget.style.borderColor="#007bff"},onMouseLeave:ge=>{ge.currentTarget.style.transform="translateY(0) scale(1)",ge.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",ge.currentTarget.style.borderColor="var(--bs-primary)"},children:s.jsxs(Y.Body,{className:"text-center position-relative",children:[s.jsx("div",{className:"mb-2",style:{fontSize:"3rem",fontWeight:"bold",color:"#04234fff",textShadow:"0 2px 4px rgba(0,0,0,0.1)",animation:"pulse 2s infinite"},children:P.total}),s.jsx("p",{className:"text-muted mb-0 fw-semibold",style:{fontSize:"1rem"},children:"Total Forms"})]})})})]})]})}),s.jsx(Tt.Pane,{eventKey:"forms",children:s.jsxs(Y.Body,{className:"p-0",children:[q&&s.jsx("div",{className:"border-bottom p-3",style:{backgroundColor:"#f8f9fa"},children:s.jsx(Ye,{variant:"tabs",className:"border-0",children:q==="processing"?s.jsxs(s.Fragment,{children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"submitted",onClick:()=>X("submitted"),active:U==="submitted",style:{cursor:"pointer",color:U==="submitted"?"var(--bs-primary)":"#6c757d",fontWeight:U==="submitted"?"600":"400",border:"none",borderBottom:U==="submitted"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(rt,{className:"me-1",size:14}),"Submitted (",C.submitted||0,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"reviewed",onClick:()=>X("reviewed"),active:U==="reviewed",style:{cursor:"pointer",color:U==="reviewed"?"var(--bs-primary)":"#6c757d",fontWeight:U==="reviewed"?"600":"400",border:"none",borderBottom:U==="reviewed"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(it,{className:"me-1",size:14}),"Reviewed (",C.reviewed||0,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"cancelled",onClick:()=>X("cancelled"),active:U==="cancelled",style:{cursor:"pointer",color:U==="cancelled"?"var(--bs-primary)":"#6c757d",fontWeight:U==="cancelled"?"600":"400",border:"none",borderBottom:U==="cancelled"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(ht,{className:"me-1",size:14}),"Cancelled (",C.cancelled||0,")"]})})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"approved",onClick:()=>X("approved"),active:U==="approved",style:{cursor:"pointer",color:U==="approved"?"var(--bs-primary)":"#6c757d",fontWeight:U==="approved"?"600":"400",border:"none",borderBottom:U==="approved"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(it,{className:"me-1",size:14}),"Approved (",C.approved||0,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"rejected",onClick:()=>X("rejected"),active:U==="rejected",style:{cursor:"pointer",color:U==="rejected"?"var(--bs-primary)":"#6c757d",fontWeight:U==="rejected"?"600":"400",border:"none",borderBottom:U==="rejected"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(zr,{className:"me-1",size:14}),"Rejected (",C.rejected||0,")"]})}),s.jsx(Ye.Item,{children:s.jsxs(Ye.Link,{eventKey:"cancelled",onClick:()=>X("cancelled"),active:U==="cancelled",style:{cursor:"pointer",color:U==="cancelled"?"var(--bs-primary)":"#6c757d",fontWeight:U==="cancelled"?"600":"400",border:"none",borderBottom:U==="cancelled"?"2px solid var(--bs-primary)":"2px solid transparent"},children:[s.jsx(ht,{className:"me-1",size:14}),"Cancelled (",C.cancelled||0,")"]})})]})})}),le.length===0?s.jsxs(Ue,{variant:"info",className:"m-3",children:["No ",U," assessment forms found."]}):s.jsx("div",{className:"table-responsive",children:s.jsxs(dr,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(J,{columnKey:"assessmentForm",sortConfig:he,onSort:O,children:"Assessment Form"}),s.jsx(J,{columnKey:"trainee",sortConfig:he,onSort:O,children:"Trainee"}),s.jsx(J,{columnKey:"occurrenceDate",sortConfig:he,onSort:O,children:"Occurrence Date"}),s.jsx(J,{columnKey:"status",sortConfig:he,onSort:O,children:"Status"}),s.jsx(J,{columnKey:"score",sortConfig:he,onSort:O,children:"Score"}),s.jsx(J,{columnKey:"result",sortConfig:he,onSort:O,children:"Result"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"PDF"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Preview"})]})}),s.jsx("tbody",{children:re.map((ge,qe)=>s.jsxs("tr",{className:`${qe%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:st=>{st.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:st=>{st.currentTarget.style.backgroundColor=qe%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:ge.assessmentForm})}),s.jsx("td",{className:"align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lt,{className:"me-2 text-primary",size:18}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-0 fw-medium",children:ge.trainee}),s.jsx("small",{className:"text-muted",children:ge.traineeEmail})]})]})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:F(ge.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:Z(ge.status)}),s.jsx("td",{className:"align-middle",children:ge.score!=="N/A"?s.jsxs("span",{className:`fw-bold ${ge.percentage>=70?"text-success":ge.percentage>=60?"text-warning":"text-danger"}`,children:[ge.score,"/",ge.maxScore]}):s.jsx("span",{className:"text-muted",children:"N/A"})}),s.jsx("td",{className:"align-middle",children:ge.result?s.jsx(Ae,{bg:ge.result.toUpperCase()==="PASSED"||ge.result.toUpperCase()==="PASS"?"success":"danger",children:ge.result}):s.jsx("span",{className:"text-muted",children:"N/A"})}),s.jsx("td",{className:"align-middle text-center",children:ge.pdfUrl?s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>$e(ge.pdfUrl),children:"View PDF"}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(ae,{variant:"outline-primary",size:"sm",onClick:()=>t(Pe.ASSESSMENTS_SECTIONS(ge.id)),children:"View"})})]},ge.id))})]})})]})})]})]})}),s.jsxs(se,{show:h,onHide:me,size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,className:"bg-primary-custom text-white border-0",children:s.jsxs(se.Title,{className:"text-white",children:["Template Preview - ",i?.templateName]})}),s.jsx(se.Body,{style:{minHeight:"350px",padding:0},children:S?s.jsxs("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"350px"},children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("span",{className:"ms-2",children:"Loading PDF..."})]}):p?s.jsx("div",{style:{height:"480px",overflow:"hidden",position:"relative"},children:s.jsx("iframe",{src:p,style:{width:"100%",height:"100%",border:"none",marginTop:"-50px",height:"calc(100% + 50px)"},title:"Template PDF Preview"})}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"350px"},children:s.jsx("p",{className:"text-muted",children:"Failed to load PDF"})})}),s.jsx(se.Footer,{children:s.jsx(ae,{variant:"secondary",onClick:me,children:"Close"})})]}),s.jsxs(se,{show:j,onHide:Xe,size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,style:{flexShrink:0,backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)"},children:s.jsx(se.Title,{style:{color:"white"},children:"Assessment PDF Preview"})}),s.jsx(se.Body,{style:{minHeight:"500px",padding:0,overflowY:"auto",maxHeight:"70vh"},children:y?s.jsx("iframe",{src:y+"#toolbar=0",style:{width:"100%",height:"600px",border:"none"},title:"Assessment PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"500px"},children:s.jsx("p",{className:"text-muted",children:"Failed to load PDF"})})}),s.jsx(se.Footer,{children:s.jsx(ae,{variant:"secondary",onClick:Xe,children:"Close"})})]}),s.jsxs(se,{show:N,onHide:()=>T(!1),size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Course Information"})}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:k&&s.jsxs(s.Fragment,{children:[s.jsxs("h6",{className:"fw-bold text-primary mb-4",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff",display:"inline-block"},children:[s.jsx($t,{className:"me-2",size:18}),"Course Details"]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Course Name"}),s.jsx("p",{className:"mb-0",children:k.name})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Course Code"}),s.jsx("p",{className:"mb-0",children:k.code||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Level"}),s.jsx("p",{className:"mb-0",children:s.jsx(Ae,{bg:"info",children:k.level||"N/A"})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Status"}),s.jsx("p",{className:"mb-0",children:s.jsx(Ae,{bg:k.status==="ON_GOING"?"warning":"secondary",children:k.status?.replace(/_/g," ")||"N/A"})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Start Date"}),s.jsx("p",{className:"mb-0",children:k.startDate?new Date(k.startDate).toLocaleDateString():"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"End Date"}),s.jsx("p",{className:"mb-0",children:k.endDate?new Date(k.endDate).toLocaleDateString():"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Max Trainees"}),s.jsx("p",{className:"mb-0",children:k.maxNumTrainee||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Venue"}),s.jsx("p",{className:"mb-0",children:k.venue||"N/A"})]})}),k.department&&s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Department"}),s.jsxs("p",{className:"mb-0",children:[k.department.name,k.department.code&&s.jsxs("span",{className:"text-muted ms-2",children:["(",k.department.code,")"]})]})]})}),k.description&&s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Description"}),s.jsx("p",{className:"mb-0",children:k.description})]})}),k.note&&s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Notes"}),s.jsx("p",{className:"mb-0",children:k.note})]})})]})]})}),s.jsx(se.Footer,{children:s.jsx(ae,{variant:"secondary",onClick:()=>T(!1),children:"Close"})})]}),M&&s.jsxs(se,{show:D,onHide:()=>A(!1),size:"lg",centered:!0,children:[s.jsx(se.Header,{closeButton:!0,children:s.jsx(se.Title,{children:"Subject & Parent Course Information"})}),s.jsx(se.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsxs("div",{children:[s.jsxs("h6",{className:"fw-bold text-primary mb-3",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx($t,{className:"me-2",size:18}),"Subject Details"]}),s.jsxs(ue,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Subject Name"}),s.jsx("p",{className:"mb-0",children:M.name})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Subject Code"}),s.jsx("p",{className:"mb-0",children:M.code||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Method"}),s.jsx("p",{className:"mb-0",children:M.method||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Duration"}),s.jsx("p",{className:"mb-0",children:M.duration?`${M.duration} day(s)`:""})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Status"}),s.jsx("p",{className:"mb-0",children:s.jsx(Ae,{bg:M.status==="ON_GOING"?"warning":"secondary",children:M.status?.replace(/_/g," ")||"N/A"})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Type"}),s.jsx("p",{className:"mb-0",children:M.type||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Start Date"}),s.jsx("p",{className:"mb-0",children:M.startDate?new Date(M.startDate).toLocaleDateString():"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"End Date"}),s.jsx("p",{className:"mb-0",children:M.endDate?new Date(M.endDate).toLocaleDateString():"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Pass Score"}),s.jsx("p",{className:"mb-0",children:M.passScore||"N/A"})]})}),M.description&&s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Description"}),s.jsx("p",{className:"mb-0",children:M.description})]})})]}),M.course&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-4"}),s.jsxs("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"1.1rem",backgroundColor:"#f0f8ff",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cce7ff"},children:[s.jsx(gt,{className:"me-2",size:18}),"Parent Course Information"]}),s.jsxs(ue,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Course Name"}),s.jsx("p",{className:"mb-0",children:M.course.name})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Course Code"}),s.jsx("p",{className:"mb-0",children:M.course.code||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Status"}),s.jsx("p",{className:"mb-0",children:s.jsx(Ae,{bg:M.course.status==="ON_GOING"?"warning":"secondary",children:M.course.status?.replace(/_/g," ")||"N/A"})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Max Trainees"}),s.jsx("p",{className:"mb-0",children:M.course.maxNumTrainee||"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Start Date"}),s.jsx("p",{className:"mb-0",children:M.course.startDate?new Date(M.course.startDate).toLocaleDateString():"N/A"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"End Date"}),s.jsx("p",{className:"mb-0",children:M.course.endDate?new Date(M.course.endDate).toLocaleDateString():"N/A"})]})}),M.course.description&&s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"fw-bold text-muted small",children:"Description"}),s.jsx("p",{className:"mb-0",children:M.course.description})]})})]})]})]})}),s.jsx(se.Footer,{children:s.jsx(ae,{variant:"secondary",onClick:()=>A(!1),children:"Close"})})]})]})},Bce=()=>{const{traineeId:e}=Or(),t=ft(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e){i(!1);return}try{i(!0),o(null);const m=await Ks.getUserById(e),f=m.data||m,h={id:f.id,eid:f.eid,firstName:f.firstName||"",lastName:f.lastName||"",middleName:f.middleName||"",name:`${f.lastName||""} ${f.middleName||""} ${f.firstName||""}`.trim().replace(/\s+/g," "),email:f.email||"",phoneNumber:f.phoneNumber||"N/A",status:f.status||"ACTIVE",gender:f.gender||"N/A",address:f.address||"N/A",avatarUrl:f.avatarUrl,role:f.role?.name||"N/A",department:f.department?.name||"N/A",departmentId:f.department?.id,dob:f.traineeProfile?.dob,enrollmentDate:f.traineeProfile?.enrollmentDate,trainingBatch:f.traineeProfile?.trainingBatch||"N/A",passportNo:f.traineeProfile?.passportNo||"N/A",nation:f.traineeProfile?.nation||"N/A",createdAt:f.createdAt,updatedAt:f.updatedAt};a(h)}catch(m){console.error("Error fetching trainee details:",m),o("Failed to load trainee details. Please try again later.")}finally{i(!1)}})()},[e]);const c=d=>{const f={ACTIVE:{variant:"success",text:"Active"},INACTIVE:{variant:"secondary",text:"Inactive"},SUSPENDED:{variant:"danger",text:"Suspended"},active:{variant:"success",text:"Active"},inactive:{variant:"secondary",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:d||"Unknown"};return s.jsx(Ae,{bg:f.variant,children:f.text})},u=d=>{if(!d)return"N/A";try{return new Date(d).toLocaleDateString()}catch{return d}};return n?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ot,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"danger",children:[s.jsx(Ue.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):r?s.jsxs(Be,{fluid:!0,className:"py-3 py-md-4 px-3 px-md-4",children:[s.jsx(ue,{className:"mb-3 mb-md-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[s.jsxs("button",{className:"btn btn-link p-0 me-2 me-md-3 mb-2 mb-md-0",onClick:()=>t(-1),"aria-label":"Go back",children:[s.jsx(Bt,{size:18,className:"d-md-none"}),s.jsx(Bt,{size:20,className:"d-none d-md-block"})]}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h2",{className:"mb-1 h4 h-md-2",children:r.name}),s.jsxs("p",{className:"text-muted mb-0 small",children:[r.eid,"  ",r.department]})]})]})})}),s.jsx("div",{style:{marginBottom:"4rem"},children:s.jsxs(ue,{className:"g-2 g-md-3",children:[s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(Y.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Lt,{size:20,className:"text-primary d-md-none"}),s.jsx(Lt,{size:24,className:"text-primary d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Status"}),s.jsx("div",{className:"mt-auto d-flex justify-content-center",children:c(r.status)})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(Y.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Ws,{size:20,className:"text-info d-md-none"}),s.jsx(Ws,{size:24,className:"text-info d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Department"}),s.jsx("h6",{className:"mb-0 text-info small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.department}),s.jsx("h6",{className:"mb-0 text-info d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.department})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(Y.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(or,{size:20,className:"text-success d-md-none"}),s.jsx(or,{size:24,className:"text-success d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Enrollment Date"}),s.jsx("h6",{className:"mb-0 text-success small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:u(r.enrollmentDate)}),s.jsx("h6",{className:"mb-0 text-success d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:u(r.enrollmentDate)})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(Y,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(Y.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Ro,{size:20,className:"text-warning d-md-none"}),s.jsx(Ro,{size:24,className:"text-warning d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Training Batch"}),s.jsx("h6",{className:"mb-0 text-warning small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.trainingBatch}),s.jsx("h6",{className:"mb-0 text-warning d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.trainingBatch})]})})})]})}),s.jsxs(ue,{className:"mb-4 g-3 g-md-4 align-items-stretch",children:[s.jsx(H,{xs:12,sm:12,md:6,lg:6,className:"mb-3 mb-md-0 d-flex",children:s.jsxs(Y,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(Y.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Personal Information"})}),s.jsxs(Y.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Employee ID:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.eid})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Vi,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Email:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.email})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(aS,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Phone Number:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.phoneNumber})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Gender:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.gender})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(or,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Date of Birth:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.dob)})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(ec,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Address:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.address})]})]})]})]})}),s.jsx(H,{xs:12,sm:12,md:6,lg:6,className:"mb-0 d-flex",children:s.jsxs(Y,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(Y.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Trainee Profile"})}),s.jsxs(Y.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ws,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Department:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.department})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Role:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.role})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(or,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Enrollment Date:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.enrollmentDate)})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ro,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Training Batch:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.trainingBatch})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ro,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Passport No:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.passportNo})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(ec,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Nation:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.nation})]})]})]})]})})]})]}):s.jsx(Be,{fluid:!0,className:"py-4",children:s.jsxs(Ue,{variant:"warning",children:[s.jsx(Ue.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},zce=J5([{path:"/",element:s.jsx(df,{}),errorElement:s.jsx(Ot,{})},{path:"/login",element:s.jsx(df,{}),errorElement:s.jsx(Ot,{})},{path:"/reset-password",element:s.jsx(XR,{}),errorElement:s.jsx(Ot,{})},{path:"/profile",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(_H,{})}]},{path:Pe.USERS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_USERS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:s.jsx(nH,{})})}]},{path:Pe.ROLES,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_ROLES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:s.jsx(mH,{})})}]},{path:Pe.DEPARTMENTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permissions:[De.VIEW_ALL_DEPARTMENTS,De.UPDATE_DEPARTMENT],requireAll:!0,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:s.jsx(yH,{})})},{path:":id",element:s.jsx(Qt,{permission:De.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:s.jsx(EH,{})})}]},{path:Pe.TEMPLATES,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:s.jsx(Boe,{})})},{path:"editor",element:s.jsx(Qt,{permission:De.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:s.jsx(Goe,{})})},{path:"drafts",element:s.jsx(Qt,{permission:De.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view drafts."}),children:s.jsx(qoe,{})})},{path:":templateId",element:s.jsx(Qt,{permission:De.VIEW_TEMPLATE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:s.jsx(L2,{})})}]},{path:Pe.SYSTEM_CONFIG,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_GLOBAL_FIELDS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:s.jsx(ece,{})})}]},{path:Pe.MAIN_MENU,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Koe,{})}]},{path:Pe.COURSES_INSTRUCTED,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:s.jsx(Nce,{})})}]},{path:Pe.COURSES_ENROLLED,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:s.jsx(koe,{})})}]},{path:"/courses/:courseId",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(Al,{})})}]},{path:"/courses/:courseId/subjects/:subjectId",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Wd,{})}]},{path:Pe.ASSESSMENTS_UPCOMING,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yce,{})}]},{path:Pe.ASSESSMENTS_MY_ASSESSMENTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(F2,{})}]},{path:Pe.ASSESSMENTS_RESULTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(jce,{})}]},{path:Pe.ASSESSMENTS_SIGNATURE_REQUIRED,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(rce,{})}]},{path:"/assessments/assign/:entityType/:entityId",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(a0,{})}]},{path:"/assessments/:assessmentId/sections",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(M2,{})}]},{path:"/assessments/sections/:sectionId/fields",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(B2,{})}]},{path:Pe.ASSESSMENT_EVENTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(P2,{})}]},{path:Pe.REPORTS_CREATE,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_SUBMITTED_REPORTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:s.jsx(cce,{})})}]},{path:Pe.REPORTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access incident/feedback reports."}),children:s.jsx(Zd,{})})}]},{path:Pe.REPORTS_ISSUES,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:s.jsx(Zd,{defaultTab:"incidents"})})}]},{path:Pe.REPORTS_FEEDBACK,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:s.jsx(Zd,{defaultTab:"feedback"})})}]},{path:"/reports/:reportId",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_INCIDENT_FEEDBACK_REPORT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view incident/feedback report details."}),children:s.jsx(dce,{})})}]},{path:Pe.TRAINER_CONFIGURE_SIGNATURE,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Ace,{})}]},{path:Pe.DEPARTMENT_MY_DETAILS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:s.jsx(Rce,{})})},{path:":courseId",element:s.jsx(Qt,{permission:De.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(Al,{})})}]},{path:Pe.DEPARTMENT_REVIEW_REQUESTS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(n0,{})},{path:":requestId",element:s.jsx(n0,{})},{path:"events/:eventId",element:s.jsx(Mce,{})}]},{path:Pe.TRAINEE_ACADEMIC_DETAILS,element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(Qt,{permission:De.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:s.jsx(Coe,{})})}]},{path:"/admin",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"main-menu",element:s.jsx(Sr,{})},{path:"users",element:s.jsx(Sr,{})},{path:"roles",element:s.jsx(Sr,{})},{path:"departments",element:s.jsx(Sr,{})},{path:"departments/:id",element:s.jsx(Sr,{})},{path:"forms",element:s.jsx(Sr,{})},{path:"forms/editor",element:s.jsx(Sr,{})},{path:"forms/drafts",element:s.jsx(Sr,{})},{path:"system-config",element:s.jsx(Sr,{})}]},{path:"/academic",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(Lle,{})},{path:"departments",element:s.jsx(kH,{})},{path:"course/:courseId",element:s.jsx(Hle,{})},{path:"course-detail/:courseId",element:s.jsx(doe,{})},{path:"course/:courseId/enroll-trainees",element:s.jsx(poe,{})},{path:"subject/:subjectId",element:s.jsx(Wd,{})},{path:"course/:courseId/subject/:subjectId",element:s.jsx(Wd,{})},{path:"assessment-events",element:s.jsx(P2,{})}]},{path:"/trainee",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(Qt,{permission:De.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:s.jsx(Eoe,{})})},{path:":traineeId/course/:courseId",element:s.jsx(Qt,{permission:De.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:s.jsx(Al,{})})},{path:":traineeId/assessments",element:s.jsx(boe,{})},{path:":traineeId/assessment/:assessmentId",element:s.jsx(joe,{})},{path:":traineeId/signature-pad/:documentId",element:s.jsx(woe,{})},{path:":traineeId/assessment-section/:sectionId",element:s.jsx(Soe,{})},{path:"academic-details",element:s.jsx(Sr,{})},{path:"enrolled-courses",element:s.jsx(Sr,{})},{path:"signature-required",element:s.jsx(Sr,{})},{path:"completion-required",element:s.jsx(Sr,{})},{path:"your-assessments",element:s.jsx(Sr,{})},{path:"create-incident-feedback-report",element:s.jsx(Sr,{})},{path:"assessment-pending",element:s.jsx(F2,{})}]},{path:"/sqa",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"issues",element:s.jsx(Sr,{})},{path:"feedback",element:s.jsx(Sr,{})},{path:"templates/:templateId",element:s.jsx(Qt,{permission:De.VIEW_TEMPLATE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:s.jsx(L2,{})})}]},{path:"/trainer",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(gce,{})},{path:"upcoming-assessments",element:s.jsx(Sr,{})},{path:"assessment-results",element:s.jsx(Sr,{})},{path:"instructed-courses",element:s.jsx(Sr,{})},{path:"configure-signature",element:s.jsx(Sr,{})},{path:"assessment-details/:resultId",element:s.jsx(_ce,{})},{path:"assess/:entityType/:entityId",element:s.jsx(a0,{})},{path:"assessments/:assessmentId/sections",element:s.jsx(M2,{})},{path:"assessments/sections/:sectionId/fields",element:s.jsx(B2,{})},{path:"assess/:entityType/:entityId",element:s.jsx(a0,{})},{path:"approval-notes/:resultId",element:s.jsx(Dce,{})},{path:"courses/:courseId",element:s.jsx(Qt,{permission:De.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(Al,{})})},{path:"trainees/:traineeId",element:s.jsx(Qt,{permission:De.VIEW_USER_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(Sce,{})})},{path:"subjects/:subjectId",element:s.jsx(Qt,{permission:De.VIEW_SUBJECT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(Tce,{})})}]},{path:"/department-head",element:s.jsx(Wt,{children:s.jsx(Ut,{})}),errorElement:s.jsx(Ot,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(Qt,{permission:De.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department dashboard."}),children:s.jsx(Pce,{})})},{path:"my-department-details",element:s.jsx(Sr,{})},{path:"my-department-details/:courseId",element:s.jsx(Qt,{permission:De.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(Al,{})})},{path:"assessment-review-requests",element:s.jsx(Sr,{})},{path:"assessment-review-requests/:requestId",element:s.jsx(n0,{})},{path:"courses/:courseId/subjects/:subjectId",element:s.jsx(Qt,{permission:De.VIEW_SUBJECT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(Wd,{})})},{path:"trainees/:traineeId",element:s.jsx(Qt,{permission:De.VIEW_USER_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(Bce,{})})}]},{path:"*",element:s.jsx(df,{}),errorElement:s.jsx(Ot,{})}],{basename:ng()});function $ce(){return v.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,a=t.hash,n=r.match(/\?\/(.+?)(?:&|$)/);if(n){const l=`/${n[1].replace(/~and~/g,"&")}${a}`;window.history.replaceState(null,"",l)}}})()},[]),s.jsxs(qR,{children:[s.jsx(Z5,{router:zce}),s.jsx(RR,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}tI.createRoot(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx($ce,{})}));
