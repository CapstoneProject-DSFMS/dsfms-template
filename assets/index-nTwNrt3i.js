import{P as R,j as a,B as ie,N as vt,a as g1,T as Gt,C as _e,b as W,A as Re,S as Ot,I as v1,F as A,M as ce,R as de,c as z,O as r2,d as s2,D as Mt,e as Ae,L as ha,f as o5,g as Ft,h as xx,i as Ph}from"./bootstrap-36CUpx7I.js";import{r as v,R as J,u as Gn,b as it,L as Vc,O as l5,c as c5,d as gx,N as d5,e as vx,f as Nr,g as u5,h as m5,i as f5}from"./router-C6Ic_n8-.js";import{a as h5,g as qn,r as bx}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Gc={},b1;function p5(){if(b1)return Gc;b1=1;var e=h5();return Gc.createRoot=e.createRoot,Gc.hydrateRoot=e.hydrateRoot,Gc}var x5=p5(),g5=["color","size","title","className"];function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Dh.apply(null,arguments)}function v5(e,t){if(e==null)return{};var r,s,n=b5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function b5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var a2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=v5(e,g5);return J.createElement("svg",Dh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-airplane",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});a2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var y5=["color","size","title","className"];function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Oh.apply(null,arguments)}function j5(e,t){if(e==null)return{};var r,s,n=w5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var n2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=j5(e,y5);return J.createElement("svg",Oh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-archive",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});n2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var N5=["color","size","title","className"];function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Rh.apply(null,arguments)}function S5(e,t){if(e==null)return{};var r,s,n=E5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var i2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=S5(e,N5);return J.createElement("svg",Rh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-clockwise",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),J.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});i2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var T5=["color","size","title","className"];function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fh.apply(null,arguments)}function C5(e,t){if(e==null)return{};var r,s,n=A5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var o2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=C5(e,T5);return J.createElement("svg",Fh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-counterclockwise",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"}),J.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"}))});o2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k5=["color","size","title","className"];function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Lh.apply(null,arguments)}function _5(e,t){if(e==null)return{};var r,s,n=I5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function I5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Pl=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=_5(e,k5);return J.createElement("svg",Lh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-down",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});Pl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var P5=["color","size","title","className"];function Mh(){return Mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mh.apply(null,arguments)}function D5(e,t){if(e==null)return{};var r,s,n=O5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var _t=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=D5(e,P5);return J.createElement("svg",Mh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-left",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});_t.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var R5=["color","size","title","className"];function Bh(){return Bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bh.apply(null,arguments)}function F5(e,t){if(e==null)return{};var r,s,n=L5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var mn=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=F5(e,R5);return J.createElement("svg",Bh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-right",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});mn.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var M5=["color","size","title","className"];function zh(){return zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zh.apply(null,arguments)}function B5(e,t){if(e==null)return{};var r,s,n=z5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var l2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=B5(e,M5);return J.createElement("svg",zh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-award",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),J.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});l2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $5=["color","size","title","className"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$h.apply(null,arguments)}function U5(e,t){if(e==null)return{};var r,s,n=W5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ed=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=U5(e,$5);return J.createElement("svg",$h({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-bar-chart",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M4 11H2v3h2zm5-4H7v7h2zm5-5v12h-2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1z"}))});Ed.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var H5=["color","size","title","className"];function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Uh.apply(null,arguments)}function V5(e,t){if(e==null)return{};var r,s,n=G5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var It=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=V5(e,H5);return J.createElement("svg",Uh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-book",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});It.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var q5=["color","size","title","className"];function Wh(){return Wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wh.apply(null,arguments)}function K5(e,t){if(e==null)return{};var r,s,n=Y5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Hh=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=K5(e,q5);return J.createElement("svg",Wh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-box-arrow-right",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),J.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});Hh.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var X5=["color","size","title","className"];function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vh.apply(null,arguments)}function J5(e,t){if(e==null)return{};var r,s,n=Z5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Bs=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=J5(e,X5);return J.createElement("svg",Vh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-building",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),J.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Bs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var Q5=["color","size","title","className"];function Gh(){return Gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gh.apply(null,arguments)}function e4(e,t){if(e==null)return{};var r,s,n=t4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function t4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ra=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=e4(e,Q5);return J.createElement("svg",Gh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-calendar-event",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});Ra.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var r4=["color","size","title","className"];function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},qh.apply(null,arguments)}function s4(e,t){if(e==null)return{};var r,s,n=a4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function a4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var nr=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=s4(e,r4);return J.createElement("svg",qh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-calendar",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});nr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var n4=["color","size","title","className"];function Kh(){return Kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Kh.apply(null,arguments)}function i4(e,t){if(e==null)return{};var r,s,n=o4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function o4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var c2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=i4(e,n4);return J.createElement("svg",Kh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chat-dots",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),J.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});c2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var l4=["color","size","title","className"];function Yh(){return Yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yh.apply(null,arguments)}function c4(e,t){if(e==null)return{};var r,s,n=d4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ht=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=c4(e,l4);return J.createElement("svg",Yh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});ht.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var u4=["color","size","title","className"];function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Xh.apply(null,arguments)}function m4(e,t){if(e==null)return{};var r,s,n=f4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var d2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=m4(e,u4);return J.createElement("svg",Xh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check-square",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});d2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var h4=["color","size","title","className"];function Jh(){return Jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jh.apply(null,arguments)}function p4(e,t){if(e==null)return{};var r,s,n=x4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var u2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=p4(e,h4);return J.createElement("svg",Jh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});u2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var g4=["color","size","title","className"];function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Zh.apply(null,arguments)}function v4(e,t){if(e==null)return{};var r,s,n=b4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function b4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ka=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=v4(e,g4);return J.createElement("svg",Zh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-down",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});Ka.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var y4=["color","size","title","className"];function Qh(){return Qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Qh.apply(null,arguments)}function j4(e,t){if(e==null)return{};var r,s,n=w4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cc=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=j4(e,y4);return J.createElement("svg",Qh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-right",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});cc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var N4=["color","size","title","className"];function e0(){return e0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},e0.apply(null,arguments)}function S4(e,t){if(e==null)return{};var r,s,n=E4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var m2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=S4(e,N4);return J.createElement("svg",e0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-up",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});m2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var T4=["color","size","title","className"];function t0(){return t0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},t0.apply(null,arguments)}function C4(e,t){if(e==null)return{};var r,s,n=A4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Dt=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=C4(e,T4);return J.createElement("svg",t0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-clipboard-check",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),J.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});Dt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k4=["color","size","title","className"];function r0(){return r0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},r0.apply(null,arguments)}function _4(e,t){if(e==null)return{};var r,s,n=I4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function I4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var f2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=_4(e,k4);return J.createElement("svg",r0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-clock-history",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"}),J.createElement("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"}),J.createElement("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"}))});f2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var P4=["color","size","title","className"];function s0(){return s0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},s0.apply(null,arguments)}function D4(e,t){if(e==null)return{};var r,s,n=O4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ft=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=D4(e,P4);return J.createElement("svg",s0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-clock",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),J.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});ft.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var R4=["color","size","title","className"];function a0(){return a0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},a0.apply(null,arguments)}function F4(e,t){if(e==null)return{};var r,s,n=L4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var h2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=F4(e,R4);return J.createElement("svg",a0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-collection",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5z"}))});h2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var M4=["color","size","title","className"];function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},n0.apply(null,arguments)}function B4(e,t){if(e==null)return{};var r,s,n=z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var $i=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=B4(e,M4);return J.createElement("svg",n0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-download",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});$i.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $4=["color","size","title","className"];function i0(){return i0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},i0.apply(null,arguments)}function U4(e,t){if(e==null)return{};var r,s,n=W4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ti=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=U4(e,$4);return J.createElement("svg",i0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-envelope",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});Ti.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var H4=["color","size","title","className"];function o0(){return o0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},o0.apply(null,arguments)}function V4(e,t){if(e==null)return{};var r,s,n=G4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var p2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=V4(e,H4);return J.createElement("svg",o0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-exclamation-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});p2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var q4=["color","size","title","className"];function l0(){return l0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},l0.apply(null,arguments)}function K4(e,t){if(e==null)return{};var r,s,n=Y4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var fr=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=K4(e,q4);return J.createElement("svg",l0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-exclamation-triangle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),J.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});fr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var X4=["color","size","title","className"];function c0(){return c0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},c0.apply(null,arguments)}function J4(e,t){if(e==null)return{};var r,s,n=Z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Dl=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=J4(e,X4);return J.createElement("svg",c0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-eye-slash",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),J.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),J.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});Dl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var Q4=["color","size","title","className"];function d0(){return d0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},d0.apply(null,arguments)}function e3(e,t){if(e==null)return{};var r,s,n=t3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function t3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Et=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=e3(e,Q4);return J.createElement("svg",d0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-eye",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),J.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});Et.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var r3=["color","size","title","className"];function u0(){return u0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},u0.apply(null,arguments)}function s3(e,t){if(e==null)return{};var r,s,n=a3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function a3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var vo=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=s3(e,r3);return J.createElement("svg",u0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-excel",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});vo.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var n3=["color","size","title","className"];function m0(){return m0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},m0.apply(null,arguments)}function i3(e,t){if(e==null)return{};var r,s,n=o3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function o3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Du=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=i3(e,n3);return J.createElement("svg",m0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-pdf",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),J.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});Du.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var l3=["color","size","title","className"];function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},f0.apply(null,arguments)}function c3(e,t){if(e==null)return{};var r,s,n=d3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var x2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=c3(e,l3);return J.createElement("svg",f0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-plus",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 6.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V9.5H6a.5.5 0 0 1 0-1h1.5V7a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});x2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var u3=["color","size","title","className"];function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},h0.apply(null,arguments)}function m3(e,t){if(e==null)return{};var r,s,n=f3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ou=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=m3(e,u3);return J.createElement("svg",h0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-text",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),J.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Ou.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var h3=["color","size","title","className"];function p0(){return p0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},p0.apply(null,arguments)}function p3(e,t){if(e==null)return{};var r,s,n=x3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ol=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=p3(e,h3);return J.createElement("svg",p0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});Ol.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var g3=["color","size","title","className"];function x0(){return x0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},x0.apply(null,arguments)}function v3(e,t){if(e==null)return{};var r,s,n=b3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function b3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var g2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=v3(e,g3);return J.createElement("svg",x0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-text-fill",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});g2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var y3=["color","size","title","className"];function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},g0.apply(null,arguments)}function j3(e,t){if(e==null)return{};var r,s,n=w3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var At=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=j3(e,y3);return J.createElement("svg",g0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-text",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),J.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});At.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var N3=["color","size","title","className"];function v0(){return v0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},v0.apply(null,arguments)}function S3(e,t){if(e==null)return{};var r,s,n=E3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ui=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=S3(e,N3);return J.createElement("svg",v0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-funnel",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});Ui.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var T3=["color","size","title","className"];function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},b0.apply(null,arguments)}function C3(e,t){if(e==null)return{};var r,s,n=A3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var v2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=C3(e,T3);return J.createElement("svg",b0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-gear",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),J.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});v2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k3=["color","size","title","className"];function y0(){return y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},y0.apply(null,arguments)}function _3(e,t){if(e==null)return{};var r,s,n=I3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function I3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var bo=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=_3(e,k3);return J.createElement("svg",y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-geo-alt",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),J.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});bo.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var P3=["color","size","title","className"];function j0(){return j0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},j0.apply(null,arguments)}function D3(e,t){if(e==null)return{};var r,s,n=O3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var b2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=D3(e,P3);return J.createElement("svg",j0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-house",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});b2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var R3=["color","size","title","className"];function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},w0.apply(null,arguments)}function F3(e,t){if(e==null)return{};var r,s,n=L3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var y2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=F3(e,R3);return J.createElement("svg",w0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-info-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});y2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var M3=["color","size","title","className"];function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},N0.apply(null,arguments)}function B3(e,t){if(e==null)return{};var r,s,n=z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Rl=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=B3(e,M3);return J.createElement("svg",N0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-key",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),J.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Rl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $3=["color","size","title","className"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},S0.apply(null,arguments)}function U3(e,t){if(e==null)return{};var r,s,n=W3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var j2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=U3(e,$3);return J.createElement("svg",S0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-list-check",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0"}))});j2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var H3=["color","size","title","className"];function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},E0.apply(null,arguments)}function V3(e,t){if(e==null)return{};var r,s,n=G3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var yx=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=V3(e,H3);return J.createElement("svg",E0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-list-ul",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});yx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var q3=["color","size","title","className"];function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T0.apply(null,arguments)}function K3(e,t){if(e==null)return{};var r,s,n=Y3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var jx=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=K3(e,q3);return J.createElement("svg",T0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-list",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});jx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var X3=["color","size","title","className"];function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},C0.apply(null,arguments)}function J3(e,t){if(e==null)return{};var r,s,n=Z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var pl=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=J3(e,X3);return J.createElement("svg",C0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-passport",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6M6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0m-.5 4a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"}),J.createElement("path",{d:"M3.232 1.776A1.5 1.5 0 0 0 2 3.252v10.95c0 .445.191.838.49 1.11.367.422.908.688 1.51.688h8a2 2 0 0 0 2-2V4a2 2 0 0 0-1-1.732v-.47A1.5 1.5 0 0 0 11.232.321l-8 1.454ZM4 3h8a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"}))});pl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var Q3=["color","size","title","className"];function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},A0.apply(null,arguments)}function eI(e,t){if(e==null)return{};var r,s,n=tI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var fn=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=eI(e,Q3);return J.createElement("svg",A0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pen",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});fn.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var rI=["color","size","title","className"];function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},k0.apply(null,arguments)}function sI(e,t){if(e==null)return{};var r,s,n=aI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var wx=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=sI(e,rI);return J.createElement("svg",k0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pencil-square",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),J.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});wx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nI=["color","size","title","className"];function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_0.apply(null,arguments)}function iI(e,t){if(e==null)return{};var r,s,n=oI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Br=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=iI(e,nI);return J.createElement("svg",_0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pencil",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});Br.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var lI=["color","size","title","className"];function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},I0.apply(null,arguments)}function cI(e,t){if(e==null)return{};var r,s,n=dI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Lr=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=cI(e,lI);return J.createElement("svg",I0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-people",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Lr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uI=["color","size","title","className"];function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},P0.apply(null,arguments)}function mI(e,t){if(e==null)return{};var r,s,n=fI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var w2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=mI(e,uI);return J.createElement("svg",P0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-check-fill",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});w2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hI=["color","size","title","className"];function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},D0.apply(null,arguments)}function pI(e,t){if(e==null)return{};var r,s,n=xI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var va=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=pI(e,hI);return J.createElement("svg",D0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-check",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),J.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});va.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gI=["color","size","title","className"];function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},O0.apply(null,arguments)}function vI(e,t){if(e==null)return{};var r,s,n=bI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var oo=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=vI(e,gI);return J.createElement("svg",O0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),J.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});oo.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var yI=["color","size","title","className"];function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},R0.apply(null,arguments)}function jI(e,t){if(e==null)return{};var r,s,n=wI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var dc=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=jI(e,yI);return J.createElement("svg",R0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-x",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});dc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var NI=["color","size","title","className"];function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},F0.apply(null,arguments)}function SI(e,t){if(e==null)return{};var r,s,n=EI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Lt=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=SI(e,NI);return J.createElement("svg",F0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Lt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var TI=["color","size","title","className"];function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},L0.apply(null,arguments)}function CI(e,t){if(e==null)return{};var r,s,n=AI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var N2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=CI(e,TI);return J.createElement("svg",L0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-phone",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});N2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var kI=["color","size","title","className"];function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},M0.apply(null,arguments)}function _I(e,t){if(e==null)return{};var r,s,n=II(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function II(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var S2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=_I(e,kI);return J.createElement("svg",M0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pie-chart",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793zm1 0V7.5h6.482A7 7 0 0 0 8.5 1.018M14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8"}))});S2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var PI=["color","size","title","className"];function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},B0.apply(null,arguments)}function DI(e,t){if(e==null)return{};var r,s,n=OI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var z0=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=DI(e,PI);return J.createElement("svg",B0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-play-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});z0.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var RI=["color","size","title","className"];function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$0.apply(null,arguments)}function FI(e,t){if(e==null)return{};var r,s,n=LI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Nx=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=FI(e,RI);return J.createElement("svg",$0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-play",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});Nx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var MI=["color","size","title","className"];function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},U0.apply(null,arguments)}function BI(e,t){if(e==null)return{};var r,s,n=zI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var E2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=BI(e,MI);return J.createElement("svg",U0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-plus-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});E2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var $I=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},W0.apply(null,arguments)}function UI(e,t){if(e==null)return{};var r,s,n=WI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ms=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=UI(e,$I);return J.createElement("svg",W0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-plus",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});ms.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var HI=["color","size","title","className"];function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},H0.apply(null,arguments)}function VI(e,t){if(e==null)return{};var r,s,n=GI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ts=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=VI(e,HI);return J.createElement("svg",H0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-save",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});ts.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var qI=["color","size","title","className"];function V0(){return V0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V0.apply(null,arguments)}function KI(e,t){if(e==null)return{};var r,s,n=YI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Sx=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=KI(e,qI);return J.createElement("svg",V0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-search",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});Sx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var XI=["color","size","title","className"];function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},G0.apply(null,arguments)}function JI(e,t){if(e==null)return{};var r,s,n=ZI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZI(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var T2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=JI(e,XI);return J.createElement("svg",G0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-send",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});T2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var QI=["color","size","title","className"];function q0(){return q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},q0.apply(null,arguments)}function eP(e,t){if(e==null)return{};var r,s,n=tP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var C2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=eP(e,QI);return J.createElement("svg",q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-shield-x",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),J.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});C2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var rP=["color","size","title","className"];function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},K0.apply(null,arguments)}function sP(e,t){if(e==null)return{};var r,s,n=aP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ex=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=sP(e,rP);return J.createElement("svg",K0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-shield",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});Ex.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var nP=["color","size","title","className"];function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Y0.apply(null,arguments)}function iP(e,t){if(e==null)return{};var r,s,n=oP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var A2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=iP(e,nP);return J.createElement("svg",Y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-square",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});A2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var lP=["color","size","title","className"];function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},X0.apply(null,arguments)}function cP(e,t){if(e==null)return{};var r,s,n=dP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var k2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=cP(e,lP);return J.createElement("svg",X0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-star",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});k2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var uP=["color","size","title","className"];function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},J0.apply(null,arguments)}function mP(e,t){if(e==null)return{};var r,s,n=fP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var $t=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=mP(e,uP);return J.createElement("svg",J0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-three-dots-vertical",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});$t.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var hP=["color","size","title","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Z0.apply(null,arguments)}function pP(e,t){if(e==null)return{};var r,s,n=xP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Wi=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=pP(e,hP);return J.createElement("svg",Z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-trash",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),J.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Wi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var gP=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Q0.apply(null,arguments)}function vP(e,t){if(e==null)return{};var r,s,n=bP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var _2=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=vP(e,gP);return J.createElement("svg",Q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-trophy",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});_2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var yP=["color","size","title","className"];function ep(){return ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ep.apply(null,arguments)}function jP(e,t){if(e==null)return{};var r,s,n=wP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ds=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=jP(e,yP);return J.createElement("svg",ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-upload",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Ds.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var NP=["color","size","title","className"];function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},tp.apply(null,arguments)}function SP(e,t){if(e==null)return{};var r,s,n=EP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Qs=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=SP(e,NP);return J.createElement("svg",tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-x-circle",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Qs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var TP=["color","size","title","className"];function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},rp.apply(null,arguments)}function CP(e,t){if(e==null)return{};var r,s,n=AP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var nt=v.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,u=c===void 0?"":c,d=CP(e,TP);return J.createElement("svg",rp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-x",u].filter(Boolean).join(" ")},d),l?J.createElement("title",null,l):null,J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});nt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};const kP="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function I2(e,t){return function(){return e.apply(t,arguments)}}const{toString:_P}=Object.prototype,{getPrototypeOf:Tx}=Object,{iterator:Ru,toStringTag:P2}=Symbol,Fu=(e=>t=>{const r=_P.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ma=e=>(e=e.toLowerCase(),t=>Fu(t)===e),Lu=e=>t=>typeof t===e,{isArray:Mo}=Array,yo=Lu("undefined");function uc(e){return e!==null&&!yo(e)&&e.constructor!==null&&!yo(e.constructor)&&zs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const D2=Ma("ArrayBuffer");function IP(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&D2(e.buffer),t}const PP=Lu("string"),zs=Lu("function"),O2=Lu("number"),mc=e=>e!==null&&typeof e=="object",DP=e=>e===!0||e===!1,Td=e=>{if(Fu(e)!=="object")return!1;const t=Tx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(P2 in e)&&!(Ru in e)},OP=e=>{if(!mc(e)||uc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},RP=Ma("Date"),FP=Ma("File"),LP=Ma("Blob"),MP=Ma("FileList"),BP=e=>mc(e)&&zs(e.pipe),zP=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||zs(e.append)&&((t=Fu(e))==="formdata"||t==="object"&&zs(e.toString)&&e.toString()==="[object FormData]"))},$P=Ma("URLSearchParams"),[UP,WP,HP,VP]=["ReadableStream","Request","Response","Headers"].map(Ma),GP=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,n;if(typeof e!="object"&&(e=[e]),Mo(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{if(uc(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(s=0;s<o;s++)l=i[s],t.call(null,e[l],l,e)}}function R2(e,t){if(uc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s=r.length,n;for(;s-- >0;)if(n=r[s],t===n.toLowerCase())return n;return null}const di=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,F2=e=>!yo(e)&&e!==di;function sp(){const{caseless:e,skipUndefined:t}=F2(this)&&this||{},r={},s=(n,i)=>{const o=e&&R2(r,i)||i;Td(r[o])&&Td(n)?r[o]=sp(r[o],n):Td(n)?r[o]=sp({},n):Mo(n)?r[o]=n.slice():(!t||!yo(n))&&(r[o]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&fc(arguments[n],s);return r}const qP=(e,t,r,{allOwnKeys:s}={})=>(fc(t,(n,i)=>{r&&zs(n)?e[i]=I2(n,r):e[i]=n},{allOwnKeys:s}),e),KP=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),YP=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},XP=(e,t,r,s)=>{let n,i,o;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)o=n[i],(!s||s(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Tx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},JP=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},ZP=e=>{if(!e)return null;if(Mo(e))return e;let t=e.length;if(!O2(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},QP=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Tx(Uint8Array)),eD=(e,t)=>{const s=(e&&e[Ru]).call(e);let n;for(;(n=s.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},tD=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},rD=Ma("HTMLFormElement"),sD=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),y1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),aD=Ma("RegExp"),L2=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};fc(r,(n,i)=>{let o;(o=t(n,i,e))!==!1&&(s[i]=o||n)}),Object.defineProperties(e,s)},nD=e=>{L2(e,(t,r)=>{if(zs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(zs(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},iD=(e,t)=>{const r={},s=n=>{n.forEach(i=>{r[i]=!0})};return Mo(e)?s(e):s(String(e).split(t)),r},oD=()=>{},lD=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function cD(e){return!!(e&&zs(e.append)&&e[P2]==="FormData"&&e[Ru])}const dD=e=>{const t=new Array(10),r=(s,n)=>{if(mc(s)){if(t.indexOf(s)>=0)return;if(uc(s))return s;if(!("toJSON"in s)){t[n]=s;const i=Mo(s)?[]:{};return fc(s,(o,l)=>{const c=r(o,n+1);!yo(c)&&(i[l]=c)}),t[n]=void 0,i}}return s};return r(e,0)},uD=Ma("AsyncFunction"),mD=e=>e&&(mc(e)||zs(e))&&zs(e.then)&&zs(e.catch),M2=((e,t)=>e?setImmediate:t?((r,s)=>(di.addEventListener("message",({source:n,data:i})=>{n===di&&i===r&&s.length&&s.shift()()},!1),n=>{s.push(n),di.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",zs(di.postMessage)),fD=typeof queueMicrotask<"u"?queueMicrotask.bind(di):typeof process<"u"&&process.nextTick||M2,hD=e=>e!=null&&zs(e[Ru]),Ee={isArray:Mo,isArrayBuffer:D2,isBuffer:uc,isFormData:zP,isArrayBufferView:IP,isString:PP,isNumber:O2,isBoolean:DP,isObject:mc,isPlainObject:Td,isEmptyObject:OP,isReadableStream:UP,isRequest:WP,isResponse:HP,isHeaders:VP,isUndefined:yo,isDate:RP,isFile:FP,isBlob:LP,isRegExp:aD,isFunction:zs,isStream:BP,isURLSearchParams:$P,isTypedArray:QP,isFileList:MP,forEach:fc,merge:sp,extend:qP,trim:GP,stripBOM:KP,inherits:YP,toFlatObject:XP,kindOf:Fu,kindOfTest:Ma,endsWith:JP,toArray:ZP,forEachEntry:eD,matchAll:tD,isHTMLForm:rD,hasOwnProperty:y1,hasOwnProp:y1,reduceDescriptors:L2,freezeMethods:nD,toObjectSet:iD,toCamelCase:sD,noop:oD,toFiniteNumber:lD,findKey:R2,global:di,isContextDefined:F2,isSpecCompliantForm:cD,toJSONObject:dD,isAsyncFn:uD,isThenable:mD,setImmediate:M2,asap:fD,isIterable:hD};function wt(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}Ee.inherits(wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ee.toJSONObject(this.config),code:this.code,status:this.status}}});const B2=wt.prototype,z2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{z2[e]={value:e}});Object.defineProperties(wt,z2);Object.defineProperty(B2,"isAxiosError",{value:!0});wt.from=(e,t,r,s,n,i)=>{const o=Object.create(B2);Ee.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return wt.call(o,l,c,r,s,n),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const pD=null;function ap(e){return Ee.isPlainObject(e)||Ee.isArray(e)}function $2(e){return Ee.endsWith(e,"[]")?e.slice(0,-2):e}function j1(e,t,r){return e?e.concat(t).map(function(n,i){return n=$2(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function xD(e){return Ee.isArray(e)&&!e.some(ap)}const gD=Ee.toFlatObject(Ee,{},null,function(t){return/^is[A-Z]/.test(t)});function Mu(e,t,r){if(!Ee.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ee.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!Ee.isUndefined(g[p])});const s=r.metaTokens,n=r.visitor||d,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ee.isSpecCompliantForm(t);if(!Ee.isFunction(n))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Ee.isDate(x))return x.toISOString();if(Ee.isBoolean(x))return x.toString();if(!c&&Ee.isBlob(x))throw new wt("Blob is not supported. Use a Buffer instead.");return Ee.isArrayBuffer(x)||Ee.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,p,g){let b=x;if(x&&!g&&typeof x=="object"){if(Ee.endsWith(p,"{}"))p=s?p:p.slice(0,-2),x=JSON.stringify(x);else if(Ee.isArray(x)&&xD(x)||(Ee.isFileList(x)||Ee.endsWith(p,"[]"))&&(b=Ee.toArray(x)))return p=$2(p),b.forEach(function(j,S){!(Ee.isUndefined(j)||j===null)&&t.append(o===!0?j1([p],S,i):o===null?p:p+"[]",u(j))}),!1}return ap(x)?!0:(t.append(j1(g,p,i),u(x)),!1)}const m=[],f=Object.assign(gD,{defaultVisitor:d,convertValue:u,isVisitable:ap});function h(x,p){if(!Ee.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+p.join("."));m.push(x),Ee.forEach(x,function(b,y){(!(Ee.isUndefined(b)||b===null)&&n.call(t,b,Ee.isString(y)?y.trim():y,p,f))===!0&&h(b,p?p.concat(y):[y])}),m.pop()}}if(!Ee.isObject(e))throw new TypeError("data must be an object");return h(e),t}function w1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Cx(e,t){this._pairs=[],e&&Mu(e,this,t)}const U2=Cx.prototype;U2.append=function(t,r){this._pairs.push([t,r])};U2.toString=function(t){const r=t?function(s){return t.call(this,s,w1)}:w1;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function vD(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function W2(e,t,r){if(!t)return e;const s=r&&r.encode||vD;Ee.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=Ee.isURLSearchParams(t)?t.toString():new Cx(t,r).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class N1{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ee.forEach(this.handlers,function(s){s!==null&&t(s)})}}const H2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bD=typeof URLSearchParams<"u"?URLSearchParams:Cx,yD=typeof FormData<"u"?FormData:null,jD=typeof Blob<"u"?Blob:null,wD={isBrowser:!0,classes:{URLSearchParams:bD,FormData:yD,Blob:jD},protocols:["http","https","file","blob","url","data"]},Ax=typeof window<"u"&&typeof document<"u",np=typeof navigator=="object"&&navigator||void 0,ND=Ax&&(!np||["ReactNative","NativeScript","NS"].indexOf(np.product)<0),SD=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ED=Ax&&window.location.href||"http://localhost",TD=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ax,hasStandardBrowserEnv:ND,hasStandardBrowserWebWorkerEnv:SD,navigator:np,origin:ED},Symbol.toStringTag,{value:"Module"})),js={...TD,...wD};function CD(e,t){return Mu(e,new js.classes.URLSearchParams,{visitor:function(r,s,n,i){return js.isNode&&Ee.isBuffer(r)?(this.append(s,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function AD(e){return Ee.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kD(e){const t={},r=Object.keys(e);let s;const n=r.length;let i;for(s=0;s<n;s++)i=r[s],t[i]=e[i];return t}function V2(e){function t(r,s,n,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&Ee.isArray(n)?n.length:o,c?(Ee.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!l):((!n[o]||!Ee.isObject(n[o]))&&(n[o]=[]),t(r,s,n[o],i)&&Ee.isArray(n[o])&&(n[o]=kD(n[o])),!l)}if(Ee.isFormData(e)&&Ee.isFunction(e.entries)){const r={};return Ee.forEachEntry(e,(s,n)=>{t(AD(s),n,r,0)}),r}return null}function _D(e,t,r){if(Ee.isString(e))try{return(t||JSON.parse)(e),Ee.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const hc={transitional:H2,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,i=Ee.isObject(t);if(i&&Ee.isHTMLForm(t)&&(t=new FormData(t)),Ee.isFormData(t))return n?JSON.stringify(V2(t)):t;if(Ee.isArrayBuffer(t)||Ee.isBuffer(t)||Ee.isStream(t)||Ee.isFile(t)||Ee.isBlob(t)||Ee.isReadableStream(t))return t;if(Ee.isArrayBufferView(t))return t.buffer;if(Ee.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return CD(t,this.formSerializer).toString();if((l=Ee.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Mu(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),_D(t)):t}],transformResponse:[function(t){const r=this.transitional||hc.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Ee.isResponse(t)||Ee.isReadableStream(t))return t;if(t&&Ee.isString(t)&&(s&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?wt.from(l,wt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:js.classes.FormData,Blob:js.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ee.forEach(["delete","get","head","post","put","patch"],e=>{hc.headers[e]={}});const ID=Ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),PD=e=>{const t={};let r,s,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!r||t[r]&&ID[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},S1=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function Cd(e){return e===!1||e==null?e:Ee.isArray(e)?e.map(Cd):String(e)}function DD(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const OD=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Pm(e,t,r,s,n){if(Ee.isFunction(s))return s.call(this,t,r);if(n&&(t=r),!!Ee.isString(t)){if(Ee.isString(s))return t.indexOf(s)!==-1;if(Ee.isRegExp(s))return s.test(t)}}function RD(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function FD(e,t){const r=Ee.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(n,i,o){return this[s].call(this,t,n,i,o)},configurable:!0})})}let $s=class{constructor(t){t&&this.set(t)}set(t,r,s){const n=this;function i(l,c,u){const d=rl(c);if(!d)throw new Error("header name must be a non-empty string");const m=Ee.findKey(n,d);(!m||n[m]===void 0||u===!0||u===void 0&&n[m]!==!1)&&(n[m||c]=Cd(l))}const o=(l,c)=>Ee.forEach(l,(u,d)=>i(u,d,c));if(Ee.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Ee.isString(t)&&(t=t.trim())&&!OD(t))o(PD(t),r);else if(Ee.isObject(t)&&Ee.isIterable(t)){let l={},c,u;for(const d of t){if(!Ee.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?Ee.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&i(r,t,s);return this}get(t,r){if(t=rl(t),t){const s=Ee.findKey(this,t);if(s){const n=this[s];if(!r)return n;if(r===!0)return DD(n);if(Ee.isFunction(r))return r.call(this,n,s);if(Ee.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=rl(t),t){const s=Ee.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||Pm(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let n=!1;function i(o){if(o=rl(o),o){const l=Ee.findKey(s,o);l&&(!r||Pm(s,s[l],l,r))&&(delete s[l],n=!0)}}return Ee.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const i=r[s];(!t||Pm(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,s={};return Ee.forEach(this,(n,i)=>{const o=Ee.findKey(s,i);if(o){r[o]=Cd(n),delete r[i];return}const l=t?RD(i):String(i).trim();l!==i&&delete r[i],r[l]=Cd(n),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ee.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=t&&Ee.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[S1]=this[S1]={accessors:{}}).accessors,n=this.prototype;function i(o){const l=rl(o);s[l]||(FD(n,o),s[l]=!0)}return Ee.isArray(t)?t.forEach(i):i(t),this}};$s.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ee.reduceDescriptors($s.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});Ee.freezeMethods($s);function Dm(e,t){const r=this||hc,s=t||r,n=$s.from(s.headers);let i=s.data;return Ee.forEach(e,function(l){i=l.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function G2(e){return!!(e&&e.__CANCEL__)}function Bo(e,t,r){wt.call(this,e??"canceled",wt.ERR_CANCELED,t,r),this.name="CanceledError"}Ee.inherits(Bo,wt,{__CANCEL__:!0});function q2(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new wt("Request failed with status code "+r.status,[wt.ERR_BAD_REQUEST,wt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function LD(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function MD(e,t){e=e||10;const r=new Array(e),s=new Array(e);let n=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=s[i];o||(o=u),r[n]=c,s[n]=u;let m=i,f=0;for(;m!==n;)f+=r[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),u-o<t)return;const h=d&&u-d;return h?Math.round(f*1e3/h):void 0}}function BD(e,t){let r=0,s=1e3/t,n,i;const o=(u,d=Date.now())=>{r=d,n=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),m=d-r;m>=s?o(u,d):(n=u,i||(i=setTimeout(()=>{i=null,o(n)},s-m)))},()=>n&&o(n)]}const Od=(e,t,r=3)=>{let s=0;const n=MD(50,250);return BD(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-s,u=n(c),d=o<=l;s=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},E1=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},T1=e=>(...t)=>Ee.asap(()=>e(...t)),zD=js.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,js.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(js.origin),js.navigator&&/(msie|trident)/i.test(js.navigator.userAgent)):()=>!0,$D=js.hasStandardBrowserEnv?{write(e,t,r,s,n,i){const o=[e+"="+encodeURIComponent(t)];Ee.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Ee.isString(s)&&o.push("path="+s),Ee.isString(n)&&o.push("domain="+n),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function UD(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function WD(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function K2(e,t,r){let s=!UD(t);return e&&(s||r==!1)?WD(e,t):t}const C1=e=>e instanceof $s?{...e}:e;function Ci(e,t){t=t||{};const r={};function s(u,d,m,f){return Ee.isPlainObject(u)&&Ee.isPlainObject(d)?Ee.merge.call({caseless:f},u,d):Ee.isPlainObject(d)?Ee.merge({},d):Ee.isArray(d)?d.slice():d}function n(u,d,m,f){if(Ee.isUndefined(d)){if(!Ee.isUndefined(u))return s(void 0,u,m,f)}else return s(u,d,m,f)}function i(u,d){if(!Ee.isUndefined(d))return s(void 0,d)}function o(u,d){if(Ee.isUndefined(d)){if(!Ee.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,m){if(m in t)return s(u,d);if(m in e)return s(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>n(C1(u),C1(d),m,!0)};return Ee.forEach(Object.keys({...e,...t}),function(d){const m=c[d]||n,f=m(e[d],t[d],d);Ee.isUndefined(f)&&m!==l||(r[d]=f)}),r}const Y2=e=>{const t=Ci({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=$s.from(o),t.url=W2(K2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Ee.isFormData(r)){if(js.hasStandardBrowserEnv||js.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Ee.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,m])=>{u.includes(d.toLowerCase())&&o.set(d,m)})}}if(js.hasStandardBrowserEnv&&(s&&Ee.isFunction(s)&&(s=s(t)),s||s!==!1&&zD(t.url))){const c=n&&i&&$D.read(i);c&&o.set(n,c)}return t},HD=typeof XMLHttpRequest<"u",VD=HD&&function(e){return new Promise(function(r,s){const n=Y2(e);let i=n.data;const o=$s.from(n.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=n,d,m,f,h,x;function p(){h&&h(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function b(){if(!g)return;const j=$s.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),E={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:j,config:e,request:g};q2(function(N){r(N),p()},function(N){s(N),p()},E),g=null}"onloadend"in g?g.onloadend=b:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(b)},g.onabort=function(){g&&(s(new wt("Request aborted",wt.ECONNABORTED,e,g)),g=null)},g.onerror=function(S){const E=S&&S.message?S.message:"Network Error",w=new wt(E,wt.ERR_NETWORK,e,g);w.event=S||null,s(w),g=null},g.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const E=n.transitional||H2;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),s(new wt(S,E.clarifyTimeoutError?wt.ETIMEDOUT:wt.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&Ee.forEach(o.toJSON(),function(S,E){g.setRequestHeader(E,S)}),Ee.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),l&&l!=="json"&&(g.responseType=n.responseType),u&&([f,x]=Od(u,!0),g.addEventListener("progress",f)),c&&g.upload&&([m,h]=Od(c),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(d=j=>{g&&(s(!j||j.type?new Bo(null,e,g):j),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const y=LD(n.url);if(y&&js.protocols.indexOf(y)===-1){s(new wt("Unsupported protocol "+y+":",wt.ERR_BAD_REQUEST,e));return}g.send(i||null)})},GD=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,n;const i=function(u){if(!n){n=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof wt?d:new Bo(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new wt(`timeout ${t} of ms exceeded`,wt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>Ee.asap(l),c}},qD=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,n;for(;s<r;)n=s+t,yield e.slice(s,n),s=n},KD=async function*(e,t){for await(const r of YD(e))yield*qD(r,t)},YD=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},A1=(e,t,r,s)=>{const n=KD(e,t);let i=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){l(),c.close();return}let m=d.byteLength;if(r){let f=i+=m;r(f)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),n.return()}},{highWaterMark:2})},k1=64*1024,{isFunction:qc}=Ee,XD=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ee.global),{ReadableStream:_1,TextEncoder:I1}=Ee.global,P1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},JD=e=>{e=Ee.merge.call({skipUndefined:!0},XD,e);const{fetch:t,Request:r,Response:s}=e,n=t?qc(t):typeof fetch=="function",i=qc(r),o=qc(s);if(!n)return!1;const l=n&&qc(_1),c=n&&(typeof I1=="function"?(x=>p=>x.encode(p))(new I1):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=i&&l&&P1(()=>{let x=!1;const p=new r(js.origin,{body:new _1,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!p}),d=o&&l&&P1(()=>Ee.isReadableStream(new s("").body)),m={stream:d&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!m[x]&&(m[x]=(p,g)=>{let b=p&&p[x];if(b)return b.call(p);throw new wt(`Response type '${x}' is not supported`,wt.ERR_NOT_SUPPORT,g)})});const f=async x=>{if(x==null)return 0;if(Ee.isBlob(x))return x.size;if(Ee.isSpecCompliantForm(x))return(await new r(js.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Ee.isArrayBufferView(x)||Ee.isArrayBuffer(x))return x.byteLength;if(Ee.isURLSearchParams(x)&&(x=x+""),Ee.isString(x))return(await c(x)).byteLength},h=async(x,p)=>{const g=Ee.toFiniteNumber(x.getContentLength());return g??f(p)};return async x=>{let{url:p,method:g,data:b,signal:y,cancelToken:j,timeout:S,onDownloadProgress:E,onUploadProgress:w,responseType:N,headers:C,withCredentials:T="same-origin",fetchOptions:_}=Y2(x),k=t||fetch;N=N?(N+"").toLowerCase():"text";let I=GD([y,j&&j.toAbortSignal()],S),L=null;const D=I&&I.unsubscribe&&(()=>{I.unsubscribe()});let M;try{if(w&&u&&g!=="get"&&g!=="head"&&(M=await h(C,b))!==0){let Se=new r(p,{method:"POST",body:b,duplex:"half"}),P;if(Ee.isFormData(b)&&(P=Se.headers.get("content-type"))&&C.setContentType(P),Se.body){const[G,K]=E1(M,Od(T1(w)));b=A1(Se.body,k1,G,K)}}Ee.isString(T)||(T=T?"include":"omit");const q=i&&"credentials"in r.prototype,Z={..._,signal:I,method:g.toUpperCase(),headers:C.normalize().toJSON(),body:b,duplex:"half",credentials:q?T:void 0};L=i&&new r(p,Z);let Q=await(i?k(L,_):k(p,Z));const U=d&&(N==="stream"||N==="response");if(d&&(E||U&&D)){const Se={};["status","statusText","headers"].forEach(O=>{Se[O]=Q[O]});const P=Ee.toFiniteNumber(Q.headers.get("content-length")),[G,K]=E&&E1(P,Od(T1(E),!0))||[];Q=new s(A1(Q.body,k1,G,()=>{K&&K(),D&&D()}),Se)}N=N||"text";let le=await m[Ee.findKey(m,N)||"text"](Q,x);return!U&&D&&D(),await new Promise((Se,P)=>{q2(Se,P,{data:le,headers:$s.from(Q.headers),status:Q.status,statusText:Q.statusText,config:x,request:L})})}catch(q){throw D&&D(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new wt("Network Error",wt.ERR_NETWORK,x,L),{cause:q.cause||q}):wt.from(q,q&&q.code,x,L)}}},ZD=new Map,X2=e=>{let t=e?e.env:{};const{fetch:r,Request:s,Response:n}=t,i=[s,n,r];let o=i.length,l=o,c,u,d=ZD;for(;l--;)c=i[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:JD(t)),d=u;return u};X2();const ip={http:pD,xhr:VD,fetch:{get:X2}};Ee.forEach(ip,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const D1=e=>`- ${e}`,QD=e=>Ee.isFunction(e)||e===null||e===!1,J2={getAdapter:(e,t)=>{e=Ee.isArray(e)?e:[e];const{length:r}=e;let s,n;const i={};for(let o=0;o<r;o++){s=e[o];let l;if(n=s,!QD(s)&&(n=ip[(l=String(s)).toLowerCase()],n===void 0))throw new wt(`Unknown adapter '${l}'`);if(n&&(Ee.isFunction(n)||(n=n.get(t))))break;i[l||"#"+o]=n}if(!n){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(D1).join(`
`):" "+D1(o[0]):"as no adapter specified";throw new wt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:ip};function Om(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Bo(null,e)}function O1(e){return Om(e),e.headers=$s.from(e.headers),e.data=Dm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),J2.getAdapter(e.adapter||hc.adapter,e)(e).then(function(s){return Om(e),s.data=Dm.call(e,e.transformResponse,s),s.headers=$s.from(s.headers),s},function(s){return G2(s)||(Om(e),s&&s.response&&(s.response.data=Dm.call(e,e.transformResponse,s.response),s.response.headers=$s.from(s.response.headers))),Promise.reject(s)})}const Z2="1.12.2",Bu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Bu[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const R1={};Bu.transitional=function(t,r,s){function n(i,o){return"[Axios v"+Z2+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(t===!1)throw new wt(n(o," has been removed"+(r?" in "+r:"")),wt.ERR_DEPRECATED);return r&&!R1[o]&&(R1[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Bu.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function eO(e,t,r){if(typeof e!="object")throw new wt("options must be an object",wt.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let n=s.length;for(;n-- >0;){const i=s[n],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new wt("option "+i+" must be "+c,wt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new wt("Unknown option "+i,wt.ERR_BAD_OPTION)}}const Ad={assertOptions:eO,validators:Bu},za=Ad.validators;let gi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new N1,response:new N1}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ci(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:i}=r;s!==void 0&&Ad.assertOptions(s,{silentJSONParsing:za.transitional(za.boolean),forcedJSONParsing:za.transitional(za.boolean),clarifyTimeoutError:za.transitional(za.boolean)},!1),n!=null&&(Ee.isFunction(n)?r.paramsSerializer={serialize:n}:Ad.assertOptions(n,{encode:za.function,serialize:za.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ad.assertOptions(r,{baseUrl:za.spelling("baseURL"),withXsrfToken:za.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&Ee.merge(i.common,i[r.method]);i&&Ee.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=$s.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,m=0,f;if(!c){const x=[O1.bind(this),void 0];for(x.unshift(...l),x.push(...u),f=x.length,d=Promise.resolve(r);m<f;)d=d.then(x[m++],x[m++]);return d}f=l.length;let h=r;for(;m<f;){const x=l[m++],p=l[m++];try{h=x(h)}catch(g){p.call(this,g);break}}try{d=O1.call(this,h)}catch(x){return Promise.reject(x)}for(m=0,f=u.length;m<f;)d=d.then(u[m++],u[m++]);return d}getUri(t){t=Ci(this.defaults,t);const r=K2(t.baseURL,t.url,t.allowAbsoluteUrls);return W2(r,t.params,t.paramsSerializer)}};Ee.forEach(["delete","get","head","options"],function(t){gi.prototype[t]=function(r,s){return this.request(Ci(s||{},{method:t,url:r,data:(s||{}).data}))}});Ee.forEach(["post","put","patch"],function(t){function r(s){return function(i,o,l){return this.request(Ci(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}gi.prototype[t]=r(),gi.prototype[t+"Form"]=r(!0)});let tO=class Q2{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const s=this;this.promise.then(n=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](n);s._listeners=null}),this.promise.then=n=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(n);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,l){s.reason||(s.reason=new Bo(i,o,l),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Q2(function(n){t=n}),cancel:t}}};function rO(e){return function(r){return e.apply(null,r)}}function sO(e){return Ee.isObject(e)&&e.isAxiosError===!0}const op={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(op).forEach(([e,t])=>{op[t]=e});function eS(e){const t=new gi(e),r=I2(gi.prototype.request,t);return Ee.extend(r,gi.prototype,t,{allOwnKeys:!0}),Ee.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return eS(Ci(e,n))},r}const wr=eS(hc);wr.Axios=gi;wr.CanceledError=Bo;wr.CancelToken=tO;wr.isCancel=G2;wr.VERSION=Z2;wr.toFormData=Mu;wr.AxiosError=wt;wr.Cancel=wr.CanceledError;wr.all=function(t){return Promise.all(t)};wr.spread=rO;wr.isAxiosError=sO;wr.mergeConfig=Ci;wr.AxiosHeaders=$s;wr.formToJSON=e=>V2(Ee.isHTMLForm(e)?new FormData(e):e);wr.getAdapter=J2.getAdapter;wr.HttpStatusCode=op;wr.default=wr;const{Axios:rce,AxiosError:sce,CanceledError:ace,isCancel:nce,CancelToken:ice,VERSION:oce,all:lce,Cancel:cce,isAxiosError:dce,spread:uce,toFormData:mce,AxiosHeaders:fce,HttpStatusCode:hce,formToJSON:pce,getAdapter:xce,mergeConfig:gce}=wr,jo={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},kx=()=>"/dsfms-template/",aO=(e="/")=>{const r=`${kx()}${e}`;window.location.href=r},Rm=()=>{aO("/")},tS="https://dsfms.id.vn",Pe=wr.create({baseURL:tS,timeout:1e4,headers:{"Content-Type":"application/json"}});let Fm=!1,lp=[],Kc=0;const F1=2,rS=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},nO=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},L1=(e,t=null)=>{lp.forEach(r=>{e?r.reject(e):r.resolve(t)}),lp=[]};Pe.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(rS(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):nO(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/assign-trainees")&&e.method==="post"&&console.log(" Assign Trainees Request (Interceptor):",{url:e.url,method:e.method,data:e.data,dataType:typeof e.data,dataIsArray:Array.isArray(e.data),dataStringified:JSON.stringify(e.data),headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Pe.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&Kc<F1){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),Fm)return new Promise((n,i)=>{lp.push({resolve:n,reject:i})}).then(n=>(t.headers.Authorization=`Bearer ${n}`,Pe(t))).catch(n=>Promise.reject(n));t._retry=!0,Fm=!0,Kc++;const s=localStorage.getItem("refreshToken");if(s)try{if(console.log(" Token ht hn (401), ang refresh token..."),rS(s))throw new Error("Refresh token is also expired");const n=await wr.post(`${tS}/auth/refresh`,{refresh_token:s}),{access_token:i,refresh_token:o}=n.data;if(!i||!o)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",o),Kc=0,console.log(" Refresh token thnh cng, retry request gc"),L1(null,i),t.headers.Authorization=`Bearer ${i}`,await Pe(t)}catch(n){return console.error(" Refresh token tht bi:",n),L1(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Rm(),Promise.reject(n)}finally{Fm=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Rm()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);Kc>=F1&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Rm())}return Promise.reject(e)});const Yc=wr.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),kn={login:async e=>{try{return(await Yc.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await Yc.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Pe.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await Yc.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await Yc.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(s){throw s.response?.data||s.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},os={getUsers:async(e={})=>{try{const r=(await Pe.get("/users",{params:e})).data;if(r&&r.data){if(Array.isArray(r.data))return{data:r.data};if(r.data.users&&Array.isArray(r.data.users))return{data:r.data.users}}return Array.isArray(r)?{data:r}:r&&r.users&&Array.isArray(r.users)?{data:r.users}:r}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{return(await Pe.get(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Pe.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Pe.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Pe.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Pe.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Pe.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{const t=(await Pe.get("/roles")).data;return t&&t.data&&typeof t.data=="object"?t.data:t}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Pe.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Pe.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Pe.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Pe.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Pe.get("/users",{params:{roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},_n=e=>e&&e.data&&typeof e.data=="object"?e.data:e,Cs={getRoles:async(e={})=>{try{const t=await Pe.get("/roles",{params:e});return _n(t.data)}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{const t=await Pe.get(`/roles/${e}`);return _n(t.data)}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{const t=await Pe.post("/roles",e);return _n(t.data)}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Pe.put(`/roles/${e}`,t),s=_n(r.data);return console.log(" API updateRole success:",s),s}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{const t=await Pe.delete(`/roles/${e}`);return _n(t.data)}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{const t=await Pe.patch(`/roles/${e}/toggle-status`);return _n(t.data)}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{const t=await Pe.patch(`/roles/${e}/enable`);return _n(t.data)}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{const t=await Pe.delete(`/roles/${e}`);return _n(t.data)}catch(t){throw t.response?.data||t.message}}},kt={getDepartments:async(e={})=>{try{return(await Pe.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{return(await Pe.get(`/departments/${e}`,{params:{includeDeleted:!0}})).data}catch(t){throw console.error("Error fetching department:",t),t}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Pe.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{console.log(" API - Updating department:",{id:e,departmentData:t});const r=await Pe.put(`/departments/${e}`,t);return console.log(" API - Department updated successfully:",r.data),r.data}catch(r){if(console.error(" API - Error updating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),console.error(" API - Request config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data}),r.code==="ERR_NETWORK"||r.message==="Network Error"){const s=new Error("Network error: Unable to connect to server. Please check your internet connection or contact support.");throw s.code="NETWORK_ERROR",s}else if(r.response?.status===502){const s=new Error("Server error (502): Bad Gateway. The server is temporarily unavailable. Please try again later.");throw s.code="BAD_GATEWAY",s}else if(r.response?.status===403){const s=new Error("Permission denied: You do not have permission to update this department.");throw s.code="PERMISSION_DENIED",s}throw r}},deleteDepartment:async e=>{try{return(await Pe.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Pe.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Pe.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Pe.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Pe.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Pe.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Pe.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Pe.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Pe.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},Jr={getCourses:async(e={})=>{try{return(await Pe.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await Pe.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Pe.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Pe.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},deleteCourse:async e=>{try{return(await Pe.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},archiveCourse:async e=>{try{return(await Pe.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},restoreCourse:async e=>{try{return(await Pe.post(`/courses/${e}/restore`)).data}catch(t){throw console.error("Error restoring course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Pe.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Pe.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{return(await Pe.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await Pe.get(`/courses/trainees/${e}/enrollments`)).data,getCourseTrainees:async e=>{try{return(await Pe.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching course trainees:",t),t}}},Fl={getTrainees:async(e={})=>{try{return(await Pe.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Pe.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Pe.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Pe.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Pe.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Pe.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Pe.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Pe.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Pe.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Pe.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Pe.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Pe.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{return(await Pe.get("/users",{params:{roleName:"TRAINEE",...e}})).data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={traineesList:e};console.log("Sending request with format:",t);const r=await Pe.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Pe.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},Xr={getSubjects:async(e={})=>{try{return(await Pe.get("/subjects",{params:e})).data}catch(t){throw t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;try{return(await Pe.get(r,{params:t})).data}catch(s){throw s}},getSubjectById:async e=>{try{const t=await Pe.get(`/subjects/${e}`,{data:void 0,transformRequest:[(r,s)=>{delete s["Content-Type"]}]});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw t}},createSubject:async e=>{try{return(await Pe.post("/subjects",e)).data}catch(t){throw t}},updateSubject:async(e,t)=>{try{return(await Pe.put(`/subjects/${e}`,t)).data}catch(r){throw r}},deleteSubject:async e=>{try{return(await Pe.delete(`/subjects/${e}`)).data}catch(t){throw t}},archiveSubject:async e=>{try{return(await Pe.delete(`/subjects/${e}/archive`)).data}catch(t){throw t}},bulkImportSubjects:async e=>{try{const r={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...o}=n;return o})},s=await Pe.post("/subjects/bulk",r);return s.status===304?{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"}:s.data}catch(t){if(t.response?.status===304)return{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"};throw t}},assignTrainees:async(e,t)=>{try{const r={batchCode:t.batchCode||t.batch_code||"",traineeUserIds:t.traineeUserIds||t.trainee_user_ids||[]};if(!r.batchCode||typeof r.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(r.traineeUserIds)||r.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");const s={batchCode:String(r.batchCode).trim(),traineeUserIds:Array.isArray(r.traineeUserIds)?[...r.traineeUserIds]:[]};return(await Pe.post(`/subjects/${e}/assign-trainees`,s)).data}catch(r){throw r}},removeTraineeFromSubject:async(e,t,r)=>{try{const s={batchCode:r};return(await Pe.delete(`/subjects/${e}/trainees/${t}`,{data:s})).data}catch(s){throw s}},addTrainerToSubject:async(e,t)=>{try{if(!t||typeof t!="object")throw new Error("Trainer data is required and must be an object");if(!t.trainer_user_id)throw new Error("trainer_user_id is required");if(!t.role_in_subject)throw new Error("role_in_subject is required");const r=["EXAMINER","ASSESSMENT_REVIEWER"];if(!r.includes(t.role_in_subject))throw new Error(`Invalid role_in_subject: ${t.role_in_subject}. Must be one of: ${r.join(", ")}`);const s=String(t.trainer_user_id).trim(),n=String(t.role_in_subject).trim();if(!s||s==="")throw new Error("trainerUserId cannot be empty");if(!n||n==="")throw new Error("roleInSubject cannot be empty");const i={trainerUserId:s,roleInSubject:n};return(await Pe.post(`/subjects/${e}/trainers`,i,{headers:{"Content-Type":"application/json"}})).data}catch(r){throw r.response?.data?r.response.data:new Error(r.message||"Failed to add trainer to subject")}},getSubjectTrainers:async e=>{try{return(await Pe.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const s={roleInSubject:r.roleInSubject};return(await Pe.put(`/subjects/${e}/trainers/${t}`,s)).data}catch(s){throw s.response?.data||s.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Pe.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}}},Ya={getTemplates:async(e={})=>{try{return(await Pe.get("/templates",{params:e})).data}catch(t){throw t}},getTemplateById:async e=>{try{return(await Pe.get(`/templates/${e}`)).data}catch(t){throw t}},getTemplatesByDepartment:async(e,t={})=>{try{return(await Pe.get(`/templates/department/${e}`,{params:{status:"PUBLISHED",...t}})).data}catch(r){throw r}},createTemplate:async e=>{try{return(await Pe.post("/templates",e)).data}catch(t){throw t}},updateTemplate:async(e,t)=>{try{return(await Pe.put(`/templates/${e}`,t)).data}catch(r){throw r}},deleteTemplate:async e=>{try{return(await Pe.delete(`/templates/${e}`)).data}catch(t){throw t}},getTemplatePDF:async e=>{try{return(await Pe.get(`/templates/pdf/${e}`,{responseType:"blob"})).data}catch(t){throw t}}},wo={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const s of r)try{const n=new FormData;n.append(s,e),console.log(` Testing field name: "${s}"`);const i=await Pe.post(`/media/docs/upload/${t}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${s}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${s}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`,uploadFromUrl:async(e,t)=>{try{console.log(" Uploading from URL:",e),console.log(" File name:",t);const r=await Pe.post("/media/docs/upload-from-url",{sourceUrl:e,fileName:t});if(r.data&&r.data.data&&r.data.data.length>0){const s=r.data.data[0].url;return console.log(" File uploaded from URL successfully! New URL:",s),s}else throw new Error("Invalid response format from upload-from-url API")}catch(r){throw console.error(" Error uploading from URL:",r),r}}},pc={getAssessmentEvents:async(e={})=>{try{return(await Pe.get("/assessments/events",{params:e})).data}catch(t){throw console.error("Error fetching assessment events:",t),t}},updateAssessmentEvent:async(e={},t={})=>{try{return(await Pe.put("/assessments/events/update",t,{params:e})).data}catch(r){throw console.error("Error updating assessment event:",r),r}},createAssessmentEvent:async e=>{try{return(await Pe.post("/assessments",e)).data}catch(t){throw console.error("Error creating assessment event:",t),t}},createBulkAssessmentEvent:async e=>{try{return(await Pe.post("/assessments/bulk",e)).data}catch(t){throw console.error("Error creating bulk assessment event:",t),t}}},Rd={getGlobalFields:async()=>{try{return(await Pe.get("/global-fields")).data}catch(e){throw e}},getGlobalFieldDetail:async()=>{try{return(await Pe.get("/global-fields/detail")).data}catch(e){throw e}},getGlobalFieldById:async e=>{try{return(await Pe.get(`/global-fields/${e}`)).data}catch(t){throw t}},createGlobalField:async e=>{try{return(await Pe.post("/global-fields",e)).data}catch(t){throw t}},updateGlobalField:async(e,t)=>{try{return(await Pe.put(`/global-fields/${e}`,t)).data}catch(r){throw r}},deleteGlobalField:async e=>{try{return(await Pe.delete(`/global-fields/${e}`)).data}catch(t){throw t}}},sl={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},_a=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return sl[e]||e;if(e&&typeof e=="object"){const{message:r,errors:s}=e;let n=r;if(Array.isArray(r))if(r.length>0){const o=r[0];typeof o=="object"&&o!==null?n=o.message||o.field||"Validation failed":n=o}else n="Validation failed";const i=sl[n]||n;if(s&&Array.isArray(s)&&s.length>0){const o=s.map(l=>{if(typeof l=="string"){const c=l.match(/(\w+)\s+(.+)/);if(c){const[,u,d]=c;return sl[n]?.fields?.[u]||d}return l}else if(typeof l=="object"&&l!==null)return l.field&&l.message?sl[n]?.fields?.[l.field]||l.message:l.property&&l.constraints?sl[n]?.fields?.[l.property]||Object.values(l.constraints)[0]||l.property:JSON.stringify(l);return String(l)});return`${i}

Details:
${o.join(`
`)}`}return i}return e?.response?.data?_a(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},sS=v.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),iO=({children:e})=>{const[t,r]=v.useState(null),[s,n]=v.useState(null),[i,o]=v.useState([]),[l,c]=v.useState(!1),[u,d]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const b=localStorage.getItem("authToken"),y=localStorage.getItem("user"),j=localStorage.getItem("refreshToken");if(b&&y&&j)try{const S=JSON.parse(atob(b.split(".")[1])),E=Date.now()/1e3;if(S.exp<E)try{const w=await kn.refreshToken(j);localStorage.setItem("authToken",w.access_token),localStorage.setItem("refreshToken",w.refresh_token);const N=JSON.parse(y);r(N),c(!0);try{const{role:C,permissions:T}=await m(N.role,N.roleId);if(C&&T)n(C),o(T);else throw new Error("Failed to fetch role and permissions")}catch(C){console.error("Failed to fetch role and permissions on initialization:",C),kn.logout(),r(null),n(null),o([]),c(!1)}}catch{kn.logout(),r(null),n(null),o([]),c(!1)}else{const w=JSON.parse(y);r(w),c(!0);try{const{role:N,permissions:C}=await m(w.role,w.roleId);if(N&&C)n(N),o(C);else throw new Error("Failed to fetch role and permissions")}catch(N){console.error("Failed to fetch role and permissions on initialization:",N),kn.logout(),r(null),n(null),o([]),c(!1)}}}catch(S){console.error(" Error parsing token or user data:",S),kn.logout(),r(null),n(null),o([]),c(!1)}else r(null),n(null),o([]),c(!1)}catch(b){console.error("Error accessing localStorage:",b),r(null),n(null),o([]),c(!1)}finally{d(!1)}})()},[]),v.useEffect(()=>{if(!l||u)return;const g=async()=>{const y=localStorage.getItem("authToken"),j=localStorage.getItem("refreshToken");if(!y||!j){x();return}try{const S=JSON.parse(atob(y.split(".")[1])),E=Date.now()/1e3;S.exp-E<300&&((await h()).success||(console.error(" Token refresh failed in validation"),x()))}catch(S){console.error(" Token validation failed:",S);try{(await h()).success||(console.error(" Token refresh failed after validation error"),x())}catch(E){console.error(" Token refresh failed:",E),x()}}},b=setTimeout(()=>{g();const y=setInterval(g,120*1e3);return()=>clearInterval(y)},500);return()=>clearTimeout(b)},[l,u]);const m=async(g,b)=>{try{if(b)try{const y=await Cs.getRoleById(b);console.log(" Role data fetched:",{hasId:!!y?.id,hasName:!!y?.name,hasPermissions:!!y?.permissions,permissionsCount:y?.permissions?.length||0});const j=Array.isArray(y?.permissions)?y.permissions:[];return n(y),o(j),{role:y,permissions:j}}catch(y){if(console.error("Error fetching role by ID:",y),y.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{const S=await Pe.get("/users/me");if(S.data&&S.data.role&&S.data.role.permissions){const E={id:b,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:S.data.role.permissions};return n(E),o(E.permissions),{role:E,permissions:E.permissions}}}catch(S){console.error("Failed to get user profile:",S)}console.warn("Cannot fetch permissions, creating minimal role");const j={id:b,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return n(j),o([]),{role:j,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const y=await Cs.getRoles(),j=y.data||y;let S;if(j&&j.roles&&Array.isArray(j.roles))S=j.roles;else if(Array.isArray(j))S=j;else throw new Error("Invalid roles data structure");const E=S.find(w=>w.name===g);if(E){const w=await Cs.getRoleById(E.id);return n(w),o(w.permissions||[]),{role:w,permissions:w.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(y){throw console.error("Fallback method failed:",y),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(y){return console.error("Error fetching user role and permissions:",y),{role:null,permissions:[]}}},f=async g=>{try{d(!0);const b=await kn.login(g);localStorage.setItem("authToken",b.access_token),localStorage.setItem("refreshToken",b.refresh_token);let y;try{const E=JSON.parse(atob(b.access_token.split(".")[1]));if(!E.userId||!E.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");y={id:E.userId,email:g.email,fullName:E.fullName||E.name||"User",role:E.roleName,roleId:E.roleId,department:E.department||"IT",lastLogin:new Date().toISOString()},g.email==="depthead@test.com"&&(y.role="DEPARTMENT_HEAD",y.roleId="dept-head-001")}catch(E){throw console.error("Error decoding token:",E),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(y));const{role:j,permissions:S}=await m(y.role,y.roleId);if(!j||!S)throw new Error("Failed to fetch user role and permissions");return r(y),n(j),o(S),c(!0),{success:!0,user:y,role:j,permissions:S}}catch(b){return{success:!1,error:_a(b)||"Login failed"}}finally{d(!1)}},h=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const b=await kn.refreshToken(g);return localStorage.setItem("authToken",b.access_token),localStorage.setItem("refreshToken",b.refresh_token),{success:!0,tokens:b}}catch(g){return console.error("Manual token refresh failed:",g),x(),{success:!1,error:g.message}}},x=()=>{kn.logout(),r(null),n(null),o([]),c(!1)},p={user:t,setUser:r,userRole:s,userPermissions:i,isAuthenticated:l,setIsAuthenticated:c,isLoading:u,login:f,logout:x,refreshToken:h,fetchUserRoleAndPermissions:m};try{return a.jsx(sS.Provider,{value:p,children:e})}catch(g){return console.error(" AuthProvider error:",g),a.jsxs("div",{style:{padding:"20px",color:"red"},children:[a.jsx("h3",{children:"Authentication Error"}),a.jsx("p",{children:"There was an error initializing the authentication system."}),a.jsxs("details",{children:[a.jsx("summary",{children:"Error Details"}),a.jsx("pre",{children:g.message})]})]})}},fs=()=>{const e=v.useContext(sS);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},oO={getPermissions:async(e={})=>{try{return(await Pe.get("/permissions",{params:e})).data}catch(t){throw t.response?.data||t.message}},getPermissionById:async e=>{try{return(await Pe.get(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},createPermission:async e=>{try{return(await Pe.post("/permissions",e)).data}catch(t){throw t.response?.data||t.message}},updatePermission:async(e,t)=>{try{return(await Pe.put(`/permissions/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deletePermission:async e=>{try{return(await Pe.delete(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},enablePermission:async e=>{try{return(await Pe.patch(`/permissions/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}}},M1=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],s=t[1],i=s.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",l={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return s.includes("forgot-password")?"Forgot Password":s.includes("reset-password")?"Reset Password":s.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("add-trainers")?"Add Trainers to Department":s.includes("remove-trainers")?"Remove Trainers from Department":s.includes("new-feature")?"Create New Feature":s.includes("bulk-import")?"Bulk Import Data":s.includes("export-report")?"Export Report":lO(l,i,s)}return e},lO=(e,t,r)=>{if(r.includes("-")){const s=r.split("/").filter(o=>o&&!o.startsWith(":")),i=s[s.length-1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},xc=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(!1),[n,i]=v.useState(null),{userPermissions:o,userRole:l}=fs(),c=v.useCallback(async()=>{s(!0),i(null);try{o&&o.length>0?t(o):(t([]),console.log(" No userPermissions available"))}catch(w){console.error("Error setting permissions:",w),i(w),t([])}finally{s(!1)}},[o]),u=v.useCallback(()=>e.map(w=>({id:w.id,title:w.viewName||w.description||M1(w.name),description:w.description||"",module:w.module,method:w.method,path:w.path,isActive:w.isActive,viewName:w.viewName,viewModule:w.viewModule})),[e]),d=v.useCallback(()=>{const w=u(),N={};return w.forEach(C=>{const T=C.module,_=C.viewModule||`${C.module} Management`;N[T]||(N[T]={id:T,name:_,description:`Manage ${_.toLowerCase()} related permissions`,permissions:[]}),N[T].permissions.push({id:C.id,title:C.title,description:C.description,isActive:C.isActive,method:C.method,path:C.path})}),Object.values(N).sort((C,T)=>C.name.localeCompare(T.name))},[u]),m=v.useCallback(w=>{const N=e.find(C=>C.id===w);return N?N.isActive==="ACTIVE":!0},[e]),f=v.useCallback(w=>e.find(N=>N.id===w),[e]),h=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(w=>w.name)),[o]),x=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(w=>w.path)),[o]),p=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(w=>w.id)),[o]),g=v.useCallback(w=>{if(!o||o.length===0)return!1;const C=(D=>{if(!D||typeof D!="string")return{method:null,path:""};const M=D.trim().split(/\s+/);if(M.length>=2){const q=M[0],Z=M.slice(1).join(" ");return{method:q,path:Z}}return{method:null,path:D}})(w),T=h.has(w),_=x.has(w),k=p.has(w);if(T||_||k||C.method&&C.path&&o.some(M=>{const q=M.method&&M.method.toUpperCase()===C.method.toUpperCase();let Z=!1;if(M.path)if(M.path===C.path)Z=!0;else{const Q=U=>U.replace(/:\w+/g,":param");(Q(M.path)===Q(C.path)||M.name&&M.name.includes(C.path.replace("/","")))&&(Z=!0)}return q&&Z}))return!0;const I=w.toLowerCase().replace(/\s+/g," ");return o.some(D=>{if(!D.name)return!1;const M=D.name.toLowerCase(),q=I.split(/[\s/:]+/).filter(Z=>Z.length>2&&!["get","post","put","patch","delete"].includes(Z));return q.length>0?q.some(Z=>M.includes(Z)):!1})},[o,h,x,p]),b=v.useCallback(w=>{if(!o||o.length===0)return!1;const N=w.filter(C=>C&&typeof C=="string");return N.length===0?!1:N.some(C=>g(C))},[o,g]),y=v.useCallback(w=>{if(!o||o.length===0)return!1;const N=w.filter(C=>C&&typeof C=="string");return N.length===0?!1:N.every(C=>g(C))},[o,g]),j=v.useCallback(w=>!o||o.length===0?!1:o.some(N=>N.module===w),[o]),S=v.useCallback(()=>!o||o.length===0?[]:[...new Set(o.map(N=>N.module))],[o]),E=v.useCallback(()=>{if(!o||o.length===0)return[];const w=o.map(C=>({id:C.id,title:C.viewName||C.description||M1(C.name),description:C.description||"",module:C.module,method:C.method,path:C.path,isActive:C.isActive,viewName:C.viewName,viewModule:C.viewModule})),N={};return w.forEach(C=>{const T=C.module,_=C.viewModule||`${C.module} Management`;N[T]||(N[T]={id:T,name:_,description:`Manage ${_.toLowerCase()} related permissions`,permissions:[]}),N[T].permissions.push({id:C.id,title:C.title,description:C.description,isActive:C.isActive,method:C.method,path:C.path})}),Object.values(N).sort((C,T)=>C.name.localeCompare(T.name))},[o]);return v.useEffect(()=>{c()},[c]),{permissions:e,loading:r,error:n,fetchPermissions:c,getUIPermissions:u,getPermissionGroups:d,isPermissionActive:m,getApiPermission:f,hasPermission:g,hasAnyPermission:b,hasAllPermissions:y,hasModuleAccess:j,getAccessibleModules:S,getUserPermissionGroups:E,userPermissions:o,userRole:l}},cO=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(!1),[n,i]=v.useState(null),o=v.useCallback(async()=>{s(!0),i(null);try{const l=await oO.getPermissions({includeDeleted:!0});let c=null;if(l&&l.data&&l.data.modules&&Array.isArray(l.data.modules))c=l.data.modules;else if(Array.isArray(l))c=l;else if(l&&l.data&&Array.isArray(l.data))c=l.data;else if(l&&typeof l=="object"){const d=Object.keys(l).find(m=>Array.isArray(l[m]));d&&(c=l[d])}if(c&&Array.isArray(c)){const u=[];c.forEach(d=>{d.module&&d.module.listPermissions&&d.module.listPermissions.forEach(m=>{const f=m.id||m.permissionId;u.push({id:f,name:m.name,module:d.module.name,viewName:m.name,viewModule:d.module.name,isActive:!0})})}),t(u)}else t([])}catch(l){console.error("Error fetching all permissions from API:",l),i(l),t([])}finally{s(!1)}},[]);return{allPermissions:e,loading:r,error:n,fetchAllPermissions:o}},Te={USERS:{CREATE:"POST /users",VIEW_ALL:"GET /users",VIEW_DETAIL:"GET /users/:userId",UPDATE:"PUT /users/:userId",BULK_CREATE:"POST /users/bulk"},ROLES:{CREATE:"POST /roles",VIEW_ALL:"GET /roles"},DEPARTMENTS:{CREATE:"POST /departments",VIEW_ALL:"GET /departments",VIEW_DETAIL:"GET /departments/:departmentId",UPDATE:"PUT /departments/:departmentId"},COURSES:{CREATE:"POST /courses",VIEW_ALL:"GET /courses",VIEW_DETAIL:"GET /courses/:id",UPDATE:"PUT /courses/:id",RESTORE:"POST /courses/:id/restore",ARCHIVE:"PATCH /courses/:courseId/archive"},SUBJECTS:{VIEW_DETAIL:"GET /subjects/:id",UPDATE:"PUT /subjects/:id",DELETE:"DELETE /subjects/:id",ARCHIVE:"PATCH /subjects/:subjectId/archive",REMOVE_INSTRUCTOR:"DELETE /subjects/:id/instructors"},ASSESSMENTS:{VIEW_ALL:"GET /assessments",VIEW_RESULTS:"GET /assessments/results",APPROVE:"POST /assessments/:assessmentId/approve"},TEMPLATES:{CREATE:"POST /templates",VIEW_ALL:"GET /templates"},PROFILES:{VIEW:"GET /profile"},GLOBAL_FIELDS:{CREATE:"POST /global-fields",VIEW_ALL:"GET /global-fields",UPDATE:"PUT /global-fields/:fieldId"},TRAINEES:{VIEW_ALL:"GET /trainees",VIEW_DETAIL:"GET /trainees/:id",VIEW_COURSES:"GET /trainees/:id/courses",VIEW_SUBJECTS:"GET /trainees/:id/subjects",VIEW_ASSESSMENTS:"GET /trainees/:id/assessments"},SQA:{VIEW_TEMPLATES:"GET /templates",VIEW_TEMPLATE_DETAIL:"GET /templates/:id",VIEW_GLOBAL_FIELD_DETAIL:"GET /global-fields/detail"}};function aS(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=aS(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Pt(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=aS(e))&&(s&&(s+=" "),s+=t);return s}function dO(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}dO(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var gc=e=>typeof e=="number"&&!isNaN(e),Ai=e=>typeof e=="string",hn=e=>typeof e=="function",uO=e=>Ai(e)||gc(e),cp=e=>Ai(e)||hn(e)?e:null,mO=(e,t)=>e===!1||gc(e)&&e>0?e:t,dp=e=>v.isValidElement(e)||Ai(e)||hn(e)||gc(e);function fO(e,t,r=300){let{scrollHeight:s,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=s+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}function hO({enter:e,exit:t,appendPosition:r=!1,collapse:s=!0,collapseDuration:n=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:u,isIn:d,playToast:m}){let f=r?`${e}--${o}`:e,h=r?`${t}--${o}`:t,x=v.useRef(0);return v.useLayoutEffect(()=>{let p=u.current,g=f.split(" "),b=y=>{y.target===u.current&&(m(),p.removeEventListener("animationend",b),p.removeEventListener("animationcancel",b),x.current===0&&y.type!=="animationcancel"&&p.classList.remove(...g))};p.classList.add(...g),p.addEventListener("animationend",b),p.addEventListener("animationcancel",b)},[]),v.useEffect(()=>{let p=u.current,g=()=>{p.removeEventListener("animationend",g),s?fO(p,c,n):c()};d||(l?g():(x.current=1,p.className+=` ${h}`,p.addEventListener("animationend",g)))},[d]),J.createElement(J.Fragment,null,i)}}function B1(e,t){return{content:nS(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function nS(e,t,r=!1){return v.isValidElement(e)&&!Ai(e.type)?v.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):hn(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function pO({closeToast:e,theme:t,ariaLabel:r="close"}){return J.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:s=>{s.stopPropagation(),e(!0)},"aria-label":r},J.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},J.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function xO({delay:e,isRunning:t,closeToast:r,type:s="default",hide:n,className:i,controlledProgress:o,progress:l,rtl:c,isIn:u,theme:d}){let m=n||o&&l===0,f={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(f.transform=`scaleX(${l})`);let h=Pt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),x=hn(i)?i({rtl:c,type:s,defaultClassName:h}):Pt(h,i),p={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{u&&r()}};return J.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},J.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${s}`}),J.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:x,style:f,...p}))}var gO=1,iS=()=>`${gO++}`;function vO(e,t,r){let s=1,n=0,i=[],o=[],l=t,c=new Map,u=new Set,d=y=>(u.add(y),()=>u.delete(y)),m=()=>{o=Array.from(c.values()),u.forEach(y=>y())},f=({containerId:y,toastId:j,updateId:S})=>{let E=y?y!==e:e!==1,w=c.has(j)&&S==null;return E||w},h=(y,j)=>{c.forEach(S=>{var E;(j==null||j===S.props.toastId)&&((E=S.toggle)==null||E.call(S,y))})},x=y=>{var j,S;(S=(j=y.props)==null?void 0:j.onClose)==null||S.call(j,y.removalReason),y.isActive=!1},p=y=>{if(y==null)c.forEach(x);else{let j=c.get(y);j&&x(j)}m()},g=()=>{n-=i.length,i=[]},b=y=>{var j,S;let{toastId:E,updateId:w}=y.props,N=w==null;y.staleId&&c.delete(y.staleId),y.isActive=!0,c.set(E,y),m(),r(B1(y,N?"added":"updated")),N&&((S=(j=y.props).onOpen)==null||S.call(j))};return{id:e,props:l,observe:d,toggle:h,removeToast:p,toasts:c,clearQueue:g,buildToast:(y,j)=>{if(f(j))return;let{toastId:S,updateId:E,data:w,staleId:N,delay:C}=j,T=E==null;T&&n++;let _={...l,style:l.toastStyle,key:s++,...Object.fromEntries(Object.entries(j).filter(([I,L])=>L!=null)),toastId:S,updateId:E,data:w,isIn:!1,className:cp(j.className||l.toastClassName),progressClassName:cp(j.progressClassName||l.progressClassName),autoClose:j.isLoading?!1:mO(j.autoClose,l.autoClose),closeToast(I){c.get(S).removalReason=I,p(S)},deleteToast(){let I=c.get(S);if(I!=null){if(r(B1(I,"removed")),c.delete(S),n--,n<0&&(n=0),i.length>0){b(i.shift());return}m()}}};_.closeButton=l.closeButton,j.closeButton===!1||dp(j.closeButton)?_.closeButton=j.closeButton:j.closeButton===!0&&(_.closeButton=dp(l.closeButton)?l.closeButton:!0);let k={content:y,props:_,staleId:N};l.limit&&l.limit>0&&n>l.limit&&T?i.push(k):gc(C)?setTimeout(()=>{b(k)},C):b(k)},setProps(y){l=y},setToggle:(y,j)=>{let S=c.get(y);S&&(S.toggle=j)},isToastActive:y=>{var j;return(j=c.get(y))==null?void 0:j.isActive},getSnapshot:()=>o}}var Is=new Map,Ll=[],up=new Set,bO=e=>up.forEach(t=>t(e)),oS=()=>Is.size>0;function yO(){Ll.forEach(e=>cS(e.content,e.options)),Ll=[]}var jO=(e,{containerId:t})=>{var r;return(r=Is.get(t||1))==null?void 0:r.toasts.get(e)};function lS(e,t){var r;if(t)return!!((r=Is.get(t))!=null&&r.isToastActive(e));let s=!1;return Is.forEach(n=>{n.isToastActive(e)&&(s=!0)}),s}function wO(e){if(!oS()){Ll=Ll.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||uO(e))Is.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Is.get(e.containerId);t?t.removeToast(e.id):Is.forEach(r=>{r.removeToast(e.id)})}}var NO=(e={})=>{Is.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function cS(e,t){dp(e)&&(oS()||Ll.push({content:e,options:t}),Is.forEach(r=>{r.buildToast(e,t)}))}function SO(e){var t;(t=Is.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function dS(e,t){Is.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function EO(e){let t=e.containerId||1;return{subscribe(r){let s=vO(t,e,bO);Is.set(t,s);let n=s.observe(r);return yO(),()=>{n(),Is.delete(t)}},setProps(r){var s;(s=Is.get(t))==null||s.setProps(r)},getSnapshot(){var r;return(r=Is.get(t))==null?void 0:r.getSnapshot()}}}function TO(e){return up.add(e),()=>{up.delete(e)}}function CO(e){return e&&(Ai(e.toastId)||gc(e.toastId))?e.toastId:iS()}function vc(e,t){return cS(e,t),t.toastId}function zu(e,t){return{...t,type:t&&t.type||e,toastId:CO(t)}}function $u(e){return(t,r)=>vc(t,zu(e,r))}function ne(e,t){return vc(e,zu("default",t))}ne.loading=(e,t)=>vc(e,zu("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function AO(e,{pending:t,error:r,success:s},n){let i;t&&(i=Ai(t)?ne.loading(t,n):ne.loading(t.render,{...n,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,m)=>{if(d==null){ne.dismiss(i);return}let f={type:u,...o,...n,data:m},h=Ai(d)?{render:d}:d;return i?ne.update(i,{...f,...h}):ne(h.render,{...f,...h}),m},c=hn(e)?e():e;return c.then(u=>l("success",s,u)).catch(u=>l("error",r,u)),c}ne.promise=AO;ne.success=$u("success");ne.info=$u("info");ne.error=$u("error");ne.warning=$u("warning");ne.warn=ne.warning;ne.dark=(e,t)=>vc(e,zu("default",{theme:"dark",...t}));function kO(e){wO(e)}ne.dismiss=kO;ne.clearWaitingQueue=NO;ne.isActive=lS;ne.update=(e,t={})=>{let r=jO(e,t);if(r){let{props:s,content:n}=r,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:iS()};i.toastId!==e&&(i.staleId=e);let o=i.render||n;delete i.render,vc(o,i)}};ne.done=e=>{ne.update(e,{progress:1})};ne.onChange=TO;ne.play=e=>dS(!0,e);ne.pause=e=>dS(!1,e);function _O(e){var t;let{subscribe:r,getSnapshot:s,setProps:n}=v.useRef(EO(e)).current;n(e);let i=(t=v.useSyncExternalStore(r,s,s))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>l(u[0],u[1]))}return{getToastToRender:o,isToastActive:lS,count:i?.length}}function IO(e){let[t,r]=v.useState(!1),[s,n]=v.useState(!1),i=v.useRef(null),o=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:m}=e;SO({id:e.toastId,containerId:e.containerId,fn:r}),v.useEffect(()=>{if(e.pauseOnFocusLoss)return f(),()=>{h()}},[e.pauseOnFocusLoss]);function f(){document.hasFocus()||b(),window.addEventListener("focus",g),window.addEventListener("blur",b)}function h(){window.removeEventListener("focus",g),window.removeEventListener("blur",b)}function x(N){if(e.draggable===!0||e.draggable===N.pointerType){y();let C=i.current;o.canCloseOnClick=!0,o.canDrag=!0,C.style.transition="none",e.draggableDirection==="x"?(o.start=N.clientX,o.removalDistance=C.offsetWidth*(e.draggablePercent/100)):(o.start=N.clientY,o.removalDistance=C.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function p(N){let{top:C,bottom:T,left:_,right:k}=i.current.getBoundingClientRect();N.nativeEvent.type!=="touchend"&&e.pauseOnHover&&N.clientX>=_&&N.clientX<=k&&N.clientY>=C&&N.clientY<=T?b():g()}function g(){r(!0)}function b(){r(!1)}function y(){o.didMove=!1,document.addEventListener("pointermove",S),document.addEventListener("pointerup",E)}function j(){document.removeEventListener("pointermove",S),document.removeEventListener("pointerup",E)}function S(N){let C=i.current;if(o.canDrag&&C){o.didMove=!0,t&&b(),e.draggableDirection==="x"?o.delta=N.clientX-o.start:o.delta=N.clientY-o.start,o.start!==N.clientX&&(o.canCloseOnClick=!1);let T=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;C.style.transform=`translate3d(${T},0)`,C.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function E(){j();let N=i.current;if(o.canDrag&&o.didMove&&N){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}N.style.transition="transform 0.2s, opacity 0.2s",N.style.removeProperty("transform"),N.style.removeProperty("opacity")}}let w={onPointerDown:x,onPointerUp:p};return l&&c&&(w.onMouseEnter=b,e.stacked||(w.onMouseLeave=g)),m&&(w.onClick=N=>{d&&d(N),o.canCloseOnClick&&u(!0)}),{playToast:g,pauseToast:b,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:w}}var PO=typeof window<"u"?v.useLayoutEffect:v.useEffect,Uu=({theme:e,type:t,isLoading:r,...s})=>J.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s});function DO(e){return J.createElement(Uu,{...e},J.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function OO(e){return J.createElement(Uu,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function RO(e){return J.createElement(Uu,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function FO(e){return J.createElement(Uu,{...e},J.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function LO(){return J.createElement("div",{className:"Toastify__spinner"})}var mp={info:OO,warning:DO,success:RO,error:FO,spinner:LO},MO=e=>e in mp;function BO({theme:e,type:t,isLoading:r,icon:s}){let n=null,i={theme:e,type:t};return s===!1||(hn(s)?n=s({...i,isLoading:r}):v.isValidElement(s)?n=v.cloneElement(s,i):r?n=mp.spinner():MO(t)&&(n=mp[t](i))),n}var zO=e=>{let{isRunning:t,preventExitTransition:r,toastRef:s,eventHandlers:n,playToast:i}=IO(e),{closeButton:o,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:m,closeToast:f,transition:h,position:x,className:p,style:g,progressClassName:b,updateId:y,role:j,progress:S,rtl:E,toastId:w,deleteToast:N,isIn:C,isLoading:T,closeOnClick:_,theme:k,ariaLabel:I}=e,L=Pt("Toastify__toast",`Toastify__toast-theme--${k}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":_}),D=hn(p)?p({rtl:E,position:x,type:d,defaultClassName:L}):Pt(L,p),M=BO(e),q=!!S||!c,Z={closeToast:f,type:d,theme:k},Q=null;return o===!1||(hn(o)?Q=o(Z):v.isValidElement(o)?Q=v.cloneElement(o,Z):Q=pO(Z)),J.createElement(h,{isIn:C,done:N,position:x,preventExitTransition:r,nodeRef:s,playToast:i},J.createElement("div",{id:w,tabIndex:0,onClick:u,"data-in":C,className:D,...n,style:g,ref:s,...C&&{role:j,"aria-label":I}},M!=null&&J.createElement("div",{className:Pt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!T})},M),nS(l,e,!t),Q,!e.customProgressBar&&J.createElement(xO,{...y&&!q?{key:`p-${y}`}:{},rtl:E,theme:k,delay:c,isRunning:t,isIn:C,closeToast:f,hide:m,type:d,className:b,controlledProgress:q,progress:S||0})))},$O=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),UO=hO($O("bounce",!0)),WO={position:"top-right",transition:UO,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function HO(e){let t={...WO,...e},r=e.stacked,[s,n]=v.useState(!0),i=v.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=_O(t),{className:u,style:d,rtl:m,containerId:f,hotKeys:h}=t;function x(g){let b=Pt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return hn(u)?u({position:g,rtl:m,defaultClassName:b}):Pt(b,cp(u))}function p(){r&&(n(!0),ne.play())}return PO(()=>{var g;if(r){let b=i.current.querySelectorAll('[data-in="true"]'),y=12,j=(g=t.position)==null?void 0:g.includes("top"),S=0,E=0;Array.from(b).reverse().forEach((w,N)=>{let C=w;C.classList.add("Toastify__toast--stacked"),N>0&&(C.dataset.collapsed=`${s}`),C.dataset.pos||(C.dataset.pos=j?"top":"bot");let T=S*(s?.2:1)+(s?0:y*N);C.style.setProperty("--y",`${j?T:T*-1}px`),C.style.setProperty("--g",`${y}`),C.style.setProperty("--s",`${1-(s?E:0)}`),S+=C.offsetHeight,E+=.025})}},[s,c,r]),v.useEffect(()=>{function g(b){var y;let j=i.current;h(b)&&((y=j.querySelector('[tabIndex="0"]'))==null||y.focus(),n(!1),ne.pause()),b.key==="Escape"&&(document.activeElement===j||j!=null&&j.contains(document.activeElement))&&(n(!0),ne.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[h]),J.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(n(!1),ne.pause())},onMouseLeave:p,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((g,b)=>{let y=b.length?{...d}:{...d,pointerEvents:"none"};return J.createElement("div",{tabIndex:-1,className:x(g),"data-stacked":r,style:y,key:`c-${g}`},b.map(({content:j,props:S})=>J.createElement(zO,{...S,stacked:r,collapseAll:p,isIn:l(S.toastId,S.containerId),key:`t-${S.key}`},j)))}))}const $a=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role}:null,status:t.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),_x=(e=!0)=>{const[t,r]=v.useState([]),[s,n]=v.useState([]),[i,o]=v.useState(!1),[l,c]=v.useState(null),[u,d]=v.useState(""),[m,f]=v.useState({type:"",status:""}),[h,x]=v.useState({key:null,direction:"asc"}),[p,g]=v.useState([]);return v.useEffect(()=>{if(!e)return;(async()=>{o(!0),c(null);try{const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U)}catch(Z){console.error("Error loading departments:",Z),c("Failed to load departments"),r([])}finally{o(!1)}})()},[e]),v.useEffect(()=>{let q=t;u&&(q=q.filter(Z=>Z.name.toLowerCase().includes(u.toLowerCase())||Z.code.toLowerCase().includes(u.toLowerCase())||Z.description.toLowerCase().includes(u.toLowerCase()))),m.type&&(q=q.filter(Z=>Z.type===m.type)),m.status&&(q=q.filter(Z=>Z.status===m.status)),n(q)},[t,u,m]),{departments:s,selectedDepartments:p,loading:i,error:l,searchTerm:u,setSearchTerm:d,filters:m,sortConfig:h,createDepartment:async q=>{o(!0),c(null);try{const Z=await kt.createDepartment(q),U=(await kt.getDepartments()).departments||[],le=$a(U);return r(le),Z}catch(Z){throw console.error("Error creating department:",Z),c("Failed to create department"),Z}finally{o(!1)}},updateDepartment:async(q,Z)=>{o(!0),c(null);try{const Q=await kt.updateDepartment(q,Z),le=(await kt.getDepartments()).departments||[],Se=$a(le);return r(Se),Q}catch(Q){throw console.error("Error updating department:",Q),c("Failed to update department"),Q}finally{o(!1)}},deleteDepartment:async q=>{o(!0),c(null);try{await kt.deleteDepartment(q);const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U)}catch(Z){throw console.error("Error deleting department:",Z),c("Failed to delete department"),Z}finally{o(!1)}},toggleDepartmentStatus:async q=>{o(!0),c(null);try{await kt.toggleDepartmentStatus(q);const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U)}catch(Z){throw console.error("Error toggling department status:",Z),ne.error("Failed to toggle department status"),Z}finally{o(!1)}},disableDepartment:async q=>{o(!0),c(null);try{await kt.disableDepartment(q);const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U)}catch(Z){throw console.error("Error disabling department:",Z),ne.error("Failed to disable department"),Z}finally{o(!1)}},enableDepartment:async q=>{o(!0),c(null);try{await kt.enableDepartment(q);const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U)}catch(Z){throw console.error("Error enabling department:",Z),ne.error("Failed to enable department"),Z}finally{o(!1)}},bulkDeleteDepartments:async q=>{o(!0),c(null);try{await kt.bulkDeleteDepartments(q);const Q=(await kt.getDepartments()).departments||[],U=$a(Q);r(U),g([])}catch(Z){throw console.error("Error bulk deleting departments:",Z),ne.error("Failed to delete departments"),Z}finally{o(!1)}},bulkToggleStatus:async(q,Z)=>{o(!0),c(null);try{await kt.bulkToggleStatus(q,Z);const U=(await kt.getDepartments()).departments||[],le=$a(U);r(le),g([])}catch(Q){throw console.error("Error bulk toggling department status:",Q),ne.error("Failed to update department status"),Q}finally{o(!1)}},sortDepartments:q=>{let Z="asc";h.key===q&&h.direction==="asc"&&(Z="desc"),x({key:q,direction:Z});const Q=[...s].sort((U,le)=>U[q]<le[q]?Z==="asc"?-1:1:U[q]>le[q]?Z==="asc"?1:-1:0);n(Q)},handleSelectDepartment:q=>{g(Z=>Z.includes(q)?Z.filter(Q=>Q!==q):[...Z,q])},handleSelectAll:()=>{p.length===s.length?g([]):g(s.map(q=>q.id))},handleFilterChange:(q,Z)=>{f(Q=>({...Q,[q]:Z}))},clearFilters:()=>{f({type:"",status:""}),d("")},getAvailableUsers:async()=>{try{return(await kt.getDepartmentHeads())?.users||[]}catch(q){return console.error("Error fetching department heads:",q),ne.error("Failed to load department heads"),[]}},refreshDepartments:async()=>{o(!0),c(null);try{const Z=(await kt.getDepartments()).departments||[],Q=$a(Z);r(Q)}catch(q){console.error("Error refreshing departments:",q),c("Failed to refresh departments")}finally{o(!1)}},setError:c}},z1=({collapsed:e,onClose:t})=>{const{hasModuleAccess:r,hasPermission:s}=xc(),{user:n}=fs(),i=Gn(),o=it(),c=(typeof n?.role=="string"?n.role:n?.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim(),u=c==="ACADEMIC_DEPARTMENT"||c==="ACADEMIC_DEPT"||c.startsWith("ACADEMIC"),{departments:d,loading:m}=_x(u),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,b]=v.useState(!1),y=v.useRef(null);v.useEffect(()=>{if(y.current&&f){const S=y.current,E=S.scrollHeight>S.clientHeight;b(E)}},[f,d]);const j=v.useMemo(()=>{const E=(typeof n?.role=="string"?n.role:n?.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return[{id:"main-menu",label:"Main Menu",icon:jx,path:"/admin/main-menu",permission:null,module:"ADMIN"},{id:"users",label:"User Management",icon:Lr,path:"/admin/users",permission:Te.USERS.VIEW_ALL,module:"USERS"},{id:"roles",label:"Role Management",icon:Ex,path:"/admin/roles",permission:Te.ROLES.VIEW_ALL,module:"ROLES"},{id:"departments",label:"Departments",icon:Bs,path:"/admin/departments",permission:Te.DEPARTMENTS.VIEW_ALL,module:"DEPARTMENTS"},{id:"forms",label:"Template List",icon:At,path:"/admin/forms",permission:Te.TEMPLATES.VIEW_ALL,module:"TEMPLATES"},{id:"system-config",label:"System Configuration",icon:v2,path:"/admin/system-config",permission:Te.GLOBAL_FIELDS.VIEW_ALL,module:"GLOBAL_FIELDS"},{id:"academic-dashboard",label:"Academic Dashboard",icon:b2,path:"/academic/dashboard",module:"ACADEMIC"},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:va,path:"/trainee/dashboard",permission:Te.TRAINEES.VIEW_DETAIL,module:"TRAINEES"},{id:"enrolled-courses",label:"Enrolled Course List",icon:va,path:"/trainee/enrolled-courses",permission:Te.TRAINEES.VIEW_COURSES,module:"TRAINEES"},{id:"all-assessments",label:"All Assessments",icon:va,path:"/trainee/all-assessments",permission:Te.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES",children:[{id:"your-assessments",label:"Your Assessments",path:"/trainee/your-assessments",permission:Te.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"signature-required",label:"Signature Required List",path:"/trainee/signature-required",permission:Te.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"completion-required",label:"Section Completion Required List",path:"/trainee/completion-required",permission:Te.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:va,path:"/trainee/create-incident-feedback-report",permission:Te.TRAINEES.VIEW_ALL,module:"TRAINEES"},{id:"upcoming-assessments",label:"List Upcoming Assessment",icon:ft,path:"/trainer/upcoming-assessments",permission:Te.ASSESSMENTS.VIEW_ALL,module:"TRAINER"},{id:"assessment-results",label:"List Assessment Result",icon:ht,path:"/trainer/assessment-results",permission:Te.ASSESSMENTS.VIEW_RESULTS,module:"TRAINER"},{id:"instructed-courses",label:"List Instructed Course",icon:It,path:"/trainer/instructed-courses",permission:Te.COURSES.VIEW_ALL,module:"TRAINER"},{id:"department-dashboard",label:"Department Dashboard",icon:Bs,path:"/department-head/dashboard",module:"DEPARTMENT_HEAD"},{id:"my-department-details",label:"My Department Details",icon:It,path:"/department-head/my-department-details",permission:Te.DEPARTMENTS.VIEW_DETAIL,module:"DEPARTMENT_HEAD"},{id:"assessment-review-requests",label:"List Assessment Review Requests",icon:Dt,path:"/department-head/assessment-review-requests",permission:Te.ASSESSMENTS.VIEW_ALL,module:"DEPARTMENT_HEAD"},{id:"issue-list",label:"Issue List",icon:fr,path:"/sqa/issues",permission:Te.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"feedback-list",label:"Feedback List",icon:c2,path:"/sqa/feedback",permission:Te.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"template-list",label:"Template List",icon:Ou,path:"/sqa/templates",permission:Te.SQA.VIEW_TEMPLATES,module:"SQA",children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:Te.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:Te.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:Te.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:Te.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"}]}].filter(N=>E==="ADMINISTRATOR"?["main-menu","users","roles","departments","forms","system-config"].includes(N.id)?N.id==="main-menu"?!0:r(N.module)||s(N.permission):!1:E==="ACADEMIC_DEPARTMENT"||E==="ACADEMIC_DEPT"||E.startsWith("ACADEMIC")?["academic-dashboard"].includes(N.id):E==="TRAINEE"?["trainee-dashboard","enrolled-courses","all-assessments","create-issue"].includes(N.id):E==="TRAINER"?["upcoming-assessments","assessment-results","instructed-courses"].includes(N.id):E==="SQA_AUDITOR"?["issue-list","feedback-list","template-list"].includes(N.id):E==="DEPARTMENT_HEAD"?["department-dashboard","my-department-details","assessment-review-requests"].includes(N.id):r(N.module)||s(N.permission))},[n,r,s]);return a.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"sticky",top:0,height:"100vh",overflowY:"hidden",overflowX:"hidden"},children:[a.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&a.jsx(a.Fragment,{children:a.jsx("img",{src:kP,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&a.jsx("div",{children:a.jsx(a2,{size:24})})]}),t&&a.jsx(ie,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:t,style:{border:"none",background:"transparent"},children:a.jsx(nt,{size:20})})]}),a.jsxs(vt,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[j.map(S=>{const E=S.icon,w=i.pathname===S.path;return S.id==="all-assessments"&&n?.role==="TRAINEE"?a.jsx(vt.Item,{className:"mb-3",children:a.jsxs("div",{className:"position-relative",children:[a.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(o("/trainee/all-assessments"),t()):p(!x)},children:[a.jsx(E,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:S.label}),a.jsx(Ka,{size:16,className:`ms-auto transition-transform ${x?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&x&&a.jsx("div",{className:"mt-2 ms-4",children:S.children&&S.children.map(N=>a.jsx(Vc,{to:N.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:i.pathname===N.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",overflowWrap:"break-word"},onClick:t,children:a.jsx("span",{className:"sidebar-nav-label",children:N.label})},N.id))})]})},S.id):a.jsx(vt.Item,{className:"mb-3",children:a.jsxs(Vc,{to:S.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${w?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:w?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t()},children:[a.jsx(E,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:S.label})]})},S.id)}),u&&a.jsx(vt.Item,{className:"mb-3",children:a.jsxs(Vc,{to:"/academic/assessment-events",className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname==="/academic/assessment-events"?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname==="/academic/assessment-events"?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t()},children:[a.jsx(Ra,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:"Assessment Event"})]})}),u&&a.jsx(vt.Item,{className:"mb-3",children:a.jsxs("div",{className:"position-relative",children:[a.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[a.jsx(Bs,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{h(!f),o("/academic/departments")},children:"Department"}),a.jsx(Ka,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:f?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{h(!f)}})]})]}),!e&&f&&a.jsx("div",{ref:y,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${g?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:m?a.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:a.jsx("small",{children:"Loading departments..."})}):d.length>0?d.map(S=>a.jsxs(Vc,{to:`/academic/course/${S.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${i.pathname===`/academic/course/${S.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:i.pathname===`/academic/course/${S.id}`?"rgba(255, 255, 255, 0.15)":"transparent",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[a.jsx(cc,{size:12,className:"me-2 sidebar-department-chevron"}),S.code]},S.id)):a.jsx("div",{className:"px-3 py-2 text-white-50",children:a.jsx("small",{children:"No departments found"})})})]})})]})]})},Mn={getProfile:async()=>{try{return(await Pe.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,t)=>{try{const s={...t||await Mn.getProfile(),avatarUrl:e};return s.address||(s.address=""),s.phoneNumber||(s.phoneNumber=""),s.avatarUrl||(s.avatarUrl=""),s.firstName||(s.firstName=""),s.lastName||(s.lastName=""),s.middleName||(s.middleName=""),Object.keys(s).forEach(i=>{(s[i]===void 0||s[i]===null)&&delete s[i]}),(await Pe.put("/profile",s)).data}catch(r){throw console.error("Error updating avatar:",r),r}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const t=await Pe.put("/profile",e);return console.log("updateProfile - response:",t.data),t.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Pe.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}}},VO=()=>{const[e,t]=v.useState(null),[r,s]=v.useState(!0),[n,i]=v.useState(null),o=async()=>{try{s(!0),i(null);const d=await Mn.getProfile();t(d)}catch(d){console.error("Error fetching profile:",d),i(d.message||"Failed to fetch profile")}finally{s(!1)}},l=async d=>{try{s(!0),i(null);const m=await Mn.updateProfile(d);return t(m),m}catch(m){throw console.error("Error updating profile:",m),i(m.message||"Failed to update profile"),m}finally{s(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:d,lastName:m,middleName:f}=e,h=[];return d&&h.push(d),f&&h.push(f),m&&h.push(m),h.join(" ")||"User"},u=()=>e?.role?e.role.name:"User";return v.useEffect(()=>{o()},[]),{profile:e,loading:r,error:n,fetchProfile:o,updateProfile:l,getDisplayName:c,getRoleName:u}},GO={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},qO=({onToggleSidebar:e})=>{const t=Gn(),r=it(),[s,n]=v.useState(!1),[i,o]=v.useState(!1),l=v.useRef(null),{user:c,isLoading:u}=fs(),{profile:d,getDisplayName:m,loading:f}=VO(),h=()=>{if(!c||f)return"Loading...";if(d&&m&&m()&&m()!=="Loading..."){const S=m();if(S&&S.trim()!=="")return S}if(d&&d.firstName){const S=[d.firstName];d.middleName&&S.push(d.middleName),d.lastName&&S.push(d.lastName);const E=S.join(" ").trim();if(E)return E}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const S=localStorage.getItem("authToken");if(S){const E=JSON.parse(atob(S.split(".")[1]));if(E.fullName&&E.fullName!=="User")return E.fullName;if(E.name&&E.name!=="User")return E.name;if(E.firstName&&E.lastName)return`${E.firstName} ${E.lastName}`}}catch(S){console.error("Error parsing JWT token for display name:",S)}return c.name||"User"},x=()=>c&&c.email||"No email",p=S=>{const E={"/profile":"Profile","/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/forms":"Template List","/admin/main-menu":"Main Menu","/admin/system-config":"Global Field List","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/assessment-events":"Assessment Event","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Create Incident/Feedback Report","/trainee/assessment-pending/section-completion":"Section Completion Required List","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessments","/trainer/assessment-results":"Assessment Results","/trainer/instructed-courses":"Instructed Courses","/trainer/courses":"Course Details","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue List","/sqa/issues":"Issue List","/sqa/feedback":"Feedback List","/sqa/templates":"Template List","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview","/department-head":"Department Dashboard","/department-head/dashboard":"Department Dashboard","/department-head/my-department-details":"My Department Details","/department-head/assessment-review-requests":"Assessment Review Requests"};return S.startsWith("/department-head/my-department-details/")&&S!=="/department-head/my-department-details"&&!S.includes("/subjects/")?"Course Details":S.startsWith("/admin/departments/")&&S!=="/admin/departments"?"Department Details":S.startsWith("/academic/departments/")&&S!=="/academic/departments"?"Department Management":S.includes("/enroll-trainees")?"Trainee Enrollments":S.startsWith("/academic/course/")&&!S.includes("/subject/")?"Department Details":S.startsWith("/academic/course-detail/")?"Course Details":S.includes("/subject/")?"Subject Details":S.includes("/enroll-trainees")?"Enroll Trainees":S.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Enrolled Course Details":S.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Enrolled Subject Details":S.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":S.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":S.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":S.startsWith("/admin/forms/editor")?"Template List":S.startsWith("/sqa/templates/")&&S!=="/sqa/templates"?"Template Detail":S.startsWith("/trainer/trainees/")?"Trainee Details":S.startsWith("/trainer/subjects/")?"Subject Details":S.startsWith("/trainer/courses/")?"Course Details":S.startsWith("/trainer/assessment-details/")?"Assessment Result Details":S.startsWith("/trainer/approval-notes/")?"Result Approval Note":S.includes("/department-head/courses/")&&S.includes("/subjects/")?"Subject Details":S.startsWith("/department-head/trainees/")||S.startsWith("/trainee/")&&S!=="/trainee"&&!S.startsWith("/trainee/dashboard")&&!S.startsWith("/trainee/academic-details")&&!S.startsWith("/trainee/enrolled-courses")&&!S.startsWith("/trainee/assessment-pending")&&!S.startsWith("/trainee/create-incident-feedback-report")&&!S.startsWith("/trainee/signature-required")&&!S.startsWith("/trainee/completion-required")&&!S.startsWith("/trainee/your-assessments")?"Trainee Details":E[S]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const S=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=S()},b=()=>{n(!s)},y=()=>{n(!1)},j=()=>{r("/profile"),n(!1)};return v.useEffect(()=>{const S=E=>{l.current&&!l.current.contains(E.target)&&o(!1)};return i&&document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[i]),a.jsxs(a.Fragment,{children:[a.jsx(g1,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:a.jsxs("div",{className:"container-fluid",children:[a.jsx(ie,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:a.jsx(jx,{size:20})}),a.jsx(g1.Brand,{className:"text-primary-custom fw-bold custom-title",children:p(t.pathname)}),a.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>o(!i),children:[a.jsx(oo,{size:32,className:"me-2"}),a.jsx("span",{children:u||f?"Loading...":h()})]}),a.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:GO,children:[a.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[a.jsx("div",{className:"fw-bold text-primary-custom",children:u||f?"Loading...":h()}),a.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:u?"Loading...":x()})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),j()},children:[a.jsx(oo,{className:"me-2",size:16}),"Profile"]}),a.jsx("div",{className:"dropdown-divider"}),a.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),g()},children:[a.jsx(Hh,{className:"me-2",size:16}),"Logout"]})]})]})}),a.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:b,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:a.jsx(oo,{size:32})})]})}),s&&a.jsx("div",{className:`profile-menu-overlay ${s?"show":""}`,onClick:y}),a.jsxs("div",{className:`profile-menu-slide ${s?"show":""}`,children:[a.jsxs("div",{className:"profile-menu-header",children:[a.jsx("button",{className:"profile-menu-close",onClick:y,"aria-label":"Close profile menu",children:a.jsx(nt,{size:20})}),a.jsx("div",{className:"profile-avatar",children:a.jsx(oo,{size:40})}),a.jsx("div",{className:"profile-name",children:u||f?"Loading...":h()}),a.jsx("div",{className:"profile-email",children:u?"Loading...":x()})]}),a.jsxs("ul",{className:"profile-menu-items",children:[a.jsx("li",{className:"profile-menu-item",children:a.jsxs("a",{href:"#",className:"profile-menu-link",onClick:S=>{S.preventDefault(),j()},children:[a.jsx(oo,{className:"icon"}),"Profile"]})}),a.jsx("li",{className:"profile-menu-item",children:a.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:S=>{S.preventDefault(),y(),g()},children:[a.jsx(Hh,{className:"icon"}),"Logout"]})})]})]})]})},KO=({children:e})=>{const[t,r]=v.useState(!1),[s,n]=v.useState(!1),[i,o]=v.useState(!1);v.useEffect(()=>{const u=()=>{n(window.innerWidth<=768)};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const l=()=>{s?o(!i):r(!t)},c=()=>{s&&o(!1)};return a.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[a.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:a.jsx(z1,{collapsed:t})}),s&&i&&a.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),a.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,children:a.jsx(z1,{collapsed:!1,onClose:c})}),a.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${s?"main-content-mobile":""}`,children:[a.jsx(qO,{onToggleSidebar:l}),a.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},si=()=>a.jsx(KO,{children:a.jsx(l5,{})}),Zt=(e,t=null,r="asc")=>{const[s,n]=v.useState({key:t,direction:r});return{sortedData:v.useMemo(()=>!s.key||!e?e:[...e].sort((u,d)=>{let m=u[s.key],f=d[s.key];if(s.key.includes(".")){const h=s.key.split(".");m=h.reduce((x,p)=>x?.[p],u),f=h.reduce((x,p)=>x?.[p],d)}if(s.key.includes("length")){const h=s.key.replace(".length","");m=u[h]?.length||0,f=d[h]?.length||0}return typeof m=="string"&&typeof f=="string"&&(m=m.toLowerCase(),f=f.toLowerCase()),m<f?s.direction==="asc"?-1:1:m>f?s.direction==="asc"?1:-1:0}),[e,s]),sortConfig:s,handleSort:u=>{let d="asc";if(s.key===u&&s.direction==="asc")d="desc";else if(s.key===u&&s.direction==="desc"){n({key:null,direction:"asc"});return}n({key:u,direction:d})},getSortIcon:u=>s.key!==u?"":s.direction==="asc"?"":"",getSortClass:u=>s.key!==u?"text-muted":(s.direction==="asc","text-primary")}},No=({data:e,loading:t,columns:r,renderRow:s,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Rt,{rows:5,columns:r.length});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:n}),a.jsx("p",{children:i})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=l.key===d,x=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:x,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsx("tr",{children:r.map((d,m)=>d.sortable?a.jsx(u,{columnKey:d.key,className:d.className||"",children:d.title},m):a.jsx("th",{className:`fw-semibold ${d.className||""}`,style:{textTransform:"uppercase",letterSpacing:"0.5px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:d.title},m))})}),a.jsx("tbody",{children:o.map((d,m)=>s(d,m))})]})})},YO=({children:e})=>a.jsx(iO,{children:e}),Aa=()=>{const e=c5(),t=it(),s=(o=>o?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:o?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:o?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return a.jsx(_e,{fluid:!0,className:"py-5",children:a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:a.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"display-1 text-muted",children:""}),a.jsx("h2",{className:"text-primary-custom mb-3",children:s.title}),a.jsx("p",{className:"text-muted mb-4",children:s.message}),a.jsx("p",{className:"small text-muted",children:s.suggestion})]}),a.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[a.jsx(ie,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),a.jsx(ie,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},Rt=({rows:e=5,columns:t=4})=>{const r=()=>a.jsx("tr",{children:Array.from({length:t}).map((s,n)=>a.jsx("td",{children:a.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:a.jsx("span",{className:"placeholder col-12"})})},n))});return a.jsxs(W,{className:"border-neutral-200",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})}),a.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"bg-neutral-50",children:a.jsx("tr",{children:Array.from({length:t}).map((s,n)=>a.jsx("th",{className:"border-neutral-200",children:a.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})})},n))})}),a.jsx("tbody",{children:Array.from({length:e}).map((s,n)=>a.jsx(r,{},n))})]})})})]})},bt=({permission:e,permissions:t=[],requireAll:r=!1,children:s,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:o,hasAllPermissions:l}=xc(),{user:c}=fs();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?l(t):o(t):!1)?s:a.jsxs("div",{className:"p-4 text-center text-muted",children:[a.jsx("h4",{children:"Access Denied"}),a.jsx("p",{children:"You don't have permission to access this page."}),a.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),a.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},hr=({permission:e,permissions:t=[],requireAll:r=!1,children:s,fallback:n=null,showMessage:i=!1,message:o="You do not have permission to access this feature."})=>{const{hasPermission:l,hasAnyPermission:c,hasAllPermissions:u}=xc();return(()=>{if(!e&&(!t||t.length===0))return!0;if(e)return l(e);if(t&&t.length>0){const m=t.filter(f=>f&&typeof f=="string");return m.length===0?!0:r?u(m):c(m)}return!1})()?s:n||(i?a.jsxs(Re,{variant:"warning",className:"mt-3",children:[a.jsx(Re.Heading,{children:"Access Denied"}),a.jsx("p",{children:o})]}):null)},Ht=({trigger:e,items:t=[],align:r="end",className:s="",onItemClick:n,placement:i="bottom-end",disabled:o=!1,...l})=>{const[c,u]=v.useState(!1),[d,m]=v.useState({top:0,left:0}),f=v.useRef(null),h=v.useRef(null),x=()=>{if(!f.current)return;const j=f.current.getBoundingClientRect(),S=200,E=150,w=4;let N,C;switch(i){case"bottom-start":N=j.bottom+w,C=j.left;break;case"bottom-end":N=j.bottom+w,C=j.right-S;break;case"top-start":N=j.top-E-w,C=j.left;break;case"top-end":N=j.top-E-w,C=j.right-S;break;default:N=j.bottom+w,C=j.right-S}N+E>window.innerHeight&&(N=j.top-E-w),N<0&&(N=w),C+S>window.innerWidth&&(C=window.innerWidth-S-w),C<0&&(C=w),m({top:N,left:C})},p=j=>{j.preventDefault(),j.stopPropagation(),!o&&(c||x(),u(!c))},g=()=>{u(!1)},b=j=>{j.onClick&&j.onClick(),n&&n(j),g()};v.useEffect(()=>{const j=E=>{c&&f.current&&!f.current.contains(E.target)&&h.current&&!h.current.contains(E.target)&&g()},S=E=>{E.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",j),document.addEventListener("keydown",S),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",S),document.body.style.overflow=""}},[c]),v.useEffect(()=>{if(c){const j=()=>x(),S=()=>x();return window.addEventListener("scroll",j,!0),window.addEventListener("resize",S),()=>{window.removeEventListener("scroll",j,!0),window.removeEventListener("resize",S)}}},[c,i]);const y=c&&gx.createPortal(a.jsx("div",{ref:h,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:d.top,left:d.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((j,S)=>j.type==="header"?a.jsx("div",{className:`dropdown-header ${j.className||""}`,children:j.content},S):j.type==="divider"?a.jsx("div",{className:"dropdown-divider"},S):a.jsxs("button",{onClick:()=>b(j),className:`dropdown-item ${j.className||""}`,disabled:j.disabled,children:[j.icon&&a.jsx("span",{className:"me-2",children:j.icon}),j.label]},S))}),document.body);return a.jsxs("div",{className:`dropdown ${s}`,children:[a.jsx("button",{ref:f,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:p,disabled:o,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),y]})},ai=({children:e})=>{const{isAuthenticated:t,isLoading:r}=fs(),s=Gn();return r?a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:a.jsx(d5,{to:"/",state:{from:s},replace:!0})},Ur=({placeholder:e="Search...",value:t,onChange:r,className:s="",size:n="md"})=>a.jsxs(v1,{className:s,size:n,children:[a.jsx(v1.Text,{className:"bg-white border-end-0",children:a.jsx(Sx,{className:"text-primary-custom"})}),a.jsx(A.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),rr=({direction:e,size:t=16,color:r})=>{const s=r||"var(--bs-primary)",n={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?a.jsx("span",{style:{...n,color:s,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?a.jsx("span",{style:{...n,color:s,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):a.jsxs("span",{style:{...n,color:r||void 0},className:r?"":"text-muted sort-icon",children:[a.jsx("span",{style:{display:"inline-block",transform:"translateY(-1px)",opacity:r?.8:.5,marginRight:"1px"},children:""}),a.jsx("span",{style:{display:"inline-block",transform:"translateY(1px)",opacity:r?.8:.5},children:""})]})},Rn=({name:e,value:t,onChange:r,options:s=[],placeholder:n="Select an option",disabled:i=!1,isInvalid:o=!1,className:l="",style:c={},...u})=>{const d=v.useRef(null),[m,f]=v.useState(!1),h=b=>{if(i)return;const j=b.target.getBoundingClientRect(),E=window.innerHeight*.15,N=j.top-E;N>0&&window.scrollTo({top:window.scrollY+N,behavior:"instant"}),f(!0)},x=b=>{i||setTimeout(()=>{const j=b.target.getBoundingClientRect(),E=window.innerHeight*.15,N=j.top-E;N>0&&window.scrollTo({top:window.scrollY+N,behavior:"instant"})},10)},p=b=>{f(!1),r&&r(b)},g=()=>{f(!1)};return a.jsxs(A.Select,{ref:d,name:e,value:t,onChange:p,onBlur:g,onClick:h,onFocus:x,disabled:i,isInvalid:o,className:l,style:{position:"relative",zIndex:1001,...c},...u,children:[a.jsx("option",{value:"",children:n}),s.map(b=>typeof b=="object"?a.jsx("option",{value:b.value,children:b.label},b.value):a.jsx("option",{value:b,children:b},b))]})},al=()=>{const{user:e}=fs(),t=it();return v.useEffect(()=>{if(e?.role){const s=(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();let n="/admin/users";s==="ACADEMIC_DEPARTMENT"||s==="ACADEMIC_DEPT"||s.startsWith("ACADEMIC")?n="/academic/dashboard":s==="TRAINEE"?n="/trainee":s==="TRAINER"?n="/trainer/upcoming-assessments":s==="SQA_AUDITOR"?n="/sqa/issues":s==="DEPARTMENT_HEAD"?n="/department-head/dashboard":n="/admin/users",t(n,{replace:!0})}},[e,t]),null},XO=({show:e,onHide:t})=>{const[r,s]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState(""),c=async d=>{d.preventDefault(),l(""),i(!0);try{const m=await fetch(`${jo.BASE_URL}${jo.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${kx()}reset-password/`})});if(!m.ok){m.status===405?l("Forgot password feature is not available on this server. Please contact support."):m.status===404?l("Forgot password endpoint not found. Please contact support."):l(`Server error (${m.status}). Please try again later.`);return}try{await m.json()}catch(f){console.error("JSON parsing error:",f),l("Server returned invalid response. Please try again later.");return}ne.success("Password reset link has been sent to your email!"),s(""),t()}catch(m){console.error("Forgot password error:",m),m.name==="TypeError"&&m.message.includes("fetch")?l("Cannot connect to server. Please check your internet connection."):l("An unexpected error occurred. Please try again later.")}finally{i(!1)}},u=()=>{s(""),l(""),t()};return a.jsxs(ce,{show:e,onHide:u,centered:!0,children:[a.jsxs(ce.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[a.jsx(Ti,{className:"me-2",size:20}),"Forgot Password"]}),a.jsx(ie,{variant:"link",onClick:u,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:a.jsx(nt,{})})]}),a.jsxs(ce.Body,{className:"pt-0",children:[a.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),o&&a.jsx(Re,{variant:"danger",className:"mb-3",children:o}),a.jsxs(A,{onSubmit:c,children:[a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),a.jsx(A.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:d=>s(d.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),a.jsxs("div",{className:"d-grid gap-2",children:[a.jsx(ie,{type:"submit",variant:"primary",size:"lg",disabled:n||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.transform="translateY(-2px)",d.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:d=>{d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),a.jsx(ie,{type:"button",variant:"outline-secondary",onClick:u,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.background="var(--bs-neutral-100)",d.target.style.borderColor="var(--bs-primary)",d.target.style.transform="translateY(-1px)"},onMouseLeave:d=>{d.target.style.background="rgba(255, 255, 255, 0.8)",d.target.style.borderColor="var(--bs-neutral-300)",d.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function Lm(){const[e,t]=v.useState(""),[r,s]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,u]=v.useState(!1),d=it(),m=Gn(),{login:f,isAuthenticated:h,isLoading:x}=fs();if(v.useEffect(()=>{if(h){const g=m.state?.from?.pathname||"/admin";d(g,{replace:!0})}},[h,d,m.state?.from?.pathname]),x)return a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(h)return null;const p=async g=>{g.preventDefault(),l(!0);try{const b=await f({email:e,password:r});if(b.success){const y=m.state?.from?.pathname;y?d(y,{replace:!0}):d("/admin",{replace:!0})}else ne.error(b.error||"Email or password is incorrect. Please try again.")}catch{ne.error("Login failed. Please try again.")}finally{l(!1)}};return a.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[a.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),a.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),a.jsx(_e,{fluid:!0,className:"position-relative",style:{zIndex:1},children:a.jsxs(de,{className:"min-vh-100",children:[a.jsx(z,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:a.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[a.jsxs("div",{className:"d-flex align-items-center mb-4",children:[a.jsx("div",{className:"dashed-line me-3"}),a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),a.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",a.jsx("br",{}),"ACADEMY"]}),a.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),a.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),a.jsx(z,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:a.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[a.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),a.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),a.jsxs("div",{style:{position:"relative",zIndex:2},children:[a.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[a.jsx("div",{className:"dashed-line me-3"}),a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),a.jsx("div",{className:"dashed-line ms-3"})]}),a.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",a.jsx("br",{}),"ACADEMY"]}),a.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),a.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),a.jsxs(A,{onSubmit:p,children:[a.jsxs(A.Group,{className:"mb-3",controlId:"email",children:[a.jsx(A.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),a.jsx(A.Control,{type:"email",value:e,onChange:g=>t(g.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),a.jsxs(A.Group,{className:"mb-4",controlId:"password",children:[a.jsx(A.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(A.Control,{type:n?"text":"password",value:r,onChange:g=>s(g.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),a.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(g=>!g),onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&i(b=>!b)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[a.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[a.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),a.jsx(ie,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:o,children:o?a.jsxs(a.Fragment,{children:[a.jsx(Ot,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center mb-2",children:a.jsx("button",{type:"button",onClick:()=>u(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),a.jsx("div",{className:"text-center mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),a.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),a.jsxs("div",{className:"text-center",children:[a.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),a.jsx("div",{className:"text-white-50 small",children:a.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),a.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),a.jsx(XO,{show:c,onHide:()=>u(!1)})]})}const JO=()=>{const[e]=vx(),t=it(),[r,s]=v.useState({newPassword:"",confirmPassword:""}),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(""),[f,h]=v.useState("");v.useEffect(()=>{const g=e.get("token");g&&h(g)},[e]);const x=g=>{const{name:b,value:y}=g.target;s(j=>({...j,[b]:y})),d&&m("")},p=async g=>{if(g.preventDefault(),m(""),!r.newPassword||!r.confirmPassword){m("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){m("Passwords do not match.");return}u(!0);try{const b=await fetch(`${jo.BASE_URL}${jo.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!b.ok){b.status===405?m("Reset password feature is not available on this server. Please contact support."):b.status===404?m("Reset password endpoint not found. Please contact support."):b.status===400?m("Invalid token or password. Please request a new reset link."):m(`Server error (${b.status}). Please try again later.`);return}try{await b.json()}catch(y){console.error("JSON parsing error:",y),m("Server returned invalid response. Please try again later.");return}ne.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(b){console.error("Reset password error:",b),b.name==="TypeError"&&b.message.includes("fetch")?m("Cannot connect to server. Please check your internet connection."):m("An unexpected error occurred. Please try again later.")}finally{u(!1)}};return a.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:a.jsx(_e,{children:a.jsx(de,{className:"justify-content-center",children:a.jsx(z,{md:6,lg:5,xl:4,children:a.jsx(W,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:a.jsxs(W.Body,{className:"p-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:a.jsx(Rl,{size:24,className:"text-white"})}),a.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),a.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),d&&a.jsx(Re,{variant:"danger",className:"mb-3",children:d}),a.jsxs(A,{onSubmit:p,children:[a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(A.Control,{type:n?"text":"password",name:"newPassword",value:r.newPassword,onChange:x,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),a.jsx(ie,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?a.jsx(Dl,{size:16}):a.jsx(Et,{size:16})})]})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(A.Control,{type:o?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:x,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),a.jsx(ie,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>l(!o),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:o?a.jsx(Dl,{size:16}):a.jsx(Et,{size:16})})]})]}),a.jsxs("div",{className:"d-grid gap-2",children:[a.jsx(ie,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),a.jsx(ie,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Fd={};Fd.version="0.18.5";var uS=1252,ZO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ix={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Px=function(e){ZO.indexOf(e)!=-1&&(uS=Ix[0]=e)};function QO(){Px(1252)}var Da=function(e){Px(e)};function Dx(){Da(1200),QO()}function $1(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function e6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function mS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var xl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?e6(e.slice(2)):t==254&&r==255?mS(e.slice(2)):t==65279?e.slice(1):e},Xc=function(t){return String.fromCharCode(t)},U1=function(t){return String.fromCharCode(t)},Ml,Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bl(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,s=e.charCodeAt(u++),o=(r&3)<<4|s>>4,n=e.charCodeAt(u++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),t+=Fn.charAt(i)+Fn.charAt(o)+Fn.charAt(l)+Fn.charAt(c);return t}function ta(e){var t="",r=0,s=0,n=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Fn.indexOf(e.charAt(u++)),o=Fn.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Fn.indexOf(e.charAt(u++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),c=Fn.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),yn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function zn(e){return Tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function W1(e){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xs=function(t){return Tt?yn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wu(e){if(typeof ArrayBuffer>"u")return Xs(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Kn(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function t6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ox(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ox(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Zr=Tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:yn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function r6(e){for(var t=[],r=0,s=e.length+250,n=zn(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(t.push(n.slice(0,r)),r=0,n=zn(65535),s=65530)}return t.push(n.slice(0,r)),Zr(t)}var Os=/\u0000/g,gl=/[\u0001-\u0006]/g;function mo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Oa(e,t){var r=""+e;return r.length>=t?r:Er("0",t-r.length)+r}function Rx(e,t){var r=""+e;return r.length>=t?r:Er(" ",t-r.length)+r}function Ld(e,t){var r=""+e;return r.length>=t?r:r+Er(" ",t-r.length)}function s6(e,t){var r=""+Math.round(e);return r.length>=t?r:Er("0",t-r.length)+r}function a6(e,t){var r=""+e;return r.length>=t?r:Er("0",t-r.length)+r}var H1=Math.pow(2,32);function so(e,t){if(e>H1||e<-H1)return s6(e,t);var r=Math.round(e);return a6(r,t)}function Md(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var V1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function n6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},G1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bd(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,o=1,l=0,c=1,u=0,d=0,m=Math.floor(n);u<t&&(m=Math.floor(n),l=m*o+i,d=m*u+c,!(n-m<5e-8));)n=1/(n-m),i=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=o)),!r)return[0,s*l,d];var f=Math.floor(s*l/d);return[f,s*l-f*d,d]}function ui(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,o=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),r&&(i=m6(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var fS=new Date(1899,11,31,0,0,0),o6=fS.getTime(),l6=new Date(1900,2,1,0,0,0);function hS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=l6&&(r+=1440*60*1e3),(r-(o6+(e.getTimezoneOffset()-fS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Fx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function c6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function d6(e){var t=e<0?12:11,r=Fx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function u6(e){var t=Fx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function zl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=d6(e):t===10?r=e.toFixed(10).substr(0,12):r=u6(e),Fx(c6(r.toUpperCase()))}function ki(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return wa(14,hS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function m6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function f6(e,t,r,s){var n="",i=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Mm[r.m-1][1];case 5:return Mm[r.m-1][0];default:return Mm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return V1[r.q][0];default:return V1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Oa(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=Oa(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Oa(c,u):"";return d}function Ln(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var pS=/%/g;function h6(e,t,r){var s=t.replace(pS,""),n=t.length-s.length;return on(e,s,r*Math.pow(10,2*n))+Er("%",n)}function p6(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return on(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function xS(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var gS=/# (\?+)( ?)\/( ?)(\d+)/;function x6(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),o=n-i*s,l=s;return r+(i===0?"":""+i)+" "+(o===0?Er(" ",e[1].length+1+e[4].length):Rx(o,e[1].length)+e[2]+"/"+e[3]+Oa(l,e[4].length))}function g6(e,t,r){return r+(t===0?"":""+t)+Er(" ",e[1].length+2+e[4].length)}var vS=/^#*0*\.([0#]+)/,bS=/\).*[0#]/,yS=/\(###\) ###\\?-####/;function As(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function q1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function K1(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function v6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function b6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function da(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bS)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?da("n",s,r):"("+da("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return p6(e,t,r);if(t.indexOf("%")!==-1)return h6(e,t,r);if(t.indexOf("E")!==-1)return xS(t,r);if(t.charCodeAt(0)===36)return"$"+da(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+so(c,t.length);if(t.match(/^[#?]+$/))return n=so(r,0),n==="0"&&(n=""),n.length>t.length?n:As(t.substr(0,t.length-n.length))+n;if(i=t.match(gS))return x6(i,c,u);if(t.match(/^#+0+$/))return u+so(c,t.length-t.indexOf("0"));if(i=t.match(vS))return n=q1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+As(i[1])).replace(/\.$/,"."+As(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Er("0",As(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+q1(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ln(so(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+da(e,t,-r):Ln(""+(Math.floor(r)+v6(r,i[1].length)))+"."+Oa(K1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return da(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=mo(da(e,t.replace(/[\\-]/g,""),r)),o=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(yS))return n=da(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Bd(c,Math.pow(10,o)-1,!1),n=""+u,d=on("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Ld(l[2],o),d.length<i[4].length&&(d=As(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Bd(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Rx(l[1],o)+i[2]+"/"+i[3]+Ld(l[2],o):Er(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=so(r,0),t.length<=n.length?n:As(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return As(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=K1(r,i[1].length),r<0?"-"+da(e,t,-r):Ln(b6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Oa(0,3-x.length):"")+x})+"."+Oa(o,i[1].length);switch(t){case"###,##0.00":return da(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Ln(so(c,0));return h!=="0"?u+h:"";case"###,###.00":return da(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return da(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function y6(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return on(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function j6(e,t,r){var s=t.replace(pS,""),n=t.length-s.length;return on(e,s,r*Math.pow(10,2*n))+Er("%",n)}function jS(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bS)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",s,r):"("+Wa("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return y6(e,t,r);if(t.indexOf("%")!==-1)return j6(e,t,r);if(t.indexOf("E")!==-1)return jS(t,r);if(t.charCodeAt(0)===36)return"$"+Wa(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Oa(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:As(t.substr(0,t.length-n.length))+n;if(i=t.match(gS))return g6(i,c,u);if(t.match(/^#+0+$/))return u+Oa(c,t.length-t.indexOf("0"));if(i=t.match(vS))return n=(""+r).replace(/^([^\.]+)$/,"$1."+As(i[1])).replace(/\.$/,"."+As(i[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Er("0",As(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ln(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Ln(""+r)+"."+Er("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Wa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=mo(Wa(e,t.replace(/[\\-]/g,""),r)),o=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(yS))return n=Wa(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Bd(c,Math.pow(10,o)-1,!1),n=""+u,d=on("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Ld(l[2],o),d.length<i[4].length&&(d=As(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Bd(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Rx(l[1],o)+i[2]+"/"+i[3]+Ld(l[2],o):Er(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:As(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return As(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Ln(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Oa(0,3-x.length):"")+x})+"."+Oa(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Ln(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Wa(e,t.slice(0,t.lastIndexOf(".")),r)+As(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function on(e,t,r){return(r|0)===r?Wa(e,t,r):da(e,t,r)}function w6(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var wS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zo(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Md(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(wS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function N6(e,t,r,s){for(var n=[],i="",o=0,l="",c="t",u,d,m,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Md(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),x=h==="("||h===")"?h:"t";n[n.length]={t:x,v:h},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=ui(t,r,e.charAt(o+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ui(t,r),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=ui(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,f="h"):(p.t="t",++o),u==null&&p.t==="T")return"";n[n.length]=p,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(wS)){if(u==null&&(u=ui(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",zo(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var g=0,b=0,y;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=f,c="h",g<1&&(g=1);break;case"s":(y=n[o].v.match(/\.0+$/))&&(b=Math.max(b,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[o].v.match(/[Hh]/)&&(g=1),g<2&&n[o].v.match(/[Mm]/)&&(g=2),g<3&&n[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var j="",S;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=f6(n[o].t.charCodeAt(0),n[o].v,u,b),n[o].t="t";break;case"n":case"?":for(S=o+1;n[S]!=null&&((l=n[S].t)==="?"||l==="D"||(l===" "||l==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[o].v+=n[S].v,n[S]={v:"",t:";"},++S;j+=n[o].v,o=S-1;break;case"G":n[o].t="t",n[o].v=ki(t,r);break}var E="",w,N;if(j.length>0){j.charCodeAt(0)==40?(w=t<0&&j.charCodeAt(0)===45?-t:t,N=on("n",j,w)):(w=t<0&&s>1?-t:t,N=on("n",j,w),w<0&&n[0]&&n[0].t=="t"&&(N=N.substr(1),n[0].v="-"+n[0].v)),S=N.length-1;var C=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){C=o;break}var T=n.length;if(C===n.length&&N.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(S>=n[o].v.length-1?(S-=n[o].v.length,n[o].v=N.substr(S+1,n[o].v.length)):S<0?n[o].v="":(n[o].v=N.substr(0,S+1),S=-1),n[o].t="t",T=o);S>=0&&T<n.length&&(n[T].v=N.substr(0,S+1)+n[T].v)}else if(C!==n.length&&N.indexOf("E")===-1){for(S=N.indexOf(".")-1,o=C;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===C?n[o].v.indexOf(".")-1:n[o].v.length-1,E=n[o].v.substr(d+1);d>=0;--d)S>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(E=N.charAt(S--)+E);n[o].v=E,n[o].t="t",T=o}for(S>=0&&T<n.length&&(n[T].v=N.substr(0,S+1)+n[T].v),S=N.indexOf(".")+1,o=C;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==C)){for(d=n[o].v.indexOf(".")>-1&&o===C?n[o].v.indexOf(".")+1:0,E=n[o].v.substr(0,d);d<n[o].v.length;++d)S<N.length&&(E+=N.charAt(S++));n[o].v=E,n[o].t="t",T=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(w=s>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=on(n[o].t,n[o].v,w),n[o].t="t");var _="";for(o=0;o!==n.length;++o)n[o]!=null&&(_+=n[o].v);return _}var Y1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function X1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function S6(e,t){var r=w6(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Y1),l=r[1].match(Y1);return X1(t,o)?[s,r[0]]:X1(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,i]}function wa(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:pt)[e],s==null&&(s=r.table&&r.table[G1[e]]||pt[G1[e]]),s==null&&(s=i6[e]||"General");break}if(Md(s,0))return ki(t,r);t instanceof Date&&(t=hS(t,r.date1904));var n=S6(s,t);if(Md(n[1]))return ki(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return N6(n[1],t,r,n[0])}function ln(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(pt[r]==null){t<0&&(t=r);continue}if(pt[r]==e){t=r;break}}t<0&&(t=391)}return pt[t]=e,t}function Hu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ln(e[t],t)}function $o(){pt=n6()}var E6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},NS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function T6(e){var t=typeof e=="number"?pt[e]:e;return t=t.replace(NS,"(\\d+)"),new RegExp("^"+t+"$")}function C6(e,t,r){var s=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(t.match(NS)||[]).forEach(function(m,f){var h=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":s=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:n=h;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:s==-1&&n==-1&&i==-1?d:u+"T"+d}var A6=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,C=new Array(256),T=0;T!=256;++T)N=T,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,C[T]=N;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function s(N){var C=0,T=0,_=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_=0;_!=256;++_)k[_]=N[_];for(_=0;_!=256;++_)for(T=N[_],C=256+_;C<4096;C+=256)T=k[C]=T>>>8^N[T&255];var I=[];for(_=1;_!=16;++_)I[_-1]=typeof Int32Array<"u"?k.subarray(_*256,_*256+256):k.slice(_*256,_*256+256);return I}var n=s(r),i=n[0],o=n[1],l=n[2],c=n[3],u=n[4],d=n[5],m=n[6],f=n[7],h=n[8],x=n[9],p=n[10],g=n[11],b=n[12],y=n[13],j=n[14];function S(N,C){for(var T=C^-1,_=0,k=N.length;_<k;)T=T>>>8^r[(T^N.charCodeAt(_++))&255];return~T}function E(N,C){for(var T=C^-1,_=N.length-15,k=0;k<_;)T=j[N[k++]^T&255]^y[N[k++]^T>>8&255]^b[N[k++]^T>>16&255]^g[N[k++]^T>>>24]^p[N[k++]]^x[N[k++]]^h[N[k++]]^f[N[k++]]^m[N[k++]]^d[N[k++]]^u[N[k++]]^c[N[k++]]^l[N[k++]]^o[N[k++]]^i[N[k++]]^r[N[k++]];for(_+=15;k<_;)T=T>>>8^r[(T^N[k++])&255];return~T}function w(N,C){for(var T=C^-1,_=0,k=N.length,I=0,L=0;_<k;)I=N.charCodeAt(_++),I<128?T=T>>>8^r[(T^I)&255]:I<2048?(T=T>>>8^r[(T^(192|I>>6&31))&255],T=T>>>8^r[(T^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,L=N.charCodeAt(_++)&1023,T=T>>>8^r[(T^(240|I>>8&7))&255],T=T>>>8^r[(T^(128|I>>2&63))&255],T=T>>>8^r[(T^(128|L>>6&15|(I&3)<<4))&255],T=T>>>8^r[(T^(128|L&63))&255]):(T=T>>>8^r[(T^(224|I>>12&15))&255],T=T>>>8^r[(T^(128|I>>6&63))&255],T=T>>>8^r[(T^(128|I&63))&255]);return~T}return e.table=r,e.bstr=S,e.buf=E,e.str=w,e})(),mt=(function(){var t={};t.version="1.2.1";function r(V,re){for(var X=V.split("/"),ee=re.split("/"),se=0,ae=0,be=Math.min(X.length,ee.length);se<be;++se){if(ae=X[se].length-ee[se].length)return ae;if(X[se]!=ee[se])return X[se]<ee[se]?-1:1}return X.length-ee.length}function s(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:s(V.slice(0,-1));var re=V.lastIndexOf("/");return re===-1?V:V.slice(0,re+1)}function n(V){if(V.charAt(V.length-1)=="/")return n(V.slice(0,-1));var re=V.lastIndexOf("/");return re===-1?V:V.slice(re+1)}function i(V,re){typeof re=="string"&&(re=new Date(re));var X=re.getHours();X=X<<6|re.getMinutes(),X=X<<5|re.getSeconds()>>>1,V.write_shift(2,X);var ee=re.getFullYear()-1980;ee=ee<<4|re.getMonth()+1,ee=ee<<5|re.getDate(),V.write_shift(2,ee)}function o(V){var re=V.read_shift(2)&65535,X=V.read_shift(2)&65535,ee=new Date,se=X&31;X>>>=5;var ae=X&15;X>>>=4,ee.setMilliseconds(0),ee.setFullYear(X+1980),ee.setMonth(ae-1),ee.setDate(se);var be=re&31;re>>>=5;var ke=re&63;return re>>>=6,ee.setHours(re),ee.setMinutes(ke),ee.setSeconds(be<<1),ee}function l(V){cs(V,0);for(var re={},X=0;V.l<=V.length-4;){var ee=V.read_shift(2),se=V.read_shift(2),ae=V.l+se,be={};switch(ee){case 21589:X=V.read_shift(1),X&1&&(be.mtime=V.read_shift(4)),se>5&&(X&2&&(be.atime=V.read_shift(4)),X&4&&(be.ctime=V.read_shift(4))),be.mtime&&(be.mt=new Date(be.mtime*1e3));break}V.l=ae,re[ee]=be}return re}var c;function u(){return c||(c={})}function d(V,re){if(V[0]==80&&V[1]==75)return dt(V,re);if((V[0]|32)==109&&(V[1]|32)==105)return t5(V,re);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var X=3,ee=512,se=0,ae=0,be=0,ke=0,ve=0,ye=[],Ne=V.slice(0,512);cs(Ne,0);var ze=m(Ne);switch(X=ze[0],X){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(ze[1]==0)return dt(V,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}ee!==512&&(Ne=V.slice(0,ee),cs(Ne,28));var qe=V.slice(0,ee);f(Ne,X);var et=Ne.read_shift(4,"i");if(X===3&&et!==0)throw new Error("# Directory Sectors: Expected 0 saw "+et);Ne.l+=4,be=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),ke=Ne.read_shift(4,"i"),se=Ne.read_shift(4,"i"),ve=Ne.read_shift(4,"i"),ae=Ne.read_shift(4,"i");for(var $e=-1,Ze=0;Ze<109&&($e=Ne.read_shift(4,"i"),!($e<0));++Ze)ye[Ze]=$e;var jt=h(V,ee);g(ve,ae,jt,ee,ye);var gr=y(jt,be,ye,ee);gr[be].name="!Directory",se>0&&ke!==L&&(gr[ke].name="!MiniFAT"),gr[ye[0]].name="!FAT",gr.fat_addrs=ye,gr.ssz=ee;var vr={},hs=[],Qo=[],el=[];j(be,gr,jt,hs,se,vr,Qo,ke),x(Qo,el,hs),hs.shift();var tl={FileIndex:Qo,FullPaths:el};return re&&re.raw&&(tl.raw={header:qe,sectors:jt}),tl}function m(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(D,"Header Signature: "),V.l+=16;var re=V.read_shift(2,"u");return[V.read_shift(2,"u"),re]}function f(V,re){var X=9;switch(V.l+=2,X=V.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function h(V,re){for(var X=Math.ceil(V.length/re)-1,ee=[],se=1;se<X;++se)ee[se-1]=V.slice(se*re,(se+1)*re);return ee[X-1]=V.slice(X*re),ee}function x(V,re,X){for(var ee=0,se=0,ae=0,be=0,ke=0,ve=X.length,ye=[],Ne=[];ee<ve;++ee)ye[ee]=Ne[ee]=ee,re[ee]=X[ee];for(;ke<Ne.length;++ke)ee=Ne[ke],se=V[ee].L,ae=V[ee].R,be=V[ee].C,ye[ee]===ee&&(se!==-1&&ye[se]!==se&&(ye[ee]=ye[se]),ae!==-1&&ye[ae]!==ae&&(ye[ee]=ye[ae])),be!==-1&&(ye[be]=ee),se!==-1&&ee!=ye[ee]&&(ye[se]=ye[ee],Ne.lastIndexOf(se)<ke&&Ne.push(se)),ae!==-1&&ee!=ye[ee]&&(ye[ae]=ye[ee],Ne.lastIndexOf(ae)<ke&&Ne.push(ae));for(ee=1;ee<ve;++ee)ye[ee]===ee&&(ae!==-1&&ye[ae]!==ae?ye[ee]=ye[ae]:se!==-1&&ye[se]!==se&&(ye[ee]=ye[se]));for(ee=1;ee<ve;++ee)if(V[ee].type!==0){if(ke=ee,ke!=ye[ke])do ke=ye[ke],re[ee]=re[ke]+"/"+re[ee];while(ke!==0&&ye[ke]!==-1&&ke!=ye[ke]);ye[ee]=-1}for(re[0]+="/",ee=1;ee<ve;++ee)V[ee].type!==2&&(re[ee]+="/")}function p(V,re,X){for(var ee=V.start,se=V.size,ae=[],be=ee;X&&se>0&&be>=0;)ae.push(re.slice(be*I,be*I+I)),se-=I,be=ci(X,be*4);return ae.length===0?Ce(0):Zr(ae).slice(0,V.size)}function g(V,re,X,ee,se){var ae=L;if(V===L){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var be=X[V],ke=(ee>>>2)-1;if(!be)return;for(var ve=0;ve<ke&&(ae=ci(be,ve*4))!==L;++ve)se.push(ae);g(ci(be,ee-4),re-1,X,ee,se)}}function b(V,re,X,ee,se){var ae=[],be=[];se||(se=[]);var ke=ee-1,ve=0,ye=0;for(ve=re;ve>=0;){se[ve]=!0,ae[ae.length]=ve,be.push(V[ve]);var Ne=X[Math.floor(ve*4/ee)];if(ye=ve*4&ke,ee<4+ye)throw new Error("FAT boundary crossed: "+ve+" 4 "+ee);if(!V[Ne])break;ve=ci(V[Ne],ye)}return{nodes:ae,data:lb([be])}}function y(V,re,X,ee){var se=V.length,ae=[],be=[],ke=[],ve=[],ye=ee-1,Ne=0,ze=0,qe=0,et=0;for(Ne=0;Ne<se;++Ne)if(ke=[],qe=Ne+re,qe>=se&&(qe-=se),!be[qe]){ve=[];var $e=[];for(ze=qe;ze>=0;){$e[ze]=!0,be[ze]=!0,ke[ke.length]=ze,ve.push(V[ze]);var Ze=X[Math.floor(ze*4/ee)];if(et=ze*4&ye,ee<4+et)throw new Error("FAT boundary crossed: "+ze+" 4 "+ee);if(!V[Ze]||(ze=ci(V[Ze],et),$e[ze]))break}ae[qe]={nodes:ke,data:lb([ve])}}return ae}function j(V,re,X,ee,se,ae,be,ke){for(var ve=0,ye=ee.length?2:0,Ne=re[V].data,ze=0,qe=0,et;ze<Ne.length;ze+=128){var $e=Ne.slice(ze,ze+128);cs($e,64),qe=$e.read_shift(2),et=Wx($e,0,qe-ye),ee.push(et);var Ze={name:et,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},jt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);jt!==0&&(Ze.ct=S($e,$e.l-8));var gr=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);gr!==0&&(Ze.mt=S($e,$e.l-8)),Ze.start=$e.read_shift(4,"i"),Ze.size=$e.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=L,Ze.name=""),Ze.type===5?(ve=Ze.start,se>0&&ve!==L&&(re[ve].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",re[Ze.start]===void 0&&(re[Ze.start]=b(X,Ze.start,re.fat_addrs,re.ssz)),re[Ze.start].name=Ze.name,Ze.content=re[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:ve!==L&&Ze.start!==L&&re[ve]&&(Ze.content=p(Ze,re[ve].data,(re[ke]||{}).data))),Ze.content&&cs(Ze.content,0),ae[et]=Ze,be.push(Ze)}}function S(V,re){return new Date((Ys(V,re+4)/1e7*Math.pow(2,32)+Ys(V,re)/1e7-11644473600)*1e3)}function E(V,re){return u(),d(c.readFileSync(V),re)}function w(V,re){var X=re&&re.type;switch(X||Tt&&Buffer.isBuffer(V)&&(X="buffer"),X||"base64"){case"file":return E(V,re);case"base64":return d(Xs(ta(V)),re);case"binary":return d(Xs(V),re)}return d(V,re)}function N(V,re){var X=re||{},ee=X.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=ee+"/",V.FileIndex[0]={name:ee,type:5}),X.CLSID&&(V.FileIndex[0].clsid=X.CLSID),C(V)}function C(V){var re="Sh33tJ5";if(!mt.find(V,"/"+re)){var X=Ce(4);X[0]=55,X[1]=X[3]=50,X[2]=54,V.FileIndex.push({name:re,type:2,content:X,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+re),T(V)}}function T(V,re){N(V);for(var X=!1,ee=!1,se=V.FullPaths.length-1;se>=0;--se){var ae=V.FileIndex[se];switch(ae.type){case 0:ee?X=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(ae.R*ae.L*ae.C)&&(X=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!re)){var be=new Date(1987,1,19),ke=0,ve=Object.create?Object.create(null):{},ye=[];for(se=0;se<V.FullPaths.length;++se)ve[V.FullPaths[se]]=!0,V.FileIndex[se].type!==0&&ye.push([V.FullPaths[se],V.FileIndex[se]]);for(se=0;se<ye.length;++se){var Ne=s(ye[se][0]);ee=ve[Ne],ee||(ye.push([Ne,{name:n(Ne).replace("/",""),type:1,clsid:q,ct:be,mt:be,content:null}]),ve[Ne]=!0)}for(ye.sort(function(et,$e){return r(et[0],$e[0])}),V.FullPaths=[],V.FileIndex=[],se=0;se<ye.length;++se)V.FullPaths[se]=ye[se][0],V.FileIndex[se]=ye[se][1];for(se=0;se<ye.length;++se){var ze=V.FileIndex[se],qe=V.FullPaths[se];if(ze.name=n(qe).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||q,se===0)ze.C=ye.length>1?1:-1,ze.size=0,ze.type=5;else if(qe.slice(-1)=="/"){for(ke=se+1;ke<ye.length&&s(V.FullPaths[ke])!=qe;++ke);for(ze.C=ke>=ye.length?-1:ke,ke=se+1;ke<ye.length&&s(V.FullPaths[ke])!=s(qe);++ke);ze.R=ke>=ye.length?-1:ke,ze.type=1}else s(V.FullPaths[se+1]||"")==s(qe)&&(ze.R=se+1),ze.type=2}}}function _(V,re){var X=re||{};if(X.fileType=="mad")return r5(V,X);switch(T(V),X.fileType){case"zip":return tr(V,X)}var ee=(function(et){for(var $e=0,Ze=0,jt=0;jt<et.FileIndex.length;++jt){var gr=et.FileIndex[jt];if(gr.content){var vr=gr.content.length;vr>0&&(vr<4096?$e+=vr+63>>6:Ze+=vr+511>>9)}}for(var hs=et.FullPaths.length+3>>2,Qo=$e+7>>3,el=$e+127>>7,tl=Qo+Ze+hs+el,ri=tl+127>>7,Im=ri<=109?0:Math.ceil((ri-109)/127);tl+ri+Im+127>>7>ri;)Im=++ri<=109?0:Math.ceil((ri-109)/127);var en=[1,Im,ri,el,hs,Ze,$e,0];return et.FileIndex[0].size=$e<<6,en[7]=(et.FileIndex[0].start=en[0]+en[1]+en[2]+en[3]+en[4]+en[5])+(en[6]+7>>3),en})(V),se=Ce(ee[7]<<9),ae=0,be=0;{for(ae=0;ae<8;++ae)se.write_shift(1,M[ae]);for(ae=0;ae<8;++ae)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),ae=0;ae<3;++ae)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,ee[2]),se.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:L),se.write_shift(4,ee[3]),se.write_shift(-4,ee[1]?ee[0]-1:L),se.write_shift(4,ee[1]),ae=0;ae<109;++ae)se.write_shift(-4,ae<ee[2]?ee[1]+ae:-1)}if(ee[1])for(be=0;be<ee[1];++be){for(;ae<236+be*127;++ae)se.write_shift(-4,ae<ee[2]?ee[1]+ae:-1);se.write_shift(-4,be===ee[1]-1?L:be+1)}var ke=function(et){for(be+=et;ae<be-1;++ae)se.write_shift(-4,ae+1);et&&(++ae,se.write_shift(-4,L))};for(be=ae=0,be+=ee[1];ae<be;++ae)se.write_shift(-4,Z.DIFSECT);for(be+=ee[2];ae<be;++ae)se.write_shift(-4,Z.FATSECT);ke(ee[3]),ke(ee[4]);for(var ve=0,ye=0,Ne=V.FileIndex[0];ve<V.FileIndex.length;++ve)Ne=V.FileIndex[ve],Ne.content&&(ye=Ne.content.length,!(ye<4096)&&(Ne.start=be,ke(ye+511>>9)));for(ke(ee[6]+7>>3);se.l&511;)se.write_shift(-4,Z.ENDOFCHAIN);for(be=ae=0,ve=0;ve<V.FileIndex.length;++ve)Ne=V.FileIndex[ve],Ne.content&&(ye=Ne.content.length,!(!ye||ye>=4096)&&(Ne.start=be,ke(ye+63>>6)));for(;se.l&511;)se.write_shift(-4,Z.ENDOFCHAIN);for(ae=0;ae<ee[4]<<2;++ae){var ze=V.FullPaths[ae];if(!ze||ze.length===0){for(ve=0;ve<17;++ve)se.write_shift(4,0);for(ve=0;ve<3;++ve)se.write_shift(4,-1);for(ve=0;ve<12;++ve)se.write_shift(4,0);continue}Ne=V.FileIndex[ae],ae===0&&(Ne.start=Ne.size?Ne.start-1:L);var qe=ae===0&&X.root||Ne.name;if(ye=2*(qe.length+1),se.write_shift(64,qe,"utf16le"),se.write_shift(2,ye),se.write_shift(1,Ne.type),se.write_shift(1,Ne.color),se.write_shift(-4,Ne.L),se.write_shift(-4,Ne.R),se.write_shift(-4,Ne.C),Ne.clsid)se.write_shift(16,Ne.clsid,"hex");else for(ve=0;ve<4;++ve)se.write_shift(4,0);se.write_shift(4,Ne.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,Ne.start),se.write_shift(4,Ne.size),se.write_shift(4,0)}for(ae=1;ae<V.FileIndex.length;++ae)if(Ne=V.FileIndex[ae],Ne.size>=4096)if(se.l=Ne.start+1<<9,Tt&&Buffer.isBuffer(Ne.content))Ne.content.copy(se,se.l,0,Ne.size),se.l+=Ne.size+511&-512;else{for(ve=0;ve<Ne.size;++ve)se.write_shift(1,Ne.content[ve]);for(;ve&511;++ve)se.write_shift(1,0)}for(ae=1;ae<V.FileIndex.length;++ae)if(Ne=V.FileIndex[ae],Ne.size>0&&Ne.size<4096)if(Tt&&Buffer.isBuffer(Ne.content))Ne.content.copy(se,se.l,0,Ne.size),se.l+=Ne.size+63&-64;else{for(ve=0;ve<Ne.size;++ve)se.write_shift(1,Ne.content[ve]);for(;ve&63;++ve)se.write_shift(1,0)}if(Tt)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function k(V,re){var X=V.FullPaths.map(function(ve){return ve.toUpperCase()}),ee=X.map(function(ve){var ye=ve.split("/");return ye[ye.length-(ve.slice(-1)=="/"?2:1)]}),se=!1;re.charCodeAt(0)===47?(se=!0,re=X[0].slice(0,-1)+re):se=re.indexOf("/")!==-1;var ae=re.toUpperCase(),be=se===!0?X.indexOf(ae):ee.indexOf(ae);if(be!==-1)return V.FileIndex[be];var ke=!ae.match(gl);for(ae=ae.replace(Os,""),ke&&(ae=ae.replace(gl,"!")),be=0;be<X.length;++be)if((ke?X[be].replace(gl,"!"):X[be]).replace(Os,"")==ae||(ke?ee[be].replace(gl,"!"):ee[be]).replace(Os,"")==ae)return V.FileIndex[be];return null}var I=64,L=-2,D="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(V,re,X){u();var ee=_(V,X);c.writeFileSync(re,ee)}function U(V){for(var re=new Array(V.length),X=0;X<V.length;++X)re[X]=String.fromCharCode(V[X]);return re.join("")}function le(V,re){var X=_(V,re);switch(re&&re.type||"buffer"){case"file":return u(),c.writeFileSync(re.filename,X),X;case"binary":return typeof X=="string"?X:U(X);case"base64":return Bl(typeof X=="string"?X:U(X));case"buffer":if(Tt)return Buffer.isBuffer(X)?X:yn(X);case"array":return typeof X=="string"?Xs(X):X}return X}var Se;function P(V){try{var re=V.InflateRaw,X=new re;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)Se=V;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function G(V,re){if(!Se)return st(V,re);var X=Se.InflateRaw,ee=new X,se=ee._processChunk(V.slice(V.l),ee._finishFlushFlag);return V.l+=ee.bytesRead,se}function K(V){return Se?Se.deflateRawSync(V):me(V)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(V){var re=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(re>>16|re>>8|re)&255}for(var te=typeof Uint8Array<"u",pe=te?new Uint8Array(256):[],we=0;we<256;++we)pe[we]=Y(we);function B(V,re){var X=pe[V&255];return re<=8?X>>>8-re:(X=X<<8|pe[V>>8&255],re<=16?X>>>16-re:(X=X<<8|pe[V>>16&255],X>>>24-re))}function Be(V,re){var X=re&7,ee=re>>>3;return(V[ee]|(X<=6?0:V[ee+1]<<8))>>>X&3}function fe(V,re){var X=re&7,ee=re>>>3;return(V[ee]|(X<=5?0:V[ee+1]<<8))>>>X&7}function oe(V,re){var X=re&7,ee=re>>>3;return(V[ee]|(X<=4?0:V[ee+1]<<8))>>>X&15}function ge(V,re){var X=re&7,ee=re>>>3;return(V[ee]|(X<=3?0:V[ee+1]<<8))>>>X&31}function ue(V,re){var X=re&7,ee=re>>>3;return(V[ee]|(X<=1?0:V[ee+1]<<8))>>>X&127}function Ie(V,re,X){var ee=re&7,se=re>>>3,ae=(1<<X)-1,be=V[se]>>>ee;return X<8-ee||(be|=V[se+1]<<8-ee,X<16-ee)||(be|=V[se+2]<<16-ee,X<24-ee)||(be|=V[se+3]<<24-ee),be&ae}function Le(V,re,X){var ee=re&7,se=re>>>3;return ee<=5?V[se]|=(X&7)<<ee:(V[se]|=X<<ee&255,V[se+1]=(X&7)>>8-ee),re+3}function he(V,re,X){var ee=re&7,se=re>>>3;return X=(X&1)<<ee,V[se]|=X,re+1}function Me(V,re,X){var ee=re&7,se=re>>>3;return X<<=ee,V[se]|=X&255,X>>>=8,V[se+1]=X,re+8}function Ge(V,re,X){var ee=re&7,se=re>>>3;return X<<=ee,V[se]|=X&255,X>>>=8,V[se+1]=X&255,V[se+2]=X>>>8,re+16}function Ke(V,re){var X=V.length,ee=2*X>re?2*X:re+5,se=0;if(X>=re)return V;if(Tt){var ae=W1(ee);if(V.copy)V.copy(ae);else for(;se<V.length;++se)ae[se]=V[se];return ae}else if(te){var be=new Uint8Array(ee);if(be.set)be.set(V);else for(;se<X;++se)be[se]=V[se];return be}return V.length=ee,V}function We(V){for(var re=new Array(V),X=0;X<V;++X)re[X]=0;return re}function yt(V,re,X){var ee=1,se=0,ae=0,be=0,ke=0,ve=V.length,ye=te?new Uint16Array(32):We(32);for(ae=0;ae<32;++ae)ye[ae]=0;for(ae=ve;ae<X;++ae)V[ae]=0;ve=V.length;var Ne=te?new Uint16Array(ve):We(ve);for(ae=0;ae<ve;++ae)ye[se=V[ae]]++,ee<se&&(ee=se),Ne[ae]=0;for(ye[0]=0,ae=1;ae<=ee;++ae)ye[ae+16]=ke=ke+ye[ae-1]<<1;for(ae=0;ae<ve;++ae)ke=V[ae],ke!=0&&(Ne[ae]=ye[ke+16]++);var ze=0;for(ae=0;ae<ve;++ae)if(ze=V[ae],ze!=0)for(ke=B(Ne[ae],ee)>>ee-ze,be=(1<<ee+4-ze)-1;be>=0;--be)re[ke|be<<ze]=ze&15|ae<<4;return ee}var Xe=te?new Uint16Array(512):We(512),Je=te?new Uint16Array(32):We(32);if(!te){for(var Ye=0;Ye<512;++Ye)Xe[Ye]=0;for(Ye=0;Ye<32;++Ye)Je[Ye]=0}(function(){for(var V=[],re=0;re<32;re++)V.push(5);yt(V,Je,32);var X=[];for(re=0;re<=143;re++)X.push(8);for(;re<=255;re++)X.push(9);for(;re<=279;re++)X.push(7);for(;re<=287;re++)X.push(8);yt(X,Xe,288)})();var at=(function(){for(var re=te?new Uint8Array(32768):[],X=0,ee=0;X<H.length-1;++X)for(;ee<H[X+1];++ee)re[ee]=X;for(;ee<32768;++ee)re[ee]=29;var se=te?new Uint8Array(259):[];for(X=0,ee=0;X<F.length-1;++X)for(;ee<F[X+1];++ee)se[ee]=X;function ae(ke,ve){for(var ye=0;ye<ke.length;){var Ne=Math.min(65535,ke.length-ye),ze=ye+Ne==ke.length;for(ve.write_shift(1,+ze),ve.write_shift(2,Ne),ve.write_shift(2,~Ne&65535);Ne-- >0;)ve[ve.l++]=ke[ye++]}return ve.l}function be(ke,ve){for(var ye=0,Ne=0,ze=te?new Uint16Array(32768):[];Ne<ke.length;){var qe=Math.min(65535,ke.length-Ne);if(qe<10){for(ye=Le(ve,ye,+(Ne+qe==ke.length)),ye&7&&(ye+=8-(ye&7)),ve.l=ye/8|0,ve.write_shift(2,qe),ve.write_shift(2,~qe&65535);qe-- >0;)ve[ve.l++]=ke[Ne++];ye=ve.l*8;continue}ye=Le(ve,ye,+(Ne+qe==ke.length)+2);for(var et=0;qe-- >0;){var $e=ke[Ne];et=(et<<5^$e)&32767;var Ze=-1,jt=0;if((Ze=ze[et])&&(Ze|=Ne&-32768,Ze>Ne&&(Ze-=32768),Ze<Ne))for(;ke[Ze+jt]==ke[Ne+jt]&&jt<250;)++jt;if(jt>2){$e=se[jt],$e<=22?ye=Me(ve,ye,pe[$e+1]>>1)-1:(Me(ve,ye,3),ye+=5,Me(ve,ye,pe[$e-23]>>5),ye+=3);var gr=$e<8?0:$e-4>>2;gr>0&&(Ge(ve,ye,jt-F[$e]),ye+=gr),$e=re[Ne-Ze],ye=Me(ve,ye,pe[$e]>>3),ye-=3;var vr=$e<4?0:$e-2>>1;vr>0&&(Ge(ve,ye,Ne-Ze-H[$e]),ye+=vr);for(var hs=0;hs<jt;++hs)ze[et]=Ne&32767,et=(et<<5^ke[Ne])&32767,++Ne;qe-=jt-1}else $e<=143?$e=$e+48:ye=he(ve,ye,1),ye=Me(ve,ye,pe[$e]),ze[et]=Ne&32767,++Ne}ye=Me(ve,ye,0)-1}return ve.l=(ye+7)/8|0,ve.l}return function(ve,ye){return ve.length<8?ae(ve,ye):be(ve,ye)}})();function me(V){var re=Ce(50+Math.floor(V.length*1.1)),X=at(V,re);return re.slice(0,X)}var xe=te?new Uint16Array(32768):We(32768),Oe=te?new Uint16Array(32768):We(32768),ot=te?new Uint16Array(128):We(128),tt=1,Qe=1;function De(V,re){var X=ge(V,re)+257;re+=5;var ee=ge(V,re)+1;re+=5;var se=oe(V,re)+4;re+=4;for(var ae=0,be=te?new Uint8Array(19):We(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,ye=te?new Uint8Array(8):We(8),Ne=te?new Uint8Array(8):We(8),ze=be.length,qe=0;qe<se;++qe)be[O[qe]]=ae=fe(V,re),ve<ae&&(ve=ae),ye[ae]++,re+=3;var et=0;for(ye[0]=0,qe=1;qe<=ve;++qe)Ne[qe]=et=et+ye[qe-1]<<1;for(qe=0;qe<ze;++qe)(et=be[qe])!=0&&(ke[qe]=Ne[et]++);var $e=0;for(qe=0;qe<ze;++qe)if($e=be[qe],$e!=0){et=pe[ke[qe]]>>8-$e;for(var Ze=(1<<7-$e)-1;Ze>=0;--Ze)ot[et|Ze<<$e]=$e&7|qe<<3}var jt=[];for(ve=1;jt.length<X+ee;)switch(et=ot[ue(V,re)],re+=et&7,et>>>=3){case 16:for(ae=3+Be(V,re),re+=2,et=jt[jt.length-1];ae-- >0;)jt.push(et);break;case 17:for(ae=3+fe(V,re),re+=3;ae-- >0;)jt.push(0);break;case 18:for(ae=11+ue(V,re),re+=7;ae-- >0;)jt.push(0);break;default:jt.push(et),ve<et&&(ve=et);break}var gr=jt.slice(0,X),vr=jt.slice(X);for(qe=X;qe<286;++qe)gr[qe]=0;for(qe=ee;qe<30;++qe)vr[qe]=0;return tt=yt(gr,xe,286),Qe=yt(vr,Oe,30),re}function Ve(V,re){if(V[0]==3&&!(V[1]&3))return[zn(re),2];for(var X=0,ee=0,se=W1(re||1<<18),ae=0,be=se.length>>>0,ke=0,ve=0;(ee&1)==0;){if(ee=fe(V,X),X+=3,ee>>>1)ee>>1==1?(ke=9,ve=5):(X=De(V,X),ke=tt,ve=Qe);else{X&7&&(X+=8-(X&7));var ye=V[X>>>3]|V[(X>>>3)+1]<<8;if(X+=32,ye>0)for(!re&&be<ae+ye&&(se=Ke(se,ae+ye),be=se.length);ye-- >0;)se[ae++]=V[X>>>3],X+=8;continue}for(;;){!re&&be<ae+32767&&(se=Ke(se,ae+32767),be=se.length);var Ne=Ie(V,X,ke),ze=ee>>>1==1?Xe[Ne]:xe[Ne];if(X+=ze&15,ze>>>=4,(ze>>>8&255)===0)se[ae++]=ze;else{if(ze==256)break;ze-=257;var qe=ze<8?0:ze-4>>2;qe>5&&(qe=0);var et=ae+F[ze];qe>0&&(et+=Ie(V,X,qe),X+=qe),Ne=Ie(V,X,ve),ze=ee>>>1==1?Je[Ne]:Oe[Ne],X+=ze&15,ze>>>=4;var $e=ze<4?0:ze-2>>1,Ze=H[ze];for($e>0&&(Ze+=Ie(V,X,$e),X+=$e),!re&&be<et&&(se=Ke(se,et+100),be=se.length);ae<et;)se[ae]=se[ae-Ze],++ae}}}return re?[se,X+7>>>3]:[se.slice(0,ae),X+7>>>3]}function st(V,re){var X=V.slice(V.l||0),ee=Ve(X,re);return V.l+=ee[1],ee[0]}function ct(V,re){if(V)typeof console<"u"&&console.error(re);else throw new Error(re)}function dt(V,re){var X=V;cs(X,0);var ee=[],se=[],ae={FileIndex:ee,FullPaths:se};N(ae,{root:re.root});for(var be=X.length-4;(X[be]!=80||X[be+1]!=75||X[be+2]!=5||X[be+3]!=6)&&be>=0;)--be;X.l=be+4,X.l+=4;var ke=X.read_shift(2);X.l+=6;var ve=X.read_shift(4);for(X.l=ve,be=0;be<ke;++be){X.l+=20;var ye=X.read_shift(4),Ne=X.read_shift(4),ze=X.read_shift(2),qe=X.read_shift(2),et=X.read_shift(2);X.l+=8;var $e=X.read_shift(4),Ze=l(X.slice(X.l+ze,X.l+ze+qe));X.l+=ze+qe+et;var jt=X.l;X.l=$e+4,Qt(X,ye,Ne,ae,Ze),X.l=jt}return ae}function Qt(V,re,X,ee,se){V.l+=2;var ae=V.read_shift(2),be=V.read_shift(2),ke=o(V);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var ve=V.read_shift(4),ye=V.read_shift(4),Ne=V.read_shift(4),ze=V.read_shift(2),qe=V.read_shift(2),et="",$e=0;$e<ze;++$e)et+=String.fromCharCode(V[V.l++]);if(qe){var Ze=l(V.slice(V.l,V.l+qe));(Ze[21589]||{}).mt&&(ke=Ze[21589].mt),((se||{})[21589]||{}).mt&&(ke=se[21589].mt)}V.l+=qe;var jt=V.slice(V.l,V.l+ye);switch(be){case 8:jt=G(V,Ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+be)}var gr=!1;ae&8&&(ve=V.read_shift(4),ve==134695760&&(ve=V.read_shift(4),gr=!0),ye=V.read_shift(4),Ne=V.read_shift(4)),ye!=re&&ct(gr,"Bad compressed size: "+re+" != "+ye),Ne!=X&&ct(gr,"Bad uncompressed size: "+X+" != "+Ne),_m(ee,et,jt,{unsafe:!0,mt:ke})}function tr(V,re){var X=re||{},ee=[],se=[],ae=Ce(1),be=X.compression?8:0,ke=0,ve=0,ye=0,Ne=0,ze=0,qe=V.FullPaths[0],et=qe,$e=V.FileIndex[0],Ze=[],jt=0;for(ve=1;ve<V.FullPaths.length;++ve)if(et=V.FullPaths[ve].slice(qe.length),$e=V.FileIndex[ve],!(!$e.size||!$e.content||et=="Sh33tJ5")){var gr=Ne,vr=Ce(et.length);for(ye=0;ye<et.length;++ye)vr.write_shift(1,et.charCodeAt(ye)&127);vr=vr.slice(0,vr.l),Ze[ze]=A6.buf($e.content,0);var hs=$e.content;be==8&&(hs=K(hs)),ae=Ce(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,ke),ae.write_shift(2,be),$e.mt?i(ae,$e.mt):ae.write_shift(4,0),ae.write_shift(-4,Ze[ze]),ae.write_shift(4,hs.length),ae.write_shift(4,$e.content.length),ae.write_shift(2,vr.length),ae.write_shift(2,0),Ne+=ae.length,ee.push(ae),Ne+=vr.length,ee.push(vr),Ne+=hs.length,ee.push(hs),ae=Ce(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,ke),ae.write_shift(2,be),ae.write_shift(4,0),ae.write_shift(-4,Ze[ze]),ae.write_shift(4,hs.length),ae.write_shift(4,$e.content.length),ae.write_shift(2,vr.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,gr),jt+=ae.l,se.push(ae),jt+=vr.length,se.push(vr),++ze}return ae=Ce(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,ze),ae.write_shift(2,ze),ae.write_shift(4,jt),ae.write_shift(4,Ne),ae.write_shift(2,0),Zr([Zr(ee),Zr(se),ae])}var xr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function to(V,re){if(V.ctype)return V.ctype;var X=V.name||"",ee=X.match(/\.([^\.]+)$/);return ee&&xr[ee[1]]||re&&(ee=(X=re).match(/[\.\\]([^\.\\])+$/),ee&&xr[ee[1]])?xr[ee[1]]:"application/octet-stream"}function ro(V){for(var re=Bl(V),X=[],ee=0;ee<re.length;ee+=76)X.push(re.slice(ee,ee+76));return X.join(`\r
`)+`\r
`}function Z_(V){var re=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var Ne=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],ee=re.split(`\r
`),se=0;se<ee.length;++se){var ae=ee[se];if(ae.length==0){X.push("");continue}for(var be=0;be<ae.length;){var ke=76,ve=ae.slice(be,be+ke);ve.charAt(ke-1)=="="?ke--:ve.charAt(ke-2)=="="?ke-=2:ve.charAt(ke-3)=="="&&(ke-=3),ve=ae.slice(be,be+ke),be+=ke,be<ae.length&&(ve+="="),X.push(ve)}}return X.join(`\r
`)}function Q_(V){for(var re=[],X=0;X<V.length;++X){for(var ee=V[X];X<=V.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+V[++X];re.push(ee)}for(var se=0;se<re.length;++se)re[se]=re[se].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return Xs(re.join(`\r
`))}function e5(V,re,X){for(var ee="",se="",ae="",be,ke=0;ke<10;++ke){var ve=re[ke];if(!ve||ve.match(/^\s*$/))break;var ye=ve.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":ee=ye[2].trim();break;case"content-type":ae=ye[2].trim();break;case"content-transfer-encoding":se=ye[2].trim();break}}switch(++ke,se.toLowerCase()){case"base64":be=Xs(ta(re.slice(ke).join("")));break;case"quoted-printable":be=Q_(re.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var Ne=_m(V,ee.slice(X.length),be,{unsafe:!0});ae&&(Ne.ctype=ae)}function t5(V,re){if(U(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=re&&re.root||"",ee=(Tt&&Buffer.isBuffer(V)?V.toString("binary"):U(V)).split(`\r
`),se=0,ae="";for(se=0;se<ee.length;++se)if(ae=ee[se],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),X||(X=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),ae.slice(0,X.length)!=X););var be=(ee[1]||"").match(/boundary="(.*?)"/);if(!be)throw new Error("MAD cannot find boundary");var ke="--"+(be[1]||""),ve=[],ye=[],Ne={FileIndex:ve,FullPaths:ye};N(Ne);var ze,qe=0;for(se=0;se<ee.length;++se){var et=ee[se];et!==ke&&et!==ke+"--"||(qe++&&e5(Ne,ee.slice(ze,se),X),ze=se)}return Ne}function r5(V,re){var X=re||{},ee=X.boundary||"SheetJS";ee="------="+ee;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],ae=V.FullPaths[0],be=ae,ke=V.FileIndex[0],ve=1;ve<V.FullPaths.length;++ve)if(be=V.FullPaths[ve].slice(ae.length),ke=V.FileIndex[ve],!(!ke.size||!ke.content||be=="Sh33tJ5")){be=be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(jt){return"_x"+jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(jt){return"_u"+jt.charCodeAt(0).toString(16)+"_"});for(var ye=ke.content,Ne=Tt&&Buffer.isBuffer(ye)?ye.toString("binary"):U(ye),ze=0,qe=Math.min(1024,Ne.length),et=0,$e=0;$e<=qe;++$e)(et=Ne.charCodeAt($e))>=32&&et<128&&++ze;var Ze=ze>=qe*4/5;se.push(ee),se.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+be),se.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),se.push("Content-Type: "+to(ke,be)),se.push(""),se.push(Ze?Z_(Ne):ro(Ne))}return se.push(ee+`--\r
`),se.join(`\r
`)}function s5(V){var re={};return N(re,V),re}function _m(V,re,X,ee){var se=ee&&ee.unsafe;se||N(V);var ae=!se&&mt.find(V,re);if(!ae){var be=V.FullPaths[0];re.slice(0,be.length)==be?be=re:(be.slice(-1)!="/"&&(be+="/"),be=(be+re).replace("//","/")),ae={name:n(re),type:2},V.FileIndex.push(ae),V.FullPaths.push(be),se||mt.utils.cfb_gc(V)}return ae.content=X,ae.size=X?X.length:0,ee&&(ee.CLSID&&(ae.clsid=ee.CLSID),ee.mt&&(ae.mt=ee.mt),ee.ct&&(ae.ct=ee.ct)),ae}function a5(V,re){N(V);var X=mt.find(V,re);if(X){for(var ee=0;ee<V.FileIndex.length;++ee)if(V.FileIndex[ee]==X)return V.FileIndex.splice(ee,1),V.FullPaths.splice(ee,1),!0}return!1}function n5(V,re,X){N(V);var ee=mt.find(V,re);if(ee){for(var se=0;se<V.FileIndex.length;++se)if(V.FileIndex[se]==ee)return V.FileIndex[se].name=n(X),V.FullPaths[se]=X,!0}return!1}function i5(V){T(V,!0)}return t.find=k,t.read=w,t.parse=d,t.write=le,t.writeFile=Q,t.utils={cfb_new:s5,cfb_add:_m,cfb_del:a5,cfb_mov:n5,cfb_gc:i5,ReadShift:wl,CheckField:VS,prep_blob:cs,bconcat:Zr,use_zlib:P,_deflateRaw:me,_inflateRaw:st,consts:Z},t})();function k6(e){return typeof e=="string"?Wu(e):Array.isArray(e)?t6(e):e}function bc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?Va(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([k6(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Kn(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function _6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Cr(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function J1(e,t){for(var r=[],s=Cr(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function Vu(e){for(var t=[],r=Cr(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Gu(e){for(var t=[],r=Cr(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function I6(e){for(var t=[],r=Cr(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var zd=new Date(1899,11,30,0,0,0);function Wr(e,t){var r=e.getTime(),s=zd.getTime()+(e.getTimezoneOffset()-zd.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var SS=new Date,P6=zd.getTime()+(SS.getTimezoneOffset()-zd.getTimezoneOffset())*6e4,Z1=SS.getTimezoneOffset();function qu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+P6),t.getTimezoneOffset()!==Z1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Z1)*6e4),t}function D6(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var Q1=new Date("2017-02-19T19:06:09.000Z"),ES=isNaN(Q1.getFullYear())?new Date("2/19/17"):Q1,O6=ES.getFullYear()==2017;function cr(e,t){var r=new Date(e);if(O6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ES.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function _i(e,t){if(Tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Va(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Va(mS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Va(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Va(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dr(e[r]));return t}function Er(e,t){for(var r="";r.length<t;)r+=e;return r}function Fa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var R6=["january","february","march","april","may","june","july","august","september","october","november","december"];function So(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&R6.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var F6=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var i=r.split(s),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}})();function TS(e){return e?e.content&&e.type?_i(e.content,!0):e.data?xl(e.data):e.asNodeBuffer&&Tt?xl(e.asNodeBuffer().toString("binary")):e.asBinary?xl(e.asBinary()):e._data&&e._data.getContent?xl(_i(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function CS(e){if(!e)return null;if(e.data)return $1(e.data);if(e.asNodeBuffer&&Tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?$1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function L6(e){return e&&e.name.slice(-4)===".bin"?CS(e):TS(e)}function pa(e,t){for(var r=e.FullPaths||Cr(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Lx(e,t){var r=pa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Or(e,t,r){if(!r)return L6(Lx(e,t));if(!t)return null;try{return Or(e,t)}catch{return null}}function Js(e,t,r){if(!r)return TS(Lx(e,t));if(!t)return null;try{return Js(e,t)}catch{return null}}function M6(e,t,r){return CS(Lx(e,t))}function eb(e){for(var t=e.FullPaths||Cr(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function St(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Tt?s=yn(r):s=r6(r),mt.utils.cfb_add(e,t,s)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Mx(){return mt.utils.cfb_new()}function AS(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function vl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ir=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,z6=/<[^>]*>/g,Ts=Ir.match(tb)?tb:z6,$6=/<\w*:/,U6=/<(\/?)\w+:/;function gt(e,t,r){for(var s={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var o=e.match(B6),l=0,c="",u=0,d="",m="",f=1;if(o)for(u=0;u!=o.length;++u){for(m=o[u],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(d=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(f=(n=m.charCodeAt(i+1))==34||n==39?1:0,c=m.slice(i+1+f,m.length-f),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(s[h]&&d.slice(l-3,l)=="ext")continue;s[h]=c,s[h.toLowerCase()]=c}}return s}function Za(e){return e.replace(U6,"<$1")}var kS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bx=Vu(kS),Bt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(l,c){return kS[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}})(),zx=/[&<>'"]/g,W6=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){var t=e+"";return t.replace(zx,function(r){return Bx[r]}).replace(W6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function rb(e){return Jt(e).replace(/ /g,"_x0020_")}var _S=/[\u0000-\u001f]/g;function $x(e){var t=e+"";return t.replace(zx,function(r){return Bx[r]}).replace(/\n/g,"<br/>").replace(_S,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function H6(e){var t=e+"";return t.replace(zx,function(r){return Bx[r]}).replace(_S,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var sb=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function V6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function or(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bm(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function ab(e){var t=zn(2*e.length),r,s,n=1,i=0,o=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function nb(e){return yn(e,"binary").toString("utf8")}var Jc="foo bar baz",er=Tt&&(nb(Jc)==Bm(Jc)&&nb||ab(Jc)==Bm(Jc)&&ab)||Bm,Va=Tt?function(e){return yn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},$l=(function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),IS=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}})(),G6=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),q6=/<\/?(?:vt:)?variant>/g,K6=/<(?:vt:)([^>]*)>([\s\S]*)</;function ib(e,t){var r=gt(e),s=e.match(G6(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var o=i.replace(q6,"").match(K6);o&&n.push({v:er(o[2]),t:o[1]})}),n}var PS=/(^\s|\s$|\n)/;function us(e,t){return"<"+e+(t.match(PS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ul(e){return Cr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?Ul(r):"")+(t!=null?(t.match(PS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Y6(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Jt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",fp(e));throw new Error("Unable to serialize "+e)}function Ux(e){if(Tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return er(Kn(Ox(e)));throw new Error("Bad input format: expected Buffer or string")}var Wl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$r={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Hi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ks={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X6(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function J6(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=s?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var ob=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},lb=Tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:yn(t)})):ob(e)}:ob,cb=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(sn(e,n)));return s.join("").replace(Os,"")},Wx=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Os,""):cb(e,t,r)}:cb,db=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},DS=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):db(e,t,r)}:db,ub=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(lo(e,n)));return s.join("")},yc=Tt?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):ub(t,r,s)}:ub,OS=function(e,t){var r=Ys(e,t);return r>0?yc(e,t+4,t+4+r-1):""},RS=OS,FS=function(e,t){var r=Ys(e,t);return r>0?yc(e,t+4,t+4+r-1):""},LS=FS,MS=function(e,t){var r=2*Ys(e,t);return r>0?yc(e,t+4,t+4+r-1):""},BS=MS,zS=function(t,r){var s=Ys(t,r);return s>0?Wx(t,r+4,r+4+s):""},$S=zS,US=function(e,t){var r=Ys(e,t);return r>0?yc(e,t+4,t+4+r):""},WS=US,HS=function(e,t){return X6(e,t)},$d=HS,Hx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Tt&&(RS=function(t,r){if(!Buffer.isBuffer(t))return OS(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},LS=function(t,r){if(!Buffer.isBuffer(t))return FS(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},BS=function(t,r){if(!Buffer.isBuffer(t))return MS(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},$S=function(t,r){if(!Buffer.isBuffer(t))return zS(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},WS=function(t,r){if(!Buffer.isBuffer(t))return US(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},$d=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):HS(t,r)},Hx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var lo=function(e,t){return e[t]},sn=function(e,t){return e[t+1]*256+e[t]},Z6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ys=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ci=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Q6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function wl(e,t){var r="",s,n,i=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(sn(this,u)),u+=2;e*=2;break;case"utf8":r=yc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Wx(this,this.l,this.l+e);break;case"wstr":return wl.call(this,e,"dbcs");case"lpstr-ansi":r=RS(this,this.l),e=4+Ys(this,this.l);break;case"lpstr-cp":r=LS(this,this.l),e=4+Ys(this,this.l);break;case"lpwstr":r=BS(this,this.l),e=4+2*Ys(this,this.l);break;case"lpp4":e=4+Ys(this,this.l),r=$S(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ys(this,this.l),r=WS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=lo(this,this.l+e++))!==0;)i.push(Xc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=sn(this,this.l+e))!==0;)i.push(Xc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=lo(this,u),this.l=u+1,l=wl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Xc(sn(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=lo(this,u),this.l=u+1,l=wl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Xc(lo(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return s=lo(this,this.l),this.l++,s;case 2:return s=(t==="i"?Z6:sn)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?ci:Q6)(this,this.l),this.l+=4,s):(n=Ys(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=$d(this,this.l):n=$d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=DS(this,this.l,e);break}}return this.l+=e,r}var eR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},tR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},rR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function sR(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)rR(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,eR(this,t,this.l);break;case 8:if(s=8,r==="f"){J6(this,t,this.l);break}case 16:break;case-4:s=4,tR(this,t,this.l);break}return this.l+=s,this}function VS(e,t){var r=DS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cs(e,t){e.l=t,e.read_shift=wl,e.chk=VS,e.write_shift=sR}function Es(e,t){e.l+=t}function Ce(e){var t=zn(e);return cs(t,0),t}function jn(e,t,r){if(e){var s,n,i;cs(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=Yl[l]||Yl[65535];for(s=e.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,l))return}}}function Us(){var e=[],t=Tt?256:2048,r=function(u){var d=Ce(u);return cs(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},o=function(){return n(),Zr(e)},l=function(u){n(),s=u,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function Fe(e,t,r,s){var n=+t,i;if(!isNaN(n)){s||(s=Yl[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Hx(r)&&e.push(r)}}function Nl(e,t,r){var s=dr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function mb(e,t,r){var s=dr(e);return s.s=Nl(s.s,t.s,r),s.e=Nl(s.e,t.s,r),s}function Sl(e,t){if(e.cRel&&e.c<0)for(e=dr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=xt(e);return!e.cRel&&e.cRel!=null&&(r=iR(r)),!e.rRel&&e.rRel!=null&&(r=aR(r)),r}function zm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+br(e.s.c)+":"+(e.e.cRel?"":"$")+br(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_r(e.s.r)+":"+(e.e.rRel?"":"$")+_r(e.e.r):Sl(e.s,t.biff)+":"+Sl(e.e,t.biff)}function Vx(e){return parseInt(nR(e),10)-1}function _r(e){return""+(e+1)}function aR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nR(e){return e.replace(/\$(\d+)$/,"$1")}function Gx(e){for(var t=oR(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function br(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function iR(e){return e.replace(/^([A-Z])/,"$$$1")}function oR(e){return e.replace(/^\$([A-Z])/,"$1")}function lR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function xt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ws(e){var t=e.indexOf(":");return t==-1?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,t)),e:yr(e.slice(t+1))}}function Nt(e,t){return typeof t>"u"||typeof t=="number"?Nt(e.s,e.e):(typeof e!="string"&&(e=xt(e)),typeof t!="string"&&(t=xt(t)),e==t?e:e+":"+t)}function zt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function fb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=wa(e.z,r?Wr(t):t)}catch{}try{return e.w=wa((e.XF||{}).numFmtId||(r?14:0),r?Wr(t):t)}catch{return""+t}}function pn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?wn[e.v]||e.v:t==null?fb(e,e.v):fb(e,t))}function Yn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function GS(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?yr(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=zt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var h={v:t[m][f]},x=o+m,p=l+f;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))h=t[m][f];else if(Array.isArray(h.v)&&(h.f=t[m][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(s.nullError)h.t="e",h.v=0;else if(s.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=s.dateNF||pt[14],s.cellDates?(h.t="d",h.w=wa(h.z,Wr(h.v))):(h.t="n",h.v=Wr(h.v),h.w=wa(h.z,h.v))):h.t="s";if(n)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(h.z=i[x][p].z),i[x][p]=h;else{var g=xt({c:p,r:x});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return u.s.c<1e7&&(i["!ref"]=Nt(u)),i}function Uo(e,t){return GS(null,e,t)}function cR(e){return e.read_shift(4,"i")}function La(e,t){return t||(t=Ce(4)),t.write_shift(4,e),t}function Ns(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qr(e,t){var r=!1;return t==null&&(r=!0,t=Ce(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dR(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function uR(e,t){return t||(t=Ce(4)),t.write_shift(2,0),t.write_shift(2,0),t}function qx(e,t){var r=e.l,s=e.read_shift(1),n=Ns(e),i=[],o={t:n,h:n};if((s&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(dR(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function mR(e,t){var r=!1;return t==null&&(r=!0,t=Ce(15+4*e.t.length)),t.write_shift(1,0),Qr(e.t,t),r?t.slice(0,t.l):t}var fR=qx;function hR(e,t){var r=!1;return t==null&&(r=!0,t=Ce(23+4*e.t.length)),t.write_shift(1,1),Qr(e.t,t),t.write_shift(4,1),uR({},t),r?t.slice(0,t.l):t}function Ea(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vi(e,t){return t==null&&(t=Ce(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Gi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function qi(e,t){return t==null&&(t=Ce(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var pR=Ns,qS=Qr;function Kx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ud(e,t){var r=!1;return t==null&&(r=!0,t=Ce(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var xR=Ns,hp=Kx,Yx=Ud;function Xx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?$d([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ci(t,0)>>2;return r?n/100:n}function KS(e,t){t==null&&(t=Ce(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function YS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function gR(e,t){return t||(t=Ce(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ki=YS,Wo=gR;function ws(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ii(e,t){return(t||Ce(8)).write_shift(8,e,"f")}function vR(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=vi[n];u&&(t.rgb=Vl(u));break;case 2:t.rgb=Vl([o,l,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Wd(e,t){if(t||(t=Ce(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function bR(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function yR(e,t){t||(t=Ce(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function XS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function jR(e){return XS(e,1)}function wR(e){return XS(e,2)}var Jx=2,Fs=3,Zc=11,hb=12,Hd=19,Qc=64,NR=65,SR=71,ER=4108,TR=4126,Kr=80,JS=81,CR=[Kr,JS],pp={1:{n:"CodePage",t:Jx},2:{n:"Category",t:Kr},3:{n:"PresentationFormat",t:Kr},4:{n:"ByteCount",t:Fs},5:{n:"LineCount",t:Fs},6:{n:"ParagraphCount",t:Fs},7:{n:"SlideCount",t:Fs},8:{n:"NoteCount",t:Fs},9:{n:"HiddenCount",t:Fs},10:{n:"MultimediaClipCount",t:Fs},11:{n:"ScaleCrop",t:Zc},12:{n:"HeadingPairs",t:ER},13:{n:"TitlesOfParts",t:TR},14:{n:"Manager",t:Kr},15:{n:"Company",t:Kr},16:{n:"LinksUpToDate",t:Zc},17:{n:"CharacterCount",t:Fs},19:{n:"SharedDoc",t:Zc},22:{n:"HyperlinksChanged",t:Zc},23:{n:"AppVersion",t:Fs,p:"version"},24:{n:"DigSig",t:NR},26:{n:"ContentType",t:Kr},27:{n:"ContentStatus",t:Kr},28:{n:"Language",t:Kr},29:{n:"Version",t:Kr},255:{},2147483648:{n:"Locale",t:Hd},2147483651:{n:"Behavior",t:Hd},1919054434:{}},xp={1:{n:"CodePage",t:Jx},2:{n:"Title",t:Kr},3:{n:"Subject",t:Kr},4:{n:"Author",t:Kr},5:{n:"Keywords",t:Kr},6:{n:"Comments",t:Kr},7:{n:"Template",t:Kr},8:{n:"LastAuthor",t:Kr},9:{n:"RevNumber",t:Kr},10:{n:"EditTime",t:Qc},11:{n:"LastPrinted",t:Qc},12:{n:"CreatedDate",t:Qc},13:{n:"ModifiedDate",t:Qc},14:{n:"PageCount",t:Fs},15:{n:"WordCount",t:Fs},16:{n:"CharCount",t:Fs},17:{n:"Thumbnail",t:SR},18:{n:"Application",t:Kr},19:{n:"DocSecurity",t:Fs},255:{},2147483648:{n:"Locale",t:Hd},2147483651:{n:"Behavior",t:Hd},1919054434:{}},pb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AR=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function kR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _R=kR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vi=dr(_R),wn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ed={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IR(e){var t=Zx();if(!e||!e.match)return t;var r={};if((e.match(Ts)||[]).forEach(function(s){var n=gt(s);switch(n[0].replace($6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[gp[n.ContentType]]!==void 0&&t[gp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==$r.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function QS(e,t){var r=I6(gp),s=[],n;s[s.length]=Ir,s[s.length]=Ue("Types",null,{xmlns:$r.CT,"xmlns:xsd":$r.xsd,"xmlns:xsi":$r.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ue("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=Ue("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ed[c][t.bookType]||ed[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){s[s.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ed[c][t.bookType]||ed[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){s[s.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Hl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function El(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Ts)||[]).forEach(function(n){var i=gt(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:vl(i.Target,t);r[l]=o,s[i.Id]=o}}),r["!id"]=s,r}function fo(e){var t=[Ir,Ue("Relationships",null,{xmlns:$r.RELS})];return Cr(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Yt(e,t,r,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Ct.HLINK,Ct.XPATH,Ct.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var PR="application/vnd.oasis.opendocument.spreadsheet";function DR(e,t){for(var r=Ux(e),s,n;s=Wl.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=gt(s[0],!1),n.path=="/"&&n.type!==PR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function OR(e){var t=[Ir];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function xb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function RR(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function FR(e){var t=[Ir];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(xb(e[r][0],e[r][1])),t.push(RR("",e[r][0]));return t.push(xb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function eE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fd.version+"</meta:generator></office:meta></office:document-meta>"}var ja=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],LR=(function(){for(var e=new Array(ja.length),t=0;t<ja.length;++t){var r=ja[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function tE(e){var t={};e=er(e);for(var r=0;r<ja.length;++r){var s=ja[r],n=e.match(LR[r]);n!=null&&n.length>0&&(t[s[1]]=Bt(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=cr(t[s[1]]))}return t}function $m(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Jt(t),s[s.length]=r?Ue(e,t,r):us(e,t))}function rE(e,t){var r=t||{},s=[Ir,Ue("cp:coreProperties",null,{"xmlns:cp":$r.CORE_PROPS,"xmlns:dc":$r.dc,"xmlns:dcterms":$r.dcterms,"xmlns:dcmitype":$r.dcmitype,"xmlns:xsi":$r.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&$m("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&$m("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=ja.length;++i){var o=ja[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&$m(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var bi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function aE(e,t,r,s){var n=[];if(typeof e=="string")n=ib(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?ib(t,s).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function MR(e,t,r){var s={};return t||(t={}),e=er(e),bi.forEach(function(n){var i=(e.match($l(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Bt(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(s[n[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&aE(s.HeadingPairs,s.TitlesOfParts,t,r),t}function nE(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=Ir,t[t.length]=Ue("Properties",null,{xmlns:$r.EXT_PROPS,"xmlns:vt":$r.vt}),bi.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Jt(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Jt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var BR=/<[^>]+>[^<]*/g;function zR(e,t){var r={},s="",n=e.match(BR);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=gt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Bt(l.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=Bt(d);break;case"bool":r[s]=or(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=cr(d);break;case"cy":case"error":r[s]=Bt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function iE(e){var t=[Ir,Ue("Properties",null,{xmlns:$r.CUST_PROPS,"xmlns:vt":$r.vt})];if(!e)return t.join("");var r=1;return Cr(e).forEach(function(n){++r,t[t.length]=Ue("property",Y6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Um;function $R(e,t,r){Um||(Um=Vu(vp)),t=Um[t]||t,e[t]=r}function UR(e,t){var r=[];return Cr(vp).map(function(s){for(var n=0;n<ja.length;++n)if(ja[n][1]==s)return ja[n];for(n=0;n<bi.length;++n)if(bi[n][1]==s)return bi[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(us(vp[s[1]]||s[1],n))}}),Ue("DocumentProperties",r.join(""),{xmlns:Ks.o})}function WR(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Cr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<ja.length;++o)if(i==ja[o][1])return;for(o=0;o<bi.length;++o)if(i==bi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(Ue(rb(i),l,{"dt:dt":c}))}}),t&&Cr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Ue(rb(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Ks.o+'">'+n.join("")+"</"+s+">"}function Qx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function HR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=Ce(8);return o.write_shift(4,s),o.write_shift(4,n),o}function oE(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function lE(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function cE(e,t,r){return t===31?lE(e):oE(e,t,r)}function bp(e,t,r){return cE(e,t,r===!1?0:4)}function VR(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return cE(e,t,0)}function GR(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(Os,""),e.l-n&2&&(e.l+=2)}return r}function qR(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(Os,"");return r}function KR(e){var t=e.l,r=Vd(e,JS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Vd(e,Fs);return[r,s]}function YR(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(KR(e));return r}function gb(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);s[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Os,"").replace(gl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function dE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function XR(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vd(e,t,r){var s=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==hb&&s!==t&&CR.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===hb?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return oE(e,s,4).replace(Os,"");case 31:return lE(e);case 64:return Qx(e);case 65:return dE(e);case 71:return XR(e);case 80:return bp(e,s,!i.raw).replace(Os,"");case 81:return VR(e,s).replace(Os,"");case 4108:return YR(e);case 4126:case 4127:return s==4127?GR(e):qR(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function vb(e,t){var r=Ce(4),s=Ce(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=Ce(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=HR(t);break;case 31:case 80:for(s=Ce(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Zr([r,s])}function bb(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0,l=0,c=-1,u={};for(o=0;o!=n;++o){var d=e.read_shift(4),m=e.read_shift(4);i[o]=[d,m+r]}i.sort(function(y,j){return y[1]-j[1]});var f={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(f[x.n]=Vd(e,x.t,{raw:!0}),x.p==="version"&&(f[x.n]=String(f[x.n]>>16)+"."+("0000"+String(f[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(f[x.n]){case 0:f[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Da(l=f[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[x.n])}}else if(i[o][0]===1){if(l=f.CodePage=Vd(e,Jx),Da(l),c!==-1){var p=e.l;e.l=i[c][1],u=gb(e,l),e.l=p}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}u=gb(e,l)}else{var g=u[i[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=dE(e);break;case 30:e.l+=4,b=bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Ar(e,4);break;case 64:e.l+=4,b=cr(Qx(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=b}}return e.l=r+s,f}var uE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function yb(e,t,r){var s=Ce(8),n=[],i=[],o=8,l=0,c=Ce(8),u=Ce(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),n.push(u),o+=8+c.length,!t){u=Ce(8),u.write_shift(4,0),n.unshift(u);var d=[Ce(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=Ce(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Zr(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(uE.indexOf(e[l][0])>-1||sE.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],h=0;if(t){h=+t[e[l][0]];var x=r[h];if(x.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=vb(x.t,f)}else{var g=JR(f);g==-1&&(g=31,f=String(f)),c=vb(g,f)}i.push(c),u=Ce(8),u.write_shift(4,t?h:2+l),n.push(u),o+=8+c.length}var b=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,b),b+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),Zr([s].concat(n).concat(i))}function jb(e,t,r){var s=e.content;if(!s)return{};cs(s,0);var n,i,o,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==mt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(o=s.read_shift(16),c=s.read_shift(4));var m=bb(s,t),f={SystemIdentifier:u};for(var h in m)f[h]=m[h];if(f.FMTID=i,n===1)return f;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var x;try{x=bb(s,null)}catch{}for(h in x)f[h]=x[h];return f.FMTID=[i,o],f}function wb(e,t,r,s,n,i){var o=Ce(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=yb(e,r,s);if(l.push(c),n){var u=yb(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Zr(l)}function In(e,t){return e.read_shift(t),null}function ZR(e,t){t||(t=Ce(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function QR(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Ar(e,t){return e.read_shift(t)===1}function ks(e,t){return t||(t=Ce(2)),t.write_shift(2,+!!e),t}function Rr(e){return e.read_shift(2,"u")}function xa(e,t){return t||(t=Ce(2)),t.write_shift(2,e),t}function mE(e,t){return QR(e,t,Rr)}function e8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function fE(e,t,r){return r||(r=Ce(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function jc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?e.read_shift(s,n):"";return o}function t8(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,i=1+(r&1),o=0,l,c={};n&&(o=e.read_shift(2)),s&&(l=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*o),s&&(e.l+=l),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function r8(e){var t=e.t||"",r=Ce(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=Ce(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return Zr(n)}function Pi(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function wc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Pi(e,s,r)}function Yi(e,t,r){if(r.biff>5)return wc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function hE(e,t,r){return r||(r=Ce(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function s8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function a8(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(Os,"");return s&&(e.l+=24),n}function n8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Os,"");return r+o}function i8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return a8(e);case"0303000000000000c000000000000046":return n8(e);default:throw new Error("Unsupported Moniker "+r)}}function td(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Os,""):"";return r}function Nb(e,t){t||(t=Ce(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function o8(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,o,l,c,u="",d,m;n&16&&(i=td(e,r-e.l)),n&128&&(o=td(e,r-e.l)),(n&257)===257&&(l=td(e,r-e.l)),(n&257)===1&&(c=i8(e,r-e.l)),n&8&&(u=td(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(m=Qx(e)),e.l=r;var f=o||l||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return d&&(h.guid=d),m&&(h.time=m),i&&(h.Tooltip=i),h}function l8(e){var t=Ce(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)s=s.slice(1),Nb(s,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Nb(n>-1?s.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function pE(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function xE(e,t){var r=pE(e);return r[3]=0,r}function Qa(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function Di(e,t,r,s){return s||(s=Ce(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function c8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function d8(e,t,r){return t===0?"":Yi(e,t,r)}function u8(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[n,i,o]}function gE(e){var t=e.read_shift(2),r=Xx(e);return[t,r]}function m8(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=jc(e,t,r),i=e.read_shift(2);if(s-=e.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}function Ku(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function vE(e,t){return t||(t=Ce(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bE(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var f8=bE;function yE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function h8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function p8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ps(e){e.l+=2,e.l+=e.read_shift(2)}var x8={0:ps,4:ps,5:ps,6:ps,7:p8,8:ps,9:ps,10:ps,11:ps,12:ps,13:h8,14:ps,15:ps,16:ps,17:ps,18:ps,19:ps,20:ps,21:yE};function g8(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(x8[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function rd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function eg(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ce(n);return i.write_shift(2,s),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function v8(e,t){return t===0||e.read_shift(2),1200}function b8(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=Yi(e,0,r);return e.read_shift(t+s-e.l),n}function y8(e,t){var r=!t||t.biff==8,s=Ce(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function j8(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function w8(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=jc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:s,hs:n,dt:i,name:o}}function N8(e,t){var r=!t||t.biff>=8?2:1,s=Ce(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function S8(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(t8(e));return i.Count=s,i.Unique=n,i}function E8(e,t){var r=Ce(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=r8(e[n]);var i=Zr([r].concat(s));return i.parts=[r.length].concat(s.map(function(o){return o.length})),i}function T8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function C8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function A8(e){var t=c8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function k8(e){return e.read_shift(2),e.read_shift(4)}function Sb(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function _8(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function I8(){var e=Ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function P8(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function D8(e){var t=Ce(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function O8(){}function R8(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=jc(e,0,r),s}function F8(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,i=Ce(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function L8(e){var t=Qa(e);return t.isst=e.read_shift(4),t}function M8(e,t,r,s){var n=Ce(10);return Di(e,t,s,n),n.write_shift(4,r),n}function B8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=Qa(e);r.biff==2&&e.l++;var i=wc(e,s-e.l,r);return n.val=i,n}function z8(e,t,r,s,n){var i=!n||n.biff==8,o=Ce(8+ +i+(1+i)*r.length);return Di(e,t,s,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function $8(e,t,r){var s=e.read_shift(2),n=Yi(e,0,r);return[s,n]}function U8(e,t,r,s){var n=r&&r.biff==5;s||(s=Ce(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}var W8=Yi;function Eb(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:i,c:l},e:{r:o,c}}}function H8(e,t){var r=t.biff==8||!t.biff?4:2,s=Ce(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function V8(e){var t=e.read_shift(2),r=e.read_shift(2),s=gE(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function G8(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(gE(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:o,rkrec:i}}function q8(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:o,ixfe:i}}function K8(e,t,r,s){var n={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=AR[l>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function Y8(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=K8(e,t,s.fStyle,r),s}function Tb(e,t,r,s){var n=r&&r.biff==5;s||(s=Ce(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function X8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function J8(e){var t=Ce(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Cb(e,t,r){var s=Qa(e);(r.biff==2||t==9)&&++e.l;var n=e8(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function Z8(e,t,r,s,n,i){var o=Ce(8);return Di(e,t,s,o),fE(r,i,o),o}function Q8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Qa(e),n=ws(e);return s.val=n,s}function eF(e,t,r,s){var n=Ce(14);return Di(e,t,s,n),Ii(r,n),n}var Ab=d8;function tF(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Pi(e,i),l=[];s>e.l;)l.push(wc(e));return[i,n,o,l]}function kb(e,t,r){var s=e.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=m8(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var rF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _b(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Pi(e,o,r);n&32&&(u=rF[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var m=s==e.l||l===0||!(d>0)?[]:gB(e,d,r,l);return{chKey:i,Name:u,itab:c,rgce:m}}function jE(e,t,r){if(r.biff<8)return sF(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(u8(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function sF(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=jc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function aF(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),i=Pi(e,s,r),o=Pi(e,n,r);return[i,o]}function nF(e,t,r){var s=bE(e);e.l++;var n=e.read_shift(1);return t-=8,[vB(e,t,r),n,s]}function Ib(e,t,r){var s=f8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,pB(e,t,r)]}function iF(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function oF(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Yi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},l,o,i]}}function lF(e,t,r){return oF(e,t,r)}function cF(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(Ku(e));return r}function dF(e){var t=Ce(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)vE(e[r],t);return t}function uF(e,t,r){if(r&&r.biff<8)return fF(e,t,r);var s=yE(e),n=g8(e,t-22,s[1]);return{cmo:s,ft:n}}var mF={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function fF(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((mF[s]||Es)(e,t,r)),{cmo:[n,s,i],ft:o}}function hF(e,t,r){var s=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=s8(e,6,r);var l=e.read_shift(2);e.read_shift(2),Rr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],m=Pi(e,e.lens[u+1]-e.lens[u]-1);if(n+=m,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function pF(e,t){var r=Ku(e);e.l+=16;var s=o8(e,t-24);return[r,s]}function xF(e){var t=Ce(24),r=yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return Zr([t,l8(e[1])])}function gF(e,t){e.read_shift(2);var r=Ku(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(Os,""),[r,s]}function vF(e){var t=e[1].Tooltip,r=Ce(10+2*(t.length+1));r.write_shift(2,2048);var s=yr(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function bF(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=pb[r]||r,r=e.read_shift(2),t[1]=pb[r]||r,t}function yF(e){return e||(e=Ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function jF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xE(e));return r}function wF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xE(e));return r}function NF(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function wE(e,t,r){if(!r.cellStyles)return Es(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function SF(e,t){var r=Ce(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function EF(e,t){var r={};return t<32||(e.l+=16,r.header=ws(e),r.footer=ws(e),e.l+=2),r}function TF(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function CF(e){for(var t=Ce(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var AF=Qa,kF=mE,_F=wc;function IF(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function PF(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Qa(e);++e.l;var n=Yi(e,t-7,r);return s.t="str",s.val=n,s}function DF(e){var t=Qa(e);++e.l;var r=ws(e);return t.t="n",t.val=r,t}function OF(e,t,r){var s=Ce(15);return Tc(s,e,t),s.write_shift(8,r,"f"),s}function RF(e){var t=Qa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function FF(e,t,r){var s=Ce(9);return Tc(s,e,t),s.write_shift(2,r),s}function LF(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function MF(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function BF(e,t,r){var s=e.l+t,n=Qa(e),i=e.read_shift(2),o=Pi(e,i,r);return e.l=s,n.t="str",n.val=o,n}var zF=[2,3,48,49,131,139,140,245],yp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=zn(1);switch(c.type){case"base64":d=Xs(ta(l));break;case"binary":d=Xs(l);break;case"buffer":case"array":d=l;break}cs(d,0);var m=d.read_shift(1),f=!!(m&136),h=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var p=0,g=521;m==2&&(p=d.read_shift(2)),d.l+=3,m!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),m!=2&&(g=d.read_shift(2));var b=d.read_shift(2),y=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var j=[],S={},E=Math.min(d.length,m==2?521:g-10-(h?264:0)),w=x?32:11;d.l<E&&d[d.l]!=13;)switch(S={},S.name=Ml.utils.decode(y,d.slice(d.l,d.l+w)).replace(/[\u0000\r\n].*$/g,""),d.l+=w,S.type=String.fromCharCode(d.read_shift(1)),m!=2&&!x&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),m==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&j.push(S),m!=2&&(d.l+=x?13:14),S.type){case"B":(!h||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var N=0,C=0;for(u[0]=[],C=0;C!=j.length;++C)u[0][C]=j[C].name;for(;p-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++N]=[],C=0,C=0;C!=j.length;++C){var T=d.slice(d.l,d.l+j[C].len);d.l+=j[C].len,cs(T,0);var _=Ml.utils.decode(y,T);switch(j[C].type){case"C":_.trim().length&&(u[N][C]=_.replace(/\s+$/,""));break;case"D":_.length===8?u[N][C]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):u[N][C]=_;break;case"F":u[N][C]=parseFloat(_.trim());break;case"+":case"I":u[N][C]=x?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(_.trim().toUpperCase()){case"Y":case"T":u[N][C]=!0;break;case"N":case"F":u[N][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[N][C]="##MEMO##"+(x?parseInt(_.trim(),10):T.read_shift(4));break;case"N":_=_.replace(/\u0000/g,"").trim(),_&&_!="."&&(u[N][C]=+_||0);break;case"@":u[N][C]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[N][C]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[N][C]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][C]=-T.read_shift(-8,"f");break;case"B":if(h&&j[C].len==8){u[N][C]=T.read_shift(8,"f");break}case"G":case"P":T.l+=j[C].len;break;case"0":if(j[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[C].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=j,u}function s(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Uo(r(l,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function n(l,c){try{return Yn(s(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Da(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Us(),m=Kd(l,{header:1,raw:!0,cellDates:!0}),f=m[0],h=m.slice(1),x=l["!cols"]||[],p=0,g=0,b=0,y=1;for(p=0;p<f.length;++p){if(((x[p]||{}).DBF||{}).name){f[p]=x[p].DBF.name,++b;continue}if(f[p]!=null){if(++b,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(g=0;g<1024;++g)if(f.indexOf(f[p]+"_"+g)==-1){f[p]+="_"+g;break}}}}var j=zt(l["!ref"]),S=[],E=[],w=[];for(p=0;p<=j.e.c-j.s.c;++p){var N="",C="",T=0,_=[];for(g=0;g<h.length;++g)h[g][p]!=null&&_.push(h[g][p]);if(_.length==0||f[p]==null){S[p]="?";continue}for(g=0;g<_.length;++g){switch(typeof _[g]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=_[g]instanceof Date?"D":"C";break;default:C="C"}T=Math.max(T,String(_[g]).length),N=N&&N!=C?"C":C}T>250&&(T=250),C=((x[p]||{}).DBF||{}).type,C=="C"&&x[p].DBF.len>T&&(T=x[p].DBF.len),N=="B"&&C=="N"&&(N="N",w[p]=x[p].DBF.dec,T=x[p].DBF.len),E[p]=N=="C"||C=="N"?T:i[N]||0,y+=E[p],S[p]=N}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*b),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+t[uS]||3)<<8),p=0,g=0;p<f.length;++p)if(f[p]!=null){var I=d.next(32),L=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,L,"sbcs"),I.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),I.write_shift(4,g),I.write_shift(1,E[p]||i[S[p]]||0),I.write_shift(1,w[p]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),g+=E[p]||i[S[p]]||0}var D=d.next(264);for(D.write_shift(4,13),p=0;p<65;++p)D.write_shift(4,0);for(p=0;p<h.length;++p){var M=d.next(y);for(M.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(S[g]){case"L":M.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":M.write_shift(8,h[p][g]||0,"f");break;case"N":var q="0";for(typeof h[p][g]=="number"&&(q=h[p][g].toFixed(w[g]||0)),b=0;b<E[g]-q.length;++b)M.write_shift(1,32);M.write_shift(1,q,"sbcs");break;case"D":h[p][g]?(M.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(h[p][g]!=null?h[p][g]:"").slice(0,E[g]);for(M.write_shift(1,Z,"sbcs"),b=0;b<E[g]-Z.length;++b)M.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}})(),NE=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Cr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var x=e[h];return typeof x=="number"?U1(x):x},s=function(f,h,x){var p=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?f:U1(p)};e["|"]=254;function n(f,h){switch(h.type){case"base64":return i(ta(f),h);case"binary":return i(f,h);case"buffer":return i(Tt&&Buffer.isBuffer(f)?f.toString("binary"):Kn(f),h);case"array":return i(_i(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var x=f.split(/[\n\r]+/),p=-1,g=-1,b=0,y=0,j=[],S=[],E=null,w={},N=[],C=[],T=[],_=0,k;for(+h.codepage>=0&&Da(+h.codepage);b!==x.length;++b){_=0;var I=x[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),L=I.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),D=L[0],M;if(I.length>0)switch(D){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&S.push(I.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,Z=!1,Q=!1,U=!1,le=-1,Se=-1;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"A":break;case"X":g=parseInt(L[y].slice(1))-1,Z=!0;break;case"Y":for(p=parseInt(L[y].slice(1))-1,Z||(g=0),k=j.length;k<=p;++k)j[k]=[];break;case"K":M=L[y].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(Fa(M))?isNaN(So(M).getDate())||(M=cr(M)):(M=Fa(M),E!==null&&zo(E)&&(M=qu(M))),q=!0;break;case"E":U=!0;var P=ho(L[y].slice(1),{r:p,c:g});j[p][g]=[j[p][g],P];break;case"S":Q=!0,j[p][g]=[j[p][g],"S5S"];break;case"G":break;case"R":le=parseInt(L[y].slice(1))-1;break;case"C":Se=parseInt(L[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+I)}if(q&&(j[p][g]&&j[p][g].length==2?j[p][g][0]=M:j[p][g]=M,E=null),Q){if(U)throw new Error("SYLK shared formula cannot have own formula");var G=le>-1&&j[le][Se];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");j[p][g][1]=$E(G[1],{r:p-le,c:g-Se})}break;case"F":var K=0;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"X":g=parseInt(L[y].slice(1))-1,++K;break;case"Y":for(p=parseInt(L[y].slice(1))-1,k=j.length;k<=p;++k)j[k]=[];break;case"M":_=parseInt(L[y].slice(1))/20;break;case"F":break;case"G":break;case"P":E=S[parseInt(L[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=L[y].slice(1).split(" "),k=parseInt(T[0],10);k<=parseInt(T[1],10);++k)_=parseInt(T[2],10),C[k-1]=_===0?{hidden:!0}:{wch:_},$n(C[k-1]);break;case"C":g=parseInt(L[y].slice(1))-1,C[g]||(C[g]={});break;case"R":p=parseInt(L[y].slice(1))-1,N[p]||(N[p]={}),_>0?(N[p].hpt=_,N[p].hpx=To(_)):_===0&&(N[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+I)}K<1&&(E=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+I)}}return N.length>0&&(w["!rows"]=N),C.length>0&&(w["!cols"]=C),h&&h.sheetRows&&(j=j.slice(0,h.sheetRows)),[j,w]}function o(f,h){var x=n(f,h),p=x[0],g=x[1],b=Uo(p,h);return Cr(g).forEach(function(y){b[y]=g[y]}),b}function l(f,h){return Yn(o(f,h),h)}function c(f,h,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+ig(f.f,{r:x,c:p}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,h){h.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Gl(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ql(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,h){h.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Kl(x.hpx)+";"),g.length>2&&f.push(g+"R"+(p+1))})}function m(f,h){var x=["ID;PWXL;N;E"],p=[],g=zt(f["!ref"]),b,y=Array.isArray(f),j=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),f["!cols"]&&u(x,f["!cols"]),f["!rows"]&&d(x,f["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var E=g.s.c;E<=g.e.c;++E){var w=xt({r:S,c:E});b=y?(f[S]||[])[E]:f[w],!(!b||b.v==null&&(!b.f||b.F))&&p.push(c(b,f,S,E))}return x.join(j)+j+p.join(j)+j+"E"+j}return{to_workbook:l,to_sheet:o,from_sheet:m}})(),SE=(function(){function e(i,o){switch(o.type){case"base64":return t(ta(i),o);case"binary":return t(i,o);case"buffer":return t(Tt&&Buffer.isBuffer(i)?i.toString("binary"):Kn(i),o);case"array":return t(_i(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,u=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var f=l[d].trim().split(","),h=f[0],x=f[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){m[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?m[c][u]=!0:p==="FALSE"?m[c][u]=!1:isNaN(Fa(x))?isNaN(So(x).getDate())?m[c][u]=x:m[c][u]=cr(x):m[c][u]=Fa(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),m[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Uo(e(i,o),o)}function s(i,o){return Yn(r(i,o),o)}var n=(function(){var i=function(c,u,d,m,f){c.push(u),c.push(d+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=zt(c["!ref"]),m,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=xt({r:h,c:x});if(m=f?(c[h]||[])[x]:c[p],!m){o(u,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?o(u,1,0,"="+m.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=wa(m.z||pt[14],Wr(cr(m.v)))),o(u,0,m.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,y=u.join(b);return y}})();return{to_workbook:s,to_sheet:r,from_sheet:n}})(),EE=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var h=m.split(`
`),x=-1,p=-1,g=0,b=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var j=yr(y[1]);if(b.length<=j.r)for(x=b.length;x<=j.r;++x)b[x]||(b[x]=[]);switch(x=j.r,p=j.c,y[2]){case"t":b[x][p]=e(y[3]);break;case"v":b[x][p]=+y[3];break;case"vtf":var S=y[y.length-1];case"vtc":switch(y[3]){case"nl":b[x][p]=!!+y[4];break;default:b[x][p]=+y[4];break}y[2]=="vtf"&&(b[x][p]=[b[x][p],S])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function s(m,f){return Uo(r(m,f),f)}function n(m,f){return Yn(s(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var f=[],h=[],x,p="",g=Ws(m["!ref"]),b=Array.isArray(m),y=g.s.r;y<=g.e.r;++y)for(var j=g.s.c;j<=g.e.c;++j)if(p=xt({r:y,c:j}),x=b?(m[y]||[])[j]:m[p],!(!x||x.v==null||x.t==="z")){switch(h=["cell",p,"t"],x.t){case"s":case"str":h.push(t(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=t(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=Wr(cr(x.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=x.w||wa(x.z||pt[14],S);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(m){return[i,o,l,o,u(m),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}})(),Eo=(function(){function e(d,m,f,h,x){x.raw?m[f][h]=d:d===""||(d==="TRUE"?m[f][h]=!0:d==="FALSE"?m[f][h]=!1:isNaN(Fa(d))?isNaN(So(d).getDate())?m[f][h]=d:m[f][h]=cr(d):m[f][h]=Fa(d))}function t(d,m){var f=m||{},h=[];if(!d||d.length===0)return h;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,b=0,y=0;y<=p;++y)b=x[y].indexOf(" "),b==-1?b=x[y].length:b++,g=Math.max(g,b);for(y=0;y<=p;++y){h[y]=[];var j=0;for(e(x[y].slice(0,g).trim(),h,y,j,f),j=1;j<=(x[y].length-g)/10+1;++j)e(x[y].slice(g+(j-1)*10,g+j*10).trim(),h,y,j,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var m={},f=!1,h=0,x=0;h<d.length;++h)(x=d.charCodeAt(h))==34?f=!f:!f&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h]);if(!x.length){m=s;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h])}return x.sort(function(p,g){return p[0]-g[0]||s[p[1]]-s[g[1]]}),r[x.pop()[1]]||44}function i(d,m){var f=m||{},h="",x=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=n(d.slice(0,1024)):f&&f.FS?h=f.FS:h=n(d.slice(0,1024));var g=0,b=0,y=0,j=0,S=0,E=h.charCodeAt(0),w=!1,N=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?T6(f.dateNF):null;function _(){var k=d.slice(j,S),I={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)I.t="z";else if(f.raw)I.t="s",I.v=k;else if(k.trim().length===0)I.t="s",I.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(I.t="s",I.v=k.slice(2,-1).replace(/""/g,'"')):t7(k)?(I.t="n",I.f=k.slice(1)):(I.t="s",I.v=k);else if(k=="TRUE")I.t="b",I.v=!0;else if(k=="FALSE")I.t="b",I.v=!1;else if(!isNaN(y=Fa(k)))I.t="n",f.cellText!==!1&&(I.w=k),I.v=y;else if(!isNaN(So(k).getDate())||T&&k.match(T)){I.z=f.dateNF||pt[14];var L=0;T&&k.match(T)&&(k=C6(k,f.dateNF,k.match(T)||[]),L=1),f.cellDates?(I.t="d",I.v=cr(k,L)):(I.t="n",I.v=Wr(cr(k,L))),f.cellText!==!1&&(I.w=wa(I.z,I.v instanceof Date?Wr(I.v):I.v)),f.cellNF||delete I.z}else I.t="s",I.v=k;if(I.t=="z"||(f.dense?(x[g]||(x[g]=[]),x[g][b]=I):x[xt({c:b,r:g})]=I),j=S+1,C=d.charCodeAt(j),p.e.c<b&&(p.e.c=b),p.e.r<g&&(p.e.r=g),N==E)++b;else if(b=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;S<d.length;++S)switch(N=d.charCodeAt(S)){case 34:C===34&&(w=!w);break;case E:case 10:case 13:if(!w&&_())break e;break}return S-j>0&&_(),x["!ref"]=Nt(p),x}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):Uo(t(d,m),m)}function l(d,m){var f="",h=m.type=="string"?[0,0,0,0]:hg(d,m);switch(m.type){case"base64":f=ta(d);break;case"binary":f=d;break;case"buffer":m.codepage==65001?f=d.toString("utf8"):m.codepage&&typeof Ml<"u"||(f=Tt&&Buffer.isBuffer(d)?d.toString("binary"):Kn(d));break;case"array":f=_i(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=er(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=er(f):m.type=="binary"&&typeof Ml<"u",f.slice(0,19)=="socialcalc:version:"?EE.to_sheet(m.type=="string"?f:er(f),m):o(f,m)}function c(d,m){return Yn(l(d,m),m)}function u(d){for(var m=[],f=zt(d["!ref"]),h,x=Array.isArray(d),p=f.s.r;p<=f.e.r;++p){for(var g=[],b=f.s.c;b<=f.e.c;++b){var y=xt({r:p,c:b});if(h=x?(d[p]||[])[b]:d[y],!h||h.v==null){g.push("          ");continue}for(var j=(h.w||(pn(h),h.w)||"").slice(0,10);j.length<10;)j+=" ";g.push(j+(b===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}})();function $F(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=NE.to_workbook(e,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return Eo.to_workbook(e,t)}}var yi=(function(){function e(P,G,K){if(P){cs(P,P.l||0);for(var O=K.Enum||le;P.l<P.length;){var F=P.read_shift(2),H=O[F]||O[65535],Y=P.read_shift(2),te=P.l+Y,pe=H.f&&H.f(P,Y,K);if(P.l=te,G(pe,H,F))return}}}function t(P,G){switch(G.type){case"base64":return r(Xs(ta(P)),G);case"binary":return r(Xs(P),G);case"buffer":case"array":return r(P,G)}throw"Unsupported type "+G.type}function r(P,G){if(!P)return P;var K=G||{},O=K.dense?[]:{},F="Sheet1",H="",Y=0,te={},pe=[],we=[],B={s:{r:0,c:0},e:{r:0,c:0}},Be=K.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)K.Enum=le,e(P,function(ue,Ie,Le){switch(Le){case 0:K.vers=ue,ue>=4096&&(K.qpro=!0);break;case 6:B=ue;break;case 204:ue&&(H=ue);break;case 222:H=ue;break;case 15:case 51:K.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:Le==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=K.dateNF||pt[14],K.cellDates&&(ue[1].t="d",ue[1].v=qu(ue[1].v))),K.qpro&&ue[3]>Y&&(O["!ref"]=Nt(B),te[F]=O,pe.push(F),O=K.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Y=ue[3],F=H||"Sheet"+(Y+1),H="");var he=K.dense?(O[ue[0].r]||[])[ue[0].c]:O[xt(ue[0])];if(he){he.t=ue[1].t,he.v=ue[1].v,ue[1].z!=null&&(he.z=ue[1].z),ue[1].f!=null&&(he.f=ue[1].f);break}K.dense?(O[ue[0].r]||(O[ue[0].r]=[]),O[ue[0].r][ue[0].c]=ue[1]):O[xt(ue[0])]=ue[1];break}},K);else if(P[2]==26||P[2]==14)K.Enum=Se,P[2]==14&&(K.qpro=!0,P.l=0),e(P,function(ue,Ie,Le){switch(Le){case 204:F=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>Y&&(O["!ref"]=Nt(B),te[F]=O,pe.push(F),O=K.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Y=ue[3],F="Sheet"+(Y+1)),Be>0&&ue[0].r>=Be)break;K.dense?(O[ue[0].r]||(O[ue[0].r]=[]),O[ue[0].r][ue[0].c]=ue[1]):O[xt(ue[0])]=ue[1],B.e.c<ue[0].c&&(B.e.c=ue[0].c),B.e.r<ue[0].r&&(B.e.r=ue[0].r);break;case 27:ue[14e3]&&(we[ue[14e3][0]]=ue[14e3][1]);break;case 1537:we[ue[0]]=ue[1],ue[0]==Y&&(F=ue[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(O["!ref"]=Nt(B),te[H||F]=O,pe.push(H||F),!we.length)return{SheetNames:pe,Sheets:te};for(var fe={},oe=[],ge=0;ge<we.length;++ge)te[pe[ge]]?(oe.push(we[ge]||pe[ge]),fe[we[ge]]=te[we[ge]]||te[pe[ge]]):(oe.push(we[ge]),fe[we[ge]]={"!ref":"A1"});return{SheetNames:oe,Sheets:fe}}function s(P,G){var K=G||{};if(+K.codepage>=0&&Da(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Us(),F=zt(P["!ref"]),H=Array.isArray(P),Y=[];He(O,0,i(1030)),He(O,6,c(F));for(var te=Math.min(F.e.r,8191),pe=F.s.r;pe<=te;++pe)for(var we=_r(pe),B=F.s.c;B<=F.e.c;++B){pe===F.s.r&&(Y[B]=br(B));var Be=Y[B]+we,fe=H?(P[pe]||[])[B]:P[Be];if(!(!fe||fe.t=="z"))if(fe.t=="n")(fe.v|0)==fe.v&&fe.v>=-32768&&fe.v<=32767?He(O,13,h(pe,B,fe.v)):He(O,14,p(pe,B,fe.v));else{var oe=pn(fe);He(O,15,m(pe,B,oe.slice(0,239)))}}return He(O,1),O.end()}function n(P,G){var K=G||{};if(+K.codepage>=0&&Da(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Us();He(O,0,o(P));for(var F=0,H=0;F<P.SheetNames.length;++F)(P.Sheets[P.SheetNames[F]]||{})["!ref"]&&He(O,27,U(P.SheetNames[F],H++));var Y=0;for(F=0;F<P.SheetNames.length;++F){var te=P.Sheets[P.SheetNames[F]];if(!(!te||!te["!ref"])){for(var pe=zt(te["!ref"]),we=Array.isArray(te),B=[],Be=Math.min(pe.e.r,8191),fe=pe.s.r;fe<=Be;++fe)for(var oe=_r(fe),ge=pe.s.c;ge<=pe.e.c;++ge){fe===pe.s.r&&(B[ge]=br(ge));var ue=B[ge]+oe,Ie=we?(te[fe]||[])[ge]:te[ue];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")He(O,23,_(fe,ge,Y,Ie.v));else{var Le=pn(Ie);He(O,22,N(fe,ge,Y,Le.slice(0,239)))}}++Y}}return He(O,1),O.end()}function i(P){var G=Ce(2);return G.write_shift(2,P),G}function o(P){var G=Ce(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var K=0,O=0,F=0,H=0;H<P.SheetNames.length;++H){var Y=P.SheetNames[H],te=P.Sheets[Y];if(!(!te||!te["!ref"])){++F;var pe=Ws(te["!ref"]);K<pe.e.r&&(K=pe.e.r),O<pe.e.c&&(O=pe.e.c)}}return K>8191&&(K=8191),G.write_shift(2,K),G.write_shift(1,F),G.write_shift(1,O),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(P,G,K){var O={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&K.qpro?(O.s.c=P.read_shift(1),P.l++,O.s.r=P.read_shift(2),O.e.c=P.read_shift(1),P.l++,O.e.r=P.read_shift(2),O):(O.s.c=P.read_shift(2),O.s.r=P.read_shift(2),G==12&&K.qpro&&(P.l+=2),O.e.c=P.read_shift(2),O.e.r=P.read_shift(2),G==12&&K.qpro&&(P.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(P){var G=Ce(8);return G.write_shift(2,P.s.c),G.write_shift(2,P.s.r),G.write_shift(2,P.e.c),G.write_shift(2,P.e.r),G}function u(P,G,K){var O=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(O[0].c=P.read_shift(1),O[3]=P.read_shift(1),O[0].r=P.read_shift(2),P.l+=2):(O[2]=P.read_shift(1),O[0].c=P.read_shift(2),O[0].r=P.read_shift(2)),O}function d(P,G,K){var O=P.l+G,F=u(P,G,K);if(F[1].t="s",K.vers==20768){P.l++;var H=P.read_shift(1);return F[1].v=P.read_shift(H,"utf8"),F}return K.qpro&&P.l++,F[1].v=P.read_shift(O-P.l,"cstr"),F}function m(P,G,K){var O=Ce(7+K.length);O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,P),O.write_shift(1,39);for(var F=0;F<O.length;++F){var H=K.charCodeAt(F);O.write_shift(1,H>=128?95:H)}return O.write_shift(1,0),O}function f(P,G,K){var O=u(P,G,K);return O[1].v=P.read_shift(2,"i"),O}function h(P,G,K){var O=Ce(7);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,P),O.write_shift(2,K,"i"),O}function x(P,G,K){var O=u(P,G,K);return O[1].v=P.read_shift(8,"f"),O}function p(P,G,K){var O=Ce(13);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,P),O.write_shift(8,K,"f"),O}function g(P,G,K){var O=P.l+G,F=u(P,G,K);if(F[1].v=P.read_shift(8,"f"),K.qpro)P.l=O;else{var H=P.read_shift(2);S(P.slice(P.l,P.l+H),F),P.l+=H}return F}function b(P,G,K){var O=G&32768;return G&=-32769,G=(O?P:0)+(G>=8192?G-16384:G),(O?"":"$")+(K?br(G):_r(G))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(P,G){cs(P,0);for(var K=[],O=0,F="",H="",Y="",te="";P.l<P.length;){var pe=P[P.l++];switch(pe){case 0:K.push(P.read_shift(8,"f"));break;case 1:H=b(G[0].c,P.read_shift(2),!0),F=b(G[0].r,P.read_shift(2),!1),K.push(H+F);break;case 2:{var we=b(G[0].c,P.read_shift(2),!0),B=b(G[0].r,P.read_shift(2),!1);H=b(G[0].c,P.read_shift(2),!0),F=b(G[0].r,P.read_shift(2),!1),K.push(we+B+":"+H+F)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(P.read_shift(2));break;case 6:{for(var Be="";pe=P[P.l++];)Be+=String.fromCharCode(pe);K.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:te=K.pop(),Y=K.pop(),K.push(["AND","OR"][pe-20]+"("+Y+","+te+")");break;default:if(pe<32&&j[pe])te=K.pop(),Y=K.pop(),K.push(Y+j[pe]+te);else if(y[pe]){if(O=y[pe][1],O==69&&(O=P[P.l++]),O>K.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+K.join("|")+"|");return}var fe=K.slice(-O);K.length-=O,K.push(y[pe][0]+"("+fe.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}K.length==1?G[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function E(P){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=P.read_shift(2),G[3]=P[P.l++],G[0].c=P[P.l++],G}function w(P,G){var K=E(P);return K[1].t="s",K[1].v=P.read_shift(G-4,"cstr"),K}function N(P,G,K,O){var F=Ce(6+O.length);F.write_shift(2,P),F.write_shift(1,K),F.write_shift(1,G),F.write_shift(1,39);for(var H=0;H<O.length;++H){var Y=O.charCodeAt(H);F.write_shift(1,Y>=128?95:Y)}return F.write_shift(1,0),F}function C(P,G){var K=E(P);K[1].v=P.read_shift(2);var O=K[1].v>>1;if(K[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return K[1].v=O,K}function T(P,G){var K=E(P),O=P.read_shift(4),F=P.read_shift(4),H=P.read_shift(2);if(H==65535)return O===0&&F===3221225472?(K[1].t="e",K[1].v=15):O===0&&F===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Y=H&32768;return H=(H&32767)-16446,K[1].v=(1-Y*2)*(F*Math.pow(2,H+32)+O*Math.pow(2,H)),K}function _(P,G,K,O){var F=Ce(14);if(F.write_shift(2,P),F.write_shift(1,K),F.write_shift(1,G),O==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var H=0,Y=0,te=0,pe=0;return O<0&&(H=1,O=-O),Y=Math.log2(O)|0,O/=Math.pow(2,Y-31),pe=O>>>0,(pe&2147483648)==0&&(O/=2,++Y,pe=O>>>0),O-=pe,pe|=2147483648,pe>>>=0,O*=Math.pow(2,32),te=O>>>0,F.write_shift(4,te),F.write_shift(4,pe),Y+=16383+(H?32768:0),F.write_shift(2,Y),F}function k(P,G){var K=T(P);return P.l+=G-14,K}function I(P,G){var K=E(P),O=P.read_shift(4);return K[1].v=O>>6,K}function L(P,G){var K=E(P),O=P.read_shift(8,"f");return K[1].v=O,K}function D(P,G){var K=L(P);return P.l+=G-10,K}function M(P,G){return P[P.l+G-1]==0?P.read_shift(G,"cstr"):""}function q(P,G){var K=P[P.l++];K>G-1&&(K=G-1);for(var O="";O.length<K;)O+=String.fromCharCode(P[P.l++]);return O}function Z(P,G,K){if(!(!K.qpro||G<21)){var O=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var F=P.read_shift(G-21,"cstr");return[O,F]}}function Q(P,G){for(var K={},O=P.l+G;P.l<O;){var F=P.read_shift(2);if(F==14e3){for(K[F]=[0,""],K[F][0]=P.read_shift(2);P[P.l];)K[F][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return K}function U(P,G){var K=Ce(5+P.length);K.write_shift(2,14e3),K.write_shift(2,G);for(var O=0;O<P.length;++O){var F=P.charCodeAt(O);K[K.l++]=F>127?95:F}return K[K.l++]=0,K}var le={0:{n:"BOF",f:Rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}})();function UF(e){var t={},r=e.match(Ts),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=gt(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Ix[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var WF=(function(){var e=$l("t"),t=$l("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Bt(o[1])},c=i.match(t);return c&&(l.s=UF(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(n).map(r).filter(function(l){return l.v})}})(),HF=(function(){var t=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}})(),VF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,GF=/<(?:\w+:)?r>/,qF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tg(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Bt(er(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=er(e),r&&(s.h=$x(s.t))):e.match(GF)&&(s.r=er(e),s.t=Bt(er((e.replace(qF,"").match(VF)||[]).join("").replace(Ts,""))),r&&(s.h=HF(WF(s.r)))),s):{t:""}}var KF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YF=/<(?:\w+:)?(?:si|sstItem)>/g,XF=/<\/(?:\w+:)?(?:si|sstItem)>/;function JF(e,t){var r=[],s="";if(!e)return r;var n=e.match(KF);if(n){s=n[2].replace(YF,"").split(XF);for(var i=0;i!=s.length;++i){var o=tg(s[i].trim(),t);o!=null&&(r[r.length]=o)}n=gt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var ZF=/^\s|\s$|[\t\n\r]/;function TE(e,t){if(!t.bookSST)return"";var r=[Ir];r[r.length]=Ue("sst",null,{xmlns:Hi[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(ZF)&&(i+=' xml:space="preserve"'),i+=">"+Jt(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function QF(e){return[e.read_shift(4),e.read_shift(4)]}function eL(e,t){var r=[],s=!1;return jn(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function tL(e,t){return t||(t=Ce(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var rL=mR;function sL(e){var t=Us();Fe(t,159,tL(e));for(var r=0;r<e.length;++r)Fe(t,19,rL(e[r]));return Fe(t,160),t.end()}function CE(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function cn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function aL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=cn(e,4),t.U=cn(e,4),t.W=cn(e,4),t}function nL(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function iL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(nL(e));return t}function oL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function lL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=cn(e,4),t.U=cn(e,4),t.W=cn(e,4),t}function cL(e){var t=lL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function AE(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function kE(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function dL(e){var t=cn(e);switch(t.Minor){case 2:return[t.Minor,uL(e)];case 3:return[t.Minor,mL()];case 4:return[t.Minor,fL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function uL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=AE(e,r),n=kE(e,e.length-e.l);return{t:"Std",h:s,v:n}}function mL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Ts,function(i){var o=gt(i);switch(Za(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){s[l]=o[l]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function hL(e,t){var r={},s=r.EncryptionVersionInfo=cn(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=AE(e,n),t-=n,r.EncryptionVerifier=kE(e,t),r}function pL(e){var t={},r=t.EncryptionVersionInfo=cn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function rg(e){var t=0,r,s=CE(e),n=s.length+1,i,o,l,c,u;for(r=zn(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var _E=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},n=function(o,l){return s(o^l)},i=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],m=0;m!=7;++m)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=CE(o),c=i(l),u=l.length,d=zn(16),m=0;m!=16;++m)d[m]=0;var f,h,x;for((u&1)===1&&(f=c>>8,d[u]=n(e[0],f),--u,f=c&255,h=l[l.length-1],d[u]=n(h,f));u>0;)--u,f=c>>8,d[u]=n(l[u],f),--u,f=c&255,d[u]=n(l[u],f);for(u=15,x=15-l.length;x>0;)f=c>>8,d[u]=n(e[x],f),--u,--x,f=c&255,d[u]=n(l[u],f),--u,--x;return d}})(),xL=function(e,t,r,s,n){n||(n=t),s||(s=_E(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=s[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,s]},gL=function(e){var t=0,r=_E(e);return function(s){var n=xL("",s,t,r);return t=n[1],n[0]}};function vL(e,t,r,s){var n={key:Rr(e),verificationBytes:Rr(e)};return r.password&&(n.verifier=rg(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=gL(r.password)),n}function bL(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=pL(e):s.Data=hL(e,t),s}function yL(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?bL(e,t-2,s):vL(e,r.biff>=8?t:t-2,r,s),s}var IE=(function(){function e(n,i){switch(i.type){case"base64":return t(ta(n),i);case"binary":return t(n,i);case"buffer":return t(Tt&&Buffer.isBuffer(n)?n.toString("binary"):Kn(n),i);case"array":return t(_i(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var f=/\\\w+\b/g,h=0,x,p=-1;x=f.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(h,f.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var b={v:g,t:"s"};Array.isArray(l)?l[m][p]=b:l[xt({r:m,c:p})]=b}break}h=f.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Nt(u),l}function r(n,i){return Yn(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=zt(n["!ref"]),l,c=Array.isArray(n),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=xt({r:u,c:d});l=c?(n[u]||[])[d]:n[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(pn(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function jL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Vl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function wL(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),i=Math.min(t,r,s),o=n-i;if(o===0)return[0,0,t];var l=0,c=0,u=n+i;switch(c=o/(u>1?2-u:u),n){case t:l=((r-s)/o+6)%6;break;case r:l=(s-t)/o+2;break;case s:l=(t-r)/o+4;break}return[l/6,c,u/2]}function NL(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function Gd(e,t){if(t===0)return e;var r=wL(jL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Vl(NL(r))}var PE=6,SL=15,EL=1,bs=PE;function Gl(e){return Math.floor((e+Math.round(128/bs)/256)*bs)}function ql(e){return Math.floor((e-5)/bs*100+.5)/100}function qd(e){return Math.round((e*bs+5)/bs*256)/256}function Wm(e){return qd(ql(Gl(e)))}function sg(e){var t=Math.abs(e-Wm(e)),r=bs;if(t>.005)for(bs=EL;bs<SL;++bs)Math.abs(e-Wm(e))<=t&&(t=Math.abs(e-Wm(e)),r=bs);bs=r}function $n(e){e.width?(e.wpx=Gl(e.width),e.wch=ql(e.wpx),e.MDW=bs):e.wpx?(e.wch=ql(e.wpx),e.width=qd(e.wch),e.MDW=bs):typeof e.wch=="number"&&(e.width=qd(e.wch),e.wpx=Gl(e.width),e.MDW=bs),e.customWidth&&delete e.customWidth}var TL=96,DE=TL;function Kl(e){return e*96/DE}function To(e){return e*DE/96}var CL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AL(e,t,r,s){t.Borders=[];var n={},i=!1;(e[0].match(Ts)||[]).forEach(function(o){var l=gt(o);switch(Za(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=or(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=or(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function kL(e,t,r,s){t.Fills=[];var n={},i=!1;(e[0].match(Ts)||[]).forEach(function(o){var l=gt(o);switch(Za(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function _L(e,t,r,s){t.Fonts=[];var n={},i=!1;(e[0].match(Ts)||[]).forEach(function(o){var l=gt(o);switch(Za(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=er(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?or(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?or(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?or(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?or(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?or(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?or(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?or(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Ix[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=or(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=vi[n.color.index];n.color.index==81&&(c=vi[1]),c||(c=vi[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Gd(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function IL(e,t,r){t.NumberFmt=[];for(var s=Cr(pt),n=0;n<s.length;++n)t.NumberFmt[s[n]]=pt[s[n]];var i=e[0].match(Ts);if(i)for(n=0;n<i.length;++n){var o=gt(i[n]);switch(Za(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Bt(er(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}ln(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function PL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:s,formatCode:Jt(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sd=["numFmtId","fillId","fontId","borderId","xfId"],ad=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function DL(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Ts)||[]).forEach(function(i){var o=gt(i),l=0;switch(Za(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],l=0;l<sd.length;++l)s[sd[l]]&&(s[sd[l]]=parseInt(s[sd[l]],10));for(l=0;l<ad.length;++l)s[ad[l]]&&(s[ad[l]]=or(s[ad[l]]));if(t.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[l]){s.numFmtId=l;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=or(o.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function OL(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var RL=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&IL(m,d,u),(m=l.match(n))&&_L(m,d,c,u),(m=l.match(s))&&kL(m,d,c,u),(m=l.match(i))&&AL(m,d,c,u),(m=l.match(r))&&DL(m,d,u),d}})();function OE(e,t){var r=[Ir,Ue("styleSheet",null,{xmlns:Hi[0],"xmlns:vt":$r.vt})],s;return e.SSF&&(s=PL(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=OL(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function FL(e,t){var r=e.read_shift(2),s=Ns(e);return[r,s]}function LL(e,t,r){r||(r=Ce(6+4*t.length)),r.write_shift(2,e),Qr(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function ML(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=bR(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=vR(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Ns(e),s}function BL(e,t){t||(t=Ce(153)),t.write_shift(2,e.sz*20),yR(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Wd(e.color,t);var s=0;return s=2,t.write_shift(1,s),Qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var zL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hm,$L=Es;function Pb(e,t){t||(t=Ce(84)),Hm||(Hm=Vu(zL));var r=Hm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Wd({auto:1},t),Wd({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function UL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function RE(e,t,r){r||(r=Ce(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nl(e,t){return t||(t=Ce(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var WL=Es;function HL(e,t){return t||(t=Ce(51)),t.write_shift(1,0),nl(null,t),nl(null,t),nl(null,t),nl(null,t),nl(null,t),t.length>t.l?t.slice(0,t.l):t}function VL(e,t){return t||(t=Ce(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ud(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function GL(e,t,r){var s=Ce(2052);return s.write_shift(4,e),Ud(t,s),Ud(r,s),s.length>s.l?s.slice(0,s.l):s}function qL(e,t,r){var s={};s.NumberFmt=[];for(var n in pt)s.NumberFmt[n]=pt[n];s.CellXf=[],s.Fonts=[];var i=[],o=!1;return jn(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],ln(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Gd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function KL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(Fe(e,615,La(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Fe(e,44,LL(n,t[n]))}),Fe(e,616))}}function YL(e){var t=1;Fe(e,611,La(t)),Fe(e,43,BL({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(e,612)}function XL(e){var t=2;Fe(e,603,La(t)),Fe(e,45,Pb({patternType:"none"})),Fe(e,45,Pb({patternType:"gray125"})),Fe(e,604)}function JL(e){var t=1;Fe(e,613,La(t)),Fe(e,46,HL()),Fe(e,614)}function ZL(e){var t=1;Fe(e,626,La(t)),Fe(e,47,RE({numFmtId:0},65535)),Fe(e,627)}function QL(e,t){Fe(e,617,La(t.length)),t.forEach(function(r){Fe(e,47,RE(r,0))}),Fe(e,618)}function eM(e){var t=1;Fe(e,619,La(t)),Fe(e,48,VL({xfId:0,name:"Normal"})),Fe(e,620)}function tM(e){var t=0;Fe(e,505,La(t)),Fe(e,506)}function rM(e){var t=0;Fe(e,508,GL(t,"TableStyleMedium9","PivotStyleMedium4")),Fe(e,509)}function sM(e,t){var r=Us();return Fe(r,278),KL(r,e.SSF),YL(r),XL(r),JL(r),ZL(r),QL(r,t.cellXfs),eM(r),tM(r),rM(r),Fe(r,279),r.end()}var aM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nM(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Ts)||[]).forEach(function(n){var i=gt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[aM.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function iM(){}function oM(){}var lM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uM(e,t,r){t.themeElements={};var s;[["clrScheme",lM,nM],["fontScheme",cM,iM],["fmtScheme",dM,oM]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var mM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function FE(e,t){(!e||e.length===0)&&(e=ag());var r,s={};if(!(r=e.match(mM)))throw new Error("themeElements not found in theme");return uM(r[0],s,t),s.raw=e,s}function ag(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ir];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fM(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var i=e.slice(e.l);e.l=s;var o;try{o=AS(i,{type:"array"})}catch{return}var l=Js(o,"theme/theme/theme1.xml",!0);if(l)return FE(l,r)}}function hM(e){return e.read_shift(4)}function pM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=xM(e,4);break;case 2:t.xclrValue=pE(e);break;case 3:t.xclrValue=hM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function xM(e,t){return Es(e,t)}function gM(e,t){return Es(e,t)}function vM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=pM(e);break;case 6:s[1]=gM(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function bM(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(vM(e,r-e.l));return{ixfe:s,ext:i}}function yM(e,t){t.forEach(function(r){r[0]})}function jM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ns(e)}}function wM(e){var t=Ce(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qr(e.name,t),t.slice(0,t.l)}function NM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function SM(e){var t=Ce(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function EM(e,t){var r=Ce(8+2*t.length);return r.write_shift(4,e),Qr(t,r),r.slice(0,r.l)}function TM(e){return e.l+=4,e.read_shift(4)!=0}function CM(e,t){var r=Ce(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AM(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return jn(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(m){l==1?s.Cell.push({type:s.Types[m[0]-1].name,index:m[1]}):l==0&&s.Value.push({type:s.Types[m[0]-1].name,index:m[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function kM(){var e=Us();return Fe(e,332),Fe(e,334,La(1)),Fe(e,335,wM({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(e,336),Fe(e,339,EM(1,"XLDAPR")),Fe(e,52),Fe(e,35,La(514)),Fe(e,4096,La(0)),Fe(e,4097,xa(1)),Fe(e,36),Fe(e,53),Fe(e,340),Fe(e,337,CM(1)),Fe(e,51,SM([[1,0]])),Fe(e,338),Fe(e,333),e.end()}function _M(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,i=2,o;return e.replace(Ts,function(l){var c=gt(l);switch(Za(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(o=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):i==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function LE(){var e=[Ir];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function IM(e){var t=[];if(!e)return t;var r=1;return(e.match(Ts)||[]).forEach(function(s){var n=gt(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function PM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=xt(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function DM(e,t,r){var s=[];return jn(e,function(i,o,l){switch(l){case 63:s.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function OM(e,t,r,s){if(!e)return e;var n=s||{},i=!1;jn(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function RM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var co=1024;function ME(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ue("xml",null,{"xmlns:v":Ks.v,"xmlns:o":Ks.o,"xmlns:x":Ks.x,"xmlns:mv":Ks.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];co<e*1e3;)co+=1e3;return t.forEach(function(i){var o=yr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ue("v:fill",c,l),d={on:"t",obscured:"t"};++co,n=n.concat(["<v:shape"+Ul({id:"_x0000_s"+co,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ue("v:shadow",null,d),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",us("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),us("x:AutoFill","False"),us("x:Row",String(o.r)),us("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Db(e,t,r,s){var n=Array.isArray(e),i;t.forEach(function(o){var l=yr(o.ref);if(n?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},n?e[l.r][l.c]=i:e[o.ref]=i;var c=zt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Nt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&s){for(m=0;m<s.length;++m)if(d.a==s[m].id){d.a=s[m].name||d.a;break}}i.c.push(d)})}function FM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=gt(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=yr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!m&&!!m[1]&&tg(m[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),s.push(u)}}}}),s}function BE(e){var t=[Ir,Ue("comments",null,{xmlns:Hi[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var i=Jt(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(Jt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(us("t",Jt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(us("t",Jt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function LM(e,t){var r=[],s=!1,n={},i=0;return e.replace(Ts,function(l,c){var u=gt(l);switch(Za(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function MM(e,t,r){var s=[Ir,Ue("ThreadedComments",null,{xmlns:$r.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(Ue("threadedComment",us("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function BM(e,t){var r=[],s=!1;return e.replace(Ts,function(i){var o=gt(i);switch(Za(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function zM(e){var t=[Ir,Ue("personList",null,{xmlns:$r.TCMNT,"xmlns:x":Hi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $M(e){var t={};t.iauthor=e.read_shift(4);var r=Ki(e);return t.rfx=r.s,t.ref=xt(r.s),e.l+=16,t}function UM(e,t){return t==null&&(t=Ce(36)),t.write_shift(4,e[1].iauthor),Wo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var WM=Ns;function HM(e){return Qr(e.slice(0,54))}function VM(e,t){var r=[],s=[],n={},i=!1;return jn(e,function(l,c,u){switch(u){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function GM(e){var t=Us(),r=[];return Fe(t,628),Fe(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Fe(t,632,HM(n.a)))})}),Fe(t,631),Fe(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:yr(s[0]),e:yr(s[0])};Fe(t,635,UM([i,n])),n.t&&n.t.length>0&&Fe(t,637,hR(n)),Fe(t,636),delete n.iauthor})}),Fe(t,634),Fe(t,629),t.end()}var qM="application/vnd.ms-office.vbaProject";function KM(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,n,e.FileIndex[s].content)}}),mt.write(t)}function YM(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&mt.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var zE=["xlsb","xlsm","xlam","biff8","xla"];function XM(){return{"!type":"dialog"}}function JM(){return{"!type":"dialog"}}function ZM(){return{"!type":"macro"}}function QM(){return{"!type":"macro"}}var ho=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+br(d)+(c?"":"$")+_r(u)}return function(n,i){return t=i,n.replace(e,r)}})(),ng=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ig=(function(){return function(t,r){return t.replace(ng,function(s,n,i,o,l,c){var u=Gx(o)-(i?0:r.c),d=Vx(c)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return n+"R"+m+"C"+f})}})();function $E(e,t){return e.replace(ng,function(r,s,n,i,o,l){return s+(n=="$"?n+i:br(Gx(i)+t.c))+(o=="$"?o+l:_r(Vx(l)+t.r))})}function e7(e,t,r){var s=Ws(t),n=s.s,i=yr(r),o={r:i.r-n.r,c:i.c-n.c};return $E(e,o)}function t7(e){return e.length!=1}function Ob(e){return e.replace(/_xlfn\./g,"")}function Dr(e){e.l+=1}function Un(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function UE(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return WE(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),o=Un(e),l=Un(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function WE(e){var t=Un(e),r=Un(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function r7(e,t,r){if(r.biff<8)return WE(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Un(e),o=Un(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function HE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return s7(e);var s=e.read_shift(r&&r.biff==12?4:2),n=Un(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function s7(e){var t=Un(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function a7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function n7(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return i7(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function i7(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function o7(e,t,r){var s=(e[e.l++]&96)>>5,n=UE(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function l7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=UE(e,i,r);return[s,n,o]}function c7(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function d7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function u7(e,t,r){var s=(e[e.l++]&96)>>5,n=r7(e,t-1,r);return[s,n]}function m7(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function Rb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function f7(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function h7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function p7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function x7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function g7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function VE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function v7(e){return e.read_shift(2),VE(e)}function b7(e){return e.read_shift(2),VE(e)}function y7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=HE(e,0,r);return[s,n]}function j7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=n7(e,0,r);return[s,n]}function w7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=HE(e,0,r);return[s,n,i]}function N7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[TB[n],KE[n],s]}function S7(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:E7(e);return[n,(i[0]===0?KE:EB)[i[1]]]}function E7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function T7(e,t,r){e.l+=r&&r.biff==2?3:4}function C7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function A7(e){return e.l++,wn[e.read_shift(1)]}function k7(e){return e.l++,e.read_shift(2)}function _7(e){return e.l++,e.read_shift(1)!==0}function I7(e){return e.l++,ws(e)}function P7(e,t,r){return e.l++,jc(e,t-1,r)}function D7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ar(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=wn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ws(e);break;case 2:r[1]=Yi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function O7(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Ki:Ku)(e));return n}function R7(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=D7(e,r.biff);return o}function F7(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function L7(e,t,r){if(r.biff==5)return M7(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function M7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function B7(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function z7(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function $7(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function U7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var W7=Es,H7=Es,V7=Es;function Nc(e,t,r){return e.l+=2,[a7(e)]}function og(e){return e.l+=6,[]}var G7=Nc,q7=og,K7=og,Y7=Nc;function GE(e){return e.l+=2,[Rr(e),e.read_shift(2)&1]}var X7=Nc,J7=GE,Z7=og,Q7=Nc,eB=Nc,tB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function rB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=tB[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:n,C:i}}function sB(e){return e.l+=2,[e.read_shift(4)]}function aB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function nB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function oB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lB(e){return e.l+=4,[0,0]}var Fb={1:{n:"PtgExp",f:C7},2:{n:"PtgTbl",f:V7},3:{n:"PtgAdd",f:Dr},4:{n:"PtgSub",f:Dr},5:{n:"PtgMul",f:Dr},6:{n:"PtgDiv",f:Dr},7:{n:"PtgPower",f:Dr},8:{n:"PtgConcat",f:Dr},9:{n:"PtgLt",f:Dr},10:{n:"PtgLe",f:Dr},11:{n:"PtgEq",f:Dr},12:{n:"PtgGe",f:Dr},13:{n:"PtgGt",f:Dr},14:{n:"PtgNe",f:Dr},15:{n:"PtgIsect",f:Dr},16:{n:"PtgUnion",f:Dr},17:{n:"PtgRange",f:Dr},18:{n:"PtgUplus",f:Dr},19:{n:"PtgUminus",f:Dr},20:{n:"PtgPercent",f:Dr},21:{n:"PtgParen",f:Dr},22:{n:"PtgMissArg",f:Dr},23:{n:"PtgStr",f:P7},26:{n:"PtgSheet",f:aB},27:{n:"PtgEndSheet",f:nB},28:{n:"PtgErr",f:A7},29:{n:"PtgBool",f:_7},30:{n:"PtgInt",f:k7},31:{n:"PtgNum",f:I7},32:{n:"PtgArray",f:m7},33:{n:"PtgFunc",f:N7},34:{n:"PtgFuncVar",f:S7},35:{n:"PtgName",f:F7},36:{n:"PtgRef",f:y7},37:{n:"PtgArea",f:o7},38:{n:"PtgMemArea",f:B7},39:{n:"PtgMemErr",f:W7},40:{n:"PtgMemNoMem",f:H7},41:{n:"PtgMemFunc",f:z7},42:{n:"PtgRefErr",f:$7},43:{n:"PtgAreaErr",f:c7},44:{n:"PtgRefN",f:j7},45:{n:"PtgAreaN",f:u7},46:{n:"PtgMemAreaN",f:iB},47:{n:"PtgMemNoMemN",f:oB},57:{n:"PtgNameX",f:L7},58:{n:"PtgRef3d",f:w7},59:{n:"PtgArea3d",f:l7},60:{n:"PtgRefErr3d",f:U7},61:{n:"PtgAreaErr3d",f:d7},255:{}},cB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dB={1:{n:"PtgElfLel",f:GE},2:{n:"PtgElfRw",f:Q7},3:{n:"PtgElfCol",f:G7},6:{n:"PtgElfRwV",f:eB},7:{n:"PtgElfColV",f:Y7},10:{n:"PtgElfRadical",f:X7},11:{n:"PtgElfRadicalS",f:Z7},13:{n:"PtgElfColS",f:q7},15:{n:"PtgElfColSV",f:K7},16:{n:"PtgElfRadicalLel",f:J7},25:{n:"PtgList",f:rB},29:{n:"PtgSxName",f:sB},255:{}},uB={0:{n:"PtgAttrNoop",f:lB},1:{n:"PtgAttrSemi",f:g7},2:{n:"PtgAttrIf",f:p7},4:{n:"PtgAttrChoose",f:f7},8:{n:"PtgAttrGoto",f:h7},16:{n:"PtgAttrSum",f:T7},32:{n:"PtgAttrBaxcel",f:Rb},33:{n:"PtgAttrBaxcel",f:Rb},64:{n:"PtgAttrSpace",f:v7},65:{n:"PtgAttrSpaceSemi",f:b7},128:{n:"PtgAttrIfError",f:x7},255:{}};function Sc(e,t,r,s){if(s.biff<8)return Es(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=R7(e,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=O7(e,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(Es(e,t)),i}function Ec(e,t,r){for(var s=e.l+t,n,i,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=Fb[i]||Fb[cB[i]],(i===24||i===25)&&(n=(i===24?dB:uB)[e[e.l+1]]),!n||!n.f?Es(e,t):o.push([n.n,n.f(e,t,r)]);return o}function mB(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var fB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function qE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Lb(e,t,r){var s=qE(e,t,r);return s=="#REF"?s:hB(s,r)}function vs(e,t,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,m=0,f=0,h,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",b=0,y=e[0].length;b<y;++b){var j=e[0][b];switch(j[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Er(" ",e[0][p][1][1]);break;case 1:g=Er("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}l.push(u+fB[j[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Nl(j[1][1],o,n),l.push(Sl(d,i));break;case"PtgRefN":d=r?Nl(j[1][1],r,n):j[1][1],l.push(Sl(d,i));break;case"PtgRef3d":m=j[1][1],d=Nl(j[1][2],o,n),x=Lb(s,m,n),l.push(x+"!"+Sl(d,i));break;case"PtgFunc":case"PtgFuncVar":var S=j[1][0],E=j[1][1];S||(S=0),S&=127;var w=S==0?[]:l.slice(-S);l.length-=S,E==="User"&&(E=w.shift()),l.push(E+"("+w.join(",")+")");break;case"PtgBool":l.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(j[1]);break;case"PtgNum":l.push(String(j[1]));break;case"PtgStr":l.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(j[1]);break;case"PtgAreaN":h=mb(j[1][1],r?{s:r}:o,n),l.push(zm(h,n));break;case"PtgArea":h=mb(j[1][1],o,n),l.push(zm(h,n));break;case"PtgArea3d":m=j[1][1],h=j[1][2],x=Lb(s,m,n),l.push(x+"!"+zm(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=j[1][2];var N=(s.names||[])[f-1]||(s[0]||[])[f],C=N?N.Name:"SH33TJSNAME"+String(f);C&&C.slice(0,6)=="_xlfn."&&!n.xlfn&&(C=C.slice(6)),l.push(C);break;case"PtgNameX":var T=j[1][1];f=j[1][2];var _;if(n.biff<=5)T<0&&(T=-T),s[T]&&(_=s[T][f]);else{var k="";if(((s[T]||[])[0]||[])[0]==14849||(((s[T]||[])[0]||[])[0]==1025?s[T][f]&&s[T][f].itab>0&&(k=s.SheetNames[s[T][f].itab-1]+"!"):k=s.SheetNames[f-1]+"!"),s[T]&&s[T][f])k+=s[T][f].Name;else if(s[0]&&s[0][f])k+=s[0][f].Name;else{var I=(qE(s,T,n)||"").split(";;");I[f-1]?k=I[f-1]:k+="SH33TJSERRX"}l.push(k);break}_||(_={Name:"SH33TJSERRY"}),l.push(_.Name);break;case"PtgParen":var L="(",D=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:L=Er(" ",e[0][p][1][1])+L;break;case 3:L=Er("\r",e[0][p][1][1])+L;break;case 4:D=Er(" ",e[0][p][1][1])+D;break;case 5:D=Er("\r",e[0][p][1][1])+D;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(L+l.pop()+D);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:j[1][1],r:j[1][0]};var M={c:r.c,r:r.r};if(s.sharedf[xt(d)]){var q=s.sharedf[xt(d)];l.push(vs(q,o,M,s,n))}else{var Z=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(vs(u[1],o,M,s,n)),Z=!0;break}Z||l.push(j[1])}break;case"PtgArray":l.push("{"+mB(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Q.indexOf(e[0][b][0])==-1){j=e[0][p];var U=!0;switch(j[1][0]){case 4:U=!1;case 0:g=Er(" ",j[1][1]);break;case 5:U=!1;case 1:g=Er("\r",j[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}l.push((U?g:"")+l.pop()+(U?"":g)),p=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function pB(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],Es(e,t-2)];var l=Ec(e,o,r);return t!==o+n&&(i=Sc(e,t-o-n,l,r)),e.l=s,[l,i]}function xB(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],Es(e,t-2)];var l=Ec(e,o,r);return t!==o+n&&(i=Sc(e,t-o-n,l,r)),e.l=s,[l,i]}function gB(e,t,r,s){var n=e.l+t,i=Ec(e,s,r),o;return n!==e.l&&(o=Sc(e,n-e.l,i,r)),[i,o]}function vB(e,t,r){var s=e.l+t,n,i=e.read_shift(2),o=Ec(e,i,r);return i==65535?[[],Es(e,t-2)]:(t!==i+2&&(n=Sc(e,s-i-2,o,r)),[o,n])}function bB(e){var t;if(sn(e,e.l+6)!==65535)return[ws(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function yB(e){if(e==null){var t=Ce(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ii(e);return Ii(0)}function Vm(e,t,r){var s=e.l+t,n=Qa(e);r.biff==2&&++e.l;var i=bB(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=xB(e,s-e.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function jB(e,t,r,s,n){var i=Di(t,r,n),o=yB(e.v),l=Ce(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Ce(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=Zr([i,o,l,u]);return m}function Yu(e,t,r){var s=e.read_shift(4),n=Ec(e,s,r),i=e.read_shift(4),o=i>0?Sc(e,i,n,r):null;return[n,o]}var wB=Yu,Xu=Yu,NB=Yu,SB=Yu,EB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},KE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Mb(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function CB(e){var t="of:="+e.replace(ng,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Gm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function AB(e){return e.replace(/\./,"!")}var Tl={},po={},Cl=typeof Map<"u";function lg(e,t,r){var s=0,n=e.length;if(r){if(Cl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Cl?r.get(t):r[t];s<i.length;++s)if(e[i[s]].t===t)return e.Count++,i[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Cl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Ju(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(bs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=ql(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=qd(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ji(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Xn(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){ln(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function YE(e,t,r,s,n,i){try{s.cellNF&&(e.z=pt[t])}catch(l){if(s.WTF)throw l}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=cr(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(pt[t]==null&&ln(E6[t]||"General",t),e.t==="e")e.w=e.w||wn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v);else if(e.t==="d"){var o=Wr(e.v);(o|0)===o?e.w=o.toString(10):e.w=zl(o)}else{if(e.v===void 0)return"";e.w=ki(e.v,po)}else e.t==="d"?e.w=wa(t,Wr(e.v),po):e.w=wa(t,e.v,po)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Gd(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Gd(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&i.Fills)throw l}}}function kB(e,t,r){if(e&&e["!ref"]){var s=zt(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function _B(e,t){var r=zt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Nt(r))}var IB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,PB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,DB=/<(?:\w:)?hyperlink [^>]*>/mg,OB=/"(\w*:\w*)"/,RB=/<(?:\w:)?col\b[^>]*[\/]?>/g,FB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LB=/<(?:\w:)?pageMargins[^>]*\/>/g,XE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,MB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,BB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zB(e,t,r,s,n,i,o){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",m=e.match(PB);m?(u=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):u=d=e;var f=u.match(XE);f?cg(f[0],l,n,r):(f=u.match(MB))&&UB(f[0],f[1]||"",l,n,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=u.slice(h,h+50).match(OB);x&&_B(l,x[1])}var p=u.match(BB);p&&p[1]&&tz(p[1],n);var g=[];if(t.cellStyles){var b=u.match(RB);b&&XB(g,b)}m&&az(m[1],l,t,c,i,o);var y=d.match(FB);y&&(l["!autofilter"]=ZB(y[0]));var j=[],S=d.match(IB);if(S)for(h=0;h!=S.length;++h)j[h]=zt(S[h].slice(S[h].indexOf('"')+1));var E=d.match(DB);E&&qB(l,E,s);var w=d.match(LB);if(w&&(l["!margins"]=KB(gt(w[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Nt(c)),t.sheetRows>0&&l["!ref"]){var N=zt(l["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Nt(N))}return g.length>0&&(l["!cols"]=g),j.length>0&&(l["!merges"]=j),l}function $B(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Nt(e[r])+'"/>';return t+"</mergeCells>"}function cg(e,t,r,s){var n=gt(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Bt(er(n.codeName)))}function UB(e,t,r,s,n){cg(e.slice(0,e.indexOf(">")),r,s,n)}function WB(e,t,r,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=Va(Jt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Ue("outlinePr",null,u)}!i&&!l||(n[n.length]=Ue("sheetPr",l,o))}var HB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],VB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function GB(e){var t={sheet:1};return HB.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),VB.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=rg(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function qB(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var i=gt(er(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Bt(i.location))):(i.Target="#"+Bt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=zt(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=xt({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function KB(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function YB(e){return ji(e),Ue("pageMargins",null,e)}function XB(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=gt(t[s],!0);n.hidden&&(n.hidden=or(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,sg(n.width)),$n(n);i<=o;)e[i++]=dr(n)}}function JB(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=Ue("col",null,Ju(n,s)));return r[r.length]="</cols>",r.join("")}function ZB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function QB(e,t,r,s){var n=typeof e.ref=="string"?e.ref:Nt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Ws(n);o.s.r==o.e.r&&(o.e.r=Ws(t["!ref"]).e.r,n=Nt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),Ue("autoFilter",null,{ref:n})}var ez=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function tz(e,t){t.Views||(t.Views=[{}]),(e.match(ez)||[]).forEach(function(r,s){var n=gt(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),or(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function rz(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,n),{})}function sz(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=wn[e.v];break;case"d":s&&s.cellDates?n=cr(e.v,-1).toISOString():(e=dr(e),e.t="n",n=""+(e.v=Wr(cr(e.v)))),typeof e.z>"u"&&(e.z=pt[14]);break;default:n=e.v;break}var l=us("v",Jt(n)),c={r:t},u=Xn(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=us("v",""+lg(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ue("f",Jt(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ue("c",l,c)}var az=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=$l("v"),o=$l("f");return function(c,u,d,m,f,h){for(var x=0,p="",g=[],b=[],y=0,j=0,S=0,E="",w,N,C=0,T=0,_,k,I=0,L=0,D=Array.isArray(h.CellXf),M,q=[],Z=[],Q=Array.isArray(u),U=[],le={},Se=!1,P=!!d.sheetStubs,G=c.split(t),K=0,O=G.length;K!=O;++K){p=G[K].trim();var F=p.length;if(F!==0){var H=0;e:for(x=0;x<F;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(N=gt(p.slice(H,x),!0),C=N.r!=null?parseInt(N.r,10):C+1,T=-1,d.sheetRows&&d.sheetRows<C)continue;le={},Se=!1,N.ht&&(Se=!0,le.hpt=parseFloat(N.ht),le.hpx=To(le.hpt)),N.hidden=="1"&&(Se=!0,le.hidden=!0),N.outlineLevel!=null&&(Se=!0,le.level=+N.outlineLevel),Se&&(U[C-1]=le)}break;case"<":H=x;break}if(H>=x)break;if(N=gt(p.slice(H,x),!0),C=N.r!=null?parseInt(N.r,10):C+1,T=-1,!(d.sheetRows&&d.sheetRows<C)){m.s.r>C-1&&(m.s.r=C-1),m.e.r<C-1&&(m.e.r=C-1),d&&d.cellStyles&&(le={},Se=!1,N.ht&&(Se=!0,le.hpt=parseFloat(N.ht),le.hpx=To(le.hpt)),N.hidden=="1"&&(Se=!0,le.hidden=!0),N.outlineLevel!=null&&(Se=!0,le.level=+N.outlineLevel),Se&&(U[C-1]=le)),g=p.slice(x).split(e);for(var Y=0;Y!=g.length&&g[Y].trim().charAt(0)=="<";++Y);for(g=g.slice(Y),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(b=p.match(r),y=x,j=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,b!=null&&b.length===2){for(y=0,E=b[1],j=0;j!=E.length&&!((S=E.charCodeAt(j)-64)<1||S>26);++j)y=26*y+S;--y,T=y}else++T;for(j=0;j!=p.length&&p.charCodeAt(j)!==62;++j);if(++j,N=gt(p.slice(0,j),!0),N.r||(N.r=xt({r:C-1,c:T})),E=p.slice(j),w={t:""},(b=E.match(i))!=null&&b[1]!==""&&(w.v=Bt(b[1])),d.cellFormula){if((b=E.match(o))!=null&&b[1]!==""){if(w.f=Bt(er(b[1])).replace(/\r\n/g,`
`),d.xlfn||(w.f=Ob(w.f)),b[0].indexOf('t="array"')>-1)w.F=(E.match(n)||[])[1],w.F.indexOf(":")>-1&&q.push([zt(w.F),w.F]);else if(b[0].indexOf('t="shared"')>-1){k=gt(b[0]);var te=Bt(er(b[1]));d.xlfn||(te=Ob(te)),Z[parseInt(k.si,10)]=[k,te,N.r]}}else(b=E.match(/<f[^>]*\/>/))&&(k=gt(b[0]),Z[k.si]&&(w.f=e7(Z[k.si][1],Z[k.si][2],N.r)));var pe=yr(N.r);for(j=0;j<q.length;++j)pe.r>=q[j][0].s.r&&pe.r<=q[j][0].e.r&&pe.c>=q[j][0].s.c&&pe.c<=q[j][0].e.c&&(w.F=q[j][1])}if(N.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(P)w.t="z";else continue;else w.t=N.t||"n";switch(m.s.c>T&&(m.s.c=T),m.e.c<T&&(m.e.c=T),w.t){case"n":if(w.v==""||w.v==null){if(!P)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!P)continue;w.t="z"}else _=Tl[parseInt(w.v,10)],w.v=_.t,w.r=_.r,d.cellHTML&&(w.h=_.h);break;case"str":w.t="s",w.v=w.v!=null?er(w.v):"",d.cellHTML&&(w.h=$x(w.v));break;case"inlineStr":b=E.match(s),w.t="s",b!=null&&(_=tg(b[1]))?(w.v=_.t,d.cellHTML&&(w.h=_.h)):w.v="";break;case"b":w.v=or(w.v);break;case"d":d.cellDates?w.v=cr(w.v,1):(w.v=Wr(cr(w.v,1)),w.t="n");break;case"e":(!d||d.cellText!==!1)&&(w.w=w.v),w.v=ZS[w.v];break}if(I=L=0,M=null,D&&N.s!==void 0&&(M=h.CellXf[N.s],M!=null&&(M.numFmtId!=null&&(I=M.numFmtId),d.cellStyles&&M.fillId!=null&&(L=M.fillId))),YE(w,I,L,d,f,h),d.cellDates&&D&&w.t=="n"&&zo(pt[I])&&(w.t="d",w.v=qu(w.v)),N.cm&&d.xlmeta){var we=(d.xlmeta.Cell||[])[+N.cm-1];we&&we.type=="XLDAPR"&&(w.D=!0)}if(Q){var B=yr(N.r);u[B.r]||(u[B.r]=[]),u[B.r][B.c]=w}else u[N.r]=w}}}}U.length>0&&(u["!rows"]=U)}})();function nz(e,t,r,s){var n=[],i=[],o=zt(e["!ref"]),l="",c,u="",d=[],m=0,f=0,h=e["!rows"],x=Array.isArray(e),p={r:u},g,b=-1;for(f=o.s.c;f<=o.e.c;++f)d[f]=br(f);for(m=o.s.r;m<=o.e.r;++m){for(i=[],u=_r(m),f=o.s.c;f<=o.e.c;++f){c=d[f]+u;var y=x?(e[m]||[])[f]:e[c];y!==void 0&&(l=sz(y,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[m])&&(p={r:u},h&&h[m]&&(g=h[m],g.hidden&&(p.hidden=1),b=-1,g.hpx?b=Kl(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(p.ht=b,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=Ue("row",i.join(""),p))}if(h)for(;m<h.length;++m)h&&h[m]&&(p={r:m+1},g=h[m],g.hidden&&(p.hidden=1),b=-1,g.hpx?b=Kl(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(p.ht=b,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=Ue("row","",p));return n.join("")}function JE(e,t,r,s){var n=[Ir,Ue("worksheet",null,{xmlns:Hi[0],"xmlns:r":$r.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=zt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Nt(d)}s||(s={}),c["!comments"]=[];var m=[];WB(c,r,e,t,n),n[n.length]=Ue("dimension",null,{ref:u}),n[n.length]=rz(c,t,e,r),t.sheetFormat&&(n[n.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=JB(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=nz(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=GB(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=QB(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=$B(c["!merges"]));var f=-1,h,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=Yt(s,-1,Jt(p[1].Target).replace(/#.*$/,""),Ct.HLINK),h["r:id"]="rId"+x),(f=p[1].Target.indexOf("#"))>-1&&(h.location=Jt(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=Jt(p[1].Tooltip)),n[n.length]=Ue("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=YB(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=us("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(x=Yt(s,-1,"../drawings/drawing"+(e+1)+".xml",Ct.DRAW),n[n.length]=Ue("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=m),c["!comments"].length>0&&(x=Yt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ct.VML),n[n.length]=Ue("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function iz(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function oz(e,t,r){var s=Ce(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=Kl(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,f=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[xt(u)];x&&(m<0&&(m=h),f=h)}m<0||(++l,s.write_shift(4,m),s.write_shift(4,f))}var p=s.l;return s.l=c,s.write_shift(4,l),s.l=p,s.length>s.l?s.slice(0,s.l):s}function lz(e,t,r,s){var n=oz(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&Fe(e,0,n)}var cz=Ki,dz=Wo;function uz(){}function mz(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=pR(e),r}function fz(e,t,r){r==null&&(r=Ce(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Wd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qS(e,r),r.slice(0,r.l)}function hz(e){var t=Ea(e);return[t]}function pz(e,t,r){return r==null&&(r=Ce(8)),Vi(t,r)}function xz(e){var t=Gi(e);return[t]}function gz(e,t,r){return r==null&&(r=Ce(4)),qi(t,r)}function vz(e){var t=Ea(e),r=e.read_shift(1);return[t,r,"b"]}function bz(e,t,r){return r==null&&(r=Ce(9)),Vi(t,r),r.write_shift(1,e.v?1:0),r}function yz(e){var t=Gi(e),r=e.read_shift(1);return[t,r,"b"]}function jz(e,t,r){return r==null&&(r=Ce(5)),qi(t,r),r.write_shift(1,e.v?1:0),r}function wz(e){var t=Ea(e),r=e.read_shift(1);return[t,r,"e"]}function Nz(e,t,r){return r==null&&(r=Ce(9)),Vi(t,r),r.write_shift(1,e.v),r}function Sz(e){var t=Gi(e),r=e.read_shift(1);return[t,r,"e"]}function Ez(e,t,r){return r==null&&(r=Ce(8)),qi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Tz(e){var t=Ea(e),r=e.read_shift(4);return[t,r,"s"]}function Cz(e,t,r){return r==null&&(r=Ce(12)),Vi(t,r),r.write_shift(4,t.v),r}function Az(e){var t=Gi(e),r=e.read_shift(4);return[t,r,"s"]}function kz(e,t,r){return r==null&&(r=Ce(8)),qi(t,r),r.write_shift(4,t.v),r}function _z(e){var t=Ea(e),r=ws(e);return[t,r,"n"]}function Iz(e,t,r){return r==null&&(r=Ce(16)),Vi(t,r),Ii(e.v,r),r}function ZE(e){var t=Gi(e),r=ws(e);return[t,r,"n"]}function Pz(e,t,r){return r==null&&(r=Ce(12)),qi(t,r),Ii(e.v,r),r}function Dz(e){var t=Ea(e),r=Xx(e);return[t,r,"n"]}function Oz(e,t,r){return r==null&&(r=Ce(12)),Vi(t,r),KS(e.v,r),r}function Rz(e){var t=Gi(e),r=Xx(e);return[t,r,"n"]}function Fz(e,t,r){return r==null&&(r=Ce(8)),qi(t,r),KS(e.v,r),r}function Lz(e){var t=Ea(e),r=qx(e);return[t,r,"is"]}function Mz(e){var t=Ea(e),r=Ns(e);return[t,r,"str"]}function Bz(e,t,r){return r==null&&(r=Ce(12+4*e.v.length)),Vi(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zz(e){var t=Gi(e),r=Ns(e);return[t,r,"str"]}function $z(e,t,r){return r==null&&(r=Ce(8+4*e.v.length)),qi(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Uz(e,t,r){var s=e.l+t,n=Ea(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=Xu(e,s-e.l,r);o[3]=vs(l,null,n,r.supbooks,r)}else e.l=s;return o}function Wz(e,t,r){var s=e.l+t,n=Ea(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=Xu(e,s-e.l,r);o[3]=vs(l,null,n,r.supbooks,r)}else e.l=s;return o}function Hz(e,t,r){var s=e.l+t,n=Ea(e);n.r=r["!row"];var i=ws(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=Xu(e,s-e.l,r);o[3]=vs(l,null,n,r.supbooks,r)}else e.l=s;return o}function Vz(e,t,r){var s=e.l+t,n=Ea(e);n.r=r["!row"];var i=Ns(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=Xu(e,s-e.l,r);o[3]=vs(l,null,n,r.supbooks,r)}else e.l=s;return o}var Gz=Ki,qz=Wo;function Kz(e,t){return t==null&&(t=Ce(4)),t.write_shift(4,e),t}function Yz(e,t){var r=e.l+t,s=Ki(e),n=Kx(e),i=Ns(e),o=Ns(e),l=Ns(e);e.l=r;var c={rfx:s,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function Xz(e,t){var r=Ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Wo({s:yr(e[0]),e:yr(e[0])},r),Yx("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return Qr(n||"",r),Qr(e[1].Tooltip||"",r),Qr("",r),r.slice(0,r.l)}function Jz(){}function Zz(e,t,r){var s=e.l+t,n=YS(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=wB(e,s-e.l,r);o[1]=l}else e.l=s;return o}function Qz(e,t,r){var s=e.l+t,n=Ki(e),i=[n];if(r.cellFormula){var o=SB(e,s-e.l,r);i[1]=o,e.l=s}else e.l=s;return i}function e$(e,t,r){r==null&&(r=Ce(18));var s=Ju(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var QE=["left","right","top","bottom","header","footer"];function t$(e){var t={};return QE.forEach(function(r){t[r]=ws(e)}),t}function r$(e,t){return t==null&&(t=Ce(48)),ji(e),QE.forEach(function(r){Ii(e[r],t)}),t}function s$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function a$(e,t,r){r==null&&(r=Ce(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function n$(e){var t=Ce(24);return t.write_shift(4,4),t.write_shift(4,1),Wo(e,t),t}function i$(e,t){return t==null&&(t=Ce(66)),t.write_shift(2,e.password?rg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function o$(){}function l$(){}function c$(e,t,r,s,n,i,o){if(!e)return e;var l=t||{};s||(s={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,f=!1,h,x,p,g,b,y,j,S,E,w=[];l.biff=12,l["!row"]=0;var N=0,C=!1,T=[],_={},k=l.supbooks||n.supbooks||[[]];if(k.sharedf=_,k.arrayf=T,k.SheetNames=n.SheetNames||n.Sheets.map(function(Q){return Q.name}),!l.supbooks&&(l.supbooks=k,n.Names))for(var I=0;I<n.Names.length;++I)k[0][I+1]=n.Names[I];var L=[],D=[],M=!1;Yl[16]={n:"BrtShortReal",f:ZE};var q;if(jn(e,function(U,le,Se){if(!f)switch(Se){case 148:u=U;break;case 0:h=U,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),S=_r(g=h.r),l["!row"]=h.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=To(U.hpt)),D[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:U[2]},U[2]){case"n":x.v=U[1];break;case"s":j=Tl[U[1]],x.v=j.t,x.r=j.r;break;case"b":x.v=!!U[1];break;case"e":x.v=U[1],l.cellText!==!1&&(x.w=wn[x.v]);break;case"str":x.t="s",x.v=U[1];break;case"is":x.t="s",x.v=U[1].t;break}if((p=o.CellXf[U[0].iStyleRef])&&YE(x,p.numFmtId,null,l,i,o),b=U[0].c==-1?b+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][b]=x):c[br(b)+S]=x,l.cellFormula){for(C=!1,N=0;N<T.length;++N){var P=T[N];h.r>=P[0].s.r&&h.r<=P[0].e.r&&b>=P[0].s.c&&b<=P[0].e.c&&(x.F=Nt(P[0]),C=!0)}!C&&U.length>3&&(x.f=U[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),l.cellDates&&p&&x.t=="n"&&zo(pt[p.numFmtId])){var G=ui(x.v);G&&(x.t="d",x.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;x={t:"z",v:void 0},b=U[0].c==-1?b+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][b]=x):c[br(b)+S]=x,d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:w.push(U);break;case 49:q=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var K=s["!id"][U.relId];for(K?(U.Target=K.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=K):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(b=U.rfx.s.c;b<=U.rfx.e.c;++b)l.dense?(c[g]||(c[g]=[]),c[g][b]||(c[g][b]={t:"z",v:void 0}),c[g][b].l=U):(y=xt({c:b,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=U);break;case 426:if(!l.cellFormula)break;T.push(U),E=l.dense?c[g][b]:c[br(b)+S],E.f=vs(U[1],d,{r:h.r,c:b},k,l),E.F=Nt(U[0]);break;case 427:if(!l.cellFormula)break;_[xt(U[0].s)]=U[1],E=l.dense?c[g][b]:c[br(b)+S],E.f=vs(U[1],d,{r:h.r,c:b},k,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)L[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},M||(M=!0,sg(U.w/256)),$n(L[U.e+1]);break;case 161:c["!autofilter"]={ref:Nt(U)};break;case 476:c["!margins"]=U;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),U.name&&(n.Sheets[r].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),U.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!le.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+Se.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Nt(u||d)),l.sheetRows&&c["!ref"]){var Z=zt(c["!ref"]);l.sheetRows<=+Z.e.r&&(Z.e.r=l.sheetRows-1,Z.e.r>d.e.r&&(Z.e.r=d.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>d.e.c&&(Z.e.c=d.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nt(Z))}return w.length>0&&(c["!merges"]=w),L.length>0&&(c["!cols"]=L),D.length>0&&(c["!rows"]=D),c}function d$(e,t,r,s,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=dr(t),t.z=t.z||pt[14],t.v=Wr(cr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:s};switch(c.s=Xn(n.cellXfs,t,n),t.l&&i["!links"].push([xt(c),t.l]),t.c&&i["!comments"].push([xt(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=lg(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?Fe(e,18,kz(t,c)):Fe(e,7,Cz(t,c))):(c.t="str",o?Fe(e,17,$z(t,c)):Fe(e,6,Bz(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Fe(e,13,Fz(t,c)):Fe(e,2,Oz(t,c)):o?Fe(e,16,Pz(t,c)):Fe(e,5,Iz(t,c)),!0;case"b":return c.t="b",o?Fe(e,15,jz(t,c)):Fe(e,4,bz(t,c)),!0;case"e":return c.t="e",o?Fe(e,14,Ez(t,c)):Fe(e,3,Nz(t,c)),!0}return o?Fe(e,12,gz(t,c)):Fe(e,1,pz(t,c)),!0}function u$(e,t,r,s){var n=zt(t["!ref"]||"A1"),i,o="",l=[];Fe(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){o=_r(d),lz(e,t,n,d);var m=!1;if(d<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){d===n.s.r&&(l[f]=br(f)),i=l[f]+o;var h=c?(t[d]||[])[f]:t[i];if(!h){m=!1;continue}m=d$(e,h,d,f,s,t,m)}}Fe(e,146)}function m$(e,t){!t||!t["!merges"]||(Fe(e,177,Kz(t["!merges"].length)),t["!merges"].forEach(function(r){Fe(e,176,qz(r))}),Fe(e,178))}function f$(e,t){!t||!t["!cols"]||(Fe(e,390),t["!cols"].forEach(function(r,s){r&&Fe(e,60,e$(s,r))}),Fe(e,391))}function h$(e,t){!t||!t["!ref"]||(Fe(e,648),Fe(e,649,n$(zt(t["!ref"]))),Fe(e,650))}function p$(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=Yt(r,-1,s[1].Target.replace(/#.*$/,""),Ct.HLINK);Fe(e,494,Xz(s,n))}}),delete t["!links"]}function x$(e,t,r,s){if(t["!comments"].length>0){var n=Yt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ct.VML);Fe(e,551,Yx("rId"+n)),t["!legacy"]=n}}function g$(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Nt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ws(i);l.s.r==l.e.r&&(l.e.r=Ws(t["!ref"]).e.r,i=Nt(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Fe(e,161,Wo(zt(i))),Fe(e,162)}}function v$(e,t,r){Fe(e,133),Fe(e,137,a$(t,r)),Fe(e,138),Fe(e,134)}function b$(e,t){t["!protect"]&&Fe(e,535,i$(t["!protect"]))}function y$(e,t,r,s){var n=Us(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=zt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Fe(n,129),(r.vbaraw||o["!outline"])&&Fe(n,147,fz(l,o["!outline"])),Fe(n,148,dz(c)),v$(n,o,r.Workbook),f$(n,o),u$(n,o,e,t),b$(n,o),g$(n,o,r,e),m$(n,o),p$(n,o,s),o["!margins"]&&Fe(n,476,r$(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&h$(n,o),x$(n,o,e,s),Fe(n,130),n.end()}function j$(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Bt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[t,n,s]}function w$(e,t,r,s,n,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var f=j$(m);d.s.r=d.s.c=0,d.e.c=l,u=br(l),f[0].forEach(function(h,x){o[u+_r(x)]={t:"n",v:h,z:f[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Nt(d)),o}function N$(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(XE);return l&&cg(l[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function S$(e,t){e.l+=10;var r=Ns(e);return{name:r}}function E$(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return jn(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var dg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],T$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],C$=[],A$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bb(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var i=t[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=or(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function zb(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=or(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function eT(e){zb(e.WBProps,dg),zb(e.CalcPr,A$),Bb(e.WBView,T$),Bb(e.Sheets,C$),po.date1904=or(e.WBProps.date1904)}function k$(e){return!e.Workbook||!e.Workbook.WBProps?"false":or(e.Workbook.WBProps.date1904)?"true":"false"}var _$="][*?/\\".split("");function tT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return _$.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function I$(e,t,r){e.forEach(function(s,n){tT(s);for(var i=0;i<n;++i)if(s==e[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[n]&&t[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function P$(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];I$(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)kB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var D$=/<\w+:workbook/;function O$(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},o=0;if(e.replace(Ts,function(c,u){var d=gt(c);switch(Za(d[0])){case"<?xml":break;case"<workbook":c.match(D$)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dg.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=or(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=er(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Bt(er(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=er(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),or(d.hidden||"0")&&(i.Hidden=!0),o=u+c.length;break;case"</definedName>":i.Ref=Bt(er(e.slice(o,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Hi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return eT(r),r}function rT(e){var t=[Ir];t[t.length]=Ue("workbook",null,{xmlns:Hi[0],"xmlns:r":$r.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(dg.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=Ue("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Jt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ue("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ue("definedName",Jt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function R$(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hp(e),r.name=Ns(e),r}function F$(e,t){return t||(t=Ce(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Yx(e.strRelID,t),Qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function L$(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ns(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function M$(e,t){t||(t=Ce(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),qS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function B$(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function z$(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=xR(e),o=NB(e,0,r),l=Kx(e);e.l=s;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function $$(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Yl[16]={n:"BrtFRTArchID$",f:B$},jn(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=vs(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),eT(r),r.Names=i,r.supbooks=o,r}function U$(e,t){Fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Fe(e,156,F$(n))}Fe(e,144)}function W$(e,t){t||(t=Ce(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qr("SheetJS",t),Qr(Fd.version,t),Qr(Fd.version,t),Qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function H$(e,t){t||(t=Ce(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function V$(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(Fe(e,135),Fe(e,158,H$(n)),Fe(e,136))}}function G$(e,t){var r=Us();return Fe(r,131),Fe(r,128,W$()),Fe(r,153,M$(e.Workbook&&e.Workbook.WBProps||null)),V$(r,e),U$(r,e),Fe(r,132),r.end()}function q$(e,t,r){return t.slice(-4)===".bin"?$$(e,r):O$(e,r)}function K$(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?c$(e,s,r,n,i,o,l):zB(e,s,r,n,i,o,l)}function Y$(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?E$(e,s,r,n,i):N$(e,s,r,n,i)}function X$(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?ZM():QM()}function J$(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?XM():JM()}function Z$(e,t,r,s){return t.slice(-4)===".bin"?qL(e,r,s):RL(e,r,s)}function Q$(e,t,r){return FE(e,r)}function e9(e,t,r){return t.slice(-4)===".bin"?eL(e,r):JF(e,r)}function t9(e,t,r){return t.slice(-4)===".bin"?VM(e,r):FM(e,r)}function r9(e,t,r){return t.slice(-4)===".bin"?DM(e):IM(e)}function s9(e,t,r,s){return r.slice(-4)===".bin"?OM(e,t,r,s):void 0}function a9(e,t,r){return t.slice(-4)===".bin"?AM(e,t,r):_M(e,t,r)}function n9(e,t,r){return(t.slice(-4)===".bin"?G$:rT)(e)}function i9(e,t,r,s,n){return(t.slice(-4)===".bin"?y$:JE)(e,r,s,n)}function o9(e,t,r){return(t.slice(-4)===".bin"?sM:OE)(e,r)}function l9(e,t,r){return(t.slice(-4)===".bin"?sL:TE)(e,r)}function c9(e,t,r){return(t.slice(-4)===".bin"?GM:BE)(e)}function d9(e){return(e.slice(-4)===".bin"?kM:LE)()}var sT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,aT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ka(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(sT),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(aT),(o=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),s[l]=i[2].slice(1,i[2].length-1));return s}function u9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(sT),n,i,o,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(aT),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var Al;function m9(e,t){var r=Al[e]||Bt(e);return r==="General"?ki(t):wa(r,t)}function f9(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=or(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=cr(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Bt(t)]=n}function h9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||wn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=ki(e.v):e.w=m9(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var s=Al[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&zo(s)){var n=ui(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function p9(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=CL[s.Pattern]||s.Pattern)}e[t.ID]=t}function x9(e,t,r,s,n,i,o,l,c,u){var d="General",m=s.StyleID,f={};u=u||{};var h=[],x=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(d=i[m].nf),i[m].Interior&&h.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=or(e);break;case"String":s.t="s",s.r=sb(Bt(e)),s.v=e.indexOf("<")>-1?Bt(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(cr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=Bt(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=ZS[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=sb(t||e));break}if(h9(s,d,u),u.cellFormula!==!1)if(s.Formula){var p=Bt(s.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),s.f=ho(p,n),delete s.Formula,s.ArrayRange=="RC"?s.F=ho("RC:RC",n):s.ArrayRange&&(s.F=ho(s.ArrayRange,n),c.push([zt(s.F),s.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(s.F=c[x][1]);u.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),s.s=f),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function g9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qm(e,t){var r=t||{};$o();var s=xl(Ux(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=er(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=dr(r);return o.type="string",Eo.to_workbook(s,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ie){n.indexOf("<"+Ie)>=0&&(i=!0)}),i)return rU(s,r);Al={"General Number":"General","General Date":pt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pt[15],"Short Date":pt[14],"Long Time":pt[19],"Medium Time":pt[18],"Short Time":pt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pt[2],Standard:pt[4],Percent:pt[10],Scientific:pt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},m=[],f=r.dense?[]:{},h="",x={},p={},g=ka('<Data ss:Type="String">'),b=0,y=0,j=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},w={},N="",C=0,T=[],_={},k={},I=0,L=[],D=[],M={},q=[],Z,Q=!1,U=[],le=[],Se={},P=0,G=0,K={Sheets:[],WBProps:{date1904:!1}},O={};Wl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";l=Wl.exec(s);)switch(l[3]=(F=l[3]).toLowerCase()){case"data":if(F=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?x9(s.slice(b,l.index),N,g,c[c.length-1][0]=="comment"?M:x,{c:y,r:j},E,q[y],p,U,r):(N="",g=ka(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(D.length>0&&(x.c=D),(!r.sheetRows||r.sheetRows>j)&&x.v!==void 0&&(r.dense?(f[j]||(f[j]=[]),f[j][y]=x):f[br(y)+_r(j)]=x),x.HRef&&(x.l={Target:Bt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(P=y+(parseInt(x.MergeAcross,10)|0),G=j+(parseInt(x.MergeDown,10)|0),T.push({s:{c:y,r:j},e:{c:P,r:G}})),!r.sheetStubs)x.MergeAcross?y=P+1:++y;else if(x.MergeAcross||x.MergeDown){for(var H=y;H<=P;++H)for(var Y=j;Y<=G;++Y)(H>y||Y>j)&&(r.dense?(f[Y]||(f[Y]=[]),f[Y][H]={t:"z"}):f[br(H)+_r(Y)]={t:"z"});y=P+1}else++y;else x=u9(l[0]),x.Index&&(y=+x.Index-1),y<S.s.c&&(S.s.c=y),y>S.e.c&&(S.e.c=y),l[0].slice(-2)==="/>"&&++y,D=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(j<S.s.r&&(S.s.r=j),j>S.e.r&&(S.e.r=j),l[0].slice(-2)==="/>"&&(p=ka(l[0]),p.Index&&(j=+p.Index-1)),y=0,++j):(p=ka(l[0]),p.Index&&(j=+p.Index-1),Se={},(p.AutoFitHeight=="0"||p.Height)&&(Se.hpx=parseInt(p.Height,10),Se.hpt=Kl(Se.hpx),le[j]=Se),p.Hidden=="1"&&(Se.hidden=!0,le[j]=Se));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));m.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(f["!ref"]=Nt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(f["!fullref"]=f["!ref"],S.e.r=r.sheetRows-1,f["!ref"]=Nt(S))),T.length&&(f["!merges"]=T),q.length>0&&(f["!cols"]=q),le.length>0&&(f["!rows"]=le),d[h]=f}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=y=0,c.push([l[3],!1]),u=ka(l[0]),h=Bt(u.Name),f=r.dense?[]:{},T=[],U=[],le=[],O={name:h,Hidden:0},K.Sheets.push(O);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),q=[],Q=!1}break;case"style":l[1]==="/"?p9(E,w,r):w=ka(l[0]);break;case"numberformat":w.nf=Bt(ka(l[0]).Format||"General"),Al[w.nf]&&(w.nf=Al[w.nf]);for(var te=0;te!=392&&pt[te]!=w.nf;++te);if(te==392){for(te=57;te!=392;++te)if(pt[te]==null){ln(w.nf,te);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Z=ka(l[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!Q&&Z.wpx>10){Q=!0,bs=PE;for(var pe=0;pe<q.length;++pe)q[pe]&&$n(q[pe])}Q&&$n(Z),q[Z.Index-1||q.length]=Z;for(var we=0;we<+Z.Span;++we)q[q.length]=dr(Z);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var B=gt(l[0]),Be={Name:B.Name,Ref:ho(B.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Be.Sheet=K.Sheets.length-1),K.Names.push(Be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?N+=s.slice(C,l.index):C=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;w.Interior=ka(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?$R(_,F,s.slice(I,l.index)):I=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));g9(M),D.push(M)}else c.push([l[3],!1]),u=ka(l[0]),M={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var fe=ka(l[0]);f["!autofilter"]={ref:ho(fe.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Vb(s,r);var oe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:oe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:oe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:oe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:oe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(I,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else I=l.index+l[0].length;break;case"header":f["!margins"]||ji(f["!margins"]={},"xlml"),isNaN(+gt(l[0]).Margin)||(f["!margins"].header=+gt(l[0]).Margin);break;case"footer":f["!margins"]||ji(f["!margins"]={},"xlml"),isNaN(+gt(l[0]).Margin)||(f["!margins"].footer=+gt(l[0]).Margin);break;case"pagemargins":var ge=gt(l[0]);f["!margins"]||ji(f["!margins"]={},"xlml"),isNaN(+ge.Top)||(f["!margins"].top=+ge.Top),isNaN(+ge.Left)||(f["!margins"].left=+ge.Left),isNaN(+ge.Right)||(f["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(f["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:oe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:oe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:oe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:oe=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:oe=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:oe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:oe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:oe=!1}break;case"smarttags":break;default:oe=!1;break}if(oe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?f9(k,F,L,s.slice(I,l.index)):(L=l,I=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ue={};return!r.bookSheets&&!r.bookProps&&(ue.Sheets=d),ue.SheetNames=m,ue.Workbook=K,ue.SSF=dr(pt),ue.Props=_,ue.Custprops=k,ue}function jp(e,t){switch(mg(t=t||{}),t.type||"base64"){case"base64":return qm(ta(e),t);case"binary":case"buffer":case"file":return qm(e,t);case"array":return qm(Kn(e),t)}}function v9(e,t){var r=[];return e.Props&&r.push(UR(e.Props,t)),e.Custprops&&r.push(WR(e.Props,e.Custprops)),r.join("")}function b9(){return""}function y9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":Jt(pt[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Ue("Style",i.join(""),o))}),Ue("Styles",r.join(""))}function nT(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ig(e.Ref,{r:0,c:0})})}function j9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(nT(n)))}return Ue("Names",r.join(""))}function w9(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(nT(l)))}return i.join("")}function N9(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(Ue("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(us("ProtectContents","True")),e["!protect"].objects&&n.push(us("ProtectObjects","True")),e["!protect"].scenarios&&n.push(us("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(us("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(us("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Ue("WorksheetOptions",n.join(""),{xmlns:Ks.x})}function S9(e){return e.map(function(t){var r=V6(t.t||""),s=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",s,{"ss:Author":t.a})}).join("")}function E9(e,t,r,s,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Jt(ig(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=yr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Jt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",f="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=wn[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||pt[14]);break;case"s":m="String",f=H6(e.v||"");break}var h=Xn(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var x=e.v!=null?f:"",p=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=S9(e.c)),Ue("Cell",p,l)}function T9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=To(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function C9(e,t,r,s){if(!e["!ref"])return"";var n=zt(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,b){$n(g);var y=!!g.width,j=Ju(b,g),S={"ss:Index":b+1};y&&(S["ss:Width"]=Gl(j.width)),g.hidden&&(S["ss:Hidden"]="1"),l.push(Ue("Column",null,S))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[T9(u,(e["!rows"]||[])[u])],m=n.s.c;m<=n.e.c;++m){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>m)&&!(i[o].s.r>u)&&!(i[o].e.c<m)&&!(i[o].e.r<u)){(i[o].s.c!=m||i[o].s.r!=u)&&(f=!0);break}if(!f){var h={r:u,c:m},x=xt(h),p=c?(e[u]||[])[m]:e[x];d.push(E9(p,x,e,t,r,s,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function A9(e,t,r){var s=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?w9(i,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?C9(i,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(N9(i,t,e,r)),s.join("")}function k9(e,t){t||(t={}),e.SSF||(e.SSF=dr(pt)),e.SSF&&($o(),Hu(e.SSF),t.revssf=Gu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Xn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(v9(e,t)),r.push(b9()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(Ue("Worksheet",A9(s,t,e),{"ss:Name":Jt(e.SheetNames[s])}));return r[2]=y9(e,t),r[3]=j9(e),Ir+Ue("Workbook",r.join(""),{xmlns:Ks.ss,"xmlns:o":Ks.o,"xmlns:x":Ks.x,"xmlns:ss":Ks.ss,"xmlns:dt":Ks.dt,"xmlns:html":Ks.html})}function _9(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=jR(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=wR(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var I9=[60,1084,2066,2165,2175];function P9(e,t,r,s,n){var i=s,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=sn(r,r.l),u=wp[c],d=0;u!=null&&I9.indexOf(c)>-1;)i=sn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+i),o.push(l),r.l+=4+i,u=wp[c=sn(r,r.l)];var m=Zr(o);cs(m,0);var f=0;m.lens=[];for(var h=0;h<o.length;++h)m.lens.push(f),f+=o[h].length;if(m.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+s;return t.f(m,m.length,n)}function Ua(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=pt[s])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||wn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=ki(e.v):e.w=wa(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&e.t=="n"&&zo(pt[s]||String(s))){var n=ui(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function nd(e,t,r){return{v:e,ixfe:t,t:r}}function D9(e,t){var r={opts:{}},s={},n=t.dense?[]:{},i={},o={},l=null,c=[],u="",d={},m,f="",h,x,p,g,b={},y=[],j,S,E=[],w=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},T=function(me){return me<8?vi[me]:me<64&&w[me-8]||vi[me]},_=function(me,xe,Oe){var ot=xe.XF.data;if(!(!ot||!ot.patternType||!Oe||!Oe.cellStyles)){xe.s={},xe.s.patternType=ot.patternType;var tt;(tt=Vl(T(ot.icvFore)))&&(xe.s.fgColor={rgb:tt}),(tt=Vl(T(ot.icvBack)))&&(xe.s.bgColor={rgb:tt})}},k=function(me,xe,Oe){if(!(Se>1)&&!(Oe.sheetRows&&me.r>=Oe.sheetRows)){if(Oe.cellStyles&&xe.XF&&xe.XF.data&&_(me,xe,Oe),delete xe.ixfe,delete xe.XF,m=me,f=xt(me),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),me.r<o.s.r&&(o.s.r=me.r),me.c<o.s.c&&(o.s.c=me.c),me.r+1>o.e.r&&(o.e.r=me.r+1),me.c+1>o.e.c&&(o.e.c=me.c+1),Oe.cellFormula&&xe.f){for(var ot=0;ot<y.length;++ot)if(!(y[ot][0].s.c>me.c||y[ot][0].s.r>me.r)&&!(y[ot][0].e.c<me.c||y[ot][0].e.r<me.r)){xe.F=Nt(y[ot][0]),(y[ot][0].s.c!=me.c||y[ot][0].s.r!=me.r)&&delete xe.f,xe.f&&(xe.f=""+vs(y[ot][1],o,me,U,I));break}}Oe.dense?(n[me.r]||(n[me.r]=[]),n[me.r][me.c]=xe):n[f]=xe}},I={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var L,D=[],M=[],q=[],Z=[],Q=!1,U=[];U.SheetNames=I.snames,U.sharedf=I.sharedf,U.arrayf=I.arrayf,U.names=[],U.XTI=[];var le=0,Se=0,P=0,G=[],K=[],O;I.codepage=1200,Da(1200);for(var F=!1;e.l<e.length-1;){var H=e.l,Y=e.read_shift(2);if(Y===0&&le===10)break;var te=e.l===e.length?0:e.read_shift(2),pe=wp[Y];if(pe&&pe.f){if(t.bookSheets&&le===133&&Y!==133)break;if(le=Y,pe.r===2||pe.r==12){var we=e.read_shift(2);if(te-=2,!I.enc&&we!==Y&&((we&255)<<8|we>>8)!==Y)throw new Error("rt mismatch: "+we+"!="+Y);pe.r==12&&(e.l+=10,te-=10)}var B={};if(Y===10?B=pe.f(e,te,I):B=P9(Y,pe,e,te,I),Se==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(Y){case 34:r.opts.Date1904=N.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=B;break;case 66:var Be=Number(B);switch(Be){case 21010:Be=1200;break;case 32768:Be=1e4;break;case 32769:Be=1252;break}Da(I.codepage=Be),F=!0;break;case 317:I.rrtabid=B;break;case 25:I.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:I.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(n["!type"]="dialog"),B.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),B.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:E.push(B);break;case 430:U.push([B]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(B);break;case 24:case 536:O={Name:B.Name,Ref:vs(B.rgce,o,null,U,I)},B.itab>0&&(O.Sheet=B.itab-1),U.names.push(O),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(K[B.itab-1]={ref:Nt(B.rgce[0][0][1][2])});break;case 22:I.ExternCount=B;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(B),U.XTI=U.XTI.concat(B);break;case 2196:if(I.biff<8)break;O!=null&&(O.Comment=B[1]);break;case 18:n["!protect"]=B;break;case 19:B!==0&&I.WTF&&console.error("Password verifier: "+B);break;case 133:i[B.pos]=B,I.snames.push(B.name);break;case 10:{if(--Se)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Nt(o),t.sheetRows&&t.sheetRows<=o.e.r){var fe=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Nt(o),o.e.r=fe}o.e.r++,o.e.c++}D.length>0&&(n["!merges"]=D),M.length>0&&(n["!objects"]=M),q.length>0&&(n["!cols"]=q),Z.length>0&&(n["!rows"]=Z),N.Sheets.push(C)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),I.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(I.biff=5,F=!0,Da(I.codepage=28591)),I.biff==8&&B.BIFFVer==0&&B.dt==16&&(I.biff=2),Se++)break;if(n=t.dense?[]:{},I.biff<8&&!F&&(F=!0,Da(I.codepage=t.codepage||1252)),I.biff<5||B.BIFFVer==0&&B.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var oe={pos:e.l-te,name:u};i[oe.pos]=oe,I.snames.push(u)}else u=(i[H]||{name:""}).name;B.dt==32&&(n["!type"]="chart"),B.dt==64&&(n["!type"]="macro"),D=[],M=[],I.arrayf=y=[],q=[],Z=[],Q=!1,C={Hidden:(i[H]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[B.r]||[])[B.c]:n[xt({c:B.c,r:B.r})])&&++B.c,j={ixfe:B.ixfe,XF:E[B.ixfe]||{},v:B.val,t:"n"},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t);break;case 5:case 517:j={ixfe:B.ixfe,XF:E[B.ixfe],v:B.val,t:B.t},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t);break;case 638:j={ixfe:B.ixfe,XF:E[B.ixfe],v:B.rknum,t:"n"},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t);break;case 189:for(var ge=B.c;ge<=B.C;++ge){var ue=B.rkrec[ge-B.c][0];j={ixfe:ue,XF:E[ue],v:B.rkrec[ge-B.c][1],t:"n"},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:ge,r:B.r},j,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){l=B;break}if(j=nd(B.val,B.cell.ixfe,B.tt),j.XF=E[j.ixfe],t.cellFormula){var Ie=B.formula;if(Ie&&Ie[0]&&Ie[0][0]&&Ie[0][0][0]=="PtgExp"){var Le=Ie[0][0][1][0],he=Ie[0][0][1][1],Me=xt({r:Le,c:he});b[Me]?j.f=""+vs(B.formula,o,B.cell,U,I):j.F=((t.dense?(n[Le]||[])[he]:n[Me])||{}).F}else j.f=""+vs(B.formula,o,B.cell,U,I)}P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k(B.cell,j,t),l=B}break;case 7:case 519:if(l)l.val=B,j=nd(B,l.cell.ixfe,"s"),j.XF=E[j.ixfe],t.cellFormula&&(j.f=""+vs(l.formula,o,l.cell,U,I)),P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k(l.cell,j,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(B);var Ge=xt(B[0].s);if(h=t.dense?(n[B[0].s.r]||[])[B[0].s.c]:n[Ge],t.cellFormula&&h){if(!l||!Ge||!h)break;h.f=""+vs(B[1],o,B[0],U,I),h.F=Nt(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;b[xt(l.cell)]=B[0],h=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[xt(l.cell)],(h||{}).f=""+vs(B[0],o,m,U,I)}}break;case 253:j=nd(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(j.h=c[B.isst].h),j.XF=E[j.ixfe],P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t);break;case 513:t.sheetStubs&&(j={ixfe:B.ixfe,XF:E[B.ixfe],t:"z"},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t));break;case 190:if(t.sheetStubs)for(var Ke=B.c;Ke<=B.C;++Ke){var We=B.ixfe[Ke-B.c];j={ixfe:We,XF:E[We],t:"z"},P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:Ke,r:B.r},j,t)}break;case 214:case 516:case 4:j=nd(B.val,B.ixfe,"s"),j.XF=E[j.ixfe],P>0&&(j.z=G[j.ixfe>>8&63]),Ua(j,t,r.opts.Date1904),k({c:B.c,r:B.r},j,t);break;case 0:case 512:Se===1&&(o=B);break;case 252:c=B;break;case 1054:if(I.biff==4){G[P++]=B[1];for(var yt=0;yt<P+163&&pt[yt]!=B[1];++yt);yt>=163&&ln(B[1],P+163)}else ln(B[1],B[0]);break;case 30:{G[P++]=B;for(var Xe=0;Xe<P+163&&pt[Xe]!=B;++Xe);Xe>=163&&ln(B,P+163)}break;case 229:D=D.concat(B);break;case 93:M[B.cmo[0]]=I.lastobj=B;break;case 438:I.lastobj.TxO=B;break;case 127:I.lastobj.ImData=B;break;case 440:for(g=B[0].s.r;g<=B[0].e.r;++g)for(p=B[0].s.c;p<=B[0].e.c;++p)h=t.dense?(n[g]||[])[p]:n[xt({c:p,r:g})],h&&(h.l=B[1]);break;case 2048:for(g=B[0].s.r;g<=B[0].e.r;++g)for(p=B[0].s.c;p<=B[0].e.c;++p)h=t.dense?(n[g]||[])[p]:n[xt({c:p,r:g})],h&&h.l&&(h.l.Tooltip=B[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;h=t.dense?(n[B[0].r]||[])[B[0].c]:n[xt(B[0])];var Je=M[B[2]];h||(t.dense?(n[B[0].r]||(n[B[0].r]=[]),h=n[B[0].r][B[0].c]={t:"z"}):h=n[xt(B[0])]={t:"z"},o.e.r=Math.max(o.e.r,B[0].r),o.s.r=Math.min(o.s.r,B[0].r),o.e.c=Math.max(o.e.c,B[0].c),o.s.c=Math.min(o.s.c,B[0].c)),h.c||(h.c=[]),x={a:B[1],t:Je.TxO.t},h.c.push(x)}break;case 2173:yM(E[B.ixfe],B.ext);break;case 125:{if(!I.cellStyles)break;for(;B.e>=B.s;)q[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},Q||(Q=!0,sg(B.w/256)),$n(q[B.e+1])}break;case 520:{var Ye={};B.level!=null&&(Z[B.r]=Ye,Ye.level=B.level),B.hidden&&(Z[B.r]=Ye,Ye.hidden=!0),B.hpt&&(Z[B.r]=Ye,Ye.hpt=B.hpt,Ye.hpx=To(B.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ji(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=B;break;case 161:n["!margins"]||ji(n["!margins"]={}),n["!margins"].header=B.header,n["!margins"].footer=B.footer;break;case 574:B.RTL&&(N.Views[0].RTL=!0);break;case 146:w=B;break;case 2198:L=B;break;case 140:S=B;break;case 442:u?C.CodeName=B||C.name:N.WBProps.CodeName=B||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=te}return r.SheetNames=Cr(i).sort(function(at,me){return Number(at)-Number(me)}).map(function(at){return i[at].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(at,me){r.Sheets[r.SheetNames[me]]["!autofilter"]=at}),r.Strings=c,r.SSF=dr(pt),I.enc&&(r.Encryption=I.enc),L&&(r.Themes=L),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),U.names.length>0&&(N.Names=U.names),r.Workbook=N,r}var kl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function O9(e,t,r){var s=mt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=jb(s,pp,kl.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var o=mt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=jb(o,xp,kl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(aE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function R9(e,t){var r=[],s=[],n=[],i=0,o,l=J1(pp,"n"),c=J1(xp,"n");if(e.Props)for(o=Cr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Cr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<n.length;++i)uE.indexOf(n[i][0])>-1||sE.indexOf(n[i][0])>-1||n[i][1]!=null&&u.push(n[i]);s.length&&mt.utils.cfb_add(t,"/SummaryInformation",wb(s,kl.SI,c,xp)),(r.length||u.length)&&mt.utils.cfb_add(t,"/DocumentSummaryInformation",wb(r,kl.DSI,l,pp,u.length?u:null,kl.UDI))}function iT(e,t){t||(t={}),mg(t),Dx(),t.codepage&&Px(t.codepage);var r,s;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),s=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=Xs(ta(e));break;case"binary":e=Xs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cs(e,0),s={content:e}}var n,i;if(r&&_9(r),t.bookProps&&!t.bookSheets)n={};else{var o=Tt?"buffer":"array";if(s&&s.content)n=D9(s.content,t);else if((i=mt.find(e,"PerfectOffice_MAIN"))&&i.content)n=yi.to_workbook(i.content,(t.type=o,t));else if((i=mt.find(e,"NativeContent_MAIN"))&&i.content)n=yi.to_workbook(i.content,(t.type=o,t));else throw(i=mt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=KM(e))}var l={};return e.FullPaths&&O9(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function F9(e,t){var r=t||{},s=mt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mt.utils.cfb_add(s,n,oT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&R9(e,s),r.biff==8&&e.vbaraw&&YM(s,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Yl={0:{f:iz},1:{f:hz},2:{f:Dz},3:{f:wz},4:{f:vz},5:{f:_z},6:{f:Mz},7:{f:Tz},8:{f:Vz},9:{f:Hz},10:{f:Uz},11:{f:Wz},12:{f:xz},13:{f:Rz},14:{f:Sz},15:{f:yz},16:{f:ZE},17:{f:zz},18:{f:Az},19:{f:qx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:z$},40:{},42:{},43:{f:ML},44:{f:FL},45:{f:$L},46:{f:WL},47:{f:UL},48:{},49:{f:cR},50:{},51:{f:NM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wE},62:{f:Lz},63:{f:PM},64:{f:o$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Es,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:s$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mz},148:{f:cz,p:16},151:{f:Jz},152:{},153:{f:L$},154:{},155:{},156:{f:R$},157:{},158:{},159:{T:1,f:QF},160:{T:-1},161:{T:1,f:Ki},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Gz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:jM},336:{T:-1},337:{f:TM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Zz},427:{f:Qz},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:t$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uz},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Yz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:WM},633:{T:1},634:{T:-1},635:{T:1,f:$M},636:{T:-1},637:{f:fR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:S$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:l$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wp={6:{f:Vm},10:{f:In},12:{f:Rr},13:{f:Rr},14:{f:Ar},15:{f:Ar},16:{f:ws},17:{f:Ar},18:{f:Ar},19:{f:Rr},20:{f:Ab},21:{f:Ab},23:{f:jE},24:{f:_b},25:{f:Ar},26:{},27:{},28:{f:lF},29:{},34:{f:Ar},35:{f:kb},38:{f:ws},39:{f:ws},40:{f:ws},41:{f:ws},42:{f:Ar},43:{f:Ar},47:{f:yL},49:{f:R8},51:{f:Rr},60:{},61:{f:_8},64:{f:Ar},65:{f:O8},66:{f:Rr},77:{},80:{},81:{},82:{},85:{f:Rr},89:{},90:{},91:{},92:{f:b8},93:{f:uF},94:{},95:{f:Ar},96:{},97:{},99:{f:Ar},125:{f:wE},128:{f:X8},129:{f:j8},130:{f:Rr},131:{f:Ar},132:{f:Ar},133:{f:w8},134:{},140:{f:bF},141:{f:Rr},144:{},146:{f:wF},151:{},152:{},153:{},154:{},155:{},156:{f:Rr},157:{},158:{},160:{f:kF},161:{f:EF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:G8},190:{f:q8},193:{f:In},197:{},198:{},199:{},200:{},201:{},202:{f:Ar},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rr},220:{},221:{f:Ar},222:{},224:{f:Y8},225:{f:v8},226:{f:In},227:{},229:{f:cF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:S8},253:{f:L8},255:{f:T8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ar},353:{f:In},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tF},431:{f:Ar},432:{},433:{},434:{},437:{},438:{f:hF},439:{f:Ar},440:{f:pF},441:{},442:{f:wc},443:{},444:{f:Rr},445:{},446:{},448:{f:In},449:{f:k8,r:2},450:{f:In},512:{f:Eb},513:{f:AF},515:{f:Q8},516:{f:B8},517:{f:Cb},519:{f:_F},520:{f:C8},523:{},545:{f:Ib},549:{f:Sb},566:{},574:{f:P8},638:{f:V8},659:{},1048:{},1054:{f:$8},1084:{},1212:{f:nF},2048:{f:gF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:rd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:In},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:NF,r:12},2173:{f:bM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ar,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:aF,r:12},2197:{},2198:{f:fM,r:12},2199:{},2200:{},2201:{},2202:{f:iF,r:12},2203:{f:In},2204:{},2205:{},2206:{},2207:{},2211:{f:A8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:jF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Eb},1:{},2:{f:RF},3:{f:DF},4:{f:PF},5:{f:Cb},7:{f:LF},8:{},9:{f:rd},11:{},22:{f:Rr},30:{f:W8},31:{},32:{},33:{f:Ib},36:{},37:{f:Sb},50:{f:MF},62:{},52:{},67:{},68:{f:Rr},69:{},86:{},126:{},127:{f:IF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BF},223:{},234:{},354:{},421:{},518:{f:Vm},521:{f:rd},536:{f:_b},547:{f:kb},561:{},579:{},1030:{f:Vm},1033:{f:rd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(e,t,r,s){var n=t;if(!isNaN(n)){var i=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&Hx(r)&&e.push(r)}}function L9(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return He(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Tc(e,t,r){return e||(e=Ce(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function M9(e,t,r,s){var n=Ce(9);return Tc(n,e,t),fE(r,s||"b",n),n}function B9(e,t,r){var s=Ce(8+2*r.length);return Tc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function z9(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Wr(cr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?He(e,2,FF(r,s,n)):He(e,3,OF(r,s,n));return;case"b":case"e":He(e,5,M9(r,s,t.v,t.t));return;case"s":case"str":He(e,4,B9(r,s,(t.v||"").slice(0,255)));return}He(e,1,Tc(null,r,s))}function $9(e,t,r,s){var n=Array.isArray(t),i=zt(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Nt(i)}for(var u=i.s.r;u<=i.e.r;++u){l=_r(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=br(d)),o=c[d]+l;var m=n?(t[u]||[])[d]:t[o];m&&z9(e,m,u,d)}}}function U9(e,t){for(var r=t||{},s=Us(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return He(s,r.biff==4?1033:r.biff==3?521:9,eg(e,16,r)),$9(s,e.Sheets[e.SheetNames[n]],n,r),He(s,10),s.end()}function W9(e,t,r){He(e,49,F8({sz:12,name:"Arial"},r))}function H9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&He(e,1054,U8(n,t[n],r))})}function V9(e,t){var r=Ce(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),He(e,2151,r),r=Ce(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),vE(zt(t["!ref"]||"A1"),r),r.write_shift(4,4),He(e,2152,r)}function G9(e,t){for(var r=0;r<16;++r)He(e,224,Tb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){He(e,224,Tb(s,0,t))})}function q9(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];He(e,440,xF(s)),s[1].Tooltip&&He(e,2048,vF(s))}delete t["!links"]}function K9(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&He(e,125,SF(Ju(n,s),n))})}}function Y9(e,t,r,s,n){var i=16+Xn(n.cellXfs,t,n);if(t.v==null&&!t.bf){He(e,513,Di(r,s,i));return}if(t.bf)He(e,6,jB(t,r,s,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Wr(cr(t.v)):t.v;He(e,515,eF(r,s,o,i));break;case"b":case"e":He(e,517,Z8(r,s,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=lg(n.Strings,t.v,n.revStrings);He(e,253,M8(r,s,l,i))}else He(e,516,z8(r,s,(t.v||"").slice(0,255),i,n));break;default:He(e,513,Di(r,s,i))}}function X9(e,t,r){var s=Us(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,m="",f=[],h=zt(i["!ref"]||"A1"),x=u?65536:16384;if(h.e.c>255||h.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,x-1)}He(s,2057,eg(r,16,t)),He(s,13,xa(1)),He(s,12,xa(100)),He(s,15,ks(!0)),He(s,17,ks(!1)),He(s,16,Ii(.001)),He(s,95,ks(!0)),He(s,42,ks(!1)),He(s,43,ks(!1)),He(s,130,xa(1)),He(s,128,J8()),He(s,131,ks(!1)),He(s,132,ks(!1)),u&&K9(s,i["!cols"]),He(s,512,H8(h,t)),u&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){m=_r(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(f[g]=br(g)),d=f[g]+m;var b=c?(i[p]||[])[g]:i[d];b&&(Y9(s,b,p,g,t),u&&b.l&&i["!links"].push([d,b.l]))}}var y=l.CodeName||l.name||n;return u&&He(s,574,D8((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&He(s,229,dF(i["!merges"])),u&&q9(s,i),He(s,442,hE(y)),u&&V9(s,i),He(s,10),s.end()}function J9(e,t,r){var s=Us(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(He(s,2057,eg(e,5,r)),r.bookType=="xla"&&He(s,135),He(s,225,l?xa(1200):null),He(s,193,ZR(2)),c&&He(s,191),c&&He(s,192),He(s,226),He(s,92,y8("SheetJS",r)),He(s,66,xa(l?1200:1252)),l&&He(s,353,xa(0)),l&&He(s,448),He(s,317,CF(e.SheetNames.length)),l&&e.vbaraw&&He(s,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";He(s,442,hE(u))}He(s,156,xa(17)),He(s,25,ks(!1)),He(s,18,ks(!1)),He(s,19,xa(0)),l&&He(s,431,ks(!1)),l&&He(s,444,xa(0)),He(s,61,I8()),He(s,64,ks(!1)),He(s,141,xa(0)),He(s,34,ks(k$(e)=="true")),He(s,14,ks(!0)),l&&He(s,439,ks(!1)),He(s,218,xa(0)),W9(s,e,r),H9(s,e.SSF,r),G9(s,r),l&&He(s,352,ks(!1));var d=s.end(),m=Us();l&&He(m,140,yF()),l&&r.Strings&&L9(m,252,E8(r.Strings)),He(m,10);var f=m.end(),h=Us(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=d.length+x+f.length;for(p=0;p<e.SheetNames.length;++p){var b=i[p]||{};He(h,133,N8({pos:g,hs:b.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var y=h.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var j=[];return d.length&&j.push(d),y.length&&j.push(y),f.length&&j.push(f),Zr(j)}function Z9(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=dr(pt)),e&&e.SSF&&($o(),Hu(e.SSF),r.revssf=Gu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fg(r),r.cellXfs=[],Xn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=X9(n,r,e);return s.unshift(J9(e,s,r)),Zr(s)}function oT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Ws(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Z9(e,t);case 4:case 3:case 2:return U9(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function $b(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,l=i&&i.index||e.length,c=F6(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,m=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var b=p.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var y=b[l].trim();if(y.match(/<t[dh]/i)){for(var j=y,S=0;j.charAt(0)=="<"&&(S=j.indexOf(">"))>-1;)j=j.slice(S+1);for(var E=0;E<x.length;++E){var w=x[E];w.s.c==d&&w.s.r<u&&u<=w.e.r&&(d=w.e.c+1,E=-1)}var N=gt(y.slice(0,y.indexOf(">")));f=N.colspan?+N.colspan:1,((m=+N.rowspan)>1||f>1)&&x.push({s:{r:u,c:d},e:{r:u+(m||1)-1,c:d+f-1}});var C=N.t||N["data-t"]||"";if(!j.length){d+=f;continue}if(j=IS(j),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!j.length){d+=f;continue}var T={t:"s",v:j};r.raw||!j.trim().length||C=="s"||(j==="TRUE"?T={t:"b",v:!0}:j==="FALSE"?T={t:"b",v:!1}:isNaN(Fa(j))?isNaN(So(j).getDate())||(T={t:"d",v:cr(j)},r.cellDates||(T={t:"n",v:Wr(T.v)}),T.z=r.dateNF||pt[14]):T={t:"n",v:Fa(j)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=T):s[xt({r:u,c:d})]=T,d+=f}}}}return s["!ref"]=Nt(h),x.length&&(s["!merges"]=x),s}function Q9(e,t,r,s){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>o)&&!(n[u].e.r<r||n[u].e.c<o)){if(n[u].s.r<r||n[u].s.c<o){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=xt({r,c:o}),m=s.dense?(e[r]||[])[o]:e[d],f=m&&m.v!=null&&(m.h||$x(m.w||(pn(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),s.editable?f='<span contenteditable="true">'+f+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),h.id=(s.id||"sjs")+"-"+d,i.push(Ue("td",f,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var eU='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tU="</body></html>";function rU(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Yn($b(r[0],t),t);var s=gg();return r.forEach(function(n,i){vg(s,$b(n,t),"Sheet"+(i+1))}),s}function sU(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lT(e,t){var r=t||{},s=r.header!=null?r.header:eU,n=r.footer!=null?r.footer:tU,i=[s],o=Ws(e["!ref"]);r.dense=Array.isArray(e),i.push(sU(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(Q9(e,o,l,r));return i.push("</table>"+n),i.join("")}function cT(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?yr(s.origin):s.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=Ws(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var m=[],f=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,b=0,y=0,j=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var S=l[x];if(Ub(S)){if(s.display)continue;h[p]={hidden:!0}}var E=S.children;for(g=b=0;g<E.length;++g){var w=E[g];if(!(s.display&&Ub(w))){var N=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):IS(w.innerHTML),C=w.getAttribute("data-z")||w.getAttribute("z");for(f=0;f<m.length;++f){var T=m[f];T.s.c==b+i&&T.s.r<p+n&&p+n<=T.e.r&&(b=T.e.c+1-i,f=-1)}j=+w.getAttribute("colspan")||1,((y=+w.getAttribute("rowspan")||1)>1||j>1)&&m.push({s:{r:p+n,c:b+i},e:{r:p+n+(y||1)-1,c:b+i+(j||1)-1}});var _={t:"s",v:N},k=w.getAttribute("data-t")||w.getAttribute("t")||"";N!=null&&(N.length==0?_.t=k||"z":s.raw||N.trim().length==0||k=="s"||(N==="TRUE"?_={t:"b",v:!0}:N==="FALSE"?_={t:"b",v:!1}:isNaN(Fa(N))?isNaN(So(N).getDate())||(_={t:"d",v:cr(N)},s.cellDates||(_={t:"n",v:Wr(_.v)}),_.z=s.dateNF||pt[14]):_={t:"n",v:Fa(N)})),_.z===void 0&&C!=null&&(_.z=C);var I="",L=w.getElementsByTagName("A");if(L&&L.length)for(var D=0;D<L.length&&!(L[D].hasAttribute("href")&&(I=L[D].getAttribute("href"),I.charAt(0)!="#"));++D);I&&I.charAt(0)!="#"&&(_.l={Target:I}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][b+i]=_):e[xt({c:b+i,r:p+n})]=_,u.e.c<b+i&&(u.e.c=b+i),b+=j}}++p}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=Nt(u),p>=c&&(e["!fullref"]=Nt((u.e.r=l.length-x+p-1+n,u))),e}function dT(e,t){var r=t||{},s=r.dense?[]:{};return cT(s,e,t)}function aU(e,t){return Yn(dT(e,t),t)}function Ub(e){var t="",r=nU(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function nU(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iU(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Bt(t.replace(/<[^>]*>/g,""));return[r]}var Wb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uT(e,t){var r=t||{},s=Ux(e),n=[],i,o,l={name:""},c="",u=0,d,m,f={},h=[],x=r.dense?[]:{},p,g,b={value:""},y="",j=0,S=[],E=-1,w=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,T={},_=[],k={},I=0,L=0,D=[],M=1,q=1,Z=[],Q={Names:[]},U={},le=["",""],Se=[],P={},G="",K=0,O=!1,F=!1,H=0;for(Wl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Wl.exec(s);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?x["!ref"]=Nt(N):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=Nt(N)),_.length&&(x["!merges"]=_),D.length&&(x["!rows"]=D),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),f[d.name]=x,F=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=gt(p[0],!1),E=w=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,x=r.dense?[]:{},_=[],D=[],F=!0);break;case"table-row-group":p[1]==="/"?--C:++C;break;case"table-row":case"":if(p[1]==="/"){E+=M,M=1;break}if(m=gt(p[0],!1),m.?E=m.-1:E==-1&&(E=0),M=+m["number-rows-repeated"]||1,M<10)for(H=0;H<M;++H)C>0&&(D[E+H]={level:C});w=-1;break;case"covered-table-cell":p[1]!=="/"&&++w,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][w]={t:"z"}):x[xt({r:E,c:w})]={t:"z"}),y="",S=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++w,b=gt(p[0],!1),q=parseInt(b["number-columns-repeated"]||"1",10),g={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(g.f=Mb(Bt(b.formula))),(b.||b["value-type"])=="string"&&(g.t="s",g.v=Bt(b["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][w]=g):x[xt({r:E,c:w})]=g),w+=q-1;else if(p[1]!=="/"){++w,y="",j=0,S=[],q=1;var Y=M?E+M-1:E;if(w>N.e.c&&(N.e.c=w),w<N.s.c&&(N.s.c=w),E<N.s.r&&(N.s.r=E),Y>N.e.r&&(N.e.r=Y),b=gt(p[0],!1),Se=[],P={},g={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Bt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(I=parseInt(b["number-matrix-rows-spanned"],10)||0,L=parseInt(b["number-matrix-columns-spanned"],10)||0,k={s:{r:E,c:w},e:{r:E+I-1,c:w+L-1}},g.F=Nt(k),Z.push([k,g.F])),b.formula)g.f=Mb(b.formula);else for(H=0;H<Z.length;++H)E>=Z[H][0].s.r&&E<=Z[H][0].e.r&&w>=Z[H][0].s.c&&w<=Z[H][0].e.c&&(g.F=Z[H][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(I=parseInt(b["number-rows-spanned"],10)||0,L=parseInt(b["number-columns-spanned"],10)||0,k={s:{r:E,c:w},e:{r:E+I-1,c:w+L-1}},_.push(k)),b["number-columns-repeated"]&&(q=parseInt(b["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=or(b["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(b.value);break;case"percentage":g.t="n",g.v=parseFloat(b.value);break;case"currency":g.t="n",g.v=parseFloat(b.value);break;case"date":g.t="d",g.v=cr(b["date-value"]),r.cellDates||(g.t="n",g.v=Wr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=D6(b["time-value"])/86400,r.cellDates&&(g.t="d",g.v=qu(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(b.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",b["string-value"]!=null&&(y=Bt(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(O=!1,g.t==="s"&&(g.v=y||"",S.length&&(g.R=S),O=j==0),U.Target&&(g.l=U),Se.length>0&&(g.c=Se,Se=[]),y&&r.cellText!==!1&&(g.w=y),O&&(g.t="z",delete g.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var te=0;te<M;++te){if(q=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(x[E+te]||(x[E+te]=[]),x[E+te][w]=te==0?g:dr(g);--q>0;)x[E+te][w+q]=dr(g);else for(x[xt({r:E+te,c:w})]=g;--q>0;)x[xt({r:E+te,c:w+q})]=dr(g);N.e.c<=w&&(N.e.c=w)}q=parseInt(b["number-columns-repeated"]||"1",10),w+=q-1,q=0,g={},y="",S=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;P.t=y,S.length&&(P.R=S),P.a=G,Se.push(P)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);G="",K=0,y="",j=0,S=[];break;case"creator":p[1]==="/"?G=s.slice(K,p.index):K=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);y="",j=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(T[l.name]=c,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=gt(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=gt(p[0],!1),c+=Wb[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=gt(p[0],!1),c+=Wb[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=gt(p[0],!1),le=Gm(o["cell-range-address"]);var pe={Name:o.name,Ref:le[0]+"!"+le[1]};F&&(pe.Sheet=h.length),Q.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!b||!b["string-value"])){var we=iU(s.slice(j,p.index));y=(y.length>0?y+`
`:"")+we[0]}else gt(p[0],!1),j=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{le=Gm(gt(p[0])["target-range-address"]),f[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(U=gt(p[0],!1),!U.href)break;U.Target=Bt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(le=Gm(U.Target.slice(1)),U.Target="#"+le[0]+"!"+le[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var B={Sheets:f,SheetNames:h,Workbook:Q};return r.bookSheets&&delete B.Sheets,B}function Hb(e,t){t=t||{},pa(e,"META-INF/manifest.xml")&&DR(Or(e,"META-INF/manifest.xml"),t);var r=Js(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=uT(er(r),t);return pa(e,"meta.xml")&&(s.Props=tE(Or(e,"meta.xml"))),s}function Vb(e,t){return uT(e,t)}var oU=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ul({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ir+t}})(),Gb=(function(){var e=function(i){return Jt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Jt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,m=Ws(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(u=0;u<m.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=m.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var b=!1,y={},j="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>d)&&!(f[h].s.r>u)&&!(f[h].e.c<d)&&!(f[h].e.r<u)){(f[h].s.c!=d||f[h].s.r!=u)&&(b=!0),y["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,y["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(b){c.push(r);continue}var S=xt({r:u,c:d}),E=x?(i[u]||[])[d]:i[S];if(E&&E.f&&(y["table:formula"]=Jt(CB(E.f)),E.F&&E.F.slice(0,S.length)==S)){var w=Ws(E.F);y["table:number-matrix-columns-spanned"]=w.e.c-w.s.c+1,y["table:number-matrix-rows-spanned"]=w.e.r-w.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":j=E.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=E.v?"true":"false";break;case"n":j=E.w||String(E.v||0),y["office:value-type"]="float",y["office:value"]=E.v||0;break;case"s":case"str":j=E.v==null?"":E.v,y["office:value-type"]="string";break;case"d":j=E.w||cr(E.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=cr(E.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(j);if(E.l&&E.l.Target){var C=E.l.Target;C=C.charAt(0)=="#"?"#"+AB(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),N=Ue("text:a",N,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+Ue("table:table-cell",Ue("text:p",N,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;$n(m),m.ods=l;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Ir],u=Ul({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Ul({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(eE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(s(o.Sheets[o.SheetNames[m]],o,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function mT(e,t){if(t.bookType=="fods")return Gb(e,t);var r=Mx(),s="",n=[],i=[];return s="mimetype",St(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",St(r,s,Gb(e,t)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",St(r,s,oU(e,t)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",St(r,s,Ir+eE()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",St(r,s,FR(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",St(r,s,OR(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Oi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Np(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):er(Kn(e))}function lU(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Xs(Va(e))}function cU(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Wn(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function qb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dU(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function uU(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Xl(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Kt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Tr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ut(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Xl(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Xl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var u={data:l,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function ns(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(Kt(s*8+n.type)),n.type==2&&t.push(Kt(n.data.length)),t.push(n.data))})}),Wn(t)}function ug(e,t){return e?.map(function(r){return t(r.data)})||[]}function ua(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Xl(e,s),i=Ut(e.slice(s[0],s[0]+n));s[0]+=n;var o={id:Tr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ut(l.data),u=Tr(c[3][0].data);o.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=Tr(i[3][0].data)>>>0>0),r.push(o)}return r}function ao(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Kt(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Kt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Kt(o.data.length)}],s[2].push({data:ns(o.meta),type:2})});var i=ns(s);t.push(Kt(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),Wn(t)}function mU(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Xl(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Wn(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=Wn(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function ma(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(mU(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Wn(t)}function no(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Kt(s),o=i.length;t.push(i),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=s}return Wn(t)}function fU(e,t,r,s){var n=Oi(e),i=n.getUint32(4,!0),o=(s>1?12:8)+qb(i&(s>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=qb(i&(s>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(u=n.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(c>-1)m={t:"s",v:t[c]};else if(!isNaN(u))m={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function hU(e,t,r){var s=Oi(e),n=s.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=dU(e,i),i+=16),n&2&&(u=s.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=s.getUint32(i,!0),i+=4),n&16&&(o=s.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:c};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return m}function Km(e,t){var r=new Uint8Array(32),s=Oi(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,uU(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),r.slice(0,n)}function Ym(e,t){var r=new Uint8Array(32),s=Oi(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),r.slice(0,n)}function pU(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return fU(e,t,r,e[0]);case 5:return hU(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function gs(e){var t=Ut(e);return Xl(t[1][0].data)}function Kb(e,t){var r=Ut(t.data),s=Tr(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=Ut(o.data),c=Tr(l[1][0].data)>>>0;switch(s){case 1:i[c]=Np(l[3][0].data);break;case 8:{var u=e[gs(l[9][0].data)][0],d=Ut(u.data),m=e[gs(d[1][0].data)][0],f=Tr(m.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Ut(m.data);i[c]=h[3].map(function(x){return Np(x.data)}).join("")}break}}),i}function xU(e,t){var r,s,n,i,o,l,c,u,d,m,f,h,x,p,g=Ut(e),b=Tr(g[1][0].data)>>>0,y=Tr(g[2][0].data)>>>0,j=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&Tr(g[8][0].data)>0||!1,S,E;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&t!=0)S=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,E=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((m=(d=g[4])==null?void 0:d[0])!=null&&m.data&&t!=1)S=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,E=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var w=j?4:1,N=Oi(S),C=[],T=0;T<S.length/2;++T){var _=N.getUint16(T*2,!0);_<65535&&C.push([T,_])}if(C.length!=y)throw"Expected ".concat(y," cells, found ").concat(C.length);var k=[];for(T=0;T<C.length-1;++T)k[C[T][0]]=E.subarray(C[T][1]*w,C[T+1][1]*w);return C.length>=1&&(k[C[C.length-1][0]]=E.subarray(C[C.length-1][1]*w)),{R:b,cells:k}}function gU(e,t){var r,s=Ut(t.data),n=(r=s?.[7])!=null&&r[0]?Tr(s[7][0].data)>>>0>0?1:0:-1,i=ug(s[5],function(o){return xU(o,n)});return{nrows:Tr(s[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function vU(e,t,r){var s,n=Ut(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Tr(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Tr(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Nt(i);var o=Ut(n[4][0].data),l=Kb(e,e[gs(o[4][0].data)][0]),c=(s=o[17])!=null&&s[0]?Kb(e,e[gs(o[17][0].data)][0]):[],u=Ut(o[3][0].data),d=0;u[1].forEach(function(m){var f=Ut(m.data),h=e[gs(f[2][0].data)][0],x=Tr(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=gU(e,h);p.data.forEach(function(g,b){g.forEach(function(y,j){var S=xt({r:d+b,c:j}),E=pU(y,l,c);E&&(r[S]=E)})}),d+=p.nrows})}function bU(e,t){var r=Ut(t.data),s={"!ref":"A1"},n=e[gs(r[2][0].data)],i=Tr(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return vU(e,n[0],s),s}function yU(e,t){var r,s=Ut(t.data),n={name:(r=s[1])!=null&&r[0]?Np(s[1][0].data):"",sheets:[]},i=ug(s[2],gs);return i.forEach(function(o){e[o].forEach(function(l){var c=Tr(l.meta[1][0].data);c==6e3&&n.sheets.push(bU(e,l))})}),n}function jU(e,t){var r=gg(),s=Ut(t.data),n=ug(s[1],gs);if(n.forEach(function(i){e[i].forEach(function(o){var l=Tr(o.meta[1][0].data);if(l==2){var c=yU(e,o);c.sheets.forEach(function(u,d){vg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Xm(e){var t,r,s,n,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=ma(c.content)}catch(m){return console.log("?? "+c.content.length+" "+(m.message||m))}var d;try{d=ua(u)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(s=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Tr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(u){var d=Tr(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return jU(i,l)}function wU(e,t,r){var s,n,i,o;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Tr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Oi(e[7][0].data),d=0,m=[],f=Oi(e[4][0].data),h=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),f.setUint16(p*2,h,!0);var g,b;switch(typeof t[p]){case"string":g=Km({t:"s",v:t[p]},r),b=Ym({t:"s",v:t[p]},r);break;case"number":g=Km({t:"n",v:t[p]},r),b=Ym({t:"n",v:t[p]},r);break;case"boolean":g=Km({t:"b",v:t[p]},r),b=Ym({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}m.push(g),d+=g.length,x.push(b),h+=b.length,++c}for(e[2][0].data=Kt(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return e[6][0].data=Wn(m),e[3][0].data=Wn(x),c}function NU(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Ws(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Nt(s)));var i=Kd(r,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(K){typeof K=="string"&&o.push(K)})});var l={},c=[],u=mt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(G,K){return[G,u.FullPaths[K]]}).forEach(function(G){var K=G[0],O=G[1];if(K.type==2&&K.name.match(/\.iwa/)){var F=K.content,H=ma(F),Y=ua(H);Y.forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:O,type:Tr(te.messages[0].meta[1][0].data)}})}}),c.sort(function(G,K){return G-K});var d=c.filter(function(G){return G>1}).map(function(G){return[G,Kt(G)]});u.FileIndex.map(function(G,K){return[G,u.FullPaths[K]]}).forEach(function(G){var K=G[0];if(G[1],!!K.name.match(/\.iwa/)){var O=ua(ma(K.content));O.forEach(function(F){F.messages.forEach(function(H){d.forEach(function(Y){F.messages.some(function(te){return Tr(te.meta[1][0].data)!=11006&&cU(te.data,Y[1])})&&l[Y[0]].deps.push(F.id)})})})}});for(var m=mt.find(u,l[1].location),f=ua(ma(m.content)),h,x=0;x<f.length;++x){var p=f[x];p.id==1&&(h=p)}var g=gs(Ut(h.messages[0].data)[1][0].data);for(m=mt.find(u,l[g].location),f=ua(ma(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);for(g=gs(Ut(h.messages[0].data)[2][0].data),m=mt.find(u,l[g].location),f=ua(ma(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);for(g=gs(Ut(h.messages[0].data)[2][0].data),m=mt.find(u,l[g].location),f=ua(ma(m.content)),x=0;x<f.length;++x)p=f[x],p.id==g&&(h=p);var b=Ut(h.messages[0].data);{b[6][0].data=Kt(s.e.r+1),b[7][0].data=Kt(s.e.c+1);var y=gs(b[46][0].data),j=mt.find(u,l[y].location),S=ua(ma(j.content));{for(var E=0;E<S.length&&S[E].id!=y;++E);if(S[E].id!=y)throw"Bad ColumnRowUIDMapArchive";var w=Ut(S[E].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var N=0;N<=s.e.c;++N){var C=[];C[1]=C[2]=[{type:0,data:Kt(N+420690)}],w[1].push({type:2,data:ns(C)}),w[2].push({type:0,data:Kt(N)}),w[3].push({type:0,data:Kt(N)})}w[4]=[],w[5]=[],w[6]=[];for(var T=0;T<=s.e.r;++T)C=[],C[1]=C[2]=[{type:0,data:Kt(T+726270)}],w[4].push({type:2,data:ns(C)}),w[5].push({type:0,data:Kt(T)}),w[6].push({type:0,data:Kt(T)});S[E].messages[0].data=ns(w)}j.content=no(ao(S)),j.size=j.content.length,delete b[46];var _=Ut(b[4][0].data);{_[7][0].data=Kt(s.e.r+1);var k=Ut(_[1][0].data),I=gs(k[2][0].data);j=mt.find(u,l[I].location),S=ua(ma(j.content));{if(S[0].id!=I)throw"Bad HeaderStorageBucket";var L=Ut(S[0].messages[0].data);for(T=0;T<i.length;++T){var D=Ut(L[2][0].data);D[1][0].data=Kt(T),D[4][0].data=Kt(i[T].length),L[2][T]={type:L[2][0].type,data:ns(D)}}S[0].messages[0].data=ns(L)}j.content=no(ao(S)),j.size=j.content.length;var M=gs(_[2][0].data);j=mt.find(u,l[M].location),S=ua(ma(j.content));{if(S[0].id!=M)throw"Bad HeaderStorageBucket";for(L=Ut(S[0].messages[0].data),N=0;N<=s.e.c;++N)D=Ut(L[2][0].data),D[1][0].data=Kt(N),D[4][0].data=Kt(s.e.r+1),L[2][N]={type:L[2][0].type,data:ns(D)};S[0].messages[0].data=ns(L)}j.content=no(ao(S)),j.size=j.content.length;var q=gs(_[4][0].data);(function(){for(var G=mt.find(u,l[q].location),K=ua(ma(G.content)),O,F=0;F<K.length;++F){var H=K[F];H.id==q&&(O=H)}var Y=Ut(O.messages[0].data);{Y[3]=[];var te=[];o.forEach(function(B,Be){te[1]=[{type:0,data:Kt(Be)}],te[2]=[{type:0,data:Kt(1)}],te[3]=[{type:2,data:lU(B)}],Y[3].push({type:2,data:ns(te)})})}O.messages[0].data=ns(Y);var pe=ao(K),we=no(pe);G.content=we,G.size=G.content.length})();var Z=Ut(_[3][0].data);{var Q=Z[1][0];delete Z[2];var U=Ut(Q.data);{var le=gs(U[2][0].data);(function(){for(var G=mt.find(u,l[le].location),K=ua(ma(G.content)),O,F=0;F<K.length;++F){var H=K[F];H.id==le&&(O=H)}var Y=Ut(O.messages[0].data);{delete Y[6],delete Z[7];var te=new Uint8Array(Y[5][0].data);Y[5]=[];for(var pe=0,we=0;we<=s.e.r;++we){var B=Ut(te);pe+=wU(B,i[we],o),B[1][0].data=Kt(we),Y[5].push({data:ns(B),type:2})}Y[1]=[{type:0,data:Kt(s.e.c+1)}],Y[2]=[{type:0,data:Kt(s.e.r+1)}],Y[3]=[{type:0,data:Kt(pe)}],Y[4]=[{type:0,data:Kt(s.e.r+1)}]}O.messages[0].data=ns(Y);var Be=ao(K),fe=no(Be);G.content=fe,G.size=G.content.length})()}Q.data=ns(U)}_[3][0].data=ns(Z)}b[4][0].data=ns(_)}h.messages[0].data=ns(b);var Se=ao(f),P=no(Se);return m.content=P,m.size=m.content.length,u}function fT(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function mg(e){fT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fg(e){fT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function SU(e){return Ct.WS.indexOf(e)>-1?"sheet":e==Ct.CS?"chart":e==Ct.DS?"dialog":e==Ct.MS?"macro":e&&e.length?e:"sheet"}function EU(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,SU(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function TU(e,t,r,s,n,i,o,l,c,u,d,m){try{i[s]=El(Js(e,r,!0),t);var f=Or(e,t),h;switch(l){case"sheet":h=K$(f,t,n,c,i[s],u,d,m);break;case"chart":if(h=Y$(f,t,n,c,i[s],u,d,m),!h||!h["!drawel"])break;var x=vl(h["!drawel"].Target,t),p=Hl(x),g=RM(Js(e,x,!0),El(Js(e,p,!0),x)),b=vl(g,x),y=Hl(b);h=w$(Js(e,b,!0),b,c,El(Js(e,y,!0),b),u,h);break;case"macro":h=X$(f,t,n,c,i[s],u,d,m);break;case"dialog":h=J$(f,t,n,c,i[s],u,d,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[s]=h;var j=[];i&&i[s]&&Cr(i[s]).forEach(function(S){var E="";if(i[s][S].Type==Ct.CMNT){E=vl(i[s][S].Target,t);var w=t9(Or(e,E,!0),E,c);if(!w||!w.length)return;Db(h,w,!1)}i[s][S].Type==Ct.TCMNT&&(E=vl(i[s][S].Target,t),j=j.concat(LM(Or(e,E,!0),c)))}),j&&j.length&&Db(h,j,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function ia(e){return e.charAt(0)=="/"?e.slice(1):e}function CU(e,t){if($o(),t=t||{},mg(t),pa(e,"META-INF/manifest.xml")||pa(e,"objectdata.xml"))return Hb(e,t);if(pa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Xm<"u"){if(e.FileIndex)return Xm(e);var r=mt.utils.cfb_new();return eb(e).forEach(function(D){St(r,D,M6(e,D))}),Xm(r)}throw new Error("Unsupported NUMBERS file")}if(!pa(e,"[Content_Types].xml"))throw pa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=eb(e),n=IR(Js(e,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Or(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Or(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Tl=[],n.sst)try{Tl=e9(Or(e,ia(n.sst)),n.sst,t)}catch(D){if(t.WTF)throw D}t.cellStyles&&n.themes.length&&(c=Q$(Js(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=Z$(Or(e,ia(n.style)),n.style,c,t))}n.links.map(function(D){try{var M=El(Js(e,Hl(ia(D))),D);return s9(Or(e,ia(D)),M,D,t)}catch{}});var d=q$(Or(e,ia(n.workbooks[0])),n.workbooks[0],t),m={},f="";n.coreprops.length&&(f=Or(e,ia(n.coreprops[0]),!0),f&&(m=tE(f)),n.extprops.length!==0&&(f=Or(e,ia(n.extprops[0]),!0),f&&MR(f,m,t)));var h={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=Js(e,ia(n.custprops[0]),!0),f&&(h=zR(f,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(M){return M.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(x.Props=m,x.Custprops=h),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var p={};t.bookDeps&&n.calcchain&&(p=r9(Or(e,ia(n.calcchain)),n.calcchain));var g=0,b={},y,j;{var S=d.Sheets;m.Worksheets=S.length,m.SheetNames=[];for(var E=0;E!=S.length;++E)m.SheetNames[E]=S[E].name}var w=i?"bin":"xml",N=n.workbooks[0].lastIndexOf("/"),C=(n.workbooks[0].slice(0,N+1)+"_rels/"+n.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");pa(e,C)||(C="xl/_rels/workbook."+w+".rels");var T=El(Js(e,C,!0),C.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=a9(Or(e,ia(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=BM(Or(e,ia(n.people[0])),t)),T&&(T=EU(T,d.Sheets));var _=Or(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=m.Worksheets;++g){var k="sheet";if(T&&T[g]?(y="xl/"+T[g][1].replace(/[\/]?xl\//,""),pa(e,y)||(y=T[g][1]),pa(e,y)||(y=C.replace(/_rels\/.*$/,"")+T[g][1]),k=T[g][2]):(y="xl/worksheets/sheet"+(g+1-_)+"."+w,y=y.replace(/sheet0\./,"sheet.")),j=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(m.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==g&&(I=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==m.SheetNames[g].toLowerCase()&&(I=1);if(!I)continue e}}TU(e,y,j,m.SheetNames[g],g,b,o,k,t,d,c,u)}return x={Directory:n,Workbook:d,Props:m,Custprops:h,Deps:p,Sheets:o,SheetNames:m.SheetNames,Strings:Tl,Styles:u,Themes:c,SSF:dr(pt)},t&&t.bookFiles&&(e.files?(x.keys=s,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(D,M){D=D.replace(/^Root Entry[\/]/,""),x.keys.push(D),x.files[D]=e.FileIndex[M]}))),t&&t.bookVBA&&(n.vba.length>0?x.vbaraw=Or(e,ia(n.vba[0]),!0):n.defaults&&n.defaults.bin===qM&&(x.vbaraw=Or(e,"xl/vbaProject.bin",!0))),x}function AU(e,t){var r=t||{},s="Workbook",n=mt.find(e,s);try{if(s="/!DataSpaces/Version",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(aL(n.content),s="/!DataSpaces/DataSpaceMap",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=iL(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=oL(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);cL(n.content)}catch{}if(s="/EncryptionInfo",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=dL(n.content);if(s="/EncryptedPackage",n=mt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function kU(e,t){return t.bookType=="ods"?mT(e,t):t.bookType=="numbers"?NU(e,t):t.bookType=="xlsb"?_U(e,t):IU(e,t)}function _U(e,t){co=1024,e&&!e.SSF&&(e.SSF=dr(pt)),e&&e.SSF&&($o(),Hu(e.SSF),t.revssf=Gu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Cl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=zE.indexOf(t.bookType)>-1,n=Zx();fg(t=t||{});var i=Mx(),o="",l=0;if(t.cellXfs=[],Xn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",St(i,o,rE(e.Props,t)),n.coreprops.push(o),Yt(t.rels,2,o,Ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,St(i,o,nE(e.Props)),n.extprops.push(o),Yt(t.rels,3,o,Ct.EXT_PROPS),e.Custprops!==e.Props&&Cr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",St(i,o,iE(e.Custprops)),n.custprops.push(o),Yt(t.rels,4,o,Ct.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,St(i,o,i9(l-1,o,t,e,d)),n.sheets.push(o),Yt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ct.WS[0])}if(m){var h=m["!comments"],x=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,St(i,p,c9(h,p)),n.comments.push(p),Yt(d,-1,"../comments"+l+"."+r,Ct.CMNT),x=!0),m["!legacy"]&&x&&St(i,"xl/drawings/vmlDrawing"+l+".vml",ME(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&St(i,Hl(o),fo(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,St(i,o,l9(t.Strings,o,t)),n.strs.push(o),Yt(t.wbrels,-1,"sharedStrings."+r,Ct.SST)),o="xl/workbook."+r,St(i,o,n9(e,o)),n.workbooks.push(o),Yt(t.rels,1,o,Ct.WB),o="xl/theme/theme1.xml",St(i,o,ag(e.Themes,t)),n.themes.push(o),Yt(t.wbrels,-1,"theme/theme1.xml",Ct.THEME),o="xl/styles."+r,St(i,o,o9(e,o,t)),n.styles.push(o),Yt(t.wbrels,-1,"styles."+r,Ct.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",St(i,o,e.vbaraw),n.vba.push(o),Yt(t.wbrels,-1,"vbaProject.bin",Ct.VBA)),o="xl/metadata."+r,St(i,o,d9(o)),n.metadata.push(o),Yt(t.wbrels,-1,"metadata."+r,Ct.XLMETA),St(i,"[Content_Types].xml",QS(n,t)),St(i,"_rels/.rels",fo(t.rels)),St(i,"xl/_rels/workbook."+r+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,i}function IU(e,t){co=1024,e&&!e.SSF&&(e.SSF=dr(pt)),e&&e.SSF&&($o(),Hu(e.SSF),t.revssf=Gu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Cl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=zE.indexOf(t.bookType)>-1,n=Zx();fg(t=t||{});var i=Mx(),o="",l=0;if(t.cellXfs=[],Xn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",St(i,o,rE(e.Props,t)),n.coreprops.push(o),Yt(t.rels,2,o,Ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,St(i,o,nE(e.Props)),n.extprops.push(o),Yt(t.rels,3,o,Ct.EXT_PROPS),e.Custprops!==e.Props&&Cr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",St(i,o,iE(e.Custprops)),n.custprops.push(o),Yt(t.rels,4,o,Ct.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,St(i,o,JE(l-1,t,e,m)),n.sheets.push(o),Yt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ct.WS[0])}if(f){var x=f["!comments"],p=!1,g="";if(x&&x.length>0){var b=!1;x.forEach(function(y){y[1].forEach(function(j){j.T==!0&&(b=!0)})}),b&&(g="xl/threadedComments/threadedComment"+l+"."+r,St(i,g,MM(x,d,t)),n.threadedcomments.push(g),Yt(m,-1,"../threadedComments/threadedComment"+l+"."+r,Ct.TCMNT)),g="xl/comments"+l+"."+r,St(i,g,BE(x)),n.comments.push(g),Yt(m,-1,"../comments"+l+"."+r,Ct.CMNT),p=!0}f["!legacy"]&&p&&St(i,"xl/drawings/vmlDrawing"+l+".vml",ME(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&St(i,Hl(o),fo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,St(i,o,TE(t.Strings,t)),n.strs.push(o),Yt(t.wbrels,-1,"sharedStrings."+r,Ct.SST)),o="xl/workbook."+r,St(i,o,rT(e)),n.workbooks.push(o),Yt(t.rels,1,o,Ct.WB),o="xl/theme/theme1.xml",St(i,o,ag(e.Themes,t)),n.themes.push(o),Yt(t.wbrels,-1,"theme/theme1.xml",Ct.THEME),o="xl/styles."+r,St(i,o,OE(e,t)),n.styles.push(o),Yt(t.wbrels,-1,"styles."+r,Ct.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",St(i,o,e.vbaraw),n.vba.push(o),Yt(t.wbrels,-1,"vbaProject.bin",Ct.VBA)),o="xl/metadata."+r,St(i,o,LE()),n.metadata.push(o),Yt(t.wbrels,-1,"metadata."+r,Ct.XLMETA),d.length>1&&(o="xl/persons/person.xml",St(i,o,zM(d)),n.people.push(o),Yt(t.wbrels,-1,"persons/person.xml",Ct.PEOPLE)),St(i,"[Content_Types].xml",QS(n,t)),St(i,"_rels/.rels",fo(t.rels)),St(i,"xl/_rels/workbook."+r+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,i}function hg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ta(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function PU(e,t){return mt.find(e,"EncryptedPackage")?AU(e,t):iT(e,t)}function DU(e,t){var r,s=e,n=t||{};return n.type||(n.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=AS(s,n),CU(r,n)}function hT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jp(e.slice(r),t);default:break e}return Eo.to_workbook(e,t)}function OU(e,t){var r="",s=hg(e,t);switch(t.type){case"base64":r=ta(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_i(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=er(r)),t.type="binary",hT(r,t)}function RU(e,t){var r=e;return t.type=="base64"&&(r=ta(r)),r=Ml.utils.decode(1200,r.slice(2),"str"),t.type="binary",hT(r,t)}function FU(e){return e.match(/[^\x00-\x7F]/)?Va(e):e}function Jm(e,t,r,s){return s?(r.type="string",Eo.to_workbook(e,r)):Eo.to_workbook(t,r)}function Jl(e,t){Dx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jl(new Uint8Array(e),(r=dr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),po={},r.dateNF&&(po.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",s=_6(e),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=FU(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=dr(r),r.type="array",Jl(Ox(s),r)}switch((n=hg(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return PU(mt.read(s,r),r);break;case 9:if(n[1]<=8)return iT(s,r);break;case 60:return jp(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return $F(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return SE.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?DU(s,r):Jm(e,s,r,i);case 239:return n[3]===60?jp(s,r):Jm(e,s,r,i);case 255:if(n[1]===254)return RU(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return yi.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return yi.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return yp.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return IE.to_workbook(s,r);break;case 10:case 13:case 32:return OU(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return zF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?yp.to_workbook(s,r):Jm(e,s,r,i)}function pT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bc(t.file,mt.write(e,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mt.write(e,t)}function LU(e,t){var r=dr(t||{}),s=kU(e,r);return MU(s,r)}function MU(e,t){var r={},s=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Wu(n))}return t.password&&typeof encrypt_agile<"u"?pT(encrypt_agile(n,t.password),t):t.type==="file"?bc(t.file,n):t.type=="string"?er(n):n}function BU(e,t){var r=t||{},s=F9(e,r);return pT(s,r)}function Ha(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Bl(Va(s));case"binary":return Va(s);case"string":return e;case"file":return bc(t.file,s,"utf8");case"buffer":return Tt?yn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Ha(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zU(e,t){switch(t.type){case"base64":return Bl(e);case"binary":return e;case"string":return e;case"file":return bc(t.file,e,"binary");case"buffer":return Tt?yn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function id(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Bl(r):t.type=="string"?er(r):r;case"file":return bc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function xT(e,t){Dx(),P$(e);var r=dr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=xT(e,r);return r.type="array",Wu(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ha(k9(e,r),r);case"slk":case"sylk":return Ha(NE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Ha(lT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return zU(gT(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Ha(xg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Ha(SE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return id(yp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Ha(Eo.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Ha(IE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Ha(EE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Ha(mT(e,r),r);case"wk1":return id(yi.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return id(yi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),id(oT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),BU(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return LU(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $U(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function pg(e,t,r){var s=r||{};return s.type="file",s.file=t,$U(s),xT(e,s)}function UU(e,t,r,s,n,i,o,l){var c=_r(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var x=o?e[r][h]:e[s[h]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[h]!=null&&(f[i[h]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(p==null)if(x.t=="e"&&p===null)f[i[h]]=null;else if(u!==void 0)f[i[h]]=u;else if(d&&p===null)f[i[h]]=null;else continue;else f[i[h]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:pn(x,p,l);p!=null&&(m=!1)}}return{row:f,isempty:m}}function Kd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=zt(d);break;case"number":c=zt(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var m=_r(c.s.r),f=[],h=[],x=0,p=0,g=Array.isArray(e),b=c.s.r,y=0,j={};g&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(S[y]||{}).hidden)switch(f[y]=br(y),r=g?e[b][y]:e[f[y]+m],s){case 1:i[y]=y-c.s.c;break;case 2:i[y]=f[y];break;case 3:i[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=pn(r,null,u),p=j[o]||0,!p)j[o]=1;else{do l=o+"_"+p++;while(j[l]);j[o]=p,j[l]=1}i[y]=l}for(b=c.s.r+n;b<=c.e.r;++b)if(!(E[b]||{}).hidden){var w=UU(e,c,b,f,s,i,g,u);(w.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(h[x++]=w.row)}return h.length=x,h}var Yb=/"/g;function WU(e,t,r,s,n,i,o,l){for(var c=!0,u=[],d="",m=_r(r),f=t.s.c;f<=t.e.c;++f)if(s[f]){var h=l.dense?(e[r]||[])[f]:e[s[f]+m];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:pn(h,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===n||p===i||p===34||l.forceQuotes){d='"'+d.replace(Yb,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(Yb,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function xg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=zt(e["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];s.dense=Array.isArray(e);for(var f=s.skipHidden&&e["!cols"]||[],h=s.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(f[x]||{}).hidden||(m[x]=br(x));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(d=WU(e,n,g,m,o,c,i,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete s.dense,r.join("")}function gT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=xg(e,t);return r}function HU(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=zt(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=br(l);for(var d=n.s.r;d<=n.e.r;++d)for(i=_r(d),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=u?(e[d]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function vT(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?yr(s.origin):s.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var m=zt(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+n)}else o==-1&&(o=0,d.e.r=t.length-1+n);var f=s.header||[],h=0;t.forEach(function(p,g){Cr(p).forEach(function(b){(h=f.indexOf(b))==-1&&(f[h=f.length]=b);var y=p[b],j="z",S="",E=xt({c:l+h,r:o+g+n});u=Zl(i,E),y&&typeof y=="object"&&!(y instanceof Date)?i[E]=y:(typeof y=="number"?j="n":typeof y=="boolean"?j="b":typeof y=="string"?j="s":y instanceof Date?(j="d",s.cellDates||(j="n",y=Wr(y)),S=s.dateNF||pt[14]):y===null&&s.nullError&&(j="e",y=0),u?(u.t=j,u.v=y,delete u.w,delete u.R,S&&(u.z=S)):i[E]=u={t:j,v:y},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,l+f.length-1);var x=_r(o);if(n)for(h=0;h<f.length;++h)i[br(h+l)+x]={t:"s",v:f[h]};return i["!ref"]=Nt(d),i}function VU(e,t){return vT(null,e,t)}function Zl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=yr(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zl(e,xt(t)):Zl(e,xt({r:t,c:r||0}))}function GU(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gg(){return{SheetNames:[],Sheets:{}}}function vg(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(tT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function qU(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=GU(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function KU(e,t){return e.z=t,e}function bT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function YU(e,t,r){return bT(e,"#"+t,r)}function XU(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function JU(e,t,r,s){for(var n=typeof t!="string"?t:zt(t),i=typeof t=="string"?t:Nt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=Zl(e,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var ba={encode_col:br,encode_row:_r,encode_cell:xt,encode_range:Nt,decode_col:Gx,decode_row:Vx,split_cell:lR,decode_cell:yr,decode_range:Ws,format_cell:pn,sheet_add_aoa:GS,sheet_add_json:vT,sheet_add_dom:cT,aoa_to_sheet:Uo,json_to_sheet:VU,table_to_sheet:dT,table_to_book:aU,sheet_to_csv:xg,sheet_to_txt:gT,sheet_to_json:Kd,sheet_to_html:lT,sheet_to_formulae:HU,sheet_to_row_object_array:Kd,sheet_get_cell:Zl,book_new:gg,book_append_sheet:vg,book_set_sheet_visibility:qU,cell_set_number_format:KU,cell_set_hyperlink:bT,cell_set_internal_link:YU,cell_add_comment:XU,sheet_set_array_formula:JU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ZU=({show:e,onClose:t,onImport:r,loading:s=!1})=>{const[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState([]),[x,p]=v.useState([]),[g,b]=v.useState(!1),y=v.useRef(null),j=["first_name","last_name","email","role"],S=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","department","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];v.useEffect(()=>{e&&E()},[e]);const E=async()=>{try{b(!0);const P=await os.getRoles();let G=[];Array.isArray(P)?G=P:P?.data?.roles?G=P.data.roles:P?.roles?G=P.roles:P?.data&&Array.isArray(P.data)&&(G=P.data),console.log(" Roles fetched:",{responseType:typeof P,responseKeys:P?Object.keys(P):"null",rolesCount:G.length,roles:G.map(K=>({id:K.id,name:K.name}))}),p(G)}catch(P){console.error("Failed to fetch roles:",P),m(["Failed to load roles. Please refresh the page."]),p([])}finally{b(!1)}},w=P=>{if(!P)return"";try{return decodeURIComponent(escape(P)).trim()}catch{return P.toString().trim()}},N=P=>{if(!P)return"";try{let G;if(P instanceof Date)G=P;else{const O=P.toString().trim();if(!O||O===""||O==="null"||O==="undefined")return"";if(O.includes("/")){const F=O.split("/");F.length===3&&(G=new Date(F[2],F[0]-1,F[1]))}else if(O.includes("-")){const F=O.split("-");F.length===3&&(F[0].length===4?G=new Date(F[0],F[1]-1,F[2]):G=new Date(F[2],F[1]-1,F[0]))}else G=new Date(O)}if(isNaN(G.getTime()))return"";const K=G.getFullYear();return K<1900||K>2100?"":G.toISOString()}catch(G){return console.error("Error formatting date:",G,"Input:",P),""}},C=P=>{if(!P)return"MALE";const G=P.toString().toUpperCase().trim();return G==="MALE"||G==="FEMALE"?G:{M:"MALE",F:"FEMALE"}[G]||"MALE"},T=P=>{if(!P)return null;const G=P.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(G)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},_=P=>P?P.toString().toUpperCase().trim().replace(/\s+/g,"_"):"",k=P=>{if(!P||!x.length)return console.warn(" findRoleId: No roleName or roles not loaded",{roleName:P,rolesCount:x.length}),null;const G=_(P);console.log(" Finding role:",{input:P,normalized:G,availableRoles:x.map(Y=>({name:Y.name,normalized:_(Y.name),id:Y.id}))});const K=x.find(Y=>{const te=_(Y.name),pe=te===G;return pe&&console.log(" Direct match:",{input:P,inputNormalized:G,dbRole:Y.name,dbRoleNormalized:te,match:pe}),pe});if(K)return console.log(" Direct match found:",K.name,K.id),K.id;console.log(" Direct match failed, checking normalization..."),x.forEach(Y=>{const te=_(Y.name);te===G&&console.log(" Found potential match:",{input:P,inputNormalized:G,dbRole:Y.name,dbRoleNormalized:te,match:te===G})});const F={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE"}[G];if(F){const Y=x.find(te=>_(te.name)===F);if(Y)return console.log(" Partial match found:",Y.name,Y.id),Y.id}const H=x.find(Y=>{const te=_(Y.name),pe=te.includes(G)||G.includes(te);return pe&&console.log(" Fuzzy match candidate:",{input:P,inputNormalized:G,dbRole:Y.name,dbRoleNormalized:te}),pe});return H?(console.log(" Fuzzy match found:",H.name,H.id),H.id):(console.warn(" No role match found for:",{input:P,normalized:G,availableRoles:x.map(Y=>({name:Y.name,normalized:_(Y.name)}))}),null)},I=P=>{if(!P||!x.length)return null;const G=_(P),K=x.find(Y=>_(Y.name)===G);if(K)return K.name;const F={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT"}[G];if(F){const Y=x.find(te=>_(te.name)===F);if(Y)return Y.name}const H=x.find(Y=>{const te=_(Y.name);return te.includes(G)||G.includes(te)});return H?H.name:null},L=()=>{const P=[S,["Nguyn","Vn","An","123 ng L Li, Qun 1, TP.HCM","nguyen.van.an@example.com","+84 123 456 789","TRAINER","M","1","CERT001","Flight Training","5","1990-01-15","BATCH2023-01","P123456789","Vietnam"]],G=ba.aoa_to_sheet(P),K=ba.book_new();ba.book_append_sheet(K,G,"Users"),pg(K,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},D=P=>{P.preventDefault(),P.stopPropagation(),P.type==="dragenter"||P.type==="dragover"?i(!0):P.type==="dragleave"&&i(!1)},M=P=>{P.preventDefault(),P.stopPropagation(),i(!1),P.dataTransfer.files&&P.dataTransfer.files[0]&&Z(P.dataTransfer.files[0])},q=P=>{P.target.files&&P.target.files[0]&&Z(P.target.files[0])},Z=P=>{if(!P.name.match(/\.(xlsx|xls)$/)){m(["Please upload an Excel file (.xlsx or .xls)"]);return}if(P.size>100*1024*1024){m(["File size must be less than 100MB"]);return}if(l(P),m([]),h([]),u([]),g){h(["Roles are still loading. Please wait a moment and try again."]);return}if(x.length===0){h(["Roles are not loaded yet. Please refresh the page and try again."]);return}console.log(" Processing file with roles loaded:",{rolesCount:x.length,roles:x.map(K=>K.name)});const G=new FileReader;G.onload=K=>{try{const O=new Uint8Array(K.target.result),F=Jl(O,{type:"array",cellText:!1,cellDates:!0,raw:!1}),H=F.SheetNames[0],Y=F.Sheets[H],te=ba.sheet_to_json(Y,{header:1,defval:"",raw:!1});if(te.length<2){m(["File must contain at least a header row and one data row"]);return}const pe=te[0].map(ue=>ue?ue.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),we=te.slice(1),B={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",department:"department",dept:"department",dept_id:"department",department_id:"department",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},fe=pe.map(ue=>B[ue]||ue).filter(ue=>S.includes(ue)),oe=j.filter(ue=>!fe.includes(ue));if(oe.length>0){h([`Your file is missing these essential data to create a user: ${oe.join(", ")}`]);return}x.length===0&&(console.warn(" Roles not loaded yet, validation may fail"),h([" Roles are still loading. Role validation may fail. Please wait and try again if you see role errors."]));const ge=we.map((ue,Ie)=>{const Le={};let he=!1;const Me=[];pe.forEach((Ke,We)=>{const yt=B[Ke]||Ke;if(S.includes(yt)){let Xe="";ue[We]!==null&&ue[We]!==void 0&&(typeof ue[We]=="string"?Xe=w(ue[We]):typeof ue[We]=="number"?Xe=ue[We].toString():Xe=w(ue[We].toString())),yt==="gender"&&(Xe=C(Xe)),Le[yt]=Xe}}),fe.forEach(Ke=>{const We=Le[Ke]||"";if(j.includes(Ke)&&!We&&(he=!0,Me.push("Required field missing")),Ke==="email"&&We&&!/\S+@\S+\.\S+/.test(We)&&(he=!0,Me.push("Invalid email")),Ke==="role"&&We)if(x.length>0){const yt=k(We);if(yt)console.log(" Role validated successfully:",We,"",yt);else{he=!0;const Xe=_(We),Je=x.map(Ye=>({original:Ye.name,normalized:_(Ye.name)}));console.error(" Role validation failed:",{input:We,normalizedInput:Xe,availableRoles:x.map(Ye=>Ye.name),availableNormalized:Je}),Me.push(`Invalid role: "${We}". Available roles: ${x.map(Ye=>Ye.name).join(", ")}`)}}else console.warn(" Roles not loaded, cannot validate role:",We);if(Ke==="phone_number"&&We&&We.length>15&&(he=!0,Me.push("Phone number too long (max 15 characters)")),Ke==="years_of_experience"&&We&&isNaN(We)&&(he=!0,Me.push("Invalid experience value")),Ke==="gender"&&We){const yt=T(We);yt&&(he=!0,Me.push(yt))}});const Ge=I(Le.role);return Ge==="TRAINER"?((!Le.specialization||Le.specialization.trim()==="")&&(he=!0,Me.push("Trainer requires specialization")),(!Le.years_of_experience||Le.years_of_experience.trim()==="")&&(he=!0,Me.push("Trainer requires years of experience")),Le.department&&Le.department.trim()!==""&&Le.department.trim()!=="-"&&(he=!0,Me.push("Department is not allowed for Trainer role"))):Ge==="TRAINEE"&&(!Le.date_of_birth||Le.date_of_birth.trim()===""?(he=!0,Me.push("Trainee requires date of birth")):N(Le.date_of_birth)||(he=!0,Me.push(`Invalid date format for date of birth: "${Le.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!Le.training_batch||Le.training_batch.trim()==="")&&(he=!0,Me.push("Trainee requires training batch")),(!Le.passport_no||Le.passport_no.trim()==="")&&(he=!0,Me.push("Trainee requires passport number")),(!Le.nation||Le.nation.trim()==="")&&(he=!0,Me.push("Trainee requires nation")),Le.enrollment_date&&Le.enrollment_date.trim()!==""&&(N(Le.enrollment_date)||(he=!0,Me.push(`Invalid date format for enrollment date: "${Le.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Ie+1,...Le,hasError:he,errors:Me,status:he?"error":"valid"}});u(ge)}catch{m(["Error reading file. Please make sure it's a valid Excel file."])}},G.readAsArrayBuffer(P)},Q=async()=>{const P=c.filter(K=>!K.hasError);if(P.length===0){m(["No valid users to import"]);return}if(!x.length){m(["Roles not loaded. Please wait and try again."]);return}const G=P.map(K=>{const O=K.phone_number?K.phone_number.substring(0,15):"",F=k(K.role),H=I(K.role);if(!F||!H)throw new Error(`Role "${K.role}" not found in system`);const Y={firstName:K.first_name||"",middleName:K.middle_name||"",lastName:K.last_name||"",address:K.address||"",email:K.email||"",phoneNumber:O,avatarUrl:K.avatar_url||"",gender:C(K.gender),role:{id:F,name:H}};if(H==="DEPARTMENT_HEAD"?K.department&&K.department.trim()!==""&&K.department.trim()!=="-"?Y.departmentId=K.department:Y.departmentId=null:H!=="TRAINER"&&K.department&&K.department.trim()!==""&&K.department.trim()!=="-"&&(Y.departmentId=K.department),H==="TRAINER")Y.trainerProfile={specialization:K.specialization||"",yearsOfExp:K.years_of_experience?parseInt(K.years_of_experience):0,certificationNumber:K.certification_number||"",bio:K.bio||""};else if(H==="TRAINEE"){const te={trainingBatch:K.training_batch||"",passportNo:K.passport_no||"",nation:K.nation||""},pe=N(K.date_of_birth);pe&&(te.dob=pe);const we=N(K.enrollment_date);we?te.enrollmentDate=we:te.enrollmentDate=new Date().toISOString(),Y.traineeProfile=te}return Y});try{await r(G),U()}catch(K){m([K.message||"Failed to import users. Please try again."])}},U=()=>{l(null),u([]),m([]),h([]),i(!1),t()},le=P=>{u(G=>G.filter(K=>K.id!==P))},Se=P=>P==="valid"?a.jsx(ht,{className:"text-success",size:16}):a.jsx(Qs,{className:"text-danger",size:16});return a.jsxs(ce,{show:e,onHide:U,size:"xl",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Ds,{className:"me-2",size:20}),"Bulk Import Users"]}),a.jsx(ie,{variant:"link",onClick:U,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&a.jsxs("div",{className:"text-center mb-3",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:a.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),a.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),a.jsx(W,{className:"mb-4",children:a.jsxs(W.Body,{children:[a.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:M,onClick:()=>y.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(vo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:y,type:"file",accept:".xlsx,.xls",onChange:q,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[o&&a.jsxs("p",{className:"text-success mb-1",children:[a.jsx("strong",{children:"Uploaded file:"})," ",o.name]}),a.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),a.jsxs("small",{className:"text-info d-block mt-1",children:[a.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:L,className:"d-flex align-items-center",children:[a.jsx($i,{className:"me-1",size:14}),"Download Template"]})]})]})}),d.length>0&&a.jsx("div",{className:"alert alert-danger mb-3",children:a.jsx("ul",{className:"mb-0",children:d.map((P,G)=>a.jsx("li",{children:P},G))})}),f.length>0&&a.jsx(Re,{variant:"warning",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:f.map((P,G)=>a.jsx("li",{children:P},G))})}),c.length>0&&a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(Gt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),a.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),a.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),a.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),a.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),a.jsx("th",{style:{minWidth:"100px"},children:"DEPARTMENT"}),a.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),a.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),a.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),a.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),a.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),a.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),a.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),a.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),a.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),a.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),a.jsx("tbody",{children:c.map(P=>a.jsxs("tr",{className:P.hasError?"table-danger":"",children:[a.jsx("td",{children:P.id}),a.jsx("td",{children:P.first_name||P.full_name||"-"}),a.jsx("td",{children:P.middle_name||"-"}),a.jsx("td",{children:P.last_name||"-"}),a.jsx("td",{children:P.email||"-"}),a.jsx("td",{children:P.role||"-"}),a.jsx("td",{children:P.department||"-"}),a.jsx("td",{children:P.phone_number||"-"}),a.jsx("td",{children:P.gender?a.jsx("span",{title:`Original: ${P.gender}`,children:C(P.gender)}):"-"}),a.jsx("td",{children:P.certification_number||"-"}),a.jsx("td",{children:P.specialization||"-"}),a.jsx("td",{children:P.years_of_experience||"-"}),a.jsx("td",{children:P.date_of_birth||"-"}),a.jsx("td",{children:P.training_batch||"-"}),a.jsx("td",{children:P.passport_no||"-"}),a.jsx("td",{children:P.nation||"-"}),a.jsx("td",{className:"text-center",children:Se(P.status)}),a.jsx("td",{children:P.errors.length>0&&a.jsx("small",{className:"text-danger",children:P.errors.length>1?`${P.errors[0]} (+${P.errors.length-1} more)`:P.errors[0]})}),a.jsx("td",{children:a.jsx(ie,{variant:"outline-danger",size:"sm",onClick:()=>le(P.id),children:a.jsx(Wi,{size:14})})})]},P.id))})]})})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:U,disabled:s,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&a.jsx(r2,{placement:"top",overlay:a.jsxs(s2,{id:"import-tooltip",children:["Only ",c.filter(P=>!P.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:a.jsx(ie,{variant:"primary",onClick:Q,disabled:s||c.filter(P=>!P.hasError).length===0,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"me-2",size:16}),"Import All (",c.filter(P=>!P.hasError).length," users)"]})})})]})]})},QU=({show:e,user:t,onConfirm:r,onCancel:s,loading:n=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",o=i?"Disable":"Enable",c=i?dc:ht;return a.jsxs(ce,{show:e,onHide:s,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ce.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),o," User"]})}),a.jsxs(ce.Body,{className:"py-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:a.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),a.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),a.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),a.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"me-3",children:a.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:a.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:t.fullName}),a.jsx("small",{className:"text-muted",children:t.email})]})]}),a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"EID"}),a.jsx("div",{className:"fw-medium",children:t.eid})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"Role"}),a.jsx("div",{className:"fw-medium",children:t.role})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"Department"}),a.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),i?a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsx("li",{children:"User cannot log into the system"}),a.jsx("li",{children:"All active sessions will be terminated"}),a.jsx("li",{children:"User data will be preserved but access restricted"}),a.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):a.jsxs(Re,{variant:"success",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsx("li",{children:"User can log into the system normally"}),a.jsx("li",{children:"All permissions and access will be restored"}),a.jsx("li",{children:"User will receive notification of account activation"}),a.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),a.jsxs(ce.Footer,{className:"border-0 bg-light",children:[a.jsx(ie,{variant:"outline-secondary",onClick:s,disabled:n,children:"Cancel"}),a.jsx(ie,{variant:i?"warning":"success",onClick:r,disabled:n,className:"d-flex align-items-center",children:n?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(c,{className:"me-2",size:16}),o," User"]})})]})]})},eW=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:s,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown ${l}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>a.jsx(A.Check,{type:"checkbox",id:`role-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),s.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>a.jsx(A.Check,{type:"checkbox",id:`dept-${u}`,label:u,checked:s.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},tW=({show:e,user:t,newRole:r,onConfirm:s,onCancel:n,loading:i=!1})=>{if(!t)return null;const o=u=>{switch(u){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},l=o(t.role),c=o(r);return a.jsxs(ce,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ce.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),a.jsxs(ce.Body,{className:"py-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:a.jsx(fr,{size:32,className:"text-warning"})}),a.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),a.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),a.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"me-3",children:a.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:a.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:t.fullName}),a.jsx("small",{className:"text-muted",children:t.email})]})]}),a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-6",children:[a.jsx("div",{className:"text-muted small",children:"Current Role"}),a.jsx("div",{className:"fw-medium",children:t.role})]}),a.jsxs("div",{className:"col-6",children:[a.jsx("div",{className:"text-muted small",children:"New Role"}),a.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",l,")"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),a.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),a.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),a.jsxs(ce.Footer,{className:"border-0 bg-light",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:n,disabled:i,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"warning",onClick:()=>{s()},disabled:i,className:"d-flex align-items-center",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ht,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},rW=({show:e,user:t,mode:r,onSave:s,onClose:n})=>{const[i,o]=v.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[l,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState([]),[h,x]=v.useState(!1),[p,g]=v.useState([]),[b,y]=v.useState(!1),[j,S]=v.useState([]),E=async()=>{x(!0);try{const D=await kt.getDepartments(),q=(D.departments||D.data||[]).map(Z=>Z.name);f(q)}catch(D){console.error("Error fetching departments:",D),ne.error("Failed to load departments"),f([])}finally{x(!1)}},w=async()=>{y(!0);try{const D=await Cs.getRoles(),q=(D.roles||D.data||[]).map(Z=>Z.name);g(q)}catch(D){console.error("Error fetching roles:",D),ne.error("Failed to load roles"),g([])}finally{y(!1)}},N=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],C=async()=>{try{const M=(await kt.getDepartments({includeDeleted:!0}))?.departments?.filter(q=>q.headUser)||[];S(M)}catch(D){console.error("Error fetching departments with heads:",D),S([])}};v.useEffect(()=>{e&&(E(),w(),C())},[e]),v.useEffect(()=>{t&&r!=="add"?o({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&o({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const T=()=>{const D={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(D.firstName="First name can only contain letters and spaces"):D.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(D.lastName="Last name can only contain letters and spaces"):D.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(D.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(D.email="Email is invalid"):D.email="Email is required",!i.phoneNumber.trim())D.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))D.phoneNumber="Phone number cannot contain letters";else{const M=i.phoneNumber.replace(/[^\d+]/g,"");(M.length<7||M.length>16)&&(D.phoneNumber="Phone number must be 7-16 digits")}if(i.role||(D.role="Role is required"),i.role==="DEPARTMENT_HEAD"&&i.department&&i.department.trim()){const M=j.find(q=>{const Z=q.name,Q=i.department,U=q.headUser?.id,le=Z&&Q&&Z.toLowerCase()===Q.toLowerCase(),Se=r!=="edit"||U!==t?.id;return le&&Se});if(M){const q=`${M.headUser?.firstName||""} ${M.headUser?.lastName||""}`.trim();D.department=`Department "${i.department}" already has a head: ${q}`}}return i.role==="TRAINER"&&(i.specialization.trim()||(D.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(D.certificationNumber="Certification number is required for trainers"),i.department&&i.department.trim()!==""&&(D.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(D.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(D.passportNo="Passport number must be 1-20 digits only"):D.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?D.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(D.dateOfBirth="Date of birth must be in the past"):D.dateOfBirth="Date of birth is required for trainees"),c(D),Object.keys(D).length===0},_=async D=>{if(D.preventDefault(),!!T()&&!u){d(!0);try{await s(i)}catch(M){console.error("Error in handleSubmit:",M)}finally{d(!1)}}},k=(D,M)=>{o(q=>({...q,[D]:M})),c(q=>{const Z={...q};if(Z[D]&&delete Z[D],D==="role"&&(delete Z.specialization,delete Z.certificationNumber,delete Z.trainingBatch,delete Z.passportNo,delete Z.dateOfBirth,delete Z.department),D==="department"){if(delete Z.department,i.role==="TRAINER")M&&M.trim()!==""&&(Z.department="Department is not allowed for Trainer role");else if(i.role==="DEPARTMENT_HEAD"&&M&&M.trim()){const Q=j.find(U=>{const le=U.name,Se=M,P=U.headUser?.id;return le&&Se&&le.toLowerCase()===Se.toLowerCase()&&(r!=="edit"||P!==t?.id)});if(Q){const U=`${Q.headUser?.firstName||""} ${Q.headUser?.lastName||""}`.trim();Z.department=`Department "${M}" already has a head: ${U}`}}}return D==="role"&&M==="TRAINER"&&o(Q=>({...Q,department:""})),Z})},I=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},L=r==="view";return a.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Et,{className:"me-2",size:20}):a.jsx(ts,{className:"me-2",size:20}),I()]})}),a.jsxs(A,{onSubmit:_,children:[a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(l).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([D,M])=>a.jsx("li",{children:M},D))})]}),a.jsxs(de,{children:[a.jsx(z,{md:4,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),a.jsx(A.Control,{type:"text",value:i.firstName,onChange:D=>k("firstName",D.target.value),isInvalid:!!l.firstName,readOnly:L,style:{borderColor:l.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.firstName})]})}),a.jsx(z,{md:4,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),a.jsx(A.Control,{type:"text",value:i.middleName,onChange:D=>k("middleName",D.target.value),isInvalid:!!l.middleName,readOnly:L,style:{borderColor:l.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.middleName})]})}),a.jsx(z,{md:4,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),a.jsx(A.Control,{type:"text",value:i.lastName,onChange:D=>k("lastName",D.target.value),isInvalid:!!l.lastName,readOnly:L,style:{borderColor:l.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),a.jsx(A.Control,{type:"email",value:i.email,onChange:D=>k("email",D.target.value),isInvalid:!!l.email,readOnly:L,style:{borderColor:l.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.email})]})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),a.jsx(A.Control,{type:"tel",value:i.phoneNumber,onChange:D=>k("phoneNumber",D.target.value),isInvalid:!!l.phoneNumber,readOnly:L,placeholder:"Enter phone number",style:{borderColor:l.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.phoneNumber})]})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),a.jsx(A.Control,{as:"textarea",rows:3,value:i.address,onChange:D=>k("address",D.target.value),readOnly:L,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),a.jsxs(de,{children:[a.jsx(z,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),a.jsxs(A.Select,{value:i.role,onChange:D=>k("role",D.target.value),isInvalid:!!l.role,disabled:L||b,style:{borderColor:l.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:b?"Loading roles...":"Select a role"}),p.map(D=>a.jsx("option",{value:D,children:D},D))]}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.role})]})}),i.role==="DEPARTMENT_HEAD"&&a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),a.jsxs(A.Select,{value:i.department,onChange:D=>k("department",D.target.value),isInvalid:!!l.department,disabled:L||h,style:{borderColor:l.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:h?"Loading departments...":"Select a department"}),m.map(D=>a.jsx("option",{value:D,children:D},D))]}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.department})]})})]}),i.role==="TRAINER"&&a.jsxs(a.Fragment,{children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),a.jsx(A.Control,{type:"text",value:i.specialization,onChange:D=>k("specialization",D.target.value),isInvalid:!!l.specialization,readOnly:L,placeholder:"Enter specialization",style:{borderColor:l.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.specialization})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),a.jsx(A.Control,{type:"text",value:i.certificationNumber,onChange:D=>k("certificationNumber",D.target.value),isInvalid:!!l.certificationNumber,readOnly:L,placeholder:"Enter certification number",style:{borderColor:l.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.certificationNumber})]})})]}),a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),a.jsx(A.Control,{type:"number",value:i.yearsOfExperience,onChange:D=>k("yearsOfExperience",D.target.value),readOnly:L,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})})]}),i.role==="TRAINEE"&&a.jsxs(a.Fragment,{children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),a.jsx(A.Control,{type:"date",value:i.dateOfBirth,onChange:D=>{const M=D.target.value;(M===""||M.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(M))&&k("dateOfBirth",M)},isInvalid:!!l.dateOfBirth,readOnly:L,max:"2024-12-31",min:"1900-01-01",style:{borderColor:l.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.dateOfBirth})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),a.jsx(A.Control,{type:"text",value:i.trainingBatch,onChange:D=>k("trainingBatch",D.target.value),isInvalid:!!l.trainingBatch,readOnly:L,placeholder:"Enter training batch",style:{borderColor:l.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.trainingBatch})]})})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),a.jsx(A.Control,{type:"text",value:i.passportNo,onChange:D=>k("passportNo",D.target.value),isInvalid:!!l.passportNo,readOnly:L,placeholder:"Enter passport number",style:{borderColor:l.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.passportNo})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),a.jsxs(A.Select,{value:i.nation,onChange:D=>k("nation",D.target.value),disabled:L,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:"Select a nation"}),N.map(D=>a.jsx("option",{value:D,children:D},D))]})]})})]})]}),r==="view"&&t&&a.jsx(de,{children:a.jsx(z,{children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),a.jsx(A.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:n,disabled:u,children:[a.jsx(nt,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(ie,{variant:"primary-custom",type:"submit",disabled:u,children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},sW=({user:e,index:t,onView:r,onEdit:s,onDisable:n})=>{const i=l=>l==="ACTIVE"?"success":"secondary",o=l=>l==="ACTIVE"?"":"";return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:e.email})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.department})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs(Ae,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:o(e.status)}),e.status]})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.USERS.VIEW_DETAIL,Te.USERS.UPDATE],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(e),permission:Te.USERS.VIEW_DETAIL},{label:"Edit User",icon:a.jsx(Br,{}),onClick:()=>s(e),permission:Te.USERS.UPDATE},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:a.jsx(dc,{}),className:"text-danger",onClick:()=>n(e),permission:Te.USERS.UPDATE}]})})})]})},aW=({users:e,loading:t,onView:r,onEdit:s,onDisable:n})=>{const{sortedData:i,sortConfig:o,handleSort:l}=Zt(e);if(t)return a.jsx(Rt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No users found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:u,children:d,className:m=""})=>{const f=o.key===u,h=f?o.direction:null;return a.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500",color:"white"},children:d}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:h,size:14,color:"white"})})]}),f&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),a.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),a.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),a.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),a.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:i.map((u,d)=>a.jsx(sW,{user:u,index:d,onView:r,onEdit:s,onDisable:n},u.id))})]})})},nW=()=>{const[e,t]=v.useState([]),[r,s]=v.useState([]),[n,i]=v.useState(""),[o,l]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!1),[f,h]=v.useState(null),[x,p]=v.useState("view"),[g,b]=v.useState(!1),[y,j]=v.useState(null),[S,E]=v.useState(!1),[w,N]=v.useState(null);v.useEffect(()=>{(async()=>{b(!0);try{const[F,H]=await Promise.all([os.getUsers(),kt.getDepartments({includeDeleted:!0})]);let Y=[];Array.isArray(F)?Y=F:Array.isArray(F?.data)?Y=F.data:F?.users&&Array.isArray(F.users)?Y=F.users:(console.warn(" Unexpected users response format:",F),Y=[]);const te=Y.map(we=>({id:we.id,eid:we.eid,fullName:[we.firstName,we.middleName,we.lastName].filter(Boolean).join(" "),firstName:we.firstName,middleName:we.middleName,lastName:we.lastName,role:we.role?.name||"N/A",roleId:we.role?.id||"",department:we.department?.name||"N/A",status:we.status,email:we.email,phoneNumber:we.phoneNumber||"",address:we.address||"",certificationNumber:we.certificationNumber||"",specialization:we.specialization||"",yearsOfExperience:we.yearsOfExperience||"",dateOfBirth:we.dateOfBirth||"",trainingBatch:we.trainingBatch||"",passportNo:we.passportNo||"",nation:we.nation||"",createdAt:we.createdAt,lastLogin:we.lastLogin||""})),pe=H.departments||H||[];t(te),s(pe),j(null)}catch(F){const H=_a(F,{});j(H)}finally{b(!1)}})()},[]);const C=[...new Set(e.map(O=>O.role).filter(Boolean))],T=[...new Set(r.map(O=>O.name).filter(Boolean)),...new Set(e.map(O=>O.department).filter(Boolean))].filter((O,F,H)=>H.indexOf(O)===F),_=e.filter(O=>{const F=!n||O.fullName.toLowerCase().includes(n.toLowerCase())||O.eid.toLowerCase().includes(n.toLowerCase())||O.email.toLowerCase().includes(n.toLowerCase()),H=o.length===0||o.includes(O.role),Y=c.length===0||c.includes(O.department);return F&&H&&Y}),k=O=>i(O),I=O=>{l(F=>F.includes(O)?F.filter(H=>H!==O):[...F,O])},L=O=>{u(F=>F.includes(O)?F.filter(H=>H!==O):[...F,O])},D=()=>{l([]),u([]),i("")},M=async O=>{try{b(!0);const F=await os.getUserById(O.id),H={id:F.id,eid:F.eid,fullName:[F.firstName,F.middleName,F.lastName].filter(Boolean).join(" "),firstName:F.firstName,middleName:F.middleName,lastName:F.lastName,role:F.role?.name||"N/A",roleId:F.role?.id||"",department:F.department?.name||"N/A",status:F.status,email:F.email,phoneNumber:F.phoneNumber||"",address:F.address||"",certificationNumber:F.trainerProfile?.certificationNumber||"",specialization:F.trainerProfile?.specialization||"",yearsOfExperience:F.trainerProfile?.yearsOfExp||"",dateOfBirth:F.traineeProfile?.dob?F.traineeProfile.dob.split("T")[0]:"",trainingBatch:F.traineeProfile?.trainingBatch||"",passportNo:F.traineeProfile?.passportNo||"",nation:F.traineeProfile?.nation||"",createdAt:F.createdAt,lastLogin:F.lastLogin||""};h(H),p("view"),m(!0)}catch{j("Unable to load user details")}finally{b(!1)}},q=async O=>{try{b(!0);const F=await os.getUserById(O.id),H={id:F.id,eid:F.eid,fullName:[F.firstName,F.middleName,F.lastName].filter(Boolean).join(" "),firstName:F.firstName,middleName:F.middleName,lastName:F.lastName,role:F.role?.name||"N/A",roleId:F.role?.id||"",department:F.department?.name||"N/A",status:F.status,email:F.email,phoneNumber:F.phoneNumber||"",address:F.address||"",certificationNumber:F.trainerProfile?.certificationNumber||"",specialization:F.trainerProfile?.specialization||"",yearsOfExperience:F.trainerProfile?.yearsOfExp||"",dateOfBirth:F.traineeProfile?.dob?F.traineeProfile.dob.split("T")[0]:"",trainingBatch:F.traineeProfile?.trainingBatch||"",passportNo:F.traineeProfile?.passportNo||"",nation:F.traineeProfile?.nation||"",createdAt:F.createdAt,lastLogin:F.lastLogin||""};h(H),p("edit"),m(!0)}catch{j("Unable to load user details")}finally{b(!1)}},Z=()=>{h(null),p("add"),m(!0)},Q=async O=>{try{b(!0);let F,H;O.status==="ACTIVE"?(F=await os.disableUser(O.id),H="disabled"):(F=await os.enableUser(O.id),H="enabled");const[Y,te]=await Promise.all([os.getUsers(),kt.getDepartments({includeDeleted:!0})]);let pe=[];Array.isArray(Y)?pe=Y:Array.isArray(Y?.data)?pe=Y.data:Y?.users&&Array.isArray(Y.users)?pe=Y.users:(console.warn(" Unexpected users response format:",Y),pe=[]);const we=pe.map(fe=>({id:fe.id,eid:fe.eid,fullName:[fe.firstName,fe.middleName,fe.lastName].filter(Boolean).join(" "),firstName:fe.firstName,middleName:fe.middleName,lastName:fe.lastName,role:fe.role?.name||"N/A",roleId:fe.role?.id||"",department:fe.department?.name||"N/A",status:fe.status,email:fe.email,phoneNumber:fe.phoneNumber||"",address:fe.address||"",certificationNumber:fe.trainerProfile?.certificationNumber||"",specialization:fe.trainerProfile?.specialization||"",yearsOfExperience:fe.trainerProfile?.yearsOfExp||"",dateOfBirth:fe.traineeProfile?.dob?fe.traineeProfile.dob.split("T")[0]:"",trainingBatch:fe.traineeProfile?.trainingBatch||"",passportNo:fe.traineeProfile?.passportNo||"",nation:fe.traineeProfile?.nation||"",createdAt:fe.createdAt,lastLogin:fe.lastLogin||""})),B=te.departments||te||[];t(we),s(B);const Be=F?.message||`User has been ${H} successfully!`;ne.success(Be)}catch(F){const H=_a(F,{});j(H),ne.error(H)}finally{b(!1)}},U=async O=>{try{if(b(!0),x==="edit"&&f&&f.role!==O.role){N(O),E(!0),b(!1);return}await le(O)}catch{b(!1)}},le=async O=>{try{b(!0);let F=null;try{const fe=(await os.getRoles()).roles?.find(oe=>oe.name===O.role);if(fe)F=fe.id;else throw new Error(`Role '${O.role}' not found in backend`)}catch(Be){throw new Error(`Failed to get role ID for '${O.role}': ${Be.message}`)}const H={firstName:O.firstName,middleName:O.middleName||"",lastName:O.lastName,address:O.address||"",email:O.email,gender:"MALE",avatarUrl:"",phoneNumber:O.phoneNumber||"",role:{id:F,name:O.role}};if(O.role==="TRAINER")H.trainerProfile={specialization:O.specialization||"",certificationNumber:O.certificationNumber||"",yearsOfExp:O.yearsOfExperience?parseInt(O.yearsOfExperience):0,bio:""};else if(O.role==="DEPARTMENT_HEAD")if(O.department&&O.department.trim()){const Be=r.find(fe=>fe.name===O.department);if(Be)H.departmentId=Be.id;else throw new Error(`Department '${O.department}' not found`)}else H.departmentId=null;else O.role==="TRAINEE"&&(O.dateOfBirth||O.trainingBatch||O.passportNo||O.nation)&&(H.traineeProfile={dob:O.dateOfBirth?new Date(O.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:O.trainingBatch||"",passportNo:O.passportNo||"",nation:O.nation||""});x==="add"?(await os.createUser(H),ne.success("User created successfully!")):x==="edit"&&(await os.updateUser(f.id,H),ne.success("User updated successfully!")),m(!1);const[Y,te]=await Promise.all([os.getUsers(),kt.getDepartments({includeDeleted:!0})]);let pe=[];if(Array.isArray(Y)?pe=Y:Array.isArray(Y?.data)?pe=Y.data:Y?.users&&Array.isArray(Y.users)?pe=Y.users:(console.warn(" Unexpected users response format:",Y),pe=[]),x==="edit"&&f?.id){const Be=pe.find(fe=>fe.id===f.id)}const we=pe.map(Be=>({id:Be.id,eid:Be.eid,fullName:[Be.firstName,Be.middleName,Be.lastName].filter(Boolean).join(" "),firstName:Be.firstName,middleName:Be.middleName,lastName:Be.lastName,role:Be.role?.name||"N/A",roleId:Be.role?.id||"",department:Be.department?.name||"N/A",status:Be.status,email:Be.email,phoneNumber:Be.phoneNumber||"",address:Be.address||"",certificationNumber:Be.trainerProfile?.certificationNumber||"",specialization:Be.trainerProfile?.specialization||"",yearsOfExperience:Be.trainerProfile?.yearsOfExp||"",dateOfBirth:Be.traineeProfile?.dob?Be.traineeProfile.dob.split("T")[0]:"",trainingBatch:Be.traineeProfile?.trainingBatch||"",passportNo:Be.traineeProfile?.passportNo||"",nation:Be.traineeProfile?.nation||"",createdAt:Be.createdAt,lastLogin:Be.lastLogin||""})),B=te.departments||te||[];t(we),s(B)}catch(F){const H=_a(F,{});throw j(H),new Error(H)}finally{b(!1)}};return{users:_,searchTerm:n,selectedRoles:o,selectedDepartments:c,uniqueRoles:C,uniqueDepartments:T,modalShow:d,selectedUser:f,modalMode:x,loading:g,error:y,confirmRoleChange:S,pendingUserData:w,handleSearch:k,handleRoleToggle:I,handleDepartmentToggle:L,handleClearFilters:D,handleView:M,handleEdit:q,handleAdd:Z,handleDisable:Q,handleSave:U,handleBulkImport:async O=>{try{b(!0);const F=await os.bulkImportUsers(O);if(F.success&&F.success.length>0&&ne.success(`Successfully imported ${F.success.length} users!`),F.failed&&F.failed.length>0){const B=F.failed.map(Be=>`User ${Be.index+1}: ${Be.error}`);ne.error(`Failed to import ${F.failed.length} users: ${B.join(", ")}`)}const[H,Y]=await Promise.all([os.getUsers(),kt.getDepartments({includeDeleted:!0})]);let te=[];Array.isArray(H)?te=H:Array.isArray(H?.data)?te=H.data:H?.users&&Array.isArray(H.users)?te=H.users:(console.warn(" Unexpected users response format:",H),te=[]);const pe=te.map(B=>({id:B.id,eid:B.eid,fullName:[B.firstName,B.middleName,B.lastName].filter(Boolean).join(" "),firstName:B.firstName,middleName:B.middleName,lastName:B.lastName,role:B.role?.name||"N/A",roleId:B.role?.id||"",department:B.department?.name||"N/A",status:B.status,email:B.email,phoneNumber:B.phoneNumber||"",address:B.address||"",certificationNumber:B.trainerProfile?.certificationNumber||"",specialization:B.trainerProfile?.specialization||"",yearsOfExperience:B.trainerProfile?.yearsOfExp||"",dateOfBirth:B.traineeProfile?.dob?B.traineeProfile.dob.split("T")[0]:"",trainingBatch:B.traineeProfile?.trainingBatch||"",passportNo:B.traineeProfile?.passportNo||"",nation:B.traineeProfile?.nation||"",createdAt:B.createdAt,lastLogin:B.lastLogin||""})),we=Y.departments||Y||[];t(pe),s(we)}catch(F){const H=_a(F,{});j(H),ne.error(H)}finally{b(!1)}},handleModalClose:()=>{m(!1),h(null)},handleConfirmRoleChange:async()=>{E(!1),w&&(await le(w),N(null))},handleCancelRoleChange:()=>{E(!1),N(null)},setError:j}},iW=()=>{const[e,t]=vx();it();const[r,s]=v.useState(!1),[n,i]=v.useState(null),[o,l]=v.useState(!1),[c,u]=v.useState(!1);v.useEffect(()=>{if(e.get("action")==="bulk-import"){u(!0);const K=new URLSearchParams(e);K.delete("action"),t(K,{replace:!0})}},[e,t]);const{users:d,loading:m,error:f,searchTerm:h,selectedRoles:x,selectedDepartments:p,uniqueRoles:g,uniqueDepartments:b,modalShow:y,selectedUser:j,modalMode:S,confirmRoleChange:E,pendingUserData:w,handleSearch:N,handleRoleToggle:C,handleDepartmentToggle:T,handleClearFilters:_,handleView:k,handleEdit:I,handleAdd:L,handleDisable:D,handleSave:M,handleBulkImport:q,handleModalClose:Z,handleConfirmRoleChange:Q,handleCancelRoleChange:U}=nW(),le=G=>{i(G),s(!0)},Se=async()=>{if(n){l(!0);try{await D(n),s(!1),i(null)}catch(G){console.error("Error disabling user:",G)}finally{l(!1)}}},P=()=>{s(!1),i(null)};return J.useEffect(()=>{f&&ne.error(f)},[f]),a.jsx(_e,{fluid:!0,className:"py-4 user-management-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(hr,{permission:Te.USERS.BULK_CREATE,fallback:null,children:a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>u(!0),className:"d-flex align-items-center",children:[a.jsx(Ds,{className:"me-1",size:16}),a.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),a.jsx("span",{className:"d-sm-none",children:"Import"})]})}),a.jsx(hr,{permission:Te.USERS.CREATE,fallback:null,children:a.jsxs(ie,{variant:"primary-custom",size:"sm",onClick:L,className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-1",size:16}),"Add User"]})})]})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search users by name, EID, or email...",value:h,onChange:N,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(eW,{uniqueRoles:g,uniqueDepartments:b,selectedRoles:x,selectedDepartments:p,onRoleToggle:C,onDepartmentToggle:T,onClearFilters:_,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[d.length," user",d.length!==1?"s":""]})})})]}),a.jsxs("div",{className:"position-relative",children:[a.jsx(aW,{users:d,loading:m,onView:k,onEdit:I,onDisable:le}),d.length>8&&a.jsxs("div",{className:"scroll-indicator",children:[a.jsx(Ka,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),a.jsx(rW,{show:y,user:j,mode:S,onSave:M,onClose:Z}),a.jsx(ZU,{show:c,onClose:()=>{if(u(!1),e.get("action")==="bulk-import"){const G=new URLSearchParams(e);G.delete("action"),t(G,{replace:!0})}},onImport:q,loading:m}),a.jsx(QU,{show:r,user:n,onConfirm:Se,onCancel:P,loading:o}),a.jsx(tW,{show:E,user:j,newRole:w?.role,onConfirm:Q,onCancel:U,loading:m})]})]})})},oW=({show:e,role:t,onConfirm:r,onCancel:s,loading:n})=>{if(!t)return null;const i=t.status==="Active",o=i?"Disable":"Enable",c=i?C2:ht;return a.jsxs(ce,{show:e,onHide:s,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ce.Header,{closeButton:!0,className:"text-white border-0",style:{backgroundColor:i?"var(--bs-secondary)":"#28a745",borderBottom:"none"},children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(c,{size:24,className:"me-2"}),o," Role: ",t.name]})}),a.jsxs(ce.Body,{className:"py-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-secondary)":"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),a.jsx("div",{children:a.jsx("h6",{className:"mb-0",children:t.name})})]}),i?a.jsxs(Re,{variant:"warning",className:"mb-3",style:{backgroundColor:"#f0e8e0",borderColor:"var(--bs-secondary)",color:"var(--bs-dark)"},children:[a.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[a.jsx(fr,{className:"me-2",style:{color:"var(--bs-secondary)"}})," Warning: Disabling Role"]}),a.jsxs("p",{className:"mb-1",children:["This action will disable the ",a.jsx("span",{className:"fw-bold",children:t.name})," role."]}),a.jsxs("ul",{className:"mb-0 ps-3",children:[a.jsx("li",{children:"Users with this role will lose access to associated permissions."}),a.jsx("li",{children:"Role data will be preserved but access will be restricted."}),a.jsx("li",{children:"Role can be re-enabled later by an administrator."}),a.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):a.jsxs(Re,{variant:"success",className:"mb-3",children:[a.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[a.jsx(ht,{className:"me-2"})," Confirm: Enabling Role"]}),a.jsxs("p",{className:"mb-1",children:["This action will restore the ",a.jsx("span",{className:"fw-bold",children:t.name})," role."]}),a.jsxs("ul",{className:"mb-0 ps-3",children:[a.jsx("li",{children:"Users with this role will regain access to associated permissions."}),a.jsx("li",{children:"All role permissions and access will be restored."}),a.jsx("li",{children:"Role will be available for assignment to new users."}),a.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(ie,{variant:"outline-secondary",onClick:s,disabled:n,children:"Cancel"}),a.jsx(ie,{variant:i?"secondary":"success",onClick:r,disabled:n,className:"d-flex align-items-center",style:i?{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#fff"}:{},children:n?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(c,{size:16,className:"me-2"}),o," Role"]})})]})]})]})},lW=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:s,className:n=""})=>{const i=t.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown ${n}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",i&&a.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>a.jsx(A.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:s,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},cW=["ADMINISTRATOR"],Xb=e=>cW.includes(e?.toUpperCase()),dW=({show:e,role:t,mode:r,onSave:s,onClose:n})=>{const[i,o]=v.useState({name:"",description:"",permissionIds:[]}),[l,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState({}),{allPermissions:h,loading:x,error:p,fetchAllPermissions:g}=cO(),b=v.useMemo(()=>{if(!h||h.length===0)return[];const _={};return h.forEach(k=>{const I=k.module,L=k.viewModule||`${k.module} Management`;_[I]||(_[I]={id:I,name:L,description:`Manage ${L.toLowerCase()} related permissions`,permissions:[]});const D=k.id||k.permissionId;D&&_[I].permissions.push({id:D,title:k.viewName||k.name,description:k.description||"",isActive:k.isActive,method:k.method,path:k.path})}),Object.values(_).sort((k,I)=>k.name.localeCompare(I.name))},[h]),y=v.useMemo(()=>{const _=b;if(r==="view"&&t?.permissions){const k=t.permissions.map(I=>I.id||I);return _.map(I=>({...I,permissions:I.permissions.filter(L=>k.includes(L.id))})).filter(I=>I.permissions.length>0)}return _},[b,r,t?.permissions]);v.useEffect(()=>{if(t&&r!=="add"){const _=t.permissions?t.permissions.map(k=>k.id||k):[];o({name:t.name||"",description:t.description||"",permissionIds:_})}else r==="add"&&o({name:"",description:"",permissionIds:[]});c({})},[t,r,e]),v.useEffect(()=>{e&&g()},[e,g]),v.useEffect(()=>{if(r==="view"){const _={};y.map(I=>I.id).forEach(I=>{_[I]=!0}),f(_)}else if(r==="edit"){const _={};y.map(I=>I.id).forEach(I=>{_[I]=!0}),f(_)}else f({})},[r,y]);const j=()=>{const _={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(_.name="Role name cannot contain special characters"):_.name="Role name is required",i.permissionIds.length===0&&(_.permissionIds="At least one permission is required"),c(_),Object.keys(_).length===0},S=async _=>{if(_.preventDefault(),!!j()){d(!0);try{await s(i)}catch(k){console.error("Error saving role:",k)}finally{d(!1)}}},E=(_,k)=>{o(I=>({...I,[_]:k})),l[_]&&c(I=>({...I,[_]:""}))},w=_=>{!_||_===null||_===void 0||(o(k=>{const I=k.permissionIds||[],L=I.some(D=>String(D)===String(_));return{...k,permissionIds:L?I.filter(D=>String(D)!==String(_)):[...I,_]}}),l.permissionIds&&c(k=>({...k,permissionIds:""})))},N=_=>{f(k=>({...k,[_]:!k[_]}))},C=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},T=r==="view";return a.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Et,{className:"me-2",size:20}):a.jsx(Ex,{className:"me-2",size:20}),C()]})}),a.jsxs(A,{onSubmit:S,children:[a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&Xb(t.name)&&r==="edit"&&a.jsxs(Re,{variant:"warning",className:"mb-3",children:[a.jsx(fr,{className:"me-2"}),a.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(l).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([_,k])=>a.jsx("li",{children:k},_))})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsx(A.Group,{className:"mb-3",children:a.jsxs(de,{className:"align-items-center",children:[a.jsx(z,{md:2,children:a.jsx(A.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),a.jsxs(z,{md:4,children:[a.jsx(A.Control,{type:"text",size:"sm",value:i.name,onChange:_=>{const k=_.target.value;/^[a-zA-Z0-9\s_]*$/.test(k)&&E("name",k)},isInvalid:!!l.name,readOnly:T,style:{borderColor:l.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.name})]})]})})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsx(A.Group,{className:"mb-3",children:a.jsxs(de,{className:"align-items-start",children:[a.jsx(z,{md:2,children:a.jsx(A.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),a.jsx(z,{md:4,children:a.jsx(A.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:_=>E("description",_.target.value),readOnly:T,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),a.jsx(de,{children:a.jsx(z,{children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),l.permissionIds&&a.jsx("div",{className:"text-danger small mb-2",children:l.permissionIds}),p&&a.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",p.message||"Unknown error"]}),a.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"300px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:x?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Ot,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):y.length>0?a.jsx(a.Fragment,{children:y.map(_=>{const k=m[_.id];return a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${T?"":"cursor-pointer"}`,onClick:()=>!T&&N(_.id),role:T?void 0:"button",tabIndex:T?void 0:0,onKeyDown:T?void 0:I=>{(I.key==="Enter"||I.key===" ")&&(I.preventDefault(),N(_.id))},"aria-expanded":T?void 0:k,children:a.jsxs("div",{className:"d-flex align-items-center",children:[!T&&(k?a.jsx(Ka,{className:"me-2",size:16}):a.jsx(cc,{className:"me-2",size:16})),a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold text-primary-custom",children:_.name}),a.jsx("small",{className:"text-muted",children:_.description})]})]})}),k&&_.permissions.length>0&&a.jsx("div",{className:"ms-3 mt-2",children:a.jsx(ha,{variant:"flush",children:_.permissions.map(I=>{const L=I.id;return L?a.jsx(ha.Item,{className:"border-0 px-0 py-2 permission-item",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"form-check me-3",children:a.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${L}`,checked:i.permissionIds.some(D=>String(D)===String(L)),onChange:D=>{D.stopPropagation(),!T&&L&&w(L)},onClick:D=>{D.stopPropagation()},disabled:T,style:{cursor:T?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("div",{className:"fw-medium text-dark",children:I.title}),a.jsx("small",{className:"text-muted",children:I.description})]}),!T&&i.permissionIds.some(D=>String(D)===String(L))&&a.jsx(Ae,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${_.id}-${L}`):null})})})]},_.id)})}):a.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),a.jsx("div",{className:"mt-2",children:a.jsxs("small",{className:"text-muted",children:[i.permissionIds.length," of ",y.reduce((_,k)=>_+k.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&a.jsx(de,{children:a.jsx(z,{children:a.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[a.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsx("small",{className:"text-muted",children:"Assigned Users:"}),a.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),a.jsxs("div",{className:"col-md-6",children:[a.jsx("small",{className:"text-muted",children:"Total Permissions:"}),a.jsx("div",{className:"fw-medium",children:i.permissionIds.length})]})]})]})})})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:n,disabled:u,children:[a.jsx(nt,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(ie,{variant:"primary-custom",type:"submit",disabled:u||t&&Xb(t.name),children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},uW=({roles:e,loading:t,actionsComponent:r,onView:s,onEdit:n,onDisable:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Rt,{rows:4,columns:4});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No roles found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=l.key===d,x=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:x,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(u,{columnKey:"name",className:"show-mobile",children:"Role Name"}),a.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(u,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),a.jsx(u,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:o.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:d.name}),a.jsx("td",{className:"show-mobile",children:a.jsxs(Ae,{bg:d.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:d.status==="Active"?"":""}),d.status]})}),a.jsx("td",{className:"show-mobile",children:d.assignedUsers}),a.jsx("td",{className:"show-mobile",children:d.lastModified}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(r,{role:d})})]},d.id))})]})})},il=e=>e===!0||e==="ACTIVE",mW=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(""),[n,i]=v.useState([]),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("view"),[f,h]=v.useState(!1),[x,p]=v.useState(null);v.useEffect(()=>{(async()=>{h(!0);try{const I=await Cs.getRoles({includeDeleted:!0}),D=(Array.isArray(I)?I:I?.roles||[]).map(M=>({id:M.id,name:M.name,description:M.description||"",assignedUsers:M.userCount||0,status:il(M.isActive)?"Active":"Inactive",createdAt:M.createdAt?M.createdAt.split("T")[0]:"",lastModified:M.updatedAt?M.updatedAt.split("T")[0]:"",isActive:M.isActive,permissions:M.permissions||[],originalData:M}));t(D),p(null)}catch(I){const L=_a(I,{});p(L),console.error("Error fetching roles:",I)}finally{h(!1)}})()},[]);const g=k=>s(k),b=k=>{i(k==="clear"?[]:I=>I.includes(k)?I.filter(L=>L!==k):[...I,k])},y=()=>{i([])},j=async k=>{try{h(!0);const I=await Cs.getRoleById(k.id);u(I),m("view"),l(!0)}catch(I){const L=_a(I,{});p(L),console.error("Error fetching role details:",I)}finally{h(!1)}},S=async k=>{try{h(!0);const I=await Cs.getRoleById(k.id),L={id:I.id,name:I.name,description:I.description||"",assignedUsers:I.userCount||0,status:il(I.isActive)?"Active":"Inactive",createdAt:I.createdAt?I.createdAt.split("T")[0]:"",lastModified:I.updatedAt?I.updatedAt.split("T")[0]:"",isActive:I.isActive,permissions:I.permissions||[],originalData:I};u(L),m("edit"),l(!0),p(null)}catch(I){const L=_a(I,{});p(L)}finally{h(!1)}},E=()=>{u(null),m("add"),l(!0)},w=async k=>{if(window.confirm("Are you sure you want to delete this role?")){h(!0);try{await new Promise(I=>setTimeout(I,1e3)),t(I=>I.filter(L=>L.id!==k)),p(null)}catch{p("Failed to delete role")}finally{h(!1)}}},N=async k=>{h(!0);try{d==="add"?(await Cs.createRole(k),ne.success("Role created successfully!")):(await Cs.updateRole(c.id,k),ne.success("Role updated successfully!"));const I=await Cs.getRoles({includeDeleted:!0}),D=(Array.isArray(I)?I:I?.roles||[]).map(M=>({id:M.id,name:M.name,description:M.description||"",assignedUsers:M.userCount||0,status:il(M.isActive)?"Active":"Inactive",createdAt:M.createdAt?M.createdAt.split("T")[0]:"",lastModified:M.updatedAt?M.updatedAt.split("T")[0]:"",isActive:M.isActive,originalData:M}));t(D),l(!1),u(null),p(null)}catch(I){const L=_a(I,{});p(L),ne.error(L)}finally{h(!1)}},C=async k=>{h(!0);try{const I=e.find(le=>le.id===k);if(!I)throw new Error("Role not found");let L,D;il(I.isActive)?(L=await Cs.disableRole(k),D="disabled"):(L=await Cs.enableRole(k),D="enabled");const q=await Cs.getRoles({includeDeleted:!0}),Q=(Array.isArray(q)?q:q?.roles||[]).map(le=>({id:le.id,name:le.name,description:le.description||"",assignedUsers:le.userCount||0,status:il(le.isActive)?"Active":"Inactive",createdAt:le.createdAt?le.createdAt.split("T")[0]:"",lastModified:le.updatedAt?le.updatedAt.split("T")[0]:"",isActive:le.isActive,originalData:le}));t(Q);const U=L?.message||`Role has been ${D} successfully!`;ne.success(U),p(null)}catch(I){const L=_a(I,{});p(L)}finally{h(!1)}},T=[...new Set(e.map(k=>k.status))];return{roles:e.filter(k=>{const I=k.name.toLowerCase().includes(r.toLowerCase()),L=n.length===0||n.includes(k.status);return I&&L}),loading:f,error:x,searchTerm:r,selectedStatuses:n,uniqueStatuses:T,modalShow:o,selectedRole:c,modalMode:d,handleSearch:g,handleStatusToggle:b,handleClearFilters:y,handleView:j,handleEdit:S,handleAdd:E,handleDelete:w,handleSave:N,handleDisable:C,handleModalClose:()=>l(!1),setError:p}},fW=()=>{const[e,t]=v.useState(!1),[r,s]=v.useState(null),[n,i]=v.useState(!1),{roles:o,loading:l,error:c,searchTerm:u,selectedStatuses:d,uniqueStatuses:m,modalShow:f,selectedRole:h,modalMode:x,handleSearch:p,handleStatusToggle:g,handleClearFilters:b,handleView:y,handleEdit:j,handleAdd:S,handleSave:E,handleDisable:w,handleModalClose:N}=mW(),C=I=>{s(I),t(!0)},T=async()=>{if(r){i(!0);try{await w(r.id),t(!1),s(null)}catch(I){console.error("Error disabling role:",I)}finally{i(!1)}}},_=()=>{t(!1),s(null)},k=({role:I})=>a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>y(I)},{label:"Edit Role",icon:a.jsx(Br,{}),onClick:()=>j(I)},...I.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:I.status==="Active"?"Disable Role":"Enable Role",icon:a.jsx(dc,{}),className:I.status==="Active"?"text-warning":"text-success",onClick:()=>C(I)}]:[]]});return J.useEffect(()=>{c&&ne.error(c)},[c]),a.jsx(_e,{fluid:!0,className:"py-4 role-management-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(hr,{permission:Te.ROLES.CREATE,fallback:null,children:a.jsxs(ie,{variant:"primary-custom",size:"sm",onClick:S,className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-1",size:16}),"Add Role"]})})})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search roles by name...",value:u,onChange:p,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(lW,{uniqueStatuses:m,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[o.length," role",o.length!==1?"s":""]})})})]}),a.jsx(uW,{roles:o,loading:l,actionsComponent:k,onView:y,onEdit:j,onDisable:w}),a.jsx(dW,{show:f,role:h,mode:x,onSave:E,onClose:N}),a.jsx(oW,{show:e,role:r,onConfirm:T,onCancel:_,loading:n})]})]})})},hW=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const s=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return a.jsxs(ce,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[a.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Bs,{className:"me-2",size:20}),"Department Details"]})}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[a.jsxs(de,{className:"mb-4",children:[a.jsxs(z,{md:8,children:[a.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),a.jsx("p",{className:"text-muted mb-3",children:t.description})]}),a.jsx(z,{md:4,className:"text-end",children:a.jsx(Ae,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),a.jsx("div",{className:"p-3 bg-light rounded",children:a.jsx(Ae,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),a.jsx("div",{className:"p-3 bg-light rounded",children:a.jsx(Ae,{bg:s(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),a.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(va,{className:"me-3 text-primary",size:24}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),a.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):a.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),a.jsx(de,{className:"mb-4",children:a.jsxs(z,{md:12,children:[a.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),a.jsxs(de,{children:[a.jsx(z,{md:4,children:a.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[a.jsx(It,{className:"text-primary mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),a.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),a.jsx(z,{md:4,children:a.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[a.jsx(Lr,{className:"text-success mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),a.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),a.jsx(z,{md:4,children:a.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[a.jsx(va,{className:"text-info mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),a.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),a.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),a.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),a.jsx(ce.Footer,{className:"border-0 p-4",children:a.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[a.jsx(nt,{className:"me-2",size:16}),"Close"]})})]})},pW=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:s,onTypeToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown ${l}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Types"}),r.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>a.jsx(A.Check,{type:"checkbox",id:`type-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),s.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>a.jsx(A.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:s.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},xW=({show:e,department:t,mode:r,onSave:s,onClose:n,availableUsers:i})=>{const[o,l]=v.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,u]=v.useState({}),[d,m]=v.useState(!1);v.useEffect(()=>{t&&r!=="add"?l({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&l({name:"",code:"",description:"",departmentHeadId:""}),u({})},[t,r,e]);const f=()=>{const b={};return o.name.trim()?o.name.trim().length<3?b.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(o.name.trim())||(b.name="Department name cannot contain special characters"):b.name="Department name is required",o.code.trim()?/^[A-Z]{2,5}$/.test(o.code.trim())||(b.code="Department code must be 2-5 uppercase letters"):b.code="Department code is required",o.departmentHeadId||(b.departmentHeadId="Department head is required"),u(b),Object.keys(b).length===0},h=async b=>{if(b.preventDefault(),!!f()){m(!0);try{const y={name:o.name.trim(),code:o.code.trim(),description:o.description.trim(),headUserId:o.departmentHeadId};console.log(" Department data being sent:",y),await s(y)}catch(y){console.error("Error saving department:",y)}finally{m(!1)}}},x=(b,y)=>{l(j=>({...j,[b]:y})),c[b]&&u(j=>({...j,[b]:""}))},p=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return a.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Et,{className:"me-2",size:20}):a.jsx(ts,{className:"me-2",size:20}),p()]})}),a.jsxs(A,{onSubmit:h,children:[a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([b,y])=>a.jsx("li",{children:y},b))})]}),a.jsxs(de,{children:[a.jsx(z,{md:8,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),a.jsx(A.Control,{type:"text",value:o.name,onChange:b=>x("name",b.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:c.name})]})}),a.jsx(z,{md:4,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),a.jsx(A.Control,{type:"text",value:o.code,onChange:b=>x("code",b.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(A.Control.Feedback,{type:"invalid",children:c.code})]})})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),a.jsxs(A.Select,{value:o.departmentHeadId,onChange:b=>x("departmentHeadId",b.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:"Select department head"}),i.map(b=>a.jsxs("option",{value:b.id,children:[b.firstName," ",b.lastName," (",b.eid,")"]},b.id))]}),a.jsx(A.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),a.jsx(A.Control,{as:"textarea",rows:4,value:o.description,onChange:b=>x("description",b.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),a.jsx(A.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),a.jsx(A.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),a.jsx(A.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),a.jsx(A.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:n,disabled:d,children:[a.jsx(nt,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(ie,{variant:"primary-custom",type:"submit",disabled:d,children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},gW=({department:e,index:t,onView:r,onToggleStatus:s})=>{const n=o=>o==="ACTIVE"?"success":"secondary",i=o=>o==="ACTIVE"?"":"";return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:e.name})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.coursesCount})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.traineesCount})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.trainersCount})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs(Ae,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.DEPARTMENTS.VIEW_DETAIL,Te.DEPARTMENTS.UPDATE],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(e),permission:Te.DEPARTMENTS.VIEW_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:a.jsx(dc,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>s(e),permission:Te.DEPARTMENTS.UPDATE}]})})})]})},vW=({departments:e,loading:t,onView:r,onToggleStatus:s})=>{const{sortedData:n,sortConfig:i,handleSort:o}=Zt(e);if(t)return a.jsx(Rt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No departments found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const l=({columnKey:c,children:u,className:d=""})=>{const m=i.key===c,f=m?i.direction:null;return a.jsxs("th",{className:`fw-semibold ${d}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(c),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500",color:"white"},children:u}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:f,size:14,color:"white"})})]}),m&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(l,{columnKey:"name",className:"show-mobile",children:"Department Name"}),a.jsx(l,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(l,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),a.jsx(l,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),a.jsx(l,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),a.jsx(l,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),a.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:n.map((c,u)=>a.jsx(gW,{department:c,index:u,onView:r,onToggleStatus:s},c.id))})]})})},bW=({show:e,department:t,onConfirm:r,onCancel:s,isProcessing:n})=>{const[i,o]=v.useState({courseCount:0,traineeCount:0,trainerCount:0}),[l,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(null);v.useEffect(()=>{e&&t?.id&&h()},[e,t?.id]);const h=async()=>{if(t?.id){c(!0);try{const y=await kt.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Full API response:",y),console.log(" DisableDepartmentModal - Department Head data:",y.departmentHead||y.headUser),d(y);const j=y.departmentHead||y.headUser;if(j&&j.id&&!j.eid)try{const S=await os.getUserById(j.id);console.log(" DisableDepartmentModal - Head User detail from API:",S),f(S)}catch(S){console.warn(" Could not fetch headUser detail:",S)}o({courseCount:y.courseCount||y.coursesCount||0,traineeCount:y.traineeCount||y.traineesCount||0,trainerCount:y.trainerCount||y.trainersCount||0})}catch(y){console.error("Error fetching department statistics:",y),d(null),f(null),o({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const x=t.status==="ACTIVE",p=x?"deactivate":"activate",g=x?"Deactivate":"Activate",b=!x||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return a.jsxs(ce,{show:e,onHide:s,centered:!0,children:[a.jsx(ce.Header,{className:"border-0 pb-0",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:"me-2 text-warning",size:20}),g," Department"]})}),a.jsxs(ce.Body,{className:"pt-0",children:[a.jsx(Re,{variant:x?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:a.jsx("div",{className:"d-flex align-items-start",children:a.jsxs("div",{children:[a.jsxs("strong",{children:["Are you sure you want to ",p," this department?"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),x&&a.jsx("div",{className:"mt-2",children:b?a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Warning:"})," Deactivating this department will:",a.jsxs("ul",{className:"mb-0 mt-1",children:[a.jsx("li",{children:"Make it unavailable for new course assignments"}),a.jsx("li",{children:"Hide it from department selection dropdowns"}),a.jsx("li",{children:"Not affect existing courses and users"})]})]}):a.jsxs("div",{className:"text-danger",children:[a.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!x&&a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",a.jsxs("ul",{className:"mb-0 mt-1",children:[a.jsx("li",{children:"New course assignments"}),a.jsx("li",{children:"Department selection in forms"}),a.jsx("li",{children:"User management operations"})]})]})]})})}),a.jsxs("div",{className:"bg-light p-4 rounded",children:[a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"d-flex flex-column",children:[a.jsx("strong",{className:"mb-1",children:"Department Head:"}),a.jsx("span",{className:"text-muted text-break",children:(()=>{const y=u||t;let j=y.departmentHead||y.headUser;if(j&&m&&(j={...j,...m}),j){console.log(" Department Head object:",j);let S="";if(j.name)S=j.name;else if(j.firstName||j.lastName){const w=[];j.firstName&&w.push(j.firstName),j.middleName&&w.push(j.middleName),j.lastName&&w.push(j.lastName),S=w.join(" ").trim()}else j.fullName&&(S=j.fullName);const E=m?.eid||m?.employeeId||j.eid||j.employeeId||"";if(console.log(" Name:",S,"EID:",E||"NOT FOUND"),S&&E)return`${S} [${E}]`;if(S)return S;if(E)return`[${E}]`;if(j.email)return console.warn(" No name or EID found in headUser object, showing email as fallback"),console.warn(" headUser object keys:",Object.keys(j)),j.email}return"N/A"})()})]})}),a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"d-flex flex-column",children:[a.jsx("strong",{className:"mb-1",children:"Current Status:"}),a.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status})]})})]}),a.jsx("hr",{className:"my-3"}),a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Ot,{animation:"border",size:"sm",className:"text-primary"}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),a.jsx("small",{className:"text-muted",children:"Courses"})]})}),a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Ot,{animation:"border",size:"sm",className:"text-primary"}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),a.jsx("small",{className:"text-muted",children:"Trainees"})]})}),a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Ot,{animation:"border",size:"sm",className:"text-primary"}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),a.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),a.jsxs(ce.Footer,{className:"border-0",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:s,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:x?"warning":"success",onClick:r,disabled:n||x&&!b,style:{backgroundColor:x?"#ffc107":"#28a745",borderColor:x?"#ffc107":"#28a745",opacity:x&&!b?.5:1},children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(fr,{className:"me-2",size:16}),x&&!b?"Cannot Deactivate":`${g} Department`]})})]})]})},yW=()=>{const e=it(),{departments:t,loading:r,searchTerm:s,setSearchTerm:n,createDepartment:i,updateDepartment:o,disableDepartment:l,enableDepartment:c,getAvailableUsers:u}=_x(),[d,m]=v.useState(!1),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,b]=v.useState("add"),[y,j]=v.useState(null),[S,E]=v.useState(!1),[w,N]=v.useState([]),[C,T]=v.useState([]),[_,k]=v.useState([]);v.useEffect(()=>{(async()=>{try{const Y=await u();k(Y)}catch(Y){console.error("Error loading available users:",Y),k([])}})()},[]);const I=()=>{j(null),b("add"),m(!0)},L=H=>{e(`/admin/departments/${H.id}`)},D=H=>{j(H),h(!0)},M=()=>{m(!1),j(null),b("add")},q=()=>{h(!1),j(null)},Z=()=>{p(!1),j(null)},Q=async H=>{try{g==="add"?(await i(H),ne.success("Department created successfully")):g==="edit"&&(await o(y.id,H),ne.success("Department updated successfully")),M()}catch(Y){console.error("Error saving department:",Y),ne.error("Failed to save department")}},U=async()=>{try{y&&(y.status==="ACTIVE"?(await l(y.id),ne.success("Department disabled successfully")):(await c(y.id),ne.success("Department enabled successfully")),q())}catch(H){console.error("Error toggling department status:",H),ne.error("Failed to toggle department status")}},le=H=>{n(H)},Se=H=>{N(H==="clear"?[]:Y=>Y.includes(H)?Y.filter(te=>te!==H):[...Y,H])},P=H=>{T(H==="clear"?[]:Y=>Y.includes(H)?Y.filter(te=>te!==H):[...Y,H])},G=()=>{N([]),T([])},K=[...new Set(t.map(H=>H.type).filter(Boolean))],O=["ACTIVE","INACTIVE"],F=t.filter(H=>{const Y=w.length===0||w.includes(H.type),te=C.length===0||C.includes(H.status);return Y&&te});return a.jsxs(_e,{fluid:!0,className:"py-4 department-management-page",children:[a.jsxs(W,{className:"shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-0 pb-0",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(hr,{permission:Te.DEPARTMENTS.CREATE,fallback:null,children:a.jsxs(ie,{variant:"primary-custom",size:"sm",onClick:I,className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-1",size:16}),"Add Department"]})})})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-4 form-mobile-stack",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search departments by name, code, or description...",value:s,onChange:le,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(pW,{uniqueTypes:K,uniqueStatuses:O,selectedTypes:w,selectedStatuses:C,onTypeToggle:Se,onStatusToggle:P,onClearFilters:G,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[F.length," department",F.length!==1?"s":""]})})})]}),a.jsx("div",{className:"position-relative mt-3",children:a.jsx(vW,{departments:F,loading:r,onView:L,onToggleStatus:D})})]})]}),d&&a.jsx(xW,{show:d,department:y,mode:g,onSave:Q,onClose:M,availableUsers:_}),f&&y&&a.jsx(bW,{show:f,department:y,onConfirm:U,onCancel:q,isProcessing:r}),x&&y&&a.jsx(hW,{show:x,department:y,onClose:Z})]})},jW=({department:e,onBack:t})=>a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-start mb-3",children:[a.jsx(ie,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:a.jsx(_t,{})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:e.name}),a.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),wW=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:y2,description:"View department overview"},{id:"edit",label:"Edit Details",icon:Br,description:"Modify department information"}];return a.jsxs("div",{className:"department-tabs",children:[a.jsx("div",{className:"tab-navigation",children:r.map(s=>{const n=s.icon,i=e===s.id;return a.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(s.id),children:[a.jsx("div",{className:"tab-icon",children:a.jsx(n,{size:20})}),a.jsxs("div",{className:"tab-content",children:[a.jsx("div",{className:"tab-label",children:s.label}),a.jsx("div",{className:"tab-description",children:s.description})]}),i&&a.jsx("div",{className:"tab-indicator"})]},s.id)})}),a.jsx("div",{className:"tab-separator"})]})},NW=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),SW=({department:e,onUpdate:t})=>{const[r,s]=v.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=v.useState(!1),[o,l]=v.useState([]);v.useEffect(()=>{(async()=>{try{const m=await kt.getDepartmentHeads(),f=Array.isArray(m)?m:m.data||m.users||[];l(f)}catch(m){console.error("Error loading department heads:",m),ne.error("Failed to load department heads"),l([])}})()},[]);const c=d=>{const{name:m,value:f}=d.target;s(h=>({...h,[m]:f}))},u=async d=>{d.preventDefault(),i(!0);try{if(!r.name||r.name.trim()===""){ne.error("Department name is required"),i(!1);return}console.log(" Submitting department update:",{departmentId:e.id,formData:r});const m=await kt.updateDepartment(e.id,r),f=NW(m);t(f),ne.success("Department updated successfully!")}catch(m){console.error(" Error updating department:",m);let f="Failed to update department";m.code==="NETWORK_ERROR"?f="Network error: Unable to connect to server. Please check your connection.":m.code==="BAD_GATEWAY"?f="Server error (502): The server is temporarily unavailable. Please try again later.":m.code==="PERMISSION_DENIED"?f="Permission denied: You do not have permission to update this department.":m.response?.data?.message?f=m.response.data.message:m.message&&(f=m.message),ne.error(f)}finally{i(!1)}};return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),a.jsxs("form",{onSubmit:u,children:[a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),a.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),a.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[a.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(o)&&o.map(d=>a.jsxs("option",{value:d.id,children:["[",d.eid,"] - ",d.firstName," ",d.lastName]},d.id))]})]})})}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),a.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),a.jsx("div",{className:"d-flex gap-2",children:a.jsx(ie,{type:"submit",variant:"primary",disabled:n,children:n?"Updating...":"Update Department"})})]})]})},Jb=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return a.jsxs("div",{className:"department-info",children:[a.jsx("h4",{className:"mb-4",children:"Department Overview"}),a.jsxs(de,{className:"g-4",children:[a.jsx(z,{md:6,children:a.jsxs("div",{className:"info-card info-card-basic",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(It,{className:"info-icon"}),a.jsx("h6",{children:"Basic Information"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Name:"}),a.jsx("span",{className:"info-value",children:e.name})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Code:"}),a.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Description:"}),a.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"info-card info-card-statistics",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(Lr,{className:"info-icon"}),a.jsx("h6",{children:"Department Statistics"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Courses:"}),a.jsx("span",{className:"info-value",children:e.courseCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Trainees:"}),a.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Trainers:"}),a.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Head of Department:"}),a.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"info-card info-card-timeline",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(nr,{className:"info-icon"}),a.jsx("h6",{children:"Timeline"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Created:"}),a.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Last Updated:"}),a.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Deleted:"}),a.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},EW=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),TW=()=>{const{id:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState("info"),d=v.useCallback(async()=>{if(!e){ne.error("Department ID is required"),i(!1);return}i(!0),l(null);try{const x=await kt.getDepartmentById(e),p=EW(x);s(p)}catch(x){console.error("Error loading department:",x),ne.error("Failed to load department details"),l("Failed to load department details")}finally{i(!1)}},[e]);v.useEffect(()=>{d()},[d]);const m=()=>{t("/admin/departments")},f=x=>{u(x)};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:a.jsx(Ot,{animation:"border",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsxs("div",{className:"text-danger mb-3",children:[a.jsx("h5",{children:"Unable to load department"}),a.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),a.jsxs(ie,{variant:"outline-primary",onClick:m,children:[a.jsx(_t,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsxs("div",{className:"text-warning mb-3",children:[a.jsx("h5",{children:"Department not found"}),a.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),a.jsxs(ie,{variant:"outline-primary",onClick:m,children:[a.jsx(_t,{className:"me-2"}),"Back to Departments"]})]})});const h=()=>{switch(c){case"info":return a.jsx(Jb,{department:r});case"edit":return a.jsx(SW,{department:r,onUpdate:s});default:return a.jsx(Jb,{department:r})}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(jW,{department:r,onBack:m}),a.jsx(wW,{activeTab:c,onTabChange:f}),a.jsx(de,{children:a.jsx(z,{children:a.jsx(W,{className:"shadow-sm",children:a.jsx(W.Body,{className:"p-4",children:h()})})})})]})},CW=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=v.useState({newPassword:"",confirmPassword:""}),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState({show:!1,message:"",variant:"success"}),f=p=>{const{name:g,value:b}=p.target;i(y=>({...y,[g]:b})),d.show&&m({show:!1,message:"",variant:"success"})},h=async p=>{if(p.preventDefault(),n.newPassword!==n.confirmPassword){m({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(n.newPassword.length<6){m({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(n),m({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),m({show:!1,message:"",variant:"success"})},1500)}catch{m({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},x=()=>{i({newPassword:"",confirmPassword:""}),m({show:!1,message:"",variant:"success"}),t()};return a.jsxs(ce,{show:e,onHide:x,size:"md",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary text-white",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Rl,{className:"me-2",size:20}),"Reset Password"]}),a.jsx(ie,{variant:"link",className:"text-white p-0",onClick:x,style:{textDecoration:"none"},children:a.jsx(nt,{size:20})})]}),a.jsxs(ce.Body,{className:"p-4",children:[d.show&&a.jsx(Re,{variant:d?.variant,className:"mb-3",children:d?.message}),a.jsxs(A,{onSubmit:h,children:[a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"fw-semibold",children:"New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(A.Control,{type:o?"text":"password",name:"newPassword",value:n.newPassword,onChange:f,required:!0,minLength:6,placeholder:"Enter new password"}),a.jsx(ie,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>l(!o),type:"button",children:o?a.jsx(Dl,{size:16}):a.jsx(Et,{size:16})})]})]}),a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Confirm New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(A.Control,{type:c?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:f,required:!0,minLength:6,placeholder:"Confirm new password"}),a.jsx(ie,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>u(!c),type:"button",children:c?a.jsx(Dl,{size:16}):a.jsx(Et,{size:16})})]})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(ie,{variant:"outline-secondary",onClick:x,disabled:s,children:"Cancel"}),a.jsx(ie,{type:"submit",variant:"secondary",disabled:s,children:s?"Updating...":a.jsxs(a.Fragment,{children:[a.jsx(Rl,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},AW=({profileData:e,user:t,onResetPassword:r,onAvatarUpdated:s,onConfigureSignature:n})=>{const i=v.useRef(null),[o,l]=v.useState(!1),[c,u]=v.useState(null),d=y=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",ACADEMIC_DEPARTMENT:"warning",SQA_AUDITOR:"secondary"})[y]||"secondary",m=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",f=()=>e?.email||t?.email||"user@example.com",h=()=>{const y=e?.role?.name||t?.role||"USER";return y==="ACADEMIC_DEPARTMENT"||y==="ACADEMIC_DEPT"?"ACADEMIC_DEPT":y},x=c||e?.avatarUrl||"",p=()=>{i.current&&i.current.click()},g=(y,j=200,S=200,E=.8)=>new Promise(w=>{const N=document.createElement("canvas"),C=N.getContext("2d"),T=new window.Image;T.onload=()=>{let{width:_,height:k}=T;_>k?_>j&&(k=k*j/_,_=j):k>S&&(_=_*S/k,k=S),N.width=_,N.height=k,C.drawImage(T,0,0,_,k);const I=N.toDataURL("image/jpeg",E);w(I)},T.src=URL.createObjectURL(y)}),b=async y=>{const j=y.target.files&&y.target.files[0];if(j){if(j.size>5*1024*1024){ne.error("File size too large. Please choose an image smaller than 5MB.");return}try{l(!0);const S=await g(j,200,200,.7);u(S);const E=await Mn.updateAvatar(S,e);ne.success("Avatar updated successfully"),s&&s(E)}catch(S){console.error("Update avatar failed:",S),S.response?.status===422?ne.error("Invalid avatar format. Please try a different image."):S.response?.status===413?ne.error("Image too large. Please choose a smaller image."):ne.error("Failed to update avatar. Please try again."),u(null)}finally{l(!1),i.current&&(i.current.value="")}}};return a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[x?a.jsx(o5,{roundedCircle:!0,src:x,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):a.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:a.jsx(Lt,{size:48,className:"text-white"})}),a.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:p,disabled:o,children:o?a.jsx(Ot,{animation:"border",size:"sm"}):""}),a.jsx("input",{ref:i,type:"file",accept:"image/*",className:"d-none",onChange:b})]}),a.jsx("h4",{className:"mb-1",children:m()}),a.jsx("p",{className:"text-muted mb-2",children:f()}),a.jsx(Ae,{bg:d(h()),className:"mb-3",children:h()}),a.jsxs("div",{className:"text-start",children:[e?.address&&a.jsxs("div",{className:"mb-3",children:[a.jsx("strong",{children:"Address:"}),a.jsx("br",{}),a.jsx("span",{className:"text-muted",children:e.address})]}),a.jsxs("div",{className:"d-flex flex-column gap-2",children:[a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[a.jsx(Rl,{size:14,className:"me-2"}),"Reset Password"]}),(()=>{const y=h();return y==="ACADEMIC_DEPT"||y==="ACADEMIC_DEPARTMENT"?null:a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[a.jsx(fn,{size:14,className:"me-2"}),"Configure Signature"]})})()]})]})]})})},kW=({profileData:e,user:t,onUpdate:r})=>{const[s,n]=v.useState(!1),[i,o]=v.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[l,c]=v.useState(!1);v.useEffect(()=>{if(e&&e.firstName){const m={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};o(m),c(!0)}},[e,l]);const u=m=>{const{name:f,value:h}=m.target;o(x=>({...x,[f]:h}))},d=async m=>{m.preventDefault(),n(!0);try{r?await r(i):(await Mn.updateProfile(i),ne.success("Personal information updated successfully!"))}catch(f){console.error("Error updating personal info:",f),r||ne.error("Failed to update personal information. Please try again.")}finally{n(!1)}};return a.jsxs(W,{children:[a.jsx(W.Header,{className:"bg-primary text-white border-0",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:20,className:"me-2 text-white"}),a.jsx("h5",{className:"mb-0 text-white",children:"Personal Information"})]})}),a.jsx(W.Body,{children:a.jsxs(A,{onSubmit:d,children:[a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"First Name"}),a.jsx(A.Control,{type:"text",name:"firstName",value:i.firstName,onChange:u,required:!0})]})}),a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Middle Name"}),a.jsx(A.Control,{type:"text",name:"middleName",value:i.middleName,onChange:u})]})}),a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Last Name"}),a.jsx(A.Control,{type:"text",name:"lastName",value:i.lastName,onChange:u,required:!0})]})})]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Email"}),a.jsx(A.Control,{type:"email",name:"email",value:i.email,onChange:u,required:!0})]})}),a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Phone Number"}),a.jsx(A.Control,{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:u})]})})]}),a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Gender"}),a.jsxs(A.Select,{name:"gender",value:i.gender,onChange:u,children:[a.jsx("option",{value:"",children:"Select Gender"}),a.jsx("option",{value:"MALE",children:"Male"}),a.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-md-12 mb-3",children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Address"}),a.jsx(A.Control,{as:"textarea",rows:3,name:"address",value:i.address,onChange:u,placeholder:"Enter your address"})]})})}),a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(ie,{type:"submit",variant:"primary",disabled:s,children:s?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(ts,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},_W=()=>{const{user:e}=fs(),t=it(),[r,s]=v.useState(!1),[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,u]=v.useState(!0),d=async()=>{try{u(!0);const x=await Mn.getProfile();l(x)}catch(x){console.error("Failed to refresh profile:",x)}finally{u(!1)}};v.useEffect(()=>{d()},[]);const m=async x=>{s(!0);try{const p=await Mn.updateProfile(x);l(p),ne.success("Personal information updated successfully!")}catch(p){throw console.error("Error updating profile:",p),ne.error("Failed to update personal information. Please try again."),p}finally{s(!1)}},f=async x=>{s(!0);try{const p=await Mn.resetPassword(x);ne.success(p.message||"Password updated successfully!")}catch(p){throw ne.error(p.message||"Failed to update password. Please check your current password."),p}finally{s(!1)}},h=()=>{e?.role,t("/trainer/configure-signature")};return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsxs(de,{children:[a.jsx(z,{lg:4,className:"mb-4",children:a.jsx(AW,{profileData:o,user:e,onResetPassword:()=>i(!0),onAvatarUpdated:d,onConfigureSignature:h})}),a.jsx(z,{lg:8,className:"mb-4",children:a.jsx(kW,{profileData:o,user:e,onUpdate:m})})]}),a.jsx(CW,{show:n,onClose:()=>i(!1),onSave:f,loading:r})]})},IW=()=>{const{user:e}=fs(),t=it(),{departments:r,loading:s,error:n}=_x(),i=r.filter(l=>l.status==="ACTIVE"),o=l=>{t(`/academic/course/${l}`)};return a.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:a.jsxs(_e,{className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"text-center",children:[a.jsx(Bs,{size:48,className:"text-primary mb-3"}),a.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),a.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),a.jsxs("p",{className:"text-muted small",children:["Total Departments: ",a.jsx("strong",{children:i.length})]})]})})}),a.jsx(de,{className:"mb-5",children:s?a.jsxs(z,{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):n?a.jsx(z,{className:"text-center py-5",children:a.jsxs("p",{className:"text-danger",children:["Error loading departments: ",n.message]})}):i.map(l=>a.jsx(z,{md:6,lg:4,className:"mb-4",children:a.jsx(W,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:a.jsxs(W.Body,{className:"p-4 d-flex flex-column h-100",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:"course-icon me-3",children:a.jsx(It,{size:24,className:"text-primary"})}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("h5",{className:"mb-1",children:l.name}),a.jsx(Ae,{bg:"secondary",className:"text-white",children:l.code})]})]}),a.jsx("div",{className:"text-muted description-container",children:l.description||a.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),a.jsxs(ie,{variant:"outline-primary",className:"w-100",onClick:()=>o(l.id),children:["View Details",a.jsx(mn,{size:16,className:"ms-2"})]})]})})},l.id))})]})})};var Zm={},Qm={},Zb;function PW(){return Zb||(Zb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Qm)),Qm}var ef={},Qb;function yT(){return Qb||(Qb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(ef)),ef}var tf={},ey;function bg(){return ey||(ey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(tf)),tf}var rf={},sf={},ty;function DW(){return ty||(ty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const s=String(r);return s==="0"&&Object.is(Number(r),-0)?"-0":s}e.toString=t})(sf)),sf}var ry;function yg(){return ry||(ry=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DW(),r=bg();function s(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],o=n.length;if(o===0)return i;let l=0,c="",u="",d=!1;for(n.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const m=n[l];u?m==="\\"&&l+1<o?(l++,c+=n[l]):m===u?u="":c+=m:d?m==='"'||m==="'"?u=m:m==="]"?(d=!1,i.push(c),c=""):c+=m:m==="["?(d=!0,c&&(i.push(c),c="")):m==="."?c&&(i.push(c),c=""):c+=m,l++}return c&&i.push(c),i}e.toPath=s})(rf)),rf}var sy;function jg(){return sy||(sy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PW(),r=yT(),s=bg(),n=yg();function i(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?i(l,n.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let m=0;m<c.length;m++){if(d==null||t.isUnsafeProperty(c[m]))return u;d=d[c[m]]}return d===void 0?u:d}e.get=i})(Zm)),Zm}var af,ay;function OW(){return ay||(ay=1,af=jg().get),af}var RW=OW();const Ri=qn(RW);var nf={exports:{}},qt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ny;function FW(){if(ny)return qt;ny=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,p=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function j(E){if(typeof E=="object"&&E!==null){var w=E.$$typeof;switch(w){case t:switch(E=E.type,E){case c:case u:case s:case i:case n:case m:return E;default:switch(E=E&&E.$$typeof,E){case l:case d:case x:case h:case o:return E;default:return w}}case r:return w}}}function S(E){return j(E)===u}return qt.AsyncMode=c,qt.ConcurrentMode=u,qt.ContextConsumer=l,qt.ContextProvider=o,qt.Element=t,qt.ForwardRef=d,qt.Fragment=s,qt.Lazy=x,qt.Memo=h,qt.Portal=r,qt.Profiler=i,qt.StrictMode=n,qt.Suspense=m,qt.isAsyncMode=function(E){return S(E)||j(E)===c},qt.isConcurrentMode=S,qt.isContextConsumer=function(E){return j(E)===l},qt.isContextProvider=function(E){return j(E)===o},qt.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},qt.isForwardRef=function(E){return j(E)===d},qt.isFragment=function(E){return j(E)===s},qt.isLazy=function(E){return j(E)===x},qt.isMemo=function(E){return j(E)===h},qt.isPortal=function(E){return j(E)===r},qt.isProfiler=function(E){return j(E)===i},qt.isStrictMode=function(E){return j(E)===n},qt.isSuspense=function(E){return j(E)===m},qt.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===s||E===u||E===i||E===n||E===m||E===f||typeof E=="object"&&E!==null&&(E.$$typeof===x||E.$$typeof===h||E.$$typeof===o||E.$$typeof===l||E.$$typeof===d||E.$$typeof===g||E.$$typeof===b||E.$$typeof===y||E.$$typeof===p)},qt.typeOf=j,qt}var iy;function LW(){return iy||(iy=1,nf.exports=FW()),nf.exports}var MW=LW(),es=e=>e===0?0:e>0?1:-1,ra=e=>typeof e=="number"&&e!=+e,mi=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,ut=e=>(typeof e=="number"||e instanceof Number)&&!ra(e),Xa=e=>ut(e)||typeof e=="string",BW=0,Ql=e=>{var t=++BW;return"".concat(e||"").concat(t)},Ss=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ut(t)&&typeof t!="string")return s;var i;if(mi(t)){if(r==null)return s;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return ra(i)&&(i=s),n&&r!=null&&i>r&&(i=r),i},jT=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},s=0;s<t;s++)if(!r[e[s]])r[e[s]]=!0;else return!0;return!1};function ds(e,t,r){return ut(e)&&ut(t)?e+r*(t-e):t}function zW(e,t,r){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):Ri(s,t))===r)}var rs=e=>e===null||typeof e>"u",Cc=e=>rs(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),$W=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function wg(e){if(typeof e!="string")return!1;var t=$W;return t.includes(e)}var UW=["viewBox","children"],oy=["points","pathLength"],of={svg:UW,polygon:oy,polyline:oy},WW=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(n=>{wg(n)&&(s[n]=(i=>r[n](r,i)))}),s},HW=(e,t,r)=>s=>(e(t,r,s),null),Ac=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(n=>{var i=e[n];wg(n)&&typeof i=="function"&&(s||(s={}),s[n]=HW(i,t,r))}),s},VW=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function wT(e){if(typeof e!="string")return!1;var t=VW;return t.includes(e)}function Jn(e){var t=Object.entries(e).filter(r=>{var[s]=r;return wT(s)});return Object.fromEntries(t)}var ly=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",cy=null,lf=null,NT=e=>{if(e===cy&&Array.isArray(lf))return lf;var t=[];return v.Children.forEach(e,r=>{rs(r)||(MW.isFragment(r)?t=t.concat(NT(r.props.children)):t.push(r))}),lf=t,cy=e,t};function Ng(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(n=>ly(n)):s=[ly(t)],NT(e).forEach(n=>{var i=Ri(n,"type.displayName")||Ri(n,"type.name");s.indexOf(i)!==-1&&r.push(n)}),r}var GW=(e,t,r,s)=>{var n;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(n=s&&of?.[s])!==null&&n!==void 0?n:[],o=t.startsWith("data-"),l=typeof e!="function"&&(!!s&&i.includes(t)||wT(t)),c=!!r&&wg(t);return o||l||c},Hr=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(v.isValidElement(e)&&(s=e.props),typeof s!="object"&&typeof s!="function")return null;var n={};return Object.keys(s).forEach(i=>{var o;GW((o=s)===null||o===void 0?void 0:o[i],i,t,r)&&(n[i]=s[i])}),n},qW=["children","width","height","viewBox","className","style","title","desc"];function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sp.apply(null,arguments)}function KW(e,t){if(e==null)return{};var r,s,n=YW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YW(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Sg=v.forwardRef((e,t)=>{var{children:r,width:s,height:n,viewBox:i,className:o,style:l,title:c,desc:u}=e,d=KW(e,qW),m=i||{width:s,height:n,x:0,y:0},f=Pt("recharts-surface",o);return v.createElement("svg",Sp({},Hr(d,!0,"svg"),{className:f,width:s,height:n,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,c),v.createElement("desc",null,u),r)}),XW=["children","className"];function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ep.apply(null,arguments)}function JW(e,t){if(e==null)return{};var r,s,n=ZW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZW(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Hs=v.forwardRef((e,t)=>{var{children:r,className:s}=e,n=JW(e,XW),i=Pt("recharts-layer",s);return v.createElement("g",Ep({className:i},Hr(n,!0),{ref:t}),r)}),ST=v.createContext(null),QW=()=>v.useContext(ST);function ar(e){return function(){return e}}const ET=Math.cos,Yd=Math.sin,Ba=Math.sqrt,Xd=Math.PI,Zu=2*Xd,Tp=Math.PI,Cp=2*Tp,ii=1e-6,eH=Cp-ii;function TT(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function tH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return TT;const r=10**t;return function(s){this._+=s[0];for(let n=1,i=s.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}class rH{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?TT:tH(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,n){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+n}`}bezierCurveTo(t,r,s,n,i,o){this._append`C${+t},${+r},${+s},${+n},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,s,n,i){if(t=+t,r=+r,s=+s,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=s-t,u=n-r,d=o-t,m=l-r,f=d*d+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>ii)if(!(Math.abs(m*c-u*d)>ii)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=s-o,x=n-l,p=c*c+u*u,g=h*h+x*x,b=Math.sqrt(p),y=Math.sqrt(f),j=i*Math.tan((Tp-Math.acos((p+f-g)/(2*b*y)))/2),S=j/y,E=j/b;Math.abs(S-1)>ii&&this._append`L${t+S*d},${r+S*m}`,this._append`A${i},${i},0,0,${+(m*h>d*x)},${this._x1=t+E*c},${this._y1=r+E*u}`}}arc(t,r,s,n,i,o){if(t=+t,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(n),c=s*Math.sin(n),u=t+l,d=r+c,m=1^o,f=o?n-i:i-n;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>ii||Math.abs(this._y1-d)>ii)&&this._append`L${u},${d}`,s&&(f<0&&(f=f%Cp+Cp),f>eH?this._append`A${s},${s},0,1,${m},${t-l},${r-c}A${s},${s},0,1,${m},${this._x1=u},${this._y1=d}`:f>ii&&this._append`A${s},${s},0,${+(f>=Tp)},${m},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+n}h${-s}Z`}toString(){return this._}}function Eg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new rH(t)}function Tg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CT(e){this._context=e}CT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Qu(e){return new CT(e)}function AT(e){return e[0]}function kT(e){return e[1]}function _T(e,t){var r=ar(!0),s=null,n=Qu,i=null,o=Eg(l);e=typeof e=="function"?e:e===void 0?AT:ar(e),t=typeof t=="function"?t:t===void 0?kT:ar(t);function l(c){var u,d=(c=Tg(c)).length,m,f=!1,h;for(s==null&&(i=n(h=o())),u=0;u<=d;++u)!(u<d&&r(m=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(m,u,c),+t(m,u,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:ar(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:ar(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:ar(!!c),l):r},l.curve=function(c){return arguments.length?(n=c,s!=null&&(i=n(s)),l):n},l.context=function(c){return arguments.length?(c==null?s=i=null:i=n(s=c),l):s},l}function od(e,t,r){var s=null,n=ar(!0),i=null,o=Qu,l=null,c=Eg(u);e=typeof e=="function"?e:e===void 0?AT:ar(+e),t=typeof t=="function"?t:ar(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?kT:ar(+r);function u(m){var f,h,x,p=(m=Tg(m)).length,g,b=!1,y,j=new Array(p),S=new Array(p);for(i==null&&(l=o(y=c())),f=0;f<=p;++f){if(!(f<p&&n(g=m[f],f,m))===b)if(b=!b)h=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=f-1;x>=h;--x)l.point(j[x],S[x]);l.lineEnd(),l.areaEnd()}b&&(j[f]=+e(g,f,m),S[f]=+t(g,f,m),l.point(s?+s(g,f,m):j[f],r?+r(g,f,m):S[f]))}if(y)return l=null,y+""||null}function d(){return _T().defined(n).curve(o).context(i)}return u.x=function(m){return arguments.length?(e=typeof m=="function"?m:ar(+m),s=null,u):e},u.x0=function(m){return arguments.length?(e=typeof m=="function"?m:ar(+m),u):e},u.x1=function(m){return arguments.length?(s=m==null?null:typeof m=="function"?m:ar(+m),u):s},u.y=function(m){return arguments.length?(t=typeof m=="function"?m:ar(+m),r=null,u):t},u.y0=function(m){return arguments.length?(t=typeof m=="function"?m:ar(+m),u):t},u.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:ar(+m),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(s).y(t)},u.defined=function(m){return arguments.length?(n=typeof m=="function"?m:ar(!!m),u):n},u.curve=function(m){return arguments.length?(o=m,i!=null&&(l=o(i)),u):o},u.context=function(m){return arguments.length?(m==null?i=l=null:l=o(i=m),u):i},u}class IT{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function sH(e){return new IT(e,!0)}function aH(e){return new IT(e,!1)}const Cg={draw(e,t){const r=Ba(t/Xd);e.moveTo(r,0),e.arc(0,0,r,0,Zu)}},nH={draw(e,t){const r=Ba(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},PT=Ba(1/3),iH=PT*2,oH={draw(e,t){const r=Ba(t/iH),s=r*PT;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},lH={draw(e,t){const r=Ba(t),s=-r/2;e.rect(s,s,r,r)}},cH=.8908130915292852,DT=Yd(Xd/10)/Yd(7*Xd/10),dH=Yd(Zu/10)*DT,uH=-ET(Zu/10)*DT,mH={draw(e,t){const r=Ba(t*cH),s=dH*r,n=uH*r;e.moveTo(0,-r),e.lineTo(s,n);for(let i=1;i<5;++i){const o=Zu*i/5,l=ET(o),c=Yd(o);e.lineTo(c*r,-l*r),e.lineTo(l*s-c*n,c*s+l*n)}e.closePath()}},cf=Ba(3),fH={draw(e,t){const r=-Ba(t/(cf*3));e.moveTo(0,r*2),e.lineTo(-cf*r,-r),e.lineTo(cf*r,-r),e.closePath()}},oa=-.5,la=Ba(3)/2,Ap=1/Ba(12),hH=(Ap/2+1)*3,pH={draw(e,t){const r=Ba(t/hH),s=r/2,n=r*Ap,i=s,o=r*Ap+r,l=-i,c=o;e.moveTo(s,n),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(oa*s-la*n,la*s+oa*n),e.lineTo(oa*i-la*o,la*i+oa*o),e.lineTo(oa*l-la*c,la*l+oa*c),e.lineTo(oa*s+la*n,oa*n-la*s),e.lineTo(oa*i+la*o,oa*o-la*i),e.lineTo(oa*l+la*c,oa*c-la*l),e.closePath()}};function xH(e,t){let r=null,s=Eg(n);e=typeof e=="function"?e:ar(e||Cg),t=typeof t=="function"?t:ar(t===void 0?64:+t);function n(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:ar(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:ar(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function Jd(){}function Zd(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function OT(e){this._context=e}OT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Zd(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Zd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gH(e){return new OT(e)}function RT(e){this._context=e}RT.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Zd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vH(e){return new RT(e)}function FT(e){this._context=e}FT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Zd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function bH(e){return new FT(e)}function LT(e){this._context=e}LT.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function yH(e){return new LT(e)}function dy(e){return e<0?-1:1}function uy(e,t,r){var s=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(s||n<0&&-0),o=(r-e._y1)/(n||s<0&&-0),l=(i*n+o*s)/(s+n);return(dy(i)+dy(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function my(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function df(e,t,r){var s=e._x0,n=e._y0,i=e._x1,o=e._y1,l=(i-s)/3;e._context.bezierCurveTo(s+l,n+l*t,i-l,o-l*r,i,o)}function Qd(e){this._context=e}Qd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:df(this,this._t0,my(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,df(this,my(this,r=uy(this,e,t)),r);break;default:df(this,this._t0,r=uy(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function MT(e){this._context=new BT(e)}(MT.prototype=Object.create(Qd.prototype)).point=function(e,t){Qd.prototype.point.call(this,t,e)};function BT(e){this._context=e}BT.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,n,i){this._context.bezierCurveTo(t,e,s,r,i,n)}};function jH(e){return new Qd(e)}function wH(e){return new MT(e)}function zT(e){this._context=e}zT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=fy(e),n=fy(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],n[0][i],s[1][i],n[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function fy(e){var t,r=e.length-1,s,n=new Array(r),i=new Array(r),o=new Array(r);for(n[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=n[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(n[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(o[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function NH(e){return new zT(e)}function em(e,t){this._context=e,this._t=t}em.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function SH(e){return new em(e,.5)}function EH(e){return new em(e,0)}function TH(e){return new em(e,1)}function Co(e,t){if((o=e.length)>1)for(var r=1,s,n,i=e[t[0]],o,l=i.length;r<o;++r)for(n=i,i=e[t[r]],s=0;s<l;++s)i[s][1]+=i[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}function kp(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function CH(e,t){return e[t]}function AH(e){const t=[];return t.key=e,t}function kH(){var e=ar([]),t=kp,r=Co,s=CH;function n(i){var o=Array.from(e.apply(this,arguments),AH),l,c=o.length,u=-1,d;for(const m of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+s(m,o[l].key,u,i)]).data=m;for(l=0,d=Tg(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:ar(Array.from(i)),n):e},n.value=function(i){return arguments.length?(s=typeof i=="function"?i:ar(+i),n):s},n.order=function(i){return arguments.length?(t=i==null?kp:typeof i=="function"?i:ar(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??Co,n):r},n}function _H(e,t){if((s=e.length)>0){for(var r,s,n=0,i=e[0].length,o;n<i;++n){for(o=r=0;r<s;++r)o+=e[r][n][1]||0;if(o)for(r=0;r<s;++r)e[r][n][1]/=o}Co(e,t)}}function IH(e,t){if((n=e.length)>0){for(var r=0,s=e[t[0]],n,i=s.length;r<i;++r){for(var o=0,l=0;o<n;++o)l+=e[o][r][1]||0;s[r][1]+=s[r][0]=-l/2}Co(e,t)}}function PH(e,t){if(!(!((o=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,s=1,n,i,o;s<i;++s){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],m=d[s][1]||0,f=d[s-1][1]||0,h=(m-f)/2,x=0;x<l;++x){var p=e[t[x]],g=p[s][1]||0,b=p[s-1][1]||0;h+=g-b}c+=m,u+=h*m}n[s-1][1]+=n[s-1][0]=r,c&&(r-=u/c)}n[s-1][1]+=n[s-1][0]=r,Co(e,t)}}var DH=["type","size","sizeType"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_p.apply(null,arguments)}function hy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function py(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hy(Object(r),!0).forEach(function(s){OH(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hy(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function OH(e,t,r){return(t=RH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RH(e){var t=FH(e,"string");return typeof t=="symbol"?t:t+""}function FH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LH(e,t){if(e==null)return{};var r,s,n=MH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MH(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var $T={symbolCircle:Cg,symbolCross:nH,symbolDiamond:oH,symbolSquare:lH,symbolStar:mH,symbolTriangle:fH,symbolWye:pH},BH=Math.PI/180,zH=e=>{var t="symbol".concat(Cc(e));return $T[t]||Cg},$H=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*BH;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},UH=(e,t)=>{$T["symbol".concat(Cc(e))]=t},Ag=e=>{var{type:t="circle",size:r=64,sizeType:s="area"}=e,n=LH(e,DH),i=py(py({},n),{},{type:t,size:r,sizeType:s}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var f=zH(o),h=xH().type(f).size($H(r,s,o));return h()},{className:c,cx:u,cy:d}=i,m=Hr(i,!0);return u===+u&&d===+d&&r===+r?v.createElement("path",_p({},m,{className:Pt("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};Ag.registerSymbol=UH;function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ip.apply(null,arguments)}function xy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function WH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xy(Object(r),!0).forEach(function(s){kg(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xy(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kg(e,t,r){return(t=HH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HH(e){var t=VH(e,"string");return typeof t=="symbol"?t:t+""}function VH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ca=32;class _g extends v.PureComponent{renderIcon(t,r){var{inactiveColor:s}=this.props,n=ca/2,i=ca/6,o=ca/3,l=t.inactive?s:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:n,x2:ca,y2:n,className:"recharts-legend-icon"});if(c==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(n,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(n,`
            H`).concat(ca,"M").concat(2*o,",").concat(n,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(n),className:"recharts-legend-icon"});if(c==="rect")return v.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ca/8,"h").concat(ca,"v").concat(ca*3/4,"h").concat(-ca,"z"),className:"recharts-legend-icon"});if(v.isValidElement(t.legendIcon)){var u=WH({},t);return delete u.legendIcon,v.cloneElement(t.legendIcon,u)}return v.createElement(Ag,{fill:l,cx:n,cy:n,size:ca,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:s,formatter:n,inactiveColor:i,iconType:o}=this.props,l={x:0,y:0,width:ca,height:ca},c={display:s==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,m)=>{var f=d.formatter||n,h=Pt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?i:d.color,p=f?f(d.value,d,m):d.value;return v.createElement("li",Ip({className:h,style:c,key:"legend-item-".concat(m)},Ac(this.props,d,m)),v.createElement(Sg,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},this.renderIcon(d,o)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},p))})}render(){var{payload:t,layout:r,align:s}=this.props;if(!t||!t.length)return null;var n={padding:0,margin:0,textAlign:r==="horizontal"?s:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:n},this.renderItems())}}kg(_g,"displayName","Legend");kg(_g,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var uf={},mf={},gy;function GH(){return gy||(gy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){const n=new Map;for(let i=0;i<r.length;i++){const o=r[i],l=s(o);n.has(l)||n.set(l,o)}return Array.from(n.values())}e.uniqBy=t})(mf)),mf}var ff={},vy;function UT(){return vy||(vy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(ff)),ff}var hf={},pf={},xf={},by;function qH(){return by||(by=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(xf)),xf}var yy;function Ig(){return yy||(yy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qH();function r(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=r})(pf)),pf}var gf={},jy;function KH(){return jy||(jy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(gf)),gf}var wy;function YH(){return wy||(wy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ig(),r=KH();function s(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=s})(hf)),hf}var vf={},bf={},Ny;function XH(){return Ny||(Ny=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jg();function r(s){return function(n){return t.get(n,s)}}e.property=r})(bf)),bf}var yf={},jf={},wf={},Nf={},Sy;function WT(){return Sy||(Sy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Nf)),Nf}var Sf={},Ey;function HT(){return Ey||(Ey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Sf)),Sf}var Ef={},Ty;function VT(){return Ty||(Ty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){return r===s||Number.isNaN(r)&&Number.isNaN(s)}e.eq=t})(Ef)),Ef}var Cy;function JH(){return Cy||(Cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pg(),r=WT(),s=HT(),n=VT();function i(m,f,h){return typeof h!="function"?t.isMatch(m,f):o(m,f,function x(p,g,b,y,j,S){const E=h(p,g,b,y,j,S);return E!==void 0?!!E:o(p,g,x,S)},new Map)}function o(m,f,h,x){if(f===m)return!0;switch(typeof f){case"object":return l(m,f,h,x);case"function":return Object.keys(f).length>0?o(m,{...f},h,x):n.eq(m,f);default:return r.isObject(m)?typeof f=="string"?f==="":!0:n.eq(m,f)}}function l(m,f,h,x){if(f==null)return!0;if(Array.isArray(f))return u(m,f,h,x);if(f instanceof Map)return c(m,f,h,x);if(f instanceof Set)return d(m,f,h,x);const p=Object.keys(f);if(m==null)return p.length===0;if(p.length===0)return!0;if(x&&x.has(f))return x.get(f)===m;x&&x.set(f,m);try{for(let g=0;g<p.length;g++){const b=p[g];if(!s.isPrimitive(m)&&!(b in m)||f[b]===void 0&&m[b]!==void 0||f[b]===null&&m[b]!==null||!h(m[b],f[b],b,m,f,x))return!1}return!0}finally{x&&x.delete(f)}}function c(m,f,h,x){if(f.size===0)return!0;if(!(m instanceof Map))return!1;for(const[p,g]of f.entries()){const b=m.get(p);if(h(b,g,p,m,f,x)===!1)return!1}return!0}function u(m,f,h,x){if(f.length===0)return!0;if(!Array.isArray(m))return!1;const p=new Set;for(let g=0;g<f.length;g++){const b=f[g];let y=!1;for(let j=0;j<m.length;j++){if(p.has(j))continue;const S=m[j];let E=!1;if(h(S,b,g,m,f,x)&&(E=!0),E){p.add(j),y=!0;break}}if(!y)return!1}return!0}function d(m,f,h,x){return f.size===0?!0:m instanceof Set?u([...m],[...f],h,x):!1}e.isMatchWith=i,e.isSetMatch=d})(wf)),wf}var Ay;function Pg(){return Ay||(Ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JH();function r(s,n){return t.isMatchWith(s,n,()=>{})}e.isMatch=r})(jf)),jf}var Tf={},Cf={},Af={},ky;function ZH(){return ky||(ky=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(s=>Object.prototype.propertyIsEnumerable.call(r,s))}e.getSymbols=t})(Af)),Af}var kf={},_y;function GT(){return _y||(_y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(kf)),kf}var _f={},Iy;function qT(){return Iy||(Iy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",s="[object Number]",n="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",m="[object Function]",f="[object ArrayBuffer]",h="[object Object]",x="[object Error]",p="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",y="[object Uint16Array]",j="[object Uint32Array]",S="[object BigUint64Array]",E="[object Int8Array]",w="[object Int16Array]",N="[object Int32Array]",C="[object BigInt64Array]",T="[object Float32Array]",_="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=d,e.bigInt64ArrayTag=C,e.bigUint64ArrayTag=S,e.booleanTag=n,e.dataViewTag=p,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=T,e.float64ArrayTag=_,e.functionTag=m,e.int16ArrayTag=w,e.int32ArrayTag=N,e.int8ArrayTag=E,e.mapTag=c,e.numberTag=s,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=y,e.uint32ArrayTag=j,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(_f)),_f}var If={},Py;function QH(){return Py||(Py=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(If)),If}var Dy;function KT(){return Dy||(Dy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZH(),r=GT(),s=qT(),n=HT(),i=QH();function o(d,m){return l(d,void 0,d,new Map,m)}function l(d,m,f,h=new Map,x=void 0){const p=x?.(d,m,f,h);if(p!==void 0)return p;if(n.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const g=new Array(d.length);h.set(d,g);for(let b=0;b<d.length;b++)g[b]=l(d[b],b,f,h,x);return Object.hasOwn(d,"index")&&(g.index=d.index),Object.hasOwn(d,"input")&&(g.input=d.input),g}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const g=new RegExp(d.source,d.flags);return g.lastIndex=d.lastIndex,g}if(d instanceof Map){const g=new Map;h.set(d,g);for(const[b,y]of d)g.set(b,l(y,b,f,h,x));return g}if(d instanceof Set){const g=new Set;h.set(d,g);for(const b of d)g.add(l(b,void 0,f,h,x));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const g=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,g);for(let b=0;b<d.length;b++)g[b]=l(d[b],b,f,h,x);return g}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const g=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,g),c(g,d,f,h,x),g}if(typeof File<"u"&&d instanceof File){const g=new File([d],d.name,{type:d.type});return h.set(d,g),c(g,d,f,h,x),g}if(typeof Blob<"u"&&d instanceof Blob){const g=new Blob([d],{type:d.type});return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof Error){const g=new d.constructor;return h.set(d,g),g.message=d.message,g.name=d.name,g.stack=d.stack,g.cause=d.cause,c(g,d,f,h,x),g}if(d instanceof Boolean){const g=new Boolean(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof Number){const g=new Number(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(d instanceof String){const g=new String(d.valueOf());return h.set(d,g),c(g,d,f,h,x),g}if(typeof d=="object"&&u(d)){const g=Object.create(Object.getPrototypeOf(d));return h.set(d,g),c(g,d,f,h,x),g}return d}function c(d,m,f=d,h,x){const p=[...Object.keys(m),...t.getSymbols(m)];for(let g=0;g<p.length;g++){const b=p[g],y=Object.getOwnPropertyDescriptor(d,b);(y==null||y.writable)&&(d[b]=l(m[b],b,f,h,x))}}function u(d){switch(r.getTag(d)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(Cf)),Cf}var Oy;function eV(){return Oy||(Oy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KT();function r(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=r})(Tf)),Tf}var Ry;function tV(){return Ry||(Ry=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pg(),r=eV();function s(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=s})(yf)),yf}var Pf={},Df={},Of={},Fy;function rV(){return Fy||(Fy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KT(),r=qT();function s(n,i){return t.cloneDeepWith(n,(o,l,c,u)=>{const d=i?.(o,l,c,u);if(d!==void 0)return d;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new n.constructor(n?.valueOf());return t.copyProperties(m,n),m}case r.argumentsTag:{const m={};return t.copyProperties(m,n),m.length=n.length,m[Symbol.iterator]=n[Symbol.iterator],m}default:return}})}e.cloneDeepWith=s})(Of)),Of}var Ly;function sV(){return Ly||(Ly=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rV();function r(s){return t.cloneDeepWith(s)}e.cloneDeep=r})(Df)),Df}var Rf={},Ff={},My;function YT(){return My||(My=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(s,n=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<n;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=r})(Ff)),Ff}var Lf={},By;function aV(){return By||(By=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GT();function r(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=r})(Lf)),Lf}var zy;function nV(){return zy||(zy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yT(),r=YT(),s=aV(),n=yg();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=n.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const m=c[d];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||s.isArguments(u))&&r.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}e.has=i})(Rf)),Rf}var $y;function iV(){return $y||($y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pg(),r=bg(),s=sV(),n=jg(),i=nV();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=s.cloneDeep(c),function(u){const d=n.get(u,l);return d===void 0?i.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(Pf)),Pf}var Uy;function oV(){return Uy||(Uy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UT(),r=XH(),s=tV(),n=iV();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?n.matchesProperty(o[0],o[1]):s.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i})(vf)),vf}var Wy;function lV(){return Wy||(Wy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GH(),r=UT(),s=YH(),n=oV();function i(o,l=r.identity){return s.isArrayLikeObject(o)?t.uniqBy(Array.from(o),n.iteratee(l)):[]}e.uniqBy=i})(uf)),uf}var Mf,Hy;function cV(){return Hy||(Hy=1,Mf=lV().uniqBy),Mf}var dV=cV();const Vy=qn(dV);function XT(e,t,r){return t===!0?Vy(e,r):typeof t=="function"?Vy(e,t):e}var Bf={exports:{}},zf={},$f={exports:{}},Uf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function uV(){if(Gy)return Uf;Gy=1;var e=bx();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,s=e.useState,n=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(m,f){var h=f(),x=s({inst:{value:h,getSnapshot:f}}),p=x[0].inst,g=x[1];return i(function(){p.value=h,p.getSnapshot=f,c(p)&&g({inst:p})},[m,h,f]),n(function(){return c(p)&&g({inst:p}),m(function(){c(p)&&g({inst:p})})},[m]),o(h),h}function c(m){var f=m.getSnapshot;m=m.value;try{var h=f();return!r(m,h)}catch{return!0}}function u(m,f){return f()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return Uf.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,Uf}var qy;function mV(){return qy||(qy=1,$f.exports=uV()),$f.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ky;function fV(){if(Ky)return zf;Ky=1;var e=bx(),t=mV();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var s=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return zf.useSyncExternalStoreWithSelector=function(u,d,m,f,h){var x=i(null);if(x.current===null){var p={hasValue:!1,value:null};x.current=p}else p=x.current;x=l(function(){function b(w){if(!y){if(y=!0,j=w,w=f(w),h!==void 0&&p.hasValue){var N=p.value;if(h(N,w))return S=N}return S=w}if(N=S,s(j,w))return N;var C=f(w);return h!==void 0&&h(N,C)?(j=w,N):(j=w,S=C)}var y=!1,j,S,E=m===void 0?null:m;return[function(){return b(d())},E===null?void 0:function(){return b(E())}]},[d,m,f,h]);var g=n(u,x[0],x[1]);return o(function(){p.hasValue=!0,p.value=g},[g]),c(g),g},zf}var Yy;function hV(){return Yy||(Yy=1,Bf.exports=fV()),Bf.exports}var pV=hV(),Dg=v.createContext(null),xV=e=>e,Sr=()=>{var e=v.useContext(Dg);return e?e.store.dispatch:xV},kd=()=>{},gV=()=>kd,vV=(e,t)=>e===t;function lt(e){var t=v.useContext(Dg);return pV.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:gV,t?t.store.getState:kd,t?t.store.getState:kd,t?e:kd,vV)}function bV(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function yV(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function jV(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${r}]`)}}var Xy=e=>Array.isArray(e)?e:[e];function wV(e){const t=Array.isArray(e[0])?e[0]:e;return jV(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function NV(e,t){const r=[],{length:s}=e;for(let n=0;n<s;n++)r.push(e[n].apply(null,t));return r}var SV=class{constructor(e){this.value=e}deref(){return this.value}},EV=typeof WeakRef<"u"?WeakRef:SV,TV=0,Jy=1;function ld(){return{s:TV,v:void 0,o:null,p:null}}function JT(e,t={}){let r=ld();const{resultEqualityCheck:s}=t;let n,i=0;function o(){let l=r;const{length:c}=arguments;for(let m=0,f=c;m<f;m++){const h=arguments[m];if(typeof h=="function"||typeof h=="object"&&h!==null){let x=l.o;x===null&&(l.o=x=new WeakMap);const p=x.get(h);p===void 0?(l=ld(),x.set(h,l)):l=p}else{let x=l.p;x===null&&(l.p=x=new Map);const p=x.get(h);p===void 0?(l=ld(),x.set(h,l)):l=p}}const u=l;let d;if(l.s===Jy)d=l.v;else if(d=e.apply(null,arguments),i++,s){const m=n?.deref?.()??n;m!=null&&s(m,d)&&(d=m,i!==0&&i--),n=typeof d=="object"&&d!==null||typeof d=="function"?new EV(d):d}return u.s=Jy,u.v=d,d}return o.clearCache=()=>{r=ld(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function CV(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...n)=>{let i=0,o=0,l,c={},u=n.pop();typeof u=="object"&&(c=u,u=n.pop()),bV(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:m,memoizeOptions:f=[],argsMemoize:h=JT,argsMemoizeOptions:x=[]}=d,p=Xy(f),g=Xy(x),b=wV(n),y=m(function(){return i++,u.apply(null,arguments)},...p),j=h(function(){o++;const E=NV(b,arguments);return l=y.apply(null,E),l},...g);return Object.assign(j,{resultFunc:u,memoizedResultFunc:y,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:h})};return Object.assign(s,{withTypes:()=>s}),s}var je=CV(JT),AV=Object.assign((e,t=je)=>{yV(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),s=r.map(i=>e[i]);return t(s,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>AV}),Wf={},Hf={},Vf={},Zy;function kV(){return Zy||(Zy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const r=(s,n,i)=>{if(s!==n){const o=t(s),l=t(n);if(o===l&&o===0){if(s<n)return i==="desc"?1:-1;if(s>n)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=r})(Vf)),Vf}var Gf={},qf={},Qy;function ZT(){return Qy||(Qy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(qf)),qf}var ej;function _V(){return ej||(ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZT(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function n(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=n})(Gf)),Gf}var tj;function IV(){return tj||(tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kV(),r=_V(),s=yg();function n(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,x)=>{let p=h;for(let g=0;g<x.length&&p!=null;++g)p=p[x[g]];return p},d=(h,x)=>x==null||h==null?x:typeof h=="object"&&"key"in h?Object.hasOwn(x,h.key)?x[h.key]:u(x,h.path):typeof h=="function"?h(x):Array.isArray(h)?u(x,h):typeof x=="object"?x[h]:x,m=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:s.toPath(h)}));return i.map(h=>({original:h,criteria:m.map(x=>d(x,h))})).slice().sort((h,x)=>{for(let p=0;p<m.length;p++){const g=t.compareValues(h.criteria[p],x.criteria[p],l[p]);if(g!==0)return g}return 0}).map(h=>h.original)}e.orderBy=n})(Hf)),Hf}var Kf={},rj;function PV(){return rj||(rj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s=1){const n=[],i=Math.floor(s),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<i?o(d,c+1):n.push(d)}};return o(r,0),n}e.flatten=t})(Kf)),Kf}var Yf={},sj;function QT(){return sj||(sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YT(),r=Ig(),s=WT(),n=VT();function i(o,l,c){return s.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?n.eq(c[l],o):!1}e.isIterateeCall=i})(Yf)),Yf}var aj;function DV(){return aj||(aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IV(),r=PV(),s=QT();function n(i,...o){const l=o.length;return l>1&&s.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&s.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=n})(Wf)),Wf}var Xf,nj;function OV(){return nj||(nj=1,Xf=DV().sortBy),Xf}var RV=OV();const tm=qn(RV);var eC=e=>e.legend.settings,FV=e=>e.legend.size,LV=e=>e.legend.payload,MV=je([LV,eC],(e,t)=>{var{itemSorter:r}=t,s=e.flat(1);return r?tm(s,r):s});function BV(){return lt(MV)}var cd=1;function tC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),s=v.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>cd||Math.abs(o.left-t.left)>cd||Math.abs(o.top-t.top)>cd||Math.abs(o.width-t.width)>cd)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function is(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var zV=typeof Symbol=="function"&&Symbol.observable||"@@observable",ij=zV,Jf=()=>Math.random().toString(36).substring(7).split("").join("."),$V={INIT:`@@redux/INIT${Jf()}`,REPLACE:`@@redux/REPLACE${Jf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Jf()}`},eu=$V;function Og(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function rC(e,t,r){if(typeof e!="function")throw new Error(is(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(is(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(is(1));return r(rC)(e,t)}let s=e,n=t,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((g,b)=>{o.set(b,g)}))}function d(){if(c)throw new Error(is(3));return n}function m(g){if(typeof g!="function")throw new Error(is(4));if(c)throw new Error(is(5));let b=!0;u();const y=l++;return o.set(y,g),function(){if(b){if(c)throw new Error(is(6));b=!1,u(),o.delete(y),i=null}}}function f(g){if(!Og(g))throw new Error(is(7));if(typeof g.type>"u")throw new Error(is(8));if(typeof g.type!="string")throw new Error(is(17));if(c)throw new Error(is(9));try{c=!0,n=s(n,g)}finally{c=!1}return(i=o).forEach(y=>{y()}),g}function h(g){if(typeof g!="function")throw new Error(is(10));s=g,f({type:eu.REPLACE})}function x(){const g=m;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(is(11));function y(){const S=b;S.next&&S.next(d())}return y(),{unsubscribe:g(y)}},[ij](){return this}}}return f({type:eu.INIT}),{dispatch:f,subscribe:m,getState:d,replaceReducer:h,[ij]:x}}function UV(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:eu.INIT})>"u")throw new Error(is(12));if(typeof r(void 0,{type:eu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(is(13))})}function sC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const s=Object.keys(r);let n;try{UV(r)}catch(i){n=i}return function(o={},l){if(n)throw n;let c=!1;const u={};for(let d=0;d<s.length;d++){const m=s[d],f=r[m],h=o[m],x=f(h,l);if(typeof x>"u")throw l&&l.type,new Error(is(14));u[m]=x,c=c||x!==h}return c=c||s.length!==Object.keys(o).length,c?u:o}}function tu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...s)=>t(r(...s)))}function WV(...e){return t=>(r,s)=>{const n=t(r,s);let i=()=>{throw new Error(is(15))};const o={getState:n.getState,dispatch:(c,...u)=>i(c,...u)},l=e.map(c=>c(o));return i=tu(...l)(n.dispatch),{...n,dispatch:i}}}function aC(e){return Og(e)&&"type"in e&&typeof e.type=="string"}var nC=Symbol.for("immer-nothing"),oj=Symbol.for("immer-draftable"),sa=Symbol.for("immer-state");function Ia(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ao=Object.getPrototypeOf;function Fi(e){return!!e&&!!e[sa]}function xn(e){return e?iC(e)||Array.isArray(e)||!!e[oj]||!!e.constructor?.[oj]||kc(e)||sm(e):!1}var HV=Object.prototype.constructor.toString();function iC(e){if(!e||typeof e!="object")return!1;const t=Ao(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===HV}function ru(e,t){rm(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,s)=>t(s,r,e))}function rm(e){const t=e[sa];return t?t.type_:Array.isArray(e)?1:kc(e)?2:sm(e)?3:0}function Pp(e,t){return rm(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function oC(e,t,r){const s=rm(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function VV(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function kc(e){return e instanceof Map}function sm(e){return e instanceof Set}function oi(e){return e.copy_||e.base_}function Dp(e,t){if(kc(e))return new Map(e);if(sm(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=iC(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[sa];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const o=n[i],l=s[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(Ao(e),s)}else{const s=Ao(e);if(s!==null&&r)return{...e};const n=Object.create(s);return Object.assign(n,e)}}function Rg(e,t=!1){return am(e)||Fi(e)||!xn(e)||(rm(e)>1&&Object.defineProperties(e,{set:{value:dd},add:{value:dd},clear:{value:dd},delete:{value:dd}}),Object.freeze(e),t&&Object.values(e).forEach(r=>Rg(r,!0))),e}function dd(){Ia(2)}function am(e){return Object.isFrozen(e)}var GV={};function Li(e){const t=GV[e];return t||Ia(0,e),t}var ec;function lC(){return ec}function qV(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function lj(e,t){t&&(Li("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Op(e){Rp(e),e.drafts_.forEach(KV),e.drafts_=null}function Rp(e){e===ec&&(ec=e.parent_)}function cj(e){return ec=qV(ec,e)}function KV(e){const t=e[sa];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function dj(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[sa].modified_&&(Op(t),Ia(4)),xn(e)&&(e=su(t,e),t.parent_||au(t,e)),t.patches_&&Li("Patches").generateReplacementPatches_(r[sa].base_,e,t.patches_,t.inversePatches_)):e=su(t,r,[]),Op(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==nC?e:void 0}function su(e,t,r){if(am(t))return t;const s=t[sa];if(!s)return ru(t,(n,i)=>uj(e,s,t,n,i,r)),t;if(s.scope_!==e)return t;if(!s.modified_)return au(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,o=!1;s.type_===3&&(i=new Set(n),n.clear(),o=!0),ru(i,(l,c)=>uj(e,s,n,l,c,r,o)),au(e,n,!1),r&&e.patches_&&Li("Patches").generatePatches_(s,r,e.patches_,e.inversePatches_)}return s.copy_}function uj(e,t,r,s,n,i,o){if(Fi(n)){const l=i&&t&&t.type_!==3&&!Pp(t.assigned_,s)?i.concat(s):void 0,c=su(e,n,l);if(oC(r,s,c),Fi(c))e.canAutoFreeze_=!1;else return}else o&&r.add(n);if(xn(n)&&!am(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;su(e,n),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(kc(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&au(e,n)}}function au(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Rg(t,r)}function YV(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:lC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=Fg;r&&(n=[s],i=tc);const{revoke:o,proxy:l}=Proxy.revocable(n,i);return s.draft_=l,s.revoke_=o,l}var Fg={get(e,t){if(t===sa)return e;const r=oi(e);if(!Pp(r,t))return XV(e,r,t);const s=r[t];return e.finalized_||!xn(s)?s:s===Zf(e.base_,t)?(Qf(e),e.copy_[t]=Lp(s,e)):s},has(e,t){return t in oi(e)},ownKeys(e){return Reflect.ownKeys(oi(e))},set(e,t,r){const s=cC(oi(e),t);if(s?.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=Zf(oi(e),t),i=n?.[sa];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(VV(r,n)&&(r!==void 0||Pp(e.base_,t)))return!0;Qf(e),Fp(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Zf(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Qf(e),Fp(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=oi(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){Ia(11)},getPrototypeOf(e){return Ao(e.base_)},setPrototypeOf(){Ia(12)}},tc={};ru(Fg,(e,t)=>{tc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});tc.deleteProperty=function(e,t){return tc.set.call(this,e,t,void 0)};tc.set=function(e,t,r){return Fg.set.call(this,e[0],t,r,e[0])};function Zf(e,t){const r=e[sa];return(r?oi(r):e)[t]}function XV(e,t,r){const s=cC(t,r);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}function cC(e,t){if(!(t in e))return;let r=Ao(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=Ao(r)}}function Fp(e){e.modified_||(e.modified_=!0,e.parent_&&Fp(e.parent_))}function Qf(e){e.copy_||(e.copy_=Dp(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var JV=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Ia(6),s!==void 0&&typeof s!="function"&&Ia(7);let n;if(xn(t)){const i=cj(this),o=Lp(t,void 0);let l=!0;try{n=r(o),l=!1}finally{l?Op(i):Rp(i)}return lj(i,s),dj(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===nC&&(n=void 0),this.autoFreeze_&&Rg(n,!0),s){const i=[],o=[];Li("Patches").generateReplacementPatches_(t,n,i,o),s(i,o)}return n}else Ia(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let s,n;return[this.produce(t,r,(o,l)=>{s=o,n=l}),s,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){xn(e)||Ia(8),Fi(e)&&(e=dn(e));const t=cj(this),r=Lp(e,void 0);return r[sa].isManual_=!0,Rp(t),r}finishDraft(e,t){const r=e&&e[sa];(!r||!r.isManual_)&&Ia(9);const{scope_:s}=r;return lj(s,t),dj(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const s=Li("Patches").applyPatches_;return Fi(e)?s(e,t):this.produce(e,n=>s(n,t))}};function Lp(e,t){const r=kc(e)?Li("MapSet").proxyMap_(e,t):sm(e)?Li("MapSet").proxySet_(e,t):YV(e,t);return(t?t.scope_:lC()).drafts_.push(r),r}function dn(e){return Fi(e)||Ia(10,e),dC(e)}function dC(e){if(!xn(e)||am(e))return e;const t=e[sa];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Dp(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Dp(e,!0);return ru(r,(s,n)=>{oC(r,s,dC(n))}),t&&(t.finalized_=!1),r}var ZV=new JV,uC=ZV.produce;function mC(e){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,e):n(i)}var QV=mC(),eG=mC,tG=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?tu:tu.apply(null,arguments)};function Na(e,t){function r(...s){if(t){let n=t(...s);if(!n)throw new Error(ea(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:s[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=s=>aC(s)&&s.type===e,r}var fC=class bl extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,bl.prototype)}static get[Symbol.species](){return bl}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new bl(...t[0].concat(this)):new bl(...t.concat(this))}};function mj(e){return xn(e)?uC(e,()=>{}):e}function ud(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function rG(e){return typeof e=="boolean"}var sG=()=>function(t){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let o=new fC;return r&&(rG(r)?o.push(QV):o.push(eG(r.extraArgument))),o},aG="RTK_autoBatch",fj=e=>t=>{setTimeout(t,e)},nG=(e={type:"raf"})=>t=>(...r)=>{const s=t(...r);let n=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:fj(10):e.type==="callback"?e.queueNotification:fj(e.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},s,{subscribe(d){const m=()=>n&&d(),f=s.subscribe(m);return l.add(d),()=>{f(),l.delete(d)}},dispatch(d){try{return n=!d?.meta?.[aG],i=!n,i&&(o||(o=!0,c(u))),s.dispatch(d)}finally{n=!0}}})},iG=e=>function(r){const{autoBatch:s=!0}=r??{};let n=new fC(e);return s&&n.push(nG(typeof s=="object"?s:void 0)),n};function oG(e){const t=sG(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(Og(r))l=sC(r);else throw new Error(ea(1));let c;typeof s=="function"?c=s(t):c=t();let u=tu;n&&(u=tG({trace:!1,...typeof n=="object"&&n}));const d=WV(...c),m=iG(d);let f=typeof o=="function"?o(m):m();const h=u(...f);return rC(l,i,h)}function hC(e){const t={},r=[];let s;const n={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(ea(28));if(l in t)throw new Error(ea(29));return t[l]=o,n},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return s=i,n}};return e(n),[t,r,s]}function lG(e){return typeof e=="function"}function cG(e,t){let[r,s,n]=hC(t),i;if(lG(e))i=()=>mj(e());else{const l=mj(e);i=()=>l}function o(l=i(),c){let u=[r[c.type],...s.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[n]),u.reduce((d,m)=>{if(m)if(Fi(d)){const h=m(d,c);return h===void 0?d:h}else{if(xn(d))return uC(d,f=>m(f,c));{const f=m(d,c);if(f===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return d},l)}return o.getInitialState=i,o}var dG="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",uG=(e=21)=>{let t="",r=e;for(;r--;)t+=dG[Math.random()*64|0];return t},mG=Symbol.for("rtk-slice-createasyncthunk");function fG(e,t){return`${e}/${t}`}function hG({creators:e}={}){const t=e?.asyncThunk?.[mG];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(ea(11));const o=(typeof s.reducers=="function"?s.reducers(xG()):s.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(j,S){const E=typeof j=="string"?j:j.type;if(!E)throw new Error(ea(12));if(E in c.sliceCaseReducersByType)throw new Error(ea(13));return c.sliceCaseReducersByType[E]=S,u},addMatcher(j,S){return c.sliceMatchers.push({matcher:j,reducer:S}),u},exposeAction(j,S){return c.actionCreators[j]=S,u},exposeCaseReducer(j,S){return c.sliceCaseReducersByName[j]=S,u}};l.forEach(j=>{const S=o[j],E={reducerName:j,type:fG(n,j),createNotation:typeof s.reducers=="function"};vG(S)?yG(E,S,u,t):gG(E,S,u)});function d(){const[j={},S=[],E=void 0]=typeof s.extraReducers=="function"?hC(s.extraReducers):[s.extraReducers],w={...j,...c.sliceCaseReducersByType};return cG(s.initialState,N=>{for(let C in w)N.addCase(C,w[C]);for(let C of c.sliceMatchers)N.addMatcher(C.matcher,C.reducer);for(let C of S)N.addMatcher(C.matcher,C.reducer);E&&N.addDefaultCase(E)})}const m=j=>j,f=new Map,h=new WeakMap;let x;function p(j,S){return x||(x=d()),x(j,S)}function g(){return x||(x=d()),x.getInitialState()}function b(j,S=!1){function E(N){let C=N[j];return typeof C>"u"&&S&&(C=ud(h,E,g)),C}function w(N=m){const C=ud(f,S,()=>new WeakMap);return ud(C,N,()=>{const T={};for(const[_,k]of Object.entries(s.selectors??{}))T[_]=pG(k,N,()=>ud(h,N,g),S);return T})}return{reducerPath:j,getSelectors:w,get selectors(){return w(E)},selectSlice:E}}const y={name:n,reducer:p,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...b(i),injectInto(j,{reducerPath:S,...E}={}){const w=S??i;return j.inject({reducerPath:w,reducer:p},E),{...y,...b(w,!0)}}};return y}}function pG(e,t,r,s){function n(i,...o){let l=t(i);return typeof l>"u"&&s&&(l=r()),e(l,...o)}return n.unwrapped=e,n}var na=hG();function xG(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function gG({type:e,reducerName:t,createNotation:r},s,n){let i,o;if("reducer"in s){if(r&&!bG(s))throw new Error(ea(17));i=s.reducer,o=s.prepare}else i=s;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?Na(e,o):Na(e))}function vG(e){return e._reducerDefinitionType==="asyncThunk"}function bG(e){return e._reducerDefinitionType==="reducerWithPrepare"}function yG({type:e,reducerName:t},r,s,n){if(!n)throw new Error(ea(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,m=n(e,i,d);s.exposeAction(t,m),o&&s.addCase(m.fulfilled,o),l&&s.addCase(m.pending,l),c&&s.addCase(m.rejected,c),u&&s.addMatcher(m.settled,u),s.exposeCaseReducer(t,{fulfilled:o||md,pending:l||md,rejected:c||md,settled:u||md})}function md(){}var jG="task",pC="listener",xC="completed",Lg="cancelled",wG=`task-${Lg}`,NG=`task-${xC}`,Mp=`${pC}-${Lg}`,SG=`${pC}-${xC}`,nm=class{constructor(e){this.code=e,this.message=`${jG} ${Lg} (reason: ${e})`}name="TaskAbortError";message},Mg=(e,t)=>{if(typeof e!="function")throw new TypeError(ea(32))},nu=()=>{},gC=(e,t=nu)=>(e.catch(t),e),vC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),wi=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ni=e=>{if(e.aborted){const{reason:t}=e;throw new nm(t)}};function bC(e,t){let r=nu;return new Promise((s,n)=>{const i=()=>n(new nm(e.reason));if(e.aborted){i();return}r=vC(e,i),t.finally(()=>r()).then(s,n)}).finally(()=>{r=nu})}var EG=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof nm?"cancelled":"rejected",error:r}}finally{t?.()}},iu=e=>t=>gC(bC(e,t).then(r=>(Ni(e),r))),yC=e=>{const t=iu(e);return r=>t(new Promise(s=>setTimeout(s,r)))},{assign:xo}=Object,hj={},im="listenerMiddleware",TG=(e,t)=>{const r=s=>vC(e,()=>wi(s,e.reason));return(s,n)=>{Mg(s);const i=new AbortController;r(i);const o=EG(async()=>{Ni(e),Ni(i.signal);const l=await s({pause:iu(i.signal),delay:yC(i.signal),signal:i.signal});return Ni(i.signal),l},()=>wi(i,NG));return n?.autoJoin&&t.push(o.catch(nu)),{result:iu(e)(o),cancel(){wi(i,wG)}}}},CG=(e,t)=>{const r=async(s,n)=>{Ni(t);let i=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:s,effect:(m,f)=>{f.unsubscribe(),c([m,f.getState(),f.getOriginalState()])}});i=()=>{d(),u()}})];n!=null&&l.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await bC(t,Promise.race(l));return Ni(t),c}finally{i()}};return(s,n)=>gC(r(s,n))},jC=e=>{let{type:t,actionCreator:r,matcher:s,predicate:n,effect:i}=e;if(t)n=Na(t).match;else if(r)t=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(ea(21));return Mg(i),{predicate:n,type:t,effect:i}},wC=xo(e=>{const{type:t,predicate:r,effect:s}=jC(e);return{id:uG(),effect:s,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ea(22))}}},{withTypes:()=>wC}),pj=(e,t)=>{const{type:r,effect:s,predicate:n}=jC(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},Bp=e=>{e.pending.forEach(t=>{wi(t,Mp)})},AG=e=>()=>{e.forEach(Bp),e.clear()},xj=(e,t,r)=>{try{e(t,r)}catch(s){setTimeout(()=>{throw s},0)}},NC=xo(Na(`${im}/add`),{withTypes:()=>NC}),kG=Na(`${im}/removeAll`),SC=xo(Na(`${im}/remove`),{withTypes:()=>SC}),_G=(...e)=>{console.error(`${im}/error`,...e)},_c=(e={})=>{const t=new Map,{extra:r,onError:s=_G}=e;Mg(s);const n=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),m=>{d.unsubscribe(),m?.cancelActive&&Bp(d)}),i=d=>{const m=pj(t,d)??wC(d);return n(m)};xo(i,{withTypes:()=>i});const o=d=>{const m=pj(t,d);return m&&(m.unsubscribe(),d.cancelActive&&Bp(m)),!!m};xo(o,{withTypes:()=>o});const l=async(d,m,f,h)=>{const x=new AbortController,p=CG(i,x.signal),g=[];try{d.pending.add(x),await Promise.resolve(d.effect(m,xo({},f,{getOriginalState:h,condition:(b,y)=>p(b,y).then(Boolean),take:p,delay:yC(x.signal),pause:iu(x.signal),extra:r,signal:x.signal,fork:TG(x.signal,g),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((b,y,j)=>{b!==x&&(wi(b,Mp),j.delete(b))})},cancel:()=>{wi(x,Mp),d.pending.delete(x)},throwIfCancelled:()=>{Ni(x.signal)}})))}catch(b){b instanceof nm||xj(s,b,{raisedBy:"effect"})}finally{await Promise.all(g),wi(x,SG),d.pending.delete(x)}},c=AG(t);return{middleware:d=>m=>f=>{if(!aC(f))return m(f);if(NC.match(f))return i(f.payload);if(kG.match(f)){c();return}if(SC.match(f))return o(f.payload);let h=d.getState();const x=()=>{if(h===hj)throw new Error(ea(23));return h};let p;try{if(p=m(f),t.size>0){const g=d.getState(),b=Array.from(t.values());for(const y of b){let j=!1;try{j=y.predicate(f,g,h)}catch(S){j=!1,xj(s,S,{raisedBy:"predicate"})}j&&l(y,f,d,x)}}}finally{h=hj}return p},startListening:i,stopListening:o,clearListeners:c}};function ea(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var IG={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},EC=na({name:"chartLayout",initialState:IG,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,s,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:PG,setLayout:DG,setChartSize:OG,setScale:RG}=EC.actions,FG=EC.reducer;function gj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function vj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gj(Object(r),!0).forEach(function(s){LG(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function LG(e,t,r){return(t=MG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MG(e){var t=BG(e,"string");return typeof t=="symbol"?t:t+""}function BG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ou=Math.PI/180,zG=e=>e*180/Math.PI,Fr=(e,t,r,s)=>({x:e+Math.cos(-ou*s)*r,y:t+Math.sin(-ou*s)*r}),TC=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},$G=(e,t)=>{var{x:r,y:s}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(s-i)**2)},UG=(e,t)=>{var{x:r,y:s}=e,{cx:n,cy:i}=t,o=$G({x:r,y:s},{x:n,y:i});if(o<=0)return{radius:o,angle:0};var l=(r-n)/o,c=Math.acos(l);return s>i&&(c=2*Math.PI-c),{radius:o,angle:zG(c),angleInRadian:c}},WG=e=>{var{startAngle:t,endAngle:r}=e,s=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(s,n);return{startAngle:t-i*360,endAngle:r-i*360}},HG=(e,t)=>{var{startAngle:r,endAngle:s}=t,n=Math.floor(r/360),i=Math.floor(s/360),o=Math.min(n,i);return e+o*360},VG=(e,t)=>{var{x:r,y:s}=e,{radius:n,angle:i}=UG({x:r,y:s},t),{innerRadius:o,outerRadius:l}=t;if(n<o||n>l||n===0)return null;var{startAngle:c,endAngle:u}=WG(t),d=i,m;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;m=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;m=d>=u&&d<=c}return m?vj(vj({},t),{},{radius:n,angle:HG(d,t)}):null};function CC(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function bj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ga(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bj(Object(r),!0).forEach(function(s){GG(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GG(e,t,r){return(t=qG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qG(e){var t=KG(e,"string");return typeof t=="symbol"?t:t+""}function KG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(e,t,r){return rs(e)||rs(t)?r:Xa(t)?Ri(e,t,r):typeof t=="function"?t(e):r}var YG=(e,t,r,s,n)=>{var i,o=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(s==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<l;c++){var u=c>0?r[c-1].coordinate:r[l-1].coordinate,d=r[c].coordinate,m=c>=l-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(es(d-u)!==es(m-d)){var h=[];if(es(m-d)===es(n[1]-n[0])){f=m;var x=d+n[1]-n[0];h[0]=Math.min(x,(x+u)/2),h[1]=Math.max(x,(x+u)/2)}else{f=u;var p=m+n[1]-n[0];h[0]=Math.min(d,(p+d)/2),h[1]=Math.max(d,(p+d)/2)}var g=[Math.min(d,(f+d)/2),Math.max(d,(f+d)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){({index:o}=r[c]);break}}else{var b=Math.min(u,m),y=Math.max(u,m);if(e>(b+d)/2&&e<=(y+d)/2){({index:o}=r[c]);break}}}else if(t){for(var j=0;j<l;j++)if(j===0&&e<=(t[j].coordinate+t[j+1].coordinate)/2||j>0&&j<l-1&&e>(t[j].coordinate+t[j-1].coordinate)/2&&e<=(t[j].coordinate+t[j+1].coordinate)/2||j===l-1&&e>(t[j].coordinate+t[j-1].coordinate)/2){({index:o}=t[j]);break}}return o},XG=(e,t,r)=>{if(t&&r){var{width:s,height:n}=r,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&ut(e[i]))return ga(ga({},e),{},{[i]:e[i]+(s||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&ut(e[o]))return ga(ga({},e),{},{[o]:e[o]+(n||0)})}return e},Xi=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",AC=(e,t,r,s)=>{if(s)return e.map(l=>l.coordinate);var n,i,o=e.map(l=>(l.coordinate===t&&(n=!0),l.coordinate===r&&(i=!0),l.coordinate));return n||o.push(t),i||o.push(r),o},kC=(e,t,r)=>{if(!e)return null;var{duplicateDomain:s,type:n,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:m,niceTicks:f,axisType:h}=e;if(!o)return null;var x=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,p=n==="category"&&o.bandwidth?o.bandwidth()/x:0;if(p=h==="angleAxis"&&i&&i.length>=2?es(i[0]-i[1])*2*p:p,m||f){var g=(m||f||[]).map((b,y)=>{var j=s?s.indexOf(b):b;return{coordinate:o(j)+p,value:b,offset:p,index:y}});return g.filter(b=>!ra(b.coordinate))}return c&&u?u.map((b,y)=>({coordinate:o(b)+p,value:b,index:y,offset:p})):o.ticks&&d!=null?o.ticks(d).map((b,y)=>({coordinate:o(b)+p,value:b,offset:p,index:y})):o.domain().map((b,y)=>({coordinate:o(b)+p,value:s?s[b]:b,index:y,offset:p}))},yj=1e-4,JG=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,s=e.range(),n=Math.min(s[0],s[1])-yj,i=Math.max(s[0],s[1])+yj,o=e(t[0]),l=e(t[r-1]);(o<n||o>i||l<n||l>i)&&e.domain([t[0],t[r-1]])}},ZG=(e,t)=>{if(!t||t.length!==2||!ut(t[0])||!ut(t[1]))return e;var r=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!ut(e[0])||e[0]<r)&&(n[0]=r),(!ut(e[1])||e[1]>s)&&(n[1]=s),n[0]>s&&(n[0]=s),n[1]<r&&(n[1]=r),n},QG=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0,o=0;o<t;++o){var l=ra(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=n,e[o][r][1]=n+l,n=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1])}},eq=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0;i<t;++i){var o=ra(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=n,e[i][r][1]=n+o,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},tq={sign:QG,expand:_H,none:Co,silhouette:IH,wiggle:PH,positive:eq},rq=(e,t,r)=>{var s=tq[r],n=kH().keys(t).value((i,o)=>+jr(i,o,0)).order(kp).offset(s);return n(e)};function sq(e){return e==null?void 0:String(e)}var jj=e=>{var{axis:t,ticks:r,offset:s,bandSize:n,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+s:null;var l=jr(i,t.dataKey,t.scale.domain()[o]);return rs(l)?null:t.scale(l)-n/2+s},aq=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var s=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return s<=0&&n>=0?0:n<0?n:s}return r[0]},nq=e=>{var t=e.flat(2).filter(ut);return[Math.min(...t),Math.max(...t)]},iq=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],oq=(e,t,r)=>{if(e!=null)return iq(Object.keys(e).reduce((s,n)=>{var i=e[n],{stackedData:o}=i,l=o.reduce((c,u)=>{var d=CC(u,t,r),m=nq(d);return[Math.min(c[0],m[0]),Math.max(c[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],s[0]),Math.max(l[1],s[1])]},[1/0,-1/0]))},wj=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Nj=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Bg=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!r||s>0)return s}if(e&&t&&t.length>=2){for(var n=tm(t,d=>d.coordinate),i=1/0,o=1,l=n.length;o<l;o++){var c=n[o],u=n[o-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Sj(e){var{tooltipEntrySettings:t,dataKey:r,payload:s,value:n,name:i}=e;return ga(ga({},t),{},{dataKey:r,payload:s,value:n,name:i})}function om(e,t){if(e)return String(e);if(typeof t=="string")return t}function lq(e,t,r,s,n){if(r==="horizontal"||r==="vertical"){var i=e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height;return i?{x:e,y:t}:null}return s?VG({x:e,y:t},s):null}var cq=(e,t,r,s)=>{var n=t.find(u=>u&&u.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:n.coordinate};if(e==="centric"){var i=n.coordinate,{radius:o}=s;return ga(ga(ga({},s),Fr(s.cx,s.cy,o,i)),{},{angle:i,radius:o})}var l=n.coordinate,{angle:c}=s;return ga(ga(ga({},s),Fr(s.cx,s.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},dq=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Nn=e=>e.layout.width,Sn=e=>e.layout.height,uq=e=>e.layout.scale,_C=e=>e.layout.margin,lm=je(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),cm=je(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),IC="data-recharts-item-index",PC="data-recharts-item-data-key",Ic=60;function Ej(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function fd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ej(Object(r),!0).forEach(function(s){mq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ej(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function mq(e,t,r){return(t=fq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fq(e){var t=hq(e,"string");return typeof t=="symbol"?t:t+""}function hq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pq=e=>e.brush.height;function xq(e){var t=cm(e);return t.reduce((r,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:Ic;return r+n}return r},0)}function gq(e){var t=cm(e);return t.reduce((r,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:Ic;return r+n}return r},0)}function vq(e){var t=lm(e);return t.reduce((r,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?r+s.height:r,0)}function bq(e){var t=lm(e);return t.reduce((r,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?r+s.height:r,0)}var Vr=je([Nn,Sn,_C,pq,xq,gq,vq,bq,eC,FV],(e,t,r,s,n,i,o,l,c,u)=>{var d={left:(r.left||0)+n,right:(r.right||0)+i},m={top:(r.top||0)+o,bottom:(r.bottom||0)+l},f=fd(fd({},m),d),h=f.bottom;f.bottom+=s,f=XG(f,c,u);var x=e-f.left-f.right,p=t-f.top-f.bottom;return fd(fd({brushBottom:h},f),{},{width:Math.max(x,0),height:Math.max(p,0)})}),yq=je(Vr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),zg=je(Nn,Sn,(e,t)=>({x:0,y:0,width:e,height:t})),jq=v.createContext(null),Ta=()=>v.useContext(jq)!=null,dm=e=>e.brush,um=je([dm,Vr,_C],(e,t,r)=>({height:e.height,x:ut(e.x)?e.x:t.left,y:ut(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:ut(e.width)?e.width:t.width})),$g=()=>{var e,t=Ta(),r=lt(yq),s=lt(um),n=(e=lt(dm))===null||e===void 0?void 0:e.padding;return!t||!s||!n?r:{width:s.width-n.left-n.right,height:s.height-n.top-n.bottom,x:n.left,y:n.top}},wq={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},DC=()=>{var e;return(e=lt(Vr))!==null&&e!==void 0?e:wq},Ug=()=>lt(Nn),Wg=()=>lt(Sn),Nq=()=>lt(e=>e.layout.margin),Vt=e=>e.layout.layoutType,Hg=()=>lt(Vt),Sq={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},OC=na({name:"legend",initialState:Sq,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=dn(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Tj,setLegendSettings:Eq,addLegendPayload:RC,removeLegendPayload:FC}=OC.actions,Tq=OC.reducer,Cq=["contextPayload"];function zp(){return zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zp.apply(null,arguments)}function Cj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cj(Object(r),!0).forEach(function(s){Vg(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Vg(e,t,r){return(t=Aq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aq(e){var t=kq(e,"string");return typeof t=="symbol"?t:t+""}function kq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _q(e,t){if(e==null)return{};var r,s,n=Iq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Iq(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Pq(e){return e.value}function Dq(e){var{contextPayload:t}=e,r=_q(e,Cq),s=XT(t,e.payloadUniqBy,Pq),n=ko(ko({},r),{},{payload:s});return v.isValidElement(e.content)?v.cloneElement(e.content,n):typeof e.content=="function"?v.createElement(e.content,n):v.createElement(_g,n)}function Oq(e,t,r,s,n,i){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((s||0)-i.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((n||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),ko(ko({},u),d)}function Rq(e){var t=Sr();return v.useEffect(()=>{t(Eq(e))},[t,e]),null}function Fq(e){var t=Sr();return v.useEffect(()=>(t(Tj(e)),()=>{t(Tj({width:0,height:0}))}),[t,e]),null}function Lq(e){var t=BV(),r=QW(),s=Nq(),{width:n,height:i,wrapperStyle:o,portal:l}=e,[c,u]=tC([t]),d=Ug(),m=Wg();if(d==null||m==null)return null;var f=d-(s.left||0)-(s.right||0),h=fi.getWidthOrHeight(e.layout,i,n,f),x=l?o:ko(ko({position:"absolute",width:h?.width||n||"auto",height:h?.height||i||"auto"},Oq(o,e,s,d,m,c)),o),p=l??r;if(p==null)return null;var g=v.createElement("div",{className:"recharts-legend-wrapper",style:x,ref:u},v.createElement(Rq,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),v.createElement(Fq,{width:c.width,height:c.height}),v.createElement(Dq,zp({},e,h,{margin:s,chartWidth:d,chartHeight:m,contextPayload:t})));return gx.createPortal(g,p)}class fi extends v.PureComponent{static getWidthOrHeight(t,r,s,n){return t==="vertical"&&ut(r)?{height:r}:t==="horizontal"?{width:s||n}:null}render(){return v.createElement(Lq,this.props)}}Vg(fi,"displayName","Legend");Vg(fi,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function $p(){return $p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$p.apply(null,arguments)}function Aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aj(Object(r),!0).forEach(function(s){Mq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Mq(e,t,r){return(t=Bq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bq(e){var t=zq(e,"string");return typeof t=="symbol"?t:t+""}function zq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $q(e){return Array.isArray(e)&&Xa(e[0])&&Xa(e[1])?e.join(" ~ "):e}var Uq=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:s={},labelStyle:n={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:m,accessibilityLayer:f=!1}=e,h=()=>{if(i&&i.length){var E={padding:0,margin:0},w=(l?tm(i,l):i).map((N,C)=>{if(N.type==="none")return null;var T=N.formatter||o||$q,{value:_,name:k}=N,I=_,L=k;if(T){var D=T(_,k,N,C,i);if(Array.isArray(D))[I,L]=D;else if(D!=null)I=D;else return null}var M=eh({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},s);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(C),style:M},Xa(L)?v.createElement("span",{className:"recharts-tooltip-item-name"},L):null,Xa(L)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},I),v.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:E},w)}return null},x=eh({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=eh({margin:0},n),g=!rs(d),b=g?d:"",y=Pt("recharts-default-tooltip",c),j=Pt("recharts-tooltip-label",u);g&&m&&i!==void 0&&i!==null&&(b=m(d,i));var S=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",$p({className:y,style:x},S),v.createElement("p",{className:j,style:p},v.isValidElement(b)?b:"".concat(b)),h())},ol="recharts-tooltip-wrapper",Wq={visibility:"hidden"};function Hq(e){var{coordinate:t,translateX:r,translateY:s}=e;return Pt(ol,{["".concat(ol,"-right")]:ut(r)&&t&&ut(t.x)&&r>=t.x,["".concat(ol,"-left")]:ut(r)&&t&&ut(t.x)&&r<t.x,["".concat(ol,"-bottom")]:ut(s)&&t&&ut(t.y)&&s>=t.y,["".concat(ol,"-top")]:ut(s)&&t&&ut(t.y)&&s<t.y})}function kj(e){var{allowEscapeViewBox:t,coordinate:r,key:s,offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(i&&ut(i[s]))return i[s];var d=r[s]-l-(n>0?n:0),m=r[s]+n;if(t[s])return o[s]?d:m;var f=c[s];if(f==null)return 0;if(o[s]){var h=d,x=f;return h<x?Math.max(m,f):Math.max(d,f)}if(u==null)return 0;var p=m+l,g=f+u;return p>g?Math.max(d,f):Math.max(m,f)}function Vq(e){var{translateX:t,translateY:r,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Gq(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:s,position:n,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,u,d,m;return o.height>0&&o.width>0&&r?(d=kj({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),m=kj({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=Vq({translateX:d,translateY:m,useTranslate3d:l})):u=Wq,{cssProperties:u,cssClasses:Hq({translateX:d,translateY:m,coordinate:r})}}function _j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function hd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_j(Object(r),!0).forEach(function(s){Up(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_j(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Up(e,t,r){return(t=qq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qq(e){var t=Kq(e,"string");return typeof t=="symbol"?t:t+""}function Kq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Yq extends v.PureComponent{constructor(){super(...arguments),Up(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Up(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,s,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:s,animationEasing:n,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:m,useTranslate3d:f,viewBox:h,wrapperStyle:x,lastBoundingBox:p,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:y,cssProperties:j}=Gq({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:m,tooltipBox:{height:p.height,width:p.width},useTranslate3d:f,viewBox:h}),S=b?{}:hd(hd({transition:c&&t?"transform ".concat(s,"ms ").concat(n):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),E=hd(hd({},S),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:E,ref:g},i)}}var Xq=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ji={devToolsEnabled:!1,isSsr:Xq()},LC=()=>lt(e=>e.rootProps.accessibilityLayer);function aa(e){return Number.isFinite(e)}function _o(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Wp(){return Wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wp.apply(null,arguments)}function Ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Pj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ij(Object(r),!0).forEach(function(s){Jq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ij(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Jq(e,t,r){return(t=Zq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zq(e){var t=Qq(e,"string");return typeof t=="symbol"?t:t+""}function Qq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dj={curveBasisClosed:vH,curveBasisOpen:bH,curveBasis:gH,curveBumpX:sH,curveBumpY:aH,curveLinearClosed:yH,curveLinear:Qu,curveMonotoneX:jH,curveMonotoneY:wH,curveNatural:NH,curveStep:SH,curveStepAfter:TH,curveStepBefore:EH},pd=e=>aa(e.x)&&aa(e.y),ll=e=>e.x,cl=e=>e.y,eK=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Cc(e));return(r==="curveMonotone"||r==="curveBump")&&t?Dj["".concat(r).concat(t==="vertical"?"Y":"X")]:Dj[r]||Qu},tK=e=>{var{type:t="linear",points:r=[],baseLine:s,layout:n,connectNulls:i=!1}=e,o=eK(t,n),l=i?r.filter(pd):r,c;if(Array.isArray(s)){var u=i?s.filter(m=>pd(m)):s,d=l.map((m,f)=>Pj(Pj({},m),{},{base:u[f]}));return n==="vertical"?c=od().y(cl).x1(ll).x0(m=>m.base.x):c=od().x(ll).y1(cl).y0(m=>m.base.y),c.defined(pd).curve(o),c(d)}return n==="vertical"&&ut(s)?c=od().y(cl).x1(ll).x0(s):ut(s)?c=od().x(ll).y1(cl).y0(s):c=_T().x(ll).y(cl),c.defined(pd).curve(o),c(l)},MC=e=>{var{className:t,points:r,path:s,pathRef:n}=e;if((!r||!r.length)&&!s)return null;var i=r&&r.length?tK(e):s;return v.createElement("path",Wp({},Jn(e),WW(e),{className:Pt("recharts-curve",t),d:i===null?void 0:i,ref:n}))},rK=["x","y","top","left","width","height","className"];function Hp(){return Hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hp.apply(null,arguments)}function Oj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function sK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oj(Object(r),!0).forEach(function(s){aK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function aK(e,t,r){return(t=nK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nK(e){var t=iK(e,"string");return typeof t=="symbol"?t:t+""}function iK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oK(e,t){if(e==null)return{};var r,s,n=lK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lK(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cK=(e,t,r,s,n,i)=>"M".concat(e,",").concat(n,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(r),dK=e=>{var{x:t=0,y:r=0,top:s=0,left:n=0,width:i=0,height:o=0,className:l}=e,c=oK(e,rK),u=sK({x:t,y:r,top:s,left:n,width:i,height:o},c);return!ut(t)||!ut(r)||!ut(i)||!ut(o)||!ut(s)||!ut(n)?null:v.createElement("path",Hp({},Hr(u,!0),{className:Pt("recharts-cross",l),d:cK(t,r,i,o,s,n)}))};function uK(e,t,r,s){var n=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function Rj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function mK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rj(Object(r),!0).forEach(function(s){fK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function fK(e,t,r){return(t=hK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hK(e){var t=pK(e,"string");return typeof t=="symbol"?t:t+""}function pK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rs(e,t){var r=mK({},e),s=t,n=Object.keys(t),i=n.reduce((o,l)=>(o[l]===void 0&&s[l]!==void 0&&(o[l]=s[l]),o),r);return i}function xK(){}function Fj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Lj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fj(Object(r),!0).forEach(function(s){gK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function gK(e,t,r){return(t=vK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vK(e){var t=bK(e,"string");return typeof t=="symbol"?t:t+""}function bK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yK=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),BC=(e,t,r)=>e.map(s=>"".concat(yK(s)," ").concat(t,"ms ").concat(r)).join(","),jK=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,s)=>r.filter(n=>s.includes(n))),rc=(e,t)=>Object.keys(t).reduce((r,s)=>Lj(Lj({},r),{},{[s]:e(s,t[s])}),{});function Mj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mj(Object(r),!0).forEach(function(s){wK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function wK(e,t,r){return(t=NK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NK(e){var t=SK(e,"string");return typeof t=="symbol"?t:t+""}function SK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lu=(e,t,r)=>e+(t-e)*r,Vp=e=>{var{from:t,to:r}=e;return t!==r},zC=(e,t,r)=>{var s=rc((n,i)=>{if(Vp(i)){var[o,l]=e(i.from,i.to,i.velocity);return ls(ls({},i),{},{from:o,velocity:l})}return i},t);return r<1?rc((n,i)=>Vp(i)?ls(ls({},i),{},{velocity:lu(i.velocity,s[n].velocity,r),from:lu(i.from,s[n].from,r)}):i,t):zC(e,s,r-1)};function EK(e,t,r,s,n,i){var o,l=s.reduce((f,h)=>ls(ls({},f),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>rc((f,h)=>h.from,l),u=()=>!Object.values(l).filter(Vp).length,d=null,m=f=>{o||(o=f);var h=f-o,x=h/r.dt;l=zC(r,l,x),n(ls(ls(ls({},e),t),c())),o=f,u()||(d=i.setTimeout(m))};return()=>(d=i.setTimeout(m),()=>{d()})}function TK(e,t,r,s,n,i,o){var l=null,c=n.reduce((m,f)=>ls(ls({},m),{},{[f]:[e[f],t[f]]}),{}),u,d=m=>{u||(u=m);var f=(m-u)/s,h=rc((p,g)=>lu(...g,r(f)),c);if(i(ls(ls(ls({},e),t),h)),f<1)l=o.setTimeout(d);else{var x=rc((p,g)=>lu(...g,r(1)),c);i(ls(ls(ls({},e),t),x))}};return()=>(l=o.setTimeout(d),()=>{l()})}const CK=(e,t,r,s,n,i)=>{var o=jK(e,t);return r.isStepper===!0?EK(e,t,r,o,n,i):TK(e,t,r,s,o,n,i)};var cu=1e-4,$C=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],UC=(e,t)=>e.map((r,s)=>r*t**s).reduce((r,s)=>r+s),Bj=(e,t)=>r=>{var s=$C(e,t);return UC(s,r)},AK=(e,t)=>r=>{var s=$C(e,t),n=[...s.map((i,o)=>i*o).slice(1),0];return UC(n,r)},zj=function(){for(var t,r,s,n,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];if(o.length===1)switch(o[0]){case"linear":[t,s,r,n]=[0,0,1,1];break;case"ease":[t,s,r,n]=[.25,.1,.25,1];break;case"ease-in":[t,s,r,n]=[.42,0,1,1];break;case"ease-out":[t,s,r,n]=[.42,0,.58,1];break;case"ease-in-out":[t,s,r,n]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,s,r,n]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else o.length===4&&([t,s,r,n]=o);var u=Bj(t,r),d=Bj(s,n),m=AK(t,r),f=x=>x>1?1:x<0?0:x,h=x=>{for(var p=x>1?1:x,g=p,b=0;b<8;++b){var y=u(g)-p,j=m(g);if(Math.abs(y-p)<cu||j<cu)return d(g);g=f(g-y/j)}return d(g)};return h.isStepper=!1,h},kK=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:s=8,dt:n=17}=t,i=(o,l,c)=>{var u=-(o-l)*r,d=c*s,m=c+(u-d)*n/1e3,f=c*n/1e3+o;return Math.abs(f-l)<cu&&Math.abs(m)<cu?[l,0]:[f,m]};return i.isStepper=!0,i.dt=n,i},_K=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return zj(e);case"spring":return kK();default:if(e.split("(")[0]==="cubic-bezier")return zj(e)}return typeof e=="function"?e:null};function IK(e){var t,r=()=>null,s=!1,n=null,i=o=>{if(!s){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){n=e.setTimeout(i.bind(null,u),c);return}i(c),n=e.setTimeout(i.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{s=!0},start:o=>{s=!1,n&&(n(),n=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class PK{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),n=null,i=o=>{o-s>=r?t(o):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{cancelAnimationFrame(n)}}}function DK(){return IK(new PK)}var OK=v.createContext(DK);function RK(e,t){var r=v.useContext(OK);return v.useMemo(()=>t??r(e),[e,t,r])}var FK={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},$j={t:0},th={t:1};function mm(e){var t=Rs(e,FK),{isActive:r,canBegin:s,duration:n,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=RK(t.animationId,t.animationManager),[m,f]=v.useState(r?$j:th),h=v.useRef(null);return v.useEffect(()=>{r||f(th)},[r]),v.useEffect(()=>{if(!r||!s)return xK;var x=CK($j,th,_K(i),n,f,d.getTimeoutController()),p=()=>{h.current=x()};return d.start([c,o,p,n,l]),()=>{d.stop(),h.current&&h.current(),l()}},[r,s,n,i,o,c,l,d]),u(m.t)}function fm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(Ql(t)),s=v.useRef(e);return s.current!==e&&(r.current=Ql(t),s.current=e),r.current}function Uj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Wj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uj(Object(r),!0).forEach(function(s){LK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function LK(e,t,r){return(t=MK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MK(e){var t=BK(e,"string");return typeof t=="symbol"?t:t+""}function BK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function du(){return du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},du.apply(null,arguments)}var Hj=(e,t,r,s,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(s)/2),o=s>=0?1:-1,l=r>=0?1:-1,c=s>=0&&r>=0||s<0&&r<0?1:0,u;if(i>0&&n instanceof Array){for(var d=[0,0,0,0],m=0,f=4;m<f;m++)d[m]=n[m]>i?i:n[m];u="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),u+="L ".concat(e+r-l*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*d[1])),u+="L ".concat(e+r,",").concat(t+s-o*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-l*d[2],",").concat(t+s)),u+="L ".concat(e+l*d[3],",").concat(t+s),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+s-o*d[3])),u+="Z"}else if(i>0&&n===+n&&n>0){var h=Math.min(i,n);u="M ".concat(e,",").concat(t+o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,`
            L `).concat(e+r-l*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,`
            L `).concat(e+r,",").concat(t+s-o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+s,`
            L `).concat(e+l*h,",").concat(t+s,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+s-o*h," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return u},zK={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},WC=e=>{var t=Rs(e,zK),r=v.useRef(null),[s,n]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var D=r.current.getTotalLength();D&&n(D)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:m,animationDuration:f,animationBegin:h,isAnimationActive:x,isUpdateAnimationActive:p}=t,g=v.useRef(l),b=v.useRef(c),y=v.useRef(i),j=v.useRef(o),S=v.useMemo(()=>({x:i,y:o,width:l,height:c,radius:u}),[i,o,l,c,u]),E=fm(S,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var w=Pt("recharts-rectangle",d);if(!p)return v.createElement("path",du({},Hr(t,!0),{className:w,d:Hj(i,o,l,c,u)}));var N=g.current,C=b.current,T=y.current,_=j.current,k="0px ".concat(s===-1?1:s,"px"),I="".concat(s,"px 0px"),L=BC(["strokeDasharray"],f,typeof m=="string"?m:void 0);return v.createElement(mm,{animationId:E,key:E,canBegin:s>0,duration:f,easing:m,isActive:p,begin:h},D=>{var M=ds(N,l,D),q=ds(C,c,D),Z=ds(T,i,D),Q=ds(_,o,D);r.current&&(g.current=M,b.current=q,y.current=Z,j.current=Q);var U;return x?D>0?U={transition:L,strokeDasharray:I}:U={strokeDasharray:k}:U={strokeDasharray:I},v.createElement("path",du({},Hr(t,!0),{className:w,d:Hj(Z,Q,M,q,u),ref:r,style:Wj(Wj({},U),t.style)}))})};function HC(e){var{cx:t,cy:r,radius:s,startAngle:n,endAngle:i}=e,o=Fr(t,r,s,n),l=Fr(t,r,s,i);return{points:[o,l],cx:t,cy:r,radius:s,startAngle:n,endAngle:i}}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gp.apply(null,arguments)}var $K=(e,t)=>{var r=es(t-e),s=Math.min(Math.abs(t-e),359.999);return r*s},xd=e=>{var{cx:t,cy:r,radius:s,angle:n,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+s,d=Math.asin(l/u)/ou,m=c?n:n+i*d,f=Fr(t,r,u,m),h=Fr(t,r,s,m),x=c?n-i*d:n,p=Fr(t,r,u*Math.cos(d*ou),x);return{center:f,circleTangency:h,lineTangency:p,theta:d}},VC=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:i,endAngle:o}=e,l=$K(i,o),c=i+l,u=Fr(t,r,n,i),d=Fr(t,r,n,c),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(s>0){var f=Fr(t,r,s,i),h=Fr(t,r,s,c);m+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},UK=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=es(u-c),{circleTangency:m,lineTangency:f,theta:h}=xd({cx:t,cy:r,radius:n,angle:c,sign:d,cornerRadius:i,cornerIsExternal:l}),{circleTangency:x,lineTangency:p,theta:g}=xd({cx:t,cy:r,radius:n,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-h-g;if(b<0)return o?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):VC({cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:c,endAngle:u});var y="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(b>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
  `);if(s>0){var{circleTangency:j,lineTangency:S,theta:E}=xd({cx:t,cy:r,radius:s,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:w,lineTangency:N,theta:C}=xd({cx:t,cy:r,radius:s,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),T=l?Math.abs(c-u):Math.abs(c-u)-E-C;if(T<0&&i===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+="L".concat(N.x,",").concat(N.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(T>180),",").concat(+(d>0),",").concat(j.x,",").concat(j.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,"Z")}else y+="L".concat(t,",").concat(r,"Z");return y},WK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},GC=e=>{var t=Rs(e,WK),{cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:m}=t;if(i<n||u===d)return null;var f=Pt("recharts-sector",m),h=i-n,x=Ss(o,h,0,!0),p;return x>0&&Math.abs(u-d)<360?p=UK({cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:Math.min(x,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=VC({cx:r,cy:s,innerRadius:n,outerRadius:i,startAngle:u,endAngle:d}),v.createElement("path",Gp({},Hr(t,!0),{className:f,d:p}))};function HK(e,t,r){var s,n,i,o;if(e==="horizontal")s=t.x,i=s,n=r.top,o=r.top+r.height;else if(e==="vertical")n=t.y,o=n,s=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:u,outerRadius:d,angle:m}=t,f=Fr(l,c,u,m),h=Fr(l,c,d,m);s=f.x,n=f.y,i=h.x,o=h.y}else return HC(t);return[{x:s,y:n},{x:i,y:o}]}var rh={},sh={},ah={},Vj;function VK(){return Vj||(Vj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZT();function r(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=r})(ah)),ah}var Gj;function GK(){return Gj||(Gj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VK();function r(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=r})(sh)),sh}var qj;function qK(){return qj||(qj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QT(),r=GK();function s(n,i,o){o&&typeof o!="number"&&t.isIterateeCall(n,i,o)&&(i=o=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),o=o===void 0?n<i?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((i-n)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=n,n+=o;return c}e.range=s})(rh)),rh}var nh,Kj;function KK(){return Kj||(Kj=1,nh=qK().range),nh}var YK=KK();const qC=qn(YK);function Bn(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function XK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gg(e){let t,r,s;e.length!==2?(t=Bn,r=(l,c)=>Bn(e(l),c),s=(l,c)=>e(l)-c):(t=e===Bn||e===XK?e:JK,r=e,s=e);function n(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(l[m],c)<0?u=m+1:d=m}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(l[m],c)<=0?u=m+1:d=m}while(u<d)}return u}function o(l,c,u=0,d=l.length){const m=n(l,c,u,d-1);return m>u&&s(l[m-1],c)>-s(l[m],c)?m-1:m}return{left:n,center:o,right:i}}function JK(){return 0}function KC(e){return e===null?NaN:+e}function*ZK(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const QK=Gg(Bn),Pc=QK.right;Gg(KC).center;class Yj extends Map{constructor(t,r=rY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,n]of t)this.set(s,n)}get(t){return super.get(Xj(this,t))}has(t){return super.has(Xj(this,t))}set(t,r){return super.set(eY(this,t),r)}delete(t){return super.delete(tY(this,t))}}function Xj({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function eY({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function tY({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function rY(e){return e!==null&&typeof e=="object"?e.valueOf():e}function sY(e=Bn){if(e===Bn)return YC;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function YC(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const aY=Math.sqrt(50),nY=Math.sqrt(10),iY=Math.sqrt(2);function uu(e,t,r){const s=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(s)),i=s/Math.pow(10,n),o=i>=aY?10:i>=nY?5:i>=iY?2:1;let l,c,u;return n<0?(u=Math.pow(10,-n)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,n)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?uu(e,t,r*2):[l,c,u]}function qp(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[n,i,o]=s?uu(t,e,r):uu(e,t,r);if(!(i>=n))return[];const l=i-n+1,c=new Array(l);if(s)if(o<0)for(let u=0;u<l;++u)c[u]=(i-u)/-o;else for(let u=0;u<l;++u)c[u]=(i-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(n+u)/-o;else for(let u=0;u<l;++u)c[u]=(n+u)*o;return c}function Kp(e,t,r){return t=+t,e=+e,r=+r,uu(e,t,r)[2]}function Yp(e,t,r){t=+t,e=+e,r=+r;const s=t<e,n=s?Kp(t,e,r):Kp(e,t,r);return(s?-1:1)*(n<0?1/-n:n)}function Jj(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function Zj(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function XC(e,t,r=0,s=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(n=n===void 0?YC:sY(n);s>r;){if(s-r>600){const c=s-r+1,u=t-r+1,d=Math.log(c),m=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*m*(c-m)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*m/c+f)),x=Math.min(s,Math.floor(t+(c-u)*m/c+f));XC(e,t,h,x,n)}const i=e[t];let o=r,l=s;for(dl(e,r,t),n(e[s],i)>0&&dl(e,r,s);o<l;){for(dl(e,o,l),++o,--l;n(e[o],i)<0;)++o;for(;n(e[l],i)>0;)--l}n(e[r],i)===0?dl(e,r,l):(++l,dl(e,l,s)),l<=t&&(r=l+1),t<=l&&(s=l-1)}return e}function dl(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function oY(e,t,r){if(e=Float64Array.from(ZK(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return Zj(e);if(t>=1)return Jj(e);var s,n=(s-1)*t,i=Math.floor(n),o=Jj(XC(e,i).subarray(0,i+1)),l=Zj(e.subarray(i+1));return o+(l-o)*(n-i)}}function lY(e,t,r=KC){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,n=(s-1)*t,i=Math.floor(n),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(n-i)}}function cY(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var s=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++s<n;)i[s]=e+s*r;return i}function Ca(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function En(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Xp=Symbol("implicit");function qg(){var e=new Yj,t=[],r=[],s=Xp;function n(i){let o=e.get(i);if(o===void 0){if(s!==Xp)return s;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Yj;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return qg(t,r).unknown(s)},Ca.apply(n,arguments),n}function Kg(){var e=qg().unknown(void 0),t=e.domain,r=e.range,s=0,n=1,i,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function m(){var f=t().length,h=n<s,x=h?n:s,p=h?s:n;i=(p-x)/Math.max(1,f-c+u*2),l&&(i=Math.floor(i)),x+=(p-x-i*(f-c))*d,o=i*(1-c),l&&(x=Math.round(x),o=Math.round(o));var g=cY(f).map(function(b){return x+i*b});return r(h?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),m()):t()},e.range=function(f){return arguments.length?([s,n]=f,s=+s,n=+n,m()):[s,n]},e.rangeRound=function(f){return[s,n]=f,s=+s,n=+n,l=!0,m()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,m()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),m()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),m()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,m()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),m()):d},e.copy=function(){return Kg(t(),[s,n]).round(l).paddingInner(c).paddingOuter(u).align(d)},Ca.apply(m(),arguments)}function JC(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return JC(t())},e}function dY(){return JC(Kg.apply(null,arguments).paddingInner(1))}function Yg(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function ZC(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function Dc(){}var sc=.7,mu=1/sc,go="\\s*([+-]?\\d+)\\s*",ac="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uY=/^#([0-9a-f]{3,8})$/,mY=new RegExp(`^rgb\\(${go},${go},${go}\\)$`),fY=new RegExp(`^rgb\\(${qa},${qa},${qa}\\)$`),hY=new RegExp(`^rgba\\(${go},${go},${go},${ac}\\)$`),pY=new RegExp(`^rgba\\(${qa},${qa},${qa},${ac}\\)$`),xY=new RegExp(`^hsl\\(${ac},${qa},${qa}\\)$`),gY=new RegExp(`^hsla\\(${ac},${qa},${qa},${ac}\\)$`),Qj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yg(Dc,nc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ew,formatHex:ew,formatHex8:vY,formatHsl:bY,formatRgb:tw,toString:tw});function ew(){return this.rgb().formatHex()}function vY(){return this.rgb().formatHex8()}function bY(){return QC(this).formatHsl()}function tw(){return this.rgb().formatRgb()}function nc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=uY.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?rw(t):r===3?new Ms(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?gd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?gd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mY.exec(e))?new Ms(t[1],t[2],t[3],1):(t=fY.exec(e))?new Ms(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hY.exec(e))?gd(t[1],t[2],t[3],t[4]):(t=pY.exec(e))?gd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xY.exec(e))?nw(t[1],t[2]/100,t[3]/100,1):(t=gY.exec(e))?nw(t[1],t[2]/100,t[3]/100,t[4]):Qj.hasOwnProperty(e)?rw(Qj[e]):e==="transparent"?new Ms(NaN,NaN,NaN,0):null}function rw(e){return new Ms(e>>16&255,e>>8&255,e&255,1)}function gd(e,t,r,s){return s<=0&&(e=t=r=NaN),new Ms(e,t,r,s)}function yY(e){return e instanceof Dc||(e=nc(e)),e?(e=e.rgb(),new Ms(e.r,e.g,e.b,e.opacity)):new Ms}function Jp(e,t,r,s){return arguments.length===1?yY(e):new Ms(e,t,r,s??1)}function Ms(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}Yg(Ms,Jp,ZC(Dc,{brighter(e){return e=e==null?mu:Math.pow(mu,e),new Ms(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?sc:Math.pow(sc,e),new Ms(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ms(Si(this.r),Si(this.g),Si(this.b),fu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sw,formatHex:sw,formatHex8:jY,formatRgb:aw,toString:aw}));function sw(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}`}function jY(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}${hi((isNaN(this.opacity)?1:this.opacity)*255)}`}function aw(){const e=fu(this.opacity);return`${e===1?"rgb(":"rgba("}${Si(this.r)}, ${Si(this.g)}, ${Si(this.b)}${e===1?")":`, ${e})`}`}function fu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Si(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hi(e){return e=Si(e),(e<16?"0":"")+e.toString(16)}function nw(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Pa(e,t,r,s)}function QC(e){if(e instanceof Pa)return new Pa(e.h,e.s,e.l,e.opacity);if(e instanceof Dc||(e=nc(e)),!e)return new Pa;if(e instanceof Pa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,n=Math.min(t,r,s),i=Math.max(t,r,s),o=NaN,l=i-n,c=(i+n)/2;return l?(t===i?o=(r-s)/l+(r<s)*6:r===i?o=(s-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+n:2-i-n,o*=60):l=c>0&&c<1?0:o,new Pa(o,l,c,e.opacity)}function wY(e,t,r,s){return arguments.length===1?QC(e):new Pa(e,t,r,s??1)}function Pa(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}Yg(Pa,wY,ZC(Dc,{brighter(e){return e=e==null?mu:Math.pow(mu,e),new Pa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?sc:Math.pow(sc,e),new Pa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,n=2*r-s;return new Ms(ih(e>=240?e-240:e+120,n,s),ih(e,n,s),ih(e<120?e+240:e-120,n,s),this.opacity)},clamp(){return new Pa(iw(this.h),vd(this.s),vd(this.l),fu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fu(this.opacity);return`${e===1?"hsl(":"hsla("}${iw(this.h)}, ${vd(this.s)*100}%, ${vd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iw(e){return e=(e||0)%360,e<0?e+360:e}function vd(e){return Math.max(0,Math.min(1,e||0))}function ih(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Xg=e=>()=>e;function NY(e,t){return function(r){return e+r*t}}function SY(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function EY(e){return(e=+e)==1?eA:function(t,r){return r-t?SY(t,r,e):Xg(isNaN(t)?r:t)}}function eA(e,t){var r=t-e;return r?NY(e,r):Xg(isNaN(e)?t:e)}const ow=(function e(t){var r=EY(t);function s(n,i){var o=r((n=Jp(n)).r,(i=Jp(i)).r),l=r(n.g,i.g),c=r(n.b,i.b),u=eA(n.opacity,i.opacity);return function(d){return n.r=o(d),n.g=l(d),n.b=c(d),n.opacity=u(d),n+""}}return s.gamma=e,s})(1);function TY(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),n;return function(i){for(n=0;n<r;++n)s[n]=e[n]*(1-i)+t[n]*i;return s}}function CY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function AY(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,n=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)n[o]=Ho(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<s;++o)i[o]=n[o](l);return i}}function kY(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function hu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _Y(e,t){var r={},s={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=Ho(e[n],t[n]):s[n]=t[n];return function(i){for(n in r)s[n]=r[n](i);return s}}var Zp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oh=new RegExp(Zp.source,"g");function IY(e){return function(){return e}}function PY(e){return function(t){return e(t)+""}}function DY(e,t){var r=Zp.lastIndex=oh.lastIndex=0,s,n,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(s=Zp.exec(e))&&(n=oh.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(s=s[0])===(n=n[0])?l[o]?l[o]+=n:l[++o]=n:(l[++o]=null,c.push({i:o,x:hu(s,n)})),r=oh.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?PY(c[0].x):IY(t):(t=c.length,function(u){for(var d=0,m;d<t;++d)l[(m=c[d]).i]=m.x(u);return l.join("")})}function Ho(e,t){var r=typeof t,s;return t==null||r==="boolean"?Xg(t):(r==="number"?hu:r==="string"?(s=nc(t))?(t=s,ow):DY:t instanceof nc?ow:t instanceof Date?kY:CY(t)?TY:Array.isArray(t)?AY:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_Y:hu)(e,t)}function Jg(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function OY(e,t){t===void 0&&(t=e,e=Ho);for(var r=0,s=t.length-1,n=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(n,n=t[++r]);return function(o){var l=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[l](o-l)}}function RY(e){return function(){return e}}function pu(e){return+e}var lw=[0,1];function Ps(e){return e}function Qp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:RY(isNaN(t)?NaN:.5)}function FY(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function LY(e,t,r){var s=e[0],n=e[1],i=t[0],o=t[1];return n<s?(s=Qp(n,s),i=r(o,i)):(s=Qp(s,n),i=r(i,o)),function(l){return i(s(l))}}function MY(e,t,r){var s=Math.min(e.length,t.length)-1,n=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)n[o]=Qp(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=Pc(e,l,1,s)-1;return i[c](n[c](l))}}function Oc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function hm(){var e=lw,t=lw,r=Ho,s,n,i,o=Ps,l,c,u;function d(){var f=Math.min(e.length,t.length);return o!==Ps&&(o=FY(e[0],e[f-1])),l=f>2?MY:LY,c=u=null,m}function m(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(s),t,r)))(s(o(f)))}return m.invert=function(f){return o(n((u||(u=l(t,e.map(s),hu)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,pu),d()):e.slice()},m.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},m.rangeRound=function(f){return t=Array.from(f),r=Jg,d()},m.clamp=function(f){return arguments.length?(o=f?!0:Ps,d()):o!==Ps},m.interpolate=function(f){return arguments.length?(r=f,d()):r},m.unknown=function(f){return arguments.length?(i=f,m):i},function(f,h){return s=f,n=h,d()}}function Zg(){return hm()(Ps,Ps)}function BY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function Io(e){return e=xu(Math.abs(e)),e?e[1]:NaN}function zY(e,t){return function(r,s){for(var n=r.length,i=[],o=0,l=e[0],c=0;n>0&&l>0&&(c+l+1>s&&(l=Math.max(1,s-c)),i.push(r.substring(n-=l,n+l)),!((c+=l+1)>s));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function $Y(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var UY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ic(e){if(!(t=UY.exec(e)))throw new Error("invalid format: "+e);var t;return new Qg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ic.prototype=Qg.prototype;function Qg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Qg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function WY(e){e:for(var t=e.length,r=1,s=-1,n;r<t;++r)switch(e[r]){case".":s=n=r;break;case"0":s===0&&(s=r),n=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(n+1):e}var tA;function HY(e,t){var r=xu(e,t);if(!r)return e+"";var s=r[0],n=r[1],i=n-(tA=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+xu(e,Math.max(0,t+i-1))[0]}function cw(e,t){var r=xu(e,t);if(!r)return e+"";var s=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+s:s.length>n+1?s.slice(0,n+1)+"."+s.slice(n+1):s+new Array(n-s.length+2).join("0")}const dw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:BY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>cw(e*100,t),r:cw,s:HY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uw(e){return e}var mw=Array.prototype.map,fw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function VY(e){var t=e.grouping===void 0||e.thousands===void 0?uw:zY(mw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?uw:$Y(mw.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(m){m=ic(m);var f=m.fill,h=m.align,x=m.sign,p=m.symbol,g=m.zero,b=m.width,y=m.comma,j=m.precision,S=m.trim,E=m.type;E==="n"?(y=!0,E="g"):dw[E]||(j===void 0&&(j=12),S=!0,E="g"),(g||f==="0"&&h==="=")&&(g=!0,f="0",h="=");var w=p==="$"?r:p==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",N=p==="$"?s:/[%p]/.test(E)?o:"",C=dw[E],T=/[defgprs%]/.test(E);j=j===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function _(k){var I=w,L=N,D,M,q;if(E==="c")L=C(k)+L,k="";else{k=+k;var Z=k<0||1/k<0;if(k=isNaN(k)?c:C(Math.abs(k),j),S&&(k=WY(k)),Z&&+k==0&&x!=="+"&&(Z=!1),I=(Z?x==="("?x:l:x==="-"||x==="("?"":x)+I,L=(E==="s"?fw[8+tA/3]:"")+L+(Z&&x==="("?")":""),T){for(D=-1,M=k.length;++D<M;)if(q=k.charCodeAt(D),48>q||q>57){L=(q===46?n+k.slice(D+1):k.slice(D))+L,k=k.slice(0,D);break}}}y&&!g&&(k=t(k,1/0));var Q=I.length+k.length+L.length,U=Q<b?new Array(b-Q+1).join(f):"";switch(y&&g&&(k=t(U+k,U.length?b-L.length:1/0),U=""),h){case"<":k=I+k+L+U;break;case"=":k=I+U+k+L;break;case"^":k=U.slice(0,Q=U.length>>1)+I+k+L+U.slice(Q);break;default:k=U+I+k+L;break}return i(k)}return _.toString=function(){return m+""},_}function d(m,f){var h=u((m=ic(m),m.type="f",m)),x=Math.max(-8,Math.min(8,Math.floor(Io(f)/3)))*3,p=Math.pow(10,-x),g=fw[8+x/3];return function(b){return h(p*b)+g}}return{format:u,formatPrefix:d}}var bd,ev,rA;GY({thousands:",",grouping:[3],currency:["$",""]});function GY(e){return bd=VY(e),ev=bd.format,rA=bd.formatPrefix,bd}function qY(e){return Math.max(0,-Io(Math.abs(e)))}function KY(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Io(t)/3)))*3-Io(Math.abs(e)))}function YY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Io(t)-Io(e))+1}function sA(e,t,r,s){var n=Yp(e,t,r),i;switch(s=ic(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=KY(n,o))&&(s.precision=i),rA(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=YY(n,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=qY(n))&&(s.precision=i-(s.type==="%")*2);break}}return ev(s)}function Zn(e){var t=e.domain;return e.ticks=function(r){var s=t();return qp(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var n=t();return sA(n[0],n[n.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),n=0,i=s.length-1,o=s[n],l=s[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=n,n=i,i=u);d-- >0;){if(u=Kp(o,l,r),u===c)return s[n]=o,s[i]=l,t(s);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function aA(){var e=Zg();return e.copy=function(){return Oc(e,aA())},Ca.apply(e,arguments),Zn(e)}function nA(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,pu),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return nA(e).unknown(t)},e=arguments.length?Array.from(e,pu):[0,1],Zn(r)}function iA(e,t){e=e.slice();var r=0,s=e.length-1,n=e[r],i=e[s],o;return i<n&&(o=r,r=s,s=o,o=n,n=i,i=o),e[r]=t.floor(n),e[s]=t.ceil(i),e}function hw(e){return Math.log(e)}function pw(e){return Math.exp(e)}function XY(e){return-Math.log(-e)}function JY(e){return-Math.exp(-e)}function ZY(e){return isFinite(e)?+("1e"+e):e<0?0:e}function QY(e){return e===10?ZY:e===Math.E?Math.exp:t=>Math.pow(e,t)}function eX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function xw(e){return(t,r)=>-e(-t,r)}function tv(e){const t=e(hw,pw),r=t.domain;let s=10,n,i;function o(){return n=eX(s),i=QY(s),r()[0]<0?(n=xw(n),i=xw(i),e(XY,JY)):e(hw,pw),t}return t.base=function(l){return arguments.length?(s=+l,o()):s},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const m=d<u;m&&([u,d]=[d,u]);let f=n(u),h=n(d),x,p;const g=l==null?10:+l;let b=[];if(!(s%1)&&h-f<g){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(x=1;x<s;++x)if(p=f<0?x/i(-f):x*i(f),!(p<u)){if(p>d)break;b.push(p)}}else for(;f<=h;++f)for(x=s-1;x>=1;--x)if(p=f>0?x/i(-f):x*i(f),!(p<u)){if(p>d)break;b.push(p)}b.length*2<g&&(b=qp(u,d,g))}else b=qp(f,h,Math.min(h-f,g)).map(i);return m?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=ic(c)).precision==null&&(c.trim=!0),c=ev(c)),l===1/0)return c;const u=Math.max(1,s*l/t.ticks().length);return d=>{let m=d/i(Math.round(n(d)));return m*s<s-.5&&(m*=s),m<=u?c(d):""}},t.nice=()=>r(iA(r(),{floor:l=>i(Math.floor(n(l))),ceil:l=>i(Math.ceil(n(l)))})),t}function oA(){const e=tv(hm()).domain([1,10]);return e.copy=()=>Oc(e,oA()).base(e.base()),Ca.apply(e,arguments),e}function gw(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vw(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function rv(e){var t=1,r=e(gw(t),vw(t));return r.constant=function(s){return arguments.length?e(gw(t=+s),vw(t)):t},Zn(r)}function lA(){var e=rv(hm());return e.copy=function(){return Oc(e,lA()).constant(e.constant())},Ca.apply(e,arguments)}function bw(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rX(e){return e<0?-e*e:e*e}function sv(e){var t=e(Ps,Ps),r=1;function s(){return r===1?e(Ps,Ps):r===.5?e(tX,rX):e(bw(r),bw(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,s()):r},Zn(t)}function av(){var e=sv(hm());return e.copy=function(){return Oc(e,av()).exponent(e.exponent())},Ca.apply(e,arguments),e}function sX(){return av.apply(null,arguments).exponent(.5)}function yw(e){return Math.sign(e)*e*e}function aX(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function cA(){var e=Zg(),t=[0,1],r=!1,s;function n(i){var o=aX(e(i));return isNaN(o)?s:r?Math.round(o):o}return n.invert=function(i){return e.invert(yw(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,pu)).map(yw)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return cA(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},Ca.apply(n,arguments),Zn(n)}function dA(){var e=[],t=[],r=[],s;function n(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=lY(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?s:t[Pc(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Bn),n()},i.range=function(o){return arguments.length?(t=Array.from(o),n()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return dA().domain(e).range(t).unknown(s)},Ca.apply(i,arguments)}function uA(){var e=0,t=1,r=1,s=[.5],n=[0,1],i;function o(c){return c!=null&&c<=c?n[Pc(s,c,0,r)]:i}function l(){var c=-1;for(s=new Array(r);++c<r;)s[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,l()):n.slice()},o.invertExtent=function(c){var u=n.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,s[0]]:u>=r?[s[r-1],t]:[s[u-1],s[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return s.slice()},o.copy=function(){return uA().domain([e,t]).range(n).unknown(i)},Ca.apply(Zn(o),arguments)}function mA(){var e=[.5],t=[0,1],r,s=1;function n(i){return i!=null&&i<=i?t[Pc(e,i,0,s)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return mA().domain(e).range(t).unknown(r)},Ca.apply(n,arguments)}const lh=new Date,ch=new Date;function Gr(e,t,r,s){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const o=n(i),l=n.ceil(i);return i-o<l-i?o:l},n.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),n.range=(i,o,l)=>{const c=[];if(i=n.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<o);return c},n.filter=i=>Gr(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(n.count=(i,o)=>(lh.setTime(+i),ch.setTime(+o),e(lh),e(ch),Math.floor(r(lh,ch))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(s?o=>s(o)%i===0:o=>n.count(0,o)%i===0):n)),n}const gu=Gr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);gu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Gr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):gu);gu.range;const an=1e3,ya=an*60,nn=ya*60,gn=nn*24,nv=gn*7,jw=gn*30,dh=gn*365,pi=Gr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*an)},(e,t)=>(t-e)/an,e=>e.getUTCSeconds());pi.range;const iv=Gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*an)},(e,t)=>{e.setTime(+e+t*ya)},(e,t)=>(t-e)/ya,e=>e.getMinutes());iv.range;const ov=Gr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ya)},(e,t)=>(t-e)/ya,e=>e.getUTCMinutes());ov.range;const lv=Gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*an-e.getMinutes()*ya)},(e,t)=>{e.setTime(+e+t*nn)},(e,t)=>(t-e)/nn,e=>e.getHours());lv.range;const cv=Gr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*nn)},(e,t)=>(t-e)/nn,e=>e.getUTCHours());cv.range;const Rc=Gr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ya)/gn,e=>e.getDate()-1);Rc.range;const pm=Gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gn,e=>e.getUTCDate()-1);pm.range;const fA=Gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gn,e=>Math.floor(e/gn));fA.range;function Zi(e){return Gr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ya)/nv)}const xm=Zi(0),vu=Zi(1),nX=Zi(2),iX=Zi(3),Po=Zi(4),oX=Zi(5),lX=Zi(6);xm.range;vu.range;nX.range;iX.range;Po.range;oX.range;lX.range;function Qi(e){return Gr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/nv)}const gm=Qi(0),bu=Qi(1),cX=Qi(2),dX=Qi(3),Do=Qi(4),uX=Qi(5),mX=Qi(6);gm.range;bu.range;cX.range;dX.range;Do.range;uX.range;mX.range;const dv=Gr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());dv.range;const uv=Gr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());uv.range;const vn=Gr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());vn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});vn.range;const bn=Gr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());bn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});bn.range;function hA(e,t,r,s,n,i){const o=[[pi,1,an],[pi,5,5*an],[pi,15,15*an],[pi,30,30*an],[i,1,ya],[i,5,5*ya],[i,15,15*ya],[i,30,30*ya],[n,1,nn],[n,3,3*nn],[n,6,6*nn],[n,12,12*nn],[s,1,gn],[s,2,2*gn],[r,1,nv],[t,1,jw],[t,3,3*jw],[e,1,dh]];function l(u,d,m){const f=d<u;f&&([u,d]=[d,u]);const h=m&&typeof m.range=="function"?m:c(u,d,m),x=h?h.range(u,+d+1):[];return f?x.reverse():x}function c(u,d,m){const f=Math.abs(d-u)/m,h=Gg(([,,g])=>g).right(o,f);if(h===o.length)return e.every(Yp(u/dh,d/dh,m));if(h===0)return gu.every(Math.max(Yp(u,d,m),1));const[x,p]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return x.every(p)}return[l,c]}const[fX,hX]=hA(bn,uv,gm,fA,cv,ov),[pX,xX]=hA(vn,dv,xm,Rc,lv,iv);function uh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function mh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ul(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function gX(e){var t=e.dateTime,r=e.date,s=e.time,n=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=ml(n),d=fl(n),m=ml(i),f=fl(i),h=ml(o),x=fl(o),p=ml(l),g=fl(l),b=ml(c),y=fl(c),j={a:Z,A:Q,b:U,B:le,c:null,d:Cw,e:Cw,f:zX,g:XX,G:ZX,H:LX,I:MX,j:BX,L:pA,m:$X,M:UX,p:Se,q:P,Q:_w,s:Iw,S:WX,u:HX,U:VX,V:GX,w:qX,W:KX,x:null,X:null,y:YX,Y:JX,Z:QX,"%":kw},S={a:G,A:K,b:O,B:F,c:null,d:Aw,e:Aw,f:sJ,g:fJ,G:pJ,H:eJ,I:tJ,j:rJ,L:gA,m:aJ,M:nJ,p:H,q:Y,Q:_w,s:Iw,S:iJ,u:oJ,U:lJ,V:cJ,w:dJ,W:uJ,x:null,X:null,y:mJ,Y:hJ,Z:xJ,"%":kw},E={a:_,A:k,b:I,B:L,c:D,d:Ew,e:Ew,f:DX,g:Sw,G:Nw,H:Tw,I:Tw,j:kX,L:PX,m:AX,M:_X,p:T,q:CX,Q:RX,s:FX,S:IX,u:wX,U:NX,V:SX,w:jX,W:EX,x:M,X:q,y:Sw,Y:Nw,Z:TX,"%":OX};j.x=w(r,j),j.X=w(s,j),j.c=w(t,j),S.x=w(r,S),S.X=w(s,S),S.c=w(t,S);function w(te,pe){return function(we){var B=[],Be=-1,fe=0,oe=te.length,ge,ue,Ie;for(we instanceof Date||(we=new Date(+we));++Be<oe;)te.charCodeAt(Be)===37&&(B.push(te.slice(fe,Be)),(ue=ww[ge=te.charAt(++Be)])!=null?ge=te.charAt(++Be):ue=ge==="e"?" ":"0",(Ie=pe[ge])&&(ge=Ie(we,ue)),B.push(ge),fe=Be+1);return B.push(te.slice(fe,Be)),B.join("")}}function N(te,pe){return function(we){var B=ul(1900,void 0,1),Be=C(B,te,we+="",0),fe,oe;if(Be!=we.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(pe&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(fe=mh(ul(B.y,0,1)),oe=fe.getUTCDay(),fe=oe>4||oe===0?bu.ceil(fe):bu(fe),fe=pm.offset(fe,(B.V-1)*7),B.y=fe.getUTCFullYear(),B.m=fe.getUTCMonth(),B.d=fe.getUTCDate()+(B.w+6)%7):(fe=uh(ul(B.y,0,1)),oe=fe.getDay(),fe=oe>4||oe===0?vu.ceil(fe):vu(fe),fe=Rc.offset(fe,(B.V-1)*7),B.y=fe.getFullYear(),B.m=fe.getMonth(),B.d=fe.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),oe="Z"in B?mh(ul(B.y,0,1)).getUTCDay():uh(ul(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(oe+5)%7:B.w+B.U*7-(oe+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,mh(B)):uh(B)}}function C(te,pe,we,B){for(var Be=0,fe=pe.length,oe=we.length,ge,ue;Be<fe;){if(B>=oe)return-1;if(ge=pe.charCodeAt(Be++),ge===37){if(ge=pe.charAt(Be++),ue=E[ge in ww?pe.charAt(Be++):ge],!ue||(B=ue(te,we,B))<0)return-1}else if(ge!=we.charCodeAt(B++))return-1}return B}function T(te,pe,we){var B=u.exec(pe.slice(we));return B?(te.p=d.get(B[0].toLowerCase()),we+B[0].length):-1}function _(te,pe,we){var B=h.exec(pe.slice(we));return B?(te.w=x.get(B[0].toLowerCase()),we+B[0].length):-1}function k(te,pe,we){var B=m.exec(pe.slice(we));return B?(te.w=f.get(B[0].toLowerCase()),we+B[0].length):-1}function I(te,pe,we){var B=b.exec(pe.slice(we));return B?(te.m=y.get(B[0].toLowerCase()),we+B[0].length):-1}function L(te,pe,we){var B=p.exec(pe.slice(we));return B?(te.m=g.get(B[0].toLowerCase()),we+B[0].length):-1}function D(te,pe,we){return C(te,t,pe,we)}function M(te,pe,we){return C(te,r,pe,we)}function q(te,pe,we){return C(te,s,pe,we)}function Z(te){return o[te.getDay()]}function Q(te){return i[te.getDay()]}function U(te){return c[te.getMonth()]}function le(te){return l[te.getMonth()]}function Se(te){return n[+(te.getHours()>=12)]}function P(te){return 1+~~(te.getMonth()/3)}function G(te){return o[te.getUTCDay()]}function K(te){return i[te.getUTCDay()]}function O(te){return c[te.getUTCMonth()]}function F(te){return l[te.getUTCMonth()]}function H(te){return n[+(te.getUTCHours()>=12)]}function Y(te){return 1+~~(te.getUTCMonth()/3)}return{format:function(te){var pe=w(te+="",j);return pe.toString=function(){return te},pe},parse:function(te){var pe=N(te+="",!1);return pe.toString=function(){return te},pe},utcFormat:function(te){var pe=w(te+="",S);return pe.toString=function(){return te},pe},utcParse:function(te){var pe=N(te+="",!0);return pe.toString=function(){return te},pe}}}var ww={"-":"",_:" ",0:"0"},ss=/^\s*\d+/,vX=/^%/,bX=/[\\^$*+?|[\]().{}]/g;function Wt(e,t,r){var s=e<0?"-":"",n=(s?-e:e)+"",i=n.length;return s+(i<r?new Array(r-i+1).join(t)+n:n)}function yX(e){return e.replace(bX,"\\$&")}function ml(e){return new RegExp("^(?:"+e.map(yX).join("|")+")","i")}function fl(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function jX(e,t,r){var s=ss.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function wX(e,t,r){var s=ss.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function NX(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function SX(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function EX(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function Nw(e,t,r){var s=ss.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function Sw(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function TX(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function CX(e,t,r){var s=ss.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function AX(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function Ew(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function kX(e,t,r){var s=ss.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function Tw(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function _X(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function IX(e,t,r){var s=ss.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function PX(e,t,r){var s=ss.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function DX(e,t,r){var s=ss.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function OX(e,t,r){var s=vX.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function RX(e,t,r){var s=ss.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function FX(e,t,r){var s=ss.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function Cw(e,t){return Wt(e.getDate(),t,2)}function LX(e,t){return Wt(e.getHours(),t,2)}function MX(e,t){return Wt(e.getHours()%12||12,t,2)}function BX(e,t){return Wt(1+Rc.count(vn(e),e),t,3)}function pA(e,t){return Wt(e.getMilliseconds(),t,3)}function zX(e,t){return pA(e,t)+"000"}function $X(e,t){return Wt(e.getMonth()+1,t,2)}function UX(e,t){return Wt(e.getMinutes(),t,2)}function WX(e,t){return Wt(e.getSeconds(),t,2)}function HX(e){var t=e.getDay();return t===0?7:t}function VX(e,t){return Wt(xm.count(vn(e)-1,e),t,2)}function xA(e){var t=e.getDay();return t>=4||t===0?Po(e):Po.ceil(e)}function GX(e,t){return e=xA(e),Wt(Po.count(vn(e),e)+(vn(e).getDay()===4),t,2)}function qX(e){return e.getDay()}function KX(e,t){return Wt(vu.count(vn(e)-1,e),t,2)}function YX(e,t){return Wt(e.getFullYear()%100,t,2)}function XX(e,t){return e=xA(e),Wt(e.getFullYear()%100,t,2)}function JX(e,t){return Wt(e.getFullYear()%1e4,t,4)}function ZX(e,t){var r=e.getDay();return e=r>=4||r===0?Po(e):Po.ceil(e),Wt(e.getFullYear()%1e4,t,4)}function QX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Wt(t/60|0,"0",2)+Wt(t%60,"0",2)}function Aw(e,t){return Wt(e.getUTCDate(),t,2)}function eJ(e,t){return Wt(e.getUTCHours(),t,2)}function tJ(e,t){return Wt(e.getUTCHours()%12||12,t,2)}function rJ(e,t){return Wt(1+pm.count(bn(e),e),t,3)}function gA(e,t){return Wt(e.getUTCMilliseconds(),t,3)}function sJ(e,t){return gA(e,t)+"000"}function aJ(e,t){return Wt(e.getUTCMonth()+1,t,2)}function nJ(e,t){return Wt(e.getUTCMinutes(),t,2)}function iJ(e,t){return Wt(e.getUTCSeconds(),t,2)}function oJ(e){var t=e.getUTCDay();return t===0?7:t}function lJ(e,t){return Wt(gm.count(bn(e)-1,e),t,2)}function vA(e){var t=e.getUTCDay();return t>=4||t===0?Do(e):Do.ceil(e)}function cJ(e,t){return e=vA(e),Wt(Do.count(bn(e),e)+(bn(e).getUTCDay()===4),t,2)}function dJ(e){return e.getUTCDay()}function uJ(e,t){return Wt(bu.count(bn(e)-1,e),t,2)}function mJ(e,t){return Wt(e.getUTCFullYear()%100,t,2)}function fJ(e,t){return e=vA(e),Wt(e.getUTCFullYear()%100,t,2)}function hJ(e,t){return Wt(e.getUTCFullYear()%1e4,t,4)}function pJ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Do(e):Do.ceil(e),Wt(e.getUTCFullYear()%1e4,t,4)}function xJ(){return"+0000"}function kw(){return"%"}function _w(e){return+e}function Iw(e){return Math.floor(+e/1e3)}var io,bA,yA;gJ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gJ(e){return io=gX(e),bA=io.format,io.parse,yA=io.utcFormat,io.utcParse,io}function vJ(e){return new Date(e)}function bJ(e){return e instanceof Date?+e:+new Date(+e)}function mv(e,t,r,s,n,i,o,l,c,u){var d=Zg(),m=d.invert,f=d.domain,h=u(".%L"),x=u(":%S"),p=u("%I:%M"),g=u("%I %p"),b=u("%a %d"),y=u("%b %d"),j=u("%B"),S=u("%Y");function E(w){return(c(w)<w?h:l(w)<w?x:o(w)<w?p:i(w)<w?g:s(w)<w?n(w)<w?b:y:r(w)<w?j:S)(w)}return d.invert=function(w){return new Date(m(w))},d.domain=function(w){return arguments.length?f(Array.from(w,bJ)):f().map(vJ)},d.ticks=function(w){var N=f();return e(N[0],N[N.length-1],w??10)},d.tickFormat=function(w,N){return N==null?E:u(N)},d.nice=function(w){var N=f();return(!w||typeof w.range!="function")&&(w=t(N[0],N[N.length-1],w??10)),w?f(iA(N,w)):d},d.copy=function(){return Oc(d,mv(e,t,r,s,n,i,o,l,c,u))},d}function yJ(){return Ca.apply(mv(pX,xX,vn,dv,xm,Rc,lv,iv,pi,bA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function jJ(){return Ca.apply(mv(fX,hX,bn,uv,gm,pm,cv,ov,pi,yA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vm(){var e=0,t=1,r,s,n,i,o=Ps,l=!1,c;function u(m){return m==null||isNaN(m=+m)?c:o(n===0?.5:(m=(i(m)-r)*n,l?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),s=i(t=+t),n=r===s?0:1/(s-r),u):[e,t]},u.clamp=function(m){return arguments.length?(l=!!m,u):l},u.interpolator=function(m){return arguments.length?(o=m,u):o};function d(m){return function(f){var h,x;return arguments.length?([h,x]=f,o=m(h,x),u):[o(0),o(1)]}}return u.range=d(Ho),u.rangeRound=d(Jg),u.unknown=function(m){return arguments.length?(c=m,u):c},function(m){return i=m,r=m(e),s=m(t),n=r===s?0:1/(s-r),u}}function Qn(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function jA(){var e=Zn(vm()(Ps));return e.copy=function(){return Qn(e,jA())},En.apply(e,arguments)}function wA(){var e=tv(vm()).domain([1,10]);return e.copy=function(){return Qn(e,wA()).base(e.base())},En.apply(e,arguments)}function NA(){var e=rv(vm());return e.copy=function(){return Qn(e,NA()).constant(e.constant())},En.apply(e,arguments)}function fv(){var e=sv(vm());return e.copy=function(){return Qn(e,fv()).exponent(e.exponent())},En.apply(e,arguments)}function wJ(){return fv.apply(null,arguments).exponent(.5)}function SA(){var e=[],t=Ps;function r(s){if(s!=null&&!isNaN(s=+s))return t((Pc(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let n of s)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(Bn),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,n)=>t(n/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(n,i)=>oY(e,i/s))},r.copy=function(){return SA(t).domain(e)},En.apply(r,arguments)}function bm(){var e=0,t=.5,r=1,s=1,n,i,o,l,c,u=Ps,d,m=!1,f;function h(p){return isNaN(p=+p)?f:(p=.5+((p=+d(p))-i)*(s*p<s*i?l:c),u(m?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,r]=p,n=d(e=+e),i=d(t=+t),o=d(r=+r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),s=i<n?-1:1,h):[e,t,r]},h.clamp=function(p){return arguments.length?(m=!!p,h):m},h.interpolator=function(p){return arguments.length?(u=p,h):u};function x(p){return function(g){var b,y,j;return arguments.length?([b,y,j]=g,u=OY(p,[b,y,j]),h):[u(0),u(.5),u(1)]}}return h.range=x(Ho),h.rangeRound=x(Jg),h.unknown=function(p){return arguments.length?(f=p,h):f},function(p){return d=p,n=p(e),i=p(t),o=p(r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),s=i<n?-1:1,h}}function EA(){var e=Zn(bm()(Ps));return e.copy=function(){return Qn(e,EA())},En.apply(e,arguments)}function TA(){var e=tv(bm()).domain([.1,1,10]);return e.copy=function(){return Qn(e,TA()).base(e.base())},En.apply(e,arguments)}function CA(){var e=rv(bm());return e.copy=function(){return Qn(e,CA()).constant(e.constant())},En.apply(e,arguments)}function hv(){var e=sv(bm());return e.copy=function(){return Qn(e,hv()).exponent(e.exponent())},En.apply(e,arguments)}function NJ(){return hv.apply(null,arguments).exponent(.5)}const yl=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Kg,scaleDiverging:EA,scaleDivergingLog:TA,scaleDivergingPow:hv,scaleDivergingSqrt:NJ,scaleDivergingSymlog:CA,scaleIdentity:nA,scaleImplicit:Xp,scaleLinear:aA,scaleLog:oA,scaleOrdinal:qg,scalePoint:dY,scalePow:av,scaleQuantile:dA,scaleQuantize:uA,scaleRadial:cA,scaleSequential:jA,scaleSequentialLog:wA,scaleSequentialPow:fv,scaleSequentialQuantile:SA,scaleSequentialSqrt:wJ,scaleSequentialSymlog:NA,scaleSqrt:sX,scaleSymlog:lA,scaleThreshold:mA,scaleTime:yJ,scaleUtc:jJ,tickFormat:sA},Symbol.toStringTag,{value:"Module"}));var ei=e=>e.chartData,pv=je([ei],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),xv=(e,t,r,s)=>s?pv(e):ei(e);function Oo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(aa(t)&&aa(r))return!0}return!1}function Pw(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function SJ(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,s]=e,n,i;if(aa(r))n=r;else if(typeof r=="function")return;if(aa(s))i=s;else if(typeof s=="function")return;var o=[n,i];if(Oo(o))return o}}function EJ(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,r);if(Oo(s))return Pw(s,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,o,l;if(n==="auto")t!=null&&(o=Math.min(...t));else if(ut(n))o=n;else if(typeof n=="function")try{t!=null&&(o=n(t?.[0]))}catch{}else if(typeof n=="string"&&wj.test(n)){var c=wj.exec(n);if(c==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(ut(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&Nj.test(i)){var d=Nj.exec(i);if(d==null||t==null)l=void 0;else{var m=+d[1];l=t[1]+m}}else l=t?.[1];var f=[o,l];if(Oo(f))return t==null?f:Pw(f,t,r)}}}var Vo=1e9,TJ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vv,mr=!0,Sa="[DecimalError] ",Ei=Sa+"Invalid argument: ",gv=Sa+"Exponent out of range: ",Go=Math.floor,li=Math.pow,CJ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zs,Yr=1e7,ir=7,AA=9007199254740991,yu=Go(AA/ir),rt={};rt.absoluteValue=rt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};rt.comparedTo=rt.cmp=function(e){var t,r,s,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,n=e.d.length,t=0,r=s<n?s:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===n?0:s>n^i.s<0?1:-1};rt.decimalPlaces=rt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ir;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};rt.dividedBy=rt.div=function(e){return un(this,new this.constructor(e))};rt.dividedToIntegerBy=rt.idiv=function(e){var t=this,r=t.constructor;return sr(un(t,new r(e),0,1),r.precision)};rt.equals=rt.eq=function(e){return!this.cmp(e)};rt.exponent=function(){return Mr(this)};rt.greaterThan=rt.gt=function(e){return this.cmp(e)>0};rt.greaterThanOrEqualTo=rt.gte=function(e){return this.cmp(e)>=0};rt.isInteger=rt.isint=function(){return this.e>this.d.length-2};rt.isNegative=rt.isneg=function(){return this.s<0};rt.isPositive=rt.ispos=function(){return this.s>0};rt.isZero=function(){return this.s===0};rt.lessThan=rt.lt=function(e){return this.cmp(e)<0};rt.lessThanOrEqualTo=rt.lte=function(e){return this.cmp(e)<1};rt.logarithm=rt.log=function(e){var t,r=this,s=r.constructor,n=s.precision,i=n+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(Zs))throw Error(Sa+"NaN");if(r.s<1)throw Error(Sa+(r.s?"NaN":"-Infinity"));return r.eq(Zs)?new s(0):(mr=!1,t=un(oc(r,i),oc(e,i),i),mr=!0,sr(t,n))};rt.minus=rt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?IA(t,e):kA(t,(e.s=-e.s,e))};rt.modulo=rt.mod=function(e){var t,r=this,s=r.constructor,n=s.precision;if(e=new s(e),!e.s)throw Error(Sa+"NaN");return r.s?(mr=!1,t=un(r,e,0,1).times(e),mr=!0,r.minus(t)):sr(new s(r),n)};rt.naturalExponential=rt.exp=function(){return _A(this)};rt.naturalLogarithm=rt.ln=function(){return oc(this)};rt.negated=rt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};rt.plus=rt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?kA(t,e):IA(t,(e.s=-e.s,e))};rt.precision=rt.sd=function(e){var t,r,s,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ei+e);if(t=Mr(n)+1,s=n.d.length-1,r=s*ir+1,s=n.d[s],s){for(;s%10==0;s/=10)r--;for(s=n.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};rt.squareRoot=rt.sqrt=function(){var e,t,r,s,n,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Sa+"NaN")}for(e=Mr(l),mr=!1,n=Math.sqrt(+l),n==0||n==1/0?(t=Ga(l.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=Go((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new c(t)):s=new c(n.toString()),r=c.precision,n=o=r+3;;)if(i=s,s=i.plus(un(l,i,o+2)).times(.5),Ga(i.d).slice(0,o)===(t=Ga(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),n==o&&t=="4999"){if(sr(i,r+1,0),i.times(i).eq(l)){s=i;break}}else if(t!="9999")break;o+=4}return mr=!0,sr(s,r)};rt.times=rt.mul=function(e){var t,r,s,n,i,o,l,c,u,d=this,m=d.constructor,f=d.d,h=(e=new m(e)).d;if(!d.s||!e.s)return new m(0);for(e.s*=d.s,r=d.e+e.e,c=f.length,u=h.length,c<u&&(i=f,f=h,h=i,o=c,c=u,u=o),i=[],o=c+u,s=o;s--;)i.push(0);for(s=u;--s>=0;){for(t=0,n=c+s;n>s;)l=i[n]+h[s]*f[n-s-1]+t,i[n--]=l%Yr|0,t=l/Yr|0;i[n]=(i[n]+t)%Yr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,mr?sr(e,m.precision):e};rt.toDecimalPlaces=rt.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(Ja(e,0,Vo),t===void 0?t=s.rounding:Ja(t,0,8),sr(r,e+Mr(r)+1,t))};rt.toExponential=function(e,t){var r,s=this,n=s.constructor;return e===void 0?r=Mi(s,!0):(Ja(e,0,Vo),t===void 0?t=n.rounding:Ja(t,0,8),s=sr(new n(s),e+1,t),r=Mi(s,!0,e+1)),r};rt.toFixed=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?Mi(n):(Ja(e,0,Vo),t===void 0?t=i.rounding:Ja(t,0,8),s=sr(new i(n),e+Mr(n)+1,t),r=Mi(s.abs(),!1,e+Mr(s)+1),n.isneg()&&!n.isZero()?"-"+r:r)};rt.toInteger=rt.toint=function(){var e=this,t=e.constructor;return sr(new t(e),Mr(e)+1,t.rounding)};rt.toNumber=function(){return+this};rt.toPower=rt.pow=function(e){var t,r,s,n,i,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Zs);if(l=new c(l),!l.s){if(e.s<1)throw Error(Sa+"Infinity");return l}if(l.eq(Zs))return l;if(s=c.precision,e.eq(Zs))return sr(l,s);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=d<0?-d:d)<=AA){for(n=new c(Zs),t=Math.ceil(s/ir+4),mr=!1;r%2&&(n=n.times(l),Ow(n.d,t)),r=Go(r/2),r!==0;)l=l.times(l),Ow(l.d,t);return mr=!0,e.s<0?new c(Zs).div(n):sr(n,s)}}else if(i<0)throw Error(Sa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,mr=!1,n=e.times(oc(l,s+u)),mr=!0,n=_A(n),n.s=i,n};rt.toPrecision=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?(r=Mr(n),s=Mi(n,r<=i.toExpNeg||r>=i.toExpPos)):(Ja(e,1,Vo),t===void 0?t=i.rounding:Ja(t,0,8),n=sr(new i(n),e,t),r=Mr(n),s=Mi(n,e<=r||r<=i.toExpNeg,e)),s};rt.toSignificantDigits=rt.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(Ja(e,1,Vo),t===void 0?t=s.rounding:Ja(t,0,8)),sr(new s(r),e,t)};rt.toString=rt.valueOf=rt.val=rt.toJSON=rt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Mr(e),r=e.constructor;return Mi(e,t<=r.toExpNeg||t>=r.toExpPos)};function kA(e,t){var r,s,n,i,o,l,c,u,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),mr?sr(t,m):t;if(c=e.d,u=t.d,o=e.e,n=t.e,c=c.slice(),i=o-n,i){for(i<0?(s=c,i=-i,l=u.length):(s=u,n=o,l=c.length),o=Math.ceil(m/ir),l=o>l?o+1:l+1,i>l&&(i=l,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,s=u,u=c,c=s),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/Yr|0,c[i]%=Yr;for(r&&(c.unshift(r),++n),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=n,mr?sr(t,m):t}function Ja(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ei+e)}function Ga(e){var t,r,s,n=e.length-1,i="",o=e[0];if(n>0){for(i+=o,t=1;t<n;t++)s=e[t]+"",r=ir-s.length,r&&(i+=Pn(r)),i+=s;o=e[t],s=o+"",r=ir-s.length,r&&(i+=Pn(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var un=(function(){function e(s,n){var i,o=0,l=s.length;for(s=s.slice();l--;)i=s[l]*n+o,s[l]=i%Yr|0,o=i/Yr|0;return o&&s.unshift(o),s}function t(s,n,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(s[l]!=n[l]){c=s[l]>n[l]?1:-1;break}return c}function r(s,n,i){for(var o=0;i--;)s[i]-=o,o=s[i]<n[i]?1:0,s[i]=o*Yr+s[i]-n[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,n,i,o){var l,c,u,d,m,f,h,x,p,g,b,y,j,S,E,w,N,C,T=s.constructor,_=s.s==n.s?1:-1,k=s.d,I=n.d;if(!s.s)return new T(s);if(!n.s)throw Error(Sa+"Division by zero");for(c=s.e-n.e,N=I.length,E=k.length,h=new T(_),x=h.d=[],u=0;I[u]==(k[u]||0);)++u;if(I[u]>(k[u]||0)&&--c,i==null?y=i=T.precision:o?y=i+(Mr(s)-Mr(n))+1:y=i,y<0)return new T(0);if(y=y/ir+2|0,u=0,N==1)for(d=0,I=I[0],y++;(u<E||d)&&y--;u++)j=d*Yr+(k[u]||0),x[u]=j/I|0,d=j%I|0;else{for(d=Yr/(I[0]+1)|0,d>1&&(I=e(I,d),k=e(k,d),N=I.length,E=k.length),S=N,p=k.slice(0,N),g=p.length;g<N;)p[g++]=0;C=I.slice(),C.unshift(0),w=I[0],I[1]>=Yr/2&&++w;do d=0,l=t(I,p,N,g),l<0?(b=p[0],N!=g&&(b=b*Yr+(p[1]||0)),d=b/w|0,d>1?(d>=Yr&&(d=Yr-1),m=e(I,d),f=m.length,g=p.length,l=t(m,p,f,g),l==1&&(d--,r(m,N<f?C:I,f))):(d==0&&(l=d=1),m=I.slice()),f=m.length,f<g&&m.unshift(0),r(p,m,g),l==-1&&(g=p.length,l=t(I,p,N,g),l<1&&(d++,r(p,N<g?C:I,g))),g=p.length):l===0&&(d++,p=[0]),x[u++]=d,l&&p[0]?p[g++]=k[S]||0:(p=[k[S]],g=1);while((S++<E||p[0]!==void 0)&&y--)}return x[0]||x.shift(),h.e=c,sr(h,o?i+Mr(h)+1:i)}})();function _A(e,t){var r,s,n,i,o,l,c=0,u=0,d=e.constructor,m=d.precision;if(Mr(e)>16)throw Error(gv+Mr(e));if(!e.s)return new d(Zs);for(mr=!1,l=m,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(s=Math.log(li(2,u))/Math.LN10*2+5|0,l+=s,r=n=i=new d(Zs),d.precision=l;;){if(n=sr(n.times(e),l),r=r.times(++c),o=i.plus(un(n,r,l)),Ga(o.d).slice(0,l)===Ga(i.d).slice(0,l)){for(;u--;)i=sr(i.times(i),l);return d.precision=m,t==null?(mr=!0,sr(i,m)):i}i=o}}function Mr(e){for(var t=e.e*ir,r=e.d[0];r>=10;r/=10)t++;return t}function fh(e,t,r){if(t>e.LN10.sd())throw mr=!0,r&&(e.precision=r),Error(Sa+"LN10 precision limit exceeded");return sr(new e(e.LN10),t)}function Pn(e){for(var t="";e--;)t+="0";return t}function oc(e,t){var r,s,n,i,o,l,c,u,d,m=1,f=10,h=e,x=h.d,p=h.constructor,g=p.precision;if(h.s<1)throw Error(Sa+(h.s?"NaN":"-Infinity"));if(h.eq(Zs))return new p(0);if(t==null?(mr=!1,u=g):u=t,h.eq(10))return t==null&&(mr=!0),fh(p,u);if(u+=f,p.precision=u,r=Ga(x),s=r.charAt(0),i=Mr(h),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)h=h.times(e),r=Ga(h.d),s=r.charAt(0),m++;i=Mr(h),s>1?(h=new p("0."+r),i++):h=new p(s+"."+r.slice(1))}else return c=fh(p,u+2,g).times(i+""),h=oc(new p(s+"."+r.slice(1)),u-f).plus(c),p.precision=g,t==null?(mr=!0,sr(h,g)):h;for(l=o=h=un(h.minus(Zs),h.plus(Zs),u),d=sr(h.times(h),u),n=3;;){if(o=sr(o.times(d),u),c=l.plus(un(o,new p(n),u)),Ga(c.d).slice(0,u)===Ga(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(fh(p,u+2,g).times(i+""))),l=un(l,new p(m),u),p.precision=g,t==null?(mr=!0,sr(l,g)):l;l=c,n+=2}}function Dw(e,t){var r,s,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(s,n),t){if(n-=s,r=r-s-1,e.e=Go(r/ir),e.d=[],s=(r+1)%ir,r<0&&(s+=ir),s<n){for(s&&e.d.push(+t.slice(0,s)),n-=ir;s<n;)e.d.push(+t.slice(s,s+=ir));t=t.slice(s),s=ir-t.length}else s-=n;for(;s--;)t+="0";if(e.d.push(+t),mr&&(e.e>yu||e.e<-yu))throw Error(gv+r)}else e.s=0,e.e=0,e.d=[0];return e}function sr(e,t,r){var s,n,i,o,l,c,u,d,m=e.d;for(o=1,i=m[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=ir,n=t,u=m[d=0];else{if(d=Math.ceil((s+1)/ir),i=m.length,d>=i)return e;for(u=i=m[d],o=1;i>=10;i/=10)o++;s%=ir,n=s-ir+o}if(r!==void 0&&(i=li(10,o-n-1),l=u/i%10|0,c=t<0||m[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(s>0?n>0?u/li(10,o-n):0:m[d-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return c?(i=Mr(e),m.length=1,t=t-i-1,m[0]=li(10,(ir-t%ir)%ir),e.e=Go(-t/ir)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(s==0?(m.length=d,i=1,d--):(m.length=d+1,i=li(10,ir-s),m[d]=n>0?(u/li(10,o-n)%li(10,n)|0)*i:0),c)for(;;)if(d==0){(m[0]+=i)==Yr&&(m[0]=1,++e.e);break}else{if(m[d]+=i,m[d]!=Yr)break;m[d--]=0,i=1}for(s=m.length;m[--s]===0;)m.pop();if(mr&&(e.e>yu||e.e<-yu))throw Error(gv+Mr(e));return e}function IA(e,t){var r,s,n,i,o,l,c,u,d,m,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),mr?sr(t,h):t;if(c=e.d,m=t.d,s=t.e,u=e.e,c=c.slice(),o=u-s,o){for(d=o<0,d?(r=c,o=-o,l=m.length):(r=m,s=u,l=c.length),n=Math.max(Math.ceil(h/ir),l)+2,o>n&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for(n=c.length,l=m.length,d=n<l,d&&(l=n),n=0;n<l;n++)if(c[n]!=m[n]){d=c[n]<m[n];break}o=0}for(d&&(r=c,c=m,m=r,t.s=-t.s),l=c.length,n=m.length-l;n>0;--n)c[l++]=0;for(n=m.length;n>o;){if(c[--n]<m[n]){for(i=n;i&&c[--i]===0;)c[i]=Yr-1;--c[i],c[n]+=Yr}c[n]-=m[n]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(t.d=c,t.e=s,mr?sr(t,h):t):new f(0)}function Mi(e,t,r){var s,n=Mr(e),i=Ga(e.d),o=i.length;return t?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Pn(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+Pn(-n-1)+i,r&&(s=r-o)>0&&(i+=Pn(s))):n>=o?(i+=Pn(n+1-o),r&&(s=r-n-1)>0&&(i=i+"."+Pn(s))):((s=n+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(n+1===o&&(i+="."),i+=Pn(s))),e.s<0?"-"+i:i}function Ow(e,t){if(e.length>t)return e.length=t,!0}function PA(e){var t,r,s;function n(i){var o=this;if(!(o instanceof n))return new n(i);if(o.constructor=n,i instanceof n){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ei+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return Dw(o,i.toString())}else if(typeof i!="string")throw Error(Ei+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,CJ.test(i))Dw(o,i);else throw Error(Ei+i)}if(n.prototype=rt,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=PA,n.config=n.set=AJ,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return n.config(e),n}function AJ(e){if(!e||typeof e!="object")throw Error(Sa+"Object expected");var t,r,s,n=["precision",1,Vo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((s=e[r=n[t]])!==void 0)if(Go(s)===s&&s>=n[t+1]&&s<=n[t+2])this[r]=s;else throw Error(Ei+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(Ei+r+": "+s);return this}var vv=PA(TJ);Zs=new vv(1);const Xt=vv;var kJ=e=>e,DA={},OA=e=>e===DA,Rw=e=>function t(){return arguments.length===0||arguments.length===1&&OA(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},RA=(e,t)=>e===1?t:Rw(function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];var i=s.filter(o=>o!==DA).length;return i>=e?t(...s):RA(e-i,Rw(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=s.map(d=>OA(d)?l.shift():d);return t(...u,...l)}))}),ym=e=>RA(e.length,e),ex=(e,t)=>{for(var r=[],s=e;s<t;++s)r[s-e]=s;return r},_J=ym((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),IJ=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return kJ;var n=r.reverse(),i=n[0],o=n.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}},tx=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),FA=e=>{var t=null,r=null;return function(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return t&&n.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=n,r=e(...n)),r}};function LA(e){var t;return e===0?t=1:t=Math.floor(new Xt(e).abs().log(10).toNumber())+1,t}function MA(e,t,r){for(var s=new Xt(e),n=0,i=[];s.lt(t)&&n<1e5;)i.push(s.toNumber()),s=s.add(r),n++;return i}ym((e,t,r)=>{var s=+e,n=+t;return s+r*(n-s)});ym((e,t,r)=>{var s=t-+e;return s=s||1/0,(r-e)/s});ym((e,t,r)=>{var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(r-e)/s))});var BA=e=>{var[t,r]=e,[s,n]=[t,r];return t>r&&([s,n]=[r,t]),[s,n]},zA=(e,t,r)=>{if(e.lte(0))return new Xt(0);var s=LA(e.toNumber()),n=new Xt(10).pow(s),i=e.div(n),o=s!==1?.05:.1,l=new Xt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(n);return t?new Xt(c.toNumber()):new Xt(Math.ceil(c.toNumber()))},PJ=(e,t,r)=>{var s=new Xt(1),n=new Xt(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(s=new Xt(10).pow(LA(e)-1),n=new Xt(Math.floor(n.div(s).toNumber())).mul(s)):i>1&&(n=new Xt(Math.floor(e)))}else e===0?n=new Xt(Math.floor((t-1)/2)):r||(n=new Xt(Math.floor(e)));var o=Math.floor((t-1)/2),l=IJ(_J(c=>n.add(new Xt(c-o).mul(s)).toNumber()),ex);return l(0,t)},$A=function(t,r,s,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(s-1)))return{step:new Xt(0),tickMin:new Xt(0),tickMax:new Xt(0)};var o=zA(new Xt(r).sub(t).div(s-1),n,i),l;t<=0&&r>=0?l=new Xt(0):(l=new Xt(t).add(r).div(2),l=l.sub(new Xt(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new Xt(r).sub(l).div(o).toNumber()),d=c+u+1;return d>s?$A(t,r,s,n,i+1):(d<s&&(u=r>0?u+(s-d):u,c=r>0?c:c+(s-d)),{step:o,tickMin:l.sub(new Xt(c).mul(o)),tickMax:l.add(new Xt(u).mul(o))})};function DJ(e){var[t,r]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(s,2),[o,l]=BA([t,r]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...ex(0,s-1).map(()=>1/0)]:[...ex(0,s-1).map(()=>-1/0),l];return t>r?tx(c):c}if(o===l)return PJ(o,s,n);var{step:u,tickMin:d,tickMax:m}=$A(o,l,i,n,0),f=MA(d,m.add(new Xt(.1).mul(u)),u);return t>r?tx(f):f}function OJ(e,t){var[r,s]=e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=BA([r,s]);if(i===-1/0||o===1/0)return[r,s];if(i===o)return[i];var l=Math.max(t,2),c=zA(new Xt(o).sub(i).div(l-1),n,0),u=[...MA(new Xt(i),new Xt(o),c),o];return n===!1&&(u=u.map(d=>Math.round(d))),r>s?tx(u):u}var RJ=FA(DJ),FJ=FA(OJ),UA=e=>e.rootProps.maxBarSize,LJ=e=>e.rootProps.barGap,WA=e=>e.rootProps.barCategoryGap,MJ=e=>e.rootProps.barSize,Fc=e=>e.rootProps.stackOffset,bv=e=>e.options.chartName,yv=e=>e.rootProps.syncId,HA=e=>e.rootProps.syncMethod,jv=e=>e.options.eventEmitter,tn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},qs={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},jm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},BJ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:tn.angleAxisId,includeHidden:!1,name:void 0,reversed:tn.reversed,scale:tn.scale,tick:tn.tick,tickCount:void 0,ticks:void 0,type:tn.type,unit:void 0},zJ={allowDataOverflow:qs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:qs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:qs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:qs.scale,tick:qs.tick,tickCount:qs.tickCount,ticks:void 0,type:qs.type,unit:void 0},$J={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:tn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:tn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:tn.scale,tick:tn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},UJ={allowDataOverflow:qs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:qs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:qs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:qs.scale,tick:qs.tick,tickCount:qs.tickCount,ticks:void 0,type:"category",unit:void 0},wv=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?$J:BJ,Nv=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?UJ:zJ,wm=e=>e.polarOptions,Sv=je([Nn,Sn,Vr],TC),VA=je([wm,Sv],(e,t)=>{if(e!=null)return Ss(e.innerRadius,t,0)}),GA=je([wm,Sv],(e,t)=>{if(e!=null)return Ss(e.outerRadius,t,t*.8)}),WJ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},qA=je([wm],WJ);je([wv,qA],jm);var KA=je([Sv,VA,GA],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});je([Nv,KA],jm);var YA=je([Vt,wm,VA,GA,Nn,Sn],(e,t,r,s,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||s==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Ss(o,n,n/2),cy:Ss(l,i,i/2),innerRadius:r,outerRadius:s,startAngle:c,endAngle:u,clockWise:!1}}}),pr=(e,t)=>t,Lc=(e,t,r)=>r;function Ev(e){return e?.id}var qr=e=>{var t=Vt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},qo=e=>e.tooltip.settings.axisId,as=e=>{var t=qr(e),r=qo(e);return Mc(e,t,r)},XA=je([as],e=>e?.dataKey);function JA(e,t,r){var{chartData:s=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:s;if(!(u==null||u.length===0)){var d=Ev(l);u.forEach((m,f)=>{var h=i==null||n?f:String(jr(m,i,null)),x=jr(m,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:x}),o.set(h,p)})}}),Array.from(o.values())}function Nm(e){return e.stackId!=null&&e.dataKey!=null}function Fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ju(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fw(Object(r),!0).forEach(function(s){HJ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function HJ(e,t,r){return(t=VJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VJ(e){var t=GJ(e,"string");return typeof t=="symbol"?t:t+""}function GJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rx=[0,"auto"],Vs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},ZA=(e,t)=>e.cartesianAxis.xAxis[t],Tn=(e,t)=>{var r=ZA(e,t);return r??Vs},Gs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:rx,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ic},QA=(e,t)=>e.cartesianAxis.yAxis[t],Cn=(e,t)=>{var r=QA(e,t);return r??Gs},qJ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Tv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??qJ},Pr=(e,t,r)=>{switch(t){case"xAxis":return Tn(e,r);case"yAxis":return Cn(e,r);case"zAxis":return Tv(e,r);case"angleAxis":return wv(e,r);case"radiusAxis":return Nv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},KJ=(e,t,r)=>{switch(t){case"xAxis":return Tn(e,r);case"yAxis":return Cn(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Mc=(e,t,r)=>{switch(t){case"xAxis":return Tn(e,r);case"yAxis":return Cn(e,r);case"angleAxis":return wv(e,r);case"radiusAxis":return Nv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},ek=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Cv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Av=e=>e.graphicalItems.cartesianItems,YJ=je([pr,Lc],Cv),kv=(e,t,r)=>e.filter(r).filter(s=>t?.includeHidden===!0?!0:!s.hide),Bc=je([Av,Pr,YJ],kv),tk=je([Bc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Nm)),rk=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),sk=je([Bc],rk),_v=e=>e.map(t=>t.data).filter(Boolean).flat(1),XJ=je([Bc],_v),Iv=(e,t)=>{var{chartData:r=[],dataStartIndex:s,dataEndIndex:n}=t;return e.length>0?e:r.slice(s,n+1)},Pv=je([XJ,xv],Iv),Dv=(e,t,r)=>t?.dataKey!=null?e.map(s=>({value:jr(s,t.dataKey)})):r.length>0?r.map(s=>s.dataKey).flatMap(s=>e.map(n=>({value:jr(n,s)}))):e.map(s=>({value:s})),Sm=je([Pv,Pr,Bc],Dv);function ak(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function eo(e){return e.filter(t=>Xa(t)||t instanceof Date).map(Number).filter(t=>ra(t)===!1)}function JJ(e,t,r){return!r||typeof t!="number"||ra(t)?[]:r.length?eo(r.flatMap(s=>{var n=jr(e,s.dataKey),i,o;if(Array.isArray(n)?[i,o]=n:i=o=n,!(!aa(i)||!aa(o)))return[t-i,t+o]})):[]}var ZJ=je([tk,xv,as],JA),nk=(e,t,r)=>{var s={},n=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),s);return Object.fromEntries(Object.entries(n).map(i=>{var[o,l]=i,c=l.map(Ev);return[o,{stackedData:rq(e,c,r),graphicalItems:l}]}))},sx=je([ZJ,tk,Fc],nk),ik=(e,t,r)=>{var{dataStartIndex:s,dataEndIndex:n}=t;if(r!=="zAxis"){var i=oq(e,s,n);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},QJ=je([sx,ei,pr],ik),ok=(e,t,r,s,n)=>r.length>0?e.flatMap(i=>r.flatMap(o=>{var l,c,u=(l=s[o.id])===null||l===void 0?void 0:l.filter(m=>ak(n,m)),d=jr(i,(c=t.dataKey)!==null&&c!==void 0?c:o.dataKey);return{value:d,errorDomain:JJ(i,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:jr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),Em=e=>e.errorBars,lk=(e,t,r)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>ak(r,s));je([sk,Em,pr],lk);var eZ=je([Pv,Pr,sk,Em,pr],ok);function tZ(e){var{value:t}=e;if(Xa(t)||t instanceof Date)return t}var Lw=e=>{var t=e.flatMap(s=>[s.value,s.errorDomain]).flat(1),r=eo(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},rZ=(e,t,r)=>{var s=e.map(tZ).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&jT(s))?qC(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},Ov=e=>{var t;if(e==null||!("domain"in e))return rx;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=eo(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:rx},wu=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},ck=e=>e.referenceElements.dots,Ko=(e,t,r)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===r:s.yAxisId===r),sZ=je([ck,pr,Lc],Ko),dk=e=>e.referenceElements.areas,aZ=je([dk,pr,Lc],Ko),uk=e=>e.referenceElements.lines,nZ=je([uk,pr,Lc],Ko),mk=(e,t)=>{var r=eo(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},iZ=je(sZ,pr,mk),fk=(e,t)=>{var r=eo(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},oZ=je([aZ,pr],fk),hk=(e,t)=>{var r=eo(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},lZ=je(nZ,pr,hk),cZ=je(iZ,lZ,oZ,(e,t,r)=>wu(e,r,t)),pk=je([Pr],Ov),Rv=(e,t,r,s,n,i,o)=>{var l=SJ(t,e.allowDataOverflow);if(l!=null)return l;var c=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",u=c?wu(r,n,Lw(s)):wu(n,Lw(s));return EJ(t,u,e.allowDataOverflow)},dZ=je([Pr,pk,QJ,eZ,cZ,Vt,pr],Rv),uZ=[0,1],Fv=(e,t,r,s,n,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=Xi(t,i);return u&&l==null?qC(0,r.length):c==="category"?rZ(s,e,u):n==="expand"?uZ:o}},Lv=je([Pr,Vt,Pv,Sm,Fc,pr,dZ],Fv),xk=(e,t,r,s,n)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":o==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Cc(i));return l in yl?l:"point"}}},Yo=je([Pr,Vt,ek,bv,pr],xk);function mZ(e){if(e!=null){if(e in yl)return yl[e]();var t="scale".concat(Cc(e));if(t in yl)return yl[t]()}}function Mv(e,t,r,s){if(!(r==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(s);var n=mZ(t);if(n!=null){var i=n.domain(r).range(s);return JG(i),i}}}var Bv=(e,t,r)=>{var s=Ov(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&Oo(e))return RJ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Oo(e))return FJ(e,t.tickCount,t.allowDecimals)}},zv=je([Lv,Mc,Yo],Bv),$v=(e,t,r,s)=>{if(s!=="angleAxis"&&e?.type==="number"&&Oo(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],o=t[1],l=r[r.length-1];return[Math.min(n,i),Math.max(o,l)]}return t},fZ=je([Pr,Lv,zv,pr],$v),hZ=je(Sm,Pr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,s=Array.from(eo(e.map(l=>l.value))).sort((l,c)=>l-c);if(s.length<2)return 1/0;var n=s[s.length-1]-s[0];if(n===0)return 1/0;for(var i=0;i<s.length-1;i++){var o=s[i+1]-s[i];r=Math.min(r,o)}return r/n}}),gk=je(hZ,Vt,WA,Vr,(e,t,r,s)=>s,(e,t,r,s,n)=>{if(!aa(e))return 0;var i=t==="vertical"?s.height:s.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var o=Ss(r,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),pZ=(e,t)=>{var r=Tn(e,t);return r==null||typeof r.padding!="string"?0:gk(e,"xAxis",t,r.padding)},xZ=(e,t)=>{var r=Cn(e,t);return r==null||typeof r.padding!="string"?0:gk(e,"yAxis",t,r.padding)},gZ=je(Tn,pZ,(e,t)=>{var r,s;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((s=n.right)!==null&&s!==void 0?s:0)+t}}),vZ=je(Cn,xZ,(e,t)=>{var r,s;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((s=n.bottom)!==null&&s!==void 0?s:0)+t}}),bZ=je([Vr,gZ,um,dm,(e,t,r)=>r],(e,t,r,s,n)=>{var{padding:i}=s;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),yZ=je([Vr,Vt,vZ,um,dm,(e,t,r)=>r],(e,t,r,s,n,i)=>{var{padding:o}=n;return i?[s.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),zc=(e,t,r,s)=>{var n;switch(t){case"xAxis":return bZ(e,r,s);case"yAxis":return yZ(e,r,s);case"zAxis":return(n=Tv(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return qA(e);case"radiusAxis":return KA(e,r);default:return}},vk=je([Pr,zc],jm),Xo=je([Pr,Yo,fZ,vk],Mv);je([Bc,Em,pr],lk);function bk(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Tm=(e,t)=>t,Cm=(e,t,r)=>r,jZ=je(lm,Tm,Cm,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(bk)),wZ=je(cm,Tm,Cm,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(bk)),yk=(e,t)=>({width:e.width,height:t.height}),NZ=(e,t)=>{var r=typeof t.width=="number"?t.width:Ic;return{width:r,height:e.height}},jk=je(Vr,Tn,yk),SZ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},EZ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},TZ=je(Sn,Vr,jZ,Tm,Cm,(e,t,r,s,n)=>{var i={},o;return r.forEach(l=>{var c=yk(t,l);o==null&&(o=SZ(t,s,e));var u=s==="top"&&!n||s==="bottom"&&n;i[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),i}),CZ=je(Nn,Vr,wZ,Tm,Cm,(e,t,r,s,n)=>{var i={},o;return r.forEach(l=>{var c=NZ(t,l);o==null&&(o=EZ(t,s,e));var u=s==="left"&&!n||s==="right"&&n;i[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),i}),AZ=(e,t)=>{var r=Tn(e,t);if(r!=null)return TZ(e,r.orientation,r.mirror)},kZ=je([Vr,Tn,AZ,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r?.[s];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),_Z=(e,t)=>{var r=Cn(e,t);if(r!=null)return CZ(e,r.orientation,r.mirror)},IZ=je([Vr,Cn,_Z,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r?.[s];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),wk=je(Vr,Cn,(e,t)=>{var r=typeof t.width=="number"?t.width:Ic;return{width:r,height:e.height}}),Mw=(e,t,r)=>{switch(t){case"xAxis":return jk(e,r).width;case"yAxis":return wk(e,r).height;default:return}},Nk=(e,t,r,s)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:o}=r,l=Xi(e,s),c=t.map(u=>u.value);if(o&&l&&i==="category"&&n&&jT(c))return c}},Uv=je([Vt,Sm,Pr,pr],Nk),Sk=(e,t,r,s)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,o=Xi(e,s);if(o&&(n==="number"||i!=="auto"))return t.map(l=>l.value)}},Wv=je([Vt,Sm,Mc,pr],Sk),Bw=je([Vt,KJ,Yo,Xo,Uv,Wv,zc,zv,pr],(e,t,r,s,n,i,o,l,c)=>{if(t==null)return null;var u=Xi(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:s}}),PZ=(e,t,r,s,n,i,o,l,c)=>{if(!(t==null||s==null)){var u=Xi(e,c),{type:d,ticks:m,tickCount:f}=t,h=r==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,x=d==="category"&&s.bandwidth?s.bandwidth()/h:0;x=c==="angleAxis"&&i!=null&&i.length>=2?es(i[0]-i[1])*2*x:x;var p=m||n;if(p){var g=p.map((b,y)=>{var j=o?o.indexOf(b):b;return{index:y,coordinate:s(j)+x,value:b,offset:x}});return g.filter(b=>!ra(b.coordinate))}return u&&l?l.map((b,y)=>({coordinate:s(b)+x,value:b,index:y,offset:x})):s.ticks?s.ticks(f).map(b=>({coordinate:s(b)+x,value:b,offset:x})):s.domain().map((b,y)=>({coordinate:s(b)+x,value:o?o[b]:b,index:y,offset:x}))}},Ek=je([Vt,Mc,Yo,Xo,zv,zc,Uv,Wv,pr],PZ),DZ=(e,t,r,s,n,i,o)=>{if(!(t==null||r==null||s==null||s[0]===s[1])){var l=Xi(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&s?.length>=2?es(s[0]-s[1])*2*u:u,l&&i?i.map((d,m)=>({coordinate:r(d)+u,value:d,index:m,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,m)=>({coordinate:r(d)+u,value:n?n[d]:d,index:m,offset:u}))}},Ro=je([Vt,Mc,Xo,zc,Uv,Wv,pr],DZ),Fo=je(Pr,Xo,(e,t)=>{if(!(e==null||t==null))return ju(ju({},e),{},{scale:t})}),OZ=je([Pr,Yo,Lv,vk],Mv);je((e,t,r)=>Tv(e,r),OZ,(e,t)=>{if(!(e==null||t==null))return ju(ju({},e),{},{scale:t})});var RZ=je([Vt,lm,cm],(e,t,r)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Tk=e=>e.options.defaultTooltipEventType,Ck=e=>e.options.validateTooltipEventTypes;function Ak(e,t,r){if(e==null)return t;var s=e?"axis":"item";return r==null?t:r.includes(s)?s:t}function Hv(e,t){var r=Tk(e),s=Ck(e);return Ak(t,r,s)}function FZ(e){return lt(t=>Hv(t,e))}var kk=(e,t)=>{var r,s=Number(t);if(!(ra(s)||t==null))return s>=0?e==null||(r=e[s])===null||r===void 0?void 0:r.value:void 0},LZ=e=>e.tooltip.settings,On={active:!1,index:null,dataKey:void 0,coordinate:void 0},MZ={itemInteraction:{click:On,hover:On},axisInteraction:{click:On,hover:On},keyboardInteraction:On,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},_k=na({name:"tooltip",initialState:MZ,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=dn(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:BZ,removeTooltipEntrySettings:zZ,setTooltipSettingsState:$Z,setActiveMouseOverItemIndex:Ik,mouseLeaveItem:UZ,mouseLeaveChart:Pk,setActiveClickItemIndex:WZ,setMouseOverAxisIndex:Dk,setMouseClickAxisIndex:HZ,setSyncInteraction:ax,setKeyboardInteraction:nx}=_k.actions,VZ=_k.reducer;function zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function yd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zw(Object(r),!0).forEach(function(s){GZ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GZ(e,t,r){return(t=qZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qZ(e){var t=KZ(e,"string");return typeof t=="symbol"?t:t+""}function KZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YZ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function XZ(e){return e.index!=null}var Ok=(e,t,r,s)=>{if(t==null)return On;var n=YZ(e,t,r);if(n==null)return On;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(XZ(n)){if(i)return yd(yd({},n),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return yd(yd({},On),{},{coordinate:n.coordinate})},Vv=(e,t)=>{var r=e?.index;if(r==null)return null;var s=Number(r);if(!aa(s))return r;var n=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(n,Math.min(s,i)))},Rk=(e,t,r,s,n,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,i);if(u!=null)return u;var d=n?.[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(s.top+t)/2};default:return{x:(s.left+e)/2,y:d.coordinate}}}},Fk=(e,t,r,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===n})},$c=e=>e.options.tooltipPayloadSearcher,Jo=e=>e.tooltip;function $w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$w(Object(r),!0).forEach(function(s){JZ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$w(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function JZ(e,t,r){return(t=ZZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZZ(e){var t=QZ(e,"string");return typeof t=="symbol"?t:t+""}function QZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eQ(e,t){return e??t}var Lk=(e,t,r,s,n,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,m=[];return e.reduce((f,h)=>{var x,{dataDefinedOnItem:p,settings:g}=h,b=eQ(p,l),y=Array.isArray(b)?CC(b,u,d):b,j=(x=g?.dataKey)!==null&&x!==void 0?x:s,S=g?.nameKey,E;if(s&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?E=zW(y,s,n):E=i(y,t,c,S),Array.isArray(E))E.forEach(N=>{var C=Uw(Uw({},g),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});f.push(Sj({tooltipEntrySettings:C,dataKey:N.dataKey,payload:N.payload,value:jr(N.payload,N.dataKey),name:N.name}))});else{var w;f.push(Sj({tooltipEntrySettings:g,dataKey:j,payload:E,value:jr(E,j),name:(w=jr(E,S))!==null&&w!==void 0?w:g?.name}))}return f},m)}},Gv=je([as,Vt,ek,bv,qr],xk),tQ=je([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),rQ=je([qr,qo],Cv),Uc=je([tQ,as,rQ],kv),sQ=je([Uc],e=>e.filter(Nm)),aQ=je([Uc],_v),Zo=je([aQ,ei],Iv),nQ=je([sQ,ei,as],JA),qv=je([Zo,as,Uc],Dv),iQ=je([as],Ov),oQ=je([Uc],e=>e.filter(Nm)),lQ=je([nQ,oQ,Fc],nk),cQ=je([lQ,ei,qr],ik),dQ=je([Uc],rk),uQ=je([Zo,as,dQ,Em,qr],ok),mQ=je([ck,qr,qo],Ko),fQ=je([mQ,qr],mk),hQ=je([dk,qr,qo],Ko),pQ=je([hQ,qr],fk),xQ=je([uk,qr,qo],Ko),gQ=je([xQ,qr],hk),vQ=je([fQ,gQ,pQ],wu),bQ=je([as,iQ,cQ,uQ,vQ,Vt,qr],Rv),Mk=je([as,Vt,Zo,qv,Fc,qr,bQ],Fv),yQ=je([Mk,as,Gv],Bv),jQ=je([as,Mk,yQ,qr],$v),Bk=e=>{var t=qr(e),r=qo(e),s=!1;return zc(e,t,r,s)},zk=je([as,Bk],jm),$k=je([as,Gv,jQ,zk],Mv),wQ=je([Vt,qv,as,qr],Nk),NQ=je([Vt,qv,as,qr],Sk),SQ=(e,t,r,s,n,i,o,l)=>{if(t){var{type:c}=t,u=Xi(e,l);if(s){var d=r==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,m=c==="category"&&s.bandwidth?s.bandwidth()/d:0;return m=l==="angleAxis"&&n!=null&&n?.length>=2?es(n[0]-n[1])*2*m:m,u&&o?o.map((f,h)=>({coordinate:s(f)+m,value:f,index:h,offset:m})):s.domain().map((f,h)=>({coordinate:s(f)+m,value:i?i[f]:f,index:h,offset:m}))}}},An=je([Vt,as,Gv,$k,Bk,wQ,NQ,qr],SQ),Kv=je([Tk,Ck,LZ],(e,t,r)=>Ak(r.shared,e,t)),Uk=e=>e.tooltip.settings.trigger,Yv=e=>e.tooltip.settings.defaultIndex,Am=je([Jo,Kv,Uk,Yv],Ok),Bi=je([Am,Zo],Vv),Wk=je([An,Bi],kk),Hk=je([Am],e=>{if(e)return e.dataKey}),Vk=je([Jo,Kv,Uk,Yv],Fk),EQ=je([Nn,Sn,Vt,Vr,An,Yv,Vk,$c],Rk),TQ=je([Am,EQ],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),CQ=je([Am],e=>e.active),AQ=je([Vk,Bi,ei,XA,Wk,$c,Kv],Lk);je([AQ],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Hw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(s){kQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kQ(e,t,r){return(t=_Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Q(e){var t=IQ(e,"string");return typeof t=="symbol"?t:t+""}function IQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PQ=()=>lt(as),DQ=()=>{var e=PQ(),t=lt(An),r=lt($k);return Bg(Hw(Hw({},e),{},{scale:r}),t)},OQ=()=>lt(bv),Xv=(e,t)=>t,Gk=(e,t,r)=>r,Jv=(e,t,r,s)=>s,RQ=je(An,e=>tm(e,t=>t.coordinate)),Zv=je([Jo,Xv,Gk,Jv],Ok),qk=je([Zv,Zo],Vv),FQ=(e,t,r)=>{if(t!=null){var s=Jo(e);return t==="axis"?r==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:r==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},Kk=je([Jo,Xv,Gk,Jv],Fk),Nu=je([Nn,Sn,Vt,Vr,An,Jv,Kk,$c],Rk),LQ=je([Zv,Nu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),Yk=je(An,qk,kk),MQ=je([Kk,qk,ei,XA,Yk,$c,Xv],Lk),BQ=je([Zv],e=>({isActive:e.active,activeIndex:e.index})),zQ=(e,t,r,s,n,i,o,l)=>{if(!(!e||!t||!s||!n||!i)){var c=lq(e.chartX,e.chartY,t,r,l);if(c){var u=dq(c,t),d=YG(u,o,i,s,n),m=cq(t,i,d,c);return{activeIndex:String(d),activeCoordinate:m}}}};function ix(){return ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ix.apply(null,arguments)}function Vw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function jd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vw(Object(r),!0).forEach(function(s){$Q(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function $Q(e,t,r){return(t=UQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UQ(e){var t=WQ(e,"string");return typeof t=="symbol"?t:t+""}function WQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HQ(e){var{coordinate:t,payload:r,index:s,offset:n,tooltipAxisBandSize:i,layout:o,cursor:l,tooltipEventType:c,chartName:u}=e,d=t,m=r,f=s;if(!l||!d||u!=="ScatterChart"&&c!=="axis")return null;var h,x;if(u==="ScatterChart")h=d,x=dK;else if(u==="BarChart")h=uK(o,d,n,i),x=WC;else if(o==="radial"){var{cx:p,cy:g,radius:b,startAngle:y,endAngle:j}=HC(d);h={cx:p,cy:g,startAngle:y,endAngle:j,innerRadius:b,outerRadius:b},x=GC}else h={points:HK(o,d,n)},x=MC;var S=typeof l=="object"&&"className"in l?l.className:void 0,E=jd(jd(jd(jd({stroke:"#ccc",pointerEvents:"none"},n),h),Hr(l,!1)),{},{payload:m,payloadIndex:f,className:Pt("recharts-tooltip-cursor",S)});return v.isValidElement(l)?v.cloneElement(l,E):v.createElement(x,E)}function VQ(e){var t=DQ(),r=DC(),s=Hg(),n=OQ();return v.createElement(HQ,ix({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:s,tooltipAxisBandSize:t,chartName:n}))}var Xk=v.createContext(null),GQ=()=>v.useContext(Xk),hh={exports:{}},Gw;function qQ(){return Gw||(Gw=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,m,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new n(d,m||c,f),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],h]:c._events[x].push(h):(c._events[x]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,m;if(this._eventsCount===0)return u;for(m in d=this._events)t.call(d,m)&&u.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var f=0,h=m.length,x=new Array(h);f<h;f++)x[f]=m[f].fn;return x},l.prototype.listenerCount=function(u){var d=r?r+u:u,m=this._events[d];return m?m.fn?1:m.length:0},l.prototype.emit=function(u,d,m,f,h,x){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],b=arguments.length,y,j;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,m),!0;case 4:return g.fn.call(g.context,d,m,f),!0;case 5:return g.fn.call(g.context,d,m,f,h),!0;case 6:return g.fn.call(g.context,d,m,f,h,x),!0}for(j=1,y=new Array(b-1);j<b;j++)y[j-1]=arguments[j];g.fn.apply(g.context,y)}else{var S=g.length,E;for(j=0;j<S;j++)switch(g[j].once&&this.removeListener(u,g[j].fn,void 0,!0),b){case 1:g[j].fn.call(g[j].context);break;case 2:g[j].fn.call(g[j].context,d);break;case 3:g[j].fn.call(g[j].context,d,m);break;case 4:g[j].fn.call(g[j].context,d,m,f);break;default:if(!y)for(E=1,y=new Array(b-1);E<b;E++)y[E-1]=arguments[E];g[j].fn.apply(g[j].context,y)}}return!0},l.prototype.on=function(u,d,m){return i(this,u,d,m,!1)},l.prototype.once=function(u,d,m){return i(this,u,d,m,!0)},l.prototype.removeListener=function(u,d,m,f){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var x=this._events[h];if(x.fn)x.fn===d&&(!f||x.once)&&(!m||x.context===m)&&o(this,h);else{for(var p=0,g=[],b=x.length;p<b;p++)(x[p].fn!==d||f&&!x[p].once||m&&x[p].context!==m)&&g.push(x[p]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(hh)),hh.exports}var KQ=qQ();const YQ=qn(KQ);var lc=new YQ,ox="recharts.syncEvent.tooltip",qw="recharts.syncEvent.brush";function Jk(e,t){if(t){var r=Number.parseInt(t,10);if(!ra(r))return e?.[r]}}var XQ={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Zk=na({name:"options",initialState:XQ,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),JQ=Zk.reducer,{createEventEmitter:ZQ}=Zk.actions;function QQ(e){return e.tooltip.syncInteraction}var eee={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Qk=na({name:"chartData",initialState:eee,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:s}=t.payload;r!=null&&(e.dataStartIndex=r),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:Kw,setDataStartEndIndexes:tee,setComputedData:vce}=Qk.actions,ree=Qk.reducer,see=["x","y"];function Yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yw(Object(r),!0).forEach(function(s){aee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function aee(e,t,r){return(t=nee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nee(e){var t=iee(e,"string");return typeof t=="symbol"?t:t+""}function iee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oee(e,t){if(e==null)return{};var r,s,n=lee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var e_=()=>{};function cee(){var e=lt(yv),t=lt(jv),r=Sr(),s=lt(HA),n=lt(An),i=Hg(),o=$g(),l=lt(c=>c.rootProps.className);v.useEffect(()=>{if(e==null)return e_;var c=(u,d,m)=>{if(t!==m&&e===u){if(s==="index"){var f;if(o&&d!==null&&d!==void 0&&(f=d.payload)!==null&&f!==void 0&&f.coordinate){var h=d.payload.coordinate,{x,y:p}=h,g=oee(h,see),b=ni(ni(ni({},g),typeof x=="number"&&{x:Math.max(o.x,Math.min(x,o.x+o.width))}),typeof p=="number"&&{y:Math.max(o.y,Math.min(p,o.y+o.height))}),y=ni(ni({},d),{},{payload:ni(ni({},d.payload),{},{coordinate:b})});r(y)}else r(d);return}if(n!=null){var j;if(typeof s=="function"){var S={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=s(n,S);j=n[E]}else s==="value"&&(j=n.find(L=>String(L.value)===d.payload.label));var{coordinate:w}=d.payload;if(j==null||d.payload.active===!1||w==null||o==null){r(ax({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:N,y:C}=w,T=Math.min(N,o.x+o.width),_=Math.min(C,o.y+o.height),k={x:i==="horizontal"?j.coordinate:T,y:i==="horizontal"?_:j.coordinate},I=ax({active:d.payload.active,coordinate:k,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label});r(I)}}};return lc.on(ox,c),()=>{lc.off(ox,c)}},[l,r,t,e,s,n,i,o])}function dee(){var e=lt(yv),t=lt(jv),r=Sr();v.useEffect(()=>{if(e==null)return e_;var s=(n,i,o)=>{t!==o&&e===n&&r(tee(i))};return lc.on(qw,s),()=>{lc.off(qw,s)}},[r,t,e])}function uee(){var e=Sr();v.useEffect(()=>{e(ZQ())},[e]),cee(),dee()}function mee(e,t,r,s,n,i){var o=lt(f=>FQ(f,e,t)),l=lt(jv),c=lt(yv),u=lt(HA),d=lt(QQ),m=d?.active;v.useEffect(()=>{if(!m&&c!=null&&l!=null){var f=ax({active:i,coordinate:r,dataKey:o,index:n,label:typeof s=="number"?String(s):s});lc.emit(ox,c,f,l)}},[m,r,o,n,s,l,c,u,i])}function Xw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xw(Object(r),!0).forEach(function(s){fee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function fee(e,t,r){return(t=hee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hee(e){var t=pee(e,"string");return typeof t=="symbol"?t:t+""}function pee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xee(e){return e.dataKey}function gee(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(Uq,t)}var Zw=[],vee={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ji.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function wd(e){var t=Rs(e,vee),{active:r,allowEscapeViewBox:s,animationDuration:n,animationEasing:i,content:o,filterNull:l,isAnimationActive:c,offset:u,payloadUniqBy:d,position:m,reverseDirection:f,useTranslate3d:h,wrapperStyle:x,cursor:p,shared:g,trigger:b,defaultIndex:y,portal:j,axisId:S}=t,E=Sr(),w=typeof y=="number"?String(y):y;v.useEffect(()=>{E($Z({shared:g,trigger:b,axisId:S,active:r,defaultIndex:w}))},[E,g,b,S,r,w]);var N=$g(),C=LC(),T=FZ(g),{activeIndex:_,isActive:k}=lt(O=>BQ(O,T,b,w)),I=lt(O=>MQ(O,T,b,w)),L=lt(O=>Yk(O,T,b,w)),D=lt(O=>LQ(O,T,b,w)),M=I,q=GQ(),Z=r??k,[Q,U]=tC([M,Z]),le=T==="axis"?L:void 0;mee(T,b,D,le,_,Z);var Se=j??q;if(Se==null)return null;var P=M??Zw;Z||(P=Zw),l&&P.length&&(P=XT(M.filter(O=>O.value!=null&&(O.hide!==!0||t.includeHidden)),d,xee));var G=P.length>0,K=v.createElement(Yq,{allowEscapeViewBox:s,animationDuration:n,animationEasing:i,isAnimationActive:c,active:Z,coordinate:D,hasPayload:G,offset:u,position:m,reverseDirection:f,useTranslate3d:h,viewBox:N,wrapperStyle:x,lastBoundingBox:Q,innerRef:U,hasPortalFromProps:!!j},gee(o,Jw(Jw({},t),{},{payload:P,label:le,active:Z,coordinate:D,accessibilityLayer:C})));return v.createElement(v.Fragment,null,gx.createPortal(K,Se),Z&&v.createElement(VQ,{cursor:p,tooltipEventType:T,coordinate:D,payload:M,index:_}))}var ph={},xh={},gh={},Qw;function bee(){return Qw||(Qw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s,{signal:n,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},m=()=>{u&&d(),p()};let f=null;const h=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,m()},s)},x=()=>{f!==null&&(clearTimeout(f),f=null)},p=()=>{x(),o=void 0,l=null},g=()=>{d()},b=function(...y){if(n?.aborted)return;o=this,l=y;const j=f==null;h(),c&&j&&d()};return b.schedule=h,b.cancel=p,b.flush=g,n?.addEventListener("abort",p,{once:!0}),b}e.debounce=t})(gh)),gh}var eN;function yee(){return eN||(eN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bee();function r(s,n=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,m=null;const f=t.debounce(function(...p){d=s.apply(this,p),m=null},n,{edges:u}),h=function(...p){return c!=null&&(m===null&&(m=Date.now()),Date.now()-m>=c)?(d=s.apply(this,p),m=Date.now(),f.cancel(),f.schedule(),d):(f.apply(this,p),d)},x=()=>(f.flush(),d);return h.cancel=f.cancel,h.flush=x,h}e.debounce=r})(xh)),xh}var tN;function jee(){return tN||(tN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yee();function r(s,n=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(s,n,{leading:o,maxWait:n,trailing:l})}e.throttle=r})(ph)),ph}var vh,rN;function wee(){return rN||(rN=1,vh=jee().throttle),vh}var Nee=wee();const See=qn(Nee);var _l=function(t,r){for(var s=arguments.length,n=new Array(s>2?s-2:0),i=2;i<s;i++)n[i-2]=arguments[i]};function sN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sN(Object(r),!0).forEach(function(s){Eee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Eee(e,t,r){return(t=Tee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tee(e){var t=Cee(e,"string");return typeof t=="symbol"?t:t+""}function Cee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nd=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:s={width:-1,height:-1},width:n="100%",height:i="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:m,className:f,onResize:h,style:x={}}=e,p=v.useRef(null),g=v.useRef();g.current=h,v.useImperativeHandle(t,()=>p.current);var[b,y]=v.useState({containerWidth:s.width,containerHeight:s.height}),j=v.useCallback((E,w)=>{y(N=>{var C=Math.round(E),T=Math.round(w);return N.containerWidth===C&&N.containerHeight===T?N:{containerWidth:C,containerHeight:T}})},[]);v.useEffect(()=>{var E=T=>{var _,{width:k,height:I}=T[0].contentRect;j(k,I),(_=g.current)===null||_===void 0||_.call(g,k,I)};d>0&&(E=See(E,d,{trailing:!0,leading:!1}));var w=new ResizeObserver(E),{width:N,height:C}=p.current.getBoundingClientRect();return j(N,C),w.observe(p.current),()=>{w.disconnect()}},[j,d]);var S=v.useMemo(()=>{var{containerWidth:E,containerHeight:w}=b;if(E<0||w<0)return null;_l(mi(n)||mi(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,n,i),_l(!r||r>0,"The aspect(%s) must be greater than zero.",r);var N=mi(n)?E:n,C=mi(i)?w:i;return r&&r>0&&(N?C=N/r:C&&(N=C*r),c&&C>c&&(C=c)),_l(N>0||C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,C,n,i,o,l,r),v.Children.map(u,T=>v.cloneElement(T,{width:N,height:C,style:bh({width:N,height:C},T.props.style)}))},[r,u,i,c,l,o,b,n]);return v.createElement("div",{id:m?"".concat(m):void 0,className:Pt("recharts-responsive-container",f),style:bh(bh({},x),{},{width:n,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:p},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},S))}),Wc=e=>null;Wc.displayName="Cell";function Aee(e,t,r){return(t=kee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kee(e){var t=_ee(e,"string");return typeof t=="symbol"?t:t+""}function _ee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Iee{constructor(t){Aee(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function aN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Pee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aN(Object(r),!0).forEach(function(s){Dee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Dee(e,t,r){return(t=Oee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oee(e){var t=Ree(e,"string");return typeof t=="symbol"?t:t+""}function Ree(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fee={cacheSize:2e3,enableCache:!0},t_=Pee({},Fee),nN=new Iee(t_.cacheSize),Lee={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},iN="recharts_measurement_span";function Mee(e,t){var r=t.fontSize||"",s=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(s,"|").concat(n,"|").concat(i,"|").concat(o,"|").concat(l)}var oN=(e,t)=>{try{var r=document.getElementById(iN);r||(r=document.createElement("span"),r.setAttribute("id",iN),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Lee,t),r.textContent="".concat(e);var s=r.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},Il=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ji.isSsr)return{width:0,height:0};if(!t_.enableCache)return oN(t,r);var s=Mee(t,r),n=nN.get(s);if(n)return n;var i=oN(t,r);return nN.set(s,i),i},lN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Bee=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zee=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,r_={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},$ee=Object.keys(r_),uo="NaN";function Uee(e,t){return e*r_[t]}class Ls{static parse(t){var r,[,s,n]=(r=zee.exec(t))!==null&&r!==void 0?r:[];return new Ls(parseFloat(s),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ra(t)&&(this.unit=""),r!==""&&!Bee.test(r)&&(this.num=NaN,this.unit=""),$ee.includes(r)&&(this.num=Uee(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Ls(NaN,""):new Ls(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Ls(NaN,""):new Ls(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Ls(NaN,""):new Ls(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Ls(NaN,""):new Ls(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ra(this.num)}}function s_(e){if(e.includes(uo))return uo;for(var t=e;t.includes("*")||t.includes("/");){var r,[,s,n,i]=(r=lN.exec(t))!==null&&r!==void 0?r:[],o=Ls.parse(s??""),l=Ls.parse(i??""),c=n==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return uo;t=t.replace(lN,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,m,f]=(u=cN.exec(t))!==null&&u!==void 0?u:[],h=Ls.parse(d??""),x=Ls.parse(f??""),p=m==="+"?h.add(x):h.subtract(x);if(p.isNaN())return uo;t=t.replace(cN,p.toString())}return t}var dN=/\(([^()]*)\)/;function Wee(e){for(var t=e,r;(r=dN.exec(t))!=null;){var[,s]=r;t=t.replace(dN,s_(s))}return t}function Hee(e){var t=e.replace(/\s+/g,"");return t=Wee(t),t=s_(t),t}function Vee(e){try{return Hee(e)}catch{return uo}}function yh(e){var t=Vee(e.slice(5,-1));return t===uo?"":t}var Gee=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],qee=["dx","dy","angle","className","breakAll"];function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},lx.apply(null,arguments)}function uN(e,t){if(e==null)return{};var r,s,n=Kee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Kee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var a_=/[ \f\n\r\t\v\u2028\u2029]+/,n_=e=>{var{children:t,breakAll:r,style:s}=e;try{var n=[];rs(t)||(r?n=t.toString().split(""):n=t.toString().split(a_));var i=n.map(l=>({word:l,width:Il(l,s).width})),o=r?0:Il("",s).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},Yee=(e,t,r,s,n)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,u=ut(i),d=o,m=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return k.reduce((I,L)=>{var{word:D,width:M}=L,q=I[I.length-1];if(q&&(s==null||n||q.width+M+r<Number(s)))q.words.push(D),q.width+=M+r;else{var Z={words:[D],width:M};I.push(Z)}return I},[])},f=m(t),h=_=>_.reduce((k,I)=>k.width>I.width?k:I);if(!u||n)return f;var x=f.length>i||h(f).width>Number(s);if(!x)return f;for(var p="",g=_=>{var k=d.slice(0,_),I=n_({breakAll:c,style:l,children:k+p}).wordsWithComputedWidth,L=m(I),D=L.length>i||h(L).width>Number(s);return[D,L]},b=0,y=d.length-1,j=0,S;b<=y&&j<=d.length-1;){var E=Math.floor((b+y)/2),w=E-1,[N,C]=g(w),[T]=g(E);if(!N&&!T&&(b=E+1),N&&T&&(y=E-1),!N&&T){S=C;break}j++}return S||f},mN=e=>{var t=rs(e)?[]:e.toString().split(a_);return[{words:t}]},Xee=e=>{var{width:t,scaleToFit:r,children:s,style:n,breakAll:i,maxLines:o}=e;if((t||r)&&!Ji.isSsr){var l,c,u=n_({breakAll:i,children:s,style:n});if(u){var{wordsWithComputedWidth:d,spaceWidth:m}=u;l=d,c=m}else return mN(s);return Yee({breakAll:i,children:s,maxLines:o,style:n},l,c,t,r)}return mN(s)},fN="#808080",km=v.forwardRef((e,t)=>{var{x:r=0,y:s=0,lineHeight:n="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:u=fN}=e,d=uN(e,Gee),m=v.useMemo(()=>Xee({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:o,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,o,d.style,d.width]),{dx:f,dy:h,angle:x,className:p,breakAll:g}=d,b=uN(d,qee);if(!Xa(r)||!Xa(s)||m.length===0)return null;var y=r+(ut(f)?f:0),j=s+(ut(h)?h:0),S;switch(c){case"start":S=yh("calc(".concat(i,")"));break;case"middle":S=yh("calc(".concat((m.length-1)/2," * -").concat(n," + (").concat(i," / 2))"));break;default:S=yh("calc(".concat(m.length-1," * -").concat(n,")"));break}var E=[];if(o){var w=m[0].width,{width:N}=d;E.push("scale(".concat(ut(N)?N/w:1,")"))}return x&&E.push("rotate(".concat(x,", ").concat(y,", ").concat(j,")")),E.length&&(b.transform=E.join(" ")),v.createElement("text",lx({},Hr(b,!0),{ref:t,x:y,y:j,className:Pt("recharts-text",p),textAnchor:l,fill:u.includes("url")?fN:u}),m.map((C,T)=>{var _=C.words.join(g?"":" ");return v.createElement("tspan",{x:y,dy:T===0?S:n,key:"".concat(_,"-").concat(T)},_)}))});km.displayName="Text";var Jee=["labelRef"];function Zee(e,t){if(e==null)return{};var r,s,n=Qee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function hN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hN(Object(r),!0).forEach(function(s){ete(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ete(e,t,r){return(t=tte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tte(e){var t=rte(e,"string");return typeof t=="symbol"?t:t+""}function rte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rn(){return rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},rn.apply(null,arguments)}var i_=v.createContext(null),ste=e=>{var{x:t,y:r,width:s,height:n,children:i}=e,o=v.useMemo(()=>({x:t,y:r,width:s,height:n}),[t,r,s,n]);return v.createElement(i_.Provider,{value:o},i)},o_=()=>{var e=v.useContext(i_),t=$g();return e||t},ate=v.createContext(null),nte=()=>{var e=v.useContext(ate),t=lt(YA);return e||t},ite=e=>{var{value:t,formatter:r}=e,s=rs(e.children)?t:e.children;return typeof r=="function"?r(s):s},Qv=e=>e!=null&&typeof e=="function",ote=(e,t)=>{var r=es(t-e),s=Math.min(Math.abs(t-e),360);return r*s},lte=(e,t,r,s,n)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:m,endAngle:f,clockWise:h}=n,x=(u+d)/2,p=ote(m,f),g=p>=0?1:-1,b,y;switch(t){case"insideStart":b=m+g*i,y=h;break;case"insideEnd":b=f-g*i,y=!h;break;case"end":b=f+g*i,y=h;break;default:throw new Error("Unsupported position ".concat(t))}y=p<=0?y:!y;var j=Fr(l,c,x,b),S=Fr(l,c,x,b+(y?1:-1)*359),E="M".concat(j.x,",").concat(j.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(y?0:1,`,
    `).concat(S.x,",").concat(S.y),w=rs(e.id)?Ql("recharts-radial-line-"):e.id;return v.createElement("text",rn({},s,{dominantBaseline:"central",className:Pt("recharts-radial-bar-label",o)}),v.createElement("defs",null,v.createElement("path",{id:w,d:E})),v.createElement("textPath",{xlinkHref:"#".concat(w)},r))},cte=(e,t,r)=>{var{cx:s,cy:n,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:m}=Fr(s,n,o+t,u);return{x:d,y:m,textAnchor:d>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+o)/2,{x:h,y:x}=Fr(s,n,f,u);return{x:h,y:x,textAnchor:"middle",verticalAnchor:"middle"}},l_=e=>"cx"in e&&ut(e.cx),dte=(e,t)=>{var{parentViewBox:r,offset:s,position:n}=e,i;r!=null&&!l_(r)&&(i=r);var{x:o,y:l,width:c,height:u}=t,d=u>=0?1:-1,m=d*s,f=d>0?"end":"start",h=d>0?"start":"end",x=c>=0?1:-1,p=x*s,g=x>0?"end":"start",b=x>0?"start":"end";if(n==="top"){var y={x:o+c/2,y:l-d*s,textAnchor:"middle",verticalAnchor:f};return kr(kr({},y),i?{height:Math.max(l-i.y,0),width:c}:{})}if(n==="bottom"){var j={x:o+c/2,y:l+u+m,textAnchor:"middle",verticalAnchor:h};return kr(kr({},j),i?{height:Math.max(i.y+i.height-(l+u),0),width:c}:{})}if(n==="left"){var S={x:o-p,y:l+u/2,textAnchor:g,verticalAnchor:"middle"};return kr(kr({},S),i?{width:Math.max(S.x-i.x,0),height:u}:{})}if(n==="right"){var E={x:o+c+p,y:l+u/2,textAnchor:b,verticalAnchor:"middle"};return kr(kr({},E),i?{width:Math.max(i.x+i.width-E.x,0),height:u}:{})}var w=i?{width:c,height:u}:{};return n==="insideLeft"?kr({x:o+p,y:l+u/2,textAnchor:b,verticalAnchor:"middle"},w):n==="insideRight"?kr({x:o+c-p,y:l+u/2,textAnchor:g,verticalAnchor:"middle"},w):n==="insideTop"?kr({x:o+c/2,y:l+m,textAnchor:"middle",verticalAnchor:h},w):n==="insideBottom"?kr({x:o+c/2,y:l+u-m,textAnchor:"middle",verticalAnchor:f},w):n==="insideTopLeft"?kr({x:o+p,y:l+m,textAnchor:b,verticalAnchor:h},w):n==="insideTopRight"?kr({x:o+c-p,y:l+m,textAnchor:g,verticalAnchor:h},w):n==="insideBottomLeft"?kr({x:o+p,y:l+u-m,textAnchor:b,verticalAnchor:f},w):n==="insideBottomRight"?kr({x:o+c-p,y:l+u-m,textAnchor:g,verticalAnchor:f},w):n&&typeof n=="object"&&(ut(n.x)||mi(n.x))&&(ut(n.y)||mi(n.y))?kr({x:o+Ss(n.x,c),y:l+Ss(n.y,u),textAnchor:"end",verticalAnchor:"end"},w):kr({x:o+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},w)},ute={offset:5};function Dn(e){var t=Rs(e,ute),{viewBox:r,position:s,value:n,children:i,content:o,className:l="",textBreakAll:c,labelRef:u}=t,d=nte(),m=o_(),f=s==="center"?m:d??m,h=r||f;if(!h||rs(n)&&rs(i)&&!v.isValidElement(o)&&typeof o!="function")return null;var x=kr(kr({},t),{},{viewBox:h});if(v.isValidElement(o)){var{labelRef:p}=x,g=Zee(x,Jee);return v.cloneElement(o,g)}var b;if(typeof o=="function"){if(b=v.createElement(o,x),v.isValidElement(b))return b}else b=ite(t);var y=l_(h),j=Hr(t,!0);if(y&&(s==="insideStart"||s==="insideEnd"||s==="end"))return lte(t,s,b,j,h);var S=y?cte(h,t.offset,t.position):dte(t,h);return v.createElement(km,rn({ref:u,className:Pt("recharts-label",l)},j,S,{breakAll:c}),b)}Dn.displayName="Label";var mte=(e,t,r)=>{if(!e)return null;var s={viewBox:t,labelRef:r};return e===!0?v.createElement(Dn,rn({key:"label-implicit"},s)):Xa(e)?v.createElement(Dn,rn({key:"label-implicit",value:e},s)):v.isValidElement(e)?e.type===Dn?v.cloneElement(e,kr({key:"label-implicit"},s)):v.createElement(Dn,rn({key:"label-implicit",content:e},s)):Qv(e)?v.createElement(Dn,rn({key:"label-implicit",content:e},s)):e&&typeof e=="object"?v.createElement(Dn,rn({},e,{key:"label-implicit"},s)):null};function fte(e){var{label:t}=e,r=o_();return mte(t,r)||null}var jh={},wh={},pN;function hte(){return pN||(pN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(wh)),wh}var Nh={},xN;function pte(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Nh)),Nh}var gN;function xte(){return gN||(gN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hte(),r=pte(),s=Ig();function n(i){if(s.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})(jh)),jh}var Sh,vN;function gte(){return vN||(vN=1,Sh=xte().last),Sh}var vte=gte();const bte=qn(vte);var yte=["valueAccessor"],jte=["dataKey","clockWise","id","textBreakAll"];function Su(){return Su=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Su.apply(null,arguments)}function bN(e,t){if(e==null)return{};var r,s,n=wte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wte(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Nte=e=>Array.isArray(e.value)?bte(e.value):e.value,c_=v.createContext(void 0),Ste=c_.Provider,d_=v.createContext(void 0),Ete=d_.Provider;function Tte(){return v.useContext(c_)}function Cte(){return v.useContext(d_)}function _d(e){var{valueAccessor:t=Nte}=e,r=bN(e,yte),{dataKey:s,clockWise:n,id:i,textBreakAll:o}=r,l=bN(r,jte),c=Tte(),u=Cte(),d=c||u;return!d||!d.length?null:v.createElement(Hs,{className:"recharts-label-list"},d.map((m,f)=>{var h,x=rs(s)?t(m,f):jr(m&&m.payload,s),p=rs(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(Dn,Su({},Hr(m,!0),l,p,{fill:(h=r.fill)!==null&&h!==void 0?h:m.fill,parentViewBox:m.parentViewBox,value:x,textBreakAll:o,viewBox:m.viewBox,key:"label-".concat(f),index:f}))}))}_d.displayName="LabelList";function u_(e){var{label:t}=e;return t?t===!0?v.createElement(_d,{key:"labelList-implicit"}):v.isValidElement(t)||Qv(t)?v.createElement(_d,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(_d,Su({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var m_=e=>e.graphicalItems.polarItems,Ate=je([pr,Lc],Cv),e1=je([m_,Pr,Ate],kv),kte=je([e1],_v),t1=je([kte,pv],Iv),_te=je([t1,Pr,e1],Dv),Ite=je([t1,Pr,e1],(e,t,r)=>r.length>0?e.flatMap(s=>r.flatMap(n=>{var i,o=jr(s,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(s=>({value:jr(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]}))),yN=()=>{},Pte=je([Pr,pk,yN,Ite,yN,Vt,pr],Rv),f_=je([Pr,Vt,t1,_te,Fc,pr,Pte],Fv),Dte=je([f_,Pr,Yo],Bv);je([Pr,f_,Dte,pr],$v);var Ote={radiusAxis:{},angleAxis:{}},h_=na({name:"polarAxis",initialState:Ote,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:bce,removeRadiusAxis:yce,addAngleAxis:jce,removeAngleAxis:wce}=h_.actions,Rte=h_.reducer;function jN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function wN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jN(Object(r),!0).forEach(function(s){Fte(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Fte(e,t,r){return(t=Lte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lte(e){var t=Mte(e,"string");return typeof t=="symbol"?t:t+""}function Mte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bte=(e,t)=>t,r1=je([m_,Bte],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),zte=[],s1=(e,t,r)=>r?.length===0?zte:r,p_=je([pv,r1,s1],(e,t,r)=>{var{chartData:s}=e;if(t!=null){var n;if(t?.data!=null&&t.data.length>0?n=t.data:n=s,(!n||!n.length)&&r!=null&&(n=r.map(i=>wN(wN({},t.presentationProps),i.props))),n!=null)return n}}),$te=je([p_,r1,s1],(e,t,r)=>{if(!(e==null||t==null))return e.map((s,n)=>{var i,o=jr(s,t.nameKey,t.name),l;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[n].props.fill:typeof s=="object"&&s!=null&&"fill"in s?l=s.fill:l=t.fill,{value:om(o,t.dataKey),color:l,payload:s,type:t.legendType}})}),Ute=je([p_,r1,s1,Vr],(e,t,r,s)=>{if(!(t==null||e==null))return $re({offset:s,pieSettings:t,displayedData:e,cells:r})}),Eh={},NN;function Wte(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${n}]`}let s=r;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(r)===s}e.isPlainObject=t})(Eh)),Eh}var Th,SN;function Hte(){return SN||(SN=1,Th=Wte().isPlainObject),Th}var Vte=Hte();const Gte=qn(Vte);function EN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function TN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EN(Object(r),!0).forEach(function(s){qte(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function qte(e,t,r){return(t=Kte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kte(e){var t=Yte(e,"string");return typeof t=="symbol"?t:t+""}function Yte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eu(){return Eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Eu.apply(null,arguments)}var CN=(e,t,r,s,n)=>{var i=r-s,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+n),o+="L ".concat(e+r-i/2-s,",").concat(t+n),o+="L ".concat(e,",").concat(t," Z"),o},Xte={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Jte=e=>{var t=Rs(e,Xte),{x:r,y:s,upperWidth:n,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:m}=t,f=v.useRef(),[h,x]=v.useState(-1),p=v.useRef(n),g=v.useRef(i),b=v.useRef(o),y=v.useRef(r),j=v.useRef(s),S=fm(e,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var D=f.current.getTotalLength();D&&x(D)}catch{}},[]),r!==+r||s!==+s||n!==+n||i!==+i||o!==+o||n===0&&i===0||o===0)return null;var E=Pt("recharts-trapezoid",l);if(!m)return v.createElement("g",null,v.createElement("path",Eu({},Hr(t,!0),{className:E,d:CN(r,s,n,i,o)})));var w=p.current,N=g.current,C=b.current,T=y.current,_=j.current,k="0px ".concat(h===-1?1:h,"px"),I="".concat(h,"px 0px"),L=BC(["strokeDasharray"],u,c);return v.createElement(mm,{animationId:S,key:S,canBegin:h>0,duration:u,easing:c,isActive:m,begin:d},D=>{var M=ds(w,n,D),q=ds(N,i,D),Z=ds(C,o,D),Q=ds(T,r,D),U=ds(_,s,D);f.current&&(p.current=M,g.current=q,b.current=Z,y.current=Q,j.current=U);var le=D>0?{transition:L,strokeDasharray:I}:{strokeDasharray:k};return v.createElement("path",Eu({},Hr(t,!0),{className:E,d:CN(Q,U,M,q,Z),ref:f,style:TN(TN({},le),t.style)}))})},Zte=["option","shapeType","propTransformer","activeClassName","isActive"];function Qte(e,t){if(e==null)return{};var r,s,n=ere(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ere(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Tu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(s){tre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function tre(e,t,r){return(t=rre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rre(e){var t=sre(e,"string");return typeof t=="symbol"?t:t+""}function sre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function are(e,t){return Tu(Tu({},t),e)}function nre(e,t){return e==="symbols"}function kN(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(WC,r);case"trapezoid":return v.createElement(Jte,r);case"sector":return v.createElement(GC,r);case"symbols":if(nre(t))return v.createElement(Ag,r);break;default:return null}}function ire(e){return v.isValidElement(e)?e.props:e}function x_(e){var{option:t,shapeType:r,propTransformer:s=are,activeClassName:n="recharts-active-shape",isActive:i}=e,o=Qte(e,Zte),l;if(v.isValidElement(t))l=v.cloneElement(t,Tu(Tu({},o),ire(t)));else if(typeof t=="function")l=t(o);else if(Gte(t)&&typeof t!="boolean"){var c=s(t,o);l=v.createElement(kN,{shapeType:r,elementProps:c})}else{var u=o;l=v.createElement(kN,{shapeType:r,elementProps:u})}return i?v.createElement(Hs,{className:n},l):l}var a1=(e,t)=>{var r=Sr();return(s,n)=>i=>{e?.(s,n,i),r(Ik({activeIndex:String(n),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}},n1=e=>{var t=Sr();return(r,s)=>n=>{e?.(r,s,n),t(UZ())}},i1=(e,t)=>{var r=Sr();return(s,n)=>i=>{e?.(s,n,i),r(WZ({activeIndex:String(n),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}};function g_(e){var{fn:t,args:r}=e,s=Sr(),n=Ta();return v.useEffect(()=>{if(!n){var i=t(r);return s(BZ(i)),()=>{s(zZ(i))}}},[t,r,s,n]),null}var v_=()=>{};function ore(e){var{legendPayload:t}=e,r=Sr(),s=Ta();return v.useEffect(()=>s?v_:(r(RC(t)),()=>{r(FC(t))}),[r,s,t]),null}function lre(e){var{legendPayload:t}=e,r=Sr(),s=lt(Vt);return v.useEffect(()=>s!=="centric"&&s!=="radial"?v_:(r(RC(t)),()=>{r(FC(t))}),[r,s,t]),null}var Ch,cre=()=>{var[e]=v.useState(()=>Ql("uid-"));return e},dre=(Ch=u5.useId)!==null&&Ch!==void 0?Ch:cre;function ure(e,t){var r=dre();return t||(e?"".concat(e,"-").concat(r):r)}var mre=v.createContext(void 0),b_=e=>{var{id:t,type:r,children:s}=e,n=ure("recharts-".concat(r),t);return v.createElement(mre.Provider,{value:n},s(n))},fre={cartesianItems:[],polarItems:[]},y_=na({name:"graphicalItems",initialState:fre,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:s}=t.payload,n=dn(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=s)},removeCartesianGraphicalItem(e,t){var r=dn(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=dn(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:hre,replaceCartesianGraphicalItem:pre,removeCartesianGraphicalItem:xre,addPolarGraphicalItem:gre,removePolarGraphicalItem:vre}=y_.actions,bre=y_.reducer;function yre(e){var t=Sr(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?t(hre(e)):r.current!==e&&t(pre({prev:r.current,next:e})),r.current=e},[t,e]),v.useEffect(()=>()=>{r.current&&(t(xre(r.current)),r.current=null)},[t]),null}function jre(e){var t=Sr();return v.useEffect(()=>(t(gre(e)),()=>{t(vre(e))}),[t,e]),null}var wre=["onMouseEnter","onClick","onMouseLeave"],Nre=["id"],Sre=["id"];function o1(e,t){if(e==null)return{};var r,s,n=Ere(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ere(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function _N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_N(Object(r),!0).forEach(function(s){Tre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_N(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Tre(e,t,r){return(t=Cre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cre(e){var t=Are(e,"string");return typeof t=="symbol"?t:t+""}function Are(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hn(){return Hn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hn.apply(null,arguments)}function kre(e){var t=v.useMemo(()=>Ng(e.children,Wc),[e.children]),r=lt(s=>$te(s,e.id,t));return r==null?null:v.createElement(lre,{legendPayload:r})}function _re(e){var{dataKey:t,nameKey:r,sectors:s,stroke:n,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:s.map(d=>d.tooltipPayload),positions:s.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:om(l,t),hide:c,type:u,color:o,unit:""}}}var Ire=(e,t)=>e>t?"start":e<t?"end":"middle",Pre=(e,t,r)=>Ss(typeof t=="function"?t(e):t,r,r*.8),Dre=(e,t,r)=>{var{top:s,left:n,width:i,height:o}=t,l=TC(i,o),c=n+Ss(e.cx,i,i/2),u=s+Ss(e.cy,o,o/2),d=Ss(e.innerRadius,l,0),m=Pre(r,e.outerRadius,l),f=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:m,maxRadius:f}},Ore=(e,t)=>{var r=es(t-e),s=Math.min(Math.abs(t-e),360);return r*s};function Rre(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Fre=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Pt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(MC,Hn({},t,{type:"linear",className:r}))},Lre=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var s=r;if(typeof e=="function"&&(s=e(t),v.isValidElement(s)))return s;var n=Pt("recharts-pie-label-text",Rre(e));return v.createElement(km,Hn({},t,{alignmentBaseline:"middle",className:n}),s)};function Mre(e){var{sectors:t,props:r,showLabels:s}=e,{label:n,labelLine:i,dataKey:o}=r;if(!s||!n||!t)return null;var l=Jn(r),c=Hr(n,!1),u=Hr(i,!1),d=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,m=t.map((f,h)=>{var x=(f.startAngle+f.endAngle)/2,p=Fr(f.cx,f.cy,f.outerRadius+d,x),g=ur(ur(ur(ur({},l),f),{},{stroke:"none"},c),{},{index:h,textAnchor:Ire(p.x,f.cx)},p),b=ur(ur(ur(ur({},l),f),{},{fill:"none",stroke:f.fill},u),{},{index:h,points:[Fr(f.cx,f.cy,f.outerRadius,x),p],key:"line"});return v.createElement(Hs,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(h)},i&&Fre(i,b),Lre(n,g,jr(f,o)))});return v.createElement(Hs,{className:"recharts-pie-labels"},m)}function Bre(e){var{sectors:t,props:r,showLabels:s}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?v.createElement(u_,{label:n}):v.createElement(Mre,{sectors:t,props:r,showLabels:s})}function zre(e){var{sectors:t,activeShape:r,inactiveShape:s,allOtherPieProps:n}=e,i=lt(Bi),{onMouseEnter:o,onClick:l,onMouseLeave:c}=n,u=o1(n,wre),d=a1(o,n.dataKey),m=n1(c),f=i1(l,n.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((h,x)=>{if(h?.startAngle===0&&h?.endAngle===0&&t.length!==1)return null;var p=r&&String(x)===i,g=i?s:null,b=p?r:g,y=ur(ur({},h),{},{stroke:h.stroke,tabIndex:-1,[IC]:x,[PC]:n.dataKey});return v.createElement(Hs,Hn({tabIndex:-1,className:"recharts-pie-sector"},Ac(u,h,x),{onMouseEnter:d(h,x),onMouseLeave:m(h,x),onClick:f(h,x),key:"sector-".concat(h?.startAngle,"-").concat(h?.endAngle,"-").concat(h.midAngle,"-").concat(x)}),v.createElement(x_,Hn({option:b,isActive:p,shapeType:"sector"},y)))}))}function $re(e){var t,{pieSettings:r,displayedData:s,cells:n,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:m}=r,f=Math.abs(r.minAngle),h=Ore(l,c),x=Math.abs(h),p=s.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=s.filter(w=>jr(w,u,0)!==0).length,b=(x>=360?g:g-1)*p,y=x-g*f-b,j=s.reduce((w,N)=>{var C=jr(N,u,0);return w+(ut(C)?C:0)},0),S;if(j>0){var E;S=s.map((w,N)=>{var C=jr(w,u,0),T=jr(w,d,N),_=Dre(r,i,w),k=(ut(C)?C:0)/j,I,L=ur(ur({},w),n&&n[N]&&n[N].props);N?I=E.endAngle+es(h)*p*(C!==0?1:0):I=l;var D=I+es(h)*((C!==0?f:0)+k*y),M=(I+D)/2,q=(_.innerRadius+_.outerRadius)/2,Z=[{name:T,value:C,payload:L,dataKey:u,type:m}],Q=Fr(_.cx,_.cy,q,M);return E=ur(ur(ur(ur({},r.presentationProps),{},{percent:k,cornerRadius:o,name:T,tooltipPayload:Z,midAngle:M,middleRadius:q,tooltipPosition:Q},L),_),{},{value:C,startAngle:I,endAngle:D,payload:L,paddingAngle:es(h)*p}),E})}return S}function Ure(e){var{showLabels:t,sectors:r,children:s}=e,n=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(Ete,{value:t?n:void 0},s)}function Wre(e){var{props:t,previousSectorsRef:r}=e,{sectors:s,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:m}=t,f=fm(t,"recharts-pie-"),h=r.current,[x,p]=v.useState(!1),g=v.useCallback(()=>{typeof m=="function"&&m(),p(!1)},[m]),b=v.useCallback(()=>{typeof d=="function"&&d(),p(!0)},[d]);return v.createElement(Ure,{showLabels:!x,sectors:s},v.createElement(mm,{animationId:f,begin:i,duration:o,isActive:n,easing:l,onAnimationStart:b,onAnimationEnd:g,key:f},y=>{var j=[],S=s&&s[0],E=S?.startAngle;return s?.forEach((w,N)=>{var C=h&&h[N],T=N>0?Ri(w,"paddingAngle",0):0;if(C){var _=ds(C.endAngle-C.startAngle,w.endAngle-w.startAngle,y),k=ur(ur({},w),{},{startAngle:E+T,endAngle:E+_+T});j.push(k),E=k.endAngle}else{var{endAngle:I,startAngle:L}=w,D=ds(0,I-L,y),M=ur(ur({},w),{},{startAngle:E+T,endAngle:E+D+T});j.push(M),E=M.endAngle}}),r.current=j,v.createElement(Hs,null,v.createElement(zre,{sectors:j,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),v.createElement(Bre,{showLabels:!x,sectors:s,props:t}),t.children)}var Hre={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ji.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Vre(e){var{id:t}=e,r=o1(e,Nre),{hide:s,className:n,rootTabIndex:i}=e,o=v.useMemo(()=>Ng(e.children,Wc),[e.children]),l=lt(d=>Ute(d,t,o)),c=v.useRef(null),u=Pt("recharts-pie",n);return s||l==null?(c.current=null,v.createElement(Hs,{tabIndex:i,className:u})):v.createElement(v.Fragment,null,v.createElement(g_,{fn:_re,args:ur(ur({},e),{},{sectors:l})}),v.createElement(Hs,{tabIndex:i,className:u},v.createElement(Wre,{props:ur(ur({},r),{},{sectors:l}),previousSectorsRef:c})))}function j_(e){var t=Rs(e,Hre),{id:r}=t,s=o1(t,Sre),n=Jn(s);return v.createElement(b_,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(jre,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),v.createElement(kre,Hn({},s,{id:i})),v.createElement(Vre,Hn({},s,{id:i}))))}j_.displayName="Pie";function IN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function PN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(r),!0).forEach(function(s){Gre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Gre(e,t,r){return(t=qre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qre(e){var t=Kre(e,"string");return typeof t=="symbol"?t:t+""}function Kre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yre={xAxis:{},yAxis:{},zAxis:{}},w_=na({name:"cartesianAxis",initialState:Yre,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:s}=t.payload;e.yAxis[r]&&(e.yAxis[r]=PN(PN({},e.yAxis[r]),{},{width:s}))}}}),{addXAxis:Xre,removeXAxis:Jre,addYAxis:Zre,removeYAxis:Qre,addZAxis:Nce,removeZAxis:Sce,updateYAxisWidth:ese}=w_.actions,tse=w_.reducer,rse=je([Vr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),sse=je([rse,Nn,Sn],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),N_=()=>lt(sse),ase="Invariant failed";function nse(e,t){throw new Error(ase)}var ise=["x","y"];function cx(){return cx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},cx.apply(null,arguments)}function DN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DN(Object(r),!0).forEach(function(s){ose(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ose(e,t,r){return(t=lse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lse(e){var t=cse(e,"string");return typeof t=="symbol"?t:t+""}function cse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dse(e,t){if(e==null)return{};var r,s,n=use(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function use(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function mse(e,t){var{x:r,y:s}=e,n=dse(e,ise),i="".concat(r),o=parseInt(i,10),l="".concat(s),c=parseInt(l,10),u="".concat(t.height||n.height),d=parseInt(u,10),m="".concat(t.width||n.width),f=parseInt(m,10);return hl(hl(hl(hl(hl({},t),n),o?{x:o}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function l1(e){return v.createElement(x_,cx({shapeType:"rectangle",propTransformer:mse,activeClassName:"recharts-active-bar"},e))}var fse=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,n)=>{if(ut(t))return t;var i=ut(s)||rs(s);return i?t(s,n):(i||nse(),r)}},hse={},S_=na({name:"errorBars",initialState:hse,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]||(e[r]=[]),e[r].push(s)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:s,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==s.dataKey||n.direction!==s.direction))}}}),{addErrorBar:Ece,replaceErrorBar:Tce,removeErrorBar:Cce}=S_.actions,pse=S_.reducer,xse=["children"];function gse(e,t){if(e==null)return{};var r,s,n=vse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vse(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var bse={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},yse=v.createContext(bse);function jse(e){var{children:t}=e,r=gse(e,xse);return v.createElement(yse.Provider,{value:r},t)}function E_(e,t){var r,s,n=lt(u=>Tn(u,e)),i=lt(u=>Cn(u,t)),o=(r=n?.allowDataOverflow)!==null&&r!==void 0?r:Vs.allowDataOverflow,l=(s=i?.allowDataOverflow)!==null&&s!==void 0?s:Gs.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function wse(e){var{xAxisId:t,yAxisId:r,clipPathId:s}=e,n=N_(),{needClipX:i,needClipY:o,needClip:l}=E_(t,r);if(!l)return null;var{x:c,y:u,width:d,height:m}=n;return v.createElement("clipPath",{id:"clipPath-".concat(s)},v.createElement("rect",{x:i?c:c-d/2,y:o?u:u-m/2,width:i?d:d*2,height:o?m:m*2}))}var Nse=["onMouseEnter","onMouseLeave","onClick"],Sse=["value","background","tooltipPosition"],Ese=["id"],Tse=["onMouseEnter","onClick","onMouseLeave"];function Vn(){return Vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vn.apply(null,arguments)}function ON(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ON(Object(r),!0).forEach(function(s){Cse(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ON(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Cse(e,t,r){return(t=Ase(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ase(e){var t=kse(e,"string");return typeof t=="symbol"?t:t+""}function kse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cu(e,t){if(e==null)return{};var r,s,n=_se(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _se(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ise=e=>{var{dataKey:t,name:r,fill:s,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:s,value:om(r,t),payload:e}]};function Pse(e){var{dataKey:t,stroke:r,strokeWidth:s,fill:n,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:n,dataKey:t,nameKey:void 0,name:om(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function Dse(e){var t=lt(Bi),{data:r,dataKey:s,background:n,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,u=Cu(i,Nse),d=a1(o,s),m=n1(l),f=i1(c,s);if(!n||r==null)return null;var h=Hr(n,!1);return v.createElement(v.Fragment,null,r.map((x,p)=>{var{value:g,background:b,tooltipPosition:y}=x,j=Cu(x,Sse);if(!b)return null;var S=d(x,p),E=m(x,p),w=f(x,p),N=_s(_s(_s(_s(_s({option:n,isActive:String(p)===t},j),{},{fill:"#eee"},b),h),Ac(u,x,p)),{},{onMouseEnter:S,onMouseLeave:E,onClick:w,dataKey:s,index:p,className:"recharts-bar-background-rectangle"});return v.createElement(l1,Vn({key:"background-bar-".concat(N.index)},N))}))}function Ose(e){var{showLabels:t,children:r,rects:s}=e,n=s?.map(i=>{var o={x:i.x,y:i.y,width:i.width,height:i.height};return _s(_s({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return v.createElement(Ste,{value:t?n:void 0},r)}function Rse(e){var{shape:t,activeBar:r,baseProps:s,entry:n,index:i,dataKey:o}=e,l=lt(Bi),c=lt(Hk),u=r&&String(i)===l&&(c==null||o===c),d=u?r:t;return v.createElement(l1,Vn({},s,n,{isActive:u,option:d,index:i,dataKey:o}))}function Fse(e){var{shape:t,baseProps:r,entry:s,index:n,dataKey:i}=e;return v.createElement(l1,Vn({},r,s,{isActive:!1,option:t,index:n,dataKey:i}))}function Lse(e){var{data:t,props:r}=e,s=Jn(r),{id:n}=s,i=Cu(s,Ese),{shape:o,dataKey:l,activeBar:c}=r,{onMouseEnter:u,onClick:d,onMouseLeave:m}=r,f=Cu(r,Tse),h=a1(u,l),x=n1(m),p=i1(d,l);return t?v.createElement(v.Fragment,null,t.map((g,b)=>v.createElement(Hs,Vn({className:"recharts-bar-rectangle"},Ac(f,g,b),{onMouseEnter:h(g,b),onMouseLeave:x(g,b),onClick:p(g,b),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(b)}),c?v.createElement(Rse,{shape:o,activeBar:c,baseProps:i,entry:g,index:b,dataKey:l}):v.createElement(Fse,{shape:o,baseProps:i,entry:g,index:b,dataKey:l})))):null}function Mse(e){var{props:t,previousRectanglesRef:r}=e,{data:s,layout:n,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,m=r.current,f=fm(t,"recharts-bar-"),[h,x]=v.useState(!1),p=!h,g=v.useCallback(()=>{typeof u=="function"&&u(),x(!1)},[u]),b=v.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return v.createElement(Ose,{showLabels:p,rects:s},v.createElement(mm,{animationId:f,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:b,key:f},y=>{var j=y===1?s:s?.map((S,E)=>{var w=m&&m[E];if(w)return _s(_s({},S),{},{x:ds(w.x,S.x,y),y:ds(w.y,S.y,y),width:ds(w.width,S.width,y),height:ds(w.height,S.height,y)});if(n==="horizontal"){var N=ds(0,S.height,y);return _s(_s({},S),{},{y:S.y+S.height-N,height:N})}var C=ds(0,S.width,y);return _s(_s({},S),{},{width:C})});return y>0&&(r.current=j??null),j==null?null:v.createElement(Hs,null,v.createElement(Lse,{props:t,data:j}))}),v.createElement(u_,{label:t.label}),t.children)}function Bse(e){var t=v.useRef(null);return v.createElement(Mse,{previousRectanglesRef:t,props:e})}var T_=0,zse=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:jr(e,t)}};class $se extends v.PureComponent{render(){var{hide:t,data:r,dataKey:s,className:n,xAxisId:i,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=Pt("recharts-bar",n),m=u;return v.createElement(Hs,{className:d,id:u},l&&v.createElement("defs",null,v.createElement(wse,{clipPathId:m,xAxisId:i,yAxisId:o})),v.createElement(Hs,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},v.createElement(Dse,{data:r,dataKey:s,background:c,allOtherBarProps:this.props}),v.createElement(Bse,this.props)))}}var Use={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ji.isSsr,legendType:"rect",minPointSize:T_,xAxisId:0,yAxisId:0};function Wse(e){var{xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:m}=E_(t,r),f=Hg(),h=Ta(),x=Ng(e.children,Wc),p=lt(y=>gae(y,t,r,h,e.id,x));if(f!=="vertical"&&f!=="horizontal")return null;var g,b=p?.[0];return b==null||b.height==null||b.width==null?g=0:g=f==="vertical"?b.height/2:b.width/2,v.createElement(jse,{xAxisId:t,yAxisId:r,data:p,dataPointFormatter:zse,errorBarOffset:g},v.createElement($se,Vn({},e,{layout:f,needClip:m,data:p,xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function Hse(e){var{layout:t,barSettings:{dataKey:r,minPointSize:s},pos:n,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:m,offset:f,cells:h,parentViewBox:x}=e,p=t==="horizontal"?l:o,g=d?p.scale.domain():null,b=aq({numericAxis:p});return m.map((y,j)=>{var S,E,w,N,C,T;d?S=ZG(d[j],g):(S=jr(y,r),Array.isArray(S)||(S=[b,S]));var _=fse(s,T_)(S[1],j);if(t==="horizontal"){var k,[I,L]=[l.scale(S[0]),l.scale(S[1])];E=jj({axis:o,ticks:c,bandSize:i,offset:n.offset,entry:y,index:j}),w=(k=L??I)!==null&&k!==void 0?k:void 0,N=n.size;var D=I-L;if(C=ra(D)?0:D,T={x:E,y:f.top,width:N,height:f.height},Math.abs(_)>0&&Math.abs(C)<Math.abs(_)){var M=es(C||_)*(Math.abs(_)-Math.abs(C));w-=M,C+=M}}else{var[q,Z]=[o.scale(S[0]),o.scale(S[1])];if(E=q,w=jj({axis:l,ticks:u,bandSize:i,offset:n.offset,entry:y,index:j}),N=Z-q,C=n.size,T={x:f.left,y:w,width:f.width,height:C},Math.abs(_)>0&&Math.abs(N)<Math.abs(_)){var Q=es(N||_)*(Math.abs(_)-Math.abs(N));N+=Q}}if(E==null||w==null||N==null||C==null)return null;var U=_s(_s({},y),{},{x:E,y:w,width:N,height:C,value:d?S:S[1],payload:y,background:T,tooltipPosition:{x:E+N/2,y:w+C/2},parentViewBox:x},h&&h[j]&&h[j].props);return U}).filter(Boolean)}function Vse(e){var t=Rs(e,Use),r=Ta();return v.createElement(b_,{id:t.id,type:"bar"},s=>v.createElement(v.Fragment,null,v.createElement(ore,{legendPayload:Ise(t)}),v.createElement(g_,{fn:Pse,args:t}),v.createElement(yre,{type:"bar",id:s,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:sq(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(Wse,Vn({},t,{id:s}))))}var jl=v.memo(Vse);jl.displayName="Bar";function RN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RN(Object(r),!0).forEach(function(s){Gse(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Gse(e,t,r){return(t=qse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qse(e){var t=Kse(e,"string");return typeof t=="symbol"?t:t+""}function Kse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yse=(e,t)=>t,Xse=(e,t,r)=>r,Jse=(e,t,r,s)=>s,Zse=(e,t,r,s,n)=>n,Hc=je([Av,Zse],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Qse=je([Hc],e=>e?.maxBarSize),eae=(e,t,r,s,n,i)=>i,FN=(e,t,r)=>{var s=r??e;if(!rs(s))return Ss(s,t,0)},tae=je([Vt,Av,Yse,Xse,Jse],(e,t,r,s,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===s).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),rae=(e,t,r,s)=>{var n=Vt(e);return n==="horizontal"?sx(e,"yAxis",r,s):sx(e,"xAxis",t,s)},sae=(e,t,r)=>{var s=Vt(e);return s==="horizontal"?Mw(e,"xAxis",t):Mw(e,"yAxis",r)},aae=(e,t,r)=>{var s={},n=e.filter(Nm),i=e.filter(u=>u.stackId==null),o=n.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),s),l=Object.entries(o).map(u=>{var[d,m]=u,f=m.map(x=>x.dataKey),h=FN(t,r,m[0].barSize);return{stackId:d,dataKeys:f,barSize:h}}),c=i.map(u=>{var d=[u.dataKey].filter(f=>f!=null),m=FN(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:m}});return[...l,...c]},nae=je([tae,MJ,sae],aae),iae=(e,t,r,s,n)=>{var i,o,l=Hc(e,t,r,s,n);if(l!=null){var c=Vt(e),u=UA(e),{maxBarSize:d}=l,m=rs(d)?u:d,f,h;return c==="horizontal"?(f=Fo(e,"xAxis",t,s),h=Ro(e,"xAxis",t,s)):(f=Fo(e,"yAxis",r,s),h=Ro(e,"yAxis",r,s)),(i=(o=Bg(f,h,!0))!==null&&o!==void 0?o:m)!==null&&i!==void 0?i:0}},C_=(e,t,r,s)=>{var n=Vt(e),i,o;return n==="horizontal"?(i=Fo(e,"xAxis",t,s),o=Ro(e,"xAxis",t,s)):(i=Fo(e,"yAxis",r,s),o=Ro(e,"yAxis",r,s)),Bg(i,o)};function oae(e,t,r,s,n){var i=s.length;if(!(i<1)){var o=Ss(e,r,0,!0),l,c=[];if(aa(s[0].barSize)){var u=!1,d=r/i,m=s.reduce((b,y)=>b+(y.barSize||0),0);m+=(i-1)*o,m>=r&&(m-=(i-1)*o,o=0),m>=r&&d>0&&(u=!0,d*=.9,m=i*d);var f=(r-m)/2>>0,h={offset:f-o,size:0};l=s.reduce((b,y)=>{var j,S={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(j=y.barSize)!==null&&j!==void 0?j:0}},E=[...b,S];return h=E[E.length-1].position,E},c)}else{var x=Ss(t,r,0,!0);r-2*x-(i-1)*o<=0&&(o=0);var p=(r-2*x-(i-1)*o)/i;p>1&&(p>>=0);var g=aa(n)?Math.min(p,n):p;l=s.reduce((b,y,j)=>[...b,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:x+(p+o)*j+(p-g)/2,size:g}}],c)}return l}}var lae=(e,t,r,s,n,i,o)=>{var l=rs(o)?t:o,c=oae(r,s,n!==i?n:i,e,l);return n!==i&&c!=null&&(c=c.map(u=>Sd(Sd({},u),{},{position:Sd(Sd({},u.position),{},{offset:u.position.offset-n/2})}))),c},cae=je([nae,UA,LJ,WA,iae,C_,Qse],lae),dae=(e,t,r,s)=>Fo(e,"xAxis",t,s),uae=(e,t,r,s)=>Fo(e,"yAxis",r,s),mae=(e,t,r,s)=>Ro(e,"xAxis",t,s),fae=(e,t,r,s)=>Ro(e,"yAxis",r,s),hae=je([cae,Hc],(e,t)=>{if(!(e==null||t==null)){var r=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),pae=(e,t)=>{var r=Ev(t);if(!(!e||r==null||t==null)){var{stackId:s}=t;if(s!=null){var n=e[s];if(n){var{stackedData:i}=n;if(i)return i.find(o=>o.key===r)}}}},xae=je([rae,Hc],pae),gae=je([Vr,zg,dae,uae,mae,fae,hae,Vt,xv,C_,xae,Hc,eae],(e,t,r,s,n,i,o,l,c,u,d,m,f)=>{var{chartData:h,dataStartIndex:x,dataEndIndex:p}=c;if(!(m==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||s==null||n==null||i==null||u==null)){var{data:g}=m,b;if(g!=null&&g.length>0?b=g:b=h?.slice(x,p+1),b!=null)return Hse({layout:l,barSettings:m,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:i,stackedData:d,displayedData:b,offset:e,cells:f})}}),A_=e=>{var{chartData:t}=e,r=Sr(),s=Ta();return v.useEffect(()=>s?()=>{}:(r(Kw(t)),()=>{r(Kw(void 0))}),[t,r,s]),null},LN={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},k_=na({name:"brush",initialState:LN,reducers:{setBrushSettings(e,t){return t.payload==null?LN:t.payload}}}),{setBrushSettings:Ace}=k_.actions,vae=k_.reducer;function bae(e,t,r){return(t=yae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yae(e){var t=jae(e,"string");return typeof t=="symbol"?t:t+""}function jae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class c1{static create(t){return new c1(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),s=r[0],n=r[r.length-1];return s<=n?t>=s&&t<=n:t>=n&&t<=s}}bae(c1,"EPS",1e-4);function wae(e){return(e%180+180)%180}var Nae=function(t){var{width:r,height:s}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=wae(n),o=i*Math.PI/180,l=Math.atan(s/r),c=o>l&&o<Math.PI-l?s/Math.sin(o):r/Math.cos(o);return Math.abs(c)},Sae={dots:[],areas:[],lines:[]},__=na({name:"referenceElements",initialState:Sae,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=dn(e).dots.findIndex(s=>s===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=dn(e).areas.findIndex(s=>s===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=dn(e).lines.findIndex(s=>s===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:kce,removeDot:_ce,addArea:Ice,removeArea:Pce,addLine:Dce,removeLine:Oce}=__.actions,Eae=__.reducer,Tae=v.createContext(void 0),Cae=e=>{var{children:t}=e,[r]=v.useState("".concat(Ql("recharts"),"-clip")),s=N_();if(s==null)return null;var{x:n,y:i,width:o,height:l}=s;return v.createElement(Tae.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:n,y:i,height:l,width:o}))),t)};function Lo(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function I_(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var s=[],n=0;n<e.length;n+=t)s.push(e[n]);return s}function Aae(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return Nae(s,r)}function kae(e,t,r){var s=r==="width",{x:n,y:i,width:o,height:l}=e;return t===1?{start:s?n:i,end:s?n+o:i+l}:{start:s?n+o:i+l,end:s?n:i}}function Au(e,t,r,s,n){if(e*t<e*s||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-n)<=0}function _ae(e,t){return I_(e,t+1)}function Iae(e,t,r,s,n){for(var i=(s||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,m=function(){var x=s?.[c];if(x===void 0)return{v:I_(s,u)};var p=c,g,b=()=>(g===void 0&&(g=r(x,p)),g),y=x.coordinate,j=c===0||Au(e,y,b,d,l);j||(c=0,d=o,u+=1),j&&(d=y+e*(b()/2+n),c+=u)},f;u<=i.length;)if(f=m(),f)return f.v;return[]}function MN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MN(Object(r),!0).forEach(function(s){Pae(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Pae(e,t,r){return(t=Dae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dae(e){var t=Oae(e,"string");return typeof t=="symbol"?t:t+""}function Oae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rae(e,t,r,s,n){for(var i=(s||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,u=function(f){var h=i[f],x,p=()=>(x===void 0&&(x=r(h,f)),x);if(f===o-1){var g=e*(h.coordinate+e*p()/2-c);i[f]=h=xs(xs({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[f]=h=xs(xs({},h),{},{tickCoord:h.coordinate});var b=Au(e,h.tickCoord,p,l,c);b&&(c=h.tickCoord-e*(p()/2+n),i[f]=xs(xs({},h),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function Fae(e,t,r,s,n,i){var o=(s||[]).slice(),l=o.length,{start:c,end:u}=t;if(i){var d=s[l-1],m=r(d,l-1),f=e*(d.coordinate+e*m/2-u);o[l-1]=d=xs(xs({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate});var h=Au(e,d.tickCoord,()=>m,c,u);h&&(u=d.tickCoord-e*(m/2+n),o[l-1]=xs(xs({},d),{},{isShow:!0}))}for(var x=i?l-1:l,p=function(y){var j=o[y],S,E=()=>(S===void 0&&(S=r(j,y)),S);if(y===0){var w=e*(j.coordinate-e*E()/2-c);o[y]=j=xs(xs({},j),{},{tickCoord:w<0?j.coordinate-w*e:j.coordinate})}else o[y]=j=xs(xs({},j),{},{tickCoord:j.coordinate});var N=Au(e,j.tickCoord,E,c,u);N&&(c=j.tickCoord+e*(E()/2+n),o[y]=xs(xs({},j),{},{isShow:!0}))},g=0;g<x;g++)p(g);return o}function d1(e,t,r){var{tick:s,ticks:n,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:m}=e;if(!n||!n.length||!s)return[];if(ut(c)||Ji.isSsr){var f;return(f=_ae(n,ut(c)?c:0))!==null&&f!==void 0?f:[]}var h=[],x=l==="top"||l==="bottom"?"width":"height",p=d&&x==="width"?Il(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(j,S)=>{var E=typeof u=="function"?u(j.value,S):j.value;return x==="width"?Aae(Il(E,{fontSize:t,letterSpacing:r}),p,m):Il(E,{fontSize:t,letterSpacing:r})[x]},b=n.length>=2?es(n[1].coordinate-n[0].coordinate):1,y=kae(i,b,x);return c==="equidistantPreserveStart"?Iae(b,y,g,n,o):(c==="preserveStart"||c==="preserveStartEnd"?h=Fae(b,y,g,n,o,c==="preserveStartEnd"):h=Rae(b,y,g,n,o),h.filter(j=>j.isShow))}var Lae=e=>{var{ticks:t,label:r,labelGapWithTick:s=5,tickSize:n=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(d=>{if(d){var m=d.getBoundingClientRect();m.width>o&&(o=m.width)}});var l=r?r.getBoundingClientRect().width:0,c=n+i,u=o+c+l+(r?s:0);return Math.round(u)}return 0},Mae=["axisLine","width","height","className","hide","ticks"],Bae=["viewBox"],zae=["viewBox"];function dx(e,t){if(e==null)return{};var r,s,n=$ae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $ae(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function zi(){return zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zi.apply(null,arguments)}function BN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BN(Object(r),!0).forEach(function(s){Uae(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Uae(e,t,r){return(t=Wae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wae(e){var t=Hae(e,"string");return typeof t=="symbol"?t:t+""}function Hae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u1={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function Vae(e){var{x:t,y:r,width:s,height:n,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=zr(zr(zr({},c),Hr(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!o||i==="bottom"&&o);u=zr(zr({},u),{},{x1:t,y1:r+d*n,x2:t+s,y2:r+d*n})}else{var m=+(i==="left"&&!o||i==="right"&&o);u=zr(zr({},u),{},{x1:t+m*s,y1:r,x2:t+m*s,y2:r+n})}return v.createElement("line",zi({},u,{className:Pt("recharts-cartesian-axis-line",Ri(l,"className"))}))}function Gae(e,t,r,s,n,i,o,l,c){var u,d,m,f,h,x,p=l?-1:1,g=e.tickSize||o,b=ut(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,f=r+ +!l*n,m=f-p*g,x=m-p*c,h=b;break;case"left":m=f=e.coordinate,d=t+ +!l*s,u=d-p*g,h=u-p*c,x=b;break;case"right":m=f=e.coordinate,d=t+ +l*s,u=d+p*g,h=u+p*c,x=b;break;default:u=d=e.coordinate,f=r+ +l*n,m=f+p*g,x=m+p*c,h=b;break}return{line:{x1:u,y1:m,x2:d,y2:f},tick:{x:h,y:x}}}function qae(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Kae(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Yae(e){var{option:t,tickProps:r,value:s}=e,n,i=Pt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))n=v.cloneElement(t,zr(zr({},r),{},{className:i}));else if(typeof t=="function")n=t(zr(zr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Pt(o,t?.className)),n=v.createElement(km,zi({},r,{className:o}),s)}return n}function Xae(e){var{ticks:t=[],tick:r,tickLine:s,stroke:n,tickFormatter:i,unit:o,padding:l,tickTextProps:c,orientation:u,mirror:d,x:m,y:f,width:h,height:x,tickSize:p,tickMargin:g,fontSize:b,letterSpacing:y,getTicksConfig:j,events:S}=e,E=d1(zr(zr({},j),{},{ticks:t}),b,y),w=qae(u,d),N=Kae(u,d),C=Jn(j),T=Hr(r,!1),_=zr(zr({},C),{},{fill:"none"},Hr(s,!1)),k=E.map((I,L)=>{var{line:D,tick:M}=Gae(I,m,f,h,x,u,p,d,g),q=zr(zr(zr(zr({textAnchor:w,verticalAnchor:N},C),{},{stroke:"none",fill:n},T),M),{},{index:L,payload:I,visibleTicksCount:E.length,tickFormatter:i,padding:l},c);return v.createElement(Hs,zi({className:"recharts-cartesian-axis-tick",key:"tick-".concat(I.value,"-").concat(I.coordinate,"-").concat(I.tickCoord)},Ac(S,I,L)),s&&v.createElement("line",zi({},_,D,{className:Pt("recharts-cartesian-axis-tick-line",Ri(s,"className"))})),r&&v.createElement(Yae,{option:r,tickProps:q,value:"".concat(typeof i=="function"?i(I.value,L):I.value).concat(o||"")}))});return k.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},k):null}var Jae=v.forwardRef((e,t)=>{var{axisLine:r,width:s,height:n,className:i,hide:o,ticks:l}=e,c=dx(e,Mae),[u,d]=v.useState(""),[m,f]=v.useState(""),h=v.useRef([]);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var p;return Lae({ticks:h.current,label:(p=e.labelRef)===null||p===void 0?void 0:p.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=v.useCallback(p=>{if(p){var g=p.getElementsByClassName("recharts-cartesian-axis-tick-value");h.current=Array.from(g);var b=g[0];if(b){var y=window.getComputedStyle(b),j=y.fontSize,S=y.letterSpacing;(j!==u||S!==m)&&(d(j),f(S))}}},[u,m]);return o||s!=null&&s<=0||n!=null&&n<=0?null:v.createElement(Hs,{className:Pt("recharts-cartesian-axis",i),ref:x},v.createElement(Vae,{x:e.x,y:e.y,width:s,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Jn(e)}),v.createElement(Xae,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:m,getTicksConfig:e,events:c}),v.createElement(ste,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(fte,{label:e.label}),e.children))}),Zae=v.memo(Jae,(e,t)=>{var{viewBox:r}=e,s=dx(e,Bae),{viewBox:n}=t,i=dx(t,zae);return Lo(r,n)&&Lo(s,i)}),m1=v.forwardRef((e,t)=>{var r=Rs(e,u1);return v.createElement(Zae,zi({},r,{ref:t}))});m1.displayName="CartesianAxis";var Qae=["x1","y1","x2","y2","key"],ene=["offset"],tne=["xAxisId","yAxisId"],rne=["xAxisId","yAxisId"];function zN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zN(Object(r),!0).forEach(function(s){sne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sne(e,t,r){return(t=ane(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ane(e){var t=nne(e,"string");return typeof t=="symbol"?t:t+""}function nne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xi(){return xi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xi.apply(null,arguments)}function ku(e,t){if(e==null)return{};var r,s,n=ine(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ine(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var one=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:s,y:n,width:i,height:o,ry:l}=e;return v.createElement("rect",{x:s,y:n,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function P_(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:s,y1:n,x2:i,y2:o,key:l}=t,c=ku(t,Qae),u=Jn(c),{offset:d}=u,m=ku(u,ene);r=v.createElement("line",xi({},m,{x1:s,y1:n,x2:i,y2:o,fill:"none",key:l}))}return r}function lne(e){var{x:t,width:r,horizontal:s=!0,horizontalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=ku(e,tne),c=n.map((u,d)=>{var m=ys(ys({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return P_(s,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function cne(e){var{y:t,height:r,vertical:s=!0,verticalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=ku(e,rne),c=n.map((u,d)=>{var m=ys(ys({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return P_(s,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function dne(e){var{horizontalFill:t,fillOpacity:r,x:s,y:n,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=l.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var h=!u[f+1],x=h?n+o-m:u[f+1]-m;if(x<=0)return null;var p=f%t.length;return v.createElement("rect",{key:"react-".concat(f),y:m,x:s,height:x,width:i,stroke:"none",fill:t[p],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function une(e){var{vertical:t=!0,verticalFill:r,fillOpacity:s,x:n,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var h=!u[f+1],x=h?n+o-m:u[f+1]-m;if(x<=0)return null;var p=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:m,y:i,width:x,height:l,stroke:"none",fill:r[p],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var mne=(e,t)=>{var{xAxis:r,width:s,height:n,offset:i}=e;return AC(d1(ys(ys(ys({},u1),r),{},{ticks:kC(r),viewBox:{x:0,y:0,width:s,height:n}})),i.left,i.left+i.width,t)},fne=(e,t)=>{var{yAxis:r,width:s,height:n,offset:i}=e;return AC(d1(ys(ys(ys({},u1),r),{},{ticks:kC(r),viewBox:{x:0,y:0,width:s,height:n}})),i.top,i.top+i.height,t)},hne={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Id(e){var t=Ug(),r=Wg(),s=DC(),n=ys(ys({},Rs(e,hne)),{},{x:ut(e.x)?e.x:s.left,y:ut(e.y)?e.y:s.top,width:ut(e.width)?e.width:s.width,height:ut(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:m,horizontalValues:f,verticalValues:h}=n,x=Ta(),p=lt(T=>Bw(T,"xAxis",i,x)),g=lt(T=>Bw(T,"yAxis",o,x));if(!ut(u)||u<=0||!ut(d)||d<=0||!ut(l)||l!==+l||!ut(c)||c!==+c)return null;var b=n.verticalCoordinatesGenerator||mne,y=n.horizontalCoordinatesGenerator||fne,{horizontalPoints:j,verticalPoints:S}=n;if((!j||!j.length)&&typeof y=="function"){var E=f&&f.length,w=y({yAxis:g?ys(ys({},g),{},{ticks:E?f:g.ticks}):void 0,width:t,height:r,offset:s},E?!0:m);_l(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(j=w)}if((!S||!S.length)&&typeof b=="function"){var N=h&&h.length,C=b({xAxis:p?ys(ys({},p),{},{ticks:N?h:p.ticks}):void 0,width:t,height:r,offset:s},N?!0:m);_l(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(S=C)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(one,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),v.createElement(dne,xi({},n,{horizontalPoints:j})),v.createElement(une,xi({},n,{verticalPoints:S})),v.createElement(lne,xi({},n,{offset:s,horizontalPoints:j,xAxis:p,yAxis:g})),v.createElement(cne,xi({},n,{offset:s,verticalPoints:S,xAxis:p,yAxis:g})))}Id.displayName="CartesianGrid";var pne=["dangerouslySetInnerHTML","ticks"],xne=["id"],gne=["domain"],vne=["domain"];function ux(){return ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ux.apply(null,arguments)}function _u(e,t){if(e==null)return{};var r,s,n=bne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function yne(e){var t=Sr();return v.useEffect(()=>(t(Xre(e)),()=>{t(Jre(e))}),[e,t]),null}var jne=e=>{var{xAxisId:t,className:r}=e,s=lt(zg),n=Ta(),i="xAxis",o=lt(g=>Xo(g,i,t,n)),l=lt(g=>Ek(g,i,t,n)),c=lt(g=>jk(g,t)),u=lt(g=>kZ(g,t)),d=lt(g=>ZA(g,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:f}=e,h=_u(e,pne),{id:x}=d,p=_u(d,xne);return v.createElement(m1,ux({},h,p,{scale:o,x:u.x,y:u.y,width:c.width,height:c.height,className:Pt("recharts-".concat(i," ").concat(i),r),viewBox:s,ticks:l}))},wne={allowDataOverflow:Vs.allowDataOverflow,allowDecimals:Vs.allowDecimals,allowDuplicatedCategory:Vs.allowDuplicatedCategory,height:Vs.height,hide:!1,mirror:Vs.mirror,orientation:Vs.orientation,padding:Vs.padding,reversed:Vs.reversed,scale:Vs.scale,tickCount:Vs.tickCount,type:Vs.type,xAxisId:0},Nne=e=>{var t,r,s,n,i,o=Rs(e,wne);return v.createElement(v.Fragment,null,v.createElement(yne,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(s=o.angle)!==null&&s!==void 0?s:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(jne,o))},Sne=(e,t)=>{var{domain:r}=e,s=_u(e,gne),{domain:n}=t,i=_u(t,vne);return Lo(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Lo({domain:r},{domain:n}):!1},Pd=v.memo(Nne,Sne);Pd.displayName="XAxis";var Ene=["dangerouslySetInnerHTML","ticks"],Tne=["id"],Cne=["domain"],Ane=["domain"];function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mx.apply(null,arguments)}function Iu(e,t){if(e==null)return{};var r,s,n=kne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function _ne(e){var t=Sr();return v.useEffect(()=>(t(Zre(e)),()=>{t(Qre(e))}),[e,t]),null}var Ine=e=>{var{yAxisId:t,className:r,width:s,label:n}=e,i=v.useRef(null),o=v.useRef(null),l=lt(zg),c=Ta(),u=Sr(),d="yAxis",m=lt(E=>Xo(E,d,t,c)),f=lt(E=>wk(E,t)),h=lt(E=>IZ(E,t)),x=lt(E=>Ek(E,d,t,c)),p=lt(E=>QA(E,t));if(v.useLayoutEffect(()=>{if(!(s!=="auto"||!f||Qv(n)||v.isValidElement(n)||p==null)){var E=i.current;if(E){var w=E.getCalculatedWidth();Math.round(f.width)!==Math.round(w)&&u(ese({id:t,width:w}))}}},[x,f,u,n,t,s,p]),f==null||h==null||p==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,y=Iu(e,Ene),{id:j}=p,S=Iu(p,Tne);return v.createElement(m1,mx({},y,S,{ref:i,labelRef:o,scale:m,x:h.x,y:h.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:f.width,height:f.height,className:Pt("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:x}))},Pne={allowDataOverflow:Gs.allowDataOverflow,allowDecimals:Gs.allowDecimals,allowDuplicatedCategory:Gs.allowDuplicatedCategory,hide:!1,mirror:Gs.mirror,orientation:Gs.orientation,padding:Gs.padding,reversed:Gs.reversed,scale:Gs.scale,tickCount:Gs.tickCount,type:Gs.type,width:Gs.width,yAxisId:0},Dne=e=>{var t,r,s,n,i,o=Rs(e,Pne);return v.createElement(v.Fragment,null,v.createElement(_ne,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(s=o.angle)!==null&&s!==void 0?s:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(Ine,o))},One=(e,t)=>{var{domain:r}=e,s=Iu(e,Cne),{domain:n}=t,i=Iu(t,Ane);return Lo(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Lo({domain:r},{domain:n}):!1},Dd=v.memo(Dne,One);Dd.displayName="YAxis";var Ah={exports:{}},kh={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $N;function Rne(){if($N)return kh;$N=1;var e=bx();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,n=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return kh.useSyncExternalStoreWithSelector=function(c,u,d,m,f){var h=n(null);if(h.current===null){var x={hasValue:!1,value:null};h.current=x}else x=h.current;h=o(function(){function g(E){if(!b){if(b=!0,y=E,E=m(E),f!==void 0&&x.hasValue){var w=x.value;if(f(w,E))return j=w}return j=E}if(w=j,r(y,E))return w;var N=m(E);return f!==void 0&&f(w,N)?(y=E,w):(y=E,j=N)}var b=!1,y,j,S=d===void 0?null:d;return[function(){return g(u())},S===null?void 0:function(){return g(S())}]},[u,d,m,f]);var p=s(c,h[0],h[1]);return i(function(){x.hasValue=!0,x.value=p},[p]),l(p),p},kh}var UN;function Fne(){return UN||(UN=1,Ah.exports=Rne()),Ah.exports}Fne();function Lne(e){e()}function Mne(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Lne(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!s||e===null||(s=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var WN={notify(){},get:()=>[]};function Bne(e,t){let r,s=WN,n=0,i=!1;function o(p){d();const g=s.subscribe(p);let b=!1;return()=>{b||(b=!0,g(),m())}}function l(){s.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){n++,r||(r=e.subscribe(c),s=Mne())}function m(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=WN)}function f(){i||(i=!0,d())}function h(){i&&(i=!1,m())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>s};return x}var zne=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$ne=zne(),Une=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Wne=Une(),Hne=()=>$ne||Wne?v.useLayoutEffect:v.useEffect,Vne=Hne(),Gne=Symbol.for("react-redux-context"),qne=typeof globalThis<"u"?globalThis:{};function Kne(){if(!v.createContext)return{};const e=qne[Gne]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var Yne=Kne();function Xne(e){const{children:t,context:r,serverState:s,store:n}=e,i=v.useMemo(()=>{const c=Bne(n);return{store:n,subscription:c,getServerState:s?()=>s:void 0}},[n,s]),o=v.useMemo(()=>n.getState(),[n]);Vne(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||Yne;return v.createElement(l.Provider,{value:i},t)}var Jne=Xne,Zne=(e,t)=>t,f1=je([Zne,Vt,YA,qr,zk,An,RQ,Vr],zQ),h1=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/s)}},D_=Na("mouseClick"),O_=_c();O_.startListening({actionCreator:D_,effect:(e,t)=>{var r=e.payload,s=f1(t.getState(),h1(r));s?.activeIndex!=null&&t.dispatch(HZ({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var fx=Na("mouseMove"),R_=_c();R_.startListening({actionCreator:fx,effect:(e,t)=>{var r=e.payload,s=t.getState(),n=Hv(s,s.tooltip.settings.shared),i=f1(s,h1(r));n==="axis"&&(i?.activeIndex!=null?t.dispatch(Dk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(Pk()))}});var HN={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},F_=na({name:"rootProps",initialState:HN,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:HN.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Qne=F_.reducer,{updateOptions:eie}=F_.actions,L_=na({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:tie}=L_.actions,rie=L_.reducer,M_=Na("keyDown"),B_=Na("focus"),p1=_c();p1.startListening({actionCreator:M_,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(Vv(n,Zo(r))),l=An(r);if(i==="Enter"){var c=Nu(r,"axis","hover",String(n.index));t.dispatch(nx({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:c}));return}var u=RZ(r),d=u==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,f=o+m*d;if(!(l==null||f>=l.length||f<0)){var h=Nu(r,"axis","hover",String(f));t.dispatch(nx({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});p1.startListening({actionCreator:B_,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",o=Nu(r,"axis","hover",String(i));t.dispatch(nx({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var fa=Na("externalEvent"),z_=_c();z_.startListening({actionCreator:fa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),s={activeCoordinate:TQ(r),activeDataKey:Hk(r),activeIndex:Bi(r),activeLabel:Wk(r),activeTooltipIndex:Bi(r),isTooltipActive:CQ(r)};e.payload.handler(s,e.payload.reactEvent)}}});var sie=je([Jo],e=>e.tooltipItemPayloads),aie=je([sie,$c,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,s)=>{var n=e.find(l=>l.settings.dataKey===s);if(n!=null){var{positions:i}=n;if(i!=null){var o=t(i,r);return o}}}),$_=Na("touchMove"),U_=_c();U_.startListening({actionCreator:$_,effect:(e,t)=>{var r=e.payload,s=t.getState(),n=Hv(s,s.tooltip.settings.shared);if(n==="axis"){var i=f1(s,h1({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(Dk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var o,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(IC),d=(o=c.getAttribute(PC))!==null&&o!==void 0?o:void 0,m=aie(t.getState(),u,d);t.dispatch(Ik({activeDataKey:d,activeIndex:u,activeCoordinate:m}))}}});var nie=sC({brush:vae,cartesianAxis:tse,chartData:ree,errorBars:pse,graphicalItems:bre,layout:FG,legend:Tq,options:JQ,polarAxis:Rte,polarOptions:rie,referenceElements:Eae,rootProps:Qne,tooltip:VZ}),iie=function(t){return oG({reducer:nie,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([O_.middleware,R_.middleware,p1.middleware,z_.middleware,U_.middleware]),devTools:Ji.devToolsEnabled})};function W_(e){var{preloadedState:t,children:r,reduxStoreName:s}=e,n=Ta(),i=v.useRef(null);if(n)return r;i.current==null&&(i.current=iie(t));var o=Dg;return v.createElement(Jne,{context:o,store:i.current},r)}function H_(e){var{layout:t,width:r,height:s,margin:n}=e,i=Sr(),o=Ta();return v.useEffect(()=>{o||(i(DG(t)),i(OG({width:r,height:s})),i(PG(n)))},[i,o,t,r,s,n]),null}function V_(e){var t=Sr();return v.useEffect(()=>{t(eie(e))},[t,e]),null}var oie=["children"];function lie(e,t){if(e==null)return{};var r,s,n=cie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Pu(){return Pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Pu.apply(null,arguments)}var die={width:"100%",height:"100%"},uie=v.forwardRef((e,t)=>{var r=Ug(),s=Wg(),n=LC();if(!_o(r)||!_o(s))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,u,d;return typeof o.tabIndex=="number"?u=o.tabIndex:u=n?0:void 0,typeof o.role=="string"?d=o.role:d=n?"application":void 0,v.createElement(Sg,Pu({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:s,style:die,ref:t}),i)}),mie=e=>{var{children:t}=e,r=lt(um);if(!r)return null;var{width:s,height:n,y:i,x:o}=r;return v.createElement(Sg,{width:s,height:n,x:o,y:i},t)},VN=v.forwardRef((e,t)=>{var{children:r}=e,s=lie(e,oie),n=Ta();return n?v.createElement(mie,null,r):v.createElement(uie,Pu({ref:t},s),r)});function fie(){var e=Sr(),[t,r]=v.useState(null),s=lt(uq);return v.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;aa(i)&&i!==s&&e(RG(i))}},[t,e,s]),r}function GN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function hie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GN(Object(r),!0).forEach(function(s){pie(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function pie(e,t,r){return(t=xie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xie(e){var t=gie(e,"string");return typeof t=="symbol"?t:t+""}function gie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vie=v.forwardRef((e,t)=>{var{children:r,className:s,height:n,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:m,onMouseUp:f,onTouchEnd:h,onTouchMove:x,onTouchStart:p,style:g,width:b}=e,y=Sr(),[j,S]=v.useState(null),[E,w]=v.useState(null);uee();var N=fie(),C=v.useCallback(P=>{N(P),typeof t=="function"&&t(P),S(P),w(P)},[N,t,S,w]),T=v.useCallback(P=>{y(D_(P)),y(fa({handler:i,reactEvent:P}))},[y,i]),_=v.useCallback(P=>{y(fx(P)),y(fa({handler:u,reactEvent:P}))},[y,u]),k=v.useCallback(P=>{y(Pk()),y(fa({handler:d,reactEvent:P}))},[y,d]),I=v.useCallback(P=>{y(fx(P)),y(fa({handler:m,reactEvent:P}))},[y,m]),L=v.useCallback(()=>{y(B_())},[y]),D=v.useCallback(P=>{y(M_(P.key))},[y]),M=v.useCallback(P=>{y(fa({handler:o,reactEvent:P}))},[y,o]),q=v.useCallback(P=>{y(fa({handler:l,reactEvent:P}))},[y,l]),Z=v.useCallback(P=>{y(fa({handler:c,reactEvent:P}))},[y,c]),Q=v.useCallback(P=>{y(fa({handler:f,reactEvent:P}))},[y,f]),U=v.useCallback(P=>{y(fa({handler:p,reactEvent:P}))},[y,p]),le=v.useCallback(P=>{y($_(P)),y(fa({handler:x,reactEvent:P}))},[y,x]),Se=v.useCallback(P=>{y(fa({handler:h,reactEvent:P}))},[y,h]);return v.createElement(Xk.Provider,{value:j},v.createElement(ST.Provider,{value:E},v.createElement("div",{className:Pt("recharts-wrapper",s),style:hie({position:"relative",cursor:"default",width:b,height:n},g),onClick:T,onContextMenu:M,onDoubleClick:q,onFocus:L,onKeyDown:D,onMouseDown:Z,onMouseEnter:_,onMouseLeave:k,onMouseMove:I,onMouseUp:Q,onTouchEnd:Se,onTouchMove:le,onTouchStart:U,ref:C},r)))}),bie=["children","className","width","height","style","compact","title","desc"];function yie(e,t){if(e==null)return{};var r,s,n=jie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var G_=v.forwardRef((e,t)=>{var{children:r,className:s,width:n,height:i,style:o,compact:l,title:c,desc:u}=e,d=yie(e,bie),m=Jn(d);return l?v.createElement(VN,{otherAttributes:m,title:c,desc:u},r):v.createElement(vie,{className:s,style:o,width:n,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(VN,{otherAttributes:m,title:c,desc:u,ref:t},v.createElement(Cae,null,r)))}),wie=["width","height"];function hx(){return hx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hx.apply(null,arguments)}function Nie(e,t){if(e==null)return{};var r,s,n=Sie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Sie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Eie={top:5,right:5,bottom:5,left:5},Tie={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Eie,reverseStackOrder:!1,syncMethod:"index"},Cie=v.forwardRef(function(t,r){var s,n=Rs(t.categoricalChartProps,Tie),{width:i,height:o}=n,l=Nie(n,wie);if(!_o(i)||!_o(o))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,categoricalChartProps:f}=t,h={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,eventEmitter:void 0};return v.createElement(W_,{preloadedState:{options:h},reduxStoreName:(s=f.id)!==null&&s!==void 0?s:c},v.createElement(A_,{chartData:f.data}),v.createElement(H_,{width:i,height:o,layout:n.layout,margin:n.margin}),v.createElement(V_,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(G_,hx({},l,{width:i,height:o,ref:r})))}),Aie=["axis","item"],_h=v.forwardRef((e,t)=>v.createElement(Cie,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Aie,tooltipPayloadSearcher:Jk,categoricalChartProps:e,ref:t}));function kie(e){var t=Sr();return v.useEffect(()=>{t(tie(e))},[t,e]),null}var _ie=["width","height","layout"];function px(){return px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},px.apply(null,arguments)}function Iie(e,t){if(e==null)return{};var r,s,n=Pie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Die={top:5,right:5,bottom:5,left:5},Oie={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Die,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Rie=v.forwardRef(function(t,r){var s,n=Rs(t.categoricalChartProps,Oie),{width:i,height:o,layout:l}=n,c=Iie(n,_ie);if(!_o(i)||!_o(o))return null;var{chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f}=t,h={chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(W_,{preloadedState:{options:h},reduxStoreName:(s=n.id)!==null&&s!==void 0?s:u},v.createElement(A_,{chartData:n.data}),v.createElement(H_,{width:i,height:o,layout:l,margin:n.margin}),v.createElement(V_,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(kie,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),v.createElement(G_,px({width:i,height:o},c,{ref:r})))}),Fie=["item"],Lie={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Mie=v.forwardRef((e,t)=>{var r=Rs(e,Lie);return v.createElement(Rie,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Fie,tooltipPayloadSearcher:Jk,categoricalChartProps:r,ref:t})});const Bie=()=>{it();const[e,t]=v.useState(!1),r=[{title:"Create New Department",description:"Create a new academic department for course management",icon:Bs,action:()=>{console.log("Create New Department")},color:"primary"}],[s,n]=v.useState({ongoingCourses:[],ongoingEnrollments:[],assessmentStatuses:[],passFailRate:[]});v.useEffect(()=>{(async()=>{t(!0);try{await new Promise(c=>setTimeout(c,1e3)),n({ongoingCourses:[{department:"Operations",count:15},{department:"Maintenance",count:12},{department:"Safety",count:8},{department:"Quality",count:10},{department:"Training",count:6}],ongoingEnrollments:[{department:"Operations",count:245},{department:"Maintenance",count:180},{department:"Safety",count:120},{department:"Quality",count:150},{department:"Training",count:95}],assessmentStatuses:[{status:"NOT_STARTED",count:150},{status:"DRAFT",count:30},{status:"SUBMITTED",count:45},{status:"APPROVED",count:85},{status:"REJECTED",count:12},{status:"CANCELLED",count:8}],passFailRate:[{department:"Operations",pass:120,fail:15},{department:"Maintenance",pass:95,fail:8},{department:"Safety",pass:80,fail:5},{department:"Quality",pass:100,fail:10},{department:"Training",pass:60,fail:3}]})}catch(c){console.error("Error fetching analytics data:",c)}finally{t(!1)}})()},[]);const i=["#1b3c53","#456882","#6a9fb8","#8fb6ce","#b4d3e4","#d9e9f2"],o={NOT_STARTED:"#6c757d",DRAFT:"#ffc107",SUBMITTED:"#0d6efd",APPROVED:"#28a745",REJECTED:"#dc3545",CANCELLED:"#6c757d"};return a.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:a.jsxs(_e,{className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{lg:12,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),a.jsx(W.Body,{children:a.jsx(de,{children:r.map((l,c)=>a.jsx(z,{md:4,className:"mb-3",children:a.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:l.action,children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(l.icon,{size:24,className:`text-${l.color} me-2`}),a.jsx("h6",{className:"mb-0",children:l.title})]}),a.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:l.description}),a.jsx(mn,{size:16,className:`text-${l.color} ms-auto`})]})},c))})})]})})}),e?a.jsx(de,{children:a.jsx(z,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading analytics data..."})]})})}):a.jsxs(a.Fragment,{children:[a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{lg:6,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(Ed,{className:"me-2",size:20}),"Ongoing Courses"]})}),a.jsx(W.Body,{children:a.jsx(Nd,{width:"100%",height:300,children:a.jsxs(_h,{data:s.ongoingCourses,children:[a.jsx(Id,{strokeDasharray:"3 3"}),a.jsx(Pd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(Dd,{}),a.jsx(wd,{}),a.jsx(fi,{}),a.jsx(jl,{dataKey:"count",fill:"#1b3c53",name:"Number of Courses"})]})})})]})}),a.jsx(z,{lg:6,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(Ed,{className:"me-2",size:20}),"Ongoing Trainees"]})}),a.jsx(W.Body,{children:a.jsx(Nd,{width:"100%",height:300,children:a.jsxs(_h,{data:s.ongoingEnrollments,children:[a.jsx(Id,{strokeDasharray:"3 3"}),a.jsx(Pd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(Dd,{}),a.jsx(wd,{}),a.jsx(fi,{}),a.jsx(jl,{dataKey:"count",fill:"#456882",name:"Number of Trainees"})]})})})]})})]}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{lg:6,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(S2,{className:"me-2",size:20}),"Assessment Results"]})}),a.jsx(W.Body,{children:a.jsx(Nd,{width:"100%",height:300,children:a.jsxs(Mie,{children:[a.jsx(j_,{data:s.assessmentStatuses,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:c})=>`${l}: ${(c*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:s.assessmentStatuses.map((l,c)=>a.jsx(Wc,{fill:o[l.status]||i[c%i.length]},`cell-${c}`))}),a.jsx(wd,{}),a.jsx(fi,{})]})})})]})}),a.jsx(z,{lg:6,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(Ed,{className:"me-2",size:20}),"Training Effectiveness (Pass/Fail Rate)"]})}),a.jsx(W.Body,{children:a.jsx(Nd,{width:"100%",height:300,children:a.jsxs(_h,{data:s.passFailRate,children:[a.jsx(Id,{strokeDasharray:"3 3"}),a.jsx(Pd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(Dd,{}),a.jsx(wd,{}),a.jsx(fi,{}),a.jsx(jl,{dataKey:"pass",stackId:"a",fill:"#28a745",name:"Pass"}),a.jsx(jl,{dataKey:"fail",stackId:"a",fill:"#dc3545",name:"Fail"})]})})})]})})]})]})]})})},zie=({courses:e,loading:t,actionsComponent:r,onView:s,onDisable:n,onRestore:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Rt,{rows:4,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No courses found"}),a.jsx("p",{children:"This department doesn't have any courses yet."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=l.key===d,x=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:x,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"department-table-container course-table-responsive",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(u,{columnKey:"name",className:"show-mobile",children:"Course Name"}),a.jsx(u,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(u,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),a.jsx(u,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),a.jsx(u,{columnKey:"venue",className:"show-mobile",children:"Venue"}),a.jsx(u,{columnKey:"note",className:"show-mobile",children:"Note"}),a.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),a.jsx("tbody",{children:o.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>s(d.id),style:{cursor:"pointer"},children:d.name})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.code})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:d.startDate||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:d.endDate||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bo,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:d.venue||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.note||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Ae,{bg:d.status==="ACTIVE"?"success":d.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.status||"N/A"})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(r,{course:d,onView:s,onDisable:n,onRestore:i})})]},d.id))})]})})},$ie=({course:e,onView:t,onDisable:r,onRestore:s})=>{const{hasPermission:n}=xc(),i=n(Te.COURSES.VIEW_DETAIL),o=n(Te.COURSES.ARCHIVE),l=n(Te.COURSES.UPDATE),c=n(Te.COURSES.RESTORE),u=o||l,d=e?.status==="ARCHIVED",m=()=>{t&&i&&t(e.id)},f=()=>{r&&u&&!d&&r(e.id)},h=()=>{s&&c&&d&&s(e.id)},x=[];return x.push({label:"View Details",icon:a.jsx(Et,{}),onClick:m,disabled:!i}),x.push({type:"divider"}),d?x.push({label:"Restore Course",icon:a.jsx(o2,{}),className:"text-success",onClick:h,disabled:!c}):x.push({label:"Delete Course",icon:a.jsx(Qs,{}),className:"text-danger",onClick:f,disabled:!u}),a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:x})},Uie=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=v.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[o,l]=v.useState({});v.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}),t()},u=f=>{const{name:h,value:x}=f.target;if(i(p=>({...p,[h]:x})),o[h]&&l(p=>({...p,[h]:""})),h==="startDate"&&x){const p=new Date;p.setHours(0,0,0,0),new Date(x+"T00:00:00")<p&&l(b=>({...b,startDate:"Start date cannot be in the past"}))}if(h==="endDate"&&x){const p=new Date;p.setHours(0,0,0,0),new Date(x+"T00:00:00")<p&&l(b=>({...b,endDate:"End date cannot be in the past"}))}},d=()=>{const f={};if(n.name.trim()||(f.name="Course name is required"),n.code.trim()||(f.code="Course code is required"),n.description.trim()||(f.description="Description is required"),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(f.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(f.venue="Venue is required"),(!n.passScore||isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(f.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)f.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<h&&(f.startDate="Start date cannot be in the past")}if(!n.endDate)f.endDate="End date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<h&&(f.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(f.endDate="End date must be after start date"),l(f),Object.keys(f).length===0},m=async f=>{if(f.preventDefault(),!!d())try{await r(n),c()}catch{}};return a.jsxs(ce,{show:e,onHide:c,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-2",size:20}),"Add New Course"]}),a.jsx(ie,{variant:"link",onClick:c,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(A,{onSubmit:m,children:[a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto",paddingTop:"1.5rem"},children:[a.jsxs(de,{className:"mb-5",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Name *"}),a.jsx(A.Control,{type:"text",name:"name",value:n.name,onChange:u,isInvalid:!!o.name,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.name})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Code *"}),a.jsx(A.Control,{type:"text",name:"code",value:n.code,onChange:u,isInvalid:!!o.code,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.code})]})})]}),a.jsxs(de,{className:"mb-5",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Max Trainees *"}),a.jsx(A.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:u,isInvalid:!!o.maxNumTrainee,disabled:s,min:"1"}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.maxNumTrainee})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Pass Score *"}),a.jsx(A.Control,{type:"number",name:"passScore",value:n.passScore,onChange:u,isInvalid:!!o.passScore,disabled:s,min:"0",max:"100",step:"1"}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),a.jsxs(de,{className:"mb-5",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Level"}),a.jsxs(A.Select,{name:"level",value:n.level,onChange:u,disabled:s,children:[a.jsx("option",{value:"BEGINNER",children:"Beginner"}),a.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),a.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Venue *"}),a.jsx(A.Control,{type:"text",name:"venue",value:n.venue,onChange:u,isInvalid:!!o.venue,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.venue})]})})]}),a.jsxs(de,{className:"mb-5",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Start Date *"}),a.jsx(A.Control,{type:"date",name:"startDate",value:n.startDate,onChange:u,isInvalid:!!o.startDate,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.startDate})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"End Date *"}),a.jsx(A.Control,{type:"date",name:"endDate",value:n.endDate,onChange:u,isInvalid:!!o.endDate,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),a.jsx(de,{className:"mb-5",children:a.jsx(z,{children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Description *"}),a.jsx(A.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:u,isInvalid:!!o.description,disabled:s}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.description})]})})}),a.jsx(de,{className:"mb-5",children:a.jsx(z,{children:a.jsxs(A.Group,{className:"mb-0",children:[a.jsx(A.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Note"}),a.jsx(A.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:u,disabled:s})]})})})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:c,disabled:s,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary-custom",type:"submit",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},Wie=({show:e,onClose:t,onArchive:r,course:s,loading:n=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),d=i==="ARCHIVE",m=()=>{o(""),c(""),t()},f=async()=>{if(!d){c('Please type "ARCHIVE" to confirm');return}try{await r(s?.id),m()}catch(x){c(x.message||"Failed to archive course. Please try again.")}},h=x=>{o(x.target.value),c("")};return a.jsxs(ce,{show:e,onHide:m,centered:!0,children:[a.jsxs(ce.Header,{className:"bg-warning text-dark border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:"me-2",size:20}),"Archive Course"]}),a.jsx(ie,{variant:"link",onClick:m,className:"text-dark p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",children:[l&&a.jsx(Re,{variant:"danger",className:"mb-3",children:l}),a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),a.jsxs("div",{className:"bg-light p-3 rounded",children:[a.jsx("strong",{children:"Course Code:"})," ",s?.code,a.jsx("br",{}),a.jsx("strong",{children:"Course Name:"})," ",s?.name,a.jsx("br",{}),s?.description&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Description:"})," ",s?.description,a.jsx("br",{})]}),s?.venue&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Venue:"})," ",s?.venue,a.jsx("br",{})]}),s?.startDate&&s?.endDate&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Duration:"})," ",s?.startDate," to ",s?.endDate]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-warning mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-warning mb-3",children:[a.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),a.jsx("li",{children:"Remove the course from active course offerings"}),a.jsx("li",{children:"Affect any ongoing training sessions"}),a.jsx("li",{children:"Course data will be archived but can be restored if needed"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",a.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),a.jsx("input",{type:"text",className:`form-control ${i&&!d?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type ARCHIVE here",disabled:n}),i&&!d&&a.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:m,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"warning",onClick:f,disabled:n||!d,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(fr,{className:"me-2",size:16}),"Archive Course"]})})]})]})},Hie=({show:e,onClose:t,departmentHead:r,department:s})=>{if(!r)return null;const n=[r.firstName,r.middleName,r.lastName].filter(Boolean).join(" ");return a.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsxs(ce.Title,{children:[a.jsx(Lt,{className:"me-2"}),"Department Head Details"]})}),a.jsx(ce.Body,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:4,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:a.jsx(Lt,{size:40,className:"text-white"})}),a.jsx("h5",{className:"mb-1",children:n}),a.jsx(Ae,{bg:"primary",className:"mb-2",children:r.role?.name||"Department Head"}),a.jsx("p",{className:"text-muted small mb-0",children:s?.name})]})}),a.jsx(z,{md:8,children:a.jsx(de,{className:"g-4",children:a.jsx(z,{md:12,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ti,{size:16,className:"me-2 text-primary"}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Email"}),a.jsx("div",{className:"fw-semibold",children:r.email||"N/A"})]})]})})})})]})}),a.jsx(ce.Footer,{children:a.jsx(ie,{variant:"secondary",onClick:t,children:"Close"})})]})},Vie=({courseId:e})=>{const t=it(),[r,s]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState(!0),[c,u]=v.useState(!1),[d,m]=v.useState("add"),[f,h]=v.useState(!1),[x,p]=v.useState(null),[g,b]=v.useState(null),[y,j]=v.useState(!1),[S,E]=v.useState(!1),w={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},N=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];v.useEffect(()=>{e&&(async()=>{l(!0);try{const q=await Jr.getDepartmentById(e);if(!q)throw new Error(`Department with ID ${e} not found in API response`);const Z={id:q.id,name:q.name,code:q.code,description:q.description,duration:"N/A",status:q.isActive,totalSubjects:q.courseCount||0,totalTrainers:q.trainerCount||0};s(Z);const Q=q.courses?.map(U=>({id:U.id,name:U.name,code:U.code,startDate:U.startDate?new Date(U.startDate).toISOString().split("T")[0]:"N/A",endDate:U.endDate?new Date(U.endDate).toISOString().split("T")[0]:"N/A",venue:U.venue||"N/A",note:U.note||"N/A",status:U.status,description:U.description,maxNumTrainee:U.maxNumTrainee,passScore:U.passScore,level:U.level,subjectCount:U.subjectCount||0}))||[];i(Q),q.headUser&&b(q.headUser),l(!1)}catch{l(!1);const M=w[e];M&&(s(M),i(N))}})()},[e]);const C=()=>{m("add"),u(!0)},T=D=>{const M=n.find(q=>q.id===D);p(M),h(!0)},_=async D=>{try{await Jr.archiveCourse(D),ne.success("Course deleted successfully"),i(M=>M.filter(q=>q.id!==D)),h(!1),p(null)}catch(M){throw ne.error("Failed to delete course. Please try again."),M}},k=async D=>{try{await Jr.restoreCourse(D),ne.success("Course restored successfully"),i(M=>M.map(q=>q.id===D?{...q,status:"ACTIVE"}:q))}catch(M){ne.error(M.response?.data?.message||"Failed to restore course. Please try again.")}},I=D=>{t(`/academic/course-detail/${D}`,{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},L=async D=>{try{E(!0);const M={departmentId:r.id,name:D.name,description:D.description,code:D.code,maxNumTrainee:Number(D.maxNumTrainee),venue:D.venue,note:D.note,passScore:Number(D.passScore),startDate:D.startDate?new Date(D.startDate).toISOString():null,endDate:D.endDate?new Date(D.endDate).toISOString():null,level:D.level},q=await Jr.createCourse(M);ne.success("Course created successfully");const Z={id:q.id,name:q.name,code:q.code,startDate:q.startDate?new Date(q.startDate).toISOString().split("T")[0]:"N/A",endDate:q.endDate?new Date(q.endDate).toISOString().split("T")[0]:"N/A",venue:q.venue||"N/A",note:q.note||"N/A",status:q.status||"PLANNED",description:q.description,maxNumTrainee:q.maxNumTrainee,passScore:q.passScore,level:q.level,department:q.department};i(Q=>[Z,...Q])}catch(M){throw M.response?.status,ne.error(M.response?.data?.message||"Failed to create course"),M}finally{E(!1)}};return o?a.jsx(_e,{className:"py-4",children:a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?a.jsxs(_e,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[a.jsx(de,{className:"mb-1 flex-shrink-0",children:a.jsx(z,{children:a.jsx(W,{className:"border-0 shadow-sm",children:a.jsxs(W.Body,{className:"p-2",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-1",children:[a.jsx(It,{className:"me-2 text-primary"}),r.name]}),a.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),a.jsx("p",{className:"text-muted mb-1 small",children:r.description}),a.jsxs(de,{className:"g-2",children:[a.jsx(z,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Total Subjects"}),a.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),a.jsx(z,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lr,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Total Trainers"}),a.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),a.jsx(z,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Department Head"}),a.jsx("div",{className:"fw-semibold small",children:g?a.jsx(ie,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>j(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName,g.middleName,g.lastName].filter(Boolean).join(" ")}):"Not assigned"})]})]})})]})]})})})}),a.jsx(de,{className:"mt-3",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0 shadow-sm",children:[a.jsx(W.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("h5",{className:"mb-0 text-white",children:[a.jsx(At,{className:"me-2"}),"Courses (",n.length,")"]}),a.jsx(hr,{permission:Te.COURSES.CREATE,children:a.jsxs(ie,{variant:"light",size:"sm",onClick:C,className:"academic-course-add-btn",children:[a.jsx(ms,{size:16,className:"me-1"}),"Add New Course"]})})]})}),a.jsx("div",{className:"p-0",children:a.jsx(zie,{courses:n,loading:!1,actionsComponent:$ie,onView:I,onDisable:T,onRestore:k})})]})})}),a.jsx(Uie,{show:c&&d==="add",onClose:()=>u(!1),onSave:L,loading:S}),a.jsx(Wie,{show:f,onClose:()=>h(!1),onArchive:_,course:x}),a.jsx(Hie,{show:y,onClose:()=>j(!1),departmentHead:g,department:r})]}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx(It,{size:48,className:"mb-3"}),a.jsx("h4",{children:"Department not found"}),a.jsx("p",{children:"The requested department could not be found."})]})})},Gie=()=>{const{courseId:e}=Nr();return a.jsx(Vie,{courseId:e})},qie=({trainer:e,onEdit:t,onDelete:r})=>a.jsx(hr,{permissions:[Te.SUBJECTS.UPDATE,Te.SUBJECTS.REMOVE_INSTRUCTOR],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"Edit Trainer",icon:a.jsx(Br,{}),onClick:()=>t(e.id),permission:Te.SUBJECTS.UPDATE},{type:"divider"},{label:"Remove Trainer",icon:a.jsx(Wi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Te.SUBJECTS.REMOVE_INSTRUCTOR}]})}),q_=({show:e,onClose:t,onDisable:r,subject:s,loading:n=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),[u,d]=v.useState(0),[m,f]=v.useState(!1),x=i==="ARCHIVE";v.useEffect(()=>{e&&s?.id?p():(d(0),o(""),c(""))},[e,s?.id]);const p=async()=>{if(s?.id){f(!0);try{const j=await Xr.getSubjectById(s.id);j?.enrollmentCount!==void 0?d(j.enrollmentCount):j?.enrollments&&Array.isArray(j.enrollments)?d(j.enrollments.length):d(0)}catch{d(0)}finally{f(!1)}}},g=()=>{o(""),c(""),d(0),t()},b=async()=>{if(!x){c('Please type "ARCHIVE" to confirm');return}try{await r(s?.id),g()}catch(j){c(j.message||"Failed to disable subject. Please try again.")}},y=j=>{o(j.target.value),c("")};return a.jsxs(ce,{show:e,onHide:g,centered:!0,children:[a.jsx(ce.Header,{className:"bg-warning text-dark border-0",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:"me-2",size:20}),"Archive Subject"]})}),a.jsxs(ce.Body,{className:"p-4",children:[l&&a.jsx(Re,{variant:"danger",className:"mb-3",children:l}),a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),a.jsxs("div",{className:"bg-light p-3 rounded",children:[a.jsx("strong",{children:"Subject Code:"})," ",s?.code,a.jsx("br",{}),a.jsx("strong",{children:"Subject Name:"})," ",s?.name,a.jsx("br",{}),s?.description&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Description:"})," ",s?.description]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-warning mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-warning mb-3",children:[a.jsx("li",{children:"Make the subject unavailable for new enrollments"}),a.jsx("li",{children:"Remove the subject from active course offerings"}),a.jsx("li",{children:"Affect any ongoing training sessions"}),u>0&&a.jsxs("li",{className:"fw-bold",children:[a.jsxs("strong",{children:["Cascade cancel all ",u," enrollment",u>1?"s":""]})," associated with this subject"]})]}),u>0&&a.jsxs("div",{className:"alert alert-warning mb-0",children:[a.jsx("strong",{children:"Total Enrollments:"})," ",a.jsx(Ae,{bg:"warning",className:"text-dark ms-2",children:u}),u>0&&a.jsxs("p",{className:"mb-0 mt-2 small",children:["All ",u," enrollment",u>1?"s":""," will be automatically cancelled when this subject is archived."]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",a.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),a.jsx("input",{type:"text",className:`form-control ${i&&!x?"is-invalid":""}`,id:"confirmText",value:i,onChange:y,placeholder:"Type ARCHIVE here",disabled:n}),i&&!x&&a.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsx(ie,{variant:"outline-secondary",onClick:g,disabled:n,children:"Cancel"}),a.jsx(ie,{variant:"warning",onClick:b,disabled:n||!x||m,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(fr,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},Kie=({show:e,onClose:t,onSave:r,subject:s,loading:n=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[l,c]=v.useState([]);v.useEffect(()=>{s&&e&&(o({name:s.name||"",code:s.code||"",description:s.description||"",duration:s.duration||"",level:s.level||"Beginner"}),c([]))},[s,e]);const u=h=>{const{name:x,value:p}=h.target;o(g=>({...g,[x]:p}))},d=()=>{const h=[];return i.name.trim()||h.push("Subject name is required"),i.code.trim()||h.push("Subject code is required"),i.description.trim()||h.push("Description is required"),i.duration.trim()||h.push("Duration is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!d())try{await r(i),f()}catch{}},f=()=>{o({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),t()};return a.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Br,{className:"me-2",size:20}),"Edit Subject"]}),a.jsx(ie,{variant:"link",onClick:f,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((h,x)=>a.jsx("li",{children:h},x))})}),a.jsxs(A,{onSubmit:m,children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Subject Name *"}),a.jsx(A.Control,{type:"text",name:"name",value:i.name,onChange:u,placeholder:"Enter subject name",disabled:n})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Subject Code *"}),a.jsx(A.Control,{type:"text",name:"code",value:i.code,onChange:u,placeholder:"Enter subject code",disabled:n})]})})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Duration *"}),a.jsx(A.Control,{type:"text",name:"duration",value:i.duration,onChange:u,placeholder:"e.g., 2 weeks, 1 month",disabled:n})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Level"}),a.jsxs(A.Select,{name:"level",value:i.level,onChange:u,disabled:n,children:[a.jsx("option",{value:"Beginner",children:"Beginner"}),a.jsx("option",{value:"Intermediate",children:"Intermediate"}),a.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Description *"}),a.jsx(A.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:u,placeholder:"Enter subject description",disabled:n})]})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary",onClick:m,disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Br,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Yie=({show:e,onClose:t,onSave:r,trainer:s,loading:n=!1})=>{const[i,o]=v.useState({roleInSubject:"EXAMINER"}),[l,c]=v.useState([]);v.useEffect(()=>{if(s&&e){const h=s.role==="EXAMINER"||s.role==="ASSESSMENT_REVIEWER"?s.role:"EXAMINER";o({roleInSubject:h}),c([])}},[s,e]);const u=h=>{const{name:x,value:p}=h.target;o(g=>({...g,[x]:p}))},d=()=>{const h=[];return i.roleInSubject||h.push("Role in assessment is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!d())try{await r(i),f()}catch{}},f=()=>{o({roleInSubject:"EXAMINER"}),c([]),t()};return a.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Br,{className:"me-2",size:20}),"Edit Trainer"]}),a.jsx(ie,{variant:"link",onClick:f,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((h,x)=>a.jsx("li",{children:h},x))})}),a.jsxs(A,{onSubmit:m,children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Trainer Name"}),a.jsx(A.Control,{type:"text",value:s?.name||"",disabled:!0,className:"bg-light"})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"EID"}),a.jsx(A.Control,{type:"text",value:s?.eid||"",disabled:!0,className:"bg-light"})]})})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Role in Assessment *"}),a.jsxs(A.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:u,disabled:n,children:[a.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),a.jsx(A.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary",onClick:m,disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Br,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Xie=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=v.useState({trainer_user_id:"",role_in_subject:"EXAMINER"}),[o,l]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!1),f=async()=>{m(!0);try{const g=await os.getTrainers();let b=[];g&&(g.data&&Array.isArray(g.data)?b=g.data:g.users&&Array.isArray(g.users)?b=g.users:g.data&&g.data.users&&Array.isArray(g.data.users)?b=g.data.users:Array.isArray(g)&&(b=g)),u(Array.isArray(b)?b:[])}catch(g){console.error("Error loading trainers:",g),u([])}finally{m(!1)}};v.useEffect(()=>{e&&(i({trainer_user_id:"",role_in_subject:"EXAMINER"}),l([]),f())},[e]);const h=()=>{const g=[];return n.trainer_user_id||g.push("Please select a trainer"),n.role_in_subject||g.push("Role in assessment is required"),l(g),g.length===0},x=async g=>{if(g.preventDefault(),!!h())try{await r(n),p()}catch{}},p=()=>{i({trainer_user_id:"",role_in_subject:"EXAMINER"}),l([]),t()};return a.jsxs(ce,{show:e,onHide:p,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-2",size:20}),"Add Trainer"]}),a.jsx(ie,{variant:"link",onClick:p,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",children:[o.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:o.map((g,b)=>a.jsx("li",{children:g},b))})}),a.jsx(A,{onSubmit:x,children:a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Select Trainer *"}),a.jsxs(Mt,{onSelect:g=>{i(b=>({...b,trainer_user_id:g||""}))},children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:s||d,style:{border:"1px solid #ced4da",backgroundColor:s||d?"#e9ecef":"#fff",minWidth:0},children:a.jsx("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:n.trainer_user_id?c.find(g=>g.id===n.trainer_user_id)?`${c.find(g=>g.id===n.trainer_user_id).firstName} ${c.find(g=>g.id===n.trainer_user_id).lastName} - ${c.find(g=>g.id===n.trainer_user_id).department?.name||"General"}`:"Choose a trainer...":d?"Loading trainers...":"Choose a trainer..."})}),a.jsx(Mt.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:d?a.jsxs(Mt.Item,{disabled:!0,children:[a.jsx(Ot,{animation:"border",size:"sm",className:"me-2"}),"Loading trainers..."]}):!Array.isArray(c)||c.length===0?a.jsx(Mt.Item,{disabled:!0,children:"No trainers available"}):c.map(g=>a.jsxs(Mt.Item,{eventKey:g.id,children:[g.firstName," ",g.lastName," - ",g.department?.name||"General"]},g.id))})]}),d&&a.jsxs("div",{className:"mt-2 text-center",children:[a.jsx(Ot,{animation:"border",size:"sm",className:"me-2"}),a.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Role in Assessment *"}),a.jsxs(Mt,{onSelect:g=>{i(b=>({...b,role_in_subject:g||"EXAMINER"}))},children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:s,style:{border:"1px solid #ced4da",backgroundColor:s?"#e9ecef":"#fff",minWidth:0},children:a.jsxs("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:[n.role_in_subject==="EXAMINER"&&"Examiner - Conducts exams and assessments",n.role_in_subject==="ASSESSMENT_REVIEWER"&&"Assessment Reviewer - Reviews and grades assessments"]})}),a.jsxs(Mt.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:[a.jsx(Mt.Item,{eventKey:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),a.jsx(Mt.Item,{eventKey:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]})]}),a.jsx(A.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})]})})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:p,disabled:s,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary",onClick:x,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Adding..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ms,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},K_=({courseId:e,subjectId:t,onView:r})=>{const[s,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e&&!t){n([]),o(!1);return}try{o(!0),c(null);const p=((await pc.getAssessmentEvents())?.data?.events||[]).filter(g=>t?g.subjectId===t:e?g.courseId===e:!1).map((g,b)=>{let y="",j="";return g.entityInfo&&(g.entityInfo.type==="subject"?y=g.entityInfo.name||"":g.entityInfo.type==="course"&&(j=g.entityInfo.name||"")),{id:g.id||`event-${b}`,name:g.name||"N/A",subject:y,course:j,occurrenceDate:g.occuranceDate||g.occurrenceDate,status:g.status||"N/A",totalTrainees:g.totalTrainees||0,templateInfo:g.templateInfo,originalEvent:g}});n(p)}catch(f){console.error("Error loading assessment events:",f),c(f.response?.data?.message||f.message||"Failed to load assessment events"),ne.error("Failed to load assessment events"),n([])}finally{o(!1)}})()},[e,t]);const u=m=>{switch(String(m||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},d=m=>{if(!m)return"-";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return i?a.jsx("div",{children:a.jsx(Rt,{rows:4,columns:6})}):l?a.jsx("div",{children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:l})]})}):s.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx(Ra,{size:48,className:"mb-3",style:{opacity:.5}}),a.jsx("h5",{children:"No assessment events found"}),a.jsxs("p",{children:["There are no assessment events available for this ",t?"subject":"course","."]})]})}):a.jsx("div",{children:a.jsx("div",{className:"table-responsive",children:a.jsxs(Gt,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),!t&&a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Subject"}),a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Template"}),a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Occurrence Date"}),a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Total Trainees"}),a.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Status"}),a.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:s.map((m,f)=>a.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=""},children:[a.jsx("td",{className:"align-middle",children:a.jsx("span",{className:"fw-medium",children:m.name||"-"})}),!t&&a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:m.subject||"-"})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:m.templateInfo?.name||"-"})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:d(m.occurrenceDate)})}),a.jsx("td",{className:"align-middle",children:a.jsx(Ae,{bg:"info",className:"px-2 py-1",children:m.totalTrainees||0})}),a.jsx("td",{className:"align-middle",children:a.jsx(Ae,{bg:u(m.status),className:"px-3 py-2",children:m.status||"-"})}),a.jsx("td",{className:"align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r&&r(m.originalEvent||m)}]})})]},m.id||f))})]})})})},x1=({show:e,onClose:t,event:r})=>{if(!r)return null;const s=d=>{if(!d)return"-";try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return d}},n=d=>{switch(String(d||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},i=r.entityInfo?.type||"-",o=r.entityInfo?.name||"-",l=r.entityInfo?.code||"-";r.entityInfo?.id;const c=r.templateInfo?.name||"-";r.templateInfo?.id;const u=r.templateInfo?.isActive??!1;return a.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,dialogClassName:"assessment-event-detail-modal",children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[a.jsx(Ra,{className:"me-2",size:20}),"Assessment Event Details"]}),a.jsx(ie,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},children:a.jsx(nt,{size:24,color:"#ffffff"})})]}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",backgroundColor:"var(--bs-light)",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[a.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[a.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[a.jsx(At,{className:"me-2",size:18}),a.jsx("span",{className:"fw-semibold",children:"Basic Information"})]}),a.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Event Name"}),a.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:r.name||"-"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[a.jsx(nr,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Occurrence Date"]}),a.jsx("span",{style:{color:"var(--bs-dark)"},children:s(r.occuranceDate||r.occurrenceDate)})]})]}),a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),a.jsx(Ae,{bg:n(r.status),className:"px-3 py-2",children:r.status||"-"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[a.jsx(Lr,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Total Trainees"]}),a.jsx(Ae,{bg:"info",className:"px-3 py-2",children:r.totalTrainees||0})]})]})]})})]}),a.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[a.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[a.jsx(It,{className:"me-2",size:18}),a.jsx("span",{className:"fw-semibold",children:i==="course"?"Course Information":i==="subject"?"Subject Information":"Entity Information"})]}),a.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Name"}),a.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:o})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Code"}),a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",children:l})]})]}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Type"}),a.jsx(Ae,{bg:i==="course"?"primary":i==="subject"?"info":"secondary",className:"px-2 py-1",children:i.toUpperCase()})]})})]})})]}),a.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[a.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[a.jsx(At,{className:"me-2",size:18}),a.jsx("span",{className:"fw-semibold",children:"Template Information"})]}),a.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Template Name"}),a.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:c})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),a.jsx(Ae,{bg:u?"success":"danger",className:"px-2 py-1",children:u?"Active":"Inactive"})]})})]})})]})]}),a.jsx(ce.Footer,{className:"border-top",children:a.jsx(ie,{variant:"secondary",onClick:t,children:"Close"})})]})},Jie=({subjectId:e,courseId:t})=>{const r=it(),s=Gn(),[n,i]=v.useState(null),[o,l]=v.useState([]),[c,u]=v.useState(!0),[d,m]=v.useState(!1),[f,h]=v.useState(!1),[x,p]=v.useState(!1),[g,b]=v.useState(!1),[y,j]=v.useState(null),[S,E]=v.useState(!1),[w,N]=v.useState(!1),[C,T]=v.useState(!1),[_,k]=v.useState(!1),[I,L]=v.useState(!1),[D,M]=v.useState(null),[q,Z]=v.useState("subject-info"),{sortedData:Q}=Zt(o),U=H=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[H]||{text:H,variant:"light"},le=v.useCallback(H=>{if(H&&H.instructors){const Y=H.instructors.map(te=>({id:te.id,eid:te.eid,name:`${te.firstName} ${te.lastName}`,role:te.roleInSubject,assignedAt:te.assignedAt}));l(Y)}else l([])},[]);v.useEffect(()=>{e&&(async()=>{if(!e){i(null),u(!1);return}u(!0);try{const Y=await Xr.getSubjectById(e);Y?(i(Y),le(Y)):i(null)}catch(Y){let te=Y.response?.data?.message||Y.message||"Failed to load subject details";if(Y.response?.data?.errors&&Array.isArray(Y.response.data.errors)&&Y.response.data.errors.length>0){const pe=Y.response.data.errors[0];te=`${te}: ${pe.message||pe.field}`}ne.error(te),i(null)}finally{u(!1)}})()},[e,le]);const Se=async H=>{N(!0);try{await new Promise(Y=>setTimeout(Y,1e3)),i(Y=>({...Y,...H})),ne.success("Subject updated successfully!"),h(!1)}catch{ne.error("Failed to update subject")}finally{N(!1)}},P=async()=>{E(!0);try{await new Promise(H=>setTimeout(H,1e3)),m(!1)}catch{}finally{E(!1)}},G=async H=>{T(!0);try{await Xr.addTrainerToSubject(e,H);const Y=await Xr.getSubjectById(e);Y&&(i(Y),le(Y)),ne.success("Trainer added successfully!"),p(!1)}catch(Y){const te=Y?.message||Y?.error||"Failed to add trainer";ne.error(te)}finally{T(!1)}},K=async H=>{if(y){k(!0);try{await Xr.updateTrainerRole(e,y.id,H);const Y=await Xr.getSubjectById(e);Y&&(i(Y),le(Y)),ne.success("Trainer role updated successfully!"),b(!1)}catch(Y){console.error("Error updating trainer role:",Y);const te=Y?.message||Y?.error||"Failed to update trainer role";ne.error(te)}finally{k(!1)}}},O=async H=>{if(H)try{await Xr.removeTrainerFromSubject(e,H);const Y=await Xr.getSubjectById(e);Y&&(i(Y),le(Y)),ne.success("Trainer removed successfully!")}catch(Y){console.error("Error removing trainer:",Y);const te=Y?.message||Y?.error||"Failed to remove trainer";ne.error(te)}},F=()=>{if(t)r(`/academic/course-detail/${t}`);else if(s.state?.courseId)r(`/academic/course-detail/${s.state.courseId}`);else if(document.referrer){const H=document.referrer.match(/\/course-detail\/([^/]+)/);r(H?`/academic/course-detail/${H[1]}`:-1)}else n?.courseId?r(`/academic/course-detail/${n.courseId}`):r(-1)};return c?a.jsx(_e,{className:"py-4",children:a.jsx(Rt,{rows:4,columns:3})}):n?a.jsxs(_e,{className:"py-4 subject-details",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:F,className:"me-3",children:[a.jsx(_t,{className:"me-2",size:16}),"Back to Course"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.name}),a.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",n.code]})]})]})}),a.jsx(W,{className:"border-0 shadow-sm",children:a.jsxs(Ft.Container,{activeKey:q,onSelect:Z,children:[a.jsxs(W.Header,{className:"border-bottom py-2 bg-primary d-flex justify-content-between align-items-center",children:[a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:q==="subject-info"?"600":"400",opacity:q==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(g2,{className:"me-2",size:16}),"Subject Information"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:q==="trainers"?"600":"400",opacity:q==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(w2,{className:"me-2",size:16}),"Trainers"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:q==="assessment-events"?"600":"400",opacity:q==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Ra,{className:"me-2",size:16}),"All Related Assessment Events"]})})]}),q==="trainers"&&a.jsxs(ie,{variant:"light",size:"sm",onClick:()=>p(!0),className:"d-flex align-items-center",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#f8f9fa",H.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="#ffffff",H.currentTarget.style.borderColor="#dee2e6"},children:[a.jsx(ms,{size:14,className:"me-1"}),"Add Trainer"]})]}),a.jsx(W.Body,{className:"p-0",children:a.jsxs(Ft.Content,{children:[a.jsx(Ft.Pane,{eventKey:"subject-info",children:a.jsxs("div",{className:"p-4",children:[a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Name:"})," ",n.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Code:"})," ",n.code]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Description:"})," ",n.description]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Method:"})," ",n.method]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Duration:"})," ",n.duration," days"]})]}),a.jsxs(z,{md:6,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Type:"})," ",n.type]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Pass Score:"})," ",n.passScore]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Room:"})," ",n.roomName]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Time Slot:"})," ",n.timeSlot]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Start Date:"})," ",new Date(n.startDate).toLocaleDateString()]}),a.jsxs("p",{children:[a.jsx("strong",{children:"End Date:"})," ",new Date(n.endDate).toLocaleDateString()]})]})]}),n.remarkNote&&a.jsx(de,{children:a.jsx(z,{xs:12,children:a.jsxs("p",{children:[a.jsx("strong",{children:"Remark Note:"})," ",n.remarkNote]})})})]})}),a.jsx(Ft.Pane,{eventKey:"trainers",children:a.jsxs(Gt,{hover:!0,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"EID"}),a.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),a.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Role"}),a.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Assigned Date"}),a.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:Q.map(H=>{const Y=U(H.role);return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Ae,{bg:"secondary",className:"text-white",children:H.eid})}),a.jsx("td",{children:H.name}),a.jsx("td",{children:a.jsx(Ae,{bg:Y.variant,children:Y.text})}),a.jsx("td",{children:H.assignedAt&&!isNaN(new Date(H.assignedAt).getTime())?new Date(H.assignedAt).toLocaleDateString():"N/A"}),a.jsx("td",{children:a.jsx(qie,{trainer:H,onEdit:()=>{j(H),b(!0)},onDelete:O})})]},H.id)})})]})}),a.jsx(Ft.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:a.jsx(K_,{subjectId:e,courseId:t,onView:H=>{M(H),L(!0)}})})]})})]})}),a.jsx(q_,{show:d,onClose:()=>m(!1),onConfirm:P,subject:n,loading:S}),a.jsx(Kie,{show:f,onClose:()=>h(!1),onSave:Se,subject:n,loading:w}),a.jsx(Xie,{show:x,onClose:()=>p(!1),onSave:G,loading:C}),a.jsx(Yie,{show:g,onClose:()=>b(!1),onSave:K,trainer:y,loading:_}),a.jsx(x1,{show:I,onClose:()=>{L(!1),M(null)},event:D})]}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{children:"Subject not found"}),a.jsx("p",{children:"The requested subject could not be found."}),a.jsxs(ie,{variant:"primary",onClick:F,children:[a.jsx(_t,{className:"me-2",size:16}),"Go Back"]})]})})},qN=()=>{const{subjectId:e,courseId:t}=Nr();return a.jsx(Jie,{subjectId:e,courseId:t})},Zie=({subject:e,onView:t,onEdit:r,onDelete:s})=>{const n=()=>{t&&t(e.id)},i=()=>{s&&s(e.id)};return a.jsx(hr,{permissions:[Te.SUBJECTS.VIEW_DETAIL,Te.SUBJECTS.DELETE],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:n,permission:Te.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Archive Subject",icon:a.jsx(n2,{}),className:"text-warning",onClick:i,permission:Te.SUBJECTS.ARCHIVE}]})})},Qie=e=>({id:e.id,name:e.name,code:e.code,method:e.method,duration:toe(e.duration),startDate:KN(e.startDate||e.start_date),endDate:KN(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.status||(e.deletedAt?"ARCHIVED":"PLANNED"),description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),eoe=e=>e.map(Qie),toe=e=>{if(!e&&e!==0)return"N/A";if(e<1){const t=Math.round(e*24);return t===0?"< 1 hour":t===1?"1 hour":`${t} hours`}return e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`},KN=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch{return"Invalid Date"}},roe=e=>{switch(e?.toUpperCase()){case"ACTIVE":case"ON-GOING":case"ONGOING":return"success";case"PLANNED":return"info";case"COMPLETED":return"primary";case"ARCHIVED":case"INACTIVE":return"secondary";default:return"secondary"}},soe=e=>{switch(e?.toUpperCase()){case"CLASSROOM":return"info";case"E_LEARNING":case"E-LEARNING":case"ELEARNING":return"primary";case"ERO":return"warning";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},aoe=({subjects:e=[],loading:t=!1,onView:r,onEdit:s,onDelete:n})=>{const i=eoe(e),{sortedData:o,sortConfig:l,handleSort:c}=Zt(i);if(t)return a.jsx(Rt,{rows:4,columns:5});if(i.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const h=l.key===d,x=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),a.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:a.jsx(rr,{direction:x,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(u,{columnKey:"name",className:"show-mobile",children:"Name"}),a.jsx(u,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(u,{columnKey:"method",className:"show-mobile",children:"Method"}),a.jsx(u,{columnKey:"duration",className:"show-mobile",children:"Duration"}),a.jsx(u,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),a.jsx(u,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),a.jsx(u,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),a.jsx(u,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),a.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px",textTransform:"uppercase",letterSpacing:"0.5px"},children:a.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),a.jsx("tbody",{children:o.map(d=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(d.id),style:{cursor:"pointer"},children:d.name})}),a.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.code,children:d.code})}),a.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:a.jsx(Ae,{bg:soe(d.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.method,children:d.method})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:d.duration})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:d.startDate})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:d.endDate})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:d.roomName})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:d.trainees||0})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs(Ae,{bg:roe(d.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:d.status==="ACTIVE"||d.status==="ON-GOING"||d.status==="ONGOING"?"":""}),d.status||"N/A"]})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(Zie,{subject:d,onView:r,onEdit:s,onDelete:n})})]},d.id))})]})})},noe=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>a.jsx(hr,{permissions:[Te.SUBJECTS.VIEW_DETAIL,Te.SUBJECTS.DELETE],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Subject List",icon:a.jsx(Et,{}),onClick:()=>t(e),permission:Te.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:a.jsx(Wi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Te.SUBJECTS.DELETE}]})}),ioe=({show:e,onClose:t,onConfirm:r,trainee:s,subjectName:n=null,loading:i=!1})=>{const o=!n,l=o?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=o?"Remove from All Subjects":"Remove from Subject",u=()=>{r(),t()};return a.jsxs(ce,{show:e,onHide:t,centered:!0,children:[a.jsx(ce.Header,{className:"bg-danger text-white border-0",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fr,{className:"me-2",size:20}),l]})}),a.jsxs(ce.Body,{className:"p-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",a.jsxs("strong",{children:['"',s?.name,'"']}),o?" from ALL subjects":` from "${n}"`,"?"]}),a.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[a.jsx("strong",{children:"Trainee:"})," ",s?.name,a.jsx("br",{}),a.jsx("strong",{children:"EID:"})," ",s?.eid,!o&&a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsx("strong",{children:"Subject:"})," ",n]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-danger mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-danger mb-3",children:[o?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),a.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),a.jsx("li",{children:"Remove the trainee from the course completely"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Remove the trainee from this specific subject only"}),a.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),a.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),a.jsx("li",{children:a.jsx("strong",{children:"Cannot be undone"})})]})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsx(ie,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),a.jsx(ie,{variant:"danger",onClick:u,disabled:i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Wi,{className:"me-2",size:16}),c]})})]})]})},ooe=({courseId:e,loading:t=!1,title:r="Enrolled Trainees"})=>{const[s,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(!1),[h,x]=v.useState(null),[p,g]=v.useState(null),[b,y]=v.useState(!1),{sortedData:j,sortConfig:S,handleSort:E}=Zt(s),w=v.useCallback(async()=>{o(!0);try{const L=await Fl.getTraineesForEnrollment();if(!L||!L.data||!L.data.users||!Array.isArray(L.data.users)){n([]);return}const D=[];for(const M of L.data.users)try{const q=await Jr.getTraineeEnrollments(M.id);if(q&&q.enrollments&&q.enrollments.length>0){const Z=q.enrollments.filter(Q=>Q.enrollment?.status==="ENROLLED");if(Z.length>0){const Q=Z.map(le=>le.subject.id),U={id:M.id,eid:M.eid,name:`${M.firstName} ${M.lastName}`.trim(),subjects:Q,userId:M.id,email:M.email,department:M.department};D.push(U)}}}catch{}n(D)}catch{n([])}finally{o(!1)}},[]);v.useEffect(()=>{e&&w()},[e,w]);const N=async L=>{try{const D=await Jr.getTraineeEnrollments(L.userId),M=D.enrollments?.filter(Z=>Z.enrollment?.status==="ENROLLED")||[],q={...L,enrollmentDetails:D,subjects:M.map(Z=>({id:Z.subject.id,name:Z.subject.name,code:Z.subject.code,status:Z.subject.status,type:Z.subject.type,method:Z.subject.method,startDate:Z.subject.startDate,endDate:Z.subject.endDate,course:Z.subject.course,enrollment:Z.enrollment}))};d(q),c(!0)}catch{d(L),c(!0)}},C=L=>{const D=s.find(M=>M.id===L);D&&(x(D),g(null),f(!0))},T=async()=>{if(h){y(!0);try{const L=await Jr.getTraineeEnrollments(h.userId);if(L&&L.enrollments&&L.enrollments.length>0){const M=L.enrollments.map(async q=>{const Z=q.subject.id,Q=q.enrollment?.batchCode||"TEST0012025";return q.enrollment?.status!=="ENROLLED"?null:Xr.removeTraineeFromSubject(Z,h.userId,Q)}).filter(q=>q!==null);M.length>0&&await Promise.all(M),await w(),ne.success(`Successfully removed ${h.name} from all subjects`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}else ne.warning(`No enrollments found for ${h.name}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}catch(L){const D=L?.response?.data?.message||L?.message||"Failed to remove trainee from subjects";ne.error(`Error: ${D}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{y(!1)}}},_=(L,D)=>{const M=s.find(Q=>Q.id===L);if(!M)return;const q=u?.subjects?.find(Q=>Q.id===D),Z=q?q.name:"Unknown Subject";x(M),g(Z),f(!0)},k=async()=>{if(!h||!p)return;const L=u?.subjects?.find(D=>D.name===p);if(!L){ne.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}y(!0);try{const D=L.enrollment?.batchCode||"TEST0012025";if(L.enrollment?.status!=="ENROLLED"){ne.warning(`Cannot remove trainee from ${p}. Enrollment status is not ENROLLED.`,{autoClose:4e3,position:"top-right",icon:!1}),y(!1);return}await Xr.removeTraineeFromSubject(L.id,h.userId,D),await w(),ne.success(`Successfully removed ${h.name} from ${p}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1),c(!1)}catch(D){const M=D?.response?.data?.message||D?.message||"Failed to remove trainee from subject";ne.error(`Error: ${M}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{y(!1)}};if(t||i)return a.jsx("div",{children:a.jsx(Rt,{rows:4,columns:4})});if(s.length===0)return a.jsx("div",{children:a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No enrolled trainees"}),a.jsx("p",{children:"No trainees have been enrolled in any subjects yet."})]})})});const I=({columnKey:L,children:D,className:M=""})=>{const q=S.key===L,Z=q?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${M}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(L),onMouseEnter:Q=>{Q.target.style.backgroundColor="#214760",Q.target.style.transform="translateY(-1px)",Q.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:Q=>{Q.target.style.backgroundColor="var(--bs-primary)",Q.target.style.transform="translateY(0)",Q.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:q?"700":"600",color:"white"},children:D}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:Z,size:14,color:"white"})})]}),q&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"d-flex flex-column",style:{height:"400px",width:"100%"},children:a.jsx("div",{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:a.jsx("div",{style:{height:"100%",overflowY:"auto"},children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(I,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(I,{columnKey:"eid",className:"show-mobile",children:"EID"}),a.jsx(I,{columnKey:"subjects",className:"show-mobile",children:"Total Subject"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:j.map(L=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary-custom",children:L.name})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:L.eid})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lr,{size:14,className:"me-1 text-muted"}),a.jsxs(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[L.subjects.length," subjects"]})]})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(noe,{trainee:L,onViewSubjects:N,onRemoveTrainee:C})})]},L.id))})]})})})}),a.jsxs(ce,{show:l,onHide:()=>c(!1),size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[a.jsx(Lr,{className:"me-2",size:20}),u?.name," - Enrolled Subjects"]}),a.jsx(ie,{variant:"link",onClick:()=>c(!1),className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsx(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:u&&a.jsxs("div",{children:[a.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:a.jsxs("div",{className:"row align-items-center",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:"Trainee Information"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ae,{bg:"primary-custom",className:"me-2 text-white",children:"EID"}),a.jsx("span",{className:"fw-semibold text-primary-custom",children:u.eid})]})]}),a.jsx("div",{className:"col-md-6 text-md-end",children:a.jsx("div",{className:"text-primary-custom small",children:a.jsxs("div",{children:["Total Subjects: ",a.jsx(Ae,{bg:"primary-custom",className:"text-white",children:u.subjects.length})]})})})]})}),a.jsx("div",{className:"row g-3",children:u.subjects.map(L=>a.jsx("div",{className:"col-12",children:a.jsx(W,{className:"border-0 shadow-sm",children:a.jsx(W.Body,{className:"p-3",children:a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-8",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:L.name}),a.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[a.jsx(Ae,{bg:"primary-custom",className:"text-white",children:L.code}),a.jsx(Ae,{bg:L.status==="ACTIVE"?"success":"primary-custom",className:L.status==="ACTIVE"?"":"text-white",children:L.status})]})]}),a.jsx(ie,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{_(u.id,L.id)},children:a.jsx(nt,{size:14})})]}),a.jsxs("div",{className:"row g-2 mb-3",children:[a.jsx("div",{className:"col-sm-6",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Type:"}),a.jsx(Ae,{bg:"primary-custom",className:"text-white",children:L.type})]})}),a.jsx("div",{className:"col-sm-6",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Method:"}),a.jsx(Ae,{bg:"primary-custom",className:"text-white",children:L.method})]})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Course:"}),a.jsx("span",{className:"fw-medium text-primary-custom",children:L.course?.name})]})]}),L.enrollment&&a.jsx("div",{className:"col-md-4",children:a.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[a.jsx("h6",{className:"text-primary-custom mb-2 fw-bold",children:"Enrollment Details"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Status:"}),a.jsx(Ae,{bg:"primary-custom",className:"text-white",children:L.enrollment.status})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Batch:"}),a.jsx("span",{className:"fw-medium small text-primary-custom",children:L.enrollment.batchCode})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Enrolled:"}),a.jsx("span",{className:"fw-medium small text-primary-custom",children:new Date(L.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},L.id))})]})}),a.jsx(ce.Footer,{className:"border-top",children:a.jsx(ie,{variant:"primary-custom",className:"text-white",onClick:()=>c(!1),children:"Close"})})]}),a.jsx(ioe,{show:m,onClose:()=>{f(!1),x(null),g(null),y(!1)},onConfirm:p?k:T,trainee:h,subjectName:p,loading:b})]})},loe=({show:e,onClose:t,onSave:r,loading:s=!1,courseId:n})=>{const[i,o]=v.useState({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[l,c]=v.useState([]),[u,d]=v.useState(!1);v.useEffect(()=>{e&&n&&(o({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]))},[e,n]);const m=p=>{const{name:g,value:b,type:y,checked:j}=p.target;o(S=>({...S,[g]:y==="checkbox"?j:b}))},f=()=>{const p=[];return n||p.push("Course ID is required"),i.name.trim()||p.push("Subject name is required"),i.code.trim()||p.push("Subject code is required"),i.duration.trim()&&(isNaN(i.duration)||parseInt(i.duration)<=0)&&p.push("Duration must be a positive number"),i.passScore.trim()&&(isNaN(i.passScore)||parseFloat(i.passScore)<0||parseFloat(i.passScore)>100)&&p.push("Pass score must be between 0 and 100"),i.startDate.trim()||p.push("Start date is required"),i.endDate.trim()||p.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&p.push("End date must be after start date"),c(p),p.length===0},h=async p=>{if(p.preventDefault(),!!f()){d(!0);try{const g={courseId:n,name:i.name.trim(),code:i.code.trim(),description:i.description.trim()||null,method:i.method,duration:i.duration.trim()?parseInt(i.duration):null,type:i.type,roomName:i.roomName.trim()||null,remarkNote:i.remarkNote.trim()||null,timeSlot:i.timeSlot.trim()||null,isSIM:i.isSIM,passScore:i.passScore.trim()?parseFloat(i.passScore):null,startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString()},b=await Pe.post("/subjects",g);ne.success("Subject created successfully!"),r&&await r(b.data||g),x()}catch(g){const b=g.response?.data?.message||g.message||"Failed to create subject";ne.error(`Error: ${b}`),c([b])}finally{d(!1)}}},x=()=>{o({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),d(!1),t()};return a.jsxs(ce,{show:e,onHide:x,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(ms,{className:"me-2",size:20}),"Add New Subject"]}),a.jsx(ie,{variant:"link",onClick:x,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((p,g)=>a.jsx("li",{children:p},g))})}),a.jsxs(A,{onSubmit:h,children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Subject Name *"}),a.jsx(A.Control,{type:"text",name:"name",value:i.name,onChange:m,placeholder:"Enter subject name",required:!0})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Subject Code *"}),a.jsx(A.Control,{type:"text",name:"code",value:i.code,onChange:m,placeholder:"Enter subject code",required:!0})]})})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Description"}),a.jsx(A.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,placeholder:"Enter subject description"})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Method *"}),a.jsxs(A.Select,{name:"method",value:i.method,onChange:m,required:!0,children:[a.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),a.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),a.jsx("option",{value:"ERO",children:"ERO"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Duration (days)"}),a.jsx(A.Control,{type:"number",name:"duration",value:i.duration,onChange:m,placeholder:"Enter duration in days",min:"1"})]})})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Type *"}),a.jsxs(A.Select,{name:"type",value:i.type,onChange:m,required:!0,children:[a.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),a.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Room Name"}),a.jsx(A.Control,{type:"text",name:"roomName",value:i.roomName,onChange:m,placeholder:"Enter room name"})]})})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Time Slot"}),a.jsx(A.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:m,placeholder:"e.g., 09:00-11:00"})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Pass Score"}),a.jsx(A.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"0.01"})]})})]}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Start Date *"}),a.jsx(A.Control,{type:"datetime-local",name:"startDate",value:i.startDate,onChange:m,required:!0})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"End Date *"}),a.jsx(A.Control,{type:"datetime-local",name:"endDate",value:i.endDate,onChange:m,required:!0})]})})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Remark Note"}),a.jsx(A.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:m,placeholder:"Enter remark note"})]}),a.jsx(A.Group,{className:"mb-3",children:a.jsx(A.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:m,label:"Is Simulator"})})]})]}),a.jsxs(ce.Footer,{className:"border-0",children:[a.jsx(ie,{variant:"secondary",onClick:x,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:h,disabled:u,children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):"Create Subject"})]})]})},coe=({show:e,onClose:t,onImport:r,loading:s=!1,courseId:n})=>{const[i,o]=v.useState(!1),[l,c]=v.useState(null),[u,d]=v.useState([]),[m,f]=v.useState([]),[h,x]=v.useState([]),p=v.useRef(null),g=["code","name","course_id"],b=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],y=k=>{k.preventDefault(),k.stopPropagation(),k.type==="dragenter"||k.type==="dragover"?o(!0):k.type==="dragleave"&&o(!1)},j=k=>{k.preventDefault(),k.stopPropagation(),o(!1),k.dataTransfer.files&&k.dataTransfer.files[0]&&E(k.dataTransfer.files[0])},S=k=>{k.target.files&&k.target.files[0]&&E(k.target.files[0])},E=k=>{if(!k.name.match(/\.(xlsx|xls)$/)){f(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(k.size>100*1024*1024){f(["File size must be less than 100MB"]);return}c(k),f([]),w(k)},w=k=>{const I=new FileReader;I.onload=L=>{try{const D=new Uint8Array(L.target.result),M=Jl(D,{type:"array"}),q=M.SheetNames[0],Z=M.Sheets[q],Q=ba.sheet_to_json(Z,{header:1});if(Q.length<2){f(["Excel file must contain at least a header row and one data row"]);return}const U=Q[0].map(K=>K?.toString().toLowerCase().trim()),le=Q.slice(1),P=(n?g.filter(K=>K!=="course_id"):g).filter(K=>!U.includes(K));if(P.length>0){f([`Missing required columns: ${P.join(", ")}`]);return}const G=le.map((K,O)=>{const F=U.includes("course_id")?K[U.indexOf("course_id")]?.toString().trim()||"":n||"",H={id:`temp_${O}`,rowNumber:O+2,code:K[U.indexOf("code")]?.toString().trim()||"",name:K[U.indexOf("name")]?.toString().trim()||"",course_id:F,description:K[U.indexOf("description")]?.toString().trim()||"",method:K[U.indexOf("method")]?.toString().trim()||"THEORY",duration:K[U.indexOf("duration")]?.toString().trim()||"",type:K[U.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:K[U.indexOf("room_name")]?.toString().trim()||"",remark_note:K[U.indexOf("remark_note")]?.toString().trim()||"",time_slot:K[U.indexOf("time_slot")]?.toString().trim()||"",pass_score:K[U.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const Y=K[U.indexOf("start_date")];return Y?Y instanceof Date?Y.toISOString().split("T")[0]:typeof Y=="number"?Y:String(Y).trim():""})(),end_date:(()=>{const Y=K[U.indexOf("end_date")];return Y?Y instanceof Date?Y.toISOString().split("T")[0]:typeof Y=="number"?Y:String(Y).trim():""})(),is_sim:U.includes("is_sim")||U.includes("issim")?K[U.indexOf(U.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(H.code||(H.hasError=!0,H.errors.push("Subject code is required")),H.name||(H.hasError=!0,H.errors.push("Subject name is required")),!H.course_id&&!n?(H.hasError=!0,H.errors.push("Course ID is required (either in file or must be importing from course detail page)")):H.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(H.course_id)||(H.hasError=!0,H.errors.push("Course ID must be a valid UUID format"))),H.duration&&(isNaN(H.duration)||parseInt(H.duration)<=0)&&(H.hasError=!0,H.errors.push("Duration must be a positive number")),H.pass_score&&(isNaN(H.pass_score)||parseFloat(H.pass_score)<0||parseFloat(H.pass_score)>100)&&(H.hasError=!0,H.errors.push("Pass score must be between 0 and 100")),H.method){let Y=H.method.toUpperCase().trim();Y==="E-LEARNING"||Y==="E LEARNING"||Y==="ELEARNING"?Y="E_LEARNING":Y==="CLASSROOM"||Y==="CLASS ROOM"||Y==="CLASS-ROOM"?Y="CLASSROOM":Y==="ERO"&&(Y="ERO"),H.method=Y,["E_LEARNING","CLASSROOM","ERO"].includes(Y)||(H.hasError=!0,H.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}if(H.type&&!["UNLIMIT","RECURRENT"].includes(H.type.toUpperCase())&&(H.hasError=!0,H.errors.push("Type must be UNLIMIT or RECURRENT")),H.start_date)try{let Y;if(typeof H.start_date=="number"&&H.start_date>1e4){const te=parseFloat(H.start_date);Y=new Date((te-25569)*86400*1e3)}else{const te=String(H.start_date).trim();Y=new Date(te)}isNaN(Y.getTime())&&(H.hasError=!0,H.errors.push("Start date must be a valid date"))}catch{H.hasError=!0,H.errors.push("Start date must be a valid date")}if(H.end_date)try{let Y;if(typeof H.end_date=="number"&&H.end_date>1e4){const te=parseFloat(H.end_date);Y=new Date((te-25569)*86400*1e3)}else{const te=String(H.end_date).trim();Y=new Date(te)}isNaN(Y.getTime())&&(H.hasError=!0,H.errors.push("End date must be a valid date"))}catch{H.hasError=!0,H.errors.push("End date must be a valid date")}return H}).filter(K=>K.code||K.name);d(G),x([])}catch{f(["Failed to parse Excel file. Please check the file format."])}},I.readAsArrayBuffer(k)},N=async()=>{const k=u.filter(L=>!L.hasError);if(k.length===0){f(["No valid subjects to import"]);return}if(!n&&k.filter(D=>!D.course_id).length>0){f(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}const I=k.map(L=>{let D=!1;const M=L.is_sim!==void 0?L.is_sim:void 0;if(M!=null&&M!=="")if(typeof M=="string"){const le=M.toLowerCase().trim();D=["true","1","yes","y"].includes(le)}else typeof M=="boolean"?D=M:typeof M=="number"&&(D=M!==0);const q=le=>{if(!le||le===""||le==="N/A")return null;try{let Se;if(typeof le=="string"){const G=le.trim();if(/^\d+$/.test(G)){const K=parseInt(G);if(K>=1&&K<=1e5){const H=(K-25569)*86400*1e3;Se=new Date(H);const Y=Se.getFullYear();(Y<1900||Y>2100)&&(Se=new Date(G))}else Se=new Date(K<1e12?K*1e3:K)}else{if(G.includes("T")&&G.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/))return G;G.match(/^\d{4}-\d{2}-\d{2}$/)?Se=new Date(G+"T00:00:00.000Z"):Se=new Date(G)}}else typeof le=="number"?le>=1&&le<=1e5?Se=new Date((le-25569)*86400*1e3):le>1e5&&le<1e12?Se=new Date(le*1e3):Se=new Date(le):Se=new Date(le);if(isNaN(Se.getTime()))return null;const P=Se.getFullYear();return P<1900||P>2100?null:Se.toISOString()}catch{return null}},Z=q(L.start_date),Q=q(L.end_date),U={code:L.code,name:L.name,courseId:String(n||L.course_id),description:L.description||"",method:L.method?L.method.toUpperCase():"CLASSROOM",duration:L.duration?parseInt(L.duration):1,type:L.type?L.type.toUpperCase():"UNLIMIT",roomName:L.room_name||"",remarkNote:L.remark_note||"",timeSlot:L.time_slot||"",passScore:L.pass_score?parseFloat(L.pass_score):70,isSIM:D};return Z&&(U.startDate=Z),Q&&(U.endDate=Q),U});try{const L=await r(I);let D=L;L&&L.data&&typeof L.data=="object"&&(D=L.data);const M=D?.summary?.created??D?.createdSubjects?.length??D?.summary?.createdCount??D?.subjects?.length??0,q=D?.summary?.failed??D?.failedSubjects?.length??D?.summary?.failedCount??0,Z=D?.summary?.skipped??D?.skippedSubjects?.length??D?.summary?.skippedCount??0,Q=D?.summary?.total??I.length;if(!(D?.summary||D?.createdSubjects!==void 0||D?.failedSubjects!==void 0)&&L!==null&&L!==void 0&&!L?.error&&!L?.message?.toLowerCase().includes("fail")){ne.success(`Imported ${Q}/${Q} subjects successfully.`,{icon:!1}),C();return}const Se=(!D||M===0&&q===0&&Z===0&&Q===0)&&!L?.error&&D?.message?.toLowerCase().includes("exist");D?.failedSubjects&&Array.isArray(D.failedSubjects)&&D.failedSubjects.length>0&&D.failedSubjects.forEach(P=>{const G=P.subject?.name||"Unknown Subject",K=P.subject?.code||"N/A",O=P.error||"Unknown error";ne.error(`${G} (${K}): ${O}`,{autoClose:6e3,position:"top-right",icon:!1})}),Se||Z>0?Z>0?ne.info(`${Z} subject(s) already exist and were skipped. ${M>0?`${M} new subject(s) were imported.`:""}`,{icon:!1}):ne.info("All subjects already exist. No new subjects were imported.",{icon:!1}):M>0&&q===0?ne.success(`Imported ${M}/${Q} subjects successfully.`,{icon:!1}):M>0&&q>0?ne.warn(`Imported ${M}/${Q}. ${q} failed.`,{icon:!1}):M===0&&q>0?ne.error(`All ${q}/${Q} subjects failed to import.`,{icon:!1}):ne.success(`Imported ${Q}/${Q} subjects successfully.`,{icon:!1}),C()}catch(L){L?.response?.status===304?(ne.info("All subjects already exist. No new subjects were imported.",{icon:!1}),C()):(ne.error(L?.response?.data?.message||L.message||"Failed to import subjects.",{icon:!1}),f([L?.response?.data?.message||L.message||"Failed to import subjects. Please try again."]))}},C=()=>{c(null),d([]),f([]),x([]),o(!1),t()},T=k=>k==="valid"?a.jsx(ht,{className:"text-success",size:16}):a.jsx(Qs,{className:"text-danger",size:16}),_=()=>{const k=[b,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],I=ba.aoa_to_sheet(k),L=ba.book_new();ba.book_append_sheet(L,I,"Subjects"),pg(L,"Subject_Upload_Template.xlsx")};return a.jsxs(ce,{show:e,onHide:C,size:"xl",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Ds,{className:"me-2",size:20}),"Bulk Import Subjects"]}),a.jsx(ie,{variant:"link",onClick:C,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[m.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:m.map((k,I)=>a.jsx("li",{children:k},I))})}),a.jsx(W,{className:"mb-4",children:a.jsxs(W.Body,{children:[a.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:j,onClick:()=>p.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(vo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:p,type:"file",accept:".xlsx,.xls",onChange:S,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&a.jsx("span",{children:", Course ID (UUID format)"})]}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:_,className:"d-flex align-items-center",children:[a.jsx($i,{className:"me-1",size:14}),"Download Template"]}),l&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(vo,{className:"text-success me-2",size:16}),a.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})]})}),u.length>0&&a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",u.length," records)"]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(Gt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"120px"},children:"CODE"}),a.jsx("th",{style:{minWidth:"200px"},children:"NAME"}),a.jsx("th",{style:{minWidth:"200px"},children:"COURSE ID"}),a.jsx("th",{style:{minWidth:"150px"},children:"METHOD"}),a.jsx("th",{style:{minWidth:"100px"},children:"DURATION"}),a.jsx("th",{style:{minWidth:"120px"},children:"TYPE"}),a.jsx("th",{style:{minWidth:"100px"},children:"PASS SCORE"}),a.jsx("th",{style:{minWidth:"150px"},children:"DESCRIPTION"}),a.jsx("th",{style:{minWidth:"150px"},children:"ROOM NAME"}),a.jsx("th",{style:{minWidth:"150px"},children:"TIME SLOT"}),a.jsx("th",{style:{minWidth:"150px"},children:"START DATE"}),a.jsx("th",{style:{minWidth:"150px"},children:"END DATE"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),a.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),a.jsx("tbody",{children:u.map((k,I)=>a.jsxs("tr",{className:k.hasError?"table-danger":"",children:[a.jsx("td",{children:k.rowNumber||I+1}),a.jsx("td",{children:k.code||"-"}),a.jsx("td",{children:k.name||"-"}),a.jsx("td",{children:k.course_id||"-"}),a.jsx("td",{children:k.method||"-"}),a.jsx("td",{children:k.duration||"-"}),a.jsx("td",{children:k.type||"-"}),a.jsx("td",{children:k.pass_score||"-"}),a.jsx("td",{children:k.description||"-"}),a.jsx("td",{children:k.room_name||"-"}),a.jsx("td",{children:k.time_slot||"-"}),a.jsx("td",{children:k.start_date||"-"}),a.jsx("td",{children:k.end_date||"-"}),a.jsx("td",{className:"text-center",children:T(k.hasError?"invalid":"valid")}),a.jsx("td",{children:k.errors.length>0&&a.jsx("small",{className:"text-danger",children:k.errors.length>1?`${k.errors[0]} (+${k.errors.length-1} more)`:k.errors[0]})}),a.jsx("td",{children:a.jsx(ie,{variant:"outline-danger",size:"sm",onClick:()=>{d(L=>L.filter(D=>D.id!==k.id))},children:a.jsx(Wi,{size:14})})})]},k.id))})]})})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:C,disabled:s,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),u.length>0&&a.jsx(r2,{placement:"top",overlay:a.jsxs(s2,{id:"import-tooltip",children:["Only ",u.filter(k=>!k.hasError).length,"/",u.length," subjects will be imported into DSFMS"]}),children:a.jsx(ie,{variant:"primary",onClick:N,disabled:s||u.filter(k=>!k.hasError).length===0,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"me-2",size:16}),"Import All (",u.filter(k=>!k.hasError).length," subjects)"]})})})]})]})},doe=({show:e,onClose:t,onSave:r,course:s,loading:n=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[l,c]=v.useState({}),u=x=>{if(!x)return"";if(typeof x=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(x))return x;try{const p=new Date(x);return isNaN(p.getTime())?"":p.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&s?o({name:s.name||"",code:s.code||"",description:s.description||"",maxTrainees:s.maxNumTrainee||s.maxTrainees||"",venue:s.venue||"",note:s.note||"",passScore:s.passScore||"",startDate:u(s.startDate),endDate:u(s.endDate),level:s.level||"BEGINNER",status:s.status||"ACTIVE"}):e||(o({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}))},[e,s]);const d=()=>{c({}),t()},m=x=>{const{name:p,value:g}=x.target;o(b=>({...b,[p]:g})),l[p]&&c(b=>({...b,[p]:""}))},f=()=>{const x={};if(i.name.trim()||(x.name="Course name is required"),i.code.trim()||(x.code="Course code is required"),i.description.trim()||(x.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(x.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(x.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(x.passScore="Pass score must be between 0 and 100"),!i.startDate)x.startDate="Start date is required";else{const p=new Date;p.setHours(0,0,0,0),new Date(i.startDate)<p&&(x.startDate="Start date cannot be in the past")}return i.endDate||(x.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(x.endDate="End date must be after start date"),c(x),Object.keys(x).length===0},h=async x=>{if(x.preventDefault(),!!f())try{const p={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},g=await Pe.put(`/courses/${s.id}`,p);ne.success("Course updated successfully!"),r&&await r(g.data||p),d()}catch(p){const g=p.response?.data?.message||p.message||"Failed to update course";ne.error(`Error: ${g}`)}};return a.jsxs(ce,{show:e,onHide:d,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Br,{className:"me-2",size:20}),"Edit Course"]}),a.jsx(ie,{variant:"link",onClick:d,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(A,{onSubmit:h,children:[a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[a.jsxs(de,{className:"mb-3",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Course Name *"}),a.jsx(A.Control,{type:"text",name:"name",value:i.name,onChange:m,isInvalid:!!l.name,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.name})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Course Code *"}),a.jsx(A.Control,{type:"text",name:"code",value:i.code,onChange:m,isInvalid:!!l.code,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.code})]})})]}),a.jsxs(de,{className:"mb-3",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Max Trainees *"}),a.jsx(A.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:m,isInvalid:!!l.maxTrainees,disabled:n,min:"1"}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.maxTrainees})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Pass Score *"}),a.jsx(A.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,isInvalid:!!l.passScore,disabled:n,min:"0",max:"100"}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),a.jsx(de,{className:"mb-3",children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Level"}),a.jsxs(A.Select,{name:"level",value:i.level,onChange:m,disabled:n,children:[a.jsx("option",{value:"BEGINNER",children:"Beginner"}),a.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),a.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),a.jsxs(de,{className:"mb-3",children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Start Date *"}),a.jsx(A.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,isInvalid:!!l.startDate,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.startDate})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"End Date *"}),a.jsx(A.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,isInvalid:!!l.endDate,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),a.jsx(de,{className:"mb-3",children:a.jsx(z,{children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Venue *"}),a.jsx(A.Control,{type:"text",name:"venue",value:i.venue,onChange:m,isInvalid:!!l.venue,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.venue})]})})}),a.jsx(de,{className:"mb-3",children:a.jsx(z,{children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Description *"}),a.jsx(A.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,isInvalid:!!l.description,disabled:n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.description})]})})}),a.jsx(de,{className:"mb-3",children:a.jsx(z,{children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Note"}),a.jsx(A.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:m,disabled:n})]})})})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:d,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary",type:"submit",disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},uoe=({course:e,department:t})=>{const r=it(),{courseId:s}=Nr(),n=Gn(),[i,o]=v.useState(!1),[l,c]=v.useState(!1),[u,d]=v.useState(!1),[m,f]=v.useState(!1),[h,x]=v.useState(null),[p,g]=v.useState(!1),[b,y]=v.useState(!1),[j,S]=v.useState(null),[E,w]=v.useState(null),[N,C]=v.useState([]),[T,_]=v.useState(!0),[k,I]=v.useState(()=>n.state?.activeTab?n.state.activeTab:"course-info");v.useEffect(()=>{n.state?.activeTab&&(I(n.state.activeTab),window.history.replaceState({},document.title))},[n.state]),v.useEffect(()=>{s&&(async()=>{if(s){_(!0);try{const G=await Jr.getCourseById(s);if(!G)throw new Error("Invalid API response");const K={id:G.id||s,name:G.name,code:G.code,description:G.description,maxTrainees:G.maxNumTrainee,maxNumTrainee:G.maxNumTrainee,venue:G.venue,note:G.note,passScore:G.passScore,startDate:G.startDate?new Date(G.startDate).toISOString().split("T")[0]:"",endDate:G.endDate?new Date(G.endDate).toISOString().split("T")[0]:"",level:G.level,status:G.status,department:G.department,subjectCount:G.subjectCount||0,traineeCount:G.traineeCount||0,trainerCount:G.trainerCount||0};w(K),G.subjects&&Array.isArray(G.subjects)?C(G.subjects):G.subjectCount>0&&!G.subjects?C([]):C([]),_(!1)}catch{if(e&&e.id&&e.name){const G={id:e.id,name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,maxNumTrainee:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||t,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0};w(G),C([])}else w(null),C([]);_(!1)}}})()},[s,e,t]);const L=()=>{t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(T)return a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!E)return a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h5",{className:"text-muted",children:"Course not found"}),a.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),a.jsxs(ie,{variant:"primary",onClick:L,children:[a.jsx(_t,{className:"me-2"}),"Back to Department"]})]})});const D=P=>{r(`/academic/course/${s}/subject/${P}`)},M=()=>{},q=P=>{const G=N.find(K=>K.id===P);G&&(x(G),f(!0))},Z=async()=>{if(h){g(!0);try{await Xr.archiveSubject(h.id),ne.success(`Successfully archived subject "${h.name}"`,{autoClose:3e3,position:"top-right",icon:!1});const P=await Jr.getCourseById(s);P.subjects&&Array.isArray(P.subjects)&&C(P.subjects),f(!1),x(null)}catch(P){const G=P?.response?.data?.message||P?.message||"Failed to archive subject";ne.error(`Error: ${G}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{g(!1)}}},Q=()=>{r(`/academic/course/${e.id}/enroll-trainees`)},U=async P=>{try{await Xr.createSubject({...P,courseId:s});const G=await Jr.getCourseById(s);G.subjects&&Array.isArray(G.subjects)&&C(G.subjects),o(!1)}catch{}},le=async P=>{const G=await Xr.bulkImportSubjects(P),K=await Jr.getCourseById(s);return K.subjects&&Array.isArray(K.subjects)&&C(K.subjects),c(!1),G},Se=async P=>{try{await Jr.updateCourse(s,P);const G=await Jr.getCourseById(s),K={id:G.id||s,name:G.name,code:G.code,description:G.description,maxTrainees:G.maxNumTrainee,maxNumTrainee:G.maxNumTrainee,venue:G.venue,note:G.note,passScore:G.passScore,startDate:G.startDate?new Date(G.startDate).toISOString().split("T")[0]:"",endDate:G.endDate?new Date(G.endDate).toISOString().split("T")[0]:"",level:G.level,status:G.status,department:G.department,subjectCount:G.subjectCount||0,traineeCount:G.traineeCount||0,trainerCount:G.trainerCount||0,subjects:G.subjects||[]};w(K),d(!1)}catch{}};return a.jsxs(_e,{fluid:!0,className:"py-2 course-detail",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:L,className:"me-3",children:[a.jsx(_t,{size:16,className:"me-1"}),"Back"]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-0 text-primary",children:[a.jsx("strong",{children:e.name}),"  ",e.code]}),a.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("div",{className:"d-flex",children:a.jsxs(ie,{size:"sm",variant:"primary",onClick:Q,children:[a.jsx(Lr,{size:14,className:"me-1"})," Enroll Trainees"]})}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsxs(ie,{size:"sm",variant:"outline-secondary",onClick:()=>d(!0),children:[a.jsx(Br,{size:14,className:"me-1"})," Edit Course"]}),a.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),a.jsxs(ie,{size:"sm",variant:"primary",onClick:()=>o(!0),children:[a.jsx(ms,{size:14,className:"me-1"})," Add Subject"]}),a.jsxs(ie,{size:"sm",variant:"outline-primary",onClick:()=>c(!0),children:[a.jsx(Ds,{size:14,className:"me-1"})," Import Bulk Subjects"]})]})]}),a.jsx(W,{className:"border-0 shadow-sm mb-2",children:a.jsxs(Ft.Container,{activeKey:k,onSelect:I,children:[a.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:k==="course-info"?"600":"400",opacity:k==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(It,{className:"me-2",size:16}),"Course Information"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:k==="subjects"?"600":"400",opacity:k==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(At,{className:"me-2",size:16}),"Subjects"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:k==="trainees"?"600":"400",opacity:k==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Lr,{className:"me-2",size:16}),"Trainees Roster"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:k==="assessment-events"?"600":"400",opacity:k==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Ra,{className:"me-2",size:16}),"All Related Assessment Events"]})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsxs(Ft.Content,{children:[a.jsx(Ft.Pane,{eventKey:"course-info",children:a.jsxs("div",{className:"p-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-3",style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem"},children:"Description"}),a.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.95rem"},children:E.description})]})})}),a.jsxs(de,{className:"g-4",children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Name"}),a.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:E.name})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Code"}),a.jsx(Ae,{bg:"secondary",className:"px-2 py-1",children:E.code})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Level"}),a.jsx(Ae,{bg:"info",className:"px-2 py-1",children:E.level})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.startDate||"N/A"})]})]})]}),a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Max Number of Trainees"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(va,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.maxTrainees})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bo,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.venue})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(l2,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.passScore})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Status"}),a.jsx(Ae,{bg:E.status==="ACTIVE"?"success":E.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:E.status})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"End Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.endDate||"N/A"})]})]})]})]})]})}),a.jsx(Ft.Pane,{eventKey:"subjects",children:a.jsx(aoe,{subjects:N,loading:!1,onView:D,onEdit:M,onDelete:q})}),a.jsx(Ft.Pane,{eventKey:"trainees",style:{height:"100%"},children:a.jsx(ooe,{courseId:s,loading:!1,title:"Trainees Roster"})}),a.jsx(Ft.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:a.jsx(K_,{courseId:s,onView:P=>{S(P),y(!0)}})})]})})]})}),a.jsx(loe,{show:i,onClose:()=>o(!1),onSave:U,courseId:s}),a.jsx(coe,{show:l,onClose:()=>c(!1),onImport:le,courseId:s}),a.jsx(doe,{show:u,onClose:()=>d(!1),onSave:Se,course:E||e}),a.jsx(q_,{show:m,onClose:()=>{f(!1),x(null)},onDisable:Z,subject:h,loading:p}),a.jsx(x1,{show:b,onClose:()=>{y(!1),S(null)},event:j})]})},moe=()=>{const{courseId:e}=Nr(),t=Gn(),[r,s]=v.useState(null),[n,i]=v.useState(null),[o,l]=v.useState(!0);return v.useEffect(()=>{e&&(async()=>{try{l(!0);try{const u=await Jr.getCourseById(e);s(u),u.department&&i(u.department)}catch{const d={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},m={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};s(d),i(m)}l(!1)}catch{l(!1)}})()},[e]),o?a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?a.jsx(_e,{className:"py-3",children:a.jsx(uoe,{course:r,department:n})}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx("h4",{children:"Course not found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},foe=({selectedSubjects:e,onSelectionChange:t})=>{const[r,s]=v.useState(""),[n,i]=v.useState([]),[o,l]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),u(null);const p=await Xr.getSubjects();if(p&&p.subjects){const g=p.subjects.map(b=>({id:b.id,name:b.name,code:b.code}));i(g)}else i([])}catch{u("Failed to load subjects"),i([])}finally{l(!1)}})()},[]);const d=n.filter(x=>x.name.toLowerCase().includes(r.toLowerCase())||x.code.toLowerCase().includes(r.toLowerCase())),m=()=>{e.length===d.length?t([]):t(d.map(x=>x.id))},f=x=>{e.includes(x)?t(e.filter(p=>p!==x)):t([...e,x])},h=d.length>0&&e.length===d.length;return a.jsxs(W,{className:"d-flex flex-column h-100 subject-selection-panel-card",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",overflow:"visible",marginBottom:"1.5rem"},children:[a.jsx(W.Header,{className:"bg-gradient-primary-custom text-white border-0",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),a.jsx(ie,{variant:"outline-light",size:"sm",onClick:m,children:h?"Deselect All":"Select All"})]})}),a.jsxs(W.Body,{className:"p-0 d-flex flex-column subject-selection-panel-body",style:{height:"500px",minHeight:0,display:"flex",flexDirection:"column"},children:[a.jsx("div",{className:"p-2 border-bottom flex-shrink-0",children:a.jsx(A.Control,{type:"text",placeholder:"Search subjects...",value:r,onChange:x=>s(x.target.value),size:"sm"})}),a.jsx("div",{className:"subject-list-scroll-container",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%"},children:o?a.jsxs("div",{className:"p-3 text-center",children:[a.jsx(Ot,{animation:"border",size:"sm",className:"me-2"}),a.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?a.jsx("div",{className:"p-3 text-center text-danger",children:a.jsx("p",{className:"mb-0",children:c})}):d.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No subjects found"})}):d.map(x=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>f(x.id),children:[a.jsx("div",{className:"me-3 flex-shrink-0",children:e.includes(x.id)?a.jsx(d2,{size:20,className:"text-primary"}):a.jsx(A2,{size:20,className:"text-muted"})}),a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:x.name,children:x.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:x.code,children:x.code})]})]},x.id))}),a.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:a.jsxs("small",{className:"text-muted",children:[e.length," of ",d.length," subjects selected"]})})]})]})},hoe=({selectedTrainees:e,onSelectionChange:t})=>{const[r,s]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState([]),[c,u]=v.useState(!1),[d,m]=v.useState(null),f=v.useRef(null);v.useEffect(()=>{h()},[]),v.useEffect(()=>{const b=y=>{f.current&&!f.current.contains(y.target)&&i(!1)};return n&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[n]);const h=async()=>{u(!0),m(null);try{const b=await Fl.getTraineesForEnrollment();if(b&&b.data&&b.data.users&&Array.isArray(b.data.users)){const y=b.data.users.map(j=>({id:j.id,eid:j.eid,name:`${j.firstName} ${j.lastName}`.trim(),firstName:j.firstName,lastName:j.lastName,email:j.email,status:j.status}));l(y)}else l([])}catch(b){console.error("Error loading trainees:",b),m("Failed to load trainees"),l([])}finally{u(!1)}},x=o.filter(b=>b.name.toLowerCase().includes(r.toLowerCase())||b.eid.toLowerCase().includes(r.toLowerCase()));v.useEffect(()=>{r.trim().length>0&&i(!0)},[r]);const p=b=>{e.find(y=>y.id===b.id)||t([...e,b])},g=b=>{t(e.filter(y=>y.id!==b))};return a.jsxs(W,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",overflow:"hidden",marginBottom:"1.5rem"},children:[a.jsx(W.Header,{className:"bg-gradient-primary-custom text-white border-0",children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),a.jsxs(W.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[a.jsxs("div",{className:"flex-shrink-0",style:{position:"relative",paddingBottom:"1rem"},ref:f,children:[a.jsx("div",{className:"p-2 border-bottom",children:a.jsx(A.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:b=>s(b.target.value),size:"sm"})}),a.jsx("div",{className:"p-2",children:a.jsxs(ie,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!n),disabled:c,children:[a.jsxs("span",{children:[a.jsx(Lr,{className:"me-2",size:16}),c?"Loading...":r.trim().length>0?`Available Trainees (${x.length})`:`Show All Available Trainees (${o.length})`]}),a.jsx(Ka,{size:16})]})}),n&&a.jsx("div",{className:"border bg-white",style:{position:"absolute",top:"calc(100% + 8px)",left:0,right:0,zIndex:1050,maxHeight:"350px",overflowY:"auto",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1)"},children:c?a.jsxs("div",{className:"p-3 text-center",children:[a.jsx(Ot,{animation:"border",size:"sm",className:"me-2"}),a.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):d?a.jsxs("div",{className:"p-3 text-center text-danger",children:[a.jsx("p",{className:"mb-0",children:d}),a.jsx(ie,{size:"sm",variant:"outline-danger",onClick:h,className:"mt-2",children:"Retry"})]}):x.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No trainees found"})}):x.map(b=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>p(b),children:[a.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:b.name,children:b.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:b.eid,children:b.eid})]}),a.jsx(ms,{size:14,className:"text-primary flex-shrink-0"})]},b.id))})]}),a.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0,marginTop:"1rem"},children:[a.jsx("div",{className:"p-2 bg-gradient-primary-custom text-white border-bottom",children:a.jsxs("small",{className:"text-white fw-semibold",children:["Selected Trainees (",e.length,")"]})}),a.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(b=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0},children:[a.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:b.name,children:b.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:b.eid,children:b.eid})]}),a.jsx(ie,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>g(b.id),children:a.jsx(nt,{size:14})})]},b.id))})]})]})]})},poe=({show:e,onClose:t,onImport:r,loading:s=!1})=>{const[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState(null),[f,h]=v.useState([]),[x,p]=v.useState([]),[g,b]=v.useState([]),[y,j]=v.useState(!1),S=v.useRef(null),E=["eid","email"],w=Q=>{Q.preventDefault(),Q.stopPropagation(),Q.type==="dragenter"||Q.type==="dragover"?i(!0):Q.type==="dragleave"&&i(!1)},N=Q=>{Q.preventDefault(),Q.stopPropagation(),i(!1),Q.dataTransfer.files&&Q.dataTransfer.files[0]&&T(Q.dataTransfer.files[0])},C=Q=>{Q.target.files&&Q.target.files[0]&&T(Q.target.files[0])},T=Q=>{if(!Q.name.match(/\.(xlsx|xls)$/)){p(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(Q.size>100*1024*1024){p(["File size must be less than 100MB"]);return}l(Q),p([]),_(Q)},_=Q=>{const U=new FileReader;U.onload=le=>{try{const Se=new Uint8Array(le.target.result),P=Jl(Se,{type:"array"}),G=P.SheetNames[0],K=P.Sheets[G],O=ba.sheet_to_json(K,{header:1});if(O.length<2){p(["Excel file must contain at least a header row and one data row"]);return}const F=O[0].map(we=>we?.toString().toLowerCase().trim()),H=O.slice(1),Y=E.filter(we=>!F.includes(we));if(Y.length>0){p([`Missing required columns: ${Y.join(", ")}`]);return}const pe=H.map((we,B)=>{const Be=we[F.indexOf("eid")]?.toString().trim()||"",fe=we[F.indexOf("email")]?.toString().trim()||"";return{id:`temp_${B}`,rowNumber:B+2,eid:Be,email:fe,hasError:!1,errors:[]}}).filter(we=>we.eid||we.email).map(we=>(we.eid||(we.hasError=!0,we.errors.push("EID is required")),we.email?/\S+@\S+\.\S+/.test(we.email)||(we.hasError=!0,we.errors.push("Email format is invalid")):(we.hasError=!0,we.errors.push("Email is required")),we));u(pe),b([])}catch{p(["Failed to parse Excel file. Please check the file format."])}},U.readAsArrayBuffer(Q)},k=async()=>{const Q=c.filter(U=>!U.hasError);if(Q.length===0){p(["No valid identifiers to lookup"]);return}j(!0),p([]);try{const U=Q.map(O=>({eid:O.eid,email:O.email}));console.log("Sending lookup request with identifiers:",U);const le=await Fl.lookupTrainees(U);console.log("Lookup response:",le),console.log("Found users:",le.foundUsers),console.log("Not found:",le.notFoundIdentifiers),le.foundUsers&&le.foundUsers.length>0&&(console.log(" First found user structure:",le.foundUsers[0]),console.log(" All found user IDs:",le.foundUsers.map(O=>({id:O.id,eid:O.eid,email:O.email}))));const Se=(le.foundUsers||[]).filter(O=>U.some(F=>F.eid===O.eid&&F.email===O.email)),P=U.filter(O=>!Se.some(F=>F.eid===O.eid&&F.email===O.email)),G=Se.map(O=>{if(console.log(" Validating trainee:",{id:O.id,eid:O.eid,email:O.email,firstName:O.firstName,lastName:O.lastName}),!O.id||typeof O.id!="string"||O.id.length<10)throw new Error(`Trainee ${O.eid} has invalid UUID: ${O.id}`);if(!O.firstName||!O.lastName)throw new Error(`Trainee ${O.eid} has missing name fields`);return O}),K={foundUsers:G,notFoundIdentifiers:P,uploadedIdentifiers:U};console.log("Exact matches found:",G),console.log("Not found identifiers:",P),m(K),h(G),console.log("Set selected trainees (exact matches only):",G)}catch(U){console.error("Lookup error:",U),console.error("Error response:",U.response?.data),p([U.response?.data?.message||U.message||"Failed to lookup trainees. Please try again."])}finally{j(!1)}},I=(Q,U)=>{h(U?le=>[...le,Q]:le=>le.filter(Se=>Se.id!==Q.id))},L=Q=>{h(Q?d?.foundUsers||[]:[])},D=async()=>{if(f.length===0){p(["Please select at least one trainee to import"]);return}try{r&&await r(f),M()}catch(Q){p([Q.message||"Failed to import selected trainees. Please try again."])}},M=()=>{l(null),u([]),m(null),h([]),p([]),b([]),i(!1),j(!1),t()},q=Q=>Q==="valid"?a.jsx(ht,{className:"text-success",size:16}):a.jsx(Qs,{className:"text-danger",size:16}),Z=()=>{const Q=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","trollergamehuydk+7@gmail.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],U=ba.book_new(),le=ba.aoa_to_sheet(Q);le["!cols"]=[{wch:15},{wch:30}],ba.book_append_sheet(U,le,"Trainees Lookup Template"),pg(U,"Trainees_Lookup_Template.xlsx")};return a.jsxs(ce,{show:e,onHide:M,size:"xl",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Ds,{className:"me-2",size:20}),"Bulk Import Trainees"]}),a.jsx(ie,{variant:"link",onClick:M,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[x.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:x.map((Q,U)=>a.jsx("li",{children:Q},U))})}),a.jsx(W,{className:"mb-4",children:a.jsxs(W.Body,{children:[a.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:N,onClick:()=>S.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(vo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:S,type:"file",accept:".xlsx,.xls",onChange:C,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Required columns:"})," eid, email"]}),a.jsx("div",{className:"mt-1",children:a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:Z,className:"d-flex align-items-center",children:[a.jsx($i,{className:"me-1",size:14}),"Download Template"]})})]}),o&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(vo,{className:"text-success me-2",size:16}),a.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})}),c.length>0&&a.jsxs(W,{className:"mb-4",children:[a.jsx(W.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(Gt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"800px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"150px"},children:"EID"}),a.jsx("th",{style:{minWidth:"250px"},children:"EMAIL"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"300px"},children:"ERROR ENCOUNTERED"})]})}),a.jsx("tbody",{children:c.map(Q=>a.jsxs("tr",{className:Q.hasError?"table-danger":"",children:[a.jsx("td",{children:Q.rowNumber||Q.id}),a.jsx("td",{children:Q.eid||"-"}),a.jsx("td",{children:Q.email||"-"}),a.jsx("td",{className:"text-center",children:q(Q.hasError?"invalid":"valid")}),a.jsx("td",{children:Q.errors.length>0&&a.jsx("small",{className:"text-danger",children:Q.errors.length>1?`${Q.errors[0]} (+${Q.errors.length-1} more)`:Q.errors[0]})})]},Q.id))})]})})}),a.jsx(W.Footer,{className:"bg-light",children:a.jsx(ie,{variant:"primary",onClick:k,disabled:y||c.filter(Q=>!Q.hasError).length===0,className:"d-flex align-items-center",children:y?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Looking up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Sx,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(Q=>!Q.hasError).length," valid)"]})})})]}),d&&a.jsxs(W,{children:[a.jsx(W.Header,{className:"bg-light",children:a.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",a.jsxs("span",{className:"ms-2",children:[a.jsx(ht,{className:"text-success me-1",size:16}),d.foundUsers?.length||0," matched",a.jsx(Qs,{className:"text-danger ms-2 me-1",size:16}),d.notFoundIdentifiers?.length||0," not found"]})]})}),a.jsx(W.Body,{className:"p-0",children:d.foundUsers?.length>0?a.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:a.jsxs(Gt,{hover:!0,className:"mb-0",children:[a.jsx("thead",{className:"bg-light sticky-top",children:a.jsxs("tr",{children:[a.jsx("th",{children:a.jsx(A.Check,{type:"checkbox",checked:f.length===(d.foundUsers?.length||0)&&(d.foundUsers?.length||0)>0,onChange:Q=>L(Q.target.checked)})}),a.jsx("th",{children:"EID"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Phone"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Matched From Excel"})]})}),a.jsx("tbody",{children:d.foundUsers?.map(Q=>d.uploadedIdentifiers?.find(le=>le.eid===Q.eid&&le.email===Q.email)?a.jsxs("tr",{className:f.some(le=>le.id===Q.id)?"table-success":"",children:[a.jsx("td",{children:a.jsx(A.Check,{type:"checkbox",checked:f.some(le=>le.id===Q.id),onChange:le=>I(Q,le.target.checked)})}),a.jsx("td",{children:Q.eid}),a.jsxs("td",{children:[Q.firstName," ",Q.lastName]}),a.jsx("td",{children:Q.email}),a.jsx("td",{children:Q.phoneNumber}),a.jsx("td",{children:a.jsx(Ae,{bg:Q.status==="ACTIVE"?"success":"secondary",children:Q.status})}),a.jsx("td",{children:a.jsx(Ae,{bg:"success",children:" Exact Match"})})]},Q.id):null).filter(Boolean)})]})}):a.jsxs("div",{className:"p-4 text-center",children:[a.jsx(Qs,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),a.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),d.notFoundIdentifiers?.length>0&&a.jsx(W.Footer,{className:"bg-warning bg-opacity-10",children:a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsxs("strong",{children:["Identifiers Not Found in System (",d.notFoundIdentifiers.length,"):"]}),a.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),a.jsx("ul",{className:"mb-0",children:d.notFoundIdentifiers.map((Q,U)=>a.jsxs("li",{children:[a.jsx("strong",{children:Q.eid})," - ",Q.email]},U))})]})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:M,disabled:s,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),d&&d.foundUsers?.length>0&&f.length>0&&a.jsx(ie,{variant:"primary",onClick:D,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"me-2",size:16}),"Import Selected (",f.length," matched trainees)"]})})]})]})},xoe=({show:e,onClose:t,onConfirm:r,loading:s=!1})=>{const[n,i]=v.useState(""),[o,l]=v.useState("");v.useEffect(()=>{e&&(i(""),l(""))},[e]);const c=f=>!f||f.trim()===""?"Batch code is required":f.length<3?"Batch code must be at least 3 characters long":f.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(f)?"Batch code can only contain letters, numbers, and underscores":null,u=f=>{const h=f.target.value;i(h),o&&l("")},d=()=>{const f=c(n);if(f){l(f);return}r(n.trim())},m=f=>{f.key==="Enter"&&(f.preventDefault(),d())};return a.jsxs(ce,{show:e,onHide:t,centered:!0,backdrop:"static",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsxs(ce.Title,{children:[a.jsx(fr,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),a.jsxs(ce.Body,{children:[a.jsx(A,{children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{children:["Batch Code ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:u,onKeyPress:m,isInvalid:!!o,disabled:s,autoFocus:!0}),a.jsx(A.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),o&&a.jsx(A.Control.Feedback,{type:"invalid",children:o})]})}),a.jsx(Re,{variant:"info",className:"mb-0",children:a.jsxs("small",{children:[a.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"secondary",onClick:t,disabled:s,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:d,disabled:s||!n.trim(),children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},goe=()=>{const e=it(),{courseId:t}=Nr(),r={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[s,n]=v.useState([]),[i,o]=v.useState([]),[l,c]=v.useState(!1),[u,d]=v.useState(!1),[m,f]=v.useState(!1),[h,x]=v.useState(!1),[p,g]=v.useState({});v.useEffect(()=>{(async()=>{try{const N=await Xr.getSubjects();if(N&&N.subjects){const C={};N.subjects.forEach(T=>{C[T.id]={name:T.name,code:T.code}}),g(C)}}catch{}})()},[]);const b=()=>{e(`/academic/course-detail/${t}`)},y=()=>{c(!0)},j=async w=>{if(!m){f(!0);try{const N=w.map(C=>({id:C.id,eid:C.eid,name:`${C.firstName} ${C.lastName}`.trim(),firstName:C.firstName,lastName:C.lastName,email:C.email,phoneNumber:C.phoneNumber,status:C.status,subjects:[]}));o(C=>{const T=new Set(C.map(k=>k.id)),_=N.filter(k=>!T.has(k.id));return _.length===0&&N.length>0?setTimeout(()=>{ne.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):_.length<N.length&&_.length>0?setTimeout(()=>{ne.warning(`Added ${_.length} new trainees. ${N.length-_.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100):_.length===N.length&&_.length>0&&setTimeout(()=>{ne.success(`Successfully added ${_.length} trainee${_.length>1?"s":""} to the selection!`,{autoClose:3e3,position:"top-right",toastId:"bulk-import-success",closeButton:!1})},100),[...C,..._]}),await new Promise(C=>setTimeout(C,1e3))}catch(N){throw N}finally{f(!1)}}},S=()=>{if(s.length===0||i.length===0){ne.warning("Please select both subjects and trainees to enroll");return}d(!0)},E=async w=>{x(!0),d(!1);try{const N=i.map(L=>{if(!L.id)throw new Error(`Trainee ${L.eid} (${L.firstName} ${L.lastName}) is missing UUID`);return L.id}),C={batchCode:String(w).trim(),traineeUserIds:N},T=s.map(async L=>{if(!L){const D=p[L]||{name:"Unknown",code:"N/A"};throw new Error(`Invalid subject ID: ${L} (${D.name})`)}try{const D=await Xr.assignTrainees(L,C);return{subjectId:L,response:D,status:"success",subjectName:p[L]?.name||"Unknown Subject",subjectCode:p[L]?.code||"N/A"}}catch(D){const M=p[L]||{name:"Unknown Subject",code:"N/A"};return{subjectId:L,status:"error",error:D,subjectName:M.name,subjectCode:M.code,errorMessage:D.response?.data?.message||D.message||"Unknown error",errorDetails:D.response?.data}}}),_=await Promise.allSettled(T),k=[],I=[];if(_.forEach((L,D)=>{if(L.status==="fulfilled"){const M=L.value;M.status==="success"?k.push(M):I.push(M)}else{const M=s[D],q=p[M]||{name:"Unknown Subject",code:"N/A"};I.push({subjectId:M,status:"error",subjectName:q.name,subjectCode:q.code,errorMessage:L.reason?.message||"Unknown error",errorDetails:L.reason})}}),I.length>0&&I.forEach(L=>{const D=L.errorMessage||"Unknown error",M=`${L.subjectName} (${L.subjectCode})`;let q=D;L.errorDetails?.message?q=L.errorDetails.message:L.errorDetails?.errors&&Array.isArray(L.errorDetails.errors)&&(q=L.errorDetails.errors.map(Z=>Z.message||Z).join(", ")),ne.error(`${M}: ${q}`,{autoClose:5e3,position:"top-right",icon:!1})}),k.length>0){const L=i.length;if(ne.success(`Successfully enrolled ${L} trainee(s) to ${k.length} subject(s): ${k.map(D=>D.subjectName).join(", ")}`,{autoClose:4e3,position:"top-right",icon:!1}),I.length===0)o([]),n([]);else{const D=new Set(k.map(M=>M.subjectId));n(M=>M.filter(q=>!D.has(q)))}setTimeout(()=>{e(`/academic/course-detail/${t}`,{state:{activeTab:"trainees"}})},1e3)}}catch(N){let C="Failed to enroll trainees. Please try again.";N.response?.data?.message?C=N.response.data.message:N.message&&(C=N.message),ne.error(C)}finally{x(!1)}};return a.jsxs(_e,{fluid:!0,className:"py-4 px-4 enroll-page",style:{minHeight:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{className:"mb-3 flex-shrink-0",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:b,className:"me-3",children:[a.jsx(_t,{size:16,className:"me-1"}),"Back"]}),a.jsx("div",{children:a.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",a.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),a.jsx(W,{className:"mb-2",children:a.jsx(W.Body,{className:"py-3 px-3",children:a.jsxs(de,{children:[a.jsx(z,{md:8,children:a.jsx("p",{className:"mb-0 text-muted",children:r.description})}),a.jsxs(z,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[a.jsx(ie,{size:"sm",variant:"primary",onClick:S,disabled:s.length===0||i.length===0||h,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:h?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ms,{size:12,className:"me-1"})," Enroll"]})}),a.jsxs(ie,{size:"sm",variant:"outline-primary",onClick:y,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[a.jsx(Ds,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),a.jsx("div",{className:"mb-4 flex-shrink-0 main-content-section",style:{position:"relative",zIndex:1,marginBottom:"3rem"},children:a.jsxs(de,{className:"g-4",children:[a.jsx(z,{lg:6,children:a.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible"},children:a.jsx(foe,{selectedSubjects:s,onSelectionChange:n})})}),a.jsx(z,{lg:6,children:a.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible"},children:a.jsx(hoe,{selectedTrainees:i,onSelectionChange:o})})})]})}),a.jsx(poe,{show:l,onClose:()=>c(!1),onImport:j,loading:m}),a.jsx(xoe,{show:u,onClose:()=>d(!1),onConfirm:E,loading:h})]})},voe=({assessmentEvents:e=[],loading:t=!1,onView:r,onUpdate:s})=>{const{sortedData:n,sortConfig:i,handleSort:o}=Zt(e);if(t)return a.jsx(Rt,{rows:4,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No assessment events found"}),a.jsx("p",{children:"There are no assessment events available."})]})});const l=({columnKey:d,children:m,className:f=""})=>{const h=i.key===d,x=h?i.direction:null;return a.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:x,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},c=d=>{switch(String(d||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},u=d=>{if(!d)return"-";try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return a.jsx("div",{className:"table-responsive",children:a.jsxs(Gt,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(l,{columnKey:"name",children:"Name"}),a.jsx(l,{columnKey:"subject",children:"Subject"}),a.jsx(l,{columnKey:"course",children:"Course"}),a.jsx(l,{columnKey:"occurrenceDate",children:"Occurrence Date"}),a.jsx(l,{columnKey:"status",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:n.map((d,m)=>a.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:f=>{f.currentTarget.style.backgroundColor=""},children:[a.jsx("td",{className:"align-middle",children:a.jsx("span",{className:"fw-medium",children:d.name||"-"})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:d.subject||"-"})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:d.course||"-"})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:u(d.occurrenceDate)})}),a.jsx("td",{className:"align-middle",children:a.jsx(Ae,{bg:c(d.status),className:"px-3 py-2",children:d.status||"-"})}),a.jsx("td",{className:"align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r&&r(d.originalEvent||d)},{label:"Update",icon:a.jsx(Br,{}),onClick:()=>s&&s(d.originalEvent||d)}]})})]},d.id||m))})]})})},boe=({show:e,onClose:t,onSave:r,event:s,loading:n=!1})=>{const[i,o]=v.useState({name:"",occuranceDate:""}),[l,c]=v.useState({}),[u,d]=v.useState(!1),m=g=>{if(!g)return"";if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g))return g;try{const b=new Date(g);return isNaN(b.getTime())?"":b.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&s?o({name:s.name||"",occuranceDate:m(s.occuranceDate||s.occurrenceDate)}):e||(o({name:"",occuranceDate:""}),c({}))},[e,s]);const f=()=>{c({}),d(!1),t()},h=g=>{const{name:b,value:y}=g.target;o(j=>({...j,[b]:y})),l[b]&&c(j=>({...j,[b]:""}))},x=()=>{const g={};if((!i.name||i.name.trim()==="")&&(g.name="Event name is required"),!i.occuranceDate)g.occuranceDate="Occurrence date is required";else{const b=new Date(i.occuranceDate),y=new Date;y.setHours(0,0,0,0),b<y&&(g.occuranceDate="Occurrence date cannot be in the past")}return c(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!x()){if(!s){ne.error("Event data is missing");return}d(!0);try{const[b,y,j]=i.occuranceDate.split("-").map(Number),E=new Date(Date.UTC(b,y-1,j,0,0,0,0)).toISOString(),w=s.occuranceDate||s.occurrenceDate,N=m(w),C={name:s.name,occuranceDate:N,templateId:s.templateInfo?.id||""};s.subjectId===null&&s.courseId?C.courseId=s.courseId:s.subjectId&&(C.subjectId=s.subjectId);const T={name:i.name,occuranceDate:E};console.log("Update Assessment Event - Request:",{params:C,body:T,isoDateString:E}),await pc.updateAssessmentEvent(C,T),ne.success("Assessment event updated successfully"),r&&r(),f()}catch(b){console.error("Error updating assessment event:",b);const y=b.response?.data?.message||b.message||"Failed to update assessment event";ne.error(y)}finally{d(!1)}}};return s?a.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[a.jsx(Br,{className:"me-2",size:20}),"Update Assessment Event"]}),a.jsx(ie,{variant:"link",onClick:f,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},disabled:u,children:a.jsx(nt,{size:24,color:"#ffffff"})})]}),a.jsxs(A,{onSubmit:p,children:[a.jsxs(ce.Body,{className:"p-4",children:[a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Event Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",name:"name",value:i.name,onChange:h,isInvalid:!!l.name,placeholder:"Enter event name",disabled:u||n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.name})]})})}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Occurrence Date ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"date",name:"occuranceDate",value:i.occuranceDate,onChange:h,isInvalid:!!l.occuranceDate,disabled:u||n}),a.jsx(A.Control.Feedback,{type:"invalid",children:l.occuranceDate})]})})}),a.jsxs(de,{className:"mt-4",children:[a.jsx(z,{md:6,children:a.jsxs("div",{className:"p-3 bg-light rounded",children:[a.jsx("small",{className:"text-muted d-block mb-1",children:"Course/Subject"}),a.jsx("strong",{children:s.entityInfo?.name||"-"})]})}),a.jsx(z,{md:6,children:a.jsxs("div",{className:"p-3 bg-light rounded",children:[a.jsx("small",{className:"text-muted d-block mb-1",children:"Template"}),a.jsx("strong",{children:s.templateInfo?.name||"-"})]})})]})]}),a.jsxs(ce.Footer,{className:"border-top",children:[a.jsx(ie,{variant:"secondary",onClick:f,disabled:u||n,children:"Cancel"}),a.jsx(ie,{variant:"primary",type:"submit",disabled:u||n,className:"d-flex align-items-center",children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Update Event"]})})]})]})]}):null},yoe=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),[s,n]=v.useState({}),[i,o]=v.useState(!1),[l,c]=v.useState([]),[u,d]=v.useState([]),[m,f]=v.useState([]),[h,x]=v.useState([]),[p,g]=v.useState([]),[b,y]=v.useState(!1),[j,S]=v.useState(null),[E,w]=v.useState(!1),[N,C]=v.useState(!0),[T,_]=v.useState(!1),[k,I]=v.useState(!0),[L,D]=v.useState(!0),[M,q]=v.useState(!1);v.useEffect(()=>{(async()=>{try{C(!0);const F=await kt.getDepartments();console.log("Departments API response:",F);let H=[];F?.data?.departments?H=F.data.departments:F?.departments?H=F.departments:F?.data&&Array.isArray(F.data)?H=F.data:Array.isArray(F)&&(H=F),console.log("All departments data:",H),console.log("First department sample:",H[0]);const Y=H.filter(te=>"status"in te?te.status==="ACTIVE":!0);console.log("Active departments:",Y),c(Y)}catch(F){console.error("Error loading departments:",F),ne.error("Failed to load departments"),c([])}finally{C(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){d([]),r(F=>({...F,templateId:""}));return}try{_(!0);const F=await Ya.getTemplatesByDepartment(t.departmentId),H=F?.data?.templates||F?.templates||F?.data||F||[];d(H),r(Y=>({...Y,templateId:""}))}catch(F){console.error("Error loading templates:",F),ne.error("Failed to load templates"),d([])}finally{_(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),x([]),I(!1),D(!1),r(F=>({...F,courseId:"",subjectId:"",traineeIds:[]}));return}try{I(!0),D(!0);const F=await kt.getDepartmentById(t.departmentId);let H=[];F?.courses&&Array.isArray(F.courses)?H=F.courses:F?.data?.courses&&Array.isArray(F.data.courses)&&(H=F.data.courses);const Y=H.filter(B=>B.status==="ACTIVE"||B.status==="PLANNED");f(Y);let te=[];Y.forEach(B=>{B.subjects&&Array.isArray(B.subjects)&&(te=te.concat(B.subjects))}),F?.subjects&&Array.isArray(F.subjects)?te=te.concat(F.subjects):F?.data?.subjects&&Array.isArray(F.data.subjects)&&(te=te.concat(F.data.subjects));const we=te.filter((B,Be,fe)=>Be===fe.findIndex(oe=>oe.id===B.id)).filter(B=>B.status==="ON_GOING"||B.status==="ACTIVE");x(we),r(B=>({...B,courseId:"",subjectId:"",traineeIds:[]}))}catch(F){console.error("Error loading courses and subjects:",F),ne.error("Failed to load courses and subjects"),f([]),x([])}finally{I(!1),D(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(F=>({...F,traineeIds:[]}));return}try{q(!0);let F=[];if(t.courseId&&!t.subjectId){const H=await Jr.getCourseTrainees(t.courseId);F=H?.trainees||H?.data?.trainees||[]}else if(t.subjectId){const H=await Xr.getSubjectById(t.subjectId),Y=[];H?.enrollmentsByBatch&&H.enrollmentsByBatch.forEach(te=>{te.trainees&&Array.isArray(te.trainees)&&te.trainees.forEach(pe=>{Y.push({id:pe.id,eid:pe.eid,firstName:pe.firstName,lastName:pe.lastName,email:pe.email})})}),F=Y}g(F),r(H=>({...H,traineeIds:[]}))}catch(F){console.error("Error loading trainees:",F),ne.error("Failed to load trainees"),g([])}finally{q(!1)}})()},[t.courseId,t.subjectId]);const Z=O=>{const{name:F,value:H}=O.target;r(F==="courseId"?Y=>({...Y,courseId:H,subjectId:H?"":Y.subjectId}):F==="subjectId"?Y=>({...Y,subjectId:H,courseId:H?"":Y.courseId}):Y=>({...Y,[F]:H})),s[F]&&n(Y=>({...Y,[F]:""}))},Q=O=>{r(F=>{const H=F.traineeIds||[],Y=H.includes(O)?H.filter(te=>te!==O):[...H,O];return{...F,traineeIds:Y}}),s.traineeIds&&n(F=>({...F,traineeIds:""}))},U=O=>{r(F=>({...F,templateId:O}))},le=async O=>{if(!O||!O.id){ne.error("Template not found");return}try{w(!0),y(!0);const F=await Ya.getTemplatePDF(O.id),H=URL.createObjectURL(F);S(H)}catch(F){console.error("Error loading PDF:",F),ne.error("Failed to load PDF preview"),y(!1)}finally{w(!1)}},Se=()=>{y(!1),j&&(URL.revokeObjectURL(j),S(null))},P=()=>{const O={};return t.departmentId||(O.departmentId="Department is required"),t.templateId||(O.templateId="Template is required"),!t.subjectId&&!t.courseId&&(O.courseSubject="Either Course or Subject must be selected"),t.subjectId&&t.courseId&&(O.courseSubject="Course and Subject cannot be selected at the same time"),t.occuranceDate||(O.occuranceDate="Occurrence date is required"),(!t.name||t.name.trim()==="")&&(O.name="Event name is required"),(!t.traineeIds||t.traineeIds.length===0)&&(O.traineeIds="At least one trainee must be selected"),n(O),Object.keys(O).length===0},G=async O=>{if(O.preventDefault(),!!P()){o(!0);try{const F={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,traineeIds:t.traineeIds};t.courseId?F.courseId=t.courseId:t.subjectId&&(F.subjectId=t.subjectId),await pc.createAssessmentEvent(F),ne.success("Assessment event created successfully"),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),n({}),g([]),e&&e()}catch(F){console.error("Error creating assessment event:",F);const H=F.response?.data?.message||F.message||"Failed to create assessment event";ne.error(H)}finally{o(!1)}}},K=O=>{const F=O.firstName||"",H=O.lastName||"",Y=O.middleName||"";return`${F} ${Y} ${H}`.trim()||O.eid||"Unknown"};return a.jsxs(A,{onSubmit:G,className:"create-assessment-event-form",children:[a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Department ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Rn,{name:"departmentId",value:t.departmentId,onChange:Z,isInvalid:!!s.departmentId,disabled:i||N,placeholder:"Select a department",options:l.map(O=>({value:O.id,label:O.name}))}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.departmentId})]})})}),a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Template ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx(Rn,{name:"templateId",value:t.templateId,onChange:O=>U(O.target.value),isInvalid:!!s.templateId,disabled:i||T||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:u.map(O=>({value:O.id,label:O.name}))}),t.templateId&&a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>{const O=u.find(F=>F.id===t.templateId);O&&le(O)},disabled:i,className:"d-flex align-items-center",children:[a.jsx(Et,{size:16,className:"me-1"}),"Preview"]})]}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.templateId}),!t.departmentId&&a.jsx(A.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3 course-select-group",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Course"}),a.jsx(Rn,{name:"courseId",value:t.courseId,onChange:Z,disabled:i||k||!!t.subjectId,placeholder:"Select a course (optional)",options:m.map(O=>({value:O.id,label:`${O.name} (${O.code})`}))}),t.subjectId&&a.jsx(A.Text,{className:"text-muted",children:"Subject is selected. Course cannot be selected."})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3 subject-select-group",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Subject"}),a.jsx(Rn,{name:"subjectId",value:t.subjectId,onChange:Z,disabled:i||L||!!t.courseId,placeholder:"Select a subject (optional)",options:h.map(O=>({value:O.id,label:`${O.name} (${O.code})`}))}),t.courseId&&a.jsx(A.Text,{className:"text-muted",children:"Course is selected. Subject cannot be selected."})]})})]}),s.courseSubject&&a.jsx(Re,{variant:"danger",className:"mb-3",children:s.courseSubject}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Event Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",name:"name",value:t.name,onChange:Z,isInvalid:!!s.name,placeholder:"Enter event name",disabled:i}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.name})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Occurrence Date ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:Z,isInvalid:!!s.occuranceDate,disabled:i}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.occuranceDate})]})})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Trainees ",a.jsx("span",{className:"text-danger",children:"*"})]}),!t.courseId&&!t.subjectId?a.jsx(Re,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):M?a.jsxs("div",{className:"text-center py-3",children:[a.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):p.length===0?a.jsxs(Re,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):a.jsx(W,{className:"border",style:{maxHeight:"300px",overflowY:"auto"},children:a.jsx(W.Body,{className:"p-3",children:a.jsx("div",{className:"d-flex flex-column gap-2",children:p.map(O=>{const F=t.traineeIds?.includes(O.id);return a.jsx("div",{className:`p-2 border rounded cursor-pointer ${F?"bg-primary":"bg-light"}`,onClick:()=>Q(O.id),style:{cursor:"pointer",transition:"all 0.2s ease",backgroundColor:F?"var(--bs-primary)":"var(--bs-light)",color:F?"#ffffff":"var(--bs-dark)"},onMouseEnter:H=>{F||(H.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:H=>{F||(H.currentTarget.style.backgroundColor="var(--bs-light)")},children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsxs("div",{children:[a.jsx("strong",{style:{color:F?"#ffffff":"inherit"},children:K(O)}),O.eid&&a.jsx(Ae,{bg:F?"light":"secondary",className:"ms-2",style:{color:F?"var(--bs-primary)":"#ffffff"},children:O.eid})]}),F&&a.jsx(Ae,{bg:"light",style:{color:"var(--bs-primary)"},children:"Selected"})]})},O.id)})})})}),s.traineeIds&&t.traineeIds?.length===0&&a.jsx("div",{className:"text-danger mt-1",style:{fontSize:"0.875rem"},children:s.traineeIds}),t.traineeIds&&t.traineeIds.length>0&&a.jsxs(A.Text,{className:"text-muted",children:[t.traineeIds.length," trainee(s) selected"]})]})})}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[a.jsx(ie,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),n({}),g([]),d([])},disabled:i,children:"Reset"}),a.jsx(ie,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Create Assessment Event"]})})]}),a.jsxs(ce,{show:b,onHide:Se,size:"lg",centered:!0,fullscreen:"lg-down",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Template Preview"})}),a.jsx(ce.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:E?a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):j?a.jsx("iframe",{src:j,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:a.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},joe=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),[s,n]=v.useState({}),[i,o]=v.useState(!1),[l,c]=v.useState([]),[u,d]=v.useState([]),[m,f]=v.useState([]),[h,x]=v.useState([]),[p,g]=v.useState([]),[b,y]=v.useState(!1),[j,S]=v.useState(null),[E,w]=v.useState(!1),[N,C]=v.useState(!0),[T,_]=v.useState(!1),[k,I]=v.useState(!0),[L,D]=v.useState(!0),[M,q]=v.useState(!1);v.useEffect(()=>{(async()=>{try{C(!0);const F=await kt.getDepartments();console.log("Departments API response:",F);let H=[];F?.data?.departments?H=F.data.departments:F?.departments?H=F.departments:F?.data&&Array.isArray(F.data)?H=F.data:Array.isArray(F)&&(H=F),console.log("All departments data:",H),console.log("First department sample:",H[0]);const Y=H.filter(te=>"status"in te?te.status==="ACTIVE":!0);console.log("Active departments:",Y),c(Y)}catch(F){console.error("Error loading departments:",F),ne.error("Failed to load departments"),c([])}finally{C(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){d([]),r(F=>({...F,templateId:""}));return}try{_(!0);const F=await Ya.getTemplatesByDepartment(t.departmentId),H=F?.data?.templates||F?.templates||F?.data||F||[];d(H),r(Y=>({...Y,templateId:""}))}catch(F){console.error("Error loading templates:",F),ne.error("Failed to load templates"),d([])}finally{_(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),x([]),I(!1),D(!1),r(F=>({...F,courseId:"",subjectId:"",excludeTraineeIds:[]}));return}try{I(!0),D(!0);const F=await kt.getDepartmentById(t.departmentId);let H=[];F?.courses&&Array.isArray(F.courses)?H=F.courses:F?.data?.courses&&Array.isArray(F.data.courses)&&(H=F.data.courses);const Y=H.filter(B=>B.status==="ACTIVE"||B.status==="PLANNED");f(Y);let te=[];Y.forEach(B=>{B.subjects&&Array.isArray(B.subjects)&&(te=te.concat(B.subjects))}),F?.subjects&&Array.isArray(F.subjects)?te=te.concat(F.subjects):F?.data?.subjects&&Array.isArray(F.data.subjects)&&(te=te.concat(F.data.subjects));const we=te.filter((B,Be,fe)=>Be===fe.findIndex(oe=>oe.id===B.id)).filter(B=>B.status==="ON_GOING"||B.status==="ACTIVE");x(we),r(B=>({...B,courseId:"",subjectId:"",excludeTraineeIds:[]}))}catch(F){console.error("Error loading courses and subjects:",F),ne.error("Failed to load courses and subjects"),f([]),x([])}finally{I(!1),D(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(F=>({...F,excludeTraineeIds:[]}));return}try{q(!0);let F=[];if(t.courseId&&!t.subjectId){const H=await Jr.getCourseTrainees(t.courseId);F=H?.trainees||H?.data?.trainees||[]}else if(t.subjectId){const H=await Xr.getSubjectById(t.subjectId),Y=[];H?.enrollmentsByBatch&&H.enrollmentsByBatch.forEach(te=>{te.trainees&&Array.isArray(te.trainees)&&te.trainees.forEach(pe=>{Y.push({id:pe.id,eid:pe.eid,firstName:pe.firstName,lastName:pe.lastName,email:pe.email})})}),F=Y}g(F)}catch(F){console.error("Error loading trainees:",F),ne.error("Failed to load trainees"),g([])}finally{q(!1)}})()},[t.courseId,t.subjectId]);const Z=O=>{const F=O.firstName||"",H=O.lastName||"",Y=O.middleName||"";return`${F} ${Y} ${H}`.trim()||O.eid||"Unknown"},Q=O=>{const{name:F,value:H}=O.target;r(F==="courseId"?Y=>({...Y,courseId:H,subjectId:H?"":Y.subjectId,excludeTraineeIds:[]}):F==="subjectId"?Y=>({...Y,subjectId:H,courseId:H?"":Y.courseId,excludeTraineeIds:[]}):Y=>({...Y,[F]:H})),s[F]&&n(Y=>({...Y,[F]:""}))},U=O=>{r(F=>{const H=F.excludeTraineeIds||[],Y=H.includes(O)?H.filter(te=>te!==O):[...H,O];return{...F,excludeTraineeIds:Y}}),s.excludeTraineeIds&&n(F=>({...F,excludeTraineeIds:""}))},le=O=>{r(F=>({...F,templateId:O}))},Se=async O=>{if(!O||!O.id){ne.error("Template not found");return}try{w(!0),y(!0);const F=await Ya.getTemplatePDF(O.id),H=URL.createObjectURL(F);S(H)}catch(F){console.error("Error loading PDF:",F),ne.error("Failed to load PDF preview"),y(!1)}finally{w(!1)}},P=()=>{y(!1),j&&(URL.revokeObjectURL(j),S(null))},G=()=>{const O={};return t.departmentId||(O.departmentId="Department is required"),t.templateId||(O.templateId="Template is required"),!t.subjectId&&!t.courseId&&(O.courseSubject="Either Course or Subject must be selected"),t.subjectId&&t.courseId&&(O.courseSubject="Course and Subject cannot be selected at the same time"),t.occuranceDate||(O.occuranceDate="Occurrence date is required"),(!t.name||t.name.trim()==="")&&(O.name="Event name is required"),n(O),Object.keys(O).length===0},K=async O=>{if(O.preventDefault(),!!G()){o(!0);try{const F={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,excludeTraineeIds:t.excludeTraineeIds||[]};t.courseId?F.courseId=t.courseId:t.subjectId&&(F.subjectId=t.subjectId),await pc.createBulkAssessmentEvent(F),ne.success("Bulk assessment event created successfully"),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),setSelectedTemplate(null),e&&e()}catch(F){console.error("Error creating bulk assessment event:",F);const H=F.response?.data?.message||F.message||"Failed to create bulk assessment event";ne.error(H)}finally{o(!1)}}};return a.jsxs(A,{onSubmit:K,className:"create-assessment-event-form",children:[a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Department ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Rn,{name:"departmentId",value:t.departmentId,onChange:Q,isInvalid:!!s.departmentId,disabled:i||N,placeholder:"Select a department",options:l.map(O=>({value:O.id,label:O.name}))}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.departmentId})]})})}),a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Template ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx(Rn,{name:"templateId",value:t.templateId,onChange:O=>le(O.target.value),isInvalid:!!s.templateId,disabled:i||T||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:u.map(O=>({value:O.id,label:O.name}))}),t.templateId&&a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>{const O=u.find(F=>F.id===t.templateId);O&&Se(O)},disabled:i,className:"d-flex align-items-center",children:[a.jsx(Et,{size:16,className:"me-1"}),"Preview"]})]}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.templateId}),!t.departmentId&&a.jsx(A.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3 course-select-group",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Course"}),a.jsx(Rn,{name:"courseId",value:t.courseId,onChange:Q,disabled:i||k||!!t.subjectId,placeholder:"Select a course (optional)",options:m.map(O=>({value:O.id,label:`${O.name} (${O.code})`}))}),t.subjectId&&a.jsx(A.Text,{className:"text-muted",children:"Subject is selected. Course cannot be selected."})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3 subject-select-group",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Subject"}),a.jsx(Rn,{name:"subjectId",value:t.subjectId,onChange:Q,disabled:i||L||!!t.courseId,placeholder:"Select a subject (optional)",options:h.map(O=>({value:O.id,label:`${O.name} (${O.code})`}))}),t.courseId&&a.jsx(A.Text,{className:"text-muted",children:"Course is selected. Subject cannot be selected."})]})})]}),s.courseSubject&&a.jsx(Re,{variant:"danger",className:"mb-3",children:s.courseSubject}),a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Event Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",name:"name",value:t.name,onChange:Q,isInvalid:!!s.name,placeholder:"Enter event name",disabled:i}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.name})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-semibold",children:["Occurrence Date ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:Q,isInvalid:!!s.occuranceDate,disabled:i}),a.jsx(A.Control.Feedback,{type:"invalid",children:s.occuranceDate})]})})]}),a.jsx(de,{children:a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"fw-semibold",children:"Exclude Trainees (Optional)"}),!t.courseId&&!t.subjectId?a.jsx(Re,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):M?a.jsxs("div",{className:"text-center py-3",children:[a.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):p.length===0?a.jsxs(Re,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):a.jsx(W,{className:"border",style:{maxHeight:"300px",overflowY:"auto"},children:a.jsx(W.Body,{className:"p-3",children:a.jsx("div",{className:"d-flex flex-column gap-2",children:p.map(O=>{const F=t.excludeTraineeIds?.includes(O.id);return a.jsx("div",{className:`p-2 border rounded cursor-pointer ${F?"bg-primary":"bg-light"}`,onClick:()=>U(O.id),style:{cursor:"pointer",transition:"all 0.2s ease",backgroundColor:F?"var(--bs-primary)":"var(--bs-light)",color:F?"#ffffff":"var(--bs-dark)"},onMouseEnter:H=>{F||(H.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:H=>{F||(H.currentTarget.style.backgroundColor="var(--bs-light)")},children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsxs("div",{children:[a.jsx("strong",{style:{color:F?"#ffffff":"inherit"},children:Z(O)}),O.eid&&a.jsx(Ae,{bg:F?"light":"secondary",className:"ms-2",style:{color:F?"var(--bs-primary)":"#ffffff"},children:O.eid})]}),F&&a.jsx(Ae,{bg:"light",style:{color:"var(--bs-primary)"},children:"Excluded"})]})},O.id)})})})}),t.excludeTraineeIds&&t.excludeTraineeIds.length>0&&a.jsxs(A.Text,{className:"text-muted",children:[t.excludeTraineeIds.length," trainee(s) excluded"]})]})})}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[a.jsx(ie,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),d([])},disabled:i,children:"Reset"}),a.jsx(ie,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]}),a.jsxs(ce,{show:b,onHide:P,size:"lg",centered:!0,fullscreen:"lg-down",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Template Preview"})}),a.jsx(ce.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:E?a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):j?a.jsx("iframe",{src:j,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:a.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},woe=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(!0),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("list"),f=async()=>{try{s(!0);const E=((await pc.getAssessmentEvents())?.data?.events||[]).map((w,N)=>{let C="",T="";return w.subjectId===null?w.entityInfo&&w.entityInfo.type==="course"&&(T=w.entityInfo.name||"",C=""):(w.entityInfo&&w.entityInfo.type==="subject"&&(C=w.entityInfo.name||""),T=""),{id:w.id||`event-${N}`,name:w.name||"N/A",subject:C,course:T,occurrenceDate:w.occuranceDate||w.occurrenceDate,status:w.status||"N/A",originalEvent:w}});t(E)}catch(j){console.error("Error loading assessment events:",j),t([])}finally{s(!1)}};v.useEffect(()=>{f()},[]);const h=j=>{const S=j.originalEvent||j;u(S),i(!0)},x=()=>{i(!1),u(null)},p=j=>{const S=j.originalEvent||j;u(S),l(!0)},g=()=>{l(!1),u(null)},b=()=>{f()},y=()=>{f(),m("list")};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{children:a.jsx(z,{children:a.jsx(W,{className:"shadow-sm",children:a.jsx(Ft.Container,{activeKey:d,onSelect:m,children:a.jsxs(W.Body,{className:"p-0",style:{overflow:"visible",minHeight:"800px"},children:[a.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"list",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="list"?"600":"400",opacity:d==="list"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(yx,{className:"me-2",size:16}),"Assessment Events"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"create",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="create"?"600":"400",opacity:d==="create"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(ms,{className:"me-2",size:16}),"Create New Assessment Event"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"create-bulk",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="create-bulk"?"600":"400",opacity:d==="create-bulk"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(h2,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]})}),a.jsxs(Ft.Content,{children:[a.jsx(Ft.Pane,{eventKey:"list",className:"p-4",children:a.jsx(voe,{assessmentEvents:e,loading:r,onView:h,onUpdate:p})}),a.jsx(Ft.Pane,{eventKey:"create",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:a.jsx(yoe,{onSuccess:y})}),a.jsx(Ft.Pane,{eventKey:"create-bulk",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:a.jsx(joe,{onSuccess:y})})]})]})})})})}),a.jsx(x1,{show:n,onClose:x,event:c}),a.jsx(boe,{show:o,onClose:g,onSave:b,event:c,loading:r})]})},Noe=({traineeId:e,courseId:t})=>{const r=it(),[s,n]=v.useState([]),[i,o]=v.useState(!0),{sortedData:l,sortConfig:c,handleSort:u}=Zt(s);v.useEffect(()=>{e&&t&&d()},[e,t]);const d=async()=>{try{o(!0);const p=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(g=>setTimeout(g,300)),n(p)}catch(p){console.error("Error loading trainee subjects:",p),ne.error("Failed to load subjects")}finally{o(!1)}},m=p=>{const b={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[p]||{variant:"secondary",text:p};return a.jsx(Ae,{bg:b.variant,children:b.text})},f=p=>{const b={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[p]||{variant:"secondary",text:p};return a.jsx(Ae,{bg:b.variant,children:b.text})},h=p=>{r(`/trainee/${e}/course/${t}/subject/${p}`)},x=({columnKey:p,children:g,className:b=""})=>{const y=c.key===p,j=y?c.direction:null;return a.jsxs("th",{className:`fw-semibold ${b}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>u(p),onMouseEnter:S=>{S.target.style.backgroundColor="#214760",S.target.style.transform="translateY(-1px)",S.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:S=>{S.target.style.backgroundColor="var(--bs-primary)",S.target.style.transform="translateY(0)",S.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:y?"600":"500",color:"white"},children:g}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:j,size:14,color:"white"})})]}),y&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return i?a.jsx(Rt,{rows:5,columns:8}):s.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(x,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),a.jsx(x,{columnKey:"name",className:"show-mobile",children:"Subject Name"}),a.jsx(x,{columnKey:"level",className:"show-mobile",children:"Level"}),a.jsx(x,{columnKey:"duration",className:"show-mobile",children:"Duration"}),a.jsx(x,{columnKey:"method",className:"show-mobile",children:"Method"}),a.jsx(x,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(x,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:l.map((p,g)=>a.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Ae,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:p.code})}),a.jsxs("td",{className:"align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:p.name}),a.jsx("small",{className:"text-muted",children:p.description})]}),a.jsx("td",{className:"align-middle show-mobile",children:f(p.level)}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("span",{className:"text-dark",children:[p.duration," hours"]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Ae,{bg:"info",className:"fw-normal",children:p.method||"Classroom"})}),a.jsx("td",{className:"align-middle show-mobile",children:m(p.status)}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${p.progress||0}%`}})}),a.jsxs("small",{className:"text-muted",children:[p.progress||0,"%"]})]})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>h(p.id)}]})})]},p.id))})]})})},Soe=({traineeId:e,courseId:t})=>{const r=it(),[s,n]=v.useState([]),[i,o]=v.useState(!0),{sortedData:l,sortConfig:c,handleSort:u}=Zt(s);v.useEffect(()=>{e&&d()},[e,t]);const d=async()=>{try{o(!0);const y=[{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}],j=[{id:"4",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",type:"Written Test",subject:"Basic Safety Protocols",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"5",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",type:"Practical Assessment",subject:"Emergency Procedures",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"6",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",type:"Quiz",subject:"Equipment Handling",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}],S=[...y.map(E=>({...E,isUpcoming:!0})),...j.map(E=>({...E,isUpcoming:!1}))];await new Promise(E=>setTimeout(E,300)),n(S)}catch(y){console.error("Error loading assessments:",y),ne.error("Failed to load assessments")}finally{o(!1)}},m=y=>{const S={UPCOMING:{variant:"warning",text:"Upcoming",icon:ft},PENDING:{variant:"warning",text:"Pending",icon:ft},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Dt},COMPLETED:{variant:"success",text:"Completed",icon:ht},PASSED:{variant:"success",text:"Passed",icon:ht},FAILED:{variant:"danger",text:"Failed",icon:fr},OVERDUE:{variant:"danger",text:"Overdue",icon:fr}}[y]||{variant:"secondary",text:y,icon:Dt},E=S.icon;return a.jsxs(Ae,{bg:S.variant,className:"d-flex align-items-center",children:[a.jsx(E,{size:12,className:"me-1"}),S.text]})},f=y=>{const S={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[y]||{variant:"secondary",text:y};return a.jsx(Ae,{bg:S.variant,children:S.text})},h=y=>{const S={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"},QUIZ:{variant:"secondary",text:"Quiz"}}[y?.toUpperCase()]||{variant:"secondary",text:y};return a.jsx(Ae,{bg:S.variant,children:S.text})},x=(y,j)=>{if(!y||!j)return null;const S=y/j*100;let E="success";return S<60?E="danger":S<80&&(E="warning"),a.jsxs(Ae,{bg:E,children:[y,"/",j," (",S.toFixed(0),"%)"]})},p=async y=>{try{r(`/trainee/${e}/assessment/${y}?action=start`)}catch(j){console.error("Error starting assessment:",j),ne.error("Failed to start assessment")}},g=y=>{r(`/trainee/${e}/assessment/${y}`)},b=({columnKey:y,children:j,className:S=""})=>{const E=c.key===y,w=E?c.direction:null;return a.jsxs("th",{className:`fw-semibold ${S}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>u(y),onMouseEnter:N=>{N.target.style.backgroundColor="#214760",N.target.style.transform="translateY(-1px)",N.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:N=>{N.target.style.backgroundColor="var(--bs-primary)",N.target.style.transform="translateY(0)",N.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:E?"600":"500",color:"white"},children:j}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:w,size:14,color:"white"})})]}),E&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return i?a.jsx(Rt,{rows:5,columns:8}):s.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No assessment events"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(b,{columnKey:"name",className:"show-mobile",children:"Assessment"}),a.jsx(b,{columnKey:"subject",className:"show-mobile",children:"Subject"}),a.jsx(b,{columnKey:"type",className:"show-mobile",children:"Type"}),a.jsx(b,{columnKey:"priority",className:"show-mobile",children:"Priority"}),a.jsx(b,{columnKey:"dueDate",className:"show-mobile",children:"Date"}),a.jsx(b,{columnKey:"score",className:"show-mobile",children:"Score"}),a.jsx(b,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:l.map((y,j)=>a.jsxs("tr",{className:`${j%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:S=>{S.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:S=>{S.currentTarget.style.backgroundColor=j%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsxs("td",{className:"align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:y.name}),y.description&&a.jsx("small",{className:"text-muted",children:y.description})]}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:y.subject})}),a.jsx("td",{className:"align-middle show-mobile",children:h(y.type)}),a.jsx("td",{className:"align-middle show-mobile",children:f(y.priority)}),a.jsx("td",{className:"align-middle show-mobile",children:y.isUpcoming?a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-1",size:14}),a.jsx("span",{className:"text-dark",children:y.dueDate?new Date(y.dueDate).toLocaleDateString():"N/A"})]}):a.jsx("span",{className:"text-dark",children:y.completedDate?new Date(y.completedDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"align-middle show-mobile",children:y.isUpcoming?a.jsx("span",{className:"text-muted",children:"-"}):x(y.score,y.maxScore)}),a.jsx("td",{className:"align-middle show-mobile",children:m(y.status)}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:y.isUpcoming?[{label:"Start Assessment",icon:a.jsx(Dt,{}),onClick:()=>p(y.id)}]:[{label:"View Results",icon:a.jsx(ht,{}),onClick:()=>g(y.id)}]})})]},y.id))})]})})},Eoe=({traineeId:e,courseId:t})=>{const r=it(),[s,n]=v.useState(null),[i,o]=v.useState(null),[l,c]=v.useState(!0),[u,d]=v.useState(""),[m,f]=v.useState("subjects");v.useEffect(()=>{e&&t&&h()},[e,t]);const h=async()=>{try{c(!0),d(""),o({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),n({id:t,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(p){console.error("Error loading course details:",p),d("Failed to load course details"),ne.error("Failed to load course details")}finally{c(!1)}},x=()=>{r("/trainee/enrolled-courses")};return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):u||!s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:u||"Course not found"}),a.jsxs(ie,{variant:"outline-danger",onClick:x,children:[a.jsx(_t,{className:"me-2",size:16}),"Back to Trainee"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",onClick:x,className:"me-3",children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(It,{className:"me-2",size:28}),s.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[s.code,"  ",i?.firstName," ",i?.lastName]})]})]})})})}),a.jsx(de,{children:a.jsx(z,{children:a.jsx(W,{className:"border-0 shadow-sm mb-2",children:a.jsxs(Ft.Container,{activeKey:m,onSelect:f,children:[a.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="subjects"?"600":"400",opacity:m==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(It,{className:"me-2",size:16}),"Subject List"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"assessments",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="assessments"?"600":"400",opacity:m==="assessments"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Dt,{className:"me-2",size:16}),"All Assessment Events"]})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsxs(Ft.Content,{children:[a.jsx(Ft.Pane,{eventKey:"subjects",children:a.jsx(Noe,{traineeId:e,courseId:t})}),a.jsx(Ft.Pane,{eventKey:"assessments",children:a.jsx(Soe,{traineeId:e,courseId:t})})]})})]})})})})]})},Toe=()=>{const{traineeId:e,courseId:t}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Eoe,{traineeId:e,courseId:t})})},Coe=({traineeId:e,courseId:t})=>{const r=it(),[s,n]=v.useState([]),[i,o]=v.useState(!0);v.useEffect(()=>{e&&l()},[e,t]);const l=async()=>{try{o(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(m){console.error("Error loading upcoming assessments:",m),ne.error("Failed to load upcoming assessments")}finally{o(!1)}},c=m=>{const h={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[m]||{variant:"secondary",text:m};return a.jsx(Ae,{bg:h.variant,children:h.text})},u=m=>{const h={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[m?.toUpperCase()]||{variant:"secondary",text:m};return a.jsx(Ae,{bg:h.variant,children:h.text})},d=async m=>{try{r(`/trainee/${e}/assessment/${m}?action=start`)}catch(f){console.error("Error starting assessment:",f),ne.error("Failed to start assessment")}};return i?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Ot,{animation:"border",variant:"primary",size:"sm"}),a.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):s.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(nr,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:s.map((m,f)=>a.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:m.name})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:m.subject})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:u(m.type)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(m.priority)}),a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-1",size:14}),a.jsx("span",{className:"text-dark",children:new Date(m.dueDate).toLocaleDateString()})]}),a.jsx("small",{className:"text-muted",children:new Date(m.dueDate).toLocaleTimeString()})]}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsxs(ie,{variant:"primary",size:"sm",onClick:()=>d(m.id),children:[a.jsx(Dt,{className:"me-1",size:14}),"Start"]})})]},m.id))})]})})},lr=({title:e,sortKey:t,sortConfig:r,onSort:s})=>{const n=()=>{s(t)},i=()=>r.key===t?r.direction==="asc"?a.jsx(m2,{size:12,className:"ms-1"}):a.jsx(Ka,{size:12,className:"ms-1"}):a.jsx(rr,{size:12,className:"ms-1"});return a.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[a.jsx("span",{className:"me-1",children:e}),i()]})},Aoe=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Aoe,document.head.appendChild(e)}const Y_=({traineeId:e,courseId:t,subjectId:r})=>{const s=it(),[n,i]=v.useState([]),[o,l]=v.useState(!0),{sortedData:c,sortConfig:u,handleSort:d}=Zt(n);v.useEffect(()=>{m()},[e,t,r]);const m=async()=>{try{l(!0);let g=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(g=g.filter(b=>b.course?.code==="SAF001")),r&&(g=g.filter(b=>b.subject?.code==="BSP")),await new Promise(b=>setTimeout(b,300)),i(g)}catch(p){console.error("Error loading completed assessments:",p),ne.error("Failed to load completed assessments")}finally{l(!1)}},f=p=>{const b={COMPLETED:{variant:"success",text:"Completed",icon:ht},PASSED:{variant:"success",text:"Passed",icon:ht},FAILED:{variant:"danger",text:"Failed",icon:fr}}[p]||{variant:"secondary",text:p,icon:ht},y=b.icon;return a.jsxs(Ae,{bg:b.variant,className:"d-flex align-items-center",children:[a.jsx(y,{size:12,className:"me-1"}),b.text]})},h=(p,g)=>{const b=p/g*100;let y="success";return b<60?y="danger":b<80&&(y="warning"),a.jsxs(Ae,{bg:y,children:[p,"/",g," (",b.toFixed(0),"%)"]})},x=p=>{s(`/trainee/${e}/assessment/${p.id}`)};return o?a.jsx("div",{className:"text-center py-4",children:a.jsx(Rt,{count:5})}):n.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ht,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Assessment",sortKey:"name",sortConfig:u,onSort:d})}),!r&&a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Subject",sortKey:"subject",sortConfig:u,onSort:d})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Type",sortKey:"type",sortConfig:u,onSort:d})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Score",sortKey:"score",sortConfig:u,onSort:d})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Completed Date",sortKey:"completedDate",sortConfig:u,onSort:d})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(lr,{title:"Status",sortKey:"status",sortConfig:u,onSort:d})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:c.map((p,g)=>a.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:p.name}),a.jsx("small",{className:"text-muted",children:p.description})]}),!r&&a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:p.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:p.subject?.code||""})]}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Ae,{bg:"primary",className:"fw-normal",children:p.type||"Assessment"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:h(p.score,p.maxScore)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:p.completedDate?new Date(p.completedDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:f(p.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Results",icon:a.jsx(ht,{}),onClick:()=>x(p)}]})})]},p.id))})]})})},koe=({traineeId:e,courseId:t,subjectId:r})=>{const s=it(),[n,i]=v.useState(null),[o,l]=v.useState(null),[c,u]=v.useState(!0),[d,m]=v.useState("");v.useEffect(()=>{e&&t&&r&&f()},[e,t,r]);const f=async()=>{try{u(!0),m("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},b={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),l(b)}catch(g){console.error("Error loading subject details:",g),m("Failed to load subject details"),ne.error("Failed to load subject details")}finally{u(!1)}},h=()=>{s(`/trainee/${e}/course/${t}`)},x=g=>{const y={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return a.jsx(Ae,{bg:y.variant,className:"fs-6",children:y.text})},p=g=>{const y={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return a.jsx(Ae,{bg:y.variant,children:y.text})};return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):d||!n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:d||"Subject not found"}),a.jsxs(ie,{variant:"outline-danger",onClick:h,children:[a.jsx(_t,{className:"me-2",size:16}),"Back to Course"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",onClick:h,className:"me-3",children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(It,{className:"me-2",size:28}),n.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",o?.firstName," ",o?.lastName]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[x(n.status),p(n.level)]})]})})}),a.jsxs(de,{children:[a.jsxs(z,{lg:8,className:"mb-4",children:[a.jsx(de,{children:a.jsx(z,{className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx(Coe,{traineeId:e,courseId:t,subjectId:r})})]})})}),a.jsx(de,{children:a.jsx(z,{children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(ht,{className:"me-2",size:20}),"Completed Assessments"]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx(Y_,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),a.jsx(z,{lg:4,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(It,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Start Date"}),a.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"End Date"}),a.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Duration"}),a.jsxs("div",{className:"text-muted",children:[n.duration," hours"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bo,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Room"}),a.jsx("div",{className:"text-muted",children:n.roomName})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Trainer"}),a.jsx("div",{className:"text-muted",children:n.trainer?.name})]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("span",{className:"fw-semibold",children:"Progress"}),a.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),a.jsx("div",{className:"progress",children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("h6",{children:"Description"}),a.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},_oe=()=>{const{traineeId:e,courseId:t,subjectId:r}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(koe,{traineeId:e,courseId:t,subjectId:r})})},Ioe=({traineeId:e})=>{const t=it(),[r,s]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!0),[f,h]=v.useState("");v.useEffect(()=>{e&&x()},[e]);const x=async()=>{try{m(!0),h("");const w=await Fl.getTraineeById(e);s(w);const N=await Fl.getTraineeAssessments(e);i(N.assessments||N.data||[]);const C=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],T=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];l(C),u(T)}catch(w){console.error("Error loading assessment data:",w),h("Failed to load assessment data"),ne.error("Failed to load assessment data")}finally{m(!1)}},p=()=>{t("/trainee/your-assessments")},g=w=>{const C={PENDING:{variant:"warning",text:"Pending",icon:ft},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Dt},COMPLETED:{variant:"success",text:"Completed",icon:ht},OVERDUE:{variant:"danger",text:"Overdue",icon:fr}}[w]||{variant:"secondary",text:w,icon:Dt},T=C.icon;return a.jsxs(Ae,{bg:C.variant,className:"d-flex align-items-center",children:[a.jsx(T,{size:12,className:"me-1"}),C.text]})},b=w=>{const C={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[w]||{variant:"secondary",text:w};return a.jsx(Ae,{bg:C.variant,children:C.text})},y=w=>{t(`/trainee/${e}/assessment/${w}`)},j=w=>{t(`/trainee/${e}/assessment/${w}`)},S=w=>{t(`/trainee/${e}/signature-pad/${w}`)},E=w=>{t(`/trainee/${e}/assessment-section/${w}`)};return d?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):f||!r?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:f||"Trainee not found"}),a.jsxs(ie,{variant:"outline-danger",onClick:p,children:[a.jsx(_t,{className:"me-2",size:16}),"Back to Trainee"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",onClick:p,className:"me-3",children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2",size:28}),"Assessment Management"]}),a.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),a.jsx(de,{children:a.jsx(z,{children:a.jsx(W,{className:"border-0 shadow-sm",children:a.jsx(W.Body,{className:"p-0",children:a.jsxs(xx,{defaultActiveKey:"pending",className:"border-bottom",children:[a.jsx(Ft,{eventKey:"pending",title:"Pending Assessments",children:a.jsx("div",{className:"p-4",children:n.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Dt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Assessment"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Type"}),a.jsx("th",{className:"text-start",children:"Priority"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(w=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:w.name}),a.jsx("small",{className:"text-muted",children:w.description})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:w.course?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:w.course?.code||""})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:w.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:w.subject?.code||""})]}),a.jsx("td",{children:a.jsx(Ae,{bg:"info",className:"fw-normal",children:w.type||"Assessment"})}),a.jsx("td",{children:b(w.priority)}),a.jsx("td",{children:w.dueDate?new Date(w.dueDate).toLocaleDateString():"N/A"}),a.jsx("td",{children:g(w.status)}),a.jsx("td",{children:a.jsx("div",{className:"d-flex gap-1",children:w.status==="PENDING"||w.status==="IN_PROGRESS"?a.jsx(ie,{variant:"primary",size:"sm",onClick:()=>y(w.id),children:"Start"}):a.jsx(ie,{variant:"outline-primary",size:"sm",onClick:()=>j(w.id),children:"View"})})})]},w.id))})]})})})}),a.jsx(Ft,{eventKey:"signature",title:"Signature Required",children:a.jsx("div",{className:"p-4",children:o.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(fn,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Document"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(w=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.subject})}),a.jsx("td",{children:new Date(w.dueDate).toLocaleDateString()}),a.jsx("td",{children:g(w.status)}),a.jsx("td",{children:a.jsxs(ie,{variant:"primary",size:"sm",onClick:()=>S(w.id),children:[a.jsx(fn,{className:"me-1",size:14}),"Sign"]})})]},w.id))})]})})})}),a.jsx(Ft,{eventKey:"completion",title:"Section Completion",children:a.jsx("div",{className:"p-4",children:c.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ht,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Section"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Type"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Progress"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:c.map(w=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:w.subject})}),a.jsx("td",{children:a.jsx(Ae,{bg:"info",className:"fw-normal",children:w.section})}),a.jsx("td",{children:new Date(w.dueDate).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),a.jsx("td",{children:g(w.status)}),a.jsx("td",{children:a.jsx(ie,{variant:"primary",size:"sm",onClick:()=>E(w.id),children:w.status==="COMPLETED"?"View":"Complete"})})]},w.id))})]})})})})]})})})})})]})},Poe=()=>{const{traineeId:e}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Ioe,{traineeId:e})})},Doe=()=>{const{traineeId:e,assessmentId:t}=Nr(),r=it(),[s,n]=vx(),[i,o]=v.useState(null),[l,c]=v.useState(!0),[u,d]=v.useState("");v.useEffect(()=>{t&&m()},[t]),v.useEffect(()=>{if(i&&s.get("action")==="start"){n({});const S=i.sections?.find(E=>E.status!=="COMPLETED");S&&r(`/trainee/${e}/assessment-section/${S.id}`)}},[i,s,r,e,n]);const m=async()=>{try{c(!0),d(""),o({id:t,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(S){console.error("Error loading assessment details:",S),d("Failed to load assessment details"),ne.error("Failed to load assessment details")}finally{c(!1)}},f=()=>{r(-1)},h=()=>{const S=i.sections.find(E=>E.status!=="COMPLETED");S?r(`/trainee/${e}/assessment-section/${S.id}`):ne.info("Starting assessment...")},x=()=>{const S=i.sections.find(E=>E.status==="IN_PROGRESS");S?r(`/trainee/${e}/assessment-section/${S.id}`):h()},p=S=>{r(`/trainee/${e}/assessment-section/${S}`)},g=()=>{r(`/trainee/${e}/signature-pad/${t}`)},b=()=>{r("/trainee/create-incident-feedback-report",{state:{assessmentId:t,assessmentName:i.name}})},y=S=>{const w={PENDING:{variant:"warning",text:"Pending",icon:ft},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Dt},COMPLETED:{variant:"success",text:"Completed",icon:ht},OVERDUE:{variant:"danger",text:"Overdue",icon:fr}}[S]||{variant:"secondary",text:S,icon:Dt},N=w.icon;return a.jsxs(Ae,{bg:w.variant,className:"d-flex align-items-center",children:[a.jsx(N,{size:12,className:"me-1"}),w.text]})},j=S=>{const w={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[S]||{variant:"secondary",text:S};return a.jsx(Ae,{bg:w.variant,children:w.text})};return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):u||!i?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:u||"Assessment not found"}),a.jsxs(ie,{variant:"outline-danger",onClick:f,children:[a.jsx(_t,{className:"me-2",size:16}),"Back"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",onClick:f,className:"me-3",children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2",size:28}),i.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[y(i.status),j(i.priority)]})]})})}),a.jsxs(de,{children:[a.jsx(z,{lg:8,className:"mb-4",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsx(W.Body,{className:"p-0",children:a.jsxs(xx,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[a.jsx(Ft,{eventKey:"overview",title:"Overview",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Description"}),a.jsx("p",{className:"text-muted",children:i.description})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Instructions"}),a.jsx("ul",{className:"list-unstyled",children:i.instructions.map((S,E)=>a.jsxs("li",{className:"mb-2",children:[a.jsx("span",{className:"text-primary me-2",children:""}),S]},E))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Assessment Sections"}),a.jsx("div",{className:"row",children:i.sections.map((S,E)=>a.jsx("div",{className:"col-md-6 mb-3",children:a.jsx(W,{className:`${S.status==="COMPLETED"?"bg-light":""}`,children:a.jsxs(W.Body,{children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1]}),y(S.status)]}),a.jsx("h6",{className:"mb-2",children:S.name}),a.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})}),a.jsx(ie,{variant:S.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>p(S.id),children:S.status==="COMPLETED"?"View":S.status==="IN_PROGRESS"?"Continue":"Start"})]})})},S.id))})]}),a.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?a.jsxs(ie,{variant:"primary",size:"lg",onClick:h,children:[a.jsx(Dt,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?a.jsxs(ie,{variant:"primary",size:"lg",onClick:x,children:[a.jsx(Dt,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&a.jsxs(ie,{variant:"outline-primary",size:"lg",onClick:g,children:[a.jsx(fn,{className:"me-2",size:20}),"Sign Document"]})]})]})}),a.jsx(Ft,{eventKey:"progress",title:"Progress",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Overall Progress"}),a.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:a.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),a.jsxs("small",{className:"text-muted",children:[i.sections.filter(S=>S.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),a.jsx("h5",{children:"Section Progress"}),i.sections.map((S,E)=>a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1,": ",S.name]}),a.jsxs("span",{className:"text-muted",children:[S.progress,"%"]})]}),a.jsx("div",{className:"progress",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})})]},S.id))]})}),i.status==="COMPLETED"&&a.jsx(Ft,{eventKey:"results",title:"Results",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Assessment Score"}),i.score!==null?a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),a.jsx("div",{children:a.jsxs(Ae,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):a.jsx("p",{className:"text-muted",children:"Score pending review"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Section Results"}),i.sections?.map((S,E)=>a.jsx(W,{className:"mb-2",children:a.jsx(W.Body,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1,": ",S.name]}),a.jsx(Ae,{bg:"success",className:"ms-2",children:"Completed"})]}),S.score!==void 0&&a.jsxs("div",{className:"text-end",children:[a.jsxs("div",{className:"fw-bold",children:[S.score," / ",S.maxScore||100]}),a.jsxs("small",{className:"text-muted",children:[Math.round(S.score/(S.maxScore||100)*100),"%"]})]})]})})},S.id))]})]})})]})})})}),a.jsx(z,{lg:4,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:20}),"Assessment Information"]})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Course"}),a.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Subject"}),a.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Due Date"}),a.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Time Limit"}),a.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ht,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Score"}),a.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Completed Date"}),a.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&a.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Signature Required"}),a.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:g,children:[a.jsx(fn,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&a.jsx(Ae,{bg:"success",children:"Signed"})]}),a.jsx("div",{className:"mt-4",children:a.jsxs(ie,{variant:"outline-secondary",className:"w-100",onClick:b,children:[a.jsx(fr,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},Ooe=({show:e,onClose:t,onSave:r,documentName:s,loading:n=!1})=>{const i=v.useRef(null),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState("");v.useEffect(()=>{e&&(u(!1),m(""),f())},[e]);const f=()=>{const y=i.current;y&&(y.getContext("2d").clearRect(0,0,y.width,y.height),u(!1))},h=y=>{l(!0);const j=i.current,S=j.getBoundingClientRect(),E=j.getContext("2d");E.beginPath(),E.moveTo(y.clientX-S.left,y.clientY-S.top)},x=y=>{if(!o)return;const j=i.current,S=j.getBoundingClientRect(),E=j.getContext("2d");E.lineTo(y.clientX-S.left,y.clientY-S.top),E.stroke(),u(!0)},p=()=>{l(!1)},g=async()=>{if(!c){m("Please provide your signature before saving");return}try{const j=i.current.toDataURL("image/png");await r({documentName:s,signature:j,timestamp:new Date().toISOString()}),t()}catch{m("Failed to save signature. Please try again.")}},b=()=>{f(),m(""),t()};return a.jsxs(ce,{show:e,onHide:b,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(fn,{className:"me-2",size:20}),"Digital Signature"]}),a.jsx(ie,{variant:"link",onClick:b,className:"text-white p-0",children:a.jsx(nt,{size:24})})]}),a.jsxs(ce.Body,{className:"p-4",children:[d&&a.jsx(Re,{variant:"danger",className:"mb-3",children:d}),a.jsxs("div",{className:"text-center mb-4",children:[a.jsxs("h5",{children:["Sign Document: ",s]}),a.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),a.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:a.jsx("canvas",{ref:i,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:h,onMouseMove:x,onMouseUp:p,onMouseLeave:p,onTouchStart:y=>{y.preventDefault();const j=y.touches[0],S=new MouseEvent("mousedown",{clientX:j.clientX,clientY:j.clientY});h(S)},onTouchMove:y=>{y.preventDefault();const j=y.touches[0],S=new MouseEvent("mousemove",{clientX:j.clientX,clientY:j.clientY});x(S)},onTouchEnd:y=>{y.preventDefault(),p()}})}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(i2,{className:"me-2",size:16}),"Clear"]}),a.jsx("div",{className:"text-muted small",children:c?a.jsx("span",{className:"text-success",children:" Signature captured"}):a.jsx("span",{children:"Please sign above"})})]}),a.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),a.jsxs("ul",{className:"mb-0 small text-muted",children:[a.jsx("li",{children:"Sign within the designated area"}),a.jsx("li",{children:"Use your full legal signature"}),a.jsx("li",{children:"Ensure the signature is clear and readable"}),a.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-4",children:[a.jsxs(ie,{variant:"outline-secondary",onClick:b,disabled:n,children:[a.jsx(nt,{className:"me-2",size:16}),"Cancel"]}),a.jsx(ie,{variant:"primary",onClick:g,disabled:n||!c,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Roe=()=>{const{traineeId:e,documentId:t}=Nr(),r=it(),s=async i=>{try{console.log("Signature saved:",i),ne.success("Signature saved successfully"),r(`/trainee/${e}/assessment/${t}`,{replace:!0})}catch(o){console.error("Error saving signature:",o),ne.error("Failed to save signature")}},n=()=>{r(`/trainee/${e}/assessment/${t}`,{replace:!0})};return a.jsx(_e,{className:"py-3",children:a.jsx(Ooe,{show:!0,documentName:`Document ${t}`,onClose:n,onSave:s})})},Foe=({traineeId:e,sectionId:t})=>{const r=it(),[s,n]=v.useState(null),[i,o]=v.useState(!0),[l,c]=v.useState("");v.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{o(!0),c(""),n({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(x){console.error("Error loading section details:",x),c("Failed to load assessment section details"),ne.error("Failed to load assessment section details")}finally{o(!1)}},d=()=>{r("/trainee/your-assessments")},m=x=>{const g={PENDING:{variant:"warning",text:"Pending",icon:ft},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Dt},COMPLETED:{variant:"success",text:"Completed",icon:ht},OVERDUE:{variant:"danger",text:"Overdue",icon:fr}}[x]||{variant:"secondary",text:x,icon:Dt},b=g.icon;return a.jsxs(Ae,{bg:g.variant,className:"d-flex align-items-center",children:[a.jsx(b,{size:12,className:"me-1"}),g.text]})},f=()=>{ne.info("Starting assessment section...")},h=()=>{ne.info("Continuing assessment section...")};return i?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):l||!s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:l||"Assessment section not found"}),a.jsxs(ie,{variant:"outline-danger",onClick:d,children:[a.jsx(_t,{className:"me-2",size:16}),"Back to Assessments"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",onClick:d,className:"me-3",children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2",size:28}),s.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[s.course,"  ",s.subject]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(s.status),a.jsx(Ae,{bg:"info",className:"fw-normal",children:s.type})]})]})})}),a.jsxs(de,{children:[a.jsx(z,{lg:8,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2",size:20}),"Assessment Section Details"]})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Description"}),a.jsx("p",{className:"text-muted",children:s.description})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Instructions"}),a.jsx("ul",{className:"list-unstyled",children:s.instructions.map((x,p)=>a.jsxs("li",{className:"mb-2",children:[a.jsx("span",{className:"text-primary me-2",children:""}),x]},p))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Questions Overview"}),a.jsx("div",{className:"row",children:s.questions.map((x,p)=>a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs("div",{className:`p-3 border rounded ${x.isAnswered||x.isCompleted?"bg-light":""}`,children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Question ",p+1]}),x.isAnswered||x.isCompleted?a.jsx(Ae,{bg:"success",className:"small",children:"Completed"}):a.jsx(Ae,{bg:"warning",className:"small",children:"Pending"})]}),a.jsx("p",{className:"mb-0 small text-muted",children:x.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},x.id))})]}),a.jsx("div",{className:"d-flex justify-content-center",children:s.status==="PENDING"?a.jsxs(ie,{variant:"primary",size:"lg",onClick:f,children:[a.jsx(Nx,{className:"me-2",size:20}),"Start Assessment"]}):a.jsxs(ie,{variant:"primary",size:"lg",onClick:h,children:[a.jsx(Dt,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),a.jsx(z,{lg:4,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(ft,{className:"me-2",size:20}),"Assessment Information"]})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Time Limit"}),a.jsxs("div",{className:"text-muted",children:[s.timeLimit," minutes"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Due Date"}),a.jsx("div",{className:"text-muted",children:new Date(s.dueDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Dt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Total Questions"}),a.jsx("div",{className:"text-muted",children:s.questions.length})]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("span",{className:"fw-semibold",children:"Progress"}),a.jsxs("span",{className:"text-muted",children:[s.progress,"%"]})]}),a.jsx(Ph,{now:s.progress,variant:"primary",className:"mb-3"}),a.jsx("div",{className:"text-center",children:a.jsxs("small",{className:"text-muted",children:[s.questions.filter(x=>x.isAnswered||x.isCompleted).length," of ",s.questions.length," questions completed"]})})]}),a.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),a.jsxs("ul",{className:"mb-0 small text-muted",children:[a.jsx("li",{children:"Read questions carefully"}),a.jsx("li",{children:"Manage your time wisely"}),a.jsx("li",{children:"Save progress regularly"}),a.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},Loe=()=>{const{traineeId:e,sectionId:t}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Foe,{traineeId:e,sectionId:t})})},Moe=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
  .quick-actions-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .quick-actions-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Moe,document.head.appendChild(e)}const YN=()=>{const e=it(),t=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Lt,path:"/trainee/academic-details",color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:It,path:"/trainee/enrolled-courses",color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:Dt,path:"/trainee/your-assessments",color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:fr,path:"/trainee/create-incident-feedback-report",color:"danger"}];return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0 shadow-sm quick-actions-card",children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),a.jsx(W.Body,{children:a.jsx(de,{children:t.map((r,s)=>{const n=r.icon;return a.jsx(z,{lg:6,xl:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(W.Body,{className:"p-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:a.jsx(n,{size:24})}),a.jsx("div",{className:"flex-grow-1",children:a.jsx("h5",{className:"mb-1",children:r.title})}),a.jsx(mn,{size:20,className:"text-muted"})]}),a.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},s)})})})]})})}),a.jsxs(de,{className:"mt-4",children:[a.jsx(z,{lg:6,className:"d-flex",children:a.jsxs(W,{className:"border-0 shadow-sm w-100 training-progress-card",children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Training Progress"})}),a.jsx(W.Body,{className:"d-flex flex-column justify-content-center",children:a.jsxs("div",{className:"text-center py-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),a.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),a.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),a.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),a.jsx(z,{lg:6,className:"d-flex",children:a.jsxs(W,{className:"border-0 shadow-sm w-100 assessments-card",children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),a.jsx(W.Body,{className:"d-flex flex-column justify-content-center",children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Dt,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No assessments pending"}),a.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/signature-required"),className:"d-flex align-items-center justify-content-center mx-auto",children:[a.jsx(Dt,{size:16,className:"me-2"}),"Go to Assessments",a.jsx(mn,{size:16,className:"ms-2"})]})]})})]})})]})]})},Boe=()=>{const e=it(),{user:t}=fs(),[r,s]=v.useState(!0),[n,i]=v.useState(null);v.useEffect(()=>{o()},[]);const o=async()=>{try{s(!0);const u={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(d=>setTimeout(d,500)),i(u)}catch(u){console.error("Error loading academic data:",u)}finally{s(!1)}},l=u=>{switch(u){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=u=>{switch(u){case"completed":return a.jsx(ht,{className:"text-success"});case"in-progress":return a.jsx(ft,{className:"text-warning"});case"pending":return a.jsx(ft,{className:"text-muted"});default:return a.jsx(ft,{className:"text-muted"})}};return r?a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?a.jsxs(_e,{className:"py-4 academic-details",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:a.jsx(_t,{size:16})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Academic Details"}),a.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{lg:3,md:6,className:"mb-3",children:a.jsx(W,{className:"border-0 shadow-sm h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(It,{size:32,className:"text-primary mb-2"}),a.jsx("h4",{className:"mb-1",children:n.totalCourses}),a.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),a.jsx(z,{lg:3,md:6,className:"mb-3",children:a.jsx(W,{className:"border-0 shadow-sm h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(_2,{size:32,className:"text-success mb-2"}),a.jsx("h4",{className:"mb-1",children:n.completedCourses}),a.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),a.jsx(z,{lg:3,md:6,className:"mb-3",children:a.jsx(W,{className:"border-0 shadow-sm h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(ft,{size:32,className:"text-warning mb-2"}),a.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),a.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),a.jsx(z,{lg:3,md:6,className:"mb-3",children:a.jsx(W,{className:"border-0 shadow-sm h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(Dt,{size:32,className:"text-info mb-2"}),a.jsx("h4",{className:"mb-1",children:n.completedAssessments}),a.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),a.jsx(de,{className:"mb-5",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"text-center mb-3",children:[a.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),a.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),a.jsx(Ph,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),a.jsx(de,{className:"text-center",children:a.jsx(z,{children:a.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),a.jsxs(de,{className:"mt-4",children:[a.jsx(z,{lg:8,className:"mb-4 pe-3",children:a.jsxs(W,{className:"border-0 shadow-sm h-100",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(It,{className:"me-2"}),"Course Progress"]})}),a.jsx(W.Body,{children:n.courses.map(u=>a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1",children:u.name}),a.jsx("small",{className:"text-muted",children:u.code})]}),a.jsx("div",{className:"d-flex align-items-center",children:a.jsx(Ae,{variant:l(u.status),children:u.status.replace("-"," ")})})]}),a.jsx(Ph,{now:u.progress,variant:u.progress===100?"success":"primary",style:{height:"8px"}}),a.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[a.jsxs("small",{className:"text-muted",children:[u.progress,"% complete"]}),u.status==="completed"&&a.jsxs("small",{className:"text-success",children:["Completed: ",new Date(u.completedDate).toLocaleDateString()]})]})]},u.id))})]})}),a.jsx(z,{lg:4,className:"mb-4 ps-3",children:a.jsxs(W,{className:"border-0 shadow-sm h-100",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(Dt,{className:"me-2"}),"Recent Assessments"]})}),a.jsx(W.Body,{children:n.recentAssessments.map(u=>a.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[a.jsx("h6",{className:"mb-1",children:u.name}),c(u.status)]}),a.jsx("small",{className:"text-muted d-block mb-1",children:u.course}),u.status==="completed"?a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsxs(Ae,{variant:"success",children:["Score: ",u.score]}),a.jsx("small",{className:"text-muted",children:new Date(u.completedDate).toLocaleDateString()})]}):a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsx(Ae,{variant:"warning",children:"Pending"}),a.jsxs("small",{className:"text-muted",children:["Due: ",new Date(u.dueDate).toLocaleDateString()]})]})]},u.id))})]})})]})]}):a.jsx(_e,{className:"py-4",children:a.jsx(Re,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},zoe=()=>{const{user:e}=fs();return e?a.jsx(_e,{className:"py-3",children:a.jsx(Boe,{})}):a.jsx(_e,{className:"py-3",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{children:"Please log in to view your academic details."})})})},XN=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:s,onLevelToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown course-filter-dropdown ${l}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>a.jsx(A.Check,{type:"checkbox",id:`level-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),s.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>a.jsx(A.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:s.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},X_=document.createElement("style");X_.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(X_);const $oe=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=$oe,document.head.appendChild(e)}const Uoe=({traineeId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(""),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState("upcoming"),x=[...new Set(r.map(D=>D.level).filter(Boolean))],p=[...new Set(r.map(D=>D.status).filter(Boolean))],g=D=>r.filter(M=>{switch(D){case"upcoming":return M.status==="PLANNED";case"ongoing":return M.status==="ON-GOING";case"completed":return M.status==="COMPLETED";default:return!0}}),b=g(f),y=v.useMemo(()=>b.filter(D=>{const M=!o||D.name.toLowerCase().includes(o.toLowerCase())||D.code.toLowerCase().includes(o.toLowerCase())||D.description.toLowerCase().includes(o.toLowerCase()),q=c.length===0||c.includes(D.level),Z=d.length===0||d.includes(D.status);return M&&q&&Z}),[b,o,c,d]),{sortedData:j,sortConfig:S,handleSort:E}=Zt(y);v.useEffect(()=>{e&&w()},[e]);const w=async()=>{try{i(!0);const D=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ON-GOING",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}},{id:"5",code:"NAV005",name:"Navigation Systems",description:"Advanced navigation and GPS systems",level:"ADVANCED",status:"COMPLETED",startDate:"2023-09-01T09:00:00.000Z",endDate:"2023-10-15T17:00:00.000Z",progress:100,department:{id:5,name:"Navigation Department",code:"NAV"}},{id:"6",code:"COMM006",name:"Communication Protocols",description:"Radio communication and protocols",level:"BEGINNER",status:"PLANNED",startDate:"2024-04-01T09:00:00.000Z",endDate:"2024-06-01T17:00:00.000Z",progress:0,department:{id:6,name:"Communication Department",code:"COMM"}},{id:"7",code:"MAINT007",name:"Aircraft Maintenance",description:"Routine maintenance procedures",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-01-20T08:00:00.000Z",endDate:"2024-03-20T16:00:00.000Z",progress:60,department:{id:7,name:"Maintenance Department",code:"MAINT"}},{id:"8",code:"ARCH008",name:"Archived Course",description:"This course has been archived",level:"BEGINNER",status:"ARCHIVED",startDate:"2023-06-01T09:00:00.000Z",endDate:"2023-08-01T17:00:00.000Z",progress:100,department:{id:8,name:"Archived Department",code:"ARCH"}}];await new Promise(M=>setTimeout(M,300)),s(D)}catch(D){console.error("Error loading trainee courses:",D),ne.error("Failed to load enrolled courses")}finally{i(!1)}},N=D=>{const q={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[D]||{variant:"secondary",text:D};return a.jsx(Ae,{bg:q.variant,children:q.text})},C=D=>{const q={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[D]||{variant:"secondary",text:D};return a.jsx(Ae,{bg:q.variant,children:q.text})},T=D=>{t(`/trainee/${e}/course/${D.id}`)},_=D=>{u(D==="clear"?[]:M=>M.includes(D)?M.filter(q=>q!==D):[...M,D])},k=D=>{m(D==="clear"?[]:M=>M.includes(D)?M.filter(q=>q!==D):[...M,D])},I=()=>{u([]),m([]),l("")},L=({columnKey:D,children:M,className:q=""})=>{const Z=S.key===D,Q=Z?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${q}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(D),onMouseEnter:U=>{U.target.style.backgroundColor="#214760",U.target.style.transform="translateY(-1px)",U.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:U=>{U.target.style.backgroundColor="var(--bs-primary)",U.target.style.transform="translateY(0)",U.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:Z?"600":"500",color:"white"},children:M}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:Q,size:14,color:"white"})})]}),Z&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return n?a.jsx(Rt,{rows:5,columns:8}):r.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No enrolled courses"}),a.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):y.length===0&&(o||c.length>0||d.length>0)?a.jsx("div",{children:a.jsx(W,{className:"border-0 shadow-sm mb-2",children:a.jsxs(Ft.Container,{activeKey:f,onSelect:h,children:[a.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(ft,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(z0,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(ht,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx(Ft.Content,{children:a.jsxs(Ft.Pane,{eventKey:f,children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(XN,{uniqueLevels:x,uniqueStatuses:p,selectedLevels:c,selectedStatuses:d,onLevelToggle:_,onStatusToggle:k,onClearFilters:I,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[y.length," course",y.length!==1?"s":""]})})})]}),a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No courses found"}),a.jsx("p",{children:"Try adjusting your search criteria or filters."}),a.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:I,children:"Clear Filters"})]})})]})})})]})})}):a.jsx("div",{children:a.jsx(W,{className:"border-0 shadow-sm mb-2",children:a.jsxs(Ft.Container,{activeKey:f,onSelect:h,children:[a.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(vt,{variant:"tabs",className:"border-0",children:[a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(ft,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(z0,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),a.jsx(vt.Item,{children:a.jsxs(vt.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(ht,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx(Ft.Content,{children:a.jsxs(Ft.Pane,{eventKey:f,children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(XN,{uniqueLevels:x,uniqueStatuses:p,selectedLevels:c,selectedStatuses:d,onLevelToggle:_,onStatusToggle:k,onClearFilters:I,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[y.length," course",y.length!==1?"s":""]})})})]}),a.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(L,{columnKey:"code",className:"show-mobile",children:"Course Code"}),a.jsx(L,{columnKey:"name",className:"show-mobile",children:"Course Name"}),a.jsx(L,{columnKey:"level",className:"show-mobile",children:"Level"}),a.jsx(L,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(L,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),a.jsx(L,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),a.jsx(L,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:j.map((D,M)=>a.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor=M%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Ae,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:D.code})}),a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:D.name}),a.jsx("small",{className:"text-muted",children:D.description})]}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:C(D.level)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:N(D.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:D.startDate?new Date(D.startDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:D.endDate?new Date(D.endDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${D.progress||0}%`}})}),a.jsxs("small",{className:"text-muted",children:[D.progress||0,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.COURSES.VIEW_DETAIL],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Course Details",icon:a.jsx(Et,{}),onClick:()=>T(D),permission:Te.COURSES.VIEW_DETAIL}]})})})]},D.id))})]})})]})})})]})})})},Woe=()=>{const{user:e}=fs();return e?a.jsx(_e,{className:"py-3",children:a.jsx(Uoe,{traineeId:e.id})}):a.jsx(_e,{className:"py-3",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Hoe=({show:e,onHide:t,onImportSuccess:r,onImportError:s})=>{const n=it(),[i,o]=v.useState("with-fields"),[l,c]=v.useState(null),[u,d]=v.useState(!1),[m,f]=v.useState({name:"",description:"",departmentId:""}),[h,x]=v.useState([]),[p,g]=v.useState(!1),b=v.useRef(null);v.useEffect(()=>{e&&y()},[e]);const y=async()=>{try{g(!0);const w=await kt.getDepartments(),N=w.departments||w.data||[];x(N)}catch(w){console.error("Error loading departments:",w),ne.error("Failed to load departments"),x([])}finally{g(!1)}},j=w=>{const N=w.target.files[0];if(N){const C=[".docx"],T=N.name.toLowerCase().substring(N.name.lastIndexOf("."));if(!C.includes(T)){ne.error("Please select a valid Word document file (.docx)");return}if(N.size>10*1024*1024){ne.error("File size must be less than 10MB");return}c(N)}},S=async()=>{if(!l){ne.error("Please select a file to import");return}d(!0);try{const w=wo.getDocsType(l.name),N=await wo.uploadDocument(l,w);let C;if(N.data&&N.data.length>0&&N.data[0].url)C=N.data[0].url,console.log(` Form Template Upload Success! Document URL: ${C}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields"){const T={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:C,fileName:l.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(T)),console.log(" Template info saved to localStorage:",T),n("/admin/forms/editor",{state:{documentUrl:C,fileName:T.fileName,importType:"File with fields",templateInfo:T}}),E(),r("File with fields",l.name)}else{const T={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:C,fileName:l.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(T)),console.log(" Template info saved to localStorage:",T),n("/admin/forms/editor",{state:{documentUrl:C,fileName:T.fileName,importType:"File without fields",templateInfo:T}}),E(),r("File without fields",l.name)}}catch(w){s(w.message||"Import failed")}finally{d(!1)}},E=()=>{c(null),o("with-fields"),f({name:"",description:"",departmentId:""}),b.current&&(b.current.value=""),t()};return a.jsxs(ce,{show:e,onHide:E,size:"lg",centered:!0,className:"import-file-modal",dialogClassName:"import-file-modal-dialog",children:[a.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Ds,{className:"me-2",size:20}),"Import Form File"]})}),a.jsxs(ce.Body,{className:"p-3 p-md-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),a.jsxs(de,{className:"g-3 import-type-row",children:[a.jsx(z,{xs:12,sm:12,md:6,className:"import-type-col",children:a.jsx(W,{className:`import-type-card ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("with-fields"),style:{cursor:"pointer"},children:a.jsx(W.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:a.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[a.jsx(Ou,{size:48,className:"text-primary mb-3"}),a.jsx("h6",{className:"text-primary mb-2",children:"File with Fields"}),a.jsx("p",{className:"text-muted small mb-0",children:"Import a Word document that already contains predefined form fields and structure. The system will automatically parse and create form templates."})]})})})}),a.jsx(z,{xs:12,sm:12,md:6,className:"import-type-col",children:a.jsx(W,{className:`import-type-card ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("without-fields"),style:{cursor:"pointer"},children:a.jsx(W.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:a.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[a.jsx(Ol,{size:48,className:"text-success mb-3"}),a.jsx("h6",{className:"text-success mb-2",children:"File without Fields"}),a.jsx("p",{className:"text-muted small mb-0",children:"Import a raw Word document without predefined structure. You will manually define form fields and mapping after import."})]})})})})]})]}),!i&&a.jsxs(Re,{variant:"info",className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),a.jsx("p",{className:"mb-0 small",children:'Choose between "File with Fields" or "File without Fields" above to continue with the import process.'})]}),(i==="without-fields"||i==="with-fields")&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Template Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:m.name,onChange:w=>f(N=>({...N,name:w.target.value})),required:!0})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Description ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:m.description,onChange:w=>f(N=>({...N,description:w.target.value})),required:!0})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Department ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:m.departmentId,onChange:w=>f(N=>({...N,departmentId:w.target.value})),required:!0,disabled:p,children:[a.jsx("option",{value:"",children:"Select Department"}),h.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]}),p&&a.jsx(A.Text,{className:"text-muted",children:"Loading departments..."}),m.templateContent&&a.jsxs(A.Text,{className:"text-muted",children:["Template Content: ",m.templateContent]})]})})]})})]}),i&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),a.jsxs(A.Group,{children:[a.jsx(A.Control,{ref:b,type:"file",accept:".docx",onChange:j,className:"mb-2"}),a.jsx(A.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),l&&a.jsx(Re,{variant:"info",className:"mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ol,{className:"me-2",size:20}),a.jsxs("div",{children:[a.jsx("strong",{children:"Selected File:"})," ",l.name,a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:["Size: ",(l.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),a.jsxs(ce.Footer,{className:"border-0 p-3 p-md-3 d-flex flex-column flex-md-row gap-2 gap-md-2 justify-content-end",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:E,disabled:u,className:"w-100 w-md-auto order-2 order-md-1",children:[a.jsx(nt,{className:"me-2",size:14}),"Cancel"]}),i==="with-fields"&&a.jsx(ie,{variant:"primary-custom",size:"sm",onClick:S,disabled:!l||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"me-2",size:14}),"Import File"]})}),i==="without-fields"&&a.jsx(ie,{variant:"primary-custom",size:"sm",onClick:S,disabled:!l||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"me-2",size:14}),"Import File"]})})]})]})},Voe=({show:e,onHide:t,template:r})=>{const[s,n]=v.useState("details"),[i,o]=v.useState(null),[l,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(!1),[h,x]=v.useState(null),[p,g]=v.useState(!1);if(v.useEffect(()=>{(async()=>{if(r?.reviewedByUserId&&e)try{c(!0);const _=await os.getUserById(r.reviewedByUserId),k=_.data||_;o(k)}catch(_){console.error("Error fetching reviewed by user:",_),o(null)}finally{c(!1)}else o(null)})()},[r?.reviewedByUserId,e]),v.useEffect(()=>{(async()=>{if(r?.id&&e&&!r.sections)try{f(!0);const _=await Ya.getTemplateById(r.id),k=_.data||_;d(k)}catch(_){console.error("Error fetching full template data:",_),d(null)}finally{f(!1)}else r?.sections?d(r):d(null)})()},[r?.id,e,r?.sections]),v.useEffect(()=>((async()=>{if(s==="content"&&r?.id&&e)try{g(!0);const _=r.formId||r.id,k=await Ya.getTemplatePDF(_),I=URL.createObjectURL(k);x(I)}catch(_){console.error("Error loading PDF:",_),x(null)}finally{g(!1)}else x(_=>(_&&URL.revokeObjectURL(_),null))})(),()=>{x(_=>(_&&URL.revokeObjectURL(_),null))}),[s,r?.id,r?.formId,e]),!r)return null;const b=T=>{if(!T)return"N/A";try{return new Date(T).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return T}},y=T=>{const _={PENDING:{variant:"warning",icon:ft,text:"PENDING"},PUBLISHED:{variant:"success",icon:ht,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:At,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:At,text:"ARCHIVED"}},k=_[T]||_.DRAFT,I=k.icon;return a.jsxs(Ae,{bg:k.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[a.jsx(I,{size:12}),k.text]})},j=()=>{console.log("Create new version for template:",r.id),t()},S=()=>a.jsx("div",{className:"template-details",children:a.jsxs("div",{className:"list-group list-group-flush",children:[a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Template Name"}),a.jsx("span",{className:"text-dark",children:r.name})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Bs,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Department"}),a.jsx("span",{className:"text-dark",children:r.department?.name||"N/A"}),r.department?.code&&a.jsx("small",{className:"text-muted d-block",children:r.department.code})]})]})}),r.description&&a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-start",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Description"}),a.jsx("span",{className:"text-dark",children:r.description})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ht,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Status"}),a.jsx("div",{children:y(r.status)})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Version"}),a.jsxs("span",{className:"text-dark",children:["Version ",r.version]})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Sections"}),a.jsxs("span",{className:"text-dark",children:[r._count?.sections||0," ",r._count?.sections===1?"section":"sections"]})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),a.jsxs("span",{className:"text-dark",children:[r.createdByUser?.firstName||""," ",r.createdByUser?.lastName||""]}),a.jsxs("small",{className:"text-muted d-block",children:[a.jsx(nr,{className:"me-1",size:12}),b(r.createdAt)]})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Last Updated"}),a.jsx("span",{className:"text-dark",children:b(r.updatedAt)})]})]})}),a.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ht,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Reviewed By"}),r.reviewedByUserId?a.jsx(a.Fragment,{children:l?a.jsx("span",{className:"text-muted",children:"Loading..."}):i?a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"text-dark",children:[i.firstName||""," ",i.lastName||""]}),r.reviewedAt&&a.jsxs("small",{className:"text-muted d-block",children:[a.jsx(nr,{className:"me-1",size:12}),b(r.reviewedAt)]})]}):a.jsxs("span",{className:"text-muted",children:["User ID: ",r.reviewedByUserId]})}):a.jsx("span",{className:"text-muted",children:"Not reviewed"})]})]})})]})}),E=()=>{const T=u?.sections||r?.sections||[];return m?a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading sections..."})]}):T.length===0?a.jsx(Re,{variant:"info",className:"mb-0",children:a.jsxs("div",{children:[a.jsx("strong",{children:"No sections found"}),a.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections yet."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"mb-3",children:a.jsxs("h6",{className:"mb-0",children:["Template Sections (",T.length,")"]})}),a.jsx("div",{className:"list-group",children:T.map((_,k)=>a.jsx("div",{className:"list-group-item",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1",children:_.label||_.name}),a.jsxs("small",{className:"text-muted",children:["Edit by: ",_.editBy||"TRAINER"," ",_.fields?.length||0," field(s)"]})]}),a.jsx(Ae,{bg:"secondary",children:_.displayOrder||k+1})]})},_.id||k))})]})},w=()=>{const _=(u?.sections||r?.sections||[]).flatMap(k=>k.fields||[]);return m?a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading fields..."})]}):_.length===0?a.jsx(Re,{variant:"info",className:"mb-0",children:a.jsxs("div",{children:[a.jsx("strong",{children:"No fields found"}),a.jsx("p",{className:"mb-0 text-muted",children:"This template has no fields yet."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"mb-3",children:a.jsxs("h6",{className:"mb-0",children:["Template Fields (",_.length,")"]})}),a.jsx("div",{className:"list-group",children:_.map((k,I)=>a.jsx("div",{className:"list-group-item",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1",children:k.label}),a.jsxs("small",{className:"text-muted",children:[k.fieldName," (",k.fieldType,") ",k.roleRequired||"TRAINER"]})]}),a.jsx(Ae,{bg:"info",children:k.fieldType})]})},k.id||k.fieldName||I))})]})},N=()=>{const T=[];return m?a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading version history..."})]}):T.length===0?a.jsx(Re,{variant:"info",className:"mb-0",children:a.jsxs("div",{children:[a.jsx("strong",{children:"No version history found"}),a.jsx("p",{className:"mb-0 text-muted",children:"This template has no previous versions."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"mb-3",children:a.jsx("h6",{className:"mb-0",children:"Version History"})}),a.jsx("div",{className:"list-group",children:T.map((_,k)=>a.jsx("div",{className:"list-group-item",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("h6",{className:"mb-1",children:["Version ",_.version]}),a.jsxs("small",{className:"text-muted",children:[b(_.createdAt||_.updatedAt),_.createdByUser&&a.jsxs(a.Fragment,{children:["  ",_.createdByUser.firstName," ",_.createdByUser.lastName]})]})]}),a.jsx(Ae,{bg:_.status==="PUBLISHED"?"success":"warning",children:_.status})]})},_.id||k))})]})},C=()=>p?a.jsx("div",{className:"content-preview",children:a.jsx("div",{className:"border rounded p-4 bg-light text-center",style:{minHeight:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsxs("div",{children:[a.jsx(Ot,{animation:"border",variant:"primary",className:"mb-3"}),a.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})})}):h?a.jsx("div",{className:"content-preview",style:{height:"60vh",overflow:"hidden"},children:a.jsx("iframe",{src:h,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block"},title:"Template PDF Preview"})}):a.jsx("div",{className:"content-preview",children:a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsx(Du,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})});return a.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,className:"template-detail-modal",dialogClassName:"template-detail-modal-dialog",contentClassName:"template-detail-modal-content",children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 template-detail-header d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0 template-detail-title flex-grow-1",style:{minWidth:0},children:[a.jsx(At,{className:"me-2 flex-shrink-0",size:20}),a.jsxs("span",{className:"template-detail-title-text text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:`Template Detail: ${r.name}`,children:[a.jsx("span",{className:"d-none d-md-inline",children:"Template Detail: "}),r.name]})]}),a.jsx(ie,{variant:"link",onClick:t,className:"text-white p-0 flex-shrink-0",style:{border:"none",background:"none",opacity:.9,color:"#ffffff !important",marginLeft:"1rem"},children:a.jsx(nt,{size:24,color:"#ffffff"})})]}),a.jsxs(ce.Body,{className:"p-0 template-detail-body",style:{maxHeight:s==="content"?"60vh":"70vh",overflowY:s==="content"?"hidden":"auto"},children:[a.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",children:a.jsxs("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:[a.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${s==="details"?"border-bottom border-white border-3":""}`,onClick:()=>n("details"),style:{fontWeight:s==="details"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[a.jsx(At,{size:16,className:"me-1 me-md-2"}),a.jsx("span",{className:"d-none d-sm-inline",children:"Details"})]}),a.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${s==="sections"?"border-bottom border-white border-3":""}`,onClick:()=>n("sections"),style:{fontWeight:s==="sections"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[a.jsx(yx,{size:16,className:"me-1 me-md-2"}),a.jsx("span",{className:"d-none d-sm-inline",children:"Section List"})]}),a.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${s==="fields"?"border-bottom border-white border-3":""}`,onClick:()=>n("fields"),style:{fontWeight:s==="fields"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[a.jsx(j2,{size:16,className:"me-1 me-md-2"}),a.jsx("span",{className:"d-none d-sm-inline",children:"Field List"})]}),a.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${s==="history"?"border-bottom border-white border-3":""}`,onClick:()=>n("history"),style:{fontWeight:s==="history"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[a.jsx(f2,{size:16,className:"me-1 me-md-2"}),a.jsx("span",{className:"d-none d-lg-inline",children:"List History Version"}),a.jsx("span",{className:"d-inline d-lg-none d-sm-inline",children:"History"})]}),a.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${s==="content"?"border-bottom border-white border-3":""}`,onClick:()=>n("content"),style:{fontWeight:s==="content"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[a.jsx(Et,{size:16,className:"me-1 me-md-2"}),a.jsx("span",{className:"d-none d-sm-inline",children:"Content Preview"})]})]})}),a.jsxs("div",{className:"p-3 p-md-4 template-detail-content",children:[s==="details"&&S(),s==="sections"&&E(),s==="fields"&&w(),s==="history"&&N(),s==="content"&&C()]})]}),a.jsxs(ce.Footer,{className:"bg-light border-0 template-detail-footer d-flex flex-wrap gap-2",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)",justifyContent:"flex-end"},children:[a.jsx(ie,{variant:"secondary",onClick:t,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#3a5a6f",T.currentTarget.style.borderColor="#3a5a6f",T.currentTarget.style.color="#ffffff"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-secondary)",T.currentTarget.style.borderColor="var(--bs-secondary)",T.currentTarget.style.color="#ffffff"},children:"Close"}),a.jsxs(ie,{variant:"primary",onClick:j,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#153a4a",T.currentTarget.style.borderColor="#153a4a",T.currentTarget.style.transform="translateY(-1px)",T.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-primary)",T.currentTarget.style.borderColor="var(--bs-primary)",T.currentTarget.style.transform="translateY(0)",T.currentTarget.style.boxShadow="none"},children:[a.jsx(x2,{className:"me-2",size:16}),a.jsx("span",{className:"d-none d-sm-inline",children:"Update New Version"}),a.jsx("span",{className:"d-inline d-sm-none",children:"New Version"})]}),r.templateConfig&&a.jsxs(ie,{variant:"primary",href:r.templateConfig,target:"_blank",rel:"noopener noreferrer",className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease",textDecoration:"none"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#153a4a",T.currentTarget.style.borderColor="#153a4a",T.currentTarget.style.transform="translateY(-1px)",T.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-primary)",T.currentTarget.style.borderColor="var(--bs-primary)",T.currentTarget.style.transform="translateY(0)",T.currentTarget.style.boxShadow="none"},children:[a.jsx($i,{className:"me-2",size:16}),a.jsx("span",{className:"d-none d-sm-inline",children:"Download File"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Download"})]})]})]})},Goe=()=>{const e=it(),[t,r]=v.useState(!1),[s,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null),[u,d]=v.useState(!1);v.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const y=await Ya.getTemplates();y.success&&y.data?n(y.data):Array.isArray(y)?n(y):y.data&&Array.isArray(y.data)?n(y.data):n([])}catch(y){console.error("Error loading templates:",y),ne.error("Failed to load templates"),n([])}finally{o(!1)}},f=()=>{r(!0)},h=()=>{r(!1),m()},x=y=>{ne.error(`Import failed: ${y}`,{icon:!1})},p=y=>{c(y),d(!0)},g=y=>{const j={PENDING:{variant:"warning",icon:ft,text:"PENDING"},PUBLISHED:{variant:"success",icon:ht,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:At,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:At,text:"ARCHIVED"}},S=j[y]||j.DRAFT,E=S.icon;return a.jsxs(Ae,{bg:S.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[a.jsx(E,{size:12}),S.text]})},b=y=>{if(!y)return"N/A";try{return new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return y}};return a.jsx(_e,{fluid:!0,className:"py-4 forms-page form-component",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:a.jsxs(de,{className:"align-items-center",children:[a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"me-2 text-white",size:24}),a.jsx("h4",{className:"mb-0 text-white",children:"Template List"})]})}),a.jsx(z,{xs:"auto",children:a.jsxs("div",{className:"d-flex gap-2",children:[a.jsxs(ie,{variant:"outline-light",onClick:()=>e("/admin/forms/drafts"),className:"d-flex align-items-center",size:"sm",children:[a.jsx(At,{className:"me-2",size:16}),"Your Drafts"]}),a.jsx(hr,{permission:Te.TEMPLATES.CREATE,fallback:null,children:a.jsxs(ie,{variant:"primary-custom",onClick:f,className:"d-flex align-items-center",size:"sm",children:[a.jsx(Ds,{className:"me-2",size:16}),"Create New Template"]})})]})})]})}),a.jsxs(W.Body,{children:[i?a.jsx(Rt,{}):s.length===0?a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ol,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No form templates found"}),a.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."})]})})}):a.jsx(de,{className:"g-3 g-md-4",children:s.map(y=>a.jsx(z,{xs:12,sm:6,md:6,lg:4,xl:3,children:a.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:j=>{j.currentTarget.style.transform="translateY(-5px)",j.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:j=>{j.currentTarget.style.transform="translateY(0)",j.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[a.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[a.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:a.jsx(At,{size:20})}),a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[a.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:y.name,children:y.name}),a.jsxs("small",{className:"text-muted",children:["v",y.version]})]})]}),a.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:a.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:y.description||"No description",children:y.description||"No description"})}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[a.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[a.jsx(Bs,{size:12,className:"text-muted me-1 flex-shrink-0"}),a.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:y.department?.code||"N/A",children:y.department?.code||"N/A"})]}),a.jsx("div",{className:"flex-shrink-0 ms-2",children:g(y.status)})]}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[a.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[a.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),a.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${y.createdByUser?.firstName||""} ${y.createdByUser?.lastName||""}`.trim(),children:[y.createdByUser?.firstName," ",y.createdByUser?.lastName]})]}),a.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:b(y.createdAt)})]}),a.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[a.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[a.jsx(At,{size:12,className:"me-1"}),y._count?.sections||0," sections"]}),a.jsxs(ie,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:j=>{j.stopPropagation(),p(y)},style:{whiteSpace:"nowrap"},children:[a.jsx(Et,{size:14,className:"me-1"}),"Preview"]})]})})]})})},y.id))}),a.jsx(Hoe,{show:t,onHide:()=>r(!1),onImportSuccess:h,onImportError:x}),a.jsx(Voe,{show:u,onHide:()=>{d(!1),c(null)},template:l})]})]})})};function qoe(e){const t=String(e||"").toUpperCase();return["TEXT","IMAGE","TOGGLE","PART","SECTION_CONTROL_TOGGLE","SIGNATURE_DRAW","SIGN_IMAGE","FINAL_SCORE_TEXT","FINAL_SCORE_NUM","VALUE_LIST"].includes(t),e}function JN(){try{const e=localStorage.getItem("templateInfo");if(e){const t=JSON.parse(e);return{id:t.id||null,name:t.name||"",description:t.description||"",departmentId:t.departmentId||"",templateContent:t.templateContent||"",templateConfig:t.templateConfig||null}}}catch{}return{id:null,name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||"",templateConfig:null}}function ZN(e,t){const r=(t||[]).map((s,n)=>{const i=s.fields||[],o={};for(const f of i)if(String(f.fieldType||"").toUpperCase()==="PART"){const h=f.fieldName||"",x=f.tempId||(h?`${h}-parent`:void 0);x&&(o[h]=x)}const c=i.map(f=>{const h=f.parentTempId;return h&&o[h]?{...f,parentTempId:o[h]}:f}).map((f,h)=>({...f,__idx:h})),u=c.filter(f=>!f.parentTempId).sort((f,h)=>f.__idx-h.__idx),d=[];for(const f of u){d.push(f);const h=String(f.fieldType||"").toUpperCase()==="PART"?f.tempId||o[f.fieldName]||(f.fieldName?`${f.fieldName}-parent`:void 0):null;if(h){const x=c.filter(p=>p.parentTempId===h).sort((p,g)=>p.__idx-g.__idx);d.push(...x)}}if(d.length!==c.length){const f=new Set(d.map(h=>h.__idx));c.filter(h=>!f.has(h.__idx)).sort((h,x)=>h.__idx-x.__idx).forEach(h=>d.push(h))}const m=d.map((f,h)=>{const x=String(f.fieldType||"").toUpperCase().startsWith("SIGNATURE"),p=String(f.fieldType||"").toUpperCase(),g=qoe(f.fieldType),b={label:f.label,fieldName:f.fieldName,fieldType:g,displayOrder:h+1,parentTempId:f.parentTempId?f.parentTempId:null};if(x&&(b.roleRequired=f.roleRequired||"TRAINER"),p==="PART"){const y=f.fieldName||"";b.tempId=f.tempId||(y?`${y}-parent`:void 0)}if(p==="VALUE_LIST"&&f.option)try{const y=JSON.parse(f.option);y.items&&Array.isArray(y.items)&&(b.option=y)}catch(y){console.warn("Failed to parse VALUE_LIST option:",y)}return b});return{label:s.label,displayOrder:n+1,editBy:s.editBy||"TRAINER",roleInSubject:s.roleInSubject?s.roleInSubject:null,isSubmittable:!!s.isSubmittable,isToggleDependent:!!s.isToggleDependent,fields:m}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:r}}function Koe(e){return Array.isArray(e)?e.map(t=>{const r=(t.fields||[]).filter(i=>i.fieldType==="PART"),s={};r.forEach(i=>{const o=`${i.fieldName}-parent`;s[i.id]=o});const n=(t.fields||[]).map(i=>{const o={label:i.label||"",fieldName:i.fieldName||"",fieldType:i.fieldType||"TEXT",roleRequired:i.roleRequired||null,parentTempId:null,option:null};if(i.parentId){const l=t.fields.find(c=>c.id===i.parentId);l&&l.fieldType==="PART"&&(o.parentTempId=`${l.fieldName}-parent`)}if(i.fieldType==="PART"&&(o.tempId=`${i.fieldName}-parent`),i.fieldType==="VALUE_LIST"&&i.options)try{o.option=JSON.stringify(i.options)}catch(l){console.warn("Failed to stringify VALUE_LIST options:",l)}return o});return{name:t.label||t.name||"",label:t.label||t.name||"",displayOrder:t.displayOrder||1,editBy:t.editBy||"TRAINER",roleInSubject:t.roleInSubject||"",isSubmittable:!!t.isSubmittable,isToggleDependent:!!t.isToggleDependent,fields:n}}):[]}const Yoe=({customFields:e=[],onAddField:t,onRemoveField:r,onInsertField:s,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:o,getDocumentKey:l,addSystemFieldToSectionRef:c,initialSections:u=null,readOnly:d=!1,className:m=""})=>{const[f,h]=v.useState([]);v.useEffect(()=>{u&&Array.isArray(u)&&u.length>0&&f.length===0&&(console.log(" Restoring sections from draft:",u),h(u))},[u]);const[x,p]=v.useState({}),[g,b]=v.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),[y,j]=v.useState({fromIndex:null,overIndex:null,position:"above"}),[S,E]=v.useState(!1),[w,N]=v.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[C,T]=v.useState(["TRAINER","TRAINEE"]),[_,k]=v.useState(!1),[I,L]=v.useState(!1),[D,M]=v.useState(null),[q,Z]=v.useState(null),[Q,U]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null,option:null});v.useEffect(()=>{e&&e.length>0&&f.length===0&&h([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]),v.useEffect(()=>(c&&(c.current={getSections:()=>f,addSystemField:(me,xe)=>{if(me===null||me<0||me>=f.length)return ne.error("Invalid section index"),!1;const Oe=f[me],ot=Oe.fields||[];if(ot.some(De=>De.fieldName===xe.fieldName))return ne.warning(`Field "${xe.fieldName}" already exists in this section`),!1;const tt={...xe,roleRequired:xe.roleRequired||Oe.editBy||"TRAINER"},Qe=[...f];if(Qe[me]={...Oe,fields:[...ot,tt]},h(Qe),t){const De=Qe.flatMap(Ve=>Ve.fields||[]);setTimeout(()=>{t(De)},0)}return!0},buildAndSubmitDraftTemplate:async me=>{try{console.log(" Building and submitting draft template..."),console.log(" Draft URL (OnlyOffice):",me);let xe=null;const Oe=JN();try{console.log(" Uploading from OnlyOffice URL to S3...");const dt=`${(Oe.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}_draft.docx`;if(console.log(" File name for upload:",dt),xe=await wo.uploadFromUrl(me,dt),xe)console.log(" Upload from URL success! S3 URL:",xe);else throw console.warn(" No S3 URL received from upload-from-url"),new Error("Failed to upload to S3")}catch(st){throw console.error(" Upload from URL failed:",st),ne.error("Could not upload draft document to S3"),st}const ot={...Oe,templateContent:Oe.templateContent,templateConfig:xe},tt=ZN(ot,f),Qe={name:tt.name,description:tt.description,departmentId:tt.departmentId,templateContent:tt.templateContent,templateConfig:tt.templateConfig||null,status:"DRAFT",sections:tt.sections};console.log(" Draft template payload built:"),console.log("   templateContent (file import):",Qe.templateContent),console.log("   templateConfig (file  chnh sa):",Qe.templateConfig||"null"),console.log("   Status:",Qe.status),console.log(` Full payload:
`,JSON.stringify(Qe,null,2));const De=Oe.id;let Ve;if(De)console.log(" Updating existing draft:",De),Ve=await Pe.put(`/templates/${De}`,Qe),ne.success("Draft template updated successfully!");else if(console.log(" Creating new draft"),Ve=await Pe.post("/templates",Qe),ne.success("Draft template saved successfully!"),Ve?.data?.data?.templateForm?.id){const st={...Oe,id:Ve.data.data.templateForm.id};localStorage.setItem("templateInfo",JSON.stringify(st))}return console.log(" Draft template saved successfully:",Ve?.data??Ve),Ve?.data??Ve}catch(xe){throw console.error(" Error building/submitting draft template:",xe),ne.error("Failed to save draft template: "+(xe.message||"Unknown error")),xe}}}),()=>{c&&(c.current=null)}),[f,c,t]);const le=()=>{N({name:"",label:"",displayOrder:f.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),E(!0)},Se=me=>{p(xe=>({...xe,[me]:!xe[me]}))},P=(me,xe,Oe)=>{xe===null||Oe===null||xe===Oe||h(ot=>{const tt=[...ot],Qe=[...tt[me]?.fields||[]],[De]=Qe.splice(xe,1);if(Qe.splice(Oe,0,De),tt[me]={...tt[me],fields:Qe},t){const Ve=tt.flatMap(st=>st.fields||[]);setTimeout(()=>{t(Ve,{silent:!0})},0)}return tt})},G=(me,xe)=>{me===null||xe===null||me===xe||h(Oe=>{const ot=[...Oe],[tt]=ot.splice(me,1);return ot.splice(xe,0,tt),ot})},K=()=>{if(!w.label){ne.warning("Please fill in section label");return}const me={...w,name:w.label,roleInSubject:w.editBy==="TRAINEE"?null:w.roleInSubject||null,fields:[...w.fields||[]]};if(me.isToggleDependent){const xe=`${me.name.toLowerCase().replace(/\s+/g,"_")}_toggle`,Oe={label:`${me.label} Toggle`,fieldName:xe,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:me.editBy||"TRAINER",parentTempId:null};me.fields=[Oe]}h(xe=>[...xe,me]),E(!1)};v.useEffect(()=>{S&&(async()=>{try{const xe=await Cs.getRoles(),ot=(Array.isArray(xe?.roles)?xe.roles:Array.isArray(xe)?xe:[]).map(Qe=>typeof Qe=="string"?Qe:Qe.name||Qe.code||Qe.roleName||"").filter(Qe=>typeof Qe=="string").map(Qe=>Qe.toUpperCase()).filter(Qe=>Qe.includes("TRAINER")||Qe.includes("TRAINEE")).map(Qe=>Qe.includes("TRAINER")?"TRAINER":"TRAINEE"),tt=Array.from(new Set(ot));tt.length>0&&T(tt)}catch{}})()},[S]);const O=me=>{const Oe=f[me]?.editBy||"TRAINER";U({label:"",fieldName:"",fieldType:"TEXT",roleRequired:Oe,displayOrder:1,parentTempId:null,option:null}),M(me),k(!0)},F=(me,xe)=>{if(!me)return{valid:!1,message:"Field name is required"};const Oe=String(xe||"").toUpperCase();return Oe==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(me)?me.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:Oe==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(me)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(me)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},H=()=>{if(!Q.label||!Q.fieldName){ne.warning("Please fill in all required fields");return}if(Q.fieldType==="VALUE_LIST"){if(!Q.option||!Q.option.trim()){ne.warning("Please provide options (JSON format) for VALUE_LIST field");return}try{const tt=JSON.parse(Q.option);if(!tt.items||!Array.isArray(tt.items)||tt.items.length===0){ne.warning('Options must be a JSON object with a non-empty "items" array');return}}catch{ne.warning('Invalid JSON format for options. Example: {"items": ["Pass", "Fail"]}');return}}const me=F(Q.fieldName,Q.fieldType);if(!me.valid){ne.warning(me.message);return}if(D===null||D<0||D>=f.length){ne.warning("Please choose a section");return}const xe=f[D].fields||[];if((q!==null?xe.filter((tt,Qe)=>Qe!==q):xe).some(tt=>tt.fieldName===Q.fieldName)){ne.warning("Field name must be unique");return}const ot=[...f];if(q!==null?ot[D].fields=[...xe.slice(0,q),Q,...xe.slice(q+1)]:ot[D].fields=[...xe,{...Q}],h(ot),t){const tt=ot.flatMap(Qe=>Qe.fields||[]);setTimeout(()=>{t(tt)},0)}k(!1),L(!1),M(null),Z(null)},Y=(me,xe)=>{const Oe=f[me]?.fields?.[xe];Oe&&(U({...Oe}),M(me),Z(xe),L(!0))},te=()=>{k(!1),L(!1),E(!1),M(null),Z(null)},[pe,we]=v.useState(!1),B=async()=>{try{we(!0);const me=JN(),xe=l?l():null;console.log(" DocumentKey:",xe);let Oe=null;const ot=me.templateContent;if(o)try{console.log(" Triggering callback flow...");const tr=await o();if(tr){console.log(" Callback flow success! OnlyOffice URL:",tr);try{console.log(" Uploading from OnlyOffice URL to S3...");const ro=`${(me.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}.docx`;console.log(" File name for upload:",ro),Oe=await wo.uploadFromUrl(tr,ro),Oe?console.log(" Upload from URL success! S3 URL:",Oe):(console.warn(" No S3 URL received from upload-from-url"),Oe=null)}catch(xr){console.error(" Upload from URL failed:",xr),ne.warning("Could not upload document to S3"),Oe=null}}else console.warn(" No OnlyOffice URL received"),Oe=null}catch(tr){console.error(" Callback flow failed:",tr),ne.warning("Could not get edited document from backend"),Oe=null}else console.warn(" forceSaveAndPoll function not available"),Oe=null;console.log(" Submitting template to backend...");const tt=f.flatMap(tr=>tr.fields||[]),Qe=tt.filter(tr=>tr.fieldType==="FINAL_SCORE_TEXT"),De=tt.filter(tr=>tr.fieldType==="FINAL_SCORE_NUM");if(Qe.length!==1){ne.error(`Template must have exactly 1 FINAL_SCORE_TEXT field. Found: ${Qe.length}`),we(!1);return}if(De.length!==1){ne.error(`Template must have exactly 1 FINAL_SCORE_NUM field. Found: ${De.length}`),we(!1);return}const Ve={...me,templateContent:ot,templateConfig:Oe},st=ZN(Ve,f),ct={name:st.name,description:st.description,departmentId:st.departmentId,templateContent:st.templateContent,templateConfig:st.templateConfig||null,status:"PENDING",sections:st.sections};console.log(" Template payload built:"),console.log("   templateContent (file import):",ct.templateContent),console.log("   templateConfig (file  chnh sa):",ct.templateConfig||"null"),console.log("   Status:",ct.status),console.log("   documentKey:",xe),console.log(` Full payload:
`,JSON.stringify(ct,null,2));const dt=me.id;let Qt;dt?(console.log(" Updating existing template (draft  PENDING):",dt),Qt=await Pe.put(`/templates/${dt}`,ct),ne.success("Template updated and submitted successfully")):(console.log(" Creating new template"),Qt=await Pe.post("/templates",ct),ne.success("Template submitted successfully")),console.log(" Backend response:",Qt?.data??Qt)}catch(me){console.error(" Submit template failed:",me),ne.error("Failed to submit template: "+(me.message||"Unknown error"))}finally{we(!1)}},Be=me=>{const xe=me.fieldName;if(!xe)return"";switch((me.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${xe}}{/`+xe+`} {^${xe}}{/`+xe+"}";case"PART":return`{#${xe}} {test_field} {/${xe}}`;case"IMAGE":case"SIGNATURE_DRAW":case"SIGN_IMAGE":case"FINAL_SCORE_TEXT":case"FINAL_SCORE_NUM":case"VALUE_LIST":case"TEXT":default:return`{${xe}}`}},[fe,oe]=v.useState(!1),[ge,ue]=v.useState(null),[Ie,Le]=v.useState(null),[he,Me]=v.useState(""),[Ge,Ke]=v.useState("TEXT"),[We,yt]=v.useState(""),[Xe,Je]=v.useState("TRAINER"),Ye=(me,xe,Oe)=>{Le(me),ue(Oe),Me(""),Ke("TEXT"),yt(""),Je("TRAINER"),oe(!0)},at=()=>{if(!We||!he||!/^[a-z][a-z0-9_]*$/.test(he)){ne.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!ge?.fieldName){ne.error("Invalid PART field");return}if(Ie===null||Ie<0||Ie>=f.length){ne.error("Invalid section");return}const Oe=f[Ie].fields||[];if(Oe.some(st=>st.fieldName===he)){ne.warning("Field name must be unique within section");return}const ot={label:We,fieldName:he,fieldType:Ge,roleRequired:Xe,parentTempId:ge?.tempId||ge?.fieldName||null},tt=[...f];if(tt[Ie].fields=[...Oe,ot],h(tt),t){const st=tt.flatMap(ct=>ct.fields||[]);setTimeout(()=>{t(st)},0)}let Qe=`{${he}}`;const De=String(Ge).toUpperCase();De==="TOGGLE"?Qe=`{#${he}}{/${he}} {^${he}}{/${he}}`:De==="IMAGE"&&(Qe=`{${he}}`);const Ve=` ${Qe}`;setTimeout(()=>s(Ve),0),oe(!1),ue(null),Le(null),Me(""),Ke("TEXT"),yt(""),Je("TRAINER")};return a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
        `}),a.jsxs("div",{className:`p-2 p-md-3 bg-light custom-fields-panel ${m}`,style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 mb-md-3 flex-wrap gap-2 flex-shrink-0",children:[a.jsx("h6",{className:"mb-0 text-muted custom-fields-title",style:{fontSize:"0.95rem"},children:"Available Custom Fields"}),a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:le,disabled:d,className:"custom-fields-add-section-btn",style:{whiteSpace:"nowrap",flexShrink:0},children:[a.jsx(ms,{className:"me-1",size:14}),a.jsx("span",{className:"d-none d-sm-inline",children:"Add Section"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Section"})]})]}),a.jsx("div",{className:"flex-grow-1 custom-fields-content",style:{overflowY:"auto",overflowX:"hidden",minHeight:"0",flex:"1 1 auto"},children:a.jsx("div",{className:"d-grid gap-2 custom-fields-grid",children:f.length>0?f.map((me,xe)=>a.jsxs(W,{className:`border section-card ${y.fromIndex===xe?"section-dragging":""} ${y.overIndex===xe?y.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!d,onDragStart:Oe=>{if(d){Oe.preventDefault();return}j({fromIndex:xe,overIndex:xe,position:"above"}),Oe.dataTransfer.effectAllowed="move"},onDragOver:Oe=>{if(d||y.fromIndex===null)return;Oe.preventDefault();const ot=Oe.currentTarget.getBoundingClientRect(),tt=ot.top+ot.height/2,Qe=Oe.clientY<tt?"above":"below";let De=xe;Qe==="below"&&y.fromIndex<xe?De=xe+1:Qe==="above"&&y.fromIndex>xe?De=xe:Qe==="below"&&y.fromIndex>xe?De=xe+1:Qe==="above"&&y.fromIndex<xe&&(De=xe),(y.overIndex!==De||y.position!==Qe)&&j(Ve=>({...Ve,overIndex:De,position:Qe}))},onDrop:Oe=>{if(d||y.fromIndex===null)return;Oe.preventDefault();const ot=Math.max(0,Math.min(y.overIndex,f.length));G(y.fromIndex,ot),j({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{j({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:d?"default":"grab"},children:[a.jsxs(W.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>Se(xe),"aria-expanded":!x[xe],onDragStart:Oe=>Oe.stopPropagation(),style:{padding:"0.75rem"},children:[a.jsxs("div",{className:"d-flex flex-column flex-grow-1",style:{minWidth:0,marginRight:"0.5rem"},children:[a.jsxs("div",{className:"section-title fw-bold d-flex align-items-center",style:{fontSize:"0.9rem"},children:[x[xe]?a.jsx(cc,{size:16,className:"flex-shrink-0"}):a.jsx(Ka,{size:16,className:"flex-shrink-0"}),a.jsx("span",{className:"text-truncate ms-1",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:me.label,children:me.label}),a.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge flex-shrink-0",children:me.fields?.length||0})]}),a.jsxs("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:["Edit by: ",me.editBy]})]}),a.jsx("div",{onClick:Oe=>Oe.stopPropagation(),className:"flex-shrink-0",children:a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>O(xe),disabled:d,className:"custom-fields-add-field-btn",style:{whiteSpace:"nowrap",fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[a.jsx(ms,{className:"me-1",size:12}),a.jsx("span",{className:"d-none d-sm-inline",children:"Add Field"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Field"})]})})]}),!x[xe]&&a.jsx(W.Body,{className:"section-body",children:me.fields&&me.fields.length>0?(()=>{const Oe=[...me.fields].sort((Ve,st)=>Ve.displayOrder-st.displayOrder),ot=Ve=>Ve?.tempId||Ve?.fieldName||null,tt=Ve=>!!Ve.parentTempId,Qe=Oe.filter(Ve=>!tt(Ve)),De=(Ve,st)=>{const ct=String(Ve.fieldType).toUpperCase()==="PART";return a.jsxs("div",{className:`p-2 p-md-2 rounded border mb-2 mb-md-2 draggable-item custom-field-item ${ct?"bg-part part-card":"bg-white child-row"} ${g.sectionIndex===xe&&g.overIndex===st?"border-primary":""} ${g.sectionIndex===xe&&g.overIndex===st&&g.position==="above"?"drop-target-above":""} ${g.sectionIndex===xe&&g.overIndex===st&&g.position==="below"?"drop-target-below":""} ${g.sectionIndex===xe&&g.fromIndex===st?"dragging":""}`,draggable:!0,style:{display:"block",visibility:"visible",opacity:1,cursor:"grab"},onDragStart:dt=>{b({sectionIndex:xe,fromIndex:st,overIndex:st,position:"above"}),dt.dataTransfer.effectAllowed="move"},onDragOver:dt=>{dt.preventDefault();const Qt=dt.currentTarget.getBoundingClientRect(),tr=Qt.top+Qt.height/2,xr=dt.clientY<tr?"above":"below";let to=st;xr==="below"&&(to=st+1),g.sectionIndex===xe&&(g.overIndex!==to||g.position!==xr)&&b(ro=>({...ro,overIndex:to,position:xr}))},onDrop:dt=>{if(dt.preventDefault(),g.sectionIndex===xe){const Qt=Math.max(0,Math.min(g.overIndex,f[xe]?.fields?.length||0));P(xe,g.fromIndex,Qt)}b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>b({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2 gap-2",children:[a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[a.jsxs("div",{className:"fw-bold field-title d-flex align-items-center flex-wrap gap-1",style:{fontSize:"0.85rem",wordBreak:"break-word"},children:[a.jsx("span",{className:"text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:Ve.label,children:Ve.label}),ct&&a.jsx("span",{className:"badge part-badge flex-shrink-0",children:"PART"})]}),a.jsxs("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis"},title:`${Ve.fieldName} (${Ve.fieldType})${Ve.roleRequired?` - ${Ve.roleRequired}`:""}`,children:[Ve.fieldName," (",Ve.fieldType,")",Ve.roleRequired?` - ${Ve.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1 flex-shrink-0",children:[a.jsx(ie,{variant:"outline-primary",size:"sm",onClick:()=>Y(xe,st),disabled:d,title:"Edit Field",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:a.jsx(Br,{size:12})}),a.jsx(ie,{variant:"outline-danger",size:"sm",onClick:()=>{const dt=[...f];if(dt[xe].fields=dt[xe].fields.filter((Qt,tr)=>tr!==st),h(dt),r){const Qt=dt.flatMap(tr=>tr.fields||[]);r(Qt)}},disabled:d,title:"Remove Field",className:"text-danger border-danger",style:{padding:"0.25rem 0.4rem"},children:a.jsx(nt,{size:12})})]})]}),a.jsxs("div",{className:"d-grid gap-1",children:[a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>s(Be(Ve)),disabled:d,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out",fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[a.jsx(Pl,{className:"me-1",size:12}),a.jsx("span",{className:"d-none d-sm-inline",children:"Insert Field"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Insert"})]}),String(Ve.fieldType).toUpperCase()==="PART"&&a.jsxs(ie,{variant:"outline-primary",size:"sm",className:"mt-0 text-primary border-primary",onClick:()=>Ye(xe,st,Ve),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[a.jsx(Pl,{className:"me-1",size:12}),a.jsx("span",{className:"d-none d-sm-inline",children:"Add Field to PART"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Add to PART"})]})]}),String(Ve.fieldType).toUpperCase()==="PART"&&(()=>{const dt=ot(Ve),Qt=Oe.filter(tr=>tr.parentTempId===dt);return Qt.length?a.jsx("div",{className:"mt-2 part-children",children:Qt.map(tr=>{const xr=me.fields.indexOf(tr);return De(tr,xr)})}):null})()]},`${xe}-${st}`)};return a.jsx(a.Fragment,{children:Qe.map(Ve=>{const st=me.fields.indexOf(Ve);return De(Ve,st)})})})():a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},xe)):a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),a.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-2 mt-md-3 gap-2 flex-shrink-0",style:{borderTop:"1px solid #dee2e6",paddingTop:"0.75rem"},children:[a.jsxs(Re,{variant:"info",className:"mb-0 custom-fields-tip",style:{fontSize:"0.75rem",padding:"0.5rem",flex:"1 1 auto",marginRight:"0.5rem"},children:[a.jsx("strong",{children:"Tip:"})," ",a.jsx("span",{className:"d-none d-sm-inline",children:"Create sections first, then add fields inside each section."}),a.jsx("span",{className:"d-inline d-sm-none",children:"Create sections, then add fields."})]}),a.jsx(ie,{variant:"primary",size:"sm",onClick:B,disabled:pe,className:"custom-fields-submit-btn flex-shrink-0",style:{whiteSpace:"nowrap",fontSize:"0.8rem",padding:"0.375rem 0.75rem"},children:pe?"Submitting...":a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"d-none d-sm-inline",children:"Submit Template"}),a.jsx("span",{className:"d-inline d-sm-none",children:"Submit"})]})})]}),a.jsxs(ce,{show:S,onHide:te,centered:!0,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Add New Section"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"Display label",value:w.label,onChange:me=>N(xe=>({...xe,label:me.target.value})),required:!0})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Edit By"}),a.jsx(A.Select,{value:w.editBy,onChange:me=>{const xe=me.target.value;N(Oe=>({...Oe,editBy:xe,roleInSubject:xe==="TRAINEE"?"":Oe.roleInSubject}))},children:C.map(me=>a.jsx("option",{value:me,children:me},me))})]})}),w.editBy==="TRAINER"&&a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Role In Subject"}),a.jsxs(A.Select,{value:w.roleInSubject||"ASSESSMENT_REVIEWER",onChange:me=>N(xe=>({...xe,roleInSubject:me.target.value})),style:{minWidth:"200px"},children:[a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),a.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"d-flex flex-row align-items-center gap-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(A.Check,{type:"checkbox",checked:w.isSubmittable,onChange:me=>N(xe=>({...xe,isSubmittable:me.target.checked})),id:"section-submittable"}),a.jsx(A.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(A.Check,{type:"checkbox",checked:w.isToggleDependent,onChange:me=>N(xe=>({...xe,isToggleDependent:me.target.checked})),id:"section-toggle-dependent"}),a.jsx(A.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:K,children:"Save Section"})]})]}),a.jsxs(ce,{show:_,onHide:te,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Add New Field"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Adding field to section: ",a.jsx("strong",{children:D!==null?f[D]?.label:"N/A"})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Crew Communication",value:Q.label,onChange:me=>U(xe=>({...xe,label:me.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., crew_communication",value:Q.fieldName,onChange:me=>U(xe=>({...xe,fieldName:me.target.value})),required:!0}),a.jsxs(A.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:Q.fieldType,onChange:me=>{const xe=me.target.value;U(Oe=>({...Oe,fieldType:xe,option:xe==="VALUE_LIST"?Oe.option:null}))},required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"IMAGE",children:"IMAGE"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"SIGNATURE_DRAW",children:"SIGNATURE_DRAW"}),a.jsx("option",{value:"SIGN_IMAGE",children:"SIGN_IMAGE"}),a.jsx("option",{value:"FINAL_SCORE_TEXT",children:"FINAL_SCORE_TEXT"}),a.jsx("option",{value:"FINAL_SCORE_NUM",children:"FINAL_SCORE_NUM"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Role Required ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",value:D!==null&&f[D]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),a.jsx(A.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),Q.fieldType==="VALUE_LIST"&&a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Options (JSON) ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{as:"textarea",rows:3,placeholder:'{"items": ["Pass", "Fail"]}',value:Q.option||"",onChange:me=>{try{const xe=me.target.value.trim();if(xe){const Oe=JSON.parse(xe);if(!Oe.items||!Array.isArray(Oe.items))throw new Error("Invalid format")}U(Oe=>({...Oe,option:xe}))}catch{U(xe=>({...xe,option:me.target.value}))}},required:!0}),a.jsxs(A.Text,{className:"text-muted",children:["JSON format with items array. Example: ",'{"items": ["Pass", "Fail"]}']}),Q.option&&(()=>{try{const me=JSON.parse(Q.option);return!me.items||!Array.isArray(me.items)?a.jsx(A.Text,{className:"text-danger",children:'Invalid format: must have "items" array'}):a.jsxs(A.Text,{className:"text-success",children:[" Valid JSON with ",me.items.length," items"]})}catch{return a.jsx(A.Text,{className:"text-danger",children:"Invalid JSON format"})}})()]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Parent Template ID"}),a.jsx(A.Control,{type:"text",placeholder:"Leave empty for root level",value:Q.parentTempId||"",onChange:me=>U(xe=>({...xe,parentTempId:me.target.value||null}))})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:H,children:"Save Field"})]})]}),a.jsxs(ce,{show:I,onHide:te,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Edit Field"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Crew Communication",value:Q.label,onChange:me=>U(xe=>({...xe,label:me.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:Q.fieldType,onChange:me=>{const xe=me.target.value;U(Oe=>({...Oe,fieldType:xe,option:xe==="VALUE_LIST"?Oe.option:null}))},required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"IMAGE",children:"IMAGE"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"SIGNATURE_DRAW",children:"SIGNATURE_DRAW"}),a.jsx("option",{value:"SIGN_IMAGE",children:"SIGN_IMAGE"}),a.jsx("option",{value:"FINAL_SCORE_TEXT",children:"FINAL_SCORE_TEXT"}),a.jsx("option",{value:"FINAL_SCORE_NUM",children:"FINAL_SCORE_NUM"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Role Required ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",value:D!==null&&f[D]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),a.jsx(A.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:Q.fieldType==="PART"?"e.g., Assessment_Items":Q.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:Q.fieldName,onChange:me=>U(xe=>({...xe,fieldName:me.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:Q.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':Q.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),Q.fieldType==="VALUE_LIST"&&a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Options (JSON) ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{as:"textarea",rows:3,placeholder:'{"items": ["Pass", "Fail"]}',value:Q.option||"",onChange:me=>{try{const xe=me.target.value.trim();if(xe){const Oe=JSON.parse(xe);if(!Oe.items||!Array.isArray(Oe.items))throw new Error("Invalid format")}U(Oe=>({...Oe,option:xe}))}catch{U(xe=>({...xe,option:me.target.value}))}},required:!0}),a.jsxs(A.Text,{className:"text-muted",children:["JSON format with items array. Example: ",'{"items": ["Pass", "Fail"]}']}),Q.option&&(()=>{try{const me=JSON.parse(Q.option);return!me.items||!Array.isArray(me.items)?a.jsx(A.Text,{className:"text-danger",children:'Invalid format: must have "items" array'}):a.jsxs(A.Text,{className:"text-success",children:[" Valid JSON with ",me.items.length," items"]})}catch{return a.jsx(A.Text,{className:"text-danger",children:"Invalid JSON format"})}})()]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Parent Template ID"}),a.jsx(A.Control,{type:"text",placeholder:"Leave empty for root level",value:Q.parentTempId||"",onChange:me=>U(xe=>({...xe,parentTempId:me.target.value||null}))})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:H,children:"Update Field"})]})]}),a.jsxs(ce,{show:fe,onHide:()=>oe(!1),children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Insert Part Field"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Insert field into PART: ",a.jsxs("strong",{children:[ge?.label," (",ge?.fieldName,")"]})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Focus Item",value:We,onChange:me=>yt(me.target.value)})]})}),a.jsx(z,{md:8,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., focus_item",value:he,onChange:me=>Me(me.target.value)}),a.jsx(A.Text,{className:"text-muted",children:"snake_case only"})]})}),a.jsx(z,{md:4,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Type"}),a.jsxs(A.Select,{value:Ge,onChange:me=>Ke(me.target.value),children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"IMAGE",children:"IMAGE"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{className:"text-primary-custom",children:"Role Required"}),a.jsx(A.Select,{value:Xe,onChange:me=>Je(me.target.value),children:C.map(me=>a.jsx("option",{value:me,children:me},me))})]})}),a.jsx(z,{md:12,children:a.jsx(A.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:()=>oe(!1),children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:at,children:"Insert"})]})]})]})]})},Xoe=({onInsertField:e,exportEditedDoc:t,initialUrl:r,readOnly:s=!1,className:n=""})=>{const[i,o]=v.useState([]),[l,c]=v.useState([]),[u,d]=v.useState({}),[m,f]=v.useState(!1),[h,x]=v.useState(!1),[p,g]=v.useState(!1),[b,y]=v.useState(null),[j,S]=v.useState(null),[E,w]=v.useState(null),[N,C]=v.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[T,_]=v.useState(["TRAINER","TRAINEE"]),k=v.useRef(null),I=v.useRef(!1),[L,D]=v.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),[M,q]=v.useState({fromIndex:null,overIndex:null,position:"above"}),Z=fe=>{d(oe=>({...oe,[fe]:!oe[fe]}))},Q=(fe,oe,ge)=>{oe===null||ge===null||oe===ge||c(ue=>{const Ie=[...ue],Le=[...Ie[fe]?.fields||[]],he=Le[oe];if(le(he)){const Ge=U(he),Ke=[],We=[];Le.forEach((Je,Ye)=>{Ye===oe||Je.parentTempId===Ge&&(Ke.push(Ye),We.push(Je))});const yt=[oe,...Ke].sort((Je,Ye)=>Ye-Je);yt.forEach(Je=>Le.splice(Je,1));let Xe=ge;yt.forEach(Je=>{Je<ge&&Xe--}),Le.splice(Xe,0,he,...We)}else{const[Ge]=Le.splice(oe,1);let Ke=ge;oe<ge&&Ke--,Le.splice(Ke,0,Ge)}return Ie[fe]={...Ie[fe],fields:Le},Ie})},U=fe=>fe.tempId||fe.name,le=fe=>String(fe.fieldType).toUpperCase()==="PART",Se=(fe,oe)=>{if(le(oe)){const ge=U(oe),ue=i.filter(Le=>Le.parentTempId===ge),Ie=[oe,...ue];fe.dataTransfer.setData("text/plain",JSON.stringify(Ie))}else fe.dataTransfer.setData("text/plain",JSON.stringify(oe))},P=(fe,oe)=>{fe.preventDefault();try{const ge=JSON.parse(fe.dataTransfer.getData("text/plain"));let Ie=Array.isArray(ge)?ge:[ge];I.current=!1,c(he=>{const Me=[...he],Ge=Me[oe]?.fields||[],Ke=Ie.filter(le),We=Ke.some(yt=>Ge.some(Xe=>le(Xe)&&Xe.name===yt.name));if(I.current=We,We){const yt=new Set(Ke.map(Ye=>Ye.name)),Xe=new Set;Ke.forEach(Ye=>{const at=U(Ye);Xe.add(at)});const Je=Ge.filter(Ye=>!(le(Ye)&&yt.has(Ye.name)||Ye.parentTempId&&Xe.has(Ye.parentTempId)));Me[oe]={...Me[oe],fields:[...Je,...Ie]}}else{for(const at of Ie)if(at.parentTempId&&Ge.some(xe=>{const Oe=U(xe);return le(xe)&&Oe===at.parentTempId}))return ne.warning(`Cannot add field "${at.name}": Fields cannot be dragged into existing PART fields.`),Me;const yt=at=>le(at)?at.name:at.parentTempId?`${at.name}:${at.parentTempId}`:at.name,Xe=new Set(Ge.map(yt)),Je=new Map,Ye=Ie.filter(at=>{if(le(at))return!Ge.some(Oe=>le(Oe)&&Oe.name===at.name);const me=yt(at);return!Xe.has(me)}).map(at=>{const me={...at};if(le(me)){console.log(` Adding PART field to section: ${me.name}`,{before:{parentTempId:me.parentTempId,tempId:me.tempId},existingFields:Ge.map(tt=>({name:tt.name,fieldType:tt.fieldType,tempId:tt.tempId,parentTempId:tt.parentTempId}))});const xe=me.parentTempId;me.parentTempId=null;const Oe=me.tempId||me.name,ot=me.tempId;me.tempId||(me.tempId=`${me.name}-parent`),Je.set(Oe,me.tempId),console.log(` PART field normalized: ${me.name}`,{before:{parentTempId:xe,tempId:ot},after:{parentTempId:me.parentTempId,tempId:me.tempId},oldId:Oe,mapping:`${Oe} -> ${me.tempId}`})}return me});console.log(" PartTempIdMapping:",Array.from(Je.entries())),console.log(" NewFields before update:",Ye.map(at=>({name:at.name,fieldType:at.fieldType,parentTempId:at.parentTempId,isPart:le(at)}))),Ye.forEach(at=>{if(at.parentTempId&&!le(at)){let me=null;if(Je.has(at.parentTempId))me=Je.get(at.parentTempId),console.log(` Updating child ${at.name}: parentTempId ${at.parentTempId} -> ${me}`),at.parentTempId=me;else{const xe=Ye.find(Oe=>le(Oe)&&(Oe.tempId===at.parentTempId||Oe.name===at.parentTempId));xe&&xe.tempId?(me=xe.tempId,console.log(` Updating child ${at.name} (fallback): parentTempId ${at.parentTempId} -> ${me}`),at.parentTempId=me):console.warn(` Could not find parent for child ${at.name} with parentTempId: ${at.parentTempId}`,{partTempIdMapping:Array.from(Je.entries()),availableParts:Ye.filter(le).map(Oe=>({name:Oe.name,tempId:Oe.tempId}))})}}}),console.log(" NewFields after update:",Ye.map(at=>({name:at.name,fieldType:at.fieldType,parentTempId:at.parentTempId,isPart:le(at)}))),Me[oe]={...Me[oe],fields:[...Ge,...Ye]}}return Me});const Le=Ie;I.current||o(he=>{const Me=(Ge,Ke)=>le(Ge)&&le(Ke)?Ge.name===Ke.name:Ge.parentTempId&&Ke.parentTempId?Ge.name===Ke.name&&Ge.parentTempId===Ke.parentTempId:Ge.name===Ke.name&&!Ge.parentTempId&&!Ke.parentTempId;return he.filter(Ge=>!Le.some(Ke=>Me(Ge,Ke)))})}catch{}},G=fe=>{fe.preventDefault()},K=(fe,oe)=>{fe===null||oe===null||fe===oe||c(ge=>{const ue=[...ge],[Ie]=ue.splice(fe,1);return ue.splice(oe,0,Ie),ue})},O=()=>{const fe=l.length+1;C({name:"",label:"",displayOrder:fe,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),g(!0)},F=()=>{if(!N.label){ne.warning("Please fill in section label");return}const fe={...N,name:N.label,roleInSubject:N.editBy==="TRAINEE"?null:N.roleInSubject||null};c(oe=>[...oe,fe]),g(!1)},H=()=>{g(!1),C({name:"",label:"",displayOrder:l.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]})};v.useEffect(()=>{p&&(async()=>{try{const oe=await Cs.getRoles(),ue=(Array.isArray(oe?.roles)?oe.roles:Array.isArray(oe)?oe:[]).map(Le=>typeof Le=="string"?Le:Le.name||Le.code||Le.roleName||"").filter(Le=>typeof Le=="string").map(Le=>Le.toUpperCase()).filter(Le=>Le.includes("TRAINER")||Le.includes("TRAINEE")).map(Le=>Le.includes("TRAINER")?"TRAINER":"TRAINEE"),Ie=Array.from(new Set(ue));Ie.length>0&&_(Ie)}catch{}})()},[p]);const Y=fe=>{c(oe=>oe.filter((ge,ue)=>ue!==fe))},te=(fe,oe)=>{const ge=l[fe]?.fields?.[oe];ge&&(w({...ge}),y(fe),S(oe),x(!0))},pe=(fe,oe)=>{if(!fe)return{valid:!1,message:"Field name is required"};const ge=String(oe||"").toUpperCase();return ge==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(fe)?fe.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:ge==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(fe)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(fe)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},we=()=>{if(!E||!E.label||!E.name){ne.warning("Please fill in all required fields");return}const fe=pe(E.name,E.fieldType);if(!fe.valid){ne.warning(fe.message);return}if(b===null||b<0||b>=l.length){ne.warning("Invalid section");return}const oe=[...l],ge=oe[b].fields||[];if(ge.filter((Me,Ge)=>Ge!==j).some(Me=>Me.name===E.name)){ne.warning("Field name must be unique within the section");return}const Le=oe[b]?.editBy||"TRAINER",he={...E,roleRequired:Le};oe[b].fields=[...ge.slice(0,j),he,...ge.slice(j+1)],c(oe),x(!1),w(null),y(null),S(null),ne.success("Field updated successfully")},B=()=>{x(!1),w(null),y(null),S(null)},Be=async()=>{try{f(!0);let fe=r;if(t&&!fe)try{const Ie=await t();Ie&&(fe=Ie)}catch{}if(!fe)try{const Ie=localStorage.getItem("templateInfo");if(Ie){const Le=JSON.parse(Ie);Le.templateContent&&(fe=Le.templateContent)}}catch{}if(!fe){ne.error("No document URL available"),f(!1);return}const{data:oe}=await Pe.post("/templates/extract-fields-from-url",{url:fe}),ue=(oe?.fields||oe||[]).map((Ie,Le)=>({name:Ie.fieldName||Ie.name||`field_${Le}`,label:`{${Ie.fieldName||Ie.name}}`,fieldType:Ie.fieldType,displayOrder:Ie.displayOrder,parentTempId:Ie.parentTempId||null,tempId:Ie.tempId}));o(ue)}catch{ne.error("Failed to extract fields")}finally{f(!1)}};return v.useEffect(()=>{r&&r!==k.current&&(k.current=r,Be())},[r]),a.jsxs("div",{className:`h-100 d-flex flex-column editor-merge-fields-wrapper ${n}`,style:{width:"100%",maxWidth:"100%",overflow:"hidden",boxSizing:"border-box"},children:[a.jsx("div",{className:"p-2 border-bottom bg-white",style:{flexShrink:0},children:a.jsx("div",{className:"d-flex align-items-center gap-2",children:a.jsx(ie,{size:"sm",variant:"outline-primary",onClick:O,disabled:m,children:"+ Add Section"})})}),a.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{overflow:"hidden",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[a.jsx("style",{children:`
          .editor-merge-fields-wrapper {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
          }
          
          .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
          /* Force margin-left = 0 for non-child fields to prevent CSS cascade issues */
          .section-field-non-child {
            margin-left: 0 !important;
          }
          .section-field-child {
            margin-left: 1rem !important;
          }
          
          /* Prevent text overflow in field items */
          .section-field-non-child > div:first-child,
          .section-field-child > div:first-child {
            min-width: 0 !important;
            flex: 1 !important;
            overflow: hidden !important;
          }
          
          .section-field-non-child .fw-bold,
          .section-field-child .fw-bold {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child .text-muted,
          .section-field-child .text-muted {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child > div:last-child,
          .section-field-child > div:last-child {
            flex-shrink: 0 !important;
          }
          
          /* Match CustomFieldsPanel styling */
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: 0.5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-border-color); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight: 600; border: 1px solid rgba(var(--bs-primary-rgb), .25); }
          .field-card-item { padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #dee2e6; margin-bottom: 0.5rem; background: white; }
          .field-card-item.bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .field-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-card-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background: #fff; }
          .field-card-item.drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .field-card-item.drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
        `}),a.jsx("div",{className:"flex-shrink-0",style:{maxHeight:"60%",overflowY:"auto",borderBottom:"1px solid #eee",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:a.jsxs("div",{className:"p-3",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[l.length===0&&a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No sections yet. Click "+ Add Section" to start.'})}),l.length>0&&a.jsx("div",{className:"d-grid gap-2",children:l.map((fe,oe)=>a.jsxs(W,{className:`border section-card ${M.fromIndex===oe?"section-dragging":""} ${M.overIndex===oe?M.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!s,onDragStart:ge=>{if(s){ge.preventDefault();return}q({fromIndex:oe,overIndex:oe,position:"above"}),ge.dataTransfer.effectAllowed="move"},onDragOver:ge=>{if(s||M.fromIndex===null){G(ge);return}ge.preventDefault();const ue=ge.currentTarget.getBoundingClientRect(),Ie=ue.top+ue.height/2,Le=ge.clientY<Ie?"above":"below";let he=oe;Le==="below"&&M.fromIndex<oe?he=oe+1:Le==="above"&&M.fromIndex>oe?he=oe:Le==="below"&&M.fromIndex>oe?he=oe+1:Le==="above"&&M.fromIndex<oe&&(he=oe),(M.overIndex!==he||M.position!==Le)&&q(Me=>({...Me,overIndex:he,position:Le}))},onDrop:ge=>{if(s||M.fromIndex===null){P(ge,oe);return}ge.preventDefault();const ue=Math.max(0,Math.min(M.overIndex,l.length));K(M.fromIndex,ue),q({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{q({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:s?"default":"grab"},children:[a.jsxs(W.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>Z(oe),"aria-expanded":!u[oe],onDragStart:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("div",{className:"section-title fw-bold",children:[u[oe]?a.jsx(cc,{size:16}):a.jsx(Ka,{size:16}),fe.label,a.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge",children:fe.fields?.length||0})]}),a.jsxs("small",{className:"text-muted",children:["Edit by: ",fe.editBy||"TRAINER"]})]}),a.jsx("div",{onClick:ge=>ge.stopPropagation(),children:a.jsx(ie,{size:"sm",variant:"outline-danger",onClick:()=>Y(oe),disabled:s,children:"Remove"})})]}),!u[oe]&&a.jsx(W.Body,{className:"section-body",children:fe.fields&&fe.fields.length>0?(()=>{const ge=[...fe.fields],ue=ge.filter(he=>le(he)?(he.parentTempId&&console.error(` PART field ${he.name} has parentTempId: ${he.parentTempId} - This should be null!`),!0):!he.parentTempId||he.parentTempId===null||he.parentTempId==="");console.log(` Section ${oe} fields analysis:`,{totalFields:ge.length,topLevelCount:ue.length,topLevelFields:ue.map(he=>({name:he.name,fieldType:he.fieldType,tempId:he.tempId,parentTempId:he.parentTempId,isPart:le(he)})),allFields:ge.map(he=>({name:he.name,fieldType:he.fieldType,tempId:he.tempId,parentTempId:he.parentTempId,isPart:le(he)}))}),ue.forEach(he=>{le(he)&&he.parentTempId&&console.error(` CRITICAL BUG: PART field ${he.name} in topLevel has parentTempId: ${he.parentTempId}`,he)});const Ie=ge.filter(le);Ie.forEach((he,Me)=>{Ie.forEach((Ge,Ke)=>{Me!==Ke&&he.parentTempId&&Ge.tempId&&he.parentTempId===Ge.tempId&&console.error(` CRITICAL: PART field ${he.name} has parentTempId "${he.parentTempId}" matching PART ${Ge.name}'s tempId "${Ge.tempId}"`,{part1:{name:he.name,fieldType:he.fieldType,tempId:he.tempId,parentTempId:he.parentTempId},part2:{name:Ge.name,fieldType:Ge.fieldType,tempId:Ge.tempId,parentTempId:Ge.parentTempId}})})});const Le=(he,Me,Ge=null)=>{const Ke=le(he);console.log(` renderRow: ${he.name} (${he.fieldType}), realIndex: ${Me}, topLevelIdx: ${Ge}, isPart: ${Ke}, parentTempId: ${he.parentTempId}, tempId: ${he.tempId}`),Ke&&he.parentTempId&&(console.error(` CRITICAL: PART field ${he.name} has parentTempId ${he.parentTempId} - resetting to null!`,he),he.parentTempId=null);const We=he.tempId,yt=he.name;Ke&&console.log(` PART field ${he.name} searching with tempId: "${We}", fieldName: "${yt}"`);let Xe=[];if(Ke){if(console.log(` PART field ${he.name} (tempId: ${We}, realIndex: ${Me}) searching for children in ${ge.length} total fields:`,{allFields:ge.map(De=>({name:De.name,fieldType:De.fieldType,isPart:le(De),parentTempId:De.parentTempId,tempId:De.tempId}))}),Xe=ge.filter(De=>{if(le(De))return We&&De.parentTempId===We&&console.error(` CRITICAL: PART field ${De.name} has parentTempId "${De.parentTempId}" matching PART ${he.name}'s tempId "${We}" - BLOCKED from children!`,{childField:{name:De.name,fieldType:De.fieldType,tempId:De.tempId,parentTempId:De.parentTempId},parentField:{name:he.name,fieldType:he.fieldType,tempId:he.tempId}}),!1;if(!De.parentTempId||De.parentTempId===null||De.parentTempId==="")return!1;if(We){const st=De.parentTempId===We;return st&&console.log(`   Child match: ${De.name} (parentTempId: ${De.parentTempId}) matches PART ${he.name} (tempId: ${We})`),st}const Ve=De.parentTempId===yt&&!De.parentTempId?.includes("-parent");return Ve&&console.log(`   Child match by name: ${De.name} (parentTempId: ${De.parentTempId}) matches PART ${he.name} (name: ${yt})`),Ve}),Ke&&Xe.length===0&&ge.length>0){const De=ge.filter(ct=>!le(ct)),Ve=De.filter(ct=>ct.parentTempId),st=Ve.filter(ct=>ct.parentTempId===We);console.warn(` PART field ${he.name} (tempId: ${We}) has NO children. Debug info:`,{totalFields:ge.length,totalNonPartFields:De.length,fieldsWithParent:Ve.length,fieldsMatchingThisPart:st.length,fieldsWithParentDetails:Ve.map(ct=>({name:ct.name,fieldType:ct.fieldType,parentTempId:ct.parentTempId,expected:We,matches:ct.parentTempId===We,duplicateNames:ge.filter(dt=>!le(dt)&&dt.name===ct.name&&dt!==ct).map(dt=>({name:dt.name,parentTempId:dt.parentTempId,belongsTo:ge.find(Qt=>le(Qt)&&(Qt.tempId===dt.parentTempId||Qt.name===dt.parentTempId))?.name||"unknown"}))})),allFieldsInSection:fe.fields.map(ct=>({name:ct.name,fieldType:ct.fieldType,tempId:ct.tempId,parentTempId:ct.parentTempId,isPart:le(ct)}))}),st.length>0&&console.error(` CRITICAL: Found ${st.length} fields with parentTempId="${We}" but filter returned 0!`,{matchingFields:st,fieldTempId:We,fieldName:yt})}Xe.length>0?console.log(` PART field ${he.name} (tempId: ${We}, realIndex: ${Me}) has ${Xe.length} children:`,Xe.map(De=>({name:De.name,fieldType:De.fieldType,parentTempId:De.parentTempId,expectedParentTempId:We,matches:De.parentTempId===We}))):Ke&&console.log(` PART field ${he.name} (tempId: ${We}, realIndex: ${Me}) has NO children`)}const Je=!Ke&&he.parentTempId&&he.parentTempId!==null&&he.parentTempId!=="";Ke&&Je&&console.error(` CRITICAL BUG: PART field ${he.name} is marked as child! parentTempId: ${he.parentTempId}`,he);const Ye=Ke?!0:!Je,at=De=>{if(Je){De.preventDefault();return}if(D({sectionIndex:oe,fromIndex:Me,overIndex:Me,position:"above"}),Ke){const Ve=ge.filter(ct=>le(ct)?!1:We?ct.parentTempId===We:ct.parentTempId===yt&&!ct.parentTempId?.includes("-parent")),st=[he,...Ve];De.dataTransfer.setData("text/plain",JSON.stringify(st)),De.dataTransfer.effectAllowed="move"}else De.dataTransfer.setData("text/plain",JSON.stringify(he)),De.dataTransfer.effectAllowed="move"},me=De=>{if(L.sectionIndex!==oe||L.fromIndex===null)return;De.preventDefault(),De.stopPropagation();const Ve=De.currentTarget.getBoundingClientRect(),st=Ve.top+Ve.height/2,ct=De.clientY<st?"above":"below";let dt=Me;ct==="below"&&(dt=Me+1),(L.overIndex!==dt||L.position!==ct)&&D(Qt=>({...Qt,overIndex:dt,position:ct}))},xe=De=>{if(L.sectionIndex!==oe||L.fromIndex===null)return;De.preventDefault(),De.stopPropagation();const Ve=Math.max(0,Math.min(L.overIndex,fe.fields.length||0));Q(oe,L.fromIndex,Ve),D({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},Oe=L.sectionIndex===oe&&L.fromIndex===Me,ot=L.sectionIndex===oe&&L.overIndex===Me,tt=ot&&L.position==="above"?"drop-target-above":ot&&L.position==="below"?"drop-target-below":"",Qe=`${oe}-topLevel-${he.name}-${he.tempId||he.name||Me}`;return Ke&&console.log(` Key for PART field ${he.name}: ${Qe}`),a.jsxs("div",{className:`p-2 rounded border mb-2 field-card-item ${Ke?"bg-part part-field-top-level":""} ${Je?"field-child":""} ${Oe?"dragging":""} ${tt}`,"data-field-name":he.name,"data-field-type":he.fieldType,"data-is-part":Ke,"data-is-child":Je,"data-parent-temp-id":he.parentTempId||"","data-render-index":Me,"data-top-level-index":Ge!==null?Ge:-1,style:{marginLeft:Ke?"0px":Je?"1rem":"0px",cursor:Ye?"grab":"default",opacity:Oe?.5:Ye?1:.8,transition:"all 0.12s ease"},draggable:Ye,onDragStart:Ye?at:void 0,onDragOver:Ye?me:void 0,onDrop:Ye?xe:void 0,onDragEnd:()=>D({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsxs("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[he.label," ",Ke&&a.jsx("span",{className:"badge part-badge",children:"PART"})]}),a.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[he.name," (",he.fieldType,")",he.roleRequired?` - ${he.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[a.jsx(ie,{variant:"outline-primary",size:"sm",onClick:()=>te(oe,Me),disabled:s,title:"Edit Field",className:"text-primary border-primary",children:a.jsx(Br,{size:14})}),a.jsx(ie,{variant:"outline-danger",size:"sm",onClick:()=>{const De=[...l],Ve=De[oe].fields[Me];De[oe].fields=De[oe].fields.filter((st,ct)=>ct!==Me),c(De),Ve&&o(st=>{if(!st.some(dt=>le(dt)&&le(Ve)?dt.name===Ve.name:dt.parentTempId&&Ve.parentTempId?dt.name===Ve.name&&dt.parentTempId===Ve.parentTempId:dt.name===Ve.name&&!dt.parentTempId&&!Ve.parentTempId)){const dt={...Ve};return[...st,dt]}return st})},disabled:s,title:"Remove Field",className:"text-danger border-danger",children:a.jsx(nt,{size:14})})]})]}),a.jsx("div",{className:"d-grid",children:a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>e(he.name),disabled:s,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[a.jsx(Pl,{className:"me-1",size:14}),"Insert Field"]})}),Ke&&Xe.length>0&&a.jsx("div",{className:"mt-2 part-children",style:{borderLeft:"3px dashed rgba(13, 110, 253, 0.35)",marginLeft:"0.5rem",paddingLeft:"0.75rem"},"data-part-parent":he.name,"data-part-tempid":he.tempId,"data-part-render-index":Me,children:(console.log(` Rendering ${Xe.length} children for PART ${he.name} (tempId: ${he.tempId}, realIndex: ${Me}):`,Xe.map(De=>({name:De.name,fieldType:De.fieldType,parentTempId:De.parentTempId,isPart:le(De)}))),Xe.map(De=>{if(le(De))return console.error(` CRITICAL BUG: Attempted to render PART field ${De.name} (${De.fieldType}) as child of PART field ${he.name} (${he.fieldType})!`,{child:{name:De.name,fieldType:De.fieldType,tempId:De.tempId,parentTempId:De.parentTempId},parent:{name:he.name,fieldType:he.fieldType,tempId:he.tempId},childrenArray:Xe.map(ct=>({name:ct.name,fieldType:ct.fieldType,isPart:le(ct)}))}),null;console.log(`   Rendering child: ${De.name} (${De.fieldType}) inside PART ${he.name}`);const Ve=fe.fields.indexOf(De),st=`${oe}-child-${he.tempId||he.name}-${De.name}-${De.tempId||Ve}`;return console.log(`   Key for child ${De.name} of PART ${he.name}: ${st}`),a.jsxs("div",{className:"p-2 rounded border mb-2 field-card-item","data-child-parent":he.name,"data-child-parent-tempid":he.tempId,"data-child-name":De.name,style:{marginLeft:"0",cursor:"default",opacity:.8},draggable:!1,children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsx("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:De.label}),a.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[De.name," (",De.fieldType,")",De.roleRequired?` - ${De.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[a.jsx(ie,{variant:"outline-primary",size:"sm",onClick:()=>te(oe,Ve),disabled:s,title:"Edit Field",className:"text-primary border-primary",children:a.jsx(Br,{size:14})}),a.jsx(ie,{variant:"outline-danger",size:"sm",onClick:()=>{const ct=[...l],dt=ct[oe].fields[Ve];ct[oe].fields=ct[oe].fields.filter((Qt,tr)=>tr!==Ve),c(ct),dt&&o(Qt=>{if(!Qt.some(xr=>le(xr)&&le(dt)?xr.name===dt.name:xr.parentTempId&&dt.parentTempId?xr.name===dt.name&&xr.parentTempId===dt.parentTempId:xr.name===dt.name&&!xr.parentTempId&&!dt.parentTempId)){const xr={...dt};return[...Qt,xr]}return Qt})},disabled:s,title:"Remove Field",className:"text-danger border-danger",children:a.jsx(nt,{size:14})})]})]}),a.jsx("div",{className:"d-grid",children:a.jsxs(ie,{variant:"outline-primary",size:"sm",onClick:()=>e(De.name),disabled:s,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[a.jsx(Pl,{className:"me-1",size:14}),"Insert Field"]})})]},st)}))},`${oe}-part-children-${he.tempId||he.name}-${Me}`)]},Qe)};return console.log(` Rendering ${ue.length} topLevel fields for section ${oe}:`,ue.map(he=>({name:he.name,fieldType:he.fieldType,tempId:he.tempId,parentTempId:he.parentTempId}))),a.jsx(a.Fragment,{children:ue.map((he,Me)=>{const Ge=fe.fields.indexOf(he);return le(he)&&he.parentTempId&&console.error(` CRITICAL BUG: Rendering PART field ${he.name} with parentTempId ${he.parentTempId} as topLevel!`,he),console.log(` Rendering topLevel[${Me}]: ${he.name} (${he.fieldType}), tempId: ${he.tempId}, parentTempId: ${he.parentTempId}, isPart: ${le(he)}`),Le(he,Ge,Me)})})})():a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:"No fields in this section. Drag fields here."})})})]},oe))})]})}),a.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:a.jsxs("div",{className:"p-2",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[a.jsx("style",{children:`
              .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
              .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
              .part-children { border-left: 3px dashed rgba(13, 110, 253, 0.35); margin-left: 0.5rem; padding-left: 0.75rem; }
              /* CRITICAL: Force PART fields to have no margin - they are always top-level */
              .part-field-top-level { margin-left: 0 !important; padding-left: 0 !important; }
              .part-field-top-level::before { display: none !important; }
              /* Ensure children have proper indentation */
              .field-child { margin-left: 1rem !important; }
            `}),a.jsx("div",{className:"text-muted small mb-2",children:"Fields"}),i?.length?(()=>{const fe=[...i].sort((Ie,Le)=>(Ie.displayOrder||0)-(Le.displayOrder||0)),oe=Ie=>!!Ie.parentTempId,ge=fe.filter(Ie=>!oe(Ie)),ue=Ie=>{const Le=le(Ie),he=U(Ie),Me=fe.filter(We=>We.parentTempId===he),Ke=!(!Le&&Ie.parentTempId&&Ie.parentTempId!==null&&Ie.parentTempId!=="");return a.jsxs("div",{className:"mb-2",children:[a.jsx(W,{className:`mb-2 ${Le?"bg-part":""}`,draggable:Ke,onDragStart:Ke?We=>Se(We,Ie):void 0,style:{cursor:Ke?"grab":"default",opacity:Ke?1:.8},children:a.jsxs(W.Body,{className:"py-2 px-2",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-2",children:a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsxs("div",{className:"fw-bold",style:{fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[Ie.label," ",Le&&a.jsx("span",{className:"badge part-badge ms-1",children:"PART"})]}),a.jsxs("div",{className:"text-muted",style:{fontSize:"0.8rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[Ie.name," (",Ie.fieldType,")"]})]})}),a.jsx("div",{className:"d-grid",children:a.jsx(ie,{size:"sm",variant:"outline-primary",onClick:()=>e(Ie.name),disabled:s,className:"insert-field-btn",children:"Insert Field"})})]})}),Le&&Me.length>0&&a.jsx("div",{className:"part-children",children:Me.map(We=>ue(We))})]},Ie.name)};return ge.map(Ie=>ue(Ie))})():a.jsx(Re,{variant:"light",className:"m-0",children:"No extracted fields."})]})})]}),a.jsxs(ce,{show:p,onHide:H,centered:!0,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Add New Section"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"Display label",value:N.label,onChange:fe=>C(oe=>({...oe,label:fe.target.value})),required:!0})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Edit By"}),a.jsx(A.Select,{value:N.editBy,onChange:fe=>{const oe=fe.target.value;C(ge=>({...ge,editBy:oe,roleInSubject:oe==="TRAINEE"?"":ge.roleInSubject}))},children:T.map(fe=>a.jsx("option",{value:fe,children:fe},fe))})]})}),N.editBy==="TRAINER"&&a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Role In Subject"}),a.jsxs(A.Select,{value:N.roleInSubject||"ASSESSMENT_REVIEWER",onChange:fe=>C(oe=>({...oe,roleInSubject:fe.target.value})),style:{minWidth:"200px"},children:[a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),a.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{className:"d-flex flex-row align-items-center gap-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(A.Check,{type:"checkbox",checked:N.isSubmittable,onChange:fe=>C(oe=>({...oe,isSubmittable:fe.target.checked})),id:"section-submittable"}),a.jsx(A.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(A.Check,{type:"checkbox",checked:N.isToggleDependent,onChange:fe=>C(oe=>({...oe,isToggleDependent:fe.target.checked})),id:"section-toggle-dependent"}),a.jsx(A.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:H,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:F,children:"Save Section"})]})]}),a.jsxs(ce,{show:h,onHide:B,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Edit Field"})}),a.jsx(ce.Body,{style:{maxHeight:"400px",overflowY:"auto"},children:E&&a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Editing field in section: ",a.jsx("strong",{children:b!==null?l[b]?.label:"N/A"})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Crew Communication",value:E.label||"",onChange:fe=>w(oe=>({...oe,label:fe.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:E.fieldType==="PART"?"e.g., Assessment_Items":E.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:E.name||"",onChange:fe=>w(oe=>({...oe,name:fe.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:E.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':E.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:E.fieldType||"TEXT",onChange:fe=>w(oe=>({...oe,fieldType:fe.target.value})),required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Role Required"}),a.jsx(A.Control,{type:"text",value:b!==null&&l[b]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"}}),a.jsx(A.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Parent Template ID"}),a.jsx(A.Control,{type:"text",placeholder:"Leave empty for root level",value:E.parentTempId||"",onChange:fe=>w(oe=>({...oe,parentTempId:fe.target.value||null}))})]})}),E.tempId&&a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Template ID (read-only)"}),a.jsx(A.Control,{type:"text",value:E.tempId,readOnly:!0,disabled:!0}),a.jsx(A.Text,{className:"text-muted",children:"This is the unique identifier for PART fields. It cannot be changed."})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:B,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:we,children:"Save Changes"})]})]})]})},Ih=`${jo.BASE_URL}/media/docs/onlyoffice/callback`,Joe=v.forwardRef(({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,showMergeFields:s=!0,importType:n="",className:i="",initialSections:o=null,onHasUnsavedChangesChange:l,onDraftSaved:c},u)=>{const[d,m]=v.useState(!0),[f,h]=v.useState(null),[x,p]=v.useState(!1),[g,b]=v.useState([]),[y]=v.useState(!0),[j,S]=v.useState(!1),E=v.useRef(!1),w=v.useRef(!1),N=v.useRef(null),C=v.useRef(null),T=v.useRef(null);v.useImperativeHandle(u,()=>({downloadAs:(oe="docx")=>{if(N.current&&typeof N.current.downloadAs=="function")N.current.downloadAs(oe);else throw new Error("Editor is not ready or downloadAs method is not available")},save:()=>{if(N.current&&typeof N.current.save=="function")N.current.save();else throw new Error("Editor is not ready or save method is not available")},saveAndDownload:async(oe="docx")=>{if(!N.current)throw new Error("Editor is not ready");if(typeof N.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),N.current.save(),await new Promise(ge=>setTimeout(ge,1e3)),console.log(" save() completed")),typeof N.current.downloadAs=="function")console.log(" Step 2: Calling downloadAs() to get document URL..."),N.current.downloadAs(oe);else throw new Error("downloadAs method is not available")},buildAndSubmitDraftTemplate:async oe=>{if(Se.current&&typeof Se.current.buildAndSubmitDraftTemplate=="function")return await Se.current.buildAndSubmitDraftTemplate(oe);throw new Error("buildAndSubmitDraftTemplate function is not available")}}),[]);const _=v.useRef(l),k=v.useRef(c);v.useEffect(()=>{_.current=l},[l]),v.useEffect(()=>{k.current=c},[c]),v.useEffect(()=>{E.current=j},[j]);const I=v.useRef(!1),L=v.useRef(null),D=v.useRef(new Map);v.useEffect(()=>{const oe=setTimeout(()=>{_.current&&_.current(j)},0);return()=>clearTimeout(oe)},[j]);const[M,q]=v.useState(!1),[Z,Q]=v.useState(null),[U,le]=v.useState([]),Se=v.useRef(null),P=[{label:"Trainee's Full Name",variable:"{trainee_name}"},{label:"Trainee's Eid",variable:"{trainee_eid}"},{label:"Trainee's Nation",variable:"{trainee_nationality}"},{label:"Trainee's Batch Name",variable:"{training_batch}"},{label:"Course's Name",variable:"{course_name}"},{label:"Course's Code",variable:"{course_code}"},{label:"Subject's Name",variable:"{subject_name}"},{label:"Subject's Code",variable:"{subject_code}"},{label:"Assessing date",variable:"{assessment_date}"},{label:"Assessment Location",variable:"{assessment_venue}"},{label:"Instructor's Full Name",variable:"{trainer_name}"},{label:"Trainer's Eid",variable:"{trainer_eid}"},{label:"Template Name",variable:"{template_name}"}],G=v.useCallback(()=>{if(w.current=!1,N.current)try{typeof N.current.destroy=="function"&&N.current.destroy()}catch(oe){console.warn("Error destroying editor:",oe)}},[]);v.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const K="bd9aaaaddaf94061b51e976a8fd335ce",O=async oe=>{try{const ue=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Ie=btoa(JSON.stringify(oe)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Le=`${ue}.${Ie}`,he=new TextEncoder,Me=await crypto.subtle.importKey("raw",he.encode(K),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Ge=await crypto.subtle.sign("HMAC",Me,he.encode(Le)),Ke=btoa(String.fromCharCode(...new Uint8Array(Ge))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),We=`${ue}.${Ie}.${Ke}`;return console.log(" Generated JWT Token (Hardcoded):",We),We}catch(ge){return console.error("Error generating JWT token:",ge),null}};v.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),m(!1);return}if(w.current){console.log(" Editor already initialized, skipping...");return}return w.current=!0,(async()=>{try{let ge=0;const ue=10;await new Promise((Xe,Je)=>{const Ye=()=>{typeof window.DocsAPI<"u"?Xe():ge<ue?(ge++,console.log(` Waiting for OnlyOffice API... (${ge}/${ue})`),setTimeout(Ye,500)):Je(new Error("OnlyOffice API failed to load after 5 seconds"))};Ye()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const Le=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;T.current=Le,console.log(" Generated documentKey for callback:",Le);const Me=await O({document:{key:Le,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"},callbackUrl:Ih}}),Ge=!0;Ge&&console.log(" Adding callbackUrl:",Ih);const Ke={document:{fileType:"docx",key:Le,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},callbackUrl:Ge?Ih:void 0,mode:"edit"},token:Me,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),p(!0)},onDocumentReady:()=>{console.log(" Document is loaded"),S(!0),console.log(" Set hasUnsavedChanges = true (document ready, user can edit)")},onError:Xe=>{console.error(" OnlyOffice Error:",Xe),console.error(" Error details:",{errorCode:Xe.data?.errorCode,errorDescription:Xe.data?.errorDescription,error:Xe.data?.error,fullEvent:Xe}),ne.error("Error loading document: "+(Xe.data?.errorDescription||Xe.data?.error||"Unknown error"))},onDocumentStateChange:Xe=>{if(console.log(" Document state changed:",Xe),console.log(" Event data:",Xe.data),Xe.data!==void 0&&Xe.data!==null){const Je=Xe.data;console.log(" Document state value:",Je),Je===1?(console.log(" Marking document as having unsaved changes"),S(!0)):(Je===0||Je===3)&&console.log(" Document state: ready/saved (state:",Je,")")}},onInfo:Xe=>{console.log(" OnlyOffice opened in mode:",Xe.data?.mode)},onDownloadAs:async Xe=>{try{const Je=Xe?.data||{};console.log(""),console.log(" OnlyOffice Event: onDownloadAs"),console.log(""),console.log(" Event data received:",JSON.stringify(Je,null,2));const Ye=Je.url||Je.downloadUrl||Je.fileUrl||(Array.isArray(Je.files)?Je.files[0]?.url:void 0)||Je.file&&Je.file.url;if(Ye){if(L.current){console.log(" This is a Submit flow - resolving Promise with URL");const tt=T.current,Qe=Ye.match(/doc-([^_/]+)/),De=Qe?Qe[1]:null;if(tt&&De){const st=tt,ct=`doc-${De}`;st!==ct&&(console.log(" Warning: URL documentKey does not match current, but resolving anyway (resolver exists)"),console.log(`   Current: ${st}, URL: ${ct}`),console.log("   This can happen during hot reload - resolving anyway because resolver exists"))}const Ve=L.current;L.current=null,Ve.resolve(Ye),S(!1);return}if(I.current){console.log(" onDownloadAs event during Submit but no resolver - ignoring (likely from old instance)");return}try{const tt=sessionStorage.getItem("onlyoffice_submitting")==="true",Qe=sessionStorage.getItem("onlyoffice_submit_docKey");if(tt&&Qe){let De=null;const Ve=Ye.match(/[?&]shardkey=([^&]+)/);if(Ve)De=Ve[1];else{const st=Ye.match(/doc-([^_/]+)/);st&&(De=`doc-${st[1]}`)}if(De&&Qe===De){console.log(" onDownloadAs: Ignoring Draft save - Submit in progress (sessionStorage check)"),console.log(`   Submit docKey: ${Qe}, URL docKey: ${De}`);return}}}catch(tt){console.warn(" Error checking sessionStorage in onDownloadAs:",tt)}const at=T.current,me=Ye.match(/doc-([^_/]+)/),xe=me?me[1]:null;if(at&&xe){const tt=at,Qe=`doc-${xe}`;if(tt!==Qe){console.log(" onDownloadAs event ignored - URL from old documentKey instance (Draft flow)"),console.log(`   Current: ${tt}, URL: ${Qe}`);return}}const Oe=Date.now(),ot=D.current.get(Ye);if(ot&&Oe-ot<2e3){console.log(" Duplicate onDownloadAs event ignored (debounced):",Ye.substring(0,50)+"...");return}D.current.set(Ye,Oe);for(const[tt,Qe]of D.current.entries())Oe-Qe>5e3&&D.current.delete(tt);console.log(" Download URL received:",Ye),console.log(" This is a Draft save - calling onDraftSaved callback"),k.current&&typeof k.current=="function"&&k.current(Ye),S(!1)}else if(console.warn(" onDownloadAs received but no URL found in payload"),I.current&&L.current){const at=L.current;L.current=null,at.reject(new Error("No URL found in onDownloadAs event"))}else I.current||ne.warning("Draft saved but URL not found")}catch(Je){console.error(" Error in onDownloadAs handler:",Je),ne.error("Error processing draft save")}},onRequestSaveAs:async Xe=>{try{const Je=Xe?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSaveAs"),console.log(""),console.log(" Event data received:",JSON.stringify(Je,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server"),S(!1);const Ye=Je.url||Je.downloadUrl||Je.fileUrl||(Array.isArray(Je.files)?Je.files[0]?.url:void 0)||Je.file&&Je.file.url;console.log(" Extracted temporary DOCX URL:",Ye),Ye||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(Je,null,2))),C.current&&(Ye?C.current.resolve(Ye):C.current.reject(new Error("onRequestSaveAs event received but no URL found")),C.current=null),console.log("")}catch(Je){console.error(" Error in onRequestSaveAs handler:",Je),C.current&&(C.current.reject(Je),C.current=null)}},onRequestSave:Xe=>{try{const Je=Xe?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSave"),console.log(""),console.log(" Event data received:",JSON.stringify(Je,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const Ye=Je.url||Je.downloadUrl||Je.fileUrl;Ye&&C.current&&(console.log(" Using URL from onRequestSave:",Ye),C.current.resolve(Ye),C.current=null),console.log("")}catch(Je){console.error(" Error in onRequestSave handler:",Je)}}}},We=new window.DocsAPI.DocEditor("onlyoffice-editor",Ke);h(We),N.current=We,m(!1);const yt=Xe=>{Xe.data&&Xe.data.type==="insertText"&&console.log(" Received insert text message:",Xe.data)};return window.addEventListener("message",yt,{passive:!0}),()=>{window.removeEventListener("message",yt)}}catch(ge){console.error("Error initializing OnlyOffice editor:",ge),ne.error("Failed to initialize editor"),m(!1)}})(),G},[e,t,G]);const F=oe=>{if(f&&x)try{if(typeof f.createConnector=="function")try{const ge=f.createConnector();if(typeof f.asc_enableKeyEvents=="function")try{f.asc_enableKeyEvents(!0)}catch{}if(ge&&ge.isConnected)try{Asc.scope.__templateText=typeof oe=="string"&&oe.includes("{")?oe:`{${oe}}`,ge.callCommand(function(){try{const ue=Api.GetDocument();let Ie=null;try{const he=ue.GetCurrentSentence(),Me=he&&typeof he=="string"?he.trim():"";if(Me&&Me.length>0)try{const Ge=ue.Search(Me);if(Ge&&Ge.length>0&&Ge.length<10){const Ke=Ge[0];try{const We=Ke.GetParagraph(0);try{Ie=Ke.GetTextPr()}catch{try{const yt=We.GetElementsCount();if(yt>0){const Xe=We.GetElement(yt-1);Xe&&Xe.GetTextPr&&(Ie=Xe.GetTextPr())}}catch{}}}catch{}}}catch{}}catch{}const Le=Api.CreateParagraph();if(Ie){const he=Api.CreateRun();he.AddText(Asc.scope.__templateText),he.SetTextPr(Ie),Le.AddElement(he)}else{const he=Api.CreateTextPr();he.SetBold(!1);const Me=Api.CreateRun();Me.AddText(Asc.scope.__templateText),Me.SetTextPr(he),Le.AddElement(Me)}ue.InsertContent([Le],!0)}catch{const ue=Api.GetDocument(),Ie=Api.CreateParagraph();Ie.AddText(Asc.scope.__templateText),ue.InsertContent([Ie],!0)}},function(){},function(ue){console.error(" Insert field error:",ue),ne.error("Failed to insert field: "+(ue?.message||"Unknown error"))});return}catch{ne.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(ge){console.error("Error inserting field:",ge),ne.error("Failed to insert field: "+ge.message)}else f?x||ne.warning("Editor is still loading, please wait..."):ne.warning("Editor not initialized yet")},H=v.useCallback(()=>T.current,[]),Y=oe=>{if(!(!oe||!oe.variable))if(Q(oe),Se.current&&typeof Se.current.getSections=="function"){const ge=Se.current.getSections();ge&&ge.length>0?(le(ge),q(!0)):ne.warning("Please create a section first before adding system fields")}else ne.warning("Custom Fields Panel is not ready. Please wait...")},te=oe=>{if(!(!Z||oe===null||oe<0))if(Se.current&&typeof Se.current.addSystemField=="function"){const ge={label:Z.label,fieldName:Z.variable.replace(/[{}]/g,""),fieldType:"TEXT",roleRequired:"TRAINER",displayOrder:1};Se.current.addSystemField(oe,ge)&&(q(!1),Q(null),ne.success(`Added ${Z.label} to section`))}else ne.error("Failed to add field to section")},pe=v.useCallback(async()=>{try{if(!N.current||!x)throw new Error("Editor not ready");const oe=T.current;if(!oe)throw new Error("Document key not found");I.current=!0;try{sessionStorage.setItem("onlyoffice_submitting","true"),sessionStorage.setItem("onlyoffice_submit_docKey",oe),console.log(" Submit state saved to sessionStorage")}catch(ue){console.warn(" Failed to set sessionStorage:",ue)}if(console.log(" Starting callback flow (Submit)..."),console.log(` DocumentKey: ${oe}`),console.log(` Callback URL: ${jo.BASE_URL}/media/docs/onlyoffice/callback`),console.log(" Step 1: Saving all changes first (auto Ctrl+S)..."),typeof N.current.save=="function")try{N.current.save(),await new Promise(ue=>setTimeout(ue,2e3)),console.log(" All changes saved successfully")}catch(ue){console.warn(" save() failed:",ue)}console.log(" Step 2: Triggering downloadAs() and waiting for URL from event..."),L.current=null;const ge=new Promise((ue,Ie)=>{L.current={resolve:ue,reject:Ie},setTimeout(()=>{L.current&&(L.current.reject(new Error("Timeout waiting for download URL")),L.current=null)},15e3)});if(typeof N.current.downloadAs=="function")try{N.current.downloadAs("docx"),console.log(" downloadAs() triggered - waiting for URL from onDownloadAs event...")}catch(ue){console.warn(" downloadAs() failed:",ue),L.current&&(L.current.reject(new Error("Failed to trigger downloadAs()")),L.current=null),I.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(Ie){console.warn(" Failed to clear sessionStorage:",Ie)}throw new Error("Failed to trigger downloadAs()")}else{L.current&&(L.current.reject(new Error("downloadAs method is not available")),L.current=null),I.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(ue){console.warn(" Failed to clear sessionStorage:",ue)}throw new Error("downloadAs method is not available")}console.log(" Waiting for URL from onDownloadAs event..."),ne.info("Waiting for document URL...");try{const ue=await ge;if(ue){console.log(" URL received from onDownloadAs event:",ue),ne.success("Document processed successfully!"),S(!1),I.current=!1,L.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage")}catch(Ie){console.warn(" Failed to clear sessionStorage:",Ie)}return ue}else{console.warn(" No URL received from onDownloadAs event"),ne.warning("Could not get document URL"),I.current=!1,L.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(Ie){console.warn(" Failed to clear sessionStorage:",Ie)}return null}}catch(ue){console.error(" Error waiting for URL from onDownloadAs:",ue),ne.error(`Failed to get document URL: ${ue.message}`),I.current=!1,L.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (error)")}catch(Ie){console.warn(" Failed to clear sessionStorage:",Ie)}throw ue}}catch(oe){console.error(" Force save and poll failed:",oe),ne.error(`Failed: ${oe.message}`),I.current=!1,L.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (outer catch)")}catch(ge){console.warn(" Failed to clear sessionStorage:",ge)}throw oe}},[x]),we=v.useCallback(()=>new Promise((oe,ge)=>{try{if(!N.current){ge(new Error("Editor not initialized"));return}if(C.current={resolve:oe,reject:ge},typeof N.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{N.current.downloadDocument()}catch(ue){console.warn("downloadDocument() failed, trying downloadAs()...",ue)}}if(typeof N.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{N.current.downloadAs("docx")}catch(ue){console.warn("downloadAs() failed:",ue)}}if(typeof N.current.save=="function"){console.log(" Attempting export via save()...");try{N.current.save()}catch(ue){console.warn("save() failed:",ue)}}setTimeout(()=>{if(C.current){const ue=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");C.current.reject(ue),C.current=null}},2e4)}catch(ue){C.current?(C.current.reject(ue),C.current=null):ge(ue)}}),[]),B=v.useCallback(async()=>{try{if(!N.current||!x)throw new Error("Editor not ready");ne.info("Exporting document...");const oe=await we();if(!oe)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",oe),ne.info("Downloading file...");const ge=await fetch(oe);if(!ge.ok)throw new Error(`Failed to fetch file: ${ge.statusText}`);const ue=await ge.blob();console.log(" Downloaded blob:",ue.size,"bytes");const Ie=t.endsWith(".docx")?t:`${t}.docx`,Le=new File([ue],Ie,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});ne.info("Uploading to S3...");const he=wo.getDocsType(Ie)||"tem",Me=await wo.uploadDocument(Le,he);console.log(" Upload API response:",Me);let Ge=null;if(Me?.data?.[0]?.url?(Ge=Me.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",Ge)):Me?.data?.url?(Ge=Me.data.url,console.log(" Found S3 URL in uploadResult.data.url:",Ge)):Me?.url?(Ge=Me.url,console.log(" Found S3 URL in uploadResult.url:",Ge)):Me?.fileUrl?(Ge=Me.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",Ge)):Me?.path&&(Ge=Me.path,console.log(" Found S3 URL in uploadResult.path:",Ge)),!Ge)throw console.error(" Upload response structure:",JSON.stringify(Me,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",Ge),console.log(" Full S3 URL:",Ge),ne.success(`Document uploaded successfully!
URL: ${Ge}`),Ge}catch(oe){throw console.error(" Export and upload failed:",oe),ne.error(`Failed: ${oe.message}`),oe}},[we,t,x]);if(d)return a.jsx(W,{className:`border-neutral-200 shadow-sm ${i}`,children:a.jsx(W.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),a.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:["Content:"," ",e?"Available":"Not available"]})]})})});if(!e)return a.jsx(W,{className:`border-neutral-200 shadow-sm ${i}`,children:a.jsx(W.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:a.jsx("div",{className:"text-center",children:a.jsxs(Re,{variant:"warning",children:[a.jsx("strong",{children:"No Document URL"}),a.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const Be=(oe,ge)=>{Array.isArray(oe)?(b(oe),ge?.silent||ne.success("Fields updated successfully")):(b(ue=>[...ue,oe]),ge?.silent||ne.success(`Added field: ${oe.label}`))},fe=oe=>{b(ge=>ge.filter((ue,Ie)=>Ie!==oe)),ne.success("Field removed")};return a.jsxs("div",{className:`onlyoffice-form-editor ${i}`,children:[a.jsx("div",{className:"p-0",children:a.jsxs(de,{className:"g-0",style:{minHeight:"90vh"},children:[a.jsx(z,{xs:12,md:s&&(n==="File without fields"&&y||n!=="File without fields")?9:12,className:"editor-col",style:{order:1},children:a.jsxs("div",{className:"p-3 editor-wrapper",style:{height:"90vh"},children:[a.jsx("div",{className:"d-flex justify-content-end align-items-center mb-2",children:a.jsxs(Mt,{children:[a.jsx(Mt.Toggle,{variant:"outline-primary",size:"sm",id:"system-mapped-field-dropdown",children:"System Mapped Field"}),a.jsx(Mt.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:P.map((oe,ge)=>a.jsx(Mt.Item,{onClick:()=>Y(oe),children:oe.label},ge))})]})}),a.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),s&&n!=="File without fields"&&a.jsx(z,{md:3,className:"border-start",style:{overflow:"hidden"},children:a.jsx("div",{style:{height:"90vh",overflowY:"auto"},children:a.jsx(Xoe,{onInsertField:F,exportEditedDoc:we,initialUrl:e,readOnly:r,className:"h-100"})})}),s&&n==="File without fields"&&y&&a.jsx(z,{xs:12,md:3,className:"border-start border-md-start custom-fields-col",style:{order:2},children:a.jsx("div",{className:"custom-fields-wrapper",style:{height:"90vh",overflowY:"auto",overflowX:"hidden"},children:a.jsx(Yoe,{customFields:g,onAddField:Be,onRemoveField:fe,onInsertField:F,initialSections:o,exportEditedDoc:we,exportAndUploadEditedDoc:B,forceSaveAndPoll:pe,getDocumentKey:H,addSystemFieldToSectionRef:Se,readOnly:r,className:"h-100"})})})]})}),a.jsxs(ce,{show:M,onShow:()=>{if(Se.current&&typeof Se.current.getSections=="function"){const oe=Se.current.getSections();le(oe||[])}},onHide:()=>{q(!1),Q(null)},centered:!0,className:"system-field-modal",children:[a.jsx(ce.Header,{closeButton:!0,className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:a.jsx(ce.Title,{className:"text-white mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Select Section"})}),a.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[Z&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral-200)"},children:[a.jsx("p",{className:"mb-1 text-primary-custom",style:{fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Field to add:"}),a.jsx("p",{className:"mb-0",style:{fontSize:"1rem",fontWeight:500,color:"var(--bs-dark)"},children:Z.label}),a.jsx("code",{className:"d-inline-block mt-1 px-2 py-1 rounded",style:{fontSize:"0.875rem",backgroundColor:"var(--bs-neutral-100)",color:"var(--bs-primary)",border:"1px solid var(--bs-neutral-300)"},children:Z.variable})]}),a.jsx("p",{className:"mb-3",style:{fontSize:"0.95rem",color:"var(--bs-dark)",fontWeight:500},children:"Choose a section to add this field:"}),U.length>0?a.jsx("div",{className:"d-grid gap-2",style:{maxHeight:"400px",overflowY:"auto"},children:U.map((oe,ge)=>a.jsx("button",{type:"button",className:"section-select-btn",onClick:()=>te(ge),style:{padding:"1rem 1.25rem",border:"2px solid var(--bs-neutral-200)",borderRadius:"0.5rem",backgroundColor:"var(--bs-light)",textAlign:"left",transition:"all 0.3s ease",cursor:"pointer",width:"100%"},onMouseEnter:ue=>{ue.currentTarget.style.borderColor="var(--bs-primary)",ue.currentTarget.style.backgroundColor="rgba(27, 60, 83, 0.05)",ue.currentTarget.style.transform="translateY(-2px)",ue.currentTarget.style.boxShadow="0 4px 12px rgba(27, 60, 83, 0.15)"},onMouseLeave:ue=>{ue.currentTarget.style.borderColor="var(--bs-neutral-200)",ue.currentTarget.style.backgroundColor="var(--bs-light)",ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="none"},children:a.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{className:"mb-1",style:{fontSize:"1rem",fontWeight:600,color:"var(--bs-primary)"},children:oe.label||oe.name}),a.jsx("div",{className:"d-flex align-items-center gap-2 mt-2",style:{fontSize:"0.875rem"},children:a.jsx("span",{className:"badge rounded-pill px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",color:"white",fontSize:"0.75rem",fontWeight:500},children:oe.editBy||"TRAINER"})})]}),a.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minWidth:"60px",height:"60px",borderRadius:"0.375rem",backgroundColor:"var(--bs-primary)",color:"white",fontSize:"1.25rem",fontWeight:700},children:oe.fields?.length||0})]})},ge))}):a.jsxs(Re,{variant:"warning",className:"mb-0",style:{backgroundColor:"#fff3cd",borderColor:"#ffc107",color:"#856404",borderRadius:"0.5rem",padding:"1rem"},children:[a.jsx("strong",{children:"No sections available."})," Please create a section first."]})]}),a.jsx(ce.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:a.jsx(ie,{variant:"secondary",onClick:()=>{q(!1),Q(null)},style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:oe=>{oe.currentTarget.style.backgroundColor="#3a5a6f",oe.currentTarget.style.borderColor="#3a5a6f",oe.currentTarget.style.transform="translateY(-1px)",oe.currentTarget.style.boxShadow="0 4px 8px rgba(69, 104, 130, 0.3)"},onMouseLeave:oe=>{oe.currentTarget.style.backgroundColor="var(--bs-secondary)",oe.currentTarget.style.borderColor="var(--bs-secondary)",oe.currentTarget.style.transform="translateY(0)",oe.currentTarget.style.boxShadow="none"},children:"Cancel"})})]})]})}),Zoe=()=>{const e=it(),t=Gn(),[r,s]=v.useState(""),[n,i]=v.useState("Untitled Document"),[o,l]=v.useState(""),[c,u]=v.useState(null),[d,m]=v.useState(!1),[f,h]=v.useState({name:"",description:"",departmentId:""}),[x,p]=v.useState([]),[g,b]=v.useState(!1),[y,j]=v.useState(!1),[S,E]=v.useState(!1),[w,N]=v.useState(!1),C=v.useRef(null);v.useEffect(()=>{console.log(" hasUnsavedChanges changed:",y)},[y]);const[T,_]=v.useState(null);v.useEffect(()=>{if(t.state){const{content:U,documentUrl:le,fileName:Se,importType:P,templateInfo:G,initialSections:K}=t.state,O=le||U||"";s(O),i(Se||"Untitled Document"),l(P||""),u(G||null),K&&Array.isArray(K)&&(_(K),console.log(" FormEditorPage received initialSections:",K)),G&&h({name:G.name||"",description:G.description||"",departmentId:G.departmentId||""}),console.log(" FormEditorPage received:",{documentUrl:le,content:U,fileName:Se,templateInfo:G,initialSections:K,finalContent:O})}},[t.state]),v.useEffect(()=>{d&&k()},[d]);const k=async()=>{try{b(!0);const U=await kt.getDepartments(),le=U.departments||U.data||[];p(le)}catch(U){console.error("Error loading departments:",U),ne.error("Failed to load departments"),p([])}finally{b(!1)}},I=()=>{c&&h({name:c.name||"",description:c.description||"",departmentId:c.departmentId||""}),m(!0)},L=()=>{m(!1)},D=()=>{if(!f.name||!f.description||!f.departmentId){ne.error("Please fill in all required fields");return}const U={...c,name:f.name,description:f.description,departmentId:f.departmentId};u(U);try{const le=localStorage.getItem("templateInfo");if(le){const P={...JSON.parse(le),name:f.name,description:f.description,departmentId:f.departmentId};localStorage.setItem("templateInfo",JSON.stringify(P))}}catch(le){console.error("Error updating localStorage:",le)}ne.success("Template information updated successfully"),m(!1)},M=()=>{console.log(" Back button clicked, hasUnsavedChanges:",y),y?(console.log(" Showing discard modal"),E(!0)):(console.log(" No unsaved changes, navigating back"),e("/admin/forms"))},q=()=>{E(!1),j(!1),e("/admin/forms")},Z=()=>{E(!1)},Q=async()=>{if(!C.current){ne.warning("Editor is not ready yet. Please wait...");return}N(!0),ne.info("Saving draft...");try{typeof C.current.saveAndDownload=="function"?await C.current.saveAndDownload("docx"):(typeof C.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),C.current.save(),await new Promise(U=>setTimeout(U,1e3))),typeof C.current.downloadAs=="function"&&(console.log(" Step 2: Calling downloadAs() to get document URL..."),C.current.downloadAs("docx")))}catch(U){console.error(" Error saving draft:",U),ne.error("Failed to save draft: "+(U.message||"Unknown error")),N(!1)}};return a.jsx(hr,{permission:Te.TEMPLATES.CREATE,fallback:a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx("h4",{children:"Access Denied"}),a.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:a.jsxs(_e,{fluid:!0,className:"py-4 form-editor-page form-component",children:[a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"border-neutral-200 form-editor-header bg-primary",children:a.jsxs(de,{className:"align-items-center",children:[a.jsx(z,{xs:12,md:8,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"outline-light",onClick:M,className:"me-3",size:"sm",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)"},onMouseEnter:U=>{U.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",U.currentTarget.style.borderColor="#fff"},onMouseLeave:U=>{U.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",U.currentTarget.style.borderColor="#fff"},children:a.jsx(_t,{size:16})}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"mb-0 text-white",children:c?.name||n}),o&&a.jsxs("small",{className:"text-white",style:{opacity:.9},children:["Import Type: ",o]})]}),c&&a.jsx(ie,{variant:"outline-light",size:"sm",onClick:I,className:"ms-2",title:"Edit Template Information",children:a.jsx(Br,{size:14})})]})]})}),a.jsx(z,{xs:12,md:4,className:"d-flex justify-content-end align-items-center mt-2 mt-md-0",children:a.jsxs(ie,{variant:"outline-light",size:"sm",onClick:Q,disabled:w,className:"d-flex align-items-center gap-2",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:U=>{w||(U.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",U.currentTarget.style.borderColor="#fff")},onMouseLeave:U=>{w||(U.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",U.currentTarget.style.borderColor="#fff")},children:[a.jsx(ts,{size:16}),w?"Saving...":"Save Draft"]})})]})}),a.jsx(W.Body,{className:"p-0",children:a.jsx(Joe,{ref:C,initialContent:r,fileName:n,showImportInfo:!!o,importType:o,initialSections:T,onHasUnsavedChangesChange:j,onDraftSaved:async U=>{try{console.log(" onDraftSaved called - checking sessionStorage...");const le=sessionStorage.getItem("onlyoffice_submitting")==="true",Se=sessionStorage.getItem("onlyoffice_submit_docKey");if(console.log(" SessionStorage check:",{isSubmitting:le,submitDocKey:Se,draftUrl:U.substring(0,100)+"..."}),le&&Se){let P=null;const G=U.match(/[?&]shardkey=([^&]+)/);if(G)P=G[1],console.log(" Extracted docKey from shardkey:",P);else{const K=U.match(/doc-([^_/]+)/);K&&(P=`doc-${K[1]}`,console.log(" Extracted docKey from path:",P))}if(console.log(" Comparing:",{submitDocKey:Se,urlDocKey:P,match:P&&Se===P}),P&&Se===P){console.log(" Draft save ignored - Submit in progress"),console.log(`   Submit docKey: ${Se}, URL docKey: ${P}`),N(!1);return}else console.log(" Submit in progress but documentKey mismatch - treating as Draft anyway"),console.log(`   Submit docKey: ${Se}, URL docKey: ${P}`)}try{console.log(" Processing draft save - uploading to S3 and building template..."),C.current&&typeof C.current.buildAndSubmitDraftTemplate=="function"?(await C.current.buildAndSubmitDraftTemplate(U),console.log(" Draft template saved successfully!")):(console.warn(" buildAndSubmitDraftTemplate function not available"),ne.warning("Draft URL saved but template not created"))}catch(P){console.error(" Error building/submitting draft template:",P),ne.error("Failed to save draft template: "+(P.message||"Unknown error"))}finally{N(!1)}}catch(le){console.error(" Error in onDraftSaved callback:",le),N(!1),ne.error("Error processing draft save")}}})})]}),a.jsxs(ce,{show:S,onHide:Z,centered:!0,children:[a.jsx(ce.Header,{className:"bg-warning text-dark border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:a.jsx(ce.Title,{className:"text-dark mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Discard Changes?"})}),a.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[a.jsx("p",{className:"mb-0",style:{fontSize:"1rem",color:"var(--bs-dark)"},children:"You have unsaved changes in the document. Are you sure you want to leave without saving?"}),a.jsx("p",{className:"mt-2 mb-0 text-muted",style:{fontSize:"0.875rem"},children:"All unsaved changes will be lost."})]}),a.jsxs(ce.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:[a.jsx(ie,{variant:"secondary",onClick:Z,style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Cancel"}),a.jsx(ie,{variant:"warning",onClick:q,style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#212529",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Discard Changes"})]})]}),a.jsxs(ce,{show:d,onHide:L,size:"lg",centered:!0,children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ce.Title,{className:"d-flex align-items-center",children:[a.jsx(Br,{className:"me-2",size:20}),"Edit Template Information"]}),a.jsx(ie,{variant:"link",onClick:L,className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:""})]}),a.jsx(ce.Body,{className:"p-4",children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Template Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:f.name,onChange:U=>h(le=>({...le,name:U.target.value})),required:!0})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Description ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:f.description,onChange:U=>h(le=>({...le,description:U.target.value})),required:!0})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Department ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:f.departmentId,onChange:U=>h(le=>({...le,departmentId:U.target.value})),required:!0,disabled:g,children:[a.jsx("option",{value:"",children:"Select Department"}),x.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]}),g&&a.jsx(A.Text,{className:"text-muted",children:"Loading departments..."})]})})]})})}),a.jsxs(ce.Footer,{className:"border-0",children:[a.jsx(ie,{variant:"outline-secondary",onClick:L,children:"Cancel"}),a.jsx(ie,{variant:"primary-custom",onClick:D,disabled:!f.name||!f.description||!f.departmentId,children:"Save Changes"})]})]})]})})},Qoe=()=>{const e=it(),{user:t}=fs(),[r,s]=v.useState([]),[n,i]=v.useState(!0);v.useEffect(()=>{t?.id&&o()},[t?.id]);const o=async()=>{try{i(!0);const u=t?.id;if(!u){ne.error("User ID not found"),s([]);return}const d=await Ya.getTemplates({status:"DRAFT",createdByUserId:u});d.success&&d.data?s(d.data):Array.isArray(d)?s(d):d.data&&Array.isArray(d.data)?s(d.data):s([])}catch(u){console.error("Error loading drafts:",u),ne.error("Failed to load drafts"),s([])}finally{i(!1)}},l=async u=>{try{console.log(" Opening draft:",u);const d=await Ya.getTemplateById(u),m=d.data?.templateForm||d.data,f=d.data?.sections||[];if(!m){ne.error("Template not found");return}console.log(" Template loaded:",m),console.log(" Sections loaded:",f);const h=Koe(f);console.log(" Converted sections:",h);const x=m.templateConfig||m.templateContent;if(!x){ne.error("Document URL not found");return}localStorage.setItem("templateInfo",JSON.stringify({id:m.id,name:m.name,description:m.description,departmentId:m.departmentId,templateContent:m.templateContent,templateConfig:m.templateConfig})),e("/admin/forms/editor",{state:{documentUrl:x,fileName:m.name,importType:"File without fields",templateInfo:{id:m.id,name:m.name,description:m.description,departmentId:m.departmentId,status:m.status},initialSections:h}}),ne.success("Draft loaded successfully")}catch(d){console.error("Error opening draft:",d),ne.error("Failed to load draft: "+(d.message||"Unknown error"))}},c=u=>{if(!u)return"N/A";try{return new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return u}};return a.jsx(_e,{fluid:!0,className:"py-4 forms-page form-component",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ie,{variant:"link",className:"text-white me-3 p-0",onClick:()=>e("/admin/forms"),style:{textDecoration:"none"},children:a.jsx(_t,{size:20})}),a.jsx(At,{className:"me-2 text-white",size:24}),a.jsx("h4",{className:"mb-0 text-white",children:"Your Drafts"})]})})})}),a.jsx(W.Body,{children:n?a.jsx(Rt,{}):r.length===0?a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ol,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No drafts found"}),a.jsx("p",{className:"text-muted mb-4",children:"You haven't saved any drafts yet. Start creating a template to save drafts."}),a.jsx(ie,{variant:"primary-custom",onClick:()=>e("/admin/forms"),children:"Go to Templates"})]})})}):a.jsx(de,{className:"g-3 g-md-4",children:r.map(u=>a.jsx(z,{xs:12,sm:6,md:6,lg:4,xl:3,children:a.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[a.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[a.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:a.jsx(At,{size:20})}),a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[a.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:u.name,children:u.name}),a.jsxs("small",{className:"text-muted",children:["v",u.version]})]})]}),a.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:a.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:u.description||"No description",children:u.description||"No description"})}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[a.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[a.jsx(Bs,{size:12,className:"text-muted me-1 flex-shrink-0"}),a.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:u.department?.code||"N/A",children:u.department?.code||"N/A"})]}),a.jsx("div",{className:"flex-shrink-0 ms-2",children:a.jsxs(Ae,{bg:"secondary",className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[a.jsx(ft,{size:12}),"DRAFT"]})})]}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[a.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[a.jsx(Lt,{size:12,className:"text-muted me-1 flex-shrink-0"}),a.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},children:[u.createdByUser?.firstName," ",u.createdByUser?.lastName]})]}),a.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:c(u.createdAt)})]}),a.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:a.jsxs(ie,{variant:"primary-custom",size:"sm",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>l(u.id),children:[a.jsx(Br,{size:14,className:"me-2"}),"Continue Editing"]})})]})})},u.id))})})]})})},ele=()=>{const e=it(),t=[{id:"add-template",title:"Add New Template",description:"Create a new form template",icon:E2,path:"/admin/forms",permission:Te.TEMPLATES.CREATE,color:"primary",action:()=>{e("/admin/forms")}},{id:"add-department",title:"Add New Department",description:"Create a new department",icon:Bs,path:"/admin/departments",permission:Te.DEPARTMENTS.CREATE,color:"primary",action:()=>{e("/admin/departments")}},{id:"bulk-import-user",title:"Bulk Import User",description:"Import multiple users from Excel file",icon:Ds,path:"/admin/users?action=bulk-import",permission:Te.USERS.BULK_CREATE,color:"primary",action:()=>{e("/admin/users?action=bulk-import")}}];return a.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:a.jsx(_e,{className:"py-4",children:a.jsx(de,{className:"mb-4",children:a.jsx(z,{lg:12,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),a.jsx(W.Body,{children:a.jsx(de,{children:t.map((r,s)=>{const n=r.icon;return a.jsx(hr,{permission:r.permission,fallback:null,children:a.jsx(z,{md:4,className:"mb-3",children:a.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:r.action,children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(n,{size:24,className:`text-${r.color} me-2`}),a.jsx("h6",{className:"mb-0",children:r.title})]}),a.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),a.jsx(mn,{size:16,className:`text-${r.color} ms-auto`})]})},s)},r.id)})})})]})})})})})},tle=({field:e,onViewDetail:t,onEdit:r})=>{const{hasPermission:s}=xc(),n=[{label:"View Detail",icon:a.jsx(At,{size:16}),onClick:()=>t(e),permission:Te.SQA.VIEW_GLOBAL_FIELD_DETAIL},{label:"Edit Global Field",icon:a.jsx(Br,{size:16}),onClick:()=>r(e),permission:Te.GLOBAL_FIELDS.UPDATE}].filter(i=>!i.permission||s(i.permission));return a.jsx(W,{className:"h-100 border-0 shadow-sm",style:{transition:"all 0.3s ease"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(W.Body,{className:"p-3 d-flex flex-column position-relative",children:[a.jsx("div",{className:"position-absolute",style:{top:"0.5rem",right:"0.5rem",zIndex:10},children:a.jsx(hr,{permissions:[Te.SQA.VIEW_GLOBAL_FIELD_DETAIL,Te.GLOBAL_FIELDS.UPDATE],fallback:null,children:a.jsx(Ht,{align:"end",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:n})})}),a.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0,paddingRight:"2rem"},children:[a.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:a.jsx(At,{size:20})}),a.jsx("div",{className:"flex-grow-1",style:{minWidth:0},children:a.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:e.label,children:e.label})})]}),a.jsxs("div",{className:"mb-2",style:{flexShrink:0},children:[a.jsx("small",{className:"text-muted d-block mb-1",children:"Field Name:"}),a.jsx("code",{className:"text-dark d-block",style:{fontSize:"0.85rem",wordBreak:"break-word",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:e.fieldName})]}),e.roleRequired&&a.jsxs("div",{className:"mt-auto",style:{flexShrink:0},children:[a.jsx("small",{className:"text-muted d-block mb-1",children:"Role Required:"}),a.jsx("span",{className:"badge bg-secondary",children:e.roleRequired})]})]})})},rle=({show:e,onHide:t,field:r})=>{if(!r)return null;const s=i=>{if(!i)return"N/A";try{return new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return i}},n=i=>{const l={TEXT:{variant:"primary",text:"TEXT"},NUMBER:{variant:"info",text:"NUMBER"},DATE:{variant:"success",text:"DATE"},SELECT:{variant:"warning",text:"SELECT"},CHECKBOX:{variant:"secondary",text:"CHECKBOX"}}[i]||{variant:"secondary",text:i||"N/A"};return a.jsx(Ae,{bg:l.variant,className:"px-2 py-1",children:l.text})};return a.jsxs(ce,{show:e,onHide:t,size:"md",centered:!0,fullscreen:"md-down",children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[a.jsx(At,{className:"me-2",size:20}),a.jsx("span",{children:"Global Field Detail"})]}),a.jsx("button",{onClick:t,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:a.jsx(nt,{size:24})})]}),a.jsx(ce.Body,{style:{padding:"1.5rem",maxHeight:"60vh",overflowY:"auto"},children:a.jsxs(ha,{variant:"flush",children:[a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Label"}),a.jsx("span",{className:"text-dark fw-medium",children:r.label||"N/A"})]})]})}),a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Name"}),a.jsx("code",{className:"text-dark",style:{fontSize:"0.9rem",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:r.fieldName||"N/A"})]})]})}),a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Type"}),a.jsx("div",{children:n(r.fieldType)})]})]})}),r.roleRequired&&a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Role Required"}),a.jsx(Ae,{bg:"secondary",children:r.roleRequired})]})]})}),r.options&&a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(At,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Options"}),a.jsx("span",{className:"text-dark",children:JSON.stringify(r.options)})]})]})}),r.createdBy&&a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(Lt,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),a.jsxs("span",{className:"text-dark",children:[r.createdBy.firstName," ",r.createdBy.lastName]})]})]})}),r.createdAt&&a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(nr,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created At"}),a.jsx("span",{className:"text-dark",children:s(r.createdAt)})]})]})}),r.updatedBy&&a.jsx(ha.Item,{className:"px-0 py-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(Lt,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated By"}),a.jsxs("span",{className:"text-dark",children:[r.updatedBy.firstName," ",r.updatedBy.lastName]})]})]})}),r.updatedAt&&a.jsx(ha.Item,{className:"px-0 py-3",children:a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(ft,{className:"text-primary-custom me-3",size:20}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated At"}),a.jsx("span",{className:"text-dark",children:s(r.updatedAt)})]})]})})]})}),a.jsx(ce.Footer,{className:"bg-light border-0",children:a.jsx("button",{onClick:t,className:"btn btn-secondary",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff"},children:"Close"})})]})},sle=({show:e,onHide:t,field:r,onSuccess:s})=>{const[n,i]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[o,l]=v.useState({}),[c,u]=v.useState(!1);v.useEffect(()=>{r&&e&&(i({label:r.label||"",fieldName:r.fieldName||"",fieldType:r.fieldType||"TEXT",roleRequired:r.roleRequired||"",options:r.options||null}),l({}))},[r,e]);const d=x=>{const{name:p,value:g}=x.target;i(b=>({...b,[p]:g})),o[p]&&l(b=>({...b,[p]:""}))},m=()=>{const x={};return n.label.trim()||(x.label="Label is required"),n.fieldName.trim()||(x.fieldName="Field Name is required"),n.fieldType||(x.fieldType="Field Type is required"),l(x),Object.keys(x).length===0},f=async x=>{if(x.preventDefault(),!!m())try{u(!0);const p={label:n.label.trim(),fieldName:n.fieldName.trim(),fieldType:n.fieldType,roleRequired:n.roleRequired||null,options:n.options||null};await Rd.updateGlobalField(r.id,p),ne.success("Global field updated successfully"),s&&s(),t()}catch(p){console.error("Error updating global field:",p);const g=p.response?.data?.message||p.message||"Failed to update global field";ne.error(g)}finally{u(!1)}},h=()=>{i({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),l({}),t()};return a.jsxs(ce,{show:e,onHide:h,size:"lg",centered:!0,fullscreen:"md-down",children:[a.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[a.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[a.jsx(ts,{className:"me-2",size:20}),a.jsx("span",{children:"Edit Global Field"})]}),a.jsx("button",{onClick:h,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:a.jsx(nt,{size:24})})]}),a.jsxs(A,{onSubmit:f,children:[a.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-medium",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",name:"label",value:n.label,onChange:d,isInvalid:!!o.label,placeholder:"Enter field label"}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.label})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-medium",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",name:"fieldName",value:n.fieldName,onChange:d,isInvalid:!!o.fieldName,placeholder:"Enter field name (e.g., template_name)"}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.fieldName})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsxs(A.Label,{className:"fw-medium",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{name:"fieldType",value:n.fieldType,onChange:d,isInvalid:!!o.fieldType,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"NUMBER",children:"NUMBER"}),a.jsx("option",{value:"DATE",children:"DATE"}),a.jsx("option",{value:"SELECT",children:"SELECT"}),a.jsx("option",{value:"CHECKBOX",children:"CHECKBOX"})]}),a.jsx(A.Control.Feedback,{type:"invalid",children:o.fieldType})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{className:"fw-medium",children:"Role Required"}),a.jsx(A.Control,{type:"text",name:"roleRequired",value:n.roleRequired,onChange:d,placeholder:"Enter role required (optional)"})]})]}),a.jsxs(ce.Footer,{className:"bg-light border-0 d-flex flex-wrap gap-2",style:{justifyContent:"flex-end"},children:[a.jsx(ie,{variant:"secondary",onClick:h,disabled:c,children:"Cancel"}),a.jsx(ie,{variant:"primary",type:"submit",disabled:c,className:"d-flex align-items-center",children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"me-2",size:16}),"Update Global Field"]})})]})]})]})},ale=({show:e,onHide:t,onSuccess:r})=>{const[s,n]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[i,o]=v.useState(!1),l=(d,m)=>{if(!d)return{valid:!1,message:"Field name is required"};const f=String(m||"").toUpperCase();return f==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(d)?d.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:f==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(d)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(d)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},c=async()=>{if(!s.label||!s.fieldName||!s.roleRequired){ne.warning("Please fill in all required fields");return}const d=l(s.fieldName,s.fieldType);if(!d.valid){ne.warning(d.message);return}try{o(!0);const m={label:s.label.trim(),fieldName:s.fieldName.trim(),fieldType:s.fieldType,roleRequired:s.roleRequired||null,options:s.options||null};await Rd.createGlobalField(m),ne.success("Global field created successfully"),r&&r(),u()}catch(m){console.error("Error creating global field:",m);const f=m.response?.data?.message||m.message||"Failed to create global field";ne.error(f)}finally{o(!1)}},u=()=>{n({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),t()};return a.jsxs(ce,{show:e,onHide:u,size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Create Global Field"})}),a.jsx(ce.Body,{children:a.jsx(A,{children:a.jsxs(de,{className:"g-3",children:[a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:"e.g., Crew Communication",value:s.label,onChange:d=>n(m=>({...m,label:d.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(z,{md:12,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(A.Control,{type:"text",placeholder:s.fieldType==="PART"?"e.g., Assessment_Items":s.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:s.fieldName,onChange:d=>n(m=>({...m,fieldName:d.target.value})),required:!0}),a.jsx(A.Text,{className:"text-muted",children:s.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':s.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:s.fieldType,onChange:d=>n(m=>({...m,fieldType:d.target.value})),required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{children:[a.jsxs(A.Label,{className:"text-primary-custom",children:["Role Required ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(A.Select,{value:s.roleRequired,onChange:d=>n(m=>({...m,roleRequired:d.target.value})),required:!0,children:[a.jsx("option",{value:"",children:"Select role"}),a.jsx("option",{value:"TRAINER",children:"TRAINER"}),a.jsx("option",{value:"TRAINEE",children:"TRAINEE"})]})]})})]})})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"outline-secondary",onClick:u,disabled:i,children:"Cancel"}),a.jsx(ie,{variant:"primary",onClick:c,disabled:i,children:"Save Field"})]})]})},nle=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(!0),[n,i]=v.useState(null),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState(null),[x,p]=v.useState(null),g=v.useCallback(async()=>{try{s(!0),i(null);const T=await Rd.getGlobalFields(),_=T?.data||T||[];t(_)}catch(T){console.error("Error loading global fields:",T),i(T.response?.data?.message||T.message||"Failed to load global fields"),ne.error("Failed to load global fields"),t([])}finally{s(!1)}},[]);v.useEffect(()=>{g()},[g]);const b=async T=>{try{h(T);const _=await Rd.getGlobalFieldDetail(),I=(_?.data||_||[]).find(L=>L.id===T.id);I?(p(I),l(!0)):(p(T),l(!0))}catch(_){console.error("Error loading field detail:",_),ne.error("Failed to load field details"),p(T),l(!0)}},y=T=>{h(T),u(!0)},j=()=>{l(!1),p(null),h(null)},S=()=>{u(!1),h(null)},E=()=>{g()},w=()=>{g()},N=()=>{m(!0)},C=()=>{m(!1)};return r?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary-custom text-white",children:a.jsx("h4",{className:"mb-0",children:"Global Field List"})}),a.jsx(W.Body,{children:a.jsx(Rt,{})})]})}):n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary-custom text-white",children:a.jsx("h4",{className:"mb-0",children:"Global Field List"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"alert alert-danger",children:[a.jsx("strong",{children:"Error:"})," ",n]})})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary-custom text-white",style:{backgroundColor:"#1b3c53",borderBottom:"none"},children:a.jsxs(de,{className:"align-items-center",children:[a.jsx(z,{children:a.jsx("h4",{className:"mb-0 text-white",children:"Global Field List"})}),a.jsx(z,{xs:"auto",className:"ms-auto",children:a.jsx(hr,{permission:Te.GLOBAL_FIELDS.CREATE,fallback:null,children:a.jsxs(ie,{variant:"light",onClick:N,className:"d-flex align-items-center",size:"sm",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#f8f9fa",T.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="#ffffff",T.currentTarget.style.borderColor="#dee2e6"},children:[a.jsx(ms,{className:"me-2",size:16}),a.jsx("span",{className:"d-none d-sm-inline",children:"Create Global Field"}),a.jsx("span",{className:"d-sm-none",children:"Create"})]})})})]})}),a.jsx(W.Body,{children:e.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsx("p",{className:"text-muted",children:"No global fields found"})}):a.jsx(de,{className:"g-3 g-md-4",children:e.map(T=>a.jsx(z,{xs:12,sm:6,md:6,lg:4,xl:3,children:a.jsx(tle,{field:T,onViewDetail:b,onEdit:y})},T.id))})})]}),a.jsx(rle,{show:o,onHide:j,field:x}),a.jsx(sle,{show:c,onHide:S,field:f,onSuccess:E}),a.jsx(ale,{show:d,onHide:C,onSuccess:w})]})},ile=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=ile,document.head.appendChild(e)}const ole=({traineeId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),{sortedData:o,sortConfig:l,handleSort:c}=Zt(r);v.useEffect(()=>{u()},[e]);const u=async()=>{try{i(!0);const f=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(h=>setTimeout(h,300)),s(f)}catch(f){console.error("Error loading signature required:",f),ne.error("Failed to load signature requirements")}finally{i(!1)}},d=f=>{const x={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return a.jsx(Ae,{bg:x.variant,children:x.text})},m=f=>{e?t(`/trainee/${e}/signature-pad/${f}`):ne.error("Unable to open signature pad: Trainee ID not found")};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Rt,{count:5})}):r.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(fn,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):a.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Document",sortKey:"name",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Course",sortKey:"course",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Subject",sortKey:"subject",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Due Date",sortKey:"dueDate",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Status",sortKey:"status",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(f=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.subject})}),a.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),a.jsx("td",{children:d(f.status)}),a.jsx("td",{children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"Sign Document",icon:a.jsx(fn,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},lle=()=>{const{user:e}=fs();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(ole,{traineeId:e?.id})})},cle=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=cle,document.head.appendChild(e)}const dle=({traineeId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),{sortedData:o,sortConfig:l,handleSort:c}=Zt(r);v.useEffect(()=>{u()},[e]);const u=async()=>{try{i(!0);const f=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(h=>setTimeout(h,300)),s(f)}catch(f){console.error("Error loading section completion:",f),ne.error("Failed to load section completion requirements")}finally{i(!1)}},d=f=>{const x={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return a.jsx(Ae,{bg:x.variant,children:x.text})},m=f=>{e?t(`/trainee/${e}/assessment-section/${f}`):ne.error("Unable to open section: Trainee ID not found")};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Rt,{count:5})}):r.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ht,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):a.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Section",sortKey:"name",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Course",sortKey:"course",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Subject",sortKey:"subject",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Type",sortKey:"section",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Due Date",sortKey:"dueDate",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Progress",sortKey:"progress",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Status",sortKey:"status",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(f=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.subject})}),a.jsx("td",{children:a.jsx(Ae,{bg:"primary",className:"fw-normal",children:f.section})}),a.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:[f.progress,"%"]})]})}),a.jsx("td",{children:d(f.status)}),a.jsx("td",{children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:f.status==="COMPLETED"?"View Section":"Complete Section",icon:f.status==="COMPLETED"?a.jsx(Et,{}):a.jsx(ht,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},QN=()=>{const{user:e}=fs();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(dle,{traineeId:e?.id})})},ule=({uniqueTypes:e,uniqueStatuses:t,uniquePriorities:r,selectedTypes:s,selectedStatuses:n,selectedPriorities:i,onTypeToggle:o,onStatusToggle:l,onPriorityToggle:c,onClearFilters:u,className:d=""})=>{const m=s.length>0||n.length>0||i.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown course-filter-dropdown ${d}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",m&&a.jsx("span",{className:"badge bg-primary ms-2",children:s.length+n.length+i.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),s.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(f=>a.jsx(A.Check,{type:"checkbox",id:`type-${f}`,label:f,checked:s.includes(f),onChange:()=>o(f),className:"mb-1"},f))})]}),a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(f=>a.jsx(A.Check,{type:"checkbox",id:`status-${f}`,label:f,checked:n.includes(f),onChange:()=>l(f),className:"mb-1"},f))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),i.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(f=>a.jsx(A.Check,{type:"checkbox",id:`priority-${f}`,label:f,checked:i.includes(f),onChange:()=>c(f),className:"mb-1"},f))})]}),m&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:u,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},J_=document.createElement("style");J_.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(J_);const mle=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=mle,document.head.appendChild(e)}const fle=({traineeId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(""),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,h]=v.useState([]),{sortedData:x,sortConfig:p,handleSort:g}=Zt(r);v.useEffect(()=>{b()},[e]);const b=async()=>{try{i(!0);const M=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(q=>setTimeout(q,300)),s(M)}catch(M){console.error("Error loading assessments:",M),ne.error("Failed to load assessments")}finally{i(!1)}},y=v.useMemo(()=>r.filter(M=>{const q=o===""||M.name.toLowerCase().includes(o.toLowerCase())||M.description.toLowerCase().includes(o.toLowerCase())||M.course?.name.toLowerCase().includes(o.toLowerCase())||M.subject?.name.toLowerCase().includes(o.toLowerCase()),Z=c.length===0||c.includes(M.type),Q=d.length===0||d.includes(M.status),U=f.length===0||f.includes(M.priority);return q&&Z&&Q&&U}),[r,o,c,d,f]),j=v.useMemo(()=>[...new Set(r.map(q=>q.type))].filter(Boolean),[r]),S=v.useMemo(()=>[...new Set(r.map(q=>q.status))].filter(Boolean),[r]),E=v.useMemo(()=>[...new Set(r.map(q=>q.priority))].filter(Boolean),[r]),w=M=>{l(M.target.value)},N=M=>{u(q=>q.includes(M)?q.filter(Z=>Z!==M):[...q,M])},C=M=>{m(q=>q.includes(M)?q.filter(Z=>Z!==M):[...q,M])},T=M=>{h(q=>q.includes(M)?q.filter(Z=>Z!==M):[...q,M])},_=()=>{u([]),m([]),h([]),l("")},k=M=>{const Z={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[M]||{variant:"secondary",text:M};return a.jsx(Ae,{bg:Z.variant,children:Z.text})},I=M=>{const Z={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[M]||{variant:"secondary",text:M};return a.jsx(Ae,{bg:Z.variant,children:Z.text})},L=M=>{t(`/trainee/${e}/assessment/${M.id}`)},D=M=>{t(`/trainee/${e}/assessment/${M.id}`)};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Rt,{count:8})}):a.jsx("div",{className:"trainee-your-assessments",children:a.jsx(W,{className:"shadow-sm",children:a.jsx(W.Body,{className:"p-0",children:a.jsxs(xx,{defaultActiveKey:"upcoming",className:"border-bottom",children:[a.jsx(Ft,{eventKey:"upcoming",title:"Upcoming Assessments",children:a.jsxs("div",{className:"p-3",children:[a.jsx("div",{style:{marginBottom:"3rem"},children:a.jsxs(de,{className:"form-mobile-stack",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search assessments by name, description, course, or subject...",value:o,onChange:w,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ule,{uniqueTypes:j,uniqueStatuses:S,uniquePriorities:E,selectedTypes:c,selectedStatuses:d,selectedPriorities:f,onTypeToggle:N,onStatusToggle:C,onPriorityToggle:T,onClearFilters:_,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[y.length," assessment",y.length!==1?"s":""]})})})]})}),y.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Dt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:r.length===0?"No upcoming assessments":"No assessments match your filters"})]}):a.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Assessment",sortKey:"name",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Course",sortKey:"course",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Subject",sortKey:"subject",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Type",sortKey:"type",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Priority",sortKey:"priority",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Due Date",sortKey:"dueDate",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(lr,{title:"Status",sortKey:"status",sortConfig:p,onSort:g})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:x.map(M=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:M.name}),a.jsx("small",{className:"text-muted",children:M.description})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:M.course?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:M.course?.code||""})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:M.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:M.subject?.code||""})]}),a.jsx("td",{children:a.jsx(Ae,{bg:"primary",className:"fw-normal",children:M.type||"Assessment"})}),a.jsx("td",{children:I(M.priority)}),a.jsx("td",{children:M.dueDate?new Date(M.dueDate).toLocaleDateString():"N/A"}),a.jsx("td",{children:k(M.status)}),a.jsx("td",{children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:M.status==="PENDING"||M.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:M.status==="PENDING"||M.status==="IN_PROGRESS"?a.jsx(Nx,{}):a.jsx(Et,{}),onClick:()=>M.status==="PENDING"||M.status==="IN_PROGRESS"?L(M):D(M)}]})})]},M.id))})]})})]})}),a.jsx(Ft,{eventKey:"completed",title:"Completed Assessments",children:a.jsx("div",{className:"p-3",children:a.jsx(Y_,{traineeId:e})})})]})})})})},e2=()=>{const{user:e}=fs();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(fle,{traineeId:e?.id})})},hle=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=hle,document.head.appendChild(e)}const ple=()=>{const[e,t]=v.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[r,s]=v.useState(!1),n=o=>{const{name:l,value:c,type:u,checked:d}=o.target;t(m=>({...m,[l]:u==="checkbox"?d:c}))},i=async o=>{o.preventDefault(),s(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(l=>setTimeout(l,1e3)),ne.success("Incident/Feedback report submitted successfully!"),t({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(l){console.error("Error submitting incident/feedback report:",l),ne.error("Failed to submit incident/feedback report. Please try again.")}finally{s(!1)}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsx("div",{className:"d-flex align-items-center",children:a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),a.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})})})}),a.jsxs(de,{className:"mt-4",children:[a.jsx(z,{lg:8,children:a.jsxs(W,{className:"border-0 shadow-sm create-issue-form",children:[a.jsx(W.Header,{children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),a.jsx(W.Body,{children:a.jsxs(A,{onSubmit:i,children:[a.jsxs(de,{children:[a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Title"}),a.jsx(A.Control,{type:"text",name:"title",value:e.title,onChange:n,placeholder:"Brief description of the incident or feedback"})]})}),a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Request Type *"}),a.jsxs(A.Select,{name:"request_type",value:e.request_type,onChange:n,required:!0,children:[a.jsx("option",{value:"",children:"Select request type"}),a.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),a.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),a.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),a.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),a.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),a.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),a.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),a.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),a.jsx(de,{children:a.jsx(z,{md:6,children:a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Severity"}),a.jsxs(A.Select,{name:"severity",value:e.severity,onChange:n,children:[a.jsx("option",{value:"LOW",children:"Low"}),a.jsx("option",{value:"MEDIUM",children:"Medium"}),a.jsx("option",{value:"HIGH",children:"High"}),a.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Description"}),a.jsx(A.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:n,placeholder:"Please provide detailed information about the incident or feedback..."})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Actions Taken"}),a.jsx(A.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:n,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),a.jsx(A.Group,{className:"mb-4",children:a.jsx(A.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:n,label:"Submit anonymously (your identity will be kept confidential)"})}),a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(ie,{type:"submit",variant:"primary",disabled:r,children:r?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(T2,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),a.jsx(z,{lg:4,children:a.jsxs(W,{className:"border-0 shadow-sm create-issue-guidelines",children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Guidelines"})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{children:"Before submitting:"}),a.jsxs("ul",{className:"small text-muted mb-0",children:[a.jsx("li",{children:"Check if the incident has already been reported"}),a.jsx("li",{children:"Provide clear and specific details"}),a.jsx("li",{children:"Include steps to reproduce the incident"}),a.jsx("li",{children:"Attach screenshots if applicable"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{children:"Response time:"}),a.jsxs("ul",{className:"small text-muted mb-0",children:[a.jsx("li",{children:"High priority: Within 24 hours"}),a.jsx("li",{children:"Medium priority: Within 2-3 days"}),a.jsx("li",{children:"Low priority: Within 1 week"})]})]}),a.jsxs(Re,{variant:"info",className:"small",children:[a.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},xle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("all");Zt(),v.useEffect(()=>{const x=[{id:1,title:"Safety Procedure Issue",description:"Reported safety concern in training module",reporter:"John Smith",reporterEmail:"john.smith@company.com",status:"open",priority:"high",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T14:20:00Z"},{id:2,title:"Training Material Error",description:"Incorrect information in assessment template",reporter:"Sarah Johnson",reporterEmail:"sarah.johnson@company.com",status:"in_progress",priority:"medium",createdAt:"2024-01-14T09:15:00Z",updatedAt:"2024-01-15T11:45:00Z"},{id:3,title:"System Performance Issue",description:"Slow loading times during assessment",reporter:"Mike Wilson",reporterEmail:"mike.wilson@company.com",status:"resolved",priority:"low",createdAt:"2024-01-13T16:20:00Z",updatedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(x),n(!1)},1e3)},[]);const u=x=>{const p={open:{variant:"danger",icon:fr},in_progress:{variant:"warning",icon:ft},resolved:{variant:"success",icon:ht},closed:{variant:"secondary",icon:Qs}},g=p[x]||p.open,b=g.icon;return a.jsxs(Ae,{bg:g.variant,className:"d-flex align-items-center",children:[a.jsx(b,{size:12,className:"me-1"}),x.replace("_"," ").toUpperCase()]})},d=x=>{const p={high:"danger",medium:"warning",low:"info"};return a.jsx(Ae,{bg:p[x]||"secondary",children:x.toUpperCase()})},m=t.filter(x=>{const p=x.title.toLowerCase().includes(i.toLowerCase())||x.description.toLowerCase().includes(i.toLowerCase())||x.reporter.toLowerCase().includes(i.toLowerCase()),g=l==="all"||x.status===l;return p&&g}),f=x=>{e(`/sqa/issues/${x}`)},h=x=>[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>f(x.id),permission:Te.SQA.VIEW_TEMPLATES}];return s?a.jsx(_e,{className:"py-4",children:a.jsx(Rt,{})}):a.jsx(_e,{fluid:!0,className:"py-4 issue-list-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsx(ie,{variant:"outline-primary",size:"sm",children:"Export Issues"})})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search issues by title, description, or reporter...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:x=>c(x.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"open",children:"Open"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"resolved",children:"Resolved"}),a.jsx("option",{value:"closed",children:"Closed"})]})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[m.length," issue",m.length!==1?"s":""]})})})]}),a.jsx(No,{data:m,loading:s,columns:[{key:"title",title:"Issue Title",className:"show-mobile",sortable:!0},{key:"reporter",title:"Reporter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"priority",title:"Priority",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(x,p)=>a.jsxs("tr",{className:`${p%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor=p%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:x.title}),a.jsx("small",{className:"text-muted",children:x.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:x.reporter}),a.jsx("small",{className:"text-muted",children:x.reporterEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:u(x.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:d(x.priority)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(x.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:h(x)})})})]},x.id),emptyMessage:"No issues found",emptyDescription:"Try adjusting your search criteria."})]})]})})},gle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("all");Zt(),v.useEffect(()=>{const p=[{id:1,title:"Training Course Feedback",description:"Positive feedback about the safety training course",submitter:"Sarah Johnson",submitterEmail:"sarah.johnson@company.com",status:"acknowledged",category:"training",rating:5,createdAt:"2024-01-15T10:30:00Z",acknowledgedAt:"2024-01-15T14:20:00Z"},{id:2,title:"System Usability Feedback",description:"Suggestions for improving the assessment interface",submitter:"Mike Wilson",submitterEmail:"mike.wilson@company.com",status:"pending",category:"system",rating:4,createdAt:"2024-01-14T09:15:00Z",acknowledgedAt:null},{id:3,title:"Content Quality Feedback",description:"Feedback about the quality of training materials",submitter:"John Smith",submitterEmail:"john.smith@company.com",status:"acknowledged",category:"content",rating:3,createdAt:"2024-01-13T16:20:00Z",acknowledgedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(p),n(!1)},1e3)},[]);const u=p=>{const g={pending:{variant:"warning",icon:ft},acknowledged:{variant:"success",icon:ht},reviewed:{variant:"info",icon:p2}},b=g[p]||g.pending,y=b.icon;return a.jsxs(Ae,{bg:b.variant,className:"d-flex align-items-center",children:[a.jsx(y,{size:12,className:"me-1"}),p.toUpperCase()]})},d=p=>{const g={training:"primary",system:"info",content:"success",general:"secondary"};return a.jsx(Ae,{bg:g[p]||"secondary",children:p.toUpperCase()})},m=t.filter(p=>{const g=p.title.toLowerCase().includes(i.toLowerCase())||p.description.toLowerCase().includes(i.toLowerCase())||p.submitter.toLowerCase().includes(i.toLowerCase()),b=l==="all"||p.status===l;return g&&b}),f=p=>{e(`/sqa/feedback/${p}`)},h=p=>{e(`/sqa/feedback/${p}/acknowledge`)},x=p=>[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>f(p.id),permission:Te.SQA.VIEW_TEMPLATES},{label:"Acknowledge",icon:a.jsx(ht,{}),onClick:()=>h(p.id),disabled:p.status==="acknowledged"||p.status==="reviewed",permission:Te.SQA.VIEW_TEMPLATES}];return s?a.jsx(_e,{className:"py-4",children:a.jsx(Rt,{})}):a.jsx(_e,{fluid:!0,className:"py-4 feedback-list-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsx(ie,{variant:"outline-primary",size:"sm",children:"Export Feedback"})})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search feedback by title, description, or submitter...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:p=>c(p.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"acknowledged",children:"Acknowledged"}),a.jsx("option",{value:"reviewed",children:"Reviewed"})]})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[m.length," feedback",(m.length!==1,"")]})})})]}),a.jsx(No,{data:m,loading:s,columns:[{key:"title",title:"Feedback Title",className:"show-mobile",sortable:!0},{key:"submitter",title:"Submitter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"category",title:"Category",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(p,g)=>a.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:p.title}),a.jsx("small",{className:"text-muted",children:p.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:p.submitter}),a.jsx("small",{className:"text-muted",children:p.submitterEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:u(p.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:d(p.category)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(p.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:x(p)})})})]},p.id),emptyMessage:"No feedback found",emptyDescription:"Try adjusting your search criteria."})]})]})})},vle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState(""),{sortConfig:u,handleSort:d}=Zt();v.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const b=[{id:"1",name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses",version:"v2.1",category:"SAFETY",sections:5,fields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z"},{id:"2",name:"Technical Skills Evaluation",description:"Template for evaluating technical skills and competencies",version:"v1.5",category:"TECHNICAL",sections:3,fields:15,status:"DRAFT",createdBy:"Sarah Johnson",createdAt:"2024-01-14T00:00:00.000Z"},{id:"3",name:"Compliance Assessment",description:"Template for compliance and regulatory assessments",version:"v3.0",category:"COMPLIANCE",sections:7,fields:31,status:"ACTIVE",createdBy:"Mike Wilson",createdAt:"2024-01-13T00:00:00.000Z"}];await new Promise(y=>setTimeout(y,1e3)),r(b)}catch(b){console.error("Error loading templates:",b)}finally{n(!1)}},f=b=>{switch(b){case"ACTIVE":return{variant:"success",icon:ht,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:ft,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:ft,text:"INACTIVE"};default:return{variant:"secondary",icon:ft,text:b}}},h=b=>{console.log("View detail for template:",b),e(`/sqa/templates/${b}`)},x=b=>{console.log("Disable template:",b)},p=t.filter(b=>{const y=b.name.toLowerCase().includes(i.toLowerCase())||b.description.toLowerCase().includes(i.toLowerCase())||b.createdBy.toLowerCase().includes(i.toLowerCase()),j=!l||b.status===l;return y&&j});if(s)return a.jsx(_e,{fluid:!0,className:"p-4",children:a.jsx(Rt,{})});const g=({columnKey:b,children:y,className:j=""})=>{const S=u.key===b,E=S?u.direction:null;return a.jsxs("th",{className:`fw-semibold ${j}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>d(b),onMouseEnter:w=>{w.target.style.backgroundColor="#214760",w.target.style.transform="translateY(-1px)",w.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:w=>{w.target.style.backgroundColor="var(--bs-primary)",w.target.style.transform="translateY(0)",w.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:S?"600":"500",color:"white"},children:y}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:E,size:14,color:"white"})})]}),S&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx(_e,{fluid:!0,className:"py-4 template-list-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsxs(de,{className:"align-items-center",children:[a.jsx(z,{xs:12,md:6,children:a.jsx("div",{})}),a.jsx(z,{xs:12,md:6,className:"mt-2 mt-md-0",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsxs(ie,{variant:"outline-primary",size:"sm",className:"d-flex align-items-center",children:[a.jsx(Du,{className:"me-1",size:16}),"Export Templates"]})})})]})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search templates by name, description, or creator...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:a.jsxs(A.Select,{value:l,onChange:b=>c(b.target.value),className:"filter-panel-mobile",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"ACTIVE",children:"Active"}),a.jsx("option",{value:"DRAFT",children:"Draft"}),a.jsx("option",{value:"INACTIVE",children:"Inactive"})]})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[p.length," template",p.length!==1?"s":""]})})})]}),a.jsxs("div",{className:"position-relative",children:[a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(g,{columnKey:"name",className:"show-mobile",children:"Template Name"}),a.jsx(g,{columnKey:"version",className:"hide-mobile",children:"Version"}),a.jsx("th",{className:"text-primary-custom fw-semibold hide-mobile",children:"Sections/Fields"}),a.jsx(g,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(g,{columnKey:"createdBy",className:"hide-mobile",children:"Created By"}),a.jsx(g,{columnKey:"createdAt",className:"hide-mobile",children:"Created Date"}),a.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:p.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:"7",className:"text-center py-5",children:[a.jsx(At,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No templates found"}),a.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]})}):p.map((b,y)=>{const j=f(b.status),S=j.icon;return a.jsxs("tr",{className:`${y%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:E=>{E.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:E=>{E.currentTarget.style.backgroundColor=y%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium text-dark",children:b.name}),a.jsx("div",{className:"text-muted small",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:b.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:b.version})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"text-muted small",children:[a.jsxs("div",{children:[b.sections," sections"]}),a.jsxs("div",{children:[b.fields," fields"]})]})}),a.jsx("td",{className:"align-middle",children:a.jsxs(Ae,{bg:j.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx(S,{className:"me-1",size:12}),j.text]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:b.createdBy})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(b.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center",children:a.jsx(hr,{permissions:[Te.SQA.VIEW_TEMPLATES,Te.SQA.VIEW_TEMPLATE_DETAIL],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Detail",icon:a.jsx(Et,{}),onClick:()=>h(b.id),permission:Te.SQA.VIEW_TEMPLATE_DETAIL},{label:"Disable Template",icon:a.jsx(Qs,{}),onClick:()=>x(b.id),permission:Te.SQA.VIEW_TEMPLATES}]})})})]},b.id)})})]})}),p.length>8&&a.jsxs("div",{className:"scroll-indicator",children:[a.jsx(Ka,{size:12,className:"me-1"}),"Scroll to see more templates"]})]})]})]})})},ble=()=>{const{templateId:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState("overview"),d=v.useCallback(async()=>{if(!e){l("Template ID is required"),i(!1);return}try{i(!0),l(null);const g=await Ya.getTemplateById(e),b=g?.data||g;if(!b){l("Template not found");return}const y={id:b.id,name:b.name||"N/A",description:b.description||"",version:b.version||"v1.0",category:b.category||"",totalSections:b.sections?.length||0,totalFields:b.sections?.reduce((j,S)=>j+(S.fields?.length||0),0)||0,status:b.status||"DRAFT",createdBy:b.createdBy?.firstName&&b.createdBy?.lastName?`${b.createdBy.firstName} ${b.createdBy.lastName}`:b.createdBy?.fullName||b.createdBy?.name||"N/A",createdAt:b.createdAt||b.createdDate,lastModified:b.updatedAt||b.updatedDate||b.createdAt,lastModifiedBy:b.updatedBy?.firstName&&b.updatedBy?.lastName?`${b.updatedBy.firstName} ${b.updatedBy.lastName}`:b.updatedBy?.fullName||b.updatedBy?.name||"N/A",sections:b.sections||[],history:b.history||b.versions||[]};s(y)}catch(g){console.error("Error loading template detail:",g),l(g.response?.data?.message||g.message||"Failed to load template details")}finally{i(!1)}},[e]);v.useEffect(()=>{d()},[d]);const m=g=>{switch(g){case"ACTIVE":return{variant:"success",icon:ht,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:ft,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:ft,text:"INACTIVE"};default:return{variant:"secondary",icon:ft,text:g}}},f=()=>{console.log("Export PDF for template:",e),alert("PDF export functionality will be implemented")},h=()=>{t("/sqa/templates")};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsxs(ie,{variant:"outline-danger",onClick:h,children:[a.jsx(_t,{className:"me-2"}),"Back to Template List"]})]})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Template Not Found"}),a.jsx("p",{children:"The requested template could not be found."}),a.jsxs(ie,{variant:"outline-warning",onClick:h,children:[a.jsx(_t,{className:"me-2"}),"Back to Template List"]})]})});const x=m(r.status),p=x.icon;return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{xs:12,children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:h,className:"me-3",children:[a.jsx(_t,{className:"me-1",size:16}),"Back to List"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1 text-dark",children:r.name}),a.jsx("p",{className:"text-muted mb-0",children:r.description})]})]}),a.jsx(hr,{permissions:[Te.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsxs(ie,{variant:"primary",size:"sm",onClick:f,className:"d-flex align-items-center",children:[a.jsx(Du,{className:"me-1",size:16}),"Export PDF"]})})]})})}),a.jsx(de,{children:a.jsx(z,{xs:12,children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:a.jsxs("div",{className:"custom-tabs",children:[a.jsx("button",{className:`custom-tab ${c==="overview"?"active":""}`,onClick:()=>u("overview"),children:"Template Overview"}),a.jsx("button",{className:`custom-tab ${c==="sections"?"active":""}`,onClick:()=>u("sections"),children:"Sections"}),a.jsx("button",{className:`custom-tab ${c==="history"?"active":""}`,onClick:()=>u("history"),children:"Version History"})]})}),a.jsxs(W.Body,{className:"p-0",children:[c==="overview"&&a.jsx("div",{className:"p-4",children:a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Version"}),a.jsx("div",{children:a.jsx(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:r.version})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Status"}),a.jsx("div",{children:a.jsxs(Ae,{bg:x.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx(p,{className:"me-1",size:12}),x.text]})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Total Sections"}),a.jsxs("div",{className:"fw-medium",children:[r.totalSections," sections"]})]})]}),a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Created By"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2",size:16}),a.jsx("span",{children:r.createdBy})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Created Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"me-2",size:16}),a.jsx("span",{children:new Date(r.createdAt).toLocaleDateString()})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Last Modified"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{className:"me-2",size:16}),a.jsx("span",{children:new Date(r.lastModified).toLocaleDateString()})]})]})]})]})}),c==="sections"&&a.jsx("div",{className:"p-4",children:a.jsx(No,{data:r.sections||[],loading:!1,columns:[{key:"name",title:"Section Name",className:"show-mobile",sortable:!0},{key:"fields",title:"Fields",className:"show-mobile",sortable:!0},{key:"order",title:"Order",className:"show-mobile",sortable:!0}],renderRow:(g,b)=>a.jsxs("tr",{className:`${b%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor=b%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"me-2 text-primary",size:16}),a.jsx("span",{className:"fw-medium",children:g.name})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs(Ae,{bg:"secondary",className:"px-2 py-1",children:[g.fields," fields"]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-muted",children:g.order})})]},g.id),emptyMessage:"No sections found",emptyDescription:"This template has no sections."})}),c==="history"&&a.jsx("div",{className:"p-4",children:a.jsx(No,{data:r.history||[],loading:!1,columns:[{key:"version",title:"Version",className:"show-mobile",sortable:!0},{key:"modifiedBy",title:"Modified By",className:"show-mobile",sortable:!0},{key:"date",title:"Date",className:"show-mobile",sortable:!0},{key:"changes",title:"Changes",className:"show-mobile",sortable:!0}],renderRow:(g,b)=>a.jsxs("tr",{className:`${b%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor=b%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Ae,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:g.version})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2",size:16}),a.jsx("span",{children:g.modifiedBy})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"me-2",size:16}),a.jsx("span",{children:new Date(g.date).toLocaleDateString()})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-muted",children:g.changes})})]},b),emptyMessage:"No version history found",emptyDescription:"This template has no version history."})})]})]})})})]})},yle=()=>{const e=it(),[t,r]=v.useState("upcoming-assessments"),s=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:Ra,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:ht,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:It,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:va,path:"/trainer/configure-signature",color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:Dt,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:Ou,path:"/trainer/assessment-details",color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:ht,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(t){case"upcoming-assessments":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),a.jsxs(de,{children:[a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Ra,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),a.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-success text-white",children:a.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(ie,{variant:"outline-primary",size:"sm",children:[a.jsx(Ra,{size:16,className:"me-2"}),"Schedule Assessment"]}),a.jsxs(ie,{variant:"outline-success",size:"sm",children:[a.jsx(Dt,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Assessment Results"}),a.jsxs(de,{children:[a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-success text-white",children:a.jsx("h6",{className:"mb-0",children:"Recent Results"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ht,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No recent results"}),a.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-info text-white",children:a.jsx("h6",{className:"mb-0",children:"Statistics"})}),a.jsx(W.Body,{children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-primary",children:"0"}),a.jsx("small",{className:"text-muted",children:"Completed"})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-warning",children:"0"}),a.jsx("small",{className:"text-muted",children:"Pending"})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-success",children:"0"}),a.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),a.jsxs(de,{children:[a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-info text-white",children:a.jsx("h6",{className:"mb-0",children:"My Courses"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(It,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No courses assigned"}),a.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),a.jsx(z,{md:6,className:"mb-3",children:a.jsxs(W,{className:"h-100",children:[a.jsx(W.Header,{className:"bg-warning text-white",children:a.jsx("h6",{className:"mb-0",children:"Course Management"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(ie,{variant:"outline-primary",size:"sm",children:[a.jsx(It,{size:16,className:"me-2"}),"View All Courses"]}),a.jsxs(ie,{variant:"outline-info",size:"sm",children:[a.jsx(ft,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsxs(z,{children:[a.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),a.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),a.jsxs(de,{children:[a.jsx(z,{lg:3,className:"mb-4",children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Navigation"})}),a.jsx(W.Body,{className:"p-0",children:a.jsx("div",{className:"list-group list-group-flush",children:s.map(o=>{const l=o.icon;return a.jsx("button",{className:`list-group-item list-group-item-action border-0 ${t===o.id?"active":""}`,onClick:()=>r(o.id),style:{backgroundColor:t===o.id?"#0d6efd":"transparent",color:t===o.id?"white":"inherit",border:"none",borderRadius:0},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(l,{size:20,className:"me-3",style:{color:t===o.id?"white":`var(--bs-${o.color})`}}),a.jsxs("div",{className:"flex-grow-1 text-start",children:[a.jsx("h6",{className:"mb-1",children:o.title}),a.jsx("small",{className:"text-muted",children:o.description})]}),a.jsx(mn,{size:16})]})},o.id)})})})]})}),a.jsx(z,{lg:9,children:a.jsx(W,{className:"border-0 shadow-sm",children:a.jsx(W.Body,{className:"p-4",children:i()})})})]}),a.jsx(de,{className:"mt-4",children:a.jsx(z,{children:a.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),a.jsx(de,{children:n.map((o,l)=>{const c=o.icon;return a.jsx(z,{lg:6,xl:3,className:"mb-4",children:a.jsx(W,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(o.path),onMouseEnter:u=>{u.currentTarget.style.transform="translateY(-5px)",u.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:u=>{u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(W.Body,{className:"p-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:`bg-${o.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:a.jsx(c,{size:24})}),a.jsx("div",{className:"flex-grow-1",children:a.jsx("h5",{className:"mb-1",children:o.title})}),a.jsx(mn,{size:20,className:"text-muted"})]}),a.jsx("p",{className:"text-muted mb-0",children:o.description})]})})},l)})})]})},ti=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:s,className:n=""})=>{const i=t.length>0;return a.jsxs(Mt,{className:`filter-panel-dropdown ${n}`,children:[a.jsx(Mt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ui,{size:14,className:"me-2"}),"Filters",i&&a.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),a.jsxs(Mt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&a.jsx(ie,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:a.jsx(nt,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>a.jsx(A.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(ie,{variant:"outline-danger",size:"sm",className:"w-100",onClick:s,children:[a.jsx(nt,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},jle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState(""),[u,d]=v.useState([]);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(C=>setTimeout(C,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",scheduledDate:"2024-01-15",scheduledTime:"09:00",status:"scheduled",duration:"120 minutes",location:"Training Room A"},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",scheduledDate:"2024-01-16",scheduledTime:"14:00",status:"scheduled",duration:"90 minutes",location:"Lab B"},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",scheduledDate:"2024-01-17",scheduledTime:"10:30",status:"pending",duration:"150 minutes",location:"Simulator Room"}])}catch{o("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const m=w=>{const C={scheduled:{variant:"primary",text:"Scheduled"},pending:{variant:"warning",text:"Pending"},inProgress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[w]||{variant:"secondary",text:w};return a.jsx(Ae,{bg:C.variant,children:C.text})},f=w=>{e(`/trainer/assessments/${w}`)},h=w=>{e(`/trainer/assessments/${w}/edit`)},x=[...new Set(t.map(w=>w.status))],p=t.filter(w=>{const N=u.length===0||u.includes(w.status),C=w.title.toLowerCase().includes(l.toLowerCase())||w.course.toLowerCase().includes(l.toLowerCase())||w.trainee.toLowerCase().includes(l.toLowerCase());return N&&C}),g=w=>{d(w==="clear"?[]:N=>N.includes(w)?N.filter(C=>C!==w):[...N,w])},b=()=>{d([]),c("")},{sortedData:y,sortConfig:j,handleSort:S}=Zt(p);if(s)return a.jsx(Rt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(p.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No upcoming assessments found"}),a.jsx("p",{children:"Try adjusting your search criteria or schedule a new assessment."})]})});const E=({columnKey:w,children:N,className:C=""})=>{const T=j.key===w,_=T?j.direction:null;return a.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(w),onMouseEnter:k=>{k.target.style.backgroundColor="#214760",k.target.style.transform="translateY(-1px)",k.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:k=>{k.target.style.backgroundColor="var(--bs-primary)",k.target.style.transform="translateY(0)",k.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:N}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:_,size:14,color:"white"})})]}),T&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search assessments, courses, or trainees...",value:l,onChange:c,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:x,selectedStatuses:u,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"title",className:"show-mobile",children:"Assessment"}),a.jsx(E,{columnKey:"course",className:"show-mobile",children:"Course"}),a.jsx(E,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),a.jsx(E,{columnKey:"scheduledDate",className:"show-mobile",children:"Date & Time"}),a.jsx(E,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map(w=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:w.title}),a.jsxs("small",{className:"text-muted",children:[a.jsx(ft,{size:12,className:"me-1"}),w.location]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:w.course})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:w.trainee})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:w.scheduledDate}),a.jsx("small",{className:"text-muted",children:w.scheduledTime})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:w.duration})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:m(w.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>f(w.id)},{label:"Edit Assessment",icon:a.jsx(wx,{}),onClick:()=>h(w.id)}]})})]},w.id))})]})})]})},wle=()=>{const[e,t]=v.useState([]),[r,s]=v.useState(!0),[n,i]=v.useState(null),[o,l]=v.useState("all"),[c,u]=v.useState(""),[d,m]=v.useState([]),{sortedData:f,sortConfig:h,handleSort:x}=Zt(e);v.useEffect(()=>{(async()=>{try{s(!0),await new Promise(T=>setTimeout(T,1e3)),t([{id:1,title:"Safety Procedures - Module 1",course:"Aviation Safety Management",trainee:"John Doe",dueDate:"2024-01-20",status:"pending",priority:"high",progress:65,instructor:"Dr. Smith",lastActivity:"2024-01-15",estimatedTime:"2 hours"},{id:2,title:"Engine Maintenance - Part A",course:"Aircraft Maintenance",trainee:"Jane Smith",dueDate:"2024-01-18",status:"in_progress",priority:"medium",progress:30,instructor:"Jane Doe",lastActivity:"2024-01-16",estimatedTime:"3 hours"},{id:3,title:"Navigation Systems - Theory",course:"Flight Operations",trainee:"Mike Johnson",dueDate:"2024-01-22",status:"completed",priority:"low",progress:100,instructor:"Mike Johnson",lastActivity:"2024-01-17",estimatedTime:"1.5 hours"},{id:4,title:"Regulatory Compliance - Section 2",course:"Aviation Regulations",trainee:"Sarah Wilson",dueDate:"2024-01-19",status:"overdue",priority:"high",progress:45,instructor:"Sarah Wilson",lastActivity:"2024-01-14",estimatedTime:"2.5 hours"},{id:5,title:"Emergency Response - Practical",course:"Crisis Management",trainee:"David Brown",dueDate:"2024-01-25",status:"pending",priority:"medium",progress:0,instructor:"David Brown",lastActivity:"2024-01-12",estimatedTime:"4 hours"}])}catch(C){i("Failed to fetch section completion data"),console.error("Error fetching sections:",C)}finally{s(!1)}})()},[]);const p=N=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},overdue:{variant:"danger",text:"Overdue"}}[N]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:T.variant,children:T.text})},g=N=>{const T={high:{variant:"danger",text:"High"},medium:{variant:"warning",text:"Medium"},low:{variant:"success",text:"Low"}}[N]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:T.variant,className:"me-1",children:T.text})},b=[...new Set(e.map(N=>N.status))],y=f.filter(N=>{const C=d.length===0||d.includes(N.status),T=c===""||N.title.toLowerCase().includes(c.toLowerCase())||N.course.toLowerCase().includes(c.toLowerCase())||N.trainee.toLowerCase().includes(c.toLowerCase());return C&&T}),j=N=>{m(N==="clear"?[]:C=>C.includes(N)?C.filter(T=>T!==N):[...C,N])},S=()=>{m([]),u("")},E=N=>{console.log("View details for section:",N)},w=N=>{console.log("Mark complete for section:",N)};return r?a.jsx(Rt,{}):n?a.jsxs(Re,{variant:"danger",className:"m-4",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:n})]}):a.jsxs("div",{className:"p-4",children:[a.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search sections, trainees, or courses...",value:c,onChange:u,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:b,selectedStatuses:d,onStatusToggle:j,onClearFilters:S,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>x("title"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Section ",a.jsx(rr,{sortConfig:h,columnKey:"title"})]}),a.jsxs("th",{onClick:()=>x("course"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Course ",a.jsx(rr,{sortConfig:h,columnKey:"course"})]}),a.jsxs("th",{onClick:()=>x("trainee"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Trainee ",a.jsx(rr,{sortConfig:h,columnKey:"trainee"})]}),a.jsxs("th",{onClick:()=>x("dueDate"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Due Date ",a.jsx(rr,{sortConfig:h,columnKey:"dueDate"})]}),a.jsxs("th",{onClick:()=>x("status"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Status ",a.jsx(rr,{sortConfig:h,columnKey:"status"})]}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),a.jsx("tbody",{children:y.map(N=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:N.title}),a.jsxs("small",{className:"text-muted",children:[a.jsx(ft,{size:12,className:"me-1"}),"Est. ",N.estimatedTime]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:N.course}),a.jsxs("small",{className:"text-muted",children:[a.jsx(Lt,{size:12,className:"me-1"}),N.instructor]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:N.trainee}),a.jsxs("small",{className:"text-muted",children:["Last activity: ",N.lastActivity]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:N.dueDate}),a.jsx("small",{className:"text-muted",children:g(N.priority)})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[p(N.status),a.jsx("div",{className:"mt-1",children:a.jsxs("small",{className:"text-muted",children:["Progress: ",N.progress,"%"]})})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>E(N.id)},{label:"Mark Complete",icon:a.jsx(ht,{}),onClick:()=>w(N.id)}]})})]},N.id))})]})})]})},Nle=()=>{const[e,t]=v.useState("upcoming-assessments"),r=[{id:"upcoming-assessments",title:"Upcoming Assessments",icon:Ra,component:a.jsx(jle,{})},{id:"section-completion",title:"Section Required Completion",icon:Dt,component:a.jsx(wle,{})}],s=r.find(n=>n.id===e);return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0",children:[a.jsx(W.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:r.map(n=>{const i=n.icon,o=e===n.id;return a.jsxs("button",{className:`custom-tab ${o?"active":""}`,onClick:()=>t(n.id),children:[a.jsx(i,{size:16,className:"me-2"}),n.title]},n.id)})})}),a.jsx(W.Body,{className:"p-0",children:s&&s.component})]})})})})},Sle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:x,handleSort:p}=Zt(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(I=>setTimeout(I,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{o("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=_=>{const I={completed:{variant:"success",text:"Completed",icon:ht},failed:{variant:"danger",text:"Failed",icon:Qs},inProgress:{variant:"warning",text:"In Progress",icon:ft},pending:{variant:"info",text:"Pending Review",icon:ft}}[_]||{variant:"secondary",text:_,icon:ft},L=I.icon;return a.jsxs(Ae,{bg:I.variant,className:"d-flex align-items-center",children:[a.jsx(L,{size:12,className:"me-1"}),I.text]})},b=_=>_.startsWith("A")?"success":_.startsWith("B")?"primary":_.startsWith("C")?"warning":_.startsWith("D")?"danger":"secondary",y=(_,k)=>{const I=_/k*100;return I>=90?"success":I>=80?"primary":I>=70?"warning":"danger"},j=[...new Set(t.map(_=>_.status))],S=t.filter(_=>{const k=m.length===0||m.includes(_.status),I=_.title.toLowerCase().includes(u.toLowerCase())||_.trainee.toLowerCase().includes(u.toLowerCase())||_.course.toLowerCase().includes(u.toLowerCase());return k&&I}),E=_=>{f(_==="clear"?[]:k=>k.includes(_)?k.filter(I=>I!==_):[...k,_])},w=()=>{f([]),d("")},N=_=>{e(`/trainer/assessment-details/${_}`)},C=_=>{console.log("Downloading result:",_)};if(s)return a.jsx(Rt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No assessment results found"}),a.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const T=({columnKey:_,children:k,className:I=""})=>{const L=x.key===_,D=L?x.direction:null;return a.jsxs("th",{className:`fw-semibold ${I}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>p(_),onMouseEnter:M=>{M.target.style.backgroundColor="#214760",M.target.style.transform="translateY(-1px)",M.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:M=>{M.target.style.backgroundColor="var(--bs-primary)",M.target.style.transform="translateY(0)",M.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:L?"600":"500",color:"white"},children:k}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:D,size:14,color:"white"})})]}),L&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search assessments, trainees, or courses...",value:u,onChange:d,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:j,selectedStatuses:m,onStatusToggle:E,onClearFilters:w,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[S.length," result",S.length!==1?"s":""]})})})]}),S.length===0?a.jsx(W,{className:"text-center py-5",children:a.jsxs(W.Body,{children:[a.jsx(ht,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No Results Found"}),a.jsx("p",{className:"text-muted",children:u||l!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(u||l!=="all")&&a.jsx(ie,{variant:"outline-primary",onClick:()=>{d(""),c("all")},children:"Clear Filters"})]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(T,{columnKey:"title",className:"show-mobile",children:"Assessment"}),a.jsx(T,{columnKey:"course",className:"show-mobile",children:"Course"}),a.jsx(T,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),a.jsx(T,{columnKey:"score",className:"show-mobile",children:"Score"}),a.jsx(T,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),a.jsx(T,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),a.jsx(T,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(_=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:_.title}),a.jsxs("small",{className:"text-muted",children:["Attempt ",_.attempts,"  ",_.duration]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:_.course})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:_.trainee})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`fw-bold text-${y(_.score,_.maxScore)}`,children:[_.score,"/",_.maxScore]}),a.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(_.score/_.maxScore*100),"%)"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx(Ae,{bg:b(_.grade),className:"fs-6",children:_.grade})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsx("div",{children:a.jsx("div",{className:"fw-medium",children:_.completedDate})})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:g(_.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>N(_.id)},{label:"Download Report",icon:a.jsx($i,{}),onClick:()=>C(_.id)}]})})]},_.id))})]})})]})},Ele=()=>a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(Sle,{})}),Tle=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:x,handleSort:p}=Zt(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(k=>setTimeout(k,1e3)),r([{id:1,title:"Aviation Safety Management",code:"ASM-101",department:"Safety & Security",status:"active",startDate:"2024-01-15",endDate:"2024-03-15",enrolledTrainees:25,maxTrainees:30,totalSubjects:8,completedSubjects:3,instructor:"Dr. John Smith",location:"Training Center A",schedule:"Mon, Wed, Fri 9:00-12:00"},{id:2,title:"Aircraft Maintenance Fundamentals",code:"AMF-201",department:"Maintenance",status:"active",startDate:"2024-01-20",endDate:"2024-04-20",enrolledTrainees:18,maxTrainees:20,totalSubjects:12,completedSubjects:5,instructor:"Jane Doe",location:"Lab B",schedule:"Tue, Thu 14:00-17:00"},{id:3,title:"Flight Operations Management",code:"FOM-301",department:"Operations",status:"scheduled",startDate:"2024-02-01",endDate:"2024-05-01",enrolledTrainees:0,maxTrainees:15,totalSubjects:10,completedSubjects:0,instructor:"Mike Johnson",location:"Simulator Room",schedule:"Mon-Fri 8:00-16:00"},{id:4,title:"Aviation Regulations & Compliance",code:"ARC-401",department:"Compliance",status:"completed",startDate:"2023-10-01",endDate:"2023-12-15",enrolledTrainees:22,maxTrainees:25,totalSubjects:6,completedSubjects:6,instructor:"Sarah Wilson",location:"Conference Room C",schedule:"Sat 9:00-17:00"},{id:5,title:"Emergency Response Procedures",code:"ERP-501",department:"Safety & Security",status:"paused",startDate:"2024-01-10",endDate:"2024-02-28",enrolledTrainees:12,maxTrainees:20,totalSubjects:4,completedSubjects:1,instructor:"David Brown",location:"Training Center B",schedule:"Wed, Fri 10:00-14:00"}])}catch{o("Failed to load instructed courses")}finally{n(!1)}})()},[]);const g=T=>{const k={active:{variant:"success",text:"Active"},scheduled:{variant:"primary",text:"Scheduled"},completed:{variant:"secondary",text:"Completed"},paused:{variant:"warning",text:"Paused"},cancelled:{variant:"danger",text:"Cancelled"}}[T]||{variant:"secondary",text:T};return a.jsx(Ae,{bg:k.variant,children:k.text})},b=(T,_)=>_>0?Math.round(T/_*100):0,y=(T,_)=>_>0?Math.round(T/_*100):0,j=[...new Set(t.map(T=>T.status))],S=t.filter(T=>{const _=m.length===0||m.includes(T.status),k=T.title.toLowerCase().includes(u.toLowerCase())||T.code.toLowerCase().includes(u.toLowerCase())||T.department.toLowerCase().includes(u.toLowerCase());return _&&k}),E=T=>{f(T==="clear"?[]:_=>_.includes(T)?_.filter(k=>k!==T):[..._,T])},w=()=>{f([]),d("")},N=T=>{e(`/trainer/courses/${T}`)};if(s)return a.jsx(Rt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No instructed courses found"}),a.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const C=({columnKey:T,children:_,className:k=""})=>{const I=x.key===T,L=I?x.direction:null;return a.jsxs("th",{className:`fw-semibold ${k}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>p(T),onMouseEnter:D=>{D.target.style.backgroundColor="#214760",D.target.style.transform="translateY(-1px)",D.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:D=>{D.target.style.backgroundColor="var(--bs-primary)",D.target.style.transform="translateY(0)",D.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:I?"600":"500",color:"white"},children:_}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:L,size:14,color:"white"})})]}),I&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search courses, codes, or departments...",value:u,onChange:d,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:j,selectedStatuses:m,onStatusToggle:E,onClearFilters:w,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[S.length," course",S.length!==1?"s":""]})})})]}),S.length===0?a.jsx(W,{className:"text-center py-5",children:a.jsxs(W.Body,{children:[a.jsx(It,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No Courses Found"}),a.jsx("p",{className:"text-muted",children:u||l!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),u||m.length>0?a.jsx(ie,{variant:"outline-primary",onClick:w,children:"Clear Filters"}):null]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(C,{columnKey:"title",className:"show-mobile",children:"Course"}),a.jsx(C,{columnKey:"department",className:"show-mobile",children:"Department"}),a.jsx(C,{columnKey:"schedule",className:"hide-mobile",children:"Schedule"}),a.jsx(C,{columnKey:"enrollment",className:"show-mobile",children:"Enrollment"}),a.jsx(C,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(T=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:T.title}),a.jsxs("small",{className:"text-muted",children:[T.code,"  ",T.location]}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:[a.jsx(nr,{size:12,className:"me-1"}),T.startDate," - ",T.endDate]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsx("span",{className:"text-muted",children:T.department})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:T.schedule}),a.jsx("small",{className:"text-muted",children:T.instructor})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lr,{size:16,className:"me-2 text-muted"}),a.jsxs("span",{className:"fw-medium",children:[T.enrolledTrainees,"/",T.maxTrainees]})]}),a.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:a.jsx("div",{className:"progress-bar bg-info",style:{width:`${y(T.enrolledTrainees,T.maxTrainees)}%`}})}),a.jsxs("small",{className:"text-muted",children:[y(T.enrolledTrainees,T.maxTrainees),"% full"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsxs("span",{className:"fw-medium",children:[T.completedSubjects,"/",T.totalSubjects]})]}),a.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:a.jsx("div",{className:"progress-bar bg-success",style:{width:`${b(T.completedSubjects,T.totalSubjects)}%`}})}),a.jsxs("small",{className:"text-muted",children:[b(T.completedSubjects,T.totalSubjects),"% complete"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:g(T.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Course Detail",icon:a.jsx(Et,{}),onClick:()=>N(T.id)}]})})]},T.id))})]})})]})},Cle=()=>a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(Tle,{})}),Ale=({courseId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(C=>setTimeout(C,1e3)),s([{id:1,title:"Safety Procedures - Module 1",code:"SP-101",duration:"2 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-20",progress:100,description:"Introduction to aviation safety procedures and protocols"},{id:2,title:"Risk Assessment Fundamentals",code:"RAF-102",duration:"3 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-25",progress:100,description:"Understanding risk assessment methodologies in aviation"},{id:3,title:"Emergency Response Protocols",code:"ERP-103",duration:"2.5 hours",status:"in_progress",instructor:"Dr. Smith",completionDate:null,progress:65,description:"Emergency response procedures and communication protocols"},{id:4,title:"Regulatory Compliance",code:"RC-104",duration:"4 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Understanding aviation regulations and compliance requirements"},{id:5,title:"Safety Management Systems",code:"SMS-105",duration:"3.5 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Implementation and management of safety management systems"}])}catch(N){l("Failed to load subjects"),console.error("Error fetching subjects:",N)}finally{i(!1)}})()},[e]);const f=w=>{const C={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[w]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:C.variant,children:C.text})},h=w=>{t(`/trainer/subjects/${w}`)},x=[...new Set(r.map(w=>w.status))],p=r.filter(w=>{const N=d.length===0||d.includes(w.status),C=w.title.toLowerCase().includes(c.toLowerCase())||w.code.toLowerCase().includes(c.toLowerCase())||w.description.toLowerCase().includes(c.toLowerCase());return N&&C}),g=w=>{m(w==="clear"?[]:N=>N.includes(w)?N.filter(C=>C!==w):[...N,w])},b=()=>{m([]),u("")},{sortedData:y,sortConfig:j,handleSort:S}=Zt(p);if(n)return a.jsx(Rt,{rows:5,columns:6});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(p.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const E=({columnKey:w,children:N,className:C=""})=>{const T=j.key===w,_=T?j.direction:null;return a.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(w),onMouseEnter:k=>{k.target.style.backgroundColor="#214760",k.target.style.transform="translateY(-1px)",k.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:k=>{k.target.style.backgroundColor="var(--bs-primary)",k.target.style.transform="translateY(0)",k.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:N}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:_,size:14,color:"white"})})]}),T&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search subjects...",value:c,onChange:u,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:x,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"title",className:"show-mobile",children:"Subject"}),a.jsx(E,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(E,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(E,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map(w=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:w.title}),a.jsx("small",{className:"text-muted",children:w.description})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:w.code})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:w.duration})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(w.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${w.progress}%`},"aria-valuenow":w.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>h(w.id)}]})})]},w.id))})]})})]})},kle=({courseId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(C=>setTimeout(C,1e3)),s([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"active",progress:75,lastActivity:"2024-01-20",completedSubjects:6,totalSubjects:8},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"active",progress:60,lastActivity:"2024-01-19",completedSubjects:5,totalSubjects:8},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"completed",progress:100,lastActivity:"2024-01-25",completedSubjects:8,totalSubjects:8},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"inactive",progress:25,lastActivity:"2024-01-22",completedSubjects:2,totalSubjects:8},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"active",progress:40,lastActivity:"2024-01-23",completedSubjects:3,totalSubjects:8}])}catch(N){l("Failed to load trainees"),console.error("Error fetching trainees:",N)}finally{i(!1)}})()},[e]);const f=w=>{const C={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[w]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:C.variant,children:C.text})},h=w=>{t(`/trainer/trainees/${w}`)},x=[...new Set(r.map(w=>w.status))],p=r.filter(w=>{const N=d.length===0||d.includes(w.status),C=w.name.toLowerCase().includes(c.toLowerCase())||w.email.toLowerCase().includes(c.toLowerCase())||w.employeeId.toLowerCase().includes(c.toLowerCase())||w.department.toLowerCase().includes(c.toLowerCase());return N&&C}),g=w=>{m(w==="clear"?[]:N=>N.includes(w)?N.filter(C=>C!==w):[...N,w])},b=()=>{m([]),u("")},{sortedData:y,sortConfig:j,handleSort:S}=Zt(p);if(n)return a.jsx(Rt,{rows:5,columns:7});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(p.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const E=({columnKey:w,children:N,className:C=""})=>{const T=j.key===w,_=T?j.direction:null;return a.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(w),onMouseEnter:k=>{k.target.style.backgroundColor="#214760",k.target.style.transform="translateY(-1px)",k.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:k=>{k.target.style.backgroundColor="var(--bs-primary)",k.target.style.transform="translateY(0)",k.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:N}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:_,size:14,color:"white"})})]}),T&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search trainees...",value:c,onChange:u,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:x,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(E,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(E,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(E,{columnKey:"enrollmentDate",className:"show-mobile",children:"Enrollment Date"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(E,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map(w=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:w.name}),a.jsx("small",{className:"text-muted",children:w.email})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:w.employeeId})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:w.department})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:w.enrollmentDate}),a.jsxs("small",{className:"text-muted",children:["Last activity: ",w.lastActivity]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(w.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${w.progress}%`},"aria-valuenow":w.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[w.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Profile",icon:a.jsx(Et,{}),onClick:()=>h(w.id)}]})})]},w.id))})]})})]})},_le=()=>{const{courseId:e}=Nr(),t=it(),[r,s]=v.useState("subjects"),[n,i]=v.useState(null),[o,l]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),await new Promise(x=>setTimeout(x,1e3)),i({id:e,title:"Aviation Safety Management",code:"ASM-101",department:"Aviation Department",instructor:"Dr. Smith",startDate:"2024-01-15",endDate:"2024-03-15",status:"active",location:"Training Room A",schedule:"Mon, Wed, Fri 09:00-12:00",description:"Comprehensive course covering aviation safety management systems, risk assessment, and regulatory compliance.",maxEnrollment:30,currentEnrollment:25,completedSubjects:8,totalSubjects:12})}catch(h){u("Failed to load course details"),console.error("Error fetching course:",h)}finally{l(!1)}})()},[e]);const d=[{id:"subjects",title:"Subject List",icon:It,component:a.jsx(Ale,{courseId:e})},{id:"trainees",title:"Trainee List",icon:Lr,component:a.jsx(kle,{courseId:e})}],m=d.find(f=>f.id===r);return o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:c})]})}):n?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t("/trainer/instructed-courses"),children:a.jsx(_t,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.title}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.department]})]})]})})}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0",children:[a.jsx(W.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:d.map(f=>{const h=f.icon,x=r===f.id;return a.jsxs("button",{className:`custom-tab ${x?"active":""}`,onClick:()=>s(f.id),children:[a.jsx(h,{size:16,className:"me-2"}),f.title]},f.id)})})}),a.jsx(W.Body,{className:"p-0",children:m&&m.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Course Not Found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},Ile=()=>{const{traineeId:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),s({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(d){l("Failed to load trainee details"),console.error("Error fetching trainee:",d)}finally{i(!1)}})()},[e]);const c=u=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[u]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:m.variant,children:m.text})};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:a.jsx(_t,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:r.name}),a.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1",children:"Status"}),c(r.status)]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(It,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1",children:"Courses"}),a.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),a.jsx("h6",{className:"mb-1",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(nr,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1",children:"Enrolled"}),a.jsx("h4",{className:"mb-0 text-warning",children:r.enrollmentDate}),a.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:6,children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Contact Information"})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(Ti,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Email:"})," ",r.email]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Position:"})," ",r.position]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(nr,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Last Activity:"})," ",r.lastActivity]})]})]})}),a.jsx(z,{md:6,children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Current Courses"})}),a.jsx(W.Body,{children:r.currentCourses.map(u=>a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[a.jsx("h6",{className:"mb-0",children:u.name}),a.jsxs("small",{className:"text-muted",children:[u.progress,"%"]})]}),a.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${u.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:["Instructor: ",u.instructor]})]},u.id))})]})})]}),a.jsx(de,{children:a.jsx(z,{children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Certifications"})}),a.jsx(W.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Certification"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Status"})]})}),a.jsx("tbody",{children:r.certifications.map((u,d)=>a.jsxs("tr",{children:[a.jsx("td",{children:u.name}),a.jsx("td",{children:u.date}),a.jsx("td",{children:c(u.status)})]},d))})]})})})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Trainee Not Found"}),a.jsx("p",{children:"The requested trainee could not be found."})]})})},Ple=({subjectId:e})=>{const t=it(),[r,s]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),s([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(C){l("Failed to load trainees in subject"),console.error("Error fetching trainees:",C)}finally{i(!1)}})()},[e]);const f=N=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[N]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:T.variant,children:T.text})},h=N=>{t(`/trainer/trainees/${N}`)},x=N=>{console.log("Send message to trainee:",N)},p=[...new Set(r.map(N=>N.status))],g=r.filter(N=>{const C=d.length===0||d.includes(N.status),T=N.name.toLowerCase().includes(c.toLowerCase())||N.email.toLowerCase().includes(c.toLowerCase())||N.employeeId.toLowerCase().includes(c.toLowerCase())||N.department.toLowerCase().includes(c.toLowerCase());return C&&T}),b=N=>{m(N==="clear"?[]:C=>C.includes(N)?C.filter(T=>T!==N):[...C,N])},y=()=>{m([]),u("")},{sortedData:j,sortConfig:S,handleSort:E}=Zt(g);if(n)return a.jsx(Rt,{rows:5,columns:7});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(ie,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const w=({columnKey:N,children:C,className:T=""})=>{const _=S.key===N,k=_?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(N),onMouseEnter:I=>{I.target.style.backgroundColor="#214760",I.target.style.transform="translateY(-1px)",I.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:I=>{I.target.style.backgroundColor="var(--bs-primary)",I.target.style.transform="translateY(0)",I.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:_?"600":"500",color:"white"},children:C}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(rr,{direction:k,size:14,color:"white"})})]}),_&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search trainees in this subject...",value:c,onChange:u,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:p,selectedStatuses:d,onStatusToggle:b,onClearFilters:y,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(w,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(w,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(w,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(w,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx(w,{columnKey:"score",className:"hide-mobile",children:"Score"}),a.jsx(w,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:j.map(N=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:N.name}),a.jsxs("small",{className:"text-muted",children:[a.jsx(Ti,{size:12,className:"me-1"}),N.email]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.employeeId})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:N.department})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:N.score?a.jsxs(Ae,{bg:N.score>=80?"success":N.score>=60?"warning":"danger",children:[N.score,"%"]}):a.jsx("span",{className:"text-muted",children:"-"})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Trainee Details",icon:a.jsx(Et,{}),onClick:()=>h(N.id)},{label:"Send Message",icon:a.jsx(Ti,{}),onClick:()=>x(N.id)}]})})]},N.id))})]})})]})},Dle=()=>{const{subjectId:e}=Nr(),t=it(),[r,s]=v.useState("trainees"),[n,i]=v.useState(null),[o,l]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),await new Promise(p=>setTimeout(p,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(x){u("Failed to load subject details"),console.error("Error fetching subject:",x)}finally{l(!1)}})()},[e]);const d=h=>{const p={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[h]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:p.variant,children:p.text})},m=[{id:"trainees",title:"Trainee List",icon:Lt,component:a.jsx(Ple,{subjectId:e})}],f=m.find(h=>h.id===r);return o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:c})]})}):n?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:a.jsx(_t,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.title}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(ft,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1",children:"Duration"}),a.jsx("h4",{className:"mb-0 text-primary",children:n.duration}),a.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1",children:"Trainees"}),a.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),a.jsx("h6",{className:"mb-1",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx(ht,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1",children:"Status"}),d(n.status)]})})})]}),a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:6,children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Subject Information"})}),a.jsxs(W.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Description:"})," ",n.description]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(ft,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),a.jsx(z,{md:6,children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Materials"})}),a.jsx(W.Body,{children:n.materials.map((h,x)=>a.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"fw-medium",children:h.name}),a.jsx("small",{className:"text-muted d-block",children:h.type})]}),a.jsx("small",{className:"text-muted",children:h.size})]},x))})]})})]}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{children:[a.jsx(W.Header,{children:a.jsx("h5",{className:"mb-0",children:"Assessments"})}),a.jsx(W.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Assessment"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Max Score"}),a.jsx("th",{children:"Average Score"})]})}),a.jsx("tbody",{children:n.assessments.map((h,x)=>a.jsxs("tr",{children:[a.jsx("td",{children:h.name}),a.jsx("td",{children:h.type}),a.jsx("td",{children:h.maxScore}),a.jsx("td",{children:h.averageScore})]},x))})]})})})]})})}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0",children:[a.jsx(W.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const x=h.icon,p=r===h.id;return a.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>s(h.id),children:[a.jsx(x,{size:16,className:"me-2"}),h.title]},h.id)})})}),a.jsx(W.Body,{className:"p-0",children:f&&f.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Subject Not Found"}),a.jsx("p",{children:"The requested subject could not be found."})]})})},Ole=()=>{const e=it(),[t,r]=v.useState(null),[s,n]=v.useState(null),[i,o]=v.useState(!1),[l,c]=v.useState(!1),[u,d]=v.useState({type:"",text:""}),m=p=>{const g=p.target.files[0];if(g)if(g.type.startsWith("image/")){const b=new FileReader;b.onload=y=>{r(g),n(y.target.result)},b.readAsDataURL(g)}else d({type:"danger",text:"Please upload an image file."})},f=async()=>{if(!t){d({type:"warning",text:"Please upload a signature first."});return}c(!0);try{await new Promise(p=>setTimeout(p,2e3)),d({type:"success",text:"Signature saved successfully!"})}catch{d({type:"danger",text:"Failed to save signature. Please try again."})}finally{c(!1)}},h=()=>{r(null),n(null),d({type:"info",text:"Signature removed."})},x=()=>{e("/profile")};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsxs(z,{children:[a.jsx("div",{className:"d-flex align-items-center mb-3",children:a.jsxs(ie,{variant:"outline-secondary",onClick:x,className:"me-3",children:[a.jsx(_t,{size:16,className:"me-2"}),"Back to Profile"]})}),a.jsx("h2",{className:"mb-2",children:"Configure Signature"}),a.jsx("p",{className:"text-muted",children:"Upload and manage your digital signature for assessments"})]})}),u.text&&a.jsx(Re,{variant:u.type,className:"mb-4",children:u.text}),a.jsxs(de,{children:[a.jsx(z,{lg:8,children:a.jsxs(W,{children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(va,{size:20,className:"me-2"}),"Digital Signature"]})}),a.jsx(W.Body,{className:"p-4",children:a.jsxs(A,{children:[a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{children:"Upload Signature Image"}),a.jsx(A.Control,{type:"file",accept:"image/*",onChange:m,className:"mb-3"}),a.jsx(A.Text,{className:"text-muted",children:"Supported formats: JPG, PNG, GIF. Maximum size: 2MB"})]}),s&&a.jsxs(A.Group,{className:"mb-4",children:[a.jsx(A.Label,{children:"Signature Preview"}),a.jsx("div",{className:"border rounded p-3 text-center bg-light",children:a.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"200px"},className:"img-fluid"})})]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx(ie,{variant:"primary",onClick:f,disabled:!t||l,children:l?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{size:16,className:"me-2"}),"Save Signature"]})}),s&&a.jsxs(a.Fragment,{children:[a.jsxs(ie,{variant:"outline-info",onClick:()=>o(!0),children:[a.jsx(Et,{size:16,className:"me-2"}),"Preview"]}),a.jsxs(ie,{variant:"outline-danger",onClick:h,children:[a.jsx(Wi,{size:16,className:"me-2"}),"Remove"]})]})]})]})})]})}),a.jsxs(z,{lg:4,children:[a.jsxs(W,{children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Signature Guidelines"})}),a.jsx(W.Body,{children:a.jsxs("ul",{className:"list-unstyled mb-0",children:[a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Format:"})," Use clear, high-contrast signature"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Size:"})," Recommended 300x100 pixels"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Background:"})," White or transparent background"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Quality:"})," High resolution for clarity"]})}),a.jsx("li",{className:"mb-0",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Usage:"})," Will be used on all assessment documents"]})})]})})]}),a.jsxs(W,{className:"mt-3",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Current Status"})}),a.jsx(W.Body,{children:a.jsx("div",{className:"text-center",children:t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-success mb-2",children:a.jsx(va,{size:32})}),a.jsx("h6",{className:"text-success",children:"Signature Configured"}),a.jsx("small",{className:"text-muted",children:"Your signature is ready for use"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-muted mb-2",children:a.jsx(va,{size:32})}),a.jsx("h6",{className:"text-muted",children:"No Signature"}),a.jsx("small",{className:"text-muted",children:"Upload a signature to get started"})]})})})]})]})]}),a.jsxs(ce,{show:i,onHide:()=>o(!1),size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:"Signature Preview"})}),a.jsx(ce.Body,{className:"text-center",children:s&&a.jsx("div",{className:"border rounded p-4 bg-light",children:a.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"300px"},className:"img-fluid"})})}),a.jsx(ce.Footer,{children:a.jsx(ie,{variant:"secondary",onClick:()=>o(!1),children:"Close"})})]})]})},Rle=()=>{const{resultId:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState("overview");v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(j=>setTimeout(j,1e3)),s({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(y){l("Failed to fetch assessment details."),console.error(y)}finally{i(!1)}})()},[e]);const d=(b,y)=>{const j=b/y*100;return j>=80?"success":j>=60?"warning":"danger"},m=b=>b.includes("A")?"success":b.includes("B")?"info":b.includes("C")?"warning":"danger",f=b=>{const y={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},j=y[b]||y.pending;return a.jsx(Ae,{bg:j.bg,children:j.text})},h=()=>{console.log("Downloading report for result:",e)},x=()=>{t(`/trainer/approval-notes/${e}`)};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Rt,{height:400})})})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Re,{variant:"danger",children:o})})})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Re,{variant:"info",children:"Assessment result not found"})})})});const p=[{id:"overview",title:"Assessment Overview",icon:At,component:a.jsx("div",{className:"p-4",children:a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),a.jsx("h5",{className:"mb-0",children:r.title})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Course"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.course})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.trainee})]})]})]}),a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`h4 mb-0 text-${d(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),a.jsx(Ae,{bg:m(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Status"}),f(r.status)]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:k2,component:a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),a.jsx("tbody",{children:r.sections.map(b=>a.jsxs("tr",{children:[a.jsx("td",{className:"fw-bold",children:b.name}),a.jsx("td",{children:a.jsxs("span",{className:`fw-bold text-${d(b.score,b.maxScore)}`,children:[b.score,"/",b.maxScore]})}),a.jsx("td",{children:f(b.status)}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ft,{size:14,className:"me-1 text-muted"}),a.jsx("span",{children:b.timeSpent})]})})]},b.id))})]})})}],g=p.find(b=>b.id===c);return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:()=>t("/trainer/assessment-results"),children:[a.jsx(_t,{size:16,className:"me-2"}),"Back to Results"]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsxs(ie,{variant:"outline-primary",onClick:h,children:[a.jsx($i,{size:16,className:"me-2"}),"Download Report"]}),a.jsxs(ie,{variant:"outline-secondary",onClick:x,children:[a.jsx(Et,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),a.jsx(de,{children:a.jsx(z,{children:a.jsxs(W,{className:"border-0",children:[a.jsx(W.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:p.map(b=>{const y=b.icon,j=c===b.id;return a.jsxs("button",{className:`custom-tab ${j?"active":""}`,onClick:()=>u(b.id),children:[a.jsx(y,{size:16,className:"me-2"}),b.title]},b.id)})})}),a.jsx(W.Body,{className:"p-0",children:g&&g.component})]})})})]})},Fle=()=>{const{resultId:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,h]=v.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(N=>setTimeout(N,1e3));const w={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};s(w),h({status:w.approvalStatus,notes:w.approvalNotes,approvedBy:"",approvedDate:""})}catch(w){l("Failed to load assessment result data"),console.error("Error fetching result data:",w)}finally{i(!1)}})()},[e]);const x=(E,w)=>{const N=E/w*100;return N>=80?"success":N>=60?"warning":"danger"},p=E=>E.includes("A")?"success":E.includes("B")?"info":E.includes("C")?"warning":"danger",g=E=>{const w={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},N=w[E]||w.pending;return a.jsx(Ae,{bg:N.bg,children:N.text})},b=(E,w)=>{h(N=>({...N,[E]:w}))},y=async()=>{try{u(!0),await new Promise(E=>setTimeout(E,1500)),s(E=>({...E,approvalStatus:f.status,approvalNotes:f.notes})),m(!1),console.log("Approval saved successfully")}catch(E){console.error("Error saving approval:",E)}finally{u(!1)}},j=()=>{h(E=>({...E,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)},S=()=>{h(E=>({...E,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Rt,{height:400})})})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Re,{variant:"danger",children:o})})})}):r?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsxs(ie,{variant:"outline-secondary",size:"sm",onClick:()=>t(`/trainer/assessment-details/${e}`),className:"me-3",children:[a.jsx(_t,{size:16,className:"me-2"}),"Back to Details"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),a.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),a.jsxs(de,{children:[a.jsxs(z,{lg:8,children:[a.jsxs(W,{className:"mb-4",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(At,{size:20,className:"me-2"}),"Assessment Summary"]})}),a.jsx(W.Body,{children:a.jsxs(de,{children:[a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),a.jsx("h5",{className:"mb-0",children:r.title})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Course"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(It,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.course})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.trainee})]})]})]}),a.jsxs(z,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`h4 mb-0 text-${x(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),a.jsx(Ae,{bg:p(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(r.approvalStatus)]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.completedDate})]})]})]})]})})]}),a.jsxs(W,{className:"mb-4",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(wx,{size:20,className:"me-2"}),"Trainer Notes"]})}),a.jsx(W.Body,{children:a.jsx("p",{className:"mb-0",children:r.trainerNotes})})]}),r.previousApprovals&&r.previousApprovals.length>0&&a.jsxs(W,{className:"mb-4",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(ft,{size:20,className:"me-2"}),"Approval History"]})}),a.jsx(W.Body,{children:r.previousApprovals.map(E=>a.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[a.jsxs("div",{children:[a.jsxs("h6",{className:"mb-1",children:[E.type.charAt(0).toUpperCase()+E.type.slice(1)," Approval"]}),a.jsxs("small",{className:"text-muted",children:["Approved by ",E.approvedBy," on ",E.approvedDate]})]}),g(E.status)]}),E.notes&&a.jsx("p",{className:"mb-0 text-muted",children:E.notes})]},E.id))})]})]}),a.jsxs(z,{lg:4,children:[a.jsxs(W,{className:"mb-4",children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Current Status"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mb-3",children:g(r.approvalStatus)}),r.approvalNotes&&a.jsxs("div",{children:[a.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),a.jsx("p",{className:"small text-muted",children:r.approvalNotes})]})]})})]}),a.jsxs(W,{children:[a.jsx(W.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),a.jsx(W.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(ie,{variant:"success",onClick:j,className:"d-flex align-items-center justify-content-center",children:[a.jsx(ht,{size:16,className:"me-2"}),"Approve Result"]}),a.jsxs(ie,{variant:"danger",onClick:S,className:"d-flex align-items-center justify-content-center",children:[a.jsx(Qs,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),a.jsxs(ce,{show:d,onHide:()=>m(!1),size:"lg",children:[a.jsx(ce.Header,{closeButton:!0,children:a.jsx(ce.Title,{children:f.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),a.jsx(ce.Body,{children:a.jsxs(A,{children:[a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Approval Notes"}),a.jsx(A.Control,{as:"textarea",rows:4,value:f.notes,onChange:E=>b("notes",E.target.value),placeholder:"Enter your approval notes..."})]}),a.jsxs(A.Group,{className:"mb-3",children:[a.jsx(A.Label,{children:"Approved By"}),a.jsx(A.Control,{type:"text",value:f.approvedBy,onChange:E=>b("approvedBy",E.target.value),placeholder:"Enter your name"})]}),a.jsxs(A.Group,{children:[a.jsx(A.Label,{children:"Approval Date"}),a.jsx(A.Control,{type:"date",value:f.approvedDate,onChange:E=>b("approvedDate",E.target.value)})]})]})}),a.jsxs(ce.Footer,{children:[a.jsx(ie,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),a.jsx(ie,{variant:f.status==="approved"?"success":"danger",onClick:y,disabled:c,children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{size:16,className:"me-2"}),f.status==="approved"?"Approve":"Reject"]})})]})]})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(de,{children:a.jsx(z,{children:a.jsx(Re,{variant:"info",children:"Assessment result not found"})})})})},Lle=()=>{const e=it(),t=[{title:"View Course Details",description:"Access detailed course information and management",icon:It,path:"/department-head/my-department-details",color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:Dt,path:"/department-head/assessment-review-requests",color:"warning"},{title:"Department Statistics",description:"View department performance metrics",icon:Lr,path:"/department-head/statistics",color:"info"},{title:"Trainee Management",description:"Manage trainee enrollments and progress",icon:Lr,path:"/department-head/trainee-management",color:"success"}];return a.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:a.jsxs(_e,{className:"py-4",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{lg:12,children:a.jsxs(W,{className:"border-0 shadow-sm",children:[a.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Department Dashboard"})}),a.jsx(W.Body,{children:a.jsxs(de,{children:[a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(It,{size:24,className:"text-primary"})}),a.jsx("h3",{className:"mb-1 fw-bold",children:"12"}),a.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Lr,{size:24,className:"text-success"})}),a.jsx("h3",{className:"mb-1 fw-bold",children:"156"}),a.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Dt,{size:24,className:"text-warning"})}),a.jsx("h3",{className:"mb-1 fw-bold",children:"8"}),a.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Ra,{size:24,className:"text-info"})}),a.jsx("h3",{className:"mb-1 fw-bold",children:"24"}),a.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})})]})})}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{lg:12,children:a.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[a.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),a.jsx(W.Body,{children:a.jsx(de,{children:t.map((r,s)=>{const n=r.icon;return a.jsx(z,{md:6,lg:3,className:"mb-3",children:a.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(n,{size:24,className:`text-${r.color} me-2`}),a.jsx("h6",{className:"mb-0",children:r.title})]}),a.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),a.jsx(mn,{size:16,className:`text-${r.color} ms-auto`})]})},s)})})})]})})})]})})},Mle=({course:e,index:t,onView:r})=>{const s=i=>{const o={PLANNED:{variant:"info",icon:ft},ONGOING:{variant:"primary",icon:ht},COMPLETED:{variant:"success",icon:ht},CANCELLED:{variant:"secondary",icon:ft},active:{variant:"success",icon:ht},inactive:{variant:"secondary",icon:ft},pending:{variant:"warning",icon:ft}},l=o[i]||o.pending,c=l.icon;return a.jsxs(Ae,{bg:l.variant,className:"d-flex align-items-center",children:[a.jsx(c,{size:12,className:"me-1"}),i.toUpperCase()]})},n=i=>[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(i),permission:Te.COURSES.VIEW_DETAIL}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),a.jsx("small",{className:"text-muted",children:e.description})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:e.code})}),a.jsx("td",{className:"align-middle show-mobile",children:s(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lr,{size:16,className:"me-1 text-muted"}),a.jsx("span",{children:e.enrolledCount})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.COURSES.VIEW_DETAIL],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:n(e)})})})]})},Ble=()=>{const e=it(),{courseId:t}=Nr(),{user:r}=fs(),[s,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null),[u,d]=v.useState(""),[m,f]=v.useState("all"),[h,x]=v.useState(null),[p,g]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!r||!r.id){o(!1);return}try{o(!0),c(null);const N=((await kt.getDepartments({includeDeleted:!0})).departments||[]).find(k=>k.headUserId===r.id);if(!N){n([]),o(!1);return}const _=((await kt.getDepartmentById(N.id)).courses||[]).map(k=>({id:k.id,title:k.name,code:k.code,description:k.description||"",status:k.status||"PLANNED",enrolledCount:k.maxNumTrainee||0,startDate:k.startDate,endDate:k.endDate,level:k.level,venue:k.venue,passScore:k.passScore,subjectCount:k.subjectCount||0}));n(_)}catch(E){console.error("Error fetching courses:",E),c("Failed to load courses. Please try again later.")}finally{o(!1)}})()},[r]);const b=s.filter(S=>{const E=S.title.toLowerCase().includes(u.toLowerCase())||S.code.toLowerCase().includes(u.toLowerCase())||S.description&&S.description.toLowerCase().includes(u.toLowerCase()),w=m==="all"||S.status===m;return E&&w}),y=S=>{x(S),e(`/department-head/my-department-details/${S.id}`)};return[{id:"subjects",title:"Subject List",icon:It,component:a.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:Lr,component:a.jsx("div",{children:"Trainee List Component"})}].find(S=>S.id===p),i?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading courses..."})]})}):l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:l})]})}):a.jsx(_e,{fluid:!0,className:"py-4 my-department-details-page",children:a.jsxs(W,{className:"border-0 shadow-sm mb-0",children:[a.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsxs("h4",{className:"mb-0 text-white",children:[a.jsx(It,{className:"me-2"}),"Courses (",b.length,")"]})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search courses by title, code, or description...",value:u,onChange:d,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:m,onChange:S=>f(S.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"PLANNED",children:"Planned"}),a.jsx("option",{value:"ONGOING",children:"Ongoing"}),a.jsx("option",{value:"COMPLETED",children:"Completed"}),a.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[b.length," course",b.length!==1?"s":""]})})})]}),a.jsx(No,{data:b,loading:i,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(S,E)=>a.jsx(Mle,{course:S,index:E,onView:y},S.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})},zle=({request:e,index:t,onView:r,onApprove:s,onDeny:n})=>{const i=l=>{const c={pending:{variant:"warning",icon:ft},approved:{variant:"success",icon:ht},denied:{variant:"danger",icon:Qs}},u=c[l]||c.pending,d=u.icon;return a.jsxs(Ae,{bg:u.variant,className:"d-flex align-items-center",children:[a.jsx(d,{size:12,className:"me-1"}),l.toUpperCase()]})},o=l=>{const c=[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(l),permission:Te.ASSESSMENTS.VIEW_ALL}];return l.status==="pending"&&c.push({type:"divider"},{label:"Approve Results",icon:a.jsx(u2,{}),className:"text-success",onClick:()=>s(l),permission:Te.ASSESSMENTS.APPROVE},{label:"Deny Results",icon:a.jsx(nt,{}),className:"text-danger",onClick:()=>n(l),permission:Te.ASSESSMENTS.APPROVE}),c};return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.traineeName}),a.jsx("small",{className:"text-muted",children:e.traineeEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:e.courseTitle}),a.jsx("small",{className:"text-muted",children:e.courseCode})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:e.assessmentTitle}),a.jsx("small",{className:"text-muted",children:e.assessmentType})]})}),a.jsx("td",{className:"align-middle show-mobile",children:i(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(e.submittedDate).toLocaleDateString()})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"fw-medium",children:e.score?`${e.score}%`:"N/A"})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.ASSESSMENTS.VIEW_ALL,Te.ASSESSMENTS.APPROVE],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:o(e)})})})]})},t2=()=>{const e=it(),[t,r]=v.useState([]),[s,n]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("all");v.useEffect(()=>{const p=[{id:1,traineeName:"John Smith",traineeEmail:"john.smith@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Final Assessment",assessmentType:"Practical Exam",status:"pending",submittedDate:"2024-01-15T14:30:00Z",score:85,department:"IT Department"},{id:2,traineeName:"Sarah Johnson",traineeEmail:"sarah.johnson@company.com",courseTitle:"Database Management Systems",courseCode:"DMS-002",assessmentTitle:"Database Design Project",assessmentType:"Project",status:"pending",submittedDate:"2024-01-14T16:45:00Z",score:92,department:"IT Department"},{id:3,traineeName:"Mike Wilson",traineeEmail:"mike.wilson@company.com",courseTitle:"Web Development Advanced",courseCode:"WDA-003",assessmentTitle:"Frontend Development Test",assessmentType:"Written Exam",status:"approved",submittedDate:"2024-01-13T10:20:00Z",score:78,department:"IT Department"},{id:4,traineeName:"Emily Davis",traineeEmail:"emily.davis@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Midterm Assessment",assessmentType:"Practical Exam",status:"denied",submittedDate:"2024-01-12T09:15:00Z",score:45,department:"IT Department"}];setTimeout(()=>{r(p),n(!1)},1e3)},[]);const u=t.filter(p=>{const g=p.traineeName.toLowerCase().includes(i.toLowerCase())||p.courseTitle.toLowerCase().includes(i.toLowerCase())||p.assessmentTitle.toLowerCase().includes(i.toLowerCase()),b=l==="all"||p.status===l;return g&&b}),d=p=>{e(`/department-head/assessment-review-requests/${p.id}`)},m=p=>{console.log("Approve request:",p),r(g=>g.map(b=>b.id===p.id?{...b,status:"approved"}:b))},f=p=>{console.log("Deny request:",p),r(g=>g.map(b=>b.id===p.id?{...b,status:"denied"}:b))},x=(()=>{const p=t.reduce((g,b)=>(g[b.status]=(g[b.status]||0)+1,g),{});return{pending:p.pending||0,approved:p.approved||0,denied:p.denied||0,total:t.length}})();return s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):a.jsx(_e,{fluid:!0,className:"py-4 assessment-review-requests-page",children:a.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[a.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(de,{className:"align-items-center",children:a.jsx(z,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/dashboard"),children:a.jsx(_t,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),a.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})]})})})}),a.jsxs(W.Body,{children:[a.jsxs(de,{className:"mb-4",children:[a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(ft,{size:24,className:"text-warning"})}),a.jsx("h5",{className:"mb-1",children:x.pending}),a.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(ht,{size:24,className:"text-success"})}),a.jsx("h5",{className:"mb-1",children:x.approved}),a.jsx("p",{className:"text-muted mb-0",children:"Approved"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-danger bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Qs,{size:24,className:"text-danger"})}),a.jsx("h5",{className:"mb-1",children:x.denied}),a.jsx("p",{className:"text-muted mb-0",children:"Denied"})]})})}),a.jsx(z,{md:3,className:"mb-3",children:a.jsx(W,{className:"h-100 border-0 shadow-sm",children:a.jsxs(W.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Dt,{size:24,className:"text-primary"})}),a.jsx("h5",{className:"mb-1",children:x.total}),a.jsx("p",{className:"text-muted mb-0",children:"Total Requests"})]})})})]}),a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search requests by trainee name, course, or assessment...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:p=>c(p.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"denied",children:"Denied"})]})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[u.length," request",u.length!==1?"s":""]})})})]}),a.jsx(No,{data:u,loading:s,columns:[{key:"traineeName",title:"Trainee Name",className:"show-mobile",sortable:!0},{key:"courseTitle",title:"Course",className:"show-mobile",sortable:!0},{key:"assessmentTitle",title:"Assessment",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"submittedDate",title:"Submitted Date",className:"hide-mobile",sortable:!0},{key:"score",title:"Score",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(p,g)=>a.jsx(zle,{request:p,index:g,onView:d,onApprove:m,onDeny:f},p.id),emptyMessage:"No assessment requests found",emptyDescription:"Try adjusting your search criteria."})]})]})})},$le=({subjects:e,loading:t,onView:r})=>{const{sortedData:s,sortConfig:n,handleSort:i}=Zt(e);if(t)return a.jsx(Rt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"No subjects are available in this course."})]})});const o=({columnKey:l,children:c,className:u=""})=>{const m=n.key===l?n.direction:null;return a.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>i(l),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:c}),a.jsx(rr,{direction:m,className:"ms-1",color:"white"})]})})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(o,{columnKey:"title",className:"show-mobile",children:"Subject Title"}),a.jsx(o,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),a.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(o,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx(o,{columnKey:"method",className:"hide-mobile",children:"Method"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:s.map((l,c)=>a.jsx(Ule,{subject:l,index:c,onView:r},l.id))})]})})},Ule=({subject:e,index:t,onView:r})=>{const s=i=>{const o={ON_GOING:{variant:"primary",icon:ht},PLANNED:{variant:"info",icon:ft},COMPLETED:{variant:"success",icon:ht},CANCELLED:{variant:"secondary",icon:ft},active:{variant:"success",icon:ht},inactive:{variant:"secondary",icon:ft},pending:{variant:"warning",icon:ft}},l=o[i]||o.pending,c=l.icon;return a.jsxs(Ae,{bg:l.variant,className:"d-flex align-items-center",children:[a.jsx(c,{size:12,className:"me-1"}),i.replace(/_/g," ").toUpperCase()]})},n=i=>[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(i),permission:Te.SUBJECTS.VIEW_DETAIL}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),a.jsx("small",{className:"text-muted",children:e.description||""})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:e.code})}),a.jsx("td",{className:"align-middle show-mobile",children:s(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"text-muted small",children:[e.duration||0," hours"]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:e.method||"N/A"})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.SUBJECTS.VIEW_DETAIL],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:n(e)})})})]})},Wle=({trainees:e,loading:t,onView:r})=>{const{sortedData:s,sortConfig:n,handleSort:i}=Zt(e);if(t)return a.jsx(Rt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"No trainees are enrolled in this course."})]})});const o=({columnKey:l,children:c,className:u=""})=>{const m=n.key===l?n.direction:null;return a.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>i(l),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:c}),a.jsx(rr,{direction:m,className:"ms-1",color:"white"})]})})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(o,{columnKey:"name",className:"show-mobile",children:"Trainee Name"}),a.jsx(o,{columnKey:"eid",className:"hide-mobile",children:"Employee ID"}),a.jsx(o,{columnKey:"email",className:"show-mobile",children:"Email"}),a.jsx(o,{columnKey:"enrollmentCount",className:"hide-mobile",children:"Enrollments"}),a.jsx(o,{columnKey:"batches",className:"hide-mobile",children:"Batches"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:s.map((l,c)=>a.jsx(Hle,{trainee:l,index:c,onView:r},l.id))})]})})},Hle=({trainee:e,index:t,onView:r})=>{const s=n=>[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>r(n),permission:Te.TRAINEES.VIEW_DETAIL}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:n=>{n.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),a.jsx("small",{className:"text-muted",children:e.email})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:e.eid||"N/A"})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:e.email})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:e.enrollmentCount||0})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:e.batches&&e.batches.length>0?e.batches.join(", "):"N/A"})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(hr,{permissions:[Te.TRAINEES.VIEW_DETAIL],fallback:null,children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:s(e)})})})]})},Vle=()=>{const e=it(),{courseId:t}=Nr(),[r,s]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,u]=v.useState(!0),[d,m]=v.useState(null),[f,h]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!t){u(!1);return}try{u(!0),m(null);const j=await Jr.getCourseById(t),S={id:j.id,title:j.name,code:j.code,description:j.description||"",status:j.status||"PLANNED",enrolledCount:j.traineeCount||0,startDate:j.startDate,endDate:j.endDate,department:j.department?.name||"N/A",departmentCode:j.department?.code||""},E=(j.subjects||[]).map(w=>({id:w.id,name:w.name,code:w.code,description:w.description||"",status:w.status||"PLANNED",duration:w.duration||0,method:w.method||"N/A",roomName:w.roomName,timeSlot:w.timeSlot,startDate:w.startDate,endDate:w.endDate,passScore:w.passScore}));s(S),i(E);try{const C=((await Jr.getCourseTrainees(t)).trainees||[]).map(T=>({id:T.id,eid:T.eid,firstName:T.firstName||"",lastName:T.lastName||"",name:`${T.firstName||""} ${T.lastName||""}`.trim(),email:T.email||"",enrollmentCount:T.enrollmentCount||0,batches:T.batches||[]}));l(C)}catch(w){console.error("Error fetching trainees:",w),l([])}}catch(j){console.error("Error fetching course details:",j),m("Failed to load course details. Please try again later.")}finally{u(!1)}})()},[t]);const x=y=>{e(`/department-head/courses/${t}/subjects/${y.id}`)},p=y=>{e(`/department-head/trainees/${y.id}`)},g=[{id:"subjects",title:"Subject List",icon:It,component:a.jsx($le,{subjects:n,loading:c,onView:x})},{id:"trainees",title:"Trainee List",icon:Lr,component:a.jsx(Wle,{trainees:o,loading:c,onView:p})}],b=g.find(y=>y.id===f);return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):d?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:d})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-4 course-details-page",children:[a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/my-department-details"),children:a.jsx(_t,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:r.title}),a.jsxs("p",{className:"text-muted mb-0",children:[r.code,"  ",r.department," (",r.departmentCode,")"]})]})]})})}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0",children:[a.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0 p-0",children:a.jsx("div",{className:"custom-tabs-container",children:g.map(y=>{const j=y.icon,S=f===y.id;return a.jsxs("button",{className:`custom-tab ${S?"active":""}`,onClick:()=>h(y.id),children:[a.jsx(j,{size:16,className:"me-2"}),y.title]},y.id)})})}),a.jsx(W.Body,{className:"p-0",children:b&&b.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Course Not Found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},Gle=({subjectId:e,courseId:t})=>{const r=it(),{courseId:s}=Nr(),n=t||s,[i,o]=v.useState([]),[l,c]=v.useState(!0),[u,d]=v.useState(null),[m,f]=v.useState(""),[h,x]=v.useState([]);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(k=>setTimeout(k,1e3)),o([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"TE002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"TE003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"TE004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"TE005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(_){d("Failed to load trainees in subject"),console.error("Error fetching trainees:",_)}finally{c(!1)}})()},[e]);const p=T=>{const k={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[T]||{variant:"secondary",text:"Unknown"};return a.jsx(Ae,{bg:k.variant,children:k.text})},g=T=>{r(`/department-head/trainees/${T}`)},b=[...new Set(i.map(T=>T.status))],y=i.filter(T=>{const _=h.length===0||h.includes(T.status),k=T.name.toLowerCase().includes(m.toLowerCase())||T.email.toLowerCase().includes(m.toLowerCase())||T.employeeId.toLowerCase().includes(m.toLowerCase())||T.department.toLowerCase().includes(m.toLowerCase());return _&&k}),j=T=>{x(T==="clear"?[]:_=>_.includes(T)?_.filter(k=>k!==T):[..._,T])},S=()=>{x([]),f("")},{sortedData:E,sortConfig:w,handleSort:N}=Zt(y),C=({columnKey:T,children:_,className:k=""})=>{const L=w.key===T?w.direction:null;return a.jsx("th",{className:`fw-semibold ${k}`,onClick:()=>N(T),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:_}),a.jsx(rr,{direction:L,className:"ms-1",color:"white"})]})})};return l?a.jsx(Rt,{rows:5,columns:7}):u?a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:u})]}):y.length===0?a.jsx("div",{className:"text-center py-5 p-4",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})}):a.jsxs("div",{className:"p-4",children:[a.jsx(de,{className:"mb-3",children:a.jsx(z,{children:a.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`/department-head/my-department-details/${n}`),style:{color:"var(--bs-primary)"},children:[a.jsx(_t,{size:20,className:"me-2"}),"Back to Course Details"]})})}),a.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(z,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Ur,{placeholder:"Search trainees in this subject...",value:m,onChange:f,className:"search-bar-mobile"})}),a.jsx(z,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(ti,{uniqueStatuses:b,selectedStatuses:h,onStatusToggle:j,onClearFilters:S,className:"filter-panel-mobile"})}),a.jsx(z,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[y.length," trainee",y.length!==1?"s":""]})})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(Gt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(C,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(C,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(C,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(C,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx(C,{columnKey:"score",className:"hide-mobile",children:"Score"}),a.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:E.map((T,_)=>a.jsxs("tr",{className:`${_%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor=_%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:18,className:"me-2 text-primary"}),a.jsxs("div",{children:[a.jsx("h6",{className:"mb-0 fw-medium",children:T.name}),a.jsx("small",{className:"text-muted",children:T.email})]})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:T.employeeId})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{children:T.department})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"d-flex justify-content-between mb-1",children:a.jsxs("span",{className:"fw-medium",children:[T.progress,"%"]})}),a.jsx("div",{className:"progress",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${T.progress}%`}})})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:T.score?a.jsx("span",{className:"fw-bold text-success",children:T.score}):a.jsx("span",{className:"text-muted",children:"-"})}),a.jsx("td",{className:"align-middle show-mobile",children:p(T.status)}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(Ht,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx($t,{size:16})},items:[{label:"View Details",icon:a.jsx(Et,{}),onClick:()=>g(T.id)}]})})]},T.id))})]})})]})},qle=()=>{const{courseId:e,subjectId:t}=Nr(),r=it(),[s,n]=v.useState("trainees"),[i,o]=v.useState(null),[l,c]=v.useState(!0),[u,d]=v.useState(null);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(p=>setTimeout(p,1e3)),o({id:t,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols. This module covers essential safety protocols, emergency procedures, and compliance requirements for aviation operations.",duration:2,status:"active",instructor:"Dr. Smith",course:"Aviation Safety Management",courseCode:"ASM-101",startDate:"2024-01-15",endDate:"2024-03-15",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,inProgressTrainees:3,pendingTrainees:2,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(x){d("Failed to load subject details"),console.error("Error fetching subject:",x)}finally{c(!1)}})()},[t]);const m=[{id:"trainees",title:"Trainee List",icon:Lt,component:a.jsx(Gle,{subjectId:t,courseId:e})}],f=m.find(h=>h.id===s);return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):u?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:u})]})}):i?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(de,{className:"mb-3",children:a.jsx(z,{children:a.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`/department-head/my-department-details/${e}`),style:{color:"var(--bs-primary)"},children:[a.jsx(_t,{size:20,className:"me-2"}),"Back to Course Details"]})})}),a.jsx(de,{className:"mb-4",children:a.jsx(z,{children:a.jsxs(W,{className:"border-0 shadow-sm",children:[a.jsx(W.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const x=h.icon,p=s===h.id;return a.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>n(h.id),children:[a.jsx(x,{size:16,className:"me-2"}),h.title]},h.id)})})}),a.jsx(W.Body,{className:"p-0",children:f&&f.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Subject Not Found"}),a.jsx("p",{children:"The requested subject could not be found."})]})})},Kle=()=>{const{traineeId:e}=Nr(),t=it(),[r,s]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e){i(!1);return}try{i(!0),l(null);const m=await os.getUserById(e),f=m.data||m,h={id:f.id,eid:f.eid,firstName:f.firstName||"",lastName:f.lastName||"",middleName:f.middleName||"",name:`${f.firstName||""} ${f.middleName||""} ${f.lastName||""}`.trim().replace(/\s+/g," "),email:f.email||"",phoneNumber:f.phoneNumber||"N/A",status:f.status||"ACTIVE",gender:f.gender||"N/A",address:f.address||"N/A",avatarUrl:f.avatarUrl,role:f.role?.name||"N/A",department:f.department?.name||"N/A",departmentId:f.department?.id,dob:f.traineeProfile?.dob,enrollmentDate:f.traineeProfile?.enrollmentDate,trainingBatch:f.traineeProfile?.trainingBatch||"N/A",passportNo:f.traineeProfile?.passportNo||"N/A",nation:f.traineeProfile?.nation||"N/A",createdAt:f.createdAt,updatedAt:f.updatedAt};s(h)}catch(m){console.error("Error fetching trainee details:",m),l("Failed to load trainee details. Please try again later.")}finally{i(!1)}})()},[e]);const c=d=>{const f={ACTIVE:{variant:"success",text:"Active"},INACTIVE:{variant:"secondary",text:"Inactive"},SUSPENDED:{variant:"danger",text:"Suspended"},active:{variant:"success",text:"Active"},inactive:{variant:"secondary",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:d||"Unknown"};return a.jsx(Ae,{bg:f.variant,children:f.text})},u=d=>{if(!d)return"N/A";try{return new Date(d).toLocaleDateString()}catch{return d}};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Ot,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-3 py-md-4 px-3 px-md-4",children:[a.jsx(de,{className:"mb-3 mb-md-4",children:a.jsx(z,{children:a.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[a.jsxs("button",{className:"btn btn-link p-0 me-2 me-md-3 mb-2 mb-md-0",onClick:()=>t(-1),"aria-label":"Go back",children:[a.jsx(_t,{size:18,className:"d-md-none"}),a.jsx(_t,{size:20,className:"d-none d-md-block"})]}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("h2",{className:"mb-1 h4 h-md-2",children:r.name}),a.jsxs("p",{className:"text-muted mb-0 small",children:[r.eid,"  ",r.department]})]})]})})}),a.jsx("div",{style:{marginBottom:"4rem"},children:a.jsxs(de,{className:"g-2 g-md-3",children:[a.jsx(z,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:a.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:a.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[a.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[a.jsx(Lt,{size:20,className:"text-primary d-md-none"}),a.jsx(Lt,{size:24,className:"text-primary d-none d-md-block"})]}),a.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Status"}),a.jsx("div",{className:"mt-auto d-flex justify-content-center",children:c(r.status)})]})})}),a.jsx(z,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:a.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:a.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[a.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[a.jsx(Bs,{size:20,className:"text-info d-md-none"}),a.jsx(Bs,{size:24,className:"text-info d-none d-md-block"})]}),a.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Department"}),a.jsx("h6",{className:"mb-0 text-info small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.department}),a.jsx("h6",{className:"mb-0 text-info d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.department})]})})}),a.jsx(z,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:a.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:a.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[a.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[a.jsx(nr,{size:20,className:"text-success d-md-none"}),a.jsx(nr,{size:24,className:"text-success d-none d-md-block"})]}),a.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Enrollment Date"}),a.jsx("h6",{className:"mb-0 text-success small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:u(r.enrollmentDate)}),a.jsx("h6",{className:"mb-0 text-success d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:u(r.enrollmentDate)})]})})}),a.jsx(z,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:a.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:a.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[a.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[a.jsx(pl,{size:20,className:"text-warning d-md-none"}),a.jsx(pl,{size:24,className:"text-warning d-none d-md-block"})]}),a.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Training Batch"}),a.jsx("h6",{className:"mb-0 text-warning small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.trainingBatch}),a.jsx("h6",{className:"mb-0 text-warning d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.trainingBatch})]})})})]})}),a.jsxs(de,{className:"mb-4 g-3 g-md-4 align-items-stretch",children:[a.jsx(z,{xs:12,sm:12,md:6,lg:6,className:"mb-3 mb-md-0 d-flex",children:a.jsxs(W,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[a.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Personal Information"})}),a.jsxs(W.Body,{className:"p-3 p-md-4 flex-grow-1",children:[a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Employee ID:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.eid})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(Ti,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Email:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.email})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(N2,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Phone Number:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.phoneNumber})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Gender:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.gender})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(nr,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Date of Birth:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.dob)})]})]}),a.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[a.jsx(bo,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Address:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.address})]})]})]})]})}),a.jsx(z,{xs:12,sm:12,md:6,lg:6,className:"mb-0 d-flex",children:a.jsxs(W,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[a.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Trainee Profile"})}),a.jsxs(W.Body,{className:"p-3 p-md-4 flex-grow-1",children:[a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(Bs,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Department:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.department})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Role:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.role})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(nr,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Enrollment Date:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.enrollmentDate)})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(pl,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Training Batch:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.trainingBatch})]})]}),a.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[a.jsx(pl,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Passport No:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.passportNo})]})]}),a.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[a.jsx(bo,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{className:"d-block d-md-inline",children:"Nation:"})," ",a.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.nation})]})]})]})]})})]})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Trainee Not Found"}),a.jsx("p",{children:"The requested trainee could not be found."})]})})},Yle=m5([{path:"/",element:a.jsx(Lm,{}),errorElement:a.jsx(Aa,{})},{path:"/login",element:a.jsx(Lm,{}),errorElement:a.jsx(Aa,{})},{path:"/reset-password",element:a.jsx(JO,{}),errorElement:a.jsx(Aa,{})},{path:"/profile",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(bt,{permission:Te.PROFILES.VIEW,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:a.jsx(_W,{})})}]},{path:"/admin",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(al,{})},{path:"main-menu",element:a.jsx(bt,{permission:null,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access main menu."}),children:a.jsx(ele,{})})},{path:"users",element:a.jsx(bt,{permission:Te.USERS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:a.jsx(iW,{})})},{path:"roles",element:a.jsx(bt,{permission:Te.ROLES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:a.jsx(fW,{})})},{path:"departments",element:a.jsx(bt,{permission:Te.DEPARTMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:a.jsx(yW,{})})},{path:"departments/:id",element:a.jsx(bt,{permission:Te.DEPARTMENTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:a.jsx(TW,{})})},{path:"forms",element:a.jsx(bt,{permission:Te.TEMPLATES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:a.jsx(Goe,{})})},{path:"forms/editor",element:a.jsx(bt,{permission:Te.TEMPLATES.CREATE,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:a.jsx(Zoe,{})})},{path:"forms/drafts",element:a.jsx(bt,{permission:Te.TEMPLATES.CREATE,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view drafts."}),children:a.jsx(Qoe,{})})},{path:"system-config",element:a.jsx(bt,{permission:Te.GLOBAL_FIELDS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:a.jsx(nle,{})})}]},{path:"/academic",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(al,{})},{path:"dashboard",element:a.jsx(Bie,{})},{path:"departments",element:a.jsx(IW,{})},{path:"course/:courseId",element:a.jsx(Gie,{})},{path:"course-detail/:courseId",element:a.jsx(moe,{})},{path:"course/:courseId/enroll-trainees",element:a.jsx(goe,{})},{path:"subject/:subjectId",element:a.jsx(qN,{})},{path:"course/:courseId/subject/:subjectId",element:a.jsx(qN,{})},{path:"assessment-events",element:a.jsx(woe,{})}]},{path:"/trainee",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:a.jsx(YN,{})})},{path:"dashboard",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:a.jsx(YN,{})})},{path:":traineeId/course/:courseId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_COURSES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:a.jsx(Toe,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_SUBJECTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:a.jsx(_oe,{})})},{path:":traineeId/assessments",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:a.jsx(Poe,{})})},{path:":traineeId/assessment/:assessmentId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:a.jsx(Doe,{})})},{path:":traineeId/signature-pad/:documentId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:a.jsx(Roe,{})})},{path:":traineeId/assessment-section/:sectionId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:a.jsx(Loe,{})})},{path:"academic-details",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:a.jsx(zoe,{})})},{path:"enrolled-courses",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_COURSES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:a.jsx(Woe,{})})},{path:"signature-required",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:a.jsx(lle,{})})},{path:"completion-required",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:a.jsx(QN,{})})},{path:"your-assessments",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:a.jsx(e2,{})})},{path:"create-incident-feedback-report",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:a.jsx(ple,{})})},{path:"assessment-pending",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment pending list."}),children:a.jsx(e2,{})})},{path:"assessment-pending/section-completion",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:a.jsx(QN,{})})}]},{path:"/sqa",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(al,{})},{path:"issues",element:a.jsx(bt,{permission:Te.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:a.jsx(xle,{})})},{path:"feedback",element:a.jsx(bt,{permission:Te.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:a.jsx(gle,{})})},{path:"templates",element:a.jsx(bt,{permission:Te.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template list."}),children:a.jsx(vle,{})})},{path:"templates/:templateId",element:a.jsx(bt,{permission:Te.SQA.VIEW_TEMPLATE_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:a.jsx(ble,{})})}]},{path:"/trainer",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(al,{})},{path:"dashboard",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainer portal."}),children:a.jsx(yle,{})})},{path:"upcoming-assessments",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view upcoming assessments."}),children:a.jsx(Nle,{})})},{path:"assessment-results",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment results."}),children:a.jsx(Ele,{})})},{path:"instructed-courses",element:a.jsx(bt,{permission:Te.COURSES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:a.jsx(Cle,{})})},{path:"configure-signature",element:a.jsx(bt,{permission:Te.PROFILES.VIEW,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to configure signature."}),children:a.jsx(Ole,{})})},{path:"assessment-details/:resultId",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:a.jsx(Rle,{})})},{path:"approval-notes/:resultId",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view approval notes."}),children:a.jsx(Fle,{})})},{path:"courses/:courseId",element:a.jsx(bt,{permission:Te.COURSES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:a.jsx(_le,{})})},{path:"trainees/:traineeId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:a.jsx(Ile,{})})},{path:"subjects/:subjectId",element:a.jsx(bt,{permission:Te.SUBJECTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:a.jsx(Dle,{})})}]},{path:"/department-head",element:a.jsx(ai,{children:a.jsx(si,{})}),errorElement:a.jsx(Aa,{}),children:[{path:"",element:a.jsx(al,{})},{path:"dashboard",element:a.jsx(Lle,{})},{path:"my-department-details",element:a.jsx(bt,{permission:Te.DEPARTMENTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:a.jsx(Ble,{})})},{path:"my-department-details/:courseId",element:a.jsx(bt,{permission:Te.COURSES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:a.jsx(Vle,{})})},{path:"assessment-review-requests",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access assessment review requests."}),children:a.jsx(t2,{})})},{path:"assessment-review-requests/:requestId",element:a.jsx(bt,{permission:Te.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment request details."}),children:a.jsx(t2,{})})},{path:"courses/:courseId/subjects/:subjectId",element:a.jsx(bt,{permission:Te.SUBJECTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:a.jsx(qle,{})})},{path:"trainees/:traineeId",element:a.jsx(bt,{permission:Te.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:a.jsx(Kle,{})})}]},{path:"*",element:a.jsx(Lm,{}),errorElement:a.jsx(Aa,{})}],{basename:kx()});function Xle(){return v.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,s=t.hash,n=r.match(/\?\/(.+?)(?:&|$)/);if(n){const o=`/${n[1].replace(/~and~/g,"&")}${s}`;window.history.replaceState(null,"",o)}}})()},[]),a.jsxs(YO,{children:[a.jsx(f5,{router:Yle}),a.jsx(HO,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}x5.createRoot(document.getElementById("root")).render(a.jsx(v.StrictMode,{children:a.jsx(Xle,{})}));
