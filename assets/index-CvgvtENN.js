import{P as O,j as s,B as se,N as ft,a as t1,C as Le,b as te,A as Ye,S as Lt,I as r1,F,M as ce,R as ge,c as ee,T as qt,O as n4,d as a4,D as dn,e as Ce,L as n1,f as s4,g as lr,h as Gj,i as fm}from"./bootstrap-DV5QiWhd.js";import{r as v,R as G,u as Si,b as mt,L as uf,O as i4,c as o4,d as Kp,N as l4,e as c4,f as d4,g as sa,h as u4,i as f4}from"./router-MMygwzQo.js";import{a as m4,g as Is,r as Yp}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Sc={},a1;function h4(){if(a1)return Sc;a1=1;var e=m4();return Sc.createRoot=e.createRoot,Sc.hydrateRoot=e.hydrateRoot,Sc}var p4=h4(),x4=["color","size","title","className"];function mm(){return mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mm.apply(null,arguments)}function g4(e,t){if(e==null)return{};var r,n,a=v4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var qj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=g4(e,x4);return G.createElement("svg",mm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-airplane",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});qj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var y4=["color","size","title","className"];function hm(){return hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hm.apply(null,arguments)}function b4(e,t){if(e==null)return{};var r,n,a=w4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Kj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b4(e,y4);return G.createElement("svg",hm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-arrow-clockwise",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),G.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});Kj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var j4=["color","size","title","className"];function pm(){return pm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pm.apply(null,arguments)}function N4(e,t){if(e==null)return{};var r,n,a=E4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function E4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gr=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=N4(e,j4);return G.createElement("svg",pm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-arrow-left",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});gr.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var S4=["color","size","title","className"];function xm(){return xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xm.apply(null,arguments)}function T4(e,t){if(e==null)return{};var r,n,a=_4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ji=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=T4(e,S4);return G.createElement("svg",xm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-arrow-right",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});Ji.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var A4=["color","size","title","className"];function gm(){return gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gm.apply(null,arguments)}function k4(e,t){if(e==null)return{};var r,n,a=C4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ml=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=k4(e,A4);return G.createElement("svg",gm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-award",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),G.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});ml.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var O4=["color","size","title","className"];function vm(){return vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vm.apply(null,arguments)}function P4(e,t){if(e==null)return{};var r,n,a=D4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function D4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ur=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P4(e,O4);return G.createElement("svg",vm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-book",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});ur.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var I4=["color","size","title","className"];function ym(){return ym=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ym.apply(null,arguments)}function R4(e,t){if(e==null)return{};var r,n,a=F4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function F4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bm=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=R4(e,I4);return G.createElement("svg",ym({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-box-arrow-right",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),G.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});bm.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var M4=["color","size","title","className"];function wm(){return wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wm.apply(null,arguments)}function L4(e,t){if(e==null)return{};var r,n,a=B4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function B4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var di=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L4(e,M4);return G.createElement("svg",wm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-building",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),G.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});di.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var $4=["color","size","title","className"];function jm(){return jm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jm.apply(null,arguments)}function z4(e,t){if(e==null)return{};var r,n,a=U4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function U4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fn=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=z4(e,$4);return G.createElement("svg",jm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-calendar",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});fn.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var W4=["color","size","title","className"];function Nm(){return Nm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nm.apply(null,arguments)}function H4(e,t){if(e==null)return{};var r,n,a=V4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function V4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Hi=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=H4(e,W4);return G.createElement("svg",Nm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-chat-dots",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),G.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});Hi.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var G4=["color","size","title","className"];function Em(){return Em=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Em.apply(null,arguments)}function q4(e,t){if(e==null)return{};var r,n,a=K4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function K4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dt=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=q4(e,G4);return G.createElement("svg",Em({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-check-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});dt.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var Y4=["color","size","title","className"];function Sm(){return Sm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sm.apply(null,arguments)}function X4(e,t){if(e==null)return{};var r,n,a=Z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z4(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Yj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=X4(e,Y4);return G.createElement("svg",Sm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-check-square",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),G.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});Yj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var J4=["color","size","title","className"];function Tm(){return Tm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tm.apply(null,arguments)}function Q4(e,t){if(e==null)return{};var r,n,a=e5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function e5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Es=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Q4(e,J4);return G.createElement("svg",Tm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-chevron-down",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});Es.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var t5=["color","size","title","className"];function _m(){return _m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_m.apply(null,arguments)}function r5(e,t){if(e==null)return{};var r,n,a=n5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function n5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xp=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=r5(e,t5);return G.createElement("svg",_m({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-chevron-right",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Xp.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var a5=["color","size","title","className"];function Am(){return Am=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Am.apply(null,arguments)}function s5(e,t){if(e==null)return{};var r,n,a=i5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function i5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=s5(e,a5);return G.createElement("svg",Am({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-chevron-up",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});Xj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var o5=["color","size","title","className"];function km(){return km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},km.apply(null,arguments)}function l5(e,t){if(e==null)return{};var r,n,a=c5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function c5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cr=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=l5(e,o5);return G.createElement("svg",km({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-clipboard-check",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),G.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),G.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});cr.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var d5=["color","size","title","className"];function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cm.apply(null,arguments)}function u5(e,t){if(e==null)return{};var r,n,a=f5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function f5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=u5(e,d5);return G.createElement("svg",Cm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-clock-history",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"}),G.createElement("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"}),G.createElement("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"}))});Zj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var m5=["color","size","title","className"];function Om(){return Om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Om.apply(null,arguments)}function h5(e,t){if(e==null)return{};var r,n,a=p5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function p5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Vt=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=h5(e,m5);return G.createElement("svg",Om({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-clock",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),G.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});Vt.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var x5=["color","size","title","className"];function Pm(){return Pm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pm.apply(null,arguments)}function g5(e,t){if(e==null)return{};var r,n,a=v5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qi=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=g5(e,x5);return G.createElement("svg",Pm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-download",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),G.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});Qi.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var y5=["color","size","title","className"];function Dm(){return Dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dm.apply(null,arguments)}function b5(e,t){if(e==null)return{};var r,n,a=w5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zp=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b5(e,y5);return G.createElement("svg",Dm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-envelope",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});Zp.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var j5=["color","size","title","className"];function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Im.apply(null,arguments)}function N5(e,t){if(e==null)return{};var r,n,a=E5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function E5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Jp=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=N5(e,j5);return G.createElement("svg",Im({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-exclamation-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Jp.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var S5=["color","size","title","className"];function Rm(){return Rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rm.apply(null,arguments)}function T5(e,t){if(e==null)return{};var r,n,a=_5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Et=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=T5(e,S5);return G.createElement("svg",Rm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-exclamation-triangle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),G.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Et.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var A5=["color","size","title","className"];function Fm(){return Fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fm.apply(null,arguments)}function k5(e,t){if(e==null)return{};var r,n,a=C5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hl=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=k5(e,A5);return G.createElement("svg",Fm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-eye-slash",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),G.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),G.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});hl.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var O5=["color","size","title","className"];function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mm.apply(null,arguments)}function P5(e,t){if(e==null)return{};var r,n,a=D5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function D5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tr=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P5(e,O5);return G.createElement("svg",Mm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-eye",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),G.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});tr.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var I5=["color","size","title","className"];function Lm(){return Lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lm.apply(null,arguments)}function R5(e,t){if(e==null)return{};var r,n,a=F5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function F5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eo=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=R5(e,I5);return G.createElement("svg",Lm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-earmark-excel",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),G.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});eo.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var M5=["color","size","title","className"];function Bm(){return Bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bm.apply(null,arguments)}function L5(e,t){if(e==null)return{};var r,n,a=B5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function B5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $m=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L5(e,M5);return G.createElement("svg",Bm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-earmark-pdf",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),G.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});$m.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var $5=["color","size","title","className"];function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zm.apply(null,arguments)}function z5(e,t){if(e==null)return{};var r,n,a=U5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function U5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qp=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=z5(e,$5);return G.createElement("svg",zm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-earmark-text",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),G.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Qp.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var W5=["color","size","title","className"];function Um(){return Um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Um.apply(null,arguments)}function H5(e,t){if(e==null)return{};var r,n,a=V5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function V5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cd=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=H5(e,W5);return G.createElement("svg",Um({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-earmark",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});cd.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var G5=["color","size","title","className"];function Wm(){return Wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wm.apply(null,arguments)}function q5(e,t){if(e==null)return{};var r,n,a=K5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function K5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Jj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=q5(e,G5);return G.createElement("svg",Wm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-text-fill",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});Jj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var Y5=["color","size","title","className"];function Hm(){return Hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hm.apply(null,arguments)}function X5(e,t){if(e==null)return{};var r,n,a=Z5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var In=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=X5(e,Y5);return G.createElement("svg",Hm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-file-text",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),G.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});In.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var J5=["color","size","title","className"];function Vm(){return Vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vm.apply(null,arguments)}function Q5(e,t){if(e==null)return{};var r,n,a=e3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function e3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var go=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Q5(e,J5);return G.createElement("svg",Vm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-funnel",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});go.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var t3=["color","size","title","className"];function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gm.apply(null,arguments)}function r3(e,t){if(e==null)return{};var r,n,a=n3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function n3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qj=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=r3(e,t3);return G.createElement("svg",Gm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-gear",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),G.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});Qj.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var a3=["color","size","title","className"];function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qm.apply(null,arguments)}function s3(e,t){if(e==null)return{};var r,n,a=i3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function i3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Hl=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=s3(e,a3);return G.createElement("svg",qm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-geo-alt",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),G.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});Hl.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var o3=["color","size","title","className"];function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Km.apply(null,arguments)}function l3(e,t){if(e==null)return{};var r,n,a=c3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function c3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=l3(e,o3);return G.createElement("svg",Km({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-graph-up",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M0 0h1v15h15v1H0zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07"}))});eN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var d3=["color","size","title","className"];function Ym(){return Ym=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ym.apply(null,arguments)}function u3(e,t){if(e==null)return{};var r,n,a=f3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function f3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=u3(e,d3);return G.createElement("svg",Ym({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-grid-3x3-gap",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M4 2v2H2V2zm1 12v-2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V7a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m5 10v-2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V7a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1M9 2v2H7V2zm5 0v2h-2V2zM4 7v2H2V7zm5 0v2H7V7zm5 0h-2v2h2zM4 12v2H2v-2zm5 0v2H7v-2zm5 0v2h-2v-2zM12 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm-1 6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1z"}))});tN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var m3=["color","size","title","className"];function Xm(){return Xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xm.apply(null,arguments)}function h3(e,t){if(e==null)return{};var r,n,a=p3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function p3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zm=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=h3(e,m3);return G.createElement("svg",Xm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-house",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});Zm.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var x3=["color","size","title","className"];function Jm(){return Jm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jm.apply(null,arguments)}function g3(e,t){if(e==null)return{};var r,n,a=v3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=g3(e,x3);return G.createElement("svg",Jm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-info-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});rN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var y3=["color","size","title","className"];function Qm(){return Qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qm.apply(null,arguments)}function b3(e,t){if(e==null)return{};var r,n,a=w3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pl=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b3(e,y3);return G.createElement("svg",Qm({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-key",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),G.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});pl.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var j3=["color","size","title","className"];function eh(){return eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eh.apply(null,arguments)}function N3(e,t){if(e==null)return{};var r,n,a=E3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function E3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ex=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=N3(e,j3);return G.createElement("svg",eh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-list",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});ex.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var S3=["color","size","title","className"];function th(){return th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},th.apply(null,arguments)}function T3(e,t){if(e==null)return{};var r,n,a=_3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var to=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=T3(e,S3);return G.createElement("svg",th({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-pen",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});to.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var A3=["color","size","title","className"];function rh(){return rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rh.apply(null,arguments)}function k3(e,t){if(e==null)return{};var r,n,a=C3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ga=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=k3(e,A3);return G.createElement("svg",rh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-pencil",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});ga.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var O3=["color","size","title","className"];function nh(){return nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nh.apply(null,arguments)}function P3(e,t){if(e==null)return{};var r,n,a=D3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function D3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Fn=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P3(e,O3);return G.createElement("svg",nh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-people",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Fn.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var I3=["color","size","title","className"];function ah(){return ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ah.apply(null,arguments)}function R3(e,t){if(e==null)return{};var r,n,a=F3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function F3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var nN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=R3(e,I3);return G.createElement("svg",ah({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-check-fill",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),G.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});nN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var M3=["color","size","title","className"];function sh(){return sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sh.apply(null,arguments)}function L3(e,t){if(e==null)return{};var r,n,a=B3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function B3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fa=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L3(e,M3);return G.createElement("svg",sh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-check",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),G.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});fa.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var $3=["color","size","title","className"];function ih(){return ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ih.apply(null,arguments)}function z3(e,t){if(e==null)return{};var r,n,a=U3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function U3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $i=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=z3(e,$3);return G.createElement("svg",ih({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),G.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});$i.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var W3=["color","size","title","className"];function oh(){return oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oh.apply(null,arguments)}function H3(e,t){if(e==null)return{};var r,n,a=V3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function V3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dd=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=H3(e,W3);return G.createElement("svg",oh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-dash",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7M11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1m0-7a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),G.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});dd.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var G3=["color","size","title","className"];function lh(){return lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lh.apply(null,arguments)}function q3(e,t){if(e==null)return{};var r,n,a=K3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function K3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ui=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=q3(e,G3);return G.createElement("svg",lh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-plus",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}),G.createElement("path",{fillRule:"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"}))});ui.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var Y3=["color","size","title","className"];function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ch.apply(null,arguments)}function X3(e,t){if(e==null)return{};var r,n,a=Z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vo=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=X3(e,Y3);return G.createElement("svg",ch({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person-x",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),G.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});vo.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var J3=["color","size","title","className"];function dh(){return dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dh.apply(null,arguments)}function Q3(e,t){if(e==null)return{};var r,n,a=eO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ya=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Q3(e,J3);return G.createElement("svg",dh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-person",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Ya.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var tO=["color","size","title","className"];function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uh.apply(null,arguments)}function rO(e,t){if(e==null)return{};var r,n,a=nO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var aN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=rO(e,tO);return G.createElement("svg",uh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-phone",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),G.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});aN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var aO=["color","size","title","className"];function fh(){return fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fh.apply(null,arguments)}function sO(e,t){if(e==null)return{};var r,n,a=iO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mh=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=sO(e,aO);return G.createElement("svg",fh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-play-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});mh.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var oO=["color","size","title","className"];function hh(){return hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hh.apply(null,arguments)}function lO(e,t){if(e==null)return{};var r,n,a=cO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function cO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tx=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=lO(e,oO);return G.createElement("svg",hh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-play",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});tx.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var dO=["color","size","title","className"];function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ph.apply(null,arguments)}function uO(e,t){if(e==null)return{};var r,n,a=fO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wn=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=uO(e,dO);return G.createElement("svg",ph({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-plus",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});wn.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var mO=["color","size","title","className"];function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xh.apply(null,arguments)}function hO(e,t){if(e==null)return{};var r,n,a=pO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=hO(e,mO);return G.createElement("svg",xh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-reply",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M6.598 5.013a.144.144 0 0 1 .202.134V6.3a.5.5 0 0 0 .5.5c.667 0 2.013.005 3.3.822.984.624 1.99 1.76 2.595 3.876-1.02-.983-2.185-1.516-3.205-1.799a8.7 8.7 0 0 0-1.921-.306 7 7 0 0 0-.798.008h-.013l-.005.001h-.001L7.3 9.9l-.05-.498a.5.5 0 0 0-.45.498v1.153c0 .108-.11.176-.202.134L2.614 8.254l-.042-.028a.147.147 0 0 1 0-.252l.042-.028zM7.8 10.386q.103 0 .223.006c.434.02 1.034.086 1.7.271 1.326.368 2.896 1.202 3.94 3.08a.5.5 0 0 0 .933-.305c-.464-3.71-1.886-5.662-3.46-6.66-1.245-.79-2.527-.942-3.336-.971v-.66a1.144 1.144 0 0 0-1.767-.96l-3.994 2.94a1.147 1.147 0 0 0 0 1.946l3.994 2.94a1.144 1.144 0 0 0 1.767-.96z"}))});sN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var xO=["color","size","title","className"];function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gh.apply(null,arguments)}function gO(e,t){if(e==null)return{};var r,n,a=vO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Oa=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=gO(e,xO);return G.createElement("svg",gh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-save",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});Oa.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var yO=["color","size","title","className"];function vh(){return vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vh.apply(null,arguments)}function bO(e,t){if(e==null)return{};var r,n,a=wO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rx=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=bO(e,yO);return G.createElement("svg",vh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-search",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});rx.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var jO=["color","size","title","className"];function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yh.apply(null,arguments)}function NO(e,t){if(e==null)return{};var r,n,a=EO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function EO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=NO(e,jO);return G.createElement("svg",yh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-send",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});iN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var SO=["color","size","title","className"];function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh.apply(null,arguments)}function TO(e,t){if(e==null)return{};var r,n,a=_O(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _O(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var oN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TO(e,SO);return G.createElement("svg",bh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-shield-x",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),G.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});oN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var AO=["color","size","title","className"];function wh(){return wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wh.apply(null,arguments)}function kO(e,t){if(e==null)return{};var r,n,a=CO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var nx=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=kO(e,AO);return G.createElement("svg",wh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-shield",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});nx.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var OO=["color","size","title","className"];function jh(){return jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jh.apply(null,arguments)}function PO(e,t){if(e==null)return{};var r,n,a=DO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=PO(e,OO);return G.createElement("svg",jh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-slash-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708"}))});lN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var IO=["color","size","title","className"];function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nh.apply(null,arguments)}function RO(e,t){if(e==null)return{};var r,n,a=FO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function FO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=RO(e,IO);return G.createElement("svg",Nh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-square",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});cN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var MO=["color","size","title","className"];function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eh.apply(null,arguments)}function LO(e,t){if(e==null)return{};var r,n,a=BO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _r=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=LO(e,MO);return G.createElement("svg",Eh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-three-dots-vertical",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});_r.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var $O=["color","size","title","className"];function Sh(){return Sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sh.apply(null,arguments)}function zO(e,t){if(e==null)return{};var r,n,a=UO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function UO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ti=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=zO(e,$O);return G.createElement("svg",Sh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-trash",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),G.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Ti.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var WO=["color","size","title","className"];function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(null,arguments)}function HO(e,t){if(e==null)return{};var r,n,a=VO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dN=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HO(e,WO);return G.createElement("svg",Th({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-trophy",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});dN.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var GO=["color","size","title","className"];function _h(){return _h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_h.apply(null,arguments)}function qO(e,t){if(e==null)return{};var r,n,a=KO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Mn=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=qO(e,GO);return G.createElement("svg",_h({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-upload",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),G.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Mn.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var YO=["color","size","title","className"];function Ah(){return Ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ah.apply(null,arguments)}function XO(e,t){if(e==null)return{};var r,n,a=ZO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _a=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=XO(e,YO);return G.createElement("svg",Ah({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-x-circle",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),G.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});_a.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};var JO=["color","size","title","className"];function kh(){return kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kh.apply(null,arguments)}function QO(e,t){if(e==null)return{};var r,n,a=eP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var We=v.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=e.size,i=a===void 0?"1em":a,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=QO(e,JO);return G.createElement("svg",kh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n,className:["bi","bi-x",d].filter(Boolean).join(" ")},u),l?G.createElement("title",null,l):null,G.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});We.propTypes={color:O.string,size:O.oneOfType([O.string,O.number]),title:O.string,className:O.string};const tP="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function uN(e,t){return function(){return e.apply(t,arguments)}}const{toString:rP}=Object.prototype,{getPrototypeOf:ax}=Object,{iterator:uu,toStringTag:fN}=Symbol,fu=(e=>t=>{const r=rP.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),va=e=>(e=e.toLowerCase(),t=>fu(t)===e),mu=e=>t=>typeof t===e,{isArray:yo}=Array,ro=mu("undefined");function Vl(e){return e!==null&&!ro(e)&&e.constructor!==null&&!ro(e.constructor)&&gn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const mN=va("ArrayBuffer");function nP(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&mN(e.buffer),t}const aP=mu("string"),gn=mu("function"),hN=mu("number"),Gl=e=>e!==null&&typeof e=="object",sP=e=>e===!0||e===!1,ad=e=>{if(fu(e)!=="object")return!1;const t=ax(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(fN in e)&&!(uu in e)},iP=e=>{if(!Gl(e)||Vl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},oP=va("Date"),lP=va("File"),cP=va("Blob"),dP=va("FileList"),uP=e=>Gl(e)&&gn(e.pipe),fP=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||gn(e.append)&&((t=fu(e))==="formdata"||t==="object"&&gn(e.toString)&&e.toString()==="[object FormData]"))},mP=va("URLSearchParams"),[hP,pP,xP,gP]=["ReadableStream","Request","Response","Headers"].map(va),vP=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ql(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),yo(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Vl(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function pN(e,t){if(Vl(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Ys=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,xN=e=>!ro(e)&&e!==Ys;function Ch(){const{caseless:e,skipUndefined:t}=xN(this)&&this||{},r={},n=(a,i)=>{const o=e&&pN(r,i)||i;ad(r[o])&&ad(a)?r[o]=Ch(r[o],a):ad(a)?r[o]=Ch({},a):yo(a)?r[o]=a.slice():(!t||!ro(a))&&(r[o]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&ql(arguments[a],n);return r}const yP=(e,t,r,{allOwnKeys:n}={})=>(ql(t,(a,i)=>{r&&gn(a)?e[i]=uN(a,r):e[i]=a},{allOwnKeys:n}),e),bP=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),wP=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},jP=(e,t,r,n)=>{let a,i,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&ax(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},NP=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},EP=e=>{if(!e)return null;if(yo(e))return e;let t=e.length;if(!hN(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},SP=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ax(Uint8Array)),TP=(e,t)=>{const n=(e&&e[uu]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},_P=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},AP=va("HTMLFormElement"),kP=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),s1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),CP=va("RegExp"),gN=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};ql(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},OP=e=>{gN(e,(t,r)=>{if(gn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(gn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},PP=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return yo(e)?n(e):n(String(e).split(t)),r},DP=()=>{},IP=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function RP(e){return!!(e&&gn(e.append)&&e[fN]==="FormData"&&e[uu])}const FP=e=>{const t=new Array(10),r=(n,a)=>{if(Gl(n)){if(t.indexOf(n)>=0)return;if(Vl(n))return n;if(!("toJSON"in n)){t[a]=n;const i=yo(n)?[]:{};return ql(n,(o,l)=>{const c=r(o,a+1);!ro(c)&&(i[l]=c)}),t[a]=void 0,i}}return n};return r(e,0)},MP=va("AsyncFunction"),LP=e=>e&&(Gl(e)||gn(e))&&gn(e.then)&&gn(e.catch),vN=((e,t)=>e?setImmediate:t?((r,n)=>(Ys.addEventListener("message",({source:a,data:i})=>{a===Ys&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Ys.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",gn(Ys.postMessage)),BP=typeof queueMicrotask<"u"?queueMicrotask.bind(Ys):typeof process<"u"&&process.nextTick||vN,$P=e=>e!=null&&gn(e[uu]),pe={isArray:yo,isArrayBuffer:mN,isBuffer:Vl,isFormData:fP,isArrayBufferView:nP,isString:aP,isNumber:hN,isBoolean:sP,isObject:Gl,isPlainObject:ad,isEmptyObject:iP,isReadableStream:hP,isRequest:pP,isResponse:xP,isHeaders:gP,isUndefined:ro,isDate:oP,isFile:lP,isBlob:cP,isRegExp:CP,isFunction:gn,isStream:uP,isURLSearchParams:mP,isTypedArray:SP,isFileList:dP,forEach:ql,merge:Ch,extend:yP,trim:vP,stripBOM:bP,inherits:wP,toFlatObject:jP,kindOf:fu,kindOfTest:va,endsWith:NP,toArray:EP,forEachEntry:TP,matchAll:_P,isHTMLForm:AP,hasOwnProperty:s1,hasOwnProp:s1,reduceDescriptors:gN,freezeMethods:OP,toObjectSet:PP,toCamelCase:kP,noop:DP,toFiniteNumber:IP,findKey:pN,global:Ys,isContextDefined:xN,isSpecCompliantForm:RP,toJSONObject:FP,isAsyncFn:MP,isThenable:LP,setImmediate:vN,asap:BP,isIterable:$P};function Ze(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}pe.inherits(Ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const yN=Ze.prototype,bN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{bN[e]={value:e}});Object.defineProperties(Ze,bN);Object.defineProperty(yN,"isAxiosError",{value:!0});Ze.from=(e,t,r,n,a,i)=>{const o=Object.create(yN);pe.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Ze.call(o,l,c,r,n,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const zP=null;function Oh(e){return pe.isPlainObject(e)||pe.isArray(e)}function wN(e){return pe.endsWith(e,"[]")?e.slice(0,-2):e}function i1(e,t,r){return e?e.concat(t).map(function(a,i){return a=wN(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function UP(e){return pe.isArray(e)&&!e.some(Oh)}const WP=pe.toFlatObject(pe,{},null,function(t){return/^is[A-Z]/.test(t)});function hu(e,t,r){if(!pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!pe.isUndefined(g[x])});const n=r.metaTokens,a=r.visitor||u,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(t);if(!pe.isFunction(a))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(pe.isDate(p))return p.toISOString();if(pe.isBoolean(p))return p.toString();if(!c&&pe.isBlob(p))throw new Ze("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(p)||pe.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,x,g){let y=p;if(p&&!g&&typeof p=="object"){if(pe.endsWith(x,"{}"))x=n?x:x.slice(0,-2),p=JSON.stringify(p);else if(pe.isArray(p)&&UP(p)||(pe.isFileList(p)||pe.endsWith(x,"[]"))&&(y=pe.toArray(p)))return x=wN(x),y.forEach(function(b,j){!(pe.isUndefined(b)||b===null)&&t.append(o===!0?i1([x],j,i):o===null?x:x+"[]",d(b))}),!1}return Oh(p)?!0:(t.append(i1(g,x,i),d(p)),!1)}const f=[],m=Object.assign(WP,{defaultVisitor:u,convertValue:d,isVisitable:Oh});function h(p,x){if(!pe.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(p),pe.forEach(p,function(y,w){(!(pe.isUndefined(y)||y===null)&&a.call(t,y,pe.isString(w)?w.trim():w,x,m))===!0&&h(y,x?x.concat(w):[w])}),f.pop()}}if(!pe.isObject(e))throw new TypeError("data must be an object");return h(e),t}function o1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function sx(e,t){this._pairs=[],e&&hu(e,this,t)}const jN=sx.prototype;jN.append=function(t,r){this._pairs.push([t,r])};jN.toString=function(t){const r=t?function(n){return t.call(this,n,o1)}:o1;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function HP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function NN(e,t,r){if(!t)return e;const n=r&&r.encode||HP;pe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=pe.isURLSearchParams(t)?t.toString():new sx(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class l1{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const EN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},VP=typeof URLSearchParams<"u"?URLSearchParams:sx,GP=typeof FormData<"u"?FormData:null,qP=typeof Blob<"u"?Blob:null,KP={isBrowser:!0,classes:{URLSearchParams:VP,FormData:GP,Blob:qP},protocols:["http","https","file","blob","url","data"]},ix=typeof window<"u"&&typeof document<"u",Ph=typeof navigator=="object"&&navigator||void 0,YP=ix&&(!Ph||["ReactNative","NativeScript","NS"].indexOf(Ph.product)<0),XP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ZP=ix&&window.location.href||"http://localhost",JP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ix,hasStandardBrowserEnv:YP,hasStandardBrowserWebWorkerEnv:XP,navigator:Ph,origin:ZP},Symbol.toStringTag,{value:"Module"})),Kr={...JP,...KP};function QP(e,t){return hu(e,new Kr.classes.URLSearchParams,{visitor:function(r,n,a,i){return Kr.isNode&&pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function eD(e){return pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function tD(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function SN(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&pe.isArray(a)?a.length:o,c?(pe.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!pe.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&pe.isArray(a[o])&&(a[o]=tD(a[o])),!l)}if(pe.isFormData(e)&&pe.isFunction(e.entries)){const r={};return pe.forEachEntry(e,(n,a)=>{t(eD(n),a,r,0)}),r}return null}function rD(e,t,r){if(pe.isString(e))try{return(t||JSON.parse)(e),pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Kl={transitional:EN,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=pe.isObject(t);if(i&&pe.isHTMLForm(t)&&(t=new FormData(t)),pe.isFormData(t))return a?JSON.stringify(SN(t)):t;if(pe.isArrayBuffer(t)||pe.isBuffer(t)||pe.isStream(t)||pe.isFile(t)||pe.isBlob(t)||pe.isReadableStream(t))return t;if(pe.isArrayBufferView(t))return t.buffer;if(pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return QP(t,this.formSerializer).toString();if((l=pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return hu(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),rD(t)):t}],transformResponse:[function(t){const r=this.transitional||Kl.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(pe.isResponse(t)||pe.isReadableStream(t))return t;if(t&&pe.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Ze.from(l,Ze.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Kr.classes.FormData,Blob:Kr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],e=>{Kl.headers[e]={}});const nD=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),aD=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&nD[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},c1=Symbol("internals");function $o(e){return e&&String(e).trim().toLowerCase()}function sd(e){return e===!1||e==null?e:pe.isArray(e)?e.map(sd):String(e)}function sD(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const iD=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ff(e,t,r,n,a){if(pe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!pe.isString(t)){if(pe.isString(n))return t.indexOf(n)!==-1;if(pe.isRegExp(n))return n.test(t)}}function oD(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function lD(e,t){const r=pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}let vn=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,c,d){const u=$o(c);if(!u)throw new Error("header name must be a non-empty string");const f=pe.findKey(a,u);(!f||a[f]===void 0||d===!0||d===void 0&&a[f]!==!1)&&(a[f||c]=sd(l))}const o=(l,c)=>pe.forEach(l,(d,u)=>i(d,u,c));if(pe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(pe.isString(t)&&(t=t.trim())&&!iD(t))o(aD(t),r);else if(pe.isObject(t)&&pe.isIterable(t)){let l={},c,d;for(const u of t){if(!pe.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?pe.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=$o(t),t){const n=pe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return sD(a);if(pe.isFunction(r))return r.call(this,a,n);if(pe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=$o(t),t){const n=pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ff(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=$o(o),o){const l=pe.findKey(n,o);l&&(!r||ff(n,n[l],l,r))&&(delete n[l],a=!0)}}return pe.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||ff(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return pe.forEach(this,(a,i)=>{const o=pe.findKey(n,i);if(o){r[o]=sd(a),delete r[i];return}const l=t?oD(i):String(i).trim();l!==i&&delete r[i],r[l]=sd(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return pe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[c1]=this[c1]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=$o(o);n[l]||(lD(a,o),n[l]=!0)}return pe.isArray(t)?t.forEach(i):i(t),this}};vn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);pe.reduceDescriptors(vn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});pe.freezeMethods(vn);function mf(e,t){const r=this||Kl,n=t||r,a=vn.from(n.headers);let i=n.data;return pe.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function TN(e){return!!(e&&e.__CANCEL__)}function bo(e,t,r){Ze.call(this,e??"canceled",Ze.ERR_CANCELED,t,r),this.name="CanceledError"}pe.inherits(bo,Ze,{__CANCEL__:!0});function _N(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ze("Request failed with status code "+r.status,[Ze.ERR_BAD_REQUEST,Ze.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function cD(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function dD(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[i];o||(o=d),r[a]=c,n[a]=d;let f=i,m=0;for(;f!==a;)m+=r[f++],f=f%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-o<t)return;const h=u&&d-u;return h?Math.round(m*1e3/h):void 0}}function uD(e,t){let r=0,n=1e3/t,a,i;const o=(d,u=Date.now())=>{r=u,a=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),f=u-r;f>=n?o(d,u):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},n-f)))},()=>a&&o(a)]}const ud=(e,t,r=3)=>{let n=0;const a=dD(50,250);return uD(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-n,d=a(c),u=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},d1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},u1=e=>(...t)=>pe.asap(()=>e(...t)),fD=Kr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Kr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Kr.origin),Kr.navigator&&/(msie|trident)/i.test(Kr.navigator.userAgent)):()=>!0,mD=Kr.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];pe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),pe.isString(n)&&o.push("path="+n),pe.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function hD(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function pD(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function AN(e,t,r){let n=!hD(t);return e&&(n||r==!1)?pD(e,t):t}const f1=e=>e instanceof vn?{...e}:e;function fi(e,t){t=t||{};const r={};function n(d,u,f,m){return pe.isPlainObject(d)&&pe.isPlainObject(u)?pe.merge.call({caseless:m},d,u):pe.isPlainObject(u)?pe.merge({},u):pe.isArray(u)?u.slice():u}function a(d,u,f,m){if(pe.isUndefined(u)){if(!pe.isUndefined(d))return n(void 0,d,f,m)}else return n(d,u,f,m)}function i(d,u){if(!pe.isUndefined(u))return n(void 0,u)}function o(d,u){if(pe.isUndefined(u)){if(!pe.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,f){if(f in t)return n(d,u);if(f in e)return n(void 0,d)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,f)=>a(f1(d),f1(u),f,!0)};return pe.forEach(Object.keys({...e,...t}),function(u){const f=c[u]||a,m=f(e[u],t[u],u);pe.isUndefined(m)&&f!==l||(r[u]=m)}),r}const kN=e=>{const t=fi({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=vn.from(o),t.url=NN(AN(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),pe.isFormData(r)){if(Kr.hasStandardBrowserEnv||Kr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(pe.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,f])=>{d.includes(u.toLowerCase())&&o.set(u,f)})}}if(Kr.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(t)),n||n!==!1&&fD(t.url))){const c=a&&i&&mD.read(i);c&&o.set(a,c)}return t},xD=typeof XMLHttpRequest<"u",gD=xD&&function(e){return new Promise(function(r,n){const a=kN(e);let i=a.data;const o=vn.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,f,m,h,p;function x(){h&&h(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function y(){if(!g)return;const b=vn.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:b,config:e,request:g};_N(function(S){r(S),x()},function(S){n(S),x()},N),g=null}"onloadend"in g?g.onloadend=y:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(y)},g.onabort=function(){g&&(n(new Ze("Request aborted",Ze.ECONNABORTED,e,g)),g=null)},g.onerror=function(j){const N=j&&j.message?j.message:"Network Error",E=new Ze(N,Ze.ERR_NETWORK,e,g);E.event=j||null,n(E),g=null},g.ontimeout=function(){let j=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||EN;a.timeoutErrorMessage&&(j=a.timeoutErrorMessage),n(new Ze(j,N.clarifyTimeoutError?Ze.ETIMEDOUT:Ze.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&pe.forEach(o.toJSON(),function(j,N){g.setRequestHeader(N,j)}),pe.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),l&&l!=="json"&&(g.responseType=a.responseType),d&&([m,p]=ud(d,!0),g.addEventListener("progress",m)),c&&g.upload&&([f,h]=ud(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",h)),(a.cancelToken||a.signal)&&(u=b=>{g&&(n(!b||b.type?new bo(null,e,g):b),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const w=cD(a.url);if(w&&Kr.protocols.indexOf(w)===-1){n(new Ze("Unsupported protocol "+w+":",Ze.ERR_BAD_REQUEST,e));return}g.send(i||null)})},vD=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof Ze?u:new bo(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new Ze(`timeout ${t} of ms exceeded`,Ze.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>pe.asap(l),c}},yD=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},bD=async function*(e,t){for await(const r of wD(e))yield*yD(r,t)},wD=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},m1=(e,t,r,n)=>{const a=bD(e,t);let i=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let f=u.byteLength;if(r){let m=i+=f;r(m)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},h1=64*1024,{isFunction:Tc}=pe,jD=(({Request:e,Response:t})=>({Request:e,Response:t}))(pe.global),{ReadableStream:p1,TextEncoder:x1}=pe.global,g1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ND=e=>{e=pe.merge.call({skipUndefined:!0},jD,e);const{fetch:t,Request:r,Response:n}=e,a=t?Tc(t):typeof fetch=="function",i=Tc(r),o=Tc(n);if(!a)return!1;const l=a&&Tc(p1),c=a&&(typeof x1=="function"?(p=>x=>p.encode(x))(new x1):async p=>new Uint8Array(await new r(p).arrayBuffer())),d=i&&l&&g1(()=>{let p=!1;const x=new r(Kr.origin,{body:new p1,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!x}),u=o&&l&&g1(()=>pe.isReadableStream(new n("").body)),f={stream:u&&(p=>p.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!f[p]&&(f[p]=(x,g)=>{let y=x&&x[p];if(y)return y.call(x);throw new Ze(`Response type '${p}' is not supported`,Ze.ERR_NOT_SUPPORT,g)})});const m=async p=>{if(p==null)return 0;if(pe.isBlob(p))return p.size;if(pe.isSpecCompliantForm(p))return(await new r(Kr.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(p)||pe.isArrayBuffer(p))return p.byteLength;if(pe.isURLSearchParams(p)&&(p=p+""),pe.isString(p))return(await c(p)).byteLength},h=async(p,x)=>{const g=pe.toFiniteNumber(p.getContentLength());return g??m(x)};return async p=>{let{url:x,method:g,data:y,signal:w,cancelToken:b,timeout:j,onDownloadProgress:N,onUploadProgress:E,responseType:S,headers:T,withCredentials:k="same-origin",fetchOptions:I}=kN(p),C=t||fetch;S=S?(S+"").toLowerCase():"text";let A=vD([w,b&&b.toAbortSignal()],j),L=null;const _=A&&A.unsubscribe&&(()=>{A.unsubscribe()});let W;try{if(E&&d&&g!=="get"&&g!=="head"&&(W=await h(T,y))!==0){let re=new r(x,{method:"POST",body:y,duplex:"half"}),M;if(pe.isFormData(y)&&(M=re.headers.get("content-type"))&&T.setContentType(M),re.body){const[z,V]=d1(W,ud(u1(E)));y=m1(re.body,h1,z,V)}}pe.isString(k)||(k=k?"include":"omit");const Y=i&&"credentials"in r.prototype,Q={...I,signal:A,method:g.toUpperCase(),headers:T.normalize().toJSON(),body:y,duplex:"half",credentials:Y?k:void 0};L=i&&new r(x,Q);let J=await(i?C(L,I):C(x,Q));const U=u&&(S==="stream"||S==="response");if(u&&(N||U&&_)){const re={};["status","statusText","headers"].forEach(P=>{re[P]=J[P]});const M=pe.toFiniteNumber(J.headers.get("content-length")),[z,V]=N&&d1(M,ud(u1(N),!0))||[];J=new n(m1(J.body,h1,z,()=>{V&&V(),_&&_()}),re)}S=S||"text";let ie=await f[pe.findKey(f,S)||"text"](J,p);return!U&&_&&_(),await new Promise((re,M)=>{_N(re,M,{data:ie,headers:vn.from(J.headers),status:J.status,statusText:J.statusText,config:p,request:L})})}catch(Y){throw _&&_(),Y&&Y.name==="TypeError"&&/Load failed|fetch/i.test(Y.message)?Object.assign(new Ze("Network Error",Ze.ERR_NETWORK,p,L),{cause:Y.cause||Y}):Ze.from(Y,Y&&Y.code,p,L)}}},ED=new Map,CN=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,i=[n,a,r];let o=i.length,l=o,c,d,u=ED;for(;l--;)c=i[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:ND(t)),u=d;return d};CN();const Dh={http:zP,xhr:gD,fetch:{get:CN}};pe.forEach(Dh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const v1=e=>`- ${e}`,SD=e=>pe.isFunction(e)||e===null||e===!1,ON={getAdapter:(e,t)=>{e=pe.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let o=0;o<r;o++){n=e[o];let l;if(a=n,!SD(n)&&(a=Dh[(l=String(n)).toLowerCase()],a===void 0))throw new Ze(`Unknown adapter '${l}'`);if(a&&(pe.isFunction(a)||(a=a.get(t))))break;i[l||"#"+o]=a}if(!a){const o=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(v1).join(`
`):" "+v1(o[0]):"as no adapter specified";throw new Ze("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a},adapters:Dh};function hf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new bo(null,e)}function y1(e){return hf(e),e.headers=vn.from(e.headers),e.data=mf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),ON.getAdapter(e.adapter||Kl.adapter,e)(e).then(function(n){return hf(e),n.data=mf.call(e,e.transformResponse,n),n.headers=vn.from(n.headers),n},function(n){return TN(n)||(hf(e),n&&n.response&&(n.response.data=mf.call(e,e.transformResponse,n.response),n.response.headers=vn.from(n.response.headers))),Promise.reject(n)})}const PN="1.12.2",pu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{pu[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const b1={};pu.transitional=function(t,r,n){function a(i,o){return"[Axios v"+PN+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new Ze(a(o," has been removed"+(r?" in "+r:"")),Ze.ERR_DEPRECATED);return r&&!b1[o]&&(b1[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};pu.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function TD(e,t,r){if(typeof e!="object")throw new Ze("options must be an object",Ze.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new Ze("option "+i+" must be "+c,Ze.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ze("Unknown option "+i,Ze.ERR_BAD_OPTION)}}const id={assertOptions:TD,validators:pu},ja=id.validators;let ti=class{constructor(t){this.defaults=t||{},this.interceptors={request:new l1,response:new l1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=fi(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&id.assertOptions(n,{silentJSONParsing:ja.transitional(ja.boolean),forcedJSONParsing:ja.transitional(ja.boolean),clarifyTimeoutError:ja.transitional(ja.boolean)},!1),a!=null&&(pe.isFunction(a)?r.paramsSerializer={serialize:a}:id.assertOptions(a,{encode:ja.function,serialize:ja.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),id.assertOptions(r,{baseUrl:ja.spelling("baseURL"),withXsrfToken:ja.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&pe.merge(i.common,i[r.method]);i&&pe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=vn.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let u,f=0,m;if(!c){const p=[y1.bind(this),void 0];for(p.unshift(...l),p.push(...d),m=p.length,u=Promise.resolve(r);f<m;)u=u.then(p[f++],p[f++]);return u}m=l.length;let h=r;for(;f<m;){const p=l[f++],x=l[f++];try{h=p(h)}catch(g){x.call(this,g);break}}try{u=y1.call(this,h)}catch(p){return Promise.reject(p)}for(f=0,m=d.length;f<m;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=fi(this.defaults,t);const r=AN(t.baseURL,t.url,t.allowAbsoluteUrls);return NN(r,t.params,t.paramsSerializer)}};pe.forEach(["delete","get","head","options"],function(t){ti.prototype[t]=function(r,n){return this.request(fi(n||{},{method:t,url:r,data:(n||{}).data}))}});pe.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(fi(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ti.prototype[t]=r(),ti.prototype[t+"Form"]=r(!0)});let _D=class DN{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new bo(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new DN(function(a){t=a}),cancel:t}}};function AD(e){return function(r){return e.apply(null,r)}}function kD(e){return pe.isObject(e)&&e.isAxiosError===!0}const Ih={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ih).forEach(([e,t])=>{Ih[t]=e});function IN(e){const t=new ti(e),r=uN(ti.prototype.request,t);return pe.extend(r,ti.prototype,t,{allOwnKeys:!0}),pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return IN(fi(e,a))},r}const zt=IN(Kl);zt.Axios=ti;zt.CanceledError=bo;zt.CancelToken=_D;zt.isCancel=TN;zt.VERSION=PN;zt.toFormData=hu;zt.AxiosError=Ze;zt.Cancel=zt.CanceledError;zt.all=function(t){return Promise.all(t)};zt.spread=AD;zt.isAxiosError=kD;zt.mergeConfig=fi;zt.AxiosHeaders=vn;zt.formToJSON=e=>SN(pe.isHTMLForm(e)?new FormData(e):e);zt.getAdapter=ON.getAdapter;zt.HttpStatusCode=Ih;zt.default=zt;const{Axios:hle,AxiosError:ple,CanceledError:xle,isCancel:gle,CancelToken:vle,VERSION:yle,all:ble,Cancel:wle,isAxiosError:jle,spread:Nle,toFormData:Ele,AxiosHeaders:Sle,HttpStatusCode:Tle,formToJSON:_le,getAdapter:Ale,mergeConfig:kle}=zt,fd={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},ox=()=>"/dsfms-template/",CD=(e="/")=>{const r=`${ox()}${e}`;window.location.href=r},pf=()=>{CD("/")},RN="https://dsfms.id.vn",Te=zt.create({baseURL:RN,timeout:1e4,headers:{"Content-Type":"application/json"}});let xf=!1,Rh=[],_c=0;const w1=2,FN=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},OD=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},j1=(e,t=null)=>{Rh.forEach(r=>{e?r.reject(e):r.resolve(t)}),Rh=[]};Te.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(FN(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):OD(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Te.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&_c<w1){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),xf)return new Promise((a,i)=>{Rh.push({resolve:a,reject:i})}).then(a=>(t.headers.Authorization=`Bearer ${a}`,Te(t))).catch(a=>Promise.reject(a));t._retry=!0,xf=!0,_c++;const n=localStorage.getItem("refreshToken");if(n)try{if(console.log(" Token ht hn (401), ang refresh token..."),FN(n))throw new Error("Refresh token is also expired");const a=await zt.post(`${RN}/auth/refresh`,{refresh_token:n}),{access_token:i,refresh_token:o}=a.data;if(!i||!o)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",o),_c=0,console.log(" Refresh token thnh cng, retry request gc"),j1(null,i),t.headers.Authorization=`Bearer ${i}`,await Te(t)}catch(a){return console.error(" Refresh token tht bi:",a),j1(a,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),pf(),Promise.reject(a)}finally{xf=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),pf()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);_c>=w1&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),pf())}return Promise.reject(e)});const Ac=zt.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),hs={login:async e=>{try{return(await Ac.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await Ac.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Te.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await Ac.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await Ac.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(n){throw n.response?.data||n.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},nn={getUsers:async(e={})=>{try{return(await Te.get("/users",{params:e})).data}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{return(await Te.get(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Te.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Te.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Te.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Te.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Te.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{return(await Te.get("/roles")).data}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Te.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Te.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Te.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Te.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Te.get("/users",{params:{includeDeleted:!0,roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},_n={getRoles:async(e={})=>{try{return(await Te.get("/roles",{params:e})).data}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{return(await Te.get(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{return(await Te.post("/roles",e)).data}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Te.put(`/roles/${e}`,t);return console.log(" API updateRole success:",r.data),r.data}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{return(await Te.delete(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{return(await Te.patch(`/roles/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{return(await Te.patch(`/roles/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{return(await Te.delete(`/roles/${e}`)).data}catch(t){throw t.response?.data||t.message}}},ct={getDepartments:async(e={})=>{try{return(await Te.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{return(await Te.get(`/departments/${e}`,{params:{includeDeleted:!0}})).data}catch(t){throw console.error("Error fetching department:",t),t}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Te.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{return(await Te.put(`/departments/${e}`,t)).data}catch(r){throw console.error("Error updating department:",r),r}},deleteDepartment:async e=>{try{return(await Te.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Te.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Te.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Te.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Te.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Te.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Te.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Te.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Te.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},yn={getCourses:async(e={})=>{try{return(await Te.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await Te.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Te.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Te.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},deleteCourse:async e=>{try{return(await Te.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},archiveCourse:async e=>{try{return(await Te.post(`/courses/${e}/archive`)).data}catch(t){throw console.error("Error archiving course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Te.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Te.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{return(await Te.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await Te.get(`/courses/trainees/${e}/enrollments`)).data},no={getTrainees:async(e={})=>{try{return(await Te.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Te.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Te.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Te.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Te.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Te.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Te.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Te.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Te.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Te.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Te.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Te.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{return(await Te.get("/users",{params:{includeDeleted:!0,roleName:"TRAINEE",...e}})).data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={trainees:e};console.log("Sending request with format:",t);const r=await Te.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Te.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},Dr={getSubjects:async(e={})=>{try{return(await Te.get("/subjects",{params:e})).data}catch(t){throw console.error("Error fetching subjects:",t),t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;console.log(" API Call - URL:",r),console.log(" API Call - courseId:",e),console.log(" API Call - params:",t);try{const n=await Te.get(r,{params:t});return console.log(" API Call - Response:",n),console.log(" API Call - Response data:",n.data),n.data}catch(n){throw console.error(" API Call - Error:",n),console.error(" API Call - Error response:",n.response),console.error(" API Call - Error status:",n.response?.status),console.error(" API Call - Error data:",n.response?.data),n}},getSubjectById:async e=>{try{return(await Te.get(`/subjects/${e}`)).data}catch(t){throw console.error("Error fetching subject:",t),t}},createSubject:async e=>{try{return(await Te.post("/subjects",e)).data}catch(t){throw console.error("Error creating subject:",t),t}},updateSubject:async(e,t)=>{try{return(await Te.put(`/subjects/${e}`,t)).data}catch(r){throw console.error("Error updating subject:",r),r}},deleteSubject:async e=>{try{return(await Te.delete(`/subjects/${e}`)).data}catch(t){throw console.error("Error deleting subject:",t),t}},bulkImportSubjects:async e=>{try{console.log(" Sending bulk import data to API:",e),console.log(" Data type check:",{isArray:Array.isArray(e),length:e.length,firstItem:e[0],firstItemKeys:Object.keys(e[0]||{}),firstItemTypes:Object.keys(e[0]||{}).reduce((a,i)=>(a[i]=typeof e[0][i],a),{})});const r={courseId:e[0]?.courseId,subjects:e.map(a=>{const{courseId:i,...o}=a;return o})};console.log(" Using working format:",r);const n=await Te.post("/subjects/bulk",r);return console.log(" Bulk import API response:",n.data),n.data}catch(t){throw console.error(" Error bulk importing subjects:",t),console.error(" Error details:",t.response?.data),console.error(" Error status:",t.response?.status),console.error(" Error message:",t.response?.data?.message),console.error(" Validation errors:",t.response?.data?.errors),console.error(" Full error response:",JSON.stringify(t.response?.data,null,2)),t}},assignTrainees:async(e,t)=>{try{console.log(" Assigning trainees to subject:",e),console.log(" Trainee data being sent:",JSON.stringify(t,null,2)),console.log(" Data validation:",{subjectId:e,subjectIdType:typeof e,traineeDataKeys:Object.keys(t),enrolledCount:t.enrolledCount,enrolledArray:t.enrolled,enrolledLength:t.enrolled?.length,firstTrainee:t.enrolled?.[0],firstTraineeKeys:t.enrolled?.[0]?Object.keys(t.enrolled[0]):null});const r=await Te.post(`/subjects/${e}/assign-trainees`,t);return console.log(" Assign trainees API response:",r.data),r.data}catch(r){throw console.error(" Error assigning trainees to subject:",r),console.error(" Error status:",r.response?.status),console.error(" Error details:",r.response?.data),console.error(" Error message:",r.response?.data?.message),console.error(" Validation errors:",r.response?.data?.errors),console.error(" Full error response:",JSON.stringify(r.response?.data,null,2)),r}},removeTraineeFromSubject:async(e,t,r)=>{try{console.log(" Removing trainee from subject:",{subjectId:e,traineeId:t,batchCode:r});const n={batchCode:r};console.log(" Request data:",JSON.stringify(n,null,2));const a=await Te.delete(`/subjects/${e}/trainees/${t}`,{data:n});return console.log(" Remove trainee from subject API response:",a.data),a.data}catch(n){throw console.error(" Error removing trainee from subject:",n),console.error(" Error status:",n.response?.status),console.error(" Error details:",n.response?.data),console.error(" Error message:",n.response?.data?.message),n}},addTrainerToSubject:async(e,t)=>{try{const r={trainerUserId:t.trainer_user_id,roleInSubject:t.role_in_subject};return(await Te.post(`/subjects/${e}/trainers`,r)).data}catch(r){throw r.response?.data||r.message}},getSubjectTrainers:async e=>{try{return(await Te.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const n={roleInSubject:r.roleInSubject};return(await Te.put(`/subjects/${e}/trainers/${t}`,n)).data}catch(n){throw n.response?.data||n.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Te.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}}},N1={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const n of r)try{const a=new FormData;a.append(n,e),console.log(` Testing field name: "${n}"`);const i=await Te.post(`/media/docs/upload/${t}`,a,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${n}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(a){console.log(` Failed with field name: "${n}"`,a.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`},zo={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},ca=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return zo[e]||e;if(e&&typeof e=="object"){const{message:r,errors:n}=e;let a=r;if(Array.isArray(r))if(r.length>0){const o=r[0];typeof o=="object"&&o!==null?a=o.message||o.field||"Validation failed":a=o}else a="Validation failed";const i=zo[a]||a;if(n&&Array.isArray(n)&&n.length>0){const o=n.map(l=>{if(typeof l=="string"){const c=l.match(/(\w+)\s+(.+)/);if(c){const[,d,u]=c;return zo[a]?.fields?.[d]||u}return l}else if(typeof l=="object"&&l!==null)return l.field&&l.message?zo[a]?.fields?.[l.field]||l.message:l.property&&l.constraints?zo[a]?.fields?.[l.property]||Object.values(l.constraints)[0]||l.property:JSON.stringify(l);return String(l)});return`${i}

Details:
${o.join(`
`)}`}return i}return e?.response?.data?ca(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},MN=v.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),PD=({children:e})=>{const[t,r]=v.useState(null),[n,a]=v.useState(null),[i,o]=v.useState([]),[l,c]=v.useState(!1),[d,u]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const y=localStorage.getItem("authToken"),w=localStorage.getItem("user"),b=localStorage.getItem("refreshToken");if(y&&w&&b)try{const j=JSON.parse(atob(y.split(".")[1])),N=Date.now()/1e3;if(j.exp<N)try{const E=await hs.refreshToken(b);localStorage.setItem("authToken",E.access_token),localStorage.setItem("refreshToken",E.refresh_token);const S=JSON.parse(w);r(S),c(!0);try{const{role:T,permissions:k}=await f(S.role,S.roleId);if(T&&k)a(T),o(k);else throw new Error("Failed to fetch role and permissions")}catch(T){console.error("Failed to fetch role and permissions on initialization:",T),hs.logout(),r(null),a(null),o([]),c(!1)}}catch{hs.logout(),r(null),a(null),o([]),c(!1)}else{const E=JSON.parse(w);r(E),c(!0);try{const{role:S,permissions:T}=await f(E.role,E.roleId);if(S&&T)a(S),o(T);else throw new Error("Failed to fetch role and permissions")}catch(S){console.error("Failed to fetch role and permissions on initialization:",S),hs.logout(),r(null),a(null),o([]),c(!1)}}}catch(j){console.error(" Error parsing token or user data:",j),hs.logout(),r(null),a(null),o([]),c(!1)}else r(null),a(null),o([]),c(!1)}catch(y){console.error("Error accessing localStorage:",y),r(null),a(null),o([]),c(!1)}finally{u(!1)}})()},[]),v.useEffect(()=>{if(!l||d)return;const g=async()=>{const w=localStorage.getItem("authToken"),b=localStorage.getItem("refreshToken");if(!w||!b){p();return}try{const j=JSON.parse(atob(w.split(".")[1])),N=Date.now()/1e3;j.exp-N<300&&((await h()).success||(console.error(" Token refresh failed in validation"),p()))}catch(j){console.error(" Token validation failed:",j);try{(await h()).success||(console.error(" Token refresh failed after validation error"),p())}catch(N){console.error(" Token refresh failed:",N),p()}}},y=setTimeout(()=>{g();const w=setInterval(g,120*1e3);return()=>clearInterval(w)},500);return()=>clearTimeout(y)},[l,d]);const f=async(g,y)=>{try{if(y)try{const w=await _n.getRoleById(y);return a(w),o(w.permissions||[]),{role:w,permissions:w.permissions||[]}}catch(w){if(console.error("Error fetching role by ID:",w),w.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{const j=await Te.get("/users/me");if(j.data&&j.data.role&&j.data.role.permissions){const N={id:y,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:j.data.role.permissions};return a(N),o(N.permissions),{role:N,permissions:N.permissions}}}catch(j){console.error("Failed to get user profile:",j)}console.warn("Cannot fetch permissions, creating minimal role");const b={id:y,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return a(b),o([]),{role:b,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const w=await _n.getRoles(),b=w.data||w;let j;if(b&&b.roles&&Array.isArray(b.roles))j=b.roles;else if(Array.isArray(b))j=b;else throw new Error("Invalid roles data structure");const N=j.find(E=>E.name===g);if(N){const E=await _n.getRoleById(N.id);return a(E),o(E.permissions||[]),{role:E,permissions:E.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(w){throw console.error("Fallback method failed:",w),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(w){return console.error("Error fetching user role and permissions:",w),{role:null,permissions:[]}}},m=async g=>{try{u(!0);const y=await hs.login(g);localStorage.setItem("authToken",y.access_token),localStorage.setItem("refreshToken",y.refresh_token);let w;try{const N=JSON.parse(atob(y.access_token.split(".")[1]));if(!N.userId||!N.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");w={id:N.userId,email:g.email,fullName:N.fullName||N.name||"User",role:N.roleName,roleId:N.roleId,department:N.department||"IT",lastLogin:new Date().toISOString()}}catch(N){throw console.error("Error decoding token:",N),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(w));const{role:b,permissions:j}=await f(w.role,w.roleId);if(!b||!j)throw new Error("Failed to fetch user role and permissions");return r(w),a(b),o(j),c(!0),{success:!0,user:w,role:b,permissions:j}}catch(y){return{success:!1,error:ca(y)||"Login failed"}}finally{u(!1)}},h=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const y=await hs.refreshToken(g);return localStorage.setItem("authToken",y.access_token),localStorage.setItem("refreshToken",y.refresh_token),{success:!0,tokens:y}}catch(g){return console.error("Manual token refresh failed:",g),p(),{success:!1,error:g.message}}},p=()=>{hs.logout(),r(null),a(null),o([]),c(!1)},x={user:t,setUser:r,userRole:n,userPermissions:i,isAuthenticated:l,setIsAuthenticated:c,isLoading:d,login:m,logout:p,refreshToken:h,fetchUserRoleAndPermissions:f};try{return s.jsx(MN.Provider,{value:x,children:e})}catch(g){return console.error(" AuthProvider error:",g),s.jsxs("div",{style:{padding:"20px",color:"red"},children:[s.jsx("h3",{children:"Authentication Error"}),s.jsx("p",{children:"There was an error initializing the authentication system."}),s.jsxs("details",{children:[s.jsx("summary",{children:"Error Details"}),s.jsx("pre",{children:g.message})]})]})}},mn=()=>{const e=v.useContext(MN);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},E1=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],n=t[1],i=n.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",l={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return n.includes("forgot-password")?"Forgot Password":n.includes("reset-password")?"Reset Password":n.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:n.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:n.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:n.includes("add-trainers")?"Add Trainers to Department":n.includes("remove-trainers")?"Remove Trainers from Department":n.includes("new-feature")?"Create New Feature":n.includes("bulk-import")?"Bulk Import Data":n.includes("export-report")?"Export Report":DD(l,i,n)}return e},DD=(e,t,r)=>{if(r.includes("-")){const n=r.split("/").filter(o=>o&&!o.startsWith(":")),i=n[n.length-1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},wo=()=>{const[e,t]=v.useState([]),[r,n]=v.useState(!1),[a,i]=v.useState(null),{userPermissions:o,userRole:l}=mn(),c=v.useCallback(async()=>{n(!0),i(null);try{o&&o.length>0?t(o):t([])}catch(E){i(E),console.error("Error setting permissions from userPermissions:",E)}finally{n(!1)}},[o]),d=v.useCallback(()=>e.map(E=>({id:E.id,title:E.viewName||E.description||E1(E.name),description:E.description||"",module:E.module,method:E.method,path:E.path,isActive:E.isActive,viewName:E.viewName,viewModule:E.viewModule})),[e]),u=v.useCallback(()=>{const E=d(),S={};return E.forEach(T=>{const k=T.module,I=T.viewModule||`${T.module} Management`;S[k]||(S[k]={id:k,name:I,description:`Manage ${I.toLowerCase()} related permissions`,permissions:[]}),S[k].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(S).sort((T,k)=>T.name.localeCompare(k.name))},[d]),f=v.useCallback(E=>{const S=e.find(T=>T.id===E);return S?S.isActive==="ACTIVE":!0},[e]),m=v.useCallback(E=>e.find(S=>S.id===E),[e]),h=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(E=>E.name)),[o]),p=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(E=>E.path)),[o]),x=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(E=>E.id)),[o]),g=v.useCallback(E=>{if(!o||o.length===0)return!1;const S=h.has(E),T=p.has(E),k=x.has(E);return S||T||k},[o,h,p,x]),y=v.useCallback(E=>!o||o.length===0?!1:E.some(S=>g(S)),[o,g]),w=v.useCallback(E=>!o||o.length===0?!1:E.every(S=>g(S)),[o,g]),b=v.useCallback(E=>!o||o.length===0?!1:o.some(S=>S.module===E),[o]),j=v.useCallback(()=>!o||o.length===0?[]:[...new Set(o.map(S=>S.module))],[o]),N=v.useCallback(()=>{if(!o||o.length===0)return[];const E=o.map(T=>({id:T.id,title:T.viewName||T.description||E1(T.name),description:T.description||"",module:T.module,method:T.method,path:T.path,isActive:T.isActive,viewName:T.viewName,viewModule:T.viewModule})),S={};return E.forEach(T=>{const k=T.module,I=T.viewModule||`${T.module} Management`;S[k]||(S[k]={id:k,name:I,description:`Manage ${I.toLowerCase()} related permissions`,permissions:[]}),S[k].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(S).sort((T,k)=>T.name.localeCompare(k.name))},[o]);return v.useEffect(()=>{o&&o.length>0&&c()},[c,o]),{permissions:e,loading:r,error:a,fetchPermissions:c,getUIPermissions:d,getPermissionGroups:u,isPermissionActive:f,getApiPermission:m,hasPermission:g,hasAnyPermission:y,hasAllPermissions:w,hasModuleAccess:b,getAccessibleModules:j,getUserPermissionGroups:N,userPermissions:o,userRole:l}},je={USERS:{CREATE:"POST /users",VIEW_ALL:"GET /users",VIEW_DETAIL:"GET /users/:userId",UPDATE:"PUT /users/:userId",BULK_CREATE:"POST /users/bulk"},ROLES:{CREATE:"POST /roles",VIEW_ALL:"GET /roles"},DEPARTMENTS:{CREATE:"POST /departments",VIEW_ALL:"GET /departments",VIEW_DETAIL:"GET /departments/:departmentId",UPDATE:"PUT /departments/:departmentId",REMOVE_TRAINERS:"PATCH /departments/:departmentId/remove-trainers"},COURSES:{CREATE:"POST /courses",VIEW_DETAIL:"GET /courses/:id",UPDATE:"PUT /courses/:id"},SUBJECTS:{VIEW_DETAIL:"GET /subjects/:id",UPDATE:"PUT /subjects/:id",DELETE:"DELETE /subjects/:id",REMOVE_INSTRUCTOR:"DELETE /subjects/:id/instructors"},TEMPLATES:{CREATE:"POST /templates",VIEW_ALL:"GET /templates"},PROFILES:{VIEW:"GET /profile"},GLOBAL_FIELDS:{VIEW_ALL:"GET /global-fields"},DASHBOARD:{VIEW:"GET /dashboard"},TRAINEES:{VIEW_ALL:"GET /trainees",VIEW_DETAIL:"GET /trainees/:id",DELETE:"DELETE /trainees/:id",VIEW_COURSES:"GET /trainees/:id/courses",VIEW_SUBJECTS:"GET /trainees/:id/subjects",VIEW_ASSESSMENTS:"GET /trainees/:id/assessments"},SQA:{VIEW_TEMPLATES:"GET /templates",VIEW_TEMPLATE_DETAIL:"GET /templates/:id",VIEW_TEMPLATE_SCHEMA:"GET /templates/:id/schema",EXTRACT_TEMPLATE_FIELDS:"POST /templates/extract-fields"}};function LN(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=LN(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function tt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=LN(e))&&(n&&(n+=" "),n+=t);return n}function ID(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}ID(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Yl=e=>typeof e=="number"&&!isNaN(e),mi=e=>typeof e=="string",Xa=e=>typeof e=="function",RD=e=>mi(e)||Yl(e),Fh=e=>mi(e)||Xa(e)?e:null,FD=(e,t)=>e===!1||Yl(e)&&e>0?e:t,Mh=e=>v.isValidElement(e)||mi(e)||Xa(e)||Yl(e);function MD(e,t,r=300){let{scrollHeight:n,style:a}=e;requestAnimationFrame(()=>{a.minHeight="initial",a.height=n+"px",a.transition=`all ${r}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,r)})})}function LD({enter:e,exit:t,appendPosition:r=!1,collapse:n=!0,collapseDuration:a=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:d,isIn:u,playToast:f}){let m=r?`${e}--${o}`:e,h=r?`${t}--${o}`:t,p=v.useRef(0);return v.useLayoutEffect(()=>{let x=d.current,g=m.split(" "),y=w=>{w.target===d.current&&(f(),x.removeEventListener("animationend",y),x.removeEventListener("animationcancel",y),p.current===0&&w.type!=="animationcancel"&&x.classList.remove(...g))};x.classList.add(...g),x.addEventListener("animationend",y),x.addEventListener("animationcancel",y)},[]),v.useEffect(()=>{let x=d.current,g=()=>{x.removeEventListener("animationend",g),n?MD(x,c,a):c()};u||(l?g():(p.current=1,x.className+=` ${h}`,x.addEventListener("animationend",g)))},[u]),G.createElement(G.Fragment,null,i)}}function S1(e,t){return{content:BN(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function BN(e,t,r=!1){return v.isValidElement(e)&&!mi(e.type)?v.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):Xa(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function BD({closeToast:e,theme:t,ariaLabel:r="close"}){return G.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:n=>{n.stopPropagation(),e(!0)},"aria-label":r},G.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},G.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function $D({delay:e,isRunning:t,closeToast:r,type:n="default",hide:a,className:i,controlledProgress:o,progress:l,rtl:c,isIn:d,theme:u}){let f=a||o&&l===0,m={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(m.transform=`scaleX(${l})`);let h=tt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),p=Xa(i)?i({rtl:c,type:n,defaultClassName:h}):tt(h,i),x={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return G.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},G.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${n}`}),G.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:p,style:m,...x}))}var zD=1,$N=()=>`${zD++}`;function UD(e,t,r){let n=1,a=0,i=[],o=[],l=t,c=new Map,d=new Set,u=w=>(d.add(w),()=>d.delete(w)),f=()=>{o=Array.from(c.values()),d.forEach(w=>w())},m=({containerId:w,toastId:b,updateId:j})=>{let N=w?w!==e:e!==1,E=c.has(b)&&j==null;return N||E},h=(w,b)=>{c.forEach(j=>{var N;(b==null||b===j.props.toastId)&&((N=j.toggle)==null||N.call(j,w))})},p=w=>{var b,j;(j=(b=w.props)==null?void 0:b.onClose)==null||j.call(b,w.removalReason),w.isActive=!1},x=w=>{if(w==null)c.forEach(p);else{let b=c.get(w);b&&p(b)}f()},g=()=>{a-=i.length,i=[]},y=w=>{var b,j;let{toastId:N,updateId:E}=w.props,S=E==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(N,w),f(),r(S1(w,S?"added":"updated")),S&&((j=(b=w.props).onOpen)==null||j.call(b))};return{id:e,props:l,observe:u,toggle:h,removeToast:x,toasts:c,clearQueue:g,buildToast:(w,b)=>{if(m(b))return;let{toastId:j,updateId:N,data:E,staleId:S,delay:T}=b,k=N==null;k&&a++;let I={...l,style:l.toastStyle,key:n++,...Object.fromEntries(Object.entries(b).filter(([A,L])=>L!=null)),toastId:j,updateId:N,data:E,isIn:!1,className:Fh(b.className||l.toastClassName),progressClassName:Fh(b.progressClassName||l.progressClassName),autoClose:b.isLoading?!1:FD(b.autoClose,l.autoClose),closeToast(A){c.get(j).removalReason=A,x(j)},deleteToast(){let A=c.get(j);if(A!=null){if(r(S1(A,"removed")),c.delete(j),a--,a<0&&(a=0),i.length>0){y(i.shift());return}f()}}};I.closeButton=l.closeButton,b.closeButton===!1||Mh(b.closeButton)?I.closeButton=b.closeButton:b.closeButton===!0&&(I.closeButton=Mh(l.closeButton)?l.closeButton:!0);let C={content:w,props:I,staleId:S};l.limit&&l.limit>0&&a>l.limit&&k?i.push(C):Yl(T)?setTimeout(()=>{y(C)},T):y(C)},setProps(w){l=w},setToggle:(w,b)=>{let j=c.get(w);j&&(j.toggle=b)},isToastActive:w=>{var b;return(b=c.get(w))==null?void 0:b.isActive},getSnapshot:()=>o}}var ln=new Map,xl=[],Lh=new Set,WD=e=>Lh.forEach(t=>t(e)),zN=()=>ln.size>0;function HD(){xl.forEach(e=>WN(e.content,e.options)),xl=[]}var VD=(e,{containerId:t})=>{var r;return(r=ln.get(t||1))==null?void 0:r.toasts.get(e)};function UN(e,t){var r;if(t)return!!((r=ln.get(t))!=null&&r.isToastActive(e));let n=!1;return ln.forEach(a=>{a.isToastActive(e)&&(n=!0)}),n}function GD(e){if(!zN()){xl=xl.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||RD(e))ln.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=ln.get(e.containerId);t?t.removeToast(e.id):ln.forEach(r=>{r.removeToast(e.id)})}}var qD=(e={})=>{ln.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function WN(e,t){Mh(e)&&(zN()||xl.push({content:e,options:t}),ln.forEach(r=>{r.buildToast(e,t)}))}function KD(e){var t;(t=ln.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function HN(e,t){ln.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function YD(e){let t=e.containerId||1;return{subscribe(r){let n=UD(t,e,WD);ln.set(t,n);let a=n.observe(r);return HD(),()=>{a(),ln.delete(t)}},setProps(r){var n;(n=ln.get(t))==null||n.setProps(r)},getSnapshot(){var r;return(r=ln.get(t))==null?void 0:r.getSnapshot()}}}function XD(e){return Lh.add(e),()=>{Lh.delete(e)}}function ZD(e){return e&&(mi(e.toastId)||Yl(e.toastId))?e.toastId:$N()}function Xl(e,t){return WN(e,t),t.toastId}function xu(e,t){return{...t,type:t&&t.type||e,toastId:ZD(t)}}function gu(e){return(t,r)=>Xl(t,xu(e,r))}function xe(e,t){return Xl(e,xu("default",t))}xe.loading=(e,t)=>Xl(e,xu("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function JD(e,{pending:t,error:r,success:n},a){let i;t&&(i=mi(t)?xe.loading(t,a):xe.loading(t.render,{...a,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,u,f)=>{if(u==null){xe.dismiss(i);return}let m={type:d,...o,...a,data:f},h=mi(u)?{render:u}:u;return i?xe.update(i,{...m,...h}):xe(h.render,{...m,...h}),f},c=Xa(e)?e():e;return c.then(d=>l("success",n,d)).catch(d=>l("error",r,d)),c}xe.promise=JD;xe.success=gu("success");xe.info=gu("info");xe.error=gu("error");xe.warning=gu("warning");xe.warn=xe.warning;xe.dark=(e,t)=>Xl(e,xu("default",{theme:"dark",...t}));function QD(e){GD(e)}xe.dismiss=QD;xe.clearWaitingQueue=qD;xe.isActive=UN;xe.update=(e,t={})=>{let r=VD(e,t);if(r){let{props:n,content:a}=r,i={delay:100,...n,...t,toastId:t.toastId||e,updateId:$N()};i.toastId!==e&&(i.staleId=e);let o=i.render||a;delete i.render,Xl(o,i)}};xe.done=e=>{xe.update(e,{progress:1})};xe.onChange=XD;xe.play=e=>HN(!0,e);xe.pause=e=>HN(!1,e);function eI(e){var t;let{subscribe:r,getSnapshot:n,setProps:a}=v.useRef(YD(e)).current;a(e);let i=(t=v.useSyncExternalStore(r,n,n))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(d=>{let{position:u}=d.props;c.has(u)||c.set(u,[]),c.get(u).push(d)}),Array.from(c,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:UN,count:i?.length}}function tI(e){let[t,r]=v.useState(!1),[n,a]=v.useState(!1),i=v.useRef(null),o=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:u,closeOnClick:f}=e;KD({id:e.toastId,containerId:e.containerId,fn:r}),v.useEffect(()=>{if(e.pauseOnFocusLoss)return m(),()=>{h()}},[e.pauseOnFocusLoss]);function m(){document.hasFocus()||y(),window.addEventListener("focus",g),window.addEventListener("blur",y)}function h(){window.removeEventListener("focus",g),window.removeEventListener("blur",y)}function p(S){if(e.draggable===!0||e.draggable===S.pointerType){w();let T=i.current;o.canCloseOnClick=!0,o.canDrag=!0,T.style.transition="none",e.draggableDirection==="x"?(o.start=S.clientX,o.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(o.start=S.clientY,o.removalDistance=T.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function x(S){let{top:T,bottom:k,left:I,right:C}=i.current.getBoundingClientRect();S.nativeEvent.type!=="touchend"&&e.pauseOnHover&&S.clientX>=I&&S.clientX<=C&&S.clientY>=T&&S.clientY<=k?y():g()}function g(){r(!0)}function y(){r(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",j),document.addEventListener("pointerup",N)}function b(){document.removeEventListener("pointermove",j),document.removeEventListener("pointerup",N)}function j(S){let T=i.current;if(o.canDrag&&T){o.didMove=!0,t&&y(),e.draggableDirection==="x"?o.delta=S.clientX-o.start:o.delta=S.clientY-o.start,o.start!==S.clientX&&(o.canCloseOnClick=!1);let k=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;T.style.transform=`translate3d(${k},0)`,T.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function N(){b();let S=i.current;if(o.canDrag&&o.didMove&&S){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){a(!0),e.closeToast(!0),e.collapseAll();return}S.style.transition="transform 0.2s, opacity 0.2s",S.style.removeProperty("transform"),S.style.removeProperty("opacity")}}let E={onPointerDown:p,onPointerUp:x};return l&&c&&(E.onMouseEnter=y,e.stacked||(E.onMouseLeave=g)),f&&(E.onClick=S=>{u&&u(S),o.canCloseOnClick&&d(!0)}),{playToast:g,pauseToast:y,isRunning:t,preventExitTransition:n,toastRef:i,eventHandlers:E}}var rI=typeof window<"u"?v.useLayoutEffect:v.useEffect,vu=({theme:e,type:t,isLoading:r,...n})=>G.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...n});function nI(e){return G.createElement(vu,{...e},G.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function aI(e){return G.createElement(vu,{...e},G.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function sI(e){return G.createElement(vu,{...e},G.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function iI(e){return G.createElement(vu,{...e},G.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function oI(){return G.createElement("div",{className:"Toastify__spinner"})}var Bh={info:aI,warning:nI,success:sI,error:iI,spinner:oI},lI=e=>e in Bh;function cI({theme:e,type:t,isLoading:r,icon:n}){let a=null,i={theme:e,type:t};return n===!1||(Xa(n)?a=n({...i,isLoading:r}):v.isValidElement(n)?a=v.cloneElement(n,i):r?a=Bh.spinner():lI(t)&&(a=Bh[t](i))),a}var dI=e=>{let{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:a,playToast:i}=tI(e),{closeButton:o,children:l,autoClose:c,onClick:d,type:u,hideProgressBar:f,closeToast:m,transition:h,position:p,className:x,style:g,progressClassName:y,updateId:w,role:b,progress:j,rtl:N,toastId:E,deleteToast:S,isIn:T,isLoading:k,closeOnClick:I,theme:C,ariaLabel:A}=e,L=tt("Toastify__toast",`Toastify__toast-theme--${C}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":N},{"Toastify__toast--close-on-click":I}),_=Xa(x)?x({rtl:N,position:p,type:u,defaultClassName:L}):tt(L,x),W=cI(e),Y=!!j||!c,Q={closeToast:m,type:u,theme:C},J=null;return o===!1||(Xa(o)?J=o(Q):v.isValidElement(o)?J=v.cloneElement(o,Q):J=BD(Q)),G.createElement(h,{isIn:T,done:S,position:p,preventExitTransition:r,nodeRef:n,playToast:i},G.createElement("div",{id:E,tabIndex:0,onClick:d,"data-in":T,className:_,...a,style:g,ref:n,...T&&{role:b,"aria-label":A}},W!=null&&G.createElement("div",{className:tt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!k})},W),BN(l,e,!t),J,!e.customProgressBar&&G.createElement($D,{...w&&!Y?{key:`p-${w}`}:{},rtl:N,theme:C,delay:c,isRunning:t,isIn:T,closeToast:m,hide:f,type:u,className:y,controlledProgress:Y,progress:j||0})))},uI=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),fI=LD(uI("bounce",!0)),mI={position:"top-right",transition:fI,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function hI(e){let t={...mI,...e},r=e.stacked,[n,a]=v.useState(!0),i=v.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=eI(t),{className:d,style:u,rtl:f,containerId:m,hotKeys:h}=t;function p(g){let y=tt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":f});return Xa(d)?d({position:g,rtl:f,defaultClassName:y}):tt(y,Fh(d))}function x(){r&&(a(!0),xe.play())}return rI(()=>{var g;if(r){let y=i.current.querySelectorAll('[data-in="true"]'),w=12,b=(g=t.position)==null?void 0:g.includes("top"),j=0,N=0;Array.from(y).reverse().forEach((E,S)=>{let T=E;T.classList.add("Toastify__toast--stacked"),S>0&&(T.dataset.collapsed=`${n}`),T.dataset.pos||(T.dataset.pos=b?"top":"bot");let k=j*(n?.2:1)+(n?0:w*S);T.style.setProperty("--y",`${b?k:k*-1}px`),T.style.setProperty("--g",`${w}`),T.style.setProperty("--s",`${1-(n?N:0)}`),j+=T.offsetHeight,N+=.025})}},[n,c,r]),v.useEffect(()=>{function g(y){var w;let b=i.current;h(y)&&((w=b.querySelector('[tabIndex="0"]'))==null||w.focus(),a(!1),xe.pause()),y.key==="Escape"&&(document.activeElement===b||b!=null&&b.contains(document.activeElement))&&(a(!0),xe.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[h]),G.createElement("section",{ref:i,className:"Toastify",id:m,onMouseEnter:()=>{r&&(a(!1),xe.pause())},onMouseLeave:x,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((g,y)=>{let w=y.length?{...u}:{...u,pointerEvents:"none"};return G.createElement("div",{tabIndex:-1,className:p(g),"data-stacked":r,style:w,key:`c-${g}`},y.map(({content:b,props:j})=>G.createElement(dI,{...j,stacked:r,collapseAll:x,isIn:l(j.toastId,j.containerId),key:`t-${j.key}`},b)))}))}const Na=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role}:null,status:t.isActive,coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),lx=(e=!0)=>{const[t,r]=v.useState([]),[n,a]=v.useState([]),[i,o]=v.useState(!1),[l,c]=v.useState(null),[d,u]=v.useState(""),[f,m]=v.useState({type:"",status:""}),[h,p]=v.useState({key:null,direction:"asc"}),[x,g]=v.useState([]);return v.useEffect(()=>{if(!e)return;(async()=>{o(!0),c(null);try{const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U)}catch(Q){console.error("Error loading departments:",Q),c("Failed to load departments"),r([])}finally{o(!1)}})()},[e]),v.useEffect(()=>{let Y=t;d&&(Y=Y.filter(Q=>Q.name.toLowerCase().includes(d.toLowerCase())||Q.code.toLowerCase().includes(d.toLowerCase())||Q.description.toLowerCase().includes(d.toLowerCase()))),f.type&&(Y=Y.filter(Q=>Q.type===f.type)),f.status&&(Y=Y.filter(Q=>Q.status===f.status)),a(Y)},[t,d,f]),{departments:n,selectedDepartments:x,loading:i,error:l,searchTerm:d,setSearchTerm:u,filters:f,sortConfig:h,createDepartment:async Y=>{o(!0),c(null);try{const Q=await ct.createDepartment(Y),U=(await ct.getDepartments()).departments||[],ie=Na(U);return r(ie),Q}catch(Q){throw console.error("Error creating department:",Q),c("Failed to create department"),Q}finally{o(!1)}},updateDepartment:async(Y,Q)=>{o(!0),c(null);try{const J=await ct.updateDepartment(Y,Q),ie=(await ct.getDepartments()).departments||[],re=Na(ie);return r(re),J}catch(J){throw console.error("Error updating department:",J),c("Failed to update department"),J}finally{o(!1)}},deleteDepartment:async Y=>{o(!0),c(null);try{await ct.deleteDepartment(Y);const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U)}catch(Q){throw console.error("Error deleting department:",Q),c("Failed to delete department"),Q}finally{o(!1)}},toggleDepartmentStatus:async Y=>{o(!0),c(null);try{await ct.toggleDepartmentStatus(Y);const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U)}catch(Q){throw console.error("Error toggling department status:",Q),xe.error("Failed to toggle department status"),Q}finally{o(!1)}},disableDepartment:async Y=>{o(!0),c(null);try{await ct.disableDepartment(Y);const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U)}catch(Q){throw console.error("Error disabling department:",Q),xe.error("Failed to disable department"),Q}finally{o(!1)}},enableDepartment:async Y=>{o(!0),c(null);try{await ct.enableDepartment(Y);const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U)}catch(Q){throw console.error("Error enabling department:",Q),xe.error("Failed to enable department"),Q}finally{o(!1)}},bulkDeleteDepartments:async Y=>{o(!0),c(null);try{await ct.bulkDeleteDepartments(Y);const J=(await ct.getDepartments()).departments||[],U=Na(J);r(U),g([])}catch(Q){throw console.error("Error bulk deleting departments:",Q),xe.error("Failed to delete departments"),Q}finally{o(!1)}},bulkToggleStatus:async(Y,Q)=>{o(!0),c(null);try{await ct.bulkToggleStatus(Y,Q);const U=(await ct.getDepartments()).departments||[],ie=Na(U);r(ie),g([])}catch(J){throw console.error("Error bulk toggling department status:",J),xe.error("Failed to update department status"),J}finally{o(!1)}},sortDepartments:Y=>{let Q="asc";h.key===Y&&h.direction==="asc"&&(Q="desc"),p({key:Y,direction:Q});const J=[...n].sort((U,ie)=>U[Y]<ie[Y]?Q==="asc"?-1:1:U[Y]>ie[Y]?Q==="asc"?1:-1:0);a(J)},handleSelectDepartment:Y=>{g(Q=>Q.includes(Y)?Q.filter(J=>J!==Y):[...Q,Y])},handleSelectAll:()=>{x.length===n.length?g([]):g(n.map(Y=>Y.id))},handleFilterChange:(Y,Q)=>{m(J=>({...J,[Y]:Q}))},clearFilters:()=>{m({type:"",status:""}),u("")},getAvailableUsers:async()=>{try{return(await ct.getDepartmentHeads())?.users||[]}catch(Y){return console.error("Error fetching department heads:",Y),xe.error("Failed to load department heads"),[]}},refreshDepartments:async()=>{o(!0),c(null);try{const Q=(await ct.getDepartments()).departments||[],J=Na(Q);r(J)}catch(Y){console.error("Error refreshing departments:",Y),c("Failed to refresh departments")}finally{o(!1)}},setError:c}},T1=({collapsed:e,onClose:t})=>{const{hasModuleAccess:r,hasPermission:n}=wo(),{user:a}=mn(),i=Si(),o=mt(),{departments:l,loading:c}=lx(a?.role==="ACADEMIC_DEPARTMENT"),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[h,p]=v.useState(!1),x=v.useRef(null);v.useEffect(()=>{if(x.current&&d){const w=x.current,b=w.scrollHeight>w.clientHeight;p(b)}},[d,l]);const g=[{id:"dashboard",label:"Dashboard",icon:Zm,path:"/admin/dashboard",permission:je.DASHBOARD.VIEW,module:"DASHBOARD"},{id:"users",label:"User Management",icon:Fn,path:"/admin/users",permission:je.USERS.VIEW_ALL,module:"USERS"},{id:"roles",label:"Role Management",icon:nx,path:"/admin/roles",permission:je.ROLES.VIEW_ALL,module:"ROLES"},{id:"departments",label:"Departments",icon:di,path:"/admin/departments",permission:je.DEPARTMENTS.VIEW_ALL,module:"DEPARTMENTS"},{id:"forms",label:"Form Templates",icon:In,path:"/admin/forms",permission:je.TEMPLATES.VIEW_ALL,module:"TEMPLATES"},{id:"system-config",label:"System Configuration",icon:Qj,path:"/admin/system-config",permission:je.GLOBAL_FIELDS.VIEW_ALL,module:"GLOBAL_FIELDS"},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:fa,path:"/trainee/dashboard",permission:je.TRAINEES.VIEW_DETAIL,module:"TRAINEES"},{id:"enrolled-courses",label:"Enrolled Course List",icon:fa,path:"/trainee/enrolled-courses",permission:je.TRAINEES.VIEW_COURSES,module:"TRAINEES"},{id:"all-assessments",label:"All Assessments",icon:fa,path:"/trainee/all-assessments",permission:je.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES",children:[{id:"your-assessments",label:"Your Assessments",path:"/trainee/your-assessments",permission:je.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"signature-required",label:"Signature Required List",path:"/trainee/signature-required",permission:je.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"completion-required",label:"Section Completion Required List",path:"/trainee/completion-required",permission:je.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:fa,path:"/trainee/create-incident-feedback-report",permission:je.TRAINEES.VIEW_ALL,module:"TRAINEES"},{id:"sqa-dashboard",label:"SQA Dashboard",icon:Zm,path:"/sqa/dashboard",permission:je.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"issue-list",label:"Issue List",icon:Et,path:"/sqa/issues",permission:je.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"feedback-list",label:"Feedback List",icon:Hi,path:"/sqa/feedback",permission:je.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"template-list",label:"Template List",icon:Qp,path:"/sqa/templates",permission:je.SQA.VIEW_TEMPLATES,module:"SQA",children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:je.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:je.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:je.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:je.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"}]}],y=v.useMemo(()=>g.filter(w=>a?.role==="ADMINISTRATOR"?["sqa-dashboard","issue-list","feedback-list","template-list"].includes(w.id)?!1:r(w.module)||n(w.permission):a?.role==="ACADEMIC_DEPARTMENT"?w.id==="dashboard":a?.role==="TRAINEE"?["trainee-dashboard","enrolled-courses","all-assessments","create-issue"].includes(w.id):a?.role==="SQA_AUDITOR"?["sqa-dashboard","issue-list","feedback-list","template-list"].includes(w.id):r(w.module)||n(w.permission)).map(w=>a?.role==="ACADEMIC_DEPARTMENT"&&w.id==="dashboard"?{...w,path:"/academic/dashboard",label:"Academic Dashboard"}:w),[a?.role,r,n]);return s.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"sticky",top:0,height:"100vh",overflowY:"hidden",overflowX:"hidden"},children:[s.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&s.jsx(s.Fragment,{children:s.jsx("img",{src:tP,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&s.jsx("div",{children:s.jsx(qj,{size:24})})]}),t&&s.jsx(se,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:t,style:{border:"none",background:"transparent"},children:s.jsx(We,{size:20})})]}),s.jsxs(ft,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[y.map(w=>{const b=w.icon,j=i.pathname===w.path;return w.id==="all-assessments"&&a?.role==="TRAINEE"?s.jsx(ft.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(o("/trainee/all-assessments"),t()):m(!f)},children:[s.jsx(b,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:w.label}),s.jsx(Es,{size:16,className:`ms-auto transition-transform ${f?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&f&&s.jsx("div",{className:"mt-2 ms-4",children:w.children&&w.children.map(N=>s.jsx(uf,{to:N.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:i.pathname===N.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",wordWrap:"break-word",overflowWrap:"break-word"},onClick:t,children:s.jsx("span",{className:"sidebar-nav-label",children:N.label})},N.id))})]})},w.id):s.jsx(ft.Item,{className:"mb-3",children:s.jsxs(uf,{to:w.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${j?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:j?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",wordWrap:e?"normal":"break-word",overflowWrap:"break-word"},onClick:()=>{t()},children:[s.jsx(b,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:w.label})]})},w.id)}),a?.role==="ACADEMIC_DEPARTMENT"&&s.jsx(ft.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[s.jsx(di,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{u(!d),o("/academic/departments")},children:"Department"}),s.jsx(Es,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:d?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{u(!d)}})]})]}),!e&&d&&s.jsx("div",{ref:x,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${h?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:c?s.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:s.jsx("small",{children:"Loading departments..."})}):l.length>0?l.map(w=>s.jsxs(uf,{to:`/academic/course/${w.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${i.pathname===`/academic/course/${w.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:i.pathname===`/academic/course/${w.id}`?"rgba(255, 255, 255, 0.15)":"transparent",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[s.jsx(Xp,{size:12,className:"me-2 sidebar-department-chevron"}),w.code]},w.id)):s.jsx("div",{className:"px-3 py-2 text-white-50",children:s.jsx("small",{children:"No departments found"})})})]})})]})]})},js={getProfile:async()=>{try{return(await Te.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,t)=>{try{const n={...t||await js.getProfile(),avatarUrl:e};return n.address||(n.address=""),n.phoneNumber||(n.phoneNumber=""),n.avatarUrl||(n.avatarUrl=""),n.firstName||(n.firstName=""),n.lastName||(n.lastName=""),n.middleName||(n.middleName=""),Object.keys(n).forEach(i=>{(n[i]===void 0||n[i]===null)&&delete n[i]}),(await Te.put("/profile",n)).data}catch(r){throw console.error("Error updating avatar:",r),r}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const t=await Te.put("/profile",e);return console.log("updateProfile - response:",t.data),t.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Te.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}}},pI=()=>{const[e,t]=v.useState(null),[r,n]=v.useState(!0),[a,i]=v.useState(null),o=async()=>{try{n(!0),i(null);const u=await js.getProfile();t(u)}catch(u){console.error("Error fetching profile:",u),i(u.message||"Failed to fetch profile")}finally{n(!1)}},l=async u=>{try{n(!0),i(null);const f=await js.updateProfile(u);return t(f),f}catch(f){throw console.error("Error updating profile:",f),i(f.message||"Failed to update profile"),f}finally{n(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:u,lastName:f,middleName:m}=e,h=[];return u&&h.push(u),m&&h.push(m),f&&h.push(f),h.join(" ")||"User"},d=()=>e?.role?e.role.name:"User";return v.useEffect(()=>{o()},[]),{profile:e,loading:r,error:a,fetchProfile:o,updateProfile:l,getDisplayName:c,getRoleName:d}},xI={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},gI=({onToggleSidebar:e})=>{const t=Si(),r=mt(),[n,a]=v.useState(!1),[i,o]=v.useState(!1),l=v.useRef(null),{user:c,isLoading:d}=mn(),{profile:u,getDisplayName:f,loading:m}=pI(),h=()=>{if(!c||m)return"Loading...";if(u&&f&&f()&&f()!=="Loading..."){const j=f();if(j&&j.trim()!=="")return j}if(u&&u.firstName){const j=[u.firstName];u.middleName&&j.push(u.middleName),u.lastName&&j.push(u.lastName);const N=j.join(" ").trim();if(N)return N}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const j=localStorage.getItem("authToken");if(j){const N=JSON.parse(atob(j.split(".")[1]));if(N.fullName&&N.fullName!=="User")return N.fullName;if(N.name&&N.name!=="User")return N.name;if(N.firstName&&N.lastName)return`${N.firstName} ${N.lastName}`}}catch(j){console.error("Error parsing JWT token for display name:",j)}return c.name||"User"},p=()=>c&&c.email||"No email",x=j=>{const N={"/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/profile":"Profile","/admin/forms":"Form Templates","/admin/system-config":"System Configuration","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/profile":"Profile","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Create Incident/Feedback Report","/trainee/assessment-pending/signature-required":"Signature Required List","/trainee/assessment-pending/section-completion":"Section Completion Required List"};return j.startsWith("/admin/departments/")&&j!=="/admin/departments"?"Edit Department Detail":j.startsWith("/academic/departments/")&&j!=="/academic/departments"?"Department Management":j.includes("/enroll-trainees")?"Trainee Enrollments":j.startsWith("/academic/course/")&&!j.includes("/subject/")?"Department Details":j.startsWith("/academic/course-detail/")?"Course Details":j.includes("/subject/")?"Subject Details":j.includes("/enroll-trainees")?"Enroll Trainees":j.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Course Details":j.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Subject Details":j.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":j.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":j.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":j.startsWith("/trainee/")&&j!=="/trainee"&&!j.startsWith("/trainee/dashboard")&&!j.startsWith("/trainee/academic-details")&&!j.startsWith("/trainee/enrolled-courses")&&!j.startsWith("/trainee/assessment-pending")&&!j.startsWith("/trainee/create-incident-feedback-report")&&!j.startsWith("/trainee/signature-required")&&!j.startsWith("/trainee/completion-required")&&!j.startsWith("/trainee/your-assessments")?"Trainee Details":N[j]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const j=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=j()},y=()=>{a(!n)},w=()=>{a(!1)},b=()=>{r("/admin/profile"),a(!1)};return v.useEffect(()=>{const j=N=>{l.current&&!l.current.contains(N.target)&&o(!1)};return i&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[i]),s.jsxs(s.Fragment,{children:[s.jsx(t1,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:s.jsxs("div",{className:"container-fluid",children:[s.jsx(se,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:s.jsx(ex,{size:20})}),s.jsx(t1.Brand,{className:"text-primary-custom fw-bold custom-title",children:x(t.pathname)}),s.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:s.jsxs("div",{ref:l,style:{position:"relative"},children:[s.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>o(!i),children:[s.jsx($i,{size:32,className:"me-2"}),s.jsx("span",{children:d||m?"Loading...":h()})]}),s.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:xI,children:[s.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:d||m?"Loading...":h()}),s.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:d?"Loading...":p()})]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),b()},children:[s.jsx($i,{className:"me-2",size:16}),"Profile"]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),g()},children:[s.jsx(bm,{className:"me-2",size:16}),"Logout"]})]})]})}),s.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:y,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:s.jsx($i,{size:32})})]})}),n&&s.jsx("div",{className:`profile-menu-overlay ${n?"show":""}`,onClick:w}),s.jsxs("div",{className:`profile-menu-slide ${n?"show":""}`,children:[s.jsxs("div",{className:"profile-menu-header",children:[s.jsx("button",{className:"profile-menu-close",onClick:w,"aria-label":"Close profile menu",children:s.jsx(We,{size:20})}),s.jsx("div",{className:"profile-avatar",children:s.jsx($i,{size:40})}),s.jsx("div",{className:"profile-name",children:d||m?"Loading...":h()}),s.jsx("div",{className:"profile-email",children:d?"Loading...":p()})]}),s.jsxs("ul",{className:"profile-menu-items",children:[s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link",onClick:j=>{j.preventDefault(),b()},children:[s.jsx($i,{className:"icon"}),"Profile"]})}),s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:j=>{j.preventDefault(),w(),g()},children:[s.jsx(bm,{className:"icon"}),"Logout"]})})]})]})]})},vI=({children:e})=>{const[t,r]=v.useState(!1),[n,a]=v.useState(!1),[i,o]=v.useState(!1);v.useEffect(()=>{const d=()=>{a(window.innerWidth<=768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const l=()=>{n?o(!i):r(!t)},c=()=>{n&&o(!1)};return s.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[s.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:s.jsx(T1,{collapsed:t})}),n&&i&&s.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),s.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,children:s.jsx(T1,{collapsed:!1,onClose:c})}),s.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${n?"main-content-mobile":""}`,children:[s.jsx(gI,{onToggleSidebar:l}),s.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},kc=()=>s.jsx(vI,{children:s.jsx(i4,{})}),yI=({children:e})=>s.jsx(PD,{children:e}),ps=()=>{const e=o4(),t=mt(),n=(o=>o?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:o?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:o?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),a=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return s.jsx(Le,{fluid:!0,className:"py-5",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:s.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"display-1 text-muted",children:""}),s.jsx("h2",{className:"text-primary-custom mb-3",children:n.title}),s.jsx("p",{className:"text-muted mb-4",children:n.message}),s.jsx("p",{className:"small text-muted",children:n.suggestion})]}),s.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[s.jsx(se,{variant:"primary",onClick:a,className:"px-4",children:"Go to Dashboard"}),s.jsx(se,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},Qr=({rows:e=5,columns:t=4})=>{const r=()=>s.jsx("tr",{children:Array.from({length:t}).map((n,a)=>s.jsx("td",{children:s.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:s.jsx("span",{className:"placeholder col-12"})})},a))});return s.jsxs(te,{className:"border-neutral-200",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})}),s.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"bg-neutral-50",children:s.jsx("tr",{children:Array.from({length:t}).map((n,a)=>s.jsx("th",{className:"border-neutral-200",children:s.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})},a))})}),s.jsx("tbody",{children:Array.from({length:e}).map((n,a)=>s.jsx(r,{},a))})]})})})]})},bI=({module:e,children:t,fallback:r=null,showMessage:n=!1,message:a="You do not have access to this module."})=>{const{hasModuleAccess:i}=wo();return i(e)?t:r||(n?s.jsxs(Ye,{variant:"warning",className:"mt-3",children:[s.jsx(Ye.Heading,{children:"Module Access Denied"}),s.jsx("p",{children:a})]}):null)},ht=({permission:e,permissions:t=[],requireAll:r=!1,children:n,redirectTo:a=null})=>{const{hasPermission:i,hasAnyPermission:o,hasAllPermissions:l}=wo(),{user:c}=mn();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?l(t):o(t):!1)?n:s.jsxs("div",{className:"p-4 text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to access this page."}),s.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),s.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},Bt=({permission:e,permissions:t=[],requireAll:r=!1,children:n,fallback:a=null,showMessage:i=!1,message:o="You do not have permission to access this feature."})=>{const{hasPermission:l,hasAnyPermission:c,hasAllPermissions:d}=wo();return(!e&&(!t||t.length===0)?!0:e?l(e):t&&t.length>0?r?d(t):c(t):!1)?n:a||(i?s.jsxs(Ye,{variant:"warning",className:"mt-3",children:[s.jsx(Ye.Heading,{children:"Access Denied"}),s.jsx("p",{children:o})]}):null)},Lr=({trigger:e,items:t=[],align:r="end",className:n="",onItemClick:a,placement:i="bottom-end",disabled:o=!1,...l})=>{const[c,d]=v.useState(!1),[u,f]=v.useState({top:0,left:0}),m=v.useRef(null),h=v.useRef(null),p=()=>{if(!m.current)return;const b=m.current.getBoundingClientRect(),j=200,N=150,E=4;let S,T;switch(i){case"bottom-start":S=b.bottom+E,T=b.left;break;case"bottom-end":S=b.bottom+E,T=b.right-j;break;case"top-start":S=b.top-N-E,T=b.left;break;case"top-end":S=b.top-N-E,T=b.right-j;break;default:S=b.bottom+E,T=b.right-j}S+N>window.innerHeight&&(S=b.top-N-E),S<0&&(S=E),T+j>window.innerWidth&&(T=window.innerWidth-j-E),T<0&&(T=E),f({top:S,left:T})},x=b=>{b.preventDefault(),b.stopPropagation(),!o&&(c||p(),d(!c))},g=()=>{d(!1)},y=b=>{b.onClick&&b.onClick(),a&&a(b),g()};v.useEffect(()=>{const b=N=>{c&&m.current&&!m.current.contains(N.target)&&h.current&&!h.current.contains(N.target)&&g()},j=N=>{N.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",b),document.addEventListener("keydown",j),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",b),document.removeEventListener("keydown",j),document.body.style.overflow=""}},[c]),v.useEffect(()=>{if(c){const b=()=>p(),j=()=>p();return window.addEventListener("scroll",b,!0),window.addEventListener("resize",j),()=>{window.removeEventListener("scroll",b,!0),window.removeEventListener("resize",j)}}},[c,i]);const w=c&&Kp.createPortal(s.jsx("div",{ref:h,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:u.top,left:u.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((b,j)=>b.type==="header"?s.jsx("div",{className:`dropdown-header ${b.className||""}`,children:b.content},j):b.type==="divider"?s.jsx("div",{className:"dropdown-divider"},j):s.jsxs("button",{onClick:()=>y(b),className:`dropdown-item ${b.className||""}`,disabled:b.disabled,children:[b.icon&&s.jsx("span",{className:"me-2",children:b.icon}),b.label]},j))}),document.body);return s.jsxs("div",{className:`dropdown ${n}`,children:[s.jsx("button",{ref:m,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:x,disabled:o,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),w]})},Cc=({children:e})=>{const{isAuthenticated:t,isLoading:r}=mn(),n=Si();return r?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:s.jsx(l4,{to:"/",state:{from:n},replace:!0})},Za=({placeholder:e="Search...",value:t,onChange:r,className:n="",size:a="md"})=>s.jsxs(r1,{className:n,size:a,children:[s.jsx(r1.Text,{className:"bg-white border-end-0",children:s.jsx(rx,{className:"text-primary-custom"})}),s.jsx(F.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),Fr=({direction:e,size:t=16})=>{const r={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?s.jsx("span",{style:{...r,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?s.jsx("span",{style:{...r,color:"var(--bs-primary)",textShadow:"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):s.jsxs("span",{style:r,className:"text-muted sort-icon",children:[s.jsx("span",{style:{display:"inline-block",transform:"translateY(-1px)",opacity:.5,marginRight:"1px"},children:""}),s.jsx("span",{style:{display:"inline-block",transform:"translateY(1px)",opacity:.5},children:""})]})},gf=()=>{const{user:e}=mn(),t=mt();return v.useEffect(()=>{if(e?.role){let r="/admin/dashboard";switch(e.role){case"ACADEMIC_DEPARTMENT":r="/academic/dashboard";break;case"TRAINEE":r="/trainee";break;case"SQA_AUDITOR":r="/sqa/dashboard";break;case"ADMIN":case"ADMINISTRATOR":default:r="/admin/dashboard";break}t(r,{replace:!0})}},[e,t]),null},wI=({show:e,onHide:t})=>{const[r,n]=v.useState(""),[a,i]=v.useState(!1),[o,l]=v.useState(""),c=async u=>{u.preventDefault(),l(""),i(!0);try{const f=await fetch(`${fd.BASE_URL}${fd.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${ox()}reset-password/`})});if(!f.ok){f.status===405?l("Forgot password feature is not available on this server. Please contact support."):f.status===404?l("Forgot password endpoint not found. Please contact support."):l(`Server error (${f.status}). Please try again later.`);return}try{await f.json()}catch(m){console.error("JSON parsing error:",m),l("Server returned invalid response. Please try again later.");return}xe.success("Password reset link has been sent to your email!"),n(""),t()}catch(f){console.error("Forgot password error:",f),f.name==="TypeError"&&f.message.includes("fetch")?l("Cannot connect to server. Please check your internet connection."):l("An unexpected error occurred. Please try again later.")}finally{i(!1)}},d=()=>{n(""),l(""),t()};return s.jsxs(ce,{show:e,onHide:d,centered:!0,children:[s.jsxs(ce.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(Zp,{className:"me-2",size:20}),"Forgot Password"]}),s.jsx(se,{variant:"link",onClick:d,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:s.jsx(We,{})})]}),s.jsxs(ce.Body,{className:"pt-0",children:[s.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),o&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:o}),s.jsxs(F,{onSubmit:c,children:[s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),s.jsx(F.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:u=>n(u.target.value),required:!0,disabled:a,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:a||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.transform="translateY(-2px)",u.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:u=>{u.target.style.transform="translateY(0)",u.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),s.jsx(se,{type:"button",variant:"outline-secondary",onClick:d,disabled:a,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.background="var(--bs-neutral-100)",u.target.style.borderColor="var(--bs-primary)",u.target.style.transform="translateY(-1px)"},onMouseLeave:u=>{u.target.style.background="rgba(255, 255, 255, 0.8)",u.target.style.borderColor="var(--bs-neutral-300)",u.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function vf(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[a,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),u=mt(),f=Si(),{login:m,isAuthenticated:h,isLoading:p}=mn();if(v.useEffect(()=>{if(h){const g=f.state?.from?.pathname||"/admin";u(g,{replace:!0})}},[h,u,f.state?.from?.pathname]),p)return s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(h)return null;const x=async g=>{g.preventDefault(),l(!0);try{const y=await m({email:e,password:r});if(y.success){const w=f.state?.from?.pathname||"/admin";u(w,{replace:!0})}else xe.error(y.error||"Email or password is incorrect. Please try again.")}catch{xe.error("Login failed. Please try again.")}finally{l(!1)}};return s.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[s.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),s.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),s.jsx(Le,{fluid:!0,className:"position-relative",style:{zIndex:1},children:s.jsxs(ge,{className:"min-vh-100",children:[s.jsx(ee,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:s.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-4",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),s.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),s.jsx(ee,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:s.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),s.jsxs("div",{style:{position:"relative",zIndex:2},children:[s.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),s.jsx("div",{className:"dashed-line ms-3"})]}),s.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),s.jsxs(F,{onSubmit:x,children:[s.jsxs(F.Group,{className:"mb-3",controlId:"email",children:[s.jsx(F.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),s.jsx(F.Control,{type:"email",value:e,onChange:g=>t(g.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),s.jsxs(F.Group,{className:"mb-4",controlId:"password",children:[s.jsx(F.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(F.Control,{type:a?"text":"password",value:r,onChange:g=>n(g.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),s.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(g=>!g),onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&i(y=>!y)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:a?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),s.jsx(se,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(Lt,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),s.jsx("div",{className:"text-center mb-2",children:s.jsx("button",{type:"button",onClick:()=>d(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),s.jsx("div",{className:"text-center mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),s.jsxs("div",{className:"text-center",children:[s.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),s.jsx("div",{className:"text-white-50 small",children:s.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),s.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),s.jsx(wI,{show:c,onHide:()=>d(!1)})]})}const jI=()=>{const[e]=c4(),t=mt(),[r,n]=v.useState({newPassword:"",confirmPassword:""}),[a,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,f]=v.useState(""),[m,h]=v.useState("");v.useEffect(()=>{const g=e.get("token");g&&h(g)},[e]);const p=g=>{const{name:y,value:w}=g.target;n(b=>({...b,[y]:w})),u&&f("")},x=async g=>{if(g.preventDefault(),f(""),!r.newPassword||!r.confirmPassword){f("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){f("Passwords do not match.");return}d(!0);try{const y=await fetch(`${fd.BASE_URL}${fd.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!y.ok){y.status===405?f("Reset password feature is not available on this server. Please contact support."):y.status===404?f("Reset password endpoint not found. Please contact support."):y.status===400?f("Invalid token or password. Please request a new reset link."):f(`Server error (${y.status}). Please try again later.`);return}try{await y.json()}catch(w){console.error("JSON parsing error:",w),f("Server returned invalid response. Please try again later.");return}xe.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(y){console.error("Reset password error:",y),y.name==="TypeError"&&y.message.includes("fetch")?f("Cannot connect to server. Please check your internet connection."):f("An unexpected error occurred. Please try again later.")}finally{d(!1)}};return s.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:s.jsx(Le,{children:s.jsx(ge,{className:"justify-content-center",children:s.jsx(ee,{md:6,lg:5,xl:4,children:s.jsx(te,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:s.jsxs(te.Body,{className:"p-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:s.jsx(pl,{size:24,className:"text-white"})}),s.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),s.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),u&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:u}),s.jsxs(F,{onSubmit:x,children:[s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(F.Control,{type:a?"text":"password",name:"newPassword",value:r.newPassword,onChange:p,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!a),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:a?s.jsx(hl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(F.Control,{type:o?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:p,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>l(!o),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:o?s.jsx(hl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),s.jsx(se,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};var yf={},bf={},_1;function NI(){return _1||(_1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(bf)),bf}var wf={},A1;function VN(){return A1||(A1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(wf)),wf}var jf={},k1;function cx(){return k1||(k1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(jf)),jf}var Nf={},Ef={},C1;function EI(){return C1||(C1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Ef)),Ef}var O1;function dx(){return O1||(O1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EI(),r=cx();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],o=a.length;if(o===0)return i;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const f=a[l];d?f==="\\"&&l+1<o?(l++,c+=a[l]):f===d?d="":c+=f:u?f==='"'||f==="'"?d=f:f==="]"?(u=!1,i.push(c),c=""):c+=f:f==="["?(u=!0,c&&(i.push(c),c="")):f==="."?c&&(i.push(c),c=""):c+=f,l++}return c&&i.push(c),i}e.toPath=n})(Nf)),Nf}var P1;function ux(){return P1||(P1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NI(),r=VN(),n=cx(),a=dx();function i(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?i(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let f=0;f<c.length;f++){if(u==null||t.isUnsafeProperty(c[f]))return d;u=u[c[f]]}return u===void 0?d:u}e.get=i})(yf)),yf}var Sf,D1;function SI(){return D1||(D1=1,Sf=ux().get),Sf}var TI=SI();const hi=Is(TI);var Tf={exports:{}},ut={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function _I(){if(I1)return ut;I1=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,f=e?Symbol.for("react.suspense"):60113,m=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,y=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function b(N){if(typeof N=="object"&&N!==null){var E=N.$$typeof;switch(E){case t:switch(N=N.type,N){case c:case d:case n:case i:case a:case f:return N;default:switch(N=N&&N.$$typeof,N){case l:case u:case p:case h:case o:return N;default:return E}}case r:return E}}}function j(N){return b(N)===d}return ut.AsyncMode=c,ut.ConcurrentMode=d,ut.ContextConsumer=l,ut.ContextProvider=o,ut.Element=t,ut.ForwardRef=u,ut.Fragment=n,ut.Lazy=p,ut.Memo=h,ut.Portal=r,ut.Profiler=i,ut.StrictMode=a,ut.Suspense=f,ut.isAsyncMode=function(N){return j(N)||b(N)===c},ut.isConcurrentMode=j,ut.isContextConsumer=function(N){return b(N)===l},ut.isContextProvider=function(N){return b(N)===o},ut.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===t},ut.isForwardRef=function(N){return b(N)===u},ut.isFragment=function(N){return b(N)===n},ut.isLazy=function(N){return b(N)===p},ut.isMemo=function(N){return b(N)===h},ut.isPortal=function(N){return b(N)===r},ut.isProfiler=function(N){return b(N)===i},ut.isStrictMode=function(N){return b(N)===a},ut.isSuspense=function(N){return b(N)===f},ut.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===n||N===d||N===i||N===a||N===f||N===m||typeof N=="object"&&N!==null&&(N.$$typeof===p||N.$$typeof===h||N.$$typeof===o||N.$$typeof===l||N.$$typeof===u||N.$$typeof===g||N.$$typeof===y||N.$$typeof===w||N.$$typeof===x)},ut.typeOf=b,ut}var R1;function AI(){return R1||(R1=1,Tf.exports=_I()),Tf.exports}var kI=AI(),Sr=e=>e===0?0:e>0?1:-1,jn=e=>typeof e=="number"&&e!=+e,Xs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,$e=e=>(typeof e=="number"||e instanceof Number)&&!jn(e),Pa=e=>$e(e)||typeof e=="string",CI=0,gl=e=>{var t=++CI;return"".concat(e||"").concat(t)},Xr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!$e(t)&&typeof t!="string")return n;var i;if(Xs(t)){if(r==null)return n;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return jn(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},GN=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Rt(e,t,r){return $e(e)&&$e(t)?e+r*(t-e):t}function qN(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):hi(n,t))===r)}var $t=e=>e===null||typeof e>"u",Zl=e=>$t(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),OI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function fx(e){if(typeof e!="string")return!1;var t=OI;return t.includes(e)}var PI=["viewBox","children"],F1=["points","pathLength"],_f={svg:PI,polygon:F1,polyline:F1},mx=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{fx(a)&&(n[a]=(i=>r[a](r,i)))}),n},DI=(e,t,r)=>n=>(e(t,r,n),null),Jl=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];fx(a)&&typeof i=="function"&&(n||(n={}),n[a]=DI(i,t,r))}),n},II=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function KN(e){if(typeof e!="string")return!1;var t=II;return t.includes(e)}function ya(e){var t=Object.entries(e).filter(r=>{var[n]=r;return KN(n)});return Object.fromEntries(t)}var M1=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",L1=null,Af=null,YN=e=>{if(e===L1&&Array.isArray(Af))return Af;var t=[];return v.Children.forEach(e,r=>{$t(r)||(kI.isFragment(r)?t=t.concat(YN(r.props.children)):t.push(r))}),Af=t,L1=e,t};function hx(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>M1(a)):n=[M1(t)],YN(e).forEach(a=>{var i=hi(a,"type.displayName")||hi(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var XN=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,RI=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&_f?.[n])!==null&&a!==void 0?a:[],o=t.startsWith("data-"),l=typeof e!="function"&&(!!n&&i.includes(t)||KN(t)),c=!!r&&fx(t);return o||l||c},Kt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(v.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var o;RI((o=n)===null||o===void 0?void 0:o[i],i,t,r)&&(a[i]=n[i])}),a},FI=["children","width","height","viewBox","className","style","title","desc"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$h.apply(null,arguments)}function MI(e,t){if(e==null)return{};var r,n,a=LI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function LI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var px=v.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:o,style:l,title:c,desc:d}=e,u=MI(e,FI),f=i||{width:n,height:a,x:0,y:0},m=tt("recharts-surface",o);return v.createElement("svg",$h({},Kt(u,!0,"svg"),{className:m,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),v.createElement("title",null,c),v.createElement("desc",null,d),r)}),BI=["children","className"];function zh(){return zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zh.apply(null,arguments)}function $I(e,t){if(e==null)return{};var r,n,a=zI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mr=v.forwardRef((e,t)=>{var{children:r,className:n}=e,a=$I(e,BI),i=tt("recharts-layer",n);return v.createElement("g",zh({className:i},Kt(a,!0),{ref:t}),r)}),ZN=v.createContext(null),UI=()=>v.useContext(ZN);function jt(e){return function(){return e}}const JN=Math.cos,md=Math.sin,ba=Math.sqrt,hd=Math.PI,yu=2*hd,Uh=Math.PI,Wh=2*Uh,Vs=1e-6,WI=Wh-Vs;function QN(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function HI(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return QN;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class VI{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?QN:HI(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,u=o-t,f=l-r,m=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Vs)if(!(Math.abs(f*c-d*u)>Vs)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-o,p=a-l,x=c*c+d*d,g=h*h+p*p,y=Math.sqrt(x),w=Math.sqrt(m),b=i*Math.tan((Uh-Math.acos((x+m-g)/(2*y*w)))/2),j=b/w,N=b/y;Math.abs(j-1)>Vs&&this._append`L${t+j*u},${r+j*f}`,this._append`A${i},${i},0,0,${+(f*h>u*p)},${this._x1=t+N*c},${this._y1=r+N*d}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^o,m=o?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Vs||Math.abs(this._y1-u)>Vs)&&this._append`L${d},${u}`,n&&(m<0&&(m=m%Wh+Wh),m>WI?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:m>Vs&&this._append`A${n},${n},0,${+(m>=Uh)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function xx(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new VI(t)}function gx(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function eE(e){this._context=e}eE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bu(e){return new eE(e)}function tE(e){return e[0]}function rE(e){return e[1]}function nE(e,t){var r=jt(!0),n=null,a=bu,i=null,o=xx(l);e=typeof e=="function"?e:e===void 0?tE:jt(e),t=typeof t=="function"?t:t===void 0?rE:jt(t);function l(c){var d,u=(c=gx(c)).length,f,m=!1,h;for(n==null&&(i=a(h=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(f,d,c),+t(f,d,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:jt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:jt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:jt(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function Oc(e,t,r){var n=null,a=jt(!0),i=null,o=bu,l=null,c=xx(d);e=typeof e=="function"?e:e===void 0?tE:jt(+e),t=typeof t=="function"?t:jt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?rE:jt(+r);function d(f){var m,h,p,x=(f=gx(f)).length,g,y=!1,w,b=new Array(x),j=new Array(x);for(i==null&&(l=o(w=c())),m=0;m<=x;++m){if(!(m<x&&a(g=f[m],m,f))===y)if(y=!y)h=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=m-1;p>=h;--p)l.point(b[p],j[p]);l.lineEnd(),l.areaEnd()}y&&(b[m]=+e(g,m,f),j[m]=+t(g,m,f),l.point(n?+n(g,m,f):b[m],r?+r(g,m,f):j[m]))}if(w)return l=null,w+""||null}function u(){return nE().defined(a).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:jt(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:jt(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:jt(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:jt(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:jt(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:jt(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:jt(!!f),d):a},d.curve=function(f){return arguments.length?(o=f,i!=null&&(l=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=l=null:l=o(i=f),d):i},d}class aE{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function GI(e){return new aE(e,!0)}function qI(e){return new aE(e,!1)}const vx={draw(e,t){const r=ba(t/hd);e.moveTo(r,0),e.arc(0,0,r,0,yu)}},KI={draw(e,t){const r=ba(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},sE=ba(1/3),YI=sE*2,XI={draw(e,t){const r=ba(t/YI),n=r*sE;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},ZI={draw(e,t){const r=ba(t),n=-r/2;e.rect(n,n,r,r)}},JI=.8908130915292852,iE=md(hd/10)/md(7*hd/10),QI=md(yu/10)*iE,e6=-JN(yu/10)*iE,t6={draw(e,t){const r=ba(t*JI),n=QI*r,a=e6*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=yu*i/5,l=JN(o),c=md(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},kf=ba(3),r6={draw(e,t){const r=-ba(t/(kf*3));e.moveTo(0,r*2),e.lineTo(-kf*r,-r),e.lineTo(kf*r,-r),e.closePath()}},Un=-.5,Wn=ba(3)/2,Hh=1/ba(12),n6=(Hh/2+1)*3,a6={draw(e,t){const r=ba(t/n6),n=r/2,a=r*Hh,i=n,o=r*Hh+r,l=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(Un*n-Wn*a,Wn*n+Un*a),e.lineTo(Un*i-Wn*o,Wn*i+Un*o),e.lineTo(Un*l-Wn*c,Wn*l+Un*c),e.lineTo(Un*n+Wn*a,Un*a-Wn*n),e.lineTo(Un*i+Wn*o,Un*o-Wn*i),e.lineTo(Un*l+Wn*c,Un*c-Wn*l),e.closePath()}};function s6(e,t){let r=null,n=xx(a);e=typeof e=="function"?e:jt(e||vx),t=typeof t=="function"?t:jt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:jt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:jt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function pd(){}function xd(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function oE(e){this._context=e}oE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:xd(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:xd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function i6(e){return new oE(e)}function lE(e){this._context=e}lE.prototype={areaStart:pd,areaEnd:pd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:xd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function o6(e){return new lE(e)}function cE(e){this._context=e}cE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:xd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function l6(e){return new cE(e)}function dE(e){this._context=e}dE.prototype={areaStart:pd,areaEnd:pd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function c6(e){return new dE(e)}function B1(e){return e<0?-1:1}function $1(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(B1(i)+B1(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function z1(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Cf(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function gd(e){this._context=e}gd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Cf(this,this._t0,z1(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Cf(this,z1(this,r=$1(this,e,t)),r);break;default:Cf(this,this._t0,r=$1(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function uE(e){this._context=new fE(e)}(uE.prototype=Object.create(gd.prototype)).point=function(e,t){gd.prototype.point.call(this,t,e)};function fE(e){this._context=e}fE.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function d6(e){return new gd(e)}function u6(e){return new uE(e)}function mE(e){this._context=e}mE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=U1(e),a=U1(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function U1(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function f6(e){return new mE(e)}function wu(e,t){this._context=e,this._t=t}wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function m6(e){return new wu(e,.5)}function h6(e){return new wu(e,0)}function p6(e){return new wu(e,1)}function ao(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Vh(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function x6(e,t){return e[t]}function g6(e){const t=[];return t.key=e,t}function v6(){var e=jt([]),t=Vh,r=ao,n=x6;function a(i){var o=Array.from(e.apply(this,arguments),g6),l,c=o.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(f,o[l].key,d,i)]).data=f;for(l=0,u=gx(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:jt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:jt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Vh:typeof i=="function"?i:jt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??ao,a):r},a}function y6(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}ao(e,t)}}function b6(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}ao(e,t)}}function w6(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[n][1]||0,m=u[n-1][1]||0,h=(f-m)/2,p=0;p<l;++p){var x=e[t[p]],g=x[n][1]||0,y=x[n-1][1]||0;h+=g-y}c+=f,d+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,ao(e,t)}}var j6=["type","size","sizeType"];function Gh(){return Gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gh.apply(null,arguments)}function W1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function H1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W1(Object(r),!0).forEach(function(n){N6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N6(e,t,r){return(t=E6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E6(e){var t=S6(e,"string");return typeof t=="symbol"?t:t+""}function S6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T6(e,t){if(e==null)return{};var r,n,a=_6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hE={symbolCircle:vx,symbolCross:KI,symbolDiamond:XI,symbolSquare:ZI,symbolStar:t6,symbolTriangle:r6,symbolWye:a6},A6=Math.PI/180,k6=e=>{var t="symbol".concat(Zl(e));return hE[t]||vx},C6=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*A6;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},O6=(e,t)=>{hE["symbol".concat(Zl(e))]=t},yx=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=T6(e,j6),i=H1(H1({},a),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var m=k6(o),h=s6().type(m).size(C6(r,n,o));return h()},{className:c,cx:d,cy:u}=i,f=Kt(i,!0);return d===+d&&u===+u&&r===+r?v.createElement("path",Gh({},f,{className:tt("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};yx.registerSymbol=O6;function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qh.apply(null,arguments)}function V1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V1(Object(r),!0).forEach(function(n){bx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bx(e,t,r){return(t=D6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D6(e){var t=I6(e,"string");return typeof t=="symbol"?t:t+""}function I6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hn=32;class wx extends v.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Hn/2,i=Hn/6,o=Hn/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Hn,y2:a,className:"recharts-legend-icon"});if(c==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Hn,"M").concat(2*o,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return v.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Hn/8,"h").concat(Hn,"v").concat(Hn*3/4,"h").concat(-Hn,"z"),className:"recharts-legend-icon"});if(v.isValidElement(t.legendIcon)){var d=P6({},t);return delete d.legendIcon,v.cloneElement(t.legendIcon,d)}return v.createElement(yx,{fill:l,cx:a,cy:a,size:Hn,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:o}=this.props,l={x:0,y:0,width:Hn,height:Hn},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((u,f)=>{var m=u.formatter||a,h=tt({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:u.inactive});if(u.type==="none")return null;var p=u.inactive?i:u.color,x=m?m(u.value,u,f):u.value;return v.createElement("li",qh({className:h,style:c,key:"legend-item-".concat(f)},Jl(this.props,u,f)),v.createElement(px,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(x," legend icon")},this.renderIcon(u,o)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},x))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}bx(wx,"displayName","Legend");bx(wx,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Of={},Pf={},G1;function R6(){return G1||(G1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const o=r[i],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}e.uniqBy=t})(Pf)),Pf}var Df={},q1;function pE(){return q1||(q1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Df)),Df}var If={},Rf={},Ff={},K1;function F6(){return K1||(K1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Ff)),Ff}var Y1;function jx(){return Y1||(Y1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=F6();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Rf)),Rf}var Mf={},X1;function M6(){return X1||(X1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Mf)),Mf}var Z1;function L6(){return Z1||(Z1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jx(),r=M6();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(If)),If}var Lf={},Bf={},J1;function B6(){return J1||(J1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ux();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Bf)),Bf}var $f={},zf={},Uf={},Wf={},Q1;function xE(){return Q1||(Q1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Wf)),Wf}var Hf={},ey;function gE(){return ey||(ey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Hf)),Hf}var Vf={},ty;function vE(){return ty||(ty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Vf)),Vf}var ry;function $6(){return ry||(ry=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Nx(),r=xE(),n=gE(),a=vE();function i(f,m,h){return typeof h!="function"?t.isMatch(f,m):o(f,m,function p(x,g,y,w,b,j){const N=h(x,g,y,w,b,j);return N!==void 0?!!N:o(x,g,p,j)},new Map)}function o(f,m,h,p){if(m===f)return!0;switch(typeof m){case"object":return l(f,m,h,p);case"function":return Object.keys(m).length>0?o(f,{...m},h,p):a.eq(f,m);default:return r.isObject(f)?typeof m=="string"?m==="":!0:a.eq(f,m)}}function l(f,m,h,p){if(m==null)return!0;if(Array.isArray(m))return d(f,m,h,p);if(m instanceof Map)return c(f,m,h,p);if(m instanceof Set)return u(f,m,h,p);const x=Object.keys(m);if(f==null)return x.length===0;if(x.length===0)return!0;if(p&&p.has(m))return p.get(m)===f;p&&p.set(m,f);try{for(let g=0;g<x.length;g++){const y=x[g];if(!n.isPrimitive(f)&&!(y in f)||m[y]===void 0&&f[y]!==void 0||m[y]===null&&f[y]!==null||!h(f[y],m[y],y,f,m,p))return!1}return!0}finally{p&&p.delete(m)}}function c(f,m,h,p){if(m.size===0)return!0;if(!(f instanceof Map))return!1;for(const[x,g]of m.entries()){const y=f.get(x);if(h(y,g,x,f,m,p)===!1)return!1}return!0}function d(f,m,h,p){if(m.length===0)return!0;if(!Array.isArray(f))return!1;const x=new Set;for(let g=0;g<m.length;g++){const y=m[g];let w=!1;for(let b=0;b<f.length;b++){if(x.has(b))continue;const j=f[b];let N=!1;if(h(j,y,g,f,m,p)&&(N=!0),N){x.add(b),w=!0;break}}if(!w)return!1}return!0}function u(f,m,h,p){return m.size===0?!0:f instanceof Set?d([...f],[...m],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(Uf)),Uf}var ny;function Nx(){return ny||(ny=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$6();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(zf)),zf}var Gf={},qf={},Kf={},ay;function z6(){return ay||(ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Kf)),Kf}var Yf={},sy;function yE(){return sy||(sy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Yf)),Yf}var Xf={},iy;function bE(){return iy||(iy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",f="[object Function]",m="[object ArrayBuffer]",h="[object Object]",p="[object Error]",x="[object DataView]",g="[object Uint8Array]",y="[object Uint8ClampedArray]",w="[object Uint16Array]",b="[object Uint32Array]",j="[object BigUint64Array]",N="[object Int8Array]",E="[object Int16Array]",S="[object Int32Array]",T="[object BigInt64Array]",k="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=m,e.arrayTag=u,e.bigInt64ArrayTag=T,e.bigUint64ArrayTag=j,e.booleanTag=a,e.dataViewTag=x,e.dateTag=l,e.errorTag=p,e.float32ArrayTag=k,e.float64ArrayTag=I,e.functionTag=f,e.int16ArrayTag=E,e.int32ArrayTag=S,e.int8ArrayTag=N,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=w,e.uint32ArrayTag=b,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=y})(Xf)),Xf}var Zf={},oy;function U6(){return oy||(oy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Zf)),Zf}var ly;function wE(){return ly||(ly=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z6(),r=yE(),n=bE(),a=gE(),i=U6();function o(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,m,h=new Map,p=void 0){const x=p?.(u,f,m,h);if(x!==void 0)return x;if(a.isPrimitive(u))return u;if(h.has(u))return h.get(u);if(Array.isArray(u)){const g=new Array(u.length);h.set(u,g);for(let y=0;y<u.length;y++)g[y]=l(u[y],y,m,h,p);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;h.set(u,g);for(const[y,w]of u)g.set(y,l(w,y,m,h,p));return g}if(u instanceof Set){const g=new Set;h.set(u,g);for(const y of u)g.add(l(y,void 0,m,h,p));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);h.set(u,g);for(let y=0;y<u.length;y++)g[y]=l(u[y],y,m,h,p);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return h.set(u,g),c(g,u,m,h,p),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return h.set(u,g),c(g,u,m,h,p),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return h.set(u,g),c(g,u,m,h,p),g}if(u instanceof Error){const g=new u.constructor;return h.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,m,h,p),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return h.set(u,g),c(g,u,m,h,p),g}if(u instanceof Number){const g=new Number(u.valueOf());return h.set(u,g),c(g,u,m,h,p),g}if(u instanceof String){const g=new String(u.valueOf());return h.set(u,g),c(g,u,m,h,p),g}if(typeof u=="object"&&d(u)){const g=Object.create(Object.getPrototypeOf(u));return h.set(u,g),c(g,u,m,h,p),g}return u}function c(u,f,m=u,h,p){const x=[...Object.keys(f),...t.getSymbols(f)];for(let g=0;g<x.length;g++){const y=x[g],w=Object.getOwnPropertyDescriptor(u,y);(w==null||w.writable)&&(u[y]=l(f[y],y,m,h,p))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(qf)),qf}var cy;function W6(){return cy||(cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wE();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Gf)),Gf}var dy;function H6(){return dy||(dy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Nx(),r=W6();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})($f)),$f}var Jf={},Qf={},e0={},uy;function V6(){return uy||(uy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wE(),r=bE();function n(a,i){return t.cloneDeepWith(a,(o,l,c,d)=>{const u=i?.(o,l,c,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a?.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(e0)),e0}var fy;function G6(){return fy||(fy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V6();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Qf)),Qf}var t0={},r0={},my;function jE(){return my||(my=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(r0)),r0}var n0={},hy;function q6(){return hy||(hy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yE();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(n0)),n0}var py;function K6(){return py||(py=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VN(),r=jE(),n=q6(),a=dx();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const f=c[u];if((d==null||!Object.hasOwn(d,f))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(f)&&f<d.length))return!1;d=d[f]}return!0}e.has=i})(t0)),t0}var xy;function Y6(){return xy||(xy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Nx(),r=cx(),n=G6(),a=ux(),i=K6();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?i.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(Jf)),Jf}var gy;function X6(){return gy||(gy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pE(),r=B6(),n=H6(),a=Y6();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i})(Lf)),Lf}var vy;function Z6(){return vy||(vy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R6(),r=pE(),n=L6(),a=X6();function i(o,l=r.identity){return n.isArrayLikeObject(o)?t.uniqBy(Array.from(o),a.iteratee(l)):[]}e.uniqBy=i})(Of)),Of}var a0,yy;function J6(){return yy||(yy=1,a0=Z6().uniqBy),a0}var Q6=J6();const by=Is(Q6);function NE(e,t,r){return t===!0?by(e,r):typeof t=="function"?by(e,t):e}var s0={exports:{}},i0={},o0={exports:{}},l0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function e8(){if(wy)return l0;wy=1;var e=Yp();function t(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(f,m){var h=m(),p=n({inst:{value:h,getSnapshot:m}}),x=p[0].inst,g=p[1];return i(function(){x.value=h,x.getSnapshot=m,c(x)&&g({inst:x})},[f,h,m]),a(function(){return c(x)&&g({inst:x}),f(function(){c(x)&&g({inst:x})})},[f]),o(h),h}function c(f){var m=f.getSnapshot;f=f.value;try{var h=m();return!r(f,h)}catch{return!0}}function d(f,m){return m()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return l0.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,l0}var jy;function t8(){return jy||(jy=1,o0.exports=e8()),o0.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ny;function r8(){if(Ny)return i0;Ny=1;var e=Yp(),t=t8();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return i0.useSyncExternalStoreWithSelector=function(d,u,f,m,h){var p=i(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=l(function(){function y(E){if(!w){if(w=!0,b=E,E=m(E),h!==void 0&&x.hasValue){var S=x.value;if(h(S,E))return j=S}return j=E}if(S=j,n(b,E))return S;var T=m(E);return h!==void 0&&h(S,T)?(b=E,S):(b=E,j=T)}var w=!1,b,j,N=f===void 0?null:f;return[function(){return y(u())},N===null?void 0:function(){return y(N())}]},[u,f,m,h]);var g=a(d,p[0],p[1]);return o(function(){x.hasValue=!0,x.value=g},[g]),c(g),g},i0}var Ey;function n8(){return Ey||(Ey=1,s0.exports=r8()),s0.exports}var a8=n8(),Ex=v.createContext(null),s8=e=>e,Ut=()=>{var e=v.useContext(Ex);return e?e.store.dispatch:s8},od=()=>{},i8=()=>od,o8=(e,t)=>e===t;function ze(e){var t=v.useContext(Ex);return a8.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:i8,t?t.store.getState:od,t?t.store.getState:od,t?e:od,o8)}function l8(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function c8(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function d8(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var Sy=e=>Array.isArray(e)?e:[e];function u8(e){const t=Array.isArray(e[0])?e[0]:e;return d8(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function f8(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var m8=class{constructor(e){this.value=e}deref(){return this.value}},h8=typeof WeakRef<"u"?WeakRef:m8,p8=0,Ty=1;function Pc(){return{s:p8,v:void 0,o:null,p:null}}function EE(e,t={}){let r=Pc();const{resultEqualityCheck:n}=t;let a,i=0;function o(){let l=r;const{length:c}=arguments;for(let f=0,m=c;f<m;f++){const h=arguments[f];if(typeof h=="function"||typeof h=="object"&&h!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(h);x===void 0?(l=Pc(),p.set(h,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(h);x===void 0?(l=Pc(),p.set(h,l)):l=x}}const d=l;let u;if(l.s===Ty)u=l.v;else if(u=e.apply(null,arguments),i++,n){const f=a?.deref?.()??a;f!=null&&n(f,u)&&(u=f,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new h8(u):u}return d.s=Ty,d.v=u,u}return o.clearCache=()=>{r=Pc(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function x8(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,o=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),l8(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:f,memoizeOptions:m=[],argsMemoize:h=EE,argsMemoizeOptions:p=[]}=u,x=Sy(m),g=Sy(p),y=u8(a),w=f(function(){return i++,d.apply(null,arguments)},...x),b=h(function(){o++;const N=f8(y,arguments);return l=w.apply(null,N),l},...g);return Object.assign(b,{resultFunc:d,memoizedResultFunc:w,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var fe=x8(EE),g8=Object.assign((e,t=fe)=>{c8(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>g8}),c0={},d0={},u0={},_y;function v8(){return _y||(_y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const o=t(n),l=t(a);if(o===l&&o===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=r})(u0)),u0}var f0={},m0={},Ay;function SE(){return Ay||(Ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(m0)),m0}var ky;function y8(){return ky||(ky=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SE(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=a})(f0)),f0}var Cy;function b8(){return Cy||(Cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=v8(),r=y8(),n=dx();function a(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const d=(h,p)=>{let x=h;for(let g=0;g<p.length&&x!=null;++g)x=x[p[g]];return x},u=(h,p)=>p==null||h==null?p:typeof h=="object"&&"key"in h?Object.hasOwn(p,h.key)?p[h.key]:d(p,h.path):typeof h=="function"?h(p):Array.isArray(h)?d(p,h):typeof p=="object"?p[h]:p,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return i.map(h=>({original:h,criteria:f.map(p=>u(p,h))})).slice().sort((h,p)=>{for(let x=0;x<f.length;x++){const g=t.compareValues(h.criteria[x],p.criteria[x],l[x]);if(g!==0)return g}return 0}).map(h=>h.original)}e.orderBy=a})(d0)),d0}var h0={},Oy;function w8(){return Oy||(Oy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<i?o(u,c+1):a.push(u)}};return o(r,0),a}e.flatten=t})(h0)),h0}var p0={},Py;function TE(){return Py||(Py=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jE(),r=jx(),n=xE(),a=vE();function i(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}e.isIterateeCall=i})(p0)),p0}var Dy;function j8(){return Dy||(Dy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=b8(),r=w8(),n=TE();function a(i,...o){const l=o.length;return l>1&&n.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=a})(c0)),c0}var x0,Iy;function N8(){return Iy||(Iy=1,x0=j8().sortBy),x0}var E8=N8();const ju=Is(E8);var _E=e=>e.legend.settings,S8=e=>e.legend.size,T8=e=>e.legend.payload,_8=fe([T8,_E],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?ju(n,r):n});function A8(){return ze(_8)}var Dc=1;function AE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>Dc||Math.abs(o.left-t.left)>Dc||Math.abs(o.top-t.top)>Dc||Math.abs(o.width-t.width)>Dc)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Or(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var k8=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ry=k8,g0=()=>Math.random().toString(36).substring(7).split("").join("."),C8={INIT:`@@redux/INIT${g0()}`,REPLACE:`@@redux/REPLACE${g0()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${g0()}`},vd=C8;function Sx(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function kE(e,t,r){if(typeof e!="function")throw new Error(Or(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Or(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Or(1));return r(kE)(e,t)}let n=e,a=t,i=new Map,o=i,l=0,c=!1;function d(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(c)throw new Error(Or(3));return a}function f(g){if(typeof g!="function")throw new Error(Or(4));if(c)throw new Error(Or(5));let y=!0;d();const w=l++;return o.set(w,g),function(){if(y){if(c)throw new Error(Or(6));y=!1,d(),o.delete(w),i=null}}}function m(g){if(!Sx(g))throw new Error(Or(7));if(typeof g.type>"u")throw new Error(Or(8));if(typeof g.type!="string")throw new Error(Or(17));if(c)throw new Error(Or(9));try{c=!0,a=n(a,g)}finally{c=!1}return(i=o).forEach(w=>{w()}),g}function h(g){if(typeof g!="function")throw new Error(Or(10));n=g,m({type:vd.REPLACE})}function p(){const g=f;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Or(11));function w(){const j=y;j.next&&j.next(u())}return w(),{unsubscribe:g(w)}},[Ry](){return this}}}return m({type:vd.INIT}),{dispatch:m,subscribe:f,getState:u,replaceReducer:h,[Ry]:p}}function O8(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:vd.INIT})>"u")throw new Error(Or(12));if(typeof r(void 0,{type:vd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Or(13))})}function CE(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{O8(r)}catch(i){a=i}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<n.length;u++){const f=n[u],m=r[f],h=o[f],p=m(h,l);if(typeof p>"u")throw l&&l.type,new Error(Or(14));d[f]=p,c=c||p!==h}return c=c||n.length!==Object.keys(o).length,c?d:o}}function yd(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function P8(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Or(15))};const o={getState:a.getState,dispatch:(c,...d)=>i(c,...d)},l=e.map(c=>c(o));return i=yd(...l)(a.dispatch),{...a,dispatch:i}}}function OE(e){return Sx(e)&&"type"in e&&typeof e.type=="string"}var PE=Symbol.for("immer-nothing"),Fy=Symbol.for("immer-draftable"),Ln=Symbol.for("immer-state");function da(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var so=Object.getPrototypeOf;function pi(e){return!!e&&!!e[Ln]}function Ja(e){return e?DE(e)||Array.isArray(e)||!!e[Fy]||!!e.constructor?.[Fy]||Ql(e)||Eu(e):!1}var D8=Object.prototype.constructor.toString();function DE(e){if(!e||typeof e!="object")return!1;const t=so(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===D8}function bd(e,t){Nu(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Nu(e){const t=e[Ln];return t?t.type_:Array.isArray(e)?1:Ql(e)?2:Eu(e)?3:0}function Kh(e,t){return Nu(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function IE(e,t,r){const n=Nu(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function I8(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Ql(e){return e instanceof Map}function Eu(e){return e instanceof Set}function Gs(e){return e.copy_||e.base_}function Yh(e,t){if(Ql(e))return new Map(e);if(Eu(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=DE(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ln];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(so(e),n)}else{const n=so(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Tx(e,t=!1){return Su(e)||pi(e)||!Ja(e)||(Nu(e)>1&&Object.defineProperties(e,{set:{value:Ic},add:{value:Ic},clear:{value:Ic},delete:{value:Ic}}),Object.freeze(e),t&&Object.values(e).forEach(r=>Tx(r,!0))),e}function Ic(){da(2)}function Su(e){return Object.isFrozen(e)}var R8={};function xi(e){const t=R8[e];return t||da(0,e),t}var vl;function RE(){return vl}function F8(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function My(e,t){t&&(xi("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Xh(e){Zh(e),e.drafts_.forEach(M8),e.drafts_=null}function Zh(e){e===vl&&(vl=e.parent_)}function Ly(e){return vl=F8(vl,e)}function M8(e){const t=e[Ln];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function By(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ln].modified_&&(Xh(t),da(4)),Ja(e)&&(e=wd(t,e),t.parent_||jd(t,e)),t.patches_&&xi("Patches").generateReplacementPatches_(r[Ln].base_,e,t.patches_,t.inversePatches_)):e=wd(t,r,[]),Xh(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==PE?e:void 0}function wd(e,t,r){if(Su(t))return t;const n=t[Ln];if(!n)return bd(t,(a,i)=>$y(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return jd(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,o=!1;n.type_===3&&(i=new Set(a),a.clear(),o=!0),bd(i,(l,c)=>$y(e,n,a,l,c,r,o)),jd(e,a,!1),r&&e.patches_&&xi("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function $y(e,t,r,n,a,i,o){if(pi(a)){const l=i&&t&&t.type_!==3&&!Kh(t.assigned_,n)?i.concat(n):void 0,c=wd(e,a,l);if(IE(r,n,c),pi(c))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Ja(a)&&!Su(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;wd(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Ql(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&jd(e,a)}}function jd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Tx(t,r)}function L8(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:RE(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=_x;r&&(a=[n],i=yl);const{revoke:o,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=o,l}var _x={get(e,t){if(t===Ln)return e;const r=Gs(e);if(!Kh(r,t))return B8(e,r,t);const n=r[t];return e.finalized_||!Ja(n)?n:n===v0(e.base_,t)?(y0(e),e.copy_[t]=Qh(n,e)):n},has(e,t){return t in Gs(e)},ownKeys(e){return Reflect.ownKeys(Gs(e))},set(e,t,r){const n=FE(Gs(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=v0(Gs(e),t),i=a?.[Ln];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(I8(r,a)&&(r!==void 0||Kh(e.base_,t)))return!0;y0(e),Jh(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return v0(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,y0(e),Jh(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Gs(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){da(11)},getPrototypeOf(e){return so(e.base_)},setPrototypeOf(){da(12)}},yl={};bd(_x,(e,t)=>{yl[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});yl.deleteProperty=function(e,t){return yl.set.call(this,e,t,void 0)};yl.set=function(e,t,r){return _x.set.call(this,e[0],t,r,e[0])};function v0(e,t){const r=e[Ln];return(r?Gs(r):e)[t]}function B8(e,t,r){const n=FE(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function FE(e,t){if(!(t in e))return;let r=so(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=so(r)}}function Jh(e){e.modified_||(e.modified_=!0,e.parent_&&Jh(e.parent_))}function y0(e){e.copy_||(e.copy_=Yh(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var $8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&da(6),n!==void 0&&typeof n!="function"&&da(7);let a;if(Ja(t)){const i=Ly(this),o=Qh(t,void 0);let l=!0;try{a=r(o),l=!1}finally{l?Xh(i):Zh(i)}return My(i,n),By(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===PE&&(a=void 0),this.autoFreeze_&&Tx(a,!0),n){const i=[],o=[];xi("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else da(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,a;return[this.produce(t,r,(o,l)=>{n=o,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ja(e)||da(8),pi(e)&&(e=Wa(e));const t=Ly(this),r=Qh(e,void 0);return r[Ln].isManual_=!0,Zh(t),r}finishDraft(e,t){const r=e&&e[Ln];(!r||!r.isManual_)&&da(9);const{scope_:n}=r;return My(n,t),By(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=xi("Patches").applyPatches_;return pi(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Qh(e,t){const r=Ql(e)?xi("MapSet").proxyMap_(e,t):Eu(e)?xi("MapSet").proxySet_(e,t):L8(e,t);return(t?t.scope_:RE()).drafts_.push(r),r}function Wa(e){return pi(e)||da(10,e),ME(e)}function ME(e){if(!Ja(e)||Su(e))return e;const t=e[Ln];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Yh(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Yh(e,!0);return bd(r,(n,a)=>{IE(r,n,ME(a))}),t&&(t.finalized_=!1),r}var z8=new $8,LE=z8.produce;function BE(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var U8=BE(),W8=BE,H8=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?yd:yd.apply(null,arguments)};function ra(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Rn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>OE(n)&&n.type===e,r}var $E=class Zo extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Zo.prototype)}static get[Symbol.species](){return Zo}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Zo(...t[0].concat(this)):new Zo(...t.concat(this))}};function zy(e){return Ja(e)?LE(e,()=>{}):e}function Rc(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function V8(e){return typeof e=="boolean"}var G8=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let o=new $E;return r&&(V8(r)?o.push(U8):o.push(W8(r.extraArgument))),o},q8="RTK_autoBatch",Uy=e=>t=>{setTimeout(t,e)},K8=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Uy(10):e.type==="callback"?e.queueNotification:Uy(e.timeout),d=()=>{o=!1,i&&(i=!1,l.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const f=()=>a&&u(),m=n.subscribe(f);return l.add(u),()=>{m(),l.delete(u)}},dispatch(u){try{return a=!u?.meta?.[q8],i=!a,i&&(o||(o=!0,c(d))),n.dispatch(u)}finally{a=!0}}})},Y8=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new $E(e);return n&&a.push(K8(typeof n=="object"?n:void 0)),a};function X8(e){const t=G8(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(Sx(r))l=CE(r);else throw new Error(Rn(1));let c;typeof n=="function"?c=n(t):c=t();let d=yd;a&&(d=H8({trace:!1,...typeof a=="object"&&a}));const u=P8(...c),f=Y8(u);let m=typeof o=="function"?o(f):f();const h=d(...m);return kE(l,i,h)}function zE(e){const t={},r=[];let n;const a={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Rn(28));if(l in t)throw new Error(Rn(29));return t[l]=o,a},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),a},addMatcher(i,o){return r.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function Z8(e){return typeof e=="function"}function J8(e,t){let[r,n,a]=zE(t),i;if(Z8(e))i=()=>zy(e());else{const l=zy(e);i=()=>l}function o(l=i(),c){let d=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,f)=>{if(f)if(pi(u)){const h=f(u,c);return h===void 0?u:h}else{if(Ja(u))return LE(u,m=>f(m,c));{const m=f(u,c);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},l)}return o.getInitialState=i,o}var Q8="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",eR=(e=21)=>{let t="",r=e;for(;r--;)t+=Q8[Math.random()*64|0];return t},tR=Symbol.for("rtk-slice-createasyncthunk");function rR(e,t){return`${e}/${t}`}function nR({creators:e}={}){const t=e?.asyncThunk?.[tR];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(Rn(11));const o=(typeof n.reducers=="function"?n.reducers(sR()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(b,j){const N=typeof b=="string"?b:b.type;if(!N)throw new Error(Rn(12));if(N in c.sliceCaseReducersByType)throw new Error(Rn(13));return c.sliceCaseReducersByType[N]=j,d},addMatcher(b,j){return c.sliceMatchers.push({matcher:b,reducer:j}),d},exposeAction(b,j){return c.actionCreators[b]=j,d},exposeCaseReducer(b,j){return c.sliceCaseReducersByName[b]=j,d}};l.forEach(b=>{const j=o[b],N={reducerName:b,type:rR(a,b),createNotation:typeof n.reducers=="function"};oR(j)?cR(N,j,d,t):iR(N,j,d)});function u(){const[b={},j=[],N=void 0]=typeof n.extraReducers=="function"?zE(n.extraReducers):[n.extraReducers],E={...b,...c.sliceCaseReducersByType};return J8(n.initialState,S=>{for(let T in E)S.addCase(T,E[T]);for(let T of c.sliceMatchers)S.addMatcher(T.matcher,T.reducer);for(let T of j)S.addMatcher(T.matcher,T.reducer);N&&S.addDefaultCase(N)})}const f=b=>b,m=new Map,h=new WeakMap;let p;function x(b,j){return p||(p=u()),p(b,j)}function g(){return p||(p=u()),p.getInitialState()}function y(b,j=!1){function N(S){let T=S[b];return typeof T>"u"&&j&&(T=Rc(h,N,g)),T}function E(S=f){const T=Rc(m,j,()=>new WeakMap);return Rc(T,S,()=>{const k={};for(const[I,C]of Object.entries(n.selectors??{}))k[I]=aR(C,S,()=>Rc(h,S,g),j);return k})}return{reducerPath:b,getSelectors:E,get selectors(){return E(N)},selectSlice:N}}const w={name:a,reducer:x,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...y(i),injectInto(b,{reducerPath:j,...N}={}){const E=j??i;return b.inject({reducerPath:E,reducer:x},N),{...w,...y(E,!0)}}};return w}}function aR(e,t,r,n){function a(i,...o){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return a.unwrapped=e,a}var $n=nR();function sR(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function iR({type:e,reducerName:t,createNotation:r},n,a){let i,o;if("reducer"in n){if(r&&!lR(n))throw new Error(Rn(17));i=n.reducer,o=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?ra(e,o):ra(e))}function oR(e){return e._reducerDefinitionType==="asyncThunk"}function lR(e){return e._reducerDefinitionType==="reducerWithPrepare"}function cR({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Rn(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,f=a(e,i,u);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),d&&n.addMatcher(f.settled,d),n.exposeCaseReducer(t,{fulfilled:o||Fc,pending:l||Fc,rejected:c||Fc,settled:d||Fc})}function Fc(){}var dR="task",UE="listener",WE="completed",Ax="cancelled",uR=`task-${Ax}`,fR=`task-${WE}`,ep=`${UE}-${Ax}`,mR=`${UE}-${WE}`,Tu=class{constructor(e){this.code=e,this.message=`${dR} ${Ax} (reason: ${e})`}name="TaskAbortError";message},kx=(e,t)=>{if(typeof e!="function")throw new TypeError(Rn(32))},Nd=()=>{},HE=(e,t=Nd)=>(e.catch(t),e),VE=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),ri=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},ni=e=>{if(e.aborted){const{reason:t}=e;throw new Tu(t)}};function GE(e,t){let r=Nd;return new Promise((n,a)=>{const i=()=>a(new Tu(e.reason));if(e.aborted){i();return}r=VE(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Nd})}var hR=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Tu?"cancelled":"rejected",error:r}}finally{t?.()}},Ed=e=>t=>HE(GE(e,t).then(r=>(ni(e),r))),qE=e=>{const t=Ed(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Vi}=Object,Wy={},_u="listenerMiddleware",pR=(e,t)=>{const r=n=>VE(e,()=>ri(n,e.reason));return(n,a)=>{kx(n);const i=new AbortController;r(i);const o=hR(async()=>{ni(e),ni(i.signal);const l=await n({pause:Ed(i.signal),delay:qE(i.signal),signal:i.signal});return ni(i.signal),l},()=>ri(i,fR));return a?.autoJoin&&t.push(o.catch(Nd)),{result:Ed(e)(o),cancel(){ri(i,uR)}}}},xR=(e,t)=>{const r=async(n,a)=>{ni(t);let i=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:n,effect:(f,m)=>{m.unsubscribe(),c([f,m.getState(),m.getOriginalState()])}});i=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await GE(t,Promise.race(l));return ni(t),c}finally{i()}};return(n,a)=>HE(r(n,a))},KE=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=ra(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Rn(21));return kx(i),{predicate:a,type:t,effect:i}},YE=Vi(e=>{const{type:t,predicate:r,effect:n}=KE(e);return{id:eR(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Rn(22))}}},{withTypes:()=>YE}),Hy=(e,t)=>{const{type:r,effect:n,predicate:a}=KE(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},tp=e=>{e.pending.forEach(t=>{ri(t,ep)})},gR=e=>()=>{e.forEach(tp),e.clear()},Vy=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},XE=Vi(ra(`${_u}/add`),{withTypes:()=>XE}),vR=ra(`${_u}/removeAll`),ZE=Vi(ra(`${_u}/remove`),{withTypes:()=>ZE}),yR=(...e)=>{console.error(`${_u}/error`,...e)},ec=(e={})=>{const t=new Map,{extra:r,onError:n=yR}=e;kx(n);const a=u=>(u.unsubscribe=()=>t.delete(u.id),t.set(u.id,u),f=>{u.unsubscribe(),f?.cancelActive&&tp(u)}),i=u=>{const f=Hy(t,u)??YE(u);return a(f)};Vi(i,{withTypes:()=>i});const o=u=>{const f=Hy(t,u);return f&&(f.unsubscribe(),u.cancelActive&&tp(f)),!!f};Vi(o,{withTypes:()=>o});const l=async(u,f,m,h)=>{const p=new AbortController,x=xR(i,p.signal),g=[];try{u.pending.add(p),await Promise.resolve(u.effect(f,Vi({},m,{getOriginalState:h,condition:(y,w)=>x(y,w).then(Boolean),take:x,delay:qE(p.signal),pause:Ed(p.signal),extra:r,signal:p.signal,fork:pR(p.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{t.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,w,b)=>{y!==p&&(ri(y,ep),b.delete(y))})},cancel:()=>{ri(p,ep),u.pending.delete(p)},throwIfCancelled:()=>{ni(p.signal)}})))}catch(y){y instanceof Tu||Vy(n,y,{raisedBy:"effect"})}finally{await Promise.all(g),ri(p,mR),u.pending.delete(p)}},c=gR(t);return{middleware:u=>f=>m=>{if(!OE(m))return f(m);if(XE.match(m))return i(m.payload);if(vR.match(m)){c();return}if(ZE.match(m))return o(m.payload);let h=u.getState();const p=()=>{if(h===Wy)throw new Error(Rn(23));return h};let x;try{if(x=f(m),t.size>0){const g=u.getState(),y=Array.from(t.values());for(const w of y){let b=!1;try{b=w.predicate(m,g,h)}catch(j){b=!1,Vy(n,j,{raisedBy:"predicate"})}b&&l(w,m,u,p)}}}finally{h=Wy}return x},startListening:i,stopListening:o,clearListeners:c}};function Rn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var bR={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},JE=$n({name:"chartLayout",initialState:bR,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:wR,setLayout:jR,setChartSize:NR,setScale:ER}=JE.actions,SR=JE.reducer;function Gy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gy(Object(r),!0).forEach(function(n){TR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TR(e,t,r){return(t=_R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _R(e){var t=AR(e,"string");return typeof t=="symbol"?t:t+""}function AR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sd=Math.PI/180,kR=e=>e*180/Math.PI,dr=(e,t,r,n)=>({x:e+Math.cos(-Sd*n)*r,y:t+Math.sin(-Sd*n)*r}),QE=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},CR=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},OR=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,o=CR({x:r,y:n},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>i&&(c=2*Math.PI-c),{radius:o,angle:kR(c),angleInRadian:c}},PR=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},DR=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return e+o*360},IR=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=OR({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:d}=PR(t),u=i,f;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;f=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=c}return f?qy(qy({},t),{},{radius:a,angle:DR(u,t)}):null};function eS(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Ky(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ky(Object(r),!0).forEach(function(n){RR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ky(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RR(e,t,r){return(t=FR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FR(e){var t=MR(e,"string");return typeof t=="symbol"?t:t+""}function MR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nt(e,t,r){return $t(e)||$t(t)?r:Pa(t)?hi(e,t,r):typeof t=="function"?t(e):r}var LR=(e,t,r,n,a)=>{var i,o=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?r[c-1].coordinate:r[l-1].coordinate,u=r[c].coordinate,f=c>=l-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(Sr(u-d)!==Sr(f-u)){var h=[];if(Sr(f-u)===Sr(a[1]-a[0])){m=f;var p=u+a[1]-a[0];h[0]=Math.min(p,(p+d)/2),h[1]=Math.max(p,(p+d)/2)}else{m=d;var x=f+a[1]-a[0];h[0]=Math.min(u,(x+u)/2),h[1]=Math.max(u,(x+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){({index:o}=r[c]);break}}else{var y=Math.min(d,f),w=Math.max(d,f);if(e>(y+u)/2&&e<=(w+u)/2){({index:o}=r[c]);break}}}else if(t){for(var b=0;b<l;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<l-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===l-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:o}=t[b]);break}}return o},BR=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&$e(e[i]))return Jn(Jn({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&$e(e[o]))return Jn(Jn({},e),{},{[o]:e[o]+(a||0)})}return e},ns=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",tS=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,o=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||o.push(t),i||o.push(r),o},rS=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:f,niceTicks:m,axisType:h}=e;if(!o)return null;var p=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,x=a==="category"&&o.bandwidth?o.bandwidth()/p:0;if(x=h==="angleAxis"&&i&&i.length>=2?Sr(i[0]-i[1])*2*x:x,f||m){var g=(f||m||[]).map((y,w)=>{var b=n?n.indexOf(y):y;return{coordinate:o(b)+x,value:y,offset:x,index:w}});return g.filter(y=>!jn(y.coordinate))}return c&&d?d.map((y,w)=>({coordinate:o(y)+x,value:y,index:w,offset:x})):o.ticks&&u!=null?o.ticks(u).map((y,w)=>({coordinate:o(y)+x,value:y,offset:x,index:w})):o.domain().map((y,w)=>({coordinate:o(y)+x,value:n?n[y]:y,index:w,offset:x}))},Yy=1e-4,$R=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Yy,i=Math.max(n[0],n[1])+Yy,o=e(t[0]),l=e(t[r-1]);(o<a||o>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},zR=(e,t)=>{if(!t||t.length!==2||!$e(t[0])||!$e(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!$e(e[0])||e[0]<r)&&(a[0]=r),(!$e(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},UR=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,o=0;o<t;++o){var l=jn(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=a,e[o][r][1]=a+l,a=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1])}},WR=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var o=jn(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},HR={sign:UR,expand:y6,none:ao,silhouette:b6,wiggle:w6,positive:WR},VR=(e,t,r)=>{var n=HR[r],a=v6().keys(t).value((i,o)=>+Nt(i,o,0)).order(Vh).offset(n);return a(e)};function nS(e){return e==null?void 0:String(e)}function Xy(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!$t(a[t.dataKey])){var l=qN(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Nt(a,$t(o)?t.dataKey:o);return $t(c)?null:t.scale(c)}var Zy=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Nt(i,t.dataKey,t.scale.domain()[o]);return $t(l)?null:t.scale(l)-a/2+n},GR=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},qR=e=>{var t=e.flat(2).filter($e);return[Math.min(...t),Math.max(...t)]},KR=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],YR=(e,t,r)=>{if(e!=null)return KR(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:o}=i,l=o.reduce((c,d)=>{var u=eS(d,t,r),f=qR(u);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},Jy=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Qy=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,bl=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=ju(t,u=>u.coordinate),i=1/0,o=1,l=a.length;o<l;o++){var c=a[o],d=a[o-1];i=Math.min((c.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function eb(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Jn(Jn({},t),{},{dataKey:r,payload:n,value:a,name:i})}function jo(e,t){if(e)return String(e);if(typeof t=="string")return t}function XR(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?IR({x:e,y:t},n):null}var ZR=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:o}=n;return Jn(Jn(Jn({},n),dr(n.cx,n.cy,o,i)),{},{angle:i,radius:o})}var l=a.coordinate,{angle:c}=n;return Jn(Jn(Jn({},n),dr(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},JR=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,as=e=>e.layout.width,ss=e=>e.layout.height,QR=e=>e.layout.scale,aS=e=>e.layout.margin,Au=fe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),ku=fe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),sS="data-recharts-item-index",iS="data-recharts-item-data-key",tc=60;function tb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tb(Object(r),!0).forEach(function(n){eF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eF(e,t,r){return(t=tF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tF(e){var t=rF(e,"string");return typeof t=="symbol"?t:t+""}function rF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nF=e=>e.brush.height;function aF(e){var t=ku(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:tc;return r+a}return r},0)}function sF(e){var t=ku(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:tc;return r+a}return r},0)}function iF(e){var t=Au(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function oF(e){var t=Au(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var yr=fe([as,ss,aS,nF,aF,sF,iF,oF,_E,S8],(e,t,r,n,a,i,o,l,c,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+i},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},m=Mc(Mc({},f),u),h=m.bottom;m.bottom+=n,m=BR(m,c,d);var p=e-m.left-m.right,x=t-m.top-m.bottom;return Mc(Mc({brushBottom:h},m),{},{width:Math.max(p,0),height:Math.max(x,0)})}),lF=fe(yr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Cx=fe(as,ss,(e,t)=>({x:0,y:0,width:e,height:t})),cF=v.createContext(null),En=()=>v.useContext(cF)!=null,Cu=e=>e.brush,Ou=fe([Cu,yr,aS],(e,t,r)=>({height:e.height,x:$e(e.x)?e.x:t.left,y:$e(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:$e(e.width)?e.width:t.width})),Ox=()=>{var e,t=En(),r=ze(lF),n=ze(Ou),a=(e=ze(Cu))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},dF={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},oS=()=>{var e;return(e=ze(yr))!==null&&e!==void 0?e:dF},Px=()=>ze(as),Dx=()=>ze(ss),uF=()=>ze(e=>e.layout.margin),at=e=>e.layout.layoutType,Pu=()=>ze(at),fF={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},lS=$n({name:"legend",initialState:fF,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Wa(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:rb,setLegendSettings:mF,addLegendPayload:cS,removeLegendPayload:dS}=lS.actions,hF=lS.reducer,pF=["contextPayload"];function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rp.apply(null,arguments)}function nb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function io(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nb(Object(r),!0).forEach(function(n){Ix(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ix(e,t,r){return(t=xF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xF(e){var t=gF(e,"string");return typeof t=="symbol"?t:t+""}function gF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vF(e,t){if(e==null)return{};var r,n,a=yF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bF(e){return e.value}function wF(e){var{contextPayload:t}=e,r=vF(e,pF),n=NE(t,e.payloadUniqBy,bF),a=io(io({},r),{},{payload:n});return v.isValidElement(e.content)?v.cloneElement(e.content,a):typeof e.content=="function"?v.createElement(e.content,a):v.createElement(wx,a)}function jF(e,t,r,n,a,i){var{layout:o,align:l,verticalAlign:c}=t,d,u;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?d={left:((n||0)-i.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?u={top:((a||0)-i.height)/2}:u=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),io(io({},d),u)}function NF(e){var t=Ut();return v.useEffect(()=>{t(mF(e))},[t,e]),null}function EF(e){var t=Ut();return v.useEffect(()=>(t(rb(e)),()=>{t(rb({width:0,height:0}))}),[t,e]),null}function SF(e){var t=A8(),r=UI(),n=uF(),{width:a,height:i,wrapperStyle:o,portal:l}=e,[c,d]=AE([t]),u=Px(),f=Dx();if(u==null||f==null)return null;var m=u-(n.left||0)-(n.right||0),h=Gi.getWidthOrHeight(e.layout,i,a,m),p=l?o:io(io({position:"absolute",width:h?.width||a||"auto",height:h?.height||i||"auto"},jF(o,e,n,u,f,c)),o),x=l??r;if(x==null)return null;var g=v.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},v.createElement(NF,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),v.createElement(EF,{width:c.width,height:c.height}),v.createElement(wF,rp({},e,h,{margin:n,chartWidth:u,chartHeight:f,contextPayload:t})));return Kp.createPortal(g,x)}class Gi extends v.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&$e(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return v.createElement(SF,this.props)}}Ix(Gi,"displayName","Legend");Ix(Gi,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function np(){return np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},np.apply(null,arguments)}function ab(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ab(Object(r),!0).forEach(function(n){TF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ab(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TF(e,t,r){return(t=_F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _F(e){var t=AF(e,"string");return typeof t=="symbol"?t:t+""}function AF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kF(e){return Array.isArray(e)&&Pa(e[0])&&Pa(e[1])?e.join(" ~ "):e}var CF=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:f,accessibilityLayer:m=!1}=e,h=()=>{if(i&&i.length){var N={padding:0,margin:0},E=(l?ju(i,l):i).map((S,T)=>{if(S.type==="none")return null;var k=S.formatter||o||kF,{value:I,name:C}=S,A=I,L=C;if(k){var _=k(I,C,S,T,i);if(Array.isArray(_))[A,L]=_;else if(_!=null)A=_;else return null}var W=b0({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:W},Pa(L)?v.createElement("span",{className:"recharts-tooltip-item-name"},L):null,Pa(L)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},A),v.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:N},E)}return null},p=b0({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),x=b0({margin:0},a),g=!$t(u),y=g?u:"",w=tt("recharts-default-tooltip",c),b=tt("recharts-tooltip-label",d);g&&f&&i!==void 0&&i!==null&&(y=f(u,i));var j=m?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",np({className:w,style:p},j),v.createElement("p",{className:b,style:x},v.isValidElement(y)?y:"".concat(y)),h())},Uo="recharts-tooltip-wrapper",OF={visibility:"hidden"};function PF(e){var{coordinate:t,translateX:r,translateY:n}=e;return tt(Uo,{["".concat(Uo,"-right")]:$e(r)&&t&&$e(t.x)&&r>=t.x,["".concat(Uo,"-left")]:$e(r)&&t&&$e(t.x)&&r<t.x,["".concat(Uo,"-bottom")]:$e(n)&&t&&$e(t.y)&&n>=t.y,["".concat(Uo,"-top")]:$e(n)&&t&&$e(t.y)&&n<t.y})}function sb(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(i&&$e(i[n]))return i[n];var u=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return o[n]?u:f;var m=c[n];if(m==null)return 0;if(o[n]){var h=u,p=m;return h<p?Math.max(f,m):Math.max(u,m)}if(d==null)return 0;var x=f+l,g=m+d;return x>g?Math.max(u,m):Math.max(f,m)}function DF(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function IF(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,d,u,f;return o.height>0&&o.width>0&&r?(u=sb({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=sb({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=DF({translateX:u,translateY:f,useTranslate3d:l})):d=OF,{cssProperties:d,cssClasses:PF({translateX:u,translateY:f,coordinate:r})}}function ib(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ib(Object(r),!0).forEach(function(n){ap(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ib(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ap(e,t,r){return(t=RF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RF(e){var t=FF(e,"string");return typeof t=="symbol"?t:t+""}function FF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class MF extends v.PureComponent{constructor(){super(...arguments),ap(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),ap(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:f,useTranslate3d:m,viewBox:h,wrapperStyle:p,lastBoundingBox:x,innerRef:g,hasPortalFromProps:y}=this.props,{cssClasses:w,cssProperties:b}=IF({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:f,tooltipBox:{height:x.height,width:x.width},useTranslate3d:m,viewBox:h}),j=y?{}:Lc(Lc({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),N=Lc(Lc({},j),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},p);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:N,ref:g},i)}}var LF=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Rs={devToolsEnabled:!1,isSsr:LF()},uS=()=>ze(e=>e.rootProps.accessibilityLayer);function Mr(e){return Number.isFinite(e)}function oo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sp.apply(null,arguments)}function ob(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ob(Object(r),!0).forEach(function(n){BF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ob(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BF(e,t,r){return(t=$F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $F(e){var t=zF(e,"string");return typeof t=="symbol"?t:t+""}function zF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cb={curveBasisClosed:o6,curveBasisOpen:l6,curveBasis:i6,curveBumpX:GI,curveBumpY:qI,curveLinearClosed:c6,curveLinear:bu,curveMonotoneX:d6,curveMonotoneY:u6,curveNatural:f6,curveStep:m6,curveStepAfter:p6,curveStepBefore:h6},Bc=e=>Mr(e.x)&&Mr(e.y),Wo=e=>e.x,Ho=e=>e.y,UF=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Zl(e));return(r==="curveMonotone"||r==="curveBump")&&t?cb["".concat(r).concat(t==="vertical"?"Y":"X")]:cb[r]||bu},WF=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,o=UF(t,a),l=i?r.filter(Bc):r,c;if(Array.isArray(n)){var d=i?n.filter(f=>Bc(f)):n,u=l.map((f,m)=>lb(lb({},f),{},{base:d[m]}));return a==="vertical"?c=Oc().y(Ho).x1(Wo).x0(f=>f.base.x):c=Oc().x(Wo).y1(Ho).y0(f=>f.base.y),c.defined(Bc).curve(o),c(u)}return a==="vertical"&&$e(n)?c=Oc().y(Ho).x1(Wo).x0(n):$e(n)?c=Oc().x(Wo).y1(Ho).y0(n):c=nE().x(Wo).y(Ho),c.defined(Bc).curve(o),c(l)},rl=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?WF(e):n;return v.createElement("path",sp({},ya(e),mx(e),{className:tt("recharts-curve",t),d:i===null?void 0:i,ref:a}))},HF=["x","y","top","left","width","height","className"];function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ip.apply(null,arguments)}function db(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function VF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?db(Object(r),!0).forEach(function(n){GF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):db(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GF(e,t,r){return(t=qF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qF(e){var t=KF(e,"string");return typeof t=="symbol"?t:t+""}function KF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YF(e,t){if(e==null)return{};var r,n,a=XF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function XF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZF=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),JF=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:o=0,className:l}=e,c=YF(e,HF),d=VF({x:t,y:r,top:n,left:a,width:i,height:o},c);return!$e(t)||!$e(r)||!$e(i)||!$e(o)||!$e(n)||!$e(a)?null:v.createElement("path",ip({},Kt(d,!0),{className:tt("recharts-cross",l),d:ZF(t,r,i,o,n,a)}))};function QF(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function ub(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ub(Object(r),!0).forEach(function(n){tM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ub(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tM(e,t,r){return(t=rM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rM(e){var t=nM(e,"string");return typeof t=="symbol"?t:t+""}function nM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Br(e,t){var r=eM({},e),n=t,a=Object.keys(t),i=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return i}function aM(){}function fb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fb(Object(r),!0).forEach(function(n){sM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sM(e,t,r){return(t=iM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iM(e){var t=oM(e,"string");return typeof t=="symbol"?t:t+""}function oM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lM=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),fS=(e,t,r)=>e.map(n=>"".concat(lM(n)," ").concat(t,"ms ").concat(r)).join(","),cM=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),wl=(e,t)=>Object.keys(t).reduce((r,n)=>mb(mb({},r),{},{[n]:e(n,t[n])}),{});function hb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hb(Object(r),!0).forEach(function(n){dM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dM(e,t,r){return(t=uM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uM(e){var t=fM(e,"string");return typeof t=="symbol"?t:t+""}function fM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Td=(e,t,r)=>e+(t-e)*r,op=e=>{var{from:t,to:r}=e;return t!==r},mS=(e,t,r)=>{var n=wl((a,i)=>{if(op(i)){var[o,l]=e(i.from,i.to,i.velocity);return Pr(Pr({},i),{},{from:o,velocity:l})}return i},t);return r<1?wl((a,i)=>op(i)?Pr(Pr({},i),{},{velocity:Td(i.velocity,n[a].velocity,r),from:Td(i.from,n[a].from,r)}):i,t):mS(e,n,r-1)};function mM(e,t,r,n,a,i){var o,l=n.reduce((m,h)=>Pr(Pr({},m),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>wl((m,h)=>h.from,l),d=()=>!Object.values(l).filter(op).length,u=null,f=m=>{o||(o=m);var h=m-o,p=h/r.dt;l=mS(r,l,p),a(Pr(Pr(Pr({},e),t),c())),o=m,d()||(u=i.setTimeout(f))};return()=>(u=i.setTimeout(f),()=>{u()})}function hM(e,t,r,n,a,i,o){var l=null,c=a.reduce((f,m)=>Pr(Pr({},f),{},{[m]:[e[m],t[m]]}),{}),d,u=f=>{d||(d=f);var m=(f-d)/n,h=wl((x,g)=>Td(...g,r(m)),c);if(i(Pr(Pr(Pr({},e),t),h)),m<1)l=o.setTimeout(u);else{var p=wl((x,g)=>Td(...g,r(1)),c);i(Pr(Pr(Pr({},e),t),p))}};return()=>(l=o.setTimeout(u),()=>{l()})}const pM=(e,t,r,n,a,i)=>{var o=cM(e,t);return r.isStepper===!0?mM(e,t,r,o,a,i):hM(e,t,r,n,o,a,i)};var _d=1e-4,hS=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],pS=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),pb=(e,t)=>r=>{var n=hS(e,t);return pS(n,r)},xM=(e,t)=>r=>{var n=hS(e,t),a=[...n.map((i,o)=>i*o).slice(1),0];return pS(a,r)},xb=function(){for(var t,r,n,a,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];if(o.length===1)switch(o[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else o.length===4&&([t,n,r,a]=o);var d=pb(t,r),u=pb(n,a),f=xM(t,r),m=p=>p>1?1:p<0?0:p,h=p=>{for(var x=p>1?1:p,g=x,y=0;y<8;++y){var w=d(g)-x,b=f(g);if(Math.abs(w-x)<_d||b<_d)return u(g);g=m(g-w/b)}return u(g)};return h.isStepper=!1,h},gM=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(o,l,c)=>{var d=-(o-l)*r,u=c*n,f=c+(d-u)*a/1e3,m=c*a/1e3+o;return Math.abs(m-l)<_d&&Math.abs(f)<_d?[l,0]:[m,f]};return i.isStepper=!0,i.dt=a,i},vM=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return xb(e);case"spring":return gM();default:if(e.split("(")[0]==="cubic-bezier")return xb(e)}return typeof e=="function"?e:null};function yM(e){var t,r=()=>null,n=!1,a=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){a=e.setTimeout(i.bind(null,d),c);return}i(c),a=e.setTimeout(i.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class bM{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function wM(){return yM(new bM)}var jM=v.createContext(wM);function NM(e,t){var r=v.useContext(jM);return v.useMemo(()=>t??r(e),[e,t,r])}var EM={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},gb={t:0},w0={t:1};function rc(e){var t=Br(e,EM),{isActive:r,canBegin:n,duration:a,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=NM(t.animationId,t.animationManager),[f,m]=v.useState(r?gb:w0),h=v.useRef(null);return v.useEffect(()=>{r||m(w0)},[r]),v.useEffect(()=>{if(!r||!n)return aM;var p=pM(gb,w0,vM(i),a,m,u.getTimeoutController()),x=()=>{h.current=p()};return u.start([c,o,x,a,l]),()=>{u.stop(),h.current&&h.current(),l()}},[r,n,a,i,o,c,l,u]),d(f.t)}function nc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(gl(t)),n=v.useRef(e);return n.current!==e&&(r.current=gl(t),n.current=e),r.current}function vb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vb(Object(r),!0).forEach(function(n){SM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SM(e,t,r){return(t=TM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TM(e){var t=_M(e,"string");return typeof t=="symbol"?t:t+""}function _M(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ad(){return Ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ad.apply(null,arguments)}var bb=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),o=n>=0?1:-1,l=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var u=[0,0,0,0],f=0,m=4;f<m;f++)u[f]=a[f]>i?i:a[f];d="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*u[1])),d+="L ".concat(e+r,",").concat(t+n-o*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+r-l*u[2],",").concat(t+n)),d+="L ".concat(e+l*u[3],",").concat(t+n),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-o*u[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var h=Math.min(i,a);d="M ".concat(e,",").concat(t+o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,`
            L `).concat(e+r-l*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,`
            L `).concat(e+r,",").concat(t+n-o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+n,`
            L `).concat(e+l*h,",").concat(t+n,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+n-o*h," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},AM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},xS=e=>{var t=Br(e,AM),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&a(_)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:f,animationDuration:m,animationBegin:h,isAnimationActive:p,isUpdateAnimationActive:x}=t,g=v.useRef(l),y=v.useRef(c),w=v.useRef(i),b=v.useRef(o),j=v.useMemo(()=>({x:i,y:o,width:l,height:c,radius:d}),[i,o,l,c,d]),N=nc(j,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var E=tt("recharts-rectangle",u);if(!x)return v.createElement("path",Ad({},Kt(t,!0),{className:E,d:bb(i,o,l,c,d)}));var S=g.current,T=y.current,k=w.current,I=b.current,C="0px ".concat(n===-1?1:n,"px"),A="".concat(n,"px 0px"),L=fS(["strokeDasharray"],m,typeof f=="string"?f:void 0);return v.createElement(rc,{animationId:N,key:N,canBegin:n>0,duration:m,easing:f,isActive:x,begin:h},_=>{var W=Rt(S,l,_),Y=Rt(T,c,_),Q=Rt(k,i,_),J=Rt(I,o,_);r.current&&(g.current=W,y.current=Y,w.current=Q,b.current=J);var U;return p?_>0?U={transition:L,strokeDasharray:A}:U={strokeDasharray:C}:U={strokeDasharray:A},v.createElement("path",Ad({},Kt(t,!0),{className:E,d:bb(Q,J,W,Y,d),ref:r,style:yb(yb({},U),t.style)}))})};function gS(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,o=dr(t,r,n,a),l=dr(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function lp(){return lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lp.apply(null,arguments)}var kM=(e,t)=>{var r=Sr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},$c=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+n,u=Math.asin(l/d)/Sd,f=c?a:a+i*u,m=dr(t,r,d,f),h=dr(t,r,n,f),p=c?a-i*u:a,x=dr(t,r,d*Math.cos(u*Sd),p);return{center:m,circleTangency:h,lineTangency:x,theta:u}},vS=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:o}=e,l=kM(i,o),c=i+l,d=dr(t,r,a,i),u=dr(t,r,a,c),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var m=dr(t,r,n,i),h=dr(t,r,n,c);f+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},CM=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=Sr(d-c),{circleTangency:f,lineTangency:m,theta:h}=$c({cx:t,cy:r,radius:a,angle:c,sign:u,cornerRadius:i,cornerIsExternal:l}),{circleTangency:p,lineTangency:x,theta:g}=$c({cx:t,cy:r,radius:a,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:l}),y=l?Math.abs(c-d):Math.abs(c-d)-h-g;if(y<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):vS({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:d});var w="M ".concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(y>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
  `);if(n>0){var{circleTangency:b,lineTangency:j,theta:N}=$c({cx:t,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:E,lineTangency:S,theta:T}=$c({cx:t,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),k=l?Math.abs(c-d):Math.abs(c-d)-N-T;if(k<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+="L".concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(j.x,",").concat(j.y,"Z")}else w+="L".concat(t,",").concat(r,"Z");return w},OM={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},yS=e=>{var t=Br(e,OM),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:f}=t;if(i<a||d===u)return null;var m=tt("recharts-sector",f),h=i-a,p=Xr(o,h,0,!0),x;return p>0&&Math.abs(d-u)<360?x=CM({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(p,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):x=vS({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u}),v.createElement("path",lp({},Kt(t,!0),{className:m,d:x}))};function PM(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:d,outerRadius:u,angle:f}=t,m=dr(l,c,d,f),h=dr(l,c,u,f);n=m.x,a=m.y,i=h.x,o=h.y}else return gS(t);return[{x:n,y:a},{x:i,y:o}]}var j0={},N0={},E0={},wb;function DM(){return wb||(wb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SE();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(E0)),E0}var jb;function IM(){return jb||(jb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DM();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(N0)),N0}var Nb;function RM(){return Nb||(Nb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TE(),r=IM();function n(a,i,o){o&&typeof o!="number"&&t.isIterateeCall(a,i,o)&&(i=o=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),o=o===void 0?a<i?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((i-a)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=o;return c}e.range=n})(j0)),j0}var S0,Eb;function FM(){return Eb||(Eb=1,S0=RM().range),S0}var MM=FM();const bS=Is(MM);function Ns(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function LM(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Rx(e){let t,r,n;e.length!==2?(t=Ns,r=(l,c)=>Ns(e(l),c),n=(l,c)=>e(l)-c):(t=e===Ns||e===LM?e:BM,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:i}}function BM(){return 0}function wS(e){return e===null?NaN:+e}function*$M(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const zM=Rx(Ns),ac=zM.right;Rx(wS).center;class Sb extends Map{constructor(t,r=HM){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(Tb(this,t))}has(t){return super.has(Tb(this,t))}set(t,r){return super.set(UM(this,t),r)}delete(t){return super.delete(WM(this,t))}}function Tb({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function UM({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function WM({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function HM(e){return e!==null&&typeof e=="object"?e.valueOf():e}function VM(e=Ns){if(e===Ns)return jS;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function jS(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const GM=Math.sqrt(50),qM=Math.sqrt(10),KM=Math.sqrt(2);function kd(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=GM?10:i>=qM?5:i>=KM?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?kd(e,t,r*2):[l,c,d]}function cp(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?kd(t,e,r):kd(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function dp(e,t,r){return t=+t,e=+e,r=+r,kd(e,t,r)[2]}function up(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?dp(t,e,r):dp(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function _b(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Ab(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function NS(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?jS:VM(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(t-d*f/c+m)),p=Math.min(n,Math.floor(t+(c-d)*f/c+m));NS(e,t,h,p,a)}const i=e[t];let o=r,l=n;for(Vo(e,r,t),a(e[n],i)>0&&Vo(e,r,n);o<l;){for(Vo(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?Vo(e,r,l):(++l,Vo(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Vo(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function YM(e,t,r){if(e=Float64Array.from($M(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Ab(e);if(t>=1)return _b(e);var n,a=(n-1)*t,i=Math.floor(a),o=_b(NS(e,i).subarray(0,i+1)),l=Ab(e.subarray(i+1));return o+(l-o)*(a-i)}}function XM(e,t,r=wS){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function ZM(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ia(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function is(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const fp=Symbol("implicit");function Fx(){var e=new Sb,t=[],r=[],n=fp;function a(i){let o=e.get(i);if(o===void 0){if(n!==fp)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Sb;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Fx(t,r).unknown(n)},ia.apply(a,arguments),a}function Mx(){var e=Fx().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var m=t().length,h=a<n,p=h?a:n,x=h?n:a;i=(x-p)/Math.max(1,m-c+d*2),l&&(i=Math.floor(i)),p+=(x-p-i*(m-c))*u,o=i*(1-c),l&&(p=Math.round(p),o=Math.round(o));var g=ZM(m).map(function(y){return p+i*y});return r(h?g.reverse():g)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,d=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(d=+m,f()):d},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return Mx(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},ia.apply(f(),arguments)}function ES(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ES(t())},e}function JM(){return ES(Mx.apply(null,arguments).paddingInner(1))}function Lx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function SS(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function sc(){}var jl=.7,Cd=1/jl,qi="\\s*([+-]?\\d+)\\s*",Nl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",QM=/^#([0-9a-f]{3,8})$/,eL=new RegExp(`^rgb\\(${qi},${qi},${qi}\\)$`),tL=new RegExp(`^rgb\\(${Ca},${Ca},${Ca}\\)$`),rL=new RegExp(`^rgba\\(${qi},${qi},${qi},${Nl}\\)$`),nL=new RegExp(`^rgba\\(${Ca},${Ca},${Ca},${Nl}\\)$`),aL=new RegExp(`^hsl\\(${Nl},${Ca},${Ca}\\)$`),sL=new RegExp(`^hsla\\(${Nl},${Ca},${Ca},${Nl}\\)$`),kb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Lx(sc,El,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Cb,formatHex:Cb,formatHex8:iL,formatHsl:oL,formatRgb:Ob,toString:Ob});function Cb(){return this.rgb().formatHex()}function iL(){return this.rgb().formatHex8()}function oL(){return TS(this).formatHsl()}function Ob(){return this.rgb().formatRgb()}function El(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=QM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Pb(t):r===3?new xn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?zc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?zc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=eL.exec(e))?new xn(t[1],t[2],t[3],1):(t=tL.exec(e))?new xn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rL.exec(e))?zc(t[1],t[2],t[3],t[4]):(t=nL.exec(e))?zc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=aL.exec(e))?Rb(t[1],t[2]/100,t[3]/100,1):(t=sL.exec(e))?Rb(t[1],t[2]/100,t[3]/100,t[4]):kb.hasOwnProperty(e)?Pb(kb[e]):e==="transparent"?new xn(NaN,NaN,NaN,0):null}function Pb(e){return new xn(e>>16&255,e>>8&255,e&255,1)}function zc(e,t,r,n){return n<=0&&(e=t=r=NaN),new xn(e,t,r,n)}function lL(e){return e instanceof sc||(e=El(e)),e?(e=e.rgb(),new xn(e.r,e.g,e.b,e.opacity)):new xn}function mp(e,t,r,n){return arguments.length===1?lL(e):new xn(e,t,r,n??1)}function xn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Lx(xn,mp,SS(sc,{brighter(e){return e=e==null?Cd:Math.pow(Cd,e),new xn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?jl:Math.pow(jl,e),new xn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new xn(ai(this.r),ai(this.g),ai(this.b),Od(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Db,formatHex:Db,formatHex8:cL,formatRgb:Ib,toString:Ib}));function Db(){return`#${Zs(this.r)}${Zs(this.g)}${Zs(this.b)}`}function cL(){return`#${Zs(this.r)}${Zs(this.g)}${Zs(this.b)}${Zs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ib(){const e=Od(this.opacity);return`${e===1?"rgb(":"rgba("}${ai(this.r)}, ${ai(this.g)}, ${ai(this.b)}${e===1?")":`, ${e})`}`}function Od(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ai(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Zs(e){return e=ai(e),(e<16?"0":"")+e.toString(16)}function Rb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ua(e,t,r,n)}function TS(e){if(e instanceof ua)return new ua(e.h,e.s,e.l,e.opacity);if(e instanceof sc||(e=El(e)),!e)return new ua;if(e instanceof ua)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new ua(o,l,c,e.opacity)}function dL(e,t,r,n){return arguments.length===1?TS(e):new ua(e,t,r,n??1)}function ua(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Lx(ua,dL,SS(sc,{brighter(e){return e=e==null?Cd:Math.pow(Cd,e),new ua(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?jl:Math.pow(jl,e),new ua(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new xn(T0(e>=240?e-240:e+120,a,n),T0(e,a,n),T0(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ua(Fb(this.h),Uc(this.s),Uc(this.l),Od(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Od(this.opacity);return`${e===1?"hsl(":"hsla("}${Fb(this.h)}, ${Uc(this.s)*100}%, ${Uc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fb(e){return e=(e||0)%360,e<0?e+360:e}function Uc(e){return Math.max(0,Math.min(1,e||0))}function T0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Bx=e=>()=>e;function uL(e,t){return function(r){return e+r*t}}function fL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function mL(e){return(e=+e)==1?_S:function(t,r){return r-t?fL(t,r,e):Bx(isNaN(t)?r:t)}}function _S(e,t){var r=t-e;return r?uL(e,r):Bx(isNaN(e)?t:e)}const Mb=(function e(t){var r=mL(t);function n(a,i){var o=r((a=mp(a)).r,(i=mp(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=_S(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n})(1);function hL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function pL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=No(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function gL(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Pd(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function vL(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=No(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var hp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_0=new RegExp(hp.source,"g");function yL(e){return function(){return e}}function bL(e){return function(t){return e(t)+""}}function wL(e,t){var r=hp.lastIndex=_0.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=hp.exec(e))&&(a=_0.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Pd(n,a)})),r=_0.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?bL(c[0].x):yL(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function No(e,t){var r=typeof t,n;return t==null||r==="boolean"?Bx(t):(r==="number"?Pd:r==="string"?(n=El(t))?(t=n,Mb):wL:t instanceof El?Mb:t instanceof Date?gL:pL(t)?hL:Array.isArray(t)?xL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?vL:Pd)(e,t)}function $x(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function jL(e,t){t===void 0&&(t=e,e=No);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function NL(e){return function(){return e}}function Dd(e){return+e}var Lb=[0,1];function cn(e){return e}function pp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:NL(isNaN(t)?NaN:.5)}function EL(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function SL(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=pp(a,n),i=r(o,i)):(n=pp(n,a),i=r(i,o)),function(l){return i(n(l))}}function TL(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=pp(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=ac(e,l,1,n)-1;return i[c](a[c](l))}}function ic(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Du(){var e=Lb,t=Lb,r=No,n,a,i,o=cn,l,c,d;function u(){var m=Math.min(e.length,t.length);return o!==cn&&(o=EL(e[0],e[m-1])),l=m>2?TL:SL,c=d=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=l(e.map(n),t,r)))(n(o(m)))}return f.invert=function(m){return o(a((d||(d=l(t,e.map(n),Pd)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,Dd),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=$x,u()},f.clamp=function(m){return arguments.length?(o=m?!0:cn,u()):o!==cn},f.interpolate=function(m){return arguments.length?(r=m,u()):r},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,h){return n=m,a=h,u()}}function zx(){return Du()(cn,cn)}function _L(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Id(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function lo(e){return e=Id(Math.abs(e)),e?e[1]:NaN}function AL(e,t){return function(r,n){for(var a=r.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function kL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var CL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Sl(e){if(!(t=CL.exec(e)))throw new Error("invalid format: "+e);var t;return new Ux({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Sl.prototype=Ux.prototype;function Ux(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ux.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function OL(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var AS;function PL(e,t){var r=Id(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(AS=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Id(e,Math.max(0,t+i-1))[0]}function Bb(e,t){var r=Id(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const $b={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:_L,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Bb(e*100,t),r:Bb,s:PL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function zb(e){return e}var Ub=Array.prototype.map,Wb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function DL(e){var t=e.grouping===void 0||e.thousands===void 0?zb:AL(Ub.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?zb:kL(Ub.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=Sl(f);var m=f.fill,h=f.align,p=f.sign,x=f.symbol,g=f.zero,y=f.width,w=f.comma,b=f.precision,j=f.trim,N=f.type;N==="n"?(w=!0,N="g"):$b[N]||(b===void 0&&(b=12),j=!0,N="g"),(g||m==="0"&&h==="=")&&(g=!0,m="0",h="=");var E=x==="$"?r:x==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",S=x==="$"?n:/[%p]/.test(N)?o:"",T=$b[N],k=/[defgprs%]/.test(N);b=b===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function I(C){var A=E,L=S,_,W,Y;if(N==="c")L=T(C)+L,C="";else{C=+C;var Q=C<0||1/C<0;if(C=isNaN(C)?c:T(Math.abs(C),b),j&&(C=OL(C)),Q&&+C==0&&p!=="+"&&(Q=!1),A=(Q?p==="("?p:l:p==="-"||p==="("?"":p)+A,L=(N==="s"?Wb[8+AS/3]:"")+L+(Q&&p==="("?")":""),k){for(_=-1,W=C.length;++_<W;)if(Y=C.charCodeAt(_),48>Y||Y>57){L=(Y===46?a+C.slice(_+1):C.slice(_))+L,C=C.slice(0,_);break}}}w&&!g&&(C=t(C,1/0));var J=A.length+C.length+L.length,U=J<y?new Array(y-J+1).join(m):"";switch(w&&g&&(C=t(U+C,U.length?y-L.length:1/0),U=""),h){case"<":C=A+C+L+U;break;case"=":C=A+U+C+L;break;case"^":C=U.slice(0,J=U.length>>1)+A+C+L+U.slice(J);break;default:C=U+A+C+L;break}return i(C)}return I.toString=function(){return f+""},I}function u(f,m){var h=d((f=Sl(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(lo(m)/3)))*3,x=Math.pow(10,-p),g=Wb[8+p/3];return function(y){return h(x*y)+g}}return{format:d,formatPrefix:u}}var Wc,Wx,kS;IL({thousands:",",grouping:[3],currency:["$",""]});function IL(e){return Wc=DL(e),Wx=Wc.format,kS=Wc.formatPrefix,Wc}function RL(e){return Math.max(0,-lo(Math.abs(e)))}function FL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lo(t)/3)))*3-lo(Math.abs(e)))}function ML(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,lo(t)-lo(e))+1}function CS(e,t,r,n){var a=up(e,t,r),i;switch(n=Sl(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=FL(a,o))&&(n.precision=i),kS(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=ML(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=RL(a))&&(n.precision=i-(n.type==="%")*2);break}}return Wx(n)}function Fs(e){var t=e.domain;return e.ticks=function(r){var n=t();return cp(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return CS(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=dp(o,l,r),d===c)return n[a]=o,n[i]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function OS(){var e=zx();return e.copy=function(){return ic(e,OS())},ia.apply(e,arguments),Fs(e)}function PS(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Dd),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return PS(e).unknown(t)},e=arguments.length?Array.from(e,Dd):[0,1],Fs(r)}function DS(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Hb(e){return Math.log(e)}function Vb(e){return Math.exp(e)}function LL(e){return-Math.log(-e)}function BL(e){return-Math.exp(-e)}function $L(e){return isFinite(e)?+("1e"+e):e<0?0:e}function zL(e){return e===10?$L:e===Math.E?Math.exp:t=>Math.pow(e,t)}function UL(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Gb(e){return(t,r)=>-e(-t,r)}function Hx(e){const t=e(Hb,Vb),r=t.domain;let n=10,a,i;function o(){return a=UL(n),i=zL(n),r()[0]<0?(a=Gb(a),i=Gb(i),e(LL,BL)):e(Hb,Vb),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let m=a(d),h=a(u),p,x;const g=l==null?10:+l;let y=[];if(!(n%1)&&h-m<g){if(m=Math.floor(m),h=Math.ceil(h),d>0){for(;m<=h;++m)for(p=1;p<n;++p)if(x=m<0?p/i(-m):p*i(m),!(x<d)){if(x>u)break;y.push(x)}}else for(;m<=h;++m)for(p=n-1;p>=1;--p)if(x=m>0?p/i(-m):p*i(m),!(x<d)){if(x>u)break;y.push(x)}y.length*2<g&&(y=cp(d,u,g))}else y=cp(m,h,Math.min(h-m,g)).map(i);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Sl(c)).precision==null&&(c.trim=!0),c=Wx(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(DS(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function IS(){const e=Hx(Du()).domain([1,10]);return e.copy=()=>ic(e,IS()).base(e.base()),ia.apply(e,arguments),e}function qb(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Kb(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Vx(e){var t=1,r=e(qb(t),Kb(t));return r.constant=function(n){return arguments.length?e(qb(t=+n),Kb(t)):t},Fs(r)}function RS(){var e=Vx(Du());return e.copy=function(){return ic(e,RS()).constant(e.constant())},ia.apply(e,arguments)}function Yb(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function WL(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function HL(e){return e<0?-e*e:e*e}function Gx(e){var t=e(cn,cn),r=1;function n(){return r===1?e(cn,cn):r===.5?e(WL,HL):e(Yb(r),Yb(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Fs(t)}function qx(){var e=Gx(Du());return e.copy=function(){return ic(e,qx()).exponent(e.exponent())},ia.apply(e,arguments),e}function VL(){return qx.apply(null,arguments).exponent(.5)}function Xb(e){return Math.sign(e)*e*e}function GL(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function FS(){var e=zx(),t=[0,1],r=!1,n;function a(i){var o=GL(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(Xb(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Dd)).map(Xb)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return FS(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ia.apply(a,arguments),Fs(a)}function MS(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=XM(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[ac(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ns),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return MS().domain(e).range(t).unknown(n)},ia.apply(i,arguments)}function LS(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[ac(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return LS().domain([e,t]).range(a).unknown(i)},ia.apply(Fs(o),arguments)}function BS(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[ac(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return BS().domain(e).range(t).unknown(r)},ia.apply(a,arguments)}const A0=new Date,k0=new Date;function br(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},a.filter=i=>br(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(A0.setTime(+i),k0.setTime(+o),e(A0),e(k0),Math.floor(r(A0,k0))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Rd=br(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Rd.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?br(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Rd);Rd.range;const Ba=1e3,Qn=Ba*60,$a=Qn*60,Qa=$a*24,Kx=Qa*7,Zb=Qa*30,C0=Qa*365,Js=br(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ba)},(e,t)=>(t-e)/Ba,e=>e.getUTCSeconds());Js.range;const Yx=br(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ba)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getMinutes());Yx.range;const Xx=br(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getUTCMinutes());Xx.range;const Zx=br(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ba-e.getMinutes()*Qn)},(e,t)=>{e.setTime(+e+t*$a)},(e,t)=>(t-e)/$a,e=>e.getHours());Zx.range;const Jx=br(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*$a)},(e,t)=>(t-e)/$a,e=>e.getUTCHours());Jx.range;const oc=br(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Qn)/Qa,e=>e.getDate()-1);oc.range;const Iu=br(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qa,e=>e.getUTCDate()-1);Iu.range;const $S=br(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qa,e=>Math.floor(e/Qa));$S.range;function _i(e){return br(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Qn)/Kx)}const Ru=_i(0),Fd=_i(1),qL=_i(2),KL=_i(3),co=_i(4),YL=_i(5),XL=_i(6);Ru.range;Fd.range;qL.range;KL.range;co.range;YL.range;XL.range;function Ai(e){return br(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Kx)}const Fu=Ai(0),Md=Ai(1),ZL=Ai(2),JL=Ai(3),uo=Ai(4),QL=Ai(5),e7=Ai(6);Fu.range;Md.range;ZL.range;JL.range;uo.range;QL.range;e7.range;const Qx=br(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Qx.range;const eg=br(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());eg.range;const es=br(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:br(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});es.range;const ts=br(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:br(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ts.range;function zS(e,t,r,n,a,i){const o=[[Js,1,Ba],[Js,5,5*Ba],[Js,15,15*Ba],[Js,30,30*Ba],[i,1,Qn],[i,5,5*Qn],[i,15,15*Qn],[i,30,30*Qn],[a,1,$a],[a,3,3*$a],[a,6,6*$a],[a,12,12*$a],[n,1,Qa],[n,2,2*Qa],[r,1,Kx],[t,1,Zb],[t,3,3*Zb],[e,1,C0]];function l(d,u,f){const m=u<d;m&&([d,u]=[u,d]);const h=f&&typeof f.range=="function"?f:c(d,u,f),p=h?h.range(d,+u+1):[];return m?p.reverse():p}function c(d,u,f){const m=Math.abs(u-d)/f,h=Rx(([,,g])=>g).right(o,m);if(h===o.length)return e.every(up(d/C0,u/C0,f));if(h===0)return Rd.every(Math.max(up(d,u,f),1));const[p,x]=o[m/o[h-1][2]<o[h][2]/m?h-1:h];return p.every(x)}return[l,c]}const[t7,r7]=zS(ts,eg,Fu,$S,Jx,Xx),[n7,a7]=zS(es,Qx,Ru,oc,Zx,Yx);function O0(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function P0(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Go(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function s7(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=qo(a),u=Ko(a),f=qo(i),m=Ko(i),h=qo(o),p=Ko(o),x=qo(l),g=Ko(l),y=qo(c),w=Ko(c),b={a:Q,A:J,b:U,B:ie,c:null,d:nw,e:nw,f:A7,g:L7,G:$7,H:S7,I:T7,j:_7,L:US,m:k7,M:C7,p:re,q:M,Q:iw,s:ow,S:O7,u:P7,U:D7,V:I7,w:R7,W:F7,x:null,X:null,y:M7,Y:B7,Z:z7,"%":sw},j={a:z,A:V,b:P,B:Z,c:null,d:aw,e:aw,f:V7,g:tB,G:nB,H:U7,I:W7,j:H7,L:HS,m:G7,M:q7,p:oe,q:ye,Q:iw,s:ow,S:K7,u:Y7,U:X7,V:Z7,w:J7,W:Q7,x:null,X:null,y:eB,Y:rB,Z:aB,"%":sw},N={a:I,A:C,b:A,B:L,c:_,d:tw,e:tw,f:w7,g:ew,G:Qb,H:rw,I:rw,j:g7,L:b7,m:x7,M:v7,p:k,q:p7,Q:N7,s:E7,S:y7,u:d7,U:u7,V:f7,w:c7,W:m7,x:W,X:Y,y:ew,Y:Qb,Z:h7,"%":j7};b.x=E(r,b),b.X=E(n,b),b.c=E(t,b),j.x=E(r,j),j.X=E(n,j),j.c=E(t,j);function E(ne,ae){return function(le){var D=[],Ae=-1,Ie=0,Ke=ne.length,Re,Se,He;for(le instanceof Date||(le=new Date(+le));++Ae<Ke;)ne.charCodeAt(Ae)===37&&(D.push(ne.slice(Ie,Ae)),(Se=Jb[Re=ne.charAt(++Ae)])!=null?Re=ne.charAt(++Ae):Se=Re==="e"?" ":"0",(He=ae[Re])&&(Re=He(le,Se)),D.push(Re),Ie=Ae+1);return D.push(ne.slice(Ie,Ae)),D.join("")}}function S(ne,ae){return function(le){var D=Go(1900,void 0,1),Ae=T(D,ne,le+="",0),Ie,Ke;if(Ae!=le.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(ae&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(Ie=P0(Go(D.y,0,1)),Ke=Ie.getUTCDay(),Ie=Ke>4||Ke===0?Md.ceil(Ie):Md(Ie),Ie=Iu.offset(Ie,(D.V-1)*7),D.y=Ie.getUTCFullYear(),D.m=Ie.getUTCMonth(),D.d=Ie.getUTCDate()+(D.w+6)%7):(Ie=O0(Go(D.y,0,1)),Ke=Ie.getDay(),Ie=Ke>4||Ke===0?Fd.ceil(Ie):Fd(Ie),Ie=oc.offset(Ie,(D.V-1)*7),D.y=Ie.getFullYear(),D.m=Ie.getMonth(),D.d=Ie.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),Ke="Z"in D?P0(Go(D.y,0,1)).getUTCDay():O0(Go(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(Ke+5)%7:D.w+D.U*7-(Ke+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,P0(D)):O0(D)}}function T(ne,ae,le,D){for(var Ae=0,Ie=ae.length,Ke=le.length,Re,Se;Ae<Ie;){if(D>=Ke)return-1;if(Re=ae.charCodeAt(Ae++),Re===37){if(Re=ae.charAt(Ae++),Se=N[Re in Jb?ae.charAt(Ae++):Re],!Se||(D=Se(ne,le,D))<0)return-1}else if(Re!=le.charCodeAt(D++))return-1}return D}function k(ne,ae,le){var D=d.exec(ae.slice(le));return D?(ne.p=u.get(D[0].toLowerCase()),le+D[0].length):-1}function I(ne,ae,le){var D=h.exec(ae.slice(le));return D?(ne.w=p.get(D[0].toLowerCase()),le+D[0].length):-1}function C(ne,ae,le){var D=f.exec(ae.slice(le));return D?(ne.w=m.get(D[0].toLowerCase()),le+D[0].length):-1}function A(ne,ae,le){var D=y.exec(ae.slice(le));return D?(ne.m=w.get(D[0].toLowerCase()),le+D[0].length):-1}function L(ne,ae,le){var D=x.exec(ae.slice(le));return D?(ne.m=g.get(D[0].toLowerCase()),le+D[0].length):-1}function _(ne,ae,le){return T(ne,t,ae,le)}function W(ne,ae,le){return T(ne,r,ae,le)}function Y(ne,ae,le){return T(ne,n,ae,le)}function Q(ne){return o[ne.getDay()]}function J(ne){return i[ne.getDay()]}function U(ne){return c[ne.getMonth()]}function ie(ne){return l[ne.getMonth()]}function re(ne){return a[+(ne.getHours()>=12)]}function M(ne){return 1+~~(ne.getMonth()/3)}function z(ne){return o[ne.getUTCDay()]}function V(ne){return i[ne.getUTCDay()]}function P(ne){return c[ne.getUTCMonth()]}function Z(ne){return l[ne.getUTCMonth()]}function oe(ne){return a[+(ne.getUTCHours()>=12)]}function ye(ne){return 1+~~(ne.getUTCMonth()/3)}return{format:function(ne){var ae=E(ne+="",b);return ae.toString=function(){return ne},ae},parse:function(ne){var ae=S(ne+="",!1);return ae.toString=function(){return ne},ae},utcFormat:function(ne){var ae=E(ne+="",j);return ae.toString=function(){return ne},ae},utcParse:function(ne){var ae=S(ne+="",!0);return ae.toString=function(){return ne},ae}}}var Jb={"-":"",_:" ",0:"0"},Ar=/^\s*\d+/,i7=/^%/,o7=/[\\^$*+?|[\]().{}]/g;function lt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function l7(e){return e.replace(o7,"\\$&")}function qo(e){return new RegExp("^(?:"+e.map(l7).join("|")+")","i")}function Ko(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function c7(e,t,r){var n=Ar.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function d7(e,t,r){var n=Ar.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function u7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function f7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function m7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Qb(e,t,r){var n=Ar.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function ew(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function h7(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function p7(e,t,r){var n=Ar.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function x7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function tw(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function g7(e,t,r){var n=Ar.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function rw(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function v7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function y7(e,t,r){var n=Ar.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function b7(e,t,r){var n=Ar.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function w7(e,t,r){var n=Ar.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function j7(e,t,r){var n=i7.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function N7(e,t,r){var n=Ar.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function E7(e,t,r){var n=Ar.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function nw(e,t){return lt(e.getDate(),t,2)}function S7(e,t){return lt(e.getHours(),t,2)}function T7(e,t){return lt(e.getHours()%12||12,t,2)}function _7(e,t){return lt(1+oc.count(es(e),e),t,3)}function US(e,t){return lt(e.getMilliseconds(),t,3)}function A7(e,t){return US(e,t)+"000"}function k7(e,t){return lt(e.getMonth()+1,t,2)}function C7(e,t){return lt(e.getMinutes(),t,2)}function O7(e,t){return lt(e.getSeconds(),t,2)}function P7(e){var t=e.getDay();return t===0?7:t}function D7(e,t){return lt(Ru.count(es(e)-1,e),t,2)}function WS(e){var t=e.getDay();return t>=4||t===0?co(e):co.ceil(e)}function I7(e,t){return e=WS(e),lt(co.count(es(e),e)+(es(e).getDay()===4),t,2)}function R7(e){return e.getDay()}function F7(e,t){return lt(Fd.count(es(e)-1,e),t,2)}function M7(e,t){return lt(e.getFullYear()%100,t,2)}function L7(e,t){return e=WS(e),lt(e.getFullYear()%100,t,2)}function B7(e,t){return lt(e.getFullYear()%1e4,t,4)}function $7(e,t){var r=e.getDay();return e=r>=4||r===0?co(e):co.ceil(e),lt(e.getFullYear()%1e4,t,4)}function z7(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+lt(t/60|0,"0",2)+lt(t%60,"0",2)}function aw(e,t){return lt(e.getUTCDate(),t,2)}function U7(e,t){return lt(e.getUTCHours(),t,2)}function W7(e,t){return lt(e.getUTCHours()%12||12,t,2)}function H7(e,t){return lt(1+Iu.count(ts(e),e),t,3)}function HS(e,t){return lt(e.getUTCMilliseconds(),t,3)}function V7(e,t){return HS(e,t)+"000"}function G7(e,t){return lt(e.getUTCMonth()+1,t,2)}function q7(e,t){return lt(e.getUTCMinutes(),t,2)}function K7(e,t){return lt(e.getUTCSeconds(),t,2)}function Y7(e){var t=e.getUTCDay();return t===0?7:t}function X7(e,t){return lt(Fu.count(ts(e)-1,e),t,2)}function VS(e){var t=e.getUTCDay();return t>=4||t===0?uo(e):uo.ceil(e)}function Z7(e,t){return e=VS(e),lt(uo.count(ts(e),e)+(ts(e).getUTCDay()===4),t,2)}function J7(e){return e.getUTCDay()}function Q7(e,t){return lt(Md.count(ts(e)-1,e),t,2)}function eB(e,t){return lt(e.getUTCFullYear()%100,t,2)}function tB(e,t){return e=VS(e),lt(e.getUTCFullYear()%100,t,2)}function rB(e,t){return lt(e.getUTCFullYear()%1e4,t,4)}function nB(e,t){var r=e.getUTCDay();return e=r>=4||r===0?uo(e):uo.ceil(e),lt(e.getUTCFullYear()%1e4,t,4)}function aB(){return"+0000"}function sw(){return"%"}function iw(e){return+e}function ow(e){return Math.floor(+e/1e3)}var Fi,GS,qS;sB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function sB(e){return Fi=s7(e),GS=Fi.format,Fi.parse,qS=Fi.utcFormat,Fi.utcParse,Fi}function iB(e){return new Date(e)}function oB(e){return e instanceof Date?+e:+new Date(+e)}function tg(e,t,r,n,a,i,o,l,c,d){var u=zx(),f=u.invert,m=u.domain,h=d(".%L"),p=d(":%S"),x=d("%I:%M"),g=d("%I %p"),y=d("%a %d"),w=d("%b %d"),b=d("%B"),j=d("%Y");function N(E){return(c(E)<E?h:l(E)<E?p:o(E)<E?x:i(E)<E?g:n(E)<E?a(E)<E?y:w:r(E)<E?b:j)(E)}return u.invert=function(E){return new Date(f(E))},u.domain=function(E){return arguments.length?m(Array.from(E,oB)):m().map(iB)},u.ticks=function(E){var S=m();return e(S[0],S[S.length-1],E??10)},u.tickFormat=function(E,S){return S==null?N:d(S)},u.nice=function(E){var S=m();return(!E||typeof E.range!="function")&&(E=t(S[0],S[S.length-1],E??10)),E?m(DS(S,E)):u},u.copy=function(){return ic(u,tg(e,t,r,n,a,i,o,l,c,d))},u}function lB(){return ia.apply(tg(n7,a7,es,Qx,Ru,oc,Zx,Yx,Js,GS).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function cB(){return ia.apply(tg(t7,r7,ts,eg,Fu,Iu,Jx,Xx,Js,qS).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Mu(){var e=0,t=1,r,n,a,i,o=cn,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(m){var h,p;return arguments.length?([h,p]=m,o=f(h,p),d):[o(0),o(1)]}}return d.range=u(No),d.rangeRound=u($x),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function Ms(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function KS(){var e=Fs(Mu()(cn));return e.copy=function(){return Ms(e,KS())},is.apply(e,arguments)}function YS(){var e=Hx(Mu()).domain([1,10]);return e.copy=function(){return Ms(e,YS()).base(e.base())},is.apply(e,arguments)}function XS(){var e=Vx(Mu());return e.copy=function(){return Ms(e,XS()).constant(e.constant())},is.apply(e,arguments)}function rg(){var e=Gx(Mu());return e.copy=function(){return Ms(e,rg()).exponent(e.exponent())},is.apply(e,arguments)}function dB(){return rg.apply(null,arguments).exponent(.5)}function ZS(){var e=[],t=cn;function r(n){if(n!=null&&!isNaN(n=+n))return t((ac(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ns),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>YM(e,i/n))},r.copy=function(){return ZS(t).domain(e)},is.apply(r,arguments)}function Lu(){var e=0,t=.5,r=1,n=1,a,i,o,l,c,d=cn,u,f=!1,m;function h(x){return isNaN(x=+x)?m:(x=.5+((x=+u(x))-i)*(n*x<n*i?l:c),d(f?Math.max(0,Math.min(1,x)):x))}h.domain=function(x){return arguments.length?([e,t,r]=x,a=u(e=+e),i=u(t=+t),o=u(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(x){return arguments.length?(f=!!x,h):f},h.interpolator=function(x){return arguments.length?(d=x,h):d};function p(x){return function(g){var y,w,b;return arguments.length?([y,w,b]=g,d=jL(x,[y,w,b]),h):[d(0),d(.5),d(1)]}}return h.range=p(No),h.rangeRound=p($x),h.unknown=function(x){return arguments.length?(m=x,h):m},function(x){return u=x,a=x(e),i=x(t),o=x(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,h}}function JS(){var e=Fs(Lu()(cn));return e.copy=function(){return Ms(e,JS())},is.apply(e,arguments)}function QS(){var e=Hx(Lu()).domain([.1,1,10]);return e.copy=function(){return Ms(e,QS()).base(e.base())},is.apply(e,arguments)}function eT(){var e=Vx(Lu());return e.copy=function(){return Ms(e,eT()).constant(e.constant())},is.apply(e,arguments)}function ng(){var e=Gx(Lu());return e.copy=function(){return Ms(e,ng()).exponent(e.exponent())},is.apply(e,arguments)}function uB(){return ng.apply(null,arguments).exponent(.5)}const Jo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Mx,scaleDiverging:JS,scaleDivergingLog:QS,scaleDivergingPow:ng,scaleDivergingSqrt:uB,scaleDivergingSymlog:eT,scaleIdentity:PS,scaleImplicit:fp,scaleLinear:OS,scaleLog:IS,scaleOrdinal:Fx,scalePoint:JM,scalePow:qx,scaleQuantile:MS,scaleQuantize:LS,scaleRadial:FS,scaleSequential:KS,scaleSequentialLog:YS,scaleSequentialPow:rg,scaleSequentialQuantile:ZS,scaleSequentialSqrt:dB,scaleSequentialSymlog:XS,scaleSqrt:VL,scaleSymlog:RS,scaleThreshold:BS,scaleTime:lB,scaleUtc:cB,tickFormat:CS},Symbol.toStringTag,{value:"Module"}));var Ls=e=>e.chartData,ag=fe([Ls],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Bu=(e,t,r,n)=>n?ag(e):Ls(e);function fo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Mr(t)&&Mr(r))return!0}return!1}function lw(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function fB(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Mr(r))a=r;else if(typeof r=="function")return;if(Mr(n))i=n;else if(typeof n=="function")return;var o=[a,i];if(fo(o))return o}}function mB(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(fo(n))return lw(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,o,l;if(a==="auto")t!=null&&(o=Math.min(...t));else if($e(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[0]))}catch{}else if(typeof a=="string"&&Jy.test(a)){var c=Jy.exec(a);if(c==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if($e(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&Qy.test(i)){var u=Qy.exec(i);if(u==null||t==null)l=void 0;else{var f=+u[1];l=t[1]+f}}else l=t?.[1];var m=[o,l];if(fo(m))return t==null?m:lw(m,t,r)}}}var Eo=1e9,hB={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},ig,Ot=!0,na="[DecimalError] ",si=na+"Invalid argument: ",sg=na+"Exponent out of range: ",So=Math.floor,qs=Math.pow,pB=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,On,jr=1e7,St=7,tT=9007199254740991,Ld=So(tT/St),Be={};Be.absoluteValue=Be.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Be.comparedTo=Be.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Be.decimalPlaces=Be.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*St;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Be.dividedBy=Be.div=function(e){return Ha(this,new this.constructor(e))};Be.dividedToIntegerBy=Be.idiv=function(e){var t=this,r=t.constructor;return wt(Ha(t,new r(e),0,1),r.precision)};Be.equals=Be.eq=function(e){return!this.cmp(e)};Be.exponent=function(){return fr(this)};Be.greaterThan=Be.gt=function(e){return this.cmp(e)>0};Be.greaterThanOrEqualTo=Be.gte=function(e){return this.cmp(e)>=0};Be.isInteger=Be.isint=function(){return this.e>this.d.length-2};Be.isNegative=Be.isneg=function(){return this.s<0};Be.isPositive=Be.ispos=function(){return this.s>0};Be.isZero=function(){return this.s===0};Be.lessThan=Be.lt=function(e){return this.cmp(e)<0};Be.lessThanOrEqualTo=Be.lte=function(e){return this.cmp(e)<1};Be.logarithm=Be.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(On))throw Error(na+"NaN");if(r.s<1)throw Error(na+(r.s?"NaN":"-Infinity"));return r.eq(On)?new n(0):(Ot=!1,t=Ha(Tl(r,i),Tl(e,i),i),Ot=!0,wt(t,a))};Be.minus=Be.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aT(t,e):rT(t,(e.s=-e.s,e))};Be.modulo=Be.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(na+"NaN");return r.s?(Ot=!1,t=Ha(r,e,0,1).times(e),Ot=!0,r.minus(t)):wt(new n(r),a)};Be.naturalExponential=Be.exp=function(){return nT(this)};Be.naturalLogarithm=Be.ln=function(){return Tl(this)};Be.negated=Be.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Be.plus=Be.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rT(t,e):aT(t,(e.s=-e.s,e))};Be.precision=Be.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(si+e);if(t=fr(a)+1,n=a.d.length-1,r=n*St+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Be.squareRoot=Be.sqrt=function(){var e,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(na+"NaN")}for(e=fr(l),Ot=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Aa(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=So((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(Ha(l,i,o+2)).times(.5),Aa(i.d).slice(0,o)===(t=Aa(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(wt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return Ot=!0,wt(n,r)};Be.times=Be.mul=function(e){var t,r,n,a,i,o,l,c,d,u=this,f=u.constructor,m=u.d,h=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=m.length,d=h.length,c<d&&(i=m,m=h,h=i,o=c,c=d,d=o),i=[],o=c+d,n=o;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+h[n]*m[a-n-1]+t,i[a--]=l%jr|0,t=l/jr|0;i[a]=(i[a]+t)%jr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Ot?wt(e,f.precision):e};Be.toDecimalPlaces=Be.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Da(e,0,Eo),t===void 0?t=n.rounding:Da(t,0,8),wt(r,e+fr(r)+1,t))};Be.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=gi(n,!0):(Da(e,0,Eo),t===void 0?t=a.rounding:Da(t,0,8),n=wt(new a(n),e+1,t),r=gi(n,!0,e+1)),r};Be.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?gi(a):(Da(e,0,Eo),t===void 0?t=i.rounding:Da(t,0,8),n=wt(new i(a),e+fr(a)+1,t),r=gi(n.abs(),!1,e+fr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Be.toInteger=Be.toint=function(){var e=this,t=e.constructor;return wt(new t(e),fr(e)+1,t.rounding)};Be.toNumber=function(){return+this};Be.toPower=Be.pow=function(e){var t,r,n,a,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(On);if(l=new c(l),!l.s){if(e.s<1)throw Error(na+"Infinity");return l}if(l.eq(On))return l;if(n=c.precision,e.eq(On))return wt(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=tT){for(a=new c(On),t=Math.ceil(n/St+4),Ot=!1;r%2&&(a=a.times(l),dw(a.d,t)),r=So(r/2),r!==0;)l=l.times(l),dw(l.d,t);return Ot=!0,e.s<0?new c(On).div(a):wt(a,n)}}else if(i<0)throw Error(na+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Ot=!1,a=e.times(Tl(l,n+d)),Ot=!0,a=nT(a),a.s=i,a};Be.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=fr(a),n=gi(a,r<=i.toExpNeg||r>=i.toExpPos)):(Da(e,1,Eo),t===void 0?t=i.rounding:Da(t,0,8),a=wt(new i(a),e,t),r=fr(a),n=gi(a,e<=r||r<=i.toExpNeg,e)),n};Be.toSignificantDigits=Be.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Da(e,1,Eo),t===void 0?t=n.rounding:Da(t,0,8)),wt(new n(r),e,t)};Be.toString=Be.valueOf=Be.val=Be.toJSON=Be[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=fr(e),r=e.constructor;return gi(e,t<=r.toExpNeg||t>=r.toExpPos)};function rT(e,t){var r,n,a,i,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ot?wt(t,f):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(f/St),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/jr|0,c[i]%=jr;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,Ot?wt(t,f):t}function Da(e,t,r){if(e!==~~e||e<t||e>r)throw Error(si+e)}function Aa(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=St-n.length,r&&(i+=gs(r)),i+=n;o=e[t],n=o+"",r=St-n.length,r&&(i+=gs(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Ha=(function(){function e(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%jr|0,o=i/jr|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*jr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,d,u,f,m,h,p,x,g,y,w,b,j,N,E,S,T,k=n.constructor,I=n.s==a.s?1:-1,C=n.d,A=a.d;if(!n.s)return new k(n);if(!a.s)throw Error(na+"Division by zero");for(c=n.e-a.e,S=A.length,N=C.length,h=new k(I),p=h.d=[],d=0;A[d]==(C[d]||0);)++d;if(A[d]>(C[d]||0)&&--c,i==null?w=i=k.precision:o?w=i+(fr(n)-fr(a))+1:w=i,w<0)return new k(0);if(w=w/St+2|0,d=0,S==1)for(u=0,A=A[0],w++;(d<N||u)&&w--;d++)b=u*jr+(C[d]||0),p[d]=b/A|0,u=b%A|0;else{for(u=jr/(A[0]+1)|0,u>1&&(A=e(A,u),C=e(C,u),S=A.length,N=C.length),j=S,x=C.slice(0,S),g=x.length;g<S;)x[g++]=0;T=A.slice(),T.unshift(0),E=A[0],A[1]>=jr/2&&++E;do u=0,l=t(A,x,S,g),l<0?(y=x[0],S!=g&&(y=y*jr+(x[1]||0)),u=y/E|0,u>1?(u>=jr&&(u=jr-1),f=e(A,u),m=f.length,g=x.length,l=t(f,x,m,g),l==1&&(u--,r(f,S<m?T:A,m))):(u==0&&(l=u=1),f=A.slice()),m=f.length,m<g&&f.unshift(0),r(x,f,g),l==-1&&(g=x.length,l=t(A,x,S,g),l<1&&(u++,r(x,S<g?T:A,g))),g=x.length):l===0&&(u++,x=[0]),p[d++]=u,l&&x[0]?x[g++]=C[j]||0:(x=[C[j]],g=1);while((j++<N||x[0]!==void 0)&&w--)}return p[0]||p.shift(),h.e=c,wt(h,o?i+fr(h)+1:i)}})();function nT(e,t){var r,n,a,i,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(fr(e)>16)throw Error(sg+fr(e));if(!e.s)return new u(On);for(Ot=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(qs(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(On),u.precision=l;;){if(a=wt(a.times(e),l),r=r.times(++c),o=i.plus(Ha(a,r,l)),Aa(o.d).slice(0,l)===Aa(i.d).slice(0,l)){for(;d--;)i=wt(i.times(i),l);return u.precision=f,t==null?(Ot=!0,wt(i,f)):i}i=o}}function fr(e){for(var t=e.e*St,r=e.d[0];r>=10;r/=10)t++;return t}function D0(e,t,r){if(t>e.LN10.sd())throw Ot=!0,r&&(e.precision=r),Error(na+"LN10 precision limit exceeded");return wt(new e(e.LN10),t)}function gs(e){for(var t="";e--;)t+="0";return t}function Tl(e,t){var r,n,a,i,o,l,c,d,u,f=1,m=10,h=e,p=h.d,x=h.constructor,g=x.precision;if(h.s<1)throw Error(na+(h.s?"NaN":"-Infinity"));if(h.eq(On))return new x(0);if(t==null?(Ot=!1,d=g):d=t,h.eq(10))return t==null&&(Ot=!0),D0(x,d);if(d+=m,x.precision=d,r=Aa(p),n=r.charAt(0),i=fr(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=Aa(h.d),n=r.charAt(0),f++;i=fr(h),n>1?(h=new x("0."+r),i++):h=new x(n+"."+r.slice(1))}else return c=D0(x,d+2,g).times(i+""),h=Tl(new x(n+"."+r.slice(1)),d-m).plus(c),x.precision=g,t==null?(Ot=!0,wt(h,g)):h;for(l=o=h=Ha(h.minus(On),h.plus(On),d),u=wt(h.times(h),d),a=3;;){if(o=wt(o.times(u),d),c=l.plus(Ha(o,new x(a),d)),Aa(c.d).slice(0,d)===Aa(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(D0(x,d+2,g).times(i+""))),l=Ha(l,new x(f),d),x.precision=g,t==null?(Ot=!0,wt(l,g)):l;l=c,a+=2}}function cw(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=So(r/St),e.d=[],n=(r+1)%St,r<0&&(n+=St),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=St;n<a;)e.d.push(+t.slice(n,n+=St));t=t.slice(n),n=St-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Ot&&(e.e>Ld||e.e<-Ld))throw Error(sg+r)}else e.s=0,e.e=0,e.d=[0];return e}function wt(e,t,r){var n,a,i,o,l,c,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=St,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/St),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;n%=St,a=n-St+o}if(r!==void 0&&(i=qs(10,o-a-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/qs(10,o-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=fr(e),f.length=1,t=t-i-1,f[0]=qs(10,(St-t%St)%St),e.e=So(-t/St)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=qs(10,St-n),f[u]=a>0?(d/qs(10,o-a)%qs(10,a)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==jr&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=jr)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(Ot&&(e.e>Ld||e.e<-Ld))throw Error(sg+fr(e));return e}function aT(e,t){var r,n,a,i,o,l,c,d,u,f,m=e.constructor,h=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),Ot?wt(t,h):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(h/St),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=jr-1;--c[i],c[a]+=jr}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Ot?wt(t,h):t):new m(0)}function gi(e,t,r){var n,a=fr(e),i=Aa(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+gs(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+gs(-a-1)+i,r&&(n=r-o)>0&&(i+=gs(n))):a>=o?(i+=gs(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+gs(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=gs(n))),e.s<0?"-"+i:i}function dw(e,t){if(e.length>t)return e.length=t,!0}function sT(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(si+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return cw(o,i.toString())}else if(typeof i!="string")throw Error(si+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,pB.test(i))cw(o,i);else throw Error(si+i)}if(a.prototype=Be,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=sT,a.config=a.set=xB,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function xB(e){if(!e||typeof e!="object")throw Error(na+"Object expected");var t,r,n,a=["precision",1,Eo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(So(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(si+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(si+r+": "+n);return this}var ig=sT(hB);On=new ig(1);const gt=ig;var gB=e=>e,iT={},oT=e=>e===iT,uw=e=>function t(){return arguments.length===0||arguments.length===1&&oT(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},lT=(e,t)=>e===1?t:uw(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(o=>o!==iT).length;return i>=e?t(...n):lT(e-i,uw(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=n.map(u=>oT(u)?l.shift():u);return t(...d,...l)}))}),$u=e=>lT(e.length,e),xp=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},vB=$u((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),yB=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return gB;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}},gp=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),cT=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=a,r=e(...a)),r}};function dT(e){var t;return e===0?t=1:t=Math.floor(new gt(e).abs().log(10).toNumber())+1,t}function uT(e,t,r){for(var n=new gt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}$u((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});$u((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});$u((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var fT=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},mT=(e,t,r)=>{if(e.lte(0))return new gt(0);var n=dT(e.toNumber()),a=new gt(10).pow(n),i=e.div(a),o=n!==1?.05:.1,l=new gt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?new gt(c.toNumber()):new gt(Math.ceil(c.toNumber()))},bB=(e,t,r)=>{var n=new gt(1),a=new gt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new gt(10).pow(dT(e)-1),a=new gt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new gt(Math.floor(e)))}else e===0?a=new gt(Math.floor((t-1)/2)):r||(a=new gt(Math.floor(e)));var o=Math.floor((t-1)/2),l=yB(vB(c=>a.add(new gt(c-o).mul(n)).toNumber()),xp);return l(0,t)},hT=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new gt(0),tickMin:new gt(0),tickMax:new gt(0)};var o=mT(new gt(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new gt(0):(l=new gt(t).add(r).div(2),l=l.sub(new gt(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new gt(r).sub(l).div(o).toNumber()),u=c+d+1;return u>n?hT(t,r,n,a,i+1):(u<n&&(d=r>0?d+(n-u):d,c=r>0?c:c+(n-u)),{step:o,tickMin:l.sub(new gt(c).mul(o)),tickMax:l.add(new gt(d).mul(o))})};function wB(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[o,l]=fT([t,r]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...xp(0,n-1).map(()=>1/0)]:[...xp(0,n-1).map(()=>-1/0),l];return t>r?gp(c):c}if(o===l)return bB(o,n,a);var{step:d,tickMin:u,tickMax:f}=hT(o,l,i,a,0),m=uT(u,f.add(new gt(.1).mul(d)),d);return t>r?gp(m):m}function jB(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=fT([r,n]);if(i===-1/0||o===1/0)return[r,n];if(i===o)return[i];var l=Math.max(t,2),c=mT(new gt(o).sub(i).div(l-1),a,0),d=[...uT(new gt(i),new gt(o),c),o];return a===!1&&(d=d.map(u=>Math.round(u))),r>n?gp(d):d}var NB=cT(wB),EB=cT(jB),pT=e=>e.rootProps.maxBarSize,SB=e=>e.rootProps.barGap,xT=e=>e.rootProps.barCategoryGap,TB=e=>e.rootProps.barSize,lc=e=>e.rootProps.stackOffset,og=e=>e.options.chartName,lg=e=>e.rootProps.syncId,gT=e=>e.rootProps.syncMethod,cg=e=>e.options.eventEmitter,Ma={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},An={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},zu=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},_B={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ma.angleAxisId,includeHidden:!1,name:void 0,reversed:Ma.reversed,scale:Ma.scale,tick:Ma.tick,tickCount:void 0,ticks:void 0,type:Ma.type,unit:void 0},AB={allowDataOverflow:An.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:An.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:An.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:An.scale,tick:An.tick,tickCount:An.tickCount,ticks:void 0,type:An.type,unit:void 0},kB={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ma.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ma.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ma.scale,tick:Ma.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},CB={allowDataOverflow:An.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:An.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:An.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:An.scale,tick:An.tick,tickCount:An.tickCount,ticks:void 0,type:"category",unit:void 0},dg=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?kB:_B,ug=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?CB:AB,Uu=e=>e.polarOptions,fg=fe([as,ss,yr],QE),vT=fe([Uu,fg],(e,t)=>{if(e!=null)return Xr(e.innerRadius,t,0)}),yT=fe([Uu,fg],(e,t)=>{if(e!=null)return Xr(e.outerRadius,t,t*.8)}),OB=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},bT=fe([Uu],OB);fe([dg,bT],zu);var wT=fe([fg,vT,yT],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});fe([ug,wT],zu);var jT=fe([at,Uu,vT,yT,as,ss],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:Xr(o,a,a/2),cy:Xr(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:d,clockWise:!1}}}),Pt=(e,t)=>t,cc=(e,t,r)=>r;function Wu(e){return e?.id}var wr=e=>{var t=at(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},To=e=>e.tooltip.settings.axisId,kr=e=>{var t=wr(e),r=To(e);return dc(e,t,r)},NT=fe([kr],e=>e?.dataKey);function ET(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:n;if(!(d==null||d.length===0)){var u=Wu(l);d.forEach((f,m)=>{var h=i==null||a?m:String(Nt(f,i,null)),p=Nt(f,l.dataKey,0),x;o.has(h)?x=o.get(h):x={},Object.assign(x,{[u]:p}),o.set(h,x)})}}),Array.from(o.values())}function Hu(e){return e.stackId!=null&&e.dataKey!=null}function fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fw(Object(r),!0).forEach(function(n){PB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PB(e,t,r){return(t=DB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DB(e){var t=IB(e,"string");return typeof t=="symbol"?t:t+""}function IB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vp=[0,"auto"],Sn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},ST=(e,t)=>e.cartesianAxis.xAxis[t],os=(e,t)=>{var r=ST(e,t);return r??Sn},Tn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:vp,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:tc},TT=(e,t)=>e.cartesianAxis.yAxis[t],ls=(e,t)=>{var r=TT(e,t);return r??Tn},RB={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},mg=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??RB},rr=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);case"zAxis":return mg(e,r);case"angleAxis":return dg(e,r);case"radiusAxis":return ug(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},FB=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},dc=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);case"angleAxis":return dg(e,r);case"radiusAxis":return ug(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},_T=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function hg(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Vu=e=>e.graphicalItems.cartesianItems,MB=fe([Pt,cc],hg),pg=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),uc=fe([Vu,rr,MB],pg),AT=fe([uc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Hu)),kT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),CT=fe([uc],kT),xg=e=>e.map(t=>t.data).filter(Boolean).flat(1),LB=fe([uc],xg),gg=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},vg=fe([LB,Bu],gg),yg=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Nt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Nt(a,n)}))):e.map(n=>({value:n})),Gu=fe([vg,rr,uc],yg);function OT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function ki(e){return e.filter(t=>Pa(t)||t instanceof Date).map(Number).filter(t=>jn(t)===!1)}function BB(e,t,r){return!r||typeof t!="number"||jn(t)?[]:r.length?ki(r.flatMap(n=>{var a=Nt(e,n.dataKey),i,o;if(Array.isArray(a)?[i,o]=a:i=o=a,!(!Mr(i)||!Mr(o)))return[t-i,t+o]})):[]}var $B=fe([AT,Bu,kr],ET),PT=(e,t,r)=>{var n={},a=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[o,l]=i,c=l.map(Wu);return[o,{stackedData:VR(e,c,r),graphicalItems:l}]}))},_l=fe([$B,AT,lc],PT),DT=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=YR(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},zB=fe([_l,Ls,Pt],DT),IT=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(o=>{var l,c,d=(l=n[o.id])===null||l===void 0?void 0:l.filter(f=>OT(a,f)),u=Nt(i,(c=t.dataKey)!==null&&c!==void 0?c:o.dataKey);return{value:u,errorDomain:BB(i,u,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:Nt(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),qu=e=>e.errorBars,RT=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>OT(r,n));fe([CT,qu,Pt],RT);var UB=fe([vg,rr,CT,qu,Pt],IT);function WB(e){var{value:t}=e;if(Pa(t)||t instanceof Date)return t}var mw=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=ki(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},HB=(e,t,r)=>{var n=e.map(WB).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&GN(n))?bS(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},bg=e=>{var t;if(e==null||!("domain"in e))return vp;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=ki(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:vp},$d=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},FT=e=>e.referenceElements.dots,_o=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),VB=fe([FT,Pt,cc],_o),MT=e=>e.referenceElements.areas,GB=fe([MT,Pt,cc],_o),LT=e=>e.referenceElements.lines,qB=fe([LT,Pt,cc],_o),BT=(e,t)=>{var r=ki(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},KB=fe(VB,Pt,BT),$T=(e,t)=>{var r=ki(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},YB=fe([GB,Pt],$T),zT=(e,t)=>{var r=ki(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},XB=fe(qB,Pt,zT),ZB=fe(KB,XB,YB,(e,t,r)=>$d(e,r,t)),UT=fe([rr],bg),wg=(e,t,r,n,a,i,o)=>{var l=fB(t,e.allowDataOverflow);if(l!=null)return l;var c=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",d=c?$d(r,a,mw(n)):$d(a,mw(n));return mB(t,d,e.allowDataOverflow)},JB=fe([rr,UT,zB,UB,ZB,at,Pt],wg),QB=[0,1],jg=(e,t,r,n,a,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=ns(t,i);return d&&l==null?bS(0,r.length):c==="category"?HB(n,e,d):a==="expand"?QB:o}},Ng=fe([rr,at,vg,Gu,lc,Pt,JB],jg),WT=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Zl(i));return l in Jo?l:"point"}}},Ao=fe([rr,at,_T,og,Pt],WT);function e9(e){if(e!=null){if(e in Jo)return Jo[e]();var t="scale".concat(Zl(e));if(t in Jo)return Jo[t]()}}function Eg(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=e9(t);if(a!=null){var i=a.domain(r).range(n);return $R(i),i}}}var Sg=(e,t,r)=>{var n=bg(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&fo(e))return NB(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&fo(e))return EB(e,t.tickCount,t.allowDecimals)}},Tg=fe([Ng,dc,Ao],Sg),_g=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&fo(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],o=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(o,l)]}return t},t9=fe([rr,Ng,Tg,Pt],_g),r9=fe(Gu,rr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(ki(e.map(l=>l.value))).sort((l,c)=>l-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var o=n[i+1]-n[i];r=Math.min(r,o)}return r/a}}),HT=fe(r9,at,xT,yr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Mr(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var o=Xr(r,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),n9=(e,t)=>{var r=os(e,t);return r==null||typeof r.padding!="string"?0:HT(e,"xAxis",t,r.padding)},a9=(e,t)=>{var r=ls(e,t);return r==null||typeof r.padding!="string"?0:HT(e,"yAxis",t,r.padding)},s9=fe(os,n9,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),i9=fe(ls,a9,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),o9=fe([yr,s9,Ou,Cu,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),l9=fe([yr,at,i9,Ou,Cu,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:o}=a;return i?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),fc=(e,t,r,n)=>{var a;switch(t){case"xAxis":return o9(e,r,n);case"yAxis":return l9(e,r,n);case"zAxis":return(a=mg(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return bT(e);case"radiusAxis":return wT(e,r);default:return}},VT=fe([rr,fc],zu),ko=fe([rr,Ao,t9,VT],Eg);fe([uc,qu,Pt],RT);function GT(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Ku=(e,t)=>t,Yu=(e,t,r)=>r,c9=fe(Au,Ku,Yu,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(GT)),d9=fe(ku,Ku,Yu,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(GT)),qT=(e,t)=>({width:e.width,height:t.height}),u9=(e,t)=>{var r=typeof t.width=="number"?t.width:tc;return{width:r,height:e.height}},KT=fe(yr,os,qT),f9=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},m9=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},h9=fe(ss,yr,c9,Ku,Yu,(e,t,r,n,a)=>{var i={},o;return r.forEach(l=>{var c=qT(t,l);o==null&&(o=f9(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),i}),p9=fe(as,yr,d9,Ku,Yu,(e,t,r,n,a)=>{var i={},o;return r.forEach(l=>{var c=u9(t,l);o==null&&(o=m9(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),i}),x9=(e,t)=>{var r=os(e,t);if(r!=null)return h9(e,r.orientation,r.mirror)},g9=fe([yr,os,x9,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),v9=(e,t)=>{var r=ls(e,t);if(r!=null)return p9(e,r.orientation,r.mirror)},y9=fe([yr,ls,v9,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),YT=fe(yr,ls,(e,t)=>{var r=typeof t.width=="number"?t.width:tc;return{width:r,height:e.height}}),hw=(e,t,r)=>{switch(t){case"xAxis":return KT(e,r).width;case"yAxis":return YT(e,r).height;default:return}},XT=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:o}=r,l=ns(e,n),c=t.map(d=>d.value);if(o&&l&&i==="category"&&a&&GN(c))return c}},Ag=fe([at,Gu,rr,Pt],XT),ZT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,o=ns(e,n);if(o&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},kg=fe([at,Gu,dc,Pt],ZT),pw=fe([at,FB,Ao,ko,Ag,kg,fc,Tg,Pt],(e,t,r,n,a,i,o,l,c)=>{if(t==null)return null;var d=ns(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:n}}),b9=(e,t,r,n,a,i,o,l,c)=>{if(!(t==null||n==null)){var d=ns(e,c),{type:u,ticks:f,tickCount:m}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,p=u==="category"&&n.bandwidth?n.bandwidth()/h:0;p=c==="angleAxis"&&i!=null&&i.length>=2?Sr(i[0]-i[1])*2*p:p;var x=f||a;if(x){var g=x.map((y,w)=>{var b=o?o.indexOf(y):y;return{index:w,coordinate:n(b)+p,value:y,offset:p}});return g.filter(y=>!jn(y.coordinate))}return d&&l?l.map((y,w)=>({coordinate:n(y)+p,value:y,index:w,offset:p})):n.ticks?n.ticks(m).map(y=>({coordinate:n(y)+p,value:y,offset:p})):n.domain().map((y,w)=>({coordinate:n(y)+p,value:o?o[y]:y,index:w,offset:p}))}},JT=fe([at,dc,Ao,ko,Tg,fc,Ag,kg,Pt],b9),w9=(e,t,r,n,a,i,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=ns(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&n?.length>=2?Sr(n[0]-n[1])*2*d:d,l&&i?i.map((u,f)=>({coordinate:r(u)+d,value:u,index:f,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,f)=>({coordinate:r(u)+d,value:a?a[u]:u,index:f,offset:d}))}},Ss=fe([at,dc,ko,fc,Ag,kg,Pt],w9),Ts=fe(rr,ko,(e,t)=>{if(!(e==null||t==null))return Bd(Bd({},e),{},{scale:t})}),j9=fe([rr,Ao,Ng,VT],Eg);fe((e,t,r)=>mg(e,r),j9,(e,t)=>{if(!(e==null||t==null))return Bd(Bd({},e),{},{scale:t})});var N9=fe([at,Au,ku],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),QT=e=>e.options.defaultTooltipEventType,e_=e=>e.options.validateTooltipEventTypes;function t_(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Cg(e,t){var r=QT(e),n=e_(e);return t_(t,r,n)}function E9(e){return ze(t=>Cg(t,e))}var r_=(e,t)=>{var r,n=Number(t);if(!(jn(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},S9=e=>e.tooltip.settings,ys={active:!1,index:null,dataKey:void 0,coordinate:void 0},T9={itemInteraction:{click:ys,hover:ys},axisInteraction:{click:ys,hover:ys},keyboardInteraction:ys,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},n_=$n({name:"tooltip",initialState:T9,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Wa(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:_9,removeTooltipEntrySettings:A9,setTooltipSettingsState:k9,setActiveMouseOverItemIndex:a_,mouseLeaveItem:C9,mouseLeaveChart:s_,setActiveClickItemIndex:O9,setMouseOverAxisIndex:i_,setMouseClickAxisIndex:P9,setSyncInteraction:yp,setKeyboardInteraction:bp}=n_.actions,D9=n_.reducer;function xw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xw(Object(r),!0).forEach(function(n){I9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I9(e,t,r){return(t=R9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R9(e){var t=F9(e,"string");return typeof t=="symbol"?t:t+""}function F9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M9(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function L9(e){return e.index!=null}var o_=(e,t,r,n)=>{if(t==null)return ys;var a=M9(e,t,r);if(a==null)return ys;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(L9(a)){if(i)return Hc(Hc({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Hc(Hc({},ys),{},{coordinate:a.coordinate})},Og=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Mr(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},l_=(e,t,r,n,a,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,i);if(d!=null)return d;var u=a?.[Number(i)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},c_=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===a})},mc=e=>e.options.tooltipPayloadSearcher,Co=e=>e.tooltip;function gw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gw(Object(r),!0).forEach(function(n){B9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B9(e,t,r){return(t=$9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $9(e){var t=z9(e,"string");return typeof t=="symbol"?t:t+""}function z9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U9(e,t){return e??t}var d_=(e,t,r,n,a,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,f=[];return e.reduce((m,h)=>{var p,{dataDefinedOnItem:x,settings:g}=h,y=U9(x,l),w=Array.isArray(y)?eS(y,d,u):y,b=(p=g?.dataKey)!==null&&p!==void 0?p:n,j=g?.nameKey,N;if(n&&Array.isArray(w)&&!Array.isArray(w[0])&&o==="axis"?N=qN(w,n,a):N=i(w,t,c,j),Array.isArray(N))N.forEach(S=>{var T=vw(vw({},g),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});m.push(eb({tooltipEntrySettings:T,dataKey:S.dataKey,payload:S.payload,value:Nt(S.payload,S.dataKey),name:S.name}))});else{var E;m.push(eb({tooltipEntrySettings:g,dataKey:b,payload:N,value:Nt(N,b),name:(E=Nt(N,j))!==null&&E!==void 0?E:g?.name}))}return m},f)}},Pg=fe([kr,at,_T,og,wr],WT),W9=fe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),H9=fe([wr,To],hg),hc=fe([W9,kr,H9],pg),V9=fe([hc],e=>e.filter(Hu)),G9=fe([hc],xg),Oo=fe([G9,Ls],gg),q9=fe([V9,Ls,kr],ET),Dg=fe([Oo,kr,hc],yg),K9=fe([kr],bg),Y9=fe([hc],e=>e.filter(Hu)),X9=fe([q9,Y9,lc],PT),Z9=fe([X9,Ls,wr],DT),J9=fe([hc],kT),Q9=fe([Oo,kr,J9,qu,wr],IT),e$=fe([FT,wr,To],_o),t$=fe([e$,wr],BT),r$=fe([MT,wr,To],_o),n$=fe([r$,wr],$T),a$=fe([LT,wr,To],_o),s$=fe([a$,wr],zT),i$=fe([t$,s$,n$],$d),o$=fe([kr,K9,Z9,Q9,i$,at,wr],wg),u_=fe([kr,at,Oo,Dg,lc,wr,o$],jg),l$=fe([u_,kr,Pg],Sg),c$=fe([kr,u_,l$,wr],_g),f_=e=>{var t=wr(e),r=To(e),n=!1;return fc(e,t,r,n)},m_=fe([kr,f_],zu),h_=fe([kr,Pg,c$,m_],Eg),d$=fe([at,Dg,kr,wr],XT),u$=fe([at,Dg,kr,wr],ZT),f$=(e,t,r,n,a,i,o,l)=>{if(t){var{type:c}=t,d=ns(e,l);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return f=l==="angleAxis"&&a!=null&&a?.length>=2?Sr(a[0]-a[1])*2*f:f,d&&o?o.map((m,h)=>({coordinate:n(m)+f,value:m,index:h,offset:f})):n.domain().map((m,h)=>({coordinate:n(m)+f,value:i?i[m]:m,index:h,offset:f}))}}},cs=fe([at,kr,Pg,h_,f_,d$,u$,wr],f$),Ig=fe([QT,e_,S9],(e,t,r)=>t_(r.shared,e,t)),p_=e=>e.tooltip.settings.trigger,Rg=e=>e.tooltip.settings.defaultIndex,Xu=fe([Co,Ig,p_,Rg],o_),_s=fe([Xu,Oo],Og),x_=fe([cs,_s],r_),g_=fe([Xu],e=>{if(e)return e.dataKey}),v_=fe([Co,Ig,p_,Rg],c_),m$=fe([as,ss,at,yr,cs,Rg,v_,mc],l_),h$=fe([Xu,m$],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),p$=fe([Xu],e=>e.active),x$=fe([v_,_s,Ls,NT,x_,mc,Ig],d_),g$=fe([x$],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yw(Object(r),!0).forEach(function(n){v$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v$(e,t,r){return(t=y$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y$(e){var t=b$(e,"string");return typeof t=="symbol"?t:t+""}function b$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w$=()=>ze(kr),j$=()=>{var e=w$(),t=ze(cs),r=ze(h_);return bl(bw(bw({},e),{},{scale:r}),t)},y_=()=>ze(og),Fg=(e,t)=>t,b_=(e,t,r)=>r,Mg=(e,t,r,n)=>n,N$=fe(cs,e=>ju(e,t=>t.coordinate)),Lg=fe([Co,Fg,b_,Mg],o_),w_=fe([Lg,Oo],Og),E$=(e,t,r)=>{if(t!=null){var n=Co(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},j_=fe([Co,Fg,b_,Mg],c_),zd=fe([as,ss,at,yr,cs,Mg,j_,mc],l_),S$=fe([Lg,zd],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),N_=fe(cs,w_,r_),T$=fe([j_,w_,Ls,NT,N_,mc,Fg],d_),_$=fe([Lg],e=>({isActive:e.active,activeIndex:e.index})),A$=(e,t,r,n,a,i,o,l)=>{if(!(!e||!t||!n||!a||!i)){var c=XR(e.chartX,e.chartY,t,r,l);if(c){var d=JR(c,t),u=LR(d,o,i,n,a),f=ZR(t,i,u,c);return{activeIndex:String(u),activeCoordinate:f}}}};function wp(){return wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wp.apply(null,arguments)}function ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ww(Object(r),!0).forEach(function(n){k$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k$(e,t,r){return(t=C$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C$(e){var t=O$(e,"string");return typeof t=="symbol"?t:t+""}function O$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P$(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:o,cursor:l,tooltipEventType:c,chartName:d}=e,u=t,f=r,m=n;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var h,p;if(d==="ScatterChart")h=u,p=JF;else if(d==="BarChart")h=QF(o,u,a,i),p=xS;else if(o==="radial"){var{cx:x,cy:g,radius:y,startAngle:w,endAngle:b}=gS(u);h={cx:x,cy:g,startAngle:w,endAngle:b,innerRadius:y,outerRadius:y},p=yS}else h={points:PM(o,u,a)},p=rl;var j=typeof l=="object"&&"className"in l?l.className:void 0,N=Vc(Vc(Vc(Vc({stroke:"#ccc",pointerEvents:"none"},a),h),Kt(l,!1)),{},{payload:f,payloadIndex:m,className:tt("recharts-tooltip-cursor",j)});return v.isValidElement(l)?v.cloneElement(l,N):v.createElement(p,N)}function D$(e){var t=j$(),r=oS(),n=Pu(),a=y_();return v.createElement(P$,wp({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var E_=v.createContext(null),I$=()=>v.useContext(E_),I0={exports:{}},jw;function R$(){return jw||(jw=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new a(u,f||c,m),p=r?r+d:d;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,h=f.length,p=new Array(h);m<h;m++)p[m]=f[m].fn;return p},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,m,h,p){var x=r?r+d:d;if(!this._events[x])return!1;var g=this._events[x],y=arguments.length,w,b;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,m),!0;case 5:return g.fn.call(g.context,u,f,m,h),!0;case 6:return g.fn.call(g.context,u,f,m,h,p),!0}for(b=1,w=new Array(y-1);b<y;b++)w[b-1]=arguments[b];g.fn.apply(g.context,w)}else{var j=g.length,N;for(b=0;b<j;b++)switch(g[b].once&&this.removeListener(d,g[b].fn,void 0,!0),y){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,u);break;case 3:g[b].fn.call(g[b].context,u,f);break;case 4:g[b].fn.call(g[b].context,u,f,m);break;default:if(!w)for(N=1,w=new Array(y-1);N<y;N++)w[N-1]=arguments[N];g[b].fn.apply(g[b].context,w)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,m){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!m||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var x=0,g=[],y=p.length;x<y;x++)(p[x].fn!==u||m&&!p[x].once||f&&p[x].context!==f)&&g.push(p[x]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(I0)),I0.exports}var F$=R$();const M$=Is(F$);var Al=new M$,jp="recharts.syncEvent.tooltip",Nw="recharts.syncEvent.brush";function Bg(e,t){if(t){var r=Number.parseInt(t,10);if(!jn(r))return e?.[r]}}var L$={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},S_=$n({name:"options",initialState:L$,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),B$=S_.reducer,{createEventEmitter:$$}=S_.actions;function z$(e){return e.tooltip.syncInteraction}var U$={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},T_=$n({name:"chartData",initialState:U$,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Ew,setDataStartEndIndexes:W$,setComputedData:Cle}=T_.actions,H$=T_.reducer,V$=["x","y"];function Sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sw(Object(r),!0).forEach(function(n){G$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G$(e,t,r){return(t=q$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q$(e){var t=K$(e,"string");return typeof t=="symbol"?t:t+""}function K$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y$(e,t){if(e==null)return{};var r,n,a=X$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function X$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var __=()=>{};function Z$(){var e=ze(lg),t=ze(cg),r=Ut(),n=ze(gT),a=ze(cs),i=Pu(),o=Ox(),l=ze(c=>c.rootProps.className);v.useEffect(()=>{if(e==null)return __;var c=(d,u,f)=>{if(t!==f&&e===d){if(n==="index"){var m;if(o&&u!==null&&u!==void 0&&(m=u.payload)!==null&&m!==void 0&&m.coordinate){var h=u.payload.coordinate,{x:p,y:x}=h,g=Y$(h,V$),y=Hs(Hs(Hs({},g),typeof p=="number"&&{x:Math.max(o.x,Math.min(p,o.x+o.width))}),typeof x=="number"&&{y:Math.max(o.y,Math.min(x,o.y+o.height))}),w=Hs(Hs({},u),{},{payload:Hs(Hs({},u.payload),{},{coordinate:y})});r(w)}else r(u);return}if(a!=null){var b;if(typeof n=="function"){var j={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},N=n(a,j);b=a[N]}else n==="value"&&(b=a.find(L=>String(L.value)===u.payload.label));var{coordinate:E}=u.payload;if(b==null||u.payload.active===!1||E==null||o==null){r(yp({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:S,y:T}=E,k=Math.min(S,o.x+o.width),I=Math.min(T,o.y+o.height),C={x:i==="horizontal"?b.coordinate:k,y:i==="horizontal"?I:b.coordinate},A=yp({active:u.payload.active,coordinate:C,dataKey:u.payload.dataKey,index:String(b.index),label:u.payload.label});r(A)}}};return Al.on(jp,c),()=>{Al.off(jp,c)}},[l,r,t,e,n,a,i,o])}function J$(){var e=ze(lg),t=ze(cg),r=Ut();v.useEffect(()=>{if(e==null)return __;var n=(a,i,o)=>{t!==o&&e===a&&r(W$(i))};return Al.on(Nw,n),()=>{Al.off(Nw,n)}},[r,t,e])}function Q$(){var e=Ut();v.useEffect(()=>{e($$())},[e]),Z$(),J$()}function ez(e,t,r,n,a,i){var o=ze(m=>E$(m,e,t)),l=ze(cg),c=ze(lg),d=ze(gT),u=ze(z$),f=u?.active;v.useEffect(()=>{if(!f&&c!=null&&l!=null){var m=yp({active:i,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n});Al.emit(jp,c,m,l)}},[f,r,o,a,n,l,c,d,i])}function Tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tw(Object(r),!0).forEach(function(n){tz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tz(e,t,r){return(t=rz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rz(e){var t=nz(e,"string");return typeof t=="symbol"?t:t+""}function nz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function az(e){return e.dataKey}function sz(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(CF,t)}var Aw=[],iz={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Rs.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function R0(e){var t=Br(e,iz),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:o,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:f,reverseDirection:m,useTranslate3d:h,wrapperStyle:p,cursor:x,shared:g,trigger:y,defaultIndex:w,portal:b,axisId:j}=t,N=Ut(),E=typeof w=="number"?String(w):w;v.useEffect(()=>{N(k9({shared:g,trigger:y,axisId:j,active:r,defaultIndex:E}))},[N,g,y,j,r,E]);var S=Ox(),T=uS(),k=E9(g),{activeIndex:I,isActive:C}=ze(P=>_$(P,k,y,E)),A=ze(P=>T$(P,k,y,E)),L=ze(P=>N_(P,k,y,E)),_=ze(P=>S$(P,k,y,E)),W=A,Y=I$(),Q=r??C,[J,U]=AE([W,Q]),ie=k==="axis"?L:void 0;ez(k,y,_,ie,I,Q);var re=b??Y;if(re==null)return null;var M=W??Aw;Q||(M=Aw),l&&M.length&&(M=NE(W.filter(P=>P.value!=null&&(P.hide!==!0||t.includeHidden)),u,az));var z=M.length>0,V=v.createElement(MF,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:Q,coordinate:_,hasPayload:z,offset:d,position:f,reverseDirection:m,useTranslate3d:h,viewBox:S,wrapperStyle:p,lastBoundingBox:J,innerRef:U,hasPortalFromProps:!!b},sz(o,_w(_w({},t),{},{payload:M,label:ie,active:Q,coordinate:_,accessibilityLayer:T})));return v.createElement(v.Fragment,null,Kp.createPortal(V,re),Q&&v.createElement(D$,{cursor:x,tooltipEventType:k,coordinate:_,payload:W,index:I}))}var F0={},M0={},L0={},kw;function oz(){return kw||(kw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{d&&u(),x()};let m=null;const h=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},n)},p=()=>{m!==null&&(clearTimeout(m),m=null)},x=()=>{p(),o=void 0,l=null},g=()=>{u()},y=function(...w){if(a?.aborted)return;o=this,l=w;const b=m==null;h(),c&&b&&u()};return y.schedule=h,y.cancel=x,y.flush=g,a?.addEventListener("abort",x,{once:!0}),y}e.debounce=t})(L0)),L0}var Cw;function lz(){return Cw||(Cw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oz();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,f=null;const m=t.debounce(function(...x){u=n.apply(this,x),f=null},a,{edges:d}),h=function(...x){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(u=n.apply(this,x),f=Date.now(),m.cancel(),m.schedule(),u):(m.apply(this,x),u)},p=()=>(m.flush(),u);return h.cancel=m.cancel,h.flush=p,h}e.debounce=r})(M0)),M0}var Ow;function cz(){return Ow||(Ow=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lz();function r(n,a=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:o,maxWait:a,trailing:l})}e.throttle=r})(F0)),F0}var B0,Pw;function dz(){return Pw||(Pw=1,B0=cz().throttle),B0}var uz=dz();const fz=Is(uz);var nl=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function Dw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dw(Object(r),!0).forEach(function(n){mz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mz(e,t,r){return(t=hz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hz(e){var t=pz(e,"string");return typeof t=="symbol"?t:t+""}function pz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z0=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:f,className:m,onResize:h,style:p={}}=e,x=v.useRef(null),g=v.useRef();g.current=h,v.useImperativeHandle(t,()=>x.current);var[y,w]=v.useState({containerWidth:n.width,containerHeight:n.height}),b=v.useCallback((N,E)=>{w(S=>{var T=Math.round(N),k=Math.round(E);return S.containerWidth===T&&S.containerHeight===k?S:{containerWidth:T,containerHeight:k}})},[]);v.useEffect(()=>{var N=k=>{var I,{width:C,height:A}=k[0].contentRect;b(C,A),(I=g.current)===null||I===void 0||I.call(g,C,A)};u>0&&(N=fz(N,u,{trailing:!0,leading:!1}));var E=new ResizeObserver(N),{width:S,height:T}=x.current.getBoundingClientRect();return b(S,T),E.observe(x.current),()=>{E.disconnect()}},[b,u]);var j=v.useMemo(()=>{var{containerWidth:N,containerHeight:E}=y;if(N<0||E<0)return null;nl(Xs(a)||Xs(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),nl(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=Xs(a)?N:a,T=Xs(i)?E:i;return r&&r>0&&(S?T=S/r:T&&(S=T*r),c&&T>c&&(T=c)),nl(S>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,T,a,i,o,l,r),v.Children.map(d,k=>v.cloneElement(k,{width:S,height:T,style:$0({width:S,height:T},k.props.style)}))},[r,d,i,c,l,o,y,a]);return v.createElement("div",{id:f?"".concat(f):void 0,className:tt("recharts-responsive-container",m),style:$0($0({},p),{},{width:a,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:x},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))}),Zu=e=>null;Zu.displayName="Cell";function xz(e,t,r){return(t=gz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gz(e){var t=vz(e,"string");return typeof t=="symbol"?t:t+""}function vz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class yz{constructor(t){xz(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Iw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iw(Object(r),!0).forEach(function(n){wz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wz(e,t,r){return(t=jz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jz(e){var t=Nz(e,"string");return typeof t=="symbol"?t:t+""}function Nz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ez={cacheSize:2e3,enableCache:!0},A_=bz({},Ez),Rw=new yz(A_.cacheSize),Sz={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Fw="recharts_measurement_span";function Tz(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(o,"|").concat(l)}var Mw=(e,t)=>{try{var r=document.getElementById(Fw);r||(r=document.createElement("span"),r.setAttribute("id",Fw),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Sz,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},al=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Rs.isSsr)return{width:0,height:0};if(!A_.enableCache)return Mw(t,r);var n=Tz(t,r),a=Rw.get(n);if(a)return a;var i=Mw(t,r);return Rw.set(n,i),i},Lw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Bw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_z=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Az=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,k_={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},kz=Object.keys(k_),Ui="NaN";function Cz(e,t){return e*k_[t]}class hn{static parse(t){var r,[,n,a]=(r=Az.exec(t))!==null&&r!==void 0?r:[];return new hn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,jn(t)&&(this.unit=""),r!==""&&!_z.test(r)&&(this.num=NaN,this.unit=""),kz.includes(r)&&(this.num=Cz(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new hn(NaN,""):new hn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new hn(NaN,""):new hn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new hn(NaN,""):new hn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new hn(NaN,""):new hn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return jn(this.num)}}function C_(e){if(e.includes(Ui))return Ui;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=Lw.exec(t))!==null&&r!==void 0?r:[],o=hn.parse(n??""),l=hn.parse(i??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Ui;t=t.replace(Lw,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,f,m]=(d=Bw.exec(t))!==null&&d!==void 0?d:[],h=hn.parse(u??""),p=hn.parse(m??""),x=f==="+"?h.add(p):h.subtract(p);if(x.isNaN())return Ui;t=t.replace(Bw,x.toString())}return t}var $w=/\(([^()]*)\)/;function Oz(e){for(var t=e,r;(r=$w.exec(t))!=null;){var[,n]=r;t=t.replace($w,C_(n))}return t}function Pz(e){var t=e.replace(/\s+/g,"");return t=Oz(t),t=C_(t),t}function Dz(e){try{return Pz(e)}catch{return Ui}}function U0(e){var t=Dz(e.slice(5,-1));return t===Ui?"":t}var Iz=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Rz=["dx","dy","angle","className","breakAll"];function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Np.apply(null,arguments)}function zw(e,t){if(e==null)return{};var r,n,a=Fz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Fz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var O_=/[ \f\n\r\t\v\u2028\u2029]+/,P_=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];$t(t)||(r?a=t.toString().split(""):a=t.toString().split(O_));var i=a.map(l=>({word:l,width:al(l,n).width})),o=r?0:al("",n).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},Mz=(e,t,r,n,a)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,d=$e(i),u=o,f=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return C.reduce((A,L)=>{var{word:_,width:W}=L,Y=A[A.length-1];if(Y&&(n==null||a||Y.width+W+r<Number(n)))Y.words.push(_),Y.width+=W+r;else{var Q={words:[_],width:W};A.push(Q)}return A},[])},m=f(t),h=I=>I.reduce((C,A)=>C.width>A.width?C:A);if(!d||a)return m;var p=m.length>i||h(m).width>Number(n);if(!p)return m;for(var x="",g=I=>{var C=u.slice(0,I),A=P_({breakAll:c,style:l,children:C+x}).wordsWithComputedWidth,L=f(A),_=L.length>i||h(L).width>Number(n);return[_,L]},y=0,w=u.length-1,b=0,j;y<=w&&b<=u.length-1;){var N=Math.floor((y+w)/2),E=N-1,[S,T]=g(E),[k]=g(N);if(!S&&!k&&(y=N+1),S&&k&&(w=N-1),!S&&k){j=T;break}b++}return j||m},Uw=e=>{var t=$t(e)?[]:e.toString().split(O_);return[{words:t}]},Lz=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:o}=e;if((t||r)&&!Rs.isSsr){var l,c,d=P_({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:f}=d;l=u,c=f}else return Uw(n);return Mz({breakAll:i,children:n,maxLines:o,style:a},l,c,t,r)}return Uw(n)},Ww="#808080",Ju=v.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=Ww}=e,u=zw(e,Iz),f=v.useMemo(()=>Lz({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:m,dy:h,angle:p,className:x,breakAll:g}=u,y=zw(u,Rz);if(!Pa(r)||!Pa(n)||f.length===0)return null;var w=r+($e(m)?m:0),b=n+($e(h)?h:0),j;switch(c){case"start":j=U0("calc(".concat(i,")"));break;case"middle":j=U0("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:j=U0("calc(".concat(f.length-1," * -").concat(a,")"));break}var N=[];if(o){var E=f[0].width,{width:S}=u;N.push("scale(".concat($e(S)?S/E:1,")"))}return p&&N.push("rotate(".concat(p,", ").concat(w,", ").concat(b,")")),N.length&&(y.transform=N.join(" ")),v.createElement("text",Np({},Kt(y,!0),{ref:t,x:w,y:b,className:tt("recharts-text",x),textAnchor:l,fill:d.includes("url")?Ww:d}),f.map((T,k)=>{var I=T.words.join(g?"":" ");return v.createElement("tspan",{x:w,dy:k===0?j:a,key:"".concat(I,"-").concat(k)},I)}))});Ju.displayName="Text";var Bz=["labelRef"];function $z(e,t){if(e==null)return{};var r,n,a=zz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Hw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hw(Object(r),!0).forEach(function(n){Uz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uz(e,t,r){return(t=Wz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wz(e){var t=Hz(e,"string");return typeof t=="symbol"?t:t+""}function Hz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function La(){return La=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},La.apply(null,arguments)}var D_=v.createContext(null),Vz=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,o=v.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return v.createElement(D_.Provider,{value:o},i)},I_=()=>{var e=v.useContext(D_),t=Ox();return e||t},Gz=v.createContext(null),qz=()=>{var e=v.useContext(Gz),t=ze(jT);return e||t},Kz=e=>{var{value:t,formatter:r}=e,n=$t(e.children)?t:e.children;return typeof r=="function"?r(n):n},$g=e=>e!=null&&typeof e=="function",Yz=(e,t)=>{var r=Sr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Xz=(e,t,r,n,a)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:f,endAngle:m,clockWise:h}=a,p=(d+u)/2,x=Yz(f,m),g=x>=0?1:-1,y,w;switch(t){case"insideStart":y=f+g*i,w=h;break;case"insideEnd":y=m-g*i,w=!h;break;case"end":y=m+g*i,w=h;break;default:throw new Error("Unsupported position ".concat(t))}w=x<=0?w:!w;var b=dr(l,c,p,y),j=dr(l,c,p,y+(w?1:-1)*359),N="M".concat(b.x,",").concat(b.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(w?0:1,`,
    `).concat(j.x,",").concat(j.y),E=$t(e.id)?gl("recharts-radial-line-"):e.id;return v.createElement("text",La({},n,{dominantBaseline:"central",className:tt("recharts-radial-bar-label",o)}),v.createElement("defs",null,v.createElement("path",{id:E,d:N})),v.createElement("textPath",{xlinkHref:"#".concat(E)},r))},Zz=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:f}=dr(n,a,o+t,d);return{x:u,y:f,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(i+o)/2,{x:h,y:p}=dr(n,a,m,d);return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"}},R_=e=>"cx"in e&&$e(e.cx),Jz=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!R_(r)&&(i=r);var{x:o,y:l,width:c,height:d}=t,u=d>=0?1:-1,f=u*n,m=u>0?"end":"start",h=u>0?"start":"end",p=c>=0?1:-1,x=p*n,g=p>0?"end":"start",y=p>0?"start":"end";if(a==="top"){var w={x:o+c/2,y:l-u*n,textAnchor:"middle",verticalAnchor:m};return Qt(Qt({},w),i?{height:Math.max(l-i.y,0),width:c}:{})}if(a==="bottom"){var b={x:o+c/2,y:l+d+f,textAnchor:"middle",verticalAnchor:h};return Qt(Qt({},b),i?{height:Math.max(i.y+i.height-(l+d),0),width:c}:{})}if(a==="left"){var j={x:o-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"};return Qt(Qt({},j),i?{width:Math.max(j.x-i.x,0),height:d}:{})}if(a==="right"){var N={x:o+c+x,y:l+d/2,textAnchor:y,verticalAnchor:"middle"};return Qt(Qt({},N),i?{width:Math.max(i.x+i.width-N.x,0),height:d}:{})}var E=i?{width:c,height:d}:{};return a==="insideLeft"?Qt({x:o+x,y:l+d/2,textAnchor:y,verticalAnchor:"middle"},E):a==="insideRight"?Qt({x:o+c-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"},E):a==="insideTop"?Qt({x:o+c/2,y:l+f,textAnchor:"middle",verticalAnchor:h},E):a==="insideBottom"?Qt({x:o+c/2,y:l+d-f,textAnchor:"middle",verticalAnchor:m},E):a==="insideTopLeft"?Qt({x:o+x,y:l+f,textAnchor:y,verticalAnchor:h},E):a==="insideTopRight"?Qt({x:o+c-x,y:l+f,textAnchor:g,verticalAnchor:h},E):a==="insideBottomLeft"?Qt({x:o+x,y:l+d-f,textAnchor:y,verticalAnchor:m},E):a==="insideBottomRight"?Qt({x:o+c-x,y:l+d-f,textAnchor:g,verticalAnchor:m},E):a&&typeof a=="object"&&($e(a.x)||Xs(a.x))&&($e(a.y)||Xs(a.y))?Qt({x:o+Xr(a.x,c),y:l+Xr(a.y,d),textAnchor:"end",verticalAnchor:"end"},E):Qt({x:o+c/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},E)},Qz={offset:5};function vs(e){var t=Br(e,Qz),{viewBox:r,position:n,value:a,children:i,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=qz(),f=I_(),m=n==="center"?f:u??f,h=r||m;if(!h||$t(a)&&$t(i)&&!v.isValidElement(o)&&typeof o!="function")return null;var p=Qt(Qt({},t),{},{viewBox:h});if(v.isValidElement(o)){var{labelRef:x}=p,g=$z(p,Bz);return v.cloneElement(o,g)}var y;if(typeof o=="function"){if(y=v.createElement(o,p),v.isValidElement(y))return y}else y=Kz(t);var w=R_(h),b=Kt(t,!0);if(w&&(n==="insideStart"||n==="insideEnd"||n==="end"))return Xz(t,n,y,b,h);var j=w?Zz(h,t.offset,t.position):Jz(t,h);return v.createElement(Ju,La({ref:d,className:tt("recharts-label",l)},b,j,{breakAll:c}),y)}vs.displayName="Label";var eU=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?v.createElement(vs,La({key:"label-implicit"},n)):Pa(e)?v.createElement(vs,La({key:"label-implicit",value:e},n)):v.isValidElement(e)?e.type===vs?v.cloneElement(e,Qt({key:"label-implicit"},n)):v.createElement(vs,La({key:"label-implicit",content:e},n)):$g(e)?v.createElement(vs,La({key:"label-implicit",content:e},n)):e&&typeof e=="object"?v.createElement(vs,La({},e,{key:"label-implicit"},n)):null};function tU(e){var{label:t}=e,r=I_();return eU(t,r)||null}var W0={},H0={},Vw;function rU(){return Vw||(Vw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(H0)),H0}var V0={},Gw;function nU(){return Gw||(Gw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(V0)),V0}var qw;function aU(){return qw||(qw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rU(),r=nU(),n=jx();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(W0)),W0}var G0,Kw;function sU(){return Kw||(Kw=1,G0=aU().last),G0}var iU=sU();const oU=Is(iU);var lU=["valueAccessor"],cU=["dataKey","clockWise","id","textBreakAll"];function Ud(){return Ud=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ud.apply(null,arguments)}function Yw(e,t){if(e==null)return{};var r,n,a=dU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uU=e=>Array.isArray(e.value)?oU(e.value):e.value,F_=v.createContext(void 0),M_=F_.Provider,L_=v.createContext(void 0),fU=L_.Provider;function mU(){return v.useContext(F_)}function hU(){return v.useContext(L_)}function ld(e){var{valueAccessor:t=uU}=e,r=Yw(e,lU),{dataKey:n,clockWise:a,id:i,textBreakAll:o}=r,l=Yw(r,cU),c=mU(),d=hU(),u=c||d;return!u||!u.length?null:v.createElement(mr,{className:"recharts-label-list"},u.map((f,m)=>{var h,p=$t(n)?t(f,m):Nt(f&&f.payload,n),x=$t(i)?{}:{id:"".concat(i,"-").concat(m)};return v.createElement(vs,Ud({},Kt(f,!0),l,x,{fill:(h=r.fill)!==null&&h!==void 0?h:f.fill,parentViewBox:f.parentViewBox,value:p,textBreakAll:o,viewBox:f.viewBox,key:"label-".concat(m),index:m}))}))}ld.displayName="LabelList";function zg(e){var{label:t}=e;return t?t===!0?v.createElement(ld,{key:"labelList-implicit"}):v.isValidElement(t)||$g(t)?v.createElement(ld,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(ld,Ud({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ep.apply(null,arguments)}var B_=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=tt("recharts-dot",a);return t===+t&&r===+r&&n===+n?v.createElement("circle",Ep({},ya(e),mx(e),{className:i,cx:t,cy:r,r:n})):null},$_=e=>e.graphicalItems.polarItems,pU=fe([Pt,cc],hg),Ug=fe([$_,rr,pU],pg),xU=fe([Ug],xg),Wg=fe([xU,ag],gg),gU=fe([Wg,rr,Ug],yg),vU=fe([Wg,rr,Ug],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,o=Nt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Nt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),Xw=()=>{},yU=fe([rr,UT,Xw,vU,Xw,at,Pt],wg),z_=fe([rr,at,Wg,gU,lc,Pt,yU],jg),bU=fe([z_,rr,Ao],Sg);fe([rr,z_,bU,Pt],_g);var wU={radiusAxis:{},angleAxis:{}},U_=$n({name:"polarAxis",initialState:wU,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Ole,removeRadiusAxis:Ple,addAngleAxis:Dle,removeAngleAxis:Ile}=U_.actions,jU=U_.reducer;function Zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zw(Object(r),!0).forEach(function(n){NU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NU(e,t,r){return(t=EU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EU(e){var t=SU(e,"string");return typeof t=="symbol"?t:t+""}function SU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TU=(e,t)=>t,Hg=fe([$_,TU],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),_U=[],Vg=(e,t,r)=>r?.length===0?_U:r,W_=fe([ag,Hg,Vg],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>Jw(Jw({},t.presentationProps),i.props))),a!=null)return a}}),AU=fe([W_,Hg,Vg],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,o=Nt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:jo(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),kU=fe([W_,Hg,Vg,yr],(e,t,r,n)=>{if(!(t==null||e==null))return TW({offset:n,pieSettings:t,displayedData:e,cells:r})}),q0={},Qw;function CU(){return Qw||(Qw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(q0)),q0}var K0,e2;function OU(){return e2||(e2=1,K0=CU().isPlainObject),K0}var PU=OU();const DU=Is(PU);function t2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t2(Object(r),!0).forEach(function(n){IU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IU(e,t,r){return(t=RU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RU(e){var t=FU(e,"string");return typeof t=="symbol"?t:t+""}function FU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wd(){return Wd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wd.apply(null,arguments)}var n2=(e,t,r,n,a)=>{var i=r-n,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+a),o+="L ".concat(e+r-i/2-n,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z"),o},MU={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},LU=e=>{var t=Br(e,MU),{x:r,y:n,upperWidth:a,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:f}=t,m=v.useRef(),[h,p]=v.useState(-1),x=v.useRef(a),g=v.useRef(i),y=v.useRef(o),w=v.useRef(r),b=v.useRef(n),j=nc(e,"trapezoid-");if(v.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var _=m.current.getTotalLength();_&&p(_)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||o!==+o||a===0&&i===0||o===0)return null;var N=tt("recharts-trapezoid",l);if(!f)return v.createElement("g",null,v.createElement("path",Wd({},Kt(t,!0),{className:N,d:n2(r,n,a,i,o)})));var E=x.current,S=g.current,T=y.current,k=w.current,I=b.current,C="0px ".concat(h===-1?1:h,"px"),A="".concat(h,"px 0px"),L=fS(["strokeDasharray"],d,c);return v.createElement(rc,{animationId:j,key:j,canBegin:h>0,duration:d,easing:c,isActive:f,begin:u},_=>{var W=Rt(E,a,_),Y=Rt(S,i,_),Q=Rt(T,o,_),J=Rt(k,r,_),U=Rt(I,n,_);m.current&&(x.current=W,g.current=Y,y.current=Q,w.current=J,b.current=U);var ie=_>0?{transition:L,strokeDasharray:A}:{strokeDasharray:C};return v.createElement("path",Wd({},Kt(t,!0),{className:N,d:n2(J,U,W,Y,Q),ref:m,style:r2(r2({},ie),t.style)}))})},BU=["option","shapeType","propTransformer","activeClassName","isActive"];function $U(e,t){if(e==null)return{};var r,n,a=zU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function a2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a2(Object(r),!0).forEach(function(n){UU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UU(e,t,r){return(t=WU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WU(e){var t=HU(e,"string");return typeof t=="symbol"?t:t+""}function HU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VU(e,t){return Hd(Hd({},t),e)}function GU(e,t){return e==="symbols"}function s2(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(xS,r);case"trapezoid":return v.createElement(LU,r);case"sector":return v.createElement(yS,r);case"symbols":if(GU(t))return v.createElement(yx,r);break;default:return null}}function qU(e){return v.isValidElement(e)?e.props:e}function H_(e){var{option:t,shapeType:r,propTransformer:n=VU,activeClassName:a="recharts-active-shape",isActive:i}=e,o=$U(e,BU),l;if(v.isValidElement(t))l=v.cloneElement(t,Hd(Hd({},o),qU(t)));else if(typeof t=="function")l=t(o);else if(DU(t)&&typeof t!="boolean"){var c=n(t,o);l=v.createElement(s2,{shapeType:r,elementProps:c})}else{var d=o;l=v.createElement(s2,{shapeType:r,elementProps:d})}return i?v.createElement(mr,{className:a},l):l}var Gg=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(a_({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},qg=e=>{var t=Ut();return(r,n)=>a=>{e?.(r,n,a),t(C9())}},Kg=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(O9({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Yg(e){var{fn:t,args:r}=e,n=Ut(),a=En();return v.useEffect(()=>{if(!a){var i=t(r);return n(_9(i)),()=>{n(A9(i))}}},[t,r,n,a]),null}var V_=()=>{};function G_(e){var{legendPayload:t}=e,r=Ut(),n=En();return v.useEffect(()=>n?V_:(r(cS(t)),()=>{r(dS(t))}),[r,n,t]),null}function KU(e){var{legendPayload:t}=e,r=Ut(),n=ze(at);return v.useEffect(()=>n!=="centric"&&n!=="radial"?V_:(r(cS(t)),()=>{r(dS(t))}),[r,n,t]),null}var Y0,YU=()=>{var[e]=v.useState(()=>gl("uid-"));return e},XU=(Y0=d4.useId)!==null&&Y0!==void 0?Y0:YU;function ZU(e,t){var r=XU();return t||(e?"".concat(e,"-").concat(r):r)}var JU=v.createContext(void 0),Xg=e=>{var{id:t,type:r,children:n}=e,a=ZU("recharts-".concat(r),t);return v.createElement(JU.Provider,{value:a},n(a))},QU={cartesianItems:[],polarItems:[]},q_=$n({name:"graphicalItems",initialState:QU,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Wa(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Wa(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Wa(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:eW,replaceCartesianGraphicalItem:tW,removeCartesianGraphicalItem:rW,addPolarGraphicalItem:nW,removePolarGraphicalItem:aW}=q_.actions,sW=q_.reducer;function K_(e){var t=Ut(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?t(eW(e)):r.current!==e&&t(tW({prev:r.current,next:e})),r.current=e},[t,e]),v.useEffect(()=>()=>{r.current&&(t(rW(r.current)),r.current=null)},[t]),null}function iW(e){var t=Ut();return v.useEffect(()=>(t(nW(e)),()=>{t(aW(e))}),[t,e]),null}var oW=["onMouseEnter","onClick","onMouseLeave"],lW=["id"],cW=["id"];function Zg(e,t){if(e==null)return{};var r,n,a=dW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function i2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i2(Object(r),!0).forEach(function(n){uW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uW(e,t,r){return(t=fW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fW(e){var t=mW(e,"string");return typeof t=="symbol"?t:t+""}function mW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function As(){return As=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},As.apply(null,arguments)}function hW(e){var t=v.useMemo(()=>hx(e.children,Zu),[e.children]),r=ze(n=>AU(n,e.id,t));return r==null?null:v.createElement(KU,{legendPayload:r})}function pW(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:n.map(u=>u.tooltipPayload),positions:n.map(u=>u.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:jo(l,t),hide:c,type:d,color:o,unit:""}}}var xW=(e,t)=>e>t?"start":e<t?"end":"middle",gW=(e,t,r)=>Xr(typeof t=="function"?t(e):t,r,r*.8),vW=(e,t,r)=>{var{top:n,left:a,width:i,height:o}=t,l=QE(i,o),c=a+Xr(e.cx,i,i/2),d=n+Xr(e.cy,o,o/2),u=Xr(e.innerRadius,l,0),f=gW(r,e.outerRadius,l),m=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:f,maxRadius:m}},yW=(e,t)=>{var r=Sr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function bW(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var wW=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=tt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(rl,As({},t,{type:"linear",className:r}))},jW=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),v.isValidElement(n)))return n;var a=tt("recharts-pie-label-text",bW(e));return v.createElement(Ju,As({},t,{alignmentBaseline:"middle",className:a}),n)};function NW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:o}=r;if(!n||!a||!t)return null;var l=ya(r),c=Kt(a,!1),d=Kt(i,!1),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((m,h)=>{var p=(m.startAngle+m.endAngle)/2,x=dr(m.cx,m.cy,m.outerRadius+u,p),g=Ct(Ct(Ct(Ct({},l),m),{},{stroke:"none"},c),{},{index:h,textAnchor:xW(x.x,m.cx)},x),y=Ct(Ct(Ct(Ct({},l),m),{},{fill:"none",stroke:m.fill},d),{},{index:h,points:[dr(m.cx,m.cy,m.outerRadius,p),x],key:"line"});return v.createElement(mr,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(h)},i&&wW(i,y),jW(a,g,Nt(m,o)))});return v.createElement(mr,{className:"recharts-pie-labels"},f)}function EW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?v.createElement(zg,{label:a}):v.createElement(NW,{sectors:t,props:r,showLabels:n})}function SW(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=ze(_s),{onMouseEnter:o,onClick:l,onMouseLeave:c}=a,d=Zg(a,oW),u=Gg(o,a.dataKey),f=qg(c),m=Kg(l,a.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((h,p)=>{if(h?.startAngle===0&&h?.endAngle===0&&t.length!==1)return null;var x=r&&String(p)===i,g=i?n:null,y=x?r:g,w=Ct(Ct({},h),{},{stroke:h.stroke,tabIndex:-1,[sS]:p,[iS]:a.dataKey});return v.createElement(mr,As({tabIndex:-1,className:"recharts-pie-sector"},Jl(d,h,p),{onMouseEnter:u(h,p),onMouseLeave:f(h,p),onClick:m(h,p),key:"sector-".concat(h?.startAngle,"-").concat(h?.endAngle,"-").concat(h.midAngle,"-").concat(p)}),v.createElement(H_,As({option:y,isActive:x,shapeType:"sector"},w)))}))}function TW(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:f}=r,m=Math.abs(r.minAngle),h=yW(l,c),p=Math.abs(h),x=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=n.filter(E=>Nt(E,d,0)!==0).length,y=(p>=360?g:g-1)*x,w=p-g*m-y,b=n.reduce((E,S)=>{var T=Nt(S,d,0);return E+($e(T)?T:0)},0),j;if(b>0){var N;j=n.map((E,S)=>{var T=Nt(E,d,0),k=Nt(E,u,S),I=vW(r,i,E),C=($e(T)?T:0)/b,A,L=Ct(Ct({},E),a&&a[S]&&a[S].props);S?A=N.endAngle+Sr(h)*x*(T!==0?1:0):A=l;var _=A+Sr(h)*((T!==0?m:0)+C*w),W=(A+_)/2,Y=(I.innerRadius+I.outerRadius)/2,Q=[{name:k,value:T,payload:L,dataKey:d,type:f}],J=dr(I.cx,I.cy,Y,W);return N=Ct(Ct(Ct(Ct({},r.presentationProps),{},{percent:C,cornerRadius:o,name:k,tooltipPayload:Q,midAngle:W,middleRadius:Y,tooltipPosition:J},L),I),{},{value:T,startAngle:A,endAngle:_,payload:L,paddingAngle:Sr(h)*x}),N})}return j}function _W(e){var{showLabels:t,sectors:r,children:n}=e,a=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(fU,{value:t?a:void 0},n)}function AW(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:f}=t,m=nc(t,"recharts-pie-"),h=r.current,[p,x]=v.useState(!1),g=v.useCallback(()=>{typeof f=="function"&&f(),x(!1)},[f]),y=v.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return v.createElement(_W,{showLabels:!p,sectors:n},v.createElement(rc,{animationId:m,begin:i,duration:o,isActive:a,easing:l,onAnimationStart:y,onAnimationEnd:g,key:m},w=>{var b=[],j=n&&n[0],N=j?.startAngle;return n?.forEach((E,S)=>{var T=h&&h[S],k=S>0?hi(E,"paddingAngle",0):0;if(T){var I=Rt(T.endAngle-T.startAngle,E.endAngle-E.startAngle,w),C=Ct(Ct({},E),{},{startAngle:N+k,endAngle:N+I+k});b.push(C),N=C.endAngle}else{var{endAngle:A,startAngle:L}=E,_=Rt(0,A-L,w),W=Ct(Ct({},E),{},{startAngle:N+k,endAngle:N+_+k});b.push(W),N=W.endAngle}}),r.current=b,v.createElement(mr,null,v.createElement(SW,{sectors:b,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),v.createElement(EW,{showLabels:!p,sectors:n,props:t}),t.children)}var kW={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Rs.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function CW(e){var{id:t}=e,r=Zg(e,lW),{hide:n,className:a,rootTabIndex:i}=e,o=v.useMemo(()=>hx(e.children,Zu),[e.children]),l=ze(u=>kU(u,t,o)),c=v.useRef(null),d=tt("recharts-pie",a);return n||l==null?(c.current=null,v.createElement(mr,{tabIndex:i,className:d})):v.createElement(v.Fragment,null,v.createElement(Yg,{fn:pW,args:Ct(Ct({},e),{},{sectors:l})}),v.createElement(mr,{tabIndex:i,className:d},v.createElement(AW,{props:Ct(Ct({},r),{},{sectors:l}),previousSectorsRef:c})))}function Y_(e){var t=Br(e,kW),{id:r}=t,n=Zg(t,cW),a=ya(n);return v.createElement(Xg,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(iW,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),v.createElement(hW,As({},n,{id:i})),v.createElement(CW,As({},n,{id:i}))))}Y_.displayName="Pie";function o2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o2(Object(r),!0).forEach(function(n){OW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OW(e,t,r){return(t=PW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PW(e){var t=DW(e,"string");return typeof t=="symbol"?t:t+""}function DW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IW={xAxis:{},yAxis:{},zAxis:{}},X_=$n({name:"cartesianAxis",initialState:IW,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=l2(l2({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:RW,removeXAxis:FW,addYAxis:MW,removeYAxis:LW,addZAxis:Rle,removeZAxis:Fle,updateYAxisWidth:BW}=X_.actions,$W=X_.reducer,zW=fe([yr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),UW=fe([zW,as,ss],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Jg=()=>ze(UW),WW=()=>ze(g$);function c2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c2(Object(r),!0).forEach(function(n){HW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HW(e,t,r){return(t=VW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=GW(e,"string");return typeof t=="symbol"?t:t+""}function GW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qW=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var o=d2(d2({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Kt(a,!1)),mx(a)),l;return v.isValidElement(a)?l=v.cloneElement(a,o):typeof a=="function"?l=a(o):l=v.createElement(B_,o),v.createElement(mr,{className:"recharts-active-dot"},l)};function u2(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=ze(_s),o=WW();if(t==null||o==null)return null;var l=t.find(c=>o.includes(c.payload));return $t(l)?null:qW({point:l,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var KW="Invariant failed";function YW(e,t){throw new Error(KW)}var XW=["x","y"];function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sp.apply(null,arguments)}function f2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f2(Object(r),!0).forEach(function(n){ZW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZW(e,t,r){return(t=JW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=QW(e,"string");return typeof t=="symbol"?t:t+""}function QW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eH(e,t){if(e==null)return{};var r,n,a=tH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rH(e,t){var{x:r,y:n}=e,a=eH(e,XW),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),m=parseInt(f,10);return Yo(Yo(Yo(Yo(Yo({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function Qg(e){return v.createElement(H_,Sp({shapeType:"rectangle",propTransformer:rH,activeClassName:"recharts-active-bar"},e))}var nH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if($e(t))return t;var i=$e(n)||$t(n);return i?t(n,a):(i||YW(),r)}},aH={},Z_=$n({name:"errorBars",initialState:aH,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Mle,replaceErrorBar:Lle,removeErrorBar:Ble}=Z_.actions,sH=Z_.reducer,iH=["children"];function oH(e,t){if(e==null)return{};var r,n,a=lH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cH={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},dH=v.createContext(cH);function uH(e){var{children:t}=e,r=oH(e,iH);return v.createElement(dH.Provider,{value:r},t)}function ev(e,t){var r,n,a=ze(d=>os(d,e)),i=ze(d=>ls(d,t)),o=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:Sn.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:Tn.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function J_(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Jg(),{needClipX:i,needClipY:o,needClip:l}=ev(t,r);if(!l)return null;var{x:c,y:d,width:u,height:f}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:i?c:c-u/2,y:o?d:d-f/2,width:i?u:u*2,height:o?f:f*2}))}var fH=["onMouseEnter","onMouseLeave","onClick"],mH=["value","background","tooltipPosition"],hH=["id"],pH=["onMouseEnter","onClick","onMouseLeave"];function ks(){return ks=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ks.apply(null,arguments)}function m2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function on(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m2(Object(r),!0).forEach(function(n){xH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xH(e,t,r){return(t=gH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gH(e){var t=vH(e,"string");return typeof t=="symbol"?t:t+""}function vH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vd(e,t){if(e==null)return{};var r,n,a=yH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bH=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:jo(r,t),payload:e}]};function wH(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:jo(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function jH(e){var t=ze(_s),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,d=Vd(i,fH),u=Gg(o,n),f=qg(l),m=Kg(c,n);if(!a||r==null)return null;var h=Kt(a,!1);return v.createElement(v.Fragment,null,r.map((p,x)=>{var{value:g,background:y,tooltipPosition:w}=p,b=Vd(p,mH);if(!y)return null;var j=u(p,x),N=f(p,x),E=m(p,x),S=on(on(on(on(on({option:a,isActive:String(x)===t},b),{},{fill:"#eee"},y),h),Jl(d,p,x)),{},{onMouseEnter:j,onMouseLeave:N,onClick:E,dataKey:n,index:x,className:"recharts-bar-background-rectangle"});return v.createElement(Qg,ks({key:"background-bar-".concat(S.index)},S))}))}function NH(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var o={x:i.x,y:i.y,width:i.width,height:i.height};return on(on({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return v.createElement(M_,{value:t?a:void 0},r)}function EH(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:o}=e,l=ze(_s),c=ze(g_),d=r&&String(i)===l&&(c==null||o===c),u=d?r:t;return v.createElement(Qg,ks({},n,a,{isActive:d,option:u,index:i,dataKey:o}))}function SH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return v.createElement(Qg,ks({},r,n,{isActive:!1,option:t,index:a,dataKey:i}))}function TH(e){var{data:t,props:r}=e,n=ya(r),{id:a}=n,i=Vd(n,hH),{shape:o,dataKey:l,activeBar:c}=r,{onMouseEnter:d,onClick:u,onMouseLeave:f}=r,m=Vd(r,pH),h=Gg(d,l),p=qg(f),x=Kg(u,l);return t?v.createElement(v.Fragment,null,t.map((g,y)=>v.createElement(mr,ks({className:"recharts-bar-rectangle"},Jl(m,g,y),{onMouseEnter:h(g,y),onMouseLeave:p(g,y),onClick:x(g,y),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(y)}),c?v.createElement(EH,{shape:o,activeBar:c,baseProps:i,entry:g,index:y,dataKey:l}):v.createElement(SH,{shape:o,baseProps:i,entry:g,index:y,dataKey:l})))):null}function _H(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,f=r.current,m=nc(t,"recharts-bar-"),[h,p]=v.useState(!1),x=!h,g=v.useCallback(()=>{typeof d=="function"&&d(),p(!1)},[d]),y=v.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return v.createElement(NH,{showLabels:x,rects:n},v.createElement(rc,{animationId:m,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:y,key:m},w=>{var b=w===1?n:n?.map((j,N)=>{var E=f&&f[N];if(E)return on(on({},j),{},{x:Rt(E.x,j.x,w),y:Rt(E.y,j.y,w),width:Rt(E.width,j.width,w),height:Rt(E.height,j.height,w)});if(a==="horizontal"){var S=Rt(0,j.height,w);return on(on({},j),{},{y:j.y+j.height-S,height:S})}var T=Rt(0,j.width,w);return on(on({},j),{},{width:T})});return w>0&&(r.current=b??null),b==null?null:v.createElement(mr,null,v.createElement(TH,{props:t,data:b}))}),v.createElement(zg,{label:t.label}),t.children)}function AH(e){var t=v.useRef(null);return v.createElement(_H,{previousRectanglesRef:t,props:e})}var Q_=0,kH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Nt(e,t)}};class CH extends v.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=tt("recharts-bar",a),f=d;return v.createElement(mr,{className:u,id:d},l&&v.createElement("defs",null,v.createElement(J_,{clipPathId:f,xAxisId:i,yAxisId:o})),v.createElement(mr,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},v.createElement(jH,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),v.createElement(AH,this.props)))}}var OH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Rs.isSsr,legendType:"rect",minPointSize:Q_,xAxisId:0,yAxisId:0};function PH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:f}=ev(t,r),m=Pu(),h=En(),p=hx(e.children,Zu),x=ze(w=>iV(w,t,r,h,e.id,p));if(m!=="vertical"&&m!=="horizontal")return null;var g,y=x?.[0];return y==null||y.height==null||y.width==null?g=0:g=m==="vertical"?y.height/2:y.width/2,v.createElement(uH,{xAxisId:t,yAxisId:r,data:x,dataPointFormatter:kH,errorBarOffset:g},v.createElement(CH,ks({},e,{layout:m,needClip:f,data:x,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function DH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:f,offset:m,cells:h,parentViewBox:p}=e,x=t==="horizontal"?l:o,g=u?x.scale.domain():null,y=GR({numericAxis:x});return f.map((w,b)=>{var j,N,E,S,T,k;u?j=zR(u[b],g):(j=Nt(w,r),Array.isArray(j)||(j=[y,j]));var I=nH(n,Q_)(j[1],b);if(t==="horizontal"){var C,[A,L]=[l.scale(j[0]),l.scale(j[1])];N=Zy({axis:o,ticks:c,bandSize:i,offset:a.offset,entry:w,index:b}),E=(C=L??A)!==null&&C!==void 0?C:void 0,S=a.size;var _=A-L;if(T=jn(_)?0:_,k={x:N,y:m.top,width:S,height:m.height},Math.abs(I)>0&&Math.abs(T)<Math.abs(I)){var W=Sr(T||I)*(Math.abs(I)-Math.abs(T));E-=W,T+=W}}else{var[Y,Q]=[o.scale(j[0]),o.scale(j[1])];if(N=Y,E=Zy({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:w,index:b}),S=Q-Y,T=a.size,k={x:m.left,y:E,width:m.width,height:T},Math.abs(I)>0&&Math.abs(S)<Math.abs(I)){var J=Sr(S||I)*(Math.abs(I)-Math.abs(S));S+=J}}if(N==null||E==null||S==null||T==null)return null;var U=on(on({},w),{},{x:N,y:E,width:S,height:T,value:u?j:j[1],payload:w,background:k,tooltipPosition:{x:N+S/2,y:E+T/2},parentViewBox:p},h&&h[b]&&h[b].props);return U}).filter(Boolean)}function IH(e){var t=Br(e,OH),r=En();return v.createElement(Xg,{id:t.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(G_,{legendPayload:bH(t)}),v.createElement(Yg,{fn:wH,args:t}),v.createElement(K_,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:nS(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(PH,ks({},t,{id:n}))))}var Tp=v.memo(IH);Tp.displayName="Bar";function h2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h2(Object(r),!0).forEach(function(n){RH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RH(e,t,r){return(t=FH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FH(e){var t=MH(e,"string");return typeof t=="symbol"?t:t+""}function MH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LH=(e,t)=>t,BH=(e,t,r)=>r,$H=(e,t,r,n)=>n,zH=(e,t,r,n,a)=>a,pc=fe([Vu,zH],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),UH=fe([pc],e=>e?.maxBarSize),WH=(e,t,r,n,a,i)=>i,p2=(e,t,r)=>{var n=r??e;if(!$t(n))return Xr(n,t,0)},HH=fe([at,Vu,LH,BH,$H],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),VH=(e,t,r,n)=>{var a=at(e);return a==="horizontal"?_l(e,"yAxis",r,n):_l(e,"xAxis",t,n)},GH=(e,t,r)=>{var n=at(e);return n==="horizontal"?hw(e,"xAxis",t):hw(e,"yAxis",r)},qH=(e,t,r)=>{var n={},a=e.filter(Hu),i=e.filter(d=>d.stackId==null),o=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),n),l=Object.entries(o).map(d=>{var[u,f]=d,m=f.map(p=>p.dataKey),h=p2(t,r,f[0].barSize);return{stackId:u,dataKeys:m,barSize:h}}),c=i.map(d=>{var u=[d.dataKey].filter(m=>m!=null),f=p2(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...c]},KH=fe([HH,TB,GH],qH),YH=(e,t,r,n,a)=>{var i,o,l=pc(e,t,r,n,a);if(l!=null){var c=at(e),d=pT(e),{maxBarSize:u}=l,f=$t(u)?d:u,m,h;return c==="horizontal"?(m=Ts(e,"xAxis",t,n),h=Ss(e,"xAxis",t,n)):(m=Ts(e,"yAxis",r,n),h=Ss(e,"yAxis",r,n)),(i=(o=bl(m,h,!0))!==null&&o!==void 0?o:f)!==null&&i!==void 0?i:0}},eA=(e,t,r,n)=>{var a=at(e),i,o;return a==="horizontal"?(i=Ts(e,"xAxis",t,n),o=Ss(e,"xAxis",t,n)):(i=Ts(e,"yAxis",r,n),o=Ss(e,"yAxis",r,n)),bl(i,o)};function XH(e,t,r,n,a){var i=n.length;if(!(i<1)){var o=Xr(e,r,0,!0),l,c=[];if(Mr(n[0].barSize)){var d=!1,u=r/i,f=n.reduce((y,w)=>y+(w.barSize||0),0);f+=(i-1)*o,f>=r&&(f-=(i-1)*o,o=0),f>=r&&u>0&&(d=!0,u*=.9,f=i*u);var m=(r-f)/2>>0,h={offset:m-o,size:0};l=n.reduce((y,w)=>{var b,j={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:h.offset+h.size+o,size:d?u:(b=w.barSize)!==null&&b!==void 0?b:0}},N=[...y,j];return h=N[N.length-1].position,N},c)}else{var p=Xr(t,r,0,!0);r-2*p-(i-1)*o<=0&&(o=0);var x=(r-2*p-(i-1)*o)/i;x>1&&(x>>=0);var g=Mr(a)?Math.min(x,a):x;l=n.reduce((y,w,b)=>[...y,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:p+(x+o)*b+(x-g)/2,size:g}}],c)}return l}}var ZH=(e,t,r,n,a,i,o)=>{var l=$t(o)?t:o,c=XH(r,n,a!==i?a:i,e,l);return a!==i&&c!=null&&(c=c.map(d=>Gc(Gc({},d),{},{position:Gc(Gc({},d.position),{},{offset:d.position.offset-a/2})}))),c},JH=fe([KH,pT,SB,xT,YH,eA,UH],ZH),QH=(e,t,r,n)=>Ts(e,"xAxis",t,n),eV=(e,t,r,n)=>Ts(e,"yAxis",r,n),tV=(e,t,r,n)=>Ss(e,"xAxis",t,n),rV=(e,t,r,n)=>Ss(e,"yAxis",r,n),nV=fe([JH,pc],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),aV=(e,t)=>{var r=Wu(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(o=>o.key===r)}}}},sV=fe([VH,pc],aV),iV=fe([yr,Cx,QH,eV,tV,rV,nV,at,Bu,eA,sV,pc,WH],(e,t,r,n,a,i,o,l,c,d,u,f,m)=>{var{chartData:h,dataStartIndex:p,dataEndIndex:x}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:g}=f,y;if(g!=null&&g.length>0?y=g:y=h?.slice(p,x+1),y!=null)return DH({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:u,displayedData:y,offset:e,cells:m})}}),tA=e=>{var{chartData:t}=e,r=Ut(),n=En();return v.useEffect(()=>n?()=>{}:(r(Ew(t)),()=>{r(Ew(void 0))}),[t,r,n]),null},x2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},rA=$n({name:"brush",initialState:x2,reducers:{setBrushSettings(e,t){return t.payload==null?x2:t.payload}}}),{setBrushSettings:$le}=rA.actions,oV=rA.reducer;function lV(e,t,r){return(t=cV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cV(e){var t=dV(e,"string");return typeof t=="symbol"?t:t+""}function dV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class tv{static create(t){return new tv(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}lV(tv,"EPS",1e-4);function uV(e){return(e%180+180)%180}var fV=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=uV(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},mV={dots:[],areas:[],lines:[]},nA=$n({name:"referenceElements",initialState:mV,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Wa(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Wa(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Wa(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:zle,removeDot:Ule,addArea:Wle,removeArea:Hle,addLine:Vle,removeLine:Gle}=nA.actions,hV=nA.reducer,pV=v.createContext(void 0),xV=e=>{var{children:t}=e,[r]=v.useState("".concat(gl("recharts"),"-clip")),n=Jg();if(n==null)return null;var{x:a,y:i,width:o,height:l}=n;return v.createElement(pV.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:i,height:l,width:o}))),t)};function mo(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function aA(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function gV(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return fV(n,r)}function vV(e,t,r){var n=r==="width",{x:a,y:i,width:o,height:l}=e;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function Gd(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function yV(e,t){return aA(e,t+1)}function bV(e,t,r,n,a){for(var i=(n||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,f=function(){var p=n?.[c];if(p===void 0)return{v:aA(n,d)};var x=c,g,y=()=>(g===void 0&&(g=r(p,x)),g),w=p.coordinate,b=c===0||Gd(e,w,y,u,l);b||(c=0,u=o,d+=1),b&&(u=w+e*(y()/2+a),c+=d)},m;d<=i.length;)if(m=f(),m)return m.v;return[]}function g2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g2(Object(r),!0).forEach(function(n){wV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wV(e,t,r){return(t=jV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jV(e){var t=NV(e,"string");return typeof t=="symbol"?t:t+""}function NV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EV(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,d=function(m){var h=i[m],p,x=()=>(p===void 0&&(p=r(h,m)),p);if(m===o-1){var g=e*(h.coordinate+e*x()/2-c);i[m]=h=Wr(Wr({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[m]=h=Wr(Wr({},h),{},{tickCoord:h.coordinate});var y=Gd(e,h.tickCoord,x,l,c);y&&(c=h.tickCoord-e*(x()/2+a),i[m]=Wr(Wr({},h),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function SV(e,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,{start:c,end:d}=t;if(i){var u=n[l-1],f=r(u,l-1),m=e*(u.coordinate+e*f/2-d);o[l-1]=u=Wr(Wr({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate});var h=Gd(e,u.tickCoord,()=>f,c,d);h&&(d=u.tickCoord-e*(f/2+a),o[l-1]=Wr(Wr({},u),{},{isShow:!0}))}for(var p=i?l-1:l,x=function(w){var b=o[w],j,N=()=>(j===void 0&&(j=r(b,w)),j);if(w===0){var E=e*(b.coordinate-e*N()/2-c);o[w]=b=Wr(Wr({},b),{},{tickCoord:E<0?b.coordinate-E*e:b.coordinate})}else o[w]=b=Wr(Wr({},b),{},{tickCoord:b.coordinate});var S=Gd(e,b.tickCoord,N,c,d);S&&(c=b.tickCoord+e*(N()/2+a),o[w]=Wr(Wr({},b),{},{isShow:!0}))},g=0;g<p;g++)x(g);return o}function rv(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:f}=e;if(!a||!a.length||!n)return[];if($e(c)||Rs.isSsr){var m;return(m=yV(a,$e(c)?c:0))!==null&&m!==void 0?m:[]}var h=[],p=l==="top"||l==="bottom"?"width":"height",x=u&&p==="width"?al(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(b,j)=>{var N=typeof d=="function"?d(b.value,j):b.value;return p==="width"?gV(al(N,{fontSize:t,letterSpacing:r}),x,f):al(N,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?Sr(a[1].coordinate-a[0].coordinate):1,w=vV(i,y,p);return c==="equidistantPreserveStart"?bV(y,w,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=SV(y,w,g,a,o,c==="preserveStartEnd"):h=EV(y,w,g,a,o),h.filter(b=>b.isShow))}var TV=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+i,d=o+c+l+(r?n:0);return Math.round(d)}return 0},_V=["axisLine","width","height","className","hide","ticks"],AV=["viewBox"],kV=["viewBox"];function _p(e,t){if(e==null)return{};var r,n,a=CV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vi(){return vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vi.apply(null,arguments)}function v2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v2(Object(r),!0).forEach(function(n){OV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OV(e,t,r){return(t=PV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PV(e){var t=DV(e,"string");return typeof t=="symbol"?t:t+""}function DV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nv={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function IV(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=pr(pr(pr({},c),Kt(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!o||i==="bottom"&&o);d=pr(pr({},d),{},{x1:t,y1:r+u*a,x2:t+n,y2:r+u*a})}else{var f=+(i==="left"&&!o||i==="right"&&o);d=pr(pr({},d),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return v.createElement("line",vi({},d,{className:tt("recharts-cartesian-axis-line",hi(l,"className"))}))}function RV(e,t,r,n,a,i,o,l,c){var d,u,f,m,h,p,x=l?-1:1,g=e.tickSize||o,y=$e(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=u=e.coordinate,m=r+ +!l*a,f=m-x*g,p=f-x*c,h=y;break;case"left":f=m=e.coordinate,u=t+ +!l*n,d=u-x*g,h=d-x*c,p=y;break;case"right":f=m=e.coordinate,u=t+ +l*n,d=u+x*g,h=d+x*c,p=y;break;default:d=u=e.coordinate,m=r+ +l*a,f=m+x*g,p=f+x*c,h=y;break}return{line:{x1:d,y1:f,x2:u,y2:m},tick:{x:h,y:p}}}function FV(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function MV(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function LV(e){var{option:t,tickProps:r,value:n}=e,a,i=tt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))a=v.cloneElement(t,pr(pr({},r),{},{className:i}));else if(typeof t=="function")a=t(pr(pr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=tt(o,t?.className)),a=v.createElement(Ju,vi({},r,{className:o}),n)}return a}function BV(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:o,padding:l,tickTextProps:c,orientation:d,mirror:u,x:f,y:m,width:h,height:p,tickSize:x,tickMargin:g,fontSize:y,letterSpacing:w,getTicksConfig:b,events:j}=e,N=rv(pr(pr({},b),{},{ticks:t}),y,w),E=FV(d,u),S=MV(d,u),T=ya(b),k=Kt(r,!1),I=pr(pr({},T),{},{fill:"none"},Kt(n,!1)),C=N.map((A,L)=>{var{line:_,tick:W}=RV(A,f,m,h,p,d,x,u,g),Y=pr(pr(pr(pr({textAnchor:E,verticalAnchor:S},T),{},{stroke:"none",fill:a},k),W),{},{index:L,payload:A,visibleTicksCount:N.length,tickFormatter:i,padding:l},c);return v.createElement(mr,vi({className:"recharts-cartesian-axis-tick",key:"tick-".concat(A.value,"-").concat(A.coordinate,"-").concat(A.tickCoord)},Jl(j,A,L)),n&&v.createElement("line",vi({},I,_,{className:tt("recharts-cartesian-axis-tick-line",hi(n,"className"))})),r&&v.createElement(LV,{option:r,tickProps:Y,value:"".concat(typeof i=="function"?i(A.value,L):A.value).concat(o||"")}))});return C.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},C):null}var $V=v.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:o,ticks:l}=e,c=_p(e,_V),[d,u]=v.useState(""),[f,m]=v.useState(""),h=v.useRef([]);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var x;return TV({ticks:h.current,label:(x=e.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=v.useCallback(x=>{if(x){var g=x.getElementsByClassName("recharts-cartesian-axis-tick-value");h.current=Array.from(g);var y=g[0];if(y){var w=window.getComputedStyle(y),b=w.fontSize,j=w.letterSpacing;(b!==d||j!==f)&&(u(b),m(j))}}},[d,f]);return o||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(mr,{className:tt("recharts-cartesian-axis",i),ref:p},v.createElement(IV,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:ya(e)}),v.createElement(BV,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:f,getTicksConfig:e,events:c}),v.createElement(Vz,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(tU,{label:e.label}),e.children))}),zV=v.memo($V,(e,t)=>{var{viewBox:r}=e,n=_p(e,AV),{viewBox:a}=t,i=_p(t,kV);return mo(r,a)&&mo(n,i)}),av=v.forwardRef((e,t)=>{var r=Br(e,nv);return v.createElement(zV,vi({},r,{ref:t}))});av.displayName="CartesianAxis";var UV=["x1","y1","x2","y2","key"],WV=["offset"],HV=["xAxisId","yAxisId"],VV=["xAxisId","yAxisId"];function y2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y2(Object(r),!0).forEach(function(n){GV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GV(e,t,r){return(t=qV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qV(e){var t=KV(e,"string");return typeof t=="symbol"?t:t+""}function KV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qs(){return Qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qs.apply(null,arguments)}function qd(e,t){if(e==null)return{};var r,n,a=YV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var XV=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:o,ry:l}=e;return v.createElement("rect",{x:n,y:a,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function sA(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:o,key:l}=t,c=qd(t,UV),d=ya(c),{offset:u}=d,f=qd(d,WV);r=v.createElement("line",Qs({},f,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function ZV(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,l=qd(e,HV),c=a.map((d,u)=>{var f=Gr(Gr({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return sA(n,f)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function JV(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,l=qd(e,VV),c=a.map((d,u)=>{var f=Gr(Gr({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return sA(n,f)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function QV(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==d[0]&&d.unshift(0);var u=d.map((f,m)=>{var h=!d[m+1],p=h?a+o-f:d[m+1]-f;if(p<=0)return null;var x=m%t.length;return v.createElement("rect",{key:"react-".concat(m),y:f,x:n,height:p,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function eG(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==d[0]&&d.unshift(0);var u=d.map((f,m)=>{var h=!d[m+1],p=h?a+o-f:d[m+1]-f;if(p<=0)return null;var x=m%r.length;return v.createElement("rect",{key:"react-".concat(m),x:f,y:i,width:p,height:l,stroke:"none",fill:r[x],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var tG=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return tS(rv(Gr(Gr(Gr({},nv),r),{},{ticks:rS(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},rG=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return tS(rv(Gr(Gr(Gr({},nv),r),{},{ticks:rS(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},nG={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Ap(e){var t=Px(),r=Dx(),n=oS(),a=Gr(Gr({},Br(e,nG)),{},{x:$e(e.x)?e.x:n.left,y:$e(e.y)?e.y:n.top,width:$e(e.width)?e.width:n.width,height:$e(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:f,horizontalValues:m,verticalValues:h}=a,p=En(),x=ze(k=>pw(k,"xAxis",i,p)),g=ze(k=>pw(k,"yAxis",o,p));if(!$e(d)||d<=0||!$e(u)||u<=0||!$e(l)||l!==+l||!$e(c)||c!==+c)return null;var y=a.verticalCoordinatesGenerator||tG,w=a.horizontalCoordinatesGenerator||rG,{horizontalPoints:b,verticalPoints:j}=a;if((!b||!b.length)&&typeof w=="function"){var N=m&&m.length,E=w({yAxis:g?Gr(Gr({},g),{},{ticks:N?m:g.ticks}):void 0,width:t,height:r,offset:n},N?!0:f);nl(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(b=E)}if((!j||!j.length)&&typeof y=="function"){var S=h&&h.length,T=y({xAxis:x?Gr(Gr({},x),{},{ticks:S?h:x.ticks}):void 0,width:t,height:r,offset:n},S?!0:f);nl(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(j=T)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(XV,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(QV,Qs({},a,{horizontalPoints:b})),v.createElement(eG,Qs({},a,{verticalPoints:j})),v.createElement(ZV,Qs({},a,{offset:n,horizontalPoints:b,xAxis:x,yAxis:g})),v.createElement(JV,Qs({},a,{offset:n,verticalPoints:j,xAxis:x,yAxis:g})))}Ap.displayName="CartesianGrid";var iA=(e,t,r,n)=>Ts(e,"xAxis",t,n),oA=(e,t,r,n)=>Ss(e,"xAxis",t,n),lA=(e,t,r,n)=>Ts(e,"yAxis",r,n),cA=(e,t,r,n)=>Ss(e,"yAxis",r,n),aG=fe([at,iA,lA,oA,cA],(e,t,r,n,a)=>ns(e,"xAxis")?bl(t,n,!1):bl(r,a,!1)),sG=(e,t,r,n,a)=>a,dA=fe([Vu,sG],(e,t)=>e.filter(r=>r.type==="area").find(r=>r.id===t)),iG=(e,t,r,n,a)=>{var i,o=dA(e,t,r,n,a);if(o!=null){var l=at(e),c=ns(l,"xAxis"),d;if(c?d=_l(e,"yAxis",r,n):d=_l(e,"xAxis",t,n),d!=null){var{stackId:u}=o,f=Wu(o);if(!(u==null||f==null)){var m=(i=d[u])===null||i===void 0?void 0:i.stackedData;return m?.find(h=>h.key===f)}}}},oG=fe([at,iA,lA,oA,cA,iG,Bu,aG,dA],(e,t,r,n,a,i,o,l,c)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:f}=o;if(!(c==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||a==null||n.length===0||a.length===0||l==null)){var{data:m}=c,h;if(m&&m.length>0?h=m:h=d?.slice(u,f+1),h!=null){var p=void 0;return AG({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataStartIndex:u,areaSettings:c,stackedData:i,displayedData:h,chartBaseValue:p,bandSize:l})}}}),lG=["id"],cG=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function uA(e,t){if(e==null)return{};var r,n,a=dG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function b2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b2(Object(r),!0).forEach(function(n){uG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uG(e,t,r){return(t=fG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fG(e){var t=mG(e,"string");return typeof t=="symbol"?t:t+""}function mG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Va.apply(null,arguments)}function Kd(e,t){return e&&e!=="none"?e:t}var hG=e=>{var{dataKey:t,name:r,stroke:n,fill:a,legendType:i,hide:o}=e;return[{inactive:o,dataKey:t,type:i,color:Kd(n,a),value:jo(r,t),payload:e}]};function pG(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:o,hide:l,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:jo(o,t),hide:l,type:e.tooltipType,color:Kd(n,i),unit:c}}}var xG=(e,t)=>{var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=tt("recharts-area-dot",typeof e!="boolean"?e.className:"");r=v.createElement(B_,Va({},t,{className:n}))}return r};function gG(e,t){return e==null?!1:t?!0:e.length===1}function vG(e){var{clipPathId:t,points:r,props:n}=e,{needClip:a,dot:i,dataKey:o}=n;if(!gG(r,i))return null;var l=XN(i),c=ya(n),d=Kt(i,!0),u=r.map((m,h)=>{var p=za(za(za({key:"dot-".concat(h),r:3},c),d),{},{index:h,cx:m.x,cy:m.y,dataKey:o,value:m.value,payload:m.payload,points:r});return xG(i,p)}),f={clipPath:a?"url(#clipPath-".concat(l?"":"dots-").concat(t,")"):void 0};return v.createElement(mr,Va({className:"recharts-area-dots"},f),u)}function yG(e){var{showLabels:t,children:r,points:n}=e,a=n.map(i=>{var o={x:i.x,y:i.y,width:0,height:0};return za(za({},o),{},{value:i.value,payload:i.payload,parentViewBox:void 0,viewBox:o,fill:void 0})});return v.createElement(M_,{value:t?a:null},r)}function w2(e){var{points:t,baseLine:r,needClip:n,clipPathId:a,props:i}=e,{layout:o,type:l,stroke:c,connectNulls:d,isRange:u}=i,{id:f}=i,m=uA(i,lG),h=ya(m);return v.createElement(v.Fragment,null,t?.length>1&&v.createElement(mr,{clipPath:n?"url(#clipPath-".concat(a,")"):void 0},v.createElement(rl,Va({},h,{id:f,points:t,connectNulls:d,type:l,baseLine:r,layout:o,stroke:"none",className:"recharts-area-area"})),c!=="none"&&v.createElement(rl,Va({},h,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:t})),c!=="none"&&u&&v.createElement(rl,Va({},h,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:r}))),v.createElement(vG,{points:t,props:m,clipPathId:a}))}function bG(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,i=n[0].y,o=n[n.length-1].y;if(!Mr(i)||!Mr(o))return null;var l=t*Math.abs(i-o),c=Math.max(...n.map(d=>d.x||0));return $e(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(d=>d.x||0),c)),$e(c)?v.createElement("rect",{x:0,y:i<o?i:i-l,width:c+(a?parseInt("".concat(a),10):1),height:Math.floor(l)}):null}function wG(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,i=n[0].x,o=n[n.length-1].x;if(!Mr(i)||!Mr(o))return null;var l=t*Math.abs(i-o),c=Math.max(...n.map(d=>d.y||0));return $e(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(d=>d.y||0),c)),$e(c)?v.createElement("rect",{x:i<o?i:i-l,y:0,width:l,height:Math.floor(c+(a?parseInt("".concat(a),10):1))}):null}function jG(e){var{alpha:t,layout:r,points:n,baseLine:a,strokeWidth:i}=e;return r==="vertical"?v.createElement(bG,{alpha:t,points:n,baseLine:a,strokeWidth:i}):v.createElement(wG,{alpha:t,points:n,baseLine:a,strokeWidth:i})}function NG(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:a,previousBaselineRef:i}=e,{points:o,baseLine:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:f,onAnimationStart:m,onAnimationEnd:h}=n,p=nc(n,"recharts-area-"),[x,g]=v.useState(!1),y=!x,w=v.useCallback(()=>{typeof h=="function"&&h(),g(!1)},[h]),b=v.useCallback(()=>{typeof m=="function"&&m(),g(!0)},[m]),j=a.current,N=i.current;return v.createElement(yG,{showLabels:y,points:o},n.children,v.createElement(rc,{animationId:p,begin:d,duration:u,isActive:c,easing:f,onAnimationEnd:w,onAnimationStart:b,key:p},E=>{if(j){var S=j.length/o.length,T=E===1?o:o.map((I,C)=>{var A=Math.floor(C*S);if(j[A]){var L=j[A];return za(za({},I),{},{x:Rt(L.x,I.x,E),y:Rt(L.y,I.y,E)})}return I}),k;return $e(l)?k=Rt(N,l,E):$t(l)||jn(l)?k=Rt(N,0,E):k=l.map((I,C)=>{var A=Math.floor(C*S);if(Array.isArray(N)&&N[A]){var L=N[A];return za(za({},I),{},{x:Rt(L.x,I.x,E),y:Rt(L.y,I.y,E)})}return I}),E>0&&(a.current=T,i.current=k),v.createElement(w2,{points:T,baseLine:k,needClip:t,clipPathId:r,props:n})}return E>0&&(a.current=o,i.current=l),v.createElement(mr,null,c&&v.createElement("defs",null,v.createElement("clipPath",{id:"animationClipPath-".concat(r)},v.createElement(jG,{alpha:E,points:o,baseLine:l,layout:n.layout,strokeWidth:n.strokeWidth}))),v.createElement(mr,{clipPath:"url(#animationClipPath-".concat(r,")")},v.createElement(w2,{points:o,baseLine:l,needClip:t,clipPathId:r,props:n})))}),v.createElement(zg,{label:n.label}))}function EG(e){var{needClip:t,clipPathId:r,props:n}=e,a=v.useRef(null),i=v.useRef();return v.createElement(NG,{needClip:t,clipPathId:r,props:n,previousPointsRef:a,previousBaselineRef:i})}class SG extends v.PureComponent{render(){var t,{hide:r,dot:n,points:a,className:i,top:o,left:l,needClip:c,xAxisId:d,yAxisId:u,width:f,height:m,id:h,baseLine:p}=this.props;if(r)return null;var x=tt("recharts-area",i),g=h,{r:y=3,strokeWidth:w=2}=(t=Kt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},b=XN(n),j=y*2+w;return v.createElement(v.Fragment,null,v.createElement(mr,{className:x},c&&v.createElement("defs",null,v.createElement(J_,{clipPathId:g,xAxisId:d,yAxisId:u}),!b&&v.createElement("clipPath",{id:"clipPath-dots-".concat(g)},v.createElement("rect",{x:l-j/2,y:o-j/2,width:f+j,height:m+j}))),v.createElement(EG,{needClip:c,clipPathId:g,props:this.props})),v.createElement(u2,{points:a,mainColor:Kd(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(p)&&v.createElement(u2,{points:p,mainColor:Kd(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var fA={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Rs.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function TG(e){var t,r=Br(e,fA),{activeDot:n,animationBegin:a,animationDuration:i,animationEasing:o,connectNulls:l,dot:c,fill:d,fillOpacity:u,hide:f,isAnimationActive:m,legendType:h,stroke:p,xAxisId:x,yAxisId:g}=r,y=uA(r,cG),w=Pu(),b=y_(),{needClip:j}=ev(x,g),N=En(),{points:E,isRange:S,baseLine:T}=(t=ze(_=>oG(_,x,g,N,e.id)))!==null&&t!==void 0?t:{},k=Jg();if(w!=="horizontal"&&w!=="vertical"||k==null||b!=="AreaChart"&&b!=="ComposedChart")return null;var{height:I,width:C,x:A,y:L}=k;return!E||!E.length?null:v.createElement(SG,Va({},y,{activeDot:n,animationBegin:a,animationDuration:i,animationEasing:o,baseLine:T,connectNulls:l,dot:c,fill:d,fillOpacity:u,height:I,hide:f,layout:w,isAnimationActive:m,isRange:S,legendType:h,needClip:j,points:E,stroke:p,width:C,left:A,top:L,xAxisId:x,yAxisId:g}))}var _G=(e,t,r,n,a)=>{var i=r??t;if($e(i))return i;var o=e==="horizontal"?a:n,l=o.scale.domain();if(o.type==="number"){var c=Math.max(l[0],l[1]),d=Math.min(l[0],l[1]);return i==="dataMin"?d:i==="dataMax"||c<0?c:Math.max(Math.min(l[0],l[1]),0)}return i==="dataMin"?l[0]:i==="dataMax"?l[1]:l[0]};function AG(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:a,layout:i,chartBaseValue:o,xAxis:l,yAxis:c,displayedData:d,dataStartIndex:u,xAxisTicks:f,yAxisTicks:m,bandSize:h}=e,p=a&&a.length,x=_G(i,o,r,l,c),g=i==="horizontal",y=!1,w=d.map((j,N)=>{var E;p?E=a[u+N]:(E=Nt(j,n),Array.isArray(E)?y=!0:E=[x,E]);var S=E[1]==null||p&&!t&&Nt(j,n)==null;return g?{x:Xy({axis:l,ticks:f,bandSize:h,entry:j,index:N}),y:S?null:c.scale(E[1]),value:E,payload:j}:{x:S?null:l.scale(E[1]),y:Xy({axis:c,ticks:m,bandSize:h,entry:j,index:N}),value:E,payload:j}}),b;return p||y?b=w.map(j=>{var N=Array.isArray(j.value)?j.value[0]:null;return g?{x:j.x,y:N!=null&&j.y!=null?c.scale(N):null,payload:j.payload}:{x:N!=null?l.scale(N):null,y:j.y,payload:j.payload}}):b=g?c.scale(x):l.scale(x),{points:w,baseLine:b,isRange:y}}function kG(e){var t=Br(e,fA),r=En();return v.createElement(Xg,{id:t.id,type:"area"},n=>v.createElement(v.Fragment,null,v.createElement(G_,{legendPayload:hG(t)}),v.createElement(Yg,{fn:pG,args:t}),v.createElement(K_,{type:"area",id:n,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:nS(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:r,connectNulls:t.connectNulls}),v.createElement(TG,Va({},t,{id:n}))))}var kp=v.memo(kG);kp.displayName="Area";var CG=["dangerouslySetInnerHTML","ticks"],OG=["id"],PG=["domain"],DG=["domain"];function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(null,arguments)}function Yd(e,t){if(e==null)return{};var r,n,a=IG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function IG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function RG(e){var t=Ut();return v.useEffect(()=>(t(RW(e)),()=>{t(FW(e))}),[e,t]),null}var FG=e=>{var{xAxisId:t,className:r}=e,n=ze(Cx),a=En(),i="xAxis",o=ze(g=>ko(g,i,t,a)),l=ze(g=>JT(g,i,t,a)),c=ze(g=>KT(g,t)),d=ze(g=>g9(g,t)),u=ze(g=>ST(g,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:m}=e,h=Yd(e,CG),{id:p}=u,x=Yd(u,OG);return v.createElement(av,Cp({},h,x,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:tt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},MG={allowDataOverflow:Sn.allowDataOverflow,allowDecimals:Sn.allowDecimals,allowDuplicatedCategory:Sn.allowDuplicatedCategory,height:Sn.height,hide:!1,mirror:Sn.mirror,orientation:Sn.orientation,padding:Sn.padding,reversed:Sn.reversed,scale:Sn.scale,tickCount:Sn.tickCount,type:Sn.type,xAxisId:0},LG=e=>{var t,r,n,a,i,o=Br(e,MG);return v.createElement(v.Fragment,null,v.createElement(RG,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(FG,o))},BG=(e,t)=>{var{domain:r}=e,n=Yd(e,PG),{domain:a}=t,i=Yd(t,DG);return mo(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:mo({domain:r},{domain:a}):!1},Op=v.memo(LG,BG);Op.displayName="XAxis";var $G=["dangerouslySetInnerHTML","ticks"],zG=["id"],UG=["domain"],WG=["domain"];function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pp.apply(null,arguments)}function Xd(e,t){if(e==null)return{};var r,n,a=HG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function HG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function VG(e){var t=Ut();return v.useEffect(()=>(t(MW(e)),()=>{t(LW(e))}),[e,t]),null}var GG=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=v.useRef(null),o=v.useRef(null),l=ze(Cx),c=En(),d=Ut(),u="yAxis",f=ze(N=>ko(N,u,t,c)),m=ze(N=>YT(N,t)),h=ze(N=>y9(N,t)),p=ze(N=>JT(N,u,t,c)),x=ze(N=>TT(N,t));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!m||$g(a)||v.isValidElement(a)||x==null)){var N=i.current;if(N){var E=N.getCalculatedWidth();Math.round(m.width)!==Math.round(E)&&d(BW({id:t,width:E}))}}},[p,m,d,a,t,n,x]),m==null||h==null||x==null)return null;var{dangerouslySetInnerHTML:g,ticks:y}=e,w=Xd(e,$G),{id:b}=x,j=Xd(x,zG);return v.createElement(av,Pp({},w,j,{ref:i,labelRef:o,scale:f,x:h.x,y:h.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:m.width,height:m.height,className:tt("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:p}))},qG={allowDataOverflow:Tn.allowDataOverflow,allowDecimals:Tn.allowDecimals,allowDuplicatedCategory:Tn.allowDuplicatedCategory,hide:!1,mirror:Tn.mirror,orientation:Tn.orientation,padding:Tn.padding,reversed:Tn.reversed,scale:Tn.scale,tickCount:Tn.tickCount,type:Tn.type,width:Tn.width,yAxisId:0},KG=e=>{var t,r,n,a,i,o=Br(e,qG);return v.createElement(v.Fragment,null,v.createElement(VG,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(GG,o))},YG=(e,t)=>{var{domain:r}=e,n=Xd(e,UG),{domain:a}=t,i=Xd(t,WG);return mo(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:mo({domain:r},{domain:a}):!1},Dp=v.memo(KG,YG);Dp.displayName="YAxis";var X0={exports:{}},Z0={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j2;function XG(){if(j2)return Z0;j2=1;var e=Yp();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return Z0.useSyncExternalStoreWithSelector=function(c,d,u,f,m){var h=a(null);if(h.current===null){var p={hasValue:!1,value:null};h.current=p}else p=h.current;h=o(function(){function g(N){if(!y){if(y=!0,w=N,N=f(N),m!==void 0&&p.hasValue){var E=p.value;if(m(E,N))return b=E}return b=N}if(E=b,r(w,N))return E;var S=f(N);return m!==void 0&&m(E,S)?(w=N,E):(w=N,b=S)}var y=!1,w,b,j=u===void 0?null:u;return[function(){return g(d())},j===null?void 0:function(){return g(j())}]},[d,u,f,m]);var x=n(c,h[0],h[1]);return i(function(){p.hasValue=!0,p.value=x},[x]),l(x),x},Z0}var N2;function ZG(){return N2||(N2=1,X0.exports=XG()),X0.exports}ZG();function JG(e){e()}function QG(){let e=null,t=null;return{clear(){e=null,t=null},notify(){JG(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var E2={notify(){},get:()=>[]};function eq(e,t){let r,n=E2,a=0,i=!1;function o(x){u();const g=n.subscribe(x);let y=!1;return()=>{y||(y=!0,g(),f())}}function l(){n.notify()}function c(){p.onStateChange&&p.onStateChange()}function d(){return i}function u(){a++,r||(r=e.subscribe(c),n=QG())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=E2)}function m(){i||(i=!0,u())}function h(){i&&(i=!1,f())}const p={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:m,tryUnsubscribe:h,getListeners:()=>n};return p}var tq=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rq=tq(),nq=()=>typeof navigator<"u"&&navigator.product==="ReactNative",aq=nq(),sq=()=>rq||aq?v.useLayoutEffect:v.useEffect,iq=sq(),oq=Symbol.for("react-redux-context"),lq=typeof globalThis<"u"?globalThis:{};function cq(){if(!v.createContext)return{};const e=lq[oq]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var dq=cq();function uq(e){const{children:t,context:r,serverState:n,store:a}=e,i=v.useMemo(()=>{const c=eq(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=v.useMemo(()=>a.getState(),[a]);iq(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||dq;return v.createElement(l.Provider,{value:i},t)}var fq=uq,mq=(e,t)=>t,sv=fe([mq,at,jT,wr,m_,cs,N$,yr],A$),iv=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},mA=ra("mouseClick"),hA=ec();hA.startListening({actionCreator:mA,effect:(e,t)=>{var r=e.payload,n=sv(t.getState(),iv(r));n?.activeIndex!=null&&t.dispatch(P9({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Ip=ra("mouseMove"),pA=ec();pA.startListening({actionCreator:Ip,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Cg(n,n.tooltip.settings.shared),i=sv(n,iv(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(i_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(s_()))}});var S2={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},xA=$n({name:"rootProps",initialState:S2,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:S2.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),hq=xA.reducer,{updateOptions:pq}=xA.actions,gA=$n({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:xq}=gA.actions,gq=gA.reducer,vA=ra("keyDown"),yA=ra("focus"),ov=ec();ov.startListening({actionCreator:vA,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(Og(a,Oo(r))),l=cs(r);if(i==="Enter"){var c=zd(r,"axis","hover",String(a.index));t.dispatch(bp({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var d=N9(r),u=d==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,m=o+f*u;if(!(l==null||m>=l.length||m<0)){var h=zd(r,"axis","hover",String(m));t.dispatch(bp({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});ov.startListening({actionCreator:yA,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",o=zd(r,"axis","hover",String(i));t.dispatch(bp({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var Gn=ra("externalEvent"),bA=ec();bA.startListening({actionCreator:Gn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:h$(r),activeDataKey:g_(r),activeIndex:_s(r),activeLabel:x_(r),activeTooltipIndex:_s(r),isTooltipActive:p$(r)};e.payload.handler(n,e.payload.reactEvent)}}});var vq=fe([Co],e=>e.tooltipItemPayloads),yq=fe([vq,mc,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var o=t(i,r);return o}}}),wA=ra("touchMove"),jA=ec();jA.startListening({actionCreator:wA,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Cg(n,n.tooltip.settings.shared);if(a==="axis"){var i=sv(n,iv({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(i_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var o,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(sS),u=(o=c.getAttribute(iS))!==null&&o!==void 0?o:void 0,f=yq(t.getState(),d,u);t.dispatch(a_({activeDataKey:u,activeIndex:d,activeCoordinate:f}))}}});var bq=CE({brush:oV,cartesianAxis:$W,chartData:H$,errorBars:sH,graphicalItems:sW,layout:SR,legend:hF,options:B$,polarAxis:jU,polarOptions:gq,referenceElements:hV,rootProps:hq,tooltip:D9}),wq=function(t){return X8({reducer:bq,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([hA.middleware,pA.middleware,ov.middleware,bA.middleware,jA.middleware]),devTools:Rs.devToolsEnabled})};function NA(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=En(),i=v.useRef(null);if(a)return r;i.current==null&&(i.current=wq(t));var o=Ex;return v.createElement(fq,{context:o,store:i.current},r)}function EA(e){var{layout:t,width:r,height:n,margin:a}=e,i=Ut(),o=En();return v.useEffect(()=>{o||(i(jR(t)),i(NR({width:r,height:n})),i(wR(a)))},[i,o,t,r,n,a]),null}function SA(e){var t=Ut();return v.useEffect(()=>{t(pq(e))},[t,e]),null}var jq=["children"];function Nq(e,t){if(e==null)return{};var r,n,a=Eq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Eq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Zd(){return Zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zd.apply(null,arguments)}var Sq={width:"100%",height:"100%"},Tq=v.forwardRef((e,t)=>{var r=Px(),n=Dx(),a=uS();if(!oo(r)||!oo(n))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,d,u;return typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?u=o.role:u=a?"application":void 0,v.createElement(px,Zd({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:n,style:Sq,ref:t}),i)}),_q=e=>{var{children:t}=e,r=ze(Ou);if(!r)return null;var{width:n,height:a,y:i,x:o}=r;return v.createElement(px,{width:n,height:a,x:o,y:i},t)},T2=v.forwardRef((e,t)=>{var{children:r}=e,n=Nq(e,jq),a=En();return a?v.createElement(_q,null,r):v.createElement(Tq,Zd({ref:t},n),r)});function Aq(){var e=Ut(),[t,r]=v.useState(null),n=ze(QR);return v.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Mr(i)&&i!==n&&e(ER(i))}},[t,e,n]),r}function _2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_2(Object(r),!0).forEach(function(n){Cq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cq(e,t,r){return(t=Oq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oq(e){var t=Pq(e,"string");return typeof t=="symbol"?t:t+""}function Pq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dq=v.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:f,onMouseUp:m,onTouchEnd:h,onTouchMove:p,onTouchStart:x,style:g,width:y}=e,w=Ut(),[b,j]=v.useState(null),[N,E]=v.useState(null);Q$();var S=Aq(),T=v.useCallback(M=>{S(M),typeof t=="function"&&t(M),j(M),E(M)},[S,t,j,E]),k=v.useCallback(M=>{w(mA(M)),w(Gn({handler:i,reactEvent:M}))},[w,i]),I=v.useCallback(M=>{w(Ip(M)),w(Gn({handler:d,reactEvent:M}))},[w,d]),C=v.useCallback(M=>{w(s_()),w(Gn({handler:u,reactEvent:M}))},[w,u]),A=v.useCallback(M=>{w(Ip(M)),w(Gn({handler:f,reactEvent:M}))},[w,f]),L=v.useCallback(()=>{w(yA())},[w]),_=v.useCallback(M=>{w(vA(M.key))},[w]),W=v.useCallback(M=>{w(Gn({handler:o,reactEvent:M}))},[w,o]),Y=v.useCallback(M=>{w(Gn({handler:l,reactEvent:M}))},[w,l]),Q=v.useCallback(M=>{w(Gn({handler:c,reactEvent:M}))},[w,c]),J=v.useCallback(M=>{w(Gn({handler:m,reactEvent:M}))},[w,m]),U=v.useCallback(M=>{w(Gn({handler:x,reactEvent:M}))},[w,x]),ie=v.useCallback(M=>{w(wA(M)),w(Gn({handler:p,reactEvent:M}))},[w,p]),re=v.useCallback(M=>{w(Gn({handler:h,reactEvent:M}))},[w,h]);return v.createElement(E_.Provider,{value:b},v.createElement(ZN.Provider,{value:N},v.createElement("div",{className:tt("recharts-wrapper",n),style:kq({position:"relative",cursor:"default",width:y,height:a},g),onClick:k,onContextMenu:W,onDoubleClick:Y,onFocus:L,onKeyDown:_,onMouseDown:Q,onMouseEnter:I,onMouseLeave:C,onMouseMove:A,onMouseUp:J,onTouchEnd:re,onTouchMove:ie,onTouchStart:U,ref:T},r)))}),Iq=["children","className","width","height","style","compact","title","desc"];function Rq(e,t){if(e==null)return{};var r,n,a=Fq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Fq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var TA=v.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:o,compact:l,title:c,desc:d}=e,u=Rq(e,Iq),f=ya(u);return l?v.createElement(T2,{otherAttributes:f,title:c,desc:d},r):v.createElement(Dq,{className:n,style:o,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(T2,{otherAttributes:f,title:c,desc:d,ref:t},v.createElement(xV,null,r)))}),Mq=["width","height"];function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(null,arguments)}function Lq(e,t){if(e==null)return{};var r,n,a=Bq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Bq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $q={top:5,right:5,bottom:5,left:5},zq={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:$q,reverseStackOrder:!1,syncMethod:"index"},_A=v.forwardRef(function(t,r){var n,a=Br(t.categoricalChartProps,zq),{width:i,height:o}=a,l=Lq(a,Mq);if(!oo(i)||!oo(o))return null;var{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,categoricalChartProps:m}=t,h={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(NA,{preloadedState:{options:h},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:c},v.createElement(tA,{chartData:m.data}),v.createElement(EA,{width:i,height:o,layout:a.layout,margin:a.margin}),v.createElement(SA,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(TA,Rp({},l,{width:i,height:o,ref:r})))}),Uq=["axis","item"],Wq=v.forwardRef((e,t)=>v.createElement(_A,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Uq,tooltipPayloadSearcher:Bg,categoricalChartProps:e,ref:t}));function Hq(e){var t=Ut();return v.useEffect(()=>{t(xq(e))},[t,e]),null}var Vq=["width","height","layout"];function Fp(){return Fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fp.apply(null,arguments)}function Gq(e,t){if(e==null)return{};var r,n,a=qq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Kq={top:5,right:5,bottom:5,left:5},Yq={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Kq,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Xq=v.forwardRef(function(t,r){var n,a=Br(t.categoricalChartProps,Yq),{width:i,height:o,layout:l}=a,c=Gq(a,Vq);if(!oo(i)||!oo(o))return null;var{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:f,tooltipPayloadSearcher:m}=t,h={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:f,tooltipPayloadSearcher:m,eventEmitter:void 0};return v.createElement(NA,{preloadedState:{options:h},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},v.createElement(tA,{chartData:a.data}),v.createElement(EA,{width:i,height:o,layout:l,margin:a.margin}),v.createElement(SA,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(Hq,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),v.createElement(TA,Fp({width:i,height:o},c,{ref:r})))}),Zq=["item"],Jq={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Qq=v.forwardRef((e,t)=>{var r=Br(e,Jq);return v.createElement(Xq,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Zq,tooltipPayloadSearcher:Bg,categoricalChartProps:r,ref:t})}),eK=["axis"],tK=v.forwardRef((e,t)=>v.createElement(_A,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:eK,tooltipPayloadSearcher:Bg,categoricalChartProps:e,ref:t}));const rK=()=>{const[e,t]=v.useState([]),[r,n]=v.useState(""),[a,i]=v.useState(""),[o,l]=v.useState(""),[c,d]=v.useState(!1),[u,f]=v.useState(null),[m,h]=v.useState("view"),[p,x]=v.useState(!1),[g,y]=v.useState(null),[w,b]=v.useState([]),[j,N]=v.useState(""),[E,S]=v.useState(!1),[T,k]=v.useState(null),[I,C]=v.useState("view"),[A,L]=v.useState(!1),[_,W]=v.useState(null);v.useEffect(()=>{t([{id:1,eid:"EMP001",fullName:"John Doe",role:"Admin",department:"IT",status:"Active",email:"john.doe@company.com",phone:"+1-555-0123"},{id:2,eid:"EMP002",fullName:"Jane Smith",role:"Trainee",department:"HR",status:"Active",email:"jane.smith@company.com",phone:"+1-555-0124"},{id:3,eid:"EMP003",fullName:"Bob Johnson",role:"Trainer",department:"Finance",status:"Inactive",email:"bob.johnson@company.com",phone:"+1-555-0125"}]),b([{id:1,name:"Admin",assignedUsers:5,status:"Active",permissions:["read","write","delete","manage_users","manage_roles"]},{id:2,name:"Trainee",assignedUsers:12,status:"Active",permissions:["read","write"]},{id:3,name:"Trainer",assignedUsers:45,status:"Active",permissions:["read","write"]}])},[]);const Y=Pe=>{n(Pe)},Q=Pe=>{i(Pe)},J=Pe=>{l(Pe)},U=Pe=>{f(Pe),h("view"),d(!0)},ie=Pe=>{f(Pe),h("edit"),d(!0)},re=()=>{f(null),h("add"),d(!0)},M=async Pe=>{if(window.confirm("Are you sure you want to delete this user?")){x(!0);try{await new Promise(Fe=>setTimeout(Fe,1e3)),t(e.filter(Fe=>Fe.id!==Pe)),y(null)}catch{y("Failed to delete user")}finally{x(!1)}}},z=async Pe=>{x(!0);try{if(await new Promise(Fe=>setTimeout(Fe,1e3)),m==="add"){const Fe={...Pe,id:Math.max(...e.map(Wt=>Wt.id))+1,eid:`EMP${String(Math.max(...e.map(Wt=>parseInt(Wt.eid.replace("EMP",""))))+1).padStart(3,"0")}`};t([...e,Fe])}else t(e.map(Fe=>Fe.id===u.id?{...Fe,...Pe}:Fe));d(!1),f(null),y(null)}catch{y("Failed to save user")}finally{x(!1)}},V=async Pe=>{x(!0);try{await new Promise(Wt=>setTimeout(Wt,2e3));const Fe=[{id:e.length+1,eid:`EMP${String(e.length+1).padStart(3,"0")}`,fullName:"Imported User 1",role:"Employee",department:"IT",status:"Active",email:"imported1@company.com",phone:"+1-555-0001"},{id:e.length+2,eid:`EMP${String(e.length+2).padStart(3,"0")}`,fullName:"Imported User 2",role:"Employee",department:"HR",status:"Active",email:"imported2@company.com",phone:"+1-555-0002"}];t([...e,...Fe]),y(null)}catch{y("Failed to import users")}finally{x(!1)}},P=Pe=>{N(Pe)},Z=Pe=>{k(Pe),C("view"),S(!0)},oe=Pe=>{k(Pe),C("edit"),S(!0)},ye=()=>{k(null),C("add"),S(!0)},ne=async Pe=>{if(window.confirm("Are you sure you want to delete this role?")){L(!0);try{await new Promise(Fe=>setTimeout(Fe,1e3)),b(w.filter(Fe=>Fe.id!==Pe)),W(null)}catch{W("Failed to delete role")}finally{L(!1)}}},ae=async Pe=>{L(!0);try{if(await new Promise(Fe=>setTimeout(Fe,1e3)),I==="add"){const Fe={...Pe,id:Math.max(...w.map(Wt=>Wt.id))+1,assignedUsers:0};b([...w,Fe])}else b(w.map(Fe=>Fe.id===T.id?{...Fe,...Pe}:Fe));S(!1),k(null),W(null)}catch{W("Failed to save role")}finally{L(!1)}},le=async Pe=>{L(!0);try{await new Promise(Fe=>setTimeout(Fe,1e3)),b(w.map(Fe=>Fe.id===Pe?{...Fe,status:"Inactive"}:Fe)),W(null)}catch{W("Failed to disable role")}finally{L(!1)}},D=e.filter(Pe=>{const Fe=Pe.fullName.toLowerCase().includes(r.toLowerCase())||Pe.eid.toLowerCase().includes(r.toLowerCase())||Pe.email.toLowerCase().includes(r.toLowerCase()),Wt=!a||Pe.role===a,ar=!o||Pe.department===o;return Fe&&Wt&&ar}),Ae=w.filter(Pe=>Pe.name.toLowerCase().includes(j.toLowerCase())),Ie=[...new Set(e.map(Pe=>Pe.role))],Ke=[...new Set(e.map(Pe=>Pe.department))];return{users:D,userSearchTerm:r,userRoleFilter:a,userDepartmentFilter:o,uniqueRoles:Ie,uniqueDepartments:Ke,userModalShow:c,selectedUser:u,userModalMode:m,userLoading:p,userError:g,handleUserSearch:Y,handleUserRoleFilter:Q,handleUserDepartmentFilter:J,handleUserView:U,handleUserEdit:ie,handleUserAdd:re,handleUserDelete:M,handleUserSave:z,handleBulkImport:V,setUserError:y,roles:Ae,roleSearchTerm:j,roleModalShow:E,selectedRole:T,roleModalMode:I,roleLoading:A,roleError:_,handleRoleSearch:P,handleRoleView:Z,handleRoleEdit:oe,handleRoleAdd:ye,handleRoleDelete:ne,handleRoleSave:ae,handleDisableRole:le,setRoleError:W,userStats:[{month:"Jan",active:40,inactive:24},{month:"Feb",active:30,inactive:13},{month:"Mar",active:20,inactive:18},{month:"Apr",active:27,inactive:15},{month:"May",active:18,inactive:12},{month:"Jun",active:23,inactive:19}],roleDistribution:[{name:"Admin",value:5},{name:"Trainer",value:15},{name:"Trainee",value:40},{name:"Manager",value:10}],departmentStats:[{name:"IT",users:25,courses:15},{name:"HR",users:15,courses:8},{name:"Finance",users:20,courses:12},{name:"Operations",users:30,courses:20}]}},nK=()=>{const{userStats:e,roleDistribution:t,departmentStats:r,userError:n,roleError:a}=rK();return G.useEffect(()=>{console.log("Dashboard mounted"),console.log("User stats:",e),console.log("Role distribution:",t),console.log("Department stats:",r)},[e,t,r]),G.useEffect(()=>{n&&xe.error(n)},[n]),G.useEffect(()=>{a&&xe.error(a)},[a]),s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("h1",{className:"text-primary-custom mb-0 text-mobile-center",children:"Aviation Training Management System"})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{lg:8,md:12,className:"mb-3 mb-lg-0",children:s.jsx(Bt,{permission:je.USERS.VIEW_ALL,fallback:null,children:s.jsxs(te,{className:"dashboard-chart-mobile",children:[s.jsx(te.Header,{children:"User Activity Trends"}),s.jsx(te.Body,{children:s.jsx(z0,{width:"100%",height:300,className:"chart-mobile-height",children:s.jsxs(tK,{data:e,children:[s.jsx(Ap,{strokeDasharray:"3 3"}),s.jsx(Op,{dataKey:"month"}),s.jsx(Dp,{}),s.jsx(R0,{}),s.jsx(Gi,{}),s.jsx(kp,{type:"monotone",dataKey:"active",stroke:"#8884d8",fill:"#8884d8",name:"Active Users"}),s.jsx(kp,{type:"monotone",dataKey:"inactive",stroke:"#82ca9d",fill:"#82ca9d",name:"Inactive Users"})]})})})]})})}),s.jsx(ee,{lg:4,md:12,children:s.jsx(Bt,{permission:je.ROLES.VIEW_ALL,fallback:null,children:s.jsxs(te,{className:"dashboard-chart-mobile",children:[s.jsx(te.Header,{children:"Role Distribution"}),s.jsx(te.Body,{children:s.jsx(z0,{width:"100%",height:300,className:"chart-mobile-height",children:s.jsxs(Qq,{children:[s.jsx(Y_,{data:t,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",fill:"#8884d8"}),s.jsx(R0,{}),s.jsx(Gi,{})]})})})]})})})]}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(bI,{module:"DEPARTMENTS",children:s.jsxs(te,{className:"dashboard-chart-mobile",children:[s.jsx(te.Header,{children:"Department Statistics"}),s.jsx(te.Body,{children:s.jsx(z0,{width:"100%",height:300,className:"chart-mobile-height",children:s.jsxs(Wq,{data:r,children:[s.jsx(Ap,{strokeDasharray:"3 3"}),s.jsx(Op,{dataKey:"name"}),s.jsx(Dp,{}),s.jsx(R0,{}),s.jsx(Gi,{}),s.jsx(Tp,{dataKey:"users",fill:"#8884d8",name:"Users"}),s.jsx(Tp,{dataKey:"courses",fill:"#82ca9d",name:"Courses"})]})})})]})})})}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(Bt,{permission:je.DASHBOARD.VIEW,fallback:s.jsxs(te,{className:"dashboard-chart-mobile",children:[s.jsx(te.Header,{children:"System Status"}),s.jsxs(te.Body,{children:[s.jsx("p",{className:"text-muted",children:"Dashboard is loading. Please wait for permissions to be loaded."}),s.jsx("p",{className:"text-muted",children:"If you continue to see this message, please contact your administrator."})]})]})})})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jd={};Jd.version="0.18.5";var AA=1252,aK=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},cv=function(e){aK.indexOf(e)!=-1&&(AA=lv[0]=e)};function sK(){cv(1252)}var ma=function(e){cv(e)};function dv(){ma(1200),sK()}function A2(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function iK(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function kA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Qo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?iK(e.slice(2)):t==254&&r==255?kA(e.slice(2)):t==65279?e.slice(1):e},qc=function(t){return String.fromCharCode(t)},k2=function(t){return String.fromCharCode(t)},kl,bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cl(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=bs.charAt(i)+bs.charAt(o)+bs.charAt(l)+bs.charAt(c);return t}function Bn(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=bs.indexOf(e.charAt(d++)),o=bs.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=bs.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=bs.indexOf(e.charAt(d++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var et=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ds=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Cs(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function C2(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Pn=function(t){return et?ds(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Qu(e){if(typeof ArrayBuffer>"u")return Pn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Bs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function oK(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function uv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return uv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Er=et?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ds(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function lK(e){for(var t=[],r=0,n=e.length+250,a=Cs(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Cs(65535),n=65530)}return t.push(a.slice(0,r)),Er(t)}var un=/\u0000/g,el=/[\u0001-\u0006]/g;function Ki(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ha(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}function fv(e,t){var r=""+e;return r.length>=t?r:Ht(" ",t-r.length)+r}function Qd(e,t){var r=""+e;return r.length>=t?r:r+Ht(" ",t-r.length)}function cK(e,t){var r=""+Math.round(e);return r.length>=t?r:Ht("0",t-r.length)+r}function dK(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}var O2=Math.pow(2,32);function Mi(e,t){if(e>O2||e<-O2)return cK(e,t);var r=Math.round(e);return dK(r,t)}function eu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var P2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],J0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function uK(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},D2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fK={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tu(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(a);d<t&&(f=Math.floor(a),l=f*o+i,u=f*d+c,!(a-f<5e-8));)a=1/(a-f),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,n*l,u];var m=Math.floor(n*l/u);return[m,n*l-m*u,u]}function ei(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=vK(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var CA=new Date(1899,11,31,0,0,0),mK=CA.getTime(),hK=new Date(1900,2,1,0,0,0);function OA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=hK&&(r+=1440*60*1e3),(r-(mK+(e.getTimezoneOffset()-CA.getTimezoneOffset())*6e4))/(1440*60*1e3)}function mv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pK(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xK(e){var t=e<0?12:11,r=mv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function gK(e){var t=mv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ol(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xK(e):t===10?r=e.toFixed(10).substr(0,12):r=gK(e),mv(pK(r.toUpperCase()))}function yi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ol(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return aa(14,OA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function vK(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function yK(e,t,r,n){var a="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return J0[r.m-1][1];case 5:return J0[r.m-1][0];default:return J0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return P2[r.q][0];default:return P2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ha(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=ha(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?ha(c,d):"";return u}function ws(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var PA=/%/g;function bK(e,t,r){var n=t.replace(PA,""),a=t.length-n.length;return Ga(e,n,r*Math.pow(10,2*a))+Ht("%",a)}function wK(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function DA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+DA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var IA=/# (\?+)( ?)\/( ?)(\d+)/;function jK(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Ht(" ",e[1].length+1+e[4].length):fv(o,e[1].length)+e[2]+"/"+e[3]+ha(l,e[4].length))}function NK(e,t,r){return r+(t===0?"":""+t)+Ht(" ",e[1].length+2+e[4].length)}var RA=/^#*0*\.([0#]+)/,FA=/\).*[0#]/,MA=/\(###\) ###\\?-####/;function an(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function I2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function R2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function EK(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function SK(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function qn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(FA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qn("n",n,r):"("+qn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return wK(e,t,r);if(t.indexOf("%")!==-1)return bK(e,t,r);if(t.indexOf("E")!==-1)return DA(t,r);if(t.charCodeAt(0)===36)return"$"+qn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Mi(c,t.length);if(t.match(/^[#?]+$/))return a=Mi(r,0),a==="0"&&(a=""),a.length>t.length?a:an(t.substr(0,t.length-a.length))+a;if(i=t.match(IA))return jK(i,c,d);if(t.match(/^#+0+$/))return d+Mi(c,t.length-t.indexOf("0"));if(i=t.match(RA))return a=I2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+an(i[1])).replace(/\.$/,"."+an(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Ht("0",an(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+I2(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ws(Mi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qn(e,t,-r):ws(""+(Math.floor(r)+EK(r,i[1].length)))+"."+ha(R2(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return qn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ki(qn(e,t.replace(/[\\-]/g,""),r)),o=0,Ki(Ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(t.match(MA))return a=qn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=tu(c,Math.pow(10,o)-1,!1),a=""+d,u=Ga("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Qd(l[2],o),u.length<i[4].length&&(u=an(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=tu(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?fv(l[1],o)+i[2]+"/"+i[3]+Qd(l[2],o):Ht(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Mi(r,0),t.length<=a.length?a:an(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,m=t.length-a.length-f;return an(t.substr(0,f)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=R2(r,i[1].length),r<0?"-"+qn(e,t,-r):ws(SK(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ha(0,3-p.length):"")+p})+"."+ha(o,i[1].length);switch(t){case"###,##0.00":return qn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ws(Mi(c,0));return h!=="0"?d+h:"";case"###,###.00":return qn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return qn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function TK(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _K(e,t,r){var n=t.replace(PA,""),a=t.length-n.length;return Ga(e,n,r*Math.pow(10,2*a))+Ht("%",a)}function LA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+LA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(FA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sa("n",n,r):"("+Sa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TK(e,t,r);if(t.indexOf("%")!==-1)return _K(e,t,r);if(t.indexOf("E")!==-1)return LA(t,r);if(t.charCodeAt(0)===36)return"$"+Sa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ha(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:an(t.substr(0,t.length-a.length))+a;if(i=t.match(IA))return NK(i,c,d);if(t.match(/^#+0+$/))return d+ha(c,t.length-t.indexOf("0"));if(i=t.match(RA))return a=(""+r).replace(/^([^\.]+)$/,"$1."+an(i[1])).replace(/\.$/,"."+an(i[1])),a=a.replace(/\.(\d*)$/,function(p,x){return"."+x+Ht("0",an(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ws(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sa(e,t,-r):ws(""+r)+"."+Ht("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Sa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ki(Sa(e,t.replace(/[\\-]/g,""),r)),o=0,Ki(Ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(t.match(MA))return a=Sa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=tu(c,Math.pow(10,o)-1,!1),a=""+d,u=Ga("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Qd(l[2],o),u.length<i[4].length&&(u=an(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=tu(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?fv(l[1],o)+i[2]+"/"+i[3]+Qd(l[2],o):Ht(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:an(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,m=t.length-a.length-f;return an(t.substr(0,f)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sa(e,t,-r):ws(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ha(0,3-p.length):"")+p})+"."+ha(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ws(""+c);return h!=="0"?d+h:"";default:if(t.match(/\.[0#?]*$/))return Sa(e,t.slice(0,t.lastIndexOf(".")),r)+an(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ga(e,t,r){return(r|0)===r?Sa(e,t,r):qn(e,t,r)}function AK(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var BA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Po(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":eu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(BA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function kK(e,t,r,n){for(var a=[],i="",o=0,l="",c="t",d,u,f,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!eu(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),p=h==="("||h===")"?h:"t";a[a.length]={t:p,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ei(t,r,e.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ei(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(d==null&&(d=ei(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(x.v=d.H>=12?"":""),x.t="T",o+=5,m="h"):(x.t="t",++o),d==null&&x.t==="T")return"";a[a.length]=x,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(BA)){if(d==null&&(d=ei(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Po(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var g=0,y=0,w;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=m,c="h",g<1&&(g=1);break;case"s":(w=a[o].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var b="",j;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=yK(a[o].t.charCodeAt(0),a[o].v,d,y),a[o].t="t";break;case"n":case"?":for(j=o+1;a[j]!=null&&((l=a[j].t)==="?"||l==="D"||(l===" "||l==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[o].v+=a[j].v,a[j]={v:"",t:";"},++j;b+=a[o].v,o=j-1;break;case"G":a[o].t="t",a[o].v=yi(t,r);break}var N="",E,S;if(b.length>0){b.charCodeAt(0)==40?(E=t<0&&b.charCodeAt(0)===45?-t:t,S=Ga("n",b,E)):(E=t<0&&n>1?-t:t,S=Ga("n",b,E),E<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),j=S.length-1;var T=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){T=o;break}var k=a.length;if(T===a.length&&S.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(j>=a[o].v.length-1?(j-=a[o].v.length,a[o].v=S.substr(j+1,a[o].v.length)):j<0?a[o].v="":(a[o].v=S.substr(0,j+1),j=-1),a[o].t="t",k=o);j>=0&&k<a.length&&(a[k].v=S.substr(0,j+1)+a[k].v)}else if(T!==a.length&&S.indexOf("E")===-1){for(j=S.indexOf(".")-1,o=T;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===T?a[o].v.indexOf(".")-1:a[o].v.length-1,N=a[o].v.substr(u+1);u>=0;--u)j>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(N=S.charAt(j--)+N);a[o].v=N,a[o].t="t",k=o}for(j>=0&&k<a.length&&(a[k].v=S.substr(0,j+1)+a[k].v),j=S.indexOf(".")+1,o=T;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==T)){for(u=a[o].v.indexOf(".")>-1&&o===T?a[o].v.indexOf(".")+1:0,N=a[o].v.substr(0,u);u<a[o].v.length;++u)j<S.length&&(N+=S.charAt(j++));a[o].v=N,a[o].t="t",k=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(E=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Ga(a[o].t,a[o].v,E),a[o].t="t");var I="";for(o=0;o!==a.length;++o)a[o]!=null&&(I+=a[o].v);return I}var F2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function M2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function CK(e,t){var r=AK(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(F2),l=r[1].match(F2);return M2(t,o)?[n,r[0]]:M2(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function aa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ve)[e],n==null&&(n=r.table&&r.table[D2[e]]||Ve[D2[e]]),n==null&&(n=fK[e]||"General");break}if(eu(n,0))return yi(t,r);t instanceof Date&&(t=OA(t,r.date1904));var a=CK(n,t);if(eu(a[1]))return yi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return kK(a[1],t,r,a[0])}function qa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ve[r]==null){t<0&&(t=r);continue}if(Ve[r]==e){t=r;break}}t<0&&(t=391)}return Ve[t]=e,t}function ef(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qa(e[t],t)}function Do(){Ve=uK()}var OK={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},$A=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function PK(e){var t=typeof e=="number"?Ve[e]:e;return t=t.replace($A,"(\\d+)"),new RegExp("^"+t+"$")}function DK(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,c=-1;(t.match($A)||[]).forEach(function(f,m){var h=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&i==-1?u:d+"T"+u}var IK=(function(){var e={};e.version="1.2.0";function t(){for(var S=0,T=new Array(256),k=0;k!=256;++k)S=k,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,T[k]=S;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(S){var T=0,k=0,I=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)C[I]=S[I];for(I=0;I!=256;++I)for(k=S[I],T=256+I;T<4096;T+=256)k=C[T]=k>>>8^S[k&255];var A=[];for(I=1;I!=16;++I)A[I-1]=typeof Int32Array<"u"?C.subarray(I*256,I*256+256):C.slice(I*256,I*256+256);return A}var a=n(r),i=a[0],o=a[1],l=a[2],c=a[3],d=a[4],u=a[5],f=a[6],m=a[7],h=a[8],p=a[9],x=a[10],g=a[11],y=a[12],w=a[13],b=a[14];function j(S,T){for(var k=T^-1,I=0,C=S.length;I<C;)k=k>>>8^r[(k^S.charCodeAt(I++))&255];return~k}function N(S,T){for(var k=T^-1,I=S.length-15,C=0;C<I;)k=b[S[C++]^k&255]^w[S[C++]^k>>8&255]^y[S[C++]^k>>16&255]^g[S[C++]^k>>>24]^x[S[C++]]^p[S[C++]]^h[S[C++]]^m[S[C++]]^f[S[C++]]^u[S[C++]]^d[S[C++]]^c[S[C++]]^l[S[C++]]^o[S[C++]]^i[S[C++]]^r[S[C++]];for(I+=15;C<I;)k=k>>>8^r[(k^S[C++])&255];return~k}function E(S,T){for(var k=T^-1,I=0,C=S.length,A=0,L=0;I<C;)A=S.charCodeAt(I++),A<128?k=k>>>8^r[(k^A)&255]:A<2048?(k=k>>>8^r[(k^(192|A>>6&31))&255],k=k>>>8^r[(k^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,L=S.charCodeAt(I++)&1023,k=k>>>8^r[(k^(240|A>>8&7))&255],k=k>>>8^r[(k^(128|A>>2&63))&255],k=k>>>8^r[(k^(128|L>>6&15|(A&3)<<4))&255],k=k>>>8^r[(k^(128|L&63))&255]):(k=k>>>8^r[(k^(224|A>>12&15))&255],k=k>>>8^r[(k^(128|A>>6&63))&255],k=k>>>8^r[(k^(128|A&63))&255]);return~k}return e.table=r,e.bstr=j,e.buf=N,e.str=E,e})(),Ue=(function(){var t={};t.version="1.2.1";function r(R,q){for(var B=R.split("/"),H=q.split("/"),K=0,X=0,ue=Math.min(B.length,H.length);K<ue;++K){if(X=B[K].length-H[K].length)return X;if(B[K]!=H[K])return B[K]<H[K]?-1:1}return B.length-H.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var q=R.lastIndexOf("/");return q===-1?R:R.slice(0,q+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var q=R.lastIndexOf("/");return q===-1?R:R.slice(q+1)}function i(R,q){typeof q=="string"&&(q=new Date(q));var B=q.getHours();B=B<<6|q.getMinutes(),B=B<<5|q.getSeconds()>>>1,R.write_shift(2,B);var H=q.getFullYear()-1980;H=H<<4|q.getMonth()+1,H=H<<5|q.getDate(),R.write_shift(2,H)}function o(R){var q=R.read_shift(2)&65535,B=R.read_shift(2)&65535,H=new Date,K=B&31;B>>>=5;var X=B&15;B>>>=4,H.setMilliseconds(0),H.setFullYear(B+1980),H.setMonth(X-1),H.setDate(K);var ue=q&31;q>>>=5;var be=q&63;return q>>>=6,H.setHours(q),H.setMinutes(be),H.setSeconds(ue<<1),H}function l(R){Ir(R,0);for(var q={},B=0;R.l<=R.length-4;){var H=R.read_shift(2),K=R.read_shift(2),X=R.l+K,ue={};switch(H){case 21589:B=R.read_shift(1),B&1&&(ue.mtime=R.read_shift(4)),K>5&&(B&2&&(ue.atime=R.read_shift(4)),B&4&&(ue.ctime=R.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}R.l=X,q[H]=ue}return q}var c;function d(){return c||(c={})}function u(R,q){if(R[0]==80&&R[1]==75)return e1(R,q);if((R[0]|32)==109&&(R[1]|32)==105)return ZC(R,q);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var B=3,H=512,K=0,X=0,ue=0,be=0,de=0,me=[],he=R.slice(0,512);Ir(he,0);var Ne=f(he);switch(B=Ne[0],B){case 3:H=512;break;case 4:H=4096;break;case 0:if(Ne[1]==0)return e1(R,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}H!==512&&(he=R.slice(0,H),Ir(he,28));var Oe=R.slice(0,H);m(he,B);var Me=he.read_shift(4,"i");if(B===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);he.l+=4,ue=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),be=he.read_shift(4,"i"),K=he.read_shift(4,"i"),de=he.read_shift(4,"i"),X=he.read_shift(4,"i");for(var Ee=-1,De=0;De<109&&(Ee=he.read_shift(4,"i"),!(Ee<0));++De)me[De]=Ee;var Xe=h(R,H);g(de,X,Xe,H,me);var Dt=w(Xe,ue,me,H);Dt[ue].name="!Directory",K>0&&be!==L&&(Dt[be].name="!MiniFAT"),Dt[me[0]].name="!FAT",Dt.fat_addrs=me,Dt.ssz=H;var It={},zr=[],Mo=[],Lo=[];b(ue,Dt,Xe,zr,K,It,Mo,be),p(Mo,Lo,zr),zr.shift();var Bo={FileIndex:Mo,FullPaths:Lo};return q&&q.raw&&(Bo.raw={header:Oe,sectors:Xe}),Bo}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(_,"Header Signature: "),R.l+=16;var q=R.read_shift(2,"u");return[R.read_shift(2,"u"),q]}function m(R,q){var B=9;switch(R.l+=2,B=R.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function h(R,q){for(var B=Math.ceil(R.length/q)-1,H=[],K=1;K<B;++K)H[K-1]=R.slice(K*q,(K+1)*q);return H[B-1]=R.slice(B*q),H}function p(R,q,B){for(var H=0,K=0,X=0,ue=0,be=0,de=B.length,me=[],he=[];H<de;++H)me[H]=he[H]=H,q[H]=B[H];for(;be<he.length;++be)H=he[be],K=R[H].L,X=R[H].R,ue=R[H].C,me[H]===H&&(K!==-1&&me[K]!==K&&(me[H]=me[K]),X!==-1&&me[X]!==X&&(me[H]=me[X])),ue!==-1&&(me[ue]=H),K!==-1&&H!=me[H]&&(me[K]=me[H],he.lastIndexOf(K)<be&&he.push(K)),X!==-1&&H!=me[H]&&(me[X]=me[H],he.lastIndexOf(X)<be&&he.push(X));for(H=1;H<de;++H)me[H]===H&&(X!==-1&&me[X]!==X?me[H]=me[X]:K!==-1&&me[K]!==K&&(me[H]=me[K]));for(H=1;H<de;++H)if(R[H].type!==0){if(be=H,be!=me[be])do be=me[be],q[H]=q[be]+"/"+q[H];while(be!==0&&me[be]!==-1&&be!=me[be]);me[H]=-1}for(q[0]+="/",H=1;H<de;++H)R[H].type!==2&&(q[H]+="/")}function x(R,q,B){for(var H=R.start,K=R.size,X=[],ue=H;B&&K>0&&ue>=0;)X.push(q.slice(ue*A,ue*A+A)),K-=A,ue=Ks(B,ue*4);return X.length===0?ve(0):Er(X).slice(0,R.size)}function g(R,q,B,H,K){var X=L;if(R===L){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ue=B[R],be=(H>>>2)-1;if(!ue)return;for(var de=0;de<be&&(X=Ks(ue,de*4))!==L;++de)K.push(X);g(Ks(ue,H-4),q-1,B,H,K)}}function y(R,q,B,H,K){var X=[],ue=[];K||(K=[]);var be=H-1,de=0,me=0;for(de=q;de>=0;){K[de]=!0,X[X.length]=de,ue.push(R[de]);var he=B[Math.floor(de*4/H)];if(me=de*4&be,H<4+me)throw new Error("FAT boundary crossed: "+de+" 4 "+H);if(!R[he])break;de=Ks(R[he],me)}return{nodes:X,data:Y2([ue])}}function w(R,q,B,H){var K=R.length,X=[],ue=[],be=[],de=[],me=H-1,he=0,Ne=0,Oe=0,Me=0;for(he=0;he<K;++he)if(be=[],Oe=he+q,Oe>=K&&(Oe-=K),!ue[Oe]){de=[];var Ee=[];for(Ne=Oe;Ne>=0;){Ee[Ne]=!0,ue[Ne]=!0,be[be.length]=Ne,de.push(R[Ne]);var De=B[Math.floor(Ne*4/H)];if(Me=Ne*4&me,H<4+Me)throw new Error("FAT boundary crossed: "+Ne+" 4 "+H);if(!R[De]||(Ne=Ks(R[De],Me),Ee[Ne]))break}X[Oe]={nodes:be,data:Y2([de])}}return X}function b(R,q,B,H,K,X,ue,be){for(var de=0,me=H.length?2:0,he=q[R].data,Ne=0,Oe=0,Me;Ne<he.length;Ne+=128){var Ee=he.slice(Ne,Ne+128);Ir(Ee,64),Oe=Ee.read_shift(2),Me=bv(Ee,0,Oe-me),H.push(Me);var De={name:Me,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Xe=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Xe!==0&&(De.ct=j(Ee,Ee.l-8));var Dt=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Dt!==0&&(De.mt=j(Ee,Ee.l-8)),De.start=Ee.read_shift(4,"i"),De.size=Ee.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=L,De.name=""),De.type===5?(de=De.start,K>0&&de!==L&&(q[de].name="!StreamData")):De.size>=4096?(De.storage="fat",q[De.start]===void 0&&(q[De.start]=y(B,De.start,q.fat_addrs,q.ssz)),q[De.start].name=De.name,De.content=q[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:de!==L&&De.start!==L&&q[de]&&(De.content=x(De,q[de].data,(q[be]||{}).data))),De.content&&Ir(De.content,0),X[Me]=De,ue.push(De)}}function j(R,q){return new Date((Cn(R,q+4)/1e7*Math.pow(2,32)+Cn(R,q)/1e7-11644473600)*1e3)}function N(R,q){return d(),u(c.readFileSync(R),q)}function E(R,q){var B=q&&q.type;switch(B||et&&Buffer.isBuffer(R)&&(B="buffer"),B||"base64"){case"file":return N(R,q);case"base64":return u(Pn(Bn(R)),q);case"binary":return u(Pn(R),q)}return u(R,q)}function S(R,q){var B=q||{},H=B.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=H+"/",R.FileIndex[0]={name:H,type:5}),B.CLSID&&(R.FileIndex[0].clsid=B.CLSID),T(R)}function T(R){var q="Sh33tJ5";if(!Ue.find(R,"/"+q)){var B=ve(4);B[0]=55,B[1]=B[3]=50,B[2]=54,R.FileIndex.push({name:q,type:2,content:B,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+q),k(R)}}function k(R,q){S(R);for(var B=!1,H=!1,K=R.FullPaths.length-1;K>=0;--K){var X=R.FileIndex[K];switch(X.type){case 0:H?B=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(X.R*X.L*X.C)&&(B=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!q)){var ue=new Date(1987,1,19),be=0,de=Object.create?Object.create(null):{},me=[];for(K=0;K<R.FullPaths.length;++K)de[R.FullPaths[K]]=!0,R.FileIndex[K].type!==0&&me.push([R.FullPaths[K],R.FileIndex[K]]);for(K=0;K<me.length;++K){var he=n(me[K][0]);H=de[he],H||(me.push([he,{name:a(he).replace("/",""),type:1,clsid:Y,ct:ue,mt:ue,content:null}]),de[he]=!0)}for(me.sort(function(Me,Ee){return r(Me[0],Ee[0])}),R.FullPaths=[],R.FileIndex=[],K=0;K<me.length;++K)R.FullPaths[K]=me[K][0],R.FileIndex[K]=me[K][1];for(K=0;K<me.length;++K){var Ne=R.FileIndex[K],Oe=R.FullPaths[K];if(Ne.name=a(Oe).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Y,K===0)Ne.C=me.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Oe.slice(-1)=="/"){for(be=K+1;be<me.length&&n(R.FullPaths[be])!=Oe;++be);for(Ne.C=be>=me.length?-1:be,be=K+1;be<me.length&&n(R.FullPaths[be])!=n(Oe);++be);Ne.R=be>=me.length?-1:be,Ne.type=1}else n(R.FullPaths[K+1]||"")==n(Oe)&&(Ne.R=K+1),Ne.type=2}}}function I(R,q){var B=q||{};if(B.fileType=="mad")return JC(R,B);switch(k(R),B.fileType){case"zip":return VC(R,B)}var H=(function(Me){for(var Ee=0,De=0,Xe=0;Xe<Me.FileIndex.length;++Xe){var Dt=Me.FileIndex[Xe];if(Dt.content){var It=Dt.content.length;It>0&&(It<4096?Ee+=It+63>>6:De+=It+511>>9)}}for(var zr=Me.FullPaths.length+3>>2,Mo=Ee+7>>3,Lo=Ee+127>>7,Bo=Mo+De+zr+Lo,Ws=Bo+127>>7,df=Ws<=109?0:Math.ceil((Ws-109)/127);Bo+Ws+df+127>>7>Ws;)df=++Ws<=109?0:Math.ceil((Ws-109)/127);var Fa=[1,df,Ws,Lo,zr,De,Ee,0];return Me.FileIndex[0].size=Ee<<6,Fa[7]=(Me.FileIndex[0].start=Fa[0]+Fa[1]+Fa[2]+Fa[3]+Fa[4]+Fa[5])+(Fa[6]+7>>3),Fa})(R),K=ve(H[7]<<9),X=0,ue=0;{for(X=0;X<8;++X)K.write_shift(1,W[X]);for(X=0;X<8;++X)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),X=0;X<3;++X)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,H[2]),K.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:L),K.write_shift(4,H[3]),K.write_shift(-4,H[1]?H[0]-1:L),K.write_shift(4,H[1]),X=0;X<109;++X)K.write_shift(-4,X<H[2]?H[1]+X:-1)}if(H[1])for(ue=0;ue<H[1];++ue){for(;X<236+ue*127;++X)K.write_shift(-4,X<H[2]?H[1]+X:-1);K.write_shift(-4,ue===H[1]-1?L:ue+1)}var be=function(Me){for(ue+=Me;X<ue-1;++X)K.write_shift(-4,X+1);Me&&(++X,K.write_shift(-4,L))};for(ue=X=0,ue+=H[1];X<ue;++X)K.write_shift(-4,Q.DIFSECT);for(ue+=H[2];X<ue;++X)K.write_shift(-4,Q.FATSECT);be(H[3]),be(H[4]);for(var de=0,me=0,he=R.FileIndex[0];de<R.FileIndex.length;++de)he=R.FileIndex[de],he.content&&(me=he.content.length,!(me<4096)&&(he.start=ue,be(me+511>>9)));for(be(H[6]+7>>3);K.l&511;)K.write_shift(-4,Q.ENDOFCHAIN);for(ue=X=0,de=0;de<R.FileIndex.length;++de)he=R.FileIndex[de],he.content&&(me=he.content.length,!(!me||me>=4096)&&(he.start=ue,be(me+63>>6)));for(;K.l&511;)K.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<H[4]<<2;++X){var Ne=R.FullPaths[X];if(!Ne||Ne.length===0){for(de=0;de<17;++de)K.write_shift(4,0);for(de=0;de<3;++de)K.write_shift(4,-1);for(de=0;de<12;++de)K.write_shift(4,0);continue}he=R.FileIndex[X],X===0&&(he.start=he.size?he.start-1:L);var Oe=X===0&&B.root||he.name;if(me=2*(Oe.length+1),K.write_shift(64,Oe,"utf16le"),K.write_shift(2,me),K.write_shift(1,he.type),K.write_shift(1,he.color),K.write_shift(-4,he.L),K.write_shift(-4,he.R),K.write_shift(-4,he.C),he.clsid)K.write_shift(16,he.clsid,"hex");else for(de=0;de<4;++de)K.write_shift(4,0);K.write_shift(4,he.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,he.start),K.write_shift(4,he.size),K.write_shift(4,0)}for(X=1;X<R.FileIndex.length;++X)if(he=R.FileIndex[X],he.size>=4096)if(K.l=he.start+1<<9,et&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+511&-512;else{for(de=0;de<he.size;++de)K.write_shift(1,he.content[de]);for(;de&511;++de)K.write_shift(1,0)}for(X=1;X<R.FileIndex.length;++X)if(he=R.FileIndex[X],he.size>0&&he.size<4096)if(et&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+63&-64;else{for(de=0;de<he.size;++de)K.write_shift(1,he.content[de]);for(;de&63;++de)K.write_shift(1,0)}if(et)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function C(R,q){var B=R.FullPaths.map(function(de){return de.toUpperCase()}),H=B.map(function(de){var me=de.split("/");return me[me.length-(de.slice(-1)=="/"?2:1)]}),K=!1;q.charCodeAt(0)===47?(K=!0,q=B[0].slice(0,-1)+q):K=q.indexOf("/")!==-1;var X=q.toUpperCase(),ue=K===!0?B.indexOf(X):H.indexOf(X);if(ue!==-1)return R.FileIndex[ue];var be=!X.match(el);for(X=X.replace(un,""),be&&(X=X.replace(el,"!")),ue=0;ue<B.length;++ue)if((be?B[ue].replace(el,"!"):B[ue]).replace(un,"")==X||(be?H[ue].replace(el,"!"):H[ue]).replace(un,"")==X)return R.FileIndex[ue];return null}var A=64,L=-2,_="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:_,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(R,q,B){d();var H=I(R,B);c.writeFileSync(q,H)}function U(R){for(var q=new Array(R.length),B=0;B<R.length;++B)q[B]=String.fromCharCode(R[B]);return q.join("")}function ie(R,q){var B=I(R,q);switch(q&&q.type||"buffer"){case"file":return d(),c.writeFileSync(q.filename,B),B;case"binary":return typeof B=="string"?B:U(B);case"base64":return Cl(typeof B=="string"?B:U(B));case"buffer":if(et)return Buffer.isBuffer(B)?B:ds(B);case"array":return typeof B=="string"?Pn(B):B}return B}var re;function M(R){try{var q=R.InflateRaw,B=new q;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)re=R;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function z(R,q){if(!re)return Jv(R,q);var B=re.InflateRaw,H=new B,K=H._processChunk(R.slice(R.l),H._finishFlushFlag);return R.l+=H.bytesRead,K}function V(R){return re?re.deflateRawSync(R):rt(R)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(R){var q=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(q>>16|q>>8|q)&255}for(var ne=typeof Uint8Array<"u",ae=ne?new Uint8Array(256):[],le=0;le<256;++le)ae[le]=ye(le);function D(R,q){var B=ae[R&255];return q<=8?B>>>8-q:(B=B<<8|ae[R>>8&255],q<=16?B>>>16-q:(B=B<<8|ae[R>>16&255],B>>>24-q))}function Ae(R,q){var B=q&7,H=q>>>3;return(R[H]|(B<=6?0:R[H+1]<<8))>>>B&3}function Ie(R,q){var B=q&7,H=q>>>3;return(R[H]|(B<=5?0:R[H+1]<<8))>>>B&7}function Ke(R,q){var B=q&7,H=q>>>3;return(R[H]|(B<=4?0:R[H+1]<<8))>>>B&15}function Re(R,q){var B=q&7,H=q>>>3;return(R[H]|(B<=3?0:R[H+1]<<8))>>>B&31}function Se(R,q){var B=q&7,H=q>>>3;return(R[H]|(B<=1?0:R[H+1]<<8))>>>B&127}function He(R,q,B){var H=q&7,K=q>>>3,X=(1<<B)-1,ue=R[K]>>>H;return B<8-H||(ue|=R[K+1]<<8-H,B<16-H)||(ue|=R[K+2]<<16-H,B<24-H)||(ue|=R[K+3]<<24-H),ue&X}function Pe(R,q,B){var H=q&7,K=q>>>3;return H<=5?R[K]|=(B&7)<<H:(R[K]|=B<<H&255,R[K+1]=(B&7)>>8-H),q+3}function Fe(R,q,B){var H=q&7,K=q>>>3;return B=(B&1)<<H,R[K]|=B,q+1}function Wt(R,q,B){var H=q&7,K=q>>>3;return B<<=H,R[K]|=B&255,B>>>=8,R[K+1]=B,q+8}function ar(R,q,B){var H=q&7,K=q>>>3;return B<<=H,R[K]|=B&255,B>>>=8,R[K+1]=B&255,R[K+2]=B>>>8,q+16}function yt(R,q){var B=R.length,H=2*B>q?2*B:q+5,K=0;if(B>=q)return R;if(et){var X=C2(H);if(R.copy)R.copy(X);else for(;K<R.length;++K)X[K]=R[K];return X}else if(ne){var ue=new Uint8Array(H);if(ue.set)ue.set(R);else for(;K<B;++K)ue[K]=R[K];return ue}return R.length=H,R}function Xt(R){for(var q=new Array(R),B=0;B<R;++B)q[B]=0;return q}function $r(R,q,B){var H=1,K=0,X=0,ue=0,be=0,de=R.length,me=ne?new Uint16Array(32):Xt(32);for(X=0;X<32;++X)me[X]=0;for(X=de;X<B;++X)R[X]=0;de=R.length;var he=ne?new Uint16Array(de):Xt(de);for(X=0;X<de;++X)me[K=R[X]]++,H<K&&(H=K),he[X]=0;for(me[0]=0,X=1;X<=H;++X)me[X+16]=be=be+me[X-1]<<1;for(X=0;X<de;++X)be=R[X],be!=0&&(he[X]=me[be+16]++);var Ne=0;for(X=0;X<de;++X)if(Ne=R[X],Ne!=0)for(be=D(he[X],H)>>H-Ne,ue=(1<<H+4-Ne)-1;ue>=0;--ue)q[be|ue<<Ne]=Ne&15|X<<4;return H}var ms=ne?new Uint16Array(512):Xt(512),Fo=ne?new Uint16Array(32):Xt(32);if(!ne){for(var rn=0;rn<512;++rn)ms[rn]=0;for(rn=0;rn<32;++rn)Fo[rn]=0}(function(){for(var R=[],q=0;q<32;q++)R.push(5);$r(R,Fo,32);var B=[];for(q=0;q<=143;q++)B.push(8);for(;q<=255;q++)B.push(9);for(;q<=279;q++)B.push(7);for(;q<=287;q++)B.push(8);$r(B,ms,288)})();var wa=(function(){for(var q=ne?new Uint8Array(32768):[],B=0,H=0;B<oe.length-1;++B)for(;H<oe[B+1];++H)q[H]=B;for(;H<32768;++H)q[H]=29;var K=ne?new Uint8Array(259):[];for(B=0,H=0;B<Z.length-1;++B)for(;H<Z[B+1];++H)K[H]=B;function X(be,de){for(var me=0;me<be.length;){var he=Math.min(65535,be.length-me),Ne=me+he==be.length;for(de.write_shift(1,+Ne),de.write_shift(2,he),de.write_shift(2,~he&65535);he-- >0;)de[de.l++]=be[me++]}return de.l}function ue(be,de){for(var me=0,he=0,Ne=ne?new Uint16Array(32768):[];he<be.length;){var Oe=Math.min(65535,be.length-he);if(Oe<10){for(me=Pe(de,me,+(he+Oe==be.length)),me&7&&(me+=8-(me&7)),de.l=me/8|0,de.write_shift(2,Oe),de.write_shift(2,~Oe&65535);Oe-- >0;)de[de.l++]=be[he++];me=de.l*8;continue}me=Pe(de,me,+(he+Oe==be.length)+2);for(var Me=0;Oe-- >0;){var Ee=be[he];Me=(Me<<5^Ee)&32767;var De=-1,Xe=0;if((De=Ne[Me])&&(De|=he&-32768,De>he&&(De-=32768),De<he))for(;be[De+Xe]==be[he+Xe]&&Xe<250;)++Xe;if(Xe>2){Ee=K[Xe],Ee<=22?me=Wt(de,me,ae[Ee+1]>>1)-1:(Wt(de,me,3),me+=5,Wt(de,me,ae[Ee-23]>>5),me+=3);var Dt=Ee<8?0:Ee-4>>2;Dt>0&&(ar(de,me,Xe-Z[Ee]),me+=Dt),Ee=q[he-De],me=Wt(de,me,ae[Ee]>>3),me-=3;var It=Ee<4?0:Ee-2>>1;It>0&&(ar(de,me,he-De-oe[Ee]),me+=It);for(var zr=0;zr<Xe;++zr)Ne[Me]=he&32767,Me=(Me<<5^be[he])&32767,++he;Oe-=Xe-1}else Ee<=143?Ee=Ee+48:me=Fe(de,me,1),me=Wt(de,me,ae[Ee]),Ne[Me]=he&32767,++he}me=Wt(de,me,0)-1}return de.l=(me+7)/8|0,de.l}return function(de,me){return de.length<8?X(de,me):ue(de,me)}})();function rt(R){var q=ve(50+Math.floor(R.length*1.1)),B=wa(R,q);return q.slice(0,B)}var Zt=ne?new Uint16Array(32768):Xt(32768),zn=ne?new Uint16Array(32768):Xt(32768),hr=ne?new Uint16Array(128):Xt(128),Us=1,Zv=1;function UC(R,q){var B=Re(R,q)+257;q+=5;var H=Re(R,q)+1;q+=5;var K=Ke(R,q)+4;q+=4;for(var X=0,ue=ne?new Uint8Array(19):Xt(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,me=ne?new Uint8Array(8):Xt(8),he=ne?new Uint8Array(8):Xt(8),Ne=ue.length,Oe=0;Oe<K;++Oe)ue[P[Oe]]=X=Ie(R,q),de<X&&(de=X),me[X]++,q+=3;var Me=0;for(me[0]=0,Oe=1;Oe<=de;++Oe)he[Oe]=Me=Me+me[Oe-1]<<1;for(Oe=0;Oe<Ne;++Oe)(Me=ue[Oe])!=0&&(be[Oe]=he[Me]++);var Ee=0;for(Oe=0;Oe<Ne;++Oe)if(Ee=ue[Oe],Ee!=0){Me=ae[be[Oe]]>>8-Ee;for(var De=(1<<7-Ee)-1;De>=0;--De)hr[Me|De<<Ee]=Ee&7|Oe<<3}var Xe=[];for(de=1;Xe.length<B+H;)switch(Me=hr[Se(R,q)],q+=Me&7,Me>>>=3){case 16:for(X=3+Ae(R,q),q+=2,Me=Xe[Xe.length-1];X-- >0;)Xe.push(Me);break;case 17:for(X=3+Ie(R,q),q+=3;X-- >0;)Xe.push(0);break;case 18:for(X=11+Se(R,q),q+=7;X-- >0;)Xe.push(0);break;default:Xe.push(Me),de<Me&&(de=Me);break}var Dt=Xe.slice(0,B),It=Xe.slice(B);for(Oe=B;Oe<286;++Oe)Dt[Oe]=0;for(Oe=H;Oe<30;++Oe)It[Oe]=0;return Us=$r(Dt,Zt,286),Zv=$r(It,zn,30),q}function WC(R,q){if(R[0]==3&&!(R[1]&3))return[Cs(q),2];for(var B=0,H=0,K=C2(q||1<<18),X=0,ue=K.length>>>0,be=0,de=0;(H&1)==0;){if(H=Ie(R,B),B+=3,H>>>1)H>>1==1?(be=9,de=5):(B=UC(R,B),be=Us,de=Zv);else{B&7&&(B+=8-(B&7));var me=R[B>>>3]|R[(B>>>3)+1]<<8;if(B+=32,me>0)for(!q&&ue<X+me&&(K=yt(K,X+me),ue=K.length);me-- >0;)K[X++]=R[B>>>3],B+=8;continue}for(;;){!q&&ue<X+32767&&(K=yt(K,X+32767),ue=K.length);var he=He(R,B,be),Ne=H>>>1==1?ms[he]:Zt[he];if(B+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)K[X++]=Ne;else{if(Ne==256)break;Ne-=257;var Oe=Ne<8?0:Ne-4>>2;Oe>5&&(Oe=0);var Me=X+Z[Ne];Oe>0&&(Me+=He(R,B,Oe),B+=Oe),he=He(R,B,de),Ne=H>>>1==1?Fo[he]:zn[he],B+=Ne&15,Ne>>>=4;var Ee=Ne<4?0:Ne-2>>1,De=oe[Ne];for(Ee>0&&(De+=He(R,B,Ee),B+=Ee),!q&&ue<Me&&(K=yt(K,Me+100),ue=K.length);X<Me;)K[X]=K[X-De],++X}}}return q?[K,B+7>>>3]:[K.slice(0,X),B+7>>>3]}function Jv(R,q){var B=R.slice(R.l||0),H=WC(B,q);return R.l+=H[1],H[0]}function Qv(R,q){if(R)typeof console<"u"&&console.error(q);else throw new Error(q)}function e1(R,q){var B=R;Ir(B,0);var H=[],K=[],X={FileIndex:H,FullPaths:K};S(X,{root:q.root});for(var ue=B.length-4;(B[ue]!=80||B[ue+1]!=75||B[ue+2]!=5||B[ue+3]!=6)&&ue>=0;)--ue;B.l=ue+4,B.l+=4;var be=B.read_shift(2);B.l+=6;var de=B.read_shift(4);for(B.l=de,ue=0;ue<be;++ue){B.l+=20;var me=B.read_shift(4),he=B.read_shift(4),Ne=B.read_shift(2),Oe=B.read_shift(2),Me=B.read_shift(2);B.l+=8;var Ee=B.read_shift(4),De=l(B.slice(B.l+Ne,B.l+Ne+Oe));B.l+=Ne+Oe+Me;var Xe=B.l;B.l=Ee+4,HC(B,me,he,X,De),B.l=Xe}return X}function HC(R,q,B,H,K){R.l+=2;var X=R.read_shift(2),ue=R.read_shift(2),be=o(R);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var de=R.read_shift(4),me=R.read_shift(4),he=R.read_shift(4),Ne=R.read_shift(2),Oe=R.read_shift(2),Me="",Ee=0;Ee<Ne;++Ee)Me+=String.fromCharCode(R[R.l++]);if(Oe){var De=l(R.slice(R.l,R.l+Oe));(De[21589]||{}).mt&&(be=De[21589].mt),((K||{})[21589]||{}).mt&&(be=K[21589].mt)}R.l+=Oe;var Xe=R.slice(R.l,R.l+me);switch(ue){case 8:Xe=z(R,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Dt=!1;X&8&&(de=R.read_shift(4),de==134695760&&(de=R.read_shift(4),Dt=!0),me=R.read_shift(4),he=R.read_shift(4)),me!=q&&Qv(Dt,"Bad compressed size: "+q+" != "+me),he!=B&&Qv(Dt,"Bad uncompressed size: "+B+" != "+he),cf(H,Me,Xe,{unsafe:!0,mt:be})}function VC(R,q){var B=q||{},H=[],K=[],X=ve(1),ue=B.compression?8:0,be=0,de=0,me=0,he=0,Ne=0,Oe=R.FullPaths[0],Me=Oe,Ee=R.FileIndex[0],De=[],Xe=0;for(de=1;de<R.FullPaths.length;++de)if(Me=R.FullPaths[de].slice(Oe.length),Ee=R.FileIndex[de],!(!Ee.size||!Ee.content||Me=="Sh33tJ5")){var Dt=he,It=ve(Me.length);for(me=0;me<Me.length;++me)It.write_shift(1,Me.charCodeAt(me)&127);It=It.slice(0,It.l),De[Ne]=IK.buf(Ee.content,0);var zr=Ee.content;ue==8&&(zr=V(zr)),X=ve(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,be),X.write_shift(2,ue),Ee.mt?i(X,Ee.mt):X.write_shift(4,0),X.write_shift(-4,De[Ne]),X.write_shift(4,zr.length),X.write_shift(4,Ee.content.length),X.write_shift(2,It.length),X.write_shift(2,0),he+=X.length,H.push(X),he+=It.length,H.push(It),he+=zr.length,H.push(zr),X=ve(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,be),X.write_shift(2,ue),X.write_shift(4,0),X.write_shift(-4,De[Ne]),X.write_shift(4,zr.length),X.write_shift(4,Ee.content.length),X.write_shift(2,It.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Dt),Xe+=X.l,K.push(X),Xe+=It.length,K.push(It),++Ne}return X=ve(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Ne),X.write_shift(2,Ne),X.write_shift(4,Xe),X.write_shift(4,he),X.write_shift(2,0),Er([Er(H),Er(K),X])}var Ec={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function GC(R,q){if(R.ctype)return R.ctype;var B=R.name||"",H=B.match(/\.([^\.]+)$/);return H&&Ec[H[1]]||q&&(H=(B=q).match(/[\.\\]([^\.\\])+$/),H&&Ec[H[1]])?Ec[H[1]]:"application/octet-stream"}function qC(R){for(var q=Cl(R),B=[],H=0;H<q.length;H+=76)B.push(q.slice(H,H+76));return B.join(`\r
`)+`\r
`}function KC(R){var q=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var he=me.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],H=q.split(`\r
`),K=0;K<H.length;++K){var X=H[K];if(X.length==0){B.push("");continue}for(var ue=0;ue<X.length;){var be=76,de=X.slice(ue,ue+be);de.charAt(be-1)=="="?be--:de.charAt(be-2)=="="?be-=2:de.charAt(be-3)=="="&&(be-=3),de=X.slice(ue,ue+be),ue+=be,ue<X.length&&(de+="="),B.push(de)}}return B.join(`\r
`)}function YC(R){for(var q=[],B=0;B<R.length;++B){for(var H=R[B];B<=R.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+R[++B];q.push(H)}for(var K=0;K<q.length;++K)q[K]=q[K].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Pn(q.join(`\r
`))}function XC(R,q,B){for(var H="",K="",X="",ue,be=0;be<10;++be){var de=q[be];if(!de||de.match(/^\s*$/))break;var me=de.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":H=me[2].trim();break;case"content-type":X=me[2].trim();break;case"content-transfer-encoding":K=me[2].trim();break}}switch(++be,K.toLowerCase()){case"base64":ue=Pn(Bn(q.slice(be).join("")));break;case"quoted-printable":ue=YC(q.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var he=cf(R,H.slice(B.length),ue,{unsafe:!0});X&&(he.ctype=X)}function ZC(R,q){if(U(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=q&&q.root||"",H=(et&&Buffer.isBuffer(R)?R.toString("binary"):U(R)).split(`\r
`),K=0,X="";for(K=0;K<H.length;++K)if(X=H[K],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),B||(B=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),X.slice(0,B.length)!=B););var ue=(H[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var be="--"+(ue[1]||""),de=[],me=[],he={FileIndex:de,FullPaths:me};S(he);var Ne,Oe=0;for(K=0;K<H.length;++K){var Me=H[K];Me!==be&&Me!==be+"--"||(Oe++&&XC(he,H.slice(Ne,K),B),Ne=K)}return he}function JC(R,q){var B=q||{},H=B.boundary||"SheetJS";H="------="+H;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],X=R.FullPaths[0],ue=X,be=R.FileIndex[0],de=1;de<R.FullPaths.length;++de)if(ue=R.FullPaths[de].slice(X.length),be=R.FileIndex[de],!(!be.size||!be.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var me=be.content,he=et&&Buffer.isBuffer(me)?me.toString("binary"):U(me),Ne=0,Oe=Math.min(1024,he.length),Me=0,Ee=0;Ee<=Oe;++Ee)(Me=he.charCodeAt(Ee))>=32&&Me<128&&++Ne;var De=Ne>=Oe*4/5;K.push(H),K.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+ue),K.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),K.push("Content-Type: "+GC(be,ue)),K.push(""),K.push(De?KC(he):qC(he))}return K.push(H+`--\r
`),K.join(`\r
`)}function QC(R){var q={};return S(q,R),q}function cf(R,q,B,H){var K=H&&H.unsafe;K||S(R);var X=!K&&Ue.find(R,q);if(!X){var ue=R.FullPaths[0];q.slice(0,ue.length)==ue?ue=q:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+q).replace("//","/")),X={name:a(q),type:2},R.FileIndex.push(X),R.FullPaths.push(ue),K||Ue.utils.cfb_gc(R)}return X.content=B,X.size=B?B.length:0,H&&(H.CLSID&&(X.clsid=H.CLSID),H.mt&&(X.mt=H.mt),H.ct&&(X.ct=H.ct)),X}function e4(R,q){S(R);var B=Ue.find(R,q);if(B){for(var H=0;H<R.FileIndex.length;++H)if(R.FileIndex[H]==B)return R.FileIndex.splice(H,1),R.FullPaths.splice(H,1),!0}return!1}function t4(R,q,B){S(R);var H=Ue.find(R,q);if(H){for(var K=0;K<R.FileIndex.length;++K)if(R.FileIndex[K]==H)return R.FileIndex[K].name=a(B),R.FullPaths[K]=B,!0}return!1}function r4(R){k(R,!0)}return t.find=C,t.read=E,t.parse=u,t.write=ie,t.writeFile=J,t.utils={cfb_new:QC,cfb_add:cf,cfb_del:e4,cfb_mov:t4,cfb_gc:r4,ReadShift:sl,CheckField:lk,prep_blob:Ir,bconcat:Er,use_zlib:M,_deflateRaw:rt,_inflateRaw:Jv,consts:Q},t})();function RK(e){return typeof e=="string"?Qu(e):Array.isArray(e)?oK(e):e}function xc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Qu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ka(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([RK(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Bs(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function FK(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Yt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function L2(e,t){for(var r=[],n=Yt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function tf(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function rf(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MK(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ru=new Date(1899,11,30,0,0,0);function vr(e,t){var r=e.getTime(),n=ru.getTime()+(e.getTimezoneOffset()-ru.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var zA=new Date,LK=ru.getTime()+(zA.getTimezoneOffset()-ru.getTimezoneOffset())*6e4,B2=zA.getTimezoneOffset();function nf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+LK),t.getTimezoneOffset()!==B2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-B2)*6e4),t}function BK(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var $2=new Date("2017-02-19T19:06:09.000Z"),UA=isNaN($2.getFullYear())?new Date("2/19/17"):$2,$K=UA.getFullYear()==2017;function At(e,t){var r=new Date(e);if($K)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(UA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function bi(e,t){if(et&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ka(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ka(kA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ka(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ka(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function kt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=kt(e[r]));return t}function Ht(e,t){for(var r="";r.length<t;)r+=e;return r}function pa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var zK=["january","february","march","april","may","june","july","august","september","october","november","december"];function ho(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&zK.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var UK=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}})();function WA(e){return e?e.content&&e.type?bi(e.content,!0):e.data?Qo(e.data):e.asNodeBuffer&&et?Qo(e.asNodeBuffer().toString("binary")):e.asBinary?Qo(e.asBinary()):e._data&&e._data.getContent?Qo(bi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function HA(e){if(!e)return null;if(e.data)return A2(e.data);if(e.asNodeBuffer&&et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?A2(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function WK(e){return e&&e.name.slice(-4)===".bin"?HA(e):WA(e)}function Xn(e,t){for(var r=e.FullPaths||Yt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function hv(e,t){var r=Xn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ir(e,t,r){if(!r)return WK(hv(e,t));if(!t)return null;try{return ir(e,t)}catch{return null}}function Dn(e,t,r){if(!r)return WA(hv(e,t));if(!t)return null;try{return Dn(e,t)}catch{return null}}function HK(e,t,r){return HA(hv(e,t))}function z2(e){for(var t=e.FullPaths||Yt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return et?n=ds(r):n=lK(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function pv(){return Ue.utils.cfb_new()}function VA(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function tl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VK=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,GK=/<[^>]*>/g,en=nr.match(U2)?U2:GK,qK=/<\w*:/,KK=/<(\/?)\w+:/;function qe(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(VK),l=0,c="",d=0,u="",f="",m=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(m=(a=f.charCodeAt(i+1))==34||a==39?1:0,c=f.slice(i+1+m,f.length-m),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Ia(e){return e.replace(KK,"<$1")}var GA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xv=tf(GA),st=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,c){return GA[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}})(),gv=/[&<>'"]/g,YK=/[\u0000-\u0008\u000b-\u001f]/g;function vt(e){var t=e+"";return t.replace(gv,function(r){return xv[r]}).replace(YK,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function W2(e){return vt(e).replace(/ /g,"_x0020_")}var qA=/[\u0000-\u001f]/g;function vv(e){var t=e+"";return t.replace(gv,function(r){return xv[r]}).replace(/\n/g,"<br/>").replace(qA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function XK(e){var t=e+"";return t.replace(gv,function(r){return xv[r]}).replace(qA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var H2=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function ZK(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Tt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q0(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function V2(e){var t=Cs(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function G2(e){return ds(e,"binary").toString("utf8")}var Kc="foo bar baz",bt=et&&(G2(Kc)==Q0(Kc)&&G2||V2(Kc)==Q0(Kc)&&V2)||Q0,ka=et?function(e){return ds(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Pl=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),KA=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),JK=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),QK=/<\/?(?:vt:)?variant>/g,eY=/<(?:vt:)([^>]*)>([\s\S]*)</;function q2(e,t){var r=qe(e),n=e.match(JK(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(QK,"").match(eY);o&&a.push({v:bt(o[2]),t:o[1]})}),a}var YA=/(^\s|\s$|\n)/;function Rr(e,t){return"<"+e+(t.match(YA)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Dl(e){return Yt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _e(e,t,r){return"<"+e+(r!=null?Dl(r):"")+(t!=null?(t.match(YA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function tY(e,t){switch(typeof e){case"string":var r=_e("vt:lpwstr",vt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",vt(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",Mp(e));throw new Error("Unable to serialize "+e)}function yv(e){if(et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return bt(Bs(uv(e)));throw new Error("Bad input format: expected Buffer or string")}var Il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ci=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],kn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function rY(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function nY(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var K2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Y2=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ds(t)})):K2(e)}:K2,X2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ua(e,a)));return n.join("").replace(un,"")},bv=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(un,""):X2(e,t,r)}:X2,Z2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},XA=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Z2(e,t,r)}:Z2,J2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(zi(e,a)));return n.join("")},gc=et?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):J2(t,r,n)}:J2,ZA=function(e,t){var r=Cn(e,t);return r>0?gc(e,t+4,t+4+r-1):""},JA=ZA,QA=function(e,t){var r=Cn(e,t);return r>0?gc(e,t+4,t+4+r-1):""},ek=QA,tk=function(e,t){var r=2*Cn(e,t);return r>0?gc(e,t+4,t+4+r-1):""},rk=tk,nk=function(t,r){var n=Cn(t,r);return n>0?bv(t,r+4,r+4+n):""},ak=nk,sk=function(e,t){var r=Cn(e,t);return r>0?gc(e,t+4,t+4+r):""},ik=sk,ok=function(e,t){return rY(e,t)},nu=ok,wv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};et&&(JA=function(t,r){if(!Buffer.isBuffer(t))return ZA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ek=function(t,r){if(!Buffer.isBuffer(t))return QA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},rk=function(t,r){if(!Buffer.isBuffer(t))return tk(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},ak=function(t,r){if(!Buffer.isBuffer(t))return nk(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},ik=function(t,r){if(!Buffer.isBuffer(t))return sk(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},nu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ok(t,r)},wv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var zi=function(e,t){return e[t]},Ua=function(e,t){return e[t+1]*256+e[t]},aY=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ks=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},sY=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function sl(e,t){var r="",n,a,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ua(this,d)),d+=2;e*=2;break;case"utf8":r=gc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=bv(this,this.l,this.l+e);break;case"wstr":return sl.call(this,e,"dbcs");case"lpstr-ansi":r=JA(this,this.l),e=4+Cn(this,this.l);break;case"lpstr-cp":r=ek(this,this.l),e=4+Cn(this,this.l);break;case"lpwstr":r=rk(this,this.l),e=4+2*Cn(this,this.l);break;case"lpp4":e=4+Cn(this,this.l),r=ak(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cn(this,this.l),r=ik(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=zi(this,this.l+e++))!==0;)i.push(qc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ua(this,this.l+e))!==0;)i.push(qc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=zi(this,d),this.l=d+1,l=sl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(qc(Ua(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=zi(this,d),this.l=d+1,l=sl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(qc(zi(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=zi(this,this.l),this.l++,n;case 2:return n=(t==="i"?aY:Ua)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ks:sY)(this,this.l),this.l+=4,n):(a=Cn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=nu(this,this.l):a=nu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=XA(this,this.l,e);break}}return this.l+=e,r}var iY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},oY=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},lY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function cY(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)lY(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,iY(this,t,this.l);break;case 8:if(n=8,r==="f"){nY(this,t,this.l);break}case 16:break;case-4:n=4,oY(this,t,this.l);break}return this.l+=n,this}function lk(e,t){var r=XA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ir(e,t){e.l=t,e.read_shift=sl,e.chk=lk,e.write_shift=cY}function Jr(e,t){e.l+=t}function ve(e){var t=Cs(e);return Ir(t,0),t}function us(e,t,r){if(e){var n,a,i;Ir(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=$l[l]||$l[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function bn(){var e=[],t=et?256:2048,r=function(d){var u=ve(d);return Ir(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},o=function(){return a(),Er(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function we(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=$l[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&wv(r)&&e.push(r)}}function il(e,t,r){var n=kt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Q2(e,t,r){var n=kt(e);return n.s=il(n.s,t.s,r),n.e=il(n.e,t.s,r),n}function ol(e,t){if(e.cRel&&e.c<0)for(e=kt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=kt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ge(e);return!e.cRel&&e.cRel!=null&&(r=fY(r)),!e.rRel&&e.rRel!=null&&(r=dY(r)),r}function em(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ft(e.s.c)+":"+(e.e.cRel?"":"$")+Ft(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+er(e.s.r)+":"+(e.e.rRel?"":"$")+er(e.e.r):ol(e.s,t.biff)+":"+ol(e.e,t.biff)}function jv(e){return parseInt(uY(e),10)-1}function er(e){return""+(e+1)}function dY(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uY(e){return e.replace(/\$(\d+)$/,"$1")}function Nv(e){for(var t=mY(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ft(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fY(e){return e.replace(/^([A-Z])/,"$$$1")}function mY(e){return e.replace(/^\$([A-Z])/,"$1")}function hY(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ge(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Nn(e){var t=e.indexOf(":");return t==-1?{s:Mt(e),e:Mt(e)}:{s:Mt(e.slice(0,t)),e:Mt(e.slice(t+1))}}function Je(e,t){return typeof t>"u"||typeof t=="number"?Je(e.s,e.e):(typeof e!="string"&&(e=Ge(e)),typeof t!="string"&&(t=Ge(t)),e==t?e:e+":"+t)}function it(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function ej(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=aa(e.z,r?vr(t):t)}catch{}try{return e.w=aa((e.XF||{}).numFmtId||(r?14:0),r?vr(t):t)}catch{return""+t}}function rs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fs[e.v]||e.v:t==null?ej(e,e.v):ej(e,t))}function $s(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ck(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=it(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var h={v:t[f][m]},p=o+f,x=l+m;if(d.s.r>p&&(d.s.r=p),d.s.c>x&&(d.s.c=x),d.e.r<p&&(d.e.r=p),d.e.c<x&&(d.e.c=x),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))h=t[f][m];else if(Array.isArray(h.v)&&(h.f=t[f][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ve[14],n.cellDates?(h.t="d",h.w=aa(h.z,vr(h.v))):(h.t="n",h.v=vr(h.v),h.w=aa(h.z,h.v))):h.t="s";if(a)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(h.z=i[p][x].z),i[p][x]=h;else{var g=Ge({c:x,r:p});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return d.s.c<1e7&&(i["!ref"]=Je(d)),i}function Io(e,t){return ck(null,e,t)}function pY(e){return e.read_shift(4,"i")}function xa(e,t){return t||(t=ve(4)),t.write_shift(4,e),t}function Zr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Tr(e,t){var r=!1;return t==null&&(r=!0,t=ve(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function xY(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function gY(e,t){return t||(t=ve(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ev(e,t){var r=e.l,n=e.read_shift(1),a=Zr(e),i=[],o={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(xY(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function vY(e,t){var r=!1;return t==null&&(r=!0,t=ve(15+4*e.t.length)),t.write_shift(1,0),Tr(e.t,t),r?t.slice(0,t.l):t}var yY=Ev;function bY(e,t){var r=!1;return t==null&&(r=!0,t=ve(23+4*e.t.length)),t.write_shift(1,1),Tr(e.t,t),t.write_shift(4,1),gY({},t),r?t.slice(0,t.l):t}function oa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Oi(e,t){return t==null&&(t=ve(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Pi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Di(e,t){return t==null&&(t=ve(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var wY=Zr,dk=Tr;function Sv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function au(e,t){var r=!1;return t==null&&(r=!0,t=ve(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jY=Zr,Lp=Sv,Tv=au;function _v(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?nu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ks(t,0)>>2;return r?a/100:a}function uk(e,t){t==null&&(t=ve(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function fk(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function NY(e,t){return t||(t=ve(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ii=fk,Ro=NY;function Yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function wi(e,t){return(t||ve(8)).write_shift(8,e,"f")}function EY(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=ii[a];d&&(t.rgb=Fl(d));break;case 2:t.rgb=Fl([o,l,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function su(e,t){if(t||(t=ve(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function SY(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function TY(e,t){t||(t=ve(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function mk(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function _Y(e){return mk(e,1)}function AY(e){return mk(e,2)}var Av=2,pn=3,Yc=11,tj=12,iu=19,Xc=64,kY=65,CY=71,OY=4108,PY=4126,Nr=80,hk=81,DY=[Nr,hk],Bp={1:{n:"CodePage",t:Av},2:{n:"Category",t:Nr},3:{n:"PresentationFormat",t:Nr},4:{n:"ByteCount",t:pn},5:{n:"LineCount",t:pn},6:{n:"ParagraphCount",t:pn},7:{n:"SlideCount",t:pn},8:{n:"NoteCount",t:pn},9:{n:"HiddenCount",t:pn},10:{n:"MultimediaClipCount",t:pn},11:{n:"ScaleCrop",t:Yc},12:{n:"HeadingPairs",t:OY},13:{n:"TitlesOfParts",t:PY},14:{n:"Manager",t:Nr},15:{n:"Company",t:Nr},16:{n:"LinksUpToDate",t:Yc},17:{n:"CharacterCount",t:pn},19:{n:"SharedDoc",t:Yc},22:{n:"HyperlinksChanged",t:Yc},23:{n:"AppVersion",t:pn,p:"version"},24:{n:"DigSig",t:kY},26:{n:"ContentType",t:Nr},27:{n:"ContentStatus",t:Nr},28:{n:"Language",t:Nr},29:{n:"Version",t:Nr},255:{},2147483648:{n:"Locale",t:iu},2147483651:{n:"Behavior",t:iu},1919054434:{}},$p={1:{n:"CodePage",t:Av},2:{n:"Title",t:Nr},3:{n:"Subject",t:Nr},4:{n:"Author",t:Nr},5:{n:"Keywords",t:Nr},6:{n:"Comments",t:Nr},7:{n:"Template",t:Nr},8:{n:"LastAuthor",t:Nr},9:{n:"RevNumber",t:Nr},10:{n:"EditTime",t:Xc},11:{n:"LastPrinted",t:Xc},12:{n:"CreatedDate",t:Xc},13:{n:"ModifiedDate",t:Xc},14:{n:"PageCount",t:pn},15:{n:"WordCount",t:pn},16:{n:"CharCount",t:pn},17:{n:"Thumbnail",t:CY},18:{n:"Application",t:Nr},19:{n:"DocSecurity",t:pn},255:{},2147483648:{n:"Locale",t:iu},2147483651:{n:"Behavior",t:iu},1919054434:{}},rj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},IY=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function RY(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var FY=RY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ii=kt(FY),fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function kv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function MY(e){var t=kv();if(!e||!e.match)return t;var r={};if((e.match(en)||[]).forEach(function(n){var a=qe(n);switch(a[0].replace(qK,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[zp[a.ContentType]]!==void 0&&t[zp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==xr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function xk(e,t){var r=MK(zp),n=[],a;n[n.length]=nr,n[n.length]=_e("Types",null,{xmlns:xr.CT,"xmlns:xsd":xr.xsd,"xmlns:xsi":xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=_e("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Zc[c][t.bookType]||Zc[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Zc[c][t.bookType]||Zc[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ll(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(en)||[]).forEach(function(a){var i=qe(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:tl(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}function Yi(e){var t=[nr,_e("Relationships",null,{xmlns:xr.RELS})];return Yt(e["!id"]).forEach(function(r){t[t.length]=_e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function xt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var LY="application/vnd.oasis.opendocument.spreadsheet";function BY(e,t){for(var r=yv(e),n,a;n=Il.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=qe(n[0],!1),a.path=="/"&&a.type!==LY)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function $Y(e){var t=[nr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function nj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function zY(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function UY(e){var t=[nr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(nj(e[r][0],e[r][1])),t.push(zY("",e[r][0]));return t.push(nj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Jd.version+"</meta:generator></office:meta></office:document-meta>"}var ta=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],WY=(function(){for(var e=new Array(ta.length),t=0;t<ta.length;++t){var r=ta[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function vk(e){var t={};e=bt(e);for(var r=0;r<ta.length;++r){var n=ta[r],a=e.match(WY[r]);a!=null&&a.length>0&&(t[n[1]]=st(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=At(t[n[1]]))}return t}function tm(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=vt(t),n[n.length]=r?_e(e,t,r):Rr(e,t))}function yk(e,t){var r=t||{},n=[nr,_e("cp:coreProperties",null,{"xmlns:cp":xr.CORE_PROPS,"xmlns:dc":xr.dc,"xmlns:dcterms":xr.dcterms,"xmlns:dcmitype":xr.dcmitype,"xmlns:xsi":xr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&tm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Mp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&tm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Mp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=ta.length;++i){var o=ta[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&tm(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var oi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wk(e,t,r,n){var a=[];if(typeof e=="string")a=q2(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?q2(t,n).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(c=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function HY(e,t,r){var n={};return t||(t={}),e=bt(e),oi.forEach(function(a){var i=(e.match(Pl(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=st(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wk(n.HeadingPairs,n.TitlesOfParts,t,r),t}function jk(e){var t=[],r=_e;return e||(e={}),e.Application="SheetJS",t[t.length]=nr,t[t.length]=_e("Properties",null,{xmlns:xr.EXT_PROPS,"xmlns:vt":xr.vt}),oi.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=vt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+vt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var VY=/<[^>]+>[^<]*/g;function GY(e,t){var r={},n="",a=e.match(VY);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=qe(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=st(u);break;case"bool":r[n]=Tt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=At(u);break;case"cy":case"error":r[n]=st(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function Nk(e){var t=[nr,_e("Properties",null,{xmlns:xr.CUST_PROPS,"xmlns:vt":xr.vt})];if(!e)return t.join("");var r=1;return Yt(e).forEach(function(a){++r,t[t.length]=_e("property",tY(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:vt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Up={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rm;function qY(e,t,r){rm||(rm=tf(Up)),t=rm[t]||t,e[t]=r}function KY(e,t){var r=[];return Yt(Up).map(function(n){for(var a=0;a<ta.length;++a)if(ta[a][1]==n)return ta[a];for(a=0;a<oi.length;++a)if(oi[a][1]==n)return oi[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Rr(Up[n[1]]||n[1],a))}}),_e("DocumentProperties",r.join(""),{xmlns:kn.o})}function YY(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Yt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<ta.length;++o)if(i==ta[o][1])return;for(o=0;o<oi.length;++o)if(i==oi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(_e(W2(i),l,{"dt:dt":c}))}}),t&&Yt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(_e(W2(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+kn.o+'">'+a.join("")+"</"+n+">"}function Cv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function XY(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=ve(8);return o.write_shift(4,n),o.write_shift(4,a),o}function Ek(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Sk(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Tk(e,t,r){return t===31?Sk(e):Ek(e,t,r)}function Wp(e,t,r){return Tk(e,t,r===!1?0:4)}function ZY(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Tk(e,t,0)}function JY(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(un,""),e.l-a&2&&(e.l+=2)}return r}function QY(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(un,"");return r}function eX(e){var t=e.l,r=ou(e,hk);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ou(e,pn);return[r,n]}function tX(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(eX(e));return r}function aj(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(un,"").replace(el,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function _k(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rX(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ou(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==tj&&n!==t&&DY.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===tj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ek(e,n,4).replace(un,"");case 31:return Sk(e);case 64:return Cv(e);case 65:return _k(e);case 71:return rX(e);case 80:return Wp(e,n,!i.raw).replace(un,"");case 81:return ZY(e,n).replace(un,"");case 4108:return tX(e);case 4126:case 4127:return n==4127?JY(e):QY(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function sj(e,t){var r=ve(4),n=ve(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ve(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=XY(t);break;case 31:case 80:for(n=ve(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Er([r,n])}function ij(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=a;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(w,b){return w[1]-b[1]});var m={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(m[p.n]=ou(e,p.t,{raw:!0}),p.p==="version"&&(m[p.n]=String(m[p.n]>>16)+"."+("0000"+String(m[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(m[p.n]){case 0:m[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(l=m[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[p.n])}}else if(i[o][0]===1){if(l=m.CodePage=ou(e,Av),ma(l),c!==-1){var x=e.l;e.l=i[c][1],d=aj(e,l),e.l=x}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=aj(e,l)}else{var g=d[i[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=_k(e);break;case 30:e.l+=4,y=Wp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Wp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Jt(e,4);break;case 64:e.l+=4,y=At(Cv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[g]=y}}return e.l=r+n,m}var Ak=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nX(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function oj(e,t,r){var n=ve(8),a=[],i=[],o=8,l=0,c=ve(8),d=ve(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),a.push(d),o+=8+c.length,!t){d=ve(8),d.write_shift(4,0),a.unshift(d);var u=[ve(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=ve(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Er(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Ak.indexOf(e[l][0])>-1||bk.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],h=0;if(t){h=+t[e[l][0]];var p=r[h];if(p.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}c=sj(p.t,m)}else{var g=nX(m);g==-1&&(g=31,m=String(m)),c=sj(g,m)}i.push(c),d=ve(8),d.write_shift(4,t?h:2+l),a.push(d),o+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,y),y+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),Er([n].concat(a).concat(i))}function lj(e,t,r){var n=e.content;if(!n)return{};Ir(n,0);var a,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),u=n.read_shift(16);if(u!==Ue.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=ij(n,t),m={SystemIdentifier:d};for(var h in f)m[h]=f[h];if(m.FMTID=i,a===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=ij(n,null)}catch{}for(h in p)m[h]=p[h];return m.FMTID=[i,o],m}function cj(e,t,r,n,a,i){var o=ve(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ue.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=oj(e,r,n);if(l.push(c),a){var d=oj(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Er(l)}function xs(e,t){return e.read_shift(t),null}function aX(e,t){t||(t=ve(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sX(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Jt(e,t){return e.read_shift(t)===1}function sn(e,t){return t||(t=ve(2)),t.write_shift(2,+!!e),t}function or(e){return e.read_shift(2,"u")}function Zn(e,t){return t||(t=ve(2)),t.write_shift(2,e),t}function kk(e,t){return sX(e,t,or)}function iX(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Ck(e,t,r){return r||(r=ve(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function vc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function oX(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,c={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*o),n&&(e.l+=l),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function lX(e){var t=e.t||"",r=ve(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ve(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Er(a)}function ji(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ji(e,n,r)}function Ri(e,t,r){if(r.biff>5)return yc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ok(e,t,r){return r||(r=ve(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function cX(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function dX(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(un,"");return n&&(e.l+=24),a}function uX(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(un,"");return r+o}function fX(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return dX(e);case"0303000000000000c000000000000046":return uX(e);default:throw new Error("Unsupported Moniker "+r)}}function Jc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(un,""):"";return r}function dj(e,t){t||(t=ve(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function mX(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,f;a&16&&(i=Jc(e,r-e.l)),a&128&&(o=Jc(e,r-e.l)),(a&257)===257&&(l=Jc(e,r-e.l)),(a&257)===1&&(c=fX(e,r-e.l)),a&8&&(d=Jc(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=Cv(e)),e.l=r;var m=o||l||c||"";m&&d&&(m+="#"+d),m||(m="#"+d),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function hX(e){var t=ve(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),dj(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&dj(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Pk(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Dk(e,t){var r=Pk(e);return r[3]=0,r}function Ra(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ni(e,t,r,n){return n||(n=ve(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function pX(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function xX(e,t,r){return t===0?"":Ri(e,t,r)}function gX(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function Ik(e){var t=e.read_shift(2),r=_v(e);return[t,r]}function vX(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=vc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function af(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Rk(e,t){return t||(t=ve(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Fk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var yX=Fk;function Mk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function bX(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function wX(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ur(e){e.l+=2,e.l+=e.read_shift(2)}var jX={0:Ur,4:Ur,5:Ur,6:Ur,7:wX,8:Ur,9:Ur,10:Ur,11:Ur,12:Ur,13:bX,14:Ur,15:Ur,16:Ur,17:Ur,18:Ur,19:Ur,20:Ur,21:Mk};function NX(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(jX[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Qc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ov(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ve(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function EX(e,t){return t===0||e.read_shift(2),1200}function SX(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ri(e,0,r);return e.read_shift(t+n-e.l),a}function TX(e,t){var r=!t||t.biff==8,n=ve(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _X(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function AX(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=vc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function kX(e,t){var r=!t||t.biff>=8?2:1,n=ve(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function CX(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(oX(e));return i.Count=n,i.Unique=a,i}function OX(e,t){var r=ve(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=lX(e[a]);var i=Er([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function PX(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function DX(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function IX(e){var t=pX(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function RX(e){return e.read_shift(2),e.read_shift(4)}function uj(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function FX(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function MX(){var e=ve(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function LX(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function BX(e){var t=ve(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function $X(){}function zX(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=vc(e,0,r),n}function UX(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=ve(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function WX(e){var t=Ra(e);return t.isst=e.read_shift(4),t}function HX(e,t,r,n){var a=ve(10);return Ni(e,t,n,a),a.write_shift(4,r),a}function VX(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ra(e);r.biff==2&&e.l++;var i=yc(e,n-e.l,r);return a.val=i,a}function GX(e,t,r,n,a){var i=!a||a.biff==8,o=ve(8+ +i+(1+i)*r.length);return Ni(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function qX(e,t,r){var n=e.read_shift(2),a=Ri(e,0,r);return[n,a]}function KX(e,t,r,n){var a=r&&r.biff==5;n||(n=ve(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var YX=Ri;function fj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c}}}function XX(e,t){var r=t.biff==8||!t.biff?4:2,n=ve(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ZX(e){var t=e.read_shift(2),r=e.read_shift(2),n=Ik(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function JX(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(Ik(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function QX(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function eZ(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return a.patternType=IY[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function tZ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=eZ(e,t,n.fStyle,r),n}function mj(e,t,r,n){var a=r&&r.biff==5;n||(n=ve(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function rZ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nZ(e){var t=ve(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function hj(e,t,r){var n=Ra(e);(r.biff==2||t==9)&&++e.l;var a=iX(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function aZ(e,t,r,n,a,i){var o=ve(8);return Ni(e,t,n,o),Ck(r,i,o),o}function sZ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ra(e),a=Yr(e);return n.val=a,n}function iZ(e,t,r,n){var a=ve(14);return Ni(e,t,n,a),wi(r,a),a}var pj=xX;function oZ(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=ji(e,i),l=[];n>e.l;)l.push(yc(e));return[i,a,o,l]}function xj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=vX(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var lZ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=ji(e,o,r);a&32&&(d=lZ[d.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||l===0||!(u>0)?[]:Nte(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:f}}function Lk(e,t,r){if(r.biff<8)return cZ(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(gX(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function cZ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function dZ(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=ji(e,n,r),o=ji(e,a,r);return[i,o]}function uZ(e,t,r){var n=Fk(e);e.l++;var a=e.read_shift(1);return t-=8,[Ete(e,t,r),a,n]}function vj(e,t,r){var n=yX(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,wte(e,t,r)]}function fZ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function mZ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Ri(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function hZ(e,t,r){return mZ(e,t,r)}function pZ(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(af(e));return r}function xZ(e){var t=ve(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Rk(e[r],t);return t}function gZ(e,t,r){if(r&&r.biff<8)return yZ(e,t,r);var n=Mk(e),a=NX(e,t-22,n[1]);return{cmo:n,ft:a}}var vZ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function yZ(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((vZ[n]||Jr)(e,t,r)),{cmo:[a,n,i],ft:o}}function bZ(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=cX(e,6,r);var l=e.read_shift(2);e.read_shift(2),or(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=ji(e,e.lens[d+1]-e.lens[d]-1);if(a+=f,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function wZ(e,t){var r=af(e);e.l+=16;var n=mX(e,t-24);return[r,n]}function jZ(e){var t=ve(24),r=Mt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Er([t,hX(e[1])])}function NZ(e,t){e.read_shift(2);var r=af(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(un,""),[r,n]}function EZ(e){var t=e[1].Tooltip,r=ve(10+2*(t.length+1));r.write_shift(2,2048);var n=Mt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function SZ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=rj[r]||r,r=e.read_shift(2),t[1]=rj[r]||r,t}function TZ(e){return e||(e=ve(4)),e.write_shift(2,1),e.write_shift(2,1),e}function _Z(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Dk(e));return r}function AZ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Dk(e));return r}function kZ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Bk(e,t,r){if(!r.cellStyles)return Jr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function CZ(e,t){var r=ve(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function OZ(e,t){var r={};return t<32||(e.l+=16,r.header=Yr(e),r.footer=Yr(e),e.l+=2),r}function PZ(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function DZ(e){for(var t=ve(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var IZ=Ra,RZ=kk,FZ=yc;function MZ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function LZ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ra(e);++e.l;var a=Ri(e,t-7,r);return n.t="str",n.val=a,n}function BZ(e){var t=Ra(e);++e.l;var r=Yr(e);return t.t="n",t.val=r,t}function $Z(e,t,r){var n=ve(15);return Nc(n,e,t),n.write_shift(8,r,"f"),n}function zZ(e){var t=Ra(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function UZ(e,t,r){var n=ve(9);return Nc(n,e,t),n.write_shift(2,r),n}function WZ(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function HZ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function VZ(e,t,r){var n=e.l+t,a=Ra(e),i=e.read_shift(2),o=ji(e,i,r);return e.l=n,a.t="str",a.val=o,a}var GZ=[2,3,48,49,131,139,140,245],Hp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=tf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Cs(1);switch(c.type){case"base64":u=Pn(Bn(l));break;case"binary":u=Pn(l);break;case"buffer":case"array":u=l;break}Ir(u,0);var f=u.read_shift(1),m=!!(f&136),h=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,g=521;f==2&&(x=u.read_shift(2)),u.l+=3,f!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(g=u.read_shift(2));var y=u.read_shift(2),w=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var b=[],j={},N=Math.min(u.length,f==2?521:g-10-(h?264:0)),E=p?32:11;u.l<N&&u[u.l]!=13;)switch(j={},j.name=kl.utils.decode(w,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,j.type=String.fromCharCode(u.read_shift(1)),f!=2&&!p&&(j.offset=u.read_shift(4)),j.len=u.read_shift(1),f==2&&(j.offset=u.read_shift(2)),j.dec=u.read_shift(1),j.name.length&&b.push(j),f!=2&&(u.l+=p?13:14),j.type){case"B":(!h||j.len!=8)&&c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var S=0,T=0;for(d[0]=[],T=0;T!=b.length;++T)d[0][T]=b[T].name;for(;x-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++S]=[],T=0,T=0;T!=b.length;++T){var k=u.slice(u.l,u.l+b[T].len);u.l+=b[T].len,Ir(k,0);var I=kl.utils.decode(w,k);switch(b[T].type){case"C":I.trim().length&&(d[S][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?d[S][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):d[S][T]=I;break;case"F":d[S][T]=parseFloat(I.trim());break;case"+":case"I":d[S][T]=p?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":d[S][T]=!0;break;case"N":case"F":d[S][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[S][T]="##MEMO##"+(p?parseInt(I.trim(),10):k.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(d[S][T]=+I||0);break;case"@":d[S][T]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[S][T]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[S][T]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[S][T]=-k.read_shift(-8,"f");break;case"B":if(h&&b[T].len==8){d[S][T]=k.read_shift(8,"f");break}case"G":case"P":k.l+=b[T].len;break;case"0":if(b[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[T].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=b,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=Io(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function a(l,c){try{return $s(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&ma(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=bn(),f=du(l,{header:1,raw:!0,cellDates:!0}),m=f[0],h=f.slice(1),p=l["!cols"]||[],x=0,g=0,y=0,w=1;for(x=0;x<m.length;++x){if(((p[x]||{}).DBF||{}).name){m[x]=p[x].DBF.name,++y;continue}if(m[x]!=null){if(++y,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(g=0;g<1024;++g)if(m.indexOf(m[x]+"_"+g)==-1){m[x]+="_"+g;break}}}}var b=it(l["!ref"]),j=[],N=[],E=[];for(x=0;x<=b.e.c-b.s.c;++x){var S="",T="",k=0,I=[];for(g=0;g<h.length;++g)h[g][x]!=null&&I.push(h[g][x]);if(I.length==0||m[x]==null){j[x]="?";continue}for(g=0;g<I.length;++g){switch(typeof I[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[g]instanceof Date?"D":"C";break;default:T="C"}k=Math.max(k,String(I[g]).length),S=S&&S!=T?"C":T}k>250&&(k=250),T=((p[x]||{}).DBF||{}).type,T=="C"&&p[x].DBF.len>k&&(k=p[x].DBF.len),S=="B"&&T=="N"&&(S="N",E[x]=p[x].DBF.dec,k=p[x].DBF.len),N[x]=S=="C"||T=="N"?k:i[S]||0,w+=N[x],j[x]=S}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,h.length),C.write_shift(2,296+32*y),C.write_shift(2,w),x=0;x<4;++x)C.write_shift(4,0);for(C.write_shift(4,0|(+t[AA]||3)<<8),x=0,g=0;x<m.length;++x)if(m[x]!=null){var A=u.next(32),L=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,L,"sbcs"),A.write_shift(1,j[x]=="?"?"C":j[x],"sbcs"),A.write_shift(4,g),A.write_shift(1,N[x]||i[j[x]]||0),A.write_shift(1,E[x]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=N[x]||i[j[x]]||0}var _=u.next(264);for(_.write_shift(4,13),x=0;x<65;++x)_.write_shift(4,0);for(x=0;x<h.length;++x){var W=u.next(w);for(W.write_shift(1,0),g=0;g<m.length;++g)if(m[g]!=null)switch(j[g]){case"L":W.write_shift(1,h[x][g]==null?63:h[x][g]?84:70);break;case"B":W.write_shift(8,h[x][g]||0,"f");break;case"N":var Y="0";for(typeof h[x][g]=="number"&&(Y=h[x][g].toFixed(E[g]||0)),y=0;y<N[g]-Y.length;++y)W.write_shift(1,32);W.write_shift(1,Y,"sbcs");break;case"D":h[x][g]?(W.write_shift(4,("0000"+h[x][g].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(h[x][g].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+h[x][g].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(h[x][g]!=null?h[x][g]:"").slice(0,N[g]);for(W.write_shift(1,Q,"sbcs"),y=0;y<N[g]-Q.length;++y)W.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),$k=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var p=e[h];return typeof p=="number"?k2(p):p},n=function(m,h,p){var x=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?m:k2(x)};e["|"]=254;function a(m,h){switch(h.type){case"base64":return i(Bn(m),h);case"binary":return i(m,h);case"buffer":return i(et&&Buffer.isBuffer(m)?m.toString("binary"):Bs(m),h);case"array":return i(bi(m),h)}throw new Error("Unrecognized type "+h.type)}function i(m,h){var p=m.split(/[\n\r]+/),x=-1,g=-1,y=0,w=0,b=[],j=[],N=null,E={},S=[],T=[],k=[],I=0,C;for(+h.codepage>=0&&ma(+h.codepage);y!==p.length;++y){I=0;var A=p[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=A.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),_=L[0],W;if(A.length>0)switch(_){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&j.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,Q=!1,J=!1,U=!1,ie=-1,re=-1;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"A":break;case"X":g=parseInt(L[w].slice(1))-1,Q=!0;break;case"Y":for(x=parseInt(L[w].slice(1))-1,Q||(g=0),C=b.length;C<=x;++C)b[C]=[];break;case"K":W=L[w].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(pa(W))?isNaN(ho(W).getDate())||(W=At(W)):(W=pa(W),N!==null&&Po(N)&&(W=nf(W))),Y=!0;break;case"E":U=!0;var M=Xi(L[w].slice(1),{r:x,c:g});b[x][g]=[b[x][g],M];break;case"S":J=!0,b[x][g]=[b[x][g],"S5S"];break;case"G":break;case"R":ie=parseInt(L[w].slice(1))-1;break;case"C":re=parseInt(L[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(Y&&(b[x][g]&&b[x][g].length==2?b[x][g][0]=W:b[x][g]=W,N=null),J){if(U)throw new Error("SYLK shared formula cannot have own formula");var z=ie>-1&&b[ie][re];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");b[x][g][1]=aC(z[1],{r:x-ie,c:g-re})}break;case"F":var V=0;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"X":g=parseInt(L[w].slice(1))-1,++V;break;case"Y":for(x=parseInt(L[w].slice(1))-1,C=b.length;C<=x;++C)b[C]=[];break;case"M":I=parseInt(L[w].slice(1))/20;break;case"F":break;case"G":break;case"P":N=j[parseInt(L[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=L[w].slice(1).split(" "),C=parseInt(k[0],10);C<=parseInt(k[1],10);++C)I=parseInt(k[2],10),T[C-1]=I===0?{hidden:!0}:{wch:I},Os(T[C-1]);break;case"C":g=parseInt(L[w].slice(1))-1,T[g]||(T[g]={});break;case"R":x=parseInt(L[w].slice(1))-1,S[x]||(S[x]={}),I>0?(S[x].hpt=I,S[x].hpx=xo(I)):I===0&&(S[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}V<1&&(N=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return S.length>0&&(E["!rows"]=S),T.length>0&&(E["!cols"]=T),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,E]}function o(m,h){var p=a(m,h),x=p[0],g=p[1],y=Io(x,h);return Yt(g).forEach(function(w){y[w]=g[w]}),y}function l(m,h){return $s(o(m,h),h)}function c(m,h,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(m.t){case"n":g+=m.v||0,m.f&&!m.F&&(g+=";E"+Mv(m.f,{r:p,c:x}));break;case"b":g+=m.v?"TRUE":"FALSE";break;case"e":g+=m.w||m.v;break;case"d":g+='"'+(m.w||m.v)+'"';break;case"s":g+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(m,h){h.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ml(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ll(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&m.push(g)})}function u(m,h){h.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Bl(p.hpx)+";"),g.length>2&&m.push(g+"R"+(x+1))})}function f(m,h){var p=["ID;PWXL;N;E"],x=[],g=it(m["!ref"]),y,w=Array.isArray(m),b=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),m["!cols"]&&d(p,m["!cols"]),m["!rows"]&&u(p,m["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var j=g.s.r;j<=g.e.r;++j)for(var N=g.s.c;N<=g.e.c;++N){var E=Ge({r:j,c:N});y=w?(m[j]||[])[N]:m[E],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,m,j,N))}return p.join(b)+b+x.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}})(),zk=(function(){function e(i,o){switch(o.type){case"base64":return t(Bn(i),o);case"binary":return t(i,o);case"buffer":return t(et&&Buffer.isBuffer(i)?i.toString("binary"):Bs(i),o);case"array":return t(bi(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var m=l[u].trim().split(","),h=m[0],p=m[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+h){case-1:if(x==="BOT"){f[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][d]=!0:x==="FALSE"?f[c][d]=!1:isNaN(pa(p))?isNaN(ho(p).getDate())?f[c][d]=p:f[c][d]=At(p):f[c][d]=pa(p),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return Io(e(i,o),o)}function n(i,o){return $s(r(i,o),o)}var a=(function(){var i=function(c,d,u,f,m){c.push(d),c.push(u+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=it(c["!ref"]),f,m=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var x=Ge({r:h,c:p});if(f=m?(c[h]||[])[p]:c[x],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=aa(f.z||Ve[14],vr(At(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,w=d.join(y);return w}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),Uk=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var h=f.split(`
`),p=-1,x=-1,g=0,y=[];g!==h.length;++g){var w=h[g].trim().split(":");if(w[0]==="cell"){var b=Mt(w[1]);if(y.length<=b.r)for(p=y.length;p<=b.r;++p)y[p]||(y[p]=[]);switch(p=b.r,x=b.c,w[2]){case"t":y[p][x]=e(w[3]);break;case"v":y[p][x]=+w[3];break;case"vtf":var j=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[p][x]=!!+w[4];break;default:y[p][x]=+w[4];break}w[2]=="vtf"&&(y[p][x]=[y[p][x],j])}}}return m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}function n(f,m){return Io(r(f,m),m)}function a(f,m){return $s(n(f,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var m=[],h=[],p,x="",g=Nn(f["!ref"]),y=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var b=g.s.c;b<=g.e.c;++b)if(x=Ge({r:w,c:b}),p=y?(f[w]||[])[b]:f[x],!(!p||p.v==null||p.t==="z")){switch(h=["cell",x,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var j=vr(At(p.v));h[2]="vtc",h[3]="nd",h[4]=""+j,h[5]=p.w||aa(p.z||Ve[14],j);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}})(),po=(function(){function e(u,f,m,h,p){p.raw?f[m][h]=u:u===""||(u==="TRUE"?f[m][h]=!0:u==="FALSE"?f[m][h]=!1:isNaN(pa(u))?isNaN(ho(u).getDate())?f[m][h]=u:f[m][h]=At(u):f[m][h]=pa(u))}function t(u,f){var m=f||{},h=[];if(!u||u.length===0)return h;for(var p=u.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,y=0,w=0;w<=x;++w)y=p[w].indexOf(" "),y==-1?y=p[w].length:y++,g=Math.max(g,y);for(w=0;w<=x;++w){h[w]=[];var b=0;for(e(p[w].slice(0,g).trim(),h,w,b,m),b=1;b<=(p[w].length-g)/10+1;++b)e(p[w].slice(g+(b-1)*10,g+b*10).trim(),h,w,b,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},m=!1,h=0,p=0;h<u.length;++h)(p=u.charCodeAt(h))==34?m=!m:!m&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h]);if(!p.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h])}return p.sort(function(x,g){return x[0]-g[0]||n[x[1]]-n[g[1]]}),r[p.pop()[1]]||44}function i(u,f){var m=f||{},h="",p=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):m&&m.FS?h=m.FS:h=a(u.slice(0,1024));var g=0,y=0,w=0,b=0,j=0,N=h.charCodeAt(0),E=!1,S=0,T=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=m.dateNF!=null?PK(m.dateNF):null;function I(){var C=u.slice(b,j),A={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)A.t="z";else if(m.raw)A.t="s",A.v=C;else if(C.trim().length===0)A.t="s",A.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(A.t="s",A.v=C.slice(2,-1).replace(/""/g,'"')):oee(C)?(A.t="n",A.f=C.slice(1)):(A.t="s",A.v=C);else if(C=="TRUE")A.t="b",A.v=!0;else if(C=="FALSE")A.t="b",A.v=!1;else if(!isNaN(w=pa(C)))A.t="n",m.cellText!==!1&&(A.w=C),A.v=w;else if(!isNaN(ho(C).getDate())||k&&C.match(k)){A.z=m.dateNF||Ve[14];var L=0;k&&C.match(k)&&(C=DK(C,m.dateNF,C.match(k)||[]),L=1),m.cellDates?(A.t="d",A.v=At(C,L)):(A.t="n",A.v=vr(At(C,L))),m.cellText!==!1&&(A.w=aa(A.z,A.v instanceof Date?vr(A.v):A.v)),m.cellNF||delete A.z}else A.t="s",A.v=C;if(A.t=="z"||(m.dense?(p[g]||(p[g]=[]),p[g][y]=A):p[Ge({c:y,r:g})]=A),b=j+1,T=u.charCodeAt(b),x.e.c<y&&(x.e.c=y),x.e.r<g&&(x.e.r=g),S==N)++y;else if(y=0,++g,m.sheetRows&&m.sheetRows<=g)return!0}e:for(;j<u.length;++j)switch(S=u.charCodeAt(j)){case 34:T===34&&(E=!E);break;case N:case 10:case 13:if(!E&&I())break e;break}return j-b>0&&I(),p["!ref"]=Je(x),p}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Io(t(u,f),f)}function l(u,f){var m="",h=f.type=="string"?[0,0,0,0]:Vv(u,f);switch(f.type){case"base64":m=Bn(u);break;case"binary":m=u;break;case"buffer":f.codepage==65001?m=u.toString("utf8"):f.codepage&&typeof kl<"u"||(m=et&&Buffer.isBuffer(u)?u.toString("binary"):Bs(u));break;case"array":m=bi(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=bt(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=bt(m):f.type=="binary"&&typeof kl<"u",m.slice(0,19)=="socialcalc:version:"?Uk.to_sheet(f.type=="string"?m:bt(m),f):o(m,f)}function c(u,f){return $s(l(u,f),f)}function d(u){for(var f=[],m=it(u["!ref"]),h,p=Array.isArray(u),x=m.s.r;x<=m.e.r;++x){for(var g=[],y=m.s.c;y<=m.e.c;++y){var w=Ge({r:x,c:y});if(h=p?(u[x]||[])[y]:u[w],!h||h.v==null){g.push("          ");continue}for(var b=(h.w||(rs(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function qZ(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=$k.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return po.to_workbook(e,t)}}var li=(function(){function e(M,z,V){if(M){Ir(M,M.l||0);for(var P=V.Enum||ie;M.l<M.length;){var Z=M.read_shift(2),oe=P[Z]||P[65535],ye=M.read_shift(2),ne=M.l+ye,ae=oe.f&&oe.f(M,ye,V);if(M.l=ne,z(ae,oe,Z))return}}}function t(M,z){switch(z.type){case"base64":return r(Pn(Bn(M)),z);case"binary":return r(Pn(M),z);case"buffer":case"array":return r(M,z)}throw"Unsupported type "+z.type}function r(M,z){if(!M)return M;var V=z||{},P=V.dense?[]:{},Z="Sheet1",oe="",ye=0,ne={},ae=[],le=[],D={s:{r:0,c:0},e:{r:0,c:0}},Ae=V.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)V.Enum=ie,e(M,function(Se,He,Pe){switch(Pe){case 0:V.vers=Se,Se>=4096&&(V.qpro=!0);break;case 6:D=Se;break;case 204:Se&&(oe=Se);break;case 222:oe=Se;break;case 15:case 51:V.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:Pe==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=V.dateNF||Ve[14],V.cellDates&&(Se[1].t="d",Se[1].v=nf(Se[1].v))),V.qpro&&Se[3]>ye&&(P["!ref"]=Je(D),ne[Z]=P,ae.push(Z),P=V.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ye=Se[3],Z=oe||"Sheet"+(ye+1),oe="");var Fe=V.dense?(P[Se[0].r]||[])[Se[0].c]:P[Ge(Se[0])];if(Fe){Fe.t=Se[1].t,Fe.v=Se[1].v,Se[1].z!=null&&(Fe.z=Se[1].z),Se[1].f!=null&&(Fe.f=Se[1].f);break}V.dense?(P[Se[0].r]||(P[Se[0].r]=[]),P[Se[0].r][Se[0].c]=Se[1]):P[Ge(Se[0])]=Se[1];break}},V);else if(M[2]==26||M[2]==14)V.Enum=re,M[2]==14&&(V.qpro=!0,M.l=0),e(M,function(Se,He,Pe){switch(Pe){case 204:Z=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>ye&&(P["!ref"]=Je(D),ne[Z]=P,ae.push(Z),P=V.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ye=Se[3],Z="Sheet"+(ye+1)),Ae>0&&Se[0].r>=Ae)break;V.dense?(P[Se[0].r]||(P[Se[0].r]=[]),P[Se[0].r][Se[0].c]=Se[1]):P[Ge(Se[0])]=Se[1],D.e.c<Se[0].c&&(D.e.c=Se[0].c),D.e.r<Se[0].r&&(D.e.r=Se[0].r);break;case 27:Se[14e3]&&(le[Se[14e3][0]]=Se[14e3][1]);break;case 1537:le[Se[0]]=Se[1],Se[0]==ye&&(Z=Se[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(P["!ref"]=Je(D),ne[oe||Z]=P,ae.push(oe||Z),!le.length)return{SheetNames:ae,Sheets:ne};for(var Ie={},Ke=[],Re=0;Re<le.length;++Re)ne[ae[Re]]?(Ke.push(le[Re]||ae[Re]),Ie[le[Re]]=ne[le[Re]]||ne[ae[Re]]):(Ke.push(le[Re]),Ie[le[Re]]={"!ref":"A1"});return{SheetNames:Ke,Sheets:Ie}}function n(M,z){var V=z||{};if(+V.codepage>=0&&ma(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var P=bn(),Z=it(M["!ref"]),oe=Array.isArray(M),ye=[];ke(P,0,i(1030)),ke(P,6,c(Z));for(var ne=Math.min(Z.e.r,8191),ae=Z.s.r;ae<=ne;++ae)for(var le=er(ae),D=Z.s.c;D<=Z.e.c;++D){ae===Z.s.r&&(ye[D]=Ft(D));var Ae=ye[D]+le,Ie=oe?(M[ae]||[])[D]:M[Ae];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?ke(P,13,h(ae,D,Ie.v)):ke(P,14,x(ae,D,Ie.v));else{var Ke=rs(Ie);ke(P,15,f(ae,D,Ke.slice(0,239)))}}return ke(P,1),P.end()}function a(M,z){var V=z||{};if(+V.codepage>=0&&ma(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var P=bn();ke(P,0,o(M));for(var Z=0,oe=0;Z<M.SheetNames.length;++Z)(M.Sheets[M.SheetNames[Z]]||{})["!ref"]&&ke(P,27,U(M.SheetNames[Z],oe++));var ye=0;for(Z=0;Z<M.SheetNames.length;++Z){var ne=M.Sheets[M.SheetNames[Z]];if(!(!ne||!ne["!ref"])){for(var ae=it(ne["!ref"]),le=Array.isArray(ne),D=[],Ae=Math.min(ae.e.r,8191),Ie=ae.s.r;Ie<=Ae;++Ie)for(var Ke=er(Ie),Re=ae.s.c;Re<=ae.e.c;++Re){Ie===ae.s.r&&(D[Re]=Ft(Re));var Se=D[Re]+Ke,He=le?(ne[Ie]||[])[Re]:ne[Se];if(!(!He||He.t=="z"))if(He.t=="n")ke(P,23,I(Ie,Re,ye,He.v));else{var Pe=rs(He);ke(P,22,S(Ie,Re,ye,Pe.slice(0,239)))}}++ye}}return ke(P,1),P.end()}function i(M){var z=ve(2);return z.write_shift(2,M),z}function o(M){var z=ve(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var V=0,P=0,Z=0,oe=0;oe<M.SheetNames.length;++oe){var ye=M.SheetNames[oe],ne=M.Sheets[ye];if(!(!ne||!ne["!ref"])){++Z;var ae=Nn(ne["!ref"]);V<ae.e.r&&(V=ae.e.r),P<ae.e.c&&(P=ae.e.c)}}return V>8191&&(V=8191),z.write_shift(2,V),z.write_shift(1,Z),z.write_shift(1,P),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function l(M,z,V){var P={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&V.qpro?(P.s.c=M.read_shift(1),M.l++,P.s.r=M.read_shift(2),P.e.c=M.read_shift(1),M.l++,P.e.r=M.read_shift(2),P):(P.s.c=M.read_shift(2),P.s.r=M.read_shift(2),z==12&&V.qpro&&(M.l+=2),P.e.c=M.read_shift(2),P.e.r=M.read_shift(2),z==12&&V.qpro&&(M.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(M){var z=ve(8);return z.write_shift(2,M.s.c),z.write_shift(2,M.s.r),z.write_shift(2,M.e.c),z.write_shift(2,M.e.r),z}function d(M,z,V){var P=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(P[0].c=M.read_shift(1),P[3]=M.read_shift(1),P[0].r=M.read_shift(2),M.l+=2):(P[2]=M.read_shift(1),P[0].c=M.read_shift(2),P[0].r=M.read_shift(2)),P}function u(M,z,V){var P=M.l+z,Z=d(M,z,V);if(Z[1].t="s",V.vers==20768){M.l++;var oe=M.read_shift(1);return Z[1].v=M.read_shift(oe,"utf8"),Z}return V.qpro&&M.l++,Z[1].v=M.read_shift(P-M.l,"cstr"),Z}function f(M,z,V){var P=ve(7+V.length);P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,M),P.write_shift(1,39);for(var Z=0;Z<P.length;++Z){var oe=V.charCodeAt(Z);P.write_shift(1,oe>=128?95:oe)}return P.write_shift(1,0),P}function m(M,z,V){var P=d(M,z,V);return P[1].v=M.read_shift(2,"i"),P}function h(M,z,V){var P=ve(7);return P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,M),P.write_shift(2,V,"i"),P}function p(M,z,V){var P=d(M,z,V);return P[1].v=M.read_shift(8,"f"),P}function x(M,z,V){var P=ve(13);return P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,M),P.write_shift(8,V,"f"),P}function g(M,z,V){var P=M.l+z,Z=d(M,z,V);if(Z[1].v=M.read_shift(8,"f"),V.qpro)M.l=P;else{var oe=M.read_shift(2);j(M.slice(M.l,M.l+oe),Z),M.l+=oe}return Z}function y(M,z,V){var P=z&32768;return z&=-32769,z=(P?M:0)+(z>=8192?z-16384:z),(P?"":"$")+(V?Ft(z):er(z))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(M,z){Ir(M,0);for(var V=[],P=0,Z="",oe="",ye="",ne="";M.l<M.length;){var ae=M[M.l++];switch(ae){case 0:V.push(M.read_shift(8,"f"));break;case 1:oe=y(z[0].c,M.read_shift(2),!0),Z=y(z[0].r,M.read_shift(2),!1),V.push(oe+Z);break;case 2:{var le=y(z[0].c,M.read_shift(2),!0),D=y(z[0].r,M.read_shift(2),!1);oe=y(z[0].c,M.read_shift(2),!0),Z=y(z[0].r,M.read_shift(2),!1),V.push(le+D+":"+oe+Z)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(M.read_shift(2));break;case 6:{for(var Ae="";ae=M[M.l++];)Ae+=String.fromCharCode(ae);V.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ne=V.pop(),ye=V.pop(),V.push(["AND","OR"][ae-20]+"("+ye+","+ne+")");break;default:if(ae<32&&b[ae])ne=V.pop(),ye=V.pop(),V.push(ye+b[ae]+ne);else if(w[ae]){if(P=w[ae][1],P==69&&(P=M[M.l++]),P>V.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+V.join("|")+"|");return}var Ie=V.slice(-P);V.length-=P,V.push(w[ae][0]+"("+Ie.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}V.length==1?z[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function N(M){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=M.read_shift(2),z[3]=M[M.l++],z[0].c=M[M.l++],z}function E(M,z){var V=N(M);return V[1].t="s",V[1].v=M.read_shift(z-4,"cstr"),V}function S(M,z,V,P){var Z=ve(6+P.length);Z.write_shift(2,M),Z.write_shift(1,V),Z.write_shift(1,z),Z.write_shift(1,39);for(var oe=0;oe<P.length;++oe){var ye=P.charCodeAt(oe);Z.write_shift(1,ye>=128?95:ye)}return Z.write_shift(1,0),Z}function T(M,z){var V=N(M);V[1].v=M.read_shift(2);var P=V[1].v>>1;if(V[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return V[1].v=P,V}function k(M,z){var V=N(M),P=M.read_shift(4),Z=M.read_shift(4),oe=M.read_shift(2);if(oe==65535)return P===0&&Z===3221225472?(V[1].t="e",V[1].v=15):P===0&&Z===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var ye=oe&32768;return oe=(oe&32767)-16446,V[1].v=(1-ye*2)*(Z*Math.pow(2,oe+32)+P*Math.pow(2,oe)),V}function I(M,z,V,P){var Z=ve(14);if(Z.write_shift(2,M),Z.write_shift(1,V),Z.write_shift(1,z),P==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var oe=0,ye=0,ne=0,ae=0;return P<0&&(oe=1,P=-P),ye=Math.log2(P)|0,P/=Math.pow(2,ye-31),ae=P>>>0,(ae&2147483648)==0&&(P/=2,++ye,ae=P>>>0),P-=ae,ae|=2147483648,ae>>>=0,P*=Math.pow(2,32),ne=P>>>0,Z.write_shift(4,ne),Z.write_shift(4,ae),ye+=16383+(oe?32768:0),Z.write_shift(2,ye),Z}function C(M,z){var V=k(M);return M.l+=z-14,V}function A(M,z){var V=N(M),P=M.read_shift(4);return V[1].v=P>>6,V}function L(M,z){var V=N(M),P=M.read_shift(8,"f");return V[1].v=P,V}function _(M,z){var V=L(M);return M.l+=z-10,V}function W(M,z){return M[M.l+z-1]==0?M.read_shift(z,"cstr"):""}function Y(M,z){var V=M[M.l++];V>z-1&&(V=z-1);for(var P="";P.length<V;)P+=String.fromCharCode(M[M.l++]);return P}function Q(M,z,V){if(!(!V.qpro||z<21)){var P=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var Z=M.read_shift(z-21,"cstr");return[P,Z]}}function J(M,z){for(var V={},P=M.l+z;M.l<P;){var Z=M.read_shift(2);if(Z==14e3){for(V[Z]=[0,""],V[Z][0]=M.read_shift(2);M[M.l];)V[Z][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return V}function U(M,z){var V=ve(5+M.length);V.write_shift(2,14e3),V.write_shift(2,z);for(var P=0;P<M.length;++P){var Z=M.charCodeAt(P);V[V.l++]=Z>127?95:Z}return V[V.l++]=0,V}var ie={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:_},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function KZ(e){var t={},r=e.match(en),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=qe(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=lv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var YZ=(function(){var e=Pl("t"),t=Pl("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:st(o[1])},c=i.match(t);return c&&(l.s=KZ(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}})(),XZ=(function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),ZZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JZ=/<(?:\w+:)?r>/,QZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(bt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=bt(e),r&&(n.h=vv(n.t))):e.match(JZ)&&(n.r=bt(e),n.t=st(bt((e.replace(QZ,"").match(ZZ)||[]).join("").replace(en,""))),r&&(n.h=XZ(YZ(n.r)))),n):{t:""}}var eJ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tJ=/<(?:\w+:)?(?:si|sstItem)>/g,rJ=/<\/(?:\w+:)?(?:si|sstItem)>/;function nJ(e,t){var r=[],n="";if(!e)return r;var a=e.match(eJ);if(a){n=a[2].replace(tJ,"").split(rJ);for(var i=0;i!=n.length;++i){var o=Pv(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=qe(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var aJ=/^\s|\s$|[\t\n\r]/;function Wk(e,t){if(!t.bookSST)return"";var r=[nr];r[r.length]=_e("sst",null,{xmlns:Ci[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(aJ)&&(i+=' xml:space="preserve"'),i+=">"+vt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sJ(e){return[e.read_shift(4),e.read_shift(4)]}function iJ(e,t){var r=[],n=!1;return us(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function oJ(e,t){return t||(t=ve(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var lJ=vY;function cJ(e){var t=bn();we(t,159,oJ(e));for(var r=0;r<e.length;++r)we(t,19,lJ(e[r]));return we(t,160),t.end()}function Hk(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ka(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function dJ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ka(e,4),t.U=Ka(e,4),t.W=Ka(e,4),t}function uJ(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function fJ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(uJ(e));return t}function mJ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function hJ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ka(e,4),t.U=Ka(e,4),t.W=Ka(e,4),t}function pJ(e){var t=hJ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Vk(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Gk(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function xJ(e){var t=Ka(e);switch(t.Minor){case 2:return[t.Minor,gJ(e)];case 3:return[t.Minor,vJ()];case 4:return[t.Minor,yJ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function gJ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Vk(e,r),a=Gk(e,e.length-e.l);return{t:"Std",h:n,v:a}}function vJ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yJ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(en,function(i){var o=qe(i);switch(Ia(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function bJ(e,t){var r={},n=r.EncryptionVersionInfo=Ka(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Vk(e,a),t-=a,r.EncryptionVerifier=Gk(e,t),r}function wJ(e){var t={},r=t.EncryptionVersionInfo=Ka(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Dv(e){var t=0,r,n=Hk(e),a=n.length+1,i,o,l,c,d;for(r=Cs(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var qk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=Hk(o),c=i(l),d=l.length,u=Cs(16),f=0;f!=16;++f)u[f]=0;var m,h,p;for((d&1)===1&&(m=c>>8,u[d]=a(e[0],m),--d,m=c&255,h=l[l.length-1],u[d]=a(h,m));d>0;)--d,m=c>>8,u[d]=a(l[d],m),--d,m=c&255,u[d]=a(l[d],m);for(d=15,p=15-l.length;p>0;)m=c>>8,u[d]=a(e[p],m),--d,--p,m=c&255,u[d]=a(l[d],m),--d,--p;return u}})(),jJ=function(e,t,r,n,a){a||(a=t),n||(n=qk(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},NJ=function(e){var t=0,r=qk(e);return function(n){var a=jJ("",n,t,r);return t=a[1],a[0]}};function EJ(e,t,r,n){var a={key:or(e),verificationBytes:or(e)};return r.password&&(a.verifier=Dv(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=NJ(r.password)),a}function SJ(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=wJ(e):n.Data=bJ(e,t),n}function TJ(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?SJ(e,t-2,n):EJ(e,r.biff>=8?t:t-2,r,n),n}var Kk=(function(){function e(a,i){switch(i.type){case"base64":return t(Bn(a),i);case"binary":return t(a,i);case"buffer":return t(et&&Buffer.isBuffer(a)?a.toString("binary"):Bs(a),i);case"array":return t(bi(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,h=0,p,x=-1;p=m.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(h,m.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var y={v:g,t:"s"};Array.isArray(l)?l[f][x]=y:l[Ge({r:f,c:x})]=y}break}h=m.lastIndex}x>d.e.c&&(d.e.c=x)}),l["!ref"]=Je(d),l}function r(a,i){return $s(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=it(a["!ref"]),l,c=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Ge({r:d,c:u});l=c?(a[d]||[])[u]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(rs(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function _J(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Fl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function AJ(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,c=0,d=a+i;switch(c=o/(d>1?2-d:d),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,d/2]}function kJ(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function lu(e,t){if(t===0)return e;var r=AJ(_J(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Fl(kJ(r))}var Yk=6,CJ=15,OJ=1,qr=Yk;function Ml(e){return Math.floor((e+Math.round(128/qr)/256)*qr)}function Ll(e){return Math.floor((e-5)/qr*100+.5)/100}function cu(e){return Math.round((e*qr+5)/qr*256)/256}function nm(e){return cu(Ll(Ml(e)))}function Iv(e){var t=Math.abs(e-nm(e)),r=qr;if(t>.005)for(qr=OJ;qr<CJ;++qr)Math.abs(e-nm(e))<=t&&(t=Math.abs(e-nm(e)),r=qr);qr=r}function Os(e){e.width?(e.wpx=Ml(e.width),e.wch=Ll(e.wpx),e.MDW=qr):e.wpx?(e.wch=Ll(e.wpx),e.width=cu(e.wch),e.MDW=qr):typeof e.wch=="number"&&(e.width=cu(e.wch),e.wpx=Ml(e.width),e.MDW=qr),e.customWidth&&delete e.customWidth}var PJ=96,Xk=PJ;function Bl(e){return e*96/Xk}function xo(e){return e*Xk/96}var DJ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IJ(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(en)||[]).forEach(function(o){var l=qe(o);switch(Ia(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Tt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Tt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function RJ(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(en)||[]).forEach(function(o){var l=qe(o);switch(Ia(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function FJ(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(en)||[]).forEach(function(o){var l=qe(o);switch(Ia(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=bt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Tt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Tt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Tt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Tt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Tt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Tt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Tt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=lv[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Tt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=ii[a.color.index];a.color.index==81&&(c=ii[1]),c||(c=ii[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=lu(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function MJ(e,t,r){t.NumberFmt=[];for(var n=Yt(Ve),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ve[n[a]];var i=e[0].match(en);if(i)for(a=0;a<i.length;++a){var o=qe(i[a]);switch(Ia(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=st(bt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}qa(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function LJ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=_e("numFmt",null,{numFmtId:n,formatCode:vt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=_e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ed=["numFmtId","fillId","fontId","borderId","xfId"],td=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BJ(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(en)||[]).forEach(function(i){var o=qe(i),l=0;switch(Ia(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<ed.length;++l)n[ed[l]]&&(n[ed[l]]=parseInt(n[ed[l]],10));for(l=0;l<td.length;++l)n[td[l]]&&(n[td[l]]=Tt(n[td[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Tt(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function $J(e){var t=[];return t[t.length]=_e("cellXfs",null),e.forEach(function(r){t[t.length]=_e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=_e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var zJ=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&MJ(f,u,d),(f=l.match(a))&&FJ(f,u,c,d),(f=l.match(n))&&RJ(f,u,c,d),(f=l.match(i))&&IJ(f,u,c,d),(f=l.match(r))&&BJ(f,u,d),u}})();function Zk(e,t){var r=[nr,_e("styleSheet",null,{xmlns:Ci[0],"xmlns:vt":xr.vt})],n;return e.SSF&&(n=LJ(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=$J(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function UJ(e,t){var r=e.read_shift(2),n=Zr(e);return[r,n]}function WJ(e,t,r){r||(r=ve(6+4*t.length)),r.write_shift(2,e),Tr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function HJ(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=SY(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=EY(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Zr(e),n}function VJ(e,t){t||(t=ve(153)),t.write_shift(2,e.sz*20),TY(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),su(e.color,t);var n=0;return n=2,t.write_shift(1,n),Tr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var GJ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],am,qJ=Jr;function yj(e,t){t||(t=ve(84)),am||(am=tf(GJ));var r=am[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(su({auto:1},t),su({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function KJ(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Jk(e,t,r){r||(r=ve(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Xo(e,t){return t||(t=ve(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var YJ=Jr;function XJ(e,t){return t||(t=ve(51)),t.write_shift(1,0),Xo(null,t),Xo(null,t),Xo(null,t),Xo(null,t),Xo(null,t),t.length>t.l?t.slice(0,t.l):t}function ZJ(e,t){return t||(t=ve(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),au(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function JJ(e,t,r){var n=ve(2052);return n.write_shift(4,e),au(t,n),au(r,n),n.length>n.l?n.slice(0,n.l):n}function QJ(e,t,r){var n={};n.NumberFmt=[];for(var a in Ve)n.NumberFmt[a]=Ve[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return us(e,function(c,d,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],qa(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=lu(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function eQ(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(we(e,615,xa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&we(e,44,WJ(a,t[a]))}),we(e,616))}}function tQ(e){var t=1;we(e,611,xa(t)),we(e,43,VJ({sz:12,color:{theme:1},name:"Calibri",family:2})),we(e,612)}function rQ(e){var t=2;we(e,603,xa(t)),we(e,45,yj({patternType:"none"})),we(e,45,yj({patternType:"gray125"})),we(e,604)}function nQ(e){var t=1;we(e,613,xa(t)),we(e,46,XJ()),we(e,614)}function aQ(e){var t=1;we(e,626,xa(t)),we(e,47,Jk({numFmtId:0},65535)),we(e,627)}function sQ(e,t){we(e,617,xa(t.length)),t.forEach(function(r){we(e,47,Jk(r,0))}),we(e,618)}function iQ(e){var t=1;we(e,619,xa(t)),we(e,48,ZJ({xfId:0,name:"Normal"})),we(e,620)}function oQ(e){var t=0;we(e,505,xa(t)),we(e,506)}function lQ(e){var t=0;we(e,508,JJ(t,"TableStyleMedium9","PivotStyleMedium4")),we(e,509)}function cQ(e,t){var r=bn();return we(r,278),eQ(r,e.SSF),tQ(r),rQ(r),nQ(r),aQ(r),sQ(r,t.cellXfs),iQ(r),oQ(r),lQ(r),we(r,279),r.end()}var dQ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uQ(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(en)||[]).forEach(function(a){var i=qe(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[dQ.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function fQ(){}function mQ(){}var hQ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pQ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xQ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function gQ(e,t,r){t.themeElements={};var n;[["clrScheme",hQ,uQ],["fontScheme",pQ,fQ],["fmtScheme",xQ,mQ]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var vQ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Qk(e,t){(!e||e.length===0)&&(e=Rv());var r,n={};if(!(r=e.match(vQ)))throw new Error("themeElements not found in theme");return gQ(r[0],n,t),n.raw=e,n}function Rv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[nr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yQ(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=VA(i,{type:"array"})}catch{return}var l=Dn(o,"theme/theme/theme1.xml",!0);if(l)return Qk(l,r)}}function bQ(e){return e.read_shift(4)}function wQ(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=jQ(e,4);break;case 2:t.xclrValue=Pk(e);break;case 3:t.xclrValue=bQ(e);break;case 4:e.l+=4;break}return e.l+=8,t}function jQ(e,t){return Jr(e,t)}function NQ(e,t){return Jr(e,t)}function EQ(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=wQ(e);break;case 6:n[1]=NQ(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function SQ(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(EQ(e,r-e.l));return{ixfe:n,ext:i}}function TQ(e,t){t.forEach(function(r){r[0]})}function _Q(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function AQ(e){var t=ve(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Tr(e.name,t),t.slice(0,t.l)}function kQ(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function CQ(e){var t=ve(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function OQ(e,t){var r=ve(8+2*t.length);return r.write_shift(4,e),Tr(t,r),r.slice(0,r.l)}function PQ(e){return e.l+=4,e.read_shift(4)!=0}function DQ(e,t){var r=ve(8);return r.write_shift(4,e),r.write_shift(4,1),r}function IQ(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return us(e,function(c,d,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function RQ(){var e=bn();return we(e,332),we(e,334,xa(1)),we(e,335,AQ({name:"XLDAPR",version:12e4,flags:3496657072})),we(e,336),we(e,339,OQ(1,"XLDAPR")),we(e,52),we(e,35,xa(514)),we(e,4096,xa(0)),we(e,4097,Zn(1)),we(e,36),we(e,53),we(e,340),we(e,337,DQ(1)),we(e,51,CQ([[1,0]])),we(e,338),we(e,333),e.end()}function FQ(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(en,function(l){var c=qe(l);switch(Ia(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function eC(){var e=[nr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function MQ(e){var t=[];if(!e)return t;var r=1;return(e.match(en)||[]).forEach(function(n){var a=qe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function LQ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ge(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function BQ(e,t,r){var n=[];return us(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function $Q(e,t,r,n){if(!e)return e;var a=n||{},i=!1;us(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function zQ(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Wi=1024;function tC(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[_e("xml",null,{"xmlns:v":kn.v,"xmlns:o":kn.o,"xmlns:x":kn.x,"xmlns:mv":kn.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Wi<e*1e3;)Wi+=1e3;return t.forEach(function(i){var o=Mt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=_e("v:fill",c,l),u={on:"t",obscured:"t"};++Wi,a=a.concat(["<v:shape"+Dl({id:"_x0000_s"+Wi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,_e("v:shadow",null,u),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Rr("x:AutoFill","False"),Rr("x:Row",String(o.r)),Rr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function bj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=Mt(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var c=it(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Je(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function UQ(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=qe(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Mt(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&Pv(f[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),n.push(d)}}}}),n}function rC(e){var t=[nr,_e("comments",null,{xmlns:Ci[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=vt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(vt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Rr("t",vt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Rr("t",vt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function WQ(e,t){var r=[],n=!1,a={},i=0;return e.replace(en,function(l,c){var d=qe(l);switch(Ia(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function HQ(e,t,r){var n=[nr,_e("ThreadedComments",null,{xmlns:xr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(_e("threadedComment",Rr("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function VQ(e,t){var r=[],n=!1;return e.replace(en,function(i){var o=qe(i);switch(Ia(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function GQ(e){var t=[nr,_e("personList",null,{xmlns:xr.TCMNT,"xmlns:x":Ci[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function qQ(e){var t={};t.iauthor=e.read_shift(4);var r=Ii(e);return t.rfx=r.s,t.ref=Ge(r.s),e.l+=16,t}function KQ(e,t){return t==null&&(t=ve(36)),t.write_shift(4,e[1].iauthor),Ro(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var YQ=Zr;function XQ(e){return Tr(e.slice(0,54))}function ZQ(e,t){var r=[],n=[],a={},i=!1;return us(e,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function JQ(e){var t=bn(),r=[];return we(t,628),we(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),we(t,632,XQ(a.a)))})}),we(t,631),we(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Mt(n[0]),e:Mt(n[0])};we(t,635,KQ([i,a])),a.t&&a.t.length>0&&we(t,637,bY(a)),we(t,636),delete a.iauthor})}),we(t,634),we(t,629),t.end()}var QQ="application/vnd.ms-office.vbaProject";function eee(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function tee(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ue.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var nC=["xlsb","xlsm","xlam","biff8","xla"];function ree(){return{"!type":"dialog"}}function nee(){return{"!type":"dialog"}}function aee(){return{"!type":"macro"}}function see(){return{"!type":"macro"}}var Xi=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,a+(l?"":"$")+Ft(u)+(c?"":"$")+er(d)}return function(a,i){return t=i,a.replace(e,r)}})(),Fv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Mv=(function(){return function(t,r){return t.replace(Fv,function(n,a,i,o,l,c){var d=Nv(o)-(i?0:r.c),u=jv(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",m=d==0?"":i?d+1:"["+d+"]";return a+"R"+f+"C"+m})}})();function aC(e,t){return e.replace(Fv,function(r,n,a,i,o,l){return n+(a=="$"?a+i:Ft(Nv(i)+t.c))+(o=="$"?o+l:er(jv(l)+t.r))})}function iee(e,t,r){var n=Nn(t),a=n.s,i=Mt(r),o={r:i.r-a.r,c:i.c-a.c};return aC(e,o)}function oee(e){return e.length!=1}function wj(e){return e.replace(/_xlfn\./g,"")}function sr(e){e.l+=1}function Ps(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function sC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return iC(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Ps(e),l=Ps(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function iC(e){var t=Ps(e),r=Ps(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function lee(e,t,r){if(r.biff<8)return iC(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Ps(e),o=Ps(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function oC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return cee(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ps(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function cee(e){var t=Ps(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function dee(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uee(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return fee(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function fee(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function mee(e,t,r){var n=(e[e.l++]&96)>>5,a=sC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function hee(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=sC(e,i,r);return[n,a,o]}function pee(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xee(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function gee(e,t,r){var n=(e[e.l++]&96)>>5,a=lee(e,t-1,r);return[n,a]}function vee(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function yee(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function bee(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function wee(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function jee(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Nee(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function lC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Eee(e){return e.read_shift(2),lC(e)}function See(e){return e.read_shift(2),lC(e)}function Tee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=oC(e,0,r);return[n,a]}function _ee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=uee(e,0,r);return[n,a]}function Aee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=oC(e,0,r);return[n,a,i]}function kee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Pte[a],uC[a],n]}function Cee(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Oee(e);return[a,(i[0]===0?uC:Ote)[i[1]]]}function Oee(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Pee(e,t,r){e.l+=r&&r.biff==2?3:4}function Dee(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Iee(e){return e.l++,fs[e.read_shift(1)]}function Ree(e){return e.l++,e.read_shift(2)}function Fee(e){return e.l++,e.read_shift(1)!==0}function Mee(e){return e.l++,Yr(e)}function Lee(e,t,r){return e.l++,vc(e,t-1,r)}function Bee(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Jt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Yr(e);break;case 2:r[1]=Ri(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function $ee(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ii:af)(e));return a}function zee(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=Bee(e,r.biff);return o}function Uee(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Wee(e,t,r){if(r.biff==5)return Hee(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Hee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Vee(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Gee(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function qee(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Kee(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Yee=Jr,Xee=Jr,Zee=Jr;function bc(e,t,r){return e.l+=2,[dee(e)]}function Lv(e){return e.l+=6,[]}var Jee=bc,Qee=Lv,ete=Lv,tte=bc;function cC(e){return e.l+=2,[or(e),e.read_shift(2)&1]}var rte=bc,nte=cC,ate=Lv,ste=bc,ite=bc,ote=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lte(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=ote[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function cte(e){return e.l+=2,[e.read_shift(4)]}function dte(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ute(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fte(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mte(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hte(e){return e.l+=4,[0,0]}var Nj={1:{n:"PtgExp",f:Dee},2:{n:"PtgTbl",f:Zee},3:{n:"PtgAdd",f:sr},4:{n:"PtgSub",f:sr},5:{n:"PtgMul",f:sr},6:{n:"PtgDiv",f:sr},7:{n:"PtgPower",f:sr},8:{n:"PtgConcat",f:sr},9:{n:"PtgLt",f:sr},10:{n:"PtgLe",f:sr},11:{n:"PtgEq",f:sr},12:{n:"PtgGe",f:sr},13:{n:"PtgGt",f:sr},14:{n:"PtgNe",f:sr},15:{n:"PtgIsect",f:sr},16:{n:"PtgUnion",f:sr},17:{n:"PtgRange",f:sr},18:{n:"PtgUplus",f:sr},19:{n:"PtgUminus",f:sr},20:{n:"PtgPercent",f:sr},21:{n:"PtgParen",f:sr},22:{n:"PtgMissArg",f:sr},23:{n:"PtgStr",f:Lee},26:{n:"PtgSheet",f:dte},27:{n:"PtgEndSheet",f:ute},28:{n:"PtgErr",f:Iee},29:{n:"PtgBool",f:Fee},30:{n:"PtgInt",f:Ree},31:{n:"PtgNum",f:Mee},32:{n:"PtgArray",f:vee},33:{n:"PtgFunc",f:kee},34:{n:"PtgFuncVar",f:Cee},35:{n:"PtgName",f:Uee},36:{n:"PtgRef",f:Tee},37:{n:"PtgArea",f:mee},38:{n:"PtgMemArea",f:Vee},39:{n:"PtgMemErr",f:Yee},40:{n:"PtgMemNoMem",f:Xee},41:{n:"PtgMemFunc",f:Gee},42:{n:"PtgRefErr",f:qee},43:{n:"PtgAreaErr",f:pee},44:{n:"PtgRefN",f:_ee},45:{n:"PtgAreaN",f:gee},46:{n:"PtgMemAreaN",f:fte},47:{n:"PtgMemNoMemN",f:mte},57:{n:"PtgNameX",f:Wee},58:{n:"PtgRef3d",f:Aee},59:{n:"PtgArea3d",f:hee},60:{n:"PtgRefErr3d",f:Kee},61:{n:"PtgAreaErr3d",f:xee},255:{}},pte={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xte={1:{n:"PtgElfLel",f:cC},2:{n:"PtgElfRw",f:ste},3:{n:"PtgElfCol",f:Jee},6:{n:"PtgElfRwV",f:ite},7:{n:"PtgElfColV",f:tte},10:{n:"PtgElfRadical",f:rte},11:{n:"PtgElfRadicalS",f:ate},13:{n:"PtgElfColS",f:Qee},15:{n:"PtgElfColSV",f:ete},16:{n:"PtgElfRadicalLel",f:nte},25:{n:"PtgList",f:lte},29:{n:"PtgSxName",f:cte},255:{}},gte={0:{n:"PtgAttrNoop",f:hte},1:{n:"PtgAttrSemi",f:Nee},2:{n:"PtgAttrIf",f:wee},4:{n:"PtgAttrChoose",f:yee},8:{n:"PtgAttrGoto",f:bee},16:{n:"PtgAttrSum",f:Pee},32:{n:"PtgAttrBaxcel",f:jj},33:{n:"PtgAttrBaxcel",f:jj},64:{n:"PtgAttrSpace",f:Eee},65:{n:"PtgAttrSpaceSemi",f:See},128:{n:"PtgAttrIfError",f:jee},255:{}};function wc(e,t,r,n){if(n.biff<8)return Jr(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=zee(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=$ee(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Jr(e,t)),i}function jc(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Nj[i]||Nj[pte[i]],(i===24||i===25)&&(a=(i===24?xte:gte)[e[e.l+1]]),!a||!a.f?Jr(e,t):o.push([a.n,a.f(e,t,r)]);return o}function vte(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var yte={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bte(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function dC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ej(e,t,r){var n=dC(e,t,r);return n=="#REF"?n:bte(n,r)}function Vr(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,m=0,h,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",y=0,w=e[0].length;y<w;++y){var b=e[0][y];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=Ht(" ",e[0][x][1][1]);break;case 1:g=Ht("\r",e[0][x][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}d=d+g,x=-1}l.push(d+yte[b[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=il(b[1][1],o,a),l.push(ol(u,i));break;case"PtgRefN":u=r?il(b[1][1],r,a):b[1][1],l.push(ol(u,i));break;case"PtgRef3d":f=b[1][1],u=il(b[1][2],o,a),p=Ej(n,f,a),l.push(p+"!"+ol(u,i));break;case"PtgFunc":case"PtgFuncVar":var j=b[1][0],N=b[1][1];j||(j=0),j&=127;var E=j==0?[]:l.slice(-j);l.length-=j,N==="User"&&(N=E.shift()),l.push(N+"("+E.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=Q2(b[1][1],r?{s:r}:o,a),l.push(em(h,a));break;case"PtgArea":h=Q2(b[1][1],o,a),l.push(em(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],p=Ej(n,f,a),l.push(p+"!"+em(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=b[1][2];var S=(n.names||[])[m-1]||(n[0]||[])[m],T=S?S.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),l.push(T);break;case"PtgNameX":var k=b[1][1];m=b[1][2];var I;if(a.biff<=5)k<0&&(k=-k),n[k]&&(I=n[k][m]);else{var C="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][m]&&n[k][m].itab>0&&(C=n.SheetNames[n[k][m].itab-1]+"!"):C=n.SheetNames[m-1]+"!"),n[k]&&n[k][m])C+=n[k][m].Name;else if(n[0]&&n[0][m])C+=n[0][m].Name;else{var A=(dC(n,k,a)||"").split(";;");A[m-1]?C=A[m-1]:C+="SH33TJSERRX"}l.push(C);break}I||(I={Name:"SH33TJSERRY"}),l.push(I.Name);break;case"PtgParen":var L="(",_=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:L=Ht(" ",e[0][x][1][1])+L;break;case 3:L=Ht("\r",e[0][x][1][1])+L;break;case 4:_=Ht(" ",e[0][x][1][1])+_;break;case 5:_=Ht("\r",e[0][x][1][1])+_;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(L+l.pop()+_);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[Ge(u)]){var Y=n.sharedf[Ge(u)];l.push(Vr(Y,o,W,n,a))}else{var Q=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Vr(d[1],o,W,n,a)),Q=!0;break}Q||l.push(b[1])}break;case"PtgArray":l.push("{"+vte(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&J.indexOf(e[0][y][0])==-1){b=e[0][x];var U=!0;switch(b[1][0]){case 4:U=!1;case 0:g=Ht(" ",b[1][1]);break;case 5:U=!1;case 1:g=Ht("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((U?g:"")+l.pop()+(U?"":g)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function wte(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Jr(e,t-2)];var l=jc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function jte(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Jr(e,t-2)];var l=jc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function Nte(e,t,r,n){var a=e.l+t,i=jc(e,n,r),o;return a!==e.l&&(o=wc(e,a-e.l,i,r)),[i,o]}function Ete(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=jc(e,i,r);return i==65535?[[],Jr(e,t-2)]:(t!==i+2&&(a=wc(e,n-i-2,o,r)),[o,a])}function Ste(e){var t;if(Ua(e,e.l+6)!==65535)return[Yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Tte(e){if(e==null){var t=ve(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return wi(e);return wi(0)}function sm(e,t,r){var n=e.l+t,a=Ra(e);r.biff==2&&++e.l;var i=Ste(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=jte(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function _te(e,t,r,n,a){var i=Ni(t,r,a),o=Tte(e.v),l=ve(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=ve(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Er([i,o,l,d]);return f}function sf(e,t,r){var n=e.read_shift(4),a=jc(e,n,r),i=e.read_shift(4),o=i>0?wc(e,i,a,r):null;return[a,o]}var Ate=sf,of=sf,kte=sf,Cte=sf,Ote={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},uC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Pte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Dte(e){var t="of:="+e.replace(Fv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function im(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Ite(e){return e.replace(/\./,"!")}var cl={},Zi={},dl=typeof Map<"u";function Bv(e,t,r){var n=0,a=e.length;if(r){if(dl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=dl?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(dl?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function lf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(qr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ll(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=cu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ci(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function zs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){qa(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function fC(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ve[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=At(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ve[t]==null&&qa(OK[t]||"General",t),e.t==="e")e.w=e.w||fs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v);else if(e.t==="d"){var o=vr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Ol(o)}else{if(e.v===void 0)return"";e.w=yi(e.v,Zi)}else e.t==="d"?e.w=aa(t,vr(e.v),Zi):e.w=aa(t,e.v,Zi)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=lu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=lu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function Rte(e,t,r){if(e&&e["!ref"]){var n=it(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Fte(e,t){var r=it(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Je(r))}var Mte=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Lte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Bte=/<(?:\w:)?hyperlink [^>]*>/mg,$te=/"(\w*:\w*)"/,zte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ute=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Wte=/<(?:\w:)?pageMargins[^>]*\/>/g,mC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Hte=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Vte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Gte(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(Lte);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var m=d.match(mC);m?$v(m[0],l,a,r):(m=d.match(Hte))&&Kte(m[0],m[1]||"",l,a,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=d.slice(h,h+50).match($te);p&&Fte(l,p[1])}var x=d.match(Vte);x&&x[1]&&ore(x[1],a);var g=[];if(t.cellStyles){var y=d.match(zte);y&&rre(g,y)}f&&dre(f[1],l,t,c,i,o);var w=u.match(Ute);w&&(l["!autofilter"]=are(w[0]));var b=[],j=u.match(Mte);if(j)for(h=0;h!=j.length;++h)b[h]=it(j[h].slice(j[h].indexOf('"')+1));var N=u.match(Bte);N&&Qte(l,N,n);var E=u.match(Wte);if(E&&(l["!margins"]=ere(qe(E[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Je(c)),t.sheetRows>0&&l["!ref"]){var S=it(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Je(S))}return g.length>0&&(l["!cols"]=g),b.length>0&&(l["!merges"]=b),l}function qte(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Je(e[r])+'"/>';return t+"</mergeCells>"}function $v(e,t,r,n){var a=qe(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=st(bt(a.codeName)))}function Kte(e,t,r,n,a){$v(e.slice(0,e.indexOf(">")),r,n,a)}function Yte(e,t,r,n,a){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=ka(vt(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+_e("outlinePr",null,d)}!i&&!l||(a[a.length]=_e("sheetPr",l,o))}var Xte=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Zte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Jte(e){var t={sheet:1};return Xte.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Zte.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Dv(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,t)}function Qte(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=qe(bt(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+st(i.location))):(i.Target="#"+st(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=it(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Ge({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function ere(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function tre(e){return ci(e),_e("pageMargins",null,e)}function rre(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=qe(t[n],!0);a.hidden&&(a.hidden=Tt(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Iv(a.width)),Os(a);i<=o;)e[i++]=kt(a)}}function nre(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=_e("col",null,lf(a,n)));return r[r.length]="</cols>",r.join("")}function are(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function sre(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Je(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Nn(a);o.s.r==o.e.r&&(o.e.r=Nn(t["!ref"]).e.r,a=Je(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),_e("autoFilter",null,{ref:a})}var ire=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ore(e,t){t.Views||(t.Views=[{}]),(e.match(ire)||[]).forEach(function(r,n){var a=qe(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Tt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function lre(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,a),{})}function cre(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=fs[e.v];break;case"d":n&&n.cellDates?a=At(e.v,-1).toISOString():(e=kt(e),e.t="n",a=""+(e.v=vr(At(e.v)))),typeof e.z>"u"&&(e.z=Ve[14]);break;default:a=e.v;break}var l=Rr("v",vt(a)),c={r:t},d=zs(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Rr("v",""+Bv(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=_e("f",vt(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),_e("c",l,c)}var dre=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Pl("v"),o=Pl("f");return function(c,d,u,f,m,h){for(var p=0,x="",g=[],y=[],w=0,b=0,j=0,N="",E,S,T=0,k=0,I,C,A=0,L=0,_=Array.isArray(h.CellXf),W,Y=[],Q=[],J=Array.isArray(d),U=[],ie={},re=!1,M=!!u.sheetStubs,z=c.split(t),V=0,P=z.length;V!=P;++V){x=z[V].trim();var Z=x.length;if(Z!==0){var oe=0;e:for(p=0;p<Z;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(S=qe(x.slice(oe,p),!0),T=S.r!=null?parseInt(S.r,10):T+1,k=-1,u.sheetRows&&u.sheetRows<T)continue;ie={},re=!1,S.ht&&(re=!0,ie.hpt=parseFloat(S.ht),ie.hpx=xo(ie.hpt)),S.hidden=="1"&&(re=!0,ie.hidden=!0),S.outlineLevel!=null&&(re=!0,ie.level=+S.outlineLevel),re&&(U[T-1]=ie)}break;case"<":oe=p;break}if(oe>=p)break;if(S=qe(x.slice(oe,p),!0),T=S.r!=null?parseInt(S.r,10):T+1,k=-1,!(u.sheetRows&&u.sheetRows<T)){f.s.r>T-1&&(f.s.r=T-1),f.e.r<T-1&&(f.e.r=T-1),u&&u.cellStyles&&(ie={},re=!1,S.ht&&(re=!0,ie.hpt=parseFloat(S.ht),ie.hpx=xo(ie.hpt)),S.hidden=="1"&&(re=!0,ie.hidden=!0),S.outlineLevel!=null&&(re=!0,ie.level=+S.outlineLevel),re&&(U[T-1]=ie)),g=x.slice(p).split(e);for(var ye=0;ye!=g.length&&g[ye].trim().charAt(0)=="<";++ye);for(g=g.slice(ye),p=0;p!=g.length;++p)if(x=g[p].trim(),x.length!==0){if(y=x.match(r),w=p,b=0,j=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,y!=null&&y.length===2){for(w=0,N=y[1],b=0;b!=N.length&&!((j=N.charCodeAt(b)-64)<1||j>26);++b)w=26*w+j;--w,k=w}else++k;for(b=0;b!=x.length&&x.charCodeAt(b)!==62;++b);if(++b,S=qe(x.slice(0,b),!0),S.r||(S.r=Ge({r:T-1,c:k})),N=x.slice(b),E={t:""},(y=N.match(i))!=null&&y[1]!==""&&(E.v=st(y[1])),u.cellFormula){if((y=N.match(o))!=null&&y[1]!==""){if(E.f=st(bt(y[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=wj(E.f)),y[0].indexOf('t="array"')>-1)E.F=(N.match(a)||[])[1],E.F.indexOf(":")>-1&&Y.push([it(E.F),E.F]);else if(y[0].indexOf('t="shared"')>-1){C=qe(y[0]);var ne=st(bt(y[1]));u.xlfn||(ne=wj(ne)),Q[parseInt(C.si,10)]=[C,ne,S.r]}}else(y=N.match(/<f[^>]*\/>/))&&(C=qe(y[0]),Q[C.si]&&(E.f=iee(Q[C.si][1],Q[C.si][2],S.r)));var ae=Mt(S.r);for(b=0;b<Y.length;++b)ae.r>=Y[b][0].s.r&&ae.r<=Y[b][0].e.r&&ae.c>=Y[b][0].s.c&&ae.c<=Y[b][0].e.c&&(E.F=Y[b][1])}if(S.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(M)E.t="z";else continue;else E.t=S.t||"n";switch(f.s.c>k&&(f.s.c=k),f.e.c<k&&(f.e.c=k),E.t){case"n":if(E.v==""||E.v==null){if(!M)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!M)continue;E.t="z"}else I=cl[parseInt(E.v,10)],E.v=I.t,E.r=I.r,u.cellHTML&&(E.h=I.h);break;case"str":E.t="s",E.v=E.v!=null?bt(E.v):"",u.cellHTML&&(E.h=vv(E.v));break;case"inlineStr":y=N.match(n),E.t="s",y!=null&&(I=Pv(y[1]))?(E.v=I.t,u.cellHTML&&(E.h=I.h)):E.v="";break;case"b":E.v=Tt(E.v);break;case"d":u.cellDates?E.v=At(E.v,1):(E.v=vr(At(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=pk[E.v];break}if(A=L=0,W=null,_&&S.s!==void 0&&(W=h.CellXf[S.s],W!=null&&(W.numFmtId!=null&&(A=W.numFmtId),u.cellStyles&&W.fillId!=null&&(L=W.fillId))),fC(E,A,L,u,m,h),u.cellDates&&_&&E.t=="n"&&Po(Ve[A])&&(E.t="d",E.v=nf(E.v)),S.cm&&u.xlmeta){var le=(u.xlmeta.Cell||[])[+S.cm-1];le&&le.type=="XLDAPR"&&(E.D=!0)}if(J){var D=Mt(S.r);d[D.r]||(d[D.r]=[]),d[D.r][D.c]=E}else d[S.r]=E}}}}U.length>0&&(d["!rows"]=U)}})();function ure(e,t,r,n){var a=[],i=[],o=it(e["!ref"]),l="",c,d="",u=[],f=0,m=0,h=e["!rows"],p=Array.isArray(e),x={r:d},g,y=-1;for(m=o.s.c;m<=o.e.c;++m)u[m]=Ft(m);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=er(f),m=o.s.c;m<=o.e.c;++m){c=u[m]+d;var w=p?(e[f]||[])[m]:e[c];w!==void 0&&(l=cre(w,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[f])&&(x={r:d},h&&h[f]&&(g=h[f],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=Bl(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),a[a.length]=_e("row",i.join(""),x))}if(h)for(;f<h.length;++f)h&&h[f]&&(x={r:f+1},g=h[f],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=Bl(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level),a[a.length]=_e("row","",x));return a.join("")}function hC(e,t,r,n){var a=[nr,_e("worksheet",null,{xmlns:Ci[0],"xmlns:r":xr.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=it(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Je(u)}n||(n={}),c["!comments"]=[];var f=[];Yte(c,r,e,t,a),a[a.length]=_e("dimension",null,{ref:d}),a[a.length]=lre(c,t,e,r),t.sheetFormat&&(a[a.length]=_e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=nre(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=ure(c,t),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=Jte(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=sre(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=qte(c["!merges"]));var m=-1,h,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=xt(n,-1,vt(x[1].Target).replace(/#.*$/,""),nt.HLINK),h["r:id"]="rId"+p),(m=x[1].Target.indexOf("#"))>-1&&(h.location=vt(x[1].Target.slice(m+1))),x[1].Tooltip&&(h.tooltip=vt(x[1].Tooltip)),a[a.length]=_e("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=tre(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Rr("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(p=xt(n,-1,"../drawings/drawing"+(e+1)+".xml",nt.DRAW),a[a.length]=_e("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=xt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",nt.VML),a[a.length]=_e("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function fre(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function mre(e,t,r){var n=ve(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Bl(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,m=-1,h=u<<10;h<u+1<<10;++h){d.c=h;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Ge(d)];p&&(f<0&&(f=h),m=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var x=n.l;return n.l=c,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function hre(e,t,r,n){var a=mre(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&we(e,0,a)}var pre=Ii,xre=Ro;function gre(){}function vre(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=wY(e),r}function yre(e,t,r){r==null&&(r=ve(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return su({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),dk(e,r),r.slice(0,r.l)}function bre(e){var t=oa(e);return[t]}function wre(e,t,r){return r==null&&(r=ve(8)),Oi(t,r)}function jre(e){var t=Pi(e);return[t]}function Nre(e,t,r){return r==null&&(r=ve(4)),Di(t,r)}function Ere(e){var t=oa(e),r=e.read_shift(1);return[t,r,"b"]}function Sre(e,t,r){return r==null&&(r=ve(9)),Oi(t,r),r.write_shift(1,e.v?1:0),r}function Tre(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"b"]}function _re(e,t,r){return r==null&&(r=ve(5)),Di(t,r),r.write_shift(1,e.v?1:0),r}function Are(e){var t=oa(e),r=e.read_shift(1);return[t,r,"e"]}function kre(e,t,r){return r==null&&(r=ve(9)),Oi(t,r),r.write_shift(1,e.v),r}function Cre(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"e"]}function Ore(e,t,r){return r==null&&(r=ve(8)),Di(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Pre(e){var t=oa(e),r=e.read_shift(4);return[t,r,"s"]}function Dre(e,t,r){return r==null&&(r=ve(12)),Oi(t,r),r.write_shift(4,t.v),r}function Ire(e){var t=Pi(e),r=e.read_shift(4);return[t,r,"s"]}function Rre(e,t,r){return r==null&&(r=ve(8)),Di(t,r),r.write_shift(4,t.v),r}function Fre(e){var t=oa(e),r=Yr(e);return[t,r,"n"]}function Mre(e,t,r){return r==null&&(r=ve(16)),Oi(t,r),wi(e.v,r),r}function pC(e){var t=Pi(e),r=Yr(e);return[t,r,"n"]}function Lre(e,t,r){return r==null&&(r=ve(12)),Di(t,r),wi(e.v,r),r}function Bre(e){var t=oa(e),r=_v(e);return[t,r,"n"]}function $re(e,t,r){return r==null&&(r=ve(12)),Oi(t,r),uk(e.v,r),r}function zre(e){var t=Pi(e),r=_v(e);return[t,r,"n"]}function Ure(e,t,r){return r==null&&(r=ve(8)),Di(t,r),uk(e.v,r),r}function Wre(e){var t=oa(e),r=Ev(e);return[t,r,"is"]}function Hre(e){var t=oa(e),r=Zr(e);return[t,r,"str"]}function Vre(e,t,r){return r==null&&(r=ve(12+4*e.v.length)),Oi(t,r),Tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Gre(e){var t=Pi(e),r=Zr(e);return[t,r,"str"]}function qre(e,t,r){return r==null&&(r=ve(8+4*e.v.length)),Di(t,r),Tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Kre(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=of(e,n-e.l,r);o[3]=Vr(l,null,a,r.supbooks,r)}else e.l=n;return o}function Yre(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=of(e,n-e.l,r);o[3]=Vr(l,null,a,r.supbooks,r)}else e.l=n;return o}function Xre(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var i=Yr(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=of(e,n-e.l,r);o[3]=Vr(l,null,a,r.supbooks,r)}else e.l=n;return o}function Zre(e,t,r){var n=e.l+t,a=oa(e);a.r=r["!row"];var i=Zr(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=of(e,n-e.l,r);o[3]=Vr(l,null,a,r.supbooks,r)}else e.l=n;return o}var Jre=Ii,Qre=Ro;function ene(e,t){return t==null&&(t=ve(4)),t.write_shift(4,e),t}function tne(e,t){var r=e.l+t,n=Ii(e),a=Sv(e),i=Zr(e),o=Zr(e),l=Zr(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:l};return o&&(c.Tooltip=o),c}function rne(e,t){var r=ve(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ro({s:Mt(e[0]),e:Mt(e[0])},r),Tv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Tr(a||"",r),Tr(e[1].Tooltip||"",r),Tr("",r),r.slice(0,r.l)}function nne(){}function ane(e,t,r){var n=e.l+t,a=fk(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=Ate(e,n-e.l,r);o[1]=l}else e.l=n;return o}function sne(e,t,r){var n=e.l+t,a=Ii(e),i=[a];if(r.cellFormula){var o=Cte(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function ine(e,t,r){r==null&&(r=ve(18));var n=lf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var xC=["left","right","top","bottom","header","footer"];function one(e){var t={};return xC.forEach(function(r){t[r]=Yr(e)}),t}function lne(e,t){return t==null&&(t=ve(48)),ci(e),xC.forEach(function(r){wi(e[r],t)}),t}function cne(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function dne(e,t,r){r==null&&(r=ve(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function une(e){var t=ve(24);return t.write_shift(4,4),t.write_shift(4,1),Ro(e,t),t}function fne(e,t){return t==null&&(t=ve(66)),t.write_shift(2,e.password?Dv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function mne(){}function hne(){}function pne(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,h,p,x,g,y,w,b,j,N,E=[];l.biff=12,l["!row"]=0;var S=0,T=!1,k=[],I={},C=l.supbooks||a.supbooks||[[]];if(C.sharedf=I,C.arrayf=k,C.SheetNames=a.SheetNames||a.Sheets.map(function(J){return J.name}),!l.supbooks&&(l.supbooks=C,a.Names))for(var A=0;A<a.Names.length;++A)C[0][A+1]=a.Names[A];var L=[],_=[],W=!1;$l[16]={n:"BrtShortReal",f:pC};var Y;if(us(e,function(U,ie,re){if(!m)switch(re){case 148:d=U;break;case 0:h=U,l.sheetRows&&l.sheetRows<=h.r&&(m=!0),j=er(g=h.r),l["!row"]=h.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=xo(U.hpt)),_[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:U[2]},U[2]){case"n":p.v=U[1];break;case"s":b=cl[U[1]],p.v=b.t,p.r=b.r;break;case"b":p.v=!!U[1];break;case"e":p.v=U[1],l.cellText!==!1&&(p.w=fs[p.v]);break;case"str":p.t="s",p.v=U[1];break;case"is":p.t="s",p.v=U[1].t;break}if((x=o.CellXf[U[0].iStyleRef])&&fC(p,x.numFmtId,null,l,i,o),y=U[0].c==-1?y+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=p):c[Ft(y)+j]=p,l.cellFormula){for(T=!1,S=0;S<k.length;++S){var M=k[S];h.r>=M[0].s.r&&h.r<=M[0].e.r&&y>=M[0].s.c&&y<=M[0].e.c&&(p.F=Je(M[0]),T=!0)}!T&&U.length>3&&(p.f=U[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>y&&(u.s.c=y),u.e.r<h.r&&(u.e.r=h.r),u.e.c<y&&(u.e.c=y),l.cellDates&&x&&p.t=="n"&&Po(Ve[x.numFmtId])){var z=ei(p.v);z&&(p.t="d",p.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}Y&&(Y.type=="XLDAPR"&&(p.D=!0),Y=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;p={t:"z",v:void 0},y=U[0].c==-1?y+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=p):c[Ft(y)+j]=p,u.s.r>h.r&&(u.s.r=h.r),u.s.c>y&&(u.s.c=y),u.e.r<h.r&&(u.e.r=h.r),u.e.c<y&&(u.e.c=y),Y&&(Y.type=="XLDAPR"&&(p.D=!0),Y=void 0);break;case 176:E.push(U);break;case 49:Y=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var V=n["!id"][U.relId];for(V?(U.Target=V.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=V):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(y=U.rfx.s.c;y<=U.rfx.e.c;++y)l.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=U):(w=Ge({c:y,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=U);break;case 426:if(!l.cellFormula)break;k.push(U),N=l.dense?c[g][y]:c[Ft(y)+j],N.f=Vr(U[1],u,{r:h.r,c:y},C,l),N.F=Je(U[0]);break;case 427:if(!l.cellFormula)break;I[Ge(U[0].s)]=U[1],N=l.dense?c[g][y]:c[Ft(y)+j],N.f=Vr(U[1],u,{r:h.r,c:y},C,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)L[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},W||(W=!0,Iv(U.w/256)),Os(L[U.e+1]);break;case 161:c["!autofilter"]={ref:Je(U)};break;case 476:c["!margins"]=U;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),U.name&&(a.Sheets[r].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ie.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Je(d||u)),l.sheetRows&&c["!ref"]){var Q=it(c["!ref"]);l.sheetRows<=+Q.e.r&&(Q.e.r=l.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Je(Q))}return E.length>0&&(c["!merges"]=E),L.length>0&&(c["!cols"]=L),_.length>0&&(c["!rows"]=_),c}function xne(e,t,r,n,a,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=kt(t),t.z=t.z||Ve[14],t.v=vr(At(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=zs(a.cellXfs,t,a),t.l&&i["!links"].push([Ge(c),t.l]),t.c&&i["!comments"].push([Ge(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=Bv(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,o?we(e,18,Rre(t,c)):we(e,7,Dre(t,c))):(c.t="str",o?we(e,17,qre(t,c)):we(e,6,Vre(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?we(e,13,Ure(t,c)):we(e,2,$re(t,c)):o?we(e,16,Lre(t,c)):we(e,5,Mre(t,c)),!0;case"b":return c.t="b",o?we(e,15,_re(t,c)):we(e,4,Sre(t,c)),!0;case"e":return c.t="e",o?we(e,14,Ore(t,c)):we(e,3,kre(t,c)),!0}return o?we(e,12,Nre(t,c)):we(e,1,wre(t,c)),!0}function gne(e,t,r,n){var a=it(t["!ref"]||"A1"),i,o="",l=[];we(e,145);var c=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=d;++u){o=er(u),hre(e,t,a,u);var f=!1;if(u<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){u===a.s.r&&(l[m]=Ft(m)),i=l[m]+o;var h=c?(t[u]||[])[m]:t[i];if(!h){f=!1;continue}f=xne(e,h,u,m,n,t,f)}}we(e,146)}function vne(e,t){!t||!t["!merges"]||(we(e,177,ene(t["!merges"].length)),t["!merges"].forEach(function(r){we(e,176,Qre(r))}),we(e,178))}function yne(e,t){!t||!t["!cols"]||(we(e,390),t["!cols"].forEach(function(r,n){r&&we(e,60,ine(n,r))}),we(e,391))}function bne(e,t){!t||!t["!ref"]||(we(e,648),we(e,649,une(it(t["!ref"]))),we(e,650))}function wne(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=xt(r,-1,n[1].Target.replace(/#.*$/,""),nt.HLINK);we(e,494,rne(n,a))}}),delete t["!links"]}function jne(e,t,r,n){if(t["!comments"].length>0){var a=xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);we(e,551,Tv("rId"+a)),t["!legacy"]=a}}function Nne(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Je(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Nn(i);l.s.r==l.e.r&&(l.e.r=Nn(t["!ref"]).e.r,i=Je(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),we(e,161,Ro(it(i))),we(e,162)}}function Ene(e,t,r){we(e,133),we(e,137,dne(t,r)),we(e,138),we(e,134)}function Sne(e,t){t["!protect"]&&we(e,535,fne(t["!protect"]))}function Tne(e,t,r,n){var a=bn(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=it(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],we(a,129),(r.vbaraw||o["!outline"])&&we(a,147,yre(l,o["!outline"])),we(a,148,xre(c)),Ene(a,o,r.Workbook),yne(a,o),gne(a,o,e,t),Sne(a,o),Nne(a,o,r,e),vne(a,o),wne(a,o,n),o["!margins"]&&we(a,476,lne(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&bne(a,o),jne(a,o,e,n),we(a,130),a.end()}function _ne(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=st((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Ane(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=_ne(f);u.s.r=u.s.c=0,u.e.c=l,d=Ft(l),m[0].forEach(function(h,p){o[d+er(p)]={t:"n",v:h,z:m[1]},c=p}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Je(u)),o}function kne(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(mC);return l&&$v(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Cne(e,t){e.l+=10;var r=Zr(e);return{name:r}}function One(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return us(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var zv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Pne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Dne=[],Ine=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tj(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Tt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function _j(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Tt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function gC(e){_j(e.WBProps,zv),_j(e.CalcPr,Ine),Tj(e.WBView,Pne),Tj(e.Sheets,Dne),Zi.date1904=Tt(e.WBProps.date1904)}function Rne(e){return!e.Workbook||!e.Workbook.WBProps?"false":Tt(e.Workbook.WBProps.date1904)?"true":"false"}var Fne="][*?/\\".split("");function vC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Fne.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Mne(e,t,r){e.forEach(function(n,a){vC(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Lne(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Mne(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Rte(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Bne=/<\w+:workbook/;function $ne(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(en,function(c,d){var u=qe(c);switch(Ia(u[0])){case"<?xml":break;case"<workbook":c.match(Bne)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":zv.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Tt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=bt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=st(bt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=bt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Tt(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=st(bt(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Ci.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gC(r),r}function yC(e){var t=[nr];t[t.length]=_e("workbook",null,{xmlns:Ci[0],"xmlns:r":xr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zv.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=_e("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:vt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=_e("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=_e("definedName",vt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zne(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Lp(e),r.name=Zr(e),r}function Une(e,t){return t||(t=ve(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Tv(e.strRelID,t),Tr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Wne(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Zr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Hne(e,t){t||(t=ve(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),dk(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Vne(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Gne(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=jY(e),o=kte(e,0,r),l=Sv(e);e.l=n;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function qne(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],$l[16]={n:"BrtFRTArchID$",f:Vne},us(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Vr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),gC(r),r.Names=i,r.supbooks=o,r}function Kne(e,t){we(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};we(e,156,Une(a))}we(e,144)}function Yne(e,t){t||(t=ve(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Tr("SheetJS",t),Tr(Jd.version,t),Tr(Jd.version,t),Tr("7262",t),t.length>t.l?t.slice(0,t.l):t}function Xne(e,t){t||(t=ve(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Zne(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(we(e,135),we(e,158,Xne(a)),we(e,136))}}function Jne(e,t){var r=bn();return we(r,131),we(r,128,Yne()),we(r,153,Hne(e.Workbook&&e.Workbook.WBProps||null)),Zne(r,e),Kne(r,e),we(r,132),r.end()}function Qne(e,t,r){return t.slice(-4)===".bin"?qne(e,r):$ne(e,r)}function eae(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?pne(e,n,r,a,i,o,l):Gte(e,n,r,a,i,o,l)}function tae(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?One(e,n,r,a,i):kne(e,n,r,a,i)}function rae(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?aee():see()}function nae(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?ree():nee()}function aae(e,t,r,n){return t.slice(-4)===".bin"?QJ(e,r,n):zJ(e,r,n)}function sae(e,t,r){return Qk(e,r)}function iae(e,t,r){return t.slice(-4)===".bin"?iJ(e,r):nJ(e,r)}function oae(e,t,r){return t.slice(-4)===".bin"?ZQ(e,r):UQ(e,r)}function lae(e,t,r){return t.slice(-4)===".bin"?BQ(e):MQ(e)}function cae(e,t,r,n){return r.slice(-4)===".bin"?$Q(e,t,r,n):void 0}function dae(e,t,r){return t.slice(-4)===".bin"?IQ(e,t,r):FQ(e,t,r)}function uae(e,t,r){return(t.slice(-4)===".bin"?Jne:yC)(e)}function fae(e,t,r,n,a){return(t.slice(-4)===".bin"?Tne:hC)(e,r,n,a)}function mae(e,t,r){return(t.slice(-4)===".bin"?cQ:Zk)(e,r)}function hae(e,t,r){return(t.slice(-4)===".bin"?cJ:Wk)(e,r)}function pae(e,t,r){return(t.slice(-4)===".bin"?JQ:rC)(e)}function xae(e){return(e.slice(-4)===".bin"?RQ:eC)()}var bC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function la(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(bC),i,o,l,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(wC),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function gae(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(bC),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(wC),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var ul;function vae(e,t){var r=ul[e]||st(e);return r==="General"?yi(t):aa(r,t)}function yae(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Tt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=At(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[st(t)]=a}function bae(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v):e.w=yi(e.v):e.w=vae(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=ul[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Po(n)){var a=ei(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function wae(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=DJ[n.Pattern]||n.Pattern)}e[t.ID]=t}function jae(e,t,r,n,a,i,o,l,c,d){var u="General",f=n.StyleID,m={};d=d||{};var h=[],p=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Tt(e);break;case"String":n.t="s",n.r=H2(st(e)),n.v=e.indexOf("<")>-1?st(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(At(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=st(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=pk[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=H2(t||e));break}if(bae(n,u,d),d.cellFormula!==!1)if(n.Formula){var x=st(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Xi(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Xi("RC:RC",a):n.ArrayRange&&(n.F=Xi(n.ArrayRange,a),c.push([it(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);d.cellStyles&&(h.forEach(function(g){!m.patternType&&g.patternType&&(m.patternType=g.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Nae(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function om(e,t){var r=t||{};Do();var n=Qo(yv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=bt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=kt(r);return o.type="string",po.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(He){a.indexOf("<"+He)>=0&&(i=!0)}),i)return lse(n,r);ul={"General Number":"General","General Date":Ve[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ve[15],"Short Date":Ve[14],"Long Time":Ve[19],"Medium Time":Ve[18],"Short Time":Ve[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ve[2],Standard:Ve[4],Percent:Ve[10],Scientific:Ve[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],m=r.dense?[]:{},h="",p={},x={},g=la('<Data ss:Type="String">'),y=0,w=0,b=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},E={},S="",T=0,k=[],I={},C={},A=0,L=[],_=[],W={},Y=[],Q,J=!1,U=[],ie=[],re={},M=0,z=0,V={Sheets:[],WBProps:{date1904:!1}},P={};Il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";l=Il.exec(n);)switch(l[3]=(Z=l[3]).toLowerCase()){case"data":if(Z=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?jae(n.slice(y,l.index),S,g,c[c.length-1][0]=="comment"?W:p,{c:w,r:b},N,Y[w],x,U,r):(S="",g=la(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(_.length>0&&(p.c=_),(!r.sheetRows||r.sheetRows>b)&&p.v!==void 0&&(r.dense?(m[b]||(m[b]=[]),m[b][w]=p):m[Ft(w)+er(b)]=p),p.HRef&&(p.l={Target:st(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(M=w+(parseInt(p.MergeAcross,10)|0),z=b+(parseInt(p.MergeDown,10)|0),k.push({s:{c:w,r:b},e:{c:M,r:z}})),!r.sheetStubs)p.MergeAcross?w=M+1:++w;else if(p.MergeAcross||p.MergeDown){for(var oe=w;oe<=M;++oe)for(var ye=b;ye<=z;++ye)(oe>w||ye>b)&&(r.dense?(m[ye]||(m[ye]=[]),m[ye][oe]={t:"z"}):m[Ft(oe)+er(ye)]={t:"z"});w=M+1}else++w;else p=gae(l[0]),p.Index&&(w=+p.Index-1),w<j.s.c&&(j.s.c=w),w>j.e.c&&(j.e.c=w),l[0].slice(-2)==="/>"&&++w,_=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<j.s.r&&(j.s.r=b),b>j.e.r&&(j.e.r=b),l[0].slice(-2)==="/>"&&(x=la(l[0]),x.Index&&(b=+x.Index-1)),w=0,++b):(x=la(l[0]),x.Index&&(b=+x.Index-1),re={},(x.AutoFitHeight=="0"||x.Height)&&(re.hpx=parseInt(x.Height,10),re.hpt=Bl(re.hpx),ie[b]=re),x.Hidden=="1"&&(re.hidden=!0,ie[b]=re));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(h),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(m["!ref"]=Je(j),r.sheetRows&&r.sheetRows<=j.e.r&&(m["!fullref"]=m["!ref"],j.e.r=r.sheetRows-1,m["!ref"]=Je(j))),k.length&&(m["!merges"]=k),Y.length>0&&(m["!cols"]=Y),ie.length>0&&(m["!rows"]=ie),u[h]=m}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,c.push([l[3],!1]),d=la(l[0]),h=st(d.Name),m=r.dense?[]:{},k=[],U=[],ie=[],P={name:h,Hidden:0},V.Sheets.push(P);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),Y=[],J=!1}break;case"style":l[1]==="/"?wae(N,E,r):E=la(l[0]);break;case"numberformat":E.nf=st(la(l[0]).Format||"General"),ul[E.nf]&&(E.nf=ul[E.nf]);for(var ne=0;ne!=392&&Ve[ne]!=E.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(Ve[ne]==null){qa(E.nf,ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Q=la(l[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!J&&Q.wpx>10){J=!0,qr=Yk;for(var ae=0;ae<Y.length;++ae)Y[ae]&&Os(Y[ae])}J&&Os(Q),Y[Q.Index-1||Y.length]=Q;for(var le=0;le<+Q.Span;++le)Y[Y.length]=kt(Q);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var D=qe(l[0]),Ae={Name:D.Name,Ref:Xi(D.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Ae.Sheet=V.Sheets.length-1),V.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=n.slice(T,l.index):T=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=la(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?qY(I,Z,n.slice(A,l.index)):A=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Nae(W),_.push(W)}else c.push([l[3],!1]),d=la(l[0]),W={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ie=la(l[0]);m["!autofilter"]={ref:Xi(Ie.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Pj(n,r);var Ke=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ke=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ke=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ke=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ke=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(A,l.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else A=l.index+l[0].length;break;case"header":m["!margins"]||ci(m["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(m["!margins"].header=+qe(l[0]).Margin);break;case"footer":m["!margins"]||ci(m["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(m["!margins"].footer=+qe(l[0]).Margin);break;case"pagemargins":var Re=qe(l[0]);m["!margins"]||ci(m["!margins"]={},"xlml"),isNaN(+Re.Top)||(m["!margins"].top=+Re.Top),isNaN(+Re.Left)||(m["!margins"].left=+Re.Left),isNaN(+Re.Right)||(m["!margins"].right=+Re.Right),isNaN(+Re.Bottom)||(m["!margins"].bottom=+Re.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ke=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ke=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ke=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ke=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ke=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ke=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ke=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ke=!1}break;case"smarttags":break;default:Ke=!1;break}if(Ke||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?yae(C,Z,L,n.slice(A,l.index)):(L=l,A=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=u),Se.SheetNames=f,Se.Workbook=V,Se.SSF=kt(Ve),Se.Props=I,Se.Custprops=C,Se}function Vp(e,t){switch(Wv(t=t||{}),t.type||"base64"){case"base64":return om(Bn(e),t);case"binary":case"buffer":case"file":return om(e,t);case"array":return om(Bs(e),t)}}function Eae(e,t){var r=[];return e.Props&&r.push(KY(e.Props,t)),e.Custprops&&r.push(YY(e.Props,e.Custprops)),r.join("")}function Sae(){return""}function Tae(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(_e("NumberFormat",null,{"ss:Format":vt(Ve[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(_e("Style",i.join(""),o))}),_e("Styles",r.join(""))}function jC(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Mv(e.Ref,{r:0,c:0})})}function _ae(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(jC(a)))}return _e("Names",r.join(""))}function Aae(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(jC(l)))}return i.join("")}function kae(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(_e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Rr("ProtectContents","True")),e["!protect"].objects&&a.push(Rr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Rr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Rr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Rr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":_e("WorksheetOptions",a.join(""),{xmlns:kn.x})}function Cae(e){return e.map(function(t){var r=ZK(t.t||""),n=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":t.a})}).join("")}function Oae(e,t,r,n,a,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+vt(Mv(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Mt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=vt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=vt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=fs[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ve[14]);break;case"s":f="String",m=XK(e.v||"");break}var h=zs(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var p=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=Cae(e.c)),_e("Cell",x,l)}function Pae(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=xo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Dae(e,t,r,n){if(!e["!ref"])return"";var a=it(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,y){Os(g);var w=!!g.width,b=lf(y,g),j={"ss:Index":y+1};w&&(j["ss:Width"]=Ml(b.width)),g.hidden&&(j["ss:Hidden"]="1"),l.push(_e("Column",null,j))});for(var c=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var u=[Pae(d,(e["!rows"]||[])[d])],f=a.s.c;f<=a.e.c;++f){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(m=!0);break}if(!m){var h={r:d,c:f},p=Ge(h),x=c?(e[d]||[])[f]:e[p];u.push(Oae(x,p,e,t,r,n,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function Iae(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],o=i?Aae(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?Dae(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(kae(i,t,e,r)),n.join("")}function Rae(e,t){t||(t={}),e.SSF||(e.SSF=kt(Ve)),e.SSF&&(Do(),ef(e.SSF),t.revssf=rf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],zs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Eae(e,t)),r.push(Sae()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(_e("Worksheet",Iae(n,t,e),{"ss:Name":vt(e.SheetNames[n])}));return r[2]=Tae(e,t),r[3]=_ae(e),nr+_e("Workbook",r.join(""),{xmlns:kn.ss,"xmlns:o":kn.o,"xmlns:x":kn.x,"xmlns:ss":kn.ss,"xmlns:dt":kn.dt,"xmlns:html":kn.html})}function Fae(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=_Y(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=AY(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Mae=[60,1084,2066,2165,2175];function Lae(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Ua(r,r.l),d=Gp[c],u=0;d!=null&&Mae.indexOf(c)>-1;)i=Ua(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=Gp[c=Ua(r,r.l)];var f=Er(o);Ir(f,0);var m=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(m),m+=o[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Ea(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ve[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v):e.w=yi(e.v):e.w=aa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Po(Ve[n]||String(n))){var a=ei(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function rd(e,t,r){return{v:e,ixfe:t,t:r}}function Bae(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},f,m="",h,p,x,g,y={},w=[],b,j,N=[],E=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=function(rt){return rt<8?ii[rt]:rt<64&&E[rt-8]||ii[rt]},I=function(rt,Zt,zn){var hr=Zt.XF.data;if(!(!hr||!hr.patternType||!zn||!zn.cellStyles)){Zt.s={},Zt.s.patternType=hr.patternType;var Us;(Us=Fl(k(hr.icvFore)))&&(Zt.s.fgColor={rgb:Us}),(Us=Fl(k(hr.icvBack)))&&(Zt.s.bgColor={rgb:Us})}},C=function(rt,Zt,zn){if(!(re>1)&&!(zn.sheetRows&&rt.r>=zn.sheetRows)){if(zn.cellStyles&&Zt.XF&&Zt.XF.data&&I(rt,Zt,zn),delete Zt.ixfe,delete Zt.XF,f=rt,m=Ge(rt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<o.s.r&&(o.s.r=rt.r),rt.c<o.s.c&&(o.s.c=rt.c),rt.r+1>o.e.r&&(o.e.r=rt.r+1),rt.c+1>o.e.c&&(o.e.c=rt.c+1),zn.cellFormula&&Zt.f){for(var hr=0;hr<w.length;++hr)if(!(w[hr][0].s.c>rt.c||w[hr][0].s.r>rt.r)&&!(w[hr][0].e.c<rt.c||w[hr][0].e.r<rt.r)){Zt.F=Je(w[hr][0]),(w[hr][0].s.c!=rt.c||w[hr][0].s.r!=rt.r)&&delete Zt.f,Zt.f&&(Zt.f=""+Vr(w[hr][1],o,rt,U,A));break}}zn.dense?(a[rt.r]||(a[rt.r]=[]),a[rt.r][rt.c]=Zt):a[m]=Zt}},A={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var L,_=[],W=[],Y=[],Q=[],J=!1,U=[];U.SheetNames=A.snames,U.sharedf=A.sharedf,U.arrayf=A.arrayf,U.names=[],U.XTI=[];var ie=0,re=0,M=0,z=[],V=[],P;A.codepage=1200,ma(1200);for(var Z=!1;e.l<e.length-1;){var oe=e.l,ye=e.read_shift(2);if(ye===0&&ie===10)break;var ne=e.l===e.length?0:e.read_shift(2),ae=Gp[ye];if(ae&&ae.f){if(t.bookSheets&&ie===133&&ye!==133)break;if(ie=ye,ae.r===2||ae.r==12){var le=e.read_shift(2);if(ne-=2,!A.enc&&le!==ye&&((le&255)<<8|le>>8)!==ye)throw new Error("rt mismatch: "+le+"!="+ye);ae.r==12&&(e.l+=10,ne-=10)}var D={};if(ye===10?D=ae.f(e,ne,A):D=Lae(ye,ae,e,ne,A),re==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(ye){case 34:r.opts.Date1904=S.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=D;break;case 66:var Ae=Number(D);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}ma(A.codepage=Ae),Z=!0;break;case 317:A.rrtabid=D;break;case 25:A.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:A.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:N.push(D);break;case 430:U.push([D]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(D);break;case 24:case 536:P={Name:D.Name,Ref:Vr(D.rgce,o,null,U,A)},D.itab>0&&(P.Sheet=D.itab-1),U.names.push(P),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(V[D.itab-1]={ref:Je(D.rgce[0][0][1][2])});break;case 22:A.ExternCount=D;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(D),U.XTI=U.XTI.concat(D);break;case 2196:if(A.biff<8)break;P!=null&&(P.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&A.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,A.snames.push(D.name);break;case 10:{if(--re)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Je(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ie=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Je(o),o.e.r=Ie}o.e.r++,o.e.c++}_.length>0&&(a["!merges"]=_),W.length>0&&(a["!objects"]=W),Y.length>0&&(a["!cols"]=Y),Q.length>0&&(a["!rows"]=Q),S.Sheets.push(T)}d===""?u=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),A.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(A.biff=5,Z=!0,ma(A.codepage=28591)),A.biff==8&&D.BIFFVer==0&&D.dt==16&&(A.biff=2),re++)break;if(a=t.dense?[]:{},A.biff<8&&!Z&&(Z=!0,ma(A.codepage=t.codepage||1252)),A.biff<5||D.BIFFVer==0&&D.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ke={pos:e.l-ne,name:d};i[Ke.pos]=Ke,A.snames.push(d)}else d=(i[oe]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),_=[],W=[],A.arrayf=w=[],Y=[],Q=[],J=!1,T={Hidden:(i[oe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[D.r]||[])[D.c]:a[Ge({c:D.c,r:D.r})])&&++D.c,b={ixfe:D.ixfe,XF:N[D.ixfe]||{},v:D.val,t:"n"},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t);break;case 5:case 517:b={ixfe:D.ixfe,XF:N[D.ixfe],v:D.val,t:D.t},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t);break;case 638:b={ixfe:D.ixfe,XF:N[D.ixfe],v:D.rknum,t:"n"},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t);break;case 189:for(var Re=D.c;Re<=D.C;++Re){var Se=D.rkrec[Re-D.c][0];b={ixfe:Se,XF:N[Se],v:D.rkrec[Re-D.c][1],t:"n"},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:Re,r:D.r},b,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){l=D;break}if(b=rd(D.val,D.cell.ixfe,D.tt),b.XF=N[b.ixfe],t.cellFormula){var He=D.formula;if(He&&He[0]&&He[0][0]&&He[0][0][0]=="PtgExp"){var Pe=He[0][0][1][0],Fe=He[0][0][1][1],Wt=Ge({r:Pe,c:Fe});y[Wt]?b.f=""+Vr(D.formula,o,D.cell,U,A):b.F=((t.dense?(a[Pe]||[])[Fe]:a[Wt])||{}).F}else b.f=""+Vr(D.formula,o,D.cell,U,A)}M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C(D.cell,b,t),l=D}break;case 7:case 519:if(l)l.val=D,b=rd(D,l.cell.ixfe,"s"),b.XF=N[b.ixfe],t.cellFormula&&(b.f=""+Vr(l.formula,o,l.cell,U,A)),M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C(l.cell,b,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(D);var ar=Ge(D[0].s);if(h=t.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[ar],t.cellFormula&&h){if(!l||!ar||!h)break;h.f=""+Vr(D[1],o,D[0],U,A),h.F=Je(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!l)break;y[Ge(l.cell)]=D[0],h=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Ge(l.cell)],(h||{}).f=""+Vr(D[0],o,f,U,A)}}break;case 253:b=rd(c[D.isst].t,D.ixfe,"s"),c[D.isst].h&&(b.h=c[D.isst].h),b.XF=N[b.ixfe],M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:D.ixfe,XF:N[D.ixfe],t:"z"},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t));break;case 190:if(t.sheetStubs)for(var yt=D.c;yt<=D.C;++yt){var Xt=D.ixfe[yt-D.c];b={ixfe:Xt,XF:N[Xt],t:"z"},M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:yt,r:D.r},b,t)}break;case 214:case 516:case 4:b=rd(D.val,D.ixfe,"s"),b.XF=N[b.ixfe],M>0&&(b.z=z[b.ixfe>>8&63]),Ea(b,t,r.opts.Date1904),C({c:D.c,r:D.r},b,t);break;case 0:case 512:re===1&&(o=D);break;case 252:c=D;break;case 1054:if(A.biff==4){z[M++]=D[1];for(var $r=0;$r<M+163&&Ve[$r]!=D[1];++$r);$r>=163&&qa(D[1],M+163)}else qa(D[1],D[0]);break;case 30:{z[M++]=D;for(var ms=0;ms<M+163&&Ve[ms]!=D;++ms);ms>=163&&qa(D,M+163)}break;case 229:_=_.concat(D);break;case 93:W[D.cmo[0]]=A.lastobj=D;break;case 438:A.lastobj.TxO=D;break;case 127:A.lastobj.ImData=D;break;case 440:for(g=D[0].s.r;g<=D[0].e.r;++g)for(x=D[0].s.c;x<=D[0].e.c;++x)h=t.dense?(a[g]||[])[x]:a[Ge({c:x,r:g})],h&&(h.l=D[1]);break;case 2048:for(g=D[0].s.r;g<=D[0].e.r;++g)for(x=D[0].s.c;x<=D[0].e.c;++x)h=t.dense?(a[g]||[])[x]:a[Ge({c:x,r:g})],h&&h.l&&(h.l.Tooltip=D[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;h=t.dense?(a[D[0].r]||[])[D[0].c]:a[Ge(D[0])];var Fo=W[D[2]];h||(t.dense?(a[D[0].r]||(a[D[0].r]=[]),h=a[D[0].r][D[0].c]={t:"z"}):h=a[Ge(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),h.c||(h.c=[]),p={a:D[1],t:Fo.TxO.t},h.c.push(p)}break;case 2173:TQ(N[D.ixfe],D.ext);break;case 125:{if(!A.cellStyles)break;for(;D.e>=D.s;)Y[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},J||(J=!0,Iv(D.w/256)),Os(Y[D.e+1])}break;case 520:{var rn={};D.level!=null&&(Q[D.r]=rn,rn.level=D.level),D.hidden&&(Q[D.r]=rn,rn.hidden=!0),D.hpt&&(Q[D.r]=rn,rn.hpt=D.hpt,rn.hpx=xo(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ci(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=D;break;case 161:a["!margins"]||ci(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(S.Views[0].RTL=!0);break;case 146:E=D;break;case 2198:L=D;break;case 140:j=D;break;case 442:d?T.CodeName=D||T.name:S.WBProps.CodeName=D||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=ne}return r.SheetNames=Yt(i).sort(function(wa,rt){return Number(wa)-Number(rt)}).map(function(wa){return i[wa].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(wa,rt){r.Sheets[r.SheetNames[rt]]["!autofilter"]=wa}),r.Strings=c,r.SSF=kt(Ve),A.enc&&(r.Encryption=A.enc),L&&(r.Themes=L),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),U.names.length>0&&(S.Names=U.names),r.Workbook=S,r}var fl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $ae(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=lj(n,Bp,fl.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var o=Ue.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=lj(o,$p,fl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(wk(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function zae(e,t){var r=[],n=[],a=[],i=0,o,l=L2(Bp,"n"),c=L2($p,"n");if(e.Props)for(o=Yt(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Yt(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)Ak.indexOf(a[i][0])>-1||bk.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&Ue.utils.cfb_add(t,"/SummaryInformation",cj(n,fl.SI,c,$p)),(r.length||d.length)&&Ue.utils.cfb_add(t,"/DocumentSummaryInformation",cj(r,fl.DSI,l,Bp,d.length?d:null,fl.UDI))}function NC(e,t){t||(t={}),Wv(t),dv(),t.codepage&&cv(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=Pn(Bn(e));break;case"binary":e=Pn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ir(e,0),n={content:e}}var a,i;if(r&&Fae(r),t.bookProps&&!t.bookSheets)a={};else{var o=et?"buffer":"array";if(n&&n.content)a=Bae(n.content,t);else if((i=Ue.find(e,"PerfectOffice_MAIN"))&&i.content)a=li.to_workbook(i.content,(t.type=o,t));else if((i=Ue.find(e,"NativeContent_MAIN"))&&i.content)a=li.to_workbook(i.content,(t.type=o,t));else throw(i=Ue.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=eee(e))}var l={};return e.FullPaths&&$ae(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function Uae(e,t){var r=t||{},n=Ue.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ue.utils.cfb_add(n,a,EC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&zae(e,n),r.biff==8&&e.vbaraw&&tee(n,Ue.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var $l={0:{f:fre},1:{f:bre},2:{f:Bre},3:{f:Are},4:{f:Ere},5:{f:Fre},6:{f:Hre},7:{f:Pre},8:{f:Zre},9:{f:Xre},10:{f:Kre},11:{f:Yre},12:{f:jre},13:{f:zre},14:{f:Cre},15:{f:Tre},16:{f:pC},17:{f:Gre},18:{f:Ire},19:{f:Ev},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Gne},40:{},42:{},43:{f:HJ},44:{f:UJ},45:{f:qJ},46:{f:YJ},47:{f:KJ},48:{},49:{f:pY},50:{},51:{f:kQ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bk},62:{f:Wre},63:{f:LQ},64:{f:mne},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cne},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vre},148:{f:pre,p:16},151:{f:nne},152:{},153:{f:Wne},154:{},155:{},156:{f:zne},157:{},158:{},159:{T:1,f:sJ},160:{T:-1},161:{T:1,f:Ii},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jre},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_Q},336:{T:-1},337:{f:PQ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Lp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Lk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ane},427:{f:sne},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:one},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gre},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tne},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Lp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YQ},633:{T:1},634:{T:-1},635:{T:1,f:qQ},636:{T:-1},637:{f:yY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Cne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hne},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gp={6:{f:sm},10:{f:xs},12:{f:or},13:{f:or},14:{f:Jt},15:{f:Jt},16:{f:Yr},17:{f:Jt},18:{f:Jt},19:{f:or},20:{f:pj},21:{f:pj},23:{f:Lk},24:{f:gj},25:{f:Jt},26:{},27:{},28:{f:hZ},29:{},34:{f:Jt},35:{f:xj},38:{f:Yr},39:{f:Yr},40:{f:Yr},41:{f:Yr},42:{f:Jt},43:{f:Jt},47:{f:TJ},49:{f:zX},51:{f:or},60:{},61:{f:FX},64:{f:Jt},65:{f:$X},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:SX},93:{f:gZ},94:{},95:{f:Jt},96:{},97:{},99:{f:Jt},125:{f:Bk},128:{f:rZ},129:{f:_X},130:{f:or},131:{f:Jt},132:{f:Jt},133:{f:AX},134:{},140:{f:SZ},141:{f:or},144:{},146:{f:AZ},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:RZ},161:{f:OZ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:JX},190:{f:QX},193:{f:xs},197:{},198:{},199:{},200:{},201:{},202:{f:Jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:Jt},222:{},224:{f:tZ},225:{f:EX},226:{f:xs},227:{},229:{f:pZ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CX},253:{f:WX},255:{f:PX},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jt},353:{f:xs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oZ},431:{f:Jt},432:{},433:{},434:{},437:{},438:{f:bZ},439:{f:Jt},440:{f:wZ},441:{},442:{f:yc},443:{},444:{f:or},445:{},446:{},448:{f:xs},449:{f:RX,r:2},450:{f:xs},512:{f:fj},513:{f:IZ},515:{f:sZ},516:{f:VX},517:{f:hj},519:{f:FZ},520:{f:DX},523:{},545:{f:vj},549:{f:uj},566:{},574:{f:LX},638:{f:ZX},659:{},1048:{},1054:{f:qX},1084:{},1212:{f:uZ},2048:{f:NZ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kZ,r:12},2173:{f:SQ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:dZ,r:12},2197:{},2198:{f:yQ,r:12},2199:{},2200:{},2201:{},2202:{f:fZ,r:12},2203:{f:xs},2204:{},2205:{},2206:{},2207:{},2211:{f:IX},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PZ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_Z},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fj},1:{},2:{f:zZ},3:{f:BZ},4:{f:LZ},5:{f:hj},7:{f:WZ},8:{},9:{f:Qc},11:{},22:{f:or},30:{f:YX},31:{},32:{},33:{f:vj},36:{},37:{f:uj},50:{f:HZ},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:MZ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VZ},223:{},234:{},354:{},421:{},518:{f:sm},521:{f:Qc},536:{f:gj},547:{f:xj},561:{},579:{},1030:{f:sm},1033:{f:Qc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ke(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&wv(r)&&e.push(r)}}function Wae(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ke(e,t,r,a);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Nc(e,t,r){return e||(e=ve(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Hae(e,t,r,n){var a=ve(9);return Nc(a,e,t),Ck(r,n||"b",a),a}function Vae(e,t,r){var n=ve(8+2*r.length);return Nc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Gae(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?vr(At(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ke(e,2,UZ(r,n,a)):ke(e,3,$Z(r,n,a));return;case"b":case"e":ke(e,5,Hae(r,n,t.v,t.t));return;case"s":case"str":ke(e,4,Vae(r,n,(t.v||"").slice(0,255)));return}ke(e,1,Nc(null,r,n))}function qae(e,t,r,n){var a=Array.isArray(t),i=it(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Je(i)}for(var d=i.s.r;d<=i.e.r;++d){l=er(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Ft(u)),o=c[u]+l;var f=a?(t[d]||[])[u]:t[o];f&&Gae(e,f,d,u)}}}function Kae(e,t){for(var r=t||{},n=bn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ke(n,r.biff==4?1033:r.biff==3?521:9,Ov(e,16,r)),qae(n,e.Sheets[e.SheetNames[a]],a,r),ke(n,10),n.end()}function Yae(e,t,r){ke(e,49,UX({sz:12,name:"Arial"},r))}function Xae(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ke(e,1054,KX(a,t[a],r))})}function Zae(e,t){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ke(e,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Rk(it(t["!ref"]||"A1"),r),r.write_shift(4,4),ke(e,2152,r)}function Jae(e,t){for(var r=0;r<16;++r)ke(e,224,mj({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ke(e,224,mj(n,0,t))})}function Qae(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ke(e,440,jZ(n)),n[1].Tooltip&&ke(e,2048,EZ(n))}delete t["!links"]}function ese(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ke(e,125,CZ(lf(a,n),a))})}}function tse(e,t,r,n,a){var i=16+zs(a.cellXfs,t,a);if(t.v==null&&!t.bf){ke(e,513,Ni(r,n,i));return}if(t.bf)ke(e,6,_te(t,r,n,a,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?vr(At(t.v)):t.v;ke(e,515,iZ(r,n,o,i));break;case"b":case"e":ke(e,517,aZ(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var l=Bv(a.Strings,t.v,a.revStrings);ke(e,253,HX(r,n,l,i))}else ke(e,516,GX(r,n,(t.v||"").slice(0,255),i,a));break;default:ke(e,513,Ni(r,n,i))}}function rse(e,t,r){var n=bn(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",m=[],h=it(i["!ref"]||"A1"),p=d?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}ke(n,2057,Ov(r,16,t)),ke(n,13,Zn(1)),ke(n,12,Zn(100)),ke(n,15,sn(!0)),ke(n,17,sn(!1)),ke(n,16,wi(.001)),ke(n,95,sn(!0)),ke(n,42,sn(!1)),ke(n,43,sn(!1)),ke(n,130,Zn(1)),ke(n,128,nZ()),ke(n,131,sn(!1)),ke(n,132,sn(!1)),d&&ese(n,i["!cols"]),ke(n,512,XX(h,t)),d&&(i["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){f=er(x);for(var g=h.s.c;g<=h.e.c;++g){x===h.s.r&&(m[g]=Ft(g)),u=m[g]+f;var y=c?(i[x]||[])[g]:i[u];y&&(tse(n,y,x,g,t),d&&y.l&&i["!links"].push([u,y.l]))}}var w=l.CodeName||l.name||a;return d&&ke(n,574,BX((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ke(n,229,xZ(i["!merges"])),d&&Qae(n,i),ke(n,442,Ok(w)),d&&Zae(n,i),ke(n,10),n.end()}function nse(e,t,r){var n=bn(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(ke(n,2057,Ov(e,5,r)),r.bookType=="xla"&&ke(n,135),ke(n,225,l?Zn(1200):null),ke(n,193,aX(2)),c&&ke(n,191),c&&ke(n,192),ke(n,226),ke(n,92,TX("SheetJS",r)),ke(n,66,Zn(l?1200:1252)),l&&ke(n,353,Zn(0)),l&&ke(n,448),ke(n,317,DZ(e.SheetNames.length)),l&&e.vbaraw&&ke(n,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";ke(n,442,Ok(d))}ke(n,156,Zn(17)),ke(n,25,sn(!1)),ke(n,18,sn(!1)),ke(n,19,Zn(0)),l&&ke(n,431,sn(!1)),l&&ke(n,444,Zn(0)),ke(n,61,MX()),ke(n,64,sn(!1)),ke(n,141,Zn(0)),ke(n,34,sn(Rne(e)=="true")),ke(n,14,sn(!0)),l&&ke(n,439,sn(!1)),ke(n,218,Zn(0)),Yae(n,e,r),Xae(n,e.SSF,r),Jae(n,r),l&&ke(n,352,sn(!1));var u=n.end(),f=bn();l&&ke(f,140,TZ()),l&&r.Strings&&Wae(f,252,OX(r.Strings)),ke(f,10);var m=f.end(),h=bn(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=u.length+p+m.length;for(x=0;x<e.SheetNames.length;++x){var y=i[x]||{};ke(h,133,kX({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var w=h.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var b=[];return u.length&&b.push(u),w.length&&b.push(w),m.length&&b.push(m),Er(b)}function ase(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=kt(Ve)),e&&e.SSF&&(Do(),ef(e.SSF),r.revssf=rf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Hv(r),r.cellXfs=[],zs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=rse(a,r,e);return n.unshift(nse(e,n,r)),Er(n)}function EC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Nn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ase(e,t);case 4:case 3:case 2:return Kae(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Aj(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,c=UK(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var x=c[o].trim(),g=x.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=x.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var w=y[l].trim();if(w.match(/<t[dh]/i)){for(var b=w,j=0;b.charAt(0)=="<"&&(j=b.indexOf(">"))>-1;)b=b.slice(j+1);for(var N=0;N<p.length;++N){var E=p[N];E.s.c==u&&E.s.r<d&&d<=E.e.r&&(u=E.e.c+1,N=-1)}var S=qe(w.slice(0,w.indexOf(">")));m=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||m>1)&&p.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+m-1}});var T=S.t||S["data-t"]||"";if(!b.length){u+=m;continue}if(b=KA(b),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!b.length){u+=m;continue}var k={t:"s",v:b};r.raw||!b.trim().length||T=="s"||(b==="TRUE"?k={t:"b",v:!0}:b==="FALSE"?k={t:"b",v:!1}:isNaN(pa(b))?isNaN(ho(b).getDate())||(k={t:"d",v:At(b)},r.cellDates||(k={t:"n",v:vr(k.v)}),k.z=r.dateNF||Ve[14]):k={t:"n",v:pa(b)}),r.dense?(n[d]||(n[d]=[]),n[d][u]=k):n[Ge({r:d,c:u})]=k,u+=m}}}}return n["!ref"]=Je(h),p.length&&(n["!merges"]=p),n}function sse(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var u=Ge({r,c:o}),f=n.dense?(e[r]||[])[o]:e[u],m=f&&f.v!=null&&(f.h||vv(f.w||(rs(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(_e("td",m,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var ise='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ose="</body></html>";function lse(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $s(Aj(r[0],t),t);var n=Kv();return r.forEach(function(a,i){Yv(n,Aj(a,t),"Sheet"+(i+1))}),n}function cse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function SC(e,t){var r=t||{},n=r.header!=null?r.header:ise,a=r.footer!=null?r.footer:ose,i=[n],o=Nn(e["!ref"]);r.dense=Array.isArray(e),i.push(cse(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(sse(e,o,l,r));return i.push("</table>"+a),i.join("")}function TC(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Mt(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Nn(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),a==-1&&(d.e.r=a=u.e.r+1)}var f=[],m=0,h=e["!rows"]||(e["!rows"]=[]),p=0,x=0,g=0,y=0,w=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<l.length&&x<c;++p){var j=l[p];if(kj(j)){if(n.display)continue;h[x]={hidden:!0}}var N=j.children;for(g=y=0;g<N.length;++g){var E=N[g];if(!(n.display&&kj(E))){var S=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):KA(E.innerHTML),T=E.getAttribute("data-z")||E.getAttribute("z");for(m=0;m<f.length;++m){var k=f[m];k.s.c==y+i&&k.s.r<x+a&&x+a<=k.e.r&&(y=k.e.c+1-i,m=-1)}b=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:x+a,c:y+i},e:{r:x+a+(w||1)-1,c:y+i+(b||1)-1}});var I={t:"s",v:S},C=E.getAttribute("data-t")||E.getAttribute("t")||"";S!=null&&(S.length==0?I.t=C||"z":n.raw||S.trim().length==0||C=="s"||(S==="TRUE"?I={t:"b",v:!0}:S==="FALSE"?I={t:"b",v:!1}:isNaN(pa(S))?isNaN(ho(S).getDate())||(I={t:"d",v:At(S)},n.cellDates||(I={t:"n",v:vr(I.v)}),I.z=n.dateNF||Ve[14]):I={t:"n",v:pa(S)})),I.z===void 0&&T!=null&&(I.z=T);var A="",L=E.getElementsByTagName("A");if(L&&L.length)for(var _=0;_<L.length&&!(L[_].hasAttribute("href")&&(A=L[_].getAttribute("href"),A.charAt(0)!="#"));++_);A&&A.charAt(0)!="#"&&(I.l={Target:A}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][y+i]=I):e[Ge({c:y+i,r:x+a})]=I,d.e.c<y+i&&(d.e.c=y+i),y+=b}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,x-1+a),e["!ref"]=Je(d),x>=c&&(e["!fullref"]=Je((d.e.r=l.length-p+x-1+a,d))),e}function _C(e,t){var r=t||{},n=r.dense?[]:{};return TC(n,e,t)}function dse(e,t){return $s(_C(e,t),t)}function kj(e){var t="",r=use(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function use(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fse(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(t.replace(/<[^>]*>/g,""));return[r]}var Cj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function AC(e,t){var r=t||{},n=yv(e),a=[],i,o,l={name:""},c="",d=0,u,f,m={},h=[],p=r.dense?[]:{},x,g,y={value:""},w="",b=0,j=[],N=-1,E=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,k={},I=[],C={},A=0,L=0,_=[],W=1,Y=1,Q=[],J={Names:[]},U={},ie=["",""],re=[],M={},z="",V=0,P=!1,Z=!1,oe=0;for(Il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Il.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=Je(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=Je(S)),I.length&&(p["!merges"]=I),_.length&&(p["!rows"]=_),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),m[u.name]=p,Z=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=qe(x[0],!1),N=E=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},I=[],_=[],Z=!0);break;case"table-row-group":x[1]==="/"?--T:++T;break;case"table-row":case"":if(x[1]==="/"){N+=W,W=1;break}if(f=qe(x[0],!1),f.?N=f.-1:N==-1&&(N=0),W=+f["number-rows-repeated"]||1,W<10)for(oe=0;oe<W;++oe)T>0&&(_[N+oe]={level:T});E=-1;break;case"covered-table-cell":x[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(p[N]||(p[N]=[]),p[N][E]={t:"z"}):p[Ge({r:N,c:E})]={t:"z"}),w="",j=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++E,y=qe(x[0],!1),Y=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=Sj(st(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=st(y["string-value"]||""),r.dense?(p[N]||(p[N]=[]),p[N][E]=g):p[Ge({r:N,c:E})]=g),E+=Y-1;else if(x[1]!=="/"){++E,w="",b=0,j=[],Y=1;var ye=W?N+W-1:N;if(E>S.e.c&&(S.e.c=E),E<S.s.c&&(S.s.c=E),N<S.s.r&&(S.s.r=N),ye>S.e.r&&(S.e.r=ye),y=qe(x[0],!1),re=[],M={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=st(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(A=parseInt(y["number-matrix-rows-spanned"],10)||0,L=parseInt(y["number-matrix-columns-spanned"],10)||0,C={s:{r:N,c:E},e:{r:N+A-1,c:E+L-1}},g.F=Je(C),Q.push([C,g.F])),y.formula)g.f=Sj(y.formula);else for(oe=0;oe<Q.length;++oe)N>=Q[oe][0].s.r&&N<=Q[oe][0].e.r&&E>=Q[oe][0].s.c&&E<=Q[oe][0].e.c&&(g.F=Q[oe][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(A=parseInt(y["number-rows-spanned"],10)||0,L=parseInt(y["number-columns-spanned"],10)||0,C={s:{r:N,c:E},e:{r:N+A-1,c:E+L-1}},I.push(C)),y["number-columns-repeated"]&&(Y=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Tt(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=At(y["date-value"]),r.cellDates||(g.t="n",g.v=vr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=BK(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=nf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(w=st(y["string-value"]),j=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(P=!1,g.t==="s"&&(g.v=w||"",j.length&&(g.R=j),P=b==0),U.Target&&(g.l=U),re.length>0&&(g.c=re,re=[]),w&&r.cellText!==!1&&(g.w=w),P&&(g.t="z",delete g.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ne=0;ne<W;++ne){if(Y=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(p[N+ne]||(p[N+ne]=[]),p[N+ne][E]=ne==0?g:kt(g);--Y>0;)p[N+ne][E+Y]=kt(g);else for(p[Ge({r:N+ne,c:E})]=g;--Y>0;)p[Ge({r:N+ne,c:E+Y})]=kt(g);S.e.c<=E&&(S.e.c=E)}Y=parseInt(y["number-columns-repeated"]||"1",10),E+=Y-1,Y=0,g={},w="",j=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i;M.t=w,j.length&&(M.R=j),M.a=z,re.push(M)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);z="",V=0,w="",b=0,j=[];break;case"creator":x[1]==="/"?z=n.slice(V,x.index):V=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);w="",b=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(k[l.name]=c,(i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=qe(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=qe(x[0],!1),c+=Cj[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=qe(x[0],!1),c+=Cj[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,x.index);break}else d=x.index+x[0].length;break;case"named-range":o=qe(x[0],!1),ie=im(o["cell-range-address"]);var ae={Name:o.name,Ref:ie[0]+"!"+ie[1]};Z&&(ae.Sheet=h.length),J.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!y||!y["string-value"])){var le=fse(n.slice(b,x.index));w=(w.length>0?w+`
`:"")+le[0]}else qe(x[0],!1),b=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ie=im(qe(x[0])["target-range-address"]),m[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(U=qe(x[0],!1),!U.href)break;U.Target=st(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ie=im(U.Target.slice(1)),U.Target="#"+ie[0]+"!"+ie[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var D={Sheets:m,SheetNames:h,Workbook:J};return r.bookSheets&&delete D.Sheets,D}function Oj(e,t){t=t||{},Xn(e,"META-INF/manifest.xml")&&BY(ir(e,"META-INF/manifest.xml"),t);var r=Dn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=AC(bt(r),t);return Xn(e,"meta.xml")&&(n.Props=vk(ir(e,"meta.xml"))),n}function Pj(e,t){return AC(e,t)}var mse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return nr+t}})(),Dj=(function(){var e=function(i){return vt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+vt(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=Nn(i["!ref"]||"A1"),m=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=f.e.r;++d){for(x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var y=!1,w={},b="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>u)&&!(m[h].s.r>d)&&!(m[h].e.c<u)&&!(m[h].e.r<d)){(m[h].s.c!=u||m[h].s.r!=d)&&(y=!0),w["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,w["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(y){c.push(r);continue}var j=Ge({r:d,c:u}),N=p?(i[d]||[])[u]:i[j];if(N&&N.f&&(w["table:formula"]=vt(Dte(N.f)),N.F&&N.F.slice(0,j.length)==j)){var E=Nn(N.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":b=N.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=N.v?"true":"false";break;case"n":b=N.w||String(N.v||0),w["office:value-type"]="float",w["office:value"]=N.v||0;break;case"s":case"str":b=N.v==null?"":N.v,w["office:value-type"]="string";break;case"d":b=N.w||At(N.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=At(N.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(b);if(N.l&&N.l.Target){var T=N.l.Target;T=T.charAt(0)=="#"?"#"+Ite(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),S=_e("text:a",S,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",S,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Os(f),f.ods=l;var m=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[nr],d=Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(gk().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function kC(e,t){if(t.bookType=="fods")return Dj(e,t);var r=pv(),n="",a=[],i=[];return n="mimetype",Qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qe(r,n,Dj(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Qe(r,n,mse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Qe(r,n,nr+gk()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Qe(r,n,UY(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qe(r,n,$Y(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ei(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):bt(Bs(e))}function hse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Pn(ka(e))}function pse(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ds(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Ij(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function xse(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function gse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function zl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function pt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ot(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=zl(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=zl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function Cr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(pt(n*8+a.type)),a.type==2&&t.push(pt(a.data.length)),t.push(a.data))})}),Ds(t)}function Uv(e,t){return e?.map(function(r){return t(r.data)})||[]}function Kn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=zl(e,n),i=ot(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Gt(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=ot(l.data),d=Gt(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Gt(i[3][0].data)>>>0>0),r.push(o)}return r}function Li(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:pt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:pt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:pt(o.data.length)}],n[2].push({data:Cr(o.meta),type:2})});var i=Cr(n);t.push(pt(i.length)),t.push(i),a.forEach(function(o){return t.push(o)})}),Ds(t)}function vse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=zl(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ds(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var u=Ds(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Yn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(vse(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ds(t)}function Bi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=pt(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Ds(t)}function yse(e,t,r,n){var a=Ei(e),i=a.getUint32(4,!0),o=(n>1?12:8)+Ij(i&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=Ij(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function bse(e,t,r){var n=Ei(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);a&1&&(c=xse(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function lm(e,t){var r=new Uint8Array(32),n=Ei(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,gse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function cm(e,t){var r=new Uint8Array(32),n=Ei(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function wse(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return yse(e,t,r,e[0]);case 5:return bse(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Hr(e){var t=ot(e);return zl(t[1][0].data)}function Rj(e,t){var r=ot(t.data),n=Gt(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=ot(o.data),c=Gt(l[1][0].data)>>>0;switch(n){case 1:i[c]=qp(l[3][0].data);break;case 8:{var d=e[Hr(l[9][0].data)][0],u=ot(d.data),f=e[Hr(u[1][0].data)][0],m=Gt(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=ot(f.data);i[c]=h[3].map(function(p){return qp(p.data)}).join("")}break}}),i}function jse(e,t){var r,n,a,i,o,l,c,d,u,f,m,h,p,x,g=ot(e),y=Gt(g[1][0].data)>>>0,w=Gt(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Gt(g[8][0].data)>0||!1,j,N;if((i=(a=g[7])==null?void 0:a[0])!=null&&i.data&&t!=0)j=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,N=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)j=(h=(m=g[4])==null?void 0:m[0])==null?void 0:h.data,N=(x=(p=g[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=b?4:1,S=Ei(j),T=[],k=0;k<j.length/2;++k){var I=S.getUint16(k*2,!0);I<65535&&T.push([k,I])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var C=[];for(k=0;k<T.length-1;++k)C[T[k][0]]=N.subarray(T[k][1]*E,T[k+1][1]*E);return T.length>=1&&(C[T[T.length-1][0]]=N.subarray(T[T.length-1][1]*E)),{R:y,cells:C}}function Nse(e,t){var r,n=ot(t.data),a=(r=n?.[7])!=null&&r[0]?Gt(n[7][0].data)>>>0>0?1:0:-1,i=Uv(n[5],function(o){return jse(o,a)});return{nrows:Gt(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Ese(e,t,r){var n,a=ot(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Gt(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Gt(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Je(i);var o=ot(a[4][0].data),l=Rj(e,e[Hr(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?Rj(e,e[Hr(o[17][0].data)][0]):[],d=ot(o[3][0].data),u=0;d[1].forEach(function(f){var m=ot(f.data),h=e[Hr(m[2][0].data)][0],p=Gt(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=Nse(e,h);x.data.forEach(function(g,y){g.forEach(function(w,b){var j=Ge({r:u+y,c:b}),N=wse(w,l,c);N&&(r[j]=N)})}),u+=x.nrows})}function Sse(e,t){var r=ot(t.data),n={"!ref":"A1"},a=e[Hr(r[2][0].data)],i=Gt(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Ese(e,a[0],n),n}function Tse(e,t){var r,n=ot(t.data),a={name:(r=n[1])!=null&&r[0]?qp(n[1][0].data):"",sheets:[]},i=Uv(n[2],Hr);return i.forEach(function(o){e[o].forEach(function(l){var c=Gt(l.meta[1][0].data);c==6e3&&a.sheets.push(Sse(e,l))})}),a}function _se(e,t){var r=Kv(),n=ot(t.data),a=Uv(n[1],Hr);if(a.forEach(function(i){e[i].forEach(function(o){var l=Gt(o.meta[1][0].data);if(l==2){var c=Tse(e,o);c.sheets.forEach(function(d,u){Yv(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function dm(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Yn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Kn(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Gt(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Gt(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return _se(i,l)}function Ase(e,t,r){var n,a,i,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Gt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Ei(e[7][0].data),u=0,f=[],m=Ei(e[4][0].data),h=0,p=[],x=0;x<t.length;++x){if(t[x]==null){d.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}d.setUint16(x*2,u,!0),m.setUint16(x*2,h,!0);var g,y;switch(typeof t[x]){case"string":g=lm({t:"s",v:t[x]},r),y=cm({t:"s",v:t[x]},r);break;case"number":g=lm({t:"n",v:t[x]},r),y=cm({t:"n",v:t[x]},r);break;case"boolean":g=lm({t:"b",v:t[x]},r),y=cm({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(g),u+=g.length,p.push(y),h+=y.length,++c}for(e[2][0].data=pt(c);x<e[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=Ds(f),e[3][0].data=Ds(p),c}function kse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Nn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Je(n)));var i=du(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(z){return z.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],d=Ue.read(t.numbers,{type:"base64"});d.FileIndex.map(function(z,V){return[z,d.FullPaths[V]]}).forEach(function(z){var V=z[0],P=z[1];if(V.type==2&&V.name.match(/\.iwa/)){var Z=V.content,oe=Yn(Z),ye=Kn(oe);ye.forEach(function(ne){c.push(ne.id),l[ne.id]={deps:[],location:P,type:Gt(ne.messages[0].meta[1][0].data)}})}}),c.sort(function(z,V){return z-V});var u=c.filter(function(z){return z>1}).map(function(z){return[z,pt(z)]});d.FileIndex.map(function(z,V){return[z,d.FullPaths[V]]}).forEach(function(z){var V=z[0];if(z[1],!!V.name.match(/\.iwa/)){var P=Kn(Yn(V.content));P.forEach(function(Z){Z.messages.forEach(function(oe){u.forEach(function(ye){Z.messages.some(function(ne){return Gt(ne.meta[1][0].data)!=11006&&pse(ne.data,ye[1])})&&l[ye[0]].deps.push(Z.id)})})})}});for(var f=Ue.find(d,l[1].location),m=Kn(Yn(f.content)),h,p=0;p<m.length;++p){var x=m[p];x.id==1&&(h=x)}var g=Hr(ot(h.messages[0].data)[1][0].data);for(f=Ue.find(d,l[g].location),m=Kn(Yn(f.content)),p=0;p<m.length;++p)x=m[p],x.id==g&&(h=x);for(g=Hr(ot(h.messages[0].data)[2][0].data),f=Ue.find(d,l[g].location),m=Kn(Yn(f.content)),p=0;p<m.length;++p)x=m[p],x.id==g&&(h=x);for(g=Hr(ot(h.messages[0].data)[2][0].data),f=Ue.find(d,l[g].location),m=Kn(Yn(f.content)),p=0;p<m.length;++p)x=m[p],x.id==g&&(h=x);var y=ot(h.messages[0].data);{y[6][0].data=pt(n.e.r+1),y[7][0].data=pt(n.e.c+1);var w=Hr(y[46][0].data),b=Ue.find(d,l[w].location),j=Kn(Yn(b.content));{for(var N=0;N<j.length&&j[N].id!=w;++N);if(j[N].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=ot(j[N].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var S=0;S<=n.e.c;++S){var T=[];T[1]=T[2]=[{type:0,data:pt(S+420690)}],E[1].push({type:2,data:Cr(T)}),E[2].push({type:0,data:pt(S)}),E[3].push({type:0,data:pt(S)})}E[4]=[],E[5]=[],E[6]=[];for(var k=0;k<=n.e.r;++k)T=[],T[1]=T[2]=[{type:0,data:pt(k+726270)}],E[4].push({type:2,data:Cr(T)}),E[5].push({type:0,data:pt(k)}),E[6].push({type:0,data:pt(k)});j[N].messages[0].data=Cr(E)}b.content=Bi(Li(j)),b.size=b.content.length,delete y[46];var I=ot(y[4][0].data);{I[7][0].data=pt(n.e.r+1);var C=ot(I[1][0].data),A=Hr(C[2][0].data);b=Ue.find(d,l[A].location),j=Kn(Yn(b.content));{if(j[0].id!=A)throw"Bad HeaderStorageBucket";var L=ot(j[0].messages[0].data);for(k=0;k<i.length;++k){var _=ot(L[2][0].data);_[1][0].data=pt(k),_[4][0].data=pt(i[k].length),L[2][k]={type:L[2][0].type,data:Cr(_)}}j[0].messages[0].data=Cr(L)}b.content=Bi(Li(j)),b.size=b.content.length;var W=Hr(I[2][0].data);b=Ue.find(d,l[W].location),j=Kn(Yn(b.content));{if(j[0].id!=W)throw"Bad HeaderStorageBucket";for(L=ot(j[0].messages[0].data),S=0;S<=n.e.c;++S)_=ot(L[2][0].data),_[1][0].data=pt(S),_[4][0].data=pt(n.e.r+1),L[2][S]={type:L[2][0].type,data:Cr(_)};j[0].messages[0].data=Cr(L)}b.content=Bi(Li(j)),b.size=b.content.length;var Y=Hr(I[4][0].data);(function(){for(var z=Ue.find(d,l[Y].location),V=Kn(Yn(z.content)),P,Z=0;Z<V.length;++Z){var oe=V[Z];oe.id==Y&&(P=oe)}var ye=ot(P.messages[0].data);{ye[3]=[];var ne=[];o.forEach(function(D,Ae){ne[1]=[{type:0,data:pt(Ae)}],ne[2]=[{type:0,data:pt(1)}],ne[3]=[{type:2,data:hse(D)}],ye[3].push({type:2,data:Cr(ne)})})}P.messages[0].data=Cr(ye);var ae=Li(V),le=Bi(ae);z.content=le,z.size=z.content.length})();var Q=ot(I[3][0].data);{var J=Q[1][0];delete Q[2];var U=ot(J.data);{var ie=Hr(U[2][0].data);(function(){for(var z=Ue.find(d,l[ie].location),V=Kn(Yn(z.content)),P,Z=0;Z<V.length;++Z){var oe=V[Z];oe.id==ie&&(P=oe)}var ye=ot(P.messages[0].data);{delete ye[6],delete Q[7];var ne=new Uint8Array(ye[5][0].data);ye[5]=[];for(var ae=0,le=0;le<=n.e.r;++le){var D=ot(ne);ae+=Ase(D,i[le],o),D[1][0].data=pt(le),ye[5].push({data:Cr(D),type:2})}ye[1]=[{type:0,data:pt(n.e.c+1)}],ye[2]=[{type:0,data:pt(n.e.r+1)}],ye[3]=[{type:0,data:pt(ae)}],ye[4]=[{type:0,data:pt(n.e.r+1)}]}P.messages[0].data=Cr(ye);var Ae=Li(V),Ie=Bi(Ae);z.content=Ie,z.size=z.content.length})()}J.data=Cr(U)}I[3][0].data=Cr(Q)}y[4][0].data=Cr(I)}h.messages[0].data=Cr(y);var re=Li(m),M=Bi(re);return f.content=M,f.size=f.content.length,d}function CC(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Wv(e){CC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Hv(e){CC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Cse(e){return nt.WS.indexOf(e)>-1?"sheet":e==nt.CS?"chart":e==nt.DS?"dialog":e==nt.MS?"macro":e&&e.length?e:"sheet"}function Ose(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Cse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Pse(e,t,r,n,a,i,o,l,c,d,u,f){try{i[n]=ll(Dn(e,r,!0),t);var m=ir(e,t),h;switch(l){case"sheet":h=eae(m,t,a,c,i[n],d,u,f);break;case"chart":if(h=tae(m,t,a,c,i[n],d,u,f),!h||!h["!drawel"])break;var p=tl(h["!drawel"].Target,t),x=Rl(p),g=zQ(Dn(e,p,!0),ll(Dn(e,x,!0),p)),y=tl(g,p),w=Rl(y);h=Ane(Dn(e,y,!0),y,c,ll(Dn(e,w,!0),y),d,h);break;case"macro":h=rae(m,t,a,c,i[n],d,u,f);break;case"dialog":h=nae(m,t,a,c,i[n],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];i&&i[n]&&Yt(i[n]).forEach(function(j){var N="";if(i[n][j].Type==nt.CMNT){N=tl(i[n][j].Target,t);var E=oae(ir(e,N,!0),N,c);if(!E||!E.length)return;bj(h,E,!1)}i[n][j].Type==nt.TCMNT&&(N=tl(i[n][j].Target,t),b=b.concat(WQ(ir(e,N,!0),c)))}),b&&b.length&&bj(h,b,!0,c.people||[])}catch(j){if(c.WTF)throw j}}function Vn(e){return e.charAt(0)=="/"?e.slice(1):e}function Dse(e,t){if(Do(),t=t||{},Wv(t),Xn(e,"META-INF/manifest.xml")||Xn(e,"objectdata.xml"))return Oj(e,t);if(Xn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof dm<"u"){if(e.FileIndex)return dm(e);var r=Ue.utils.cfb_new();return z2(e).forEach(function(_){Qe(r,_,HK(e,_))}),dm(r)}throw new Error("Unsupported NUMBERS file")}if(!Xn(e,"[Content_Types].xml"))throw Xn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=z2(e),a=MY(Dn(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ir(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ir(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(cl=[],a.sst)try{cl=iae(ir(e,Vn(a.sst)),a.sst,t)}catch(_){if(t.WTF)throw _}t.cellStyles&&a.themes.length&&(c=sae(Dn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=aae(ir(e,Vn(a.style)),a.style,c,t))}a.links.map(function(_){try{var W=ll(Dn(e,Rl(Vn(_))),_);return cae(ir(e,Vn(_)),W,_,t)}catch{}});var u=Qne(ir(e,Vn(a.workbooks[0])),a.workbooks[0],t),f={},m="";a.coreprops.length&&(m=ir(e,Vn(a.coreprops[0]),!0),m&&(f=vk(m)),a.extprops.length!==0&&(m=ir(e,Vn(a.extprops[0]),!0),m&&HY(m,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=Dn(e,Vn(a.custprops[0]),!0),m&&(h=GY(m,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(W){return W.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=h),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var x={};t.bookDeps&&a.calcchain&&(x=lae(ir(e,Vn(a.calcchain)),a.calcchain));var g=0,y={},w,b;{var j=u.Sheets;f.Worksheets=j.length,f.SheetNames=[];for(var N=0;N!=j.length;++N)f.SheetNames[N]=j[N].name}var E=i?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Xn(e,T)||(T="xl/_rels/workbook."+E+".rels");var k=ll(Dn(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=dae(ir(e,Vn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=VQ(ir(e,Vn(a.people[0])),t)),k&&(k=Ose(k,u.Sheets));var I=ir(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var C="sheet";if(k&&k[g]?(w="xl/"+k[g][1].replace(/[\/]?xl\//,""),Xn(e,w)||(w=k[g][1]),Xn(e,w)||(w=T.replace(/_rels\/.*$/,"")+k[g][1]),C=k[g][2]):(w="xl/worksheets/sheet"+(g+1-I)+"."+E,w=w.replace(/sheet0\./,"sheet.")),b=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==g&&(A=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}Pse(e,w,b,f.SheetNames[g],g,y,o,C,t,u,c,d)}return p={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:x,Sheets:o,SheetNames:f.SheetNames,Strings:cl,Styles:d,Themes:c,SSF:kt(Ve)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(_,W){_=_.replace(/^Root Entry[\/]/,""),p.keys.push(_),p.files[_]=e.FileIndex[W]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=ir(e,Vn(a.vba[0]),!0):a.defaults&&a.defaults.bin===QQ&&(p.vbaraw=ir(e,"xl/vbaProject.bin",!0))),p}function Ise(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(dJ(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=fJ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=mJ(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);pJ(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=xJ(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Rse(e,t){return t.bookType=="ods"?kC(e,t):t.bookType=="numbers"?kse(e,t):t.bookType=="xlsb"?Fse(e,t):Mse(e,t)}function Fse(e,t){Wi=1024,e&&!e.SSF&&(e.SSF=kt(Ve)),e&&e.SSF&&(Do(),ef(e.SSF),t.revssf=rf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=nC.indexOf(t.bookType)>-1,a=kv();Hv(t=t||{});var i=pv(),o="",l=0;if(t.cellXfs=[],zs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Qe(i,o,yk(e.Props,t)),a.coreprops.push(o),xt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qe(i,o,jk(e.Props)),a.extprops.push(o),xt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Qe(i,o,Nk(e.Custprops)),a.custprops.push(o),xt(t.rels,4,o,nt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qe(i,o,fae(l-1,o,t,e,u)),a.sheets.push(o),xt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(f){var h=f["!comments"],p=!1,x="";h&&h.length>0&&(x="xl/comments"+l+"."+r,Qe(i,x,pae(h,x)),a.comments.push(x),xt(u,-1,"../comments"+l+"."+r,nt.CMNT),p=!0),f["!legacy"]&&p&&Qe(i,"xl/drawings/vmlDrawing"+l+".vml",tC(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Qe(i,Rl(o),Yi(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Qe(i,o,hae(t.Strings,o,t)),a.strs.push(o),xt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,Qe(i,o,uae(e,o)),a.workbooks.push(o),xt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",Qe(i,o,Rv(e.Themes,t)),a.themes.push(o),xt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,Qe(i,o,mae(e,o,t)),a.styles.push(o),xt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Qe(i,o,e.vbaraw),a.vba.push(o),xt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,Qe(i,o,xae(o)),a.metadata.push(o),xt(t.wbrels,-1,"metadata."+r,nt.XLMETA),Qe(i,"[Content_Types].xml",xk(a,t)),Qe(i,"_rels/.rels",Yi(t.rels)),Qe(i,"xl/_rels/workbook."+r+".rels",Yi(t.wbrels)),delete t.revssf,delete t.ssf,i}function Mse(e,t){Wi=1024,e&&!e.SSF&&(e.SSF=kt(Ve)),e&&e.SSF&&(Do(),ef(e.SSF),t.revssf=rf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=nC.indexOf(t.bookType)>-1,a=kv();Hv(t=t||{});var i=pv(),o="",l=0;if(t.cellXfs=[],zs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Qe(i,o,yk(e.Props,t)),a.coreprops.push(o),xt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(i,o,jk(e.Props)),a.extprops.push(o),xt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Qe(i,o,Nk(e.Custprops)),a.custprops.push(o),xt(t.rels,4,o,nt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qe(i,o,hC(l-1,t,e,f)),a.sheets.push(o),xt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(m){var p=m["!comments"],x=!1,g="";if(p&&p.length>0){var y=!1;p.forEach(function(w){w[1].forEach(function(b){b.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+l+"."+r,Qe(i,g,HQ(p,u,t)),a.threadedcomments.push(g),xt(f,-1,"../threadedComments/threadedComment"+l+"."+r,nt.TCMNT)),g="xl/comments"+l+"."+r,Qe(i,g,rC(p)),a.comments.push(g),xt(f,-1,"../comments"+l+"."+r,nt.CMNT),x=!0}m["!legacy"]&&x&&Qe(i,"xl/drawings/vmlDrawing"+l+".vml",tC(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&Qe(i,Rl(o),Yi(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Qe(i,o,Wk(t.Strings,t)),a.strs.push(o),xt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,Qe(i,o,yC(e)),a.workbooks.push(o),xt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",Qe(i,o,Rv(e.Themes,t)),a.themes.push(o),xt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,Qe(i,o,Zk(e,t)),a.styles.push(o),xt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Qe(i,o,e.vbaraw),a.vba.push(o),xt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,Qe(i,o,eC()),a.metadata.push(o),xt(t.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(o="xl/persons/person.xml",Qe(i,o,GQ(u)),a.people.push(o),xt(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Qe(i,"[Content_Types].xml",xk(a,t)),Qe(i,"_rels/.rels",Yi(t.rels)),Qe(i,"xl/_rels/workbook."+r+".rels",Yi(t.wbrels)),delete t.revssf,delete t.ssf,i}function Vv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Bn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Lse(e,t){return Ue.find(e,"EncryptedPackage")?Ise(e,t):NC(e,t)}function Bse(e,t){var r,n=e,a=t||{};return a.type||(a.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r=VA(n,a),Dse(r,a)}function OC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vp(e.slice(r),t);default:break e}return po.to_workbook(e,t)}function $se(e,t){var r="",n=Vv(e,t);switch(t.type){case"base64":r=Bn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=bi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=bt(r)),t.type="binary",OC(r,t)}function zse(e,t){var r=e;return t.type=="base64"&&(r=Bn(r)),r=kl.utils.decode(1200,r.slice(2),"str"),t.type="binary",OC(r,t)}function Use(e){return e.match(/[^\x00-\x7F]/)?ka(e):e}function um(e,t,r,n){return n?(r.type="string",po.to_workbook(e,r)):po.to_workbook(t,r)}function Ul(e,t){dv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ul(new Uint8Array(e),(r=kt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Zi={},r.dateNF&&(Zi.dateNF=r.dateNF),r.type||(r.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=et?"buffer":"binary",n=FK(e),typeof Uint8Array<"u"&&!et&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Use(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=kt(r),r.type="array",Ul(uv(n),r)}switch((a=Vv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Lse(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return NC(n,r);break;case 60:return Vp(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return qZ(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return zk.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Bse(n,r):um(e,n,r,i);case 239:return a[3]===60?Vp(n,r):um(e,n,r,i);case 255:if(a[1]===254)return zse(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return li.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return li.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Hp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Kk.to_workbook(n,r);break;case 10:case 13:case 32:return $se(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return GZ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Hp.to_workbook(n,r):um(e,n,r,i)}function PC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return xc(t.file,Ue.write(e,{type:et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ue.write(e,t)}function Wse(e,t){var r=kt(t||{}),n=Rse(e,r);return Hse(n,r)}function Hse(e,t){var r={},n=et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ue.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Qu(a))}return t.password&&typeof encrypt_agile<"u"?PC(encrypt_agile(a,t.password),t):t.type==="file"?xc(t.file,a):t.type=="string"?bt(a):a}function Vse(e,t){var r=t||{},n=Uae(e,r);return PC(n,r)}function Ta(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cl(ka(n));case"binary":return ka(n);case"string":return e;case"file":return xc(t.file,n,"utf8");case"buffer":return et?ds(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ta(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Gse(e,t){switch(t.type){case"base64":return Cl(e);case"binary":return e;case"string":return e;case"file":return xc(t.file,e,"binary");case"buffer":return et?ds(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cl(r):t.type=="string"?bt(r):r;case"file":return xc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function DC(e,t){dv(),Lne(e);var r=kt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=DC(e,r);return r.type="array",Qu(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ta(Rae(e,r),r);case"slk":case"sylk":return Ta($k.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ta(SC(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Gse(IC(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ta(qv(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ta(zk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return nd(Hp.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ta(po.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ta(Kk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ta(Uk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ta(kC(e,r),r);case"wk1":return nd(li.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return nd(li.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),nd(EC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Vse(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Wse(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function qse(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Gv(e,t,r){var n=r||{};return n.type="file",n.file=t,qse(n),DC(e,n)}function Kse(e,t,r,n,a,i,o,l){var c=er(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=o?e[r][h]:e[n[h]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[h]!=null&&(m[i[h]]=d);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(x==null)if(p.t=="e"&&x===null)m[i[h]]=null;else if(d!==void 0)m[i[h]]=d;else if(u&&x===null)m[i[h]]=null;else continue;else m[i[h]]=u&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:rs(p,x,l);x!=null&&(f=!1)}}return{row:m,isempty:f}}function du(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=it(u);break;case"number":c=it(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var f=er(c.s.r),m=[],h=[],p=0,x=0,g=Array.isArray(e),y=c.s.r,w=0,b={};g&&!e[y]&&(e[y]=[]);var j=d.skipHidden&&e["!cols"]||[],N=d.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(j[w]||{}).hidden)switch(m[w]=Ft(w),r=g?e[y][w]:e[m[w]+f],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=m[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=rs(r,null,d),x=b[o]||0,!x)b[o]=1;else{do l=o+"_"+x++;while(b[l]);b[o]=x,b[l]=1}i[w]=l}for(y=c.s.r+a;y<=c.e.r;++y)if(!(N[y]||{}).hidden){var E=Kse(e,c,y,m,n,i,g,d);(E.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(h[p++]=E.row)}return h.length=p,h}var Fj=/"/g;function Yse(e,t,r,n,a,i,o,l){for(var c=!0,d=[],u="",f=er(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var h=l.dense?(e[r]||[])[m]:e[n[m]+f];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:rs(h,null,l));for(var p=0,x=0;p!==u.length;++p)if((x=u.charCodeAt(p))===a||x===i||x===34||l.forceQuotes){u='"'+u.replace(Fj,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(Fj,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function qv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=it(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(m[p]||{}).hidden||(f[p]=Ft(p));for(var x=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(u=Yse(e,a,g,f,o,c,i,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete n.dense,r.join("")}function IC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=qv(e,t);return r}function Xse(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=it(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=Ft(l);for(var u=a.s.r;u<=a.e.r;++u)for(i=er(u),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function RC(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var f=it(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+a)}else o==-1&&(o=0,u.e.r=t.length-1+a);var m=n.header||[],h=0;t.forEach(function(x,g){Yt(x).forEach(function(y){(h=m.indexOf(y))==-1&&(m[h=m.length]=y);var w=x[y],b="z",j="",N=Ge({c:l+h,r:o+g+a});d=Wl(i,N),w&&typeof w=="object"&&!(w instanceof Date)?i[N]=w:(typeof w=="number"?b="n":typeof w=="boolean"?b="b":typeof w=="string"?b="s":w instanceof Date?(b="d",n.cellDates||(b="n",w=vr(w)),j=n.dateNF||Ve[14]):w===null&&n.nullError&&(b="e",w=0),d?(d.t=b,d.v=w,delete d.w,delete d.R,j&&(d.z=j)):i[N]=d={t:b,v:w},j&&(d.z=j))})}),u.e.c=Math.max(u.e.c,l+m.length-1);var p=er(o);if(a)for(h=0;h<m.length;++h)i[Ft(h+l)+p]={t:"s",v:m[h]};return i["!ref"]=Je(u),i}function Zse(e,t){return RC(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Mt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,Ge(t)):Wl(e,Ge({r:t,c:r||0}))}function Jse(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Kv(){return{SheetNames:[],Sheets:{}}}function Yv(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(vC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Qse(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Jse(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eie(e,t){return e.z=t,e}function FC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tie(e,t,r){return FC(e,"#"+t,r)}function rie(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nie(e,t,r,n){for(var a=typeof t!="string"?t:it(t),i=typeof t=="string"?t:Je(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Wl(e,o,l);c.t="n",c.F=i,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var ea={encode_col:Ft,encode_row:er,encode_cell:Ge,encode_range:Je,decode_col:Nv,decode_row:jv,split_cell:hY,decode_cell:Mt,decode_range:Nn,format_cell:rs,sheet_add_aoa:ck,sheet_add_json:RC,sheet_add_dom:TC,aoa_to_sheet:Io,json_to_sheet:Zse,table_to_sheet:_C,table_to_book:dse,sheet_to_csv:qv,sheet_to_txt:IC,sheet_to_json:du,sheet_to_html:SC,sheet_to_formulae:Xse,sheet_to_row_object_array:du,sheet_get_cell:Wl,book_new:Kv,book_append_sheet:Yv,book_set_sheet_visibility:Qse,cell_set_number_format:eie,cell_set_hyperlink:FC,cell_set_internal_link:tie,cell_add_comment:rie,sheet_set_array_formula:nie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aie=({show:e,onClose:t,onImport:r,loading:n=!1})=>{const[a,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState([]),[u,f]=v.useState([]),[m,h]=v.useState([]),[p,x]=v.useState([]),[g,y]=v.useState(!1),w=v.useRef(null),b=["first_name","last_name","email","role"],j=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","department","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];v.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{y(!0);const re=await nn.getRoles();x(re.roles||[])}catch(re){console.error("Failed to fetch roles:",re),f(["Failed to load roles. Please refresh the page."])}finally{y(!1)}},E=re=>{if(!re)return"";try{return decodeURIComponent(escape(re)).trim()}catch{return re.toString().trim()}},S=re=>{if(!re)return"";try{let M;if(re instanceof Date)M=re;else{const V=re.toString().trim();if(!V||V===""||V==="null"||V==="undefined")return"";if(V.includes("/")){const P=V.split("/");P.length===3&&(M=new Date(P[2],P[0]-1,P[1]))}else if(V.includes("-")){const P=V.split("-");P.length===3&&(P[0].length===4?M=new Date(P[0],P[1]-1,P[2]):M=new Date(P[2],P[1]-1,P[0]))}else M=new Date(V)}if(isNaN(M.getTime()))return"";const z=M.getFullYear();return z<1900||z>2100?"":M.toISOString()}catch(M){return console.error("Error formatting date:",M,"Input:",re),""}},T=re=>{if(!re)return"MALE";const M=re.toString().toUpperCase().trim();return M==="MALE"||M==="FEMALE"?M:{M:"MALE",F:"FEMALE"}[M]||"MALE"},k=re=>{if(!re)return null;const M=re.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(M)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},I=re=>{if(!re||!p.length)return null;const M=re.toUpperCase().trim(),z=p.find(oe=>oe.name.toUpperCase()===M);if(z)return z.id;const P={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT"}[M];if(P){const oe=p.find(ye=>ye.name.toUpperCase()===P);if(oe)return oe.id}const Z=p.find(oe=>oe.name.toUpperCase().includes(M)||M.includes(oe.name.toUpperCase()));return Z?Z.id:null},C=re=>{if(!re||!p.length)return null;const M=re.toUpperCase().trim(),z=p.find(oe=>oe.name.toUpperCase()===M);if(z)return z.name;const P={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT"}[M];if(P){const oe=p.find(ye=>ye.name.toUpperCase()===P);if(oe)return oe.name}const Z=p.find(oe=>oe.name.toUpperCase().includes(M)||M.includes(oe.name.toUpperCase()));return Z?Z.name:null},A=()=>{const re=[j,["Nguyn","Vn","An","123 ng L Li, Qun 1, TP.HCM","nguyen.van.an@example.com","+84 123 456 789","TRAINER","M","1","CERT001","Flight Training","5","1990-01-15","BATCH2023-01","P123456789","Vietnam"]],M=ea.aoa_to_sheet(re),z=ea.book_new();ea.book_append_sheet(z,M,"Users"),Gv(z,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},L=re=>{re.preventDefault(),re.stopPropagation(),re.type==="dragenter"||re.type==="dragover"?i(!0):re.type==="dragleave"&&i(!1)},_=re=>{re.preventDefault(),re.stopPropagation(),i(!1),re.dataTransfer.files&&re.dataTransfer.files[0]&&Y(re.dataTransfer.files[0])},W=re=>{re.target.files&&re.target.files[0]&&Y(re.target.files[0])},Y=re=>{if(!re.name.match(/\.(xlsx|xls)$/)){f(["Please upload an Excel file (.xlsx or .xls)"]);return}if(re.size>100*1024*1024){f(["File size must be less than 100MB"]);return}l(re),f([]),h([]),d([]);const M=new FileReader;M.onload=z=>{try{const V=new Uint8Array(z.target.result),P=Ul(V,{type:"array",cellText:!1,cellDates:!0,raw:!1}),Z=P.SheetNames[0],oe=P.Sheets[Z],ye=ea.sheet_to_json(oe,{header:1,defval:"",raw:!1});if(ye.length<2){f(["File must contain at least a header row and one data row"]);return}const ne=ye[0].map(Re=>Re?Re.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),ae=ye.slice(1),le={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",department:"department",dept:"department",dept_id:"department",department_id:"department",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},Ae=ne.map(Re=>le[Re]||Re).filter(Re=>j.includes(Re)),Ie=b.filter(Re=>!Ae.includes(Re));if(Ie.length>0){h([`Your file is missing these essential data to create a user: ${Ie.join(", ")}`]);return}const Ke=ae.map((Re,Se)=>{const He={};let Pe=!1;const Fe=[];ne.forEach((ar,yt)=>{const Xt=le[ar]||ar;if(j.includes(Xt)){let $r="";Re[yt]!==null&&Re[yt]!==void 0&&(typeof Re[yt]=="string"?$r=E(Re[yt]):typeof Re[yt]=="number"?$r=Re[yt].toString():$r=E(Re[yt].toString())),Xt==="gender"&&($r=T($r)),He[Xt]=$r}}),Ae.forEach(ar=>{const yt=He[ar]||"";if(b.includes(ar)&&!yt&&(Pe=!0,Fe.push("Required field missing")),ar==="email"&&yt&&!/\S+@\S+\.\S+/.test(yt)&&(Pe=!0,Fe.push("Invalid email")),ar==="role"&&yt&&(I(yt)||(Pe=!0,Fe.push("Invalid role"))),ar==="phone_number"&&yt&&yt.length>15&&(Pe=!0,Fe.push("Phone number too long (max 15 characters)")),ar==="years_of_experience"&&yt&&isNaN(yt)&&(Pe=!0,Fe.push("Invalid experience value")),ar==="gender"&&yt){const Xt=k(yt);Xt&&(Pe=!0,Fe.push(Xt))}});const Wt=C(He.role);return Wt==="TRAINER"?((!He.specialization||He.specialization.trim()==="")&&(Pe=!0,Fe.push("Trainer requires specialization")),(!He.years_of_experience||He.years_of_experience.trim()==="")&&(Pe=!0,Fe.push("Trainer requires years of experience")),(!He.department||He.department.trim()==="")&&(Pe=!0,Fe.push("Trainer requires department"))):Wt==="TRAINEE"&&(!He.date_of_birth||He.date_of_birth.trim()===""?(Pe=!0,Fe.push("Trainee requires date of birth")):S(He.date_of_birth)||(Pe=!0,Fe.push(`Invalid date format for date of birth: "${He.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!He.training_batch||He.training_batch.trim()==="")&&(Pe=!0,Fe.push("Trainee requires training batch")),(!He.passport_no||He.passport_no.trim()==="")&&(Pe=!0,Fe.push("Trainee requires passport number")),(!He.nation||He.nation.trim()==="")&&(Pe=!0,Fe.push("Trainee requires nation")),He.enrollment_date&&He.enrollment_date.trim()!==""&&(S(He.enrollment_date)||(Pe=!0,Fe.push(`Invalid date format for enrollment date: "${He.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Se+1,...He,hasError:Pe,errors:Fe,status:Pe?"error":"valid"}});d(Ke)}catch{f(["Error reading file. Please make sure it's a valid Excel file."])}},M.readAsArrayBuffer(re)},Q=async()=>{const re=c.filter(z=>!z.hasError);if(re.length===0){f(["No valid users to import"]);return}if(!p.length){f(["Roles not loaded. Please wait and try again."]);return}const M=re.map(z=>{const V=z.phone_number?z.phone_number.substring(0,15):"",P=I(z.role),Z=C(z.role);if(!P||!Z)throw new Error(`Role "${z.role}" not found in system`);const oe={firstName:z.first_name||"",middleName:z.middle_name||"",lastName:z.last_name||"",address:z.address||"",email:z.email||"",phoneNumber:V,avatarUrl:z.avatar_url||"",gender:T(z.gender),role:{id:P,name:Z}};if(z.department&&(oe.department={id:z.department}),Z==="TRAINER")oe.trainerProfile={specialization:z.specialization||"",yearsOfExp:z.years_of_experience?parseInt(z.years_of_experience):0,certificationNumber:z.certification_number||"",bio:z.bio||""};else if(Z==="TRAINEE"){const ye={trainingBatch:z.training_batch||"",passportNo:z.passport_no||"",nation:z.nation||""},ne=S(z.date_of_birth);ne&&(ye.dob=ne);const ae=S(z.enrollment_date);ae?ye.enrollmentDate=ae:ye.enrollmentDate=new Date().toISOString(),oe.traineeProfile=ye}return oe});try{await r(M),J()}catch(z){f([z.message||"Failed to import users. Please try again."])}},J=()=>{l(null),d([]),f([]),h([]),i(!1),t()},U=re=>{d(M=>M.filter(z=>z.id!==re))},ie=re=>re==="valid"?s.jsx(dt,{className:"text-success",size:16}):s.jsx(_a,{className:"text-danger",size:16});return s.jsxs(ce,{show:e,onHide:J,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-2",size:20}),"Bulk Import Users"]}),s.jsx(se,{variant:"link",onClick:J,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:s.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),s.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),s.jsx(te,{className:"mb-4",children:s.jsxs(te.Body,{children:[s.jsxs("div",{className:`upload-area ${a?"drag-active":""}`,onDragEnter:L,onDragLeave:L,onDragOver:L,onDrop:_,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:a?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(eo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:W,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[o&&s.jsxs("p",{className:"text-success mb-1",children:[s.jsx("strong",{children:"Uploaded file:"})," ",o.name]}),s.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),s.jsxs("small",{className:"text-info d-block mt-1",children:[s.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:A,className:"d-flex align-items-center",children:[s.jsx(Qi,{className:"me-1",size:14}),"Download Template"]})]})]})}),u.length>0&&s.jsx("div",{className:"alert alert-danger mb-3",children:s.jsx("ul",{className:"mb-0",children:u.map((re,M)=>s.jsx("li",{children:re},M))})}),m.length>0&&s.jsx(Ye,{variant:"warning",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:m.map((re,M)=>s.jsx("li",{children:re},M))})}),c.length>0&&s.jsxs(te,{children:[s.jsx(te.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(qt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),s.jsx("th",{style:{minWidth:"100px"},children:"DEPARTMENT"}),s.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),s.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),s.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),s.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),s.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),s.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),s.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),s.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),s.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:c.map(re=>s.jsxs("tr",{className:re.hasError?"table-danger":"",children:[s.jsx("td",{children:re.id}),s.jsx("td",{children:re.first_name||re.full_name||"-"}),s.jsx("td",{children:re.middle_name||"-"}),s.jsx("td",{children:re.last_name||"-"}),s.jsx("td",{children:re.email||"-"}),s.jsx("td",{children:re.role||"-"}),s.jsx("td",{children:re.department||"-"}),s.jsx("td",{children:re.phone_number||"-"}),s.jsx("td",{children:re.gender?s.jsx("span",{title:`Original: ${re.gender}`,children:T(re.gender)}):"-"}),s.jsx("td",{children:re.certification_number||"-"}),s.jsx("td",{children:re.specialization||"-"}),s.jsx("td",{children:re.years_of_experience||"-"}),s.jsx("td",{children:re.date_of_birth||"-"}),s.jsx("td",{children:re.training_batch||"-"}),s.jsx("td",{children:re.passport_no||"-"}),s.jsx("td",{children:re.nation||"-"}),s.jsx("td",{className:"text-center",children:ie(re.status)}),s.jsx("td",{children:re.errors.length>0&&s.jsx("small",{className:"text-danger",children:re.errors.length>1?`${re.errors[0]} (+${re.errors.length-1} more)`:re.errors[0]})}),s.jsx("td",{children:s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>U(re.id),children:s.jsx(Ti,{size:14})})})]},re.id))})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:J,disabled:n,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&s.jsx(n4,{placement:"top",overlay:s.jsxs(a4,{id:"import-tooltip",children:["Only ",c.filter(re=>!re.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:s.jsx(se,{variant:"primary",onClick:Q,disabled:n||c.filter(re=>!re.hasError).length===0,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"me-2",size:16}),"Import All (",c.filter(re=>!re.hasError).length," users)"]})})})]})]})},sie=({show:e,user:t,onConfirm:r,onCancel:n,loading:a=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",o=i?"Disable":"Enable",c=i?vo:dt;return s.jsxs(ce,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),o," User"]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:s.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),s.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),s.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"EID"}),s.jsx("div",{className:"fw-medium",children:t.eid})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Department"}),s.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),i?s.jsxs(Ye,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User cannot log into the system"}),s.jsx("li",{children:"All active sessions will be terminated"}),s.jsx("li",{children:"User data will be preserved but access restricted"}),s.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):s.jsxs(Ye,{variant:"success",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User can log into the system normally"}),s.jsx("li",{children:"All permissions and access will be restored"}),s.jsx("li",{children:"User will receive notification of account activation"}),s.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 bg-light",children:[s.jsx(se,{variant:"outline-secondary",onClick:n,disabled:a,children:"Cancel"}),s.jsx(se,{variant:i?"warning":"success",onClick:r,disabled:a,className:"d-flex align-items-center",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"me-2",size:16}),o," User"]})})]})]})},iie=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:n,onRoleToggle:a,onDepartmentToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return s.jsxs(dn,{className:`filter-panel-dropdown ${l}`,children:[s.jsx(dn.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(go,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]})}),s.jsxs(dn.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(F.Check,{type:"checkbox",id:`role-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),n.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(F.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:n.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(We,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},oie=({show:e,user:t,newRole:r,onConfirm:n,onCancel:a,loading:i=!1})=>{if(!t)return null;const o=d=>{switch(d){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},l=o(t.role),c=o(r);return s.jsxs(ce,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:s.jsx(Et,{size:32,className:"text-warning"})}),s.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),s.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"Current Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"New Role"}),s.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),s.jsxs(Ye,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",l,")"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),s.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),s.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 bg-light",children:[s.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:i,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"warning",onClick:()=>{n()},disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},lie=({show:e,user:t,mode:r,onSave:n,onClose:a})=>{const[i,o]=v.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[l,c]=v.useState({}),[d,u]=v.useState(!1),[f,m]=v.useState([]),[h,p]=v.useState(!1),[x,g]=v.useState([]),[y,w]=v.useState(!1),[b,j]=v.useState([]),N=async()=>{p(!0);try{const _=await ct.getDepartments(),Y=(_.departments||_.data||[]).map(Q=>Q.name);m(Y)}catch(_){console.error("Error fetching departments:",_),xe.error("Failed to load departments"),m([])}finally{p(!1)}},E=async()=>{w(!0);try{const _=await _n.getRoles(),Y=(_.roles||_.data||[]).map(Q=>Q.name);g(Y)}catch(_){console.error("Error fetching roles:",_),xe.error("Failed to load roles"),g([])}finally{w(!1)}},S=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],T=async()=>{try{const W=(await ct.getDepartments({includeDeleted:!0}))?.departments?.filter(Y=>Y.headUser)||[];j(W)}catch(_){console.error("Error fetching departments with heads:",_),j([])}};v.useEffect(()=>{e&&(N(),E(),T())},[e]),v.useEffect(()=>{t&&r!=="add"?o({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&o({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const k=()=>{const _={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(_.firstName="First name can only contain letters and spaces"):_.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(_.lastName="Last name can only contain letters and spaces"):_.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(_.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(_.email="Email is invalid"):_.email="Email is required",!i.phoneNumber.trim())_.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))_.phoneNumber="Phone number cannot contain letters";else{const W=i.phoneNumber.replace(/[^\d+]/g,"");(W.length<7||W.length>16)&&(_.phoneNumber="Phone number must be 7-16 digits")}if(i.role||(_.role="Role is required"),i.role==="DEPARTMENT_HEAD")if(!i.department.trim())_.department="Department is required for department heads";else{const W=b.find(Y=>{const Q=Y.name,J=i.department,U=Y.headUser?.id,ie=Q&&J&&Q.toLowerCase()===J.toLowerCase(),re=r!=="edit"||U!==t?.id;return ie&&re});if(W){const Y=`${W.headUser?.firstName||""} ${W.headUser?.lastName||""}`.trim();_.department=`Department "${i.department}" already has a head: ${Y}`}}return i.role==="TRAINER"&&(i.specialization.trim()||(_.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(_.certificationNumber="Certification number is required for trainers")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(_.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(_.passportNo="Passport number must be 1-20 digits only"):_.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?_.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(_.dateOfBirth="Date of birth must be in the past"):_.dateOfBirth="Date of birth is required for trainees"),c(_),Object.keys(_).length===0},I=async _=>{if(_.preventDefault(),!!k()&&!d){u(!0);try{await n(i)}catch(W){console.error("Error in handleSubmit:",W)}finally{u(!1)}}},C=(_,W)=>{o(Y=>({...Y,[_]:W})),c(Y=>{const Q={...Y};if(Q[_]&&delete Q[_],_==="role"&&(delete Q.specialization,delete Q.certificationNumber,delete Q.trainingBatch,delete Q.passportNo,delete Q.dateOfBirth,delete Q.department),_==="department"&&(delete Q.department,i.role==="DEPARTMENT_HEAD"))if(!W.trim())Q.department="Department is required for department heads";else{const J=b.find(U=>{const ie=U.name,re=W,M=U.headUser?.id;return ie&&re&&ie.toLowerCase()===re.toLowerCase()&&(r!=="edit"||M!==t?.id)});if(J){const U=`${J.headUser?.firstName||""} ${J.headUser?.lastName||""}`.trim();Q.department=`Department "${W}" already has a head: ${U}`}}return Q})},A=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},L=r==="view";return s.jsxs(ce,{show:e,onHide:a,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(Oa,{className:"me-2",size:20}),A()]})}),s.jsxs(F,{onSubmit:I,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(l).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([_,W])=>s.jsx("li",{children:W},_))})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:4,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),s.jsx(F.Control,{type:"text",value:i.firstName,onChange:_=>C("firstName",_.target.value),isInvalid:!!l.firstName,readOnly:L,style:{borderColor:l.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.firstName})]})}),s.jsx(ee,{md:4,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),s.jsx(F.Control,{type:"text",value:i.middleName,onChange:_=>C("middleName",_.target.value),isInvalid:!!l.middleName,readOnly:L,style:{borderColor:l.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.middleName})]})}),s.jsx(ee,{md:4,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),s.jsx(F.Control,{type:"text",value:i.lastName,onChange:_=>C("lastName",_.target.value),isInvalid:!!l.lastName,readOnly:L,style:{borderColor:l.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),s.jsx(F.Control,{type:"email",value:i.email,onChange:_=>C("email",_.target.value),isInvalid:!!l.email,readOnly:L,style:{borderColor:l.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.email})]})})}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),s.jsx(F.Control,{type:"tel",value:i.phoneNumber,onChange:_=>C("phoneNumber",_.target.value),isInvalid:!!l.phoneNumber,readOnly:L,placeholder:"Enter phone number",style:{borderColor:l.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.phoneNumber})]})})}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),s.jsx(F.Control,{as:"textarea",rows:3,value:i.address,onChange:_=>C("address",_.target.value),readOnly:L,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsxs(ge,{children:[s.jsx(ee,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),s.jsxs(F.Select,{value:i.role,onChange:_=>C("role",_.target.value),isInvalid:!!l.role,disabled:L||y,style:{borderColor:l.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:y?"Loading roles...":"Select a role"}),x.map(_=>s.jsx("option",{value:_,children:_},_))]}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.role})]})}),(i.role==="DEPARTMENT_HEAD"||i.role==="TRAINER")&&s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),s.jsxs(F.Select,{value:i.department,onChange:_=>C("department",_.target.value),isInvalid:!!l.department,disabled:L||h,style:{borderColor:l.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:h?"Loading departments...":"Select a department"}),f.map(_=>s.jsx("option",{value:_,children:_},_))]}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.department})]})})]}),i.role==="TRAINER"&&s.jsxs(s.Fragment,{children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),s.jsx(F.Control,{type:"text",value:i.specialization,onChange:_=>C("specialization",_.target.value),isInvalid:!!l.specialization,readOnly:L,placeholder:"Enter specialization",style:{borderColor:l.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.specialization})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),s.jsx(F.Control,{type:"text",value:i.certificationNumber,onChange:_=>C("certificationNumber",_.target.value),isInvalid:!!l.certificationNumber,readOnly:L,placeholder:"Enter certification number",style:{borderColor:l.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.certificationNumber})]})})]}),s.jsx(ge,{children:s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),s.jsx(F.Control,{type:"number",value:i.yearsOfExperience,onChange:_=>C("yearsOfExperience",_.target.value),readOnly:L,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})})]}),i.role==="TRAINEE"&&s.jsxs(s.Fragment,{children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),s.jsx(F.Control,{type:"date",value:i.dateOfBirth,onChange:_=>{const W=_.target.value;(W===""||W.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(W))&&C("dateOfBirth",W)},isInvalid:!!l.dateOfBirth,readOnly:L,max:"2024-12-31",min:"1900-01-01",style:{borderColor:l.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.dateOfBirth})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),s.jsx(F.Control,{type:"text",value:i.trainingBatch,onChange:_=>C("trainingBatch",_.target.value),isInvalid:!!l.trainingBatch,readOnly:L,placeholder:"Enter training batch",style:{borderColor:l.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.trainingBatch})]})})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),s.jsx(F.Control,{type:"text",value:i.passportNo,onChange:_=>C("passportNo",_.target.value),isInvalid:!!l.passportNo,readOnly:L,placeholder:"Enter passport number",style:{borderColor:l.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.passportNo})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),s.jsxs(F.Select,{value:i.nation,onChange:_=>C("nation",_.target.value),disabled:L,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select a nation"}),S.map(_=>s.jsx("option",{value:_,children:_},_))]})]})})]})]}),r==="view"&&t&&s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),s.jsx(F.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:d,children:[s.jsx(We,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},cie=({user:e,index:t,onView:r,onEdit:n,onDisable:a})=>{const i=l=>l==="ACTIVE"?"success":"secondary",o=l=>l==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:e.email})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.department})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(Ce,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:o(e.status)}),e.status]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.USERS.VIEW_DETAIL,je.USERS.UPDATE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r(e),permission:je.USERS.VIEW_DETAIL},{label:"Edit User",icon:s.jsx(ga,{}),onClick:()=>n(e),permission:je.USERS.UPDATE},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:s.jsx(vo,{}),className:"text-danger",onClick:()=>a(e),permission:je.USERS.UPDATE}]})})})]})},tn=(e,t=null,r="asc")=>{const[n,a]=v.useState({key:t,direction:r});return{sortedData:v.useMemo(()=>!n.key||!e?e:[...e].sort((d,u)=>{let f=d[n.key],m=u[n.key];if(n.key.includes(".")){const h=n.key.split(".");f=h.reduce((p,x)=>p?.[x],d),m=h.reduce((p,x)=>p?.[x],u)}if(n.key.includes("length")){const h=n.key.replace(".length","");f=d[h]?.length||0,m=u[h]?.length||0}return typeof f=="string"&&typeof m=="string"&&(f=f.toLowerCase(),m=m.toLowerCase()),f<m?n.direction==="asc"?-1:1:f>m?n.direction==="asc"?1:-1:0}),[e,n]),sortConfig:n,handleSort:d=>{let u="asc";if(n.key===d&&n.direction==="asc")u="desc";else if(n.key===d&&n.direction==="desc"){a({key:null,direction:"asc"});return}a({key:d,direction:u})},getSortIcon:d=>n.key!==d?"":n.direction==="asc"?"":"",getSortClass:d=>n.key!==d?"text-muted":(n.direction==="asc","text-primary")}},die=({users:e,loading:t,onView:r,onEdit:n,onDisable:a})=>{const{sortedData:i,sortConfig:o,handleSort:l}=tn(e);if(t)return s.jsx(Qr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No users found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:d,children:u,className:f=""})=>{const m=o.key===d,h=m?o.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${f} ${m?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="transparent",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:h,size:14})})]}),m&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),s.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),s.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:i.map((d,u)=>s.jsx(cie,{user:d,index:u,onView:r,onEdit:n,onDisable:a},d.id))})]})})},uie=()=>{const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,i]=v.useState(""),[o,l]=v.useState([]),[c,d]=v.useState([]),[u,f]=v.useState(!1),[m,h]=v.useState(null),[p,x]=v.useState("view"),[g,y]=v.useState(!1),[w,b]=v.useState(null),[j,N]=v.useState(!1),[E,S]=v.useState(null);v.useEffect(()=>{(async()=>{y(!0);try{const[Z,oe]=await Promise.all([nn.getUsers({includeDeleted:!0}),ct.getDepartments({includeDeleted:!0})]),ye=Z.data.map(ae=>({id:ae.id,eid:ae.eid,fullName:[ae.firstName,ae.middleName,ae.lastName].filter(Boolean).join(" "),firstName:ae.firstName,middleName:ae.middleName,lastName:ae.lastName,role:ae.role?.name||"N/A",roleId:ae.role?.id||"",department:ae.department?.name||"N/A",status:ae.status,email:ae.email,phoneNumber:ae.phoneNumber||"",address:ae.address||"",certificationNumber:ae.certificationNumber||"",specialization:ae.specialization||"",yearsOfExperience:ae.yearsOfExperience||"",dateOfBirth:ae.dateOfBirth||"",trainingBatch:ae.trainingBatch||"",passportNo:ae.passportNo||"",nation:ae.nation||"",createdAt:ae.createdAt,lastLogin:ae.lastLogin||""})),ne=oe.departments||oe||[];t(ye),n(ne),b(null)}catch(Z){const oe=ca(Z,{});b(oe)}finally{y(!1)}})()},[]);const T=[...new Set(e.map(P=>P.role).filter(Boolean))],k=[...new Set(r.map(P=>P.name).filter(Boolean)),...new Set(e.map(P=>P.department).filter(Boolean))].filter((P,Z,oe)=>oe.indexOf(P)===Z),I=e.filter(P=>{const Z=!a||P.fullName.toLowerCase().includes(a.toLowerCase())||P.eid.toLowerCase().includes(a.toLowerCase())||P.email.toLowerCase().includes(a.toLowerCase()),oe=o.length===0||o.includes(P.role),ye=c.length===0||c.includes(P.department);return Z&&oe&&ye}),C=P=>i(P),A=P=>{l(Z=>Z.includes(P)?Z.filter(oe=>oe!==P):[...Z,P])},L=P=>{d(Z=>Z.includes(P)?Z.filter(oe=>oe!==P):[...Z,P])},_=()=>{l([]),d([]),i("")},W=async P=>{try{y(!0);const Z=await nn.getUserById(P.id),oe={id:Z.id,eid:Z.eid,fullName:[Z.firstName,Z.middleName,Z.lastName].filter(Boolean).join(" "),firstName:Z.firstName,middleName:Z.middleName,lastName:Z.lastName,role:Z.role?.name||"N/A",roleId:Z.role?.id||"",department:Z.department?.name||"N/A",status:Z.status,email:Z.email,phoneNumber:Z.phoneNumber||"",address:Z.address||"",certificationNumber:Z.trainerProfile?.certificationNumber||"",specialization:Z.trainerProfile?.specialization||"",yearsOfExperience:Z.trainerProfile?.yearsOfExp||"",dateOfBirth:Z.traineeProfile?.dob?Z.traineeProfile.dob.split("T")[0]:"",trainingBatch:Z.traineeProfile?.trainingBatch||"",passportNo:Z.traineeProfile?.passportNo||"",nation:Z.traineeProfile?.nation||"",createdAt:Z.createdAt,lastLogin:Z.lastLogin||""};h(oe),x("view"),f(!0)}catch{b("Unable to load user details")}finally{y(!1)}},Y=async P=>{try{y(!0);const Z=await nn.getUserById(P.id),oe={id:Z.id,eid:Z.eid,fullName:[Z.firstName,Z.middleName,Z.lastName].filter(Boolean).join(" "),firstName:Z.firstName,middleName:Z.middleName,lastName:Z.lastName,role:Z.role?.name||"N/A",roleId:Z.role?.id||"",department:Z.department?.name||"N/A",status:Z.status,email:Z.email,phoneNumber:Z.phoneNumber||"",address:Z.address||"",certificationNumber:Z.trainerProfile?.certificationNumber||"",specialization:Z.trainerProfile?.specialization||"",yearsOfExperience:Z.trainerProfile?.yearsOfExp||"",dateOfBirth:Z.traineeProfile?.dob?Z.traineeProfile.dob.split("T")[0]:"",trainingBatch:Z.traineeProfile?.trainingBatch||"",passportNo:Z.traineeProfile?.passportNo||"",nation:Z.traineeProfile?.nation||"",createdAt:Z.createdAt,lastLogin:Z.lastLogin||""};h(oe),x("edit"),f(!0)}catch{b("Unable to load user details")}finally{y(!1)}},Q=()=>{h(null),x("add"),f(!0)},J=async P=>{try{y(!0);let Z,oe;P.status==="ACTIVE"?(Z=await nn.disableUser(P.id),oe="disabled"):(Z=await nn.enableUser(P.id),oe="enabled");const[ye,ne]=await Promise.all([nn.getUsers({includeDeleted:!0}),ct.getDepartments({includeDeleted:!0})]),ae=ye.data.map(Ae=>({id:Ae.id,eid:Ae.eid,fullName:[Ae.firstName,Ae.middleName,Ae.lastName].filter(Boolean).join(" "),firstName:Ae.firstName,middleName:Ae.middleName,lastName:Ae.lastName,role:Ae.role?.name||"N/A",roleId:Ae.role?.id||"",department:Ae.department?.name||"N/A",status:Ae.status,email:Ae.email,phoneNumber:Ae.phoneNumber||"",address:Ae.address||"",certificationNumber:Ae.trainerProfile?.certificationNumber||"",specialization:Ae.trainerProfile?.specialization||"",yearsOfExperience:Ae.trainerProfile?.yearsOfExp||"",dateOfBirth:Ae.traineeProfile?.dob?Ae.traineeProfile.dob.split("T")[0]:"",trainingBatch:Ae.traineeProfile?.trainingBatch||"",passportNo:Ae.traineeProfile?.passportNo||"",nation:Ae.traineeProfile?.nation||"",createdAt:Ae.createdAt,lastLogin:Ae.lastLogin||""})),le=ne.departments||ne||[];t(ae),n(le);const D=Z?.message||`User has been ${oe} successfully!`;xe.success(D)}catch(Z){const oe=ca(Z,{});b(oe),xe.error(oe)}finally{y(!1)}},U=async P=>{try{if(y(!0),p==="edit"&&m&&m.role!==P.role){S(P),N(!0),y(!1);return}await ie(P)}catch{y(!1)}},ie=async P=>{try{y(!0);let Z=null;try{const Ae=(await nn.getRoles()).roles?.find(Ie=>Ie.name===P.role);if(Ae)Z=Ae.id;else throw new Error(`Role '${P.role}' not found in backend`)}catch(D){throw new Error(`Failed to get role ID for '${P.role}': ${D.message}`)}const oe={firstName:P.firstName,middleName:P.middleName||"",lastName:P.lastName,address:P.address||"",email:P.email,gender:"MALE",avatarUrl:"",phoneNumber:P.phoneNumber||"",role:{id:Z,name:P.role}};P.role==="TRAINER"?oe.trainerProfile={specialization:P.specialization||"",certificationNumber:P.certificationNumber||"",yearsOfExp:P.yearsOfExperience?parseInt(P.yearsOfExperience):0,bio:""}:P.role==="TRAINEE"&&(P.dateOfBirth||P.trainingBatch||P.passportNo||P.nation)&&(oe.traineeProfile={dob:P.dateOfBirth?new Date(P.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:P.trainingBatch||"",passportNo:P.passportNo||"",nation:P.nation||""}),p==="add"?(await nn.createUser(oe),xe.success("User created successfully!")):p==="edit"&&(await nn.updateUser(m.id,oe),xe.success("User updated successfully!")),f(!1);const[ye,ne]=await Promise.all([nn.getUsers({includeDeleted:!0}),ct.getDepartments({includeDeleted:!0})]);if(p==="edit"&&m?.id){const D=ye.data.find(Ae=>Ae.id===m.id)}const ae=ye.data.map(D=>({id:D.id,eid:D.eid,fullName:[D.firstName,D.middleName,D.lastName].filter(Boolean).join(" "),firstName:D.firstName,middleName:D.middleName,lastName:D.lastName,role:D.role?.name||"N/A",roleId:D.role?.id||"",department:D.department?.name||"N/A",status:D.status,email:D.email,phoneNumber:D.phoneNumber||"",address:D.address||"",certificationNumber:D.trainerProfile?.certificationNumber||"",specialization:D.trainerProfile?.specialization||"",yearsOfExperience:D.trainerProfile?.yearsOfExp||"",dateOfBirth:D.traineeProfile?.dob?D.traineeProfile.dob.split("T")[0]:"",trainingBatch:D.traineeProfile?.trainingBatch||"",passportNo:D.traineeProfile?.passportNo||"",nation:D.traineeProfile?.nation||"",createdAt:D.createdAt,lastLogin:D.lastLogin||""})),le=ne.departments||ne||[];t(ae),n(le)}catch(Z){const oe=ca(Z,{});throw b(oe),new Error(oe)}finally{y(!1)}};return{users:I,searchTerm:a,selectedRoles:o,selectedDepartments:c,uniqueRoles:T,uniqueDepartments:k,modalShow:u,selectedUser:m,modalMode:p,loading:g,error:w,confirmRoleChange:j,pendingUserData:E,handleSearch:C,handleRoleToggle:A,handleDepartmentToggle:L,handleClearFilters:_,handleView:W,handleEdit:Y,handleAdd:Q,handleDisable:J,handleSave:U,handleBulkImport:async P=>{try{y(!0);const Z=await nn.bulkImportUsers(P);if(Z.success&&Z.success.length>0&&xe.success(`Successfully imported ${Z.success.length} users!`),Z.failed&&Z.failed.length>0){const le=Z.failed.map(D=>`User ${D.index+1}: ${D.error}`);xe.error(`Failed to import ${Z.failed.length} users: ${le.join(", ")}`)}const[oe,ye]=await Promise.all([nn.getUsers({includeDeleted:!0}),ct.getDepartments({includeDeleted:!0})]),ne=oe.data.map(le=>({id:le.id,eid:le.eid,fullName:[le.firstName,le.middleName,le.lastName].filter(Boolean).join(" "),firstName:le.firstName,middleName:le.middleName,lastName:le.lastName,role:le.role?.name||"N/A",roleId:le.role?.id||"",department:le.department?.name||"N/A",status:le.status,email:le.email,phoneNumber:le.phoneNumber||"",address:le.address||"",certificationNumber:le.trainerProfile?.certificationNumber||"",specialization:le.trainerProfile?.specialization||"",yearsOfExperience:le.trainerProfile?.yearsOfExp||"",dateOfBirth:le.traineeProfile?.dob?le.traineeProfile.dob.split("T")[0]:"",trainingBatch:le.traineeProfile?.trainingBatch||"",passportNo:le.traineeProfile?.passportNo||"",nation:le.traineeProfile?.nation||"",createdAt:le.createdAt,lastLogin:le.lastLogin||""})),ae=ye.departments||ye||[];t(ne),n(ae)}catch(Z){const oe=ca(Z,{});b(oe),xe.error(oe)}finally{y(!1)}},handleModalClose:()=>{f(!1),h(null)},handleConfirmRoleChange:async()=>{N(!1),E&&(await ie(E),S(null))},handleCancelRoleChange:()=>{N(!1),S(null)},setError:b}},fie=()=>{const[e,t]=v.useState(!1),[r,n]=v.useState(null),[a,i]=v.useState(!1),[o,l]=v.useState(!1),{users:c,loading:d,error:u,searchTerm:f,selectedRoles:m,selectedDepartments:h,uniqueRoles:p,uniqueDepartments:x,modalShow:g,selectedUser:y,modalMode:w,confirmRoleChange:b,pendingUserData:j,handleSearch:N,handleRoleToggle:E,handleDepartmentToggle:S,handleClearFilters:T,handleView:k,handleEdit:I,handleAdd:C,handleDisable:A,handleSave:L,handleBulkImport:_,handleModalClose:W,handleConfirmRoleChange:Y,handleCancelRoleChange:Q}=uie(),J=re=>{n(re),t(!0)},U=async()=>{if(r){i(!0);try{await A(r),t(!1),n(null)}catch(re){console.error("Error disabling user:",re)}finally{i(!1)}}},ie=()=>{t(!1),n(null)};return G.useEffect(()=>{u&&xe.error(u)},[u]),s.jsx(Le,{fluid:!0,className:"py-4 user-management-page",children:s.jsxs(te,{className:"border-neutral-200 shadow-sm",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ge,{className:"align-items-center",children:s.jsx(ee,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(Bt,{permission:je.USERS.BULK_CREATE,fallback:null,children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>l(!0),className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-1",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),s.jsx("span",{className:"d-sm-none",children:"Import"})]})}),s.jsx(Bt,{permission:je.USERS.CREATE,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:C,className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-1",size:16}),"Add User"]})})]})})})}),s.jsxs(te.Body,{children:[s.jsxs(ge,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search users by name, EID, or email...",value:f,onChange:N,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(iie,{uniqueRoles:p,uniqueDepartments:x,selectedRoles:m,selectedDepartments:h,onRoleToggle:E,onDepartmentToggle:S,onClearFilters:T,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[c.length," user",c.length!==1?"s":""]})})})]}),s.jsxs("div",{className:"position-relative",children:[s.jsx(die,{users:c,loading:d,onView:k,onEdit:I,onDisable:J}),c.length>8&&s.jsxs("div",{className:"scroll-indicator",children:[s.jsx(Es,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),s.jsx(lie,{show:g,user:y,mode:w,onSave:L,onClose:W}),s.jsx(aie,{show:o,onClose:()=>l(!1),onImport:_,loading:d}),s.jsx(sie,{show:e,user:r,onConfirm:U,onCancel:ie,loading:a}),s.jsx(oie,{show:b,user:y,newRole:j?.role,onConfirm:Y,onCancel:Q,loading:d})]})]})})},mie=({show:e,role:t,onConfirm:r,onCancel:n,loading:a})=>{if(!t)return null;const i=t.status==="Active",o=i?"Disable":"Enable",c=i?oN:dt;return s.jsxs(ce,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:`text-white ${i?"bg-warning":"bg-success"}`,style:{borderBottom:"none"},children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(c,{size:24,className:"me-2"}),o," Role: ",t.name]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-warning)":"var(--bs-success)",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-0",children:t.name}),s.jsx("small",{className:"text-muted",children:t.description})]})]}),i?s.jsxs(Ye,{variant:"warning",className:"mb-3",children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Et,{className:"me-2"})," Warning: Disabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will disable the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will lose access to associated permissions."}),s.jsx("li",{children:"Role data will be preserved but access will be restricted."}),s.jsx("li",{children:"Role can be re-enabled later by an administrator."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):s.jsxs(Ye,{variant:"success",className:"mb-3",children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(dt,{className:"me-2"})," Confirm: Enabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will restore the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will regain access to associated permissions."}),s.jsx("li",{children:"All role permissions and access will be restored."}),s.jsx("li",{children:"Role will be available for assignment to new users."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(se,{variant:"outline-secondary",onClick:n,disabled:a,children:"Cancel"}),s.jsx(se,{variant:i?"warning":"success",onClick:r,disabled:a,className:"d-flex align-items-center",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{size:16,className:"me-2"}),o," Role"]})})]})]})]})},hie=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:n,className:a=""})=>{const i=t.length>0;return s.jsxs(dn,{className:`filter-panel-dropdown ${a}`,children:[s.jsx(dn.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(go,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsxs(dn.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>s.jsx(F.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:n,children:[s.jsx(We,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},pie=["ADMINISTRATOR"],Mj=e=>pie.includes(e?.toUpperCase()),xie=({show:e,role:t,mode:r,onSave:n,onClose:a})=>{const[i,o]=v.useState({name:"",description:"",permissionIds:[]}),[l,c]=v.useState({}),[d,u]=v.useState(!1),[f,m]=v.useState({}),{getPermissionGroups:h,loading:p,error:x}=wo(),g=v.useMemo(()=>{const T=h();if(r==="view"&&t?.permissions){const k=t.permissions.map(I=>I.id||I);return T.map(I=>({...I,permissions:I.permissions.filter(C=>k.includes(C.id))})).filter(I=>I.permissions.length>0)}return T},[h,r,t?.permissions]);v.useEffect(()=>{if(console.log("RoleModal useEffect - Role:",t),console.log("RoleModal useEffect - Mode:",r),console.log("RoleModal useEffect - Role permissions:",t?.permissions),t&&r!=="add"){const T=t.permissions?t.permissions.map(k=>k.id||k):[];console.log("RoleModal useEffect - Mapped permission IDs:",T),o({name:t.name||"",description:t.description||"",permissionIds:T})}else r==="add"&&o({name:"",description:"",permissionIds:[]});c({})},[t,r,e]),v.useEffect(()=>{if(r==="view"){const T={};g.map(I=>I.id).forEach(I=>{T[I]=!0}),m(T)}else if(r==="edit"){const T={};g.map(I=>I.id).forEach(I=>{T[I]=!0}),m(T)}else m({})},[r,g]);const y=()=>{const T={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(T.name="Role name cannot contain special characters"):T.name="Role name is required",i.permissionIds.length===0&&(T.permissionIds="At least one permission is required"),c(T),Object.keys(T).length===0},w=async T=>{if(T.preventDefault(),!!y()){u(!0);try{await n(i)}catch(k){console.error("Error saving role:",k)}finally{u(!1)}}},b=(T,k)=>{o(I=>({...I,[T]:k})),l[T]&&c(I=>({...I,[T]:""}))},j=T=>{o(k=>({...k,permissionIds:k.permissionIds.includes(T)?k.permissionIds.filter(I=>I!==T):[...k.permissionIds,T]})),l.permissionIds&&c(k=>({...k,permissionIds:""}))},N=T=>{m(k=>({...k,[T]:!k[T]}))},E=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},S=r==="view";return s.jsxs(ce,{show:e,onHide:a,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(nx,{className:"me-2",size:20}),E()]})}),s.jsxs(F,{onSubmit:w,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&Mj(t.name)&&r==="edit"&&s.jsxs(Ye,{variant:"warning",className:"mb-3",children:[s.jsx(Et,{className:"me-2"}),s.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(l).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([T,k])=>s.jsx("li",{children:k},T))})]}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsx(F.Group,{className:"mb-3",children:s.jsxs(ge,{className:"align-items-center",children:[s.jsx(ee,{md:2,children:s.jsx(F.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),s.jsxs(ee,{md:4,children:[s.jsx(F.Control,{type:"text",size:"sm",value:i.name,onChange:T=>{const k=T.target.value;/^[a-zA-Z0-9\s_]*$/.test(k)&&b("name",k)},isInvalid:!!l.name,readOnly:S,style:{borderColor:l.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.name})]})]})})})}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsx(F.Group,{className:"mb-3",children:s.jsxs(ge,{className:"align-items-start",children:[s.jsx(ee,{md:2,children:s.jsx(F.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),s.jsx(ee,{md:4,children:s.jsx(F.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:T=>b("description",T.target.value),readOnly:S,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),l.permissionIds&&s.jsx("div",{className:"text-danger small mb-2",children:l.permissionIds}),x&&s.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",x.message||"Unknown error"]}),s.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"300px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:p?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Lt,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):s.jsx(s.Fragment,{children:g.map(T=>{const k=f[T.id];return s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${S?"":"cursor-pointer"}`,onClick:()=>!S&&N(T.id),role:S?void 0:"button",tabIndex:S?void 0:0,onKeyDown:S?void 0:I=>{(I.key==="Enter"||I.key===" ")&&(I.preventDefault(),N(T.id))},"aria-expanded":S?void 0:k,children:s.jsxs("div",{className:"d-flex align-items-center",children:[!S&&(k?s.jsx(Es,{className:"me-2",size:16}):s.jsx(Xp,{className:"me-2",size:16})),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:T.name}),s.jsx("small",{className:"text-muted",children:T.description})]})]})}),k&&s.jsx("div",{className:"ms-3 mt-2",children:s.jsx(n1,{variant:"flush",children:T.permissions.map(I=>s.jsx(n1.Item,{className:`border-0 px-0 py-2 permission-item ${S?"":"cursor-pointer"}`,onClick:()=>!S&&j(I.id),role:S?void 0:"button",tabIndex:S?void 0:0,onKeyDown:S?void 0:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),j(I.id))},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(F.Check,{type:"checkbox",id:`permission-${I.id}`,checked:i.permissionIds.includes(I.id),onChange:()=>j(I.id),disabled:S,className:"me-3",style:{pointerEvents:S?"none":"auto"},"aria-label":`${I.title}: ${I.description}`}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-medium text-dark",children:I.title}),s.jsx("small",{className:"text-muted",children:I.description})]}),!S&&i.permissionIds.includes(I.id)&&s.jsx(Ce,{bg:"primary",className:"ms-2",children:"Selected"})]})},I.id))})})]},T.id)})})}),s.jsx("div",{className:"mt-2",children:s.jsxs("small",{className:"text-muted",children:[i.permissionIds.length," of ",g.reduce((T,k)=>T+k.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Assigned Users:"}),s.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Total Permissions:"}),s.jsx("div",{className:"fw-medium",children:i.permissionIds.length})]})]})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:d,children:[s.jsx(We,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:d||t&&Mj(t.name),children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},gie=({roles:e,loading:t,actionsComponent:r,onView:n,onEdit:a,onDisable:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=tn(e);if(t)return s.jsx(Qr,{rows:4,columns:4});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No roles found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const d=({columnKey:u,children:f,className:m=""})=>{const h=l.key===u,p=h?l.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${m} ${h?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="transparent",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600"},children:f}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:p,size:14})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(d,{columnKey:"name",className:"show-mobile",children:"Role Name"}),s.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(d,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),s.jsx(d,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:o.map((u,f)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:u.name}),s.jsx("td",{className:"show-mobile",children:s.jsxs(Ce,{bg:u.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="Active"?"":""}),u.status]})}),s.jsx("td",{className:"show-mobile",children:u.assignedUsers}),s.jsx("td",{className:"show-mobile",children:u.lastModified}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{role:u})})]},u.id))})]})})},vie=()=>{const[e,t]=v.useState([]),[r,n]=v.useState(""),[a,i]=v.useState([]),[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,f]=v.useState("view"),[m,h]=v.useState(!1),[p,x]=v.useState(null);v.useEffect(()=>{(async()=>{h(!0);try{const L=(await _n.getRoles({includeDeleted:!0})).roles.map(_=>({id:_.id,name:_.name,description:_.description||"",assignedUsers:_.userCount||0,status:_.isActive==="ACTIVE"?"Active":"Inactive",createdAt:_.createdAt?_.createdAt.split("T")[0]:"",lastModified:_.updatedAt?_.updatedAt.split("T")[0]:"",isActive:_.isActive,permissions:_.permissions||[],originalData:_}));t(L),x(null)}catch(A){const L=ca(A,{});x(L),console.error("Error fetching roles:",A)}finally{h(!1)}})()},[]);const g=C=>n(C),y=C=>{i(C==="clear"?[]:A=>A.includes(C)?A.filter(L=>L!==C):[...A,C])},w=()=>{i([])},b=async C=>{try{h(!0);const A=await _n.getRoleById(C.id);d(A),f("view"),l(!0)}catch(A){const L=ca(A,{});x(L),console.error("Error fetching role details:",A)}finally{h(!1)}},j=async C=>{try{h(!0);const A=await _n.getRoleById(C.id),L={id:A.id,name:A.name,description:A.description||"",assignedUsers:A.userCount||0,status:A.isActive?"Active":"Inactive",createdAt:A.createdAt?A.createdAt.split("T")[0]:"",lastModified:A.updatedAt?A.updatedAt.split("T")[0]:"",isActive:A.isActive,permissions:A.permissions||[],originalData:A};d(L),f("edit"),l(!0),x(null)}catch(A){const L=ca(A,{});x(L)}finally{h(!1)}},N=()=>{d(null),f("add"),l(!0)},E=async C=>{if(window.confirm("Are you sure you want to delete this role?")){h(!0);try{await new Promise(A=>setTimeout(A,1e3)),t(A=>A.filter(L=>L.id!==C)),x(null)}catch{x("Failed to delete role")}finally{h(!1)}}},S=async C=>{h(!0);try{u==="add"?(await _n.createRole(C),xe.success("Role created successfully!")):(await _n.updateRole(c.id,C),xe.success("Role updated successfully!"));const L=(await _n.getRoles({includeDeleted:!0})).roles.map(_=>({id:_.id,name:_.name,description:_.description||"",assignedUsers:_.userCount||0,status:_.isActive==="ACTIVE"?"Active":"Inactive",createdAt:_.createdAt?_.createdAt.split("T")[0]:"",lastModified:_.updatedAt?_.updatedAt.split("T")[0]:"",isActive:_.isActive,originalData:_}));t(L),l(!1),d(null),x(null)}catch(A){const L=ca(A,{});x(L),xe.error(L)}finally{h(!1)}},T=async C=>{h(!0);try{const A=e.find(J=>J.id===C);if(!A)throw new Error("Role not found");let L,_;A.isActive==="ACTIVE"?(L=await _n.disableRole(C),_="disabled"):(L=await _n.enableRole(C),_="enabled");const Y=(await _n.getRoles({includeDeleted:!0})).roles.map(J=>({id:J.id,name:J.name,description:J.description||"",assignedUsers:J.userCount||0,status:J.isActive==="ACTIVE"?"Active":"Inactive",createdAt:J.createdAt?J.createdAt.split("T")[0]:"",lastModified:J.updatedAt?J.updatedAt.split("T")[0]:"",isActive:J.isActive,originalData:J}));t(Y);const Q=L?.message||`Role has been ${_} successfully!`;xe.success(Q),x(null)}catch(A){const L=ca(A,{});x(L),xe.error(L)}finally{h(!1)}},k=[...new Set(e.map(C=>C.status))];return{roles:e.filter(C=>{const A=C.name.toLowerCase().includes(r.toLowerCase()),L=a.length===0||a.includes(C.status);return A&&L}),loading:m,error:p,searchTerm:r,selectedStatuses:a,uniqueStatuses:k,modalShow:o,selectedRole:c,modalMode:u,handleSearch:g,handleStatusToggle:y,handleClearFilters:w,handleView:b,handleEdit:j,handleAdd:N,handleDelete:E,handleSave:S,handleDisable:T,handleModalClose:()=>l(!1),setError:x}},yie=()=>{const[e,t]=v.useState(!1),[r,n]=v.useState(null),[a,i]=v.useState(!1),{roles:o,loading:l,error:c,searchTerm:d,selectedStatuses:u,uniqueStatuses:f,modalShow:m,selectedRole:h,modalMode:p,handleSearch:x,handleStatusToggle:g,handleClearFilters:y,handleView:w,handleEdit:b,handleAdd:j,handleSave:N,handleDisable:E,handleModalClose:S}=vie(),T=A=>{n(A),t(!0)},k=async()=>{if(r){i(!0);try{await E(r.id),t(!1),n(null)}catch(A){console.error("Error disabling role:",A)}finally{i(!1)}}},I=()=>{t(!1),n(null)},C=({role:A})=>s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:s.jsx(_r,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>w(A)},{label:"Edit Role",icon:s.jsx(ga,{}),onClick:()=>b(A)},...A.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:A.status==="Active"?"Disable Role":"Enable Role",icon:s.jsx(vo,{}),className:A.status==="Active"?"text-warning":"text-success",onClick:()=>T(A)}]:[]]});return G.useEffect(()=>{c&&xe.error(c)},[c]),s.jsx(Le,{fluid:!0,className:"py-4 role-management-page",children:s.jsxs(te,{className:"border-neutral-200 shadow-sm",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ge,{className:"align-items-center",children:s.jsx(ee,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Bt,{permission:je.ROLES.CREATE,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:j,className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-1",size:16}),"Add Role"]})})})})})}),s.jsxs(te.Body,{children:[s.jsxs(ge,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search roles by name...",value:d,onChange:x,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(hie,{uniqueStatuses:f,selectedStatuses:u,onStatusToggle:g,onClearFilters:y,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[o.length," role",o.length!==1?"s":""]})})})]}),s.jsx(gie,{roles:o,loading:l,actionsComponent:C,onView:w,onEdit:b,onDisable:E}),s.jsx(xie,{show:m,role:h,mode:p,onSave:N,onClose:S}),s.jsx(mie,{show:e,role:r,onConfirm:k,onCancel:I,loading:a})]})]})})},bie=({show:e,department:t,onClose:r,onAssign:n,availableInstructors:a=[],assignedInstructors:i=[]})=>{const[o,l]=v.useState([]),[c,d]=v.useState("");v.useEffect(()=>{e&&(l([]),d(""))},[e]);const u=p=>{l(x=>x.includes(p)?x.filter(g=>g!==p):[...x,p])},f=()=>{n(o),l([])},m=p=>{console.log("Remove instructor:",p)},h=a.filter(p=>p.name.toLowerCase().includes(c.toLowerCase())||p.email.toLowerCase().includes(c.toLowerCase()));return!e||!t?null:s.jsxs(ce,{show:e,onHide:r,size:"xl",centered:!0,children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(ui,{className:"me-2",size:20}),"Assign Instructors - ",t.name]})}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Available Instructors"}),s.jsx(F.Control,{type:"text",placeholder:"Search instructors...",value:c,onChange:p=>d(p.target.value),className:"mb-3",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}}),s.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-primary)"},children:h.length===0?s.jsx("div",{className:"p-4 text-center text-muted",children:"No available instructors found"}):h.map(p=>s.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom",style:{backgroundColor:o.includes(p.id)?"var(--bs-primary-bg-subtle)":"transparent"},children:[s.jsx(F.Check,{type:"checkbox",checked:o.includes(p.id),onChange:()=>u(p.id),className:"me-3"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-semibold text-dark",children:p.name}),s.jsx("div",{className:"text-muted small",children:p.email}),s.jsx("div",{className:"text-muted small",children:p.specialization||"No specialization"})]})]},p.id))})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h5",{className:"fw-semibold text-dark mb-3",children:"Currently Assigned"}),s.jsx("div",{className:"border rounded",style:{maxHeight:"400px",overflowY:"auto",borderColor:"var(--bs-success)"},children:i.length===0?s.jsx("div",{className:"p-4 text-center text-muted",children:"No instructors assigned yet"}):i.map(p=>s.jsxs("div",{className:"d-flex align-items-center p-3 border-bottom bg-light",children:[s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-semibold text-dark",children:p.name}),s.jsx("div",{className:"text-muted small",children:p.email}),s.jsx("div",{className:"text-muted small",children:p.specialization||"No specialization"})]}),s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>m(p.id),title:"Remove instructor",children:s.jsx(dd,{size:14})})]},p.id))})]})})]}),o.length>0&&s.jsxs(Ye,{variant:"info",className:"mt-3",children:[s.jsx("strong",{children:o.length})," instructor(s) selected for assignment"]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:r,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsxs(se,{variant:"primary",onClick:f,disabled:o.length===0,children:[s.jsx(ui,{className:"me-2",size:16}),"Assign ",o.length," Instructor(s)"]})]})]})},wie=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const n=a=>{switch(a){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return s.jsxs(ce,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(di,{className:"me-2",size:20}),"Department Details"]})}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ge,{className:"mb-4",children:[s.jsxs(ee,{md:8,children:[s.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),s.jsx("p",{className:"text-muted mb-3",children:t.description})]}),s.jsx(ee,{md:4,className:"text-end",children:s.jsx(Ce,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ce,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ce,{bg:n(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),s.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fa,{className:"me-3 text-primary",size:24}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),s.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):s.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),s.jsx(ge,{className:"mb-4",children:s.jsxs(ee,{md:12,children:[s.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),s.jsxs(ge,{children:[s.jsx(ee,{md:4,children:s.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[s.jsx(ur,{className:"text-primary mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),s.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),s.jsx(ee,{md:4,children:s.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[s.jsx(Fn,{className:"text-success mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),s.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),s.jsx(ee,{md:4,children:s.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[s.jsx(fa,{className:"text-info mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),s.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),s.jsx(ce.Footer,{className:"border-0 p-4",children:s.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[s.jsx(We,{className:"me-2",size:16}),"Close"]})})]})},jie=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:n,onTypeToggle:a,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return s.jsxs(dn,{className:`filter-panel-dropdown ${l}`,children:[s.jsxs(dn.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(go,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]}),s.jsx("div",{className:"position-absolute end-0 me-3",children:s.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:s.jsx("path",{d:"M6 8L2 4h8L6 8z"})})})]}),s.jsxs(dn.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Types"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(F.Check,{type:"checkbox",id:`type-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(F.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:n.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(We,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Nie=({show:e,department:t,mode:r,onSave:n,onClose:a,availableUsers:i})=>{const[o,l]=v.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,d]=v.useState({}),[u,f]=v.useState(!1);v.useEffect(()=>{t&&r!=="add"?l({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&l({name:"",code:"",description:"",departmentHeadId:""}),d({})},[t,r,e]);const m=()=>{const y={};return o.name.trim()?o.name.trim().length<3?y.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(o.name.trim())||(y.name="Department name cannot contain special characters"):y.name="Department name is required",o.code.trim()?/^[A-Z]{2,5}$/.test(o.code.trim())||(y.code="Department code must be 2-5 uppercase letters"):y.code="Department code is required",o.departmentHeadId||(y.departmentHeadId="Department head is required"),d(y),Object.keys(y).length===0},h=async y=>{if(y.preventDefault(),!!m()){f(!0);try{const w={name:o.name.trim(),code:o.code.trim(),description:o.description.trim(),headUserId:o.departmentHeadId};console.log(" Department data being sent:",w),await n(w)}catch(w){console.error("Error saving department:",w)}finally{f(!1)}}},p=(y,w)=>{l(b=>({...b,[y]:w})),c[y]&&d(b=>({...b,[y]:""}))},x=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return s.jsxs(ce,{show:e,onHide:a,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(tr,{className:"me-2",size:20}):s.jsx(Oa,{className:"me-2",size:20}),x()]})}),s.jsxs(F,{onSubmit:h,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([y,w])=>s.jsx("li",{children:w},y))})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:8,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),s.jsx(F.Control,{type:"text",value:o.name,onChange:y=>p("name",y.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:c.name})]})}),s.jsx(ee,{md:4,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),s.jsx(F.Control,{type:"text",value:o.code,onChange:y=>p("code",y.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(F.Control.Feedback,{type:"invalid",children:c.code})]})})]}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),s.jsxs(F.Select,{value:o.departmentHeadId,onChange:y=>p("departmentHeadId",y.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select department head"}),i.map(y=>s.jsxs("option",{value:y.id,children:[y.firstName," ",y.lastName," (",y.eid,")"]},y.id))]}),s.jsx(F.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),s.jsx(F.Control,{as:"textarea",rows:4,value:o.description,onChange:y=>p("description",y.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),s.jsx(F.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),s.jsx(F.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),s.jsx(F.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),s.jsx(F.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:u,children:[s.jsx(We,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},Eie=({department:e,index:t,onView:r,onToggleStatus:n})=>{const a=o=>o==="ACTIVE"?"success":"secondary",i=o=>o==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.coursesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.traineesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.trainersCount})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(Ce,{bg:a(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.DEPARTMENTS.VIEW_DETAIL,je.DEPARTMENTS.UPDATE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>r(e),permission:je.DEPARTMENTS.VIEW_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:s.jsx(vo,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>n(e),permission:je.DEPARTMENTS.UPDATE}]})})})]})},Sie=({departments:e,loading:t,onView:r,onToggleStatus:n})=>{const{sortedData:a,sortConfig:i,handleSort:o}=tn(e);if(t)return s.jsx(Qr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No departments found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const f=i.key===c,m=f?i.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${u} ${f?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>o(c),onMouseEnter:h=>{h.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="transparent",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:m,size:14})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(l,{columnKey:"name",className:"show-mobile",children:"Department Name"}),s.jsx(l,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(l,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),s.jsx(l,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),s.jsx(l,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),s.jsx(l,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),s.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:a.map((c,d)=>s.jsx(Eie,{department:c,index:d,onView:r,onToggleStatus:n},c.id))})]})})},Tie=({show:e,department:t,onConfirm:r,onCancel:n,isProcessing:a})=>{const[i,o]=v.useState({courseCount:0,traineeCount:0,trainerCount:0}),[l,c]=v.useState(!1);v.useEffect(()=>{e&&t?.id&&d()},[e,t?.id]);const d=async()=>{if(t?.id){c(!0);try{const p=await ct.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Statistics API response:",p),o({courseCount:p.courseCount||p.coursesCount||0,traineeCount:p.traineeCount||p.traineesCount||0,trainerCount:p.trainerCount||p.trainersCount||0})}catch(p){console.error("Error fetching department statistics:",p),o({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const u=t.status==="ACTIVE",f=u?"deactivate":"activate",m=u?"Deactivate":"Activate",h=!u||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return s.jsxs(ce,{show:e,onHide:n,centered:!0,children:[s.jsx(ce.Header,{className:"border-0 pb-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:"me-2 text-warning",size:20}),m," Department"]})}),s.jsxs(ce.Body,{className:"pt-0",children:[s.jsx(Ye,{variant:u?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:s.jsx("div",{className:"d-flex align-items-start",children:s.jsxs("div",{children:[s.jsxs("strong",{children:["Are you sure you want to ",f," this department?"]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),u&&s.jsx("div",{className:"mt-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Warning:"})," Deactivating this department will:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"Make it unavailable for new course assignments"}),s.jsx("li",{children:"Hide it from department selection dropdowns"}),s.jsx("li",{children:"Not affect existing courses and users"})]})]}):s.jsxs("div",{className:"text-danger",children:[s.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!u&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"New course assignments"}),s.jsx("li",{children:"Department selection in forms"}),s.jsx("li",{children:"User management operations"})]})]})]})})}),s.jsxs("div",{className:"bg-light p-4 rounded",children:[s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Department Head:"}),s.jsx("span",{className:"text-muted text-break",children:t.departmentHead?.name||t.departmentHead?.email||"N/A"})]})}),s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Current Status:"}),s.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status})]})})]}),s.jsx("hr",{className:"my-3"}),s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(Lt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),s.jsx("small",{className:"text-muted",children:"Courses"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(Lt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),s.jsx("small",{className:"text-muted",children:"Trainees"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(Lt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),s.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:u?"warning":"success",onClick:r,disabled:a||u&&!h,style:{backgroundColor:u?"#ffc107":"#28a745",borderColor:u?"#ffc107":"#28a745",opacity:u&&!h?.5:1},children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.8rem",height:"0.8rem"}}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Et,{className:"me-2",size:16}),u&&!h?"Cannot Deactivate":`${m} Department`]})})]})]})},_ie=()=>{const e=mt(),{departments:t,loading:r,searchTerm:n,setSearchTerm:a,createDepartment:i,updateDepartment:o,disableDepartment:l,enableDepartment:c,getAvailableUsers:d}=lx(),[u,f]=v.useState(!1),[m,h]=v.useState(!1),[p,x]=v.useState(!1),[g,y]=v.useState(!1),[w,b]=v.useState("add"),[j,N]=v.useState(null),[E,S]=v.useState(!1),[T,k]=v.useState([]),[I,C]=v.useState([]),[A,L]=v.useState([]);v.useEffect(()=>{(async()=>{try{const D=await d();L(D)}catch(D){console.error("Error loading available users:",D),L([])}})()},[]);const _=()=>{N(null),b("add"),f(!0)},W=le=>{e(`/admin/departments/${le.id}`)},Y=le=>{N(le),h(!0)},Q=()=>{f(!1),N(null),b("add")},J=()=>{h(!1),N(null)},U=()=>{x(!1),N(null)},ie=()=>{y(!1),N(null)},re=le=>{console.log("Assign instructors:",le,"to department:",j.name),U()},M=async le=>{try{w==="add"?(await i(le),xe.success("Department created successfully")):w==="edit"&&(await o(j.id,le),xe.success("Department updated successfully")),Q()}catch(D){console.error("Error saving department:",D),xe.error("Failed to save department")}},z=async()=>{try{j&&(j.status==="ACTIVE"?(await l(j.id),xe.success("Department disabled successfully")):(await c(j.id),xe.success("Department enabled successfully")),J())}catch(le){console.error("Error toggling department status:",le),xe.error("Failed to toggle department status")}},V=le=>{a(le)},P=le=>{k(le==="clear"?[]:D=>D.includes(le)?D.filter(Ae=>Ae!==le):[...D,le])},Z=le=>{C(le==="clear"?[]:D=>D.includes(le)?D.filter(Ae=>Ae!==le):[...D,le])},oe=()=>{k([]),C([])},ye=[...new Set(t.map(le=>le.type).filter(Boolean))],ne=["ACTIVE","INACTIVE"],ae=t.filter(le=>{const D=T.length===0||T.includes(le.type),Ae=I.length===0||I.includes(le.status);return D&&Ae});return s.jsxs(Le,{fluid:!0,className:"py-4 department-management-page",children:[s.jsxs(te,{className:"shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-0 pb-0",children:s.jsx(ge,{className:"align-items-center",children:s.jsx(ee,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Bt,{permission:je.DEPARTMENTS.CREATE,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:_,className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-1",size:16}),"Add Department"]})})})})})}),s.jsxs(te.Body,{children:[s.jsxs(ge,{className:"mb-4 form-mobile-stack",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search departments by name, code, or description...",value:n,onChange:V,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(jie,{uniqueTypes:ye,uniqueStatuses:ne,selectedTypes:T,selectedStatuses:I,onTypeToggle:P,onStatusToggle:Z,onClearFilters:oe,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[ae.length," department",ae.length!==1?"s":""]})})})]}),s.jsx("div",{className:"position-relative mt-3",children:s.jsx(Sie,{departments:ae,loading:r,onView:W,onToggleStatus:Y})})]})]}),u&&s.jsx(Nie,{show:u,department:j,mode:w,onSave:M,onClose:Q,availableUsers:A}),m&&j&&s.jsx(Tie,{show:m,department:j,onConfirm:z,onCancel:J,isProcessing:r}),p&&j&&s.jsx(bie,{show:p,department:j,onClose:U,onAssign:re,availableInstructors:A.filter(le=>le.role==="TRAINER"),assignedInstructors:[]}),g&&j&&s.jsx(wie,{show:g,department:j,onClose:ie})]})},Aie=({department:e,onBack:t})=>s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:s.jsx(gr,{})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:e.name}),s.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),kie=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:rN,description:"View department overview"},{id:"trainers",label:"Manage Trainers",icon:ui,description:"Assign trainers to department"},{id:"edit",label:"Edit Details",icon:ga,description:"Modify department information"}];return s.jsxs("div",{className:"department-tabs",children:[s.jsx("div",{className:"tab-navigation",children:r.map(n=>{const a=n.icon,i=e===n.id;return s.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(n.id),children:[s.jsx("div",{className:"tab-icon",children:s.jsx(a,{size:20})}),s.jsxs("div",{className:"tab-content",children:[s.jsx("div",{className:"tab-label",children:n.label}),s.jsx("div",{className:"tab-description",children:n.description})]}),i&&s.jsx("div",{className:"tab-indicator"})]},n.id)})}),s.jsx("div",{className:"tab-separator"})]})},Cie=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),Oie=({department:e,onUpdate:t})=>{const[r,n]=v.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[a,i]=v.useState(!1),[o,l]=v.useState([]);v.useEffect(()=>{(async()=>{try{const f=await ct.getDepartmentHeads(),m=Array.isArray(f)?f:f.data||f.users||[];l(m)}catch(f){console.error("Error loading department heads:",f),xe.error("Failed to load department heads"),l([])}})()},[]);const c=u=>{const{name:f,value:m}=u.target;n(h=>({...h,[f]:m}))},d=async u=>{u.preventDefault(),i(!0);try{const f=await ct.updateDepartment(e.id,r),m=Cie(f);t(m),xe.success("Department updated successfully!")}catch(f){console.error("Error updating department:",f),xe.error("Failed to update department")}finally{i(!1)}};return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),s.jsxs("form",{onSubmit:d,children:[s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),s.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),s.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[s.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(o)&&o.map(u=>s.jsxs("option",{value:u.id,children:["[",u.eid,"] - ",u.firstName," ",u.lastName]},u.id))]}),r.headUserId&&(()=>{const u=Array.isArray(o)?o.find(f=>f.id===r.headUserId):null;return u?s.jsxs("div",{className:"form-text",children:["Current selection: [",u.eid,"] - ",u.firstName," ",u.lastName]}):null})()]})})}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),s.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(se,{type:"submit",variant:"primary",disabled:a,children:a?"Updating...":"Update Department"})})]})]})},Pie=({trainers:e=[],loading:t=!1,showAddButton:r=!1,onAddClick:n,departmentId:a,onTrainerRemoved:i})=>{const[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,f]=v.useState(!1);if(t)return s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading trainers..."})]});if(!e||e.length===0)return s.jsxs("div",{className:"text-center py-5",children:[s.jsx(fa,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No trainers assigned"}),s.jsx("p",{className:"text-muted",children:"This department doesn't have any trainers assigned yet."})]});const m=g=>{const{firstName:y,middleName:w,lastName:b}=g;return[y,w,b].filter(Boolean).join(" ")},h=g=>{d(g),l(!0)},p=async()=>{if(!(!c||!a)){f(!0);try{await ct.removeTrainersFromDepartment(a,[c.eid]),xe.success(`Successfully removed ${m(c)} from department`),i&&i(),l(!1),d(null)}catch(g){console.error("Error removing trainer:",g),xe.error("Failed to remove trainer from department")}finally{f(!1)}}},x=()=>{l(!1),d(null)};return s.jsxs("div",{className:"assigned-trainers-table",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[s.jsxs("h5",{className:"mb-0",children:[s.jsx(fa,{className:"me-2"}),"Assigned Trainers (",e.length,")"]}),r&&s.jsxs(se,{variant:"primary",onClick:n,className:"d-flex align-items-center",children:[s.jsx(ui,{className:"me-2",size:16}),"Add Trainers to Department"]})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"EID"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Full Name"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Email"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Phone"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Address"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",width:"80",children:"Actions"})]})}),s.jsx("tbody",{children:e.map((g,y)=>s.jsxs("tr",{className:`${y%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor=y%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"fw-semibold text-primary-custom",children:g.eid})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:m(g)})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:g.email})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:g.phoneNumber?s.jsx("span",{className:"text-dark",children:g.phoneNumber}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:g.address?s.jsx("span",{className:"text-truncate text-dark",style:{maxWidth:"200px"},title:g.address,children:g.address}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permission:je.DEPARTMENTS.REMOVE_TRAINERS,fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"Remove from Department",icon:s.jsx(dd,{}),className:"text-danger",onClick:()=>h(g)}]})})})]},g.id))})]})}),s.jsxs(ce,{show:o,onHide:x,centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(dd,{className:"me-2 text-danger",size:20}),"Remove Trainer"]})}),s.jsxs(ce.Body,{children:[s.jsxs("p",{children:["Are you sure you want to remove ",s.jsx("strong",{children:c?m(c):""})," from this department?"]}),s.jsx("p",{className:"text-muted small mb-0",children:"This action cannot be undone. The trainer will no longer be associated with this department."})]}),s.jsxs(ce.Footer,{children:[s.jsx(se,{variant:"secondary",onClick:x,disabled:u,children:"Cancel"}),s.jsx(se,{variant:"danger",onClick:p,disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):"Remove Trainer"})]})]})]})},Die=({show:e,onHide:t,departmentId:r,assignedTrainers:n=[],onTrainersAdded:a})=>{const[i,o]=v.useState([]),[l,c]=v.useState([]),[d,u]=v.useState(""),[f,m]=v.useState(!1),[h,p]=v.useState(!1);v.useEffect(()=>{e&&r&&x()},[e,r,n]);const x=async()=>{m(!0);try{const C=((await nn.getUsers()).data||[]).filter(_=>_.role&&_.role.name==="TRAINER").map(_=>({id:_.id,eid:_.eid,firstName:_.firstName,middleName:_.middleName,lastName:_.lastName,email:_.email,status:_.status,address:_.address,gender:_.gender,phoneNumber:_.phoneNumber})),A=n.map(_=>_.id),L=C.filter(_=>!A.includes(_.id));o(L)}catch(T){console.error("Error loading available trainers:",T),xe.error("Failed to load available trainers")}finally{m(!1)}},g=(T,k)=>{c(k?I=>[...I,T]:I=>I.filter(C=>C!==T))},y=T=>{if(T){const k=w();c(k.map(I=>I.id))}else c([])},w=()=>{if(!d)return i;const T=d.toLowerCase();return i.filter(k=>k.eid?.toLowerCase().includes(T)||k.firstName?.toLowerCase().includes(T)||k.lastName?.toLowerCase().includes(T)||k.email?.toLowerCase().includes(T))},b=T=>{const{firstName:k,middleName:I,lastName:C}=T;return[k,I,C].filter(Boolean).join(" ")},j=async()=>{if(l.length===0){xe.warning("Please select at least one trainer");return}p(!0);try{const T=l.map(k=>{const I=i.find(C=>C.id===k);return I?I.eid:null}).filter(k=>k!==null);await ct.assignTrainersToDepartment(r,T),xe.success(`Successfully assigned ${T.length} trainer(s) to department`),a(),N()}catch(T){console.error("Error assigning trainers:",T),xe.error("Failed to assign trainers")}finally{p(!1)}},N=()=>{c([]),u(""),t()},E=w(),S=E.length>0&&E.every(T=>l.includes(T.id));return s.jsxs(ce,{show:e,onHide:N,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"border-0 pb-0 d-flex align-items-center justify-content-between",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[s.jsx("div",{}),s.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(ui,{className:"me-2",size:20}),"Add Trainers to Department"]}),s.jsx(se,{variant:"link",onClick:N,className:"p-0",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:s.jsx(We,{})})]}),s.jsxs(ce.Body,{className:"pt-0",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-muted mb-3",style:{padding:"20px 24px"},children:"Select trainers to assign to this department."}),s.jsxs(ge,{className:"align-items-center",children:[s.jsx(ee,{md:8,children:s.jsx(F.Control,{type:"text",placeholder:"Search by EID, name, or email...",value:d,onChange:T=>u(T.target.value)})}),s.jsx(ee,{md:4,className:"text-end",children:s.jsxs("span",{className:"text-muted",children:[E.length," trainer",E.length!==1?"s":""," found"]})})]})]}),f?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading available trainers..."})]}):s.jsx("div",{className:"table-responsive",style:{maxHeight:"400px"},children:s.jsxs(qt,{hover:!0,className:"mb-0",children:[s.jsx("thead",{className:"table-light sticky-top",children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"50px",padding:"16px 12px"},children:s.jsx(F.Check,{type:"checkbox",checked:S,onChange:T=>y(T.target.checked)})}),s.jsx("th",{style:{padding:"16px 12px"},children:"EID"}),s.jsx("th",{style:{padding:"16px 12px"},children:"Full Name"}),s.jsx("th",{style:{padding:"16px 12px"},children:"Email"})]})}),s.jsx("tbody",{children:E.map(T=>s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"16px 12px"},children:s.jsx(F.Check,{type:"checkbox",checked:l.includes(T.id),onChange:k=>g(T.id,k.target.checked)})}),s.jsx("td",{style:{padding:"16px 12px"},children:s.jsx("code",{className:"text-primary",children:T.eid})}),s.jsx("td",{style:{padding:"16px 12px"},children:s.jsx("span",{children:b(T)})}),s.jsx("td",{style:{padding:"16px 12px"},children:T.email})]},T.id))})]})}),E.length===0&&!f&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ui,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No trainers available"}),s.jsx("p",{className:"text-muted",children:d?"No trainers match your search criteria.":"All trainers are already assigned to departments."})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(se,{variant:"outline-secondary",onClick:N,disabled:h,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:j,disabled:l.length===0||h,children:h?s.jsxs(s.Fragment,{children:[s.jsx(Lt,{size:"sm",className:"me-2"}),"Assigning..."]}):`Assign ${l.length} Trainer${l.length!==1?"s":""}`})]})]})},Iie=({department:e,onDepartmentUpdate:t})=>{const[r,n]=v.useState(!1),a=e?.trainers||[],i=()=>{t&&t()};return s.jsxs("div",{children:[s.jsx(Pie,{trainers:a,loading:!1,showAddButton:!0,onAddClick:()=>n(!0),departmentId:e?.id,onTrainerRemoved:i}),s.jsx(Die,{show:r,onHide:()=>n(!1),departmentId:e?.id,assignedTrainers:a,onTrainersAdded:i})]})},Lj=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return s.jsxs("div",{className:"department-info",children:[s.jsx("h4",{className:"mb-4",children:"Department Overview"}),s.jsxs(ge,{className:"g-4",children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"info-card",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(ur,{className:"info-icon"}),s.jsx("h6",{children:"Basic Information"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Name:"}),s.jsx("span",{className:"info-value",children:e.name})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Code:"}),s.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Description:"}),s.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"info-card",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(Fn,{className:"info-icon"}),s.jsx("h6",{children:"Department Statistics"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Courses:"}),s.jsx("span",{className:"info-value",children:e.courseCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainees:"}),s.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainers:"}),s.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Head of Department:"}),s.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"info-card",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(fn,{className:"info-icon"}),s.jsx("h6",{children:"Timeline"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Created:"}),s.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Last Updated:"}),s.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Deleted:"}),s.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},Rie=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),Fie=()=>{const{id:e}=sa(),t=mt(),[r,n]=v.useState(null),[a,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("info"),u=v.useCallback(async()=>{if(!e){xe.error("Department ID is required"),i(!1);return}i(!0),l(null);try{const p=await ct.getDepartmentById(e),x=Rie(p);n(x)}catch(p){console.error("Error loading department:",p),xe.error("Failed to load department details"),l("Failed to load department details")}finally{i(!1)}},[e]);v.useEffect(()=>{u()},[u]);const f=()=>{t("/admin/departments")},m=p=>{d(p)};if(a)return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:s.jsx(Lt,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(o)return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-danger mb-3",children:[s.jsx("h5",{children:"Unable to load department"}),s.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),s.jsxs(se,{variant:"outline-primary",onClick:f,children:[s.jsx(gr,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-warning mb-3",children:[s.jsx("h5",{children:"Department not found"}),s.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),s.jsxs(se,{variant:"outline-primary",onClick:f,children:[s.jsx(gr,{className:"me-2"}),"Back to Departments"]})]})});const h=()=>{switch(c){case"info":return s.jsx(Lj,{department:r});case"trainers":return s.jsx(Iie,{department:r,onDepartmentUpdate:u});case"edit":return s.jsx(Oie,{department:r,onUpdate:n});default:return s.jsx(Lj,{department:r})}};return s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(Aie,{department:r,onBack:f}),s.jsx(kie,{activeTab:c,onTabChange:m}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(te,{className:"shadow-sm",children:s.jsx(te.Body,{className:"p-4",children:h()})})})})]})},Mie=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,i]=v.useState({newPassword:"",confirmPassword:""}),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,f]=v.useState({show:!1,message:"",variant:"success"}),m=x=>{const{name:g,value:y}=x.target;i(w=>({...w,[g]:y})),u.show&&f({show:!1,message:"",variant:"success"})},h=async x=>{if(x.preventDefault(),a.newPassword!==a.confirmPassword){f({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(a.newPassword.length<6){f({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(a),f({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),f({show:!1,message:"",variant:"success"})},1500)}catch{f({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},p=()=>{i({newPassword:"",confirmPassword:""}),f({show:!1,message:"",variant:"success"}),t()};return s.jsxs(ce,{show:e,onHide:p,size:"md",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary text-white",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(pl,{className:"me-2",size:20}),"Reset Password"]}),s.jsx(se,{variant:"link",className:"text-white p-0",onClick:p,style:{textDecoration:"none"},children:s.jsx(We,{size:20})})]}),s.jsxs(ce.Body,{className:"p-4",children:[u.show&&s.jsx(Ye,{variant:u?.variant,className:"mb-3",children:u?.message}),s.jsxs(F,{onSubmit:h,children:[s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{className:"fw-semibold",children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(F.Control,{type:o?"text":"password",name:"newPassword",value:a.newPassword,onChange:m,required:!0,minLength:6,placeholder:"Enter new password"}),s.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>l(!o),type:"button",children:o?s.jsx(hl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs(F.Group,{className:"mb-4",children:[s.jsx(F.Label,{className:"fw-semibold",children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(F.Control,{type:c?"text":"password",name:"confirmPassword",value:a.confirmPassword,onChange:m,required:!0,minLength:6,placeholder:"Confirm new password"}),s.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>d(!c),type:"button",children:c?s.jsx(hl,{size:16}):s.jsx(tr,{size:16})})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(se,{variant:"outline-secondary",onClick:p,disabled:n,children:"Cancel"}),s.jsx(se,{type:"submit",variant:"secondary",disabled:n,children:n?"Updating...":s.jsxs(s.Fragment,{children:[s.jsx(pl,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},Lie=({profileData:e,user:t,onResetPassword:r,onAvatarUpdated:n})=>{const a=v.useRef(null),[i,o]=v.useState(!1),[l,c]=v.useState(null),d=y=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",SQA_AUDITOR:"secondary"})[y]||"secondary",u=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",f=()=>e?.email||t?.email||"user@example.com",m=()=>e?.role?.name||t?.role||"USER",h=l||e?.avatarUrl||"",p=()=>{a.current&&a.current.click()},x=(y,w=200,b=200,j=.8)=>new Promise(N=>{const E=document.createElement("canvas"),S=E.getContext("2d"),T=new window.Image;T.onload=()=>{let{width:k,height:I}=T;k>I?k>w&&(I=I*w/k,k=w):I>b&&(k=k*b/I,I=b),E.width=k,E.height=I,S.drawImage(T,0,0,k,I);const C=E.toDataURL("image/jpeg",j);N(C)},T.src=URL.createObjectURL(y)}),g=async y=>{const w=y.target.files&&y.target.files[0];if(w){if(w.size>5*1024*1024){xe.error("File size too large. Please choose an image smaller than 5MB.");return}try{o(!0);const b=await x(w,200,200,.7);c(b);const j=await js.updateAvatar(b,e);xe.success("Avatar updated successfully"),n&&n(j)}catch(b){console.error("Update avatar failed:",b),b.response?.status===422?xe.error("Invalid avatar format. Please try a different image."):b.response?.status===413?xe.error("Image too large. Please choose a smaller image."):xe.error("Failed to update avatar. Please try again."),c(null)}finally{o(!1),a.current&&(a.current.value="")}}};return s.jsx(te,{className:"h-100",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[h?s.jsx(s4,{roundedCircle:!0,src:h,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:s.jsx(Ya,{size:48,className:"text-white"})}),s.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:p,disabled:i,children:i?s.jsx(Lt,{animation:"border",size:"sm"}):""}),s.jsx("input",{ref:a,type:"file",accept:"image/*",className:"d-none",onChange:g})]}),s.jsx("h4",{className:"mb-1",children:u()}),s.jsx("p",{className:"text-muted mb-2",children:f()}),s.jsx(Ce,{bg:d(m()),className:"mb-3",children:m()}),s.jsxs("div",{className:"text-start",children:[e?.address&&s.jsxs("div",{className:"mb-3",children:[s.jsx("strong",{children:"Address:"}),s.jsx("br",{}),s.jsx("span",{className:"text-muted",children:e.address})]}),s.jsx("div",{className:"d-flex justify-content-center",children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(pl,{size:14,className:"me-2"}),"Reset Password"]})})]})]})})},Bie=({profileData:e,user:t,onUpdate:r})=>{const[n,a]=v.useState(!1),[i,o]=v.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[l,c]=v.useState(!1);v.useEffect(()=>{if(e&&e.firstName){const f={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};o(f),c(!0)}},[e,l]);const d=f=>{const{name:m,value:h}=f.target;o(p=>({...p,[m]:h}))},u=async f=>{f.preventDefault(),a(!0);try{r?await r(i):(await js.updateProfile(i),xe.success("Personal information updated successfully!"))}catch(m){console.error("Error updating personal info:",m),r||xe.error("Failed to update personal information. Please try again.")}finally{a(!1)}};return s.jsxs(te,{children:[s.jsx(te.Header,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ya,{size:20,className:"me-2 text-primary"}),s.jsx("h5",{className:"mb-0",children:"Personal Information"})]})}),s.jsx(te.Body,{children:s.jsxs(F,{onSubmit:u,children:[s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"First Name"}),s.jsx(F.Control,{type:"text",name:"firstName",value:i.firstName,onChange:d,required:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Middle Name"}),s.jsx(F.Control,{type:"text",name:"middleName",value:i.middleName,onChange:d})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Last Name"}),s.jsx(F.Control,{type:"text",name:"lastName",value:i.lastName,onChange:d,required:!0})]})})]}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Email"}),s.jsx(F.Control,{type:"email",name:"email",value:i.email,onChange:d,required:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Phone Number"}),s.jsx(F.Control,{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:d})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Gender"}),s.jsxs(F.Select,{name:"gender",value:i.gender,onChange:d,children:[s.jsx("option",{value:"",children:"Select Gender"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-12 mb-3",children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Address"}),s.jsx(F.Control,{as:"textarea",rows:3,name:"address",value:i.address,onChange:d,placeholder:"Enter your address"})]})})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(se,{type:"submit",variant:"primary",disabled:n,children:n?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(Oa,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},$ie=()=>{const{user:e}=mn(),[t,r]=v.useState(!1),[n,a]=v.useState(!1),[i,o]=v.useState(null),[l,c]=v.useState(!0),d=async()=>{try{c(!0);const m=await js.getProfile();o(m)}catch(m){console.error("Failed to refresh profile:",m)}finally{c(!1)}};v.useEffect(()=>{d()},[]);const u=async m=>{r(!0);try{const h=await js.updateProfile(m);o(h),xe.success("Personal information updated successfully!")}catch(h){throw console.error("Error updating profile:",h),xe.error("Failed to update personal information. Please try again."),h}finally{r(!1)}},f=async m=>{r(!0);try{const h=await js.resetPassword(m);xe.success(h.message||"Password updated successfully!")}catch(h){throw xe.error(h.message||"Failed to update password. Please check your current password."),h}finally{r(!1)}};return l?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsxs(ge,{children:[s.jsx(ee,{lg:4,className:"mb-4",children:s.jsx(Lie,{profileData:i,user:e,onResetPassword:()=>a(!0),onAvatarUpdated:d})}),s.jsx(ee,{lg:8,className:"mb-4",children:s.jsx(Bie,{profileData:i,user:e,onUpdate:u})})]}),s.jsx(Mie,{show:n,onClose:()=>a(!1),onSave:f,loading:t})]})},zie=()=>{const{user:e}=mn(),t=mt(),{departments:r,loading:n,error:a}=lx(),i=r.filter(l=>l.status==="ACTIVE"),o=l=>{t(`/academic/course/${l}`)};return s.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:s.jsxs(Le,{className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"text-center",children:[s.jsx(di,{size:48,className:"text-primary mb-3"}),s.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),s.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),s.jsxs("p",{className:"text-muted small",children:["Total Departments: ",s.jsx("strong",{children:i.length})]})]})})}),s.jsx(ge,{className:"mb-5",children:n?s.jsxs(ee,{className:"text-center py-5",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):a?s.jsx(ee,{className:"text-center py-5",children:s.jsxs("p",{className:"text-danger",children:["Error loading departments: ",a.message]})}):i.map(l=>s.jsx(ee,{md:6,lg:4,className:"mb-4",children:s.jsx(te,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:s.jsxs(te.Body,{className:"p-4 d-flex flex-column",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"course-icon me-3",children:s.jsx(ur,{size:24,className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"mb-1",children:l.name}),s.jsx(Ce,{bg:"secondary",className:"text-white",children:l.code})]})]}),s.jsx("p",{className:"text-muted mb-3 flex-grow-1",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.4",maxHeight:"4.2em"},children:l.description}),s.jsxs(se,{variant:"outline-primary",className:"w-100 mt-auto",onClick:()=>o(l.id),children:["View Details",s.jsx(Ji,{size:16,className:"ms-2"})]})]})})},l.id))})]})})},Uie=()=>{const e=mt(),t={totalCourses:24,activeCourses:18,totalTrainees:156,completedCourses:89,upcomingSessions:12,averageCompletion:78},r=[{id:1,type:"course_completed",title:"Safety Procedures Course",trainee:"John Smith",time:"2 hours ago",icon:ml},{id:2,type:"new_enrollment",title:"Emergency Response Training",trainee:"Sarah Johnson",time:"4 hours ago",icon:fa},{id:3,type:"course_scheduled",title:"First Aid Training",trainee:"Mike Wilson",time:"6 hours ago",icon:fn}],n=[{title:"View All Departments",description:"Browse and manage academic departments",icon:di,action:()=>e("/academic/departments"),color:"primary"},{title:"Course Management",description:"Create and manage training courses",icon:ur,action:()=>e("/academic/departments"),color:"success"},{title:"Trainee Reports",description:"View trainee progress and reports",icon:In,action:()=>e("/academic/departments"),color:"info"}];return s.jsx("div",{style:{paddingBottom:"2rem"},children:s.jsxs(Le,{className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsx("div",{children:s.jsx("h2",{className:"mb-1",children:"Academic Dashboard"})})})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(ur,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:t.totalCourses}),s.jsx("p",{className:"text-muted mb-0 small",children:"Total Courses"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(eN,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:t.activeCourses}),s.jsx("p",{className:"text-muted mb-0 small",children:"Active Courses"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Fn,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:t.totalTrainees}),s.jsx("p",{className:"text-muted mb-0 small",children:"Total Trainees"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(ml,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:t.completedCourses}),s.jsx("p",{className:"text-muted mb-0 small",children:"Completed"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(fn,{size:32,className:"text-danger mb-2"}),s.jsx("h4",{className:"mb-1",children:t.upcomingSessions}),s.jsx("p",{className:"text-muted mb-0 small",children:"Upcoming"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Vt,{size:32,className:"text-secondary mb-2"}),s.jsxs("h4",{className:"mb-1",children:[t.averageCompletion,"%"]}),s.jsx("p",{className:"text-muted mb-0 small",children:"Avg. Completion"})]})})})]}),s.jsxs(ge,{children:[s.jsx(ee,{lg:8,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),s.jsx(te.Body,{children:s.jsx(ge,{children:n.map((a,i)=>s.jsx(ee,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:a.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(a.icon,{size:24,className:`text-${a.color} me-2`}),s.jsx("h6",{className:"mb-0",children:a.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:a.description}),s.jsx(Ji,{size:16,className:`text-${a.color} ms-auto`})]})},i))})})]})}),s.jsx(ee,{lg:4,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h5",{className:"mb-0",children:"Recent Activities"})}),s.jsxs(te.Body,{children:[r.map(a=>s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx("div",{className:"me-3",children:s.jsx(a.icon,{size:20,className:"text-primary"})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"mb-1 small",children:a.title}),s.jsx("p",{className:"text-muted mb-1 small",children:a.trainee}),s.jsx("p",{className:"text-muted mb-0 small",children:a.time})]})]},a.id)),s.jsx(se,{variant:"outline-primary",size:"sm",className:"w-100",children:"View All Activities"})]})]})})]})]})})},Wie=({courses:e,loading:t,actionsComponent:r,onView:n,onDisable:a})=>{const{sortedData:i,sortConfig:o,handleSort:l}=tn(e);if(t)return s.jsx(Qr,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"This department doesn't have any courses yet."})]})});const c=({columnKey:d,children:u,className:f=""})=>{const m=o.key===d,h=m?o.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${f} ${m?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="transparent",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"700":"600"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:h,size:14})})]}),m&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(c,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(c,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(c,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(c,{columnKey:"venue",className:"show-mobile",children:"Venue"}),s.jsx(c,{columnKey:"note",className:"show-mobile",children:"Note"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:i.map((d,u)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>n(d.id),style:{cursor:"pointer"},children:d.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.code})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.startDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.endDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Hl,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.venue||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(In,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.note||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ce,{bg:d.status==="ACTIVE"?"success":d.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.status||"N/A"})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{course:d,onView:n,onDisable:a})})]},d.id))})]})})},Hie=({course:e,onView:t,onDisable:r})=>{const n=()=>{t(e.id)},a=()=>{r(e.id)};return s.jsx(Bt,{permissions:[je.COURSES.VIEW_DETAIL,je.COURSES.UPDATE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:n,permission:je.COURSES.VIEW_DETAIL},{type:"divider"},{label:"Archive Course",icon:s.jsx(_a,{}),className:"text-warning",onClick:a,permission:je.COURSES.UPDATE}]})})},Vie=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,i]=v.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[o,l]=v.useState({});v.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}),t()},d=m=>{const{name:h,value:p}=m.target;if(i(x=>({...x,[h]:p})),o[h]&&l(x=>({...x,[h]:""})),h==="startDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(y=>({...y,startDate:"Start date cannot be in the past"}))}if(h==="endDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(y=>({...y,endDate:"End date cannot be in the past"}))}},u=()=>{const m={};if(a.name.trim()||(m.name="Course name is required"),a.code.trim()||(m.code="Course code is required"),a.description.trim()||(m.description="Description is required"),(!a.maxNumTrainee||isNaN(a.maxNumTrainee)||parseInt(a.maxNumTrainee)<=0)&&(m.maxNumTrainee="Max trainees must be a positive number"),a.venue.trim()||(m.venue="Venue is required"),(!a.passScore||isNaN(a.passScore)||!Number.isInteger(parseFloat(a.passScore))||parseInt(a.passScore)<0||parseInt(a.passScore)>100)&&(m.passScore="Pass score must be an integer between 0 and 100"),!a.startDate)m.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(a.startDate+"T00:00:00")<h&&(m.startDate="Start date cannot be in the past")}if(!a.endDate)m.endDate="End date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(a.endDate+"T00:00:00")<h&&(m.endDate="End date cannot be in the past")}return a.startDate&&a.endDate&&new Date(a.startDate+"T00:00:00")>=new Date(a.endDate+"T00:00:00")&&(m.endDate="End date must be after start date"),l(m),Object.keys(m).length===0},f=async m=>{if(m.preventDefault(),!!u())try{await r(a),c()}catch{}};return s.jsxs(ce,{show:e,onHide:c,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-2",size:20}),"Add New Course"]}),s.jsx(se,{variant:"link",onClick:c,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(F,{onSubmit:f,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Course Name *"}),s.jsx(F.Control,{type:"text",name:"name",value:a.name,onChange:d,isInvalid:!!o.name,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.name})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Course Code *"}),s.jsx(F.Control,{type:"text",name:"code",value:a.code,onChange:d,isInvalid:!!o.code,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.code})]})})]}),s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Max Trainees *"}),s.jsx(F.Control,{type:"number",name:"maxNumTrainee",value:a.maxNumTrainee,onChange:d,isInvalid:!!o.maxNumTrainee,disabled:n,min:"1"}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.maxNumTrainee})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Pass Score *"}),s.jsx(F.Control,{type:"number",name:"passScore",value:a.passScore,onChange:d,isInvalid:!!o.passScore,disabled:n,min:"0",max:"100",step:"1"}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Level"}),s.jsxs(F.Select,{name:"level",value:a.level,onChange:d,disabled:n,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Venue *"}),s.jsx(F.Control,{type:"text",name:"venue",value:a.venue,onChange:d,isInvalid:!!o.venue,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.venue})]})})]}),s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Start Date *"}),s.jsx(F.Control,{type:"date",name:"startDate",value:a.startDate,onChange:d,isInvalid:!!o.startDate,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.startDate})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"End Date *"}),s.jsx(F.Control,{type:"date",name:"endDate",value:a.endDate,onChange:d,isInvalid:!!o.endDate,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Description *"}),s.jsx(F.Control,{as:"textarea",rows:3,name:"description",value:a.description,onChange:d,isInvalid:!!o.description,disabled:n}),s.jsx(F.Control.Feedback,{type:"invalid",children:o.description})]})})}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Note"}),s.jsx(F.Control,{as:"textarea",rows:2,name:"note",value:a.note,onChange:d,disabled:n})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:c,disabled:n,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary-custom",type:"submit",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},Gie=({show:e,onClose:t,onArchive:r,course:n,loading:a=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),u=i==="ARCHIVE",f=()=>{o(""),c(""),t()},m=async()=>{if(!u){c('Please type "ARCHIVE" to confirm');return}try{await r(n?.id),f()}catch(p){c(p.message||"Failed to archive course. Please try again.")}},h=p=>{o(p.target.value),c("")};return s.jsxs(ce,{show:e,onHide:f,centered:!0,children:[s.jsx(ce.Header,{className:"bg-warning text-dark border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:"me-2",size:20}),"Archive Course"]})}),s.jsxs(ce.Body,{className:"p-4",children:[l&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:l}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Course Code:"})," ",n?.code,s.jsx("br",{}),s.jsx("strong",{children:"Course Name:"})," ",n?.name,s.jsx("br",{}),n?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",n?.description,s.jsx("br",{})]}),n?.venue&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Venue:"})," ",n?.venue,s.jsx("br",{})]}),n?.startDate&&n?.endDate&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Duration:"})," ",n?.startDate," to ",n?.endDate]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[s.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),s.jsx("li",{children:"Move the course to archived status"}),s.jsx("li",{children:"Preserve all course data and trainee progress"}),s.jsx("li",{children:"Allow course to be restored if needed"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!u?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type ARCHIVE here",disabled:a}),i&&!u&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"warning",onClick:m,disabled:a||!u,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Et,{className:"me-2",size:16}),"Archive Course"]})})]})]})},qie=({show:e,onClose:t,departmentHead:r,department:n})=>r?s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsxs(ce.Title,{children:[s.jsx(Ya,{className:"me-2"}),"Department Head Details"]})}),s.jsx(ce.Body,{children:s.jsxs(ge,{className:"g-3",children:[s.jsx(ee,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:s.jsx(Ya,{size:40,className:"text-white"})}),s.jsxs("h5",{className:"mb-1",children:[r.firstName," ",r.lastName]}),s.jsx(Ce,{bg:"primary",className:"mb-2",children:"Department Head"}),s.jsx("p",{className:"text-muted small mb-0",children:n?.name})]})}),s.jsx(ee,{md:8,children:s.jsxs(ge,{className:"g-3",children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Zp,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Email"}),s.jsx("div",{className:"fw-semibold",children:r.email})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(aN,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Phone"}),s.jsx("div",{className:"fw-semibold",children:r.phone||"N/A"})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(di,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Department"}),s.jsxs("div",{className:"fw-semibold",children:[n?.name," (",n?.code,")"]})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Appointed Date"}),s.jsx("div",{className:"fw-semibold",children:r.appointedDate||"N/A"})]})]})}),s.jsx(ee,{md:12,children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(ml,{size:16,className:"me-2 text-primary mt-1"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Responsibilities"}),s.jsx("div",{className:"fw-semibold",children:r.responsibilities||"Oversee department operations, manage training programs, and ensure compliance with safety standards."})]})]})})]})})]})}),s.jsx(ce.Footer,{children:s.jsx(se,{variant:"secondary",onClick:t,children:"Close"})})]}):null,Kie=({courseId:e})=>{const t=mt(),[r,n]=v.useState(null),[a,i]=v.useState([]),[o,l]=v.useState(!0),[c,d]=v.useState(!1),[u,f]=v.useState("add"),[m,h]=v.useState(!1),[p,x]=v.useState(null),[g,y]=v.useState(null),[w,b]=v.useState(!1),[j,N]=v.useState(!1),E={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},S=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];v.useEffect(()=>{e&&(async()=>{l(!0);try{const W=await yn.getDepartmentById(e);if(!W)throw new Error(`Department with ID ${e} not found in API response`);const Y={id:W.id,name:W.name,code:W.code,description:W.description,duration:"N/A",status:W.isActive,totalSubjects:W.courseCount||0,totalTrainers:W.trainerCount||0};n(Y);const Q=W.courses?.map(J=>({id:J.id,name:J.name,code:J.code,startDate:J.startDate?new Date(J.startDate).toISOString().split("T")[0]:"N/A",endDate:J.endDate?new Date(J.endDate).toISOString().split("T")[0]:"N/A",venue:J.venue||"N/A",note:J.note||"N/A",status:J.status,description:J.description,maxNumTrainee:J.maxNumTrainee,passScore:J.passScore,level:J.level,subjectCount:J.subjectCount||0}))||[];i(Q),W.headUser&&y(W.headUser),l(!1)}catch{l(!1);const _=E[e];_&&(n(_),i(S))}})()},[e]);const T=()=>{f("add"),d(!0)},k=L=>{const _=a.find(W=>W.id===L);x(_),h(!0)},I=async L=>{try{await yn.archiveCourse(L),xe.success("Course archived successfully"),i(_=>_.map(W=>W.id===L?{...W,status:"ARCHIVED"}:W)),h(!1),x(null)}catch(_){throw xe.error("Failed to archive course. Please try again."),_}},C=L=>{t(`/academic/course-detail/${L}`,{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},A=async L=>{try{N(!0);const _={departmentId:r.id,name:L.name,description:L.description,code:L.code,maxNumTrainee:Number(L.maxNumTrainee),venue:L.venue,note:L.note,passScore:Number(L.passScore),startDate:L.startDate?new Date(L.startDate).toISOString():null,endDate:L.endDate?new Date(L.endDate).toISOString():null,level:L.level},W=await yn.createCourse(_);xe.success("Course created successfully");const Y={id:W.id,name:W.name,code:W.code,startDate:W.startDate?new Date(W.startDate).toISOString().split("T")[0]:"N/A",endDate:W.endDate?new Date(W.endDate).toISOString().split("T")[0]:"N/A",venue:W.venue||"N/A",note:W.note||"N/A",status:W.status||"PLANNED",description:W.description,maxNumTrainee:W.maxNumTrainee,passScore:W.passScore,level:W.level,department:W.department};i(Q=>[Y,...Q])}catch(_){throw _.response?.status,xe.error(_.response?.data?.message||"Failed to create course"),_}finally{N(!1)}};return o?s.jsx(Le,{className:"py-4",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?s.jsxs(Le,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[s.jsx(ge,{className:"mb-1 flex-shrink-0",children:s.jsx(ee,{children:s.jsx(te,{className:"border-0 shadow-sm",children:s.jsxs(te.Body,{className:"p-2",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-1",children:[s.jsx(ur,{className:"me-2 text-primary"}),r.name]}),s.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),s.jsx("p",{className:"text-muted mb-1 small",children:r.description}),s.jsxs(ge,{className:"g-2",children:[s.jsx(ee,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(In,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Subjects"}),s.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),s.jsx(ee,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fn,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Trainers"}),s.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),s.jsx(ee,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ya,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Department Head"}),s.jsx("div",{className:"fw-semibold small",children:g?s.jsxs(se,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>b(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName," ",g.lastName]}):"Not assigned"})]})]})})]})]})})})}),s.jsx(ge,{className:"mt-3",children:s.jsx(ee,{children:s.jsxs(te,{className:"border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom flex-shrink-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("h5",{className:"mb-0",children:[s.jsx(In,{className:"me-2"}),"Courses (",a.length,")"]}),s.jsx(Bt,{permission:je.COURSES.CREATE,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:T,children:[s.jsx(wn,{size:16,className:"me-1"}),"Add New Course"]})})]})}),s.jsx("div",{className:"p-0",children:s.jsx(Wie,{courses:a,loading:!1,actionsComponent:Hie,onView:C,onDisable:k})})]})})}),s.jsx(Vie,{show:c&&u==="add",onClose:()=>d(!1),onSave:A,loading:j}),s.jsx(Gie,{show:m,onClose:()=>h(!1),onArchive:I,course:p}),s.jsx(qie,{show:w,onClose:()=>b(!1),departmentHead:g,department:r})]}):s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx(ur,{size:48,className:"mb-3"}),s.jsx("h4",{children:"Department not found"}),s.jsx("p",{children:"The requested department could not be found."})]})})},Yie=()=>{const{courseId:e}=sa();return s.jsx(Kie,{courseId:e})},Xie=({trainer:e,onEdit:t,onDelete:r})=>s.jsx(Bt,{permissions:[je.SUBJECTS.UPDATE,je.SUBJECTS.REMOVE_INSTRUCTOR],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"Edit Trainer",icon:s.jsx(ga,{}),onClick:()=>t(e.id),permission:je.SUBJECTS.UPDATE},{type:"divider"},{label:"Remove Trainer",icon:s.jsx(Ti,{}),className:"text-danger",onClick:()=>r(e.id),permission:je.SUBJECTS.REMOVE_INSTRUCTOR}]})}),MC=({show:e,onClose:t,onDisable:r,subject:n,loading:a=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),u=i==="DISABLE",f=()=>{o(""),c(""),t()},m=async()=>{if(!u){c('Please type "DISABLE" to confirm');return}try{await r(n?.id),f()}catch(p){c(p.message||"Failed to disable subject. Please try again.")}},h=p=>{o(p.target.value),c("")};return s.jsxs(ce,{show:e,onHide:f,centered:!0,children:[s.jsx(ce.Header,{className:"bg-warning text-dark border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:"me-2",size:20}),"Disable Subject"]})}),s.jsxs(ce.Body,{className:"p-4",children:[l&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:l}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to disable the following subject:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Subject Code:"})," ",n?.code,s.jsx("br",{}),s.jsx("strong",{children:"Subject Name:"})," ",n?.name,s.jsx("br",{}),n?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",n?.description]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[s.jsx("li",{children:"Make the subject unavailable for new enrollments"}),s.jsx("li",{children:"Remove the subject from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"DISABLE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!u?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type DISABLE here",disabled:a}),i&&!u&&s.jsx("div",{className:"invalid-feedback",children:'Please type "DISABLE" exactly as shown'})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsx(se,{variant:"outline-secondary",onClick:f,disabled:a,children:"Cancel"}),s.jsx(se,{variant:"warning",onClick:m,disabled:a||!u,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Disabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Et,{className:"me-2",size:16}),"Disable Subject"]})})]})]})},Zie=({show:e,onClose:t,onSave:r,subject:n,loading:a=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[l,c]=v.useState([]);v.useEffect(()=>{n&&e&&(o({name:n.name||"",code:n.code||"",description:n.description||"",duration:n.duration||"",level:n.level||"Beginner"}),c([]))},[n,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.name.trim()||h.push("Subject name is required"),i.code.trim()||h.push("Subject code is required"),i.description.trim()||h.push("Description is required"),i.duration.trim()||h.push("Duration is required"),c(h),h.length===0},f=async h=>{if(h.preventDefault(),!!u())try{await r(i),m()}catch{}},m=()=>{o({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),t()};return s.jsxs(ce,{show:e,onHide:m,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(ga,{className:"me-2",size:20}),"Edit Subject"]}),s.jsx(se,{variant:"link",onClick:m,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((h,p)=>s.jsx("li",{children:h},p))})}),s.jsxs(F,{onSubmit:f,children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Subject Name *"}),s.jsx(F.Control,{type:"text",name:"name",value:i.name,onChange:d,placeholder:"Enter subject name",disabled:a})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Subject Code *"}),s.jsx(F.Control,{type:"text",name:"code",value:i.code,onChange:d,placeholder:"Enter subject code",disabled:a})]})})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Duration *"}),s.jsx(F.Control,{type:"text",name:"duration",value:i.duration,onChange:d,placeholder:"e.g., 2 weeks, 1 month",disabled:a})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Level"}),s.jsxs(F.Select,{name:"level",value:i.level,onChange:d,disabled:a,children:[s.jsx("option",{value:"Beginner",children:"Beginner"}),s.jsx("option",{value:"Intermediate",children:"Intermediate"}),s.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Description *"}),s.jsx(F.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:d,placeholder:"Enter subject description",disabled:a})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:m,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:f,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ga,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Jie=({show:e,onClose:t,onSave:r,trainer:n,loading:a=!1})=>{const[i,o]=v.useState({roleInSubject:"ASSISTANT_INSTRUCTOR"}),[l,c]=v.useState([]);v.useEffect(()=>{n&&e&&(o({roleInSubject:n.role||"ASSISTANT_INSTRUCTOR"}),c([]))},[n,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.roleInSubject||h.push("Role in subject is required"),c(h),h.length===0},f=async h=>{if(h.preventDefault(),!!u())try{await r(i),m()}catch{}},m=()=>{o({roleInSubject:"ASSISTANT_INSTRUCTOR"}),c([]),t()};return s.jsxs(ce,{show:e,onHide:m,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(ga,{className:"me-2",size:20}),"Edit Trainer"]}),s.jsx(se,{variant:"link",onClick:m,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((h,p)=>s.jsx("li",{children:h},p))})}),s.jsxs(F,{onSubmit:f,children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Trainer Name"}),s.jsx(F.Control,{type:"text",value:n?.name||"",disabled:!0,className:"bg-light"})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"EID"}),s.jsx(F.Control,{type:"text",value:n?.eid||"",disabled:!0,className:"bg-light"})]})})]}),s.jsx(ge,{children:s.jsx(ee,{md:12,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Role in Subject *"}),s.jsxs(F.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:d,disabled:a,children:[s.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),s.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),s.jsx(F.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:m,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:f,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ga,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Qie=({show:e,onClose:t,onSave:r,loading:n=!1})=>{const[a,i]=v.useState({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),[o,l]=v.useState([]),[c,d]=v.useState([]),[u,f]=v.useState(!1),m=async()=>{f(!0);try{const y=await nn.getTrainers();y&&y.data?d(y.data):d([])}catch{d([])}finally{f(!1)}};v.useEffect(()=>{e&&(i({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),l([]),m())},[e]);const h=y=>{const{name:w,value:b}=y.target;i(j=>({...j,[w]:b}))},p=()=>{const y=[];return a.trainer_user_id||y.push("Please select a trainer"),a.role_in_subject||y.push("Role in subject is required"),l(y),y.length===0},x=async y=>{if(y.preventDefault(),!!p())try{await r(a),g()}catch{}},g=()=>{i({trainer_user_id:"",role_in_subject:"ASSISTANT_INSTRUCTOR"}),l([]),t()};return s.jsxs(ce,{show:e,onHide:g,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-2",size:20}),"Add Trainer"]}),s.jsx(se,{variant:"link",onClick:g,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[o.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((y,w)=>s.jsx("li",{children:y},w))})}),s.jsx(F,{onSubmit:x,children:s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Select Trainer *"}),s.jsxs(F.Select,{name:"trainer_user_id",value:a.trainer_user_id,onChange:h,disabled:n||u,children:[s.jsx("option",{value:"",children:u?"Loading trainers...":"Choose a trainer..."}),c.map(y=>s.jsxs("option",{value:y.id,children:[y.firstName," ",y.lastName," - ",y.department?.name||"General"]},y.id))]}),u&&s.jsxs("div",{className:"mt-2 text-center",children:[s.jsx(Lt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Role in Subject *"}),s.jsxs(F.Select,{name:"role_in_subject",value:a.role_in_subject,onChange:h,disabled:n,children:[s.jsx("option",{value:"PRIMARY_INSTRUCTOR",children:"Primary Instructor - Main course instructor"}),s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"}),s.jsx("option",{value:"ASSISTANT_INSTRUCTOR",children:"Assistant Instructor - Supports primary instructor"})]}),s.jsx(F.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in the subject"})]})})]})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:g,disabled:n,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:x,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(wn,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},eoe=({subjectId:e,courseId:t})=>{const r=mt(),n=Si(),[a,i]=v.useState(null),[o,l]=v.useState([]),[c,d]=v.useState(!0),[u,f]=v.useState(!1),[m,h]=v.useState(!1),[p,x]=v.useState(!1),[g,y]=v.useState(!1),[w,b]=v.useState(null),[j,N]=v.useState(!1),[E,S]=v.useState(!1),[T,k]=v.useState(!1),[I,C]=v.useState(!1),[A,L]=v.useState("subject-info"),{sortedData:_}=tn(o),W=z=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[z]||{text:z,variant:"light"},Y=v.useCallback(z=>{if(console.log(" NEW CODE: Loading trainers from subject data:",z),z&&z.instructors){console.log(" Raw instructors data:",z.instructors);const V=z.instructors.map(P=>({id:P.id,eid:P.eid,name:`${P.firstName} ${P.lastName}`,role:P.roleInSubject,assignedAt:P.assignedAt}));console.log(" Transformed trainers:",V),l(V)}else console.log(" No instructors data in subject"),l([])},[]);v.useEffect(()=>{e&&(async()=>{if(e){d(!0);try{const V=await Dr.getSubjectById(e);V?(i(V),Y(V)):i(null)}catch{i(null)}finally{d(!1)}}})()},[e,Y]);const Q=async z=>{S(!0);try{await new Promise(V=>setTimeout(V,1e3)),i(V=>({...V,...z})),xe.success("Subject updated successfully!"),h(!1)}catch{xe.error("Failed to update subject")}finally{S(!1)}},J=async()=>{N(!0);try{await new Promise(z=>setTimeout(z,1e3)),f(!1)}catch{}finally{N(!1)}},U=async z=>{k(!0);try{await Dr.addTrainerToSubject(e,z);const V=await Dr.getSubjectById(e);V&&(i(V),Y(V)),xe.success("Trainer added successfully!"),x(!1)}catch(V){console.error("Error adding trainer:",V);const P=V?.message||V?.error||"Failed to add trainer";xe.error(P)}finally{k(!1)}},ie=async z=>{if(w){C(!0);try{await Dr.updateTrainerRole(e,w.id,z);const V=await Dr.getSubjectById(e);V&&(i(V),Y(V)),xe.success("Trainer role updated successfully!"),y(!1)}catch(V){console.error("Error updating trainer role:",V);const P=V?.message||V?.error||"Failed to update trainer role";xe.error(P)}finally{C(!1)}}},re=async z=>{if(z)try{await Dr.removeTrainerFromSubject(e,z);const V=await Dr.getSubjectById(e);V&&(i(V),Y(V)),xe.success("Trainer removed successfully!")}catch(V){console.error("Error removing trainer:",V);const P=V?.message||V?.error||"Failed to remove trainer";xe.error(P)}},M=()=>{if(t)r(`/academic/course-detail/${t}`);else if(n.state?.courseId)r(`/academic/course-detail/${n.state.courseId}`);else if(document.referrer){const z=document.referrer.match(/\/course-detail\/([^/]+)/);r(z?`/academic/course-detail/${z[1]}`:-1)}else a?.courseId?r(`/academic/course-detail/${a.courseId}`):r(-1)};return c?s.jsx(Le,{className:"py-4",children:s.jsx(Qr,{rows:4,columns:3})}):a?s.jsxs(Le,{className:"py-4 subject-details",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(se,{variant:"outline-secondary",onClick:M,className:"me-3",children:[s.jsx(gr,{className:"me-2",size:16}),"Back to Course"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:a.name}),s.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",a.code]})]})]})}),s.jsx(te,{className:"border-0 shadow-sm",children:s.jsxs(lr.Container,{activeKey:A,onSelect:L,children:[s.jsx(te.Header,{className:"border-bottom py-2",children:s.jsxs(ft,{variant:"tabs",className:"border-0",children:[s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",color:A==="subject-info"?"#0d6efd":"#6c757d",fontWeight:A==="subject-info"?"600":"400"},children:[s.jsx(Jj,{className:"me-2",size:16}),"Subject Information"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",color:A==="trainers"?"#0d6efd":"#6c757d",fontWeight:A==="trainers"?"600":"400"},children:[s.jsx(nN,{className:"me-2",size:16}),"Trainers (",o.length,")"]})})]})}),s.jsx(te.Body,{className:"p-4",children:s.jsxs(lr.Content,{children:[s.jsxs(lr.Pane,{eventKey:"subject-info",children:[s.jsxs(ge,{children:[s.jsxs(ee,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",a.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Code:"})," ",a.code]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",a.description]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Method:"})," ",a.method]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Duration:"})," ",a.duration," days"]})]}),s.jsxs(ee,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Type:"})," ",a.type]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Pass Score:"})," ",a.passScore,"%"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Room:"})," ",a.roomName]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time Slot:"})," ",a.timeSlot]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Start Date:"})," ",new Date(a.startDate).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"End Date:"})," ",new Date(a.endDate).toLocaleDateString()]})]})]}),a.remarkNote&&s.jsx(ge,{children:s.jsx(ee,{xs:12,children:s.jsxs("p",{children:[s.jsx("strong",{children:"Remark Note:"})," ",a.remarkNote]})})})]}),s.jsxs(lr.Pane,{eventKey:"trainers",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[s.jsxs("h6",{className:"mb-0",children:["Trainers (",o.length,")"]}),s.jsxs(se,{variant:"primary",size:"sm",onClick:()=>x(!0),children:[s.jsx(wn,{size:14,className:"me-1"}),"Add Trainer"]})]}),s.jsxs(qt,{hover:!0,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"EID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Assigned Date"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:_.map(z=>{const V=W(z.role);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx(Ce,{bg:"secondary",className:"text-white",children:z.eid})}),s.jsx("td",{children:z.name}),s.jsx("td",{children:s.jsx(Ce,{bg:V.variant,children:V.text})}),s.jsx("td",{children:new Date(z.assignedAt).toLocaleDateString()}),s.jsx("td",{children:s.jsx(Xie,{trainer:z,onEdit:()=>{b(z),y(!0)},onDelete:re})})]},z.id)})})]})]})]})})]})}),s.jsx(MC,{show:u,onClose:()=>f(!1),onConfirm:J,subject:a,loading:j}),s.jsx(Zie,{show:m,onClose:()=>h(!1),onSave:Q,subject:a,loading:E}),s.jsx(Qie,{show:p,onClose:()=>x(!1),onSave:U,loading:T}),s.jsx(Jie,{show:g,onClose:()=>y(!1),onSave:ie,trainer:w,loading:I})]}):s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{children:"Subject not found"}),s.jsx("p",{children:"The requested subject could not be found."}),s.jsxs(se,{variant:"primary",onClick:M,children:[s.jsx(gr,{className:"me-2",size:16}),"Go Back"]})]})})},Bj=()=>{const{subjectId:e,courseId:t}=sa();return s.jsx(eoe,{subjectId:e,courseId:t})},toe=({subject:e,onView:t,onEdit:r,onDelete:n})=>{const a=()=>{t&&t(e.id)},i=()=>{n&&n(e.id)};return s.jsx(Bt,{permissions:[je.SUBJECTS.VIEW_DETAIL,je.SUBJECTS.DELETE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:a,permission:je.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Disable Subject",icon:s.jsx(lN,{}),className:"text-warning",onClick:i,permission:je.SUBJECTS.DELETE}]})})},roe=e=>(console.log(" mapApiSubjectToTable - API subject fields:",Object.keys(e)),console.log(" mapApiSubjectToTable - start_date:",e.start_date,"startDate:",e.startDate),console.log(" mapApiSubjectToTable - end_date:",e.end_date,"endDate:",e.endDate),{id:e.id,name:e.name,code:e.code,method:e.method,duration:aoe(e.duration),startDate:$j(e.startDate||e.start_date),endDate:$j(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.deletedAt?"INACTIVE":"ACTIVE",description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),noe=e=>{console.log(" mapApiSubjectsToTable - Input:",e),console.log(" mapApiSubjectsToTable - Input length:",e.length);const t=e.map(roe);return console.log(" mapApiSubjectsToTable - Output:",t),console.log(" mapApiSubjectsToTable - Output length:",t.length),t},aoe=e=>e?e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`:"N/A",$j=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch(t){return console.error("Error formatting date:",t),"Invalid Date"}},soe=e=>{switch(e){case"ACTIVE":return"success";case"INACTIVE":return"secondary";default:return"secondary"}},ioe=e=>{switch(e){case"CLASSROOM":return"info";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},ooe=({subjects:e=[],loading:t=!1,onView:r,onEdit:n,onDelete:a})=>{console.log(" SubjectTable - Received subjects:",e),console.log(" SubjectTable - subjects length:",e.length),console.log(" SubjectTable - loading:",t);const i=noe(e);console.log(" SubjectTable - mappedApiSubjects:",i),console.log(" SubjectTable - mappedApiSubjects length:",i.length);const{sortedData:o,sortConfig:l,handleSort:c}=tn(i);if(t)return s.jsx(Qr,{rows:4,columns:5});if(i.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const d=({columnKey:u,children:f,className:m=""})=>{const h=l.key===u,p=h?l.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${m} ${h?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="transparent",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:f}),s.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:s.jsx(Fr,{direction:p,size:14})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(d,{columnKey:"name",className:"show-mobile",children:"Name"}),s.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(d,{columnKey:"method",className:"show-mobile",children:"Method"}),s.jsx(d,{columnKey:"duration",className:"show-mobile",children:"Duration"}),s.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(d,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),s.jsx(d,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),s.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:s.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),s.jsx("tbody",{children:o.map(u=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(u.id),style:{cursor:"pointer"},children:u.name})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.code,children:u.code})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ce,{bg:ioe(u.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.method,children:u.method})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.duration})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.startDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.endDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.roomName})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fn,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.trainees||0})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs(Ce,{bg:soe(u.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="ACTIVE"?"":""}),u.status==="ACTIVE"?"Active":"Inactive"]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(toe,{subject:u,onView:r,onEdit:n,onDelete:a})})]},u.id))})]})})},loe=({trainee:e,onView:t,onRemove:r})=>{const n=()=>{t&&t(e)},a=()=>{r&&r(e)};return s.jsx(Bt,{permissions:[je.TRAINEES.VIEW_DETAIL,je.TRAINEES.DELETE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Details",icon:s.jsx(tr,{}),onClick:n,permission:je.TRAINEES.VIEW_DETAIL},{type:"divider"},{label:"Remove from Course",icon:s.jsx(vo,{}),className:"text-danger",onClick:a,permission:je.TRAINEES.DELETE}]})})},coe=({show:e,onClose:t,onConfirm:r,trainee:n,subject:a,loading:i=!1})=>{if(!n||!a)return null;const o=()=>{r(n.id,a.id)};return s.jsxs(ce,{show:e,onHide:t,centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,className:"border-bottom",children:s.jsxs(ce.Title,{className:"d-flex align-items-center text-danger",children:[s.jsx(Et,{className:"me-2",size:20}),"Remove Subject"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs(Ye,{variant:"warning",className:"mb-3",children:[s.jsx(Et,{className:"me-2",size:16}),s.jsx("strong",{children:"Warning:"})," This action cannot be undone."]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-2",children:["Are you sure you want to remove ",s.jsxs("strong",{children:['"',a.name,'"']})," from trainee ",s.jsxs("strong",{children:['"',n.name,'"']}),"?"]}),s.jsx("div",{className:"bg-light p-3 rounded",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Trainee:"}),s.jsx("div",{className:"fw-semibold",children:n.name}),s.jsx("div",{className:"text-muted small",children:n.eid})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Subject:"}),s.jsx("div",{className:"fw-semibold",children:a.name}),s.jsx("div",{className:"text-muted small",children:a.code})]})]})})]}),s.jsx("p",{className:"text-muted small mb-0",children:"The trainee will no longer be enrolled in this subject and will lose access to related materials and assessments."})]}),s.jsxs(ce.Footer,{className:"border-top",children:[s.jsx(se,{variant:"secondary",onClick:t,disabled:i,children:"Cancel"}),s.jsx(se,{variant:"danger",onClick:o,disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ti,{className:"me-2",size:16}),"Remove Subject"]})})]})]})},doe=({show:e,onClose:t,trainee:r,onRemoveSubject:n,loading:a=!1})=>{const[i,o]=v.useState(!1),[l,c]=v.useState(null),[d,u]=v.useState(!1);if(!r)return null;const f=(p,x)=>{const g=r.subjects.find(y=>y.id===p);g&&(c(g),o(!0))},m=async(p,x)=>{u(!0);try{await n(p,x),o(!1),c(null)}catch(g){console.error("Error removing subject:",g)}finally{u(!1)}},h=()=>{o(!1),c(null)};return s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,className:"border-bottom",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Ya,{className:"me-2 text-primary",size:20}),"Trainee Details"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs(ge,{className:"mb-4",children:[s.jsxs(ee,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Full Name"}),s.jsx("p",{className:"mb-0 fw-semibold",children:r.name})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Employee ID"}),s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",children:r.eid})]})]}),s.jsxs(ee,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Email"}),s.jsx("span",{children:r.email})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Phone"}),s.jsx("span",{children:r.phone})]})]})]}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Enroll Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:16,className:"me-2 text-primary"}),s.jsx("span",{children:r.enrollDate||"N/A"})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Enroll Batch"}),s.jsx(Ce,{bg:"info",className:"px-2 py-1",children:r.enrollBatch||"N/A"})]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"text-muted mb-3 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2 text-primary",size:16}),"Enrolled Subjects (",r.subjects?.length||0,")"]}),r.subjects&&r.subjects.length>0?s.jsx("div",{className:"table-responsive",children:s.jsxs(qt,{hover:!0,size:"sm",className:"mb-0",children:[s.jsx("thead",{className:"bg-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-0",children:"Subject Name"}),s.jsx("th",{className:"border-0",children:"Code"}),s.jsx("th",{className:"border-0",children:"Status"}),s.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),s.jsx("tbody",{children:r.subjects.map((p,x)=>s.jsxs("tr",{children:[s.jsxs("td",{className:"border-0",children:[s.jsx("div",{className:"fw-semibold",children:p.name}),p.description&&s.jsx("small",{className:"text-muted",children:p.description})]}),s.jsx("td",{className:"border-0",children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:p.code})}),s.jsx("td",{className:"border-0",children:s.jsx(Ce,{bg:p.status==="ACTIVE"?"success":p.status==="COMPLETED"?"primary":"warning",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:p.status})}),s.jsx("td",{className:"border-0 text-center",children:s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>f(p.id||x,p.name),disabled:a,className:"p-1",style:{minWidth:"32px"},children:s.jsx(Ti,{size:14})})})]},x))})]})}):s.jsxs("div",{className:"text-center text-muted py-3",children:[s.jsx(ur,{size:32,className:"mb-2"}),s.jsx("p",{className:"mb-0",children:"No subjects enrolled"})]})]})]}),s.jsx(ce.Footer,{className:"border-top",children:s.jsx(se,{variant:"secondary",onClick:t,children:"Close"})}),s.jsx(coe,{show:i,onClose:h,onConfirm:m,trainee:r,subject:l,loading:d})]})},uoe=({course:e,loading:t=!1,onView:r,onRemove:n})=>{const{courseId:a}=sa(),[i,o]=v.useState(null),[l,c]=v.useState(!1),[d,u]=v.useState([]),[f,m]=v.useState(!0),[h,p]=v.useState(null),{sortedData:x,sortConfig:g,handleSort:y}=tn(d),w=v.useCallback(async()=>{m(!0),p(null);try{const T=await no.getTraineesForEnrollment();if(!T||!T.data){u([]);return}const k=[];for(const I of T.data)try{const C=await yn.getTraineeEnrollments(I.id);if(C&&C.enrollments&&C.enrollments.length>0){const A=C.enrollments.filter(L=>L.enrollment?.status==="ENROLLED");if(A.length>0){const L=A.map(W=>W.subject.id),_={id:I.id,eid:I.eid,name:`${I.firstName} ${I.lastName}`.trim(),email:I.email,subjects:L,userId:I.id,department:I.department,enrollmentCount:A.length,enrollDate:A[0]?.enrollment?.enrollmentDate?new Date(A[0].enrollment.enrollmentDate).toLocaleDateString():"N/A",enrollBatch:A[0]?.enrollment?.batchCode||"N/A"};k.push(_)}}}catch{}u(k)}catch{u([])}finally{m(!1)}},[]);v.useEffect(()=>{a&&w()},[a,w]);const b=async T=>{try{const k=await yn.getTraineeEnrollments(T.userId),I=k.enrollments?.filter(A=>A.enrollment?.status==="ENROLLED")||[],C={...T,enrollmentDetails:k,subjects:I.map(A=>({id:A.subject.id,name:A.subject.name,code:A.subject.code,status:A.subject.status,type:A.subject.type,method:A.subject.method,startDate:A.subject.startDate,endDate:A.subject.endDate,course:A.subject.course,enrollment:A.enrollment}))};o(C),c(!0)}catch{o(T),c(!0)}},j=()=>{c(!1),o(null)},N=async T=>{if(window.confirm(`Are you sure you want to remove ${T.name} from this course?`))try{const k=await yn.getTraineeEnrollments(T.userId);if(k&&k.enrollments&&k.enrollments.length>0){const C=k.enrollments.map(async A=>{const L=A.subject.id,_=A.enrollment?.batchCode||"TEST0012025";return A.enrollment?.status!=="ENROLLED"?null:Dr.removeTraineeFromSubject(L,T.userId,_)}).filter(A=>A!==null);C.length>0&&await Promise.all(C),await w()}}catch(k){console.error("Error removing trainee:",k)}},E=async(T,k)=>{try{const I=d.find(L=>L.id===T);if(!I)return;const C=i?.subjects?.find(L=>L.id===k);if(!C)return;const A=C.enrollment?.batchCode||"TEST0012025";if(C.enrollment?.status!=="ENROLLED")throw new Error("Cannot remove trainee from inactive enrollment");await Dr.removeTraineeFromSubject(k,I.userId,A),await w(),c(!1)}catch(I){throw console.error("Error removing subject:",I),I}};if(f)return s.jsx(Qr,{rows:4,columns:7});if(h)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-danger",children:[s.jsx("h5",{children:"Error loading trainees"}),s.jsx("p",{children:h}),s.jsx("button",{className:"btn btn-outline-primary",onClick:fetchTrainees,children:"Try Again"})]})});if(d.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})});const S=({columnKey:T,children:k,className:I=""})=>{const C=g.key===T,A=C?g.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-start ${I} ${C?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px"},onClick:()=>y(T),onMouseEnter:L=>{L.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",L.target.style.transform="translateY(-1px)",L.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:L=>{L.target.style.backgroundColor="transparent",L.target.style.transform="translateY(0)",L.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"700":"600",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k}),s.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:s.jsx(Fr,{direction:A,size:14})})]}),C&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"department-table-container trainee-table-scroll",style:{overflowX:"hidden"},children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(S,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(S,{columnKey:"name",className:"show-mobile",children:"Full Name"}),s.jsx(S,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(S,{columnKey:"subjects",className:"show-mobile",children:"Number of Subjects"}),s.jsx(S,{columnKey:"enrollDate",className:"show-mobile",children:"Enroll Date"}),s.jsx(S,{columnKey:"enrollBatch",className:"show-mobile",children:"Enroll Batch"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px"},children:s.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),s.jsx("tbody",{children:x.map(T=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:T.eid,children:T.eid})}),s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>b(T),style:{cursor:"pointer"},children:T.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",style:{fontSize:"0.85rem"},children:T.email})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ce,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:T.enrollmentCount})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:T.enrollDate})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ce,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:T.enrollBatch,children:T.enrollBatch})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(loe,{trainee:T,onView:b,onRemove:N})})]},T.id))})]})}),s.jsx(doe,{show:l,onClose:j,trainee:i,onRemoveSubject:E})]})},foe=({show:e,onClose:t,onSave:r,loading:n=!1,courseId:a})=>{const[i,o]=v.useState({courseId:a||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[l,c]=v.useState([]),[d,u]=v.useState(!1),[f,m]=v.useState([]),[h,p]=v.useState(!1);v.useEffect(()=>{e&&x()},[e]);const x=async()=>{p(!0);try{const j=await yn.getCourses();j&&j.courses?m(j.courses):Array.isArray(j)&&m(j)}catch{xe.error("Failed to load courses")}finally{p(!1)}},g=j=>{const{name:N,value:E,type:S,checked:T}=j.target;o(k=>({...k,[N]:S==="checkbox"?T:E}))},y=()=>{const j=[];return i.courseId.trim()||j.push("Course is required"),i.name.trim()||j.push("Subject name is required"),i.code.trim()||j.push("Subject code is required"),i.description.trim()||j.push("Description is required"),i.duration.trim()?(isNaN(i.duration)||parseInt(i.duration)<=0)&&j.push("Duration must be a positive number"):j.push("Duration is required"),i.passScore.trim()?(isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&j.push("Pass score must be between 0 and 100"):j.push("Pass score is required"),i.startDate.trim()||j.push("Start date is required"),i.endDate.trim()||j.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&j.push("End date must be after start date"),c(j),j.length===0},w=async j=>{if(j.preventDefault(),!!y()){u(!0);try{const N={courseId:a,name:i.name.trim(),code:i.code.trim(),description:i.description.trim(),method:i.method,duration:parseInt(i.duration),type:i.type,roomName:i.roomName.trim(),remarkNote:i.remarkNote.trim(),timeSlot:i.timeSlot.trim(),isSIM:i.isSIM,passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString()},E=await Te.post("/subjects",N);xe.success("Subject created successfully!"),r&&await r(E.data||N),b()}catch(N){const E=N.response?.data?.message||N.message||"Failed to create subject";xe.error(`Error: ${E}`),c([E])}finally{u(!1)}}},b=()=>{o({courseId:a||"",name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),u(!1),t()};return s.jsxs(ce,{show:e,onHide:b,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-2",size:20}),"Add New Subject"]}),s.jsx(se,{variant:"link",onClick:b,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[l.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((j,N)=>s.jsx("li",{children:j},N))})}),s.jsxs(F,{onSubmit:w,children:[s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Course *"}),s.jsxs(F.Select,{name:"courseId",value:i.courseId,onChange:g,required:!0,disabled:h,children:[s.jsx("option",{value:"",children:h?"Loading courses...":"Select a course"}),f.map(j=>s.jsxs("option",{value:j.id,children:[j.name," (",j.code,")"]},j.id))]})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Subject Name *"}),s.jsx(F.Control,{type:"text",name:"name",value:i.name,onChange:g,placeholder:"Enter subject name",required:!0})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Subject Code *"}),s.jsx(F.Control,{type:"text",name:"code",value:i.code,onChange:g,placeholder:"Enter subject code",required:!0})]})})]}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Description *"}),s.jsx(F.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:g,placeholder:"Enter subject description",required:!0})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Method *"}),s.jsxs(F.Select,{name:"method",value:i.method,onChange:g,required:!0,children:[s.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),s.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),s.jsx("option",{value:"ERO",children:"ERO"})]})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Duration (days) *"}),s.jsx(F.Control,{type:"number",name:"duration",value:i.duration,onChange:g,placeholder:"Enter duration in days",min:"1",required:!0})]})})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Type *"}),s.jsxs(F.Select,{name:"type",value:i.type,onChange:g,required:!0,children:[s.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),s.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Room Name"}),s.jsx(F.Control,{type:"text",name:"roomName",value:i.roomName,onChange:g,placeholder:"Enter room name"})]})})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Time Slot"}),s.jsx(F.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:g,placeholder:"e.g., 09:00-11:00"})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Pass Score *"}),s.jsx(F.Control,{type:"number",name:"passScore",value:i.passScore,onChange:g,placeholder:"Enter pass score (0-100)",min:"0",max:"100",required:!0})]})})]}),s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Start Date *"}),s.jsx(F.Control,{type:"datetime-local",name:"startDate",value:i.startDate,onChange:g,required:!0})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"End Date *"}),s.jsx(F.Control,{type:"datetime-local",name:"endDate",value:i.endDate,onChange:g,required:!0})]})})]}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Remark Note"}),s.jsx(F.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:g,placeholder:"Enter remark note"})]}),s.jsx(F.Group,{className:"mb-3",children:s.jsx(F.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:g,label:"Is Simulator"})})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(se,{variant:"secondary",onClick:b,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:w,disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"16px",height:"16px"}}),"Creating..."]}):"Create Subject"})]})]})},moe=({show:e,onClose:t,onImport:r,loading:n=!1,courseId:a})=>{const[i,o]=v.useState(!1),[l,c]=v.useState(null),[d,u]=v.useState([]),[f,m]=v.useState([]),[h,p]=v.useState([]),x=v.useRef(null),g=["code","name","course_id"],y=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date"],w=C=>{C.preventDefault(),C.stopPropagation(),C.type==="dragenter"||C.type==="dragover"?o(!0):C.type==="dragleave"&&o(!1)},b=C=>{C.preventDefault(),C.stopPropagation(),o(!1),C.dataTransfer.files&&C.dataTransfer.files[0]&&N(C.dataTransfer.files[0])},j=C=>{C.target.files&&C.target.files[0]&&N(C.target.files[0])},N=C=>{if(!C.name.match(/\.(xlsx|xls)$/)){m(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(C.size>100*1024*1024){m(["File size must be less than 100MB"]);return}c(C),m([]),E(C)},E=C=>{const A=new FileReader;A.onload=L=>{try{const _=new Uint8Array(L.target.result),W=Ul(_,{type:"array"}),Y=W.SheetNames[0],Q=W.Sheets[Y],J=ea.sheet_to_json(Q,{header:1});if(J.length<2){m(["Excel file must contain at least a header row and one data row"]);return}const U=J[0].map(z=>z?.toString().toLowerCase().trim()),ie=J.slice(1),re=g.filter(z=>!U.includes(z));if(re.length>0){m([`Missing required columns: ${re.join(", ")}`]);return}const M=ie.map((z,V)=>{const P={id:`temp_${V}`,rowNumber:V+2,code:z[U.indexOf("code")]?.toString().trim()||"",name:z[U.indexOf("name")]?.toString().trim()||"",course_id:z[U.indexOf("course_id")]?.toString().trim()||"",description:z[U.indexOf("description")]?.toString().trim()||"",method:z[U.indexOf("method")]?.toString().trim()||"THEORY",duration:z[U.indexOf("duration")]?.toString().trim()||"",type:z[U.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:z[U.indexOf("room_name")]?.toString().trim()||"",remark_note:z[U.indexOf("remark_note")]?.toString().trim()||"",time_slot:z[U.indexOf("time_slot")]?.toString().trim()||"",pass_score:z[U.indexOf("pass_score")]?.toString().trim()||"",start_date:z[U.indexOf("start_date")]?.toString().trim()||"",end_date:z[U.indexOf("end_date")]?.toString().trim()||"",hasError:!1,errors:[]};if(P.code||(P.hasError=!0,P.errors.push("Subject code is required")),P.name||(P.hasError=!0,P.errors.push("Subject name is required")),P.course_id?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(P.course_id)||(P.hasError=!0,P.errors.push("Course ID must be a valid UUID format")):(P.hasError=!0,P.errors.push("Course ID is required")),P.duration&&(isNaN(P.duration)||parseInt(P.duration)<=0)&&(P.hasError=!0,P.errors.push("Duration must be a positive number")),P.pass_score&&(isNaN(P.pass_score)||parseFloat(P.pass_score)<0||parseFloat(P.pass_score)>100)&&(P.hasError=!0,P.errors.push("Pass score must be between 0 and 100")),P.method&&!["E_LEARNING","CLASSROOM","ERO"].includes(P.method.toUpperCase())&&(P.hasError=!0,P.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO")),P.type&&!["UNLIMIT","RECURRENT"].includes(P.type.toUpperCase())&&(P.hasError=!0,P.errors.push("Type must be UNLIMIT or RECURRENT")),P.start_date){let Z;if(typeof P.start_date=="number"&&P.start_date>1e4){const oe=parseFloat(P.start_date);Z=new Date((oe-25569)*86400*1e3).toISOString().replace("T"," ").replace("Z","")}else{const oe=String(P.start_date).trim();/^\d{4}-\d{2}-\d{2}/.test(oe)?Z=oe:Z=oe.replace(/\s+(AM|PM)/gi,"").replace(/\s+/g," ").replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})/,"$3-$1-$2 $4:$5:$6")}isNaN(Date.parse(Z))?(P.hasError=!0,P.errors.push("Start date must be a valid date")):P.start_date=Z}if(P.end_date){let Z;if(typeof P.end_date=="number"&&P.end_date>1e4){const oe=parseFloat(P.end_date);Z=new Date((oe-25569)*86400*1e3).toISOString().replace("T"," ").replace("Z","")}else{const oe=String(P.end_date).trim();/^\d{4}-\d{2}-\d{2}/.test(oe)?Z=oe:Z=oe.replace(/\s+(AM|PM)/gi,"").replace(/\s+/g," ").replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})/,"$3-$1-$2 $4:$5:$6")}isNaN(Date.parse(Z))?(P.hasError=!0,P.errors.push("End date must be a valid date")):P.end_date=Z}return P}).filter(z=>z.code||z.name);u(M),p([])}catch{m(["Failed to parse Excel file. Please check the file format."])}},A.readAsArrayBuffer(C)},S=async()=>{const C=d.filter(L=>!L.hasError);if(C.length===0){m(["No valid subjects to import"]);return}const A=C.map(L=>({code:L.code,name:L.name,courseId:String(a||L.course_id),description:L.description||"",method:L.method?L.method.toUpperCase():"CLASSROOM",duration:L.duration?parseInt(L.duration):1,type:L.type?L.type.toUpperCase():"UNLIMIT",room_name:L.room_name||"",remark_note:L.remark_note||"",time_slot:L.time_slot||"",pass_score:L.pass_score?parseFloat(L.pass_score):70,start_date:L.start_date||null,end_date:L.end_date||null}));try{await r(A),T()}catch(L){m([L.message||"Failed to import subjects. Please try again."])}},T=()=>{c(null),u([]),m([]),p([]),o(!1),t()},k=C=>C==="valid"?s.jsx(dt,{className:"text-success",size:16}):s.jsx(_a,{className:"text-danger",size:16}),I=()=>{const C=[y,["MATH101","Mathematics",a||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",a||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",a||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],A=ea.aoa_to_sheet(C),L=ea.book_new();ea.book_append_sheet(L,A,"Subjects"),Gv(L,"Subject_Upload_Template.xlsx")};return s.jsxs(ce,{show:e,onHide:T,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-2",size:20}),"Bulk Import Subjects"]}),s.jsx(se,{variant:"link",onClick:T,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[f.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:f.map((C,A)=>s.jsx("li",{children:C},A))})}),s.jsx(te,{className:"mb-4",children:s.jsxs(te.Body,{children:[s.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:b,onClick:()=>x.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(eo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:x,type:"file",accept:".xlsx,.xls",onChange:j,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," Code, Name, Course ID (UUID format)"]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:I,className:"d-flex align-items-center",children:[s.jsx(Qi,{className:"me-1",size:14}),"Download Template"]}),l&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(eo,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})]})}),d.length>0&&s.jsxs(te,{children:[s.jsx(te.Header,{className:"bg-light",children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",d.length," subjects)",s.jsxs("span",{className:"ms-2",children:[s.jsx(dt,{className:"text-success me-1",size:16}),d.filter(C=>!C.hasError).length," valid",s.jsx(_a,{className:"text-danger ms-2 me-1",size:16}),d.filter(C=>C.hasError).length," invalid"]})]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:s.jsxs(qt,{hover:!0,className:"mb-0",children:[s.jsx("thead",{className:"bg-light sticky-top",children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Code"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Course ID"}),s.jsx("th",{children:"Method"}),s.jsx("th",{children:"Duration"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Pass Score"}),s.jsx("th",{children:"Errors"})]})}),s.jsx("tbody",{children:d.map((C,A)=>s.jsxs("tr",{className:C.hasError?"table-danger":"table-success",children:[s.jsx("td",{children:k(C.hasError?"invalid":"valid")}),s.jsx("td",{children:C.code}),s.jsx("td",{children:C.name}),s.jsx("td",{children:C.course_id}),s.jsx("td",{children:C.method}),s.jsx("td",{children:C.duration}),s.jsx("td",{children:C.type}),s.jsx("td",{children:C.pass_score}),s.jsx("td",{children:C.errors.length>0&&s.jsx("small",{className:"text-danger",children:C.errors.join(", ")})})]},C.id))})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:T,disabled:n,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),d.length>0&&s.jsx(se,{variant:"primary",onClick:S,disabled:n||d.filter(C=>!C.hasError).length===0,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"me-2",size:16}),"Import All (",d.filter(C=>!C.hasError).length," subjects)"]})})]})]})},hoe=({show:e,onClose:t,onSave:r,course:n,loading:a=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[l,c]=v.useState({});v.useEffect(()=>{n&&o({name:n.name||"",code:n.code||"",description:n.description||"",maxTrainees:n.maxNumTrainee||n.maxTrainees||"",venue:n.venue||"",note:n.note||"",passScore:n.passScore||"",startDate:n.startDate||"",endDate:n.endDate||"",level:n.level||"BEGINNER",status:n.status||"ACTIVE"})},[n]);const d=()=>{o({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}),t()},u=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x})),l[p]&&c(g=>({...g,[p]:""}))},f=()=>{const h={};if(i.name.trim()||(h.name="Course name is required"),i.code.trim()||(h.code="Course code is required"),i.description.trim()||(h.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(h.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(h.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(h.passScore="Pass score must be between 0 and 100"),!i.startDate)h.startDate="Start date is required";else{const p=new Date;p.setHours(0,0,0,0),new Date(i.startDate)<p&&(h.startDate="Start date cannot be in the past")}return i.endDate||(h.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(h.endDate="End date must be after start date"),c(h),Object.keys(h).length===0},m=async h=>{if(h.preventDefault(),!!f())try{const p={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},x=await Te.put(`/courses/${n.id}`,p);xe.success("Course updated successfully!"),r&&await r(x.data||p),d()}catch(p){const x=p.response?.data?.message||p.message||"Failed to update course";xe.error(`Error: ${x}`)}};return s.jsxs(ce,{show:e,onHide:d,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(ga,{className:"me-2",size:20}),"Edit Course"]}),s.jsx(se,{variant:"link",onClick:d,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(F,{onSubmit:m,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Course Name *"}),s.jsx(F.Control,{type:"text",name:"name",value:i.name,onChange:u,isInvalid:!!l.name,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.name})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Course Code *"}),s.jsx(F.Control,{type:"text",name:"code",value:i.code,onChange:u,isInvalid:!!l.code,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.code})]})})]}),s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Max Trainees *"}),s.jsx(F.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:u,isInvalid:!!l.maxTrainees,disabled:a,min:"1"}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.maxTrainees})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Pass Score (%) *"}),s.jsx(F.Control,{type:"number",name:"passScore",value:i.passScore,onChange:u,isInvalid:!!l.passScore,disabled:a,min:"0",max:"100"}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Level"}),s.jsxs(F.Select,{name:"level",value:i.level,onChange:u,disabled:a,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),s.jsxs(ge,{className:"mb-3",children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Start Date *"}),s.jsx(F.Control,{type:"date",name:"startDate",value:i.startDate,onChange:u,isInvalid:!!l.startDate,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.startDate})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"End Date *"}),s.jsx(F.Control,{type:"date",name:"endDate",value:i.endDate,onChange:u,isInvalid:!!l.endDate,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Venue *"}),s.jsx(F.Control,{type:"text",name:"venue",value:i.venue,onChange:u,isInvalid:!!l.venue,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.venue})]})})}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Description *"}),s.jsx(F.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:u,isInvalid:!!l.description,disabled:a}),s.jsx(F.Control.Feedback,{type:"invalid",children:l.description})]})})}),s.jsx(ge,{className:"mb-3",children:s.jsx(ee,{children:s.jsxs(F.Group,{children:[s.jsx(F.Label,{children:"Note"}),s.jsx(F.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:u,disabled:a})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:d,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",type:"submit",disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},poe=({course:e,department:t})=>{const r=mt(),{courseId:n}=sa();console.log(" InPageCourseDetail - courseId from URL params:",n),console.log(" InPageCourseDetail - course prop:",e),console.log(" InPageCourseDetail - department prop:",t);const[a,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,f]=v.useState(!1),[m,h]=v.useState(null),[p,x]=v.useState(!1),[g,y]=v.useState(null),[w,b]=v.useState([]),[j,N]=v.useState(!0),[E,S]=v.useState("course-info"),T=v.useCallback(async()=>{console.log(" Loading subjects...");try{const U=await Dr.getSubjects();console.log(" API Response:",U),U&&U.subjects?(console.log(" Found subjects:",U.subjects.length,"subjects"),b(U.subjects)):(console.log(" No subjects found in response"),b([]))}catch(U){console.error(" Error loading subjects:",U),console.error(" Error details:",U.response?.data),console.error(" Error status:",U.response?.status)}},[]),k=v.useCallback(async()=>{},[]);v.useEffect(()=>{k()},[n,k]),v.useEffect(()=>{(async()=>{if(n){N(!0);try{const ie=await yn.getCourseById(n),re={name:ie.name,code:ie.code,description:ie.description,maxTrainees:ie.maxNumTrainee,venue:ie.venue,note:ie.note,passScore:ie.passScore,startDate:ie.startDate?new Date(ie.startDate).toISOString().split("T")[0]:"N/A",endDate:ie.endDate?new Date(ie.endDate).toISOString().split("T")[0]:"N/A",level:ie.level,status:ie.status,department:ie.department,subjectCount:ie.subjectCount||0,traineeCount:ie.traineeCount||0,trainerCount:ie.trainerCount||0,subjects:ie.subjects||[]};y(re),N(!1)}catch{N(!1);const ie={name:e?.name||"Course Name",code:e?.code||"COURSE001",description:"Comprehensive safety procedures training covering emergency protocols, evacuation procedures, and safety equipment usage. This course ensures all personnel are equipped with essential safety knowledge and skills required for aviation operations.",maxTrainees:50,venue:"Training Center A - Room 101",note:"",passScore:80,startDate:"2024-01-15",endDate:"2024-01-29",level:"Intermediate",status:"ACTIVE"};y(ie)}}})(),T()},[n,e,T]);const I=()=>{t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(j)return s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!g)return s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h5",{className:"text-muted",children:"Course not found"}),s.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),s.jsxs(se,{variant:"primary",onClick:I,children:[s.jsx(gr,{className:"me-2"}),"Back to Department"]})]})});const C=U=>{r(`/academic/course/${n}/subject/${U}`)},A=()=>{},L=U=>{const ie=w.find(re=>re.id===U);ie&&(h(ie),f(!0))},_=async()=>{if(m){x(!0);try{await Dr.deleteSubject(m.id),await T(),f(!1),h(null)}catch(U){console.error("Error disabling subject:",U)}finally{x(!1)}}},W=()=>{r(`/academic/course/${e.id}/enroll-trainees`)},Y=async U=>{try{await Dr.createSubject({...U,courseId:n}),await T(),i(!1)}catch(ie){console.error("Error adding subject:",ie)}},Q=async U=>{try{await Dr.bulkImportSubjects(U),await T(),l(!1)}catch(ie){console.error("Error bulk importing subjects:",ie)}},J=async U=>{try{await yn.updateCourse(n,U);const ie=await yn.getCourseById(n),re={name:ie.name,code:ie.code,description:ie.description,maxTrainees:ie.maxNumTrainee,venue:ie.venue,note:ie.note,passScore:ie.passScore,startDate:ie.startDate?new Date(ie.startDate).toISOString().split("T")[0]:"N/A",endDate:ie.endDate?new Date(ie.endDate).toISOString().split("T")[0]:"N/A",level:ie.level,status:ie.status,department:ie.department,subjectCount:ie.subjectCount||0,traineeCount:ie.traineeCount||0,trainerCount:ie.trainerCount||0,subjects:ie.subjects||[]};y(re),d(!1)}catch(ie){console.error("Error updating course:",ie)}};return s.jsxs(Le,{fluid:!0,className:"py-2 course-detail",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:I,className:"me-3",children:[s.jsx(gr,{size:16,className:"me-1"}),"Back"]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-0 text-primary",children:[s.jsx("strong",{children:e.name}),"  ",e.code]}),s.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("div",{className:"d-flex",children:s.jsxs(se,{size:"sm",variant:"primary",onClick:W,children:[s.jsx(Fn,{size:14,className:"me-1"})," Enroll Trainees"]})}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(se,{size:"sm",variant:"outline-secondary",onClick:()=>d(!0),children:[s.jsx(ga,{size:14,className:"me-1"})," Edit Course"]}),s.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),s.jsxs(se,{size:"sm",variant:"primary",onClick:()=>i(!0),children:[s.jsx(wn,{size:14,className:"me-1"})," Add Subject"]}),s.jsxs(se,{size:"sm",variant:"outline-primary",onClick:()=>l(!0),children:[s.jsx(Mn,{size:14,className:"me-1"})," Import Bulk Subjects"]})]})]}),s.jsx(te,{className:"border-0 shadow-sm mb-2",children:s.jsxs(lr.Container,{activeKey:E,onSelect:S,children:[s.jsx(te.Header,{className:"border-bottom py-2",children:s.jsxs(ft,{variant:"tabs",className:"border-0",children:[s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",color:E==="course-info"?"#0d6efd":"#6c757d",fontWeight:E==="course-info"?"600":"400"},children:[s.jsx(ur,{className:"me-2",size:16}),"Course Information"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",color:E==="subjects"?"#0d6efd":"#6c757d",fontWeight:E==="subjects"?"600":"400"},children:[s.jsx(In,{className:"me-2",size:16}),"Subjects"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",color:E==="trainees"?"#0d6efd":"#6c757d",fontWeight:E==="trainees"?"600":"400"},children:[s.jsx(Fn,{className:"me-2",size:16}),"Trainees Roster"]})})]})}),s.jsx(te.Body,{className:"p-0",children:s.jsxs(lr.Content,{children:[s.jsx(lr.Pane,{eventKey:"course-info",children:s.jsx("div",{className:"p-4",children:s.jsxs(ge,{className:"g-4",children:[s.jsxs(ee,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Course Name"}),s.jsx("p",{className:"mb-0 fw-semibold",children:g.name})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Course Code"}),s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",children:g.code})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Description"}),s.jsx("p",{className:"mb-0 text-muted small",children:g.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Level"}),s.jsx(Ce,{bg:"info",className:"px-2 py-1",children:g.level})]})]}),s.jsxs(ee,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Max Number of Trainees"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fa,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"fw-semibold",children:g.maxTrainees})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Venue"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Hl,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"fw-semibold",children:g.venue})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Pass Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ml,{size:16,className:"me-2 text-primary"}),s.jsxs("span",{className:"fw-semibold",children:[g.passScore,"%"]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Status"}),s.jsx(Ce,{bg:g.status==="ACTIVE"?"success":g.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:g.status})]})]}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"Start Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"fw-semibold",children:g.startDate})]})]})}),s.jsx(ee,{md:6,children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-muted mb-2",children:"End Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"fw-semibold",children:g.endDate})]})]})})]})})}),s.jsx(lr.Pane,{eventKey:"subjects",children:s.jsx(ooe,{subjects:w,loading:!1,onView:C,onEdit:A,onDelete:L})}),s.jsx(lr.Pane,{eventKey:"trainees",style:{height:"100%"},children:s.jsx(uoe,{course:e,loading:!1,onView:U=>{console.log("View trainee:",U)},onRemove:U=>{console.log("Remove trainee:",U)}})})]})})]})}),s.jsx(foe,{show:a,onClose:()=>i(!1),onSave:Y,courseId:n}),s.jsx(moe,{show:o,onClose:()=>l(!1),onImport:Q,courseId:n}),s.jsx(hoe,{show:c,onClose:()=>d(!1),onSave:J,course:e}),s.jsx(MC,{show:u,onClose:()=>{f(!1),h(null)},onDisable:_,subject:m,loading:p})]})},xoe=()=>{const{courseId:e}=sa(),t=Si(),[r,n]=v.useState(null),[a,i]=v.useState(null),[o,l]=v.useState(!0);return v.useEffect(()=>{e&&(async()=>{try{l(!0);try{const d=await yn.getCourseById(e);n(d),d.department&&i(d.department)}catch{const u={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},f={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};n(u),i(f)}l(!1)}catch{l(!1)}})()},[e]),o?s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?s.jsx(Le,{className:"py-3",children:s.jsx(poe,{course:r,department:a})}):s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},goe=({selectedSubjects:e,onSelectionChange:t})=>{const[r,n]=v.useState(""),[a,i]=v.useState([]),[o,l]=v.useState(!0),[c,d]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),d(null);const x=await Dr.getSubjects();if(x&&x.subjects){const g=x.subjects.map(y=>({id:y.id,name:y.name,code:y.code}));i(g)}else i([])}catch{d("Failed to load subjects"),i([])}finally{l(!1)}})()},[]);const u=a.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())||p.code.toLowerCase().includes(r.toLowerCase())),f=()=>{e.length===u.length?t([]):t(u.map(p=>p.id))},m=p=>{e.includes(p)?t(e.filter(x=>x!==p)):t([...e,p])},h=u.length>0&&e.length===u.length;return s.jsxs(te,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[s.jsx(te.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),s.jsx(se,{variant:"outline-light",size:"sm",onClick:f,children:h?"Deselect All":"Select All"})]})}),s.jsxs(te.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[s.jsx("div",{className:"p-2 border-bottom",children:s.jsx(F.Control,{type:"text",placeholder:"Search subjects...",value:r,onChange:p=>n(p.target.value),size:"sm"})}),s.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0},children:o?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(Lt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?s.jsx("div",{className:"p-3 text-center text-danger",children:s.jsx("p",{className:"mb-0",children:c})}):u.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No subjects found"})}):u.map(p=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>m(p.id),children:[s.jsx("div",{className:"me-3",children:e.includes(p.id)?s.jsx(Yj,{size:20,className:"text-primary"}):s.jsx(cN,{size:20,className:"text-muted"})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:p.name,children:p.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:p.code,children:p.code})]})]},p.id))}),s.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:s.jsxs("small",{className:"text-muted",children:[e.length," of ",u.length," subjects selected"]})})]})]})},voe=({selectedTrainees:e,onSelectionChange:t})=>{const[r,n]=v.useState(""),[a,i]=v.useState(!1),[o,l]=v.useState([]),[c,d]=v.useState(!1),[u,f]=v.useState(null),m=v.useRef(null);v.useEffect(()=>{h()},[]),v.useEffect(()=>{const y=w=>{m.current&&!m.current.contains(w.target)&&i(!1)};return a&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[a]);const h=async()=>{d(!0),f(null);try{const y=await no.getTraineesForEnrollment();if(y&&y.data){const w=y.data.map(b=>({id:b.id,eid:b.eid,name:`${b.firstName} ${b.lastName}`.trim(),firstName:b.firstName,lastName:b.lastName,email:b.email,status:b.status}));l(w)}else l([])}catch{f("Failed to load trainees"),l([])}finally{d(!1)}},p=o.filter(y=>y.name.toLowerCase().includes(r.toLowerCase())||y.eid.toLowerCase().includes(r.toLowerCase())),x=y=>{e.find(w=>w.id===y.id)||t([...e,y])},g=y=>{t(e.filter(w=>w.id!==y))};return s.jsxs(te,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[s.jsx(te.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),s.jsxs(te.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[s.jsxs("div",{className:"flex-shrink-0",style:{position:"relative"},ref:m,children:[s.jsx("div",{className:"p-2 border-bottom",children:s.jsx(F.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:y=>n(y.target.value),size:"sm"})}),s.jsx("div",{className:"p-2",children:s.jsxs(se,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!a),disabled:c,children:[s.jsxs("span",{children:[s.jsx(Fn,{className:"me-2",size:16}),c?"Loading...":`Show All Available Trainees (${o.length})`]}),s.jsx(Es,{size:16})]})}),a&&s.jsx("div",{className:"border bg-white shadow-sm",style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1050,maxHeight:"200px",overflowY:"auto",borderRadius:"0 0 8px 8px"},children:c?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(Lt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):u?s.jsxs("div",{className:"p-3 text-center text-danger",children:[s.jsx("p",{className:"mb-0",children:u}),s.jsx(se,{size:"sm",variant:"outline-danger",onClick:h,className:"mt-2",children:"Retry"})]}):p.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees found"})}):p.map(y=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>x(y),children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),s.jsx(wn,{size:14,className:"text-primary flex-shrink-0"})]},y.id))})]}),s.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0},children:[s.jsx("div",{className:"p-2 bg-light border-bottom",children:s.jsxs("small",{className:"text-muted fw-semibold",children:["Selected Trainees (",e.length,")"]})}),s.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(y=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),s.jsx(se,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>g(y.id),children:s.jsx(We,{size:14})})]},y.id))})]})]})]})},yoe=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>s.jsx(Bt,{permissions:[je.SUBJECTS.VIEW_DETAIL,je.SUBJECTS.DELETE],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Subject List",icon:s.jsx(tr,{}),onClick:()=>t(e),permission:je.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:s.jsx(Ti,{}),className:"text-danger",onClick:()=>r(e.id),permission:je.SUBJECTS.DELETE}]})}),boe=({show:e,onClose:t,onConfirm:r,trainee:n,subjectName:a=null,loading:i=!1})=>{const o=!a,l=o?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=o?"Remove from All Subjects":"Remove from Subject",d=()=>{r(),t()};return s.jsxs(ce,{show:e,onHide:t,centered:!0,children:[s.jsx(ce.Header,{className:"bg-danger text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Et,{className:"me-2",size:20}),l]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",s.jsxs("strong",{children:['"',n?.name,'"']}),o?" from ALL subjects":` from "${a}"`,"?"]}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsx("strong",{children:"Trainee:"})," ",n?.name,s.jsx("br",{}),s.jsx("strong",{children:"EID:"})," ",n?.eid,!o&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("strong",{children:"Subject:"})," ",a]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[o?s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),s.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),s.jsx("li",{children:"Remove the trainee from the course completely"})]}):s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from this specific subject only"}),s.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),s.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),s.jsx("li",{children:s.jsx("strong",{children:"Cannot be undone"})})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),s.jsx(se,{variant:"danger",onClick:d,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ti,{className:"me-2",size:16}),c]})})]})]})},woe=({courseId:e,loading:t=!1})=>{const[r,n]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,f]=v.useState(!1),[m,h]=v.useState(null),[p,x]=v.useState(null),[g,y]=v.useState(!1),{sortedData:w,sortConfig:b,handleSort:j}=tn(r),N=v.useCallback(async()=>{i(!0);try{const A=await no.getTraineesForEnrollment();if(!A||!A.data){n([]);return}const L=[];for(const _ of A.data)try{const W=await yn.getTraineeEnrollments(_.id);if(W&&W.enrollments&&W.enrollments.length>0){const Y=W.enrollments.filter(Q=>Q.enrollment?.status==="ENROLLED");if(Y.length>0){const Q=Y.map(U=>U.subject.id),J={id:_.id,eid:_.eid,name:`${_.firstName} ${_.lastName}`.trim(),subjects:Q,userId:_.id,email:_.email,department:_.department};L.push(J)}}}catch{}n(L)}catch{n([])}finally{i(!1)}},[]);v.useEffect(()=>{e&&N()},[e,N]);const E=async A=>{try{const L=await yn.getTraineeEnrollments(A.userId),_=L.enrollments?.filter(Y=>Y.enrollment?.status==="ENROLLED")||[],W={...A,enrollmentDetails:L,subjects:_.map(Y=>({id:Y.subject.id,name:Y.subject.name,code:Y.subject.code,status:Y.subject.status,type:Y.subject.type,method:Y.subject.method,startDate:Y.subject.startDate,endDate:Y.subject.endDate,course:Y.subject.course,enrollment:Y.enrollment}))};d(W),l(!0)}catch{d(A),l(!0)}},S=A=>{const L=r.find(_=>_.id===A);L&&(h(L),x(null),f(!0))},T=async()=>{if(m){y(!0);try{const A=await yn.getTraineeEnrollments(m.userId);if(A&&A.enrollments&&A.enrollments.length>0){const _=A.enrollments.map(async W=>{const Y=W.subject.id,Q=W.enrollment?.batchCode||"TEST0012025";return W.enrollment?.status!=="ENROLLED"?null:Dr.removeTraineeFromSubject(Y,m.userId,Q)}).filter(W=>W!==null);_.length>0&&await Promise.all(_),await N(),f(!1)}else f(!1)}catch{}finally{y(!1)}}},k=(A,L)=>{const _=r.find(Q=>Q.id===A);if(!_)return;const W=c?.subjects?.find(Q=>Q.id===L),Y=W?W.name:"Unknown Subject";h(_),x(Y),f(!0)},I=async()=>{if(!m||!p)return;const A=c?.subjects?.find(L=>L.name===p);if(A){y(!0);try{const L=A.enrollment?.batchCode||"TEST0012025";if(A.enrollment?.status!=="ENROLLED")return;await Dr.removeTraineeFromSubject(A.id,m.userId,L),await N(),f(!1),l(!1)}catch{}finally{y(!1)}}};if(t||a)return s.jsxs(te,{className:"h-100",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h6",{className:"mb-0",children:"Enrolled Trainees"})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(Qr,{rows:4,columns:4})})]});if(r.length===0)return s.jsxs(te,{className:"h-100",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h6",{className:"mb-0",children:"Enrolled Trainees (0)"})}),s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled trainees"}),s.jsx("p",{children:"This course doesn't have any enrolled trainees yet."})]})})})]});const C=({columnKey:A,children:L,className:_=""})=>{const W=b.key===A,Y=W?b.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 ${_} ${W?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>j(A),onMouseEnter:Q=>{Q.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",Q.target.style.transform="translateY(-1px)",Q.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:Q=>{Q.target.style.backgroundColor="transparent",Q.target.style.transform="translateY(0)",Q.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:W?"700":"600"},children:L}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:Y,size:14})})]}),W&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs(s.Fragment,{children:[s.jsxs(te,{className:"d-flex flex-column mb-5",style:{height:"400px",marginBottom:"2rem",marginTop:"12rem"},children:[s.jsx(te.Header,{className:"bg-white border-bottom",style:{flexShrink:0},children:s.jsxs("h6",{className:"mb-0",children:["Enrolled Trainees (",r.length,")"]})}),s.jsx(te.Body,{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",overflowY:"auto"},children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(C,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(C,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(C,{columnKey:"subjects",className:"show-mobile",children:"Subjects"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:w.map(A=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom",children:A.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ce,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:A.eid})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fn,{size:14,className:"me-1 text-muted"}),s.jsxs(Ce,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[A.subjects.length," subjects"]})]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(yoe,{trainee:A,onViewSubjects:E,onRemoveTrainee:S})})]},A.id))})]})})})]}),s.jsxs(ce,{show:o,onHide:()=>l(!1),size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,className:"border-bottom",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Fn,{className:"me-2",size:20}),c?.name," - Enrolled Subjects"]})}),s.jsx(ce.Body,{className:"p-4",children:c&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-4 p-3 bg-light rounded",children:s.jsxs("div",{className:"row align-items-center",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h6",{className:"mb-1 text-primary",children:"Trainee Information"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ce,{bg:"secondary",className:"me-2",children:"EID"}),s.jsx("span",{className:"fw-semibold",children:c.eid})]})]}),s.jsx("div",{className:"col-md-6 text-md-end",children:s.jsx("div",{className:"text-muted small",children:s.jsxs("div",{children:["Total Subjects: ",s.jsx(Ce,{bg:"info",children:c.subjects.length})]})})})]})}),s.jsx("div",{className:"row g-3",children:c.subjects.map(A=>s.jsx("div",{className:"col-12",children:s.jsx(te,{className:"border-0 shadow-sm",children:s.jsx(te.Body,{className:"p-3",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-8",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 text-dark",children:A.name}),s.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[s.jsx(Ce,{bg:"outline-secondary",className:"text-dark border",children:A.code}),s.jsx(Ce,{bg:A.status==="ACTIVE"?"success":"secondary",children:A.status})]})]}),s.jsx(se,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{k(c.id,A.id)},children:s.jsx(We,{size:14})})]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-muted small me-2",children:"Type:"}),s.jsx(Ce,{bg:"outline-primary",className:"text-primary border",children:A.type})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-muted small me-2",children:"Method:"}),s.jsx(Ce,{bg:"outline-info",className:"text-info border",children:A.method})]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("span",{className:"text-muted small me-2",children:"Course:"}),s.jsx("span",{className:"fw-medium",children:A.course?.name})]})]}),A.enrollment&&s.jsx("div",{className:"col-md-4",children:s.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[s.jsx("h6",{className:"text-primary mb-2",children:"Enrollment Details"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-muted small",children:"Status:"}),s.jsx(Ce,{bg:"info",children:A.enrollment.status})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-muted small",children:"Batch:"}),s.jsx("span",{className:"fw-medium small",children:A.enrollment.batchCode})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-muted small",children:"Enrolled:"}),s.jsx("span",{className:"fw-medium small",children:new Date(A.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},A.id))})]})}),s.jsx(ce.Footer,{className:"border-top",children:s.jsx(se,{variant:"secondary",onClick:()=>l(!1),children:"Close"})})]}),s.jsx(boe,{show:u,onClose:()=>{f(!1),h(null),x(null),y(!1)},onConfirm:p?I:T,trainee:m,subjectName:p,loading:g})]})},joe=({show:e,onClose:t,onImport:r,loading:n=!1})=>{const[a,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState([]),[u,f]=v.useState(null),[m,h]=v.useState([]),[p,x]=v.useState([]),[g,y]=v.useState([]),[w,b]=v.useState(!1),j=v.useRef(null),N=["eid","email"],E=J=>{J.preventDefault(),J.stopPropagation(),J.type==="dragenter"||J.type==="dragover"?i(!0):J.type==="dragleave"&&i(!1)},S=J=>{J.preventDefault(),J.stopPropagation(),i(!1),J.dataTransfer.files&&J.dataTransfer.files[0]&&k(J.dataTransfer.files[0])},T=J=>{J.target.files&&J.target.files[0]&&k(J.target.files[0])},k=J=>{if(!J.name.match(/\.(xlsx|xls)$/)){x(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(J.size>100*1024*1024){x(["File size must be less than 100MB"]);return}l(J),x([]),I(J)},I=J=>{const U=new FileReader;U.onload=ie=>{try{const re=new Uint8Array(ie.target.result),M=Ul(re,{type:"array"}),z=M.SheetNames[0],V=M.Sheets[z],P=ea.sheet_to_json(V,{header:1});if(P.length<2){x(["Excel file must contain at least a header row and one data row"]);return}const Z=P[0].map(le=>le?.toString().toLowerCase().trim()),oe=P.slice(1),ye=N.filter(le=>!Z.includes(le));if(ye.length>0){x([`Missing required columns: ${ye.join(", ")}`]);return}const ae=oe.map((le,D)=>{const Ae=le[Z.indexOf("eid")]?.toString().trim()||"",Ie=le[Z.indexOf("email")]?.toString().trim()||"";return{id:`temp_${D}`,rowNumber:D+2,eid:Ae,email:Ie,hasError:!1,errors:[]}}).filter(le=>le.eid||le.email).map(le=>(le.eid||(le.hasError=!0,le.errors.push("EID is required")),le.email?/\S+@\S+\.\S+/.test(le.email)||(le.hasError=!0,le.errors.push("Email format is invalid")):(le.hasError=!0,le.errors.push("Email is required")),le));d(ae),y([])}catch{x(["Failed to parse Excel file. Please check the file format."])}},U.readAsArrayBuffer(J)},C=async()=>{const J=c.filter(U=>!U.hasError);if(J.length===0){x(["No valid identifiers to lookup"]);return}b(!0),x([]);try{const U=J.map(P=>({eid:P.eid,email:P.email}));console.log("Sending lookup request with identifiers:",U);const ie=await no.lookupTrainees(U);console.log("Lookup response:",ie),console.log("Found users:",ie.foundUsers),console.log("Not found:",ie.notFoundIdentifiers),ie.foundUsers&&ie.foundUsers.length>0&&(console.log(" First found user structure:",ie.foundUsers[0]),console.log(" All found user IDs:",ie.foundUsers.map(P=>({id:P.id,eid:P.eid,email:P.email}))));const re=(ie.foundUsers||[]).filter(P=>U.some(Z=>Z.eid===P.eid&&Z.email===P.email)),M=U.filter(P=>!re.some(Z=>Z.eid===P.eid&&Z.email===P.email)),z=re.map(P=>{if(console.log(" Validating trainee:",{id:P.id,eid:P.eid,email:P.email,firstName:P.firstName,lastName:P.lastName}),!P.id||typeof P.id!="string"||P.id.length<10)throw new Error(`Trainee ${P.eid} has invalid UUID: ${P.id}`);if(!P.firstName||!P.lastName)throw new Error(`Trainee ${P.eid} has missing name fields`);return P}),V={foundUsers:z,notFoundIdentifiers:M,uploadedIdentifiers:U};console.log("Exact matches found:",z),console.log("Not found identifiers:",M),f(V),h(z),console.log("Set selected trainees (exact matches only):",z)}catch(U){console.error("Lookup error:",U),console.error("Error response:",U.response?.data),x([U.response?.data?.message||U.message||"Failed to lookup trainees. Please try again."])}finally{b(!1)}},A=(J,U)=>{h(U?ie=>[...ie,J]:ie=>ie.filter(re=>re.id!==J.id))},L=J=>{h(J?u?.foundUsers||[]:[])},_=async()=>{if(m.length===0){x(["Please select at least one trainee to import"]);return}try{r&&await r(m),W()}catch(J){x([J.message||"Failed to import selected trainees. Please try again."])}},W=()=>{l(null),d([]),f(null),h([]),x([]),y([]),i(!1),b(!1),t()},Y=J=>J==="valid"?s.jsx(dt,{className:"text-success",size:16}):s.jsx(_a,{className:"text-danger",size:16}),Q=()=>{const J=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","jane.smith@example.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],U=ea.book_new(),ie=ea.aoa_to_sheet(J);ie["!cols"]=[{wch:15},{wch:30}],ea.book_append_sheet(U,ie,"Trainees Lookup Template"),Gv(U,"Trainees_Lookup_Template.xlsx")};return s.jsxs(ce,{show:e,onHide:W,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-2",size:20}),"Bulk Import Trainees"]}),s.jsx(se,{variant:"link",onClick:W,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[p.length>0&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:p.map((J,U)=>s.jsx("li",{children:J},U))})}),s.jsx(te,{className:"mb-4",children:s.jsxs(te.Body,{children:[s.jsxs("div",{className:`upload-area ${a?"drag-active":""}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:S,onClick:()=>j.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:a?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(eo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:j,type:"file",accept:".xlsx,.xls",onChange:T,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," eid, email"]}),s.jsx("div",{className:"mt-1",children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:Q,className:"d-flex align-items-center",children:[s.jsx(Qi,{className:"me-1",size:14}),"Download Template"]})})]}),o&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(eo,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})}),c.length>0&&s.jsxs(te,{className:"mb-4",children:[s.jsx(te.Header,{className:"bg-light",children:s.jsxs("h6",{className:"mb-0",children:["Uploaded Identifiers (",c.length," entries)",s.jsxs("span",{className:"ms-2",children:[s.jsx(dt,{className:"text-success me-1",size:16}),c.filter(J=>!J.hasError).length," valid",s.jsx(_a,{className:"text-danger ms-2 me-1",size:16}),c.filter(J=>J.hasError).length," invalid"]})]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:s.jsxs(qt,{hover:!0,className:"mb-0",children:[s.jsx("thead",{className:"bg-light sticky-top",children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"EID"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Errors"})]})}),s.jsx("tbody",{children:c.map((J,U)=>s.jsxs("tr",{className:J.hasError?"table-danger":"table-success",children:[s.jsx("td",{children:Y(J.hasError?"invalid":"valid")}),s.jsx("td",{children:J.eid}),s.jsx("td",{children:J.email}),s.jsx("td",{children:J.errors.length>0&&s.jsx("small",{className:"text-danger",children:J.errors.join(", ")})})]},J.id))})]})})}),s.jsx(te.Footer,{className:"bg-light",children:s.jsx(se,{variant:"primary",onClick:C,disabled:w||c.filter(J=>!J.hasError).length===0,className:"d-flex align-items-center",children:w?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Looking up..."]}):s.jsxs(s.Fragment,{children:[s.jsx(rx,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(J=>!J.hasError).length," valid)"]})})})]}),u&&s.jsxs(te,{children:[s.jsx(te.Header,{className:"bg-light",children:s.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",s.jsxs("span",{className:"ms-2",children:[s.jsx(dt,{className:"text-success me-1",size:16}),u.foundUsers?.length||0," matched",s.jsx(_a,{className:"text-danger ms-2 me-1",size:16}),u.notFoundIdentifiers?.length||0," not found"]})]})}),s.jsx(te.Body,{className:"p-0",children:u.foundUsers?.length>0?s.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:s.jsxs(qt,{hover:!0,className:"mb-0",children:[s.jsx("thead",{className:"bg-light sticky-top",children:s.jsxs("tr",{children:[s.jsx("th",{children:s.jsx(F.Check,{type:"checkbox",checked:m.length===(u.foundUsers?.length||0)&&(u.foundUsers?.length||0)>0,onChange:J=>L(J.target.checked)})}),s.jsx("th",{children:"EID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Phone"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Matched From Excel"})]})}),s.jsx("tbody",{children:u.foundUsers?.map(J=>u.uploadedIdentifiers?.find(ie=>ie.eid===J.eid&&ie.email===J.email)?s.jsxs("tr",{className:m.some(ie=>ie.id===J.id)?"table-success":"",children:[s.jsx("td",{children:s.jsx(F.Check,{type:"checkbox",checked:m.some(ie=>ie.id===J.id),onChange:ie=>A(J,ie.target.checked)})}),s.jsx("td",{children:J.eid}),s.jsxs("td",{children:[J.firstName," ",J.lastName]}),s.jsx("td",{children:J.email}),s.jsx("td",{children:J.phoneNumber}),s.jsx("td",{children:s.jsx(Ce,{bg:J.status==="ACTIVE"?"success":"secondary",children:J.status})}),s.jsx("td",{children:s.jsx(Ce,{bg:"success",children:" Exact Match"})})]},J.id):null).filter(Boolean)})]})}):s.jsxs("div",{className:"p-4 text-center",children:[s.jsx(_a,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),s.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),u.notFoundIdentifiers?.length>0&&s.jsx(te.Footer,{className:"bg-warning bg-opacity-10",children:s.jsxs(Ye,{variant:"warning",className:"mb-0",children:[s.jsxs("strong",{children:["Identifiers Not Found in System (",u.notFoundIdentifiers.length,"):"]}),s.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),s.jsx("ul",{className:"mb-0",children:u.notFoundIdentifiers.map((J,U)=>s.jsxs("li",{children:[s.jsx("strong",{children:J.eid})," - ",J.email]},U))})]})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:W,disabled:n,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),u&&u.foundUsers?.length>0&&m.length>0&&s.jsx(se,{variant:"primary",onClick:_,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"me-2",size:16}),"Import Selected (",m.length," matched trainees)"]})})]})]})},Noe=({show:e,onClose:t,onConfirm:r,loading:n=!1})=>{const[a,i]=v.useState(""),[o,l]=v.useState("");v.useEffect(()=>{e&&(i(""),l(""))},[e]);const c=m=>!m||m.trim()===""?"Batch code is required":m.length<3?"Batch code must be at least 3 characters long":m.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(m)?"Batch code can only contain letters, numbers, and underscores":null,d=m=>{const h=m.target.value;i(h),o&&l("")},u=()=>{const m=c(a);if(m){l(m);return}r(a.trim())},f=m=>{m.key==="Enter"&&(m.preventDefault(),u())};return s.jsxs(ce,{show:e,onHide:t,centered:!0,backdrop:"static",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsxs(ce.Title,{children:[s.jsx(Et,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),s.jsxs(ce.Body,{children:[s.jsx(F,{children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsxs(F.Label,{children:["Batch Code ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(F.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:a,onChange:d,onKeyPress:f,isInvalid:!!o,disabled:n,autoFocus:!0}),s.jsx(F.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),o&&s.jsx(F.Control.Feedback,{type:"invalid",children:o})]})}),s.jsx(Ye,{variant:"info",className:"mb-0",children:s.jsxs("small",{children:[s.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),s.jsxs(ce.Footer,{children:[s.jsx(se,{variant:"secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:u,disabled:n||!a.trim(),children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},Eoe=()=>{const e=mt(),{courseId:t}=sa(),r={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[n,a]=v.useState([]),[i,o]=v.useState([]),[l,c]=v.useState(!1),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[h,p]=v.useState(!1),[x,g]=v.useState(0),y=()=>{e(`/academic/course-detail/${t}`)},w=()=>{c(!0)},b=async E=>{if(f){console.log(" Bulk import already in progress, skipping...");return}m(!0);try{console.log(" Bulk import trainees received:",E);const S=E.map(T=>(console.log(" Processing bulk import trainee:",{id:T.id,eid:T.eid,firstName:T.firstName,lastName:T.lastName}),{id:T.id,eid:T.eid,name:`${T.firstName} ${T.lastName}`.trim(),firstName:T.firstName,lastName:T.lastName,email:T.email,phoneNumber:T.phoneNumber,status:T.status,subjects:[]}));console.log(" New trainees to add:",S),o(T=>{const k=new Set(T.map(C=>C.id)),I=S.filter(C=>!k.has(C.id));return console.log(" Existing trainee IDs:",Array.from(k)),console.log(" New unique trainees to add:",I),console.log(" Duplicates filtered out:",S.length-I.length),I.length===0&&S.length>0?setTimeout(()=>{xe.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):I.length<S.length&&I.length>0&&setTimeout(()=>{xe.warning(`Added ${I.length} new trainees. ${S.length-I.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100),[...T,...I]}),await new Promise(T=>setTimeout(T,1e3))}catch(S){throw S}finally{m(!1)}},j=()=>{if(n.length===0||i.length===0){xe.warning("Please select both subjects and trainees to enroll");return}u(!0)},N=async E=>{p(!0),u(!1);try{console.log(" Selected trainees for enrollment:",i),console.log(" Using batch code:",E);const S={batchCode:E,traineeUserIds:i.map(I=>{if(console.log(" Processing trainee:",{id:I.id,eid:I.eid,name:`${I.firstName} ${I.lastName}`}),!I.id)throw new Error(`Trainee ${I.eid} (${I.firstName} ${I.lastName}) is missing UUID`);return I.id})};console.log(" Final trainee data for API:",S),console.log(" Note: Server will validate for duplicate enrollments");const T=n.map(async I=>{if(!I)throw new Error(`Invalid subject ID: ${I}`);const C=await Dr.assignTrainees(I,S);return{subjectId:I,response:C}}),k=await Promise.all(T);console.log(" All enrollments completed successfully:",k),g(I=>I+1),o([]),a([]),xe.success(`Successfully enrolled ${i.length} trainees to ${n.length} subject(s) with batch code: ${E}`)}catch(S){let T="Failed to enroll trainees. Please try again.";S.response?.data?.message?T=S.response.data.message:S.response?.data?.errors?T=`Validation errors: ${JSON.stringify(S.response.data.errors)}`:S.message&&(T=S.message),xe.error(T)}finally{p(!1)}};return s.jsxs(Le,{fluid:!0,className:"py-4 px-4 enroll-page",children:[s.jsxs("div",{className:"d-flex flex-column",children:[s.jsxs("div",{className:"flex-shrink-0 mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:y,className:"me-3",children:[s.jsx(gr,{size:16,className:"me-1"}),"Back"]}),s.jsx("div",{children:s.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",s.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),s.jsx(te,{className:"mb-2",children:s.jsx(te.Body,{className:"py-2",children:s.jsxs(ge,{children:[s.jsx(ee,{md:8,children:s.jsx("p",{className:"mb-0 text-muted",children:r.description})}),s.jsxs(ee,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[s.jsx(se,{size:"sm",variant:"primary",onClick:j,disabled:n.length===0||i.length===0||h,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:h?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(wn,{size:12,className:"me-1"})," Enroll"]})}),s.jsxs(se,{size:"sm",variant:"outline-primary",onClick:w,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(Mn,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),s.jsx("div",{className:"mb-4",children:s.jsxs(ge,{className:"g-3",children:[s.jsx(ee,{lg:6,children:s.jsx("div",{style:{height:"500px"},children:s.jsx(goe,{selectedSubjects:n,onSelectionChange:a})})}),s.jsx(ee,{lg:6,children:s.jsx("div",{style:{height:"500px"},children:s.jsx(voe,{selectedTrainees:i,onSelectionChange:o})})})]})}),s.jsx("div",{className:"mt-4",children:s.jsx(woe,{courseId:t,loading:!1},x)})]}),s.jsx(joe,{show:l,onClose:()=>c(!1),onImport:b,loading:f}),s.jsx(Noe,{show:d,onClose:()=>u(!1),onConfirm:N,loading:h})]})},Soe=({traineeId:e,courseId:t})=>{const r=mt(),[n,a]=v.useState([]),[i,o]=v.useState(!0);v.useEffect(()=>{e&&t&&l()},[e,t]);const l=async()=>{try{o(!0);const f=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(m=>setTimeout(m,300)),a(f)}catch(f){console.error("Error loading trainee subjects:",f),xe.error("Failed to load subjects")}finally{o(!1)}},c=f=>{const h={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[f]||{variant:"secondary",text:f};return s.jsx(Ce,{bg:h.variant,children:h.text})},d=f=>{const h={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[f]||{variant:"secondary",text:f};return s.jsx(Ce,{bg:h.variant,children:h.text})},u=f=>{r(`/trainee/${e}/course/${t}/subject/${f}`)};return i?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Lt,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"mt-2 text-muted small",children:"Loading subjects..."})]}):n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ur,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No subjects found"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Code"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Name"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Level"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Duration"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Method"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:n.map((f,m)=>s.jsxs("tr",{className:`${m%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=m%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:f.code})}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:f.name}),s.jsx("small",{className:"text-muted",children:f.description})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(f.level)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("span",{className:"text-dark",children:[f.duration," hours"]})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"info",className:"fw-normal",children:f.method||"Classroom"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(f.status)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress||0}%`}})}),s.jsxs("small",{className:"text-muted",children:[f.progress||0,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>u(f.id),children:s.jsx(tr,{size:14})})})]},f.id))})]})})},LC=({traineeId:e,courseId:t})=>{const[r,n]=v.useState([]),[a,i]=v.useState(!0);v.useEffect(()=>{e&&o()},[e,t]);const o=async()=>{try{i(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(u){console.error("Error loading upcoming assessments:",u),xe.error("Failed to load upcoming assessments")}finally{i(!1)}},l=u=>{const m={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[u]||{variant:"secondary",text:u};return s.jsx(Ce,{bg:m.variant,children:m.text})},c=u=>{const m={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[u?.toUpperCase()]||{variant:"secondary",text:u};return s.jsx(Ce,{bg:m.variant,children:m.text})},d=u=>{console.log("Start assessment:",u)};return a?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Lt,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):r.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(fn,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:r.map((u,f)=>s.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:m=>{m.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:m=>{m.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:u.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:u.subject})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(u.type)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:l(u.priority)}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"text-muted me-1",size:14}),s.jsx("span",{className:"text-dark",children:new Date(u.dueDate).toLocaleDateString()})]}),s.jsx("small",{className:"text-muted",children:new Date(u.dueDate).toLocaleTimeString()})]}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsxs(se,{variant:"primary",size:"sm",onClick:()=>d(u.id),children:[s.jsx(cr,{className:"me-1",size:14}),"Start"]})})]},u.id))})]})})},_t=({title:e,sortKey:t,sortConfig:r,onSort:n})=>{const a=()=>{n(t)},i=()=>r.key===t?r.direction==="asc"?s.jsx(Xj,{size:12,className:"ms-1"}):s.jsx(Es,{size:12,className:"ms-1"}):s.jsx(Fr,{size:12,className:"ms-1"});return s.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:a,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[s.jsx("span",{className:"me-1",children:e}),i()]})},Toe=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Toe,document.head.appendChild(e)}const Xv=({traineeId:e,courseId:t,subjectId:r})=>{const[n,a]=v.useState([]),[i,o]=v.useState(!0),{sortedData:l,sortConfig:c,handleSort:d}=tn(n);v.useEffect(()=>{u()},[e,t,r]);const u=async()=>{try{o(!0);let x=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(x=x.filter(g=>g.course?.code==="SAF001")),r&&(x=x.filter(g=>g.subject?.code==="BSP")),await new Promise(g=>setTimeout(g,300)),a(x)}catch(p){console.error("Error loading completed assessments:",p),xe.error("Failed to load completed assessments")}finally{o(!1)}},f=p=>{const g={COMPLETED:{variant:"success",text:"Completed",icon:dt},PASSED:{variant:"success",text:"Passed",icon:dt},FAILED:{variant:"danger",text:"Failed",icon:Et}}[p]||{variant:"secondary",text:p,icon:dt},y=g.icon;return s.jsxs(Ce,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(y,{size:12,className:"me-1"}),g.text]})},m=(p,x)=>{const g=p/x*100;let y="success";return g<60?y="danger":g<80&&(y="warning"),s.jsxs(Ce,{bg:y,children:[p,"/",x," (",g.toFixed(0),"%)"]})},h=p=>{console.log("View completed assessment:",p.id)};return i?s.jsx("div",{className:"text-center py-4",children:s.jsx(Qr,{count:5})}):n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(dt,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Assessment",sortKey:"name",sortConfig:c,onSort:d})}),!r&&s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Subject",sortKey:"subject",sortConfig:c,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Type",sortKey:"type",sortConfig:c,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Score",sortKey:"score",sortConfig:c,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Completed Date",sortKey:"completedDate",sortConfig:c,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(_t,{title:"Status",sortKey:"status",sortConfig:c,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:l.map((p,x)=>s.jsxs("tr",{className:`${x%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor=x%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:p.name}),s.jsx("small",{className:"text-muted",children:p.description})]}),!r&&s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:p.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:p.subject?.code||""})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"primary",className:"fw-normal",children:p.type||"Assessment"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:m(p.score,p.maxScore)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:p.completedDate?new Date(p.completedDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:f(p.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Results",icon:s.jsx(dt,{}),onClick:()=>h(p)}]})})]},p.id))})]})})},_oe=({traineeId:e,courseId:t})=>{const r=mt(),[n,a]=v.useState(null),[i,o]=v.useState(null),[l,c]=v.useState(!0),[d,u]=v.useState("");v.useEffect(()=>{e&&t&&f()},[e,t]);const f=async()=>{try{c(!0),u(""),o({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),a({id:t,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(x){console.error("Error loading course details:",x),u("Failed to load course details"),xe.error("Failed to load course details")}finally{c(!1)}},m=()=>{r("/trainee/enrolled-courses")},h=x=>{const y={ACTIVE:{variant:"success",text:"Active"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[x]||{variant:"secondary",text:x};return s.jsx(Ce,{bg:y.variant,className:"fs-6",children:y.text})},p=x=>{const y={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[x]||{variant:"secondary",text:x};return s.jsx(Ce,{bg:y.variant,children:y.text})};return l?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):d||!n?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs(Ye,{variant:"danger",children:[s.jsx(Ye.Heading,{children:"Error"}),s.jsx("p",{children:d||"Course not found"}),s.jsxs(se,{variant:"outline-danger",onClick:m,children:[s.jsx(gr,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:m,className:"me-3",children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2",size:28}),n.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",i?.firstName," ",i?.lastName]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[h(n.status),p(n.level)]})]})})}),s.jsxs(ge,{children:[s.jsxs(ee,{lg:8,className:"mb-4",children:[s.jsx(ge,{children:s.jsx(ee,{className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2",size:20}),"Subject List"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(Soe,{traineeId:e,courseId:t})})]})})}),s.jsx(ge,{children:s.jsx(ee,{className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(LC,{traineeId:e,courseId:t})})]})})}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(dt,{className:"me-2",size:20}),"Completed Assessments"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(Xv,{traineeId:e,courseId:t})})]})})})]}),s.jsx(ee,{lg:4,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2",size:20}),"Enrolled Course Details"]})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Start Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"End Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Hl,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Venue"}),s.jsx("div",{className:"text-muted",children:n.venue})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fn,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Max Trainees"}),s.jsx("div",{className:"text-muted",children:n.maxNumTrainee})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Pass Score"}),s.jsxs("div",{className:"text-muted",children:[n.passScore,"%"]})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),s.jsx("div",{className:"progress",children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},Aoe=()=>{const{traineeId:e,courseId:t}=sa();return s.jsx(Le,{className:"py-3",children:s.jsx(_oe,{traineeId:e,courseId:t})})},koe=({traineeId:e,courseId:t,subjectId:r})=>{const n=mt(),[a,i]=v.useState(null),[o,l]=v.useState(null),[c,d]=v.useState(!0),[u,f]=v.useState("");v.useEffect(()=>{e&&t&&r&&m()},[e,t,r]);const m=async()=>{try{d(!0),f("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},y={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),l(y)}catch(g){console.error("Error loading subject details:",g),f("Failed to load subject details"),xe.error("Failed to load subject details")}finally{d(!1)}},h=()=>{n(`/trainee/${e}/course/${t}`)},p=g=>{const w={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return s.jsx(Ce,{bg:w.variant,className:"fs-6",children:w.text})},x=g=>{const w={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return s.jsx(Ce,{bg:w.variant,children:w.text})};return c?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):u||!a?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs(Ye,{variant:"danger",children:[s.jsx(Ye.Heading,{children:"Error"}),s.jsx("p",{children:u||"Subject not found"}),s.jsxs(se,{variant:"outline-danger",onClick:h,children:[s.jsx(gr,{className:"me-2",size:16}),"Back to Course"]})]})}):s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:h,className:"me-3",children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2",size:28}),a.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[a.code,"  ",o?.firstName," ",o?.lastName]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(a.status),x(a.level)]})]})})}),s.jsxs(ge,{children:[s.jsxs(ee,{lg:8,className:"mb-4",children:[s.jsx(ge,{children:s.jsx(ee,{className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(LC,{traineeId:e,courseId:t,subjectId:r})})]})})}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(dt,{className:"me-2",size:20}),"Completed Assessments"]})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(Xv,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),s.jsx(ee,{lg:4,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Start Date"}),s.jsx("div",{className:"text-muted",children:new Date(a.startDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fn,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"End Date"}),s.jsx("div",{className:"text-muted",children:new Date(a.endDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Duration"}),s.jsxs("div",{className:"text-muted",children:[a.duration," hours"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Hl,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Room"}),s.jsx("div",{className:"text-muted",children:a.roomName})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ya,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Trainer"}),s.jsx("div",{className:"text-muted",children:a.trainer?.name})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),s.jsx("div",{className:"progress",children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${a.progress}%`}})})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:a.description})]})]})]})})]})]})},Coe=()=>{const{traineeId:e,courseId:t,subjectId:r}=sa();return s.jsx(Le,{className:"py-3",children:s.jsx(koe,{traineeId:e,courseId:t,subjectId:r})})},Ooe=({traineeId:e})=>{const t=mt(),[r,n]=v.useState(null),[a,i]=v.useState([]),[o,l]=v.useState([]),[c,d]=v.useState([]),[u,f]=v.useState(!0),[m,h]=v.useState("");v.useEffect(()=>{e&&p()},[e]);const p=async()=>{try{f(!0),h("");const E=await no.getTraineeById(e);n(E);const S=await no.getTraineeAssessments(e);i(S.assessments||S.data||[]);const T=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],k=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];l(T),d(k)}catch(E){console.error("Error loading assessment data:",E),h("Failed to load assessment data"),xe.error("Failed to load assessment data")}finally{f(!1)}},x=()=>{t("/trainee/your-assessments")},g=E=>{const T={PENDING:{variant:"warning",text:"Pending",icon:Vt},IN_PROGRESS:{variant:"info",text:"In Progress",icon:cr},COMPLETED:{variant:"success",text:"Completed",icon:dt},OVERDUE:{variant:"danger",text:"Overdue",icon:Et}}[E]||{variant:"secondary",text:E,icon:cr},k=T.icon;return s.jsxs(Ce,{bg:T.variant,className:"d-flex align-items-center",children:[s.jsx(k,{size:12,className:"me-1"}),T.text]})},y=E=>{const T={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[E]||{variant:"secondary",text:E};return s.jsx(Ce,{bg:T.variant,children:T.text})},w=E=>{console.log("Start assessment:",E)},b=E=>{console.log("View assessment:",E)},j=E=>{console.log("Open signature pad for:",E)},N=E=>{console.log("Complete section:",E)};return u?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):m||!r?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs(Ye,{variant:"danger",children:[s.jsx(Ye.Heading,{children:"Error"}),s.jsx("p",{children:m||"Trainee not found"}),s.jsxs(se,{variant:"outline-danger",onClick:x,children:[s.jsx(gr,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:x,className:"me-3",children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2",size:28}),"Assessment Management"]}),s.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(te,{className:"border-0 shadow-sm",children:s.jsx(te.Body,{className:"p-0",children:s.jsxs(Gj,{defaultActiveKey:"pending",className:"border-bottom",children:[s.jsx(lr,{eventKey:"pending",title:"Pending Assessments",children:s.jsx("div",{className:"p-4",children:a.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(cr,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Assessment"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Priority"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:a.map(E=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.name}),s.jsx("small",{className:"text-muted",children:E.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:E.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:E.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:E.subject?.code||""})]}),s.jsx("td",{children:s.jsx(Ce,{bg:"info",className:"fw-normal",children:E.type||"Assessment"})}),s.jsx("td",{children:y(E.priority)}),s.jsx("td",{children:E.dueDate?new Date(E.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsx("div",{className:"d-flex gap-1",children:E.status==="PENDING"||E.status==="IN_PROGRESS"?s.jsx(se,{variant:"primary",size:"sm",onClick:()=>w(E.id),children:"Start"}):s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>b(E.id),children:"View"})})})]},E.id))})]})})})}),s.jsx(lr,{eventKey:"signature",title:"Signature Required",children:s.jsx("div",{className:"p-4",children:o.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(to,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Document"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:o.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.subject})}),s.jsx("td",{children:new Date(E.dueDate).toLocaleDateString()}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsxs(se,{variant:"primary",size:"sm",onClick:()=>j(E.id),children:[s.jsx(to,{className:"me-1",size:14}),"Sign"]})})]},E.id))})]})})})}),s.jsx(lr,{eventKey:"completion",title:"Section Completion",children:s.jsx("div",{className:"p-4",children:c.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(dt,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Section"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Progress"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:c.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:E.subject})}),s.jsx("td",{children:s.jsx(Ce,{bg:"info",className:"fw-normal",children:E.section})}),s.jsx("td",{children:new Date(E.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${E.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[E.progress,"%"]})]})}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:s.jsx(se,{variant:"primary",size:"sm",onClick:()=>N(E.id),children:E.status==="COMPLETED"?"View":"Complete"})})]},E.id))})]})})})})]})})})})})]})},Poe=()=>{const{traineeId:e}=sa();return s.jsx(Le,{className:"py-3",children:s.jsx(Ooe,{traineeId:e})})},Doe=({show:e,onClose:t,onSave:r,documentName:n,loading:a=!1})=>{const i=v.useRef(null),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,f]=v.useState("");v.useEffect(()=>{e&&(d(!1),f(""),m())},[e]);const m=()=>{const w=i.current;w&&(w.getContext("2d").clearRect(0,0,w.width,w.height),d(!1))},h=w=>{l(!0);const b=i.current,j=b.getBoundingClientRect(),N=b.getContext("2d");N.beginPath(),N.moveTo(w.clientX-j.left,w.clientY-j.top)},p=w=>{if(!o)return;const b=i.current,j=b.getBoundingClientRect(),N=b.getContext("2d");N.lineTo(w.clientX-j.left,w.clientY-j.top),N.stroke(),d(!0)},x=()=>{l(!1)},g=async()=>{if(!c){f("Please provide your signature before saving");return}try{const b=i.current.toDataURL("image/png");await r({documentName:n,signature:b,timestamp:new Date().toISOString()}),t()}catch{f("Failed to save signature. Please try again.")}},y=()=>{m(),f(""),t()};return s.jsxs(ce,{show:e,onHide:y,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(to,{className:"me-2",size:20}),"Digital Signature"]}),s.jsx(se,{variant:"link",onClick:y,className:"text-white p-0",children:s.jsx(We,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[u&&s.jsx(Ye,{variant:"danger",className:"mb-3",children:u}),s.jsxs("div",{className:"text-center mb-4",children:[s.jsxs("h5",{children:["Sign Document: ",n]}),s.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),s.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:s.jsx("canvas",{ref:i,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:h,onMouseMove:p,onMouseUp:x,onMouseLeave:x,onTouchStart:w=>{w.preventDefault();const b=w.touches[0],j=new MouseEvent("mousedown",{clientX:b.clientX,clientY:b.clientY});h(j)},onTouchMove:w=>{w.preventDefault();const b=w.touches[0],j=new MouseEvent("mousemove",{clientX:b.clientX,clientY:b.clientY});p(j)},onTouchEnd:w=>{w.preventDefault(),x()}})}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs(se,{variant:"outline-secondary",onClick:m,disabled:a,children:[s.jsx(Kj,{className:"me-2",size:16}),"Clear"]}),s.jsx("div",{className:"text-muted small",children:c?s.jsx("span",{className:"text-success",children:" Signature captured"}):s.jsx("span",{children:"Please sign above"})})]}),s.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Sign within the designated area"}),s.jsx("li",{children:"Use your full legal signature"}),s.jsx("li",{children:"Ensure the signature is clear and readable"}),s.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:y,disabled:a,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:g,disabled:a||!c,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Oa,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Ioe=()=>{const{traineeId:e,documentId:t}=sa();return s.jsx(Le,{className:"py-3",children:s.jsx(Doe,{show:!0,documentName:`Document ${t}`,onClose:()=>window.history.back(),onSave:r=>{console.log("Signature saved:",r)}})})},Roe=({traineeId:e,sectionId:t})=>{const r=mt(),[n,a]=v.useState(null),[i,o]=v.useState(!0),[l,c]=v.useState("");v.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{o(!0),c(""),a({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(p){console.error("Error loading section details:",p),c("Failed to load assessment section details"),xe.error("Failed to load assessment section details")}finally{o(!1)}},u=()=>{r("/trainee/your-assessments")},f=p=>{const g={PENDING:{variant:"warning",text:"Pending",icon:Vt},IN_PROGRESS:{variant:"info",text:"In Progress",icon:cr},COMPLETED:{variant:"success",text:"Completed",icon:dt},OVERDUE:{variant:"danger",text:"Overdue",icon:Et}}[p]||{variant:"secondary",text:p,icon:cr},y=g.icon;return s.jsxs(Ce,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(y,{size:12,className:"me-1"}),g.text]})},m=()=>{console.log("Start assessment section:",t)},h=()=>{console.log("Continue assessment section:",t)};return i?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):l||!n?s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs(Ye,{variant:"danger",children:[s.jsx(Ye.Heading,{children:"Error"}),s.jsx("p",{children:l||"Assessment section not found"}),s.jsxs(se,{variant:"outline-danger",onClick:u,children:[s.jsx(gr,{className:"me-2",size:16}),"Back to Assessments"]})]})}):s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:u,className:"me-3",children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2",size:28}),n.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[n.course,"  ",n.subject]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[f(n.status),s.jsx(Ce,{bg:"info",className:"fw-normal",children:n.type})]})]})})}),s.jsxs(ge,{children:[s.jsx(ee,{lg:8,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2",size:20}),"Assessment Section Details"]})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:n.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:n.instructions.map((p,x)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),p]},x))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Questions Overview"}),s.jsx("div",{className:"row",children:n.questions.map((p,x)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs("div",{className:`p-3 border rounded ${p.isAnswered||p.isCompleted?"bg-light":""}`,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Question ",x+1]}),p.isAnswered||p.isCompleted?s.jsx(Ce,{bg:"success",className:"small",children:"Completed"}):s.jsx(Ce,{bg:"warning",className:"small",children:"Pending"})]}),s.jsx("p",{className:"mb-0 small text-muted",children:p.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},p.id))})]}),s.jsx("div",{className:"d-flex justify-content-center",children:n.status==="PENDING"?s.jsxs(se,{variant:"primary",size:"lg",onClick:m,children:[s.jsx(tx,{className:"me-2",size:20}),"Start Assessment"]}):s.jsxs(se,{variant:"primary",size:"lg",onClick:h,children:[s.jsx(cr,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),s.jsx(ee,{lg:4,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Vt,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[n.timeLimit," minutes"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.dueDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(cr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Total Questions"}),s.jsx("div",{className:"text-muted",children:n.questions.length})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),s.jsx(fm,{now:n.progress,variant:"primary",className:"mb-3"}),s.jsx("div",{className:"text-center",children:s.jsxs("small",{className:"text-muted",children:[n.questions.filter(p=>p.isAnswered||p.isCompleted).length," of ",n.questions.length," questions completed"]})})]}),s.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Read questions carefully"}),s.jsx("li",{children:"Manage your time wisely"}),s.jsx("li",{children:"Save progress regularly"}),s.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},Foe=()=>{const{traineeId:e,sectionId:t}=sa();return s.jsx(Le,{className:"py-3",children:s.jsx(Roe,{traineeId:e,sectionId:t})})},Moe=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Moe,document.head.appendChild(e)}const zj=()=>{const e=mt(),t=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Ya,path:"/trainee/academic-details",color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:ur,path:"/trainee/enrolled-courses",color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:cr,path:"/trainee/your-assessments",color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Et,path:"/trainee/create-incident-feedback-report",color:"danger"}];return s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("h3",{className:"mb-3",children:"Quick Actions"})})}),s.jsx(ge,{children:t.map((r,n)=>{const a=r.icon;return s.jsx(ee,{lg:6,xl:3,className:"mb-4",children:s.jsx(te,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(te.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(a,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:r.title})}),s.jsx(Ji,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},n)})}),s.jsxs(ge,{className:"mt-4",children:[s.jsx(ee,{lg:6,className:"d-flex",children:s.jsxs(te,{className:"border-0 shadow-sm w-100 training-progress-card",children:[s.jsx(te.Header,{children:s.jsx("h5",{className:"mb-0",children:"Training Progress"})}),s.jsx(te.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),s.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),s.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),s.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),s.jsx(ee,{lg:6,className:"d-flex",children:s.jsxs(te,{className:"border-0 shadow-sm w-100 assessments-card",children:[s.jsx(te.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),s.jsx(te.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(cr,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No assessments pending"}),s.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/assessment-pending/signature-required"),className:"d-flex align-items-center justify-content-center mx-auto",children:[s.jsx(cr,{size:16,className:"me-2"}),"Go to Assessments",s.jsx(Ji,{size:16,className:"ms-2"})]})]})})]})})]})]})},Loe=()=>{const e=mt(),{user:t}=mn(),[r,n]=v.useState(!0),[a,i]=v.useState(null);v.useEffect(()=>{o()},[]);const o=async()=>{try{n(!0);const d={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(u=>setTimeout(u,500)),i(d)}catch(d){console.error("Error loading academic data:",d)}finally{n(!1)}},l=d=>{switch(d){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=d=>{switch(d){case"completed":return s.jsx(dt,{className:"text-success"});case"in-progress":return s.jsx(Vt,{className:"text-warning"});case"pending":return s.jsx(Vt,{className:"text-muted"});default:return s.jsx(Vt,{className:"text-muted"})}};return r?s.jsx(Le,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):a?s.jsxs(Le,{className:"py-4 academic-details",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Academic Details"}),s.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{lg:3,md:6,className:"mb-3",children:s.jsx(te,{className:"border-0 shadow-sm h-100",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(ur,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:a.totalCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),s.jsx(ee,{lg:3,md:6,className:"mb-3",children:s.jsx(te,{className:"border-0 shadow-sm h-100",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(dN,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:a.completedCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),s.jsx(ee,{lg:3,md:6,className:"mb-3",children:s.jsx(te,{className:"border-0 shadow-sm h-100",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Vt,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:a.inProgressCourses}),s.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),s.jsx(ee,{lg:3,md:6,className:"mb-3",children:s.jsx(te,{className:"border-0 shadow-sm h-100",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(cr,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:a.completedAssessments}),s.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),s.jsx(ge,{className:"mb-5",children:s.jsx(ee,{children:s.jsxs(te,{className:"border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"text-center mb-3",children:[s.jsxs("h2",{className:"text-primary mb-1",children:[a.overallProgress,"%"]}),s.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),s.jsx(fm,{now:a.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),s.jsx(ge,{className:"text-center",children:s.jsx(ee,{children:s.jsxs("small",{className:"text-muted",children:[a.completedCourses," of ",a.totalCourses," courses completed"]})})})]})]})})}),s.jsxs(ge,{className:"mt-4",children:[s.jsx(ee,{lg:8,className:"mb-4 pe-3",children:s.jsxs(te,{className:"border-0 shadow-sm h-100",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(ur,{className:"me-2"}),"Course Progress"]})}),s.jsx(te.Body,{children:a.courses.map(d=>s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:d.name}),s.jsx("small",{className:"text-muted",children:d.code})]}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx(Ce,{variant:l(d.status),children:d.status.replace("-"," ")})})]}),s.jsx(fm,{now:d.progress,variant:d.progress===100?"success":"primary",style:{height:"8px"}}),s.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[s.jsxs("small",{className:"text-muted",children:[d.progress,"% complete"]}),d.status==="completed"&&s.jsxs("small",{className:"text-success",children:["Completed: ",new Date(d.completedDate).toLocaleDateString()]})]})]},d.id))})]})}),s.jsx(ee,{lg:4,className:"mb-4 ps-3",children:s.jsxs(te,{className:"border-0 shadow-sm h-100",children:[s.jsx(te.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(cr,{className:"me-2"}),"Recent Assessments"]})}),s.jsx(te.Body,{children:a.recentAssessments.map(d=>s.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[s.jsx("h6",{className:"mb-1",children:d.name}),c(d.status)]}),s.jsx("small",{className:"text-muted d-block mb-1",children:d.course}),d.status==="completed"?s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs(Ce,{variant:"success",children:["Score: ",d.score]}),s.jsx("small",{className:"text-muted",children:new Date(d.completedDate).toLocaleDateString()})]}):s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx(Ce,{variant:"warning",children:"Pending"}),s.jsxs("small",{className:"text-muted",children:["Due: ",new Date(d.dueDate).toLocaleDateString()]})]})]},d.id))})]})})]})]}):s.jsx(Le,{className:"py-4",children:s.jsx(Ye,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},Boe=()=>{const{user:e}=mn();return e?s.jsx(Le,{className:"py-3",children:s.jsx(Loe,{})}):s.jsx(Le,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your academic details."})})})},Uj=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:n,onLevelToggle:a,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||n.length>0;return s.jsxs(dn,{className:`filter-panel-dropdown course-filter-dropdown ${l}`,children:[s.jsx(dn.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(go,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+n.length})]})}),s.jsxs(dn.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>a("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(F.Check,{type:"checkbox",id:`level-${d}`,label:d,checked:r.includes(d),onChange:()=>a(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),n.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(F.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:n.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(We,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},BC=document.createElement("style");BC.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(BC);const $oe=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=$oe,document.head.appendChild(e)}const zoe=({traineeId:e})=>{const t=mt(),[r,n]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(""),[c,d]=v.useState([]),[u,f]=v.useState([]),[m,h]=v.useState("upcoming"),p=[...new Set(r.map(_=>_.level).filter(Boolean))],x=[...new Set(r.map(_=>_.status).filter(Boolean))],g=_=>r.filter(W=>{switch(_){case"upcoming":return W.status==="PLANNED";case"ongoing":return W.status==="ON-GOING";case"completed":return W.status==="COMPLETED";default:return!0}}),y=g(m),w=v.useMemo(()=>y.filter(_=>{const W=!o||_.name.toLowerCase().includes(o.toLowerCase())||_.code.toLowerCase().includes(o.toLowerCase())||_.description.toLowerCase().includes(o.toLowerCase()),Y=c.length===0||c.includes(_.level),Q=u.length===0||u.includes(_.status);return W&&Y&&Q}),[y,o,c,u]),{sortedData:b,sortConfig:j,handleSort:N}=tn(w);v.useEffect(()=>{e&&E()},[e]);const E=async()=>{try{i(!0);const _=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ON-GOING",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}},{id:"5",code:"NAV005",name:"Navigation Systems",description:"Advanced navigation and GPS systems",level:"ADVANCED",status:"COMPLETED",startDate:"2023-09-01T09:00:00.000Z",endDate:"2023-10-15T17:00:00.000Z",progress:100,department:{id:5,name:"Navigation Department",code:"NAV"}},{id:"6",code:"COMM006",name:"Communication Protocols",description:"Radio communication and protocols",level:"BEGINNER",status:"PLANNED",startDate:"2024-04-01T09:00:00.000Z",endDate:"2024-06-01T17:00:00.000Z",progress:0,department:{id:6,name:"Communication Department",code:"COMM"}},{id:"7",code:"MAINT007",name:"Aircraft Maintenance",description:"Routine maintenance procedures",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-01-20T08:00:00.000Z",endDate:"2024-03-20T16:00:00.000Z",progress:60,department:{id:7,name:"Maintenance Department",code:"MAINT"}},{id:"8",code:"ARCH008",name:"Archived Course",description:"This course has been archived",level:"BEGINNER",status:"ARCHIVED",startDate:"2023-06-01T09:00:00.000Z",endDate:"2023-08-01T17:00:00.000Z",progress:100,department:{id:8,name:"Archived Department",code:"ARCH"}}];await new Promise(W=>setTimeout(W,300)),n(_)}catch(_){console.error("Error loading trainee courses:",_),xe.error("Failed to load enrolled courses")}finally{i(!1)}},S=_=>{const Y={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[_]||{variant:"secondary",text:_};return s.jsx(Ce,{bg:Y.variant,children:Y.text})},T=_=>{const Y={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[_]||{variant:"secondary",text:_};return s.jsx(Ce,{bg:Y.variant,children:Y.text})},k=_=>{t(`/trainee/${e}/course/${_.id}`)},I=_=>{d(_==="clear"?[]:W=>W.includes(_)?W.filter(Y=>Y!==_):[...W,_])},C=_=>{f(_==="clear"?[]:W=>W.includes(_)?W.filter(Y=>Y!==_):[...W,_])},A=()=>{d([]),f([]),l("")},L=({columnKey:_,children:W,className:Y=""})=>{const Q=j.key===_,J=Q?j.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${Y} ${Q?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>N(_),onMouseEnter:U=>{U.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",U.target.style.transform="translateY(-1px)",U.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:U=>{U.target.style.backgroundColor="transparent",U.target.style.transform="translateY(0)",U.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:Q?"600":"500"},children:W}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:J,size:14})})]}),Q&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return a?s.jsx(Qr,{rows:5,columns:8}):r.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled courses"}),s.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):w.length===0&&(o||c.length>0||u.length>0)?s.jsx("div",{children:s.jsxs(lr.Container,{activeKey:m,onSelect:h,children:[s.jsxs(ft,{variant:"tabs",className:"mb-3",children:[s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[s.jsx(mh,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[s.jsx(dt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),s.jsx(lr.Content,{children:s.jsxs(lr.Pane,{eventKey:m,children:[s.jsxs(ge,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Uj,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:I,onStatusToggle:C,onClearFilters:A,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or filters."}),s.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:A,children:"Clear Filters"})]})})]})})]})}):s.jsx("div",{children:s.jsxs(lr.Container,{activeKey:m,onSelect:h,children:[s.jsxs(ft,{variant:"tabs",className:"mb-3",children:[s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[s.jsx(Vt,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[s.jsx(mh,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(ft.Item,{children:s.jsxs(ft.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[s.jsx(dt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),s.jsx(lr.Content,{children:s.jsxs(lr.Pane,{eventKey:m,children:[s.jsxs(ge,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Uj,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:I,onStatusToggle:C,onClearFilters:A,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),s.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(L,{columnKey:"code",className:"show-mobile",children:"Course Code"}),s.jsx(L,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(L,{columnKey:"level",className:"show-mobile",children:"Level"}),s.jsx(L,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(L,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),s.jsx(L,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),s.jsx(L,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:b.map((_,W)=>s.jsxs("tr",{className:`${W%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:Y=>{Y.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:Y=>{Y.currentTarget.style.backgroundColor=W%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:_.code})}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:_.name}),s.jsx("small",{className:"text-muted",children:_.description})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:T(_.level)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:S(_.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:_.startDate?new Date(_.startDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:_.endDate?new Date(_.endDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${_.progress||0}%`}})}),s.jsxs("small",{className:"text-muted",children:[_.progress||0,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.COURSES.VIEW_DETAIL],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"View Course Details",icon:s.jsx(tr,{}),onClick:()=>k(_),permission:je.COURSES.VIEW_DETAIL}]})})})]},_.id))})]})})]})})]})})},Uoe=()=>{const{user:e}=mn();return e?s.jsx(Le,{className:"py-3",children:s.jsx(zoe,{traineeId:e.id})}):s.jsx(Le,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Woe=({show:e,onHide:t,onImportSuccess:r,onImportError:n})=>{const a=mt(),[i,o]=v.useState("with-fields"),[l,c]=v.useState(null),[d,u]=v.useState(!1),f=v.useRef(null),m=g=>{const y=g.target.files[0];if(y){const w=[".docx"],b=y.name.toLowerCase().substring(y.name.lastIndexOf("."));if(!w.includes(b)){xe.error("Please select a valid Word document file (.docx)");return}if(y.size>10*1024*1024){xe.error("File size must be less than 10MB");return}c(y)}},h=async()=>{if(!l){xe.error("Please select a file to import");return}u(!0);try{const g=N1.getDocsType(l.name),y=await N1.uploadDocument(l,g);let w;if(y.data&&y.data.length>0&&y.data[0].url)w=y.data[0].url,console.log(` Form Template Upload Success! Document URL: ${w}`);else throw new Error("Invalid response format from upload API");a("/admin/forms/editor",{state:{documentUrl:w,fileName:l.name.replace(".docx",""),importType:i==="with-fields"?"File with fields":"File without fields"}}),p(),r(i==="with-fields"?"File with fields":"File without fields",l.name)}catch(g){n(g.message||"Import failed")}finally{u(!1)}},p=()=>{c(null),o("with-fields"),f.current&&(f.current.value=""),t()},x=g=>{xe.info(`Downloading ${g} template...`)};return s.jsxs(ce,{show:e,onHide:p,size:"lg",centered:!0,className:"import-file-modal",children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-2",size:20}),"Import Form File"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),s.jsxs(ge,{className:"g-3",children:[s.jsx(ee,{md:6,children:s.jsx(te,{className:`h-100 cursor-pointer ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("with-fields"),style:{cursor:"pointer"},children:s.jsx(te.Body,{className:"text-center p-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-between",children:[s.jsxs("div",{children:[s.jsx(Qp,{size:48,className:"text-primary mb-3"}),s.jsx("h6",{className:"text-primary",children:"File with Fields"}),s.jsx("p",{className:"text-muted small mb-3",children:"Import a Word document that already contains predefined form fields and structure. The system will automatically parse and create form templates."})]}),s.jsx("div",{className:"mt-auto",children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:g=>{g.stopPropagation(),x("with-fields")},children:[s.jsx(Qi,{className:"me-1",size:14}),"Download Template"]})})]})})})}),s.jsx(ee,{md:6,children:s.jsx(te,{className:`h-100 cursor-pointer ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("without-fields"),style:{cursor:"pointer"},children:s.jsx(te.Body,{className:"text-center p-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-between",children:[s.jsxs("div",{children:[s.jsx(cd,{size:48,className:"text-success mb-3"}),s.jsx("h6",{className:"text-success",children:"File without Fields"}),s.jsx("p",{className:"text-muted small mb-3",children:"Import a raw Word document without predefined structure. You will manually define form fields and mapping after import."})]}),s.jsx("div",{className:"mt-auto",children:s.jsxs(se,{variant:"outline-success",size:"sm",onClick:g=>{g.stopPropagation(),x("without-fields")},children:[s.jsx(Qi,{className:"me-1",size:14}),"Download Template"]})})]})})})})]})]}),!i&&s.jsxs(Ye,{variant:"info",className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),s.jsx("p",{className:"mb-0 small",children:'Choose between "File with Fields" or "File without Fields" above to continue with the import process.'})]}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),s.jsxs(F.Group,{children:[s.jsx(F.Control,{ref:f,type:"file",accept:".docx",onChange:m,className:"mb-2"}),s.jsx(F.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),l&&s.jsx(Ye,{variant:"info",className:"mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(cd,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",l.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(l.size/1024/1024).toFixed(2)," MB"]})]})]})}),s.jsxs(Ye,{variant:"light",className:"mb-0",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Import Instructions"}),i==="with-fields"?s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Automatic Processing:"})," System will parse Word document and create form templates automatically"]}),s.jsx("li",{children:"Document should contain predefined form fields and structure"}),s.jsx("li",{children:"Form fields will be automatically mapped and validated"}),s.jsx("li",{children:"Content will be converted to editable form template"}),s.jsx("li",{children:"Download the template above for the correct format"})]}):s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Manual Processing:"})," You will manually define form fields and structure"]}),s.jsx("li",{children:"Document content will be parsed and converted to editable format"}),s.jsx("li",{children:"Use merge field buttons to add dynamic fields to the content"}),s.jsx("li",{children:"Perfect for documents that need custom field mapping"}),s.jsx("li",{children:"Full control over form structure and field placement"})]})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:p,disabled:d,children:[s.jsx(We,{className:"me-2",size:16}),"Cancel"]}),i&&s.jsx(se,{variant:"primary-custom",onClick:h,disabled:!l||d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"me-2",size:16}),"Import File"]})})]})]})},Hoe=()=>{const e=mt(),[t,r]=v.useState(!1),n=()=>{r(!0)},a=()=>{e("/admin/forms/editor",{state:{content:'<h1 style="text-align: center;">New Form</h1><p>Start creating your form here...</p>',fileName:"New Form",importType:"New Form"}})},i=(l,c)=>{xe.success(`${l} file "${c}" imported successfully!`),r(!1)},o=l=>{xe.error(`Import failed: ${l}`)};return s.jsx(Le,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(te,{className:"border-neutral-200 shadow-sm",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ge,{className:"align-items-center",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(In,{className:"me-2 text-primary-custom",size:24}),s.jsx("h4",{className:"mb-0 text-primary-custom",children:"Form Templates"})]})})})}),s.jsxs(te.Body,{children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(cd,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No form templates found"}),s.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."}),s.jsxs("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[s.jsx(Bt,{permission:je.TEMPLATES.CREATE,fallback:null,children:s.jsxs(se,{variant:"outline-primary",onClick:a,className:"d-flex align-items-center",children:[s.jsx(wn,{className:"me-2",size:16}),"Create New Form"]})}),s.jsx(Bt,{permission:je.TEMPLATES.CREATE,fallback:null,children:s.jsxs(se,{variant:"primary-custom",onClick:n,className:"d-flex align-items-center",children:[s.jsx(Mn,{className:"me-2",size:16}),"Import File"]})})]})]})})}),s.jsx(Woe,{show:t,onHide:()=>r(!1),onImportSuccess:i,onImportError:o})]})]})})},$C=[{name:"customer_name",label:"Customer Name",category:"customer"},{name:"invoice_total",label:"Invoice Total",category:"financial"},{name:"invoice_date",label:"Invoice Date",category:"date"},{name:"company_name",label:"Company Name",category:"company"},{name:"address",label:"Address",category:"location"},{name:"phone",label:"Phone",category:"contact"},{name:"email",label:"Email",category:"contact"},{name:"signature",label:"Signature",category:"signature"}];[...$C];const Voe=({mergeFields:e=[],onInsertField:t,readOnly:r=!1,className:n="",showCategories:a=!1,selectedCategory:i=null})=>{const o=e.length>0?e:$C;return s.jsxs("div",{className:`p-3 bg-light merge-fields-panel ${n}`,children:[s.jsx("h6",{className:"mb-3 text-muted",children:"Merge Fields"}),s.jsx("div",{className:"d-grid gap-2",children:o.map(l=>s.jsx(se,{variant:"outline-secondary",size:"sm",className:"text-start d-flex align-items-center",onClick:()=>t(l.name),disabled:r,children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold",children:l.label}),s.jsx("small",{className:"text-muted",children:l.name})]})},l.name))}),s.jsxs(Ye,{variant:"info",className:"mt-3 mb-0",style:{fontSize:"0.8rem"},children:[s.jsx("strong",{children:"Tip:"})," Click any field to insert it into your document. Merge fields will be replaced with actual data when the form is used."]})]})},Goe=({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,mergeFields:n=[],showMergeFields:a=!0,showImportInfo:i=!1,importType:o="",className:l=""})=>{const[c,d]=v.useState(!0),[u,f]=v.useState(null),[m,h]=v.useState(!1),p=v.useRef(!1),x=v.useRef(null),g=v.useCallback(()=>{if(p.current=!1,x.current)try{typeof x.current.destroy=="function"&&x.current.destroy()}catch(j){console.warn("Error destroying editor:",j)}},[]);v.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const y="bd9aaaaddaf94061b51e976a8fd335ce",w=async j=>{try{const E=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),S=btoa(JSON.stringify(j)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),T=`${E}.${S}`,k=new TextEncoder,I=await crypto.subtle.importKey("raw",k.encode(y),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),C=await crypto.subtle.sign("HMAC",I,k.encode(T)),A=btoa(String.fromCharCode(...new Uint8Array(C))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),L=`${E}.${S}.${A}`;return console.log(" Generated JWT Token (Hardcoded):",L),L}catch(N){return console.error("Error generating JWT token:",N),null}};v.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),d(!1);return}if(p.current){console.log(" Editor already initialized, skipping...");return}return p.current=!0,(async()=>{try{let N=0;const E=10;await new Promise((_,W)=>{const Y=()=>{typeof window.DocsAPI<"u"?_():N<E?(N++,console.log(` Waiting for OnlyOffice API... (${N}/${E})`),setTimeout(Y,500)):W(new Error("OnlyOffice API failed to load after 5 seconds"))};Y()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const T=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,I=await w({document:{key:T,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"}}}),C={document:{fileType:"docx",key:T,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!1,comments:!1,help:!1,hideRightMenu:!1},mode:"edit"},token:I,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),h(!0),xe.success("Document editor loaded successfully!")},onDocumentReady:()=>{console.log(" Document is loaded"),xe.success("Document loaded successfully!")},onError:_=>{console.error(" OnlyOffice Error:",_),xe.error("Error loading document: "+_.data?.errorDescription||"Unknown error")},onDocumentStateChange:_=>{console.log(" Document state changed:",_)},onInfo:_=>{console.log(" OnlyOffice opened in mode:",_.data?.mode)}}},A=new window.DocsAPI.DocEditor("onlyoffice-editor",C);f(A),x.current=A,d(!1);const L=_=>{_.data&&_.data.type==="insertText"&&console.log(" Received insert text message:",_.data)};return window.addEventListener("message",L,{passive:!0}),()=>{window.removeEventListener("message",L)}}catch(N){console.error("Error initializing OnlyOffice editor:",N),xe.error("Failed to initialize editor"),d(!1)}})(),g},[e,t,g]);const b=j=>{if(u&&m)try{console.log(" Attempting to insert field at cursor position:",j),console.log(" Editor debug info:",{editor:!!u,isEditorReady:m,editorMethods:Object.getOwnPropertyNames(u),hasInsertTextAtCursor:typeof u.insertTextAtCursor,hasInsertText:typeof u.insertText,hasExecuteCommand:typeof u.executeCommand,hasServiceCommand:typeof u.serviceCommand});try{const N=document.getElementById("onlyoffice-editor");if(N&&N.contentWindow){N.focus(),console.log(" Focused editor iframe");const E=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:N.contentWindow,passive:!0});N.contentWindow.dispatchEvent(E),console.log(" Clicked inside editor")}}catch(N){console.log(" Failed to focus editor:",N)}if(typeof u.createConnector=="function")try{const N=u.createConnector();if(console.log(" Created connector:",N),console.log(" Connector methods:",N?Object.getOwnPropertyNames(N):"No connector"),console.log(" Connector prototype methods:",N?Object.getOwnPropertyNames(Object.getPrototypeOf(N)):"No connector"),console.log(" Connector events:",N.events),console.log(" Connector isConnected:",N.isConnected),console.log(" Connector frame:",N.frame),typeof u.asc_enableKeyEvents=="function")try{u.asc_enableKeyEvents(!0),console.log(" Enabled key events for focus")}catch(E){console.log(" Failed to enable key events:",E)}if(setTimeout(()=>{console.log(" Connector ready after delay")},100),N&&N.isConnected)try{console.log(" Using OnlyOffice Automation API - callCommand (Official method)..."),Asc.scope.fieldName=j,N.callCommand(function(){const E=Api.GetDocument(),S=Api.CreateParagraph();S.AddText(`{{${Asc.scope.fieldName}}}`),E.InsertContent([S])},function(){console.log(" Used OnlyOffice Automation API - callCommand successfully"),requestAnimationFrame(()=>{xe.success(`Inserted {{${j}}} field at cursor position`)})});return}catch(E){console.log(" OnlyOffice Automation API - callCommand failed:",E),xe.error("Failed to insert field using OnlyOffice Automation API")}}catch(N){console.log(" createConnector failed:",N)}}catch(N){console.error("Error inserting field:",N),xe.error("Failed to insert field: "+N.message)}else u?m||xe.warning("Editor is still loading, please wait..."):xe.warning("Editor not initialized yet")};return c?s.jsx(te,{className:`border-neutral-200 shadow-sm ${l}`,children:s.jsx(te.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(Lt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),s.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Content: ",e?"Available":"Not available"]})]})})}):e?s.jsx("div",{className:`onlyoffice-form-editor ${l}`,children:s.jsxs("div",{className:"p-0",children:[i&&s.jsxs(Ye,{variant:"info",className:"mb-0 rounded-0",children:["You are editing an imported form: ",s.jsx("strong",{children:o})]}),s.jsxs(ge,{className:"g-0",children:[s.jsx(ee,{md:a?9:12,children:s.jsx("div",{className:"p-3 h-100",children:s.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"90vh",border:"1px solid #ddd",borderRadius:"4px"}})})}),a&&s.jsx(ee,{md:3,className:"border-start",children:s.jsx(Voe,{mergeFields:n,onInsertField:b,readOnly:r,className:"h-100"})})]})]})}):s.jsx(te,{className:`border-neutral-200 shadow-sm ${l}`,children:s.jsx(te.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsx("div",{className:"text-center",children:s.jsxs(Ye,{variant:"warning",children:[s.jsx("strong",{children:"No Document URL"}),s.jsx("br",{}),"Please upload a document first to use the editor."]})})})})},qoe=()=>{const e=mt(),t=Si(),[r,n]=v.useState(""),[a,i]=v.useState("Untitled Document"),[o,l]=v.useState("");v.useEffect(()=>{if(t.state){const{content:d,documentUrl:u,fileName:f,importType:m}=t.state,h=u||d||"";n(h),i(f||"Untitled Document"),l(m||""),console.log(" FormEditorPage received:",{documentUrl:u,content:d,fileName:f,finalContent:h})}},[t.state]);const c=()=>{e("/admin/forms")};return s.jsx(Bt,{permission:je.TEMPLATES.CREATE,fallback:s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:s.jsx(Le,{fluid:!0,className:"py-4 form-editor-page form-component",children:s.jsxs(te,{className:"border-neutral-200 shadow-sm",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(ge,{className:"align-items-center",children:s.jsx(ee,{xs:12,md:8,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:c,className:"me-3",size:"sm",children:s.jsx(gr,{size:16})}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0 text-primary-custom",children:a}),o&&s.jsxs("small",{className:"text-muted",children:["Import Type: ",o]})]})]})})})}),s.jsx(te.Body,{className:"p-0",children:s.jsx(Goe,{initialContent:r,fileName:a,showImportInfo:!!o,importType:o})})]})})})},Koe=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Koe,document.head.appendChild(e)}const Yoe=({traineeId:e})=>{const[t,r]=v.useState([]),[n,a]=v.useState(!0),{sortedData:i,sortConfig:o,handleSort:l}=tn(t);v.useEffect(()=>{c()},[e]);const c=async()=>{try{a(!0);const f=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(m=>setTimeout(m,300)),r(f)}catch(f){console.error("Error loading signature required:",f),xe.error("Failed to load signature requirements")}finally{a(!1)}},d=f=>{const h={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return s.jsx(Ce,{bg:h.variant,children:h.text})},u=f=>{console.log("Open signature pad for document:",f),xe.info("Signature pad functionality coming soon")};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(Qr,{count:5})}):t.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(to,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Document",sortKey:"name",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Course",sortKey:"course",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Status",sortKey:"status",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:i.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.subject})}),s.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),s.jsx("td",{children:d(f.status)}),s.jsx("td",{children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"Sign Document",icon:s.jsx(to,{}),onClick:()=>u(f.id)}]})})]},f.id))})]})})},Wj=()=>{const{user:e}=mn();return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsx(Yoe,{traineeId:e?.id})})},Xoe=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Xoe,document.head.appendChild(e)}const Zoe=({traineeId:e})=>{const[t,r]=v.useState([]),[n,a]=v.useState(!0),{sortedData:i,sortConfig:o,handleSort:l}=tn(t);v.useEffect(()=>{c()},[e]);const c=async()=>{try{a(!0);const f=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(m=>setTimeout(m,300)),r(f)}catch(f){console.error("Error loading section completion:",f),xe.error("Failed to load section completion requirements")}finally{a(!1)}},d=f=>{const h={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return s.jsx(Ce,{bg:h.variant,children:h.text})},u=f=>{console.log("Complete section:",f),xe.info("Section completion functionality coming soon")};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(Qr,{count:5})}):t.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(dt,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Section",sortKey:"name",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Course",sortKey:"course",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Type",sortKey:"section",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Progress",sortKey:"progress",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Status",sortKey:"status",sortConfig:o,onSort:l})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:i.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.subject})}),s.jsx("td",{children:s.jsx(Ce,{bg:"primary",className:"fw-normal",children:f.section})}),s.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[f.progress,"%"]})]})}),s.jsx("td",{children:d(f.status)}),s.jsx("td",{children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:f.status==="COMPLETED"?"View Section":"Complete Section",icon:f.status==="COMPLETED"?s.jsx(tr,{}):s.jsx(dt,{}),onClick:()=>u(f.id)}]})})]},f.id))})]})})},Hj=()=>{const{user:e}=mn();return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsx(Zoe,{traineeId:e?.id})})},Joe=({uniqueTypes:e,uniqueStatuses:t,uniquePriorities:r,selectedTypes:n,selectedStatuses:a,selectedPriorities:i,onTypeToggle:o,onStatusToggle:l,onPriorityToggle:c,onClearFilters:d,className:u=""})=>{const f=n.length>0||a.length>0||i.length>0;return s.jsxs(dn,{className:`filter-panel-dropdown course-filter-dropdown ${u}`,children:[s.jsx(dn.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(go,{size:14,className:"me-2"}),"Filters",f&&s.jsx("span",{className:"badge bg-primary ms-2",children:n.length+a.length+i.length})]})}),s.jsxs(dn.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),n.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(m=>s.jsx(F.Check,{type:"checkbox",id:`type-${m}`,label:m,checked:n.includes(m),onChange:()=>o(m),className:"mb-1"},m))})]}),s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),a.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(m=>s.jsx(F.Check,{type:"checkbox",id:`status-${m}`,label:m,checked:a.includes(m),onChange:()=>l(m),className:"mb-1"},m))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),i.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:s.jsx(We,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(m=>s.jsx(F.Check,{type:"checkbox",id:`priority-${m}`,label:m,checked:i.includes(m),onChange:()=>c(m),className:"mb-1"},m))})]}),f&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:d,children:[s.jsx(We,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},zC=document.createElement("style");zC.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(zC);const Qoe=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Qoe,document.head.appendChild(e)}const ele=({traineeId:e})=>{mt();const[t,r]=v.useState([]),[n,a]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState([]),[d,u]=v.useState([]),[f,m]=v.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=tn(t);v.useEffect(()=>{g()},[e]);const g=async()=>{try{a(!0);const _=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(W=>setTimeout(W,300)),r(_)}catch(_){console.error("Error loading assessments:",_),xe.error("Failed to load assessments")}finally{a(!1)}},y=v.useMemo(()=>t.filter(_=>{const W=i===""||_.name.toLowerCase().includes(i.toLowerCase())||_.description.toLowerCase().includes(i.toLowerCase())||_.course?.name.toLowerCase().includes(i.toLowerCase())||_.subject?.name.toLowerCase().includes(i.toLowerCase()),Y=l.length===0||l.includes(_.type),Q=d.length===0||d.includes(_.status),J=f.length===0||f.includes(_.priority);return W&&Y&&Q&&J}),[t,i,l,d,f]),w=v.useMemo(()=>[...new Set(t.map(W=>W.type))].filter(Boolean),[t]),b=v.useMemo(()=>[...new Set(t.map(W=>W.status))].filter(Boolean),[t]),j=v.useMemo(()=>[...new Set(t.map(W=>W.priority))].filter(Boolean),[t]),N=_=>{o(_.target.value)},E=_=>{c(W=>W.includes(_)?W.filter(Y=>Y!==_):[...W,_])},S=_=>{u(W=>W.includes(_)?W.filter(Y=>Y!==_):[...W,_])},T=_=>{m(W=>W.includes(_)?W.filter(Y=>Y!==_):[...W,_])},k=()=>{c([]),u([]),m([]),o("")},I=_=>{const Y={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[_]||{variant:"secondary",text:_};return s.jsx(Ce,{bg:Y.variant,children:Y.text})},C=_=>{const Y={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[_]||{variant:"secondary",text:_};return s.jsx(Ce,{bg:Y.variant,children:Y.text})},A=_=>{console.log("Start assessment:",_.id),xe.info("Assessment functionality coming soon")},L=_=>{console.log("View assessment:",_.id),xe.info("Assessment details functionality coming soon")};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(Qr,{count:8})}):s.jsx("div",{className:"trainee-your-assessments",children:s.jsx(te,{className:"shadow-sm",children:s.jsx(te.Body,{className:"p-0",children:s.jsxs(Gj,{defaultActiveKey:"upcoming",className:"border-bottom",children:[s.jsx(lr,{eventKey:"upcoming",title:"Upcoming Assessments",children:s.jsxs("div",{className:"p-3",children:[s.jsx("div",{style:{marginBottom:"3rem"},children:s.jsxs(ge,{className:"form-mobile-stack",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search assessments by name, description, course, or subject...",value:i,onChange:N,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(Joe,{uniqueTypes:w,uniqueStatuses:b,uniquePriorities:j,selectedTypes:l,selectedStatuses:d,selectedPriorities:f,onTypeToggle:E,onStatusToggle:S,onPriorityToggle:T,onClearFilters:k,className:"filter-panel-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[y.length," assessment",y.length!==1?"s":""]})})})]})}),y.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(cr,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:t.length===0?"No upcoming assessments":"No assessments match your filters"})]}):s.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:s.jsxs(qt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Assessment",sortKey:"name",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Course",sortKey:"course",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Subject",sortKey:"subject",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Type",sortKey:"type",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Priority",sortKey:"priority",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Due Date",sortKey:"dueDate",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:s.jsx(_t,{title:"Status",sortKey:"status",sortConfig:p,onSort:x})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:h.map(_=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:_.name}),s.jsx("small",{className:"text-muted",children:_.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:_.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:_.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:_.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:_.subject?.code||""})]}),s.jsx("td",{children:s.jsx(Ce,{bg:"primary",className:"fw-normal",children:_.type||"Assessment"})}),s.jsx("td",{children:C(_.priority)}),s.jsx("td",{children:_.dueDate?new Date(_.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:I(_.status)}),s.jsx("td",{children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:_.status==="PENDING"||_.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:_.status==="PENDING"||_.status==="IN_PROGRESS"?s.jsx(tx,{}):s.jsx(tr,{}),onClick:()=>_.status==="PENDING"||_.status==="IN_PROGRESS"?A(_):L(_)}]})})]},_.id))})]})})]})}),s.jsx(lr,{eventKey:"completed",title:"Completed Assessments",children:s.jsx("div",{className:"p-3",children:s.jsx(Xv,{traineeId:e})})})]})})})})},Vj=()=>{const{user:e}=mn();return s.jsx(Le,{fluid:!0,className:"py-4",children:s.jsx(ele,{traineeId:e?.id})})},tle=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=tle,document.head.appendChild(e)}const rle=()=>{const[e,t]=v.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[r,n]=v.useState(!1),a=o=>{const{name:l,value:c,type:d,checked:u}=o.target;t(f=>({...f,[l]:d==="checkbox"?u:c}))},i=async o=>{o.preventDefault(),n(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(l=>setTimeout(l,1e3)),xe.success("Incident/Feedback report submitted successfully!"),t({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(l){console.error("Error submitting incident/feedback report:",l),xe.error("Failed to submit incident/feedback report. Please try again.")}finally{n(!1)}};return s.jsxs(Le,{fluid:!0,className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("div",{className:"d-flex align-items-center",children:s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),s.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})})})}),s.jsxs(ge,{className:"mt-4",children:[s.jsx(ee,{lg:8,children:s.jsxs(te,{className:"border-0 shadow-sm create-issue-form",children:[s.jsx(te.Header,{children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(In,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),s.jsx(te.Body,{children:s.jsxs(F,{onSubmit:i,children:[s.jsxs(ge,{children:[s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Title"}),s.jsx(F.Control,{type:"text",name:"title",value:e.title,onChange:a,placeholder:"Brief description of the incident or feedback"})]})}),s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Request Type *"}),s.jsxs(F.Select,{name:"request_type",value:e.request_type,onChange:a,required:!0,children:[s.jsx("option",{value:"",children:"Select request type"}),s.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),s.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),s.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),s.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),s.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),s.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),s.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),s.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),s.jsx(ge,{children:s.jsx(ee,{md:6,children:s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Severity"}),s.jsxs(F.Select,{name:"severity",value:e.severity,onChange:a,children:[s.jsx("option",{value:"LOW",children:"Low"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Description"}),s.jsx(F.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:a,placeholder:"Please provide detailed information about the incident or feedback..."})]}),s.jsxs(F.Group,{className:"mb-3",children:[s.jsx(F.Label,{children:"Actions Taken"}),s.jsx(F.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:a,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),s.jsx(F.Group,{className:"mb-4",children:s.jsx(F.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:a,label:"Submit anonymously (your identity will be kept confidential)"})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(se,{type:"submit",variant:"primary",disabled:r,children:r?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(iN,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),s.jsx(ee,{lg:4,children:s.jsxs(te,{className:"border-0 shadow-sm create-issue-guidelines",children:[s.jsx(te.Header,{children:s.jsx("h5",{className:"mb-0",children:"Guidelines"})}),s.jsxs(te.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Before submitting:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"Check if the incident has already been reported"}),s.jsx("li",{children:"Provide clear and specific details"}),s.jsx("li",{children:"Include steps to reproduce the incident"}),s.jsx("li",{children:"Attach screenshots if applicable"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Response time:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"High priority: Within 24 hours"}),s.jsx("li",{children:"Medium priority: Within 2-3 days"}),s.jsx("li",{children:"Low priority: Within 1 week"})]})]}),s.jsxs(Ye,{variant:"info",className:"small",children:[s.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},nle=()=>{const e=mt();wo();const t={totalIssues:24,pendingIssues:8,totalFeedback:156,acknowledgedFeedback:89,totalTemplates:12,activeTemplates:10},r=[{id:1,type:"issue_created",title:"Safety Procedure Issue",description:"New issue reported by John Smith",time:"2 hours ago",icon:Et,color:"danger"},{id:2,type:"feedback_received",title:"Training Feedback",description:"Feedback from Sarah Johnson",time:"4 hours ago",icon:Hi,color:"info"},{id:3,type:"template_updated",title:"Assessment Template",description:"Template updated by Mike Wilson",time:"6 hours ago",icon:In,color:"success"}],n=[{title:"Issue List",description:"View and manage all reported issues",icon:Et,action:()=>e("/sqa/issues"),color:"danger"},{title:"Feedback List",description:"Review and acknowledge feedback",icon:Hi,action:()=>e("/sqa/feedback"),color:"info"},{title:"Template List",description:"Manage assessment templates",icon:In,action:()=>e("/sqa/templates"),color:"success"}];return s.jsx("div",{style:{paddingBottom:"2rem"},children:s.jsxs(Le,{className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"SQA Auditor Dashboard"}),s.jsx("p",{className:"text-muted mb-0",children:"Quality assurance and audit management"})]})})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Et,{size:32,className:"text-danger mb-2"}),s.jsx("h4",{className:"mb-1",children:t.totalIssues}),s.jsx("p",{className:"text-muted mb-0 small",children:"Total Issues"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Vt,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:t.pendingIssues}),s.jsx("p",{className:"text-muted mb-0 small",children:"Pending Issues"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Hi,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:t.totalFeedback}),s.jsx("p",{className:"text-muted mb-0 small",children:"Total Feedback"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(dt,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:t.acknowledgedFeedback}),s.jsx("p",{className:"text-muted mb-0 small",children:"Acknowledged"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(In,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:t.totalTemplates}),s.jsx("p",{className:"text-muted mb-0 small",children:"Templates"})]})})}),s.jsx(ee,{md:6,lg:2,className:"mb-3",children:s.jsx(te,{className:"h-100 border-0 shadow-sm",children:s.jsxs(te.Body,{className:"text-center",children:[s.jsx(Jp,{size:32,className:"text-secondary mb-2"}),s.jsx("h4",{className:"mb-1",children:t.activeTemplates}),s.jsx("p",{className:"text-muted mb-0 small",children:"Active"})]})})})]}),s.jsxs(ge,{children:[s.jsx(ee,{lg:8,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),s.jsx(te.Body,{children:s.jsx(ge,{children:n.map((a,i)=>s.jsx(ee,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:a.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(a.icon,{size:24,className:`text-${a.color} me-2`}),s.jsx("h6",{className:"mb-0",children:a.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:a.description}),s.jsx(Ji,{size:16,className:`text-${a.color} ms-auto`})]})},i))})})]})}),s.jsx(ee,{lg:4,className:"mb-4",children:s.jsxs(te,{className:"h-100 border-0 shadow-sm",children:[s.jsx(te.Header,{className:"bg-white border-bottom",children:s.jsx("h5",{className:"mb-0",children:"Recent Activities"})}),s.jsxs(te.Body,{children:[r.map(a=>s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx("div",{className:"me-3",children:s.jsx(a.icon,{size:20,className:`text-${a.color}`})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"mb-1 small",children:a.title}),s.jsx("p",{className:"text-muted mb-1 small",children:a.description}),s.jsx("p",{className:"text-muted mb-0 small",children:a.time})]})]},a.id)),s.jsx(se,{variant:"outline-primary",size:"sm",className:"w-100",children:"View All Activities"})]})]})})]})]})})},ale=()=>{const e=mt(),[t,r]=v.useState([]),[n,a]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("all"),{sortConfig:d,handleSort:u}=tn();v.useEffect(()=>{const y=[{id:1,title:"Safety Procedure Issue",description:"Reported safety concern in training module",reporter:"John Smith",reporterEmail:"john.smith@company.com",status:"open",priority:"high",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T14:20:00Z"},{id:2,title:"Training Material Error",description:"Incorrect information in assessment template",reporter:"Sarah Johnson",reporterEmail:"sarah.johnson@company.com",status:"in_progress",priority:"medium",createdAt:"2024-01-14T09:15:00Z",updatedAt:"2024-01-15T11:45:00Z"},{id:3,title:"System Performance Issue",description:"Slow loading times during assessment",reporter:"Mike Wilson",reporterEmail:"mike.wilson@company.com",status:"resolved",priority:"low",createdAt:"2024-01-13T16:20:00Z",updatedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(y),a(!1)},1e3)},[]);const f=y=>{const w={open:{variant:"danger",icon:Et},in_progress:{variant:"warning",icon:Vt},resolved:{variant:"success",icon:dt},closed:{variant:"secondary",icon:_a}},b=w[y]||w.open,j=b.icon;return s.jsxs(Ce,{bg:b.variant,className:"d-flex align-items-center",children:[s.jsx(j,{size:12,className:"me-1"}),y.replace("_"," ").toUpperCase()]})},m=y=>{const w={high:"danger",medium:"warning",low:"info"};return s.jsx(Ce,{bg:w[y]||"secondary",children:y.toUpperCase()})},h=t.filter(y=>{const w=y.title.toLowerCase().includes(i.toLowerCase())||y.description.toLowerCase().includes(i.toLowerCase())||y.reporter.toLowerCase().includes(i.toLowerCase()),b=l==="all"||y.status===l;return w&&b}),p=y=>{e(`/sqa/issues/${y}`)},x=y=>{e(`/sqa/issues/${y}/respond`)},g=y=>[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>p(y.id),permission:je.SQA.VIEW_TEMPLATES},{label:"Respond",icon:s.jsx(sN,{}),onClick:()=>x(y.id),disabled:y.status==="resolved"||y.status==="closed",permission:je.SQA.VIEW_TEMPLATES}];return n?s.jsx(Le,{className:"py-4",children:s.jsx(Qr,{})}):s.jsxs(Le,{className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Issue List"}),s.jsx("p",{className:"text-muted mb-0",children:"Manage and respond to reported issues"})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Issues"})})]})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:8,children:s.jsx(Za,{placeholder:"Search issues by title, description, or reporter...",value:i,onChange:o})}),s.jsx(ee,{md:4,children:s.jsxs("select",{className:"form-select",value:l,onChange:y=>c(y.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"resolved",children:"Resolved"}),s.jsx("option",{value:"closed",children:"Closed"})]})})]}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(te,{className:"border-0 shadow-sm",children:s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Issue Title",sortKey:"title",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Reporter"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Status",sortKey:"status",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Priority",sortKey:"priority",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Created Date",sortKey:"createdAt",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",width:"80",children:"Actions"})]})}),s.jsx("tbody",{children:h.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:"6",className:"text-center py-5",children:[s.jsx(Et,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No issues found"}),s.jsx("p",{className:"text-muted",children:"No issues match your current filters."})]})}):h.map(y=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:y.title}),s.jsx("p",{className:"text-muted small mb-0",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:y.description})]})}),s.jsx("td",{children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:y.reporter}),s.jsx("div",{className:"text-muted small",children:y.reporterEmail})]})}),s.jsx("td",{children:f(y.status)}),s.jsx("td",{children:m(y.priority)}),s.jsx("td",{children:s.jsx("div",{className:"text-muted small",children:new Date(y.createdAt).toLocaleDateString()})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.SQA.VIEW_TEMPLATES],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:g(y)})})})]},y.id))})]})})})})})})]})},sle=()=>{const e=mt(),[t,r]=v.useState([]),[n,a]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("all"),{sortConfig:d,handleSort:u}=tn();v.useEffect(()=>{const w=[{id:1,title:"Training Course Feedback",description:"Positive feedback about the safety training course",submitter:"Sarah Johnson",submitterEmail:"sarah.johnson@company.com",status:"acknowledged",category:"training",rating:5,createdAt:"2024-01-15T10:30:00Z",acknowledgedAt:"2024-01-15T14:20:00Z"},{id:2,title:"System Usability Feedback",description:"Suggestions for improving the assessment interface",submitter:"Mike Wilson",submitterEmail:"mike.wilson@company.com",status:"pending",category:"system",rating:4,createdAt:"2024-01-14T09:15:00Z",acknowledgedAt:null},{id:3,title:"Content Quality Feedback",description:"Feedback about the quality of training materials",submitter:"John Smith",submitterEmail:"john.smith@company.com",status:"acknowledged",category:"content",rating:3,createdAt:"2024-01-13T16:20:00Z",acknowledgedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(w),a(!1)},1e3)},[]);const f=w=>{const b={pending:{variant:"warning",icon:Vt},acknowledged:{variant:"success",icon:dt},reviewed:{variant:"info",icon:Jp}},j=b[w]||b.pending,N=j.icon;return s.jsxs(Ce,{bg:j.variant,className:"d-flex align-items-center",children:[s.jsx(N,{size:12,className:"me-1"}),w.toUpperCase()]})},m=w=>{const b={training:"primary",system:"info",content:"success",general:"secondary"};return s.jsx(Ce,{bg:b[w]||"secondary",children:w.toUpperCase()})},h=w=>Array.from({length:5},(b,j)=>s.jsx("span",{className:j<w?"text-warning":"text-muted",children:""},j)),p=t.filter(w=>{const b=w.title.toLowerCase().includes(i.toLowerCase())||w.description.toLowerCase().includes(i.toLowerCase())||w.submitter.toLowerCase().includes(i.toLowerCase()),j=l==="all"||w.status===l;return b&&j}),x=w=>{e(`/sqa/feedback/${w}`)},g=w=>{e(`/sqa/feedback/${w}/acknowledge`)},y=w=>[{label:"View Details",icon:s.jsx(tr,{}),onClick:()=>x(w.id),permission:je.SQA.VIEW_TEMPLATES},{label:"Acknowledge",icon:s.jsx(dt,{}),onClick:()=>g(w.id),disabled:w.status==="acknowledged"||w.status==="reviewed",permission:je.SQA.VIEW_TEMPLATES}];return n?s.jsx(Le,{className:"py-4",children:s.jsx(Qr,{})}):s.jsxs(Le,{className:"py-4",children:[s.jsx(ge,{className:"mb-4",children:s.jsx(ee,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Feedback List"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and acknowledge user feedback"})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Feedback"})})]})})}),s.jsxs(ge,{className:"mb-4",children:[s.jsx(ee,{md:8,children:s.jsx(Za,{placeholder:"Search feedback by title, description, or submitter...",value:i,onChange:o})}),s.jsx(ee,{md:4,children:s.jsxs("select",{className:"form-select",value:l,onChange:w=>c(w.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"acknowledged",children:"Acknowledged"}),s.jsx("option",{value:"reviewed",children:"Reviewed"})]})})]}),s.jsx(ge,{children:s.jsx(ee,{children:s.jsx(te,{className:"border-0 shadow-sm",children:s.jsx(te.Body,{className:"p-0",children:s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Feedback Title",sortKey:"title",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Submitter"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Category"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Rating"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Status",sortKey:"status",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(Fr,{title:"Created Date",sortKey:"createdAt",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",width:"80",children:"Actions"})]})}),s.jsx("tbody",{children:p.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:"7",className:"text-center py-5",children:[s.jsx(Hi,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No feedback found"}),s.jsx("p",{className:"text-muted",children:"No feedback matches your current filters."})]})}):p.map(w=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:w.title}),s.jsx("p",{className:"text-muted small mb-0",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:w.description})]})}),s.jsx("td",{children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:w.submitter}),s.jsx("div",{className:"text-muted small",children:w.submitterEmail})]})}),s.jsx("td",{children:m(w.category)}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"me-2",children:h(w.rating)}),s.jsxs("span",{className:"text-muted small",children:["(",w.rating,"/5)"]})]})}),s.jsx("td",{children:f(w.status)}),s.jsx("td",{children:s.jsx("div",{className:"text-muted small",children:new Date(w.createdAt).toLocaleDateString()})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.SQA.VIEW_TEMPLATES],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:y(w)})})})]},w.id))})]})})})})})})]})},ile=()=>{mt();const[e,t]=v.useState([]),[r,n]=v.useState(!0),[a,i]=v.useState(""),[o,l]=v.useState(""),{sortConfig:c,handleSort:d}=tn();v.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const b=[{id:"1",name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses",version:"v2.1",category:"SAFETY",sections:5,fields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z"},{id:"2",name:"Technical Skills Evaluation",description:"Template for evaluating technical skills and competencies",version:"v1.5",category:"TECHNICAL",sections:3,fields:15,status:"DRAFT",createdBy:"Sarah Johnson",createdAt:"2024-01-14T00:00:00.000Z"},{id:"3",name:"Compliance Assessment",description:"Template for compliance and regulatory assessments",version:"v3.0",category:"COMPLIANCE",sections:7,fields:31,status:"ACTIVE",createdBy:"Mike Wilson",createdAt:"2024-01-13T00:00:00.000Z"}];await new Promise(j=>setTimeout(j,1e3)),t(b)}catch(b){console.error("Error loading templates:",b)}finally{n(!1)}},f=b=>{switch(b){case"ACTIVE":return{variant:"success",icon:dt,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:Vt,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:Vt,text:"INACTIVE"};default:return{variant:"secondary",icon:Vt,text:b}}},m=b=>{switch(b){case"SAFETY":return{variant:"danger",text:"SAFETY"};case"TECHNICAL":return{variant:"info",text:"TECHNICAL"};case"COMPLIANCE":return{variant:"dark",text:"COMPLIANCE"};default:return{variant:"secondary",text:b}}},h=b=>{console.log("View history for template:",b)},p=b=>{console.log("View sections for template:",b)},x=b=>{console.log("View fields for template:",b)},g=b=>{console.log("Export PDF for template:",b)},y=e.filter(b=>{const j=b.name.toLowerCase().includes(a.toLowerCase())||b.description.toLowerCase().includes(a.toLowerCase())||b.createdBy.toLowerCase().includes(a.toLowerCase()),N=!o||b.status===o;return j&&N});if(r)return s.jsx(Le,{fluid:!0,className:"p-4",children:s.jsx(Qr,{})});const w=({columnKey:b,children:j,className:N=""})=>{const E=c.key===b,S=E?c.direction:null;return s.jsxs("th",{className:`border-neutral-200 text-primary-custom fw-semibold ${N} ${E?"text-primary":"text-muted"}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onClick:()=>d(b),onMouseEnter:T=>{T.target.style.backgroundColor="rgba(0, 123, 255, 0.08)",T.target.style.transform="translateY(-1px)",T.target.style.boxShadow="0 2px 8px rgba(0, 123, 255, 0.15)"},onMouseLeave:T=>{T.target.style.backgroundColor="transparent",T.target.style.transform="translateY(0)",T.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:E?"600":"500"},children:j}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(Fr,{direction:S,size:14})})]}),E&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, var(--bs-primary), var(--bs-info))",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx(Le,{fluid:!0,className:"py-4 template-list-page",children:s.jsxs(te,{className:"border-neutral-200 shadow-sm",children:[s.jsx(te.Header,{className:"bg-light-custom border-neutral-200",children:s.jsxs(ge,{className:"align-items-center",children:[s.jsx(ee,{xs:12,md:6,children:s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1 text-dark",children:"Template List"}),s.jsx("p",{className:"text-muted mb-0",children:"Manage assessment templates and their versions"})]})}),s.jsx(ee,{xs:12,md:6,className:"mt-2 mt-md-0",children:s.jsx("div",{className:"d-flex justify-content-end gap-2",children:s.jsxs(se,{variant:"outline-primary",size:"sm",className:"d-flex align-items-center",children:[s.jsx($m,{className:"me-1",size:16}),"Export Templates"]})})})]})}),s.jsxs(te.Body,{children:[s.jsxs(ge,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(ee,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(Za,{placeholder:"Search templates by name, description, or creator...",value:a,onChange:i,className:"search-bar-mobile"})}),s.jsx(ee,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsxs(F.Select,{value:o,onChange:b=>l(b.target.value),className:"filter-panel-mobile",children:[s.jsx("option",{value:"",children:"All Status"}),s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"DRAFT",children:"Draft"}),s.jsx("option",{value:"INACTIVE",children:"Inactive"})]})}),s.jsx(ee,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[y.length," template",y.length!==1?"s":""]})})})]}),s.jsxs("div",{className:"position-relative",children:[s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(w,{columnKey:"name",className:"show-mobile",children:"Template Name"}),s.jsx(w,{columnKey:"version",className:"show-mobile",children:"Version"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Category"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Sections/Fields"}),s.jsx(w,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(w,{columnKey:"createdBy",className:"show-mobile",children:"Created By"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",width:"80",children:"Actions"})]})}),s.jsx("tbody",{children:y.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:"7",className:"text-center py-5",children:[s.jsx(In,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No templates found"}),s.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]})}):y.map((b,j)=>{const N=f(b.status),E=m(b.category),S=N.icon;return s.jsxs("tr",{className:`${j%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor=j%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium text-dark",children:b.name}),s.jsx("div",{className:"text-muted small",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:b.description})]})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:b.version})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ce,{bg:E.variant,className:"px-2 py-1",style:{fontSize:"0.75rem"},children:E.text})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{className:"text-muted small",children:[s.jsxs("div",{children:[b.sections," sections"]}),s.jsxs("div",{children:[b.fields," fields"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(Ce,{bg:N.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(S,{className:"me-1",size:12}),N.text]})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{className:"text-muted small",children:[s.jsx("div",{children:b.createdBy}),s.jsx("div",{children:new Date(b.createdAt).toLocaleDateString()})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Bt,{permissions:[je.SQA.VIEW_TEMPLATES,je.SQA.VIEW_TEMPLATE_DETAIL],fallback:null,children:s.jsx(Lr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(_r,{size:16})},items:[{label:"List History Version",icon:s.jsx(Zj,{}),onClick:()=>h(b.id),permission:je.SQA.VIEW_TEMPLATE_DETAIL},{label:"Section List",icon:s.jsx(ex,{}),onClick:()=>p(b.id),permission:je.SQA.VIEW_TEMPLATE_SCHEMA},{label:"Field List",icon:s.jsx(tN,{}),onClick:()=>x(b.id),permission:je.SQA.EXTRACT_TEMPLATE_FIELDS},{label:"PDF Preview for Export",icon:s.jsx($m,{}),onClick:()=>g(b.id),permission:je.SQA.VIEW_TEMPLATES}]})})})]},b.id)})})]})}),y.length>8&&s.jsxs("div",{className:"scroll-indicator",children:[s.jsx(Es,{size:12,className:"me-1"}),"Scroll to see more templates"]})]})]})]})})},ole=u4([{path:"/",element:s.jsx(vf,{}),errorElement:s.jsx(ps,{})},{path:"/login",element:s.jsx(vf,{}),errorElement:s.jsx(ps,{})},{path:"/reset-password",element:s.jsx(jI,{}),errorElement:s.jsx(ps,{})},{path:"/admin",element:s.jsx(Cc,{children:s.jsx(kc,{})}),errorElement:s.jsx(ps,{}),children:[{path:"",element:s.jsx(gf,{})},{path:"dashboard",element:s.jsx(ht,{permission:je.DASHBOARD.VIEW,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access the dashboard."}),children:s.jsx(nK,{})})},{path:"users",element:s.jsx(ht,{permission:je.USERS.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:s.jsx(fie,{})})},{path:"roles",element:s.jsx(ht,{permission:je.ROLES.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:s.jsx(yie,{})})},{path:"departments",element:s.jsx(ht,{permission:je.DEPARTMENTS.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:s.jsx(_ie,{})})},{path:"departments/:id",element:s.jsx(ht,{permission:je.DEPARTMENTS.VIEW_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:s.jsx(Fie,{})})},{path:"profile",element:s.jsx(ht,{permission:je.PROFILES.VIEW,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:s.jsx($ie,{})})},{path:"forms",element:s.jsx(ht,{permission:je.TEMPLATES.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:s.jsx(Hoe,{})})},{path:"forms/editor",element:s.jsx(ht,{permission:je.TEMPLATES.CREATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:s.jsx(qoe,{})})},{path:"system-config",element:s.jsx(ht,{permission:je.GLOBAL_FIELDS.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:s.jsx("div",{children:"System Configuration Page"})})}]},{path:"/academic",element:s.jsx(Cc,{children:s.jsx(kc,{})}),errorElement:s.jsx(ps,{}),children:[{path:"",element:s.jsx(gf,{})},{path:"dashboard",element:s.jsx(Uie,{})},{path:"departments",element:s.jsx(zie,{})},{path:"course/:courseId",element:s.jsx(Yie,{})},{path:"course-detail/:courseId",element:s.jsx(xoe,{})},{path:"course/:courseId/enroll-trainees",element:s.jsx(Eoe,{})},{path:"subject/:subjectId",element:s.jsx(Bj,{})},{path:"course/:courseId/subject/:subjectId",element:s.jsx(Bj,{})}]},{path:"/trainee",element:s.jsx(Cc,{children:s.jsx(kc,{})}),errorElement:s.jsx(ps,{}),children:[{path:"",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:s.jsx(zj,{})})},{path:"dashboard",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:s.jsx(zj,{})})},{path:":traineeId/course/:courseId",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:s.jsx(Aoe,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_SUBJECTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:s.jsx(Coe,{})})},{path:":traineeId/assessments",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:s.jsx(Poe,{})})},{path:":traineeId/signature-pad/:documentId",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:s.jsx(Ioe,{})})},{path:":traineeId/assessment-section/:sectionId",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:s.jsx(Foe,{})})},{path:"academic-details",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:s.jsx(Boe,{})})},{path:"enrolled-courses",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:s.jsx(Uoe,{})})},{path:"signature-required",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:s.jsx(Wj,{})})},{path:"completion-required",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:s.jsx(Hj,{})})},{path:"your-assessments",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:s.jsx(Vj,{})})},{path:"create-incident-feedback-report",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ALL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:s.jsx(rle,{})})},{path:"assessment-pending",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment pending list."}),children:s.jsx(Vj,{})})},{path:"assessment-pending/signature-required",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:s.jsx(Wj,{})})},{path:"assessment-pending/section-completion",element:s.jsx(ht,{permission:je.TRAINEES.VIEW_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:s.jsx(Hj,{})})}]},{path:"/sqa",element:s.jsx(Cc,{children:s.jsx(kc,{})}),errorElement:s.jsx(ps,{}),children:[{path:"",element:s.jsx(gf,{})},{path:"dashboard",element:s.jsx(ht,{permission:je.SQA.VIEW_TEMPLATES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access SQA dashboard."}),children:s.jsx(nle,{})})},{path:"issues",element:s.jsx(ht,{permission:je.SQA.VIEW_TEMPLATES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:s.jsx(ale,{})})},{path:"feedback",element:s.jsx(ht,{permission:je.SQA.VIEW_TEMPLATES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:s.jsx(sle,{})})},{path:"templates",element:s.jsx(ht,{permission:je.SQA.VIEW_TEMPLATES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template list."}),children:s.jsx(ile,{})})}]},{path:"*",element:s.jsx(vf,{}),errorElement:s.jsx(ps,{})}],{basename:ox()});function lle(){return v.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,n=t.hash,a=r.match(/\?\/(.+?)(?:&|$)/);if(a){const o=`/${a[1].replace(/~and~/g,"&")}${n}`;window.history.replaceState(null,"",o)}}})()},[]),s.jsxs(yI,{children:[s.jsx(f4,{router:ole}),s.jsx(hI,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}p4.createRoot(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx(lle,{})}));
